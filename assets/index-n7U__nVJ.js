var F$=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var o_e=F$((qa,Ka)=>{(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const d of document.querySelectorAll('link[rel="modulepreload"]'))a(d);new MutationObserver(d=>{for(const p of d)if(p.type==="childList")for(const _ of p.addedNodes)_.tagName==="LINK"&&_.rel==="modulepreload"&&a(_)}).observe(document,{childList:!0,subtree:!0});function i(d){const p={};return d.integrity&&(p.integrity=d.integrity),d.referrerPolicy&&(p.referrerPolicy=d.referrerPolicy),d.crossOrigin==="use-credentials"?p.credentials="include":d.crossOrigin==="anonymous"?p.credentials="omit":p.credentials="same-origin",p}function a(d){if(d.ep)return;d.ep=!0;const p=i(d);fetch(d.href,p)}})();/**
* @vue/shared v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**//*! #__NO_SIDE_EFFECTS__ */function cC(e){const t=Object.create(null);for(const i of e.split(","))t[i]=1;return i=>i in t}const ci={},pm=[],_o=()=>{},N$=()=>!1,j1=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&(e.charCodeAt(2)>122||e.charCodeAt(2)<97),uC=e=>e.startsWith("onUpdate:"),as=Object.assign,dC=(e,t)=>{const i=e.indexOf(t);i>-1&&e.splice(i,1)},B$=Object.prototype.hasOwnProperty,to=(e,t)=>B$.call(e,t),ln=Array.isArray,mm=e=>uy(e)==="[object Map]",H1=e=>uy(e)==="[object Set]",Hd=e=>uy(e)==="[object Date]",Nn=e=>typeof e=="function",Dn=e=>typeof e=="string",oc=e=>typeof e=="symbol",yr=e=>e!==null&&typeof e=="object",L_=e=>(yr(e)||Nn(e))&&Nn(e.then)&&Nn(e.catch),UO=Object.prototype.toString,uy=e=>UO.call(e),V$=e=>uy(e).slice(8,-1),D_=e=>uy(e)==="[object Object]",hC=e=>Dn(e)&&e!=="NaN"&&e[0]!=="-"&&""+parseInt(e,10)===e,v_=cC(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),G1=e=>{const t=Object.create(null);return i=>t[i]||(t[i]=e(i))},$$=/-(\w)/g,da=G1(e=>e.replace($$,(t,i)=>i?i.toUpperCase():"")),U$=/\B([A-Z])/g,Vu=G1(e=>e.replace(U$,"-$1").toLowerCase()),dy=G1(e=>e.charAt(0).toUpperCase()+e.slice(1)),__=G1(e=>e?`on${dy(e)}`:""),$d=(e,t)=>!Object.is(e,t),$b=(e,...t)=>{for(let i=0;i<e.length;i++)e[i](...t)},jO=(e,t,i,a=!1)=>{Object.defineProperty(e,t,{configurable:!0,enumerable:!1,writable:a,value:i})},AS=e=>{const t=parseFloat(e);return isNaN(t)?e:t},j$=e=>{const t=Dn(e)?Number(e):NaN;return isNaN(t)?e:t};let Xk;const W1=()=>Xk||(Xk=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function $n(e){if(ln(e)){const t={};for(let i=0;i<e.length;i++){const a=e[i],d=Dn(a)?q$(a):$n(a);if(d)for(const p in d)t[p]=d[p]}return t}else if(Dn(e)||yr(e))return e}const H$=/;(?![^(]*\))/g,G$=/:([^]+)/,W$=/\/\*[^]*?\*\//g;function q$(e){const t={};return e.replace(W$,"").split(H$).forEach(i=>{if(i){const a=i.split(G$);a.length>1&&(t[a[0].trim()]=a[1].trim())}}),t}function pe(e){let t="";if(Dn(e))t=e;else if(ln(e))for(let i=0;i<e.length;i++){const a=pe(e[i]);a&&(t+=a+" ")}else if(yr(e))for(const i in e)e[i]&&(t+=i+" ");return t.trim()}function Ha(e){if(!e)return null;let{class:t,style:i}=e;return t&&!Dn(t)&&(e.class=pe(t)),i&&(e.style=$n(i)),e}const K$="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",Z$=cC(K$);function HO(e){return!!e||e===""}function Y$(e,t){if(e.length!==t.length)return!1;let i=!0;for(let a=0;i&&a<e.length;a++)i=Tm(e[a],t[a]);return i}function Tm(e,t){if(e===t)return!0;let i=Hd(e),a=Hd(t);if(i||a)return i&&a?e.getTime()===t.getTime():!1;if(i=oc(e),a=oc(t),i||a)return e===t;if(i=ln(e),a=ln(t),i||a)return i&&a?Y$(e,t):!1;if(i=yr(e),a=yr(t),i||a){if(!i||!a)return!1;const d=Object.keys(e).length,p=Object.keys(t).length;if(d!==p)return!1;for(const _ in e){const r=e.hasOwnProperty(_),S=t.hasOwnProperty(_);if(r&&!S||!r&&S||!Tm(e[_],t[_]))return!1}}return String(e)===String(t)}function GO(e,t){return e.findIndex(i=>Tm(i,t))}const WO=e=>!!(e&&e.__v_isRef===!0),pn=e=>Dn(e)?e:e==null?"":ln(e)||yr(e)&&(e.toString===UO||!Nn(e.toString))?WO(e)?pn(e.value):JSON.stringify(e,qO,2):String(e),qO=(e,t)=>WO(t)?qO(e,t.value):mm(t)?{[`Map(${t.size})`]:[...t.entries()].reduce((i,[a,d],p)=>(i[N2(a,p)+" =>"]=d,i),{})}:H1(t)?{[`Set(${t.size})`]:[...t.values()].map(i=>N2(i))}:oc(t)?N2(t):yr(t)&&!ln(t)&&!D_(t)?String(t):t,N2=(e,t="")=>{var i;return oc(e)?`Symbol(${(i=e.description)!=null?i:t})`:e};/**
* @vue/reactivity v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let oa;class KO{constructor(t=!1){this.detached=t,this._active=!0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=oa,!t&&oa&&(this.index=(oa.scopes||(oa.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let t,i;if(this.scopes)for(t=0,i=this.scopes.length;t<i;t++)this.scopes[t].pause();for(t=0,i=this.effects.length;t<i;t++)this.effects[t].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let t,i;if(this.scopes)for(t=0,i=this.scopes.length;t<i;t++)this.scopes[t].resume();for(t=0,i=this.effects.length;t<i;t++)this.effects[t].resume()}}run(t){if(this._active){const i=oa;try{return oa=this,t()}finally{oa=i}}}on(){oa=this}off(){oa=this.parent}stop(t){if(this._active){this._active=!1;let i,a;for(i=0,a=this.effects.length;i<a;i++)this.effects[i].stop();for(this.effects.length=0,i=0,a=this.cleanups.length;i<a;i++)this.cleanups[i]();if(this.cleanups.length=0,this.scopes){for(i=0,a=this.scopes.length;i<a;i++)this.scopes[i].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!t){const d=this.parent.scopes.pop();d&&d!==this&&(this.parent.scopes[this.index]=d,d.index=this.index)}this.parent=void 0}}}function fC(e){return new KO(e)}function pC(){return oa}function mC(e,t=!1){oa&&oa.cleanups.push(e)}let vi;const B2=new WeakSet;class ZO{constructor(t){this.fn=t,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,oa&&oa.active&&oa.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,B2.has(this)&&(B2.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||XO(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,Jk(this),JO(this);const t=vi,i=ec;vi=this,ec=!0;try{return this.fn()}finally{QO(this),vi=t,ec=i,this.flags&=-3}}stop(){if(this.flags&1){for(let t=this.deps;t;t=t.nextDep)_C(t);this.deps=this.depsTail=void 0,Jk(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?B2.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){kS(this)&&this.run()}get dirty(){return kS(this)}}let YO=0,y_,b_;function XO(e,t=!1){if(e.flags|=8,t){e.next=b_,b_=e;return}e.next=y_,y_=e}function gC(){YO++}function vC(){if(--YO>0)return;if(b_){let t=b_;for(b_=void 0;t;){const i=t.next;t.next=void 0,t.flags&=-9,t=i}}let e;for(;y_;){let t=y_;for(y_=void 0;t;){const i=t.next;if(t.next=void 0,t.flags&=-9,t.flags&1)try{t.trigger()}catch(a){e||(e=a)}t=i}}if(e)throw e}function JO(e){for(let t=e.deps;t;t=t.nextDep)t.version=-1,t.prevActiveLink=t.dep.activeLink,t.dep.activeLink=t}function QO(e){let t,i=e.depsTail,a=i;for(;a;){const d=a.prevDep;a.version===-1?(a===i&&(i=d),_C(a),X$(a)):t=a,a.dep.activeLink=a.prevActiveLink,a.prevActiveLink=void 0,a=d}e.deps=t,e.depsTail=i}function kS(e){for(let t=e.deps;t;t=t.nextDep)if(t.dep.version!==t.version||t.dep.computed&&(eL(t.dep.computed)||t.dep.version!==t.version))return!0;return!!e._dirty}function eL(e){if(e.flags&4&&!(e.flags&16)||(e.flags&=-17,e.globalVersion===z_))return;e.globalVersion=z_;const t=e.dep;if(e.flags|=2,t.version>0&&!e.isSSR&&e.deps&&!kS(e)){e.flags&=-3;return}const i=vi,a=ec;vi=e,ec=!0;try{JO(e);const d=e.fn(e._value);(t.version===0||$d(d,e._value))&&(e._value=d,t.version++)}catch(d){throw t.version++,d}finally{vi=i,ec=a,QO(e),e.flags&=-3}}function _C(e,t=!1){const{dep:i,prevSub:a,nextSub:d}=e;if(a&&(a.nextSub=d,e.prevSub=void 0),d&&(d.prevSub=a,e.nextSub=void 0),i.subs===e&&(i.subs=a,!a&&i.computed)){i.computed.flags&=-5;for(let p=i.computed.deps;p;p=p.nextDep)_C(p,!0)}!t&&!--i.sc&&i.map&&i.map.delete(i.key)}function X$(e){const{prevDep:t,nextDep:i}=e;t&&(t.nextDep=i,e.prevDep=void 0),i&&(i.prevDep=t,e.nextDep=void 0)}let ec=!0;const tL=[];function Qd(){tL.push(ec),ec=!1}function eh(){const e=tL.pop();ec=e===void 0?!0:e}function Jk(e){const{cleanup:t}=e;if(e.cleanup=void 0,t){const i=vi;vi=void 0;try{t()}finally{vi=i}}}let z_=0,J$=class{constructor(t,i){this.sub=t,this.dep=i,this.version=i.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}};class q1{constructor(t){this.computed=t,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0}track(t){if(!vi||!ec||vi===this.computed)return;let i=this.activeLink;if(i===void 0||i.sub!==vi)i=this.activeLink=new J$(vi,this),vi.deps?(i.prevDep=vi.depsTail,vi.depsTail.nextDep=i,vi.depsTail=i):vi.deps=vi.depsTail=i,nL(i);else if(i.version===-1&&(i.version=this.version,i.nextDep)){const a=i.nextDep;a.prevDep=i.prevDep,i.prevDep&&(i.prevDep.nextDep=a),i.prevDep=vi.depsTail,i.nextDep=void 0,vi.depsTail.nextDep=i,vi.depsTail=i,vi.deps===i&&(vi.deps=a)}return i}trigger(t){this.version++,z_++,this.notify(t)}notify(t){gC();try{for(let i=this.subs;i;i=i.prevSub)i.sub.notify()&&i.sub.dep.notify()}finally{vC()}}}function nL(e){if(e.dep.sc++,e.sub.flags&4){const t=e.dep.computed;if(t&&!e.dep.subs){t.flags|=20;for(let a=t.deps;a;a=a.nextDep)nL(a)}const i=e.dep.subs;i!==e&&(e.prevSub=i,i&&(i.nextSub=e)),e.dep.subs=e}}const l1=new WeakMap,Tf=Symbol(""),PS=Symbol(""),F_=Symbol("");function Ns(e,t,i){if(ec&&vi){let a=l1.get(e);a||l1.set(e,a=new Map);let d=a.get(i);d||(a.set(i,d=new q1),d.map=a,d.key=i),d.track()}}function Au(e,t,i,a,d,p){const _=l1.get(e);if(!_){z_++;return}const r=S=>{S&&S.trigger()};if(gC(),t==="clear")_.forEach(r);else{const S=ln(e),C=S&&hC(i);if(S&&i==="length"){const M=Number(a);_.forEach((k,z)=>{(z==="length"||z===F_||!oc(z)&&z>=M)&&r(k)})}else switch((i!==void 0||_.has(void 0))&&r(_.get(i)),C&&r(_.get(F_)),t){case"add":S?C&&r(_.get("length")):(r(_.get(Tf)),mm(e)&&r(_.get(PS)));break;case"delete":S||(r(_.get(Tf)),mm(e)&&r(_.get(PS)));break;case"set":mm(e)&&r(_.get(Tf));break}}vC()}function Q$(e,t){const i=l1.get(e);return i&&i.get(t)}function Xp(e){const t=wo(e);return t===e?t:(Ns(t,"iterate",F_),wl(e)?t:t.map(Bs))}function K1(e){return Ns(e=wo(e),"iterate",F_),e}const e6={__proto__:null,[Symbol.iterator](){return V2(this,Symbol.iterator,Bs)},concat(...e){return Xp(this).concat(...e.map(t=>ln(t)?Xp(t):t))},entries(){return V2(this,"entries",e=>(e[1]=Bs(e[1]),e))},every(e,t){return Tu(this,"every",e,t,void 0,arguments)},filter(e,t){return Tu(this,"filter",e,t,i=>i.map(Bs),arguments)},find(e,t){return Tu(this,"find",e,t,Bs,arguments)},findIndex(e,t){return Tu(this,"findIndex",e,t,void 0,arguments)},findLast(e,t){return Tu(this,"findLast",e,t,Bs,arguments)},findLastIndex(e,t){return Tu(this,"findLastIndex",e,t,void 0,arguments)},forEach(e,t){return Tu(this,"forEach",e,t,void 0,arguments)},includes(...e){return $2(this,"includes",e)},indexOf(...e){return $2(this,"indexOf",e)},join(e){return Xp(this).join(e)},lastIndexOf(...e){return $2(this,"lastIndexOf",e)},map(e,t){return Tu(this,"map",e,t,void 0,arguments)},pop(){return o_(this,"pop")},push(...e){return o_(this,"push",e)},reduce(e,...t){return Qk(this,"reduce",e,t)},reduceRight(e,...t){return Qk(this,"reduceRight",e,t)},shift(){return o_(this,"shift")},some(e,t){return Tu(this,"some",e,t,void 0,arguments)},splice(...e){return o_(this,"splice",e)},toReversed(){return Xp(this).toReversed()},toSorted(e){return Xp(this).toSorted(e)},toSpliced(...e){return Xp(this).toSpliced(...e)},unshift(...e){return o_(this,"unshift",e)},values(){return V2(this,"values",Bs)}};function V2(e,t,i){const a=K1(e),d=a[t]();return a!==e&&!wl(e)&&(d._next=d.next,d.next=()=>{const p=d._next();return p.value&&(p.value=i(p.value)),p}),d}const t6=Array.prototype;function Tu(e,t,i,a,d,p){const _=K1(e),r=_!==e&&!wl(e),S=_[t];if(S!==t6[t]){const k=S.apply(e,p);return r?Bs(k):k}let C=i;_!==e&&(r?C=function(k,z){return i.call(this,Bs(k),z,e)}:i.length>2&&(C=function(k,z){return i.call(this,k,z,e)}));const M=S.call(_,C,a);return r&&d?d(M):M}function Qk(e,t,i,a){const d=K1(e);let p=i;return d!==e&&(wl(e)?i.length>3&&(p=function(_,r,S){return i.call(this,_,r,S,e)}):p=function(_,r,S){return i.call(this,_,Bs(r),S,e)}),d[t](p,...a)}function $2(e,t,i){const a=wo(e);Ns(a,"iterate",F_);const d=a[t](...i);return(d===-1||d===!1)&&xC(i[0])?(i[0]=wo(i[0]),a[t](...i)):d}function o_(e,t,i=[]){Qd(),gC();const a=wo(e)[t].apply(e,i);return vC(),eh(),a}const n6=cC("__proto__,__v_isRef,__isVue"),rL=new Set(Object.getOwnPropertyNames(Symbol).filter(e=>e!=="arguments"&&e!=="caller").map(e=>Symbol[e]).filter(oc));function r6(e){oc(e)||(e=String(e));const t=wo(this);return Ns(t,"has",e),t.hasOwnProperty(e)}class oL{constructor(t=!1,i=!1){this._isReadonly=t,this._isShallow=i}get(t,i,a){if(i==="__v_skip")return t.__v_skip;const d=this._isReadonly,p=this._isShallow;if(i==="__v_isReactive")return!d;if(i==="__v_isReadonly")return d;if(i==="__v_isShallow")return p;if(i==="__v_raw")return a===(d?p?f6:lL:p?aL:sL).get(t)||Object.getPrototypeOf(t)===Object.getPrototypeOf(a)?t:void 0;const _=ln(t);if(!d){let S;if(_&&(S=e6[i]))return S;if(i==="hasOwnProperty")return r6}const r=Reflect.get(t,i,To(t)?t:a);return(oc(i)?rL.has(i):n6(i))||(d||Ns(t,"get",i),p)?r:To(r)?_&&hC(i)?r:r.value:yr(r)?d?Wm(r):lo(r):r}}class iL extends oL{constructor(t=!1){super(!1,t)}set(t,i,a,d){let p=t[i];if(!this._isShallow){const S=kf(p);if(!wl(a)&&!kf(a)&&(p=wo(p),a=wo(a)),!ln(t)&&To(p)&&!To(a))return S?!1:(p.value=a,!0)}const _=ln(t)&&hC(i)?Number(i)<t.length:to(t,i),r=Reflect.set(t,i,a,To(t)?t:d);return t===wo(d)&&(_?$d(a,p)&&Au(t,"set",i,a):Au(t,"add",i,a)),r}deleteProperty(t,i){const a=to(t,i);t[i];const d=Reflect.deleteProperty(t,i);return d&&a&&Au(t,"delete",i,void 0),d}has(t,i){const a=Reflect.has(t,i);return(!oc(i)||!rL.has(i))&&Ns(t,"has",i),a}ownKeys(t){return Ns(t,"iterate",ln(t)?"length":Tf),Reflect.ownKeys(t)}}class o6 extends oL{constructor(t=!1){super(!0,t)}set(t,i){return!0}deleteProperty(t,i){return!0}}const i6=new iL,s6=new o6,a6=new iL(!0),RS=e=>e,mb=e=>Reflect.getPrototypeOf(e);function l6(e,t,i){return function(...a){const d=this.__v_raw,p=wo(d),_=mm(p),r=e==="entries"||e===Symbol.iterator&&_,S=e==="keys"&&_,C=d[e](...a),M=i?RS:t?OS:Bs;return!t&&Ns(p,"iterate",S?PS:Tf),{next(){const{value:k,done:z}=C.next();return z?{value:k,done:z}:{value:r?[M(k[0]),M(k[1])]:M(k),done:z}},[Symbol.iterator](){return this}}}}function gb(e){return function(...t){return e==="delete"?!1:e==="clear"?void 0:this}}function c6(e,t){const i={get(d){const p=this.__v_raw,_=wo(p),r=wo(d);e||($d(d,r)&&Ns(_,"get",d),Ns(_,"get",r));const{has:S}=mb(_),C=t?RS:e?OS:Bs;if(S.call(_,d))return C(p.get(d));if(S.call(_,r))return C(p.get(r));p!==_&&p.get(d)},get size(){const d=this.__v_raw;return!e&&Ns(wo(d),"iterate",Tf),Reflect.get(d,"size",d)},has(d){const p=this.__v_raw,_=wo(p),r=wo(d);return e||($d(d,r)&&Ns(_,"has",d),Ns(_,"has",r)),d===r?p.has(d):p.has(d)||p.has(r)},forEach(d,p){const _=this,r=_.__v_raw,S=wo(r),C=t?RS:e?OS:Bs;return!e&&Ns(S,"iterate",Tf),r.forEach((M,k)=>d.call(p,C(M),C(k),_))}};return as(i,e?{add:gb("add"),set:gb("set"),delete:gb("delete"),clear:gb("clear")}:{add(d){!t&&!wl(d)&&!kf(d)&&(d=wo(d));const p=wo(this);return mb(p).has.call(p,d)||(p.add(d),Au(p,"add",d,d)),this},set(d,p){!t&&!wl(p)&&!kf(p)&&(p=wo(p));const _=wo(this),{has:r,get:S}=mb(_);let C=r.call(_,d);C||(d=wo(d),C=r.call(_,d));const M=S.call(_,d);return _.set(d,p),C?$d(p,M)&&Au(_,"set",d,p):Au(_,"add",d,p),this},delete(d){const p=wo(this),{has:_,get:r}=mb(p);let S=_.call(p,d);S||(d=wo(d),S=_.call(p,d)),r&&r.call(p,d);const C=p.delete(d);return S&&Au(p,"delete",d,void 0),C},clear(){const d=wo(this),p=d.size!==0,_=d.clear();return p&&Au(d,"clear",void 0,void 0),_}}),["keys","values","entries",Symbol.iterator].forEach(d=>{i[d]=l6(d,e,t)}),i}function yC(e,t){const i=c6(e,t);return(a,d,p)=>d==="__v_isReactive"?!e:d==="__v_isReadonly"?e:d==="__v_raw"?a:Reflect.get(to(i,d)&&d in a?i:a,d,p)}const u6={get:yC(!1,!1)},d6={get:yC(!1,!0)},h6={get:yC(!0,!1)},sL=new WeakMap,aL=new WeakMap,lL=new WeakMap,f6=new WeakMap;function p6(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function m6(e){return e.__v_skip||!Object.isExtensible(e)?0:p6(V$(e))}function lo(e){return kf(e)?e:bC(e,!1,i6,u6,sL)}function cL(e){return bC(e,!1,a6,d6,aL)}function Wm(e){return bC(e,!0,s6,h6,lL)}function bC(e,t,i,a,d){if(!yr(e)||e.__v_raw&&!(t&&e.__v_isReactive))return e;const p=d.get(e);if(p)return p;const _=m6(e);if(_===0)return e;const r=new Proxy(e,_===2?a:i);return d.set(e,r),r}function Lu(e){return kf(e)?Lu(e.__v_raw):!!(e&&e.__v_isReactive)}function kf(e){return!!(e&&e.__v_isReadonly)}function wl(e){return!!(e&&e.__v_isShallow)}function xC(e){return e?!!e.__v_raw:!1}function wo(e){const t=e&&e.__v_raw;return t?wo(t):e}function tc(e){return!to(e,"__v_skip")&&Object.isExtensible(e)&&jO(e,"__v_skip",!0),e}const Bs=e=>yr(e)?lo(e):e,OS=e=>yr(e)?Wm(e):e;function To(e){return e?e.__v_isRef===!0:!1}function Se(e){return uL(e,!1)}function Uo(e){return uL(e,!0)}function uL(e,t){return To(e)?e:new g6(e,t)}class g6{constructor(t,i){this.dep=new q1,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=i?t:wo(t),this._value=i?t:Bs(t),this.__v_isShallow=i}get value(){return this.dep.track(),this._value}set value(t){const i=this._rawValue,a=this.__v_isShallow||wl(t)||kf(t);t=a?t:wo(t),$d(t,i)&&(this._rawValue=t,this._value=a?t:Bs(t),this.dep.trigger())}}function b(e){return To(e)?e.value:e}const v6={get:(e,t,i)=>t==="__v_raw"?e:b(Reflect.get(e,t,i)),set:(e,t,i,a)=>{const d=e[t];return To(d)&&!To(i)?(d.value=i,!0):Reflect.set(e,t,i,a)}};function dL(e){return Lu(e)?e:new Proxy(e,v6)}class _6{constructor(t){this.__v_isRef=!0,this._value=void 0;const i=this.dep=new q1,{get:a,set:d}=t(i.track.bind(i),i.trigger.bind(i));this._get=a,this._set=d}get value(){return this._value=this._get()}set value(t){this._set(t)}}function y6(e){return new _6(e)}function Zi(e){const t=ln(e)?new Array(e.length):{};for(const i in e)t[i]=hL(e,i);return t}class b6{constructor(t,i,a){this._object=t,this._key=i,this._defaultValue=a,this.__v_isRef=!0,this._value=void 0}get value(){const t=this._object[this._key];return this._value=t===void 0?this._defaultValue:t}set value(t){this._object[this._key]=t}get dep(){return Q$(wo(this._object),this._key)}}class x6{constructor(t){this._getter=t,this.__v_isRef=!0,this.__v_isReadonly=!0,this._value=void 0}get value(){return this._value=this._getter()}}function po(e,t,i){return To(e)?e:Nn(e)?new x6(e):yr(e)&&arguments.length>1?hL(e,t,i):Se(e)}function hL(e,t,i){const a=e[t];return To(a)?a:new b6(e,t,i)}class w6{constructor(t,i,a){this.fn=t,this.setter=i,this._value=void 0,this.dep=new q1(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=z_-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!i,this.isSSR=a}notify(){if(this.flags|=16,!(this.flags&8)&&vi!==this)return XO(this,!0),!0}get value(){const t=this.dep.track();return eL(this),t&&(t.version=this.dep.version),this._value}set value(t){this.setter&&this.setter(t)}}function S6(e,t,i=!1){let a,d;return Nn(e)?a=e:(a=e.get,d=e.set),new w6(a,d,i)}const vb={},c1=new WeakMap;let pf;function T6(e,t=!1,i=pf){if(i){let a=c1.get(i);a||c1.set(i,a=[]),a.push(e)}}function C6(e,t,i=ci){const{immediate:a,deep:d,once:p,scheduler:_,augmentJob:r,call:S}=i,C=q=>d?q:wl(q)||d===!1||d===0?ku(q,1):ku(q);let M,k,z,F,B=!1,N=!1;if(To(e)?(k=()=>e.value,B=wl(e)):Lu(e)?(k=()=>C(e),B=!0):ln(e)?(N=!0,B=e.some(q=>Lu(q)||wl(q)),k=()=>e.map(q=>{if(To(q))return q.value;if(Lu(q))return C(q);if(Nn(q))return S?S(q,2):q()})):Nn(e)?t?k=S?()=>S(e,2):e:k=()=>{if(z){Qd();try{z()}finally{eh()}}const q=pf;pf=M;try{return S?S(e,3,[F]):e(F)}finally{pf=q}}:k=_o,t&&d){const q=k,J=d===!0?1/0:d;k=()=>ku(q(),J)}const j=pC(),U=()=>{M.stop(),j&&j.active&&dC(j.effects,M)};if(p&&t){const q=t;t=(...J)=>{q(...J),U()}}let te=N?new Array(e.length).fill(vb):vb;const Y=q=>{if(!(!(M.flags&1)||!M.dirty&&!q))if(t){const J=M.run();if(d||B||(N?J.some((ne,se)=>$d(ne,te[se])):$d(J,te))){z&&z();const ne=pf;pf=M;try{const se=[J,te===vb?void 0:N&&te[0]===vb?[]:te,F];S?S(t,3,se):t(...se),te=J}finally{pf=ne}}}else M.run()};return r&&r(Y),M=new ZO(k),M.scheduler=_?()=>_(Y,!1):Y,F=q=>T6(q,!1,M),z=M.onStop=()=>{const q=c1.get(M);if(q){if(S)S(q,4);else for(const J of q)J();c1.delete(M)}},t?a?Y(!0):te=M.run():_?_(Y.bind(null,!0),!0):M.run(),U.pause=M.pause.bind(M),U.resume=M.resume.bind(M),U.stop=U,U}function ku(e,t=1/0,i){if(t<=0||!yr(e)||e.__v_skip||(i=i||new Set,i.has(e)))return e;if(i.add(e),t--,To(e))ku(e.value,t,i);else if(ln(e))for(let a=0;a<e.length;a++)ku(e[a],t,i);else if(H1(e)||mm(e))e.forEach(a=>{ku(a,t,i)});else if(D_(e)){for(const a in e)ku(e[a],t,i);for(const a of Object.getOwnPropertySymbols(e))Object.prototype.propertyIsEnumerable.call(e,a)&&ku(e[a],t,i)}return e}/**
* @vue/runtime-core v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function hy(e,t,i,a){try{return a?e(...a):e()}catch(d){Z1(d,t,i)}}function ic(e,t,i,a){if(Nn(e)){const d=hy(e,t,i,a);return d&&L_(d)&&d.catch(p=>{Z1(p,t,i)}),d}if(ln(e)){const d=[];for(let p=0;p<e.length;p++)d.push(ic(e[p],t,i,a));return d}}function Z1(e,t,i,a=!0){const d=t?t.vnode:null,{errorHandler:p,throwUnhandledErrorInProduction:_}=t&&t.appContext.config||ci;if(t){let r=t.parent;const S=t.proxy,C=`https://vuejs.org/error-reference/#runtime-${i}`;for(;r;){const M=r.ec;if(M){for(let k=0;k<M.length;k++)if(M[k](e,S,C)===!1)return}r=r.parent}if(p){Qd(),hy(p,null,10,[e,S,C]),eh();return}}E6(e,i,d,a,_)}function E6(e,t,i,a=!0,d=!1){if(d)throw e;console.error(e)}const ia=[];let zc=-1;const gm=[];let Ld=null,im=0;const fL=Promise.resolve();let u1=null;function Vn(e){const t=u1||fL;return e?t.then(this?e.bind(this):e):t}function M6(e){let t=zc+1,i=ia.length;for(;t<i;){const a=t+i>>>1,d=ia[a],p=N_(d);p<e||p===e&&d.flags&2?t=a+1:i=a}return t}function wC(e){if(!(e.flags&1)){const t=N_(e),i=ia[ia.length-1];!i||!(e.flags&2)&&t>=N_(i)?ia.push(e):ia.splice(M6(t),0,e),e.flags|=1,pL()}}function pL(){u1||(u1=fL.then(gL))}function I6(e){ln(e)?gm.push(...e):Ld&&e.id===-1?Ld.splice(im+1,0,e):e.flags&1||(gm.push(e),e.flags|=1),pL()}function eP(e,t,i=zc+1){for(;i<ia.length;i++){const a=ia[i];if(a&&a.flags&2){if(e&&a.id!==e.uid)continue;ia.splice(i,1),i--,a.flags&4&&(a.flags&=-2),a(),a.flags&4||(a.flags&=-2)}}}function mL(e){if(gm.length){const t=[...new Set(gm)].sort((i,a)=>N_(i)-N_(a));if(gm.length=0,Ld){Ld.push(...t);return}for(Ld=t,im=0;im<Ld.length;im++){const i=Ld[im];i.flags&4&&(i.flags&=-2),i.flags&8||i(),i.flags&=-2}Ld=null,im=0}}const N_=e=>e.id==null?e.flags&2?-1:1/0:e.id;function gL(e){try{for(zc=0;zc<ia.length;zc++){const t=ia[zc];t&&!(t.flags&8)&&(t.flags&4&&(t.flags&=-2),hy(t,t.i,t.i?15:14),t.flags&4||(t.flags&=-2))}}finally{for(;zc<ia.length;zc++){const t=ia[zc];t&&(t.flags&=-2)}zc=-1,ia.length=0,mL(),u1=null,(ia.length||gm.length)&&gL()}}let is=null,vL=null;function d1(e){const t=is;return is=e,vL=e&&e.type.__scopeId||null,t}function st(e,t=is,i){if(!t||e._n)return e;const a=(...d)=>{a._d&&pP(-1);const p=d1(t);let _;try{_=e(...d)}finally{d1(p),a._d&&pP(1)}return _};return a._n=!0,a._c=!0,a._d=!0,a}function hr(e,t){if(is===null)return e;const i=ex(is),a=e.dirs||(e.dirs=[]);for(let d=0;d<t.length;d++){let[p,_,r,S=ci]=t[d];p&&(Nn(p)&&(p={mounted:p,updated:p}),p.deep&&ku(_),a.push({dir:p,instance:i,value:_,oldValue:void 0,arg:r,modifiers:S}))}return e}function cf(e,t,i,a){const d=e.dirs,p=t&&t.dirs;for(let _=0;_<d.length;_++){const r=d[_];p&&(r.oldValue=p[_].value);let S=r.dir[a];S&&(Qd(),ic(S,i,8,[e.el,r,e,t]),eh())}}const _L=Symbol("_vte"),yL=e=>e.__isTeleport,x_=e=>e&&(e.disabled||e.disabled===""),tP=e=>e&&(e.defer||e.defer===""),nP=e=>typeof SVGElement<"u"&&e instanceof SVGElement,rP=e=>typeof MathMLElement=="function"&&e instanceof MathMLElement,LS=(e,t)=>{const i=e&&e.to;return Dn(i)?t?t(i):null:i},bL={name:"Teleport",__isTeleport:!0,process(e,t,i,a,d,p,_,r,S,C){const{mc:M,pc:k,pbc:z,o:{insert:F,querySelector:B,createText:N,createComment:j}}=C,U=x_(t.props);let{shapeFlag:te,children:Y,dynamicChildren:q}=t;if(e==null){const J=t.el=N(""),ne=t.anchor=N("");F(J,i,a),F(ne,i,a);const se=(ce,le)=>{te&16&&(d&&d.isCE&&(d.ce._teleportTarget=ce),M(Y,ce,le,d,p,_,r,S))},fe=()=>{const ce=t.target=LS(t.props,B),le=xL(ce,t,N,F);ce&&(_!=="svg"&&nP(ce)?_="svg":_!=="mathml"&&rP(ce)&&(_="mathml"),U||(se(ce,le),Ub(t,!1)))};U&&(se(i,ne),Ub(t,!0)),tP(t.props)?ra(()=>{fe(),t.el.__isMounted=!0},p):fe()}else{if(tP(t.props)&&!e.el.__isMounted){ra(()=>{bL.process(e,t,i,a,d,p,_,r,S,C),delete e.el.__isMounted},p);return}t.el=e.el,t.targetStart=e.targetStart;const J=t.anchor=e.anchor,ne=t.target=e.target,se=t.targetAnchor=e.targetAnchor,fe=x_(e.props),ce=fe?i:ne,le=fe?J:se;if(_==="svg"||nP(ne)?_="svg":(_==="mathml"||rP(ne))&&(_="mathml"),q?(z(e.dynamicChildren,q,ce,d,p,_,r),IC(e,t,!0)):S||k(e,t,ce,le,d,p,_,r,!1),U)fe?t.props&&e.props&&t.props.to!==e.props.to&&(t.props.to=e.props.to):_b(t,i,J,C,1);else if((t.props&&t.props.to)!==(e.props&&e.props.to)){const ge=t.target=LS(t.props,B);ge&&_b(t,ge,null,C,0)}else fe&&_b(t,ne,se,C,1);Ub(t,U)}},remove(e,t,i,{um:a,o:{remove:d}},p){const{shapeFlag:_,children:r,anchor:S,targetStart:C,targetAnchor:M,target:k,props:z}=e;if(k&&(d(C),d(M)),p&&d(S),_&16){const F=p||!x_(z);for(let B=0;B<r.length;B++){const N=r[B];a(N,t,i,F,!!N.dynamicChildren)}}},move:_b,hydrate:A6};function _b(e,t,i,{o:{insert:a},m:d},p=2){p===0&&a(e.targetAnchor,t,i);const{el:_,anchor:r,shapeFlag:S,children:C,props:M}=e,k=p===2;if(k&&a(_,t,i),(!k||x_(M))&&S&16)for(let z=0;z<C.length;z++)d(C[z],t,i,2);k&&a(r,t,i)}function A6(e,t,i,a,d,p,{o:{nextSibling:_,parentNode:r,querySelector:S,insert:C,createText:M}},k){const z=t.target=LS(t.props,S);if(z){const F=x_(t.props),B=z._lpa||z.firstChild;if(t.shapeFlag&16)if(F)t.anchor=k(_(e),t,r(e),i,a,d,p),t.targetStart=B,t.targetAnchor=B&&_(B);else{t.anchor=_(e);let N=B;for(;N;){if(N&&N.nodeType===8){if(N.data==="teleport start anchor")t.targetStart=N;else if(N.data==="teleport anchor"){t.targetAnchor=N,z._lpa=t.targetAnchor&&_(t.targetAnchor);break}}N=_(N)}t.targetAnchor||xL(z,t,M,C),k(B&&_(B),t,z,i,a,d,p)}Ub(t,F)}return t.anchor&&_(t.anchor)}const k6=bL;function Ub(e,t){const i=e.ctx;if(i&&i.ut){let a,d;for(t?(a=e.el,d=e.anchor):(a=e.targetStart,d=e.targetAnchor);a&&a!==d;)a.nodeType===1&&a.setAttribute("data-v-owner",i.uid),a=a.nextSibling;i.ut()}}function xL(e,t,i,a){const d=t.targetStart=i(""),p=t.targetAnchor=i("");return d[_L]=p,e&&(a(d,e),a(p,e)),p}const Dd=Symbol("_leaveCb"),yb=Symbol("_enterCb");function wL(){const e={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return gr(()=>{e.isMounted=!0}),Oo(()=>{e.isUnmounting=!0}),e}const gl=[Function,Array],SL={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:gl,onEnter:gl,onAfterEnter:gl,onEnterCancelled:gl,onBeforeLeave:gl,onLeave:gl,onAfterLeave:gl,onLeaveCancelled:gl,onBeforeAppear:gl,onAppear:gl,onAfterAppear:gl,onAppearCancelled:gl},TL=e=>{const t=e.subTree;return t.component?TL(t.component):t},P6={name:"BaseTransition",props:SL,setup(e,{slots:t}){const i=wr(),a=wL();return()=>{const d=t.default&&SC(t.default(),!0);if(!d||!d.length)return;const p=CL(d),_=wo(e),{mode:r}=_;if(a.isLeaving)return U2(p);const S=oP(p);if(!S)return U2(p);let C=B_(S,_,a,i,k=>C=k);S.type!==os&&Pf(S,C);let M=i.subTree&&oP(i.subTree);if(M&&M.type!==os&&!mf(S,M)&&TL(i).type!==os){let k=B_(M,_,a,i);if(Pf(M,k),r==="out-in"&&S.type!==os)return a.isLeaving=!0,k.afterLeave=()=>{a.isLeaving=!1,i.job.flags&8||i.update(),delete k.afterLeave,M=void 0},U2(p);r==="in-out"&&S.type!==os?k.delayLeave=(z,F,B)=>{const N=EL(a,M);N[String(M.key)]=M,z[Dd]=()=>{F(),z[Dd]=void 0,delete C.delayedLeave,M=void 0},C.delayedLeave=()=>{B(),delete C.delayedLeave,M=void 0}}:M=void 0}else M&&(M=void 0);return p}}};function CL(e){let t=e[0];if(e.length>1){for(const i of e)if(i.type!==os){t=i;break}}return t}const R6=P6;function EL(e,t){const{leavingVNodes:i}=e;let a=i.get(t.type);return a||(a=Object.create(null),i.set(t.type,a)),a}function B_(e,t,i,a,d){const{appear:p,mode:_,persisted:r=!1,onBeforeEnter:S,onEnter:C,onAfterEnter:M,onEnterCancelled:k,onBeforeLeave:z,onLeave:F,onAfterLeave:B,onLeaveCancelled:N,onBeforeAppear:j,onAppear:U,onAfterAppear:te,onAppearCancelled:Y}=t,q=String(e.key),J=EL(i,e),ne=(ce,le)=>{ce&&ic(ce,a,9,le)},se=(ce,le)=>{const ge=le[1];ne(ce,le),ln(ce)?ce.every(de=>de.length<=1)&&ge():ce.length<=1&&ge()},fe={mode:_,persisted:r,beforeEnter(ce){let le=S;if(!i.isMounted)if(p)le=j||S;else return;ce[Dd]&&ce[Dd](!0);const ge=J[q];ge&&mf(e,ge)&&ge.el[Dd]&&ge.el[Dd](),ne(le,[ce])},enter(ce){let le=C,ge=M,de=k;if(!i.isMounted)if(p)le=U||C,ge=te||M,de=Y||k;else return;let ke=!1;const We=ce[yb]=we=>{ke||(ke=!0,we?ne(de,[ce]):ne(ge,[ce]),fe.delayedLeave&&fe.delayedLeave(),ce[yb]=void 0)};le?se(le,[ce,We]):We()},leave(ce,le){const ge=String(e.key);if(ce[yb]&&ce[yb](!0),i.isUnmounting)return le();ne(z,[ce]);let de=!1;const ke=ce[Dd]=We=>{de||(de=!0,le(),We?ne(N,[ce]):ne(B,[ce]),ce[Dd]=void 0,J[ge]===e&&delete J[ge])};J[ge]=e,F?se(F,[ce,ke]):ke()},clone(ce){const le=B_(ce,t,i,a,d);return d&&d(le),le}};return fe}function U2(e){if(Y1(e))return e=zu(e),e.children=null,e}function oP(e){if(!Y1(e))return yL(e.type)&&e.children?CL(e.children):e;const{shapeFlag:t,children:i}=e;if(i){if(t&16)return i[0];if(t&32&&Nn(i.default))return i.default()}}function Pf(e,t){e.shapeFlag&6&&e.component?(e.transition=t,Pf(e.component.subTree,t)):e.shapeFlag&128?(e.ssContent.transition=t.clone(e.ssContent),e.ssFallback.transition=t.clone(e.ssFallback)):e.transition=t}function SC(e,t=!1,i){let a=[],d=0;for(let p=0;p<e.length;p++){let _=e[p];const r=i==null?_.key:String(i)+String(_.key!=null?_.key:p);_.type===Bn?(_.patchFlag&128&&d++,a=a.concat(SC(_.children,t,r))):(t||_.type!==os)&&a.push(r!=null?zu(_,{key:r}):_)}if(d>1)for(let p=0;p<a.length;p++)a[p].patchFlag=-2;return a}/*! #__NO_SIDE_EFFECTS__ */function qe(e,t){return Nn(e)?as({name:e.name},t,{setup:e}):e}function ML(e){e.ids=[e.ids[0]+e.ids[2]+++"-",0,0]}function h1(e,t,i,a,d=!1){if(ln(e)){e.forEach((B,N)=>h1(B,t&&(ln(t)?t[N]:t),i,a,d));return}if(vm(a)&&!d){a.shapeFlag&512&&a.type.__asyncResolved&&a.component.subTree.component&&h1(e,t,i,a.component.subTree);return}const p=a.shapeFlag&4?ex(a.component):a.el,_=d?null:p,{i:r,r:S}=e,C=t&&t.r,M=r.refs===ci?r.refs={}:r.refs,k=r.setupState,z=wo(k),F=k===ci?()=>!1:B=>to(z,B);if(C!=null&&C!==S&&(Dn(C)?(M[C]=null,F(C)&&(k[C]=null)):To(C)&&(C.value=null)),Nn(S))hy(S,r,12,[_,M]);else{const B=Dn(S),N=To(S);if(B||N){const j=()=>{if(e.f){const U=B?F(S)?k[S]:M[S]:S.value;d?ln(U)&&dC(U,p):ln(U)?U.includes(p)||U.push(p):B?(M[S]=[p],F(S)&&(k[S]=M[S])):(S.value=[p],e.k&&(M[e.k]=S.value))}else B?(M[S]=_,F(S)&&(k[S]=_)):N&&(S.value=_,e.k&&(M[e.k]=_))};_?(j.id=-1,ra(j,i)):j()}}}W1().requestIdleCallback;W1().cancelIdleCallback;const vm=e=>!!e.type.__asyncLoader,Y1=e=>e.type.__isKeepAlive;function TC(e,t){AL(e,"a",t)}function IL(e,t){AL(e,"da",t)}function AL(e,t,i=ps){const a=e.__wdc||(e.__wdc=()=>{let d=i;for(;d;){if(d.isDeactivated)return;d=d.parent}return e()});if(X1(t,a,i),i){let d=i.parent;for(;d&&d.parent;)Y1(d.parent.vnode)&&O6(a,t,i,d),d=d.parent}}function O6(e,t,i,a){const d=X1(t,e,a,!0);th(()=>{dC(a[t],d)},i)}function X1(e,t,i=ps,a=!1){if(i){const d=i[e]||(i[e]=[]),p=t.__weh||(t.__weh=(..._)=>{Qd();const r=py(i),S=ic(t,i,e,_);return r(),eh(),S});return a?d.unshift(p):d.push(p),p}}const $u=e=>(t,i=ps)=>{(!$_||e==="sp")&&X1(e,(...a)=>t(...a),i)},fy=$u("bm"),gr=$u("m"),kL=$u("bu"),hc=$u("u"),Oo=$u("bum"),th=$u("um"),L6=$u("sp"),D6=$u("rtg"),z6=$u("rtc");function F6(e,t=ps){X1("ec",e,t)}const CC="components",N6="directives";function Er(e,t){return EC(CC,e,!0,t)||e}const PL=Symbol.for("v-ndc");function Tr(e){return Dn(e)?EC(CC,e,!1)||e:e||PL}function J1(e){return EC(N6,e)}function EC(e,t,i=!0,a=!1){const d=is||ps;if(d){const p=d.type;if(e===CC){const r=S8(p,!1);if(r&&(r===t||r===da(t)||r===dy(da(t))))return p}const _=iP(d[e]||p[e],t)||iP(d.appContext[e],t);return!_&&a?p:_}}function iP(e,t){return e&&(e[t]||e[da(t)]||e[dy(da(t))])}function Or(e,t,i,a){let d;const p=i,_=ln(e);if(_||Dn(e)){const r=_&&Lu(e);let S=!1;r&&(S=!wl(e),e=K1(e)),d=new Array(e.length);for(let C=0,M=e.length;C<M;C++)d[C]=t(S?Bs(e[C]):e[C],C,void 0,p)}else if(typeof e=="number"){d=new Array(e);for(let r=0;r<e;r++)d[r]=t(r+1,r,void 0,p)}else if(yr(e))if(e[Symbol.iterator])d=Array.from(e,(r,S)=>t(r,S,void 0,p));else{const r=Object.keys(e);d=new Array(r.length);for(let S=0,C=r.length;S<C;S++){const M=r[S];d[S]=t(e[M],M,S,p)}}else d=[];return d}function Ya(e,t){for(let i=0;i<t.length;i++){const a=t[i];if(ln(a))for(let d=0;d<a.length;d++)e[a[d].name]=a[d].fn;else a&&(e[a.name]=a.key?(...d)=>{const p=a.fn(...d);return p&&(p.key=a.key),p}:a.fn)}return e}function pt(e,t,i={},a,d){if(is.ce||is.parent&&vm(is.parent)&&is.parent.ce)return t!=="default"&&(i.name=t),ae(),kt(Bn,null,[Ze("slot",i,a&&a())],64);let p=e[t];p&&p._c&&(p._d=!1),ae();const _=p&&RL(p(i)),r=i.key||_&&_.key,S=kt(Bn,{key:(r&&!oc(r)?r:`_${t}`)+(!_&&a?"_fb":"")},_||(a?a():[]),_&&e._===1?64:-2);return S.scopeId&&(S.slotScopeIds=[S.scopeId+"-s"]),p&&p._c&&(p._d=!0),S}function RL(e){return e.some(t=>Ho(t)?!(t.type===os||t.type===Bn&&!RL(t.children)):!0)?e:null}function B6(e,t){const i={};for(const a in e)i[__(a)]=e[a];return i}const DS=e=>e?JL(e)?ex(e):DS(e.parent):null,w_=as(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>e.props,$attrs:e=>e.attrs,$slots:e=>e.slots,$refs:e=>e.refs,$parent:e=>DS(e.parent),$root:e=>DS(e.root),$host:e=>e.ce,$emit:e=>e.emit,$options:e=>DL(e),$forceUpdate:e=>e.f||(e.f=()=>{wC(e.update)}),$nextTick:e=>e.n||(e.n=Vn.bind(e.proxy)),$watch:e=>a8.bind(e)}),j2=(e,t)=>e!==ci&&!e.__isScriptSetup&&to(e,t),V6={get({_:e},t){if(t==="__v_skip")return!0;const{ctx:i,setupState:a,data:d,props:p,accessCache:_,type:r,appContext:S}=e;let C;if(t[0]!=="$"){const F=_[t];if(F!==void 0)switch(F){case 1:return a[t];case 2:return d[t];case 4:return i[t];case 3:return p[t]}else{if(j2(a,t))return _[t]=1,a[t];if(d!==ci&&to(d,t))return _[t]=2,d[t];if((C=e.propsOptions[0])&&to(C,t))return _[t]=3,p[t];if(i!==ci&&to(i,t))return _[t]=4,i[t];zS&&(_[t]=0)}}const M=w_[t];let k,z;if(M)return t==="$attrs"&&Ns(e.attrs,"get",""),M(e);if((k=r.__cssModules)&&(k=k[t]))return k;if(i!==ci&&to(i,t))return _[t]=4,i[t];if(z=S.config.globalProperties,to(z,t))return z[t]},set({_:e},t,i){const{data:a,setupState:d,ctx:p}=e;return j2(d,t)?(d[t]=i,!0):a!==ci&&to(a,t)?(a[t]=i,!0):to(e.props,t)||t[0]==="$"&&t.slice(1)in e?!1:(p[t]=i,!0)},has({_:{data:e,setupState:t,accessCache:i,ctx:a,appContext:d,propsOptions:p}},_){let r;return!!i[_]||e!==ci&&to(e,_)||j2(t,_)||(r=p[0])&&to(r,_)||to(a,_)||to(w_,_)||to(d.config.globalProperties,_)},defineProperty(e,t,i){return i.get!=null?e._.accessCache[t]=0:to(i,"value")&&this.set(e,t,i.value,null),Reflect.defineProperty(e,t,i)}};function Hi(){return OL().slots}function Uu(){return OL().attrs}function OL(){const e=wr();return e.setupContext||(e.setupContext=eD(e))}function sP(e){return ln(e)?e.reduce((t,i)=>(t[i]=null,t),{}):e}let zS=!0;function $6(e){const t=DL(e),i=e.proxy,a=e.ctx;zS=!1,t.beforeCreate&&aP(t.beforeCreate,e,"bc");const{data:d,computed:p,methods:_,watch:r,provide:S,inject:C,created:M,beforeMount:k,mounted:z,beforeUpdate:F,updated:B,activated:N,deactivated:j,beforeDestroy:U,beforeUnmount:te,destroyed:Y,unmounted:q,render:J,renderTracked:ne,renderTriggered:se,errorCaptured:fe,serverPrefetch:ce,expose:le,inheritAttrs:ge,components:de,directives:ke,filters:We}=t;if(C&&U6(C,a,null),_)for(const Me in _){const Ae=_[Me];Nn(Ae)&&(a[Me]=Ae.bind(i))}if(d){const Me=d.call(i,i);yr(Me)&&(e.data=lo(Me))}if(zS=!0,p)for(const Me in p){const Ae=p[Me],me=Nn(Ae)?Ae.bind(i,i):Nn(Ae.get)?Ae.get.bind(i,i):_o,Be=!Nn(Ae)&&Nn(Ae.set)?Ae.set.bind(i):_o,Ve=ee({get:me,set:Be});Object.defineProperty(a,Me,{enumerable:!0,configurable:!0,get:()=>Ve.value,set:bt=>Ve.value=bt})}if(r)for(const Me in r)LL(r[Me],a,i,Me);if(S){const Me=Nn(S)?S.call(i):S;Reflect.ownKeys(Me).forEach(Ae=>{Dr(Ae,Me[Ae])})}M&&aP(M,e,"c");function be(Me,Ae){ln(Ae)?Ae.forEach(me=>Me(me.bind(i))):Ae&&Me(Ae.bind(i))}if(be(fy,k),be(gr,z),be(kL,F),be(hc,B),be(TC,N),be(IL,j),be(F6,fe),be(z6,ne),be(D6,se),be(Oo,te),be(th,q),be(L6,ce),ln(le))if(le.length){const Me=e.exposed||(e.exposed={});le.forEach(Ae=>{Object.defineProperty(Me,Ae,{get:()=>i[Ae],set:me=>i[Ae]=me})})}else e.exposed||(e.exposed={});J&&e.render===_o&&(e.render=J),ge!=null&&(e.inheritAttrs=ge),de&&(e.components=de),ke&&(e.directives=ke),ce&&ML(e)}function U6(e,t,i=_o){ln(e)&&(e=FS(e));for(const a in e){const d=e[a];let p;yr(d)?"default"in d?p=An(d.from||a,d.default,!0):p=An(d.from||a):p=An(d),To(p)?Object.defineProperty(t,a,{enumerable:!0,configurable:!0,get:()=>p.value,set:_=>p.value=_}):t[a]=p}}function aP(e,t,i){ic(ln(e)?e.map(a=>a.bind(t.proxy)):e.bind(t.proxy),t,i)}function LL(e,t,i,a){let d=a.includes(".")?qL(i,a):()=>i[a];if(Dn(e)){const p=t[e];Nn(p)&&qt(d,p)}else if(Nn(e))qt(d,e.bind(i));else if(yr(e))if(ln(e))e.forEach(p=>LL(p,t,i,a));else{const p=Nn(e.handler)?e.handler.bind(i):t[e.handler];Nn(p)&&qt(d,p,e)}}function DL(e){const t=e.type,{mixins:i,extends:a}=t,{mixins:d,optionsCache:p,config:{optionMergeStrategies:_}}=e.appContext,r=p.get(t);let S;return r?S=r:!d.length&&!i&&!a?S=t:(S={},d.length&&d.forEach(C=>f1(S,C,_,!0)),f1(S,t,_)),yr(t)&&p.set(t,S),S}function f1(e,t,i,a=!1){const{mixins:d,extends:p}=t;p&&f1(e,p,i,!0),d&&d.forEach(_=>f1(e,_,i,!0));for(const _ in t)if(!(a&&_==="expose")){const r=j6[_]||i&&i[_];e[_]=r?r(e[_],t[_]):t[_]}return e}const j6={data:lP,props:cP,emits:cP,methods:f_,computed:f_,beforeCreate:ta,created:ta,beforeMount:ta,mounted:ta,beforeUpdate:ta,updated:ta,beforeDestroy:ta,beforeUnmount:ta,destroyed:ta,unmounted:ta,activated:ta,deactivated:ta,errorCaptured:ta,serverPrefetch:ta,components:f_,directives:f_,watch:G6,provide:lP,inject:H6};function lP(e,t){return t?e?function(){return as(Nn(e)?e.call(this,this):e,Nn(t)?t.call(this,this):t)}:t:e}function H6(e,t){return f_(FS(e),FS(t))}function FS(e){if(ln(e)){const t={};for(let i=0;i<e.length;i++)t[e[i]]=e[i];return t}return e}function ta(e,t){return e?[...new Set([].concat(e,t))]:t}function f_(e,t){return e?as(Object.create(null),e,t):t}function cP(e,t){return e?ln(e)&&ln(t)?[...new Set([...e,...t])]:as(Object.create(null),sP(e),sP(t??{})):t}function G6(e,t){if(!e)return t;if(!t)return e;const i=as(Object.create(null),e);for(const a in t)i[a]=ta(e[a],t[a]);return i}function zL(){return{app:null,config:{isNativeTag:N$,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let W6=0;function q6(e,t){return function(a,d=null){Nn(a)||(a=as({},a)),d!=null&&!yr(d)&&(d=null);const p=zL(),_=new WeakSet,r=[];let S=!1;const C=p.app={_uid:W6++,_component:a,_props:d,_container:null,_context:p,_instance:null,version:C8,get config(){return p.config},set config(M){},use(M,...k){return _.has(M)||(M&&Nn(M.install)?(_.add(M),M.install(C,...k)):Nn(M)&&(_.add(M),M(C,...k))),C},mixin(M){return p.mixins.includes(M)||p.mixins.push(M),C},component(M,k){return k?(p.components[M]=k,C):p.components[M]},directive(M,k){return k?(p.directives[M]=k,C):p.directives[M]},mount(M,k,z){if(!S){const F=C._ceVNode||Ze(a,d);return F.appContext=p,z===!0?z="svg":z===!1&&(z=void 0),e(F,M,z),S=!0,C._container=M,M.__vue_app__=C,ex(F.component)}},onUnmount(M){r.push(M)},unmount(){S&&(ic(r,C._instance,16),e(null,C._container),delete C._container.__vue_app__)},provide(M,k){return p.provides[M]=k,C},runWithContext(M){const k=Cf;Cf=C;try{return M()}finally{Cf=k}}};return C}}let Cf=null;function Dr(e,t){if(ps){let i=ps.provides;const a=ps.parent&&ps.parent.provides;a===i&&(i=ps.provides=Object.create(a)),i[e]=t}}function An(e,t,i=!1){const a=ps||is;if(a||Cf){const d=Cf?Cf._context.provides:a?a.parent==null?a.vnode.appContext&&a.vnode.appContext.provides:a.parent.provides:void 0;if(d&&e in d)return d[e];if(arguments.length>1)return i&&Nn(t)?t.call(a&&a.proxy):t}}function K6(){return!!(ps||is||Cf)}const FL={},NL=()=>Object.create(FL),BL=e=>Object.getPrototypeOf(e)===FL;function Z6(e,t,i,a=!1){const d={},p=NL();e.propsDefaults=Object.create(null),VL(e,t,d,p);for(const _ in e.propsOptions[0])_ in d||(d[_]=void 0);i?e.props=a?d:cL(d):e.type.props?e.props=d:e.props=p,e.attrs=p}function Y6(e,t,i,a){const{props:d,attrs:p,vnode:{patchFlag:_}}=e,r=wo(d),[S]=e.propsOptions;let C=!1;if((a||_>0)&&!(_&16)){if(_&8){const M=e.vnode.dynamicProps;for(let k=0;k<M.length;k++){let z=M[k];if(Q1(e.emitsOptions,z))continue;const F=t[z];if(S)if(to(p,z))F!==p[z]&&(p[z]=F,C=!0);else{const B=da(z);d[B]=NS(S,r,B,F,e,!1)}else F!==p[z]&&(p[z]=F,C=!0)}}}else{VL(e,t,d,p)&&(C=!0);let M;for(const k in r)(!t||!to(t,k)&&((M=Vu(k))===k||!to(t,M)))&&(S?i&&(i[k]!==void 0||i[M]!==void 0)&&(d[k]=NS(S,r,k,void 0,e,!0)):delete d[k]);if(p!==r)for(const k in p)(!t||!to(t,k))&&(delete p[k],C=!0)}C&&Au(e.attrs,"set","")}function VL(e,t,i,a){const[d,p]=e.propsOptions;let _=!1,r;if(t)for(let S in t){if(v_(S))continue;const C=t[S];let M;d&&to(d,M=da(S))?!p||!p.includes(M)?i[M]=C:(r||(r={}))[M]=C:Q1(e.emitsOptions,S)||(!(S in a)||C!==a[S])&&(a[S]=C,_=!0)}if(p){const S=wo(i),C=r||ci;for(let M=0;M<p.length;M++){const k=p[M];i[k]=NS(d,S,k,C[k],e,!to(C,k))}}return _}function NS(e,t,i,a,d,p){const _=e[i];if(_!=null){const r=to(_,"default");if(r&&a===void 0){const S=_.default;if(_.type!==Function&&!_.skipFactory&&Nn(S)){const{propsDefaults:C}=d;if(i in C)a=C[i];else{const M=py(d);a=C[i]=S.call(null,t),M()}}else a=S;d.ce&&d.ce._setProp(i,a)}_[0]&&(p&&!r?a=!1:_[1]&&(a===""||a===Vu(i))&&(a=!0))}return a}const X6=new WeakMap;function $L(e,t,i=!1){const a=i?X6:t.propsCache,d=a.get(e);if(d)return d;const p=e.props,_={},r=[];let S=!1;if(!Nn(e)){const M=k=>{S=!0;const[z,F]=$L(k,t,!0);as(_,z),F&&r.push(...F)};!i&&t.mixins.length&&t.mixins.forEach(M),e.extends&&M(e.extends),e.mixins&&e.mixins.forEach(M)}if(!p&&!S)return yr(e)&&a.set(e,pm),pm;if(ln(p))for(let M=0;M<p.length;M++){const k=da(p[M]);uP(k)&&(_[k]=ci)}else if(p)for(const M in p){const k=da(M);if(uP(k)){const z=p[M],F=_[k]=ln(z)||Nn(z)?{type:z}:as({},z),B=F.type;let N=!1,j=!0;if(ln(B))for(let U=0;U<B.length;++U){const te=B[U],Y=Nn(te)&&te.name;if(Y==="Boolean"){N=!0;break}else Y==="String"&&(j=!1)}else N=Nn(B)&&B.name==="Boolean";F[0]=N,F[1]=j,(N||to(F,"default"))&&r.push(k)}}const C=[_,r];return yr(e)&&a.set(e,C),C}function uP(e){return e[0]!=="$"&&!v_(e)}const UL=e=>e[0]==="_"||e==="$stable",MC=e=>ln(e)?e.map(Fc):[Fc(e)],J6=(e,t,i)=>{if(t._n)return t;const a=st((...d)=>MC(t(...d)),i);return a._c=!1,a},jL=(e,t,i)=>{const a=e._ctx;for(const d in e){if(UL(d))continue;const p=e[d];if(Nn(p))t[d]=J6(d,p,a);else if(p!=null){const _=MC(p);t[d]=()=>_}}},HL=(e,t)=>{const i=MC(t);e.slots.default=()=>i},GL=(e,t,i)=>{for(const a in t)(i||a!=="_")&&(e[a]=t[a])},Q6=(e,t,i)=>{const a=e.slots=NL();if(e.vnode.shapeFlag&32){const d=t._;d?(GL(a,t,i),i&&jO(a,"_",d,!0)):jL(t,a)}else t&&HL(e,t)},e8=(e,t,i)=>{const{vnode:a,slots:d}=e;let p=!0,_=ci;if(a.shapeFlag&32){const r=t._;r?i&&r===1?p=!1:GL(d,t,i):(p=!t.$stable,jL(t,d)),_=t}else t&&(HL(e,t),_={default:1});if(p)for(const r in d)!UL(r)&&_[r]==null&&delete d[r]},ra=p8;function t8(e){return n8(e)}function n8(e,t){const i=W1();i.__VUE__=!0;const{insert:a,remove:d,patchProp:p,createElement:_,createText:r,createComment:S,setText:C,setElementText:M,parentNode:k,nextSibling:z,setScopeId:F=_o,insertStaticContent:B}=e,N=(Re,nt,Qe,Yt=null,Xt=null,$t=null,Ot=void 0,Ft=null,sn=!!nt.dynamicChildren)=>{if(Re===nt)return;Re&&!mf(Re,nt)&&(Yt=vt(Re),bt(Re,Xt,$t,!0),Re=null),nt.patchFlag===-2&&(sn=!1,nt.dynamicChildren=null);const{type:an,ref:Pn,shapeFlag:bn}=nt;switch(an){case qm:j(Re,nt,Qe,Yt);break;case os:U(Re,nt,Qe,Yt);break;case G2:Re==null&&te(nt,Qe,Yt,Ot);break;case Bn:de(Re,nt,Qe,Yt,Xt,$t,Ot,Ft,sn);break;default:bn&1?J(Re,nt,Qe,Yt,Xt,$t,Ot,Ft,sn):bn&6?ke(Re,nt,Qe,Yt,Xt,$t,Ot,Ft,sn):(bn&64||bn&128)&&an.process(Re,nt,Qe,Yt,Xt,$t,Ot,Ft,sn,Fe)}Pn!=null&&Xt&&h1(Pn,Re&&Re.ref,$t,nt||Re,!nt)},j=(Re,nt,Qe,Yt)=>{if(Re==null)a(nt.el=r(nt.children),Qe,Yt);else{const Xt=nt.el=Re.el;nt.children!==Re.children&&C(Xt,nt.children)}},U=(Re,nt,Qe,Yt)=>{Re==null?a(nt.el=S(nt.children||""),Qe,Yt):nt.el=Re.el},te=(Re,nt,Qe,Yt)=>{[Re.el,Re.anchor]=B(Re.children,nt,Qe,Yt,Re.el,Re.anchor)},Y=({el:Re,anchor:nt},Qe,Yt)=>{let Xt;for(;Re&&Re!==nt;)Xt=z(Re),a(Re,Qe,Yt),Re=Xt;a(nt,Qe,Yt)},q=({el:Re,anchor:nt})=>{let Qe;for(;Re&&Re!==nt;)Qe=z(Re),d(Re),Re=Qe;d(nt)},J=(Re,nt,Qe,Yt,Xt,$t,Ot,Ft,sn)=>{nt.type==="svg"?Ot="svg":nt.type==="math"&&(Ot="mathml"),Re==null?ne(nt,Qe,Yt,Xt,$t,Ot,Ft,sn):ce(Re,nt,Xt,$t,Ot,Ft,sn)},ne=(Re,nt,Qe,Yt,Xt,$t,Ot,Ft)=>{let sn,an;const{props:Pn,shapeFlag:bn,transition:It,dirs:Sn}=Re;if(sn=Re.el=_(Re.type,$t,Pn&&Pn.is,Pn),bn&8?M(sn,Re.children):bn&16&&fe(Re.children,sn,null,Yt,Xt,H2(Re,$t),Ot,Ft),Sn&&cf(Re,null,Yt,"created"),se(sn,Re,Re.scopeId,Ot,Yt),Pn){for(const vr in Pn)vr!=="value"&&!v_(vr)&&p(sn,vr,null,Pn[vr],$t,Yt);"value"in Pn&&p(sn,"value",null,Pn.value,$t),(an=Pn.onVnodeBeforeMount)&&Lc(an,Yt,Re)}Sn&&cf(Re,null,Yt,"beforeMount");const Yn=r8(Xt,It);Yn&&It.beforeEnter(sn),a(sn,nt,Qe),((an=Pn&&Pn.onVnodeMounted)||Yn||Sn)&&ra(()=>{an&&Lc(an,Yt,Re),Yn&&It.enter(sn),Sn&&cf(Re,null,Yt,"mounted")},Xt)},se=(Re,nt,Qe,Yt,Xt)=>{if(Qe&&F(Re,Qe),Yt)for(let $t=0;$t<Yt.length;$t++)F(Re,Yt[$t]);if(Xt){let $t=Xt.subTree;if(nt===$t||ZL($t.type)&&($t.ssContent===nt||$t.ssFallback===nt)){const Ot=Xt.vnode;se(Re,Ot,Ot.scopeId,Ot.slotScopeIds,Xt.parent)}}},fe=(Re,nt,Qe,Yt,Xt,$t,Ot,Ft,sn=0)=>{for(let an=sn;an<Re.length;an++){const Pn=Re[an]=Ft?zd(Re[an]):Fc(Re[an]);N(null,Pn,nt,Qe,Yt,Xt,$t,Ot,Ft)}},ce=(Re,nt,Qe,Yt,Xt,$t,Ot)=>{const Ft=nt.el=Re.el;let{patchFlag:sn,dynamicChildren:an,dirs:Pn}=nt;sn|=Re.patchFlag&16;const bn=Re.props||ci,It=nt.props||ci;let Sn;if(Qe&&uf(Qe,!1),(Sn=It.onVnodeBeforeUpdate)&&Lc(Sn,Qe,nt,Re),Pn&&cf(nt,Re,Qe,"beforeUpdate"),Qe&&uf(Qe,!0),(bn.innerHTML&&It.innerHTML==null||bn.textContent&&It.textContent==null)&&M(Ft,""),an?le(Re.dynamicChildren,an,Ft,Qe,Yt,H2(nt,Xt),$t):Ot||Ae(Re,nt,Ft,null,Qe,Yt,H2(nt,Xt),$t,!1),sn>0){if(sn&16)ge(Ft,bn,It,Qe,Xt);else if(sn&2&&bn.class!==It.class&&p(Ft,"class",null,It.class,Xt),sn&4&&p(Ft,"style",bn.style,It.style,Xt),sn&8){const Yn=nt.dynamicProps;for(let vr=0;vr<Yn.length;vr++){const tr=Yn[vr],zr=bn[tr],Cr=It[tr];(Cr!==zr||tr==="value")&&p(Ft,tr,zr,Cr,Xt,Qe)}}sn&1&&Re.children!==nt.children&&M(Ft,nt.children)}else!Ot&&an==null&&ge(Ft,bn,It,Qe,Xt);((Sn=It.onVnodeUpdated)||Pn)&&ra(()=>{Sn&&Lc(Sn,Qe,nt,Re),Pn&&cf(nt,Re,Qe,"updated")},Yt)},le=(Re,nt,Qe,Yt,Xt,$t,Ot)=>{for(let Ft=0;Ft<nt.length;Ft++){const sn=Re[Ft],an=nt[Ft],Pn=sn.el&&(sn.type===Bn||!mf(sn,an)||sn.shapeFlag&70)?k(sn.el):Qe;N(sn,an,Pn,null,Yt,Xt,$t,Ot,!0)}},ge=(Re,nt,Qe,Yt,Xt)=>{if(nt!==Qe){if(nt!==ci)for(const $t in nt)!v_($t)&&!($t in Qe)&&p(Re,$t,nt[$t],null,Xt,Yt);for(const $t in Qe){if(v_($t))continue;const Ot=Qe[$t],Ft=nt[$t];Ot!==Ft&&$t!=="value"&&p(Re,$t,Ft,Ot,Xt,Yt)}"value"in Qe&&p(Re,"value",nt.value,Qe.value,Xt)}},de=(Re,nt,Qe,Yt,Xt,$t,Ot,Ft,sn)=>{const an=nt.el=Re?Re.el:r(""),Pn=nt.anchor=Re?Re.anchor:r("");let{patchFlag:bn,dynamicChildren:It,slotScopeIds:Sn}=nt;Sn&&(Ft=Ft?Ft.concat(Sn):Sn),Re==null?(a(an,Qe,Yt),a(Pn,Qe,Yt),fe(nt.children||[],Qe,Pn,Xt,$t,Ot,Ft,sn)):bn>0&&bn&64&&It&&Re.dynamicChildren?(le(Re.dynamicChildren,It,Qe,Xt,$t,Ot,Ft),(nt.key!=null||Xt&&nt===Xt.subTree)&&IC(Re,nt,!0)):Ae(Re,nt,Qe,Pn,Xt,$t,Ot,Ft,sn)},ke=(Re,nt,Qe,Yt,Xt,$t,Ot,Ft,sn)=>{nt.slotScopeIds=Ft,Re==null?nt.shapeFlag&512?Xt.ctx.activate(nt,Qe,Yt,Ot,sn):We(nt,Qe,Yt,Xt,$t,Ot,sn):we(Re,nt,sn)},We=(Re,nt,Qe,Yt,Xt,$t,Ot)=>{const Ft=Re.component=y8(Re,Yt,Xt);if(Y1(Re)&&(Ft.ctx.renderer=Fe),b8(Ft,!1,Ot),Ft.asyncDep){if(Xt&&Xt.registerDep(Ft,be,Ot),!Re.el){const sn=Ft.subTree=Ze(os);U(null,sn,nt,Qe)}}else be(Ft,Re,nt,Qe,Xt,$t,Ot)},we=(Re,nt,Qe)=>{const Yt=nt.component=Re.component;if(h8(Re,nt,Qe))if(Yt.asyncDep&&!Yt.asyncResolved){Me(Yt,nt,Qe);return}else Yt.next=nt,Yt.update();else nt.el=Re.el,Yt.vnode=nt},be=(Re,nt,Qe,Yt,Xt,$t,Ot)=>{const Ft=()=>{if(Re.isMounted){let{next:bn,bu:It,u:Sn,parent:Yn,vnode:vr}=Re;{const jn=WL(Re);if(jn){bn&&(bn.el=vr.el,Me(Re,bn,Ot)),jn.asyncDep.then(()=>{Re.isUnmounted||Ft()});return}}let tr=bn,zr;uf(Re,!1),bn?(bn.el=vr.el,Me(Re,bn,Ot)):bn=vr,It&&$b(It),(zr=bn.props&&bn.props.onVnodeBeforeUpdate)&&Lc(zr,Yn,bn,vr),uf(Re,!0);const Cr=hP(Re),Io=Re.subTree;Re.subTree=Cr,N(Io,Cr,k(Io.el),vt(Io),Re,Xt,$t),bn.el=Cr.el,tr===null&&f8(Re,Cr.el),Sn&&ra(Sn,Xt),(zr=bn.props&&bn.props.onVnodeUpdated)&&ra(()=>Lc(zr,Yn,bn,vr),Xt)}else{let bn;const{el:It,props:Sn}=nt,{bm:Yn,m:vr,parent:tr,root:zr,type:Cr}=Re,Io=vm(nt);uf(Re,!1),Yn&&$b(Yn),!Io&&(bn=Sn&&Sn.onVnodeBeforeMount)&&Lc(bn,tr,nt),uf(Re,!0);{zr.ce&&zr.ce._injectChildStyle(Cr);const jn=Re.subTree=hP(Re);N(null,jn,Qe,Yt,Re,Xt,$t),nt.el=jn.el}if(vr&&ra(vr,Xt),!Io&&(bn=Sn&&Sn.onVnodeMounted)){const jn=nt;ra(()=>Lc(bn,tr,jn),Xt)}(nt.shapeFlag&256||tr&&vm(tr.vnode)&&tr.vnode.shapeFlag&256)&&Re.a&&ra(Re.a,Xt),Re.isMounted=!0,nt=Qe=Yt=null}};Re.scope.on();const sn=Re.effect=new ZO(Ft);Re.scope.off();const an=Re.update=sn.run.bind(sn),Pn=Re.job=sn.runIfDirty.bind(sn);Pn.i=Re,Pn.id=Re.uid,sn.scheduler=()=>wC(Pn),uf(Re,!0),an()},Me=(Re,nt,Qe)=>{nt.component=Re;const Yt=Re.vnode.props;Re.vnode=nt,Re.next=null,Y6(Re,nt.props,Yt,Qe),e8(Re,nt.children,Qe),Qd(),eP(Re),eh()},Ae=(Re,nt,Qe,Yt,Xt,$t,Ot,Ft,sn=!1)=>{const an=Re&&Re.children,Pn=Re?Re.shapeFlag:0,bn=nt.children,{patchFlag:It,shapeFlag:Sn}=nt;if(It>0){if(It&128){Be(an,bn,Qe,Yt,Xt,$t,Ot,Ft,sn);return}else if(It&256){me(an,bn,Qe,Yt,Xt,$t,Ot,Ft,sn);return}}Sn&8?(Pn&16&&Nt(an,Xt,$t),bn!==an&&M(Qe,bn)):Pn&16?Sn&16?Be(an,bn,Qe,Yt,Xt,$t,Ot,Ft,sn):Nt(an,Xt,$t,!0):(Pn&8&&M(Qe,""),Sn&16&&fe(bn,Qe,Yt,Xt,$t,Ot,Ft,sn))},me=(Re,nt,Qe,Yt,Xt,$t,Ot,Ft,sn)=>{Re=Re||pm,nt=nt||pm;const an=Re.length,Pn=nt.length,bn=Math.min(an,Pn);let It;for(It=0;It<bn;It++){const Sn=nt[It]=sn?zd(nt[It]):Fc(nt[It]);N(Re[It],Sn,Qe,null,Xt,$t,Ot,Ft,sn)}an>Pn?Nt(Re,Xt,$t,!0,!1,bn):fe(nt,Qe,Yt,Xt,$t,Ot,Ft,sn,bn)},Be=(Re,nt,Qe,Yt,Xt,$t,Ot,Ft,sn)=>{let an=0;const Pn=nt.length;let bn=Re.length-1,It=Pn-1;for(;an<=bn&&an<=It;){const Sn=Re[an],Yn=nt[an]=sn?zd(nt[an]):Fc(nt[an]);if(mf(Sn,Yn))N(Sn,Yn,Qe,null,Xt,$t,Ot,Ft,sn);else break;an++}for(;an<=bn&&an<=It;){const Sn=Re[bn],Yn=nt[It]=sn?zd(nt[It]):Fc(nt[It]);if(mf(Sn,Yn))N(Sn,Yn,Qe,null,Xt,$t,Ot,Ft,sn);else break;bn--,It--}if(an>bn){if(an<=It){const Sn=It+1,Yn=Sn<Pn?nt[Sn].el:Yt;for(;an<=It;)N(null,nt[an]=sn?zd(nt[an]):Fc(nt[an]),Qe,Yn,Xt,$t,Ot,Ft,sn),an++}}else if(an>It)for(;an<=bn;)bt(Re[an],Xt,$t,!0),an++;else{const Sn=an,Yn=an,vr=new Map;for(an=Yn;an<=It;an++){const Ut=nt[an]=sn?zd(nt[an]):Fc(nt[an]);Ut.key!=null&&vr.set(Ut.key,an)}let tr,zr=0;const Cr=It-Yn+1;let Io=!1,jn=0;const Gt=new Array(Cr);for(an=0;an<Cr;an++)Gt[an]=0;for(an=Sn;an<=bn;an++){const Ut=Re[an];if(zr>=Cr){bt(Ut,Xt,$t,!0);continue}let tt;if(Ut.key!=null)tt=vr.get(Ut.key);else for(tr=Yn;tr<=It;tr++)if(Gt[tr-Yn]===0&&mf(Ut,nt[tr])){tt=tr;break}tt===void 0?bt(Ut,Xt,$t,!0):(Gt[tt-Yn]=an+1,tt>=jn?jn=tt:Io=!0,N(Ut,nt[tt],Qe,null,Xt,$t,Ot,Ft,sn),zr++)}const ct=Io?o8(Gt):pm;for(tr=ct.length-1,an=Cr-1;an>=0;an--){const Ut=Yn+an,tt=nt[Ut],yn=Ut+1<Pn?nt[Ut+1].el:Yt;Gt[an]===0?N(null,tt,Qe,yn,Xt,$t,Ot,Ft,sn):Io&&(tr<0||an!==ct[tr]?Ve(tt,Qe,yn,2):tr--)}}},Ve=(Re,nt,Qe,Yt,Xt=null)=>{const{el:$t,type:Ot,transition:Ft,children:sn,shapeFlag:an}=Re;if(an&6){Ve(Re.component.subTree,nt,Qe,Yt);return}if(an&128){Re.suspense.move(nt,Qe,Yt);return}if(an&64){Ot.move(Re,nt,Qe,Fe);return}if(Ot===Bn){a($t,nt,Qe);for(let bn=0;bn<sn.length;bn++)Ve(sn[bn],nt,Qe,Yt);a(Re.anchor,nt,Qe);return}if(Ot===G2){Y(Re,nt,Qe);return}if(Yt!==2&&an&1&&Ft)if(Yt===0)Ft.beforeEnter($t),a($t,nt,Qe),ra(()=>Ft.enter($t),Xt);else{const{leave:bn,delayLeave:It,afterLeave:Sn}=Ft,Yn=()=>a($t,nt,Qe),vr=()=>{bn($t,()=>{Yn(),Sn&&Sn()})};It?It($t,Yn,vr):vr()}else a($t,nt,Qe)},bt=(Re,nt,Qe,Yt=!1,Xt=!1)=>{const{type:$t,props:Ot,ref:Ft,children:sn,dynamicChildren:an,shapeFlag:Pn,patchFlag:bn,dirs:It,cacheIndex:Sn}=Re;if(bn===-2&&(Xt=!1),Ft!=null&&h1(Ft,null,Qe,Re,!0),Sn!=null&&(nt.renderCache[Sn]=void 0),Pn&256){nt.ctx.deactivate(Re);return}const Yn=Pn&1&&It,vr=!vm(Re);let tr;if(vr&&(tr=Ot&&Ot.onVnodeBeforeUnmount)&&Lc(tr,nt,Re),Pn&6)Mt(Re.component,Qe,Yt);else{if(Pn&128){Re.suspense.unmount(Qe,Yt);return}Yn&&cf(Re,null,nt,"beforeUnmount"),Pn&64?Re.type.remove(Re,nt,Qe,Fe,Yt):an&&!an.hasOnce&&($t!==Bn||bn>0&&bn&64)?Nt(an,nt,Qe,!1,!0):($t===Bn&&bn&384||!Xt&&Pn&16)&&Nt(sn,nt,Qe),Yt&&Pe(Re)}(vr&&(tr=Ot&&Ot.onVnodeUnmounted)||Yn)&&ra(()=>{tr&&Lc(tr,nt,Re),Yn&&cf(Re,null,nt,"unmounted")},Qe)},Pe=Re=>{const{type:nt,el:Qe,anchor:Yt,transition:Xt}=Re;if(nt===Bn){wt(Qe,Yt);return}if(nt===G2){q(Re);return}const $t=()=>{d(Qe),Xt&&!Xt.persisted&&Xt.afterLeave&&Xt.afterLeave()};if(Re.shapeFlag&1&&Xt&&!Xt.persisted){const{leave:Ot,delayLeave:Ft}=Xt,sn=()=>Ot(Qe,$t);Ft?Ft(Re.el,$t,sn):sn()}else $t()},wt=(Re,nt)=>{let Qe;for(;Re!==nt;)Qe=z(Re),d(Re),Re=Qe;d(nt)},Mt=(Re,nt,Qe)=>{const{bum:Yt,scope:Xt,job:$t,subTree:Ot,um:Ft,m:sn,a:an}=Re;dP(sn),dP(an),Yt&&$b(Yt),Xt.stop(),$t&&($t.flags|=8,bt(Ot,Re,nt,Qe)),Ft&&ra(Ft,nt),ra(()=>{Re.isUnmounted=!0},nt),nt&&nt.pendingBranch&&!nt.isUnmounted&&Re.asyncDep&&!Re.asyncResolved&&Re.suspenseId===nt.pendingId&&(nt.deps--,nt.deps===0&&nt.resolve())},Nt=(Re,nt,Qe,Yt=!1,Xt=!1,$t=0)=>{for(let Ot=$t;Ot<Re.length;Ot++)bt(Re[Ot],nt,Qe,Yt,Xt)},vt=Re=>{if(Re.shapeFlag&6)return vt(Re.component.subTree);if(Re.shapeFlag&128)return Re.suspense.next();const nt=z(Re.anchor||Re.el),Qe=nt&&nt[_L];return Qe?z(Qe):nt};let Bt=!1;const Wt=(Re,nt,Qe)=>{Re==null?nt._vnode&&bt(nt._vnode,null,null,!0):N(nt._vnode||null,Re,nt,null,null,null,Qe),nt._vnode=Re,Bt||(Bt=!0,eP(),mL(),Bt=!1)},Fe={p:N,um:bt,m:Ve,r:Pe,mt:We,mc:fe,pc:Ae,pbc:le,n:vt,o:e};return{render:Wt,hydrate:void 0,createApp:q6(Wt)}}function H2({type:e,props:t},i){return i==="svg"&&e==="foreignObject"||i==="mathml"&&e==="annotation-xml"&&t&&t.encoding&&t.encoding.includes("html")?void 0:i}function uf({effect:e,job:t},i){i?(e.flags|=32,t.flags|=4):(e.flags&=-33,t.flags&=-5)}function r8(e,t){return(!e||e&&!e.pendingBranch)&&t&&!t.persisted}function IC(e,t,i=!1){const a=e.children,d=t.children;if(ln(a)&&ln(d))for(let p=0;p<a.length;p++){const _=a[p];let r=d[p];r.shapeFlag&1&&!r.dynamicChildren&&((r.patchFlag<=0||r.patchFlag===32)&&(r=d[p]=zd(d[p]),r.el=_.el),!i&&r.patchFlag!==-2&&IC(_,r)),r.type===qm&&(r.el=_.el)}}function o8(e){const t=e.slice(),i=[0];let a,d,p,_,r;const S=e.length;for(a=0;a<S;a++){const C=e[a];if(C!==0){if(d=i[i.length-1],e[d]<C){t[a]=d,i.push(a);continue}for(p=0,_=i.length-1;p<_;)r=p+_>>1,e[i[r]]<C?p=r+1:_=r;C<e[i[p]]&&(p>0&&(t[a]=i[p-1]),i[p]=a)}}for(p=i.length,_=i[p-1];p-- >0;)i[p]=_,_=t[_];return i}function WL(e){const t=e.subTree.component;if(t)return t.asyncDep&&!t.asyncResolved?t:WL(t)}function dP(e){if(e)for(let t=0;t<e.length;t++)e[t].flags|=8}const i8=Symbol.for("v-scx"),s8=()=>An(i8);function Cs(e,t){return AC(e,null,t)}function qt(e,t,i){return AC(e,t,i)}function AC(e,t,i=ci){const{immediate:a,deep:d,flush:p,once:_}=i,r=as({},i),S=t&&a||!t&&p!=="post";let C;if($_){if(p==="sync"){const F=s8();C=F.__watcherHandles||(F.__watcherHandles=[])}else if(!S){const F=()=>{};return F.stop=_o,F.resume=_o,F.pause=_o,F}}const M=ps;r.call=(F,B,N)=>ic(F,M,B,N);let k=!1;p==="post"?r.scheduler=F=>{ra(F,M&&M.suspense)}:p!=="sync"&&(k=!0,r.scheduler=(F,B)=>{B?F():wC(F)}),r.augmentJob=F=>{t&&(F.flags|=4),k&&(F.flags|=2,M&&(F.id=M.uid,F.i=M))};const z=C6(e,t,r);return $_&&(C?C.push(z):S&&z()),z}function a8(e,t,i){const a=this.proxy,d=Dn(e)?e.includes(".")?qL(a,e):()=>a[e]:e.bind(a,a);let p;Nn(t)?p=t:(p=t.handler,i=t);const _=py(this),r=AC(d,p.bind(a),i);return _(),r}function qL(e,t){const i=t.split(".");return()=>{let a=e;for(let d=0;d<i.length&&a;d++)a=a[i[d]];return a}}const l8=(e,t)=>t==="modelValue"||t==="model-value"?e.modelModifiers:e[`${t}Modifiers`]||e[`${da(t)}Modifiers`]||e[`${Vu(t)}Modifiers`];function c8(e,t,...i){if(e.isUnmounted)return;const a=e.vnode.props||ci;let d=i;const p=t.startsWith("update:"),_=p&&l8(a,t.slice(7));_&&(_.trim&&(d=i.map(M=>Dn(M)?M.trim():M)),_.number&&(d=i.map(AS)));let r,S=a[r=__(t)]||a[r=__(da(t))];!S&&p&&(S=a[r=__(Vu(t))]),S&&ic(S,e,6,d);const C=a[r+"Once"];if(C){if(!e.emitted)e.emitted={};else if(e.emitted[r])return;e.emitted[r]=!0,ic(C,e,6,d)}}function KL(e,t,i=!1){const a=t.emitsCache,d=a.get(e);if(d!==void 0)return d;const p=e.emits;let _={},r=!1;if(!Nn(e)){const S=C=>{const M=KL(C,t,!0);M&&(r=!0,as(_,M))};!i&&t.mixins.length&&t.mixins.forEach(S),e.extends&&S(e.extends),e.mixins&&e.mixins.forEach(S)}return!p&&!r?(yr(e)&&a.set(e,null),null):(ln(p)?p.forEach(S=>_[S]=null):as(_,p),yr(e)&&a.set(e,_),_)}function Q1(e,t){return!e||!j1(t)?!1:(t=t.slice(2).replace(/Once$/,""),to(e,t[0].toLowerCase()+t.slice(1))||to(e,Vu(t))||to(e,t))}function hP(e){const{type:t,vnode:i,proxy:a,withProxy:d,propsOptions:[p],slots:_,attrs:r,emit:S,render:C,renderCache:M,props:k,data:z,setupState:F,ctx:B,inheritAttrs:N}=e,j=d1(e);let U,te;try{if(i.shapeFlag&4){const q=d||a,J=q;U=Fc(C.call(J,q,M,k,F,z,B)),te=r}else{const q=t;U=Fc(q.length>1?q(k,{attrs:r,slots:_,emit:S}):q(k,null)),te=t.props?r:u8(r)}}catch(q){S_.length=0,Z1(q,e,1),U=Ze(os)}let Y=U;if(te&&N!==!1){const q=Object.keys(te),{shapeFlag:J}=Y;q.length&&J&7&&(p&&q.some(uC)&&(te=d8(te,p)),Y=zu(Y,te,!1,!0))}return i.dirs&&(Y=zu(Y,null,!1,!0),Y.dirs=Y.dirs?Y.dirs.concat(i.dirs):i.dirs),i.transition&&Pf(Y,i.transition),U=Y,d1(j),U}const u8=e=>{let t;for(const i in e)(i==="class"||i==="style"||j1(i))&&((t||(t={}))[i]=e[i]);return t},d8=(e,t)=>{const i={};for(const a in e)(!uC(a)||!(a.slice(9)in t))&&(i[a]=e[a]);return i};function h8(e,t,i){const{props:a,children:d,component:p}=e,{props:_,children:r,patchFlag:S}=t,C=p.emitsOptions;if(t.dirs||t.transition)return!0;if(i&&S>=0){if(S&1024)return!0;if(S&16)return a?fP(a,_,C):!!_;if(S&8){const M=t.dynamicProps;for(let k=0;k<M.length;k++){const z=M[k];if(_[z]!==a[z]&&!Q1(C,z))return!0}}}else return(d||r)&&(!r||!r.$stable)?!0:a===_?!1:a?_?fP(a,_,C):!0:!!_;return!1}function fP(e,t,i){const a=Object.keys(t);if(a.length!==Object.keys(e).length)return!0;for(let d=0;d<a.length;d++){const p=a[d];if(t[p]!==e[p]&&!Q1(i,p))return!0}return!1}function f8({vnode:e,parent:t},i){for(;t;){const a=t.subTree;if(a.suspense&&a.suspense.activeBranch===e&&(a.el=e.el),a===e)(e=t.vnode).el=i,t=t.parent;else break}}const ZL=e=>e.__isSuspense;function p8(e,t){t&&t.pendingBranch?ln(e)?t.effects.push(...e):t.effects.push(e):I6(e)}const Bn=Symbol.for("v-fgt"),qm=Symbol.for("v-txt"),os=Symbol.for("v-cmt"),G2=Symbol.for("v-stc"),S_=[];let Ga=null;function ae(e=!1){S_.push(Ga=e?null:[])}function m8(){S_.pop(),Ga=S_[S_.length-1]||null}let V_=1;function pP(e,t=!1){V_+=e,e<0&&Ga&&t&&(Ga.hasOnce=!0)}function YL(e){return e.dynamicChildren=V_>0?Ga||pm:null,m8(),V_>0&&Ga&&Ga.push(e),e}function Oe(e,t,i,a,d,p){return YL(Ue(e,t,i,a,d,p,!0))}function kt(e,t,i,a,d){return YL(Ze(e,t,i,a,d,!0))}function Ho(e){return e?e.__v_isVNode===!0:!1}function mf(e,t){return e.type===t.type&&e.key===t.key}const XL=({key:e})=>e??null,jb=({ref:e,ref_key:t,ref_for:i})=>(typeof e=="number"&&(e=""+e),e!=null?Dn(e)||To(e)||Nn(e)?{i:is,r:e,k:t,f:!!i}:e:null);function Ue(e,t=null,i=null,a=0,d=null,p=e===Bn?0:1,_=!1,r=!1){const S={__v_isVNode:!0,__v_skip:!0,type:e,props:t,key:t&&XL(t),ref:t&&jb(t),scopeId:vL,slotScopeIds:null,children:i,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:p,patchFlag:a,dynamicProps:d,dynamicChildren:null,appContext:null,ctx:is};return r?(kC(S,i),p&128&&e.normalize(S)):i&&(S.shapeFlag|=Dn(i)?8:16),V_>0&&!_&&Ga&&(S.patchFlag>0||p&6)&&S.patchFlag!==32&&Ga.push(S),S}const Ze=g8;function g8(e,t=null,i=null,a=0,d=null,p=!1){if((!e||e===PL)&&(e=os),Ho(e)){const r=zu(e,t,!0);return i&&kC(r,i),V_>0&&!p&&Ga&&(r.shapeFlag&6?Ga[Ga.indexOf(e)]=r:Ga.push(r)),r.patchFlag=-2,r}if(T8(e)&&(e=e.__vccOpts),t){t=Uc(t);let{class:r,style:S}=t;r&&!Dn(r)&&(t.class=pe(r)),yr(S)&&(xC(S)&&!ln(S)&&(S=as({},S)),t.style=$n(S))}const _=Dn(e)?1:ZL(e)?128:yL(e)?64:yr(e)?4:Nn(e)?2:0;return Ue(e,t,i,a,d,_,p,!0)}function Uc(e){return e?xC(e)||BL(e)?as({},e):e:null}function zu(e,t,i=!1,a=!1){const{props:d,ref:p,patchFlag:_,children:r,transition:S}=e,C=t?Mr(d||{},t):d,M={__v_isVNode:!0,__v_skip:!0,type:e.type,props:C,key:C&&XL(C),ref:t&&t.ref?i&&p?ln(p)?p.concat(jb(t)):[p,jb(t)]:jb(t):p,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:r,target:e.target,targetStart:e.targetStart,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:t&&e.type!==Bn?_===-1?16:_|16:_,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:S,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&zu(e.ssContent),ssFallback:e.ssFallback&&zu(e.ssFallback),el:e.el,anchor:e.anchor,ctx:e.ctx,ce:e.ce};return S&&a&&Pf(M,S.clone(M)),M}function Rr(e=" ",t=0){return Ze(qm,null,e,t)}function yt(e="",t=!1){return t?(ae(),kt(os,null,e)):Ze(os,null,e)}function Fc(e){return e==null||typeof e=="boolean"?Ze(os):ln(e)?Ze(Bn,null,e.slice()):Ho(e)?zd(e):Ze(qm,null,String(e))}function zd(e){return e.el===null&&e.patchFlag!==-1||e.memo?e:zu(e)}function kC(e,t){let i=0;const{shapeFlag:a}=e;if(t==null)t=null;else if(ln(t))i=16;else if(typeof t=="object")if(a&65){const d=t.default;d&&(d._c&&(d._d=!1),kC(e,d()),d._c&&(d._d=!0));return}else{i=32;const d=t._;!d&&!BL(t)?t._ctx=is:d===3&&is&&(is.slots._===1?t._=1:(t._=2,e.patchFlag|=1024))}else Nn(t)?(t={default:t,_ctx:is},i=32):(t=String(t),a&64?(i=16,t=[Rr(t)]):i=8);e.children=t,e.shapeFlag|=i}function Mr(...e){const t={};for(let i=0;i<e.length;i++){const a=e[i];for(const d in a)if(d==="class")t.class!==a.class&&(t.class=pe([t.class,a.class]));else if(d==="style")t.style=$n([t.style,a.style]);else if(j1(d)){const p=t[d],_=a[d];_&&p!==_&&!(ln(p)&&p.includes(_))&&(t[d]=p?[].concat(p,_):_)}else d!==""&&(t[d]=a[d])}return t}function Lc(e,t,i,a=null){ic(e,t,7,[i,a])}const v8=zL();let _8=0;function y8(e,t,i){const a=e.type,d=(t?t.appContext:e.appContext)||v8,p={uid:_8++,vnode:e,type:a,parent:t,appContext:d,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new KO(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(d.provides),ids:t?t.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:$L(a,d),emitsOptions:KL(a,d),emit:null,emitted:null,propsDefaults:ci,inheritAttrs:a.inheritAttrs,ctx:ci,data:ci,props:ci,attrs:ci,slots:ci,refs:ci,setupState:ci,setupContext:null,suspense:i,suspenseId:i?i.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return p.ctx={_:p},p.root=t?t.root:p,p.emit=c8.bind(null,p),e.ce&&e.ce(p),p}let ps=null;const wr=()=>ps||is;let p1,BS;{const e=W1(),t=(i,a)=>{let d;return(d=e[i])||(d=e[i]=[]),d.push(a),p=>{d.length>1?d.forEach(_=>_(p)):d[0](p)}};p1=t("__VUE_INSTANCE_SETTERS__",i=>ps=i),BS=t("__VUE_SSR_SETTERS__",i=>$_=i)}const py=e=>{const t=ps;return p1(e),e.scope.on(),()=>{e.scope.off(),p1(t)}},mP=()=>{ps&&ps.scope.off(),p1(null)};function JL(e){return e.vnode.shapeFlag&4}let $_=!1;function b8(e,t=!1,i=!1){t&&BS(t);const{props:a,children:d}=e.vnode,p=JL(e);Z6(e,a,p,t),Q6(e,d,i);const _=p?x8(e,t):void 0;return t&&BS(!1),_}function x8(e,t){const i=e.type;e.accessCache=Object.create(null),e.proxy=new Proxy(e.ctx,V6);const{setup:a}=i;if(a){Qd();const d=e.setupContext=a.length>1?eD(e):null,p=py(e),_=hy(a,e,0,[e.props,d]),r=L_(_);if(eh(),p(),(r||e.sp)&&!vm(e)&&ML(e),r){if(_.then(mP,mP),t)return _.then(S=>{gP(e,S)}).catch(S=>{Z1(S,e,0)});e.asyncDep=_}else gP(e,_)}else QL(e)}function gP(e,t,i){Nn(t)?e.type.__ssrInlineRender?e.ssrRender=t:e.render=t:yr(t)&&(e.setupState=dL(t)),QL(e)}function QL(e,t,i){const a=e.type;e.render||(e.render=a.render||_o);{const d=py(e);Qd();try{$6(e)}finally{eh(),d()}}}const w8={get(e,t){return Ns(e,"get",""),e[t]}};function eD(e){const t=i=>{e.exposed=i||{}};return{attrs:new Proxy(e.attrs,w8),slots:e.slots,emit:e.emit,expose:t}}function ex(e){return e.exposed?e.exposeProxy||(e.exposeProxy=new Proxy(dL(tc(e.exposed)),{get(t,i){if(i in t)return t[i];if(i in w_)return w_[i](e)},has(t,i){return i in t||i in w_}})):e.proxy}function S8(e,t=!0){return Nn(e)?e.displayName||e.name:e.name||t&&e.__name}function T8(e){return Nn(e)&&"__vccOpts"in e}const ee=(e,t)=>S6(e,t,$_);function Kn(e,t,i){const a=arguments.length;return a===2?yr(t)&&!ln(t)?Ho(t)?Ze(e,null,[t]):Ze(e,t):Ze(e,null,t):(a>3?i=Array.prototype.slice.call(arguments,2):a===3&&Ho(i)&&(i=[i]),Ze(e,t,i))}const C8="3.5.13",E8=_o;/**
* @vue/runtime-dom v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let VS;const vP=typeof window<"u"&&window.trustedTypes;if(vP)try{VS=vP.createPolicy("vue",{createHTML:e=>e})}catch{}const tD=VS?e=>VS.createHTML(e):e=>e,M8="http://www.w3.org/2000/svg",I8="http://www.w3.org/1998/Math/MathML",Eu=typeof document<"u"?document:null,_P=Eu&&Eu.createElement("template"),A8={insert:(e,t,i)=>{t.insertBefore(e,i||null)},remove:e=>{const t=e.parentNode;t&&t.removeChild(e)},createElement:(e,t,i,a)=>{const d=t==="svg"?Eu.createElementNS(M8,e):t==="mathml"?Eu.createElementNS(I8,e):i?Eu.createElement(e,{is:i}):Eu.createElement(e);return e==="select"&&a&&a.multiple!=null&&d.setAttribute("multiple",a.multiple),d},createText:e=>Eu.createTextNode(e),createComment:e=>Eu.createComment(e),setText:(e,t)=>{e.nodeValue=t},setElementText:(e,t)=>{e.textContent=t},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>Eu.querySelector(e),setScopeId(e,t){e.setAttribute(t,"")},insertStaticContent(e,t,i,a,d,p){const _=i?i.previousSibling:t.lastChild;if(d&&(d===p||d.nextSibling))for(;t.insertBefore(d.cloneNode(!0),i),!(d===p||!(d=d.nextSibling)););else{_P.innerHTML=tD(a==="svg"?`<svg>${e}</svg>`:a==="mathml"?`<math>${e}</math>`:e);const r=_P.content;if(a==="svg"||a==="mathml"){const S=r.firstChild;for(;S.firstChild;)r.appendChild(S.firstChild);r.removeChild(S)}t.insertBefore(r,i)}return[_?_.nextSibling:t.firstChild,i?i.previousSibling:t.lastChild]}},Id="transition",i_="animation",Cm=Symbol("_vtc"),nD={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},rD=as({},SL,nD),k8=e=>(e.displayName="Transition",e.props=rD,e),ls=k8((e,{slots:t})=>Kn(R6,oD(e),t)),df=(e,t=[])=>{ln(e)?e.forEach(i=>i(...t)):e&&e(...t)},yP=e=>e?ln(e)?e.some(t=>t.length>1):e.length>1:!1;function oD(e){const t={};for(const de in e)de in nD||(t[de]=e[de]);if(e.css===!1)return t;const{name:i="v",type:a,duration:d,enterFromClass:p=`${i}-enter-from`,enterActiveClass:_=`${i}-enter-active`,enterToClass:r=`${i}-enter-to`,appearFromClass:S=p,appearActiveClass:C=_,appearToClass:M=r,leaveFromClass:k=`${i}-leave-from`,leaveActiveClass:z=`${i}-leave-active`,leaveToClass:F=`${i}-leave-to`}=e,B=P8(d),N=B&&B[0],j=B&&B[1],{onBeforeEnter:U,onEnter:te,onEnterCancelled:Y,onLeave:q,onLeaveCancelled:J,onBeforeAppear:ne=U,onAppear:se=te,onAppearCancelled:fe=Y}=t,ce=(de,ke,We,we)=>{de._enterCancelled=we,kd(de,ke?M:r),kd(de,ke?C:_),We&&We()},le=(de,ke)=>{de._isLeaving=!1,kd(de,k),kd(de,F),kd(de,z),ke&&ke()},ge=de=>(ke,We)=>{const we=de?se:te,be=()=>ce(ke,de,We);df(we,[ke,be]),bP(()=>{kd(ke,de?S:p),Dc(ke,de?M:r),yP(we)||xP(ke,a,N,be)})};return as(t,{onBeforeEnter(de){df(U,[de]),Dc(de,p),Dc(de,_)},onBeforeAppear(de){df(ne,[de]),Dc(de,S),Dc(de,C)},onEnter:ge(!1),onAppear:ge(!0),onLeave(de,ke){de._isLeaving=!0;const We=()=>le(de,ke);Dc(de,k),de._enterCancelled?(Dc(de,z),$S()):($S(),Dc(de,z)),bP(()=>{de._isLeaving&&(kd(de,k),Dc(de,F),yP(q)||xP(de,a,j,We))}),df(q,[de,We])},onEnterCancelled(de){ce(de,!1,void 0,!0),df(Y,[de])},onAppearCancelled(de){ce(de,!0,void 0,!0),df(fe,[de])},onLeaveCancelled(de){le(de),df(J,[de])}})}function P8(e){if(e==null)return null;if(yr(e))return[W2(e.enter),W2(e.leave)];{const t=W2(e);return[t,t]}}function W2(e){return j$(e)}function Dc(e,t){t.split(/\s+/).forEach(i=>i&&e.classList.add(i)),(e[Cm]||(e[Cm]=new Set)).add(t)}function kd(e,t){t.split(/\s+/).forEach(a=>a&&e.classList.remove(a));const i=e[Cm];i&&(i.delete(t),i.size||(e[Cm]=void 0))}function bP(e){requestAnimationFrame(()=>{requestAnimationFrame(e)})}let R8=0;function xP(e,t,i,a){const d=e._endId=++R8,p=()=>{d===e._endId&&a()};if(i!=null)return setTimeout(p,i);const{type:_,timeout:r,propCount:S}=iD(e,t);if(!_)return a();const C=_+"end";let M=0;const k=()=>{e.removeEventListener(C,z),p()},z=F=>{F.target===e&&++M>=S&&k()};setTimeout(()=>{M<S&&k()},r+1),e.addEventListener(C,z)}function iD(e,t){const i=window.getComputedStyle(e),a=B=>(i[B]||"").split(", "),d=a(`${Id}Delay`),p=a(`${Id}Duration`),_=wP(d,p),r=a(`${i_}Delay`),S=a(`${i_}Duration`),C=wP(r,S);let M=null,k=0,z=0;t===Id?_>0&&(M=Id,k=_,z=p.length):t===i_?C>0&&(M=i_,k=C,z=S.length):(k=Math.max(_,C),M=k>0?_>C?Id:i_:null,z=M?M===Id?p.length:S.length:0);const F=M===Id&&/\b(transform|all)(,|$)/.test(a(`${Id}Property`).toString());return{type:M,timeout:k,propCount:z,hasTransform:F}}function wP(e,t){for(;e.length<t.length;)e=e.concat(e);return Math.max(...t.map((i,a)=>SP(i)+SP(e[a])))}function SP(e){return e==="auto"?0:Number(e.slice(0,-1).replace(",","."))*1e3}function $S(){return document.body.offsetHeight}function O8(e,t,i){const a=e[Cm];a&&(t=(t?[t,...a]:[...a]).join(" ")),t==null?e.removeAttribute("class"):i?e.setAttribute("class",t):e.className=t}const m1=Symbol("_vod"),sD=Symbol("_vsh"),no={beforeMount(e,{value:t},{transition:i}){e[m1]=e.style.display==="none"?"":e.style.display,i&&t?i.beforeEnter(e):s_(e,t)},mounted(e,{value:t},{transition:i}){i&&t&&i.enter(e)},updated(e,{value:t,oldValue:i},{transition:a}){!t!=!i&&(a?t?(a.beforeEnter(e),s_(e,!0),a.enter(e)):a.leave(e,()=>{s_(e,!1)}):s_(e,t))},beforeUnmount(e,{value:t}){s_(e,t)}};function s_(e,t){e.style.display=t?e[m1]:"none",e[sD]=!t}const L8=Symbol(""),D8=/(^|;)\s*display\s*:/;function z8(e,t,i){const a=e.style,d=Dn(i);let p=!1;if(i&&!d){if(t)if(Dn(t))for(const _ of t.split(";")){const r=_.slice(0,_.indexOf(":")).trim();i[r]==null&&Hb(a,r,"")}else for(const _ in t)i[_]==null&&Hb(a,_,"");for(const _ in i)_==="display"&&(p=!0),Hb(a,_,i[_])}else if(d){if(t!==i){const _=a[L8];_&&(i+=";"+_),a.cssText=i,p=D8.test(i)}}else t&&e.removeAttribute("style");m1 in e&&(e[m1]=p?a.display:"",e[sD]&&(a.display="none"))}const TP=/\s*!important$/;function Hb(e,t,i){if(ln(i))i.forEach(a=>Hb(e,t,a));else if(i==null&&(i=""),t.startsWith("--"))e.setProperty(t,i);else{const a=F8(e,t);TP.test(i)?e.setProperty(Vu(a),i.replace(TP,""),"important"):e[a]=i}}const CP=["Webkit","Moz","ms"],q2={};function F8(e,t){const i=q2[t];if(i)return i;let a=da(t);if(a!=="filter"&&a in e)return q2[t]=a;a=dy(a);for(let d=0;d<CP.length;d++){const p=CP[d]+a;if(p in e)return q2[t]=p}return t}const EP="http://www.w3.org/1999/xlink";function MP(e,t,i,a,d,p=Z$(t)){a&&t.startsWith("xlink:")?i==null?e.removeAttributeNS(EP,t.slice(6,t.length)):e.setAttributeNS(EP,t,i):i==null||p&&!HO(i)?e.removeAttribute(t):e.setAttribute(t,p?"":oc(i)?String(i):i)}function IP(e,t,i,a,d){if(t==="innerHTML"||t==="textContent"){i!=null&&(e[t]=t==="innerHTML"?tD(i):i);return}const p=e.tagName;if(t==="value"&&p!=="PROGRESS"&&!p.includes("-")){const r=p==="OPTION"?e.getAttribute("value")||"":e.value,S=i==null?e.type==="checkbox"?"on":"":String(i);(r!==S||!("_value"in e))&&(e.value=S),i==null&&e.removeAttribute(t),e._value=i;return}let _=!1;if(i===""||i==null){const r=typeof e[t];r==="boolean"?i=HO(i):i==null&&r==="string"?(i="",_=!0):r==="number"&&(i=0,_=!0)}try{e[t]=i}catch{}_&&e.removeAttribute(d||t)}function Fd(e,t,i,a){e.addEventListener(t,i,a)}function N8(e,t,i,a){e.removeEventListener(t,i,a)}const AP=Symbol("_vei");function B8(e,t,i,a,d=null){const p=e[AP]||(e[AP]={}),_=p[t];if(a&&_)_.value=a;else{const[r,S]=V8(t);if(a){const C=p[t]=j8(a,d);Fd(e,r,C,S)}else _&&(N8(e,r,_,S),p[t]=void 0)}}const kP=/(?:Once|Passive|Capture)$/;function V8(e){let t;if(kP.test(e)){t={};let a;for(;a=e.match(kP);)e=e.slice(0,e.length-a[0].length),t[a[0].toLowerCase()]=!0}return[e[2]===":"?e.slice(3):Vu(e.slice(2)),t]}let K2=0;const $8=Promise.resolve(),U8=()=>K2||($8.then(()=>K2=0),K2=Date.now());function j8(e,t){const i=a=>{if(!a._vts)a._vts=Date.now();else if(a._vts<=i.attached)return;ic(H8(a,i.value),t,5,[a])};return i.value=e,i.attached=U8(),i}function H8(e,t){if(ln(t)){const i=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{i.call(e),e._stopped=!0},t.map(a=>d=>!d._stopped&&a&&a(d))}else return t}const PP=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&e.charCodeAt(2)>96&&e.charCodeAt(2)<123,G8=(e,t,i,a,d,p)=>{const _=d==="svg";t==="class"?O8(e,a,_):t==="style"?z8(e,i,a):j1(t)?uC(t)||B8(e,t,i,a,p):(t[0]==="."?(t=t.slice(1),!0):t[0]==="^"?(t=t.slice(1),!1):W8(e,t,a,_))?(IP(e,t,a),!e.tagName.includes("-")&&(t==="value"||t==="checked"||t==="selected")&&MP(e,t,a,_,p,t!=="value")):e._isVueCE&&(/[A-Z]/.test(t)||!Dn(a))?IP(e,da(t),a,p,t):(t==="true-value"?e._trueValue=a:t==="false-value"&&(e._falseValue=a),MP(e,t,a,_))};function W8(e,t,i,a){if(a)return!!(t==="innerHTML"||t==="textContent"||t in e&&PP(t)&&Nn(i));if(t==="spellcheck"||t==="draggable"||t==="translate"||t==="form"||t==="list"&&e.tagName==="INPUT"||t==="type"&&e.tagName==="TEXTAREA")return!1;if(t==="width"||t==="height"){const d=e.tagName;if(d==="IMG"||d==="VIDEO"||d==="CANVAS"||d==="SOURCE")return!1}return PP(t)&&Dn(i)?!1:t in e}const aD=new WeakMap,lD=new WeakMap,g1=Symbol("_moveCb"),RP=Symbol("_enterCb"),q8=e=>(delete e.props.mode,e),K8=q8({name:"TransitionGroup",props:as({},rD,{tag:String,moveClass:String}),setup(e,{slots:t}){const i=wr(),a=wL();let d,p;return hc(()=>{if(!d.length)return;const _=e.moveClass||`${e.name||"v"}-move`;if(!J8(d[0].el,i.vnode.el,_))return;d.forEach(Z8),d.forEach(Y8);const r=d.filter(X8);$S(),r.forEach(S=>{const C=S.el,M=C.style;Dc(C,_),M.transform=M.webkitTransform=M.transitionDuration="";const k=C[g1]=z=>{z&&z.target!==C||(!z||/transform$/.test(z.propertyName))&&(C.removeEventListener("transitionend",k),C[g1]=null,kd(C,_))};C.addEventListener("transitionend",k)})}),()=>{const _=wo(e),r=oD(_);let S=_.tag||Bn;if(d=[],p)for(let C=0;C<p.length;C++){const M=p[C];M.el&&M.el instanceof Element&&(d.push(M),Pf(M,B_(M,r,a,i)),aD.set(M,M.el.getBoundingClientRect()))}p=t.default?SC(t.default()):[];for(let C=0;C<p.length;C++){const M=p[C];M.key!=null&&Pf(M,B_(M,r,a,i))}return Ze(S,null,p)}}}),cD=K8;function Z8(e){const t=e.el;t[g1]&&t[g1](),t[RP]&&t[RP]()}function Y8(e){lD.set(e,e.el.getBoundingClientRect())}function X8(e){const t=aD.get(e),i=lD.get(e),a=t.left-i.left,d=t.top-i.top;if(a||d){const p=e.el.style;return p.transform=p.webkitTransform=`translate(${a}px,${d}px)`,p.transitionDuration="0s",e}}function J8(e,t,i){const a=e.cloneNode(),d=e[Cm];d&&d.forEach(r=>{r.split(/\s+/).forEach(S=>S&&a.classList.remove(S))}),i.split(/\s+/).forEach(r=>r&&a.classList.add(r)),a.style.display="none";const p=t.nodeType===1?t:t.parentNode;p.appendChild(a);const{hasTransform:_}=iD(a);return p.removeChild(a),_}const Em=e=>{const t=e.props["onUpdate:modelValue"]||!1;return ln(t)?i=>$b(t,i):t};function Q8(e){e.target.composing=!0}function OP(e){const t=e.target;t.composing&&(t.composing=!1,t.dispatchEvent(new Event("input")))}const Du=Symbol("_assign"),tx={created(e,{modifiers:{lazy:t,trim:i,number:a}},d){e[Du]=Em(d);const p=a||d.props&&d.props.type==="number";Fd(e,t?"change":"input",_=>{if(_.target.composing)return;let r=e.value;i&&(r=r.trim()),p&&(r=AS(r)),e[Du](r)}),i&&Fd(e,"change",()=>{e.value=e.value.trim()}),t||(Fd(e,"compositionstart",Q8),Fd(e,"compositionend",OP),Fd(e,"change",OP))},mounted(e,{value:t}){e.value=t??""},beforeUpdate(e,{value:t,oldValue:i,modifiers:{lazy:a,trim:d,number:p}},_){if(e[Du]=Em(_),e.composing)return;const r=(p||e.type==="number")&&!/^0\d/.test(e.value)?AS(e.value):e.value,S=t??"";r!==S&&(document.activeElement===e&&e.type!=="range"&&(a&&t===i||d&&e.value.trim()===S)||(e.value=S))}},v1={deep:!0,created(e,t,i){e[Du]=Em(i),Fd(e,"change",()=>{const a=e._modelValue,d=dD(e),p=e.checked,_=e[Du];if(ln(a)){const r=GO(a,d),S=r!==-1;if(p&&!S)_(a.concat(d));else if(!p&&S){const C=[...a];C.splice(r,1),_(C)}}else if(H1(a)){const r=new Set(a);p?r.add(d):r.delete(d),_(r)}else _(hD(e,p))})},mounted:LP,beforeUpdate(e,t,i){e[Du]=Em(i),LP(e,t,i)}};function LP(e,{value:t,oldValue:i},a){e._modelValue=t;let d;if(ln(t))d=GO(t,a.props.value)>-1;else if(H1(t))d=t.has(a.props.value);else{if(t===i)return;d=Tm(t,hD(e,!0))}e.checked!==d&&(e.checked=d)}const uD={created(e,{value:t},i){e.checked=Tm(t,i.props.value),e[Du]=Em(i),Fd(e,"change",()=>{e[Du](dD(e))})},beforeUpdate(e,{value:t,oldValue:i},a){e[Du]=Em(a),t!==i&&(e.checked=Tm(t,a.props.value))}};function dD(e){return"_value"in e?e._value:e.value}function hD(e,t){const i=t?"_trueValue":"_falseValue";return i in e?e[i]:t}const eU=["ctrl","shift","alt","meta"],tU={stop:e=>e.stopPropagation(),prevent:e=>e.preventDefault(),self:e=>e.target!==e.currentTarget,ctrl:e=>!e.ctrlKey,shift:e=>!e.shiftKey,alt:e=>!e.altKey,meta:e=>!e.metaKey,left:e=>"button"in e&&e.button!==0,middle:e=>"button"in e&&e.button!==1,right:e=>"button"in e&&e.button!==2,exact:(e,t)=>eU.some(i=>e[`${i}Key`]&&!t.includes(i))},Qn=(e,t)=>{const i=e._withMods||(e._withMods={}),a=t.join(".");return i[a]||(i[a]=(d,...p)=>{for(let _=0;_<t.length;_++){const r=tU[t[_]];if(r&&r(d,t))return}return e(d,...p)})},nU={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},Po=(e,t)=>{const i=e._withKeys||(e._withKeys={}),a=t.join(".");return i[a]||(i[a]=d=>{if(!("key"in d))return;const p=Vu(d.key);if(t.some(_=>_===p||nU[_]===p))return e(d)})},rU=as({patchProp:G8},A8);let DP;function fD(){return DP||(DP=t8(rU))}const Gd=(...e)=>{fD().render(...e)},pD=(...e)=>{const t=fD().createApp(...e),{mount:i}=t;return t.mount=a=>{const d=iU(a);if(!d)return;const p=t._component;!Nn(p)&&!p.render&&!p.template&&(p.template=d.innerHTML),d.nodeType===1&&(d.textContent="");const _=i(d,!1,oU(d));return d instanceof Element&&(d.removeAttribute("v-cloak"),d.setAttribute("data-v-app","")),_},t};function oU(e){if(e instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&e instanceof MathMLElement)return"mathml"}function iU(e){return Dn(e)?document.querySelector(e):e}/*!
 * pinia v2.3.0
 * (c) 2024 Eduardo San Martin Morote
 * @license MIT
 */let mD;const nx=e=>mD=e,gD=Symbol();function US(e){return e&&typeof e=="object"&&Object.prototype.toString.call(e)==="[object Object]"&&typeof e.toJSON!="function"}var T_;(function(e){e.direct="direct",e.patchObject="patch object",e.patchFunction="patch function"})(T_||(T_={}));function sU(){const e=fC(!0),t=e.run(()=>Se({}));let i=[],a=[];const d=tc({install(p){nx(d),d._a=p,p.provide(gD,d),p.config.globalProperties.$pinia=d,a.forEach(_=>i.push(_)),a=[]},use(p){return this._a?i.push(p):a.push(p),this},_p:i,_a:null,_e:e,_s:new Map,state:t});return d}const vD=()=>{};function zP(e,t,i,a=vD){e.push(t);const d=()=>{const p=e.indexOf(t);p>-1&&(e.splice(p,1),a())};return!i&&pC()&&mC(d),d}function Jp(e,...t){e.slice().forEach(i=>{i(...t)})}const aU=e=>e(),FP=Symbol(),Z2=Symbol();function jS(e,t){e instanceof Map&&t instanceof Map?t.forEach((i,a)=>e.set(a,i)):e instanceof Set&&t instanceof Set&&t.forEach(e.add,e);for(const i in t){if(!t.hasOwnProperty(i))continue;const a=t[i],d=e[i];US(d)&&US(a)&&e.hasOwnProperty(i)&&!To(a)&&!Lu(a)?e[i]=jS(d,a):e[i]=a}return e}const lU=Symbol();function cU(e){return!US(e)||!e.hasOwnProperty(lU)}const{assign:Pd}=Object;function uU(e){return!!(To(e)&&e.effect)}function dU(e,t,i,a){const{state:d,actions:p,getters:_}=t,r=i.state.value[e];let S;function C(){r||(i.state.value[e]=d?d():{});const M=Zi(i.state.value[e]);return Pd(M,p,Object.keys(_||{}).reduce((k,z)=>(k[z]=tc(ee(()=>{nx(i);const F=i._s.get(e);return _[z].call(F,F)})),k),{}))}return S=_D(e,C,t,i,a,!0),S}function _D(e,t,i={},a,d,p){let _;const r=Pd({actions:{}},i),S={deep:!0};let C,M,k=[],z=[],F;const B=a.state.value[e];!p&&!B&&(a.state.value[e]={}),Se({});let N;function j(fe){let ce;C=M=!1,typeof fe=="function"?(fe(a.state.value[e]),ce={type:T_.patchFunction,storeId:e,events:F}):(jS(a.state.value[e],fe),ce={type:T_.patchObject,payload:fe,storeId:e,events:F});const le=N=Symbol();Vn().then(()=>{N===le&&(C=!0)}),M=!0,Jp(k,ce,a.state.value[e])}const U=p?function(){const{state:ce}=i,le=ce?ce():{};this.$patch(ge=>{Pd(ge,le)})}:vD;function te(){_.stop(),k=[],z=[],a._s.delete(e)}const Y=(fe,ce="")=>{if(FP in fe)return fe[Z2]=ce,fe;const le=function(){nx(a);const ge=Array.from(arguments),de=[],ke=[];function We(Me){de.push(Me)}function we(Me){ke.push(Me)}Jp(z,{args:ge,name:le[Z2],store:J,after:We,onError:we});let be;try{be=fe.apply(this&&this.$id===e?this:J,ge)}catch(Me){throw Jp(ke,Me),Me}return be instanceof Promise?be.then(Me=>(Jp(de,Me),Me)).catch(Me=>(Jp(ke,Me),Promise.reject(Me))):(Jp(de,be),be)};return le[FP]=!0,le[Z2]=ce,le},q={_p:a,$id:e,$onAction:zP.bind(null,z),$patch:j,$reset:U,$subscribe(fe,ce={}){const le=zP(k,fe,ce.detached,()=>ge()),ge=_.run(()=>qt(()=>a.state.value[e],de=>{(ce.flush==="sync"?M:C)&&fe({storeId:e,type:T_.direct,events:F},de)},Pd({},S,ce)));return le},$dispose:te},J=lo(q);a._s.set(e,J);const se=(a._a&&a._a.runWithContext||aU)(()=>a._e.run(()=>(_=fC()).run(()=>t({action:Y}))));for(const fe in se){const ce=se[fe];if(To(ce)&&!uU(ce)||Lu(ce))p||(B&&cU(ce)&&(To(ce)?ce.value=B[fe]:jS(ce,B[fe])),a.state.value[e][fe]=ce);else if(typeof ce=="function"){const le=Y(ce,fe);se[fe]=le,r.actions[fe]=ce}}return Pd(J,se),Pd(wo(J),se),Object.defineProperty(J,"$state",{get:()=>a.state.value[e],set:fe=>{j(ce=>{Pd(ce,fe)})}}),a._p.forEach(fe=>{Pd(J,_.run(()=>fe({store:J,app:a._a,pinia:a,options:r})))}),B&&p&&i.hydrate&&i.hydrate(J.$state,B),C=!0,M=!0,J}/*! #__NO_SIDE_EFFECTS__ */function hU(e,t,i){let a,d;const p=typeof t=="function";a=e,d=p?i:t;function _(r,S){const C=K6();return r=r||(C?An(gD,null):null),r&&nx(r),r=mD,r._s.has(a)||(p?_D(a,t,d,r):dU(a,d,r)),r._s.get(a)}return _.$id=a,_}function yD(e){{const t=wo(e),i={};for(const a in t){const d=t[a];d.effect?i[a]=ee({get:()=>e[a],set(p){e[a]=p}}):(To(d)||Lu(d))&&(i[a]=po(e,a))}return i}}const fU="2.9.5",NP=Symbol("INSTALLED_KEY"),bD=Symbol(),C_="el",pU="is-",hf=(e,t,i,a,d)=>{let p=`${e}-${t}`;return i&&(p+=`-${i}`),a&&(p+=`__${a}`),d&&(p+=`--${d}`),p},xD=Symbol("namespaceContextKey"),PC=e=>{const t=e||(wr()?An(xD,Se(C_)):Se(C_));return ee(()=>b(t)||C_)},en=(e,t)=>{const i=PC(t);return{namespace:i,b:(N="")=>hf(i.value,e,N,"",""),e:N=>N?hf(i.value,e,"",N,""):"",m:N=>N?hf(i.value,e,"","",N):"",be:(N,j)=>N&&j?hf(i.value,e,N,j,""):"",em:(N,j)=>N&&j?hf(i.value,e,"",N,j):"",bm:(N,j)=>N&&j?hf(i.value,e,N,"",j):"",bem:(N,j,U)=>N&&j&&U?hf(i.value,e,N,j,U):"",is:(N,...j)=>{const U=j.length>=1?j[0]:!0;return N&&U?`${pU}${N}`:""},cssVar:N=>{const j={};for(const U in N)N[U]&&(j[`--${i.value}-${U}`]=N[U]);return j},cssVarName:N=>`--${i.value}-${N}`,cssVarBlock:N=>{const j={};for(const U in N)N[U]&&(j[`--${i.value}-${e}-${U}`]=N[U]);return j},cssVarBlockName:N=>`--${i.value}-${e}-${N}`}};var wD=typeof global=="object"&&global&&global.Object===Object&&global,mU=typeof self=="object"&&self&&self.Object===Object&&self,fc=wD||mU||Function("return this")(),Cl=fc.Symbol,SD=Object.prototype,gU=SD.hasOwnProperty,vU=SD.toString,a_=Cl?Cl.toStringTag:void 0;function _U(e){var t=gU.call(e,a_),i=e[a_];try{e[a_]=void 0;var a=!0}catch{}var d=vU.call(e);return a&&(t?e[a_]=i:delete e[a_]),d}var yU=Object.prototype,bU=yU.toString;function xU(e){return bU.call(e)}var wU="[object Null]",SU="[object Undefined]",BP=Cl?Cl.toStringTag:void 0;function Bf(e){return e==null?e===void 0?SU:wU:BP&&BP in Object(e)?_U(e):xU(e)}function jc(e){return e!=null&&typeof e=="object"}var TU="[object Symbol]";function rx(e){return typeof e=="symbol"||jc(e)&&Bf(e)==TU}function RC(e,t){for(var i=-1,a=e==null?0:e.length,d=Array(a);++i<a;)d[i]=t(e[i],i,e);return d}var ha=Array.isArray,VP=Cl?Cl.prototype:void 0,$P=VP?VP.toString:void 0;function TD(e){if(typeof e=="string")return e;if(ha(e))return RC(e,TD)+"";if(rx(e))return $P?$P.call(e):"";var t=e+"";return t=="0"&&1/e==-1/0?"-0":t}var CU=/\s/;function EU(e){for(var t=e.length;t--&&CU.test(e.charAt(t)););return t}var MU=/^\s+/;function IU(e){return e&&e.slice(0,EU(e)+1).replace(MU,"")}function fa(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var UP=NaN,AU=/^[-+]0x[0-9a-f]+$/i,kU=/^0b[01]+$/i,PU=/^0o[0-7]+$/i,RU=parseInt;function jP(e){if(typeof e=="number")return e;if(rx(e))return UP;if(fa(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=fa(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=IU(e);var i=kU.test(e);return i||PU.test(e)?RU(e.slice(2),i?2:8):AU.test(e)?UP:+e}function OC(e){return e}var OU="[object AsyncFunction]",LU="[object Function]",DU="[object GeneratorFunction]",zU="[object Proxy]";function LC(e){if(!fa(e))return!1;var t=Bf(e);return t==LU||t==DU||t==OU||t==zU}var Y2=fc["__core-js_shared__"],HP=function(){var e=/[^.]+$/.exec(Y2&&Y2.keys&&Y2.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function FU(e){return!!HP&&HP in e}var NU=Function.prototype,BU=NU.toString;function Vf(e){if(e!=null){try{return BU.call(e)}catch{}try{return e+""}catch{}}return""}var VU=/[\\^$.*+?()[\]{}|]/g,$U=/^\[object .+?Constructor\]$/,UU=Function.prototype,jU=Object.prototype,HU=UU.toString,GU=jU.hasOwnProperty,WU=RegExp("^"+HU.call(GU).replace(VU,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function qU(e){if(!fa(e)||FU(e))return!1;var t=LC(e)?WU:$U;return t.test(Vf(e))}function KU(e,t){return e==null?void 0:e[t]}function $f(e,t){var i=KU(e,t);return qU(i)?i:void 0}var HS=$f(fc,"WeakMap"),GP=Object.create,ZU=function(){function e(){}return function(t){if(!fa(t))return{};if(GP)return GP(t);e.prototype=t;var i=new e;return e.prototype=void 0,i}}();function YU(e,t,i){switch(i.length){case 0:return e.call(t);case 1:return e.call(t,i[0]);case 2:return e.call(t,i[0],i[1]);case 3:return e.call(t,i[0],i[1],i[2])}return e.apply(t,i)}function XU(){}function CD(e,t){var i=-1,a=e.length;for(t||(t=Array(a));++i<a;)t[i]=e[i];return t}var JU=800,QU=16,ej=Date.now;function tj(e){var t=0,i=0;return function(){var a=ej(),d=QU-(a-i);if(i=a,d>0){if(++t>=JU)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}function nj(e){return function(){return e}}var _1=function(){try{var e=$f(Object,"defineProperty");return e({},"",{}),e}catch{}}(),rj=_1?function(e,t){return _1(e,"toString",{configurable:!0,enumerable:!1,value:nj(t),writable:!0})}:OC,ED=tj(rj);function oj(e,t){for(var i=-1,a=e==null?0:e.length;++i<a&&t(e[i],i,e)!==!1;);return e}function MD(e,t,i,a){for(var d=e.length,p=i+(a?1:-1);a?p--:++p<d;)if(t(e[p],p,e))return p;return-1}function ij(e){return e!==e}function sj(e,t,i){for(var a=i-1,d=e.length;++a<d;)if(e[a]===t)return a;return-1}function aj(e,t,i){return t===t?sj(e,t,i):MD(e,ij,i)}function lj(e,t){var i=e==null?0:e.length;return!!i&&aj(e,t,0)>-1}var cj=9007199254740991,uj=/^(?:0|[1-9]\d*)$/;function ox(e,t){var i=typeof e;return t=t??cj,!!t&&(i=="number"||i!="symbol"&&uj.test(e))&&e>-1&&e%1==0&&e<t}function DC(e,t,i){t=="__proto__"&&_1?_1(e,t,{configurable:!0,enumerable:!0,value:i,writable:!0}):e[t]=i}function my(e,t){return e===t||e!==e&&t!==t}var dj=Object.prototype,hj=dj.hasOwnProperty;function zC(e,t,i){var a=e[t];(!(hj.call(e,t)&&my(a,i))||i===void 0&&!(t in e))&&DC(e,t,i)}function Km(e,t,i,a){var d=!i;i||(i={});for(var p=-1,_=t.length;++p<_;){var r=t[p],S=void 0;S===void 0&&(S=e[r]),d?DC(i,r,S):zC(i,r,S)}return i}var WP=Math.max;function ID(e,t,i){return t=WP(t===void 0?e.length-1:t,0),function(){for(var a=arguments,d=-1,p=WP(a.length-t,0),_=Array(p);++d<p;)_[d]=a[t+d];d=-1;for(var r=Array(t+1);++d<t;)r[d]=a[d];return r[t]=i(_),YU(e,this,r)}}function AD(e,t){return ED(ID(e,t,OC),e+"")}var fj=9007199254740991;function FC(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=fj}function Zm(e){return e!=null&&FC(e.length)&&!LC(e)}function pj(e,t,i){if(!fa(i))return!1;var a=typeof t;return(a=="number"?Zm(i)&&ox(t,i.length):a=="string"&&t in i)?my(i[t],e):!1}function mj(e){return AD(function(t,i){var a=-1,d=i.length,p=d>1?i[d-1]:void 0,_=d>2?i[2]:void 0;for(p=e.length>3&&typeof p=="function"?(d--,p):void 0,_&&pj(i[0],i[1],_)&&(p=d<3?void 0:p,d=1),t=Object(t);++a<d;){var r=i[a];r&&e(t,r,a,p)}return t})}var gj=Object.prototype;function NC(e){var t=e&&e.constructor,i=typeof t=="function"&&t.prototype||gj;return e===i}function vj(e,t){for(var i=-1,a=Array(e);++i<e;)a[i]=t(i);return a}var _j="[object Arguments]";function qP(e){return jc(e)&&Bf(e)==_j}var kD=Object.prototype,yj=kD.hasOwnProperty,bj=kD.propertyIsEnumerable,U_=qP(function(){return arguments}())?qP:function(e){return jc(e)&&yj.call(e,"callee")&&!bj.call(e,"callee")};function xj(){return!1}var PD=typeof qa=="object"&&qa&&!qa.nodeType&&qa,KP=PD&&typeof Ka=="object"&&Ka&&!Ka.nodeType&&Ka,wj=KP&&KP.exports===PD,ZP=wj?fc.Buffer:void 0,Sj=ZP?ZP.isBuffer:void 0,j_=Sj||xj,Tj="[object Arguments]",Cj="[object Array]",Ej="[object Boolean]",Mj="[object Date]",Ij="[object Error]",Aj="[object Function]",kj="[object Map]",Pj="[object Number]",Rj="[object Object]",Oj="[object RegExp]",Lj="[object Set]",Dj="[object String]",zj="[object WeakMap]",Fj="[object ArrayBuffer]",Nj="[object DataView]",Bj="[object Float32Array]",Vj="[object Float64Array]",$j="[object Int8Array]",Uj="[object Int16Array]",jj="[object Int32Array]",Hj="[object Uint8Array]",Gj="[object Uint8ClampedArray]",Wj="[object Uint16Array]",qj="[object Uint32Array]",Ti={};Ti[Bj]=Ti[Vj]=Ti[$j]=Ti[Uj]=Ti[jj]=Ti[Hj]=Ti[Gj]=Ti[Wj]=Ti[qj]=!0;Ti[Tj]=Ti[Cj]=Ti[Fj]=Ti[Ej]=Ti[Nj]=Ti[Mj]=Ti[Ij]=Ti[Aj]=Ti[kj]=Ti[Pj]=Ti[Rj]=Ti[Oj]=Ti[Lj]=Ti[Dj]=Ti[zj]=!1;function Kj(e){return jc(e)&&FC(e.length)&&!!Ti[Bf(e)]}function BC(e){return function(t){return e(t)}}var RD=typeof qa=="object"&&qa&&!qa.nodeType&&qa,E_=RD&&typeof Ka=="object"&&Ka&&!Ka.nodeType&&Ka,Zj=E_&&E_.exports===RD,X2=Zj&&wD.process,Mm=function(){try{var e=E_&&E_.require&&E_.require("util").types;return e||X2&&X2.binding&&X2.binding("util")}catch{}}(),YP=Mm&&Mm.isTypedArray,VC=YP?BC(YP):Kj,Yj=Object.prototype,Xj=Yj.hasOwnProperty;function OD(e,t){var i=ha(e),a=!i&&U_(e),d=!i&&!a&&j_(e),p=!i&&!a&&!d&&VC(e),_=i||a||d||p,r=_?vj(e.length,String):[],S=r.length;for(var C in e)(t||Xj.call(e,C))&&!(_&&(C=="length"||d&&(C=="offset"||C=="parent")||p&&(C=="buffer"||C=="byteLength"||C=="byteOffset")||ox(C,S)))&&r.push(C);return r}function LD(e,t){return function(i){return e(t(i))}}var Jj=LD(Object.keys,Object),Qj=Object.prototype,eH=Qj.hasOwnProperty;function tH(e){if(!NC(e))return Jj(e);var t=[];for(var i in Object(e))eH.call(e,i)&&i!="constructor"&&t.push(i);return t}function gy(e){return Zm(e)?OD(e):tH(e)}function nH(e){var t=[];if(e!=null)for(var i in Object(e))t.push(i);return t}var rH=Object.prototype,oH=rH.hasOwnProperty;function iH(e){if(!fa(e))return nH(e);var t=NC(e),i=[];for(var a in e)a=="constructor"&&(t||!oH.call(e,a))||i.push(a);return i}function vy(e){return Zm(e)?OD(e,!0):iH(e)}var sH=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,aH=/^\w*$/;function $C(e,t){if(ha(e))return!1;var i=typeof e;return i=="number"||i=="symbol"||i=="boolean"||e==null||rx(e)?!0:aH.test(e)||!sH.test(e)||t!=null&&e in Object(t)}var H_=$f(Object,"create");function lH(){this.__data__=H_?H_(null):{},this.size=0}function cH(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var uH="__lodash_hash_undefined__",dH=Object.prototype,hH=dH.hasOwnProperty;function fH(e){var t=this.__data__;if(H_){var i=t[e];return i===uH?void 0:i}return hH.call(t,e)?t[e]:void 0}var pH=Object.prototype,mH=pH.hasOwnProperty;function gH(e){var t=this.__data__;return H_?t[e]!==void 0:mH.call(t,e)}var vH="__lodash_hash_undefined__";function _H(e,t){var i=this.__data__;return this.size+=this.has(e)?0:1,i[e]=H_&&t===void 0?vH:t,this}function Rf(e){var t=-1,i=e==null?0:e.length;for(this.clear();++t<i;){var a=e[t];this.set(a[0],a[1])}}Rf.prototype.clear=lH;Rf.prototype.delete=cH;Rf.prototype.get=fH;Rf.prototype.has=gH;Rf.prototype.set=_H;function yH(){this.__data__=[],this.size=0}function ix(e,t){for(var i=e.length;i--;)if(my(e[i][0],t))return i;return-1}var bH=Array.prototype,xH=bH.splice;function wH(e){var t=this.__data__,i=ix(t,e);if(i<0)return!1;var a=t.length-1;return i==a?t.pop():xH.call(t,i,1),--this.size,!0}function SH(e){var t=this.__data__,i=ix(t,e);return i<0?void 0:t[i][1]}function TH(e){return ix(this.__data__,e)>-1}function CH(e,t){var i=this.__data__,a=ix(i,e);return a<0?(++this.size,i.push([e,t])):i[a][1]=t,this}function ju(e){var t=-1,i=e==null?0:e.length;for(this.clear();++t<i;){var a=e[t];this.set(a[0],a[1])}}ju.prototype.clear=yH;ju.prototype.delete=wH;ju.prototype.get=SH;ju.prototype.has=TH;ju.prototype.set=CH;var G_=$f(fc,"Map");function EH(){this.size=0,this.__data__={hash:new Rf,map:new(G_||ju),string:new Rf}}function MH(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}function sx(e,t){var i=e.__data__;return MH(t)?i[typeof t=="string"?"string":"hash"]:i.map}function IH(e){var t=sx(this,e).delete(e);return this.size-=t?1:0,t}function AH(e){return sx(this,e).get(e)}function kH(e){return sx(this,e).has(e)}function PH(e,t){var i=sx(this,e),a=i.size;return i.set(e,t),this.size+=i.size==a?0:1,this}function Hu(e){var t=-1,i=e==null?0:e.length;for(this.clear();++t<i;){var a=e[t];this.set(a[0],a[1])}}Hu.prototype.clear=EH;Hu.prototype.delete=IH;Hu.prototype.get=AH;Hu.prototype.has=kH;Hu.prototype.set=PH;var RH="Expected a function";function ax(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new TypeError(RH);var i=function(){var a=arguments,d=t?t.apply(this,a):a[0],p=i.cache;if(p.has(d))return p.get(d);var _=e.apply(this,a);return i.cache=p.set(d,_)||p,_};return i.cache=new(ax.Cache||Hu),i}ax.Cache=Hu;var OH=500;function LH(e){var t=ax(e,function(a){return i.size===OH&&i.clear(),a}),i=t.cache;return t}var DH=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,zH=/\\(\\)?/g,FH=LH(function(e){var t=[];return e.charCodeAt(0)===46&&t.push(""),e.replace(DH,function(i,a,d,p){t.push(d?p.replace(zH,"$1"):a||i)}),t});function NH(e){return e==null?"":TD(e)}function Ym(e,t){return ha(e)?e:$C(e,t)?[e]:FH(NH(e))}function Xm(e){if(typeof e=="string"||rx(e))return e;var t=e+"";return t=="0"&&1/e==-1/0?"-0":t}function lx(e,t){t=Ym(t,e);for(var i=0,a=t.length;e!=null&&i<a;)e=e[Xm(t[i++])];return i&&i==a?e:void 0}function Ii(e,t,i){var a=e==null?void 0:lx(e,t);return a===void 0?i:a}function UC(e,t){for(var i=-1,a=t.length,d=e.length;++i<a;)e[d+i]=t[i];return e}var XP=Cl?Cl.isConcatSpreadable:void 0;function BH(e){return ha(e)||U_(e)||!!(XP&&e&&e[XP])}function _y(e,t,i,a,d){var p=-1,_=e.length;for(i||(i=BH),d||(d=[]);++p<_;){var r=e[p];t>0&&i(r)?t>1?_y(r,t-1,i,a,d):UC(d,r):a||(d[d.length]=r)}return d}function DD(e){var t=e==null?0:e.length;return t?_y(e,1):[]}function zD(e){return ED(ID(e,void 0,DD),e+"")}var jC=LD(Object.getPrototypeOf,Object),VH="[object Object]",$H=Function.prototype,UH=Object.prototype,FD=$H.toString,jH=UH.hasOwnProperty,HH=FD.call(Object);function ND(e){if(!jc(e)||Bf(e)!=VH)return!1;var t=jC(e);if(t===null)return!0;var i=jH.call(t,"constructor")&&t.constructor;return typeof i=="function"&&i instanceof i&&FD.call(i)==HH}function GH(e,t,i){var a=-1,d=e.length;t<0&&(t=-t>d?0:d+t),i=i>d?d:i,i<0&&(i+=d),d=t>i?0:i-t>>>0,t>>>=0;for(var p=Array(d);++a<d;)p[a]=e[a+t];return p}function Vs(){if(!arguments.length)return[];var e=arguments[0];return ha(e)?e:[e]}function WH(){this.__data__=new ju,this.size=0}function qH(e){var t=this.__data__,i=t.delete(e);return this.size=t.size,i}function KH(e){return this.__data__.get(e)}function ZH(e){return this.__data__.has(e)}var YH=200;function XH(e,t){var i=this.__data__;if(i instanceof ju){var a=i.__data__;if(!G_||a.length<YH-1)return a.push([e,t]),this.size=++i.size,this;i=this.__data__=new Hu(a)}return i.set(e,t),this.size=i.size,this}function nc(e){var t=this.__data__=new ju(e);this.size=t.size}nc.prototype.clear=WH;nc.prototype.delete=qH;nc.prototype.get=KH;nc.prototype.has=ZH;nc.prototype.set=XH;function JH(e,t){return e&&Km(t,gy(t),e)}function QH(e,t){return e&&Km(t,vy(t),e)}var BD=typeof qa=="object"&&qa&&!qa.nodeType&&qa,JP=BD&&typeof Ka=="object"&&Ka&&!Ka.nodeType&&Ka,eG=JP&&JP.exports===BD,QP=eG?fc.Buffer:void 0,e3=QP?QP.allocUnsafe:void 0;function VD(e,t){if(t)return e.slice();var i=e.length,a=e3?e3(i):new e.constructor(i);return e.copy(a),a}function tG(e,t){for(var i=-1,a=e==null?0:e.length,d=0,p=[];++i<a;){var _=e[i];t(_,i,e)&&(p[d++]=_)}return p}function $D(){return[]}var nG=Object.prototype,rG=nG.propertyIsEnumerable,t3=Object.getOwnPropertySymbols,HC=t3?function(e){return e==null?[]:(e=Object(e),tG(t3(e),function(t){return rG.call(e,t)}))}:$D;function oG(e,t){return Km(e,HC(e),t)}var iG=Object.getOwnPropertySymbols,UD=iG?function(e){for(var t=[];e;)UC(t,HC(e)),e=jC(e);return t}:$D;function sG(e,t){return Km(e,UD(e),t)}function jD(e,t,i){var a=t(e);return ha(e)?a:UC(a,i(e))}function GS(e){return jD(e,gy,HC)}function HD(e){return jD(e,vy,UD)}var WS=$f(fc,"DataView"),qS=$f(fc,"Promise"),_m=$f(fc,"Set"),n3="[object Map]",aG="[object Object]",r3="[object Promise]",o3="[object Set]",i3="[object WeakMap]",s3="[object DataView]",lG=Vf(WS),cG=Vf(G_),uG=Vf(qS),dG=Vf(_m),hG=Vf(HS),Xl=Bf;(WS&&Xl(new WS(new ArrayBuffer(1)))!=s3||G_&&Xl(new G_)!=n3||qS&&Xl(qS.resolve())!=r3||_m&&Xl(new _m)!=o3||HS&&Xl(new HS)!=i3)&&(Xl=function(e){var t=Bf(e),i=t==aG?e.constructor:void 0,a=i?Vf(i):"";if(a)switch(a){case lG:return s3;case cG:return n3;case uG:return r3;case dG:return o3;case hG:return i3}return t});var fG=Object.prototype,pG=fG.hasOwnProperty;function mG(e){var t=e.length,i=new e.constructor(t);return t&&typeof e[0]=="string"&&pG.call(e,"index")&&(i.index=e.index,i.input=e.input),i}var y1=fc.Uint8Array;function GC(e){var t=new e.constructor(e.byteLength);return new y1(t).set(new y1(e)),t}function gG(e,t){var i=t?GC(e.buffer):e.buffer;return new e.constructor(i,e.byteOffset,e.byteLength)}var vG=/\w*$/;function _G(e){var t=new e.constructor(e.source,vG.exec(e));return t.lastIndex=e.lastIndex,t}var a3=Cl?Cl.prototype:void 0,l3=a3?a3.valueOf:void 0;function yG(e){return l3?Object(l3.call(e)):{}}function GD(e,t){var i=t?GC(e.buffer):e.buffer;return new e.constructor(i,e.byteOffset,e.length)}var bG="[object Boolean]",xG="[object Date]",wG="[object Map]",SG="[object Number]",TG="[object RegExp]",CG="[object Set]",EG="[object String]",MG="[object Symbol]",IG="[object ArrayBuffer]",AG="[object DataView]",kG="[object Float32Array]",PG="[object Float64Array]",RG="[object Int8Array]",OG="[object Int16Array]",LG="[object Int32Array]",DG="[object Uint8Array]",zG="[object Uint8ClampedArray]",FG="[object Uint16Array]",NG="[object Uint32Array]";function BG(e,t,i){var a=e.constructor;switch(t){case IG:return GC(e);case bG:case xG:return new a(+e);case AG:return gG(e,i);case kG:case PG:case RG:case OG:case LG:case DG:case zG:case FG:case NG:return GD(e,i);case wG:return new a;case SG:case EG:return new a(e);case TG:return _G(e);case CG:return new a;case MG:return yG(e)}}function WD(e){return typeof e.constructor=="function"&&!NC(e)?ZU(jC(e)):{}}var VG="[object Map]";function $G(e){return jc(e)&&Xl(e)==VG}var c3=Mm&&Mm.isMap,UG=c3?BC(c3):$G,jG="[object Set]";function HG(e){return jc(e)&&Xl(e)==jG}var u3=Mm&&Mm.isSet,GG=u3?BC(u3):HG,WG=1,qG=2,KG=4,qD="[object Arguments]",ZG="[object Array]",YG="[object Boolean]",XG="[object Date]",JG="[object Error]",KD="[object Function]",QG="[object GeneratorFunction]",eW="[object Map]",tW="[object Number]",ZD="[object Object]",nW="[object RegExp]",rW="[object Set]",oW="[object String]",iW="[object Symbol]",sW="[object WeakMap]",aW="[object ArrayBuffer]",lW="[object DataView]",cW="[object Float32Array]",uW="[object Float64Array]",dW="[object Int8Array]",hW="[object Int16Array]",fW="[object Int32Array]",pW="[object Uint8Array]",mW="[object Uint8ClampedArray]",gW="[object Uint16Array]",vW="[object Uint32Array]",gi={};gi[qD]=gi[ZG]=gi[aW]=gi[lW]=gi[YG]=gi[XG]=gi[cW]=gi[uW]=gi[dW]=gi[hW]=gi[fW]=gi[eW]=gi[tW]=gi[ZD]=gi[nW]=gi[rW]=gi[oW]=gi[iW]=gi[pW]=gi[mW]=gi[gW]=gi[vW]=!0;gi[JG]=gi[KD]=gi[sW]=!1;function ym(e,t,i,a,d,p){var _,r=t&WG,S=t&qG,C=t&KG;if(i&&(_=d?i(e,a,d,p):i(e)),_!==void 0)return _;if(!fa(e))return e;var M=ha(e);if(M){if(_=mG(e),!r)return CD(e,_)}else{var k=Xl(e),z=k==KD||k==QG;if(j_(e))return VD(e,r);if(k==ZD||k==qD||z&&!d){if(_=S||z?{}:WD(e),!r)return S?sG(e,QH(_,e)):oG(e,JH(_,e))}else{if(!gi[k])return d?e:{};_=BG(e,k,r)}}p||(p=new nc);var F=p.get(e);if(F)return F;p.set(e,_),GG(e)?e.forEach(function(j){_.add(ym(j,t,i,j,e,p))}):UG(e)&&e.forEach(function(j,U){_.set(U,ym(j,t,i,U,e,p))});var B=C?S?HD:GS:S?vy:gy,N=M?void 0:B(e);return oj(N||e,function(j,U){N&&(U=j,j=e[U]),zC(_,U,ym(j,t,i,U,e,p))}),_}var _W=4;function d3(e){return ym(e,_W)}var yW=1,bW=4;function b1(e){return ym(e,yW|bW)}var xW="__lodash_hash_undefined__";function wW(e){return this.__data__.set(e,xW),this}function SW(e){return this.__data__.has(e)}function W_(e){var t=-1,i=e==null?0:e.length;for(this.__data__=new Hu;++t<i;)this.add(e[t])}W_.prototype.add=W_.prototype.push=wW;W_.prototype.has=SW;function TW(e,t){for(var i=-1,a=e==null?0:e.length;++i<a;)if(t(e[i],i,e))return!0;return!1}function YD(e,t){return e.has(t)}var CW=1,EW=2;function XD(e,t,i,a,d,p){var _=i&CW,r=e.length,S=t.length;if(r!=S&&!(_&&S>r))return!1;var C=p.get(e),M=p.get(t);if(C&&M)return C==t&&M==e;var k=-1,z=!0,F=i&EW?new W_:void 0;for(p.set(e,t),p.set(t,e);++k<r;){var B=e[k],N=t[k];if(a)var j=_?a(N,B,k,t,e,p):a(B,N,k,e,t,p);if(j!==void 0){if(j)continue;z=!1;break}if(F){if(!TW(t,function(U,te){if(!YD(F,te)&&(B===U||d(B,U,i,a,p)))return F.push(te)})){z=!1;break}}else if(!(B===N||d(B,N,i,a,p))){z=!1;break}}return p.delete(e),p.delete(t),z}function MW(e){var t=-1,i=Array(e.size);return e.forEach(function(a,d){i[++t]=[d,a]}),i}function WC(e){var t=-1,i=Array(e.size);return e.forEach(function(a){i[++t]=a}),i}var IW=1,AW=2,kW="[object Boolean]",PW="[object Date]",RW="[object Error]",OW="[object Map]",LW="[object Number]",DW="[object RegExp]",zW="[object Set]",FW="[object String]",NW="[object Symbol]",BW="[object ArrayBuffer]",VW="[object DataView]",h3=Cl?Cl.prototype:void 0,J2=h3?h3.valueOf:void 0;function $W(e,t,i,a,d,p,_){switch(i){case VW:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case BW:return!(e.byteLength!=t.byteLength||!p(new y1(e),new y1(t)));case kW:case PW:case LW:return my(+e,+t);case RW:return e.name==t.name&&e.message==t.message;case DW:case FW:return e==t+"";case OW:var r=MW;case zW:var S=a&IW;if(r||(r=WC),e.size!=t.size&&!S)return!1;var C=_.get(e);if(C)return C==t;a|=AW,_.set(e,t);var M=XD(r(e),r(t),a,d,p,_);return _.delete(e),M;case NW:if(J2)return J2.call(e)==J2.call(t)}return!1}var UW=1,jW=Object.prototype,HW=jW.hasOwnProperty;function GW(e,t,i,a,d,p){var _=i&UW,r=GS(e),S=r.length,C=GS(t),M=C.length;if(S!=M&&!_)return!1;for(var k=S;k--;){var z=r[k];if(!(_?z in t:HW.call(t,z)))return!1}var F=p.get(e),B=p.get(t);if(F&&B)return F==t&&B==e;var N=!0;p.set(e,t),p.set(t,e);for(var j=_;++k<S;){z=r[k];var U=e[z],te=t[z];if(a)var Y=_?a(te,U,z,t,e,p):a(U,te,z,e,t,p);if(!(Y===void 0?U===te||d(U,te,i,a,p):Y)){N=!1;break}j||(j=z=="constructor")}if(N&&!j){var q=e.constructor,J=t.constructor;q!=J&&"constructor"in e&&"constructor"in t&&!(typeof q=="function"&&q instanceof q&&typeof J=="function"&&J instanceof J)&&(N=!1)}return p.delete(e),p.delete(t),N}var WW=1,f3="[object Arguments]",p3="[object Array]",bb="[object Object]",qW=Object.prototype,m3=qW.hasOwnProperty;function KW(e,t,i,a,d,p){var _=ha(e),r=ha(t),S=_?p3:Xl(e),C=r?p3:Xl(t);S=S==f3?bb:S,C=C==f3?bb:C;var M=S==bb,k=C==bb,z=S==C;if(z&&j_(e)){if(!j_(t))return!1;_=!0,M=!1}if(z&&!M)return p||(p=new nc),_||VC(e)?XD(e,t,i,a,d,p):$W(e,t,S,i,a,d,p);if(!(i&WW)){var F=M&&m3.call(e,"__wrapped__"),B=k&&m3.call(t,"__wrapped__");if(F||B){var N=F?e.value():e,j=B?t.value():t;return p||(p=new nc),d(N,j,i,a,p)}}return z?(p||(p=new nc),GW(e,t,i,a,d,p)):!1}function cx(e,t,i,a,d){return e===t?!0:e==null||t==null||!jc(e)&&!jc(t)?e!==e&&t!==t:KW(e,t,i,a,cx,d)}var ZW=1,YW=2;function XW(e,t,i,a){var d=i.length,p=d;if(e==null)return!p;for(e=Object(e);d--;){var _=i[d];if(_[2]?_[1]!==e[_[0]]:!(_[0]in e))return!1}for(;++d<p;){_=i[d];var r=_[0],S=e[r],C=_[1];if(_[2]){if(S===void 0&&!(r in e))return!1}else{var M=new nc,k;if(!(k===void 0?cx(C,S,ZW|YW,a,M):k))return!1}}return!0}function JD(e){return e===e&&!fa(e)}function JW(e){for(var t=gy(e),i=t.length;i--;){var a=t[i],d=e[a];t[i]=[a,d,JD(d)]}return t}function QD(e,t){return function(i){return i==null?!1:i[e]===t&&(t!==void 0||e in Object(i))}}function QW(e){var t=JW(e);return t.length==1&&t[0][2]?QD(t[0][0],t[0][1]):function(i){return i===e||XW(i,e,t)}}function eq(e,t){return e!=null&&t in Object(e)}function tq(e,t,i){t=Ym(t,e);for(var a=-1,d=t.length,p=!1;++a<d;){var _=Xm(t[a]);if(!(p=e!=null&&i(e,_)))break;e=e[_]}return p||++a!=d?p:(d=e==null?0:e.length,!!d&&FC(d)&&ox(_,d)&&(ha(e)||U_(e)))}function ez(e,t){return e!=null&&tq(e,t,eq)}var nq=1,rq=2;function oq(e,t){return $C(e)&&JD(t)?QD(Xm(e),t):function(i){var a=Ii(i,e);return a===void 0&&a===t?ez(i,e):cx(t,a,nq|rq)}}function iq(e){return function(t){return t==null?void 0:t[e]}}function sq(e){return function(t){return lx(t,e)}}function aq(e){return $C(e)?iq(Xm(e)):sq(e)}function tz(e){return typeof e=="function"?e:e==null?OC:typeof e=="object"?ha(e)?oq(e[0],e[1]):QW(e):aq(e)}function lq(e){return function(t,i,a){for(var d=-1,p=Object(t),_=a(t),r=_.length;r--;){var S=_[++d];if(i(p[S],S,p)===!1)break}return t}}var nz=lq();function cq(e,t){return e&&nz(e,t,gy)}function uq(e,t){return function(i,a){if(i==null)return i;if(!Zm(i))return e(i,a);for(var d=i.length,p=-1,_=Object(i);++p<d&&a(_[p],p,_)!==!1;);return i}}var dq=uq(cq),Q2=function(){return fc.Date.now()},hq="Expected a function",fq=Math.max,pq=Math.min;function Ra(e,t,i){var a,d,p,_,r,S,C=0,M=!1,k=!1,z=!0;if(typeof e!="function")throw new TypeError(hq);t=jP(t)||0,fa(i)&&(M=!!i.leading,k="maxWait"in i,p=k?fq(jP(i.maxWait)||0,t):p,z="trailing"in i?!!i.trailing:z);function F(ne){var se=a,fe=d;return a=d=void 0,C=ne,_=e.apply(fe,se),_}function B(ne){return C=ne,r=setTimeout(U,t),M?F(ne):_}function N(ne){var se=ne-S,fe=ne-C,ce=t-se;return k?pq(ce,p-fe):ce}function j(ne){var se=ne-S,fe=ne-C;return S===void 0||se>=t||se<0||k&&fe>=p}function U(){var ne=Q2();if(j(ne))return te(ne);r=setTimeout(U,N(ne))}function te(ne){return r=void 0,z&&a?F(ne):(a=d=void 0,_)}function Y(){r!==void 0&&clearTimeout(r),C=0,a=S=d=r=void 0}function q(){return r===void 0?_:te(Q2())}function J(){var ne=Q2(),se=j(ne);if(a=arguments,d=this,S=ne,se){if(r===void 0)return B(S);if(k)return clearTimeout(r),r=setTimeout(U,t),F(S)}return r===void 0&&(r=setTimeout(U,t)),_}return J.cancel=Y,J.flush=q,J}function KS(e,t,i){(i!==void 0&&!my(e[t],i)||i===void 0&&!(t in e))&&DC(e,t,i)}function rz(e){return jc(e)&&Zm(e)}function ZS(e,t){if(!(t==="constructor"&&typeof e[t]=="function")&&t!="__proto__")return e[t]}function mq(e){return Km(e,vy(e))}function gq(e,t,i,a,d,p,_){var r=ZS(e,i),S=ZS(t,i),C=_.get(S);if(C){KS(e,i,C);return}var M=p?p(r,S,i+"",e,t,_):void 0,k=M===void 0;if(k){var z=ha(S),F=!z&&j_(S),B=!z&&!F&&VC(S);M=S,z||F||B?ha(r)?M=r:rz(r)?M=CD(r):F?(k=!1,M=VD(S,!0)):B?(k=!1,M=GD(S,!0)):M=[]:ND(S)||U_(S)?(M=r,U_(r)?M=mq(r):(!fa(r)||LC(r))&&(M=WD(S))):k=!1}k&&(_.set(S,M),d(M,S,a,p,_),_.delete(S)),KS(e,i,M)}function oz(e,t,i,a,d){e!==t&&nz(t,function(p,_){if(d||(d=new nc),fa(p))gq(e,t,_,i,oz,a,d);else{var r=a?a(ZS(e,_),p,_+"",e,t,d):void 0;r===void 0&&(r=p),KS(e,_,r)}},vy)}function vq(e){var t=e==null?0:e.length;return t?e[t-1]:void 0}function iz(e,t,i){var a=e==null?0:e.length;if(!a)return-1;var d=a-1;return MD(e,tz(t),d,!0)}function _q(e,t){var i=-1,a=Zm(e)?Array(e.length):[];return dq(e,function(d,p,_){a[++i]=t(d,p,_)}),a}function yq(e,t){var i=ha(e)?RC:_q;return i(e,tz(t))}function bq(e,t){return _y(yq(e,t),1)}var xq=1/0;function wq(e){var t=e==null?0:e.length;return t?_y(e,xq):[]}function q_(e){for(var t=-1,i=e==null?0:e.length,a={};++t<i;){var d=e[t];a[d[0]]=d[1]}return a}function Sq(e,t){return t.length<2?e:lx(e,GH(t,0,-1))}function ms(e,t){return cx(e,t)}function Ki(e){return e==null}function yy(e){return e===null}function sz(e){return e===void 0}var az=mj(function(e,t,i){oz(e,t,i)});function Tq(e,t){return t=Ym(t,e),e=Sq(e,t),e==null||delete e[Xm(vq(t))]}function Cq(e){return ND(e)?void 0:e}var Eq=1,Mq=2,Iq=4,Aq=zD(function(e,t){var i={};if(e==null)return i;var a=!1;t=RC(t,function(p){return p=Ym(p,e),a||(a=p.length>1),p}),Km(e,HD(e),i),a&&(i=ym(i,Eq|Mq|Iq,Cq));for(var d=t.length;d--;)Tq(i,t[d]);return i});function lz(e,t,i,a){if(!fa(e))return e;t=Ym(t,e);for(var d=-1,p=t.length,_=p-1,r=e;r!=null&&++d<p;){var S=Xm(t[d]),C=i;if(S==="__proto__"||S==="constructor"||S==="prototype")return e;if(d!=_){var M=r[S];C=void 0,C===void 0&&(C=fa(M)?M:ox(t[d+1])?[]:{})}zC(r,S,C),r=r[S]}return e}function kq(e,t,i){for(var a=-1,d=t.length,p={};++a<d;){var _=t[a],r=lx(e,_);i(r,_)&&lz(p,Ym(_,e),r)}return p}function Pq(e,t){return kq(e,t,function(i,a){return ez(e,a)})}var Jl=zD(function(e,t){return e==null?{}:Pq(e,t)});function Rq(e,t,i){return e==null?e:lz(e,t,i)}var Oq="Expected a function";function Ef(e,t,i){var a=!0,d=!0;if(typeof e!="function")throw new TypeError(Oq);return fa(i)&&(a="leading"in i?!!i.leading:a,d="trailing"in i?!!i.trailing:d),Ra(e,t,{leading:a,maxWait:t,trailing:d})}var Lq=1/0,Dq=_m&&1/WC(new _m([,-0]))[1]==Lq?function(e){return new _m(e)}:XU,zq=200;function Fq(e,t,i){var a=-1,d=lj,p=e.length,_=!0,r=[],S=r;if(p>=zq){var C=Dq(e);if(C)return WC(C);_=!1,d=YD,S=new W_}else S=r;e:for(;++a<p;){var M=e[a],k=M;if(M=M!==0?M:0,_&&k===k){for(var z=S.length;z--;)if(S[z]===k)continue e;r.push(M)}else d(S,k,i)||(S!==r&&S.push(k),r.push(M))}return r}var eS=AD(function(e){return Fq(_y(e,1,rz,!0))});const oo=e=>e===void 0,Ro=e=>typeof e=="boolean",Gn=e=>typeof e=="number",ja=e=>!e&&e!==0||ln(e)&&e.length===0||yr(e)&&!Object.keys(e).length,la=e=>typeof Element>"u"?!1:e instanceof Element,rc=e=>Ki(e),Nq=e=>Dn(e)?!Number.isNaN(Number(e)):!1,ux=e=>e===window;var Bq=Object.defineProperty,Vq=Object.defineProperties,$q=Object.getOwnPropertyDescriptors,g3=Object.getOwnPropertySymbols,Uq=Object.prototype.hasOwnProperty,jq=Object.prototype.propertyIsEnumerable,v3=(e,t,i)=>t in e?Bq(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,Hq=(e,t)=>{for(var i in t||(t={}))Uq.call(t,i)&&v3(e,i,t[i]);if(g3)for(var i of g3(t))jq.call(t,i)&&v3(e,i,t[i]);return e},Gq=(e,t)=>Vq(e,$q(t));function YS(e,t){var i;const a=Uo();return Cs(()=>{a.value=e()},Gq(Hq({},t),{flush:(i=void 0)!=null?i:"sync"})),Wm(a)}var _3;const Hr=typeof window<"u",Wq=e=>typeof e<"u",XS=e=>typeof e=="function",qq=e=>typeof e=="string",Im=()=>{},JS=Hr&&((_3=window==null?void 0:window.navigator)==null?void 0:_3.userAgent)&&/iP(ad|hone|od)/.test(window.navigator.userAgent);function Wd(e){return typeof e=="function"?e():b(e)}function cz(e,t){function i(...a){return new Promise((d,p)=>{Promise.resolve(e(()=>t.apply(this,a),{fn:t,thisArg:this,args:a})).then(d).catch(p)})}return i}function Kq(e,t={}){let i,a,d=Im;const p=r=>{clearTimeout(r),d(),d=Im};return r=>{const S=Wd(e),C=Wd(t.maxWait);return i&&p(i),S<=0||C!==void 0&&C<=0?(a&&(p(a),a=null),Promise.resolve(r())):new Promise((M,k)=>{d=t.rejectOnCancel?k:M,C&&!a&&(a=setTimeout(()=>{i&&p(i),a=null,M(r())},C)),i=setTimeout(()=>{a&&p(a),a=null,M(r())},S)})}}function Zq(e,t=!0,i=!0,a=!1){let d=0,p,_=!0,r=Im,S;const C=()=>{p&&(clearTimeout(p),p=void 0,r(),r=Im)};return k=>{const z=Wd(e),F=Date.now()-d,B=()=>S=k();return C(),z<=0?(d=Date.now(),B()):(F>z&&(i||!_)?(d=Date.now(),B()):t&&(S=new Promise((N,j)=>{r=a?j:N,p=setTimeout(()=>{d=Date.now(),_=!0,N(B()),C()},Math.max(0,z-F))})),!i&&!p&&(p=setTimeout(()=>_=!0,z)),_=!1,S)}}function Yq(e){return e}function Xq(e,t){let i,a,d;const p=Se(!0),_=()=>{p.value=!0,d()};qt(e,_,{flush:"sync"});const r=XS(t)?t:t.get,S=XS(t)?void 0:t.set,C=y6((M,k)=>(a=M,d=k,{get(){return p.value&&(i=r(),p.value=!1),a(),i},set(z){S==null||S(z)}}));return Object.isExtensible(C)&&(C.trigger=_),C}function by(e){return pC()?(mC(e),!0):!1}function Jq(e,t=200,i={}){return cz(Kq(t,i),e)}function Qq(e,t=200,i={}){const a=Se(e.value),d=Jq(()=>{a.value=e.value},t,i);return qt(e,()=>d()),a}function uz(e,t=200,i=!1,a=!0,d=!1){return cz(Zq(t,i,a,d),e)}function qC(e,t=!0){wr()?gr(e):t?e():Vn(e)}function Of(e,t,i={}){const{immediate:a=!0}=i,d=Se(!1);let p=null;function _(){p&&(clearTimeout(p),p=null)}function r(){d.value=!1,_()}function S(...C){_(),d.value=!0,p=setTimeout(()=>{d.value=!1,p=null,e(...C)},Wd(t))}return a&&(d.value=!0,Hr&&S()),by(r),{isPending:Wm(d),start:S,stop:r}}function aa(e){var t;const i=Wd(e);return(t=i==null?void 0:i.$el)!=null?t:i}const nh=Hr?window:void 0,e9=Hr?window.document:void 0;function So(...e){let t,i,a,d;if(qq(e[0])||Array.isArray(e[0])?([i,a,d]=e,t=nh):[t,i,a,d]=e,!t)return Im;Array.isArray(i)||(i=[i]),Array.isArray(a)||(a=[a]);const p=[],_=()=>{p.forEach(M=>M()),p.length=0},r=(M,k,z,F)=>(M.addEventListener(k,z,F),()=>M.removeEventListener(k,z,F)),S=qt(()=>[aa(t),Wd(d)],([M,k])=>{_(),M&&p.push(...i.flatMap(z=>a.map(F=>r(M,z,F,k))))},{immediate:!0,flush:"post"}),C=()=>{S(),_()};return by(C),C}let y3=!1;function KC(e,t,i={}){const{window:a=nh,ignore:d=[],capture:p=!0,detectIframe:_=!1}=i;if(!a)return;JS&&!y3&&(y3=!0,Array.from(a.document.body.children).forEach(z=>z.addEventListener("click",Im)));let r=!0;const S=z=>d.some(F=>{if(typeof F=="string")return Array.from(a.document.querySelectorAll(F)).some(B=>B===z.target||z.composedPath().includes(B));{const B=aa(F);return B&&(z.target===B||z.composedPath().includes(B))}}),M=[So(a,"click",z=>{const F=aa(e);if(!(!F||F===z.target||z.composedPath().includes(F))){if(z.detail===0&&(r=!S(z)),!r){r=!0;return}t(z)}},{passive:!0,capture:p}),So(a,"pointerdown",z=>{const F=aa(e);F&&(r=!z.composedPath().includes(F)&&!S(z))},{passive:!0}),_&&So(a,"blur",z=>{var F;const B=aa(e);((F=a.document.activeElement)==null?void 0:F.tagName)==="IFRAME"&&!(B!=null&&B.contains(a.document.activeElement))&&t(z)})].filter(Boolean);return()=>M.forEach(z=>z())}function t9(e={}){var t;const{window:i=nh}=e,a=(t=e.document)!=null?t:i==null?void 0:i.document,d=Xq(()=>null,()=>a==null?void 0:a.activeElement);return i&&(So(i,"blur",p=>{p.relatedTarget===null&&d.trigger()},!0),So(i,"focus",d.trigger,!0)),d}function dz(e,t=!1){const i=Se(),a=()=>i.value=!!e();return a(),qC(a,t),i}function n9(e){return JSON.parse(JSON.stringify(e))}const b3=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},x3="__vueuse_ssr_handlers__";b3[x3]=b3[x3]||{};function r9(e,t,{window:i=nh,initialValue:a=""}={}){const d=Se(a),p=ee(()=>{var _;return aa(t)||((_=i==null?void 0:i.document)==null?void 0:_.documentElement)});return qt([p,()=>Wd(e)],([_,r])=>{var S;if(_&&i){const C=(S=i.getComputedStyle(_).getPropertyValue(r))==null?void 0:S.trim();d.value=C||a}},{immediate:!0}),qt(d,_=>{var r;(r=p.value)!=null&&r.style&&p.value.style.setProperty(Wd(e),_)}),d}function o9({document:e=e9}={}){if(!e)return Se("visible");const t=Se(e.visibilityState);return So(e,"visibilitychange",()=>{t.value=e.visibilityState}),t}var w3=Object.getOwnPropertySymbols,i9=Object.prototype.hasOwnProperty,s9=Object.prototype.propertyIsEnumerable,a9=(e,t)=>{var i={};for(var a in e)i9.call(e,a)&&t.indexOf(a)<0&&(i[a]=e[a]);if(e!=null&&w3)for(var a of w3(e))t.indexOf(a)<0&&s9.call(e,a)&&(i[a]=e[a]);return i};function ti(e,t,i={}){const a=i,{window:d=nh}=a,p=a9(a,["window"]);let _;const r=dz(()=>d&&"ResizeObserver"in d),S=()=>{_&&(_.disconnect(),_=void 0)},C=qt(()=>aa(e),k=>{S(),r.value&&d&&k&&(_=new ResizeObserver(t),_.observe(k,p))},{immediate:!0,flush:"post"}),M=()=>{S(),C()};return by(M),{isSupported:r,stop:M}}function S3(e,t={}){const{reset:i=!0,windowResize:a=!0,windowScroll:d=!0,immediate:p=!0}=t,_=Se(0),r=Se(0),S=Se(0),C=Se(0),M=Se(0),k=Se(0),z=Se(0),F=Se(0);function B(){const N=aa(e);if(!N){i&&(_.value=0,r.value=0,S.value=0,C.value=0,M.value=0,k.value=0,z.value=0,F.value=0);return}const j=N.getBoundingClientRect();_.value=j.height,r.value=j.bottom,S.value=j.left,C.value=j.right,M.value=j.top,k.value=j.width,z.value=j.x,F.value=j.y}return ti(e,B),qt(()=>aa(e),N=>!N&&B()),d&&So("scroll",B,{capture:!0,passive:!0}),a&&So("resize",B,{passive:!0}),qC(()=>{p&&B()}),{height:_,bottom:r,left:S,right:C,top:M,width:k,x:z,y:F,update:B}}var T3=Object.getOwnPropertySymbols,l9=Object.prototype.hasOwnProperty,c9=Object.prototype.propertyIsEnumerable,u9=(e,t)=>{var i={};for(var a in e)l9.call(e,a)&&t.indexOf(a)<0&&(i[a]=e[a]);if(e!=null&&T3)for(var a of T3(e))t.indexOf(a)<0&&c9.call(e,a)&&(i[a]=e[a]);return i};function hz(e,t,i={}){const a=i,{window:d=nh}=a,p=u9(a,["window"]);let _;const r=dz(()=>d&&"MutationObserver"in d),S=()=>{_&&(_.disconnect(),_=void 0)},C=qt(()=>aa(e),k=>{S(),r.value&&d&&k&&(_=new MutationObserver(t),_.observe(k,p))},{immediate:!0}),M=()=>{S(),C()};return by(M),{isSupported:r,stop:M}}var C3;(function(e){e.UP="UP",e.RIGHT="RIGHT",e.DOWN="DOWN",e.LEFT="LEFT",e.NONE="NONE"})(C3||(C3={}));var d9=Object.defineProperty,E3=Object.getOwnPropertySymbols,h9=Object.prototype.hasOwnProperty,f9=Object.prototype.propertyIsEnumerable,M3=(e,t,i)=>t in e?d9(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,p9=(e,t)=>{for(var i in t||(t={}))h9.call(t,i)&&M3(e,i,t[i]);if(E3)for(var i of E3(t))f9.call(t,i)&&M3(e,i,t[i]);return e};const m9={easeInSine:[.12,0,.39,0],easeOutSine:[.61,1,.88,1],easeInOutSine:[.37,0,.63,1],easeInQuad:[.11,0,.5,0],easeOutQuad:[.5,1,.89,1],easeInOutQuad:[.45,0,.55,1],easeInCubic:[.32,0,.67,0],easeOutCubic:[.33,1,.68,1],easeInOutCubic:[.65,0,.35,1],easeInQuart:[.5,0,.75,0],easeOutQuart:[.25,1,.5,1],easeInOutQuart:[.76,0,.24,1],easeInQuint:[.64,0,.78,0],easeOutQuint:[.22,1,.36,1],easeInOutQuint:[.83,0,.17,1],easeInExpo:[.7,0,.84,0],easeOutExpo:[.16,1,.3,1],easeInOutExpo:[.87,0,.13,1],easeInCirc:[.55,0,1,.45],easeOutCirc:[0,.55,.45,1],easeInOutCirc:[.85,0,.15,1],easeInBack:[.36,0,.66,-.56],easeOutBack:[.34,1.56,.64,1],easeInOutBack:[.68,-.6,.32,1.6]};p9({linear:Yq},m9);function fz(e,t,i,a={}){var d,p,_;const{clone:r=!1,passive:S=!1,eventName:C,deep:M=!1,defaultValue:k}=a,z=wr(),F=i||(z==null?void 0:z.emit)||((d=z==null?void 0:z.$emit)==null?void 0:d.bind(z))||((_=(p=z==null?void 0:z.proxy)==null?void 0:p.$emit)==null?void 0:_.bind(z==null?void 0:z.proxy));let B=C;t||(t="modelValue"),B=C||B||`update:${t.toString()}`;const N=U=>r?XS(r)?r(U):n9(U):U,j=()=>Wq(e[t])?N(e[t]):k;if(S){const U=j(),te=Se(U);return qt(()=>e[t],Y=>te.value=N(Y)),qt(te,Y=>{(Y!==e[t]||M)&&F(B,Y)},{deep:M}),te}else return ee({get(){return j()},set(U){F(B,U)}})}function g9({window:e=nh}={}){if(!e)return Se(!1);const t=Se(e.document.hasFocus());return So(e,"blur",()=>{t.value=!1}),So(e,"focus",()=>{t.value=!0}),t}function v9(e={}){const{window:t=nh,initialWidth:i=1/0,initialHeight:a=1/0,listenOrientation:d=!0,includeScrollbar:p=!0}=e,_=Se(i),r=Se(a),S=()=>{t&&(p?(_.value=t.innerWidth,r.value=t.innerHeight):(_.value=t.document.documentElement.clientWidth,r.value=t.document.documentElement.clientHeight))};return S(),qC(S),So("resize",S,{passive:!0}),d&&So("orientationchange",S,{passive:!0}),{width:_,height:r}}class _9 extends Error{constructor(t){super(t),this.name="ElementPlusError"}}function ji(e,t){throw new _9(`[${e}] ${t}`)}const I3={current:0},A3=Se(0),pz=2e3,k3=Symbol("elZIndexContextKey"),mz=Symbol("zIndexContextKey"),Jm=e=>{const t=wr()?An(k3,I3):I3,i=e||(wr()?An(mz,void 0):void 0),a=ee(()=>{const _=b(i);return Gn(_)?_:pz}),d=ee(()=>a.value+A3.value),p=()=>(t.current++,A3.value=t.current,d.value);return!Hr&&An(k3),{initialZIndex:a,currentZIndex:d,nextZIndex:p}};var y9={name:"en",el:{breadcrumb:{label:"Breadcrumb"},colorpicker:{confirm:"OK",clear:"Clear",defaultLabel:"color picker",description:"current color is {color}. press enter to select a new color.",alphaLabel:"pick alpha value"},datepicker:{now:"Now",today:"Today",cancel:"Cancel",clear:"Clear",confirm:"OK",dateTablePrompt:"Use the arrow keys and enter to select the day of the month",monthTablePrompt:"Use the arrow keys and enter to select the month",yearTablePrompt:"Use the arrow keys and enter to select the year",selectedDate:"Selected date",selectDate:"Select date",selectTime:"Select time",startDate:"Start Date",startTime:"Start Time",endDate:"End Date",endTime:"End Time",prevYear:"Previous Year",nextYear:"Next Year",prevMonth:"Previous Month",nextMonth:"Next Month",year:"",month1:"January",month2:"February",month3:"March",month4:"April",month5:"May",month6:"June",month7:"July",month8:"August",month9:"September",month10:"October",month11:"November",month12:"December",week:"week",weeks:{sun:"Sun",mon:"Mon",tue:"Tue",wed:"Wed",thu:"Thu",fri:"Fri",sat:"Sat"},weeksFull:{sun:"Sunday",mon:"Monday",tue:"Tuesday",wed:"Wednesday",thu:"Thursday",fri:"Friday",sat:"Saturday"},months:{jan:"Jan",feb:"Feb",mar:"Mar",apr:"Apr",may:"May",jun:"Jun",jul:"Jul",aug:"Aug",sep:"Sep",oct:"Oct",nov:"Nov",dec:"Dec"}},inputNumber:{decrease:"decrease number",increase:"increase number"},select:{loading:"Loading",noMatch:"No matching data",noData:"No data",placeholder:"Select"},mention:{loading:"Loading"},dropdown:{toggleDropdown:"Toggle Dropdown"},cascader:{noMatch:"No matching data",loading:"Loading",placeholder:"Select",noData:"No data"},pagination:{goto:"Go to",pagesize:"/page",total:"Total {total}",pageClassifier:"",page:"Page",prev:"Go to previous page",next:"Go to next page",currentPage:"page {pager}",prevPages:"Previous {pager} pages",nextPages:"Next {pager} pages",deprecationWarning:"Deprecated usages detected, please refer to the el-pagination documentation for more details"},dialog:{close:"Close this dialog"},drawer:{close:"Close this dialog"},messagebox:{title:"Message",confirm:"OK",cancel:"Cancel",error:"Illegal input",close:"Close this dialog"},upload:{deleteTip:"press delete to remove",delete:"Delete",preview:"Preview",continue:"Continue"},slider:{defaultLabel:"slider between {min} and {max}",defaultRangeStartLabel:"pick start value",defaultRangeEndLabel:"pick end value"},table:{emptyText:"No Data",confirmFilter:"Confirm",resetFilter:"Reset",clearFilter:"All",sumText:"Sum"},tour:{next:"Next",previous:"Previous",finish:"Finish"},tree:{emptyText:"No Data"},transfer:{noMatch:"No matching data",noData:"No data",titles:["List 1","List 2"],filterPlaceholder:"Enter keyword",noCheckedFormat:"{total} items",hasCheckedFormat:"{checked}/{total} checked"},image:{error:"FAILED"},pageHeader:{title:"Back"},popconfirm:{confirmButtonText:"Yes",cancelButtonText:"No"},carousel:{leftArrow:"Carousel arrow left",rightArrow:"Carousel arrow right",indicator:"Carousel switch to index {index}"}}};const b9=e=>(t,i)=>x9(t,i,b(e)),x9=(e,t,i)=>Ii(i,e,e).replace(/\{(\w+)\}/g,(a,d)=>{var p;return`${(p=t==null?void 0:t[d])!=null?p:`{${d}}`}`}),w9=e=>{const t=ee(()=>b(e).name),i=To(e)?e:Se(e);return{lang:t,locale:i,t:b9(e)}},gz=Symbol("localeContextKey"),Gr=e=>{const t=e||An(gz,Se());return w9(ee(()=>t.value||y9))},vz="__epPropKey",dt=e=>e,S9=e=>yr(e)&&!!e[vz],pc=(e,t)=>{if(!yr(e)||S9(e))return e;const{values:i,required:a,default:d,type:p,validator:_}=e,S={type:p,required:!!a,validator:i||_?C=>{let M=!1,k=[];if(i&&(k=Array.from(i),to(e,"default")&&k.push(d),M||(M=k.includes(C))),_&&(M||(M=_(C))),!M&&k.length>0){const z=[...new Set(k)].map(F=>JSON.stringify(F)).join(", ");E8(`Invalid prop: validation failed${t?` for prop "${t}"`:""}. Expected one of [${z}], got value ${JSON.stringify(C)}.`)}return M}:void 0,[vz]:!0};return to(e,"default")&&(S.default=d),S},un=e=>q_(Object.entries(e).map(([t,i])=>[t,pc(i,t)])),Zc=["","default","small","large"],zi=pc({type:String,values:Zc,required:!1}),_z=Symbol("size"),yz=()=>{const e=An(_z,{});return ee(()=>b(e.size)||"")},bz=Symbol("emptyValuesContextKey"),T9=["",void 0,null],C9=void 0,Qm=un({emptyValues:Array,valueOnClear:{type:[String,Number,Boolean,Function],default:void 0,validator:e=>Nn(e)?!e():!e}}),dx=(e,t)=>{const i=wr()?An(bz,Se({})):Se({}),a=ee(()=>e.emptyValues||i.value.emptyValues||T9),d=ee(()=>Nn(e.valueOnClear)?e.valueOnClear():e.valueOnClear!==void 0?e.valueOnClear:Nn(i.value.valueOnClear)?i.value.valueOnClear():i.value.valueOnClear!==void 0?i.value.valueOnClear:t!==void 0?t:C9),p=_=>a.value.includes(_);return a.value.includes(d.value),{emptyValues:a,valueOnClear:d,isEmptyValue:p}},Am=e=>Object.keys(e),xz=e=>Object.entries(e),M_=(e,t,i)=>({get value(){return Ii(e,t,i)},set value(a){Rq(e,t,a)}}),x1=Se();function hx(e,t=void 0){const i=wr()?An(bD,x1):x1;return e?ee(()=>{var a,d;return(d=(a=i.value)==null?void 0:a[e])!=null?d:t}):i}function fx(e,t){const i=hx(),a=en(e,ee(()=>{var r;return((r=i.value)==null?void 0:r.namespace)||C_})),d=Gr(ee(()=>{var r;return(r=i.value)==null?void 0:r.locale})),p=Jm(ee(()=>{var r;return((r=i.value)==null?void 0:r.zIndex)||pz})),_=ee(()=>{var r;return b(t)||((r=i.value)==null?void 0:r.size)||""});return ZC(ee(()=>b(i)||{})),{ns:a,locale:d,zIndex:p,size:_}}const ZC=(e,t,i=!1)=>{var a;const d=!!wr(),p=d?hx():void 0,_=(a=t==null?void 0:t.provide)!=null?a:d?Dr:void 0;if(!_)return;const r=ee(()=>{const S=b(e);return p!=null&&p.value?E9(p.value,S):S});return _(bD,r),_(gz,ee(()=>r.value.locale)),_(xD,ee(()=>r.value.namespace)),_(mz,ee(()=>r.value.zIndex)),_(_z,{size:ee(()=>r.value.size||"")}),_(bz,ee(()=>({emptyValues:r.value.emptyValues,valueOnClear:r.value.valueOnClear}))),(i||!x1.value)&&(x1.value=r.value),r},E9=(e,t)=>{const i=[...new Set([...Am(e),...Am(t)])],a={};for(const d of i)a[d]=t[d]!==void 0?t[d]:e[d];return a},M9=(e=[])=>({version:fU,install:(i,a)=>{i[NP]||(i[NP]=!0,e.forEach(d=>i.use(d)),a&&ZC(a,i,!0))}}),mr="update:modelValue",Eo="change",Es="input",I9=un({zIndex:{type:dt([Number,String]),default:100},target:{type:String,default:""},offset:{type:Number,default:0},position:{type:String,values:["top","bottom"],default:"top"}}),A9={scroll:({scrollTop:e,fixed:t})=>Gn(e)&&Ro(t),[Eo]:e=>Ro(e)};var fn=(e,t)=>{const i=e.__vccOpts||e;for(const[a,d]of t)i[a]=d;return i};function k9(e,t,i,a){const d=i-t;return e/=a/2,e<1?d/2*e*e*e+t:d/2*((e-=2)*e*e+2)+t}const qd=e=>Hr?window.requestAnimationFrame(e):setTimeout(e,16),Lf=e=>Hr?window.cancelAnimationFrame(e):clearTimeout(e),wz=(e="")=>e.split(" ").filter(t=>!!t.trim()),Aa=(e,t)=>{if(!e||!t)return!1;if(t.includes(" "))throw new Error("className should not contain space.");return e.classList.contains(t)},bl=(e,t)=>{!e||!t.trim()||e.classList.add(...wz(t))},js=(e,t)=>{!e||!t.trim()||e.classList.remove(...wz(t))},Pu=(e,t)=>{var i;if(!Hr||!e||!t)return"";let a=da(t);a==="float"&&(a="cssFloat");try{const d=e.style[a];if(d)return d;const p=(i=document.defaultView)==null?void 0:i.getComputedStyle(e,"");return p?p[a]:""}catch{return e.style[a]}},Sz=(e,t,i)=>{if(!(!e||!t))if(yr(t))xz(t).forEach(([a,d])=>Sz(e,a,d));else{const a=da(t);e.style[a]=i}};function ui(e,t="px"){if(!e)return"";if(Gn(e)||Nq(e))return`${e}${t}`;if(Dn(e))return e}const P9=(e,t)=>{if(!Hr)return!1;const i={undefined:"overflow",true:"overflow-y",false:"overflow-x"}[String(t)],a=Pu(e,i);return["scroll","auto","overlay"].some(d=>a.includes(d))},YC=(e,t)=>{if(!Hr)return;let i=e;for(;i;){if([window,document,document.documentElement].includes(i))return window;if(P9(i,t))return i;i=i.parentNode}return i};let xb;const Tz=e=>{var t;if(!Hr)return 0;if(xb!==void 0)return xb;const i=document.createElement("div");i.className=`${e}-scrollbar__wrap`,i.style.visibility="hidden",i.style.width="100px",i.style.position="absolute",i.style.top="-9999px",document.body.appendChild(i);const a=i.offsetWidth;i.style.overflow="scroll";const d=document.createElement("div");d.style.width="100%",i.appendChild(d);const p=d.offsetWidth;return(t=i.parentNode)==null||t.removeChild(i),xb=a-p,xb};function XC(e,t){if(!Hr)return;if(!t){e.scrollTop=0;return}const i=[];let a=t.offsetParent;for(;a!==null&&e!==a&&e.contains(a);)i.push(a),a=a.offsetParent;const d=t.offsetTop+i.reduce((S,C)=>S+C.offsetTop,0),p=d+t.offsetHeight,_=e.scrollTop,r=_+e.clientHeight;d<_?e.scrollTop=d:p>r&&(e.scrollTop=p-e.clientHeight)}function R9(e,t,i,a,d){const p=Date.now();let _;const r=()=>{const C=Date.now()-p,M=k9(C>a?a:C,t,i,a);ux(e)?e.scrollTo(window.pageXOffset,M):e.scrollTop=M,C<a?_=qd(r):Nn(d)&&d()};return r(),()=>{_&&Lf(_)}}const P3=(e,t)=>ux(t)?e.ownerDocument.documentElement:t,R3=e=>ux(e)?window.scrollY:e.scrollTop,Cz="ElAffix",O9=qe({name:Cz}),L9=qe({...O9,props:I9,emits:A9,setup(e,{expose:t,emit:i}){const a=e,d=en("affix"),p=Uo(),_=Uo(),r=Uo(),{height:S}=v9(),{height:C,width:M,top:k,bottom:z,update:F}=S3(_,{windowScroll:!1}),B=S3(p),N=Se(!1),j=Se(0),U=Se(0),te=ee(()=>({height:N.value?`${C.value}px`:"",width:N.value?`${M.value}px`:""})),Y=ee(()=>{if(!N.value)return{};const ne=a.offset?ui(a.offset):0;return{height:`${C.value}px`,width:`${M.value}px`,top:a.position==="top"?ne:"",bottom:a.position==="bottom"?ne:"",transform:U.value?`translateY(${U.value}px)`:"",zIndex:a.zIndex}}),q=()=>{if(!r.value)return;j.value=r.value instanceof Window?document.documentElement.scrollTop:r.value.scrollTop||0;const{position:ne,target:se,offset:fe}=a,ce=fe+C.value;if(ne==="top")if(se){const le=B.bottom.value-ce;N.value=fe>k.value&&B.bottom.value>0,U.value=le<0?le:0}else N.value=fe>k.value;else if(se){const le=S.value-B.top.value-ce;N.value=S.value-fe<z.value&&S.value>B.top.value,U.value=le<0?-le:0}else N.value=S.value-fe<z.value},J=()=>{F(),i("scroll",{scrollTop:j.value,fixed:N.value})};return qt(N,ne=>i("change",ne)),gr(()=>{var ne;a.target?(p.value=(ne=document.querySelector(a.target))!=null?ne:void 0,p.value||ji(Cz,`Target does not exist: ${a.target}`)):p.value=document.documentElement,r.value=YC(_.value,!0),F()}),So(r,"scroll",J),Cs(q),t({update:q,updateRoot:F}),(ne,se)=>(ae(),Oe("div",{ref_key:"root",ref:_,class:pe(b(d).b()),style:$n(b(te))},[Ue("div",{class:pe({[b(d).m("fixed")]:N.value}),style:$n(b(Y))},[pt(ne.$slots,"default")],6)],6))}});var D9=fn(L9,[["__file","affix.vue"]]);const ur=(e,t)=>{if(e.install=i=>{for(const a of[e,...Object.values(t??{})])i.component(a.name,a)},t)for(const[i,a]of Object.entries(t))e[i]=a;return e},Ez=(e,t)=>(e.install=i=>{e._context=i._context,i.config.globalProperties[t]=e},e),z9=(e,t)=>(e.install=i=>{i.directive(t,e)},e),ri=e=>(e.install=_o,e),F9=ur(D9),N9=un({size:{type:dt([Number,String])},color:{type:String}}),B9=qe({name:"ElIcon",inheritAttrs:!1}),V9=qe({...B9,props:N9,setup(e){const t=e,i=en("icon"),a=ee(()=>{const{size:d,color:p}=t;return!d&&!p?{}:{fontSize:oo(d)?void 0:ui(d),"--color":p}});return(d,p)=>(ae(),Oe("i",Mr({class:b(i).b(),style:b(a)},d.$attrs),[pt(d.$slots,"default")],16))}});var $9=fn(V9,[["__file","icon.vue"]]);const On=ur($9);/*! Element Plus Icons Vue v2.3.1 */var U9=qe({name:"ArrowDown",__name:"arrow-down",setup(e){return(t,i)=>(ae(),Oe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ue("path",{fill:"currentColor",d:"M831.872 340.864 512 652.672 192.128 340.864a30.592 30.592 0 0 0-42.752 0 29.12 29.12 0 0 0 0 41.6L489.664 714.24a32 32 0 0 0 44.672 0l340.288-331.712a29.12 29.12 0 0 0 0-41.728 30.592 30.592 0 0 0-42.752 0z"})]))}}),Gu=U9,j9=qe({name:"ArrowLeft",__name:"arrow-left",setup(e){return(t,i)=>(ae(),Oe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ue("path",{fill:"currentColor",d:"M609.408 149.376 277.76 489.6a32 32 0 0 0 0 44.672l331.648 340.352a29.12 29.12 0 0 0 41.728 0 30.592 30.592 0 0 0 0-42.752L339.264 511.936l311.872-319.872a30.592 30.592 0 0 0 0-42.688 29.12 29.12 0 0 0-41.728 0z"})]))}}),Kd=j9,H9=qe({name:"ArrowRight",__name:"arrow-right",setup(e){return(t,i)=>(ae(),Oe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ue("path",{fill:"currentColor",d:"M340.864 149.312a30.592 30.592 0 0 0 0 42.752L652.736 512 340.864 831.872a30.592 30.592 0 0 0 0 42.752 29.12 29.12 0 0 0 41.728 0L714.24 534.336a32 32 0 0 0 0-44.672L382.592 149.376a29.12 29.12 0 0 0-41.728 0z"})]))}}),ca=H9,G9=qe({name:"ArrowUp",__name:"arrow-up",setup(e){return(t,i)=>(ae(),Oe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ue("path",{fill:"currentColor",d:"m488.832 344.32-339.84 356.672a32 32 0 0 0 0 44.16l.384.384a29.44 29.44 0 0 0 42.688 0l320-335.872 319.872 335.872a29.44 29.44 0 0 0 42.688 0l.384-.384a32 32 0 0 0 0-44.16L535.168 344.32a32 32 0 0 0-46.336 0"})]))}}),JC=G9,W9=qe({name:"Back",__name:"back",setup(e){return(t,i)=>(ae(),Oe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ue("path",{fill:"currentColor",d:"M224 480h640a32 32 0 1 1 0 64H224a32 32 0 0 1 0-64"}),Ue("path",{fill:"currentColor",d:"m237.248 512 265.408 265.344a32 32 0 0 1-45.312 45.312l-288-288a32 32 0 0 1 0-45.312l288-288a32 32 0 1 1 45.312 45.312z"})]))}}),q9=W9,K9=qe({name:"Calendar",__name:"calendar",setup(e){return(t,i)=>(ae(),Oe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ue("path",{fill:"currentColor",d:"M128 384v512h768V192H768v32a32 32 0 1 1-64 0v-32H320v32a32 32 0 0 1-64 0v-32H128v128h768v64zm192-256h384V96a32 32 0 1 1 64 0v32h160a32 32 0 0 1 32 32v768a32 32 0 0 1-32 32H96a32 32 0 0 1-32-32V160a32 32 0 0 1 32-32h160V96a32 32 0 0 1 64 0zm-32 384h64a32 32 0 0 1 0 64h-64a32 32 0 0 1 0-64m0 192h64a32 32 0 1 1 0 64h-64a32 32 0 1 1 0-64m192-192h64a32 32 0 0 1 0 64h-64a32 32 0 0 1 0-64m0 192h64a32 32 0 1 1 0 64h-64a32 32 0 1 1 0-64m192-192h64a32 32 0 1 1 0 64h-64a32 32 0 1 1 0-64m0 192h64a32 32 0 1 1 0 64h-64a32 32 0 1 1 0-64"})]))}}),Z9=K9,Y9=qe({name:"CaretRight",__name:"caret-right",setup(e){return(t,i)=>(ae(),Oe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ue("path",{fill:"currentColor",d:"M384 192v640l384-320.064z"})]))}}),Mz=Y9,X9=qe({name:"CaretTop",__name:"caret-top",setup(e){return(t,i)=>(ae(),Oe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ue("path",{fill:"currentColor",d:"M512 320 192 704h639.936z"})]))}}),J9=X9,Q9=qe({name:"Check",__name:"check",setup(e){return(t,i)=>(ae(),Oe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ue("path",{fill:"currentColor",d:"M406.656 706.944 195.84 496.256a32 32 0 1 0-45.248 45.248l256 256 512-512a32 32 0 0 0-45.248-45.248L406.592 706.944z"})]))}}),xy=Q9,e7=qe({name:"CircleCheckFilled",__name:"circle-check-filled",setup(e){return(t,i)=>(ae(),Oe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ue("path",{fill:"currentColor",d:"M512 64a448 448 0 1 1 0 896 448 448 0 0 1 0-896m-55.808 536.384-99.52-99.584a38.4 38.4 0 1 0-54.336 54.336l126.72 126.72a38.272 38.272 0 0 0 54.336 0l262.4-262.464a38.4 38.4 0 1 0-54.272-54.336z"})]))}}),t7=e7,n7=qe({name:"CircleCheck",__name:"circle-check",setup(e){return(t,i)=>(ae(),Oe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ue("path",{fill:"currentColor",d:"M512 896a384 384 0 1 0 0-768 384 384 0 0 0 0 768m0 64a448 448 0 1 1 0-896 448 448 0 0 1 0 896"}),Ue("path",{fill:"currentColor",d:"M745.344 361.344a32 32 0 0 1 45.312 45.312l-288 288a32 32 0 0 1-45.312 0l-160-160a32 32 0 1 1 45.312-45.312L480 626.752l265.344-265.408z"})]))}}),QC=n7,r7=qe({name:"CircleCloseFilled",__name:"circle-close-filled",setup(e){return(t,i)=>(ae(),Oe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ue("path",{fill:"currentColor",d:"M512 64a448 448 0 1 1 0 896 448 448 0 0 1 0-896m0 393.664L407.936 353.6a38.4 38.4 0 1 0-54.336 54.336L457.664 512 353.6 616.064a38.4 38.4 0 1 0 54.336 54.336L512 566.336 616.064 670.4a38.4 38.4 0 1 0 54.336-54.336L566.336 512 670.4 407.936a38.4 38.4 0 1 0-54.336-54.336z"})]))}}),eE=r7,o7=qe({name:"CircleClose",__name:"circle-close",setup(e){return(t,i)=>(ae(),Oe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ue("path",{fill:"currentColor",d:"m466.752 512-90.496-90.496a32 32 0 0 1 45.248-45.248L512 466.752l90.496-90.496a32 32 0 1 1 45.248 45.248L557.248 512l90.496 90.496a32 32 0 1 1-45.248 45.248L512 557.248l-90.496 90.496a32 32 0 0 1-45.248-45.248z"}),Ue("path",{fill:"currentColor",d:"M512 896a384 384 0 1 0 0-768 384 384 0 0 0 0 768m0 64a448 448 0 1 1 0-896 448 448 0 0 1 0 896"})]))}}),Wu=o7,i7=qe({name:"Clock",__name:"clock",setup(e){return(t,i)=>(ae(),Oe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ue("path",{fill:"currentColor",d:"M512 896a384 384 0 1 0 0-768 384 384 0 0 0 0 768m0 64a448 448 0 1 1 0-896 448 448 0 0 1 0 896"}),Ue("path",{fill:"currentColor",d:"M480 256a32 32 0 0 1 32 32v256a32 32 0 0 1-64 0V288a32 32 0 0 1 32-32"}),Ue("path",{fill:"currentColor",d:"M480 512h256q32 0 32 32t-32 32H480q-32 0-32-32t32-32"})]))}}),Iz=i7,s7=qe({name:"Close",__name:"close",setup(e){return(t,i)=>(ae(),Oe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ue("path",{fill:"currentColor",d:"M764.288 214.592 512 466.88 259.712 214.592a31.936 31.936 0 0 0-45.12 45.12L466.752 512 214.528 764.224a31.936 31.936 0 1 0 45.12 45.184L512 557.184l252.288 252.288a31.936 31.936 0 0 0 45.12-45.12L557.12 512.064l252.288-252.352a31.936 31.936 0 1 0-45.12-45.184z"})]))}}),sc=s7,a7=qe({name:"DArrowLeft",__name:"d-arrow-left",setup(e){return(t,i)=>(ae(),Oe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ue("path",{fill:"currentColor",d:"M529.408 149.376a29.12 29.12 0 0 1 41.728 0 30.592 30.592 0 0 1 0 42.688L259.264 511.936l311.872 319.936a30.592 30.592 0 0 1-.512 43.264 29.12 29.12 0 0 1-41.216-.512L197.76 534.272a32 32 0 0 1 0-44.672l331.648-340.224zm256 0a29.12 29.12 0 0 1 41.728 0 30.592 30.592 0 0 1 0 42.688L515.264 511.936l311.872 319.936a30.592 30.592 0 0 1-.512 43.264 29.12 29.12 0 0 1-41.216-.512L453.76 534.272a32 32 0 0 1 0-44.672l331.648-340.224z"})]))}}),Zd=a7,l7=qe({name:"DArrowRight",__name:"d-arrow-right",setup(e){return(t,i)=>(ae(),Oe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ue("path",{fill:"currentColor",d:"M452.864 149.312a29.12 29.12 0 0 1 41.728.064L826.24 489.664a32 32 0 0 1 0 44.672L494.592 874.624a29.12 29.12 0 0 1-41.728 0 30.592 30.592 0 0 1 0-42.752L764.736 512 452.864 192a30.592 30.592 0 0 1 0-42.688m-256 0a29.12 29.12 0 0 1 41.728.064L570.24 489.664a32 32 0 0 1 0 44.672L238.592 874.624a29.12 29.12 0 0 1-41.728 0 30.592 30.592 0 0 1 0-42.752L508.736 512 196.864 192a30.592 30.592 0 0 1 0-42.688z"})]))}}),Yd=l7,c7=qe({name:"Delete",__name:"delete",setup(e){return(t,i)=>(ae(),Oe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ue("path",{fill:"currentColor",d:"M160 256H96a32 32 0 0 1 0-64h256V95.936a32 32 0 0 1 32-32h256a32 32 0 0 1 32 32V192h256a32 32 0 1 1 0 64h-64v672a32 32 0 0 1-32 32H192a32 32 0 0 1-32-32zm448-64v-64H416v64zM224 896h576V256H224zm192-128a32 32 0 0 1-32-32V416a32 32 0 0 1 64 0v320a32 32 0 0 1-32 32m192 0a32 32 0 0 1-32-32V416a32 32 0 0 1 64 0v320a32 32 0 0 1-32 32"})]))}}),u7=c7,d7=qe({name:"Document",__name:"document",setup(e){return(t,i)=>(ae(),Oe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ue("path",{fill:"currentColor",d:"M832 384H576V128H192v768h640zm-26.496-64L640 154.496V320zM160 64h480l256 256v608a32 32 0 0 1-32 32H160a32 32 0 0 1-32-32V96a32 32 0 0 1 32-32m160 448h384v64H320zm0-192h160v64H320zm0 384h384v64H320z"})]))}}),h7=d7,f7=qe({name:"FullScreen",__name:"full-screen",setup(e){return(t,i)=>(ae(),Oe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ue("path",{fill:"currentColor",d:"m160 96.064 192 .192a32 32 0 0 1 0 64l-192-.192V352a32 32 0 0 1-64 0V96h64zm0 831.872V928H96V672a32 32 0 1 1 64 0v191.936l192-.192a32 32 0 1 1 0 64zM864 96.064V96h64v256a32 32 0 1 1-64 0V160.064l-192 .192a32 32 0 1 1 0-64l192-.192zm0 831.872-192-.192a32 32 0 0 1 0-64l192 .192V672a32 32 0 1 1 64 0v256h-64z"})]))}}),p7=f7,m7=qe({name:"Hide",__name:"hide",setup(e){return(t,i)=>(ae(),Oe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ue("path",{fill:"currentColor",d:"M876.8 156.8c0-9.6-3.2-16-9.6-22.4-6.4-6.4-12.8-9.6-22.4-9.6-9.6 0-16 3.2-22.4 9.6L736 220.8c-64-32-137.6-51.2-224-60.8-160 16-288 73.6-377.6 176C44.8 438.4 0 496 0 512s48 73.6 134.4 176c22.4 25.6 44.8 48 73.6 67.2l-86.4 89.6c-6.4 6.4-9.6 12.8-9.6 22.4 0 9.6 3.2 16 9.6 22.4 6.4 6.4 12.8 9.6 22.4 9.6 9.6 0 16-3.2 22.4-9.6l704-710.4c3.2-6.4 6.4-12.8 6.4-22.4Zm-646.4 528c-76.8-70.4-128-128-153.6-172.8 28.8-48 80-105.6 153.6-172.8C304 272 400 230.4 512 224c64 3.2 124.8 19.2 176 44.8l-54.4 54.4C598.4 300.8 560 288 512 288c-64 0-115.2 22.4-160 64s-64 96-64 160c0 48 12.8 89.6 35.2 124.8L256 707.2c-9.6-6.4-19.2-16-25.6-22.4Zm140.8-96c-12.8-22.4-19.2-48-19.2-76.8 0-44.8 16-83.2 48-112 32-28.8 67.2-48 112-48 28.8 0 54.4 6.4 73.6 19.2zM889.599 336c-12.8-16-28.8-28.8-41.6-41.6l-48 48c73.6 67.2 124.8 124.8 150.4 169.6-28.8 48-80 105.6-153.6 172.8-73.6 67.2-172.8 108.8-284.8 115.2-51.2-3.2-99.2-12.8-140.8-28.8l-48 48c57.6 22.4 118.4 38.4 188.8 44.8 160-16 288-73.6 377.6-176C979.199 585.6 1024 528 1024 512s-48.001-73.6-134.401-176Z"}),Ue("path",{fill:"currentColor",d:"M511.998 672c-12.8 0-25.6-3.2-38.4-6.4l-51.2 51.2c28.8 12.8 57.6 19.2 89.6 19.2 64 0 115.2-22.4 160-64 41.6-41.6 64-96 64-160 0-32-6.4-64-19.2-89.6l-51.2 51.2c3.2 12.8 6.4 25.6 6.4 38.4 0 44.8-16 83.2-48 112-32 28.8-67.2 48-112 48Z"})]))}}),g7=m7,v7=qe({name:"InfoFilled",__name:"info-filled",setup(e){return(t,i)=>(ae(),Oe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ue("path",{fill:"currentColor",d:"M512 64a448 448 0 1 1 0 896.064A448 448 0 0 1 512 64m67.2 275.072c33.28 0 60.288-23.104 60.288-57.344s-27.072-57.344-60.288-57.344c-33.28 0-60.16 23.104-60.16 57.344s26.88 57.344 60.16 57.344M590.912 699.2c0-6.848 2.368-24.64 1.024-34.752l-52.608 60.544c-10.88 11.456-24.512 19.392-30.912 17.28a12.992 12.992 0 0 1-8.256-14.72l87.68-276.992c7.168-35.136-12.544-67.2-54.336-71.296-44.096 0-108.992 44.736-148.48 101.504 0 6.784-1.28 23.68.064 33.792l52.544-60.608c10.88-11.328 23.552-19.328 29.952-17.152a12.8 12.8 0 0 1 7.808 16.128L388.48 728.576c-10.048 32.256 8.96 63.872 55.04 71.04 67.84 0 107.904-43.648 147.456-100.416z"})]))}}),tE=v7,_7=qe({name:"Loading",__name:"loading",setup(e){return(t,i)=>(ae(),Oe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ue("path",{fill:"currentColor",d:"M512 64a32 32 0 0 1 32 32v192a32 32 0 0 1-64 0V96a32 32 0 0 1 32-32m0 640a32 32 0 0 1 32 32v192a32 32 0 1 1-64 0V736a32 32 0 0 1 32-32m448-192a32 32 0 0 1-32 32H736a32 32 0 1 1 0-64h192a32 32 0 0 1 32 32m-640 0a32 32 0 0 1-32 32H96a32 32 0 0 1 0-64h192a32 32 0 0 1 32 32M195.2 195.2a32 32 0 0 1 45.248 0L376.32 331.008a32 32 0 0 1-45.248 45.248L195.2 240.448a32 32 0 0 1 0-45.248zm452.544 452.544a32 32 0 0 1 45.248 0L828.8 783.552a32 32 0 0 1-45.248 45.248L647.744 692.992a32 32 0 0 1 0-45.248zM828.8 195.264a32 32 0 0 1 0 45.184L692.992 376.32a32 32 0 0 1-45.248-45.248l135.808-135.808a32 32 0 0 1 45.248 0m-452.544 452.48a32 32 0 0 1 0 45.248L240.448 828.8a32 32 0 0 1-45.248-45.248l135.808-135.808a32 32 0 0 1 45.248 0z"})]))}}),Hc=_7,y7=qe({name:"Minus",__name:"minus",setup(e){return(t,i)=>(ae(),Oe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ue("path",{fill:"currentColor",d:"M128 544h768a32 32 0 1 0 0-64H128a32 32 0 0 0 0 64"})]))}}),b7=y7,x7=qe({name:"MoreFilled",__name:"more-filled",setup(e){return(t,i)=>(ae(),Oe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ue("path",{fill:"currentColor",d:"M176 416a112 112 0 1 1 0 224 112 112 0 0 1 0-224m336 0a112 112 0 1 1 0 224 112 112 0 0 1 0-224m336 0a112 112 0 1 1 0 224 112 112 0 0 1 0-224"})]))}}),O3=x7,w7=qe({name:"More",__name:"more",setup(e){return(t,i)=>(ae(),Oe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ue("path",{fill:"currentColor",d:"M176 416a112 112 0 1 0 0 224 112 112 0 0 0 0-224m0 64a48 48 0 1 1 0 96 48 48 0 0 1 0-96m336-64a112 112 0 1 1 0 224 112 112 0 0 1 0-224m0 64a48 48 0 1 0 0 96 48 48 0 0 0 0-96m336-64a112 112 0 1 1 0 224 112 112 0 0 1 0-224m0 64a48 48 0 1 0 0 96 48 48 0 0 0 0-96"})]))}}),S7=w7,T7=qe({name:"PictureFilled",__name:"picture-filled",setup(e){return(t,i)=>(ae(),Oe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ue("path",{fill:"currentColor",d:"M96 896a32 32 0 0 1-32-32V160a32 32 0 0 1 32-32h832a32 32 0 0 1 32 32v704a32 32 0 0 1-32 32zm315.52-228.48-68.928-68.928a32 32 0 0 0-45.248 0L128 768.064h778.688l-242.112-290.56a32 32 0 0 0-49.216 0L458.752 665.408a32 32 0 0 1-47.232 2.112M256 384a96 96 0 1 0 192.064-.064A96 96 0 0 0 256 384"})]))}}),C7=T7,E7=qe({name:"Plus",__name:"plus",setup(e){return(t,i)=>(ae(),Oe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ue("path",{fill:"currentColor",d:"M480 480V128a32 32 0 0 1 64 0v352h352a32 32 0 1 1 0 64H544v352a32 32 0 1 1-64 0V544H128a32 32 0 0 1 0-64z"})]))}}),Az=E7,M7=qe({name:"QuestionFilled",__name:"question-filled",setup(e){return(t,i)=>(ae(),Oe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ue("path",{fill:"currentColor",d:"M512 64a448 448 0 1 1 0 896 448 448 0 0 1 0-896m23.744 191.488c-52.096 0-92.928 14.784-123.2 44.352-30.976 29.568-45.76 70.4-45.76 122.496h80.256c0-29.568 5.632-52.8 17.6-68.992 13.376-19.712 35.2-28.864 66.176-28.864 23.936 0 42.944 6.336 56.32 19.712 12.672 13.376 19.712 31.68 19.712 54.912 0 17.6-6.336 34.496-19.008 49.984l-8.448 9.856c-45.76 40.832-73.216 70.4-82.368 89.408-9.856 19.008-14.08 42.24-14.08 68.992v9.856h80.96v-9.856c0-16.896 3.52-31.68 10.56-45.76 6.336-12.672 15.488-24.64 28.16-35.2 33.792-29.568 54.208-48.576 60.544-55.616 16.896-22.528 26.048-51.392 26.048-86.592 0-42.944-14.08-76.736-42.24-101.376-28.16-25.344-65.472-37.312-111.232-37.312zm-12.672 406.208a54.272 54.272 0 0 0-38.72 14.784 49.408 49.408 0 0 0-15.488 38.016c0 15.488 4.928 28.16 15.488 38.016A54.848 54.848 0 0 0 523.072 768c15.488 0 28.16-4.928 38.72-14.784a51.52 51.52 0 0 0 16.192-38.72 51.968 51.968 0 0 0-15.488-38.016 55.936 55.936 0 0 0-39.424-14.784z"})]))}}),I7=M7,A7=qe({name:"RefreshLeft",__name:"refresh-left",setup(e){return(t,i)=>(ae(),Oe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ue("path",{fill:"currentColor",d:"M289.088 296.704h92.992a32 32 0 0 1 0 64H232.96a32 32 0 0 1-32-32V179.712a32 32 0 0 1 64 0v50.56a384 384 0 0 1 643.84 282.88 384 384 0 0 1-383.936 384 384 384 0 0 1-384-384h64a320 320 0 1 0 640 0 320 320 0 0 0-555.712-216.448z"})]))}}),k7=A7,P7=qe({name:"RefreshRight",__name:"refresh-right",setup(e){return(t,i)=>(ae(),Oe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ue("path",{fill:"currentColor",d:"M784.512 230.272v-50.56a32 32 0 1 1 64 0v149.056a32 32 0 0 1-32 32H667.52a32 32 0 1 1 0-64h92.992A320 320 0 1 0 524.8 833.152a320 320 0 0 0 320-320h64a384 384 0 0 1-384 384 384 384 0 0 1-384-384 384 384 0 0 1 643.712-282.88z"})]))}}),R7=P7,O7=qe({name:"ScaleToOriginal",__name:"scale-to-original",setup(e){return(t,i)=>(ae(),Oe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ue("path",{fill:"currentColor",d:"M813.176 180.706a60.235 60.235 0 0 1 60.236 60.235v481.883a60.235 60.235 0 0 1-60.236 60.235H210.824a60.235 60.235 0 0 1-60.236-60.235V240.94a60.235 60.235 0 0 1 60.236-60.235h602.352zm0-60.235H210.824A120.47 120.47 0 0 0 90.353 240.94v481.883a120.47 120.47 0 0 0 120.47 120.47h602.353a120.47 120.47 0 0 0 120.471-120.47V240.94a120.47 120.47 0 0 0-120.47-120.47zm-120.47 180.705a30.118 30.118 0 0 0-30.118 30.118v301.177a30.118 30.118 0 0 0 60.236 0V331.294a30.118 30.118 0 0 0-30.118-30.118zm-361.412 0a30.118 30.118 0 0 0-30.118 30.118v301.177a30.118 30.118 0 1 0 60.236 0V331.294a30.118 30.118 0 0 0-30.118-30.118M512 361.412a30.118 30.118 0 0 0-30.118 30.117v30.118a30.118 30.118 0 0 0 60.236 0V391.53A30.118 30.118 0 0 0 512 361.412M512 512a30.118 30.118 0 0 0-30.118 30.118v30.117a30.118 30.118 0 0 0 60.236 0v-30.117A30.118 30.118 0 0 0 512 512"})]))}}),L7=O7,D7=qe({name:"Search",__name:"search",setup(e){return(t,i)=>(ae(),Oe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ue("path",{fill:"currentColor",d:"m795.904 750.72 124.992 124.928a32 32 0 0 1-45.248 45.248L750.656 795.904a416 416 0 1 1 45.248-45.248zM480 832a352 352 0 1 0 0-704 352 352 0 0 0 0 704"})]))}}),z7=D7,F7=qe({name:"SortDown",__name:"sort-down",setup(e){return(t,i)=>(ae(),Oe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ue("path",{fill:"currentColor",d:"M576 96v709.568L333.312 562.816A32 32 0 1 0 288 608l297.408 297.344A32 32 0 0 0 640 882.688V96a32 32 0 0 0-64 0"})]))}}),N7=F7,B7=qe({name:"SortUp",__name:"sort-up",setup(e){return(t,i)=>(ae(),Oe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ue("path",{fill:"currentColor",d:"M384 141.248V928a32 32 0 1 0 64 0V218.56l242.688 242.688A32 32 0 1 0 736 416L438.592 118.656A32 32 0 0 0 384 141.248"})]))}}),V7=B7,$7=qe({name:"StarFilled",__name:"star-filled",setup(e){return(t,i)=>(ae(),Oe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ue("path",{fill:"currentColor",d:"M283.84 867.84 512 747.776l228.16 119.936a6.4 6.4 0 0 0 9.28-6.72l-43.52-254.08 184.512-179.904a6.4 6.4 0 0 0-3.52-10.88l-255.104-37.12L517.76 147.904a6.4 6.4 0 0 0-11.52 0L392.192 379.072l-255.104 37.12a6.4 6.4 0 0 0-3.52 10.88L318.08 606.976l-43.584 254.08a6.4 6.4 0 0 0 9.28 6.72z"})]))}}),wb=$7,U7=qe({name:"Star",__name:"star",setup(e){return(t,i)=>(ae(),Oe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ue("path",{fill:"currentColor",d:"m512 747.84 228.16 119.936a6.4 6.4 0 0 0 9.28-6.72l-43.52-254.08 184.512-179.904a6.4 6.4 0 0 0-3.52-10.88l-255.104-37.12L517.76 147.904a6.4 6.4 0 0 0-11.52 0L392.192 379.072l-255.104 37.12a6.4 6.4 0 0 0-3.52 10.88L318.08 606.976l-43.584 254.08a6.4 6.4 0 0 0 9.28 6.72zM313.6 924.48a70.4 70.4 0 0 1-102.144-74.24l37.888-220.928L88.96 472.96A70.4 70.4 0 0 1 128 352.896l221.76-32.256 99.2-200.96a70.4 70.4 0 0 1 126.208 0l99.2 200.96 221.824 32.256a70.4 70.4 0 0 1 39.04 120.064L774.72 629.376l37.888 220.928a70.4 70.4 0 0 1-102.144 74.24L512 820.096l-198.4 104.32z"})]))}}),j7=U7,H7=qe({name:"SuccessFilled",__name:"success-filled",setup(e){return(t,i)=>(ae(),Oe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ue("path",{fill:"currentColor",d:"M512 64a448 448 0 1 1 0 896 448 448 0 0 1 0-896m-55.808 536.384-99.52-99.584a38.4 38.4 0 1 0-54.336 54.336l126.72 126.72a38.272 38.272 0 0 0 54.336 0l262.4-262.464a38.4 38.4 0 1 0-54.272-54.336z"})]))}}),kz=H7,G7=qe({name:"View",__name:"view",setup(e){return(t,i)=>(ae(),Oe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ue("path",{fill:"currentColor",d:"M512 160c320 0 512 352 512 352S832 864 512 864 0 512 0 512s192-352 512-352m0 64c-225.28 0-384.128 208.064-436.8 288 52.608 79.872 211.456 288 436.8 288 225.28 0 384.128-208.064 436.8-288-52.608-79.872-211.456-288-436.8-288zm0 64a224 224 0 1 1 0 448 224 224 0 0 1 0-448m0 64a160.192 160.192 0 0 0-160 160c0 88.192 71.744 160 160 160s160-71.808 160-160-71.744-160-160-160"})]))}}),W7=G7,q7=qe({name:"WarningFilled",__name:"warning-filled",setup(e){return(t,i)=>(ae(),Oe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ue("path",{fill:"currentColor",d:"M512 64a448 448 0 1 1 0 896 448 448 0 0 1 0-896m0 192a58.432 58.432 0 0 0-58.24 63.744l23.36 256.384a35.072 35.072 0 0 0 69.76 0l23.296-256.384A58.432 58.432 0 0 0 512 256m0 512a51.2 51.2 0 1 0 0-102.4 51.2 51.2 0 0 0 0 102.4"})]))}}),px=q7,K7=qe({name:"ZoomIn",__name:"zoom-in",setup(e){return(t,i)=>(ae(),Oe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ue("path",{fill:"currentColor",d:"m795.904 750.72 124.992 124.928a32 32 0 0 1-45.248 45.248L750.656 795.904a416 416 0 1 1 45.248-45.248zM480 832a352 352 0 1 0 0-704 352 352 0 0 0 0 704m-32-384v-96a32 32 0 0 1 64 0v96h96a32 32 0 0 1 0 64h-96v96a32 32 0 0 1-64 0v-96h-96a32 32 0 0 1 0-64z"})]))}}),Pz=K7,Z7=qe({name:"ZoomOut",__name:"zoom-out",setup(e){return(t,i)=>(ae(),Oe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ue("path",{fill:"currentColor",d:"m795.904 750.72 124.992 124.928a32 32 0 0 1-45.248 45.248L750.656 795.904a416 416 0 1 1 45.248-45.248zM480 832a352 352 0 1 0 0-704 352 352 0 0 0 0 704M352 448h256a32 32 0 0 1 0 64H352a32 32 0 0 1 0-64"})]))}}),Y7=Z7;const Mo=dt([String,Object,Function]),nE={Close:sc},rE={Close:sc,SuccessFilled:kz,InfoFilled:tE,WarningFilled:px,CircleCloseFilled:eE},Xd={success:kz,warning:px,error:eE,info:tE},mx={validating:Hc,success:QC,error:Wu},X7=["light","dark"],J7=un({title:{type:String,default:""},description:{type:String,default:""},type:{type:String,values:Am(Xd),default:"info"},closable:{type:Boolean,default:!0},closeText:{type:String,default:""},showIcon:Boolean,center:Boolean,effect:{type:String,values:X7,default:"light"}}),Q7={close:e=>e instanceof MouseEvent},eK=qe({name:"ElAlert"}),tK=qe({...eK,props:J7,emits:Q7,setup(e,{emit:t}){const i=e,{Close:a}=rE,d=Hi(),p=en("alert"),_=Se(!0),r=ee(()=>Xd[i.type]),S=ee(()=>!!(i.description||d.default)),C=M=>{_.value=!1,t("close",M)};return(M,k)=>(ae(),kt(ls,{name:b(p).b("fade"),persisted:""},{default:st(()=>[hr(Ue("div",{class:pe([b(p).b(),b(p).m(M.type),b(p).is("center",M.center),b(p).is(M.effect)]),role:"alert"},[M.showIcon&&b(r)?(ae(),kt(b(On),{key:0,class:pe([b(p).e("icon"),{[b(p).is("big")]:b(S)}])},{default:st(()=>[(ae(),kt(Tr(b(r))))]),_:1},8,["class"])):yt("v-if",!0),Ue("div",{class:pe(b(p).e("content"))},[M.title||M.$slots.title?(ae(),Oe("span",{key:0,class:pe([b(p).e("title"),{"with-description":b(S)}])},[pt(M.$slots,"title",{},()=>[Rr(pn(M.title),1)])],2)):yt("v-if",!0),b(S)?(ae(),Oe("p",{key:1,class:pe(b(p).e("description"))},[pt(M.$slots,"default",{},()=>[Rr(pn(M.description),1)])],2)):yt("v-if",!0),M.closable?(ae(),Oe(Bn,{key:2},[M.closeText?(ae(),Oe("div",{key:0,class:pe([b(p).e("close-btn"),b(p).is("customed")]),onClick:C},pn(M.closeText),3)):(ae(),kt(b(On),{key:1,class:pe(b(p).e("close-btn")),onClick:C},{default:st(()=>[Ze(b(a))]),_:1},8,["class"]))],64)):yt("v-if",!0)],2)],2),[[no,_.value]])]),_:3},8,["name"]))}});var nK=fn(tK,[["__file","alert.vue"]]);const rK=ur(nK),gx=()=>Hr&&/firefox/i.test(window.navigator.userAgent);let Ta;const oK={height:"0",visibility:"hidden",overflow:gx()?"":"hidden",position:"absolute","z-index":"-1000",top:"0",right:"0"},iK=["letter-spacing","line-height","padding-top","padding-bottom","font-family","font-weight","font-size","text-rendering","text-transform","width","text-indent","padding-left","padding-right","border-width","box-sizing"];function sK(e){const t=window.getComputedStyle(e),i=t.getPropertyValue("box-sizing"),a=Number.parseFloat(t.getPropertyValue("padding-bottom"))+Number.parseFloat(t.getPropertyValue("padding-top")),d=Number.parseFloat(t.getPropertyValue("border-bottom-width"))+Number.parseFloat(t.getPropertyValue("border-top-width"));return{contextStyle:iK.map(_=>[_,t.getPropertyValue(_)]),paddingSize:a,borderSize:d,boxSizing:i}}function L3(e,t=1,i){var a;Ta||(Ta=document.createElement("textarea"),document.body.appendChild(Ta));const{paddingSize:d,borderSize:p,boxSizing:_,contextStyle:r}=sK(e);r.forEach(([k,z])=>Ta==null?void 0:Ta.style.setProperty(k,z)),Object.entries(oK).forEach(([k,z])=>Ta==null?void 0:Ta.style.setProperty(k,z,"important")),Ta.value=e.value||e.placeholder||"";let S=Ta.scrollHeight;const C={};_==="border-box"?S=S+p:_==="content-box"&&(S=S-d),Ta.value="";const M=Ta.scrollHeight-d;if(Gn(t)){let k=M*t;_==="border-box"&&(k=k+d+p),S=Math.max(k,S),C.minHeight=`${k}px`}if(Gn(i)){let k=M*i;_==="border-box"&&(k=k+d+p),S=Math.min(k,S)}return C.height=`${S}px`,(a=Ta.parentNode)==null||a.removeChild(Ta),Ta=void 0,C}const ni=e=>e,aK=un({ariaLabel:String,ariaOrientation:{type:String,values:["horizontal","vertical","undefined"]},ariaControls:String}),_s=e=>Jl(aK,e),oE=un({id:{type:String,default:void 0},size:zi,disabled:Boolean,modelValue:{type:dt([String,Number,Object]),default:""},maxlength:{type:[String,Number]},minlength:{type:[String,Number]},type:{type:String,default:"text"},resize:{type:String,values:["none","both","horizontal","vertical"]},autosize:{type:dt([Boolean,Object]),default:!1},autocomplete:{type:String,default:"off"},formatter:{type:Function},parser:{type:Function},placeholder:{type:String},form:{type:String},readonly:Boolean,clearable:Boolean,showPassword:Boolean,showWordLimit:Boolean,suffixIcon:{type:Mo},prefixIcon:{type:Mo},containerRole:{type:String,default:void 0},tabindex:{type:[String,Number],default:0},validateEvent:{type:Boolean,default:!0},inputStyle:{type:dt([Object,Array,String]),default:()=>ni({})},autofocus:Boolean,rows:{type:Number,default:2},..._s(["ariaLabel"])}),lK={[mr]:e=>Dn(e),input:e=>Dn(e),change:e=>Dn(e),focus:e=>e instanceof FocusEvent,blur:e=>e instanceof FocusEvent,clear:()=>!0,mouseleave:e=>e instanceof MouseEvent,mouseenter:e=>e instanceof MouseEvent,keydown:e=>e instanceof Event,compositionstart:e=>e instanceof CompositionEvent,compositionupdate:e=>e instanceof CompositionEvent,compositionend:e=>e instanceof CompositionEvent},cK=["class","style"],uK=/^on[A-Z]/,wy=(e={})=>{const{excludeListeners:t=!1,excludeKeys:i}=e,a=ee(()=>((i==null?void 0:i.value)||[]).concat(cK)),d=wr();return ee(d?()=>{var p;return q_(Object.entries((p=d.proxy)==null?void 0:p.$attrs).filter(([_])=>!a.value.includes(_)&&!(t&&uK.test(_))))}:()=>({}))},Uf=Symbol("formContextKey"),Gc=Symbol("formItemContextKey"),D3={prefix:Math.floor(Math.random()*1e4),current:0},dK=Symbol("elIdInjection"),iE=()=>wr()?An(dK,D3):D3,vs=e=>{const t=iE(),i=PC();return YS(()=>b(e)||`${i.value}-id-${t.prefix}-${t.current++}`)},As=()=>{const e=An(Uf,void 0),t=An(Gc,void 0);return{form:e,formItem:t}},Al=(e,{formItemContext:t,disableIdGeneration:i,disableIdManagement:a})=>{i||(i=Se(!1)),a||(a=Se(!1));const d=Se();let p;const _=ee(()=>{var r;return!!(!(e.label||e.ariaLabel)&&t&&t.inputIds&&((r=t.inputIds)==null?void 0:r.length)<=1)});return gr(()=>{p=qt([po(e,"id"),i],([r,S])=>{const C=r??(S?void 0:vs().value);C!==d.value&&(t!=null&&t.removeInputId&&(d.value&&t.removeInputId(d.value),!(a!=null&&a.value)&&!S&&C&&t.addInputId(C)),d.value=C)},{immediate:!0})}),th(()=>{p&&p(),t!=null&&t.removeInputId&&d.value&&t.removeInputId(d.value)}),{isLabeledByFormItem:_,inputId:d}},Rz=e=>{const t=wr();return ee(()=>{var i,a;return(a=(i=t==null?void 0:t.proxy)==null?void 0:i.$props)==null?void 0:a[e]})},Li=(e,t={})=>{const i=Se(void 0),a=t.prop?i:Rz("size"),d=t.global?i:yz(),p=t.form?{size:void 0}:An(Uf,void 0),_=t.formItem?{size:void 0}:An(Gc,void 0);return ee(()=>a.value||b(e)||(_==null?void 0:_.size)||(p==null?void 0:p.size)||d.value||"")},ks=e=>{const t=Rz("disabled"),i=An(Uf,void 0);return ee(()=>t.value||b(e)||(i==null?void 0:i.disabled)||!1)};function rh(e,{beforeFocus:t,afterFocus:i,beforeBlur:a,afterBlur:d}={}){const p=wr(),{emit:_}=p,r=Uo(),S=Se(!1),C=z=>{Nn(t)&&t(z)||S.value||(S.value=!0,_("focus",z),i==null||i())},M=z=>{var F;Nn(a)&&a(z)||z.relatedTarget&&((F=r.value)!=null&&F.contains(z.relatedTarget))||(S.value=!1,_("blur",z),d==null||d())},k=()=>{var z,F;(z=r.value)!=null&&z.contains(document.activeElement)&&r.value!==document.activeElement||(F=e.value)==null||F.focus()};return qt(r,z=>{z&&z.setAttribute("tabindex","-1")}),So(r,"focus",C,!0),So(r,"blur",M,!0),So(r,"click",k,!0),{isFocused:S,wrapperRef:r,handleFocus:C,handleBlur:M}}const hK=e=>/([\uAC00-\uD7AF\u3130-\u318F])+/gi.test(e);function Sy({afterComposition:e,emit:t}){const i=Se(!1),a=r=>{t==null||t("compositionstart",r),i.value=!0},d=r=>{var S;t==null||t("compositionupdate",r);const C=(S=r.target)==null?void 0:S.value,M=C[C.length-1]||"";i.value=!hK(M)},p=r=>{t==null||t("compositionend",r),i.value&&(i.value=!1,Vn(()=>e(r)))};return{isComposing:i,handleComposition:r=>{r.type==="compositionend"?p(r):d(r)},handleCompositionStart:a,handleCompositionUpdate:d,handleCompositionEnd:p}}function fK(e){let t;function i(){if(e.value==null)return;const{selectionStart:d,selectionEnd:p,value:_}=e.value;if(d==null||p==null)return;const r=_.slice(0,Math.max(0,d)),S=_.slice(Math.max(0,p));t={selectionStart:d,selectionEnd:p,value:_,beforeTxt:r,afterTxt:S}}function a(){if(e.value==null||t==null)return;const{value:d}=e.value,{beforeTxt:p,afterTxt:_,selectionStart:r}=t;if(p==null||_==null||r==null)return;let S=d.length;if(d.endsWith(_))S=d.length-_.length;else if(d.startsWith(p))S=p.length;else{const C=p[r-1],M=d.indexOf(C,r-1);M!==-1&&(S=M+1)}e.value.setSelectionRange(S,S)}return[i,a]}const pK=qe({name:"ElInput",inheritAttrs:!1}),mK=qe({...pK,props:oE,emits:lK,setup(e,{expose:t,emit:i}){const a=e,d=Uu(),p=wy(),_=Hi(),r=ee(()=>[a.type==="textarea"?N.b():B.b(),B.m(z.value),B.is("disabled",F.value),B.is("exceed",bt.value),{[B.b("group")]:_.prepend||_.append,[B.m("prefix")]:_.prefix||a.prefixIcon,[B.m("suffix")]:_.suffix||a.suffixIcon||a.clearable||a.showPassword,[B.bm("suffix","password-clear")]:Ae.value&&me.value,[B.b("hidden")]:a.type==="hidden"},d.class]),S=ee(()=>[B.e("wrapper"),B.is("focus",fe.value)]),{form:C,formItem:M}=As(),{inputId:k}=Al(a,{formItemContext:M}),z=Li(),F=ks(),B=en("input"),N=en("textarea"),j=Uo(),U=Uo(),te=Se(!1),Y=Se(!1),q=Se(),J=Uo(a.inputStyle),ne=ee(()=>j.value||U.value),{wrapperRef:se,isFocused:fe,handleFocus:ce,handleBlur:le}=rh(ne,{beforeFocus(){return F.value},afterBlur(){var It;a.validateEvent&&((It=M==null?void 0:M.validate)==null||It.call(M,"blur").catch(Sn=>void 0))}}),ge=ee(()=>{var It;return(It=C==null?void 0:C.statusIcon)!=null?It:!1}),de=ee(()=>(M==null?void 0:M.validateState)||""),ke=ee(()=>de.value&&mx[de.value]),We=ee(()=>Y.value?W7:g7),we=ee(()=>[d.style]),be=ee(()=>[a.inputStyle,J.value,{resize:a.resize}]),Me=ee(()=>Ki(a.modelValue)?"":String(a.modelValue)),Ae=ee(()=>a.clearable&&!F.value&&!a.readonly&&!!Me.value&&(fe.value||te.value)),me=ee(()=>a.showPassword&&!F.value&&!!Me.value&&(!!Me.value||fe.value)),Be=ee(()=>a.showWordLimit&&!!a.maxlength&&(a.type==="text"||a.type==="textarea")&&!F.value&&!a.readonly&&!a.showPassword),Ve=ee(()=>Me.value.length),bt=ee(()=>!!Be.value&&Ve.value>Number(a.maxlength)),Pe=ee(()=>!!_.suffix||!!a.suffixIcon||Ae.value||a.showPassword||Be.value||!!de.value&&ge.value),[wt,Mt]=fK(j);ti(U,It=>{if(Bt(),!Be.value||a.resize!=="both")return;const Sn=It[0],{width:Yn}=Sn.contentRect;q.value={right:`calc(100% - ${Yn+15+6}px)`}});const Nt=()=>{const{type:It,autosize:Sn}=a;if(!(!Hr||It!=="textarea"||!U.value))if(Sn){const Yn=yr(Sn)?Sn.minRows:void 0,vr=yr(Sn)?Sn.maxRows:void 0,tr=L3(U.value,Yn,vr);J.value={overflowY:"hidden",...tr},Vn(()=>{U.value.offsetHeight,J.value=tr})}else J.value={minHeight:L3(U.value).minHeight}},Bt=(It=>{let Sn=!1;return()=>{var Yn;if(Sn||!a.autosize)return;((Yn=U.value)==null?void 0:Yn.offsetParent)===null||(It(),Sn=!0)}})(Nt),Wt=()=>{const It=ne.value,Sn=a.formatter?a.formatter(Me.value):Me.value;!It||It.value===Sn||(It.value=Sn)},Fe=async It=>{wt();let{value:Sn}=It.target;if(a.formatter&&(Sn=a.parser?a.parser(Sn):Sn),!Re.value){if(Sn===Me.value){Wt();return}i(mr,Sn),i("input",Sn),await Vn(),Wt(),Mt()}},cn=It=>{i("change",It.target.value)},{isComposing:Re,handleCompositionStart:nt,handleCompositionUpdate:Qe,handleCompositionEnd:Yt}=Sy({emit:i,afterComposition:Fe}),Xt=()=>{wt(),Y.value=!Y.value,setTimeout(Mt)},$t=()=>{var It;return(It=ne.value)==null?void 0:It.focus()},Ot=()=>{var It;return(It=ne.value)==null?void 0:It.blur()},Ft=It=>{te.value=!1,i("mouseleave",It)},sn=It=>{te.value=!0,i("mouseenter",It)},an=It=>{i("keydown",It)},Pn=()=>{var It;(It=ne.value)==null||It.select()},bn=()=>{i(mr,""),i("change",""),i("clear"),i("input","")};return qt(()=>a.modelValue,()=>{var It;Vn(()=>Nt()),a.validateEvent&&((It=M==null?void 0:M.validate)==null||It.call(M,"change").catch(Sn=>void 0))}),qt(Me,()=>Wt()),qt(()=>a.type,async()=>{await Vn(),Wt(),Nt()}),gr(()=>{!a.formatter&&a.parser,Wt(),Vn(Nt)}),t({input:j,textarea:U,ref:ne,textareaStyle:be,autosize:po(a,"autosize"),isComposing:Re,focus:$t,blur:Ot,select:Pn,clear:bn,resizeTextarea:Nt}),(It,Sn)=>(ae(),Oe("div",{class:pe([b(r),{[b(B).bm("group","append")]:It.$slots.append,[b(B).bm("group","prepend")]:It.$slots.prepend}]),style:$n(b(we)),onMouseenter:sn,onMouseleave:Ft},[yt(" input "),It.type!=="textarea"?(ae(),Oe(Bn,{key:0},[yt(" prepend slot "),It.$slots.prepend?(ae(),Oe("div",{key:0,class:pe(b(B).be("group","prepend"))},[pt(It.$slots,"prepend")],2)):yt("v-if",!0),Ue("div",{ref_key:"wrapperRef",ref:se,class:pe(b(S))},[yt(" prefix slot "),It.$slots.prefix||It.prefixIcon?(ae(),Oe("span",{key:0,class:pe(b(B).e("prefix"))},[Ue("span",{class:pe(b(B).e("prefix-inner"))},[pt(It.$slots,"prefix"),It.prefixIcon?(ae(),kt(b(On),{key:0,class:pe(b(B).e("icon"))},{default:st(()=>[(ae(),kt(Tr(It.prefixIcon)))]),_:1},8,["class"])):yt("v-if",!0)],2)],2)):yt("v-if",!0),Ue("input",Mr({id:b(k),ref_key:"input",ref:j,class:b(B).e("inner")},b(p),{minlength:It.minlength,maxlength:It.maxlength,type:It.showPassword?Y.value?"text":"password":It.type,disabled:b(F),readonly:It.readonly,autocomplete:It.autocomplete,tabindex:It.tabindex,"aria-label":It.ariaLabel,placeholder:It.placeholder,style:It.inputStyle,form:It.form,autofocus:It.autofocus,role:It.containerRole,onCompositionstart:b(nt),onCompositionupdate:b(Qe),onCompositionend:b(Yt),onInput:Fe,onChange:cn,onKeydown:an}),null,16,["id","minlength","maxlength","type","disabled","readonly","autocomplete","tabindex","aria-label","placeholder","form","autofocus","role","onCompositionstart","onCompositionupdate","onCompositionend"]),yt(" suffix slot "),b(Pe)?(ae(),Oe("span",{key:1,class:pe(b(B).e("suffix"))},[Ue("span",{class:pe(b(B).e("suffix-inner"))},[!b(Ae)||!b(me)||!b(Be)?(ae(),Oe(Bn,{key:0},[pt(It.$slots,"suffix"),It.suffixIcon?(ae(),kt(b(On),{key:0,class:pe(b(B).e("icon"))},{default:st(()=>[(ae(),kt(Tr(It.suffixIcon)))]),_:1},8,["class"])):yt("v-if",!0)],64)):yt("v-if",!0),b(Ae)?(ae(),kt(b(On),{key:1,class:pe([b(B).e("icon"),b(B).e("clear")]),onMousedown:Qn(b(_o),["prevent"]),onClick:bn},{default:st(()=>[Ze(b(Wu))]),_:1},8,["class","onMousedown"])):yt("v-if",!0),b(me)?(ae(),kt(b(On),{key:2,class:pe([b(B).e("icon"),b(B).e("password")]),onClick:Xt},{default:st(()=>[(ae(),kt(Tr(b(We))))]),_:1},8,["class"])):yt("v-if",!0),b(Be)?(ae(),Oe("span",{key:3,class:pe(b(B).e("count"))},[Ue("span",{class:pe(b(B).e("count-inner"))},pn(b(Ve))+" / "+pn(It.maxlength),3)],2)):yt("v-if",!0),b(de)&&b(ke)&&b(ge)?(ae(),kt(b(On),{key:4,class:pe([b(B).e("icon"),b(B).e("validateIcon"),b(B).is("loading",b(de)==="validating")])},{default:st(()=>[(ae(),kt(Tr(b(ke))))]),_:1},8,["class"])):yt("v-if",!0)],2)],2)):yt("v-if",!0)],2),yt(" append slot "),It.$slots.append?(ae(),Oe("div",{key:1,class:pe(b(B).be("group","append"))},[pt(It.$slots,"append")],2)):yt("v-if",!0)],64)):(ae(),Oe(Bn,{key:1},[yt(" textarea "),Ue("textarea",Mr({id:b(k),ref_key:"textarea",ref:U,class:[b(N).e("inner"),b(B).is("focus",b(fe))]},b(p),{minlength:It.minlength,maxlength:It.maxlength,tabindex:It.tabindex,disabled:b(F),readonly:It.readonly,autocomplete:It.autocomplete,style:b(be),"aria-label":It.ariaLabel,placeholder:It.placeholder,form:It.form,autofocus:It.autofocus,rows:It.rows,role:It.containerRole,onCompositionstart:b(nt),onCompositionupdate:b(Qe),onCompositionend:b(Yt),onInput:Fe,onFocus:b(ce),onBlur:b(le),onChange:cn,onKeydown:an}),null,16,["id","minlength","maxlength","tabindex","disabled","readonly","autocomplete","aria-label","placeholder","form","autofocus","rows","role","onCompositionstart","onCompositionupdate","onCompositionend","onFocus","onBlur"]),b(Be)?(ae(),Oe("span",{key:0,style:$n(q.value),class:pe(b(B).e("count"))},pn(b(Ve))+" / "+pn(It.maxlength),7)):yt("v-if",!0)],64))],38))}});var gK=fn(mK,[["__file","input.vue"]]);const Us=ur(gK),Qp=4,Oz={vertical:{offset:"offsetHeight",scroll:"scrollTop",scrollSize:"scrollHeight",size:"height",key:"vertical",axis:"Y",client:"clientY",direction:"top"},horizontal:{offset:"offsetWidth",scroll:"scrollLeft",scrollSize:"scrollWidth",size:"width",key:"horizontal",axis:"X",client:"clientX",direction:"left"}},vK=({move:e,size:t,bar:i})=>({[i.size]:t,transform:`translate${i.axis}(${e}%)`}),sE=Symbol("scrollbarContextKey"),_K=un({vertical:Boolean,size:String,move:Number,ratio:{type:Number,required:!0},always:Boolean}),yK="Thumb",bK=qe({__name:"thumb",props:_K,setup(e){const t=e,i=An(sE),a=en("scrollbar");i||ji(yK,"can not inject scrollbar context");const d=Se(),p=Se(),_=Se({}),r=Se(!1);let S=!1,C=!1,M=Hr?document.onselectstart:null;const k=ee(()=>Oz[t.vertical?"vertical":"horizontal"]),z=ee(()=>vK({size:t.size,move:t.move,bar:k.value})),F=ee(()=>d.value[k.value.offset]**2/i.wrapElement[k.value.scrollSize]/t.ratio/p.value[k.value.offset]),B=ne=>{var se;if(ne.stopPropagation(),ne.ctrlKey||[1,2].includes(ne.button))return;(se=window.getSelection())==null||se.removeAllRanges(),j(ne);const fe=ne.currentTarget;fe&&(_.value[k.value.axis]=fe[k.value.offset]-(ne[k.value.client]-fe.getBoundingClientRect()[k.value.direction]))},N=ne=>{if(!p.value||!d.value||!i.wrapElement)return;const se=Math.abs(ne.target.getBoundingClientRect()[k.value.direction]-ne[k.value.client]),fe=p.value[k.value.offset]/2,ce=(se-fe)*100*F.value/d.value[k.value.offset];i.wrapElement[k.value.scroll]=ce*i.wrapElement[k.value.scrollSize]/100},j=ne=>{ne.stopImmediatePropagation(),S=!0,document.addEventListener("mousemove",U),document.addEventListener("mouseup",te),M=document.onselectstart,document.onselectstart=()=>!1},U=ne=>{if(!d.value||!p.value||S===!1)return;const se=_.value[k.value.axis];if(!se)return;const fe=(d.value.getBoundingClientRect()[k.value.direction]-ne[k.value.client])*-1,ce=p.value[k.value.offset]-se,le=(fe-ce)*100*F.value/d.value[k.value.offset];i.wrapElement[k.value.scroll]=le*i.wrapElement[k.value.scrollSize]/100},te=()=>{S=!1,_.value[k.value.axis]=0,document.removeEventListener("mousemove",U),document.removeEventListener("mouseup",te),J(),C&&(r.value=!1)},Y=()=>{C=!1,r.value=!!t.size},q=()=>{C=!0,r.value=S};Oo(()=>{J(),document.removeEventListener("mouseup",te)});const J=()=>{document.onselectstart!==M&&(document.onselectstart=M)};return So(po(i,"scrollbarElement"),"mousemove",Y),So(po(i,"scrollbarElement"),"mouseleave",q),(ne,se)=>(ae(),kt(ls,{name:b(a).b("fade"),persisted:""},{default:st(()=>[hr(Ue("div",{ref_key:"instance",ref:d,class:pe([b(a).e("bar"),b(a).is(b(k).key)]),onMousedown:N},[Ue("div",{ref_key:"thumb",ref:p,class:pe(b(a).e("thumb")),style:$n(b(z)),onMousedown:B},null,38)],34),[[no,ne.always||r.value]])]),_:1},8,["name"]))}});var z3=fn(bK,[["__file","thumb.vue"]]);const xK=un({always:{type:Boolean,default:!0},minSize:{type:Number,required:!0}}),wK=qe({__name:"bar",props:xK,setup(e,{expose:t}){const i=e,a=An(sE),d=Se(0),p=Se(0),_=Se(""),r=Se(""),S=Se(1),C=Se(1);return t({handleScroll:z=>{if(z){const F=z.offsetHeight-Qp,B=z.offsetWidth-Qp;p.value=z.scrollTop*100/F*S.value,d.value=z.scrollLeft*100/B*C.value}},update:()=>{const z=a==null?void 0:a.wrapElement;if(!z)return;const F=z.offsetHeight-Qp,B=z.offsetWidth-Qp,N=F**2/z.scrollHeight,j=B**2/z.scrollWidth,U=Math.max(N,i.minSize),te=Math.max(j,i.minSize);S.value=N/(F-N)/(U/(F-U)),C.value=j/(B-j)/(te/(B-te)),r.value=U+Qp<F?`${U}px`:"",_.value=te+Qp<B?`${te}px`:""}}),(z,F)=>(ae(),Oe(Bn,null,[Ze(z3,{move:d.value,ratio:C.value,size:_.value,always:z.always},null,8,["move","ratio","size","always"]),Ze(z3,{move:p.value,ratio:S.value,size:r.value,vertical:"",always:z.always},null,8,["move","ratio","size","always"])],64))}});var SK=fn(wK,[["__file","bar.vue"]]);const TK=un({height:{type:[String,Number],default:""},maxHeight:{type:[String,Number],default:""},native:{type:Boolean,default:!1},wrapStyle:{type:dt([String,Object,Array]),default:""},wrapClass:{type:[String,Array],default:""},viewClass:{type:[String,Array],default:""},viewStyle:{type:[String,Array,Object],default:""},noresize:Boolean,tag:{type:String,default:"div"},always:Boolean,minSize:{type:Number,default:20},tabindex:{type:[String,Number],default:void 0},id:String,role:String,..._s(["ariaLabel","ariaOrientation"])}),CK={scroll:({scrollTop:e,scrollLeft:t})=>[e,t].every(Gn)},EK="ElScrollbar",MK=qe({name:EK}),IK=qe({...MK,props:TK,emits:CK,setup(e,{expose:t,emit:i}){const a=e,d=en("scrollbar");let p,_,r=0,S=0;const C=Se(),M=Se(),k=Se(),z=Se(),F=ee(()=>{const J={};return a.height&&(J.height=ui(a.height)),a.maxHeight&&(J.maxHeight=ui(a.maxHeight)),[a.wrapStyle,J]}),B=ee(()=>[a.wrapClass,d.e("wrap"),{[d.em("wrap","hidden-default")]:!a.native}]),N=ee(()=>[d.e("view"),a.viewClass]),j=()=>{var J;M.value&&((J=z.value)==null||J.handleScroll(M.value),r=M.value.scrollTop,S=M.value.scrollLeft,i("scroll",{scrollTop:M.value.scrollTop,scrollLeft:M.value.scrollLeft}))};function U(J,ne){yr(J)?M.value.scrollTo(J):Gn(J)&&Gn(ne)&&M.value.scrollTo(J,ne)}const te=J=>{Gn(J)&&(M.value.scrollTop=J)},Y=J=>{Gn(J)&&(M.value.scrollLeft=J)},q=()=>{var J;(J=z.value)==null||J.update()};return qt(()=>a.noresize,J=>{J?(p==null||p(),_==null||_()):({stop:p}=ti(k,q),_=So("resize",q))},{immediate:!0}),qt(()=>[a.maxHeight,a.height],()=>{a.native||Vn(()=>{var J;q(),M.value&&((J=z.value)==null||J.handleScroll(M.value))})}),Dr(sE,lo({scrollbarElement:C,wrapElement:M})),TC(()=>{M.value&&(M.value.scrollTop=r,M.value.scrollLeft=S)}),gr(()=>{a.native||Vn(()=>{q()})}),hc(()=>q()),t({wrapRef:M,update:q,scrollTo:U,setScrollTop:te,setScrollLeft:Y,handleScroll:j}),(J,ne)=>(ae(),Oe("div",{ref_key:"scrollbarRef",ref:C,class:pe(b(d).b())},[Ue("div",{ref_key:"wrapRef",ref:M,class:pe(b(B)),style:$n(b(F)),tabindex:J.tabindex,onScroll:j},[(ae(),kt(Tr(J.tag),{id:J.id,ref_key:"resizeRef",ref:k,class:pe(b(N)),style:$n(J.viewStyle),role:J.role,"aria-label":J.ariaLabel,"aria-orientation":J.ariaOrientation},{default:st(()=>[pt(J.$slots,"default")]),_:3},8,["id","class","style","role","aria-label","aria-orientation"]))],46,["tabindex"]),J.native?yt("v-if",!0):(ae(),kt(SK,{key:0,ref_key:"barRef",ref:z,always:J.always,"min-size":J.minSize},null,8,["always","min-size"]))],2))}});var AK=fn(IK,[["__file","scrollbar.vue"]]);const Yc=ur(AK),aE=Symbol("popper"),Lz=Symbol("popperContent"),kK=["dialog","grid","group","listbox","menu","navigation","tooltip","tree"],Dz=un({role:{type:String,values:kK,default:"tooltip"}}),PK=qe({name:"ElPopper",inheritAttrs:!1}),RK=qe({...PK,props:Dz,setup(e,{expose:t}){const i=e,a=Se(),d=Se(),p=Se(),_=Se(),r=ee(()=>i.role),S={triggerRef:a,popperInstanceRef:d,contentRef:p,referenceRef:_,role:r};return t(S),Dr(aE,S),(C,M)=>pt(C.$slots,"default")}});var OK=fn(RK,[["__file","popper.vue"]]);const zz=un({arrowOffset:{type:Number,default:5}}),LK=qe({name:"ElPopperArrow",inheritAttrs:!1}),DK=qe({...LK,props:zz,setup(e,{expose:t}){const i=e,a=en("popper"),{arrowOffset:d,arrowRef:p,arrowStyle:_}=An(Lz,void 0);return qt(()=>i.arrowOffset,r=>{d.value=r}),Oo(()=>{p.value=void 0}),t({arrowRef:p}),(r,S)=>(ae(),Oe("span",{ref_key:"arrowRef",ref:p,class:pe(b(a).e("arrow")),style:$n(b(_)),"data-popper-arrow":""},null,6))}});var zK=fn(DK,[["__file","arrow.vue"]]);const Fz=un({virtualRef:{type:dt(Object)},virtualTriggering:Boolean,onMouseenter:{type:dt(Function)},onMouseleave:{type:dt(Function)},onClick:{type:dt(Function)},onKeydown:{type:dt(Function)},onFocus:{type:dt(Function)},onBlur:{type:dt(Function)},onContextmenu:{type:dt(Function)},id:String,open:Boolean}),Nz=Symbol("elForwardRef"),FK=e=>{Dr(Nz,{setForwardRef:i=>{e.value=i}})},NK=e=>({mounted(t){e(t)},updated(t){e(t)},unmounted(){e(null)}}),BK='a[href],button:not([disabled]),button:not([hidden]),:not([tabindex="-1"]),input:not([disabled]),input:not([type="hidden"]),select:not([disabled]),textarea:not([disabled])',VK=e=>getComputedStyle(e).position==="fixed"?!1:e.offsetParent!==null,F3=e=>Array.from(e.querySelectorAll(BK)).filter(t=>w1(t)&&VK(t)),w1=e=>{if(e.tabIndex>0||e.tabIndex===0&&e.getAttribute("tabIndex")!==null)return!0;if(e.tabIndex<0||e.hasAttribute("disabled")||e.getAttribute("aria-disabled")==="true")return!1;switch(e.nodeName){case"A":return!!e.href&&e.rel!=="ignore";case"INPUT":return!(e.type==="hidden"||e.type==="file");case"BUTTON":case"SELECT":case"TEXTAREA":return!0;default:return!1}},Gb=function(e,t,...i){let a;t.includes("mouse")||t.includes("click")?a="MouseEvents":t.includes("key")?a="KeyboardEvent":a="HTMLEvents";const d=document.createEvent(a);return d.initEvent(t,...i),e.dispatchEvent(d),e},Bz=e=>!e.getAttribute("aria-owns"),Vz=(e,t,i)=>{const{parentNode:a}=e;if(!a)return null;const d=a.querySelectorAll(i),p=Array.prototype.indexOf.call(d,e);return d[p+t]||null},Wb=e=>{e&&(e.focus(),!Bz(e)&&e.click())},$K="ElOnlyChild",$z=qe({name:$K,setup(e,{slots:t,attrs:i}){var a;const d=An(Nz),p=NK((a=d==null?void 0:d.setForwardRef)!=null?a:_o);return()=>{var _;const r=(_=t.default)==null?void 0:_.call(t,i);if(!r||r.length>1)return null;const S=Uz(r);return S?hr(zu(S,i),[[p]]):null}}});function Uz(e){if(!e)return null;const t=e;for(const i of t){if(yr(i))switch(i.type){case os:continue;case qm:case"svg":return N3(i);case Bn:return Uz(i.children);default:return i}return N3(i)}return null}function N3(e){const t=en("only-child");return Ze("span",{class:t.e("content")},[e])}const UK=qe({name:"ElPopperTrigger",inheritAttrs:!1}),jK=qe({...UK,props:Fz,setup(e,{expose:t}){const i=e,{role:a,triggerRef:d}=An(aE,void 0);FK(d);const p=ee(()=>r.value?i.id:void 0),_=ee(()=>{if(a&&a.value==="tooltip")return i.open&&i.id?i.id:void 0}),r=ee(()=>{if(a&&a.value!=="tooltip")return a.value}),S=ee(()=>r.value?`${i.open}`:void 0);let C;const M=["onMouseenter","onMouseleave","onClick","onKeydown","onFocus","onBlur","onContextmenu"];return gr(()=>{qt(()=>i.virtualRef,k=>{k&&(d.value=aa(k))},{immediate:!0}),qt(d,(k,z)=>{C==null||C(),C=void 0,la(k)&&(M.forEach(F=>{var B;const N=i[F];N&&(k.addEventListener(F.slice(2).toLowerCase(),N),(B=z==null?void 0:z.removeEventListener)==null||B.call(z,F.slice(2).toLowerCase(),N))}),w1(k)&&(C=qt([p,_,r,S],F=>{["aria-controls","aria-describedby","aria-haspopup","aria-expanded"].forEach((B,N)=>{Ki(F[N])?k.removeAttribute(B):k.setAttribute(B,F[N])})},{immediate:!0}))),la(z)&&w1(z)&&["aria-controls","aria-describedby","aria-haspopup","aria-expanded"].forEach(F=>z.removeAttribute(F))},{immediate:!0})}),Oo(()=>{if(C==null||C(),C=void 0,d.value&&la(d.value)){const k=d.value;M.forEach(z=>{const F=i[z];F&&k.removeEventListener(z.slice(2).toLowerCase(),F)}),d.value=void 0}}),t({triggerRef:d}),(k,z)=>k.virtualTriggering?yt("v-if",!0):(ae(),kt(b($z),Mr({key:0},k.$attrs,{"aria-controls":b(p),"aria-describedby":b(_),"aria-expanded":b(S),"aria-haspopup":b(r)}),{default:st(()=>[pt(k.$slots,"default")]),_:3},16,["aria-controls","aria-describedby","aria-expanded","aria-haspopup"]))}});var HK=fn(jK,[["__file","trigger.vue"]]);const tS="focus-trap.focus-after-trapped",nS="focus-trap.focus-after-released",GK="focus-trap.focusout-prevented",B3={cancelable:!0,bubbles:!1},WK={cancelable:!0,bubbles:!1},V3="focusAfterTrapped",$3="focusAfterReleased",lE=Symbol("elFocusTrap"),cE=Se(),vx=Se(0),uE=Se(0);let Sb=0;const jz=e=>{const t=[],i=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:a=>{const d=a.tagName==="INPUT"&&a.type==="hidden";return a.disabled||a.hidden||d?NodeFilter.FILTER_SKIP:a.tabIndex>=0||a===document.activeElement?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;i.nextNode();)t.push(i.currentNode);return t},U3=(e,t)=>{for(const i of e)if(!qK(i,t))return i},qK=(e,t)=>{if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(t&&e===t)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1},KK=e=>{const t=jz(e),i=U3(t,e),a=U3(t.reverse(),e);return[i,a]},ZK=e=>e instanceof HTMLInputElement&&"select"in e,Mu=(e,t)=>{if(e&&e.focus){const i=document.activeElement;let a=!1;la(e)&&!w1(e)&&!e.getAttribute("tabindex")&&(e.setAttribute("tabindex","-1"),a=!0),e.focus({preventScroll:!0}),uE.value=window.performance.now(),e!==i&&ZK(e)&&t&&e.select(),la(e)&&a&&e.removeAttribute("tabindex")}};function j3(e,t){const i=[...e],a=e.indexOf(t);return a!==-1&&i.splice(a,1),i}const YK=()=>{let e=[];return{push:a=>{const d=e[0];d&&a!==d&&d.pause(),e=j3(e,a),e.unshift(a)},remove:a=>{var d,p;e=j3(e,a),(p=(d=e[0])==null?void 0:d.resume)==null||p.call(d)}}},XK=(e,t=!1)=>{const i=document.activeElement;for(const a of e)if(Mu(a,t),document.activeElement!==i)return},H3=YK(),JK=()=>vx.value>uE.value,Tb=()=>{cE.value="pointer",vx.value=window.performance.now()},G3=()=>{cE.value="keyboard",vx.value=window.performance.now()},QK=()=>(gr(()=>{Sb===0&&(document.addEventListener("mousedown",Tb),document.addEventListener("touchstart",Tb),document.addEventListener("keydown",G3)),Sb++}),Oo(()=>{Sb--,Sb<=0&&(document.removeEventListener("mousedown",Tb),document.removeEventListener("touchstart",Tb),document.removeEventListener("keydown",G3))}),{focusReason:cE,lastUserFocusTimestamp:vx,lastAutomatedFocusTimestamp:uE}),Cb=e=>new CustomEvent(GK,{...WK,detail:e}),En={tab:"Tab",enter:"Enter",space:"Space",left:"ArrowLeft",up:"ArrowUp",right:"ArrowRight",down:"ArrowDown",esc:"Escape",delete:"Delete",backspace:"Backspace",numpadEnter:"NumpadEnter",pageUp:"PageUp",pageDown:"PageDown",home:"Home",end:"End"};let sm=[];const W3=e=>{e.code===En.esc&&sm.forEach(t=>t(e))},eZ=e=>{gr(()=>{sm.length===0&&document.addEventListener("keydown",W3),Hr&&sm.push(e)}),Oo(()=>{sm=sm.filter(t=>t!==e),sm.length===0&&Hr&&document.removeEventListener("keydown",W3)})},tZ=qe({name:"ElFocusTrap",inheritAttrs:!1,props:{loop:Boolean,trapped:Boolean,focusTrapEl:Object,focusStartEl:{type:[Object,String],default:"first"}},emits:[V3,$3,"focusin","focusout","focusout-prevented","release-requested"],setup(e,{emit:t}){const i=Se();let a,d;const{focusReason:p}=QK();eZ(B=>{e.trapped&&!_.paused&&t("release-requested",B)});const _={paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}},r=B=>{if(!e.loop&&!e.trapped||_.paused)return;const{code:N,altKey:j,ctrlKey:U,metaKey:te,currentTarget:Y,shiftKey:q}=B,{loop:J}=e,ne=N===En.tab&&!j&&!U&&!te,se=document.activeElement;if(ne&&se){const fe=Y,[ce,le]=KK(fe);if(ce&&le){if(!q&&se===le){const de=Cb({focusReason:p.value});t("focusout-prevented",de),de.defaultPrevented||(B.preventDefault(),J&&Mu(ce,!0))}else if(q&&[ce,fe].includes(se)){const de=Cb({focusReason:p.value});t("focusout-prevented",de),de.defaultPrevented||(B.preventDefault(),J&&Mu(le,!0))}}else if(se===fe){const de=Cb({focusReason:p.value});t("focusout-prevented",de),de.defaultPrevented||B.preventDefault()}}};Dr(lE,{focusTrapRef:i,onKeydown:r}),qt(()=>e.focusTrapEl,B=>{B&&(i.value=B)},{immediate:!0}),qt([i],([B],[N])=>{B&&(B.addEventListener("keydown",r),B.addEventListener("focusin",M),B.addEventListener("focusout",k)),N&&(N.removeEventListener("keydown",r),N.removeEventListener("focusin",M),N.removeEventListener("focusout",k))});const S=B=>{t(V3,B)},C=B=>t($3,B),M=B=>{const N=b(i);if(!N)return;const j=B.target,U=B.relatedTarget,te=j&&N.contains(j);e.trapped||U&&N.contains(U)||(a=U),te&&t("focusin",B),!_.paused&&e.trapped&&(te?d=j:Mu(d,!0))},k=B=>{const N=b(i);if(!(_.paused||!N))if(e.trapped){const j=B.relatedTarget;!Ki(j)&&!N.contains(j)&&setTimeout(()=>{if(!_.paused&&e.trapped){const U=Cb({focusReason:p.value});t("focusout-prevented",U),U.defaultPrevented||Mu(d,!0)}},0)}else{const j=B.target;j&&N.contains(j)||t("focusout",B)}};async function z(){await Vn();const B=b(i);if(B){H3.push(_);const N=B.contains(document.activeElement)?a:document.activeElement;if(a=N,!B.contains(N)){const U=new Event(tS,B3);B.addEventListener(tS,S),B.dispatchEvent(U),U.defaultPrevented||Vn(()=>{let te=e.focusStartEl;Dn(te)||(Mu(te),document.activeElement!==te&&(te="first")),te==="first"&&XK(jz(B),!0),(document.activeElement===N||te==="container")&&Mu(B)})}}}function F(){const B=b(i);if(B){B.removeEventListener(tS,S);const N=new CustomEvent(nS,{...B3,detail:{focusReason:p.value}});B.addEventListener(nS,C),B.dispatchEvent(N),!N.defaultPrevented&&(p.value=="keyboard"||!JK()||B.contains(document.activeElement))&&Mu(a??document.body),B.removeEventListener(nS,C),H3.remove(_)}}return gr(()=>{e.trapped&&z(),qt(()=>e.trapped,B=>{B?z():F()})}),Oo(()=>{e.trapped&&F(),i.value&&(i.value.removeEventListener("keydown",r),i.value.removeEventListener("focusin",M),i.value.removeEventListener("focusout",k),i.value=void 0)}),{onKeydown:r}}});function nZ(e,t,i,a,d,p){return pt(e.$slots,"default",{handleKeydown:e.onKeydown})}var eg=fn(tZ,[["render",nZ],["__file","focus-trap.vue"]]),ka="top",El="bottom",Ml="right",Pa="left",dE="auto",Ty=[ka,El,Ml,Pa],km="start",K_="end",rZ="clippingParents",Hz="viewport",l_="popper",oZ="reference",q3=Ty.reduce(function(e,t){return e.concat([t+"-"+km,t+"-"+K_])},[]),qu=[].concat(Ty,[dE]).reduce(function(e,t){return e.concat([t,t+"-"+km,t+"-"+K_])},[]),iZ="beforeRead",sZ="read",aZ="afterRead",lZ="beforeMain",cZ="main",uZ="afterMain",dZ="beforeWrite",hZ="write",fZ="afterWrite",pZ=[iZ,sZ,aZ,lZ,cZ,uZ,dZ,hZ,fZ];function Wc(e){return e?(e.nodeName||"").toLowerCase():null}function mc(e){if(e==null)return window;if(e.toString()!=="[object Window]"){var t=e.ownerDocument;return t&&t.defaultView||window}return e}function Pm(e){var t=mc(e).Element;return e instanceof t||e instanceof Element}function Sl(e){var t=mc(e).HTMLElement;return e instanceof t||e instanceof HTMLElement}function hE(e){if(typeof ShadowRoot>"u")return!1;var t=mc(e).ShadowRoot;return e instanceof t||e instanceof ShadowRoot}function mZ(e){var t=e.state;Object.keys(t.elements).forEach(function(i){var a=t.styles[i]||{},d=t.attributes[i]||{},p=t.elements[i];!Sl(p)||!Wc(p)||(Object.assign(p.style,a),Object.keys(d).forEach(function(_){var r=d[_];r===!1?p.removeAttribute(_):p.setAttribute(_,r===!0?"":r)}))})}function gZ(e){var t=e.state,i={popper:{position:t.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(t.elements.popper.style,i.popper),t.styles=i,t.elements.arrow&&Object.assign(t.elements.arrow.style,i.arrow),function(){Object.keys(t.elements).forEach(function(a){var d=t.elements[a],p=t.attributes[a]||{},_=Object.keys(t.styles.hasOwnProperty(a)?t.styles[a]:i[a]),r=_.reduce(function(S,C){return S[C]="",S},{});!Sl(d)||!Wc(d)||(Object.assign(d.style,r),Object.keys(p).forEach(function(S){d.removeAttribute(S)}))})}}var Gz={name:"applyStyles",enabled:!0,phase:"write",fn:mZ,effect:gZ,requires:["computeStyles"]};function Vc(e){return e.split("-")[0]}var Mf=Math.max,S1=Math.min,Rm=Math.round;function Om(e,t){t===void 0&&(t=!1);var i=e.getBoundingClientRect(),a=1,d=1;if(Sl(e)&&t){var p=e.offsetHeight,_=e.offsetWidth;_>0&&(a=Rm(i.width)/_||1),p>0&&(d=Rm(i.height)/p||1)}return{width:i.width/a,height:i.height/d,top:i.top/d,right:i.right/a,bottom:i.bottom/d,left:i.left/a,x:i.left/a,y:i.top/d}}function fE(e){var t=Om(e),i=e.offsetWidth,a=e.offsetHeight;return Math.abs(t.width-i)<=1&&(i=t.width),Math.abs(t.height-a)<=1&&(a=t.height),{x:e.offsetLeft,y:e.offsetTop,width:i,height:a}}function Wz(e,t){var i=t.getRootNode&&t.getRootNode();if(e.contains(t))return!0;if(i&&hE(i)){var a=t;do{if(a&&e.isSameNode(a))return!0;a=a.parentNode||a.host}while(a)}return!1}function Fu(e){return mc(e).getComputedStyle(e)}function vZ(e){return["table","td","th"].indexOf(Wc(e))>=0}function oh(e){return((Pm(e)?e.ownerDocument:e.document)||window.document).documentElement}function _x(e){return Wc(e)==="html"?e:e.assignedSlot||e.parentNode||(hE(e)?e.host:null)||oh(e)}function K3(e){return!Sl(e)||Fu(e).position==="fixed"?null:e.offsetParent}function _Z(e){var t=navigator.userAgent.toLowerCase().indexOf("firefox")!==-1,i=navigator.userAgent.indexOf("Trident")!==-1;if(i&&Sl(e)){var a=Fu(e);if(a.position==="fixed")return null}var d=_x(e);for(hE(d)&&(d=d.host);Sl(d)&&["html","body"].indexOf(Wc(d))<0;){var p=Fu(d);if(p.transform!=="none"||p.perspective!=="none"||p.contain==="paint"||["transform","perspective"].indexOf(p.willChange)!==-1||t&&p.willChange==="filter"||t&&p.filter&&p.filter!=="none")return d;d=d.parentNode}return null}function Cy(e){for(var t=mc(e),i=K3(e);i&&vZ(i)&&Fu(i).position==="static";)i=K3(i);return i&&(Wc(i)==="html"||Wc(i)==="body"&&Fu(i).position==="static")?t:i||_Z(e)||t}function pE(e){return["top","bottom"].indexOf(e)>=0?"x":"y"}function I_(e,t,i){return Mf(e,S1(t,i))}function yZ(e,t,i){var a=I_(e,t,i);return a>i?i:a}function qz(){return{top:0,right:0,bottom:0,left:0}}function Kz(e){return Object.assign({},qz(),e)}function Zz(e,t){return t.reduce(function(i,a){return i[a]=e,i},{})}var bZ=function(e,t){return e=typeof e=="function"?e(Object.assign({},t.rects,{placement:t.placement})):e,Kz(typeof e!="number"?e:Zz(e,Ty))};function xZ(e){var t,i=e.state,a=e.name,d=e.options,p=i.elements.arrow,_=i.modifiersData.popperOffsets,r=Vc(i.placement),S=pE(r),C=[Pa,Ml].indexOf(r)>=0,M=C?"height":"width";if(!(!p||!_)){var k=bZ(d.padding,i),z=fE(p),F=S==="y"?ka:Pa,B=S==="y"?El:Ml,N=i.rects.reference[M]+i.rects.reference[S]-_[S]-i.rects.popper[M],j=_[S]-i.rects.reference[S],U=Cy(p),te=U?S==="y"?U.clientHeight||0:U.clientWidth||0:0,Y=N/2-j/2,q=k[F],J=te-z[M]-k[B],ne=te/2-z[M]/2+Y,se=I_(q,ne,J),fe=S;i.modifiersData[a]=(t={},t[fe]=se,t.centerOffset=se-ne,t)}}function wZ(e){var t=e.state,i=e.options,a=i.element,d=a===void 0?"[data-popper-arrow]":a;d!=null&&(typeof d=="string"&&(d=t.elements.popper.querySelector(d),!d)||!Wz(t.elements.popper,d)||(t.elements.arrow=d))}var SZ={name:"arrow",enabled:!0,phase:"main",fn:xZ,effect:wZ,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function Lm(e){return e.split("-")[1]}var TZ={top:"auto",right:"auto",bottom:"auto",left:"auto"};function CZ(e){var t=e.x,i=e.y,a=window,d=a.devicePixelRatio||1;return{x:Rm(t*d)/d||0,y:Rm(i*d)/d||0}}function Z3(e){var t,i=e.popper,a=e.popperRect,d=e.placement,p=e.variation,_=e.offsets,r=e.position,S=e.gpuAcceleration,C=e.adaptive,M=e.roundOffsets,k=e.isFixed,z=_.x,F=z===void 0?0:z,B=_.y,N=B===void 0?0:B,j=typeof M=="function"?M({x:F,y:N}):{x:F,y:N};F=j.x,N=j.y;var U=_.hasOwnProperty("x"),te=_.hasOwnProperty("y"),Y=Pa,q=ka,J=window;if(C){var ne=Cy(i),se="clientHeight",fe="clientWidth";if(ne===mc(i)&&(ne=oh(i),Fu(ne).position!=="static"&&r==="absolute"&&(se="scrollHeight",fe="scrollWidth")),ne=ne,d===ka||(d===Pa||d===Ml)&&p===K_){q=El;var ce=k&&ne===J&&J.visualViewport?J.visualViewport.height:ne[se];N-=ce-a.height,N*=S?1:-1}if(d===Pa||(d===ka||d===El)&&p===K_){Y=Ml;var le=k&&ne===J&&J.visualViewport?J.visualViewport.width:ne[fe];F-=le-a.width,F*=S?1:-1}}var ge=Object.assign({position:r},C&&TZ),de=M===!0?CZ({x:F,y:N}):{x:F,y:N};if(F=de.x,N=de.y,S){var ke;return Object.assign({},ge,(ke={},ke[q]=te?"0":"",ke[Y]=U?"0":"",ke.transform=(J.devicePixelRatio||1)<=1?"translate("+F+"px, "+N+"px)":"translate3d("+F+"px, "+N+"px, 0)",ke))}return Object.assign({},ge,(t={},t[q]=te?N+"px":"",t[Y]=U?F+"px":"",t.transform="",t))}function EZ(e){var t=e.state,i=e.options,a=i.gpuAcceleration,d=a===void 0?!0:a,p=i.adaptive,_=p===void 0?!0:p,r=i.roundOffsets,S=r===void 0?!0:r,C={placement:Vc(t.placement),variation:Lm(t.placement),popper:t.elements.popper,popperRect:t.rects.popper,gpuAcceleration:d,isFixed:t.options.strategy==="fixed"};t.modifiersData.popperOffsets!=null&&(t.styles.popper=Object.assign({},t.styles.popper,Z3(Object.assign({},C,{offsets:t.modifiersData.popperOffsets,position:t.options.strategy,adaptive:_,roundOffsets:S})))),t.modifiersData.arrow!=null&&(t.styles.arrow=Object.assign({},t.styles.arrow,Z3(Object.assign({},C,{offsets:t.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:S})))),t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-placement":t.placement})}var Yz={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:EZ,data:{}},Eb={passive:!0};function MZ(e){var t=e.state,i=e.instance,a=e.options,d=a.scroll,p=d===void 0?!0:d,_=a.resize,r=_===void 0?!0:_,S=mc(t.elements.popper),C=[].concat(t.scrollParents.reference,t.scrollParents.popper);return p&&C.forEach(function(M){M.addEventListener("scroll",i.update,Eb)}),r&&S.addEventListener("resize",i.update,Eb),function(){p&&C.forEach(function(M){M.removeEventListener("scroll",i.update,Eb)}),r&&S.removeEventListener("resize",i.update,Eb)}}var Xz={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:MZ,data:{}},IZ={left:"right",right:"left",bottom:"top",top:"bottom"};function qb(e){return e.replace(/left|right|bottom|top/g,function(t){return IZ[t]})}var AZ={start:"end",end:"start"};function Y3(e){return e.replace(/start|end/g,function(t){return AZ[t]})}function mE(e){var t=mc(e),i=t.pageXOffset,a=t.pageYOffset;return{scrollLeft:i,scrollTop:a}}function gE(e){return Om(oh(e)).left+mE(e).scrollLeft}function kZ(e){var t=mc(e),i=oh(e),a=t.visualViewport,d=i.clientWidth,p=i.clientHeight,_=0,r=0;return a&&(d=a.width,p=a.height,/^((?!chrome|android).)*safari/i.test(navigator.userAgent)||(_=a.offsetLeft,r=a.offsetTop)),{width:d,height:p,x:_+gE(e),y:r}}function PZ(e){var t,i=oh(e),a=mE(e),d=(t=e.ownerDocument)==null?void 0:t.body,p=Mf(i.scrollWidth,i.clientWidth,d?d.scrollWidth:0,d?d.clientWidth:0),_=Mf(i.scrollHeight,i.clientHeight,d?d.scrollHeight:0,d?d.clientHeight:0),r=-a.scrollLeft+gE(e),S=-a.scrollTop;return Fu(d||i).direction==="rtl"&&(r+=Mf(i.clientWidth,d?d.clientWidth:0)-p),{width:p,height:_,x:r,y:S}}function vE(e){var t=Fu(e),i=t.overflow,a=t.overflowX,d=t.overflowY;return/auto|scroll|overlay|hidden/.test(i+d+a)}function Jz(e){return["html","body","#document"].indexOf(Wc(e))>=0?e.ownerDocument.body:Sl(e)&&vE(e)?e:Jz(_x(e))}function A_(e,t){var i;t===void 0&&(t=[]);var a=Jz(e),d=a===((i=e.ownerDocument)==null?void 0:i.body),p=mc(a),_=d?[p].concat(p.visualViewport||[],vE(a)?a:[]):a,r=t.concat(_);return d?r:r.concat(A_(_x(_)))}function QS(e){return Object.assign({},e,{left:e.x,top:e.y,right:e.x+e.width,bottom:e.y+e.height})}function RZ(e){var t=Om(e);return t.top=t.top+e.clientTop,t.left=t.left+e.clientLeft,t.bottom=t.top+e.clientHeight,t.right=t.left+e.clientWidth,t.width=e.clientWidth,t.height=e.clientHeight,t.x=t.left,t.y=t.top,t}function X3(e,t){return t===Hz?QS(kZ(e)):Pm(t)?RZ(t):QS(PZ(oh(e)))}function OZ(e){var t=A_(_x(e)),i=["absolute","fixed"].indexOf(Fu(e).position)>=0,a=i&&Sl(e)?Cy(e):e;return Pm(a)?t.filter(function(d){return Pm(d)&&Wz(d,a)&&Wc(d)!=="body"}):[]}function LZ(e,t,i){var a=t==="clippingParents"?OZ(e):[].concat(t),d=[].concat(a,[i]),p=d[0],_=d.reduce(function(r,S){var C=X3(e,S);return r.top=Mf(C.top,r.top),r.right=S1(C.right,r.right),r.bottom=S1(C.bottom,r.bottom),r.left=Mf(C.left,r.left),r},X3(e,p));return _.width=_.right-_.left,_.height=_.bottom-_.top,_.x=_.left,_.y=_.top,_}function Qz(e){var t=e.reference,i=e.element,a=e.placement,d=a?Vc(a):null,p=a?Lm(a):null,_=t.x+t.width/2-i.width/2,r=t.y+t.height/2-i.height/2,S;switch(d){case ka:S={x:_,y:t.y-i.height};break;case El:S={x:_,y:t.y+t.height};break;case Ml:S={x:t.x+t.width,y:r};break;case Pa:S={x:t.x-i.width,y:r};break;default:S={x:t.x,y:t.y}}var C=d?pE(d):null;if(C!=null){var M=C==="y"?"height":"width";switch(p){case km:S[C]=S[C]-(t[M]/2-i[M]/2);break;case K_:S[C]=S[C]+(t[M]/2-i[M]/2);break}}return S}function Z_(e,t){t===void 0&&(t={});var i=t,a=i.placement,d=a===void 0?e.placement:a,p=i.boundary,_=p===void 0?rZ:p,r=i.rootBoundary,S=r===void 0?Hz:r,C=i.elementContext,M=C===void 0?l_:C,k=i.altBoundary,z=k===void 0?!1:k,F=i.padding,B=F===void 0?0:F,N=Kz(typeof B!="number"?B:Zz(B,Ty)),j=M===l_?oZ:l_,U=e.rects.popper,te=e.elements[z?j:M],Y=LZ(Pm(te)?te:te.contextElement||oh(e.elements.popper),_,S),q=Om(e.elements.reference),J=Qz({reference:q,element:U,placement:d}),ne=QS(Object.assign({},U,J)),se=M===l_?ne:q,fe={top:Y.top-se.top+N.top,bottom:se.bottom-Y.bottom+N.bottom,left:Y.left-se.left+N.left,right:se.right-Y.right+N.right},ce=e.modifiersData.offset;if(M===l_&&ce){var le=ce[d];Object.keys(fe).forEach(function(ge){var de=[Ml,El].indexOf(ge)>=0?1:-1,ke=[ka,El].indexOf(ge)>=0?"y":"x";fe[ge]+=le[ke]*de})}return fe}function DZ(e,t){t===void 0&&(t={});var i=t,a=i.placement,d=i.boundary,p=i.rootBoundary,_=i.padding,r=i.flipVariations,S=i.allowedAutoPlacements,C=S===void 0?qu:S,M=Lm(a),k=M?r?q3:q3.filter(function(B){return Lm(B)===M}):Ty,z=k.filter(function(B){return C.indexOf(B)>=0});z.length===0&&(z=k);var F=z.reduce(function(B,N){return B[N]=Z_(e,{placement:N,boundary:d,rootBoundary:p,padding:_})[Vc(N)],B},{});return Object.keys(F).sort(function(B,N){return F[B]-F[N]})}function zZ(e){if(Vc(e)===dE)return[];var t=qb(e);return[Y3(e),t,Y3(t)]}function FZ(e){var t=e.state,i=e.options,a=e.name;if(!t.modifiersData[a]._skip){for(var d=i.mainAxis,p=d===void 0?!0:d,_=i.altAxis,r=_===void 0?!0:_,S=i.fallbackPlacements,C=i.padding,M=i.boundary,k=i.rootBoundary,z=i.altBoundary,F=i.flipVariations,B=F===void 0?!0:F,N=i.allowedAutoPlacements,j=t.options.placement,U=Vc(j),te=U===j,Y=S||(te||!B?[qb(j)]:zZ(j)),q=[j].concat(Y).reduce(function(wt,Mt){return wt.concat(Vc(Mt)===dE?DZ(t,{placement:Mt,boundary:M,rootBoundary:k,padding:C,flipVariations:B,allowedAutoPlacements:N}):Mt)},[]),J=t.rects.reference,ne=t.rects.popper,se=new Map,fe=!0,ce=q[0],le=0;le<q.length;le++){var ge=q[le],de=Vc(ge),ke=Lm(ge)===km,We=[ka,El].indexOf(de)>=0,we=We?"width":"height",be=Z_(t,{placement:ge,boundary:M,rootBoundary:k,altBoundary:z,padding:C}),Me=We?ke?Ml:Pa:ke?El:ka;J[we]>ne[we]&&(Me=qb(Me));var Ae=qb(Me),me=[];if(p&&me.push(be[de]<=0),r&&me.push(be[Me]<=0,be[Ae]<=0),me.every(function(wt){return wt})){ce=ge,fe=!1;break}se.set(ge,me)}if(fe)for(var Be=B?3:1,Ve=function(wt){var Mt=q.find(function(Nt){var vt=se.get(Nt);if(vt)return vt.slice(0,wt).every(function(Bt){return Bt})});if(Mt)return ce=Mt,"break"},bt=Be;bt>0;bt--){var Pe=Ve(bt);if(Pe==="break")break}t.placement!==ce&&(t.modifiersData[a]._skip=!0,t.placement=ce,t.reset=!0)}}var NZ={name:"flip",enabled:!0,phase:"main",fn:FZ,requiresIfExists:["offset"],data:{_skip:!1}};function J3(e,t,i){return i===void 0&&(i={x:0,y:0}),{top:e.top-t.height-i.y,right:e.right-t.width+i.x,bottom:e.bottom-t.height+i.y,left:e.left-t.width-i.x}}function Q3(e){return[ka,Ml,El,Pa].some(function(t){return e[t]>=0})}function BZ(e){var t=e.state,i=e.name,a=t.rects.reference,d=t.rects.popper,p=t.modifiersData.preventOverflow,_=Z_(t,{elementContext:"reference"}),r=Z_(t,{altBoundary:!0}),S=J3(_,a),C=J3(r,d,p),M=Q3(S),k=Q3(C);t.modifiersData[i]={referenceClippingOffsets:S,popperEscapeOffsets:C,isReferenceHidden:M,hasPopperEscaped:k},t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-reference-hidden":M,"data-popper-escaped":k})}var VZ={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:BZ};function $Z(e,t,i){var a=Vc(e),d=[Pa,ka].indexOf(a)>=0?-1:1,p=typeof i=="function"?i(Object.assign({},t,{placement:e})):i,_=p[0],r=p[1];return _=_||0,r=(r||0)*d,[Pa,Ml].indexOf(a)>=0?{x:r,y:_}:{x:_,y:r}}function UZ(e){var t=e.state,i=e.options,a=e.name,d=i.offset,p=d===void 0?[0,0]:d,_=qu.reduce(function(M,k){return M[k]=$Z(k,t.rects,p),M},{}),r=_[t.placement],S=r.x,C=r.y;t.modifiersData.popperOffsets!=null&&(t.modifiersData.popperOffsets.x+=S,t.modifiersData.popperOffsets.y+=C),t.modifiersData[a]=_}var jZ={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:UZ};function HZ(e){var t=e.state,i=e.name;t.modifiersData[i]=Qz({reference:t.rects.reference,element:t.rects.popper,placement:t.placement})}var eF={name:"popperOffsets",enabled:!0,phase:"read",fn:HZ,data:{}};function GZ(e){return e==="x"?"y":"x"}function WZ(e){var t=e.state,i=e.options,a=e.name,d=i.mainAxis,p=d===void 0?!0:d,_=i.altAxis,r=_===void 0?!1:_,S=i.boundary,C=i.rootBoundary,M=i.altBoundary,k=i.padding,z=i.tether,F=z===void 0?!0:z,B=i.tetherOffset,N=B===void 0?0:B,j=Z_(t,{boundary:S,rootBoundary:C,padding:k,altBoundary:M}),U=Vc(t.placement),te=Lm(t.placement),Y=!te,q=pE(U),J=GZ(q),ne=t.modifiersData.popperOffsets,se=t.rects.reference,fe=t.rects.popper,ce=typeof N=="function"?N(Object.assign({},t.rects,{placement:t.placement})):N,le=typeof ce=="number"?{mainAxis:ce,altAxis:ce}:Object.assign({mainAxis:0,altAxis:0},ce),ge=t.modifiersData.offset?t.modifiersData.offset[t.placement]:null,de={x:0,y:0};if(ne){if(p){var ke,We=q==="y"?ka:Pa,we=q==="y"?El:Ml,be=q==="y"?"height":"width",Me=ne[q],Ae=Me+j[We],me=Me-j[we],Be=F?-fe[be]/2:0,Ve=te===km?se[be]:fe[be],bt=te===km?-fe[be]:-se[be],Pe=t.elements.arrow,wt=F&&Pe?fE(Pe):{width:0,height:0},Mt=t.modifiersData["arrow#persistent"]?t.modifiersData["arrow#persistent"].padding:qz(),Nt=Mt[We],vt=Mt[we],Bt=I_(0,se[be],wt[be]),Wt=Y?se[be]/2-Be-Bt-Nt-le.mainAxis:Ve-Bt-Nt-le.mainAxis,Fe=Y?-se[be]/2+Be+Bt+vt+le.mainAxis:bt+Bt+vt+le.mainAxis,cn=t.elements.arrow&&Cy(t.elements.arrow),Re=cn?q==="y"?cn.clientTop||0:cn.clientLeft||0:0,nt=(ke=ge==null?void 0:ge[q])!=null?ke:0,Qe=Me+Wt-nt-Re,Yt=Me+Fe-nt,Xt=I_(F?S1(Ae,Qe):Ae,Me,F?Mf(me,Yt):me);ne[q]=Xt,de[q]=Xt-Me}if(r){var $t,Ot=q==="x"?ka:Pa,Ft=q==="x"?El:Ml,sn=ne[J],an=J==="y"?"height":"width",Pn=sn+j[Ot],bn=sn-j[Ft],It=[ka,Pa].indexOf(U)!==-1,Sn=($t=ge==null?void 0:ge[J])!=null?$t:0,Yn=It?Pn:sn-se[an]-fe[an]-Sn+le.altAxis,vr=It?sn+se[an]+fe[an]-Sn-le.altAxis:bn,tr=F&&It?yZ(Yn,sn,vr):I_(F?Yn:Pn,sn,F?vr:bn);ne[J]=tr,de[J]=tr-sn}t.modifiersData[a]=de}}var qZ={name:"preventOverflow",enabled:!0,phase:"main",fn:WZ,requiresIfExists:["offset"]};function KZ(e){return{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}}function ZZ(e){return e===mc(e)||!Sl(e)?mE(e):KZ(e)}function YZ(e){var t=e.getBoundingClientRect(),i=Rm(t.width)/e.offsetWidth||1,a=Rm(t.height)/e.offsetHeight||1;return i!==1||a!==1}function XZ(e,t,i){i===void 0&&(i=!1);var a=Sl(t),d=Sl(t)&&YZ(t),p=oh(t),_=Om(e,d),r={scrollLeft:0,scrollTop:0},S={x:0,y:0};return(a||!a&&!i)&&((Wc(t)!=="body"||vE(p))&&(r=ZZ(t)),Sl(t)?(S=Om(t,!0),S.x+=t.clientLeft,S.y+=t.clientTop):p&&(S.x=gE(p))),{x:_.left+r.scrollLeft-S.x,y:_.top+r.scrollTop-S.y,width:_.width,height:_.height}}function JZ(e){var t=new Map,i=new Set,a=[];e.forEach(function(p){t.set(p.name,p)});function d(p){i.add(p.name);var _=[].concat(p.requires||[],p.requiresIfExists||[]);_.forEach(function(r){if(!i.has(r)){var S=t.get(r);S&&d(S)}}),a.push(p)}return e.forEach(function(p){i.has(p.name)||d(p)}),a}function QZ(e){var t=JZ(e);return pZ.reduce(function(i,a){return i.concat(t.filter(function(d){return d.phase===a}))},[])}function eY(e){var t;return function(){return t||(t=new Promise(function(i){Promise.resolve().then(function(){t=void 0,i(e())})})),t}}function tY(e){var t=e.reduce(function(i,a){var d=i[a.name];return i[a.name]=d?Object.assign({},d,a,{options:Object.assign({},d.options,a.options),data:Object.assign({},d.data,a.data)}):a,i},{});return Object.keys(t).map(function(i){return t[i]})}var eR={placement:"bottom",modifiers:[],strategy:"absolute"};function tR(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return!t.some(function(a){return!(a&&typeof a.getBoundingClientRect=="function")})}function _E(e){e===void 0&&(e={});var t=e,i=t.defaultModifiers,a=i===void 0?[]:i,d=t.defaultOptions,p=d===void 0?eR:d;return function(_,r,S){S===void 0&&(S=p);var C={placement:"bottom",orderedModifiers:[],options:Object.assign({},eR,p),modifiersData:{},elements:{reference:_,popper:r},attributes:{},styles:{}},M=[],k=!1,z={state:C,setOptions:function(N){var j=typeof N=="function"?N(C.options):N;B(),C.options=Object.assign({},p,C.options,j),C.scrollParents={reference:Pm(_)?A_(_):_.contextElement?A_(_.contextElement):[],popper:A_(r)};var U=QZ(tY([].concat(a,C.options.modifiers)));return C.orderedModifiers=U.filter(function(te){return te.enabled}),F(),z.update()},forceUpdate:function(){if(!k){var N=C.elements,j=N.reference,U=N.popper;if(tR(j,U)){C.rects={reference:XZ(j,Cy(U),C.options.strategy==="fixed"),popper:fE(U)},C.reset=!1,C.placement=C.options.placement,C.orderedModifiers.forEach(function(fe){return C.modifiersData[fe.name]=Object.assign({},fe.data)});for(var te=0;te<C.orderedModifiers.length;te++){if(C.reset===!0){C.reset=!1,te=-1;continue}var Y=C.orderedModifiers[te],q=Y.fn,J=Y.options,ne=J===void 0?{}:J,se=Y.name;typeof q=="function"&&(C=q({state:C,options:ne,name:se,instance:z})||C)}}}},update:eY(function(){return new Promise(function(N){z.forceUpdate(),N(C)})}),destroy:function(){B(),k=!0}};if(!tR(_,r))return z;z.setOptions(S).then(function(N){!k&&S.onFirstUpdate&&S.onFirstUpdate(N)});function F(){C.orderedModifiers.forEach(function(N){var j=N.name,U=N.options,te=U===void 0?{}:U,Y=N.effect;if(typeof Y=="function"){var q=Y({state:C,name:j,instance:z,options:te}),J=function(){};M.push(q||J)}})}function B(){M.forEach(function(N){return N()}),M=[]}return z}}_E();var nY=[Xz,eF,Yz,Gz];_E({defaultModifiers:nY});var rY=[Xz,eF,Yz,Gz,jZ,NZ,qZ,SZ,VZ],oY=_E({defaultModifiers:rY});const iY=["fixed","absolute"],sY=un({boundariesPadding:{type:Number,default:0},fallbackPlacements:{type:dt(Array),default:void 0},gpuAcceleration:{type:Boolean,default:!0},offset:{type:Number,default:12},placement:{type:String,values:qu,default:"bottom"},popperOptions:{type:dt(Object),default:()=>({})},strategy:{type:String,values:iY,default:"absolute"}}),tF=un({...sY,id:String,style:{type:dt([String,Array,Object])},className:{type:dt([String,Array,Object])},effect:{type:dt(String),default:"dark"},visible:Boolean,enterable:{type:Boolean,default:!0},pure:Boolean,focusOnShow:{type:Boolean,default:!1},trapping:{type:Boolean,default:!1},popperClass:{type:dt([String,Array,Object])},popperStyle:{type:dt([String,Array,Object])},referenceEl:{type:dt(Object)},triggerTargetEl:{type:dt(Object)},stopPopperMouseEvent:{type:Boolean,default:!0},virtualTriggering:Boolean,zIndex:Number,..._s(["ariaLabel"])}),aY={mouseenter:e=>e instanceof MouseEvent,mouseleave:e=>e instanceof MouseEvent,focus:()=>!0,blur:()=>!0,close:()=>!0},lY=(e,t)=>{const i=Se(!1),a=Se();return{focusStartRef:a,trapped:i,onFocusAfterReleased:C=>{var M;((M=C.detail)==null?void 0:M.focusReason)!=="pointer"&&(a.value="first",t("blur"))},onFocusAfterTrapped:()=>{t("focus")},onFocusInTrap:C=>{e.visible&&!i.value&&(C.target&&(a.value=C.target),i.value=!0)},onFocusoutPrevented:C=>{e.trapping||(C.detail.focusReason==="pointer"&&C.preventDefault(),i.value=!1)},onReleaseRequested:()=>{i.value=!1,t("close")}}},cY=(e,t=[])=>{const{placement:i,strategy:a,popperOptions:d}=e,p={placement:i,strategy:a,...d,modifiers:[...dY(e),...t]};return hY(p,d==null?void 0:d.modifiers),p},uY=e=>{if(Hr)return aa(e)};function dY(e){const{offset:t,gpuAcceleration:i,fallbackPlacements:a}=e;return[{name:"offset",options:{offset:[0,t??12]}},{name:"preventOverflow",options:{padding:{top:2,bottom:2,left:5,right:5}}},{name:"flip",options:{padding:5,fallbackPlacements:a}},{name:"computeStyles",options:{gpuAcceleration:i}}]}function hY(e,t){t&&(e.modifiers=[...e.modifiers,...t??[]])}const fY=(e,t,i={})=>{const a={name:"updateState",enabled:!0,phase:"write",fn:({state:S})=>{const C=pY(S);Object.assign(_.value,C)},requires:["computeStyles"]},d=ee(()=>{const{onFirstUpdate:S,placement:C,strategy:M,modifiers:k}=b(i);return{onFirstUpdate:S,placement:C||"bottom",strategy:M||"absolute",modifiers:[...k||[],a,{name:"applyStyles",enabled:!1}]}}),p=Uo(),_=Se({styles:{popper:{position:b(d).strategy,left:"0",top:"0"},arrow:{position:"absolute"}},attributes:{}}),r=()=>{p.value&&(p.value.destroy(),p.value=void 0)};return qt(d,S=>{const C=b(p);C&&C.setOptions(S)},{deep:!0}),qt([e,t],([S,C])=>{r(),!(!S||!C)&&(p.value=oY(S,C,b(d)))}),Oo(()=>{r()}),{state:ee(()=>{var S;return{...((S=b(p))==null?void 0:S.state)||{}}}),styles:ee(()=>b(_).styles),attributes:ee(()=>b(_).attributes),update:()=>{var S;return(S=b(p))==null?void 0:S.update()},forceUpdate:()=>{var S;return(S=b(p))==null?void 0:S.forceUpdate()},instanceRef:ee(()=>b(p))}};function pY(e){const t=Object.keys(e.elements),i=q_(t.map(d=>[d,e.styles[d]||{}])),a=q_(t.map(d=>[d,e.attributes[d]]));return{styles:i,attributes:a}}const mY=0,gY=e=>{const{popperInstanceRef:t,contentRef:i,triggerRef:a,role:d}=An(aE,void 0),p=Se(),_=Se(),r=ee(()=>({name:"eventListeners",enabled:!!e.visible})),S=ee(()=>{var U;const te=b(p),Y=(U=b(_))!=null?U:mY;return{name:"arrow",enabled:!sz(te),options:{element:te,padding:Y}}}),C=ee(()=>({onFirstUpdate:()=>{B()},...cY(e,[b(S),b(r)])})),M=ee(()=>uY(e.referenceEl)||b(a)),{attributes:k,state:z,styles:F,update:B,forceUpdate:N,instanceRef:j}=fY(M,i,C);return qt(j,U=>t.value=U),gr(()=>{qt(()=>{var U;return(U=b(M))==null?void 0:U.getBoundingClientRect()},()=>{B()})}),{attributes:k,arrowRef:p,contentRef:i,instanceRef:j,state:z,styles:F,role:d,forceUpdate:N,update:B}},vY=(e,{attributes:t,styles:i,role:a})=>{const{nextZIndex:d}=Jm(),p=en("popper"),_=ee(()=>b(t).popper),r=Se(Gn(e.zIndex)?e.zIndex:d()),S=ee(()=>[p.b(),p.is("pure",e.pure),p.is(e.effect),e.popperClass]),C=ee(()=>[{zIndex:b(r)},b(i).popper,e.popperStyle||{}]),M=ee(()=>a.value==="dialog"?"false":void 0),k=ee(()=>b(i).arrow||{});return{ariaModal:M,arrowStyle:k,contentAttrs:_,contentClass:S,contentStyle:C,contentZIndex:r,updateZIndex:()=>{r.value=Gn(e.zIndex)?e.zIndex:d()}}},_Y=qe({name:"ElPopperContent"}),yY=qe({..._Y,props:tF,emits:aY,setup(e,{expose:t,emit:i}){const a=e,{focusStartRef:d,trapped:p,onFocusAfterReleased:_,onFocusAfterTrapped:r,onFocusInTrap:S,onFocusoutPrevented:C,onReleaseRequested:M}=lY(a,i),{attributes:k,arrowRef:z,contentRef:F,styles:B,instanceRef:N,role:j,update:U}=gY(a),{ariaModal:te,arrowStyle:Y,contentAttrs:q,contentClass:J,contentStyle:ne,updateZIndex:se}=vY(a,{styles:B,attributes:k,role:j}),fe=An(Gc,void 0),ce=Se();Dr(Lz,{arrowStyle:Y,arrowRef:z,arrowOffset:ce}),fe&&Dr(Gc,{...fe,addInputId:_o,removeInputId:_o});let le;const ge=(ke=!0)=>{U(),ke&&se()},de=()=>{ge(!1),a.visible&&a.focusOnShow?p.value=!0:a.visible===!1&&(p.value=!1)};return gr(()=>{qt(()=>a.triggerTargetEl,(ke,We)=>{le==null||le(),le=void 0;const we=b(ke||F.value),be=b(We||F.value);la(we)&&(le=qt([j,()=>a.ariaLabel,te,()=>a.id],Me=>{["role","aria-label","aria-modal","id"].forEach((Ae,me)=>{Ki(Me[me])?we.removeAttribute(Ae):we.setAttribute(Ae,Me[me])})},{immediate:!0})),be!==we&&la(be)&&["role","aria-label","aria-modal","id"].forEach(Me=>{be.removeAttribute(Me)})},{immediate:!0}),qt(()=>a.visible,de,{immediate:!0})}),Oo(()=>{le==null||le(),le=void 0}),t({popperContentRef:F,popperInstanceRef:N,updatePopper:ge,contentStyle:ne}),(ke,We)=>(ae(),Oe("div",Mr({ref_key:"contentRef",ref:F},b(q),{style:b(ne),class:b(J),tabindex:"-1",onMouseenter:we=>ke.$emit("mouseenter",we),onMouseleave:we=>ke.$emit("mouseleave",we)}),[Ze(b(eg),{trapped:b(p),"trap-on-focus-in":!0,"focus-trap-el":b(F),"focus-start-el":b(d),onFocusAfterTrapped:b(r),onFocusAfterReleased:b(_),onFocusin:b(S),onFocusoutPrevented:b(C),onReleaseRequested:b(M)},{default:st(()=>[pt(ke.$slots,"default")]),_:3},8,["trapped","focus-trap-el","focus-start-el","onFocusAfterTrapped","onFocusAfterReleased","onFocusin","onFocusoutPrevented","onReleaseRequested"])],16,["onMouseenter","onMouseleave"]))}});var bY=fn(yY,[["__file","content.vue"]]);const nF=ur(OK),yx=Symbol("elTooltip");function nR(){let e;const t=(a,d)=>{i(),e=window.setTimeout(a,d)},i=()=>window.clearTimeout(e);return by(()=>i()),{registerTimeout:t,cancelTimeout:i}}const xY=un({showAfter:{type:Number,default:0},hideAfter:{type:Number,default:200},autoClose:{type:Number,default:0}}),wY=({showAfter:e,hideAfter:t,autoClose:i,open:a,close:d})=>{const{registerTimeout:p}=nR(),{registerTimeout:_,cancelTimeout:r}=nR();return{onOpen:M=>{p(()=>{a(M);const k=b(i);Gn(k)&&k>0&&_(()=>{d(M)},k)},b(e))},onClose:M=>{r(),p(()=>{d(M)},b(t))}}},rs=un({...xY,...tF,appendTo:{type:dt([String,Object])},content:{type:String,default:""},rawContent:Boolean,persistent:Boolean,visible:{type:dt(Boolean),default:null},transition:String,teleported:{type:Boolean,default:!0},disabled:Boolean,..._s(["ariaLabel"])}),Y_=un({...Fz,disabled:Boolean,trigger:{type:dt([String,Array]),default:"hover"},triggerKeys:{type:dt(Array),default:()=>[En.enter,En.numpadEnter,En.space]}}),SY=pc({type:dt(Boolean),default:null}),TY=pc({type:dt(Function)}),CY=e=>{const t=`update:${e}`,i=`onUpdate:${e}`,a=[t],d={[e]:SY,[i]:TY};return{useModelToggle:({indicator:_,toggleReason:r,shouldHideWhenRouteChanges:S,shouldProceed:C,onShow:M,onHide:k})=>{const z=wr(),{emit:F}=z,B=z.props,N=ee(()=>Nn(B[i])),j=ee(()=>B[e]===null),U=se=>{_.value!==!0&&(_.value=!0,r&&(r.value=se),Nn(M)&&M(se))},te=se=>{_.value!==!1&&(_.value=!1,r&&(r.value=se),Nn(k)&&k(se))},Y=se=>{if(B.disabled===!0||Nn(C)&&!C())return;const fe=N.value&&Hr;fe&&F(t,!0),(j.value||!fe)&&U(se)},q=se=>{if(B.disabled===!0||!Hr)return;const fe=N.value&&Hr;fe&&F(t,!1),(j.value||!fe)&&te(se)},J=se=>{Ro(se)&&(B.disabled&&se?N.value&&F(t,!1):_.value!==se&&(se?U():te()))},ne=()=>{_.value?q():Y()};return qt(()=>B[e],J),S&&z.appContext.config.globalProperties.$route!==void 0&&qt(()=>({...z.proxy.$route}),()=>{S.value&&_.value&&q()}),gr(()=>{J(B[e])}),{hide:q,show:Y,toggle:ne,hasUpdateHandler:N}},useModelToggleProps:d,useModelToggleEmits:a}},{useModelToggleProps:EY,useModelToggleEmits:MY,useModelToggle:IY}=CY("visible"),AY=un({...Dz,...EY,...rs,...Y_,...zz,showArrow:{type:Boolean,default:!0}}),kY=[...MY,"before-show","before-hide","show","hide","open","close"],PY=(e,t)=>ln(e)?e.includes(t):e===t,em=(e,t,i)=>a=>{PY(b(e),t)&&i(a)},_i=(e,t,{checkForDefaultPrevented:i=!0}={})=>d=>{const p=e==null?void 0:e(d);if(i===!1||!p)return t==null?void 0:t(d)},rR=e=>t=>t.pointerType==="mouse"?e(t):void 0,RY=qe({name:"ElTooltipTrigger"}),OY=qe({...RY,props:Y_,setup(e,{expose:t}){const i=e,a=en("tooltip"),{controlled:d,id:p,open:_,onOpen:r,onClose:S,onToggle:C}=An(yx,void 0),M=Se(null),k=()=>{if(b(d)||i.disabled)return!0},z=po(i,"trigger"),F=_i(k,em(z,"hover",r)),B=_i(k,em(z,"hover",S)),N=_i(k,em(z,"click",q=>{q.button===0&&C(q)})),j=_i(k,em(z,"focus",r)),U=_i(k,em(z,"focus",S)),te=_i(k,em(z,"contextmenu",q=>{q.preventDefault(),C(q)})),Y=_i(k,q=>{const{code:J}=q;i.triggerKeys.includes(J)&&(q.preventDefault(),C(q))});return t({triggerRef:M}),(q,J)=>(ae(),kt(b(HK),{id:b(p),"virtual-ref":q.virtualRef,open:b(_),"virtual-triggering":q.virtualTriggering,class:pe(b(a).e("trigger")),onBlur:b(U),onClick:b(N),onContextmenu:b(te),onFocus:b(j),onMouseenter:b(F),onMouseleave:b(B),onKeydown:b(Y)},{default:st(()=>[pt(q.$slots,"default")]),_:3},8,["id","virtual-ref","open","virtual-triggering","class","onBlur","onClick","onContextmenu","onFocus","onMouseenter","onMouseleave","onKeydown"]))}});var LY=fn(OY,[["__file","trigger.vue"]]);const DY=un({to:{type:dt([String,Object]),required:!0},disabled:Boolean}),zY=qe({__name:"teleport",props:DY,setup(e){return(t,i)=>t.disabled?pt(t.$slots,"default",{key:0}):(ae(),kt(k6,{key:1,to:t.to},[pt(t.$slots,"default")],8,["to"]))}});var FY=fn(zY,[["__file","teleport.vue"]]);const tg=ur(FY),rF=()=>{const e=PC(),t=iE(),i=ee(()=>`${e.value}-popper-container-${t.prefix}`),a=ee(()=>`#${i.value}`);return{id:i,selector:a}},NY=e=>{const t=document.createElement("div");return t.id=e,document.body.appendChild(t),t},BY=()=>{const{id:e,selector:t}=rF();return fy(()=>{Hr&&(document.body.querySelector(t.value)||NY(e.value))}),{id:e,selector:t}},VY=qe({name:"ElTooltipContent",inheritAttrs:!1}),$Y=qe({...VY,props:rs,setup(e,{expose:t}){const i=e,{selector:a}=rF(),d=en("tooltip"),p=Se();let _;const{controlled:r,id:S,open:C,trigger:M,onClose:k,onOpen:z,onShow:F,onHide:B,onBeforeShow:N,onBeforeHide:j}=An(yx,void 0),U=ee(()=>i.transition||`${d.namespace.value}-fade-in-linear`),te=ee(()=>i.persistent);Oo(()=>{_==null||_()});const Y=ee(()=>b(te)?!0:b(C)),q=ee(()=>i.disabled?!1:b(C)),J=ee(()=>i.appendTo||a.value),ne=ee(()=>{var Me;return(Me=i.style)!=null?Me:{}}),se=Se(!0),fe=()=>{B(),be()&&Mu(document.body),se.value=!0},ce=()=>{if(b(r))return!0},le=_i(ce,()=>{i.enterable&&b(M)==="hover"&&z()}),ge=_i(ce,()=>{b(M)==="hover"&&k()}),de=()=>{var Me,Ae;(Ae=(Me=p.value)==null?void 0:Me.updatePopper)==null||Ae.call(Me),N==null||N()},ke=()=>{j==null||j()},We=()=>{F(),_=KC(ee(()=>{var Me;return(Me=p.value)==null?void 0:Me.popperContentRef}),()=>{if(b(r))return;b(M)!=="hover"&&k()})},we=()=>{i.virtualTriggering||k()},be=Me=>{var Ae;const me=(Ae=p.value)==null?void 0:Ae.popperContentRef,Be=(Me==null?void 0:Me.relatedTarget)||document.activeElement;return me==null?void 0:me.contains(Be)};return qt(()=>b(C),Me=>{Me?se.value=!1:_==null||_()},{flush:"post"}),qt(()=>i.content,()=>{var Me,Ae;(Ae=(Me=p.value)==null?void 0:Me.updatePopper)==null||Ae.call(Me)}),t({contentRef:p,isFocusInsideContent:be}),(Me,Ae)=>(ae(),kt(b(tg),{disabled:!Me.teleported,to:b(J)},{default:st(()=>[Ze(ls,{name:b(U),onAfterLeave:fe,onBeforeEnter:de,onAfterEnter:We,onBeforeLeave:ke},{default:st(()=>[b(Y)?hr((ae(),kt(b(bY),Mr({key:0,id:b(S),ref_key:"contentRef",ref:p},Me.$attrs,{"aria-label":Me.ariaLabel,"aria-hidden":se.value,"boundaries-padding":Me.boundariesPadding,"fallback-placements":Me.fallbackPlacements,"gpu-acceleration":Me.gpuAcceleration,offset:Me.offset,placement:Me.placement,"popper-options":Me.popperOptions,strategy:Me.strategy,effect:Me.effect,enterable:Me.enterable,pure:Me.pure,"popper-class":Me.popperClass,"popper-style":[Me.popperStyle,b(ne)],"reference-el":Me.referenceEl,"trigger-target-el":Me.triggerTargetEl,visible:b(q),"z-index":Me.zIndex,onMouseenter:b(le),onMouseleave:b(ge),onBlur:we,onClose:b(k)}),{default:st(()=>[pt(Me.$slots,"default")]),_:3},16,["id","aria-label","aria-hidden","boundaries-padding","fallback-placements","gpu-acceleration","offset","placement","popper-options","strategy","effect","enterable","pure","popper-class","popper-style","reference-el","trigger-target-el","visible","z-index","onMouseenter","onMouseleave","onClose"])),[[no,b(q)]]):yt("v-if",!0)]),_:3},8,["name"])]),_:3},8,["disabled","to"]))}});var UY=fn($Y,[["__file","content.vue"]]);const jY=qe({name:"ElTooltip"}),HY=qe({...jY,props:AY,emits:kY,setup(e,{expose:t,emit:i}){const a=e;BY();const d=vs(),p=Se(),_=Se(),r=()=>{var U;const te=b(p);te&&((U=te.popperInstanceRef)==null||U.update())},S=Se(!1),C=Se(),{show:M,hide:k,hasUpdateHandler:z}=IY({indicator:S,toggleReason:C}),{onOpen:F,onClose:B}=wY({showAfter:po(a,"showAfter"),hideAfter:po(a,"hideAfter"),autoClose:po(a,"autoClose"),open:M,close:k}),N=ee(()=>Ro(a.visible)&&!z.value);Dr(yx,{controlled:N,id:d,open:Wm(S),trigger:po(a,"trigger"),onOpen:U=>{F(U)},onClose:U=>{B(U)},onToggle:U=>{b(S)?B(U):F(U)},onShow:()=>{i("show",C.value)},onHide:()=>{i("hide",C.value)},onBeforeShow:()=>{i("before-show",C.value)},onBeforeHide:()=>{i("before-hide",C.value)},updatePopper:r}),qt(()=>a.disabled,U=>{U&&S.value&&(S.value=!1)});const j=U=>{var te;return(te=_.value)==null?void 0:te.isFocusInsideContent(U)};return IL(()=>S.value&&k()),t({popperRef:p,contentRef:_,isFocusInsideContent:j,updatePopper:r,onOpen:F,onClose:B,hide:k}),(U,te)=>(ae(),kt(b(nF),{ref_key:"popperRef",ref:p,role:U.role},{default:st(()=>[Ze(LY,{disabled:U.disabled,trigger:U.trigger,"trigger-keys":U.triggerKeys,"virtual-ref":U.virtualRef,"virtual-triggering":U.virtualTriggering},{default:st(()=>[U.$slots.default?pt(U.$slots,"default",{key:0}):yt("v-if",!0)]),_:3},8,["disabled","trigger","trigger-keys","virtual-ref","virtual-triggering"]),Ze(UY,{ref_key:"contentRef",ref:_,"aria-label":U.ariaLabel,"boundaries-padding":U.boundariesPadding,content:U.content,disabled:U.disabled,effect:U.effect,enterable:U.enterable,"fallback-placements":U.fallbackPlacements,"hide-after":U.hideAfter,"gpu-acceleration":U.gpuAcceleration,offset:U.offset,persistent:U.persistent,"popper-class":U.popperClass,"popper-style":U.popperStyle,placement:U.placement,"popper-options":U.popperOptions,pure:U.pure,"raw-content":U.rawContent,"reference-el":U.referenceEl,"trigger-target-el":U.triggerTargetEl,"show-after":U.showAfter,strategy:U.strategy,teleported:U.teleported,transition:U.transition,"virtual-triggering":U.virtualTriggering,"z-index":U.zIndex,"append-to":U.appendTo},{default:st(()=>[pt(U.$slots,"content",{},()=>[U.rawContent?(ae(),Oe("span",{key:0,innerHTML:U.content},null,8,["innerHTML"])):(ae(),Oe("span",{key:1},pn(U.content),1))]),U.showArrow?(ae(),kt(b(zK),{key:0,"arrow-offset":U.arrowOffset},null,8,["arrow-offset"])):yt("v-if",!0)]),_:3},8,["aria-label","boundaries-padding","content","disabled","effect","enterable","fallback-placements","hide-after","gpu-acceleration","offset","persistent","popper-class","popper-style","placement","popper-options","pure","raw-content","reference-el","trigger-target-el","show-after","strategy","teleported","transition","virtual-triggering","z-index","append-to"])]),_:3},8,["role"]))}});var GY=fn(HY,[["__file","tooltip.vue"]]);const Is=ur(GY),WY=un({valueKey:{type:String,default:"value"},modelValue:{type:[String,Number],default:""},debounce:{type:Number,default:300},placement:{type:dt(String),values:["top","top-start","top-end","bottom","bottom-start","bottom-end"],default:"bottom-start"},fetchSuggestions:{type:dt([Function,Array]),default:_o},popperClass:{type:String,default:""},triggerOnFocus:{type:Boolean,default:!0},selectWhenUnmatched:{type:Boolean,default:!1},hideLoading:{type:Boolean,default:!1},teleported:rs.teleported,highlightFirstItem:{type:Boolean,default:!1},fitInputWidth:{type:Boolean,default:!1},clearable:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},name:String,..._s(["ariaLabel"])}),qY={[mr]:e=>Dn(e),[Es]:e=>Dn(e),[Eo]:e=>Dn(e),focus:e=>e instanceof FocusEvent,blur:e=>e instanceof FocusEvent,clear:()=>!0,select:e=>yr(e)},oF="ElAutocomplete",KY=qe({name:oF,inheritAttrs:!1}),ZY=qe({...KY,props:WY,emits:qY,setup(e,{expose:t,emit:i}){const a=e,d=wy(),p=Uu(),_=ks(),r=en("autocomplete"),S=Se(),C=Se(),M=Se(),k=Se();let z=!1,F=!1;const B=Se([]),N=Se(-1),j=Se(""),U=Se(!1),te=Se(!1),Y=Se(!1),q=vs(),J=ee(()=>p.style),ne=ee(()=>(B.value.length>0||Y.value)&&U.value),se=ee(()=>!a.hideLoading&&Y.value),fe=ee(()=>S.value?Array.from(S.value.$el.querySelectorAll("input")):[]),ce=()=>{ne.value&&(j.value=`${S.value.$el.offsetWidth}px`)},le=()=>{N.value=-1},ge=async vt=>{if(te.value)return;const Bt=Wt=>{Y.value=!1,!te.value&&(ln(Wt)?(B.value=Wt,N.value=a.highlightFirstItem?0:-1):ji(oF,"autocomplete suggestions must be an array"))};if(Y.value=!0,ln(a.fetchSuggestions))Bt(a.fetchSuggestions);else{const Wt=await a.fetchSuggestions(vt,Bt);ln(Wt)&&Bt(Wt)}},de=Ra(ge,a.debounce),ke=vt=>{const Bt=!!vt;if(i(Es,vt),i(mr,vt),te.value=!1,U.value||(U.value=Bt),!a.triggerOnFocus&&!vt){te.value=!0,B.value=[];return}de(vt)},We=vt=>{var Bt;_.value||(((Bt=vt.target)==null?void 0:Bt.tagName)!=="INPUT"||fe.value.includes(document.activeElement))&&(U.value=!0)},we=vt=>{i(Eo,vt)},be=vt=>{F?F=!1:(U.value=!0,i("focus",vt),a.triggerOnFocus&&!z&&de(String(a.modelValue)))},Me=vt=>{setTimeout(()=>{var Bt;if((Bt=M.value)!=null&&Bt.isFocusInsideContent()){F=!0;return}U.value&&Ve(),i("blur",vt)})},Ae=()=>{U.value=!1,i(mr,""),i("clear")},me=async()=>{ne.value&&N.value>=0&&N.value<B.value.length?wt(B.value[N.value]):a.selectWhenUnmatched&&(i("select",{value:a.modelValue}),B.value=[],N.value=-1)},Be=vt=>{ne.value&&(vt.preventDefault(),vt.stopPropagation(),Ve())},Ve=()=>{U.value=!1},bt=()=>{var vt;(vt=S.value)==null||vt.focus()},Pe=()=>{var vt;(vt=S.value)==null||vt.blur()},wt=async vt=>{i(Es,vt[a.valueKey]),i(mr,vt[a.valueKey]),i("select",vt),B.value=[],N.value=-1},Mt=vt=>{if(!ne.value||Y.value)return;if(vt<0){N.value=-1;return}vt>=B.value.length&&(vt=B.value.length-1);const Bt=C.value.querySelector(`.${r.be("suggestion","wrap")}`),Fe=Bt.querySelectorAll(`.${r.be("suggestion","list")} li`)[vt],cn=Bt.scrollTop,{offsetTop:Re,scrollHeight:nt}=Fe;Re+nt>cn+Bt.clientHeight&&(Bt.scrollTop+=nt),Re<cn&&(Bt.scrollTop-=nt),N.value=vt,S.value.ref.setAttribute("aria-activedescendant",`${q.value}-item-${N.value}`)},Nt=KC(k,()=>{var vt;(vt=M.value)!=null&&vt.isFocusInsideContent()||ne.value&&Ve()});return Oo(()=>{Nt==null||Nt()}),gr(()=>{S.value.ref.setAttribute("role","textbox"),S.value.ref.setAttribute("aria-autocomplete","list"),S.value.ref.setAttribute("aria-controls","id"),S.value.ref.setAttribute("aria-activedescendant",`${q.value}-item-${N.value}`),z=S.value.ref.hasAttribute("readonly")}),t({highlightedIndex:N,activated:U,loading:Y,inputRef:S,popperRef:M,suggestions:B,handleSelect:wt,handleKeyEnter:me,focus:bt,blur:Pe,close:Ve,highlight:Mt,getData:ge}),(vt,Bt)=>(ae(),kt(b(Is),{ref_key:"popperRef",ref:M,visible:b(ne),placement:vt.placement,"fallback-placements":["bottom-start","top-start"],"popper-class":[b(r).e("popper"),vt.popperClass],teleported:vt.teleported,"gpu-acceleration":!1,pure:"","manual-mode":"",effect:"light",trigger:"click",transition:`${b(r).namespace.value}-zoom-in-top`,persistent:"",role:"listbox",onBeforeShow:ce,onHide:le},{content:st(()=>[Ue("div",{ref_key:"regionRef",ref:C,class:pe([b(r).b("suggestion"),b(r).is("loading",b(se))]),style:$n({[vt.fitInputWidth?"width":"minWidth"]:j.value,outline:"none"}),role:"region"},[Ze(b(Yc),{id:b(q),tag:"ul","wrap-class":b(r).be("suggestion","wrap"),"view-class":b(r).be("suggestion","list"),role:"listbox"},{default:st(()=>[b(se)?(ae(),Oe("li",{key:0},[pt(vt.$slots,"loading",{},()=>[Ze(b(On),{class:pe(b(r).is("loading"))},{default:st(()=>[Ze(b(Hc))]),_:1},8,["class"])])])):(ae(!0),Oe(Bn,{key:1},Or(B.value,(Wt,Fe)=>(ae(),Oe("li",{id:`${b(q)}-item-${Fe}`,key:Fe,class:pe({highlighted:N.value===Fe}),role:"option","aria-selected":N.value===Fe,onClick:cn=>wt(Wt)},[pt(vt.$slots,"default",{item:Wt},()=>[Rr(pn(Wt[vt.valueKey]),1)])],10,["id","aria-selected","onClick"]))),128))]),_:3},8,["id","wrap-class","view-class"])],6)]),default:st(()=>[Ue("div",{ref_key:"listboxRef",ref:k,class:pe([b(r).b(),vt.$attrs.class]),style:$n(b(J)),role:"combobox","aria-haspopup":"listbox","aria-expanded":b(ne),"aria-owns":b(q)},[Ze(b(Us),Mr({ref_key:"inputRef",ref:S},b(d),{clearable:vt.clearable,disabled:b(_),name:vt.name,"model-value":vt.modelValue,"aria-label":vt.ariaLabel,onInput:ke,onChange:we,onFocus:be,onBlur:Me,onClear:Ae,onKeydown:[Po(Qn(Wt=>Mt(N.value-1),["prevent"]),["up"]),Po(Qn(Wt=>Mt(N.value+1),["prevent"]),["down"]),Po(me,["enter"]),Po(Ve,["tab"]),Po(Be,["esc"])],onMousedown:We}),Ya({_:2},[vt.$slots.prepend?{name:"prepend",fn:st(()=>[pt(vt.$slots,"prepend")])}:void 0,vt.$slots.append?{name:"append",fn:st(()=>[pt(vt.$slots,"append")])}:void 0,vt.$slots.prefix?{name:"prefix",fn:st(()=>[pt(vt.$slots,"prefix")])}:void 0,vt.$slots.suffix?{name:"suffix",fn:st(()=>[pt(vt.$slots,"suffix")])}:void 0]),1040,["clearable","disabled","name","model-value","aria-label","onKeydown"])],14,["aria-expanded","aria-owns"])]),_:3},8,["visible","placement","popper-class","teleported","transition"]))}});var YY=fn(ZY,[["__file","autocomplete.vue"]]);const XY=ur(YY),JY=un({size:{type:[Number,String],values:Zc,default:"",validator:e=>Gn(e)},shape:{type:String,values:["circle","square"],default:"circle"},icon:{type:Mo},src:{type:String,default:""},alt:String,srcSet:String,fit:{type:dt(String),default:"cover"}}),QY={error:e=>e instanceof Event},eX=qe({name:"ElAvatar"}),tX=qe({...eX,props:JY,emits:QY,setup(e,{emit:t}){const i=e,a=en("avatar"),d=Se(!1),p=ee(()=>{const{size:C,icon:M,shape:k}=i,z=[a.b()];return Dn(C)&&z.push(a.m(C)),M&&z.push(a.m("icon")),k&&z.push(a.m(k)),z}),_=ee(()=>{const{size:C}=i;return Gn(C)?a.cssVarBlock({size:ui(C)||""}):void 0}),r=ee(()=>({objectFit:i.fit}));qt(()=>i.src,()=>d.value=!1);function S(C){d.value=!0,t("error",C)}return(C,M)=>(ae(),Oe("span",{class:pe(b(p)),style:$n(b(_))},[(C.src||C.srcSet)&&!d.value?(ae(),Oe("img",{key:0,src:C.src,alt:C.alt,srcset:C.srcSet,style:$n(b(r)),onError:S},null,44,["src","alt","srcset"])):C.icon?(ae(),kt(b(On),{key:1},{default:st(()=>[(ae(),kt(Tr(C.icon)))]),_:1})):pt(C.$slots,"default",{key:2})],6))}});var nX=fn(tX,[["__file","avatar.vue"]]);const rX=ur(nX),oX={visibilityHeight:{type:Number,default:200},target:{type:String,default:""},right:{type:Number,default:40},bottom:{type:Number,default:40}},iX={click:e=>e instanceof MouseEvent},sX=(e,t,i)=>{const a=Uo(),d=Uo(),p=Se(!1),_=()=>{a.value&&(p.value=a.value.scrollTop>=e.visibilityHeight)},r=C=>{var M;(M=a.value)==null||M.scrollTo({top:0,behavior:"smooth"}),t("click",C)},S=uz(_,300,!0);return So(d,"scroll",S),gr(()=>{var C;d.value=document,a.value=document.documentElement,e.target&&(a.value=(C=document.querySelector(e.target))!=null?C:void 0,a.value||ji(i,`target does not exist: ${e.target}`),d.value=a.value),_()}),{visible:p,handleClick:r}},iF="ElBacktop",aX=qe({name:iF}),lX=qe({...aX,props:oX,emits:iX,setup(e,{emit:t}){const i=e,a=en("backtop"),{handleClick:d,visible:p}=sX(i,t,iF),_=ee(()=>({right:`${i.right}px`,bottom:`${i.bottom}px`}));return(r,S)=>(ae(),kt(ls,{name:`${b(a).namespace.value}-fade-in`},{default:st(()=>[b(p)?(ae(),Oe("div",{key:0,style:$n(b(_)),class:pe(b(a).b()),onClick:Qn(b(d),["stop"])},[pt(r.$slots,"default",{},()=>[Ze(b(On),{class:pe(b(a).e("icon"))},{default:st(()=>[Ze(b(J9))]),_:1},8,["class"])])],14,["onClick"])):yt("v-if",!0)]),_:3},8,["name"]))}});var cX=fn(lX,[["__file","backtop.vue"]]);const uX=ur(cX),dX=un({value:{type:[String,Number],default:""},max:{type:Number,default:99},isDot:Boolean,hidden:Boolean,type:{type:String,values:["primary","success","warning","info","danger"],default:"danger"},showZero:{type:Boolean,default:!0},color:String,badgeStyle:{type:dt([String,Object,Array])},offset:{type:dt(Array),default:[0,0]},badgeClass:{type:String}}),hX=qe({name:"ElBadge"}),fX=qe({...hX,props:dX,setup(e,{expose:t}){const i=e,a=en("badge"),d=ee(()=>i.isDot?"":Gn(i.value)&&Gn(i.max)?i.max<i.value?`${i.max}+`:`${i.value}`:`${i.value}`),p=ee(()=>{var _,r,S,C,M;return[{backgroundColor:i.color,marginRight:ui(-((r=(_=i.offset)==null?void 0:_[0])!=null?r:0)),marginTop:ui((C=(S=i.offset)==null?void 0:S[1])!=null?C:0)},(M=i.badgeStyle)!=null?M:{}]});return t({content:d}),(_,r)=>(ae(),Oe("div",{class:pe(b(a).b())},[pt(_.$slots,"default"),Ze(ls,{name:`${b(a).namespace.value}-zoom-in-center`,persisted:""},{default:st(()=>[hr(Ue("sup",{class:pe([b(a).e("content"),b(a).em("content",_.type),b(a).is("fixed",!!_.$slots.default),b(a).is("dot",_.isDot),b(a).is("hide-zero",!_.showZero&&i.value===0),_.badgeClass]),style:$n(b(p))},[pt(_.$slots,"content",{value:b(d)},()=>[Rr(pn(b(d)),1)])],6),[[no,!_.hidden&&(b(d)||_.isDot||_.$slots.content)]])]),_:3},8,["name"])],2))}});var pX=fn(fX,[["__file","badge.vue"]]);const sF=ur(pX),aF=Symbol("breadcrumbKey"),mX=un({separator:{type:String,default:"/"},separatorIcon:{type:Mo}}),gX=qe({name:"ElBreadcrumb"}),vX=qe({...gX,props:mX,setup(e){const t=e,{t:i}=Gr(),a=en("breadcrumb"),d=Se();return Dr(aF,t),gr(()=>{const p=d.value.querySelectorAll(`.${a.e("item")}`);p.length&&p[p.length-1].setAttribute("aria-current","page")}),(p,_)=>(ae(),Oe("div",{ref_key:"breadcrumb",ref:d,class:pe(b(a).b()),"aria-label":b(i)("el.breadcrumb.label"),role:"navigation"},[pt(p.$slots,"default")],10,["aria-label"]))}});var _X=fn(vX,[["__file","breadcrumb.vue"]]);const yX=un({to:{type:dt([String,Object]),default:""},replace:Boolean}),bX=qe({name:"ElBreadcrumbItem"}),xX=qe({...bX,props:yX,setup(e){const t=e,i=wr(),a=An(aF,void 0),d=en("breadcrumb"),p=i.appContext.config.globalProperties.$router,_=Se(),r=()=>{!t.to||!p||(t.replace?p.replace(t.to):p.push(t.to))};return(S,C)=>{var M,k;return ae(),Oe("span",{class:pe(b(d).e("item"))},[Ue("span",{ref_key:"link",ref:_,class:pe([b(d).e("inner"),b(d).is("link",!!S.to)]),role:"link",onClick:r},[pt(S.$slots,"default")],2),(M=b(a))!=null&&M.separatorIcon?(ae(),kt(b(On),{key:0,class:pe(b(d).e("separator"))},{default:st(()=>[(ae(),kt(Tr(b(a).separatorIcon)))]),_:1},8,["class"])):(ae(),Oe("span",{key:1,class:pe(b(d).e("separator")),role:"presentation"},pn((k=b(a))==null?void 0:k.separator),3))],2)}}});var lF=fn(xX,[["__file","breadcrumb-item.vue"]]);const wX=ur(_X,{BreadcrumbItem:lF}),SX=ri(lF),cF=Symbol("buttonGroupContextKey"),Ud=({from:e,replacement:t,scope:i,version:a,ref:d,type:p="API"},_)=>{qt(()=>b(_),r=>{},{immediate:!0})},TX=(e,t)=>{Ud({from:"type.text",replacement:"link",version:"3.0.0",scope:"props",ref:"https://element-plus.org/en-US/component/button.html#button-attributes"},ee(()=>e.type==="text"));const i=An(cF,void 0),a=hx("button"),{form:d}=As(),p=Li(ee(()=>i==null?void 0:i.size)),_=ks(),r=Se(),S=Hi(),C=ee(()=>e.type||(i==null?void 0:i.type)||""),M=ee(()=>{var B,N,j;return(j=(N=e.autoInsertSpace)!=null?N:(B=a.value)==null?void 0:B.autoInsertSpace)!=null?j:!1}),k=ee(()=>e.tag==="button"?{ariaDisabled:_.value||e.loading,disabled:_.value||e.loading,autofocus:e.autofocus,type:e.nativeType}:{}),z=ee(()=>{var B;const N=(B=S.default)==null?void 0:B.call(S);if(M.value&&(N==null?void 0:N.length)===1){const j=N[0];if((j==null?void 0:j.type)===qm){const U=j.children;return new RegExp("^\\p{Unified_Ideograph}{2}$","u").test(U.trim())}}return!1});return{_disabled:_,_size:p,_type:C,_ref:r,_props:k,shouldAddSpace:z,handleClick:B=>{if(_.value||e.loading){B.stopPropagation();return}e.nativeType==="reset"&&(d==null||d.resetFields()),t("click",B)}}},eT=["default","primary","success","warning","info","danger","text",""],CX=["button","submit","reset"],tT=un({size:zi,disabled:Boolean,type:{type:String,values:eT,default:""},icon:{type:Mo},nativeType:{type:String,values:CX,default:"button"},loading:Boolean,loadingIcon:{type:Mo,default:()=>Hc},plain:Boolean,text:Boolean,link:Boolean,bg:Boolean,autofocus:Boolean,round:Boolean,circle:Boolean,color:String,dark:Boolean,autoInsertSpace:{type:Boolean,default:void 0},tag:{type:dt([String,Object]),default:"button"}}),EX={click:e=>e instanceof MouseEvent};function Ms(e,t){MX(e)&&(e="100%");var i=IX(e);return e=t===360?e:Math.min(t,Math.max(0,parseFloat(e))),i&&(e=parseInt(String(e*t),10)/100),Math.abs(e-t)<1e-6?1:(t===360?e=(e<0?e%t+t:e%t)/parseFloat(String(t)):e=e%t/parseFloat(String(t)),e)}function Mb(e){return Math.min(1,Math.max(0,e))}function MX(e){return typeof e=="string"&&e.indexOf(".")!==-1&&parseFloat(e)===1}function IX(e){return typeof e=="string"&&e.indexOf("%")!==-1}function uF(e){return e=parseFloat(e),(isNaN(e)||e<0||e>1)&&(e=1),e}function Ib(e){return e<=1?"".concat(Number(e)*100,"%"):e}function _f(e){return e.length===1?"0"+e:String(e)}function AX(e,t,i){return{r:Ms(e,255)*255,g:Ms(t,255)*255,b:Ms(i,255)*255}}function oR(e,t,i){e=Ms(e,255),t=Ms(t,255),i=Ms(i,255);var a=Math.max(e,t,i),d=Math.min(e,t,i),p=0,_=0,r=(a+d)/2;if(a===d)_=0,p=0;else{var S=a-d;switch(_=r>.5?S/(2-a-d):S/(a+d),a){case e:p=(t-i)/S+(t<i?6:0);break;case t:p=(i-e)/S+2;break;case i:p=(e-t)/S+4;break}p/=6}return{h:p,s:_,l:r}}function rS(e,t,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?e+(t-e)*(6*i):i<1/2?t:i<2/3?e+(t-e)*(2/3-i)*6:e}function kX(e,t,i){var a,d,p;if(e=Ms(e,360),t=Ms(t,100),i=Ms(i,100),t===0)d=i,p=i,a=i;else{var _=i<.5?i*(1+t):i+t-i*t,r=2*i-_;a=rS(r,_,e+1/3),d=rS(r,_,e),p=rS(r,_,e-1/3)}return{r:a*255,g:d*255,b:p*255}}function iR(e,t,i){e=Ms(e,255),t=Ms(t,255),i=Ms(i,255);var a=Math.max(e,t,i),d=Math.min(e,t,i),p=0,_=a,r=a-d,S=a===0?0:r/a;if(a===d)p=0;else{switch(a){case e:p=(t-i)/r+(t<i?6:0);break;case t:p=(i-e)/r+2;break;case i:p=(e-t)/r+4;break}p/=6}return{h:p,s:S,v:_}}function PX(e,t,i){e=Ms(e,360)*6,t=Ms(t,100),i=Ms(i,100);var a=Math.floor(e),d=e-a,p=i*(1-t),_=i*(1-d*t),r=i*(1-(1-d)*t),S=a%6,C=[i,_,p,p,r,i][S],M=[r,i,i,_,p,p][S],k=[p,p,r,i,i,_][S];return{r:C*255,g:M*255,b:k*255}}function sR(e,t,i,a){var d=[_f(Math.round(e).toString(16)),_f(Math.round(t).toString(16)),_f(Math.round(i).toString(16))];return a&&d[0].startsWith(d[0].charAt(1))&&d[1].startsWith(d[1].charAt(1))&&d[2].startsWith(d[2].charAt(1))?d[0].charAt(0)+d[1].charAt(0)+d[2].charAt(0):d.join("")}function RX(e,t,i,a,d){var p=[_f(Math.round(e).toString(16)),_f(Math.round(t).toString(16)),_f(Math.round(i).toString(16)),_f(OX(a))];return d&&p[0].startsWith(p[0].charAt(1))&&p[1].startsWith(p[1].charAt(1))&&p[2].startsWith(p[2].charAt(1))&&p[3].startsWith(p[3].charAt(1))?p[0].charAt(0)+p[1].charAt(0)+p[2].charAt(0)+p[3].charAt(0):p.join("")}function OX(e){return Math.round(parseFloat(e)*255).toString(16)}function aR(e){return Ua(e)/255}function Ua(e){return parseInt(e,16)}function LX(e){return{r:e>>16,g:(e&65280)>>8,b:e&255}}var nT={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",goldenrod:"#daa520",gold:"#ffd700",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavenderblush:"#fff0f5",lavender:"#e6e6fa",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};function DX(e){var t={r:0,g:0,b:0},i=1,a=null,d=null,p=null,_=!1,r=!1;return typeof e=="string"&&(e=NX(e)),typeof e=="object"&&(Cu(e.r)&&Cu(e.g)&&Cu(e.b)?(t=AX(e.r,e.g,e.b),_=!0,r=String(e.r).substr(-1)==="%"?"prgb":"rgb"):Cu(e.h)&&Cu(e.s)&&Cu(e.v)?(a=Ib(e.s),d=Ib(e.v),t=PX(e.h,a,d),_=!0,r="hsv"):Cu(e.h)&&Cu(e.s)&&Cu(e.l)&&(a=Ib(e.s),p=Ib(e.l),t=kX(e.h,a,p),_=!0,r="hsl"),Object.prototype.hasOwnProperty.call(e,"a")&&(i=e.a)),i=uF(i),{ok:_,format:e.format||r,r:Math.min(255,Math.max(t.r,0)),g:Math.min(255,Math.max(t.g,0)),b:Math.min(255,Math.max(t.b,0)),a:i}}var zX="[-\\+]?\\d+%?",FX="[-\\+]?\\d*\\.\\d+%?",Nd="(?:".concat(FX,")|(?:").concat(zX,")"),oS="[\\s|\\(]+(".concat(Nd,")[,|\\s]+(").concat(Nd,")[,|\\s]+(").concat(Nd,")\\s*\\)?"),iS="[\\s|\\(]+(".concat(Nd,")[,|\\s]+(").concat(Nd,")[,|\\s]+(").concat(Nd,")[,|\\s]+(").concat(Nd,")\\s*\\)?"),Zl={CSS_UNIT:new RegExp(Nd),rgb:new RegExp("rgb"+oS),rgba:new RegExp("rgba"+iS),hsl:new RegExp("hsl"+oS),hsla:new RegExp("hsla"+iS),hsv:new RegExp("hsv"+oS),hsva:new RegExp("hsva"+iS),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/};function NX(e){if(e=e.trim().toLowerCase(),e.length===0)return!1;var t=!1;if(nT[e])e=nT[e],t=!0;else if(e==="transparent")return{r:0,g:0,b:0,a:0,format:"name"};var i=Zl.rgb.exec(e);return i?{r:i[1],g:i[2],b:i[3]}:(i=Zl.rgba.exec(e),i?{r:i[1],g:i[2],b:i[3],a:i[4]}:(i=Zl.hsl.exec(e),i?{h:i[1],s:i[2],l:i[3]}:(i=Zl.hsla.exec(e),i?{h:i[1],s:i[2],l:i[3],a:i[4]}:(i=Zl.hsv.exec(e),i?{h:i[1],s:i[2],v:i[3]}:(i=Zl.hsva.exec(e),i?{h:i[1],s:i[2],v:i[3],a:i[4]}:(i=Zl.hex8.exec(e),i?{r:Ua(i[1]),g:Ua(i[2]),b:Ua(i[3]),a:aR(i[4]),format:t?"name":"hex8"}:(i=Zl.hex6.exec(e),i?{r:Ua(i[1]),g:Ua(i[2]),b:Ua(i[3]),format:t?"name":"hex"}:(i=Zl.hex4.exec(e),i?{r:Ua(i[1]+i[1]),g:Ua(i[2]+i[2]),b:Ua(i[3]+i[3]),a:aR(i[4]+i[4]),format:t?"name":"hex8"}:(i=Zl.hex3.exec(e),i?{r:Ua(i[1]+i[1]),g:Ua(i[2]+i[2]),b:Ua(i[3]+i[3]),format:t?"name":"hex"}:!1)))))))))}function Cu(e){return!!Zl.CSS_UNIT.exec(String(e))}var dF=function(){function e(t,i){t===void 0&&(t=""),i===void 0&&(i={});var a;if(t instanceof e)return t;typeof t=="number"&&(t=LX(t)),this.originalInput=t;var d=DX(t);this.originalInput=t,this.r=d.r,this.g=d.g,this.b=d.b,this.a=d.a,this.roundA=Math.round(100*this.a)/100,this.format=(a=i.format)!==null&&a!==void 0?a:d.format,this.gradientType=i.gradientType,this.r<1&&(this.r=Math.round(this.r)),this.g<1&&(this.g=Math.round(this.g)),this.b<1&&(this.b=Math.round(this.b)),this.isValid=d.ok}return e.prototype.isDark=function(){return this.getBrightness()<128},e.prototype.isLight=function(){return!this.isDark()},e.prototype.getBrightness=function(){var t=this.toRgb();return(t.r*299+t.g*587+t.b*114)/1e3},e.prototype.getLuminance=function(){var t=this.toRgb(),i,a,d,p=t.r/255,_=t.g/255,r=t.b/255;return p<=.03928?i=p/12.92:i=Math.pow((p+.055)/1.055,2.4),_<=.03928?a=_/12.92:a=Math.pow((_+.055)/1.055,2.4),r<=.03928?d=r/12.92:d=Math.pow((r+.055)/1.055,2.4),.2126*i+.7152*a+.0722*d},e.prototype.getAlpha=function(){return this.a},e.prototype.setAlpha=function(t){return this.a=uF(t),this.roundA=Math.round(100*this.a)/100,this},e.prototype.isMonochrome=function(){var t=this.toHsl().s;return t===0},e.prototype.toHsv=function(){var t=iR(this.r,this.g,this.b);return{h:t.h*360,s:t.s,v:t.v,a:this.a}},e.prototype.toHsvString=function(){var t=iR(this.r,this.g,this.b),i=Math.round(t.h*360),a=Math.round(t.s*100),d=Math.round(t.v*100);return this.a===1?"hsv(".concat(i,", ").concat(a,"%, ").concat(d,"%)"):"hsva(".concat(i,", ").concat(a,"%, ").concat(d,"%, ").concat(this.roundA,")")},e.prototype.toHsl=function(){var t=oR(this.r,this.g,this.b);return{h:t.h*360,s:t.s,l:t.l,a:this.a}},e.prototype.toHslString=function(){var t=oR(this.r,this.g,this.b),i=Math.round(t.h*360),a=Math.round(t.s*100),d=Math.round(t.l*100);return this.a===1?"hsl(".concat(i,", ").concat(a,"%, ").concat(d,"%)"):"hsla(".concat(i,", ").concat(a,"%, ").concat(d,"%, ").concat(this.roundA,")")},e.prototype.toHex=function(t){return t===void 0&&(t=!1),sR(this.r,this.g,this.b,t)},e.prototype.toHexString=function(t){return t===void 0&&(t=!1),"#"+this.toHex(t)},e.prototype.toHex8=function(t){return t===void 0&&(t=!1),RX(this.r,this.g,this.b,this.a,t)},e.prototype.toHex8String=function(t){return t===void 0&&(t=!1),"#"+this.toHex8(t)},e.prototype.toHexShortString=function(t){return t===void 0&&(t=!1),this.a===1?this.toHexString(t):this.toHex8String(t)},e.prototype.toRgb=function(){return{r:Math.round(this.r),g:Math.round(this.g),b:Math.round(this.b),a:this.a}},e.prototype.toRgbString=function(){var t=Math.round(this.r),i=Math.round(this.g),a=Math.round(this.b);return this.a===1?"rgb(".concat(t,", ").concat(i,", ").concat(a,")"):"rgba(".concat(t,", ").concat(i,", ").concat(a,", ").concat(this.roundA,")")},e.prototype.toPercentageRgb=function(){var t=function(i){return"".concat(Math.round(Ms(i,255)*100),"%")};return{r:t(this.r),g:t(this.g),b:t(this.b),a:this.a}},e.prototype.toPercentageRgbString=function(){var t=function(i){return Math.round(Ms(i,255)*100)};return this.a===1?"rgb(".concat(t(this.r),"%, ").concat(t(this.g),"%, ").concat(t(this.b),"%)"):"rgba(".concat(t(this.r),"%, ").concat(t(this.g),"%, ").concat(t(this.b),"%, ").concat(this.roundA,")")},e.prototype.toName=function(){if(this.a===0)return"transparent";if(this.a<1)return!1;for(var t="#"+sR(this.r,this.g,this.b,!1),i=0,a=Object.entries(nT);i<a.length;i++){var d=a[i],p=d[0],_=d[1];if(t===_)return p}return!1},e.prototype.toString=function(t){var i=!!t;t=t??this.format;var a=!1,d=this.a<1&&this.a>=0,p=!i&&d&&(t.startsWith("hex")||t==="name");return p?t==="name"&&this.a===0?this.toName():this.toRgbString():(t==="rgb"&&(a=this.toRgbString()),t==="prgb"&&(a=this.toPercentageRgbString()),(t==="hex"||t==="hex6")&&(a=this.toHexString()),t==="hex3"&&(a=this.toHexString(!0)),t==="hex4"&&(a=this.toHex8String(!0)),t==="hex8"&&(a=this.toHex8String()),t==="name"&&(a=this.toName()),t==="hsl"&&(a=this.toHslString()),t==="hsv"&&(a=this.toHsvString()),a||this.toHexString())},e.prototype.toNumber=function(){return(Math.round(this.r)<<16)+(Math.round(this.g)<<8)+Math.round(this.b)},e.prototype.clone=function(){return new e(this.toString())},e.prototype.lighten=function(t){t===void 0&&(t=10);var i=this.toHsl();return i.l+=t/100,i.l=Mb(i.l),new e(i)},e.prototype.brighten=function(t){t===void 0&&(t=10);var i=this.toRgb();return i.r=Math.max(0,Math.min(255,i.r-Math.round(255*-(t/100)))),i.g=Math.max(0,Math.min(255,i.g-Math.round(255*-(t/100)))),i.b=Math.max(0,Math.min(255,i.b-Math.round(255*-(t/100)))),new e(i)},e.prototype.darken=function(t){t===void 0&&(t=10);var i=this.toHsl();return i.l-=t/100,i.l=Mb(i.l),new e(i)},e.prototype.tint=function(t){return t===void 0&&(t=10),this.mix("white",t)},e.prototype.shade=function(t){return t===void 0&&(t=10),this.mix("black",t)},e.prototype.desaturate=function(t){t===void 0&&(t=10);var i=this.toHsl();return i.s-=t/100,i.s=Mb(i.s),new e(i)},e.prototype.saturate=function(t){t===void 0&&(t=10);var i=this.toHsl();return i.s+=t/100,i.s=Mb(i.s),new e(i)},e.prototype.greyscale=function(){return this.desaturate(100)},e.prototype.spin=function(t){var i=this.toHsl(),a=(i.h+t)%360;return i.h=a<0?360+a:a,new e(i)},e.prototype.mix=function(t,i){i===void 0&&(i=50);var a=this.toRgb(),d=new e(t).toRgb(),p=i/100,_={r:(d.r-a.r)*p+a.r,g:(d.g-a.g)*p+a.g,b:(d.b-a.b)*p+a.b,a:(d.a-a.a)*p+a.a};return new e(_)},e.prototype.analogous=function(t,i){t===void 0&&(t=6),i===void 0&&(i=30);var a=this.toHsl(),d=360/i,p=[this];for(a.h=(a.h-(d*t>>1)+720)%360;--t;)a.h=(a.h+d)%360,p.push(new e(a));return p},e.prototype.complement=function(){var t=this.toHsl();return t.h=(t.h+180)%360,new e(t)},e.prototype.monochromatic=function(t){t===void 0&&(t=6);for(var i=this.toHsv(),a=i.h,d=i.s,p=i.v,_=[],r=1/t;t--;)_.push(new e({h:a,s:d,v:p})),p=(p+r)%1;return _},e.prototype.splitcomplement=function(){var t=this.toHsl(),i=t.h;return[this,new e({h:(i+72)%360,s:t.s,l:t.l}),new e({h:(i+216)%360,s:t.s,l:t.l})]},e.prototype.onBackground=function(t){var i=this.toRgb(),a=new e(t).toRgb(),d=i.a+a.a*(1-i.a);return new e({r:(i.r*i.a+a.r*a.a*(1-i.a))/d,g:(i.g*i.a+a.g*a.a*(1-i.a))/d,b:(i.b*i.a+a.b*a.a*(1-i.a))/d,a:d})},e.prototype.triad=function(){return this.polyad(3)},e.prototype.tetrad=function(){return this.polyad(4)},e.prototype.polyad=function(t){for(var i=this.toHsl(),a=i.h,d=[this],p=360/t,_=1;_<t;_++)d.push(new e({h:(a+_*p)%360,s:i.s,l:i.l}));return d},e.prototype.equals=function(t){return this.toRgbString()===new e(t).toRgbString()},e}();function Ad(e,t=20){return e.mix("#141414",t).toString()}function BX(e){const t=ks(),i=en("button");return ee(()=>{let a={},d=e.color;if(d){const p=d.match(/var\((.*?)\)/);p&&(d=window.getComputedStyle(window.document.documentElement).getPropertyValue(p[1]));const _=new dF(d),r=e.dark?_.tint(20).toString():Ad(_,20);if(e.plain)a=i.cssVarBlock({"bg-color":e.dark?Ad(_,90):_.tint(90).toString(),"text-color":d,"border-color":e.dark?Ad(_,50):_.tint(50).toString(),"hover-text-color":`var(${i.cssVarName("color-white")})`,"hover-bg-color":d,"hover-border-color":d,"active-bg-color":r,"active-text-color":`var(${i.cssVarName("color-white")})`,"active-border-color":r}),t.value&&(a[i.cssVarBlockName("disabled-bg-color")]=e.dark?Ad(_,90):_.tint(90).toString(),a[i.cssVarBlockName("disabled-text-color")]=e.dark?Ad(_,50):_.tint(50).toString(),a[i.cssVarBlockName("disabled-border-color")]=e.dark?Ad(_,80):_.tint(80).toString());else{const S=e.dark?Ad(_,30):_.tint(30).toString(),C=_.isDark()?`var(${i.cssVarName("color-white")})`:`var(${i.cssVarName("color-black")})`;if(a=i.cssVarBlock({"bg-color":d,"text-color":C,"border-color":d,"hover-bg-color":S,"hover-text-color":C,"hover-border-color":S,"active-bg-color":r,"active-border-color":r}),t.value){const M=e.dark?Ad(_,50):_.tint(50).toString();a[i.cssVarBlockName("disabled-bg-color")]=M,a[i.cssVarBlockName("disabled-text-color")]=e.dark?"rgba(255, 255, 255, 0.5)":`var(${i.cssVarName("color-white")})`,a[i.cssVarBlockName("disabled-border-color")]=M}}}return a})}const VX=qe({name:"ElButton"}),$X=qe({...VX,props:tT,emits:EX,setup(e,{expose:t,emit:i}){const a=e,d=BX(a),p=en("button"),{_ref:_,_size:r,_type:S,_disabled:C,_props:M,shouldAddSpace:k,handleClick:z}=TX(a,i),F=ee(()=>[p.b(),p.m(S.value),p.m(r.value),p.is("disabled",C.value),p.is("loading",a.loading),p.is("plain",a.plain),p.is("round",a.round),p.is("circle",a.circle),p.is("text",a.text),p.is("link",a.link),p.is("has-bg",a.bg)]);return t({ref:_,size:r,type:S,disabled:C,shouldAddSpace:k}),(B,N)=>(ae(),kt(Tr(B.tag),Mr({ref_key:"_ref",ref:_},b(M),{class:b(F),style:b(d),onClick:b(z)}),{default:st(()=>[B.loading?(ae(),Oe(Bn,{key:0},[B.$slots.loading?pt(B.$slots,"loading",{key:0}):(ae(),kt(b(On),{key:1,class:pe(b(p).is("loading"))},{default:st(()=>[(ae(),kt(Tr(B.loadingIcon)))]),_:1},8,["class"]))],64)):B.icon||B.$slots.icon?(ae(),kt(b(On),{key:1},{default:st(()=>[B.icon?(ae(),kt(Tr(B.icon),{key:0})):pt(B.$slots,"icon",{key:1})]),_:3})):yt("v-if",!0),B.$slots.default?(ae(),Oe("span",{key:2,class:pe({[b(p).em("text","expand")]:b(k)})},[pt(B.$slots,"default")],2)):yt("v-if",!0)]),_:3},16,["class","style","onClick"]))}});var UX=fn($X,[["__file","button.vue"]]);const jX={size:tT.size,type:tT.type},HX=qe({name:"ElButtonGroup"}),GX=qe({...HX,props:jX,setup(e){const t=e;Dr(cF,lo({size:po(t,"size"),type:po(t,"type")}));const i=en("button");return(a,d)=>(ae(),Oe("div",{class:pe(b(i).b("group"))},[pt(a.$slots,"default")],2))}});var hF=fn(GX,[["__file","button-group.vue"]]);const ss=ur(UX,{ButtonGroup:hF}),fF=ri(hF);var Xc=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Xa(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var pF={exports:{}};(function(e,t){(function(i,a){e.exports=a()})(Xc,function(){var i=1e3,a=6e4,d=36e5,p="millisecond",_="second",r="minute",S="hour",C="day",M="week",k="month",z="quarter",F="year",B="date",N="Invalid Date",j=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,U=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,te={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(We){var we=["th","st","nd","rd"],be=We%100;return"["+We+(we[(be-20)%10]||we[be]||we[0])+"]"}},Y=function(We,we,be){var Me=String(We);return!Me||Me.length>=we?We:""+Array(we+1-Me.length).join(be)+We},q={s:Y,z:function(We){var we=-We.utcOffset(),be=Math.abs(we),Me=Math.floor(be/60),Ae=be%60;return(we<=0?"+":"-")+Y(Me,2,"0")+":"+Y(Ae,2,"0")},m:function We(we,be){if(we.date()<be.date())return-We(be,we);var Me=12*(be.year()-we.year())+(be.month()-we.month()),Ae=we.clone().add(Me,k),me=be-Ae<0,Be=we.clone().add(Me+(me?-1:1),k);return+(-(Me+(be-Ae)/(me?Ae-Be:Be-Ae))||0)},a:function(We){return We<0?Math.ceil(We)||0:Math.floor(We)},p:function(We){return{M:k,y:F,w:M,d:C,D:B,h:S,m:r,s:_,ms:p,Q:z}[We]||String(We||"").toLowerCase().replace(/s$/,"")},u:function(We){return We===void 0}},J="en",ne={};ne[J]=te;var se="$isDayjsObject",fe=function(We){return We instanceof de||!(!We||!We[se])},ce=function We(we,be,Me){var Ae;if(!we)return J;if(typeof we=="string"){var me=we.toLowerCase();ne[me]&&(Ae=me),be&&(ne[me]=be,Ae=me);var Be=we.split("-");if(!Ae&&Be.length>1)return We(Be[0])}else{var Ve=we.name;ne[Ve]=we,Ae=Ve}return!Me&&Ae&&(J=Ae),Ae||!Me&&J},le=function(We,we){if(fe(We))return We.clone();var be=typeof we=="object"?we:{};return be.date=We,be.args=arguments,new de(be)},ge=q;ge.l=ce,ge.i=fe,ge.w=function(We,we){return le(We,{locale:we.$L,utc:we.$u,x:we.$x,$offset:we.$offset})};var de=function(){function We(be){this.$L=ce(be.locale,null,!0),this.parse(be),this.$x=this.$x||be.x||{},this[se]=!0}var we=We.prototype;return we.parse=function(be){this.$d=function(Me){var Ae=Me.date,me=Me.utc;if(Ae===null)return new Date(NaN);if(ge.u(Ae))return new Date;if(Ae instanceof Date)return new Date(Ae);if(typeof Ae=="string"&&!/Z$/i.test(Ae)){var Be=Ae.match(j);if(Be){var Ve=Be[2]-1||0,bt=(Be[7]||"0").substring(0,3);return me?new Date(Date.UTC(Be[1],Ve,Be[3]||1,Be[4]||0,Be[5]||0,Be[6]||0,bt)):new Date(Be[1],Ve,Be[3]||1,Be[4]||0,Be[5]||0,Be[6]||0,bt)}}return new Date(Ae)}(be),this.init()},we.init=function(){var be=this.$d;this.$y=be.getFullYear(),this.$M=be.getMonth(),this.$D=be.getDate(),this.$W=be.getDay(),this.$H=be.getHours(),this.$m=be.getMinutes(),this.$s=be.getSeconds(),this.$ms=be.getMilliseconds()},we.$utils=function(){return ge},we.isValid=function(){return this.$d.toString()!==N},we.isSame=function(be,Me){var Ae=le(be);return this.startOf(Me)<=Ae&&Ae<=this.endOf(Me)},we.isAfter=function(be,Me){return le(be)<this.startOf(Me)},we.isBefore=function(be,Me){return this.endOf(Me)<le(be)},we.$g=function(be,Me,Ae){return ge.u(be)?this[Me]:this.set(Ae,be)},we.unix=function(){return Math.floor(this.valueOf()/1e3)},we.valueOf=function(){return this.$d.getTime()},we.startOf=function(be,Me){var Ae=this,me=!!ge.u(Me)||Me,Be=ge.p(be),Ve=function(Wt,Fe){var cn=ge.w(Ae.$u?Date.UTC(Ae.$y,Fe,Wt):new Date(Ae.$y,Fe,Wt),Ae);return me?cn:cn.endOf(C)},bt=function(Wt,Fe){return ge.w(Ae.toDate()[Wt].apply(Ae.toDate("s"),(me?[0,0,0,0]:[23,59,59,999]).slice(Fe)),Ae)},Pe=this.$W,wt=this.$M,Mt=this.$D,Nt="set"+(this.$u?"UTC":"");switch(Be){case F:return me?Ve(1,0):Ve(31,11);case k:return me?Ve(1,wt):Ve(0,wt+1);case M:var vt=this.$locale().weekStart||0,Bt=(Pe<vt?Pe+7:Pe)-vt;return Ve(me?Mt-Bt:Mt+(6-Bt),wt);case C:case B:return bt(Nt+"Hours",0);case S:return bt(Nt+"Minutes",1);case r:return bt(Nt+"Seconds",2);case _:return bt(Nt+"Milliseconds",3);default:return this.clone()}},we.endOf=function(be){return this.startOf(be,!1)},we.$set=function(be,Me){var Ae,me=ge.p(be),Be="set"+(this.$u?"UTC":""),Ve=(Ae={},Ae[C]=Be+"Date",Ae[B]=Be+"Date",Ae[k]=Be+"Month",Ae[F]=Be+"FullYear",Ae[S]=Be+"Hours",Ae[r]=Be+"Minutes",Ae[_]=Be+"Seconds",Ae[p]=Be+"Milliseconds",Ae)[me],bt=me===C?this.$D+(Me-this.$W):Me;if(me===k||me===F){var Pe=this.clone().set(B,1);Pe.$d[Ve](bt),Pe.init(),this.$d=Pe.set(B,Math.min(this.$D,Pe.daysInMonth())).$d}else Ve&&this.$d[Ve](bt);return this.init(),this},we.set=function(be,Me){return this.clone().$set(be,Me)},we.get=function(be){return this[ge.p(be)]()},we.add=function(be,Me){var Ae,me=this;be=Number(be);var Be=ge.p(Me),Ve=function(wt){var Mt=le(me);return ge.w(Mt.date(Mt.date()+Math.round(wt*be)),me)};if(Be===k)return this.set(k,this.$M+be);if(Be===F)return this.set(F,this.$y+be);if(Be===C)return Ve(1);if(Be===M)return Ve(7);var bt=(Ae={},Ae[r]=a,Ae[S]=d,Ae[_]=i,Ae)[Be]||1,Pe=this.$d.getTime()+be*bt;return ge.w(Pe,this)},we.subtract=function(be,Me){return this.add(-1*be,Me)},we.format=function(be){var Me=this,Ae=this.$locale();if(!this.isValid())return Ae.invalidDate||N;var me=be||"YYYY-MM-DDTHH:mm:ssZ",Be=ge.z(this),Ve=this.$H,bt=this.$m,Pe=this.$M,wt=Ae.weekdays,Mt=Ae.months,Nt=Ae.meridiem,vt=function(Fe,cn,Re,nt){return Fe&&(Fe[cn]||Fe(Me,me))||Re[cn].slice(0,nt)},Bt=function(Fe){return ge.s(Ve%12||12,Fe,"0")},Wt=Nt||function(Fe,cn,Re){var nt=Fe<12?"AM":"PM";return Re?nt.toLowerCase():nt};return me.replace(U,function(Fe,cn){return cn||function(Re){switch(Re){case"YY":return String(Me.$y).slice(-2);case"YYYY":return ge.s(Me.$y,4,"0");case"M":return Pe+1;case"MM":return ge.s(Pe+1,2,"0");case"MMM":return vt(Ae.monthsShort,Pe,Mt,3);case"MMMM":return vt(Mt,Pe);case"D":return Me.$D;case"DD":return ge.s(Me.$D,2,"0");case"d":return String(Me.$W);case"dd":return vt(Ae.weekdaysMin,Me.$W,wt,2);case"ddd":return vt(Ae.weekdaysShort,Me.$W,wt,3);case"dddd":return wt[Me.$W];case"H":return String(Ve);case"HH":return ge.s(Ve,2,"0");case"h":return Bt(1);case"hh":return Bt(2);case"a":return Wt(Ve,bt,!0);case"A":return Wt(Ve,bt,!1);case"m":return String(bt);case"mm":return ge.s(bt,2,"0");case"s":return String(Me.$s);case"ss":return ge.s(Me.$s,2,"0");case"SSS":return ge.s(Me.$ms,3,"0");case"Z":return Be}return null}(Fe)||Be.replace(":","")})},we.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},we.diff=function(be,Me,Ae){var me,Be=this,Ve=ge.p(Me),bt=le(be),Pe=(bt.utcOffset()-this.utcOffset())*a,wt=this-bt,Mt=function(){return ge.m(Be,bt)};switch(Ve){case F:me=Mt()/12;break;case k:me=Mt();break;case z:me=Mt()/3;break;case M:me=(wt-Pe)/6048e5;break;case C:me=(wt-Pe)/864e5;break;case S:me=wt/d;break;case r:me=wt/a;break;case _:me=wt/i;break;default:me=wt}return Ae?me:ge.a(me)},we.daysInMonth=function(){return this.endOf(k).$D},we.$locale=function(){return ne[this.$L]},we.locale=function(be,Me){if(!be)return this.$L;var Ae=this.clone(),me=ce(be,Me,!0);return me&&(Ae.$L=me),Ae},we.clone=function(){return ge.w(this.$d,this)},we.toDate=function(){return new Date(this.valueOf())},we.toJSON=function(){return this.isValid()?this.toISOString():null},we.toISOString=function(){return this.$d.toISOString()},we.toString=function(){return this.$d.toUTCString()},We}(),ke=de.prototype;return le.prototype=ke,[["$ms",p],["$s",_],["$m",r],["$H",S],["$W",C],["$M",k],["$y",F],["$D",B]].forEach(function(We){ke[We[1]]=function(we){return this.$g(we,We[0],We[1])}}),le.extend=function(We,we){return We.$i||(We(we,de,le),We.$i=!0),le},le.locale=ce,le.isDayjs=fe,le.unix=function(We){return le(1e3*We)},le.en=ne[J],le.Ls=ne,le.p={},le})})(pF);var WX=pF.exports;const lr=Xa(WX),sS=(e,t)=>[e>0?e-1:void 0,e,e<t?e+1:void 0],jd=e=>Array.from(Array.from({length:e}).keys()),mF=e=>e.replace(/\W?m{1,2}|\W?ZZ/g,"").replace(/\W?h{1,2}|\W?s{1,3}|\W?a/gi,"").trim(),gF=e=>e.replace(/\W?D{1,2}|\W?Do|\W?d{1,4}|\W?M{1,4}|\W?Y{2,4}/g,"").trim(),lR=function(e,t){const i=Hd(e),a=Hd(t);return i&&a?e.getTime()===t.getTime():!i&&!a?e===t:!1},cR=function(e,t){const i=ln(e),a=ln(t);return i&&a?e.length!==t.length?!1:e.every((d,p)=>lR(d,t[p])):!i&&!a?lR(e,t):!1},uR=function(e,t,i){const a=ja(t)||t==="x"?lr(e).locale(i):lr(e,t).locale(i);return a.isValid()?a:void 0},dR=function(e,t,i){return ja(t)?e:t==="x"?+e:lr(e).locale(i).format(t)},aS=(e,t)=>{var i;const a=[],d=t==null?void 0:t();for(let p=0;p<e;p++)a.push((i=d==null?void 0:d.includes(p))!=null?i:!1);return a},Ab=e=>ln(e)?e.map(t=>t.toDate()):e.toDate(),qX=(e,t)=>{const i=e.subtract(1,"month").endOf("month").date();return jd(t).map((a,d)=>i-(t-d-1))},KX=e=>{const t=e.daysInMonth();return jd(t).map((i,a)=>a+1)},ZX=e=>jd(e.length/7).map(t=>{const i=t*7;return e.slice(i,i+7)}),YX=un({selectedDay:{type:dt(Object)},range:{type:dt(Array)},date:{type:dt(Object),required:!0},hideHeader:{type:Boolean}}),XX={pick:e=>yr(e)};var vF={exports:{}};(function(e,t){(function(i,a){e.exports=a()})(Xc,function(){return function(i,a,d){var p=a.prototype,_=function(k){return k&&(k.indexOf?k:k.s)},r=function(k,z,F,B,N){var j=k.name?k:k.$locale(),U=_(j[z]),te=_(j[F]),Y=U||te.map(function(J){return J.slice(0,B)});if(!N)return Y;var q=j.weekStart;return Y.map(function(J,ne){return Y[(ne+(q||0))%7]})},S=function(){return d.Ls[d.locale()]},C=function(k,z){return k.formats[z]||function(F){return F.replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,function(B,N,j){return N||j.slice(1)})}(k.formats[z.toUpperCase()])},M=function(){var k=this;return{months:function(z){return z?z.format("MMMM"):r(k,"months")},monthsShort:function(z){return z?z.format("MMM"):r(k,"monthsShort","months",3)},firstDayOfWeek:function(){return k.$locale().weekStart||0},weekdays:function(z){return z?z.format("dddd"):r(k,"weekdays")},weekdaysMin:function(z){return z?z.format("dd"):r(k,"weekdaysMin","weekdays",2)},weekdaysShort:function(z){return z?z.format("ddd"):r(k,"weekdaysShort","weekdays",3)},longDateFormat:function(z){return C(k.$locale(),z)},meridiem:this.$locale().meridiem,ordinal:this.$locale().ordinal}};p.localeData=function(){return M.bind(this)()},d.localeData=function(){var k=S();return{firstDayOfWeek:function(){return k.weekStart||0},weekdays:function(){return d.weekdays()},weekdaysShort:function(){return d.weekdaysShort()},weekdaysMin:function(){return d.weekdaysMin()},months:function(){return d.months()},monthsShort:function(){return d.monthsShort()},longDateFormat:function(z){return C(k,z)},meridiem:k.meridiem,ordinal:k.ordinal}},d.months=function(){return r(S(),"months")},d.monthsShort=function(){return r(S(),"monthsShort","months",3)},d.weekdays=function(k){return r(S(),"weekdays",null,null,k)},d.weekdaysShort=function(k){return r(S(),"weekdaysShort","weekdays",3,k)},d.weekdaysMin=function(k){return r(S(),"weekdaysMin","weekdays",2,k)}}})})(vF);var JX=vF.exports;const _F=Xa(JX),QX=["year","years","month","months","date","dates","week","datetime","datetimerange","daterange","monthrange","yearrange"],lS=["sun","mon","tue","wed","thu","fri","sat"],eJ=(e,t)=>{lr.extend(_F);const i=lr.localeData().firstDayOfWeek(),{t:a,lang:d}=Gr(),p=lr().locale(d.value),_=ee(()=>!!e.range&&!!e.range.length),r=ee(()=>{let z=[];if(_.value){const[F,B]=e.range,N=jd(B.date()-F.date()+1).map(te=>({text:F.date()+te,type:"current"}));let j=N.length%7;j=j===0?0:7-j;const U=jd(j).map((te,Y)=>({text:Y+1,type:"next"}));z=N.concat(U)}else{const F=e.date.startOf("month").day(),B=qX(e.date,(F-i+7)%7).map(te=>({text:te,type:"prev"})),N=KX(e.date).map(te=>({text:te,type:"current"}));z=[...B,...N];const j=7-(z.length%7||7),U=jd(j).map((te,Y)=>({text:Y+1,type:"next"}));z=z.concat(U)}return ZX(z)}),S=ee(()=>{const z=i;return z===0?lS.map(F=>a(`el.datepicker.weeks.${F}`)):lS.slice(z).concat(lS.slice(0,z)).map(F=>a(`el.datepicker.weeks.${F}`))}),C=(z,F)=>{switch(F){case"prev":return e.date.startOf("month").subtract(1,"month").date(z);case"next":return e.date.startOf("month").add(1,"month").date(z);case"current":return e.date.date(z)}};return{now:p,isInRange:_,rows:r,weekDays:S,getFormattedDate:C,handlePickDay:({text:z,type:F})=>{const B=C(z,F);t("pick",B)},getSlotData:({text:z,type:F})=>{const B=C(z,F);return{isSelected:B.isSame(e.selectedDay),type:`${F}-month`,day:B.format("YYYY-MM-DD"),date:B.toDate()}}}},tJ=qe({name:"DateTable"}),nJ=qe({...tJ,props:YX,emits:XX,setup(e,{expose:t,emit:i}){const a=e,{isInRange:d,now:p,rows:_,weekDays:r,getFormattedDate:S,handlePickDay:C,getSlotData:M}=eJ(a,i),k=en("calendar-table"),z=en("calendar-day"),F=({text:B,type:N})=>{const j=[N];if(N==="current"){const U=S(B,N);U.isSame(a.selectedDay,"day")&&j.push(z.is("selected")),U.isSame(p,"day")&&j.push(z.is("today"))}return j};return t({getFormattedDate:S}),(B,N)=>(ae(),Oe("table",{class:pe([b(k).b(),b(k).is("range",b(d))]),cellspacing:"0",cellpadding:"0"},[B.hideHeader?yt("v-if",!0):(ae(),Oe("thead",{key:0},[Ue("tr",null,[(ae(!0),Oe(Bn,null,Or(b(r),j=>(ae(),Oe("th",{key:j,scope:"col"},pn(j),1))),128))])])),Ue("tbody",null,[(ae(!0),Oe(Bn,null,Or(b(_),(j,U)=>(ae(),Oe("tr",{key:U,class:pe({[b(k).e("row")]:!0,[b(k).em("row","hide-border")]:U===0&&B.hideHeader})},[(ae(!0),Oe(Bn,null,Or(j,(te,Y)=>(ae(),Oe("td",{key:Y,class:pe(F(te)),onClick:q=>b(C)(te)},[Ue("div",{class:pe(b(z).b())},[pt(B.$slots,"date-cell",{data:b(M)(te)},()=>[Ue("span",null,pn(te.text),1)])],2)],10,["onClick"]))),128))],2))),128))])],2))}});var hR=fn(nJ,[["__file","date-table.vue"]]);const rJ=(e,t)=>{const i=e.endOf("month"),a=t.startOf("month"),p=i.isSame(a,"week")?a.add(1,"week"):a;return[[e,i],[p.startOf("week"),t]]},oJ=(e,t)=>{const i=e.endOf("month"),a=e.add(1,"month").startOf("month"),d=i.isSame(a,"week")?a.add(1,"week"):a,p=d.endOf("month"),_=t.startOf("month"),r=p.isSame(_,"week")?_.add(1,"week"):_;return[[e,i],[d.startOf("week"),p],[r.startOf("week"),t]]},iJ=(e,t,i)=>{const{lang:a}=Gr(),d=Se(),p=lr().locale(a.value),_=ee({get(){return e.modelValue?S.value:d.value},set(j){if(!j)return;d.value=j;const U=j.toDate();t(Es,U),t(mr,U)}}),r=ee(()=>{if(!e.range||!ln(e.range)||e.range.length!==2||e.range.some(Y=>!Hd(Y)))return[];const j=e.range.map(Y=>lr(Y).locale(a.value)),[U,te]=j;return U.isAfter(te)?[]:U.isSame(te,"month")?F(U,te):U.add(1,"month").month()!==te.month()?[]:F(U,te)}),S=ee(()=>e.modelValue?lr(e.modelValue).locale(a.value):_.value||(r.value.length?r.value[0][0]:p)),C=ee(()=>S.value.subtract(1,"month").date(1)),M=ee(()=>S.value.add(1,"month").date(1)),k=ee(()=>S.value.subtract(1,"year").date(1)),z=ee(()=>S.value.add(1,"year").date(1)),F=(j,U)=>{const te=j.startOf("week"),Y=U.endOf("week"),q=te.get("month"),J=Y.get("month");return q===J?[[te,Y]]:(q+1)%12===J?rJ(te,Y):q+2===J||(q+1)%11===J?oJ(te,Y):[]},B=j=>{_.value=j};return{calculateValidatedDateRange:F,date:S,realSelectedDay:_,pickDay:B,selectDate:j=>{const te={"prev-month":C.value,"next-month":M.value,"prev-year":k.value,"next-year":z.value,today:p}[j];te.isSame(S.value,"day")||B(te)},validatedRange:r}},sJ=e=>ln(e)&&e.length===2&&e.every(t=>Hd(t)),aJ=un({modelValue:{type:Date},range:{type:dt(Array),validator:sJ}}),lJ={[mr]:e=>Hd(e),[Es]:e=>Hd(e)},cJ="ElCalendar",uJ=qe({name:cJ}),dJ=qe({...uJ,props:aJ,emits:lJ,setup(e,{expose:t,emit:i}){const a=e,d=en("calendar"),{calculateValidatedDateRange:p,date:_,pickDay:r,realSelectedDay:S,selectDate:C,validatedRange:M}=iJ(a,i),{t:k}=Gr(),z=ee(()=>{const F=`el.datepicker.month${_.value.format("M")}`;return`${_.value.year()} ${k("el.datepicker.year")} ${k(F)}`});return t({selectedDay:S,pickDay:r,selectDate:C,calculateValidatedDateRange:p}),(F,B)=>(ae(),Oe("div",{class:pe(b(d).b())},[Ue("div",{class:pe(b(d).e("header"))},[pt(F.$slots,"header",{date:b(z)},()=>[Ue("div",{class:pe(b(d).e("title"))},pn(b(z)),3),b(M).length===0?(ae(),Oe("div",{key:0,class:pe(b(d).e("button-group"))},[Ze(b(fF),null,{default:st(()=>[Ze(b(ss),{size:"small",onClick:N=>b(C)("prev-month")},{default:st(()=>[Rr(pn(b(k)("el.datepicker.prevMonth")),1)]),_:1},8,["onClick"]),Ze(b(ss),{size:"small",onClick:N=>b(C)("today")},{default:st(()=>[Rr(pn(b(k)("el.datepicker.today")),1)]),_:1},8,["onClick"]),Ze(b(ss),{size:"small",onClick:N=>b(C)("next-month")},{default:st(()=>[Rr(pn(b(k)("el.datepicker.nextMonth")),1)]),_:1},8,["onClick"])]),_:1})],2)):yt("v-if",!0)])],2),b(M).length===0?(ae(),Oe("div",{key:0,class:pe(b(d).e("body"))},[Ze(hR,{date:b(_),"selected-day":b(S),onPick:b(r)},Ya({_:2},[F.$slots["date-cell"]?{name:"date-cell",fn:st(N=>[pt(F.$slots,"date-cell",Ha(Uc(N)))])}:void 0]),1032,["date","selected-day","onPick"])],2)):(ae(),Oe("div",{key:1,class:pe(b(d).e("body"))},[(ae(!0),Oe(Bn,null,Or(b(M),(N,j)=>(ae(),kt(hR,{key:j,date:N[0],"selected-day":b(S),range:N,"hide-header":j!==0,onPick:b(r)},Ya({_:2},[F.$slots["date-cell"]?{name:"date-cell",fn:st(U=>[pt(F.$slots,"date-cell",Ha(Uc(U)))])}:void 0]),1032,["date","selected-day","range","hide-header","onPick"]))),128))],2))],2))}});var hJ=fn(dJ,[["__file","calendar.vue"]]);const fJ=ur(hJ),pJ=un({header:{type:String,default:""},footer:{type:String,default:""},bodyStyle:{type:dt([String,Object,Array]),default:""},bodyClass:String,shadow:{type:String,values:["always","hover","never"],default:"always"}}),mJ=qe({name:"ElCard"}),gJ=qe({...mJ,props:pJ,setup(e){const t=en("card");return(i,a)=>(ae(),Oe("div",{class:pe([b(t).b(),b(t).is(`${i.shadow}-shadow`)])},[i.$slots.header||i.header?(ae(),Oe("div",{key:0,class:pe(b(t).e("header"))},[pt(i.$slots,"header",{},()=>[Rr(pn(i.header),1)])],2)):yt("v-if",!0),Ue("div",{class:pe([b(t).e("body"),i.bodyClass]),style:$n(i.bodyStyle)},[pt(i.$slots,"default")],6),i.$slots.footer||i.footer?(ae(),Oe("div",{key:1,class:pe(b(t).e("footer"))},[pt(i.$slots,"footer",{},()=>[Rr(pn(i.footer),1)])],2)):yt("v-if",!0)],2))}});var vJ=fn(gJ,[["__file","card.vue"]]);const _J=ur(vJ),yJ=un({initialIndex:{type:Number,default:0},height:{type:String,default:""},trigger:{type:String,values:["hover","click"],default:"hover"},autoplay:{type:Boolean,default:!0},interval:{type:Number,default:3e3},indicatorPosition:{type:String,values:["","none","outside"],default:""},arrow:{type:String,values:["always","hover","never"],default:"hover"},type:{type:String,values:["","card"],default:""},cardScale:{type:Number,default:.83},loop:{type:Boolean,default:!0},direction:{type:String,values:["horizontal","vertical"],default:"horizontal"},pauseOnHover:{type:Boolean,default:!0},motionBlur:Boolean}),bJ={change:(e,t)=>[e,t].every(Gn)},yF=Symbol("carouselContextKey"),rT="ElCarouselItem";var vl=(e=>(e[e.TEXT=1]="TEXT",e[e.CLASS=2]="CLASS",e[e.STYLE=4]="STYLE",e[e.PROPS=8]="PROPS",e[e.FULL_PROPS=16]="FULL_PROPS",e[e.HYDRATE_EVENTS=32]="HYDRATE_EVENTS",e[e.STABLE_FRAGMENT=64]="STABLE_FRAGMENT",e[e.KEYED_FRAGMENT=128]="KEYED_FRAGMENT",e[e.UNKEYED_FRAGMENT=256]="UNKEYED_FRAGMENT",e[e.NEED_PATCH=512]="NEED_PATCH",e[e.DYNAMIC_SLOTS=1024]="DYNAMIC_SLOTS",e[e.HOISTED=-1]="HOISTED",e[e.BAIL=-2]="BAIL",e))(vl||{});function oT(e){return Ho(e)&&e.type===Bn}function xJ(e){return Ho(e)&&e.type===os}function wJ(e){return Ho(e)&&!oT(e)&&!xJ(e)}const SJ=e=>{if(!Ho(e))return{};const t=e.props||{},i=(Ho(e.type)?e.type.props:void 0)||{},a={};return Object.keys(i).forEach(d=>{to(i[d],"default")&&(a[d]=i[d].default)}),Object.keys(t).forEach(d=>{a[da(d)]=t[d]}),a},TJ=e=>{if(!ln(e)||e.length>1)throw new Error("expect to receive a single Vue element child");return e[0]},Ou=e=>{const t=ln(e)?e:[e],i=[];return t.forEach(a=>{var d;ln(a)?i.push(...Ou(a)):Ho(a)&&((d=a.component)!=null&&d.subTree)?i.push(a,...Ou(a.component.subTree)):Ho(a)&&ln(a.children)?i.push(...Ou(a.children)):Ho(a)&&a.shapeFlag===2?i.push(...Ou(a.type())):i.push(a)}),i},CJ=(e,t,i)=>Ou(e.subTree).filter(p=>{var _;return Ho(p)&&((_=p.type)==null?void 0:_.name)===t&&!!p.component}).map(p=>p.component.uid).map(p=>i[p]).filter(p=>!!p),yE=(e,t)=>{const i={},a=Uo([]);return{children:a,addChild:_=>{i[_.uid]=_,a.value=CJ(e,t,i)},removeChild:_=>{delete i[_],a.value=a.value.filter(r=>r.uid!==_)}}},fR=300,EJ=(e,t,i)=>{const{children:a,addChild:d,removeChild:p}=yE(wr(),rT),_=Hi(),r=Se(-1),S=Se(null),C=Se(!1),M=Se(),k=Se(0),z=Se(!0),F=Se(!0),B=Se(!1),N=ee(()=>e.arrow!=="never"&&!b(te)),j=ee(()=>a.value.some(Nt=>Nt.props.label.toString().length>0)),U=ee(()=>e.type==="card"),te=ee(()=>e.direction==="vertical"),Y=ee(()=>e.height!=="auto"?{height:e.height}:{height:`${k.value}px`,overflow:"hidden"}),q=Ef(Nt=>{le(Nt)},fR,{trailing:!0}),J=Ef(Nt=>{me(Nt)},fR),ne=Nt=>z.value?r.value<=1?Nt<=1:Nt>1:!0;function se(){S.value&&(clearInterval(S.value),S.value=null)}function fe(){e.interval<=0||!e.autoplay||S.value||(S.value=setInterval(()=>ce(),e.interval))}const ce=()=>{F.value||(B.value=!0),F.value=!1,r.value<a.value.length-1?r.value=r.value+1:e.loop?r.value=0:B.value=!1};function le(Nt){if(F.value||(B.value=!0),F.value=!1,Dn(Nt)){const Wt=a.value.filter(Fe=>Fe.props.name===Nt);Wt.length>0&&(Nt=a.value.indexOf(Wt[0]))}if(Nt=Number(Nt),Number.isNaN(Nt)||Nt!==Math.floor(Nt))return;const vt=a.value.length,Bt=r.value;Nt<0?r.value=e.loop?vt-1:0:Nt>=vt?r.value=e.loop?0:vt-1:r.value=Nt,Bt===r.value&&ge(Bt),bt()}function ge(Nt){a.value.forEach((vt,Bt)=>{vt.translateItem(Bt,r.value,Nt)})}function de(Nt,vt){var Bt,Wt,Fe,cn;const Re=b(a),nt=Re.length;if(nt===0||!Nt.states.inStage)return!1;const Qe=vt+1,Yt=vt-1,Xt=nt-1,$t=Re[Xt].states.active,Ot=Re[0].states.active,Ft=(Wt=(Bt=Re[Qe])==null?void 0:Bt.states)==null?void 0:Wt.active,sn=(cn=(Fe=Re[Yt])==null?void 0:Fe.states)==null?void 0:cn.active;return vt===Xt&&Ot||Ft?"left":vt===0&&$t||sn?"right":!1}function ke(){C.value=!0,e.pauseOnHover&&se()}function We(){C.value=!1,fe()}function we(){B.value=!1}function be(Nt){b(te)||a.value.forEach((vt,Bt)=>{Nt===de(vt,Bt)&&(vt.states.hover=!0)})}function Me(){b(te)||a.value.forEach(Nt=>{Nt.states.hover=!1})}function Ae(Nt){Nt!==r.value&&(F.value||(B.value=!0)),r.value=Nt}function me(Nt){e.trigger==="hover"&&Nt!==r.value&&(r.value=Nt,F.value||(B.value=!0))}function Be(){le(r.value-1)}function Ve(){le(r.value+1)}function bt(){se(),e.pauseOnHover||fe()}function Pe(Nt){e.height==="auto"&&(k.value=Nt)}function wt(){var Nt;const vt=(Nt=_.default)==null?void 0:Nt.call(_);if(!vt)return null;const Wt=Ou(vt).filter(Fe=>Ho(Fe)&&Fe.type.name===rT);return(Wt==null?void 0:Wt.length)===2&&e.loop&&!U.value?(z.value=!0,Wt):(z.value=!1,null)}qt(()=>r.value,(Nt,vt)=>{ge(vt),z.value&&(Nt=Nt%2,vt=vt%2),vt>-1&&t("change",Nt,vt)}),qt(()=>e.autoplay,Nt=>{Nt?fe():se()}),qt(()=>e.loop,()=>{le(r.value)}),qt(()=>e.interval,()=>{bt()});const Mt=Uo();return gr(()=>{qt(()=>a.value,()=>{a.value.length>0&&le(e.initialIndex)},{immediate:!0}),Mt.value=ti(M.value,()=>{ge()}),fe()}),Oo(()=>{se(),M.value&&Mt.value&&Mt.value.stop()}),Dr(yF,{root:M,isCardType:U,isVertical:te,items:a,loop:e.loop,cardScale:e.cardScale,addItem:d,removeItem:p,setActiveItem:le,setContainerHeight:Pe}),{root:M,activeIndex:r,arrowDisplay:N,hasLabel:j,hover:C,isCardType:U,isTransitioning:B,items:a,isVertical:te,containerStyle:Y,isItemsTwoLength:z,handleButtonEnter:be,handleTransitionEnd:we,handleButtonLeave:Me,handleIndicatorClick:Ae,handleMouseEnter:ke,handleMouseLeave:We,setActiveItem:le,prev:Be,next:Ve,PlaceholderItem:wt,isTwoLengthShow:ne,throttledArrowClick:q,throttledIndicatorHover:J}},MJ="ElCarousel",IJ=qe({name:MJ}),AJ=qe({...IJ,props:yJ,emits:bJ,setup(e,{expose:t,emit:i}){const a=e,{root:d,activeIndex:p,arrowDisplay:_,hasLabel:r,hover:S,isCardType:C,items:M,isVertical:k,containerStyle:z,handleButtonEnter:F,handleButtonLeave:B,isTransitioning:N,handleIndicatorClick:j,handleMouseEnter:U,handleMouseLeave:te,handleTransitionEnd:Y,setActiveItem:q,prev:J,next:ne,PlaceholderItem:se,isTwoLengthShow:fe,throttledArrowClick:ce,throttledIndicatorHover:le}=EJ(a,i),ge=en("carousel"),{t:de}=Gr(),ke=ee(()=>{const be=[ge.b(),ge.m(a.direction)];return b(C)&&be.push(ge.m("card")),be}),We=ee(()=>{const be=[ge.e("container")];return a.motionBlur&&b(N)&&M.value.length>1&&be.push(b(k)?`${ge.namespace.value}-transitioning-vertical`:`${ge.namespace.value}-transitioning`),be}),we=ee(()=>{const be=[ge.e("indicators"),ge.em("indicators",a.direction)];return b(r)&&be.push(ge.em("indicators","labels")),a.indicatorPosition==="outside"&&be.push(ge.em("indicators","outside")),b(k)&&be.push(ge.em("indicators","right")),be});return t({activeIndex:p,setActiveItem:q,prev:J,next:ne}),(be,Me)=>(ae(),Oe("div",{ref_key:"root",ref:d,class:pe(b(ke)),onMouseenter:Qn(b(U),["stop"]),onMouseleave:Qn(b(te),["stop"])},[b(_)?(ae(),kt(ls,{key:0,name:"carousel-arrow-left",persisted:""},{default:st(()=>[hr(Ue("button",{type:"button",class:pe([b(ge).e("arrow"),b(ge).em("arrow","left")]),"aria-label":b(de)("el.carousel.leftArrow"),onMouseenter:Ae=>b(F)("left"),onMouseleave:b(B),onClick:Qn(Ae=>b(ce)(b(p)-1),["stop"])},[Ze(b(On),null,{default:st(()=>[Ze(b(Kd))]),_:1})],42,["aria-label","onMouseenter","onMouseleave","onClick"]),[[no,(be.arrow==="always"||b(S))&&(a.loop||b(p)>0)]])]),_:1})):yt("v-if",!0),b(_)?(ae(),kt(ls,{key:1,name:"carousel-arrow-right",persisted:""},{default:st(()=>[hr(Ue("button",{type:"button",class:pe([b(ge).e("arrow"),b(ge).em("arrow","right")]),"aria-label":b(de)("el.carousel.rightArrow"),onMouseenter:Ae=>b(F)("right"),onMouseleave:b(B),onClick:Qn(Ae=>b(ce)(b(p)+1),["stop"])},[Ze(b(On),null,{default:st(()=>[Ze(b(ca))]),_:1})],42,["aria-label","onMouseenter","onMouseleave","onClick"]),[[no,(be.arrow==="always"||b(S))&&(a.loop||b(p)<b(M).length-1)]])]),_:1})):yt("v-if",!0),Ue("div",{class:pe(b(We)),style:$n(b(z)),onTransitionend:b(Y)},[Ze(b(se)),pt(be.$slots,"default")],46,["onTransitionend"]),be.indicatorPosition!=="none"?(ae(),Oe("ul",{key:2,class:pe(b(we))},[(ae(!0),Oe(Bn,null,Or(b(M),(Ae,me)=>hr((ae(),Oe("li",{key:me,class:pe([b(ge).e("indicator"),b(ge).em("indicator",be.direction),b(ge).is("active",me===b(p))]),onMouseenter:Be=>b(le)(me),onClick:Qn(Be=>b(j)(me),["stop"])},[Ue("button",{class:pe(b(ge).e("button")),"aria-label":b(de)("el.carousel.indicator",{index:me+1})},[b(r)?(ae(),Oe("span",{key:0},pn(Ae.props.label),1)):yt("v-if",!0)],10,["aria-label"])],42,["onMouseenter","onClick"])),[[no,b(fe)(me)]])),128))],2)):yt("v-if",!0),a.motionBlur?(ae(),Oe("svg",{key:3,xmlns:"http://www.w3.org/2000/svg",version:"1.1",style:{display:"none"}},[Ue("defs",null,[Ue("filter",{id:"elCarouselHorizontal"},[Ue("feGaussianBlur",{in:"SourceGraphic",stdDeviation:"12,0"})]),Ue("filter",{id:"elCarouselVertical"},[Ue("feGaussianBlur",{in:"SourceGraphic",stdDeviation:"0,10"})])])])):yt("v-if",!0)],42,["onMouseenter","onMouseleave"]))}});var kJ=fn(AJ,[["__file","carousel.vue"]]);const PJ=un({name:{type:String,default:""},label:{type:[String,Number],default:""}}),RJ=e=>{const t=An(yF),i=wr(),a=Se(),d=Se(!1),p=Se(0),_=Se(1),r=Se(!1),S=Se(!1),C=Se(!1),M=Se(!1),{isCardType:k,isVertical:z,cardScale:F}=t;function B(Y,q,J){const ne=J-1,se=q-1,fe=q+1,ce=J/2;return q===0&&Y===ne?-1:q===ne&&Y===0?J:Y<se&&q-Y>=ce?J+1:Y>fe&&Y-q>=ce?-2:Y}function N(Y,q){var J,ne;const se=b(z)?((J=t.root.value)==null?void 0:J.offsetHeight)||0:((ne=t.root.value)==null?void 0:ne.offsetWidth)||0;return C.value?se*((2-F)*(Y-q)+1)/4:Y<q?-(1+F)*se/4:(3+F)*se/4}function j(Y,q,J){const ne=t.root.value;return ne?((J?ne.offsetHeight:ne.offsetWidth)||0)*(Y-q):0}const U=(Y,q,J)=>{var ne;const se=b(k),fe=(ne=t.items.value.length)!=null?ne:Number.NaN,ce=Y===q;!se&&!oo(J)&&(M.value=ce||Y===J),!ce&&fe>2&&t.loop&&(Y=B(Y,q,fe));const le=b(z);r.value=ce,se?(C.value=Math.round(Math.abs(Y-q))<=1,p.value=N(Y,q),_.value=b(r)?1:F):p.value=j(Y,q,le),S.value=!0,ce&&a.value&&t.setContainerHeight(a.value.offsetHeight)};function te(){if(t&&b(k)){const Y=t.items.value.findIndex(({uid:q})=>q===i.uid);t.setActiveItem(Y)}}return gr(()=>{t.addItem({props:e,states:lo({hover:d,translate:p,scale:_,active:r,ready:S,inStage:C,animating:M}),uid:i.uid,translateItem:U})}),th(()=>{t.removeItem(i.uid)}),{carouselItemRef:a,active:r,animating:M,hover:d,inStage:C,isVertical:z,translate:p,isCardType:k,scale:_,ready:S,handleItemClick:te}},OJ=qe({name:rT}),LJ=qe({...OJ,props:PJ,setup(e){const t=e,i=en("carousel"),{carouselItemRef:a,active:d,animating:p,hover:_,inStage:r,isVertical:S,translate:C,isCardType:M,scale:k,ready:z,handleItemClick:F}=RJ(t),B=ee(()=>[i.e("item"),i.is("active",d.value),i.is("in-stage",r.value),i.is("hover",_.value),i.is("animating",p.value),{[i.em("item","card")]:M.value,[i.em("item","card-vertical")]:M.value&&S.value}]),N=ee(()=>{const U=`${`translate${b(S)?"Y":"X"}`}(${b(C)}px)`,te=`scale(${b(k)})`;return{transform:[U,te].join(" ")}});return(j,U)=>hr((ae(),Oe("div",{ref_key:"carouselItemRef",ref:a,class:pe(b(B)),style:$n(b(N)),onClick:b(F)},[b(M)?hr((ae(),Oe("div",{key:0,class:pe(b(i).e("mask"))},null,2)),[[no,!b(d)]]):yt("v-if",!0),pt(j.$slots,"default")],14,["onClick"])),[[no,b(z)]])}});var bF=fn(LJ,[["__file","carousel-item.vue"]]);const DJ=ur(kJ,{CarouselItem:bF}),zJ=ri(bF),xF={modelValue:{type:[Number,String,Boolean],default:void 0},label:{type:[String,Boolean,Number,Object],default:void 0},value:{type:[String,Boolean,Number,Object],default:void 0},indeterminate:Boolean,disabled:Boolean,checked:Boolean,name:{type:String,default:void 0},trueValue:{type:[String,Number],default:void 0},falseValue:{type:[String,Number],default:void 0},trueLabel:{type:[String,Number],default:void 0},falseLabel:{type:[String,Number],default:void 0},id:{type:String,default:void 0},border:Boolean,size:zi,tabindex:[String,Number],validateEvent:{type:Boolean,default:!0},..._s(["ariaControls"])},wF={[mr]:e=>Dn(e)||Gn(e)||Ro(e),change:e=>Dn(e)||Gn(e)||Ro(e)},ng=Symbol("checkboxGroupContextKey"),FJ=({model:e,isChecked:t})=>{const i=An(ng,void 0),a=ee(()=>{var p,_;const r=(p=i==null?void 0:i.max)==null?void 0:p.value,S=(_=i==null?void 0:i.min)==null?void 0:_.value;return!oo(r)&&e.value.length>=r&&!t.value||!oo(S)&&e.value.length<=S&&t.value});return{isDisabled:ks(ee(()=>(i==null?void 0:i.disabled.value)||a.value)),isLimitDisabled:a}},NJ=(e,{model:t,isLimitExceeded:i,hasOwnLabel:a,isDisabled:d,isLabeledByFormItem:p})=>{const _=An(ng,void 0),{formItem:r}=As(),{emit:S}=wr();function C(B){var N,j,U,te;return[!0,e.trueValue,e.trueLabel].includes(B)?(j=(N=e.trueValue)!=null?N:e.trueLabel)!=null?j:!0:(te=(U=e.falseValue)!=null?U:e.falseLabel)!=null?te:!1}function M(B,N){S("change",C(B),N)}function k(B){if(i.value)return;const N=B.target;S("change",C(N.checked),B)}async function z(B){i.value||!a.value&&!d.value&&p.value&&(B.composedPath().some(U=>U.tagName==="LABEL")||(t.value=C([!1,e.falseValue,e.falseLabel].includes(t.value)),await Vn(),M(t.value,B)))}const F=ee(()=>(_==null?void 0:_.validateEvent)||e.validateEvent);return qt(()=>e.modelValue,()=>{F.value&&(r==null||r.validate("change").catch(B=>void 0))}),{handleChange:k,onClickRoot:z}},BJ=e=>{const t=Se(!1),{emit:i}=wr(),a=An(ng,void 0),d=ee(()=>oo(a)===!1),p=Se(!1),_=ee({get(){var r,S;return d.value?(r=a==null?void 0:a.modelValue)==null?void 0:r.value:(S=e.modelValue)!=null?S:t.value},set(r){var S,C;d.value&&ln(r)?(p.value=((S=a==null?void 0:a.max)==null?void 0:S.value)!==void 0&&r.length>(a==null?void 0:a.max.value)&&r.length>_.value.length,p.value===!1&&((C=a==null?void 0:a.changeEvent)==null||C.call(a,r))):(i(mr,r),t.value=r)}});return{model:_,isGroup:d,isLimitExceeded:p}},VJ=(e,t,{model:i})=>{const a=An(ng,void 0),d=Se(!1),p=ee(()=>rc(e.value)?e.label:e.value),_=ee(()=>{const M=i.value;return Ro(M)?M:ln(M)?yr(p.value)?M.map(wo).some(k=>ms(k,p.value)):M.map(wo).includes(p.value):M!=null?M===e.trueValue||M===e.trueLabel:!!M}),r=Li(ee(()=>{var M;return(M=a==null?void 0:a.size)==null?void 0:M.value}),{prop:!0}),S=Li(ee(()=>{var M;return(M=a==null?void 0:a.size)==null?void 0:M.value})),C=ee(()=>!!t.default||!rc(p.value));return{checkboxButtonSize:r,isChecked:_,isFocused:d,checkboxSize:S,hasOwnLabel:C,actualValue:p}},SF=(e,t)=>{const{formItem:i}=As(),{model:a,isGroup:d,isLimitExceeded:p}=BJ(e),{isFocused:_,isChecked:r,checkboxButtonSize:S,checkboxSize:C,hasOwnLabel:M,actualValue:k}=VJ(e,t,{model:a}),{isDisabled:z}=FJ({model:a,isChecked:r}),{inputId:F,isLabeledByFormItem:B}=Al(e,{formItemContext:i,disableIdGeneration:M,disableIdManagement:d}),{handleChange:N,onClickRoot:j}=NJ(e,{model:a,isLimitExceeded:p,hasOwnLabel:M,isDisabled:z,isLabeledByFormItem:B});return(()=>{function te(){var Y,q;ln(a.value)&&!a.value.includes(k.value)?a.value.push(k.value):a.value=(q=(Y=e.trueValue)!=null?Y:e.trueLabel)!=null?q:!0}e.checked&&te()})(),Ud({from:"label act as value",replacement:"value",version:"3.0.0",scope:"el-checkbox",ref:"https://element-plus.org/en-US/component/checkbox.html"},ee(()=>d.value&&rc(e.value))),Ud({from:"true-label",replacement:"true-value",version:"3.0.0",scope:"el-checkbox",ref:"https://element-plus.org/en-US/component/checkbox.html"},ee(()=>!!e.trueLabel)),Ud({from:"false-label",replacement:"false-value",version:"3.0.0",scope:"el-checkbox",ref:"https://element-plus.org/en-US/component/checkbox.html"},ee(()=>!!e.falseLabel)),{inputId:F,isLabeledByFormItem:B,isChecked:r,isDisabled:z,isFocused:_,checkboxButtonSize:S,checkboxSize:C,hasOwnLabel:M,model:a,actualValue:k,handleChange:N,onClickRoot:j}},$J=qe({name:"ElCheckbox"}),UJ=qe({...$J,props:xF,emits:wF,setup(e){const t=e,i=Hi(),{inputId:a,isLabeledByFormItem:d,isChecked:p,isDisabled:_,isFocused:r,checkboxSize:S,hasOwnLabel:C,model:M,actualValue:k,handleChange:z,onClickRoot:F}=SF(t,i),B=en("checkbox"),N=ee(()=>[B.b(),B.m(S.value),B.is("disabled",_.value),B.is("bordered",t.border),B.is("checked",p.value)]),j=ee(()=>[B.e("input"),B.is("disabled",_.value),B.is("checked",p.value),B.is("indeterminate",t.indeterminate),B.is("focus",r.value)]);return(U,te)=>(ae(),kt(Tr(!b(C)&&b(d)?"span":"label"),{class:pe(b(N)),"aria-controls":U.indeterminate?U.ariaControls:null,onClick:b(F)},{default:st(()=>{var Y,q,J,ne;return[Ue("span",{class:pe(b(j))},[U.trueValue||U.falseValue||U.trueLabel||U.falseLabel?hr((ae(),Oe("input",{key:0,id:b(a),"onUpdate:modelValue":se=>To(M)?M.value=se:null,class:pe(b(B).e("original")),type:"checkbox",indeterminate:U.indeterminate,name:U.name,tabindex:U.tabindex,disabled:b(_),"true-value":(q=(Y=U.trueValue)!=null?Y:U.trueLabel)!=null?q:!0,"false-value":(ne=(J=U.falseValue)!=null?J:U.falseLabel)!=null?ne:!1,onChange:b(z),onFocus:se=>r.value=!0,onBlur:se=>r.value=!1,onClick:Qn(()=>{},["stop"])},null,42,["id","onUpdate:modelValue","indeterminate","name","tabindex","disabled","true-value","false-value","onChange","onFocus","onBlur","onClick"])),[[v1,b(M)]]):hr((ae(),Oe("input",{key:1,id:b(a),"onUpdate:modelValue":se=>To(M)?M.value=se:null,class:pe(b(B).e("original")),type:"checkbox",indeterminate:U.indeterminate,disabled:b(_),value:b(k),name:U.name,tabindex:U.tabindex,onChange:b(z),onFocus:se=>r.value=!0,onBlur:se=>r.value=!1,onClick:Qn(()=>{},["stop"])},null,42,["id","onUpdate:modelValue","indeterminate","disabled","value","name","tabindex","onChange","onFocus","onBlur","onClick"])),[[v1,b(M)]]),Ue("span",{class:pe(b(B).e("inner"))},null,2)],2),b(C)?(ae(),Oe("span",{key:0,class:pe(b(B).e("label"))},[pt(U.$slots,"default"),U.$slots.default?yt("v-if",!0):(ae(),Oe(Bn,{key:0},[Rr(pn(U.label),1)],64))],2)):yt("v-if",!0)]}),_:3},8,["class","aria-controls","onClick"]))}});var jJ=fn(UJ,[["__file","checkbox.vue"]]);const HJ=qe({name:"ElCheckboxButton"}),GJ=qe({...HJ,props:xF,emits:wF,setup(e){const t=e,i=Hi(),{isFocused:a,isChecked:d,isDisabled:p,checkboxButtonSize:_,model:r,actualValue:S,handleChange:C}=SF(t,i),M=An(ng,void 0),k=en("checkbox"),z=ee(()=>{var B,N,j,U;const te=(N=(B=M==null?void 0:M.fill)==null?void 0:B.value)!=null?N:"";return{backgroundColor:te,borderColor:te,color:(U=(j=M==null?void 0:M.textColor)==null?void 0:j.value)!=null?U:"",boxShadow:te?`-1px 0 0 0 ${te}`:void 0}}),F=ee(()=>[k.b("button"),k.bm("button",_.value),k.is("disabled",p.value),k.is("checked",d.value),k.is("focus",a.value)]);return(B,N)=>{var j,U,te,Y;return ae(),Oe("label",{class:pe(b(F))},[B.trueValue||B.falseValue||B.trueLabel||B.falseLabel?hr((ae(),Oe("input",{key:0,"onUpdate:modelValue":q=>To(r)?r.value=q:null,class:pe(b(k).be("button","original")),type:"checkbox",name:B.name,tabindex:B.tabindex,disabled:b(p),"true-value":(U=(j=B.trueValue)!=null?j:B.trueLabel)!=null?U:!0,"false-value":(Y=(te=B.falseValue)!=null?te:B.falseLabel)!=null?Y:!1,onChange:b(C),onFocus:q=>a.value=!0,onBlur:q=>a.value=!1,onClick:Qn(()=>{},["stop"])},null,42,["onUpdate:modelValue","name","tabindex","disabled","true-value","false-value","onChange","onFocus","onBlur","onClick"])),[[v1,b(r)]]):hr((ae(),Oe("input",{key:1,"onUpdate:modelValue":q=>To(r)?r.value=q:null,class:pe(b(k).be("button","original")),type:"checkbox",name:B.name,tabindex:B.tabindex,disabled:b(p),value:b(S),onChange:b(C),onFocus:q=>a.value=!0,onBlur:q=>a.value=!1,onClick:Qn(()=>{},["stop"])},null,42,["onUpdate:modelValue","name","tabindex","disabled","value","onChange","onFocus","onBlur","onClick"])),[[v1,b(r)]]),B.$slots.default||B.label?(ae(),Oe("span",{key:2,class:pe(b(k).be("button","inner")),style:$n(b(d)?b(z):void 0)},[pt(B.$slots,"default",{},()=>[Rr(pn(B.label),1)])],6)):yt("v-if",!0)],2)}}});var TF=fn(GJ,[["__file","checkbox-button.vue"]]);const WJ=un({modelValue:{type:dt(Array),default:()=>[]},disabled:Boolean,min:Number,max:Number,size:zi,fill:String,textColor:String,tag:{type:String,default:"div"},validateEvent:{type:Boolean,default:!0},..._s(["ariaLabel"])}),qJ={[mr]:e=>ln(e),change:e=>ln(e)},KJ=qe({name:"ElCheckboxGroup"}),ZJ=qe({...KJ,props:WJ,emits:qJ,setup(e,{emit:t}){const i=e,a=en("checkbox"),{formItem:d}=As(),{inputId:p,isLabeledByFormItem:_}=Al(i,{formItemContext:d}),r=async C=>{t(mr,C),await Vn(),t("change",C)},S=ee({get(){return i.modelValue},set(C){r(C)}});return Dr(ng,{...Jl(Zi(i),["size","min","max","disabled","validateEvent","fill","textColor"]),modelValue:S,changeEvent:r}),qt(()=>i.modelValue,()=>{i.validateEvent&&(d==null||d.validate("change").catch(C=>void 0))}),(C,M)=>{var k;return ae(),kt(Tr(C.tag),{id:b(p),class:pe(b(a).b("group")),role:"group","aria-label":b(_)?void 0:C.ariaLabel||"checkbox-group","aria-labelledby":b(_)?(k=b(d))==null?void 0:k.labelId:void 0},{default:st(()=>[pt(C.$slots,"default")]),_:3},8,["id","class","aria-label","aria-labelledby"])}}});var CF=fn(ZJ,[["__file","checkbox-group.vue"]]);const Il=ur(jJ,{CheckboxButton:TF,CheckboxGroup:CF}),YJ=ri(TF),EF=ri(CF),MF=un({modelValue:{type:[String,Number,Boolean],default:void 0},size:zi,disabled:Boolean,label:{type:[String,Number,Boolean],default:void 0},value:{type:[String,Number,Boolean],default:void 0},name:{type:String,default:void 0}}),XJ=un({...MF,border:Boolean}),IF={[mr]:e=>Dn(e)||Gn(e)||Ro(e),[Eo]:e=>Dn(e)||Gn(e)||Ro(e)},AF=Symbol("radioGroupKey"),kF=(e,t)=>{const i=Se(),a=An(AF,void 0),d=ee(()=>!!a),p=ee(()=>rc(e.value)?e.label:e.value),_=ee({get(){return d.value?a.modelValue:e.modelValue},set(k){d.value?a.changeEvent(k):t&&t(mr,k),i.value.checked=e.modelValue===p.value}}),r=Li(ee(()=>a==null?void 0:a.size)),S=ks(ee(()=>a==null?void 0:a.disabled)),C=Se(!1),M=ee(()=>S.value||d.value&&_.value!==p.value?-1:0);return Ud({from:"label act as value",replacement:"value",version:"3.0.0",scope:"el-radio",ref:"https://element-plus.org/en-US/component/radio.html"},ee(()=>d.value&&rc(e.value))),{radioRef:i,isGroup:d,radioGroup:a,focus:C,size:r,disabled:S,tabIndex:M,modelValue:_,actualValue:p}},JJ=qe({name:"ElRadio"}),QJ=qe({...JJ,props:XJ,emits:IF,setup(e,{emit:t}){const i=e,a=en("radio"),{radioRef:d,radioGroup:p,focus:_,size:r,disabled:S,modelValue:C,actualValue:M}=kF(i,t);function k(){Vn(()=>t("change",C.value))}return(z,F)=>{var B;return ae(),Oe("label",{class:pe([b(a).b(),b(a).is("disabled",b(S)),b(a).is("focus",b(_)),b(a).is("bordered",z.border),b(a).is("checked",b(C)===b(M)),b(a).m(b(r))])},[Ue("span",{class:pe([b(a).e("input"),b(a).is("disabled",b(S)),b(a).is("checked",b(C)===b(M))])},[hr(Ue("input",{ref_key:"radioRef",ref:d,"onUpdate:modelValue":N=>To(C)?C.value=N:null,class:pe(b(a).e("original")),value:b(M),name:z.name||((B=b(p))==null?void 0:B.name),disabled:b(S),checked:b(C)===b(M),type:"radio",onFocus:N=>_.value=!0,onBlur:N=>_.value=!1,onChange:k,onClick:Qn(()=>{},["stop"])},null,42,["onUpdate:modelValue","value","name","disabled","checked","onFocus","onBlur","onClick"]),[[uD,b(C)]]),Ue("span",{class:pe(b(a).e("inner"))},null,2)],2),Ue("span",{class:pe(b(a).e("label")),onKeydown:Qn(()=>{},["stop"])},[pt(z.$slots,"default",{},()=>[Rr(pn(z.label),1)])],42,["onKeydown"])],2)}}});var eQ=fn(QJ,[["__file","radio.vue"]]);const tQ=un({...MF}),nQ=qe({name:"ElRadioButton"}),rQ=qe({...nQ,props:tQ,setup(e){const t=e,i=en("radio"),{radioRef:a,focus:d,size:p,disabled:_,modelValue:r,radioGroup:S,actualValue:C}=kF(t),M=ee(()=>({backgroundColor:(S==null?void 0:S.fill)||"",borderColor:(S==null?void 0:S.fill)||"",boxShadow:S!=null&&S.fill?`-1px 0 0 0 ${S.fill}`:"",color:(S==null?void 0:S.textColor)||""}));return(k,z)=>{var F;return ae(),Oe("label",{class:pe([b(i).b("button"),b(i).is("active",b(r)===b(C)),b(i).is("disabled",b(_)),b(i).is("focus",b(d)),b(i).bm("button",b(p))])},[hr(Ue("input",{ref_key:"radioRef",ref:a,"onUpdate:modelValue":B=>To(r)?r.value=B:null,class:pe(b(i).be("button","original-radio")),value:b(C),type:"radio",name:k.name||((F=b(S))==null?void 0:F.name),disabled:b(_),onFocus:B=>d.value=!0,onBlur:B=>d.value=!1,onClick:Qn(()=>{},["stop"])},null,42,["onUpdate:modelValue","value","name","disabled","onFocus","onBlur","onClick"]),[[uD,b(r)]]),Ue("span",{class:pe(b(i).be("button","inner")),style:$n(b(r)===b(C)?b(M):{}),onKeydown:Qn(()=>{},["stop"])},[pt(k.$slots,"default",{},()=>[Rr(pn(k.label),1)])],46,["onKeydown"])],2)}}});var PF=fn(rQ,[["__file","radio-button.vue"]]);const oQ=un({id:{type:String,default:void 0},size:zi,disabled:Boolean,modelValue:{type:[String,Number,Boolean],default:void 0},fill:{type:String,default:""},textColor:{type:String,default:""},name:{type:String,default:void 0},validateEvent:{type:Boolean,default:!0},..._s(["ariaLabel"])}),iQ=IF,sQ=qe({name:"ElRadioGroup"}),aQ=qe({...sQ,props:oQ,emits:iQ,setup(e,{emit:t}){const i=e,a=en("radio"),d=vs(),p=Se(),{formItem:_}=As(),{inputId:r,isLabeledByFormItem:S}=Al(i,{formItemContext:_}),C=k=>{t(mr,k),Vn(()=>t("change",k))};gr(()=>{const k=p.value.querySelectorAll("[type=radio]"),z=k[0];!Array.from(k).some(F=>F.checked)&&z&&(z.tabIndex=0)});const M=ee(()=>i.name||d.value);return Dr(AF,lo({...Zi(i),changeEvent:C,name:M})),qt(()=>i.modelValue,()=>{i.validateEvent&&(_==null||_.validate("change").catch(k=>void 0))}),(k,z)=>(ae(),Oe("div",{id:b(r),ref_key:"radioGroupRef",ref:p,class:pe(b(a).b("group")),role:"radiogroup","aria-label":b(S)?void 0:k.ariaLabel||"radio-group","aria-labelledby":b(S)?b(_).labelId:void 0},[pt(k.$slots,"default")],10,["id","aria-label","aria-labelledby"]))}});var RF=fn(aQ,[["__file","radio-group.vue"]]);const OF=ur(eQ,{RadioButton:PF,RadioGroup:RF}),lQ=ri(RF),cQ=ri(PF);var uQ=qe({name:"NodeContent",setup(){return{ns:en("cascader-node")}},render(){const{ns:e}=this,{node:t,panel:i}=this.$parent,{data:a,label:d}=t,{renderLabelFn:p}=i;return Kn("span",{class:e.e("label")},p?p({node:t,data:a}):d)}});const bE=Symbol(),dQ=qe({name:"ElCascaderNode",components:{ElCheckbox:Il,ElRadio:OF,NodeContent:uQ,ElIcon:On,Check:xy,Loading:Hc,ArrowRight:ca},props:{node:{type:Object,required:!0},menuId:String},emits:["expand"],setup(e,{emit:t}){const i=An(bE),a=en("cascader-node"),d=ee(()=>i.isHoverMenu),p=ee(()=>i.config.multiple),_=ee(()=>i.config.checkStrictly),r=ee(()=>{var ne;return(ne=i.checkedNodes[0])==null?void 0:ne.uid}),S=ee(()=>e.node.isDisabled),C=ee(()=>e.node.isLeaf),M=ee(()=>_.value&&!C.value||!S.value),k=ee(()=>F(i.expandingNode)),z=ee(()=>_.value&&i.checkedNodes.some(F)),F=ne=>{var se;const{level:fe,uid:ce}=e.node;return((se=ne==null?void 0:ne.pathNodes[fe-1])==null?void 0:se.uid)===ce},B=()=>{k.value||i.expandNode(e.node)},N=ne=>{const{node:se}=e;ne!==se.checked&&i.handleCheckChange(se,ne)},j=()=>{i.lazyLoad(e.node,()=>{C.value||B()})},U=ne=>{d.value&&(te(),!C.value&&t("expand",ne))},te=()=>{const{node:ne}=e;!M.value||ne.loading||(ne.loaded?B():j())},Y=()=>{d.value&&!C.value||(C.value&&!S.value&&!_.value&&!p.value?J(!0):te())},q=ne=>{_.value?(N(ne),e.node.loaded&&B()):J(ne)},J=ne=>{e.node.loaded?(N(ne),!_.value&&B()):j()};return{panel:i,isHoverMenu:d,multiple:p,checkStrictly:_,checkedNodeId:r,isDisabled:S,isLeaf:C,expandable:M,inExpandingPath:k,inCheckedPath:z,ns:a,handleHoverExpand:U,handleExpand:te,handleClick:Y,handleCheck:J,handleSelectCheck:q}}});function hQ(e,t,i,a,d,p){const _=Er("el-checkbox"),r=Er("el-radio"),S=Er("check"),C=Er("el-icon"),M=Er("node-content"),k=Er("loading"),z=Er("arrow-right");return ae(),Oe("li",{id:`${e.menuId}-${e.node.uid}`,role:"menuitem","aria-haspopup":!e.isLeaf,"aria-owns":e.isLeaf?void 0:e.menuId,"aria-expanded":e.inExpandingPath,tabindex:e.expandable?-1:void 0,class:pe([e.ns.b(),e.ns.is("selectable",e.checkStrictly),e.ns.is("active",e.node.checked),e.ns.is("disabled",!e.expandable),e.inExpandingPath&&"in-active-path",e.inCheckedPath&&"in-checked-path"]),onMouseenter:e.handleHoverExpand,onFocus:e.handleHoverExpand,onClick:e.handleClick},[yt(" prefix "),e.multiple?(ae(),kt(_,{key:0,"model-value":e.node.checked,indeterminate:e.node.indeterminate,disabled:e.isDisabled,onClick:Qn(()=>{},["stop"]),"onUpdate:modelValue":e.handleSelectCheck},null,8,["model-value","indeterminate","disabled","onClick","onUpdate:modelValue"])):e.checkStrictly?(ae(),kt(r,{key:1,"model-value":e.checkedNodeId,label:e.node.uid,disabled:e.isDisabled,"onUpdate:modelValue":e.handleSelectCheck,onClick:Qn(()=>{},["stop"])},{default:st(()=>[yt(`
        Add an empty element to avoid render label,
        do not use empty fragment here for https://github.com/vuejs/vue-next/pull/2485
      `),Ue("span")]),_:1},8,["model-value","label","disabled","onUpdate:modelValue","onClick"])):e.isLeaf&&e.node.checked?(ae(),kt(C,{key:2,class:pe(e.ns.e("prefix"))},{default:st(()=>[Ze(S)]),_:1},8,["class"])):yt("v-if",!0),yt(" content "),Ze(M),yt(" postfix "),e.isLeaf?yt("v-if",!0):(ae(),Oe(Bn,{key:3},[e.node.loading?(ae(),kt(C,{key:0,class:pe([e.ns.is("loading"),e.ns.e("postfix")])},{default:st(()=>[Ze(k)]),_:1},8,["class"])):(ae(),kt(C,{key:1,class:pe(["arrow-right",e.ns.e("postfix")])},{default:st(()=>[Ze(z)]),_:1},8,["class"]))],64))],42,["id","aria-haspopup","aria-owns","aria-expanded","tabindex","onMouseenter","onFocus","onClick"])}var fQ=fn(dQ,[["render",hQ],["__file","node.vue"]]);const pQ=qe({name:"ElCascaderMenu",components:{Loading:Hc,ElIcon:On,ElScrollbar:Yc,ElCascaderNode:fQ},props:{nodes:{type:Array,required:!0},index:{type:Number,required:!0}},setup(e){const t=wr(),i=en("cascader-menu"),{t:a}=Gr(),d=vs();let p=null,_=null;const r=An(bE),S=Se(null),C=ee(()=>!e.nodes.length),M=ee(()=>!r.initialLoaded),k=ee(()=>`${d.value}-${e.index}`),z=j=>{p=j.target},F=j=>{if(!(!r.isHoverMenu||!p||!S.value))if(p.contains(j.target)){B();const U=t.vnode.el,{left:te}=U.getBoundingClientRect(),{offsetWidth:Y,offsetHeight:q}=U,J=j.clientX-te,ne=p.offsetTop,se=ne+p.offsetHeight;S.value.innerHTML=`
          <path style="pointer-events: auto;" fill="transparent" d="M${J} ${ne} L${Y} 0 V${ne} Z" />
          <path style="pointer-events: auto;" fill="transparent" d="M${J} ${se} L${Y} ${q} V${se} Z" />
        `}else _||(_=window.setTimeout(N,r.config.hoverThreshold))},B=()=>{_&&(clearTimeout(_),_=null)},N=()=>{S.value&&(S.value.innerHTML="",B())};return{ns:i,panel:r,hoverZone:S,isEmpty:C,isLoading:M,menuId:k,t:a,handleExpand:z,handleMouseMove:F,clearHoverZone:N}}});function mQ(e,t,i,a,d,p){const _=Er("el-cascader-node"),r=Er("loading"),S=Er("el-icon"),C=Er("el-scrollbar");return ae(),kt(C,{key:e.menuId,tag:"ul",role:"menu",class:pe(e.ns.b()),"wrap-class":e.ns.e("wrap"),"view-class":[e.ns.e("list"),e.ns.is("empty",e.isEmpty)],onMousemove:e.handleMouseMove,onMouseleave:e.clearHoverZone},{default:st(()=>{var M;return[(ae(!0),Oe(Bn,null,Or(e.nodes,k=>(ae(),kt(_,{key:k.uid,node:k,"menu-id":e.menuId,onExpand:e.handleExpand},null,8,["node","menu-id","onExpand"]))),128)),e.isLoading?(ae(),Oe("div",{key:0,class:pe(e.ns.e("empty-text"))},[Ze(S,{size:"14",class:pe(e.ns.is("loading"))},{default:st(()=>[Ze(r)]),_:1},8,["class"]),Rr(" "+pn(e.t("el.cascader.loading")),1)],2)):e.isEmpty?(ae(),Oe("div",{key:1,class:pe(e.ns.e("empty-text"))},[pt(e.$slots,"empty",{},()=>[Rr(pn(e.t("el.cascader.noData")),1)])],2)):(M=e.panel)!=null&&M.isHoverMenu?(ae(),Oe("svg",{key:2,ref:"hoverZone",class:pe(e.ns.e("hover-zone"))},null,2)):yt("v-if",!0)]}),_:3},8,["class","wrap-class","view-class","onMousemove","onMouseleave"])}var gQ=fn(pQ,[["render",mQ],["__file","menu.vue"]]);const xE=(e="")=>e.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d"),Nc=e=>dy(e);let vQ=0;const _Q=e=>{const t=[e];let{parent:i}=e;for(;i;)t.unshift(i),i=i.parent;return t};let iT=class sT{constructor(t,i,a,d=!1){this.data=t,this.config=i,this.parent=a,this.root=d,this.uid=vQ++,this.checked=!1,this.indeterminate=!1,this.loading=!1;const{value:p,label:_,children:r}=i,S=t[r],C=_Q(this);this.level=d?0:a?a.level+1:1,this.value=t[p],this.label=t[_],this.pathNodes=C,this.pathValues=C.map(M=>M.value),this.pathLabels=C.map(M=>M.label),this.childrenData=S,this.children=(S||[]).map(M=>new sT(M,i,this)),this.loaded=!i.lazy||this.isLeaf||!ja(S)}get isDisabled(){const{data:t,parent:i,config:a}=this,{disabled:d,checkStrictly:p}=a;return(Nn(d)?d(t,this):!!t[d])||!p&&(i==null?void 0:i.isDisabled)}get isLeaf(){const{data:t,config:i,childrenData:a,loaded:d}=this,{lazy:p,leaf:_}=i,r=Nn(_)?_(t,this):t[_];return oo(r)?p&&!d?!1:!(ln(a)&&a.length):!!r}get valueByOption(){return this.config.emitPath?this.pathValues:this.value}appendChild(t){const{childrenData:i,children:a}=this,d=new sT(t,this.config,this);return ln(i)?i.push(t):this.childrenData=[t],a.push(d),d}calcText(t,i){const a=t?this.pathLabels.join(i):this.label;return this.text=a,a}broadcast(t,...i){const a=`onParent${Nc(t)}`;this.children.forEach(d=>{d&&(d.broadcast(t,...i),d[a]&&d[a](...i))})}emit(t,...i){const{parent:a}=this,d=`onChild${Nc(t)}`;a&&(a[d]&&a[d](...i),a.emit(t,...i))}onParentCheck(t){this.isDisabled||this.setCheckState(t)}onChildCheck(){const{children:t}=this,i=t.filter(d=>!d.isDisabled),a=i.length?i.every(d=>d.checked):!1;this.setCheckState(a)}setCheckState(t){const i=this.children.length,a=this.children.reduce((d,p)=>{const _=p.checked?1:p.indeterminate?.5:0;return d+_},0);this.checked=this.loaded&&this.children.filter(d=>!d.isDisabled).every(d=>d.loaded&&d.checked)&&t,this.indeterminate=this.loaded&&a!==i&&a>0}doCheck(t){if(this.checked===t)return;const{checkStrictly:i,multiple:a}=this.config;i||!a?this.checked=t:(this.broadcast("check",t),this.setCheckState(t),this.emit("check"))}};const aT=(e,t)=>e.reduce((i,a)=>(a.isLeaf?i.push(a):(!t&&i.push(a),i=i.concat(aT(a.children,t))),i),[]);let pR=class{constructor(t,i){this.config=i;const a=(t||[]).map(d=>new iT(d,this.config));this.nodes=a,this.allNodes=aT(a,!1),this.leafNodes=aT(a,!0)}getNodes(){return this.nodes}getFlattedNodes(t){return t?this.leafNodes:this.allNodes}appendNode(t,i){const a=i?i.appendChild(t):new iT(t,this.config);i||this.nodes.push(a),this.appendAllNodesAndLeafNodes(a)}appendNodes(t,i){t.forEach(a=>this.appendNode(a,i))}appendAllNodesAndLeafNodes(t){this.allNodes.push(t),t.isLeaf&&this.leafNodes.push(t),t.children&&t.children.forEach(i=>{this.appendAllNodesAndLeafNodes(i)})}getNodeByValue(t,i=!1){return!t&&t!==0?null:this.getFlattedNodes(i).find(d=>ms(d.value,t)||ms(d.pathValues,t))||null}getSameNode(t){return t&&this.getFlattedNodes(!1).find(({value:a,level:d})=>ms(t.value,a)&&t.level===d)||null}};const LF=un({modelValue:{type:dt([Number,String,Array])},options:{type:dt(Array),default:()=>[]},props:{type:dt(Object),default:()=>({})}}),yQ={expandTrigger:"click",multiple:!1,checkStrictly:!1,emitPath:!0,lazy:!1,lazyLoad:_o,value:"value",label:"label",children:"children",leaf:"leaf",disabled:"disabled",hoverThreshold:500},bQ=e=>ee(()=>({...yQ,...e.props})),mR=e=>{if(!e)return 0;const t=e.id.split("-");return Number(t[t.length-2])},xQ=e=>{if(!e)return;const t=e.querySelector("input");t?t.click():Bz(e)&&e.click()},wQ=(e,t)=>{const i=t.slice(0),a=i.map(p=>p.uid),d=e.reduce((p,_)=>{const r=a.indexOf(_.uid);return r>-1&&(p.push(_),i.splice(r,1),a.splice(r,1)),p},[]);return d.push(...i),d},gR=e=>[...new Set(e)],sa=e=>!e&&e!==0?[]:ln(e)?e:[e],SQ=qe({name:"ElCascaderPanel",components:{ElCascaderMenu:gQ},props:{...LF,border:{type:Boolean,default:!0},renderLabel:Function},emits:[mr,Eo,"close","expand-change"],setup(e,{emit:t,slots:i}){let a=!1;const d=en("cascader"),p=bQ(e);let _=null;const r=Se(!0),S=Se([]),C=Se(null),M=Se([]),k=Se(null),z=Se([]),F=ee(()=>p.value.expandTrigger==="hover"),B=ee(()=>e.renderLabel||i.default),N=()=>{const{options:de}=e,ke=p.value;a=!1,_=new pR(de,ke),M.value=[_.getNodes()],ke.lazy&&ja(e.options)?(r.value=!1,j(void 0,We=>{We&&(_=new pR(We,ke),M.value=[_.getNodes()]),r.value=!0,fe(!1,!0)})):fe(!1,!0)},j=(de,ke)=>{const We=p.value;de=de||new iT({},We,void 0,!0),de.loading=!0;const we=be=>{const Me=de,Ae=Me.root?null:Me;be&&(_==null||_.appendNodes(be,Ae)),Me.loading=!1,Me.loaded=!0,Me.childrenData=Me.childrenData||[],ke&&ke(be)};We.lazyLoad(de,we)},U=(de,ke)=>{var We;const{level:we}=de,be=M.value.slice(0,we);let Me;de.isLeaf?Me=de.pathNodes[we-2]:(Me=de,be.push(de.children)),((We=k.value)==null?void 0:We.uid)!==(Me==null?void 0:Me.uid)&&(k.value=de,M.value=be,!ke&&t("expand-change",(de==null?void 0:de.pathValues)||[]))},te=(de,ke,We=!0)=>{const{checkStrictly:we,multiple:be}=p.value,Me=z.value[0];a=!0,!be&&(Me==null||Me.doCheck(!1)),de.doCheck(ke),se(),We&&!be&&!we&&t("close"),!We&&!be&&!we&&Y(de)},Y=de=>{de&&(de=de.parent,Y(de),de&&U(de))},q=de=>_==null?void 0:_.getFlattedNodes(de),J=de=>{var ke;return(ke=q(de))==null?void 0:ke.filter(We=>We.checked!==!1)},ne=()=>{z.value.forEach(de=>de.doCheck(!1)),se(),M.value=M.value.slice(0,1),k.value=null,t("expand-change",[])},se=()=>{var de;const{checkStrictly:ke,multiple:We}=p.value,we=z.value,be=J(!ke),Me=wQ(we,be),Ae=Me.map(me=>me.valueByOption);z.value=Me,C.value=We?Ae:(de=Ae[0])!=null?de:null},fe=(de=!1,ke=!1)=>{const{modelValue:We}=e,{lazy:we,multiple:be,checkStrictly:Me}=p.value,Ae=!Me;if(!(!r.value||a||!ke&&ms(We,C.value)))if(we&&!de){const Be=gR(wq(sa(We))).map(Ve=>_==null?void 0:_.getNodeByValue(Ve)).filter(Ve=>!!Ve&&!Ve.loaded&&!Ve.loading);Be.length?Be.forEach(Ve=>{j(Ve,()=>fe(!1,ke))}):fe(!0,ke)}else{const me=be?sa(We):[We],Be=gR(me.map(Ve=>_==null?void 0:_.getNodeByValue(Ve,Ae)));ce(Be,ke),C.value=b1(We)}},ce=(de,ke=!0)=>{const{checkStrictly:We}=p.value,we=z.value,be=de.filter(me=>!!me&&(We||me.isLeaf)),Me=_==null?void 0:_.getSameNode(k.value),Ae=ke&&Me||be[0];Ae?Ae.pathNodes.forEach(me=>U(me,!0)):k.value=null,we.forEach(me=>me.doCheck(!1)),lo(be).forEach(me=>me.doCheck(!0)),z.value=be,Vn(le)},le=()=>{Hr&&S.value.forEach(de=>{const ke=de==null?void 0:de.$el;if(ke){const We=ke.querySelector(`.${d.namespace.value}-scrollbar__wrap`),we=ke.querySelector(`.${d.b("node")}.${d.is("active")}`)||ke.querySelector(`.${d.b("node")}.in-active-path`);XC(We,we)}})},ge=de=>{const ke=de.target,{code:We}=de;switch(We){case En.up:case En.down:{de.preventDefault();const we=We===En.up?-1:1;Wb(Vz(ke,we,`.${d.b("node")}[tabindex="-1"]`));break}case En.left:{de.preventDefault();const we=S.value[mR(ke)-1],be=we==null?void 0:we.$el.querySelector(`.${d.b("node")}[aria-expanded="true"]`);Wb(be);break}case En.right:{de.preventDefault();const we=S.value[mR(ke)+1],be=we==null?void 0:we.$el.querySelector(`.${d.b("node")}[tabindex="-1"]`);Wb(be);break}case En.enter:case En.numpadEnter:xQ(ke);break}};return Dr(bE,lo({config:p,expandingNode:k,checkedNodes:z,isHoverMenu:F,initialLoaded:r,renderLabelFn:B,lazyLoad:j,expandNode:U,handleCheckChange:te})),qt([p,()=>e.options],N,{deep:!0,immediate:!0}),qt(()=>e.modelValue,()=>{a=!1,fe()},{deep:!0}),qt(()=>C.value,de=>{ms(de,e.modelValue)||(t(mr,de),t(Eo,de))}),kL(()=>S.value=[]),gr(()=>!ja(e.modelValue)&&fe()),{ns:d,menuList:S,menus:M,checkedNodes:z,handleKeyDown:ge,handleCheckChange:te,getFlattedNodes:q,getCheckedNodes:J,clearCheckedNodes:ne,calculateCheckedValue:se,scrollToExpandingNode:le}}});function TQ(e,t,i,a,d,p){const _=Er("el-cascader-menu");return ae(),Oe("div",{class:pe([e.ns.b("panel"),e.ns.is("bordered",e.border)]),onKeydown:e.handleKeyDown},[(ae(!0),Oe(Bn,null,Or(e.menus,(r,S)=>(ae(),kt(_,{key:S,ref_for:!0,ref:C=>e.menuList[S]=C,index:S,nodes:[...r]},{empty:st(()=>[pt(e.$slots,"empty")]),_:2},1032,["index","nodes"]))),128))],42,["onKeydown"])}var CQ=fn(SQ,[["render",TQ],["__file","index.vue"]]);const DF=ur(CQ),Nu=un({type:{type:String,values:["primary","success","info","warning","danger"],default:"primary"},closable:Boolean,disableTransitions:Boolean,hit:Boolean,color:String,size:{type:String,values:Zc},effect:{type:String,values:["dark","light","plain"],default:"light"},round:Boolean}),EQ={close:e=>e instanceof MouseEvent,click:e=>e instanceof MouseEvent},MQ=qe({name:"ElTag"}),IQ=qe({...MQ,props:Nu,emits:EQ,setup(e,{emit:t}){const i=e,a=Li(),d=en("tag"),p=ee(()=>{const{type:C,hit:M,effect:k,closable:z,round:F}=i;return[d.b(),d.is("closable",z),d.m(C||"primary"),d.m(a.value),d.m(k),d.is("hit",M),d.is("round",F)]}),_=C=>{t("close",C)},r=C=>{t("click",C)},S=C=>{var M,k,z;(z=(k=(M=C==null?void 0:C.component)==null?void 0:M.subTree)==null?void 0:k.component)!=null&&z.bum&&(C.component.subTree.component.bum=null)};return(C,M)=>C.disableTransitions?(ae(),Oe("span",{key:0,class:pe(b(p)),style:$n({backgroundColor:C.color}),onClick:r},[Ue("span",{class:pe(b(d).e("content"))},[pt(C.$slots,"default")],2),C.closable?(ae(),kt(b(On),{key:0,class:pe(b(d).e("close")),onClick:Qn(_,["stop"])},{default:st(()=>[Ze(b(sc))]),_:1},8,["class","onClick"])):yt("v-if",!0)],6)):(ae(),kt(ls,{key:1,name:`${b(d).namespace.value}-zoom-in-center`,appear:"",onVnodeMounted:S},{default:st(()=>[Ue("span",{class:pe(b(p)),style:$n({backgroundColor:C.color}),onClick:r},[Ue("span",{class:pe(b(d).e("content"))},[pt(C.$slots,"default")],2),C.closable?(ae(),kt(b(On),{key:0,class:pe(b(d).e("close")),onClick:Qn(_,["stop"])},{default:st(()=>[Ze(b(sc))]),_:1},8,["class","onClick"])):yt("v-if",!0)],6)]),_:3},8,["name"]))}});var AQ=fn(IQ,[["__file","tag.vue"]]);const Dm=ur(AQ),kQ=un({...LF,size:zi,placeholder:String,disabled:Boolean,clearable:Boolean,filterable:Boolean,filterMethod:{type:dt(Function),default:(e,t)=>e.text.includes(t)},separator:{type:String,default:" / "},showAllLevels:{type:Boolean,default:!0},collapseTags:Boolean,maxCollapseTags:{type:Number,default:1},collapseTagsTooltip:{type:Boolean,default:!1},debounce:{type:Number,default:300},beforeFilter:{type:dt(Function),default:()=>!0},placement:{type:dt(String),values:qu,default:"bottom-start"},fallbackPlacements:{type:dt(Array),default:["bottom-start","bottom","top-start","top","right","left"]},popperClass:{type:String,default:""},teleported:rs.teleported,tagType:{...Nu.type,default:"info"},tagEffect:{...Nu.effect,default:"light"},validateEvent:{type:Boolean,default:!0},persistent:{type:Boolean,default:!0},...Qm}),PQ={[mr]:e=>!0,[Eo]:e=>!0,focus:e=>e instanceof FocusEvent,blur:e=>e instanceof FocusEvent,clear:()=>!0,visibleChange:e=>Ro(e),expandChange:e=>!!e,removeTag:e=>!!e},Rd=new Map;if(Hr){let e;document.addEventListener("mousedown",t=>e=t),document.addEventListener("mouseup",t=>{if(e){for(const i of Rd.values())for(const{documentHandler:a}of i)a(t,e);e=void 0}})}function vR(e,t){let i=[];return ln(t.arg)?i=t.arg:la(t.arg)&&i.push(t.arg),function(a,d){const p=t.instance.popperRef,_=a.target,r=d==null?void 0:d.target,S=!t||!t.instance,C=!_||!r,M=e.contains(_)||e.contains(r),k=e===_,z=i.length&&i.some(B=>B==null?void 0:B.contains(_))||i.length&&i.includes(r),F=p&&(p.contains(_)||p.contains(r));S||C||M||k||z||F||t.value(a,d)}}const Bu={beforeMount(e,t){Rd.has(e)||Rd.set(e,[]),Rd.get(e).push({documentHandler:vR(e,t),bindingFn:t.value})},updated(e,t){Rd.has(e)||Rd.set(e,[]);const i=Rd.get(e),a=i.findIndex(p=>p.bindingFn===t.oldValue),d={documentHandler:vR(e,t),bindingFn:t.value};a>=0?i.splice(a,1,d):i.push(d)},unmounted(e){Rd.delete(e)}},RQ="ElCascader",OQ=qe({name:RQ}),LQ=qe({...OQ,props:kQ,emits:PQ,setup(e,{expose:t,emit:i}){const a=e,d={modifiers:[{name:"arrowPosition",enabled:!0,phase:"main",fn:({state:ct})=>{const{modifiersData:Ut,placement:tt}=ct;["right","left","bottom","top"].includes(tt)||(Ut.arrow.x=35)},requires:["arrow"]}]},p=Uu();let _=0,r=0;const S=en("cascader"),C=en("input"),{t:M}=Gr(),{form:k,formItem:z}=As(),{valueOnClear:F}=dx(a),{isComposing:B,handleComposition:N}=Sy({afterComposition(ct){var Ut;const tt=(Ut=ct.target)==null?void 0:Ut.value;jn(tt)}}),j=Se(null),U=Se(null),te=Se(null),Y=Se(null),q=Se(null),J=Se(!1),ne=Se(!1),se=Se(!1),fe=Se(!1),ce=Se(""),le=Se(""),ge=Se([]),de=Se([]),ke=Se([]),We=ee(()=>p.style),we=ee(()=>a.disabled||(k==null?void 0:k.disabled)),be=ee(()=>a.placeholder||M("el.cascader.placeholder")),Me=ee(()=>le.value||ge.value.length>0||B.value?"":be.value),Ae=Li(),me=ee(()=>Ae.value==="small"?"small":"default"),Be=ee(()=>!!a.props.multiple),Ve=ee(()=>!a.filterable||Be.value),bt=ee(()=>Be.value?le.value:ce.value),Pe=ee(()=>{var ct;return((ct=Y.value)==null?void 0:ct.checkedNodes)||[]}),wt=ee(()=>!a.clearable||we.value||se.value||!ne.value?!1:!!Pe.value.length),Mt=ee(()=>{const{showAllLevels:ct,separator:Ut}=a,tt=Pe.value;return tt.length?Be.value?"":tt[0].calcText(ct,Ut):""}),Nt=ee(()=>(z==null?void 0:z.validateState)||""),vt=ee({get(){return b1(a.modelValue)},set(ct){const Ut=ct??F.value;i(mr,Ut),i(Eo,Ut),a.validateEvent&&(z==null||z.validate("change").catch(tt=>void 0))}}),Bt=ee(()=>[S.b(),S.m(Ae.value),S.is("disabled",we.value),p.class]),Wt=ee(()=>[C.e("icon"),"icon-arrow-down",S.is("reverse",J.value)]),Fe=ee(()=>S.is("focus",J.value||fe.value)),cn=ee(()=>{var ct,Ut;return(Ut=(ct=j.value)==null?void 0:ct.popperRef)==null?void 0:Ut.contentRef}),Re=ct=>{var Ut,tt,yn;we.value||(ct=ct??!J.value,ct!==J.value&&(J.value=ct,(tt=(Ut=U.value)==null?void 0:Ut.input)==null||tt.setAttribute("aria-expanded",`${ct}`),ct?(nt(),Vn((yn=Y.value)==null?void 0:yn.scrollToExpandingNode)):a.filterable&&Sn(),i("visibleChange",ct)))},nt=()=>{Vn(()=>{var ct;(ct=j.value)==null||ct.updatePopper()})},Qe=()=>{se.value=!1},Yt=ct=>{const{showAllLevels:Ut,separator:tt}=a;return{node:ct,key:ct.uid,text:ct.calcText(Ut,tt),hitState:!1,closable:!we.value&&!ct.isDisabled,isCollapseTag:!1}},Xt=ct=>{var Ut;const tt=ct.node;tt.doCheck(!1),(Ut=Y.value)==null||Ut.calculateCheckedValue(),i("removeTag",tt.valueByOption)},$t=()=>{if(!Be.value)return;const ct=Pe.value,Ut=[],tt=[];if(ct.forEach(yn=>tt.push(Yt(yn))),de.value=tt,ct.length){ct.slice(0,a.maxCollapseTags).forEach(sr=>Ut.push(Yt(sr)));const yn=ct.slice(a.maxCollapseTags),wn=yn.length;wn&&(a.collapseTags?Ut.push({key:-1,text:`+ ${wn}`,closable:!1,isCollapseTag:!0}):yn.forEach(sr=>Ut.push(Yt(sr))))}ge.value=Ut},Ot=()=>{var ct,Ut;const{filterMethod:tt,showAllLevels:yn,separator:wn}=a,sr=(Ut=(ct=Y.value)==null?void 0:ct.getFlattedNodes(!a.props.checkStrictly))==null?void 0:Ut.filter(vo=>vo.isDisabled?!1:(vo.calcText(yn,wn),tt(vo,bt.value)));Be.value&&(ge.value.forEach(vo=>{vo.hitState=!1}),de.value.forEach(vo=>{vo.hitState=!1})),se.value=!0,ke.value=sr,nt()},Ft=()=>{var ct;let Ut;se.value&&q.value?Ut=q.value.$el.querySelector(`.${S.e("suggestion-item")}`):Ut=(ct=Y.value)==null?void 0:ct.$el.querySelector(`.${S.b("node")}[tabindex="-1"]`),Ut&&(Ut.focus(),!se.value&&Ut.click())},sn=()=>{var ct,Ut;const tt=(ct=U.value)==null?void 0:ct.input,yn=te.value,wn=(Ut=q.value)==null?void 0:Ut.$el;if(!(!Hr||!tt)){if(wn){const sr=wn.querySelector(`.${S.e("suggestion-list")}`);sr.style.minWidth=`${tt.offsetWidth}px`}if(yn){const{offsetHeight:sr}=yn,vo=ge.value.length>0?`${Math.max(sr,_)-2}px`:`${_}px`;tt.style.height=vo,nt()}}},an=ct=>{var Ut;return(Ut=Y.value)==null?void 0:Ut.getCheckedNodes(ct)},Pn=ct=>{nt(),i("expandChange",ct)},bn=ct=>{if(!B.value)switch(ct.code){case En.enter:case En.numpadEnter:Re();break;case En.down:Re(!0),Vn(Ft),ct.preventDefault();break;case En.esc:J.value===!0&&(ct.preventDefault(),ct.stopPropagation(),Re(!1));break;case En.tab:Re(!1);break}},It=()=>{var ct;(ct=Y.value)==null||ct.clearCheckedNodes(),!J.value&&a.filterable&&Sn(),Re(!1),i("clear")},Sn=()=>{const{value:ct}=Mt;ce.value=ct,le.value=ct},Yn=ct=>{var Ut,tt;const{checked:yn}=ct;Be.value?(Ut=Y.value)==null||Ut.handleCheckChange(ct,!yn,!1):(!yn&&((tt=Y.value)==null||tt.handleCheckChange(ct,!0,!1)),Re(!1))},vr=ct=>{const Ut=ct.target,{code:tt}=ct;switch(tt){case En.up:case En.down:{ct.preventDefault();const yn=tt===En.up?-1:1;Wb(Vz(Ut,yn,`.${S.e("suggestion-item")}[tabindex="-1"]`));break}case En.enter:case En.numpadEnter:Ut.click();break}},tr=()=>{const ct=ge.value,Ut=ct[ct.length-1];r=le.value?0:r+1,!(!Ut||!r||a.collapseTags&&ct.length>1)&&(Ut.hitState?Xt(Ut):Ut.hitState=!0)},zr=ct=>{const Ut=ct.target,tt=S.e("search-input");Ut.className===tt&&(fe.value=!0),i("focus",ct)},Cr=ct=>{fe.value=!1,i("blur",ct)},Io=Ra(()=>{const{value:ct}=bt;if(!ct)return;const Ut=a.beforeFilter(ct);L_(Ut)?Ut.then(Ot).catch(()=>{}):Ut!==!1?Ot():Qe()},a.debounce),jn=(ct,Ut)=>{!J.value&&Re(!0),!(Ut!=null&&Ut.isComposing)&&(ct?Io():Qe())},Gt=ct=>Number.parseFloat(r9(C.cssVarName("input-height"),ct).value)-2;return qt(se,nt),qt([Pe,we,()=>a.collapseTags],$t),qt(ge,()=>{Vn(()=>sn())}),qt(Ae,async()=>{await Vn();const ct=U.value.input;_=Gt(ct)||_,sn()}),qt(Mt,Sn,{immediate:!0}),gr(()=>{const ct=U.value.input,Ut=Gt(ct);_=ct.offsetHeight||Ut,ti(ct,sn)}),t({getCheckedNodes:an,cascaderPanelRef:Y,togglePopperVisible:Re,contentRef:cn,presentText:Mt}),(ct,Ut)=>(ae(),kt(b(Is),{ref_key:"tooltipRef",ref:j,visible:J.value,teleported:ct.teleported,"popper-class":[b(S).e("dropdown"),ct.popperClass],"popper-options":d,"fallback-placements":ct.fallbackPlacements,"stop-popper-mouse-event":!1,"gpu-acceleration":!1,placement:ct.placement,transition:`${b(S).namespace.value}-zoom-in-top`,effect:"light",pure:"",persistent:ct.persistent,onHide:Qe},{default:st(()=>[hr((ae(),Oe("div",{class:pe(b(Bt)),style:$n(b(We)),onClick:()=>Re(b(Ve)?void 0:!0),onKeydown:bn,onMouseenter:tt=>ne.value=!0,onMouseleave:tt=>ne.value=!1},[Ze(b(Us),{ref_key:"input",ref:U,modelValue:ce.value,"onUpdate:modelValue":tt=>ce.value=tt,placeholder:b(Me),readonly:b(Ve),disabled:b(we),"validate-event":!1,size:b(Ae),class:pe(b(Fe)),tabindex:b(Be)&&ct.filterable&&!b(we)?-1:void 0,onCompositionstart:b(N),onCompositionupdate:b(N),onCompositionend:b(N),onFocus:zr,onBlur:Cr,onInput:jn},Ya({suffix:st(()=>[b(wt)?(ae(),kt(b(On),{key:"clear",class:pe([b(C).e("icon"),"icon-circle-close"]),onClick:Qn(It,["stop"])},{default:st(()=>[Ze(b(Wu))]),_:1},8,["class","onClick"])):(ae(),kt(b(On),{key:"arrow-down",class:pe(b(Wt)),onClick:Qn(tt=>Re(),["stop"])},{default:st(()=>[Ze(b(Gu))]),_:1},8,["class","onClick"]))]),_:2},[ct.$slots.prefix?{name:"prefix",fn:st(()=>[pt(ct.$slots,"prefix")])}:void 0]),1032,["modelValue","onUpdate:modelValue","placeholder","readonly","disabled","size","class","tabindex","onCompositionstart","onCompositionupdate","onCompositionend"]),b(Be)?(ae(),Oe("div",{key:0,ref_key:"tagWrapper",ref:te,class:pe([b(S).e("tags"),b(S).is("validate",!!b(Nt))])},[(ae(!0),Oe(Bn,null,Or(ge.value,tt=>(ae(),kt(b(Dm),{key:tt.key,type:ct.tagType,size:b(me),effect:ct.tagEffect,hit:tt.hitState,closable:tt.closable,"disable-transitions":"",onClose:yn=>Xt(tt)},{default:st(()=>[tt.isCollapseTag===!1?(ae(),Oe("span",{key:0},pn(tt.text),1)):(ae(),kt(b(Is),{key:1,disabled:J.value||!ct.collapseTagsTooltip,"fallback-placements":["bottom","top","right","left"],placement:"bottom",effect:"light"},{default:st(()=>[Ue("span",null,pn(tt.text),1)]),content:st(()=>[Ue("div",{class:pe(b(S).e("collapse-tags"))},[(ae(!0),Oe(Bn,null,Or(de.value.slice(ct.maxCollapseTags),(yn,wn)=>(ae(),Oe("div",{key:wn,class:pe(b(S).e("collapse-tag"))},[(ae(),kt(b(Dm),{key:yn.key,class:"in-tooltip",type:ct.tagType,size:b(me),effect:ct.tagEffect,hit:yn.hitState,closable:yn.closable,"disable-transitions":"",onClose:sr=>Xt(yn)},{default:st(()=>[Ue("span",null,pn(yn.text),1)]),_:2},1032,["type","size","effect","hit","closable","onClose"]))],2))),128))],2)]),_:2},1032,["disabled"]))]),_:2},1032,["type","size","effect","hit","closable","onClose"]))),128)),ct.filterable&&!b(we)?hr((ae(),Oe("input",{key:0,"onUpdate:modelValue":tt=>le.value=tt,type:"text",class:pe(b(S).e("search-input")),placeholder:b(Mt)?"":b(be),onInput:tt=>jn(le.value,tt),onClick:Qn(tt=>Re(!0),["stop"]),onKeydown:Po(tr,["delete"]),onCompositionstart:b(N),onCompositionupdate:b(N),onCompositionend:b(N),onFocus:zr,onBlur:Cr},null,42,["onUpdate:modelValue","placeholder","onInput","onClick","onKeydown","onCompositionstart","onCompositionupdate","onCompositionend"])),[[tx,le.value]]):yt("v-if",!0)],2)):yt("v-if",!0)],46,["onClick","onMouseenter","onMouseleave"])),[[b(Bu),()=>Re(!1),b(cn)]])]),content:st(()=>[hr(Ze(b(DF),{ref_key:"cascaderPanelRef",ref:Y,modelValue:b(vt),"onUpdate:modelValue":tt=>To(vt)?vt.value=tt:null,options:ct.options,props:a.props,border:!1,"render-label":ct.$slots.default,onExpandChange:Pn,onClose:tt=>ct.$nextTick(()=>Re(!1))},{empty:st(()=>[pt(ct.$slots,"empty")]),_:3},8,["modelValue","onUpdate:modelValue","options","props","render-label","onClose"]),[[no,!se.value]]),ct.filterable?hr((ae(),kt(b(Yc),{key:0,ref_key:"suggestionPanel",ref:q,tag:"ul",class:pe(b(S).e("suggestion-panel")),"view-class":b(S).e("suggestion-list"),onKeydown:vr},{default:st(()=>[ke.value.length?(ae(!0),Oe(Bn,{key:0},Or(ke.value,tt=>(ae(),Oe("li",{key:tt.uid,class:pe([b(S).e("suggestion-item"),b(S).is("checked",tt.checked)]),tabindex:-1,onClick:yn=>Yn(tt)},[pt(ct.$slots,"suggestion-item",{item:tt},()=>[Ue("span",null,pn(tt.text),1),tt.checked?(ae(),kt(b(On),{key:0},{default:st(()=>[Ze(b(xy))]),_:1})):yt("v-if",!0)])],10,["onClick"]))),128)):pt(ct.$slots,"empty",{key:1},()=>[Ue("li",{class:pe(b(S).e("empty-text"))},pn(b(M)("el.cascader.noMatch")),3)])]),_:3},8,["class","view-class"])),[[no,se.value]]):yt("v-if",!0)]),_:3},8,["visible","teleported","popper-class","fallback-placements","placement","transition","persistent"]))}});var DQ=fn(LQ,[["__file","cascader.vue"]]);const zQ=ur(DQ),FQ=un({checked:Boolean,disabled:Boolean,type:{type:String,values:["primary","success","info","warning","danger"],default:"primary"}}),NQ={"update:checked":e=>Ro(e),[Eo]:e=>Ro(e)},BQ=qe({name:"ElCheckTag"}),VQ=qe({...BQ,props:FQ,emits:NQ,setup(e,{emit:t}){const i=e,a=en("check-tag"),d=ee(()=>i.disabled),p=ee(()=>[a.b(),a.is("checked",i.checked),a.is("disabled",d.value),a.m(i.type||"primary")]),_=()=>{if(d.value)return;const r=!i.checked;t(Eo,r),t("update:checked",r)};return(r,S)=>(ae(),Oe("span",{class:pe(b(p)),onClick:_},[pt(r.$slots,"default")],2))}});var $Q=fn(VQ,[["__file","check-tag.vue"]]);const UQ=ur($Q),jQ=un({tag:{type:String,default:"div"},span:{type:Number,default:24},offset:{type:Number,default:0},pull:{type:Number,default:0},push:{type:Number,default:0},xs:{type:dt([Number,Object]),default:()=>ni({})},sm:{type:dt([Number,Object]),default:()=>ni({})},md:{type:dt([Number,Object]),default:()=>ni({})},lg:{type:dt([Number,Object]),default:()=>ni({})},xl:{type:dt([Number,Object]),default:()=>ni({})}}),zF=Symbol("rowContextKey"),HQ=qe({name:"ElCol"}),GQ=qe({...HQ,props:jQ,setup(e){const t=e,{gutter:i}=An(zF,{gutter:ee(()=>0)}),a=en("col"),d=ee(()=>{const _={};return i.value&&(_.paddingLeft=_.paddingRight=`${i.value/2}px`),_}),p=ee(()=>{const _=[];return["span","offset","pull","push"].forEach(C=>{const M=t[C];Gn(M)&&(C==="span"?_.push(a.b(`${t[C]}`)):M>0&&_.push(a.b(`${C}-${t[C]}`)))}),["xs","sm","md","lg","xl"].forEach(C=>{Gn(t[C])?_.push(a.b(`${C}-${t[C]}`)):yr(t[C])&&Object.entries(t[C]).forEach(([M,k])=>{_.push(M!=="span"?a.b(`${C}-${M}-${k}`):a.b(`${C}-${k}`))})}),i.value&&_.push(a.is("guttered")),[a.b(),_]});return(_,r)=>(ae(),kt(Tr(_.tag),{class:pe(b(p)),style:$n(b(d))},{default:st(()=>[pt(_.$slots,"default")]),_:3},8,["class","style"]))}});var WQ=fn(GQ,[["__file","col.vue"]]);const qQ=ur(WQ),_R=e=>Gn(e)||Dn(e)||ln(e),KQ=un({accordion:Boolean,modelValue:{type:dt([Array,String,Number]),default:()=>ni([])}}),ZQ={[mr]:_R,[Eo]:_R},FF=Symbol("collapseContextKey"),YQ=(e,t)=>{const i=Se(Vs(e.modelValue)),a=p=>{i.value=p;const _=e.accordion?i.value[0]:i.value;t(mr,_),t(Eo,_)},d=p=>{if(e.accordion)a([i.value[0]===p?"":p]);else{const _=[...i.value],r=_.indexOf(p);r>-1?_.splice(r,1):_.push(p),a(_)}};return qt(()=>e.modelValue,()=>i.value=Vs(e.modelValue),{deep:!0}),Dr(FF,{activeNames:i,handleItemClick:d}),{activeNames:i,setActiveNames:a}},XQ=()=>{const e=en("collapse");return{rootKls:ee(()=>e.b())}},JQ=qe({name:"ElCollapse"}),QQ=qe({...JQ,props:KQ,emits:ZQ,setup(e,{expose:t,emit:i}){const a=e,{activeNames:d,setActiveNames:p}=YQ(a,i),{rootKls:_}=XQ();return t({activeNames:d,setActiveNames:p}),(r,S)=>(ae(),Oe("div",{class:pe(b(_))},[pt(r.$slots,"default")],2))}});var eee=fn(QQ,[["__file","collapse.vue"]]);const tee=qe({name:"ElCollapseTransition"}),nee=qe({...tee,setup(e){const t=en("collapse-transition"),i=d=>{d.style.maxHeight="",d.style.overflow=d.dataset.oldOverflow,d.style.paddingTop=d.dataset.oldPaddingTop,d.style.paddingBottom=d.dataset.oldPaddingBottom},a={beforeEnter(d){d.dataset||(d.dataset={}),d.dataset.oldPaddingTop=d.style.paddingTop,d.dataset.oldPaddingBottom=d.style.paddingBottom,d.style.height&&(d.dataset.elExistsHeight=d.style.height),d.style.maxHeight=0,d.style.paddingTop=0,d.style.paddingBottom=0},enter(d){requestAnimationFrame(()=>{d.dataset.oldOverflow=d.style.overflow,d.dataset.elExistsHeight?d.style.maxHeight=d.dataset.elExistsHeight:d.scrollHeight!==0?d.style.maxHeight=`${d.scrollHeight}px`:d.style.maxHeight=0,d.style.paddingTop=d.dataset.oldPaddingTop,d.style.paddingBottom=d.dataset.oldPaddingBottom,d.style.overflow="hidden"})},afterEnter(d){d.style.maxHeight="",d.style.overflow=d.dataset.oldOverflow},enterCancelled(d){i(d)},beforeLeave(d){d.dataset||(d.dataset={}),d.dataset.oldPaddingTop=d.style.paddingTop,d.dataset.oldPaddingBottom=d.style.paddingBottom,d.dataset.oldOverflow=d.style.overflow,d.style.maxHeight=`${d.scrollHeight}px`,d.style.overflow="hidden"},leave(d){d.scrollHeight!==0&&(d.style.maxHeight=0,d.style.paddingTop=0,d.style.paddingBottom=0)},afterLeave(d){i(d)},leaveCancelled(d){i(d)}};return(d,p)=>(ae(),kt(ls,Mr({name:b(t).b()},B6(a)),{default:st(()=>[pt(d.$slots,"default")]),_:3},16,["name"]))}});var ree=fn(nee,[["__file","collapse-transition.vue"]]);const bx=ur(ree),oee=un({title:{type:String,default:""},name:{type:dt([String,Number]),default:void 0},icon:{type:Mo,default:ca},disabled:Boolean}),iee=e=>{const t=An(FF),{namespace:i}=en("collapse"),a=Se(!1),d=Se(!1),p=iE(),_=ee(()=>p.current++),r=ee(()=>{var z;return(z=e.name)!=null?z:`${i.value}-id-${p.prefix}-${b(_)}`}),S=ee(()=>t==null?void 0:t.activeNames.value.includes(b(r)));return{focusing:a,id:_,isActive:S,handleFocus:()=>{setTimeout(()=>{d.value?d.value=!1:a.value=!0},50)},handleHeaderClick:()=>{e.disabled||(t==null||t.handleItemClick(b(r)),a.value=!1,d.value=!0)},handleEnterClick:()=>{t==null||t.handleItemClick(b(r))}}},see=(e,{focusing:t,isActive:i,id:a})=>{const d=en("collapse"),p=ee(()=>[d.b("item"),d.is("active",b(i)),d.is("disabled",e.disabled)]),_=ee(()=>[d.be("item","header"),d.is("active",b(i)),{focusing:b(t)&&!e.disabled}]),r=ee(()=>[d.be("item","arrow"),d.is("active",b(i))]),S=ee(()=>d.be("item","wrap")),C=ee(()=>d.be("item","content")),M=ee(()=>d.b(`content-${b(a)}`)),k=ee(()=>d.b(`head-${b(a)}`));return{arrowKls:r,headKls:_,rootKls:p,itemWrapperKls:S,itemContentKls:C,scopedContentId:M,scopedHeadId:k}},aee=qe({name:"ElCollapseItem"}),lee=qe({...aee,props:oee,setup(e,{expose:t}){const i=e,{focusing:a,id:d,isActive:p,handleFocus:_,handleHeaderClick:r,handleEnterClick:S}=iee(i),{arrowKls:C,headKls:M,rootKls:k,itemWrapperKls:z,itemContentKls:F,scopedContentId:B,scopedHeadId:N}=see(i,{focusing:a,isActive:p,id:d});return t({isActive:p}),(j,U)=>(ae(),Oe("div",{class:pe(b(k))},[Ue("button",{id:b(N),class:pe(b(M)),"aria-expanded":b(p),"aria-controls":b(B),"aria-describedby":b(B),tabindex:j.disabled?-1:0,type:"button",onClick:b(r),onKeydown:Po(Qn(b(S),["stop","prevent"]),["space","enter"]),onFocus:b(_),onBlur:te=>a.value=!1},[pt(j.$slots,"title",{},()=>[Rr(pn(j.title),1)]),pt(j.$slots,"icon",{isActive:b(p)},()=>[Ze(b(On),{class:pe(b(C))},{default:st(()=>[(ae(),kt(Tr(j.icon)))]),_:1},8,["class"])])],42,["id","aria-expanded","aria-controls","aria-describedby","tabindex","onClick","onKeydown","onFocus","onBlur"]),Ze(b(bx),null,{default:st(()=>[hr(Ue("div",{id:b(B),role:"region",class:pe(b(z)),"aria-hidden":!b(p),"aria-labelledby":b(N)},[Ue("div",{class:pe(b(F))},[pt(j.$slots,"default")],2)],10,["id","aria-hidden","aria-labelledby"]),[[no,b(p)]])]),_:3})],2))}});var NF=fn(lee,[["__file","collapse-item.vue"]]);const cee=ur(eee,{CollapseItem:NF}),uee=ri(NF),dee=un({color:{type:dt(Object),required:!0},vertical:{type:Boolean,default:!1}});let cS=!1;function X_(e,t){if(!Hr)return;const i=function(p){var _;(_=t.drag)==null||_.call(t,p)},a=function(p){var _;document.removeEventListener("mousemove",i),document.removeEventListener("mouseup",a),document.removeEventListener("touchmove",i),document.removeEventListener("touchend",a),document.onselectstart=null,document.ondragstart=null,cS=!1,(_=t.end)==null||_.call(t,p)},d=function(p){var _;cS||(p.preventDefault(),document.onselectstart=()=>!1,document.ondragstart=()=>!1,document.addEventListener("mousemove",i),document.addEventListener("mouseup",a),document.addEventListener("touchmove",i),document.addEventListener("touchend",a),cS=!0,(_=t.start)==null||_.call(t,p))};e.addEventListener("mousedown",d),e.addEventListener("touchstart",d,{passive:!1})}const hee=(e,t)=>{if(!Hr||!e||!t)return!1;const i=e.getBoundingClientRect();let a;return t instanceof Element?a=t.getBoundingClientRect():a={top:0,right:window.innerWidth,bottom:window.innerHeight,left:0},i.top<a.bottom&&i.bottom>a.top&&i.right>a.left&&i.left<a.right},yR=e=>{let t=0,i=e;for(;i;)t+=i.offsetTop,i=i.offsetParent;return t},lT=(e,t)=>Math.abs(yR(e)-yR(t)),wE=e=>{let t,i;return e.type==="touchend"?(i=e.changedTouches[0].clientY,t=e.changedTouches[0].clientX):e.type.startsWith("touch")?(i=e.touches[0].clientY,t=e.touches[0].clientX):(i=e.clientY,t=e.clientX),{clientX:t,clientY:i}},fee=e=>{const t=wr(),{t:i}=Gr(),a=Uo(),d=Uo(),p=ee(()=>e.color.get("alpha")),_=ee(()=>i("el.colorpicker.alphaLabel"));function r(k){var z;k.target!==a.value&&S(k),(z=a.value)==null||z.focus()}function S(k){if(!d.value||!a.value)return;const F=t.vnode.el.getBoundingClientRect(),{clientX:B,clientY:N}=wE(k);if(e.vertical){let j=N-F.top;j=Math.max(a.value.offsetHeight/2,j),j=Math.min(j,F.height-a.value.offsetHeight/2),e.color.set("alpha",Math.round((j-a.value.offsetHeight/2)/(F.height-a.value.offsetHeight)*100))}else{let j=B-F.left;j=Math.max(a.value.offsetWidth/2,j),j=Math.min(j,F.width-a.value.offsetWidth/2),e.color.set("alpha",Math.round((j-a.value.offsetWidth/2)/(F.width-a.value.offsetWidth)*100))}}function C(k){const{code:z,shiftKey:F}=k,B=F?10:1;switch(z){case En.left:case En.down:k.preventDefault(),k.stopPropagation(),M(-B);break;case En.right:case En.up:k.preventDefault(),k.stopPropagation(),M(B);break}}function M(k){let z=p.value+k;z=z<0?0:z>100?100:z,e.color.set("alpha",z)}return{thumb:a,bar:d,alpha:p,alphaLabel:_,handleDrag:S,handleClick:r,handleKeydown:C}},pee=(e,{bar:t,thumb:i,handleDrag:a})=>{const d=wr(),p=en("color-alpha-slider"),_=Se(0),r=Se(0),S=Se();function C(){if(!i.value||e.vertical)return 0;const te=d.vnode.el,Y=e.color.get("alpha");return te?Math.round(Y*(te.offsetWidth-i.value.offsetWidth/2)/100):0}function M(){if(!i.value)return 0;const te=d.vnode.el;if(!e.vertical)return 0;const Y=e.color.get("alpha");return te?Math.round(Y*(te.offsetHeight-i.value.offsetHeight/2)/100):0}function k(){if(e.color&&e.color.value){const{r:te,g:Y,b:q}=e.color.toRgb();return`linear-gradient(to right, rgba(${te}, ${Y}, ${q}, 0) 0%, rgba(${te}, ${Y}, ${q}, 1) 100%)`}return""}function z(){_.value=C(),r.value=M(),S.value=k()}gr(()=>{if(!t.value||!i.value)return;const te={drag:Y=>{a(Y)},end:Y=>{a(Y)}};X_(t.value,te),X_(i.value,te),z()}),qt(()=>e.color.get("alpha"),()=>z()),qt(()=>e.color.value,()=>z());const F=ee(()=>[p.b(),p.is("vertical",e.vertical)]),B=ee(()=>p.e("bar")),N=ee(()=>p.e("thumb")),j=ee(()=>({background:S.value})),U=ee(()=>({left:ui(_.value),top:ui(r.value)}));return{rootKls:F,barKls:B,barStyle:j,thumbKls:N,thumbStyle:U,update:z}},mee="ElColorAlphaSlider",gee=qe({name:mee}),vee=qe({...gee,props:dee,setup(e,{expose:t}){const i=e,{alpha:a,alphaLabel:d,bar:p,thumb:_,handleDrag:r,handleClick:S,handleKeydown:C}=fee(i),{rootKls:M,barKls:k,barStyle:z,thumbKls:F,thumbStyle:B,update:N}=pee(i,{bar:p,thumb:_,handleDrag:r});return t({update:N,bar:p,thumb:_}),(j,U)=>(ae(),Oe("div",{class:pe(b(M))},[Ue("div",{ref_key:"bar",ref:p,class:pe(b(k)),style:$n(b(z)),onClick:b(S)},null,14,["onClick"]),Ue("div",{ref_key:"thumb",ref:_,class:pe(b(F)),style:$n(b(B)),"aria-label":b(d),"aria-valuenow":b(a),"aria-orientation":j.vertical?"vertical":"horizontal","aria-valuemin":"0","aria-valuemax":"100",role:"slider",tabindex:"0",onKeydown:b(C)},null,46,["aria-label","aria-valuenow","aria-orientation","onKeydown"])],2))}});var _ee=fn(vee,[["__file","alpha-slider.vue"]]);const yee=qe({name:"ElColorHueSlider",props:{color:{type:Object,required:!0},vertical:Boolean},setup(e){const t=en("color-hue-slider"),i=wr(),a=Se(),d=Se(),p=Se(0),_=Se(0),r=ee(()=>e.color.get("hue"));qt(()=>r.value,()=>{z()});function S(F){F.target!==a.value&&C(F)}function C(F){if(!d.value||!a.value)return;const N=i.vnode.el.getBoundingClientRect(),{clientX:j,clientY:U}=wE(F);let te;if(e.vertical){let Y=U-N.top;Y=Math.min(Y,N.height-a.value.offsetHeight/2),Y=Math.max(a.value.offsetHeight/2,Y),te=Math.round((Y-a.value.offsetHeight/2)/(N.height-a.value.offsetHeight)*360)}else{let Y=j-N.left;Y=Math.min(Y,N.width-a.value.offsetWidth/2),Y=Math.max(a.value.offsetWidth/2,Y),te=Math.round((Y-a.value.offsetWidth/2)/(N.width-a.value.offsetWidth)*360)}e.color.set("hue",te)}function M(){if(!a.value)return 0;const F=i.vnode.el;if(e.vertical)return 0;const B=e.color.get("hue");return F?Math.round(B*(F.offsetWidth-a.value.offsetWidth/2)/360):0}function k(){if(!a.value)return 0;const F=i.vnode.el;if(!e.vertical)return 0;const B=e.color.get("hue");return F?Math.round(B*(F.offsetHeight-a.value.offsetHeight/2)/360):0}function z(){p.value=M(),_.value=k()}return gr(()=>{if(!d.value||!a.value)return;const F={drag:B=>{C(B)},end:B=>{C(B)}};X_(d.value,F),X_(a.value,F),z()}),{bar:d,thumb:a,thumbLeft:p,thumbTop:_,hueValue:r,handleClick:S,update:z,ns:t}}});function bee(e,t,i,a,d,p){return ae(),Oe("div",{class:pe([e.ns.b(),e.ns.is("vertical",e.vertical)])},[Ue("div",{ref:"bar",class:pe(e.ns.e("bar")),onClick:e.handleClick},null,10,["onClick"]),Ue("div",{ref:"thumb",class:pe(e.ns.e("thumb")),style:$n({left:e.thumbLeft+"px",top:e.thumbTop+"px"})},null,6)],2)}var xee=fn(yee,[["render",bee],["__file","hue-slider.vue"]]);const wee=un({modelValue:String,id:String,showAlpha:Boolean,colorFormat:String,disabled:Boolean,size:zi,popperClass:{type:String,default:""},tabindex:{type:[String,Number],default:0},teleported:rs.teleported,predefine:{type:dt(Array)},validateEvent:{type:Boolean,default:!0},..._s(["ariaLabel"])}),See={[mr]:e=>Dn(e)||Ki(e),[Eo]:e=>Dn(e)||Ki(e),activeChange:e=>Dn(e)||Ki(e),focus:e=>e instanceof FocusEvent,blur:e=>e instanceof FocusEvent},BF=Symbol("colorPickerContextKey"),bR=function(e,t,i){return[e,t*i/((e=(2-t)*i)<1?e:2-e)||0,e/2]},Tee=function(e){return Dn(e)&&e.includes(".")&&Number.parseFloat(e)===1},Cee=function(e){return Dn(e)&&e.includes("%")},bm=function(e,t){Tee(e)&&(e="100%");const i=Cee(e);return e=Math.min(t,Math.max(0,Number.parseFloat(`${e}`))),i&&(e=Number.parseInt(`${e*t}`,10)/100),Math.abs(e-t)<1e-6?1:e%t/Number.parseFloat(t)},xR={10:"A",11:"B",12:"C",13:"D",14:"E",15:"F"},Kb=e=>{e=Math.min(Math.round(e),255);const t=Math.floor(e/16),i=e%16;return`${xR[t]||t}${xR[i]||i}`},wR=function({r:e,g:t,b:i}){return Number.isNaN(+e)||Number.isNaN(+t)||Number.isNaN(+i)?"":`#${Kb(e)}${Kb(t)}${Kb(i)}`},uS={A:10,B:11,C:12,D:13,E:14,F:15},ff=function(e){return e.length===2?(uS[e[0].toUpperCase()]||+e[0])*16+(uS[e[1].toUpperCase()]||+e[1]):uS[e[1].toUpperCase()]||+e[1]},Eee=function(e,t,i){t=t/100,i=i/100;let a=t;const d=Math.max(i,.01);i*=2,t*=i<=1?i:2-i,a*=d<=1?d:2-d;const p=(i+t)/2,_=i===0?2*a/(d+a):2*t/(i+t);return{h:e,s:_*100,v:p*100}},SR=(e,t,i)=>{e=bm(e,255),t=bm(t,255),i=bm(i,255);const a=Math.max(e,t,i),d=Math.min(e,t,i);let p;const _=a,r=a-d,S=a===0?0:r/a;if(a===d)p=0;else{switch(a){case e:{p=(t-i)/r+(t<i?6:0);break}case t:{p=(i-e)/r+2;break}case i:{p=(e-t)/r+4;break}}p/=6}return{h:p*360,s:S*100,v:_*100}},c_=function(e,t,i){e=bm(e,360)*6,t=bm(t,100),i=bm(i,100);const a=Math.floor(e),d=e-a,p=i*(1-t),_=i*(1-d*t),r=i*(1-(1-d)*t),S=a%6,C=[i,_,p,p,r,i][S],M=[r,i,i,_,p,p][S],k=[p,p,r,i,i,_][S];return{r:Math.round(C*255),g:Math.round(M*255),b:Math.round(k*255)}};class k_{constructor(t={}){this._hue=0,this._saturation=100,this._value=100,this._alpha=100,this.enableAlpha=!1,this.format="hex",this.value="";for(const i in t)to(t,i)&&(this[i]=t[i]);t.value?this.fromString(t.value):this.doOnChange()}set(t,i){if(arguments.length===1&&typeof t=="object"){for(const a in t)to(t,a)&&this.set(a,t[a]);return}this[`_${t}`]=i,this.doOnChange()}get(t){return t==="alpha"?Math.floor(this[`_${t}`]):this[`_${t}`]}toRgb(){return c_(this._hue,this._saturation,this._value)}fromString(t){if(!t){this._hue=0,this._saturation=100,this._value=100,this.doOnChange();return}const i=(a,d,p)=>{this._hue=Math.max(0,Math.min(360,a)),this._saturation=Math.max(0,Math.min(100,d)),this._value=Math.max(0,Math.min(100,p)),this.doOnChange()};if(t.includes("hsl")){const a=t.replace(/hsla|hsl|\(|\)/gm,"").split(/\s|,/g).filter(d=>d!=="").map((d,p)=>p>2?Number.parseFloat(d):Number.parseInt(d,10));if(a.length===4?this._alpha=Number.parseFloat(a[3])*100:a.length===3&&(this._alpha=100),a.length>=3){const{h:d,s:p,v:_}=Eee(a[0],a[1],a[2]);i(d,p,_)}}else if(t.includes("hsv")){const a=t.replace(/hsva|hsv|\(|\)/gm,"").split(/\s|,/g).filter(d=>d!=="").map((d,p)=>p>2?Number.parseFloat(d):Number.parseInt(d,10));a.length===4?this._alpha=Number.parseFloat(a[3])*100:a.length===3&&(this._alpha=100),a.length>=3&&i(a[0],a[1],a[2])}else if(t.includes("rgb")){const a=t.replace(/rgba|rgb|\(|\)/gm,"").split(/\s|,/g).filter(d=>d!=="").map((d,p)=>p>2?Number.parseFloat(d):Number.parseInt(d,10));if(a.length===4?this._alpha=Number.parseFloat(a[3])*100:a.length===3&&(this._alpha=100),a.length>=3){const{h:d,s:p,v:_}=SR(a[0],a[1],a[2]);i(d,p,_)}}else if(t.includes("#")){const a=t.replace("#","").trim();if(!/^[0-9a-fA-F]{3}$|^[0-9a-fA-F]{6}$|^[0-9a-fA-F]{8}$/.test(a))return;let d,p,_;a.length===3?(d=ff(a[0]+a[0]),p=ff(a[1]+a[1]),_=ff(a[2]+a[2])):(a.length===6||a.length===8)&&(d=ff(a.slice(0,2)),p=ff(a.slice(2,4)),_=ff(a.slice(4,6))),a.length===8?this._alpha=ff(a.slice(6))/255*100:(a.length===3||a.length===6)&&(this._alpha=100);const{h:r,s:S,v:C}=SR(d,p,_);i(r,S,C)}}compare(t){return Math.abs(t._hue-this._hue)<2&&Math.abs(t._saturation-this._saturation)<1&&Math.abs(t._value-this._value)<1&&Math.abs(t._alpha-this._alpha)<1}doOnChange(){const{_hue:t,_saturation:i,_value:a,_alpha:d,format:p}=this;if(this.enableAlpha)switch(p){case"hsl":{const _=bR(t,i/100,a/100);this.value=`hsla(${t}, ${Math.round(_[1]*100)}%, ${Math.round(_[2]*100)}%, ${this.get("alpha")/100})`;break}case"hsv":{this.value=`hsva(${t}, ${Math.round(i)}%, ${Math.round(a)}%, ${this.get("alpha")/100})`;break}case"hex":{this.value=`${wR(c_(t,i,a))}${Kb(d*255/100)}`;break}default:{const{r:_,g:r,b:S}=c_(t,i,a);this.value=`rgba(${_}, ${r}, ${S}, ${this.get("alpha")/100})`}}else switch(p){case"hsl":{const _=bR(t,i/100,a/100);this.value=`hsl(${t}, ${Math.round(_[1]*100)}%, ${Math.round(_[2]*100)}%)`;break}case"hsv":{this.value=`hsv(${t}, ${Math.round(i)}%, ${Math.round(a)}%)`;break}case"rgb":{const{r:_,g:r,b:S}=c_(t,i,a);this.value=`rgb(${_}, ${r}, ${S})`;break}default:this.value=wR(c_(t,i,a))}}}const Mee=qe({props:{colors:{type:Array,required:!0},color:{type:Object,required:!0},enableAlpha:{type:Boolean,required:!0}},setup(e){const t=en("color-predefine"),{currentColor:i}=An(BF),a=Se(p(e.colors,e.color));qt(()=>i.value,_=>{const r=new k_;r.fromString(_),a.value.forEach(S=>{S.selected=r.compare(S)})}),Cs(()=>{a.value=p(e.colors,e.color)});function d(_){e.color.fromString(e.colors[_])}function p(_,r){return _.map(S=>{const C=new k_;return C.enableAlpha=e.enableAlpha,C.format="rgba",C.fromString(S),C.selected=C.value===r.value,C})}return{rgbaColors:a,handleSelect:d,ns:t}}});function Iee(e,t,i,a,d,p){return ae(),Oe("div",{class:pe(e.ns.b())},[Ue("div",{class:pe(e.ns.e("colors"))},[(ae(!0),Oe(Bn,null,Or(e.rgbaColors,(_,r)=>(ae(),Oe("div",{key:e.colors[r],class:pe([e.ns.e("color-selector"),e.ns.is("alpha",_._alpha<100),{selected:_.selected}]),onClick:S=>e.handleSelect(r)},[Ue("div",{style:$n({backgroundColor:_.value})},null,4)],10,["onClick"]))),128))],2)],2)}var Aee=fn(Mee,[["render",Iee],["__file","predefine.vue"]]);const kee=qe({name:"ElSlPanel",props:{color:{type:Object,required:!0}},setup(e){const t=en("color-svpanel"),i=wr(),a=Se(0),d=Se(0),p=Se("hsl(0, 100%, 50%)"),_=ee(()=>{const C=e.color.get("hue"),M=e.color.get("value");return{hue:C,value:M}});function r(){const C=e.color.get("saturation"),M=e.color.get("value"),k=i.vnode.el,{clientWidth:z,clientHeight:F}=k;d.value=C*z/100,a.value=(100-M)*F/100,p.value=`hsl(${e.color.get("hue")}, 100%, 50%)`}function S(C){const k=i.vnode.el.getBoundingClientRect(),{clientX:z,clientY:F}=wE(C);let B=z-k.left,N=F-k.top;B=Math.max(0,B),B=Math.min(B,k.width),N=Math.max(0,N),N=Math.min(N,k.height),d.value=B,a.value=N,e.color.set({saturation:B/k.width*100,value:100-N/k.height*100})}return qt(()=>_.value,()=>{r()}),gr(()=>{X_(i.vnode.el,{drag:C=>{S(C)},end:C=>{S(C)}}),r()}),{cursorTop:a,cursorLeft:d,background:p,colorValue:_,handleDrag:S,update:r,ns:t}}});function Pee(e,t,i,a,d,p){return ae(),Oe("div",{class:pe(e.ns.b()),style:$n({backgroundColor:e.background})},[Ue("div",{class:pe(e.ns.e("white"))},null,2),Ue("div",{class:pe(e.ns.e("black"))},null,2),Ue("div",{class:pe(e.ns.e("cursor")),style:$n({top:e.cursorTop+"px",left:e.cursorLeft+"px"})},[Ue("div")],6)],6)}var Ree=fn(kee,[["render",Pee],["__file","sv-panel.vue"]]);const Oee=qe({name:"ElColorPicker"}),Lee=qe({...Oee,props:wee,emits:See,setup(e,{expose:t,emit:i}){const a=e,{t:d}=Gr(),p=en("color"),{formItem:_}=As(),r=Li(),S=ks(),{inputId:C,isLabeledByFormItem:M}=Al(a,{formItemContext:_}),k=Se(),z=Se(),F=Se(),B=Se(),N=Se(),j=Se(),{isFocused:U,handleFocus:te,handleBlur:Y}=rh(N,{beforeFocus(){return S.value},beforeBlur(Wt){var Fe;return(Fe=B.value)==null?void 0:Fe.isFocusInsideContent(Wt)},afterBlur(){we(!1),me()}});let q=!0;const J=lo(new k_({enableAlpha:a.showAlpha,format:a.colorFormat||"",value:a.modelValue})),ne=Se(!1),se=Se(!1),fe=Se(""),ce=ee(()=>!a.modelValue&&!se.value?"transparent":We(J,a.showAlpha)),le=ee(()=>!a.modelValue&&!se.value?"":J.value),ge=ee(()=>M.value?void 0:a.ariaLabel||d("el.colorpicker.defaultLabel")),de=ee(()=>M.value?_==null?void 0:_.labelId:void 0),ke=ee(()=>[p.b("picker"),p.is("disabled",S.value),p.bm("picker",r.value),p.is("focused",U.value)]);function We(Wt,Fe){if(!(Wt instanceof k_))throw new TypeError("color should be instance of _color Class");const{r:cn,g:Re,b:nt}=Wt.toRgb();return Fe?`rgba(${cn}, ${Re}, ${nt}, ${Wt.get("alpha")/100})`:`rgb(${cn}, ${Re}, ${nt})`}function we(Wt){ne.value=Wt}const be=Ra(we,100,{leading:!0});function Me(){S.value||we(!0)}function Ae(){be(!1),me()}function me(){Vn(()=>{a.modelValue?J.fromString(a.modelValue):(J.value="",Vn(()=>{se.value=!1}))})}function Be(){S.value||(ne.value&&me(),be(!ne.value))}function Ve(){J.fromString(fe.value)}function bt(){const Wt=J.value;i(mr,Wt),i("change",Wt),a.validateEvent&&(_==null||_.validate("change").catch(Fe=>void 0)),be(!1),Vn(()=>{const Fe=new k_({enableAlpha:a.showAlpha,format:a.colorFormat||"",value:a.modelValue});J.compare(Fe)||me()})}function Pe(){be(!1),i(mr,null),i("change",null),a.modelValue!==null&&a.validateEvent&&(_==null||_.validate("change").catch(Wt=>void 0)),me()}function wt(){ne.value&&(Ae(),U.value&&vt())}function Mt(Wt){Wt.preventDefault(),Wt.stopPropagation(),we(!1),me()}function Nt(Wt){switch(Wt.code){case En.enter:case En.numpadEnter:case En.space:Wt.preventDefault(),Wt.stopPropagation(),Me(),j.value.focus();break;case En.esc:Mt(Wt);break}}function vt(){N.value.focus()}function Bt(){N.value.blur()}return gr(()=>{a.modelValue&&(fe.value=le.value)}),qt(()=>a.modelValue,Wt=>{Wt?Wt&&Wt!==J.value&&(q=!1,J.fromString(Wt)):se.value=!1}),qt(()=>[a.colorFormat,a.showAlpha],()=>{J.enableAlpha=a.showAlpha,J.format=a.colorFormat||J.format,J.doOnChange(),i(mr,J.value)}),qt(()=>le.value,Wt=>{fe.value=Wt,q&&i("activeChange",Wt),q=!0}),qt(()=>J.value,()=>{!a.modelValue&&!se.value&&(se.value=!0)}),qt(()=>ne.value,()=>{Vn(()=>{var Wt,Fe,cn;(Wt=k.value)==null||Wt.update(),(Fe=z.value)==null||Fe.update(),(cn=F.value)==null||cn.update()})}),Dr(BF,{currentColor:le}),t({color:J,show:Me,hide:Ae,focus:vt,blur:Bt}),(Wt,Fe)=>(ae(),kt(b(Is),{ref_key:"popper",ref:B,visible:ne.value,"show-arrow":!1,"fallback-placements":["bottom","top","right","left"],offset:0,"gpu-acceleration":!1,"popper-class":[b(p).be("picker","panel"),b(p).b("dropdown"),Wt.popperClass],"stop-popper-mouse-event":!1,effect:"light",trigger:"click",teleported:Wt.teleported,transition:`${b(p).namespace.value}-zoom-in-top`,persistent:"",onHide:cn=>we(!1)},{content:st(()=>[hr((ae(),Oe("div",{onKeydown:Po(Mt,["esc"])},[Ue("div",{class:pe(b(p).be("dropdown","main-wrapper"))},[Ze(xee,{ref_key:"hue",ref:k,class:"hue-slider",color:b(J),vertical:""},null,8,["color"]),Ze(Ree,{ref_key:"sv",ref:z,color:b(J)},null,8,["color"])],2),Wt.showAlpha?(ae(),kt(_ee,{key:0,ref_key:"alpha",ref:F,color:b(J)},null,8,["color"])):yt("v-if",!0),Wt.predefine?(ae(),kt(Aee,{key:1,ref:"predefine","enable-alpha":Wt.showAlpha,color:b(J),colors:Wt.predefine},null,8,["enable-alpha","color","colors"])):yt("v-if",!0),Ue("div",{class:pe(b(p).be("dropdown","btns"))},[Ue("span",{class:pe(b(p).be("dropdown","value"))},[Ze(b(Us),{ref_key:"inputRef",ref:j,modelValue:fe.value,"onUpdate:modelValue":cn=>fe.value=cn,"validate-event":!1,size:"small",onKeyup:Po(Ve,["enter"]),onBlur:Ve},null,8,["modelValue","onUpdate:modelValue","onKeyup"])],2),Ze(b(ss),{class:pe(b(p).be("dropdown","link-btn")),text:"",size:"small",onClick:Pe},{default:st(()=>[Rr(pn(b(d)("el.colorpicker.clear")),1)]),_:1},8,["class"]),Ze(b(ss),{plain:"",size:"small",class:pe(b(p).be("dropdown","btn")),onClick:bt},{default:st(()=>[Rr(pn(b(d)("el.colorpicker.confirm")),1)]),_:1},8,["class"])],2)],40,["onKeydown"])),[[b(Bu),wt,N.value]])]),default:st(()=>[Ue("div",Mr({id:b(C),ref_key:"triggerRef",ref:N},Wt.$attrs,{class:b(ke),role:"button","aria-label":b(ge),"aria-labelledby":b(de),"aria-description":b(d)("el.colorpicker.description",{color:Wt.modelValue||""}),"aria-disabled":b(S),tabindex:b(S)?-1:Wt.tabindex,onKeydown:Nt,onFocus:b(te),onBlur:b(Y)}),[b(S)?(ae(),Oe("div",{key:0,class:pe(b(p).be("picker","mask"))},null,2)):yt("v-if",!0),Ue("div",{class:pe(b(p).be("picker","trigger")),onClick:Be},[Ue("span",{class:pe([b(p).be("picker","color"),b(p).is("alpha",Wt.showAlpha)])},[Ue("span",{class:pe(b(p).be("picker","color-inner")),style:$n({backgroundColor:b(ce)})},[hr(Ze(b(On),{class:pe([b(p).be("picker","icon"),b(p).is("icon-arrow-down")])},{default:st(()=>[Ze(b(Gu))]),_:1},8,["class"]),[[no,Wt.modelValue||se.value]]),hr(Ze(b(On),{class:pe([b(p).be("picker","empty"),b(p).is("icon-close")])},{default:st(()=>[Ze(b(sc))]),_:1},8,["class"]),[[no,!Wt.modelValue&&!se.value]])],6)],2)],2)],16,["id","aria-label","aria-labelledby","aria-description","aria-disabled","tabindex","onFocus","onBlur"])]),_:1},8,["visible","popper-class","teleported","transition","onHide"]))}});var Dee=fn(Lee,[["__file","color-picker.vue"]]);const zee=ur(Dee),Fee=un({a11y:{type:Boolean,default:!0},locale:{type:dt(Object)},size:zi,button:{type:dt(Object)},experimentalFeatures:{type:dt(Object)},keyboardNavigation:{type:Boolean,default:!0},message:{type:dt(Object)},zIndex:Number,namespace:{type:String,default:"el"},...Qm}),Yl={},Nee=qe({name:"ElConfigProvider",props:Fee,setup(e,{slots:t}){qt(()=>e.message,a=>{Object.assign(Yl,a??{})},{immediate:!0,deep:!0});const i=ZC(e);return()=>pt(t,"default",{config:i==null?void 0:i.value})}}),Bee=ur(Nee),Vee=qe({name:"ElContainer"}),$ee=qe({...Vee,props:{direction:{type:String}},setup(e){const t=e,i=Hi(),a=en("container"),d=ee(()=>t.direction==="vertical"?!0:t.direction==="horizontal"?!1:i&&i.default?i.default().some(_=>{const r=_.type.name;return r==="ElHeader"||r==="ElFooter"}):!1);return(p,_)=>(ae(),Oe("section",{class:pe([b(a).b(),b(a).is("vertical",b(d))])},[pt(p.$slots,"default")],2))}});var Uee=fn($ee,[["__file","container.vue"]]);const jee=qe({name:"ElAside"}),Hee=qe({...jee,props:{width:{type:String,default:null}},setup(e){const t=e,i=en("aside"),a=ee(()=>t.width?i.cssVarBlock({width:t.width}):{});return(d,p)=>(ae(),Oe("aside",{class:pe(b(i).b()),style:$n(b(a))},[pt(d.$slots,"default")],6))}});var VF=fn(Hee,[["__file","aside.vue"]]);const Gee=qe({name:"ElFooter"}),Wee=qe({...Gee,props:{height:{type:String,default:null}},setup(e){const t=e,i=en("footer"),a=ee(()=>t.height?i.cssVarBlock({height:t.height}):{});return(d,p)=>(ae(),Oe("footer",{class:pe(b(i).b()),style:$n(b(a))},[pt(d.$slots,"default")],6))}});var $F=fn(Wee,[["__file","footer.vue"]]);const qee=qe({name:"ElHeader"}),Kee=qe({...qee,props:{height:{type:String,default:null}},setup(e){const t=e,i=en("header"),a=ee(()=>t.height?i.cssVarBlock({height:t.height}):{});return(d,p)=>(ae(),Oe("header",{class:pe(b(i).b()),style:$n(b(a))},[pt(d.$slots,"default")],6))}});var UF=fn(Kee,[["__file","header.vue"]]);const Zee=qe({name:"ElMain"}),Yee=qe({...Zee,setup(e){const t=en("main");return(i,a)=>(ae(),Oe("main",{class:pe(b(t).b())},[pt(i.$slots,"default")],2))}});var jF=fn(Yee,[["__file","main.vue"]]);const Xee=ur(Uee,{Aside:VF,Footer:$F,Header:UF,Main:jF}),Jee=ri(VF),Qee=ri($F),ete=ri(UF),tte=ri(jF);var HF={exports:{}};(function(e,t){(function(i,a){e.exports=a()})(Xc,function(){var i={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},a=/(\[[^[]*\])|([-_:/.,()\s]+)|(A|a|Q|YYYY|YY?|ww?|MM?M?M?|Do|DD?|hh?|HH?|mm?|ss?|S{1,3}|z|ZZ?)/g,d=/\d/,p=/\d\d/,_=/\d\d?/,r=/\d*[^-_:/,()\s\d]+/,S={},C=function(j){return(j=+j)+(j>68?1900:2e3)},M=function(j){return function(U){this[j]=+U}},k=[/[+-]\d\d:?(\d\d)?|Z/,function(j){(this.zone||(this.zone={})).offset=function(U){if(!U||U==="Z")return 0;var te=U.match(/([+-]|\d\d)/g),Y=60*te[1]+(+te[2]||0);return Y===0?0:te[0]==="+"?-Y:Y}(j)}],z=function(j){var U=S[j];return U&&(U.indexOf?U:U.s.concat(U.f))},F=function(j,U){var te,Y=S.meridiem;if(Y){for(var q=1;q<=24;q+=1)if(j.indexOf(Y(q,0,U))>-1){te=q>12;break}}else te=j===(U?"pm":"PM");return te},B={A:[r,function(j){this.afternoon=F(j,!1)}],a:[r,function(j){this.afternoon=F(j,!0)}],Q:[d,function(j){this.month=3*(j-1)+1}],S:[d,function(j){this.milliseconds=100*+j}],SS:[p,function(j){this.milliseconds=10*+j}],SSS:[/\d{3}/,function(j){this.milliseconds=+j}],s:[_,M("seconds")],ss:[_,M("seconds")],m:[_,M("minutes")],mm:[_,M("minutes")],H:[_,M("hours")],h:[_,M("hours")],HH:[_,M("hours")],hh:[_,M("hours")],D:[_,M("day")],DD:[p,M("day")],Do:[r,function(j){var U=S.ordinal,te=j.match(/\d+/);if(this.day=te[0],U)for(var Y=1;Y<=31;Y+=1)U(Y).replace(/\[|\]/g,"")===j&&(this.day=Y)}],w:[_,M("week")],ww:[p,M("week")],M:[_,M("month")],MM:[p,M("month")],MMM:[r,function(j){var U=z("months"),te=(z("monthsShort")||U.map(function(Y){return Y.slice(0,3)})).indexOf(j)+1;if(te<1)throw new Error;this.month=te%12||te}],MMMM:[r,function(j){var U=z("months").indexOf(j)+1;if(U<1)throw new Error;this.month=U%12||U}],Y:[/[+-]?\d+/,M("year")],YY:[p,function(j){this.year=C(j)}],YYYY:[/\d{4}/,M("year")],Z:k,ZZ:k};function N(j){var U,te;U=j,te=S&&S.formats;for(var Y=(j=U.replace(/(\[[^\]]+])|(LTS?|l{1,4}|L{1,4})/g,function(le,ge,de){var ke=de&&de.toUpperCase();return ge||te[de]||i[de]||te[ke].replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,function(We,we,be){return we||be.slice(1)})})).match(a),q=Y.length,J=0;J<q;J+=1){var ne=Y[J],se=B[ne],fe=se&&se[0],ce=se&&se[1];Y[J]=ce?{regex:fe,parser:ce}:ne.replace(/^\[|\]$/g,"")}return function(le){for(var ge={},de=0,ke=0;de<q;de+=1){var We=Y[de];if(typeof We=="string")ke+=We.length;else{var we=We.regex,be=We.parser,Me=le.slice(ke),Ae=we.exec(Me)[0];be.call(ge,Ae),le=le.replace(Ae,"")}}return function(me){var Be=me.afternoon;if(Be!==void 0){var Ve=me.hours;Be?Ve<12&&(me.hours+=12):Ve===12&&(me.hours=0),delete me.afternoon}}(ge),ge}}return function(j,U,te){te.p.customParseFormat=!0,j&&j.parseTwoDigitYear&&(C=j.parseTwoDigitYear);var Y=U.prototype,q=Y.parse;Y.parse=function(J){var ne=J.date,se=J.utc,fe=J.args;this.$u=se;var ce=fe[1];if(typeof ce=="string"){var le=fe[2]===!0,ge=fe[3]===!0,de=le||ge,ke=fe[2];ge&&(ke=fe[2]),S=this.$locale(),!le&&ke&&(S=te.Ls[ke]),this.$d=function(Me,Ae,me,Be){try{if(["x","X"].indexOf(Ae)>-1)return new Date((Ae==="X"?1e3:1)*Me);var Ve=N(Ae)(Me),bt=Ve.year,Pe=Ve.month,wt=Ve.day,Mt=Ve.hours,Nt=Ve.minutes,vt=Ve.seconds,Bt=Ve.milliseconds,Wt=Ve.zone,Fe=Ve.week,cn=new Date,Re=wt||(bt||Pe?1:cn.getDate()),nt=bt||cn.getFullYear(),Qe=0;bt&&!Pe||(Qe=Pe>0?Pe-1:cn.getMonth());var Yt,Xt=Mt||0,$t=Nt||0,Ot=vt||0,Ft=Bt||0;return Wt?new Date(Date.UTC(nt,Qe,Re,Xt,$t,Ot,Ft+60*Wt.offset*1e3)):me?new Date(Date.UTC(nt,Qe,Re,Xt,$t,Ot,Ft)):(Yt=new Date(nt,Qe,Re,Xt,$t,Ot,Ft),Fe&&(Yt=Be(Yt).week(Fe).toDate()),Yt)}catch{return new Date("")}}(ne,ce,se,te),this.init(),ke&&ke!==!0&&(this.$L=this.locale(ke).$L),de&&ne!=this.format(ce)&&(this.$d=new Date("")),S={}}else if(ce instanceof Array)for(var We=ce.length,we=1;we<=We;we+=1){fe[1]=ce[we-1];var be=te.apply(this,fe);if(be.isValid()){this.$d=be.$d,this.$L=be.$L,this.init();break}we===We&&(this.$d=new Date(""))}else q.call(this,J)}}})})(HF);var nte=HF.exports;const SE=Xa(nte);var GF={exports:{}};(function(e,t){(function(i,a){e.exports=a()})(Xc,function(){return function(i,a){var d=a.prototype,p=d.format;d.format=function(_){var r=this,S=this.$locale();if(!this.isValid())return p.bind(this)(_);var C=this.$utils(),M=(_||"YYYY-MM-DDTHH:mm:ssZ").replace(/\[([^\]]+)]|Q|wo|ww|w|WW|W|zzz|z|gggg|GGGG|Do|X|x|k{1,2}|S/g,function(k){switch(k){case"Q":return Math.ceil((r.$M+1)/3);case"Do":return S.ordinal(r.$D);case"gggg":return r.weekYear();case"GGGG":return r.isoWeekYear();case"wo":return S.ordinal(r.week(),"W");case"w":case"ww":return C.s(r.week(),k==="w"?1:2,"0");case"W":case"WW":return C.s(r.isoWeek(),k==="W"?1:2,"0");case"k":case"kk":return C.s(String(r.$H===0?24:r.$H),k==="k"?1:2,"0");case"X":return Math.floor(r.$d.getTime()/1e3);case"x":return r.$d.getTime();case"z":return"["+r.offsetName()+"]";case"zzz":return"["+r.offsetName("long")+"]";default:return k}});return p.bind(this)(M)}}})})(GF);var rte=GF.exports;const ote=Xa(rte);var WF={exports:{}};(function(e,t){(function(i,a){e.exports=a()})(Xc,function(){var i="week",a="year";return function(d,p,_){var r=p.prototype;r.week=function(S){if(S===void 0&&(S=null),S!==null)return this.add(7*(S-this.week()),"day");var C=this.$locale().yearStart||1;if(this.month()===11&&this.date()>25){var M=_(this).startOf(a).add(1,a).date(C),k=_(this).endOf(i);if(M.isBefore(k))return 1}var z=_(this).startOf(a).date(C).startOf(i).subtract(1,"millisecond"),F=this.diff(z,i,!0);return F<0?_(this).startOf("week").week():Math.ceil(F)},r.weeks=function(S){return S===void 0&&(S=null),this.week(S)}}})})(WF);var ite=WF.exports;const ste=Xa(ite);var qF={exports:{}};(function(e,t){(function(i,a){e.exports=a()})(Xc,function(){return function(i,a){a.prototype.weekYear=function(){var d=this.month(),p=this.week(),_=this.year();return p===1&&d===11?_+1:d===0&&p>=52?_-1:_}}})})(qF);var ate=qF.exports;const lte=Xa(ate);var KF={exports:{}};(function(e,t){(function(i,a){e.exports=a()})(Xc,function(){return function(i,a,d){a.prototype.dayOfYear=function(p){var _=Math.round((d(this).startOf("day")-d(this).startOf("year"))/864e5)+1;return p==null?_:this.add(p-_,"day")}}})})(KF);var cte=KF.exports;const ute=Xa(cte);var ZF={exports:{}};(function(e,t){(function(i,a){e.exports=a()})(Xc,function(){return function(i,a){a.prototype.isSameOrAfter=function(d,p){return this.isSame(d,p)||this.isAfter(d,p)}}})})(ZF);var dte=ZF.exports;const hte=Xa(dte);var YF={exports:{}};(function(e,t){(function(i,a){e.exports=a()})(Xc,function(){return function(i,a){a.prototype.isSameOrBefore=function(d,p){return this.isSame(d,p)||this.isBefore(d,p)}}})})(YF);var fte=YF.exports;const pte=Xa(fte),TR=["hours","minutes","seconds"],cT="HH:mm:ss",am="YYYY-MM-DD",mte={date:am,dates:am,week:"gggg[w]ww",year:"YYYY",years:"YYYY",month:"YYYY-MM",months:"YYYY-MM",datetime:`${am} ${cT}`,monthrange:"YYYY-MM",yearrange:"YYYY",daterange:am,datetimerange:`${am} ${cT}`},XF=un({disabledHours:{type:dt(Function)},disabledMinutes:{type:dt(Function)},disabledSeconds:{type:dt(Function)}}),JF=un({visible:Boolean,actualVisible:{type:Boolean,default:void 0},format:{type:String,default:""}}),TE=un({id:{type:dt([Array,String])},name:{type:dt([Array,String])},popperClass:{type:String,default:""},format:String,valueFormat:String,dateFormat:String,timeFormat:String,type:{type:String,default:""},clearable:{type:Boolean,default:!0},clearIcon:{type:dt([String,Object]),default:Wu},editable:{type:Boolean,default:!0},prefixIcon:{type:dt([String,Object]),default:""},size:zi,readonly:Boolean,disabled:Boolean,placeholder:{type:String,default:""},popperOptions:{type:dt(Object),default:()=>({})},modelValue:{type:dt([Date,Array,String,Number]),default:""},rangeSeparator:{type:String,default:"-"},startPlaceholder:String,endPlaceholder:String,defaultValue:{type:dt([Date,Array])},defaultTime:{type:dt([Date,Array])},isRange:Boolean,...XF,disabledDate:{type:Function},cellClassName:{type:Function},shortcuts:{type:Array,default:()=>[]},arrowControl:Boolean,tabindex:{type:dt([String,Number]),default:0},validateEvent:{type:Boolean,default:!0},unlinkPanels:Boolean,placement:{type:dt(String),values:qu,default:"bottom"},fallbackPlacements:{type:dt(Array),default:["bottom","top","right","left"]},...Qm,..._s(["ariaLabel"]),showNow:{type:Boolean,default:!0}}),gte=un({id:{type:dt(Array)},name:{type:dt(Array)},modelValue:{type:dt([Array,String])},startPlaceholder:String,endPlaceholder:String}),vte=qe({name:"PickerRangeTrigger",inheritAttrs:!1}),_te=qe({...vte,props:gte,emits:["mouseenter","mouseleave","click","touchstart","focus","blur","startInput","endInput","startChange","endChange"],setup(e,{expose:t,emit:i}){const a=wy(),d=en("date"),p=en("range"),_=Se(),r=Se(),{wrapperRef:S,isFocused:C}=rh(_),M=q=>{i("click",q)},k=q=>{i("mouseenter",q)},z=q=>{i("mouseleave",q)},F=q=>{i("mouseenter",q)},B=q=>{i("startInput",q)},N=q=>{i("endInput",q)},j=q=>{i("startChange",q)},U=q=>{i("endChange",q)};return t({focus:()=>{var q;(q=_.value)==null||q.focus()},blur:()=>{var q,J;(q=_.value)==null||q.blur(),(J=r.value)==null||J.blur()}}),(q,J)=>(ae(),Oe("div",{ref_key:"wrapperRef",ref:S,class:pe([b(d).is("active",b(C)),q.$attrs.class]),style:$n(q.$attrs.style),onClick:M,onMouseenter:k,onMouseleave:z,onTouchstartPassive:F},[pt(q.$slots,"prefix"),Ue("input",Mr(b(a),{id:q.id&&q.id[0],ref_key:"inputRef",ref:_,name:q.name&&q.name[0],placeholder:q.startPlaceholder,value:q.modelValue&&q.modelValue[0],class:b(p).b("input"),onInput:B,onChange:j}),null,16,["id","name","placeholder","value"]),pt(q.$slots,"range-separator"),Ue("input",Mr(b(a),{id:q.id&&q.id[1],ref_key:"endInputRef",ref:r,name:q.name&&q.name[1],placeholder:q.endPlaceholder,value:q.modelValue&&q.modelValue[1],class:b(p).b("input"),onInput:N,onChange:U}),null,16,["id","name","placeholder","value"]),pt(q.$slots,"suffix")],38))}});var yte=fn(_te,[["__file","picker-range-trigger.vue"]]);const bte=qe({name:"Picker"}),xte=qe({...bte,props:TE,emits:["update:modelValue","change","focus","blur","clear","calendar-change","panel-change","visible-change","keydown"],setup(e,{expose:t,emit:i}){const a=e,d=Uu(),{lang:p}=Gr(),_=en("date"),r=en("input"),S=en("range"),{form:C,formItem:M}=As(),k=An("ElPopperOptions",{}),{valueOnClear:z}=dx(a,null),F=Se(),B=Se(),N=Se(!1),j=Se(!1),U=Se(null);let te=!1;const{isFocused:Y,handleFocus:q,handleBlur:J}=rh(B,{beforeFocus(){return a.readonly||me.value},afterFocus(){N.value=!0},beforeBlur(tt){var yn;return!te&&((yn=F.value)==null?void 0:yn.isFocusInsideContent(tt))},afterBlur(){sn(),N.value=!1,te=!1,a.validateEvent&&(M==null||M.validate("blur").catch(tt=>void 0))}}),ne=ee(()=>[_.b("editor"),_.bm("editor",a.type),r.e("wrapper"),_.is("disabled",me.value),_.is("active",N.value),S.b("editor"),Xt?S.bm("editor",Xt.value):"",d.class]),se=ee(()=>[r.e("icon"),S.e("close-icon"),Bt.value?"":S.e("close-icon--hidden")]);qt(N,tt=>{tt?Vn(()=>{tt&&(U.value=a.modelValue)}):(Ft.value=null,Vn(()=>{fe(a.modelValue)}))});const fe=(tt,yn)=>{(yn||!cR(tt,U.value))&&(i("change",tt),a.validateEvent&&(M==null||M.validate("change").catch(wn=>void 0)))},ce=tt=>{if(!cR(a.modelValue,tt)){let yn;ln(tt)?yn=tt.map(wn=>dR(wn,a.valueFormat,p.value)):tt&&(yn=dR(tt,a.valueFormat,p.value)),i("update:modelValue",tt&&yn,p.value)}},le=tt=>{i("keydown",tt)},ge=ee(()=>B.value?Array.from(B.value.$el.querySelectorAll("input")):[]),de=(tt,yn,wn)=>{const sr=ge.value;sr.length&&(!wn||wn==="min"?(sr[0].setSelectionRange(tt,yn),sr[0].focus()):wn==="max"&&(sr[1].setSelectionRange(tt,yn),sr[1].focus()))},ke=(tt="",yn=!1)=>{N.value=yn;let wn;ln(tt)?wn=tt.map(sr=>sr.toDate()):wn=tt&&tt.toDate(),Ft.value=null,ce(wn)},We=()=>{j.value=!0},we=()=>{i("visible-change",!0)},be=()=>{j.value=!1,N.value=!1,i("visible-change",!1)},Me=()=>{N.value=!0},Ae=()=>{N.value=!1},me=ee(()=>a.disabled||(C==null?void 0:C.disabled)),Be=ee(()=>{let tt;if(Fe.value?Cr.value.getDefaultValue&&(tt=Cr.value.getDefaultValue()):ln(a.modelValue)?tt=a.modelValue.map(yn=>uR(yn,a.valueFormat,p.value)):tt=uR(a.modelValue,a.valueFormat,p.value),Cr.value.getRangeAvailableTime){const yn=Cr.value.getRangeAvailableTime(tt);ms(yn,tt)||(tt=yn,Fe.value||ce(Ab(tt)))}return ln(tt)&&tt.some(yn=>!yn)&&(tt=[]),tt}),Ve=ee(()=>{if(!Cr.value.panelReady)return"";const tt=Pn(Be.value);return ln(Ft.value)?[Ft.value[0]||tt&&tt[0]||"",Ft.value[1]||tt&&tt[1]||""]:Ft.value!==null?Ft.value:!Pe.value&&Fe.value||!N.value&&Fe.value?"":tt?wt.value||Mt.value||Nt.value?tt.join(", "):tt:""}),bt=ee(()=>a.type.includes("time")),Pe=ee(()=>a.type.startsWith("time")),wt=ee(()=>a.type==="dates"),Mt=ee(()=>a.type==="months"),Nt=ee(()=>a.type==="years"),vt=ee(()=>a.prefixIcon||(bt.value?Iz:Z9)),Bt=Se(!1),Wt=tt=>{a.readonly||me.value||(Bt.value&&(tt.stopPropagation(),Cr.value.handleClear?Cr.value.handleClear():ce(z.value),fe(z.value,!0),Bt.value=!1,be()),i("clear"))},Fe=ee(()=>{const{modelValue:tt}=a;return!tt||ln(tt)&&!tt.filter(Boolean).length}),cn=async tt=>{var yn;a.readonly||me.value||(((yn=tt.target)==null?void 0:yn.tagName)!=="INPUT"||Y.value)&&(N.value=!0)},Re=()=>{a.readonly||me.value||!Fe.value&&a.clearable&&(Bt.value=!0)},nt=()=>{Bt.value=!1},Qe=tt=>{var yn;a.readonly||me.value||(((yn=tt.touches[0].target)==null?void 0:yn.tagName)!=="INPUT"||Y.value)&&(N.value=!0)},Yt=ee(()=>a.type.includes("range")),Xt=Li(),$t=ee(()=>{var tt,yn;return(yn=(tt=b(F))==null?void 0:tt.popperRef)==null?void 0:yn.contentRef}),Ot=KC(B,tt=>{const yn=b($t),wn=aa(B);yn&&(tt.target===yn||tt.composedPath().includes(yn))||tt.target===wn||wn&&tt.composedPath().includes(wn)||(N.value=!1)});Oo(()=>{Ot==null||Ot()});const Ft=Se(null),sn=()=>{if(Ft.value){const tt=an(Ve.value);tt&&bn(tt)&&(ce(Ab(tt)),Ft.value=null)}Ft.value===""&&(ce(z.value),fe(z.value),Ft.value=null)},an=tt=>tt?Cr.value.parseUserInput(tt):null,Pn=tt=>tt?Cr.value.formatToString(tt):null,bn=tt=>Cr.value.isValidValue(tt),It=async tt=>{if(a.readonly||me.value)return;const{code:yn}=tt;if(le(tt),yn===En.esc){N.value===!0&&(N.value=!1,tt.preventDefault(),tt.stopPropagation());return}if(yn===En.down&&(Cr.value.handleFocusPicker&&(tt.preventDefault(),tt.stopPropagation()),N.value===!1&&(N.value=!0,await Vn()),Cr.value.handleFocusPicker)){Cr.value.handleFocusPicker();return}if(yn===En.tab){te=!0;return}if(yn===En.enter||yn===En.numpadEnter){(Ft.value===null||Ft.value===""||bn(an(Ve.value)))&&(sn(),N.value=!1),tt.stopPropagation();return}if(Ft.value){tt.stopPropagation();return}Cr.value.handleKeydownInput&&Cr.value.handleKeydownInput(tt)},Sn=tt=>{Ft.value=tt,N.value||(N.value=!0)},Yn=tt=>{const yn=tt.target;Ft.value?Ft.value=[yn.value,Ft.value[1]]:Ft.value=[yn.value,null]},vr=tt=>{const yn=tt.target;Ft.value?Ft.value=[Ft.value[0],yn.value]:Ft.value=[null,yn.value]},tr=()=>{var tt;const yn=Ft.value,wn=an(yn&&yn[0]),sr=b(Be);if(wn&&wn.isValid()){Ft.value=[Pn(wn),((tt=Ve.value)==null?void 0:tt[1])||null];const vo=[wn,sr&&(sr[1]||null)];bn(vo)&&(ce(Ab(vo)),Ft.value=null)}},zr=()=>{var tt;const yn=b(Ft),wn=an(yn&&yn[1]),sr=b(Be);if(wn&&wn.isValid()){Ft.value=[((tt=b(Ve))==null?void 0:tt[0])||null,Pn(wn)];const vo=[sr&&sr[0],wn];bn(vo)&&(ce(Ab(vo)),Ft.value=null)}},Cr=Se({}),Io=tt=>{Cr.value[tt[0]]=tt[1],Cr.value.panelReady=!0},jn=tt=>{i("calendar-change",tt)},Gt=(tt,yn,wn)=>{i("panel-change",tt,yn,wn)},ct=()=>{var tt;(tt=B.value)==null||tt.focus()},Ut=()=>{var tt;(tt=B.value)==null||tt.blur()};return Dr("EP_PICKER_BASE",{props:a}),t({focus:ct,blur:Ut,handleOpen:Me,handleClose:Ae,onPick:ke}),(tt,yn)=>(ae(),kt(b(Is),Mr({ref_key:"refPopper",ref:F,visible:N.value,effect:"light",pure:"",trigger:"click"},tt.$attrs,{role:"dialog",teleported:"",transition:`${b(_).namespace.value}-zoom-in-top`,"popper-class":[`${b(_).namespace.value}-picker__popper`,tt.popperClass],"popper-options":b(k),"fallback-placements":tt.fallbackPlacements,"gpu-acceleration":!1,placement:tt.placement,"stop-popper-mouse-event":!1,"hide-after":0,persistent:"",onBeforeShow:We,onShow:we,onHide:be}),{default:st(()=>[b(Yt)?(ae(),kt(yte,{key:1,id:tt.id,ref_key:"inputRef",ref:B,"model-value":b(Ve),name:tt.name,disabled:b(me),readonly:!tt.editable||tt.readonly,"start-placeholder":tt.startPlaceholder,"end-placeholder":tt.endPlaceholder,class:pe(b(ne)),style:$n(tt.$attrs.style),"aria-label":tt.ariaLabel,tabindex:tt.tabindex,autocomplete:"off",role:"combobox",onClick:cn,onFocus:b(q),onBlur:b(J),onStartInput:Yn,onStartChange:tr,onEndInput:vr,onEndChange:zr,onMousedown:cn,onMouseenter:Re,onMouseleave:nt,onTouchstartPassive:Qe,onKeydown:It},{prefix:st(()=>[b(vt)?(ae(),kt(b(On),{key:0,class:pe([b(r).e("icon"),b(S).e("icon")])},{default:st(()=>[(ae(),kt(Tr(b(vt))))]),_:1},8,["class"])):yt("v-if",!0)]),"range-separator":st(()=>[pt(tt.$slots,"range-separator",{},()=>[Ue("span",{class:pe(b(S).b("separator"))},pn(tt.rangeSeparator),3)])]),suffix:st(()=>[tt.clearIcon?(ae(),kt(b(On),{key:0,class:pe(b(se)),onMousedown:Qn(b(_o),["prevent"]),onClick:Wt},{default:st(()=>[(ae(),kt(Tr(tt.clearIcon)))]),_:1},8,["class","onMousedown"])):yt("v-if",!0)]),_:3},8,["id","model-value","name","disabled","readonly","start-placeholder","end-placeholder","class","style","aria-label","tabindex","onFocus","onBlur"])):(ae(),kt(b(Us),{key:0,id:tt.id,ref_key:"inputRef",ref:B,"container-role":"combobox","model-value":b(Ve),name:tt.name,size:b(Xt),disabled:b(me),placeholder:tt.placeholder,class:pe([b(_).b("editor"),b(_).bm("editor",tt.type),tt.$attrs.class]),style:$n(tt.$attrs.style),readonly:!tt.editable||tt.readonly||b(wt)||b(Mt)||b(Nt)||tt.type==="week","aria-label":tt.ariaLabel,tabindex:tt.tabindex,"validate-event":!1,onInput:Sn,onFocus:b(q),onBlur:b(J),onKeydown:It,onChange:sn,onMousedown:cn,onMouseenter:Re,onMouseleave:nt,onTouchstartPassive:Qe,onClick:Qn(()=>{},["stop"])},{prefix:st(()=>[b(vt)?(ae(),kt(b(On),{key:0,class:pe(b(r).e("icon")),onMousedown:Qn(cn,["prevent"]),onTouchstartPassive:Qe},{default:st(()=>[(ae(),kt(Tr(b(vt))))]),_:1},8,["class","onMousedown"])):yt("v-if",!0)]),suffix:st(()=>[Bt.value&&tt.clearIcon?(ae(),kt(b(On),{key:0,class:pe(`${b(r).e("icon")} clear-icon`),onMousedown:Qn(b(_o),["prevent"]),onClick:Wt},{default:st(()=>[(ae(),kt(Tr(tt.clearIcon)))]),_:1},8,["class","onMousedown"])):yt("v-if",!0)]),_:1},8,["id","model-value","name","size","disabled","placeholder","class","style","readonly","aria-label","tabindex","onFocus","onBlur","onClick"]))]),content:st(()=>[pt(tt.$slots,"default",{visible:N.value,actualVisible:j.value,parsedValue:b(Be),format:tt.format,dateFormat:tt.dateFormat,timeFormat:tt.timeFormat,unlinkPanels:tt.unlinkPanels,type:tt.type,defaultValue:tt.defaultValue,showNow:tt.showNow,onPick:ke,onSelectRange:de,onSetPickerOption:Io,onCalendarChange:jn,onPanelChange:Gt,onMousedown:Qn(()=>{},["stop"])})]),_:3},16,["visible","transition","popper-class","popper-options","fallback-placements","placement"]))}});var QF=fn(xte,[["__file","picker.vue"]]);const wte=un({...JF,datetimeRole:String,parsedValue:{type:dt(Object)}}),e4=({getAvailableHours:e,getAvailableMinutes:t,getAvailableSeconds:i})=>{const a=(_,r,S,C)=>{const M={hour:e,minute:t,second:i};let k=_;return["hour","minute","second"].forEach(z=>{if(M[z]){let F;const B=M[z];switch(z){case"minute":{F=B(k.hour(),r,C);break}case"second":{F=B(k.hour(),k.minute(),r,C);break}default:{F=B(r,C);break}}if(F!=null&&F.length&&!F.includes(k[z]())){const N=S?0:F.length-1;k=k[z](F[N])}}}),k},d={};return{timePickerOptions:d,getAvailableTime:a,onSetOption:([_,r])=>{d[_]=r}}},dS=e=>{const t=(a,d)=>a||d,i=a=>a!==!0;return e.map(t).filter(i)},t4=(e,t,i)=>({getHoursList:(_,r)=>aS(24,e&&(()=>e==null?void 0:e(_,r))),getMinutesList:(_,r,S)=>aS(60,t&&(()=>t==null?void 0:t(_,r,S))),getSecondsList:(_,r,S,C)=>aS(60,i&&(()=>i==null?void 0:i(_,r,S,C)))}),n4=(e,t,i)=>{const{getHoursList:a,getMinutesList:d,getSecondsList:p}=t4(e,t,i);return{getAvailableHours:(C,M)=>dS(a(C,M)),getAvailableMinutes:(C,M,k)=>dS(d(C,M,k)),getAvailableSeconds:(C,M,k,z)=>dS(p(C,M,k,z))}},r4=e=>{const t=Se(e.parsedValue);return qt(()=>e.visible,i=>{i||(t.value=e.parsedValue)}),t},Ste=un({role:{type:String,required:!0},spinnerDate:{type:dt(Object),required:!0},showSeconds:{type:Boolean,default:!0},arrowControl:Boolean,amPmMode:{type:dt(String),default:""},...XF}),Tte=100,Cte=600,T1={beforeMount(e,t){const i=t.value,{interval:a=Tte,delay:d=Cte}=Nn(i)?{}:i;let p,_;const r=()=>Nn(i)?i():i.handler(),S=()=>{_&&(clearTimeout(_),_=void 0),p&&(clearInterval(p),p=void 0)};e.addEventListener("mousedown",C=>{C.button===0&&(S(),r(),document.addEventListener("mouseup",()=>S(),{once:!0}),_=setTimeout(()=>{p=setInterval(()=>{r()},a)},d))})}},Ete=qe({__name:"basic-time-spinner",props:Ste,emits:["change","select-range","set-option"],setup(e,{emit:t}){const i=e,a=An("EP_PICKER_BASE"),{isRange:d}=a.props,p=en("time"),{getHoursList:_,getMinutesList:r,getSecondsList:S}=t4(i.disabledHours,i.disabledMinutes,i.disabledSeconds);let C=!1;const M=Se(),k=Se(),z=Se(),F=Se(),B={hours:k,minutes:z,seconds:F},N=ee(()=>i.showSeconds?TR:TR.slice(0,2)),j=ee(()=>{const{spinnerDate:Ve}=i,bt=Ve.hour(),Pe=Ve.minute(),wt=Ve.second();return{hours:bt,minutes:Pe,seconds:wt}}),U=ee(()=>{const{hours:Ve,minutes:bt}=b(j),{role:Pe,spinnerDate:wt}=i,Mt=d?void 0:wt;return{hours:_(Pe,Mt),minutes:r(Ve,Pe,Mt),seconds:S(Ve,bt,Pe,Mt)}}),te=ee(()=>{const{hours:Ve,minutes:bt,seconds:Pe}=b(j);return{hours:sS(Ve,23),minutes:sS(bt,59),seconds:sS(Pe,59)}}),Y=Ra(Ve=>{C=!1,ne(Ve)},200),q=Ve=>{if(!!!i.amPmMode)return"";const Pe=i.amPmMode==="A";let wt=Ve<12?" am":" pm";return Pe&&(wt=wt.toUpperCase()),wt},J=Ve=>{let bt;switch(Ve){case"hours":bt=[0,2];break;case"minutes":bt=[3,5];break;case"seconds":bt=[6,8];break}const[Pe,wt]=bt;t("select-range",Pe,wt),M.value=Ve},ne=Ve=>{ce(Ve,b(j)[Ve])},se=()=>{ne("hours"),ne("minutes"),ne("seconds")},fe=Ve=>Ve.querySelector(`.${p.namespace.value}-scrollbar__wrap`),ce=(Ve,bt)=>{if(i.arrowControl)return;const Pe=b(B[Ve]);Pe&&Pe.$el&&(fe(Pe.$el).scrollTop=Math.max(0,bt*le(Ve)))},le=Ve=>{const bt=b(B[Ve]),Pe=bt==null?void 0:bt.$el.querySelector("li");return Pe&&Number.parseFloat(Pu(Pe,"height"))||0},ge=()=>{ke(1)},de=()=>{ke(-1)},ke=Ve=>{M.value||J("hours");const bt=M.value,Pe=b(j)[bt],wt=M.value==="hours"?24:60,Mt=We(bt,Pe,Ve,wt);we(bt,Mt),ce(bt,Mt),Vn(()=>J(bt))},We=(Ve,bt,Pe,wt)=>{let Mt=(bt+Pe+wt)%wt;const Nt=b(U)[Ve];for(;Nt[Mt]&&Mt!==bt;)Mt=(Mt+Pe+wt)%wt;return Mt},we=(Ve,bt)=>{if(b(U)[Ve][bt])return;const{hours:Mt,minutes:Nt,seconds:vt}=b(j);let Bt;switch(Ve){case"hours":Bt=i.spinnerDate.hour(bt).minute(Nt).second(vt);break;case"minutes":Bt=i.spinnerDate.hour(Mt).minute(bt).second(vt);break;case"seconds":Bt=i.spinnerDate.hour(Mt).minute(Nt).second(bt);break}t("change",Bt)},be=(Ve,{value:bt,disabled:Pe})=>{Pe||(we(Ve,bt),J(Ve),ce(Ve,bt))},Me=Ve=>{const bt=b(B[Ve]);if(!bt)return;C=!0,Y(Ve);const Pe=Math.min(Math.round((fe(bt.$el).scrollTop-(Ae(Ve)*.5-10)/le(Ve)+3)/le(Ve)),Ve==="hours"?23:59);we(Ve,Pe)},Ae=Ve=>b(B[Ve]).$el.offsetHeight,me=()=>{const Ve=bt=>{const Pe=b(B[bt]);Pe&&Pe.$el&&(fe(Pe.$el).onscroll=()=>{Me(bt)})};Ve("hours"),Ve("minutes"),Ve("seconds")};gr(()=>{Vn(()=>{!i.arrowControl&&me(),se(),i.role==="start"&&J("hours")})});const Be=(Ve,bt)=>{B[bt].value=Ve??void 0};return t("set-option",[`${i.role}_scrollDown`,ke]),t("set-option",[`${i.role}_emitSelectRange`,J]),qt(()=>i.spinnerDate,()=>{C||se()}),(Ve,bt)=>(ae(),Oe("div",{class:pe([b(p).b("spinner"),{"has-seconds":Ve.showSeconds}])},[Ve.arrowControl?yt("v-if",!0):(ae(!0),Oe(Bn,{key:0},Or(b(N),Pe=>(ae(),kt(b(Yc),{key:Pe,ref_for:!0,ref:wt=>Be(wt,Pe),class:pe(b(p).be("spinner","wrapper")),"wrap-style":"max-height: inherit;","view-class":b(p).be("spinner","list"),noresize:"",tag:"ul",onMouseenter:wt=>J(Pe),onMousemove:wt=>ne(Pe)},{default:st(()=>[(ae(!0),Oe(Bn,null,Or(b(U)[Pe],(wt,Mt)=>(ae(),Oe("li",{key:Mt,class:pe([b(p).be("spinner","item"),b(p).is("active",Mt===b(j)[Pe]),b(p).is("disabled",wt)]),onClick:Nt=>be(Pe,{value:Mt,disabled:wt})},[Pe==="hours"?(ae(),Oe(Bn,{key:0},[Rr(pn(("0"+(Ve.amPmMode?Mt%12||12:Mt)).slice(-2))+pn(q(Mt)),1)],64)):(ae(),Oe(Bn,{key:1},[Rr(pn(("0"+Mt).slice(-2)),1)],64))],10,["onClick"]))),128))]),_:2},1032,["class","view-class","onMouseenter","onMousemove"]))),128)),Ve.arrowControl?(ae(!0),Oe(Bn,{key:1},Or(b(N),Pe=>(ae(),Oe("div",{key:Pe,class:pe([b(p).be("spinner","wrapper"),b(p).is("arrow")]),onMouseenter:wt=>J(Pe)},[hr((ae(),kt(b(On),{class:pe(["arrow-up",b(p).be("spinner","arrow")])},{default:st(()=>[Ze(b(JC))]),_:1},8,["class"])),[[b(T1),de]]),hr((ae(),kt(b(On),{class:pe(["arrow-down",b(p).be("spinner","arrow")])},{default:st(()=>[Ze(b(Gu))]),_:1},8,["class"])),[[b(T1),ge]]),Ue("ul",{class:pe(b(p).be("spinner","list"))},[(ae(!0),Oe(Bn,null,Or(b(te)[Pe],(wt,Mt)=>(ae(),Oe("li",{key:Mt,class:pe([b(p).be("spinner","item"),b(p).is("active",wt===b(j)[Pe]),b(p).is("disabled",b(U)[Pe][wt])])},[b(Gn)(wt)?(ae(),Oe(Bn,{key:0},[Pe==="hours"?(ae(),Oe(Bn,{key:0},[Rr(pn(("0"+(Ve.amPmMode?wt%12||12:wt)).slice(-2))+pn(q(wt)),1)],64)):(ae(),Oe(Bn,{key:1},[Rr(pn(("0"+wt).slice(-2)),1)],64))],64)):yt("v-if",!0)],2))),128))],2)],42,["onMouseenter"]))),128)):yt("v-if",!0)],2))}});var uT=fn(Ete,[["__file","basic-time-spinner.vue"]]);const Mte=qe({__name:"panel-time-pick",props:wte,emits:["pick","select-range","set-picker-option"],setup(e,{emit:t}){const i=e,a=An("EP_PICKER_BASE"),{arrowControl:d,disabledHours:p,disabledMinutes:_,disabledSeconds:r,defaultValue:S}=a.props,{getAvailableHours:C,getAvailableMinutes:M,getAvailableSeconds:k}=n4(p,_,r),z=en("time"),{t:F,lang:B}=Gr(),N=Se([0,2]),j=r4(i),U=ee(()=>oo(i.actualVisible)?`${z.namespace.value}-zoom-in-top`:""),te=ee(()=>i.format.includes("ss")),Y=ee(()=>i.format.includes("A")?"A":i.format.includes("a")?"a":""),q=Ae=>{const me=lr(Ae).locale(B.value),Be=We(me);return me.isSame(Be)},J=()=>{t("pick",j.value,!1)},ne=(Ae=!1,me=!1)=>{me||t("pick",i.parsedValue,Ae)},se=Ae=>{if(!i.visible)return;const me=We(Ae).millisecond(0);t("pick",me,!0)},fe=(Ae,me)=>{t("select-range",Ae,me),N.value=[Ae,me]},ce=Ae=>{const me=[0,3].concat(te.value?[6]:[]),Be=["hours","minutes"].concat(te.value?["seconds"]:[]),bt=(me.indexOf(N.value[0])+Ae+me.length)%me.length;ge.start_emitSelectRange(Be[bt])},le=Ae=>{const me=Ae.code,{left:Be,right:Ve,up:bt,down:Pe}=En;if([Be,Ve].includes(me)){ce(me===Be?-1:1),Ae.preventDefault();return}if([bt,Pe].includes(me)){const wt=me===bt?-1:1;ge.start_scrollDown(wt),Ae.preventDefault();return}},{timePickerOptions:ge,onSetOption:de,getAvailableTime:ke}=e4({getAvailableHours:C,getAvailableMinutes:M,getAvailableSeconds:k}),We=Ae=>ke(Ae,i.datetimeRole||"",!0),we=Ae=>Ae?lr(Ae,i.format).locale(B.value):null,be=Ae=>Ae?Ae.format(i.format):null,Me=()=>lr(S).locale(B.value);return t("set-picker-option",["isValidValue",q]),t("set-picker-option",["formatToString",be]),t("set-picker-option",["parseUserInput",we]),t("set-picker-option",["handleKeydownInput",le]),t("set-picker-option",["getRangeAvailableTime",We]),t("set-picker-option",["getDefaultValue",Me]),(Ae,me)=>(ae(),kt(ls,{name:b(U)},{default:st(()=>[Ae.actualVisible||Ae.visible?(ae(),Oe("div",{key:0,class:pe(b(z).b("panel"))},[Ue("div",{class:pe([b(z).be("panel","content"),{"has-seconds":b(te)}])},[Ze(uT,{ref:"spinner",role:Ae.datetimeRole||"start","arrow-control":b(d),"show-seconds":b(te),"am-pm-mode":b(Y),"spinner-date":Ae.parsedValue,"disabled-hours":b(p),"disabled-minutes":b(_),"disabled-seconds":b(r),onChange:se,onSetOption:b(de),onSelectRange:fe},null,8,["role","arrow-control","show-seconds","am-pm-mode","spinner-date","disabled-hours","disabled-minutes","disabled-seconds","onSetOption"])],2),Ue("div",{class:pe(b(z).be("panel","footer"))},[Ue("button",{type:"button",class:pe([b(z).be("panel","btn"),"cancel"]),onClick:J},pn(b(F)("el.datepicker.cancel")),3),Ue("button",{type:"button",class:pe([b(z).be("panel","btn"),"confirm"]),onClick:Be=>ne()},pn(b(F)("el.datepicker.confirm")),11,["onClick"])],2)],2)):yt("v-if",!0)]),_:1},8,["name"]))}});var C1=fn(Mte,[["__file","panel-time-pick.vue"]]);const Ite=un({...JF,parsedValue:{type:dt(Array)}}),Ate=qe({__name:"panel-time-range",props:Ite,emits:["pick","select-range","set-picker-option"],setup(e,{emit:t}){const i=e,a=(cn,Re)=>{const nt=[];for(let Qe=cn;Qe<=Re;Qe++)nt.push(Qe);return nt},{t:d,lang:p}=Gr(),_=en("time"),r=en("picker"),S=An("EP_PICKER_BASE"),{arrowControl:C,disabledHours:M,disabledMinutes:k,disabledSeconds:z,defaultValue:F}=S.props,B=ee(()=>[_.be("range-picker","body"),_.be("panel","content"),_.is("arrow",C),q.value?"has-seconds":""]),N=ee(()=>[_.be("range-picker","body"),_.be("panel","content"),_.is("arrow",C),q.value?"has-seconds":""]),j=ee(()=>i.parsedValue[0]),U=ee(()=>i.parsedValue[1]),te=r4(i),Y=()=>{t("pick",te.value,!1)},q=ee(()=>i.format.includes("ss")),J=ee(()=>i.format.includes("A")?"A":i.format.includes("a")?"a":""),ne=(cn=!1)=>{t("pick",[j.value,U.value],cn)},se=cn=>{le(cn.millisecond(0),U.value)},fe=cn=>{le(j.value,cn.millisecond(0))},ce=cn=>{const Re=cn.map(Qe=>lr(Qe).locale(p.value)),nt=Ve(Re);return Re[0].isSame(nt[0])&&Re[1].isSame(nt[1])},le=(cn,Re)=>{i.visible&&t("pick",[cn,Re],!0)},ge=ee(()=>j.value>U.value),de=Se([0,2]),ke=(cn,Re)=>{t("select-range",cn,Re,"min"),de.value=[cn,Re]},We=ee(()=>q.value?11:8),we=(cn,Re)=>{t("select-range",cn,Re,"max");const nt=b(We);de.value=[cn+nt,Re+nt]},be=cn=>{const Re=q.value?[0,3,6,11,14,17]:[0,3,8,11],nt=["hours","minutes"].concat(q.value?["seconds"]:[]),Yt=(Re.indexOf(de.value[0])+cn+Re.length)%Re.length,Xt=Re.length/2;Yt<Xt?Mt.start_emitSelectRange(nt[Yt]):Mt.end_emitSelectRange(nt[Yt-Xt])},Me=cn=>{const Re=cn.code,{left:nt,right:Qe,up:Yt,down:Xt}=En;if([nt,Qe].includes(Re)){be(Re===nt?-1:1),cn.preventDefault();return}if([Yt,Xt].includes(Re)){const $t=Re===Yt?-1:1,Ot=de.value[0]<We.value?"start":"end";Mt[`${Ot}_scrollDown`]($t),cn.preventDefault();return}},Ae=(cn,Re)=>{const nt=M?M(cn):[],Qe=cn==="start",Xt=(Re||(Qe?U.value:j.value)).hour(),$t=Qe?a(Xt+1,23):a(0,Xt-1);return eS(nt,$t)},me=(cn,Re,nt)=>{const Qe=k?k(cn,Re):[],Yt=Re==="start",Xt=nt||(Yt?U.value:j.value),$t=Xt.hour();if(cn!==$t)return Qe;const Ot=Xt.minute(),Ft=Yt?a(Ot+1,59):a(0,Ot-1);return eS(Qe,Ft)},Be=(cn,Re,nt,Qe)=>{const Yt=z?z(cn,Re,nt):[],Xt=nt==="start",$t=Qe||(Xt?U.value:j.value),Ot=$t.hour(),Ft=$t.minute();if(cn!==Ot||Re!==Ft)return Yt;const sn=$t.second(),an=Xt?a(sn+1,59):a(0,sn-1);return eS(Yt,an)},Ve=([cn,Re])=>[Nt(cn,"start",!0,Re),Nt(Re,"end",!1,cn)],{getAvailableHours:bt,getAvailableMinutes:Pe,getAvailableSeconds:wt}=n4(Ae,me,Be),{timePickerOptions:Mt,getAvailableTime:Nt,onSetOption:vt}=e4({getAvailableHours:bt,getAvailableMinutes:Pe,getAvailableSeconds:wt}),Bt=cn=>cn?ln(cn)?cn.map(Re=>lr(Re,i.format).locale(p.value)):lr(cn,i.format).locale(p.value):null,Wt=cn=>cn?ln(cn)?cn.map(Re=>Re.format(i.format)):cn.format(i.format):null,Fe=()=>{if(ln(F))return F.map(Re=>lr(Re).locale(p.value));const cn=lr(F).locale(p.value);return[cn,cn.add(60,"m")]};return t("set-picker-option",["formatToString",Wt]),t("set-picker-option",["parseUserInput",Bt]),t("set-picker-option",["isValidValue",ce]),t("set-picker-option",["handleKeydownInput",Me]),t("set-picker-option",["getDefaultValue",Fe]),t("set-picker-option",["getRangeAvailableTime",Ve]),(cn,Re)=>cn.actualVisible?(ae(),Oe("div",{key:0,class:pe([b(_).b("range-picker"),b(r).b("panel")])},[Ue("div",{class:pe(b(_).be("range-picker","content"))},[Ue("div",{class:pe(b(_).be("range-picker","cell"))},[Ue("div",{class:pe(b(_).be("range-picker","header"))},pn(b(d)("el.datepicker.startTime")),3),Ue("div",{class:pe(b(B))},[Ze(uT,{ref:"minSpinner",role:"start","show-seconds":b(q),"am-pm-mode":b(J),"arrow-control":b(C),"spinner-date":b(j),"disabled-hours":Ae,"disabled-minutes":me,"disabled-seconds":Be,onChange:se,onSetOption:b(vt),onSelectRange:ke},null,8,["show-seconds","am-pm-mode","arrow-control","spinner-date","onSetOption"])],2)],2),Ue("div",{class:pe(b(_).be("range-picker","cell"))},[Ue("div",{class:pe(b(_).be("range-picker","header"))},pn(b(d)("el.datepicker.endTime")),3),Ue("div",{class:pe(b(N))},[Ze(uT,{ref:"maxSpinner",role:"end","show-seconds":b(q),"am-pm-mode":b(J),"arrow-control":b(C),"spinner-date":b(U),"disabled-hours":Ae,"disabled-minutes":me,"disabled-seconds":Be,onChange:fe,onSetOption:b(vt),onSelectRange:we},null,8,["show-seconds","am-pm-mode","arrow-control","spinner-date","onSetOption"])],2)],2)],2),Ue("div",{class:pe(b(_).be("panel","footer"))},[Ue("button",{type:"button",class:pe([b(_).be("panel","btn"),"cancel"]),onClick:nt=>Y()},pn(b(d)("el.datepicker.cancel")),11,["onClick"]),Ue("button",{type:"button",class:pe([b(_).be("panel","btn"),"confirm"]),disabled:b(ge),onClick:nt=>ne()},pn(b(d)("el.datepicker.confirm")),11,["disabled","onClick"])],2)],2)):yt("v-if",!0)}});var kte=fn(Ate,[["__file","panel-time-range.vue"]]);lr.extend(SE);var Pte=qe({name:"ElTimePicker",install:null,props:{...TE,isRange:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(e,t){const i=Se(),[a,d]=e.isRange?["timerange",kte]:["time",C1],p=_=>t.emit("update:modelValue",_);return Dr("ElPopperOptions",e.popperOptions),t.expose({focus:()=>{var _;(_=i.value)==null||_.focus()},blur:()=>{var _;(_=i.value)==null||_.blur()},handleOpen:()=>{var _;(_=i.value)==null||_.handleOpen()},handleClose:()=>{var _;(_=i.value)==null||_.handleClose()}}),()=>{var _;const r=(_=e.format)!=null?_:cT;return Ze(QF,Mr(e,{ref:i,type:a,format:r,"onUpdate:modelValue":p}),{default:S=>Ze(d,S,null)})}}});const Rte=ur(Pte),xx=Symbol(),Ote=un({...TE,type:{type:dt(String),default:"date"}}),Lte=["date","dates","year","years","month","months","week","range"],CE=un({disabledDate:{type:dt(Function)},date:{type:dt(Object),required:!0},minDate:{type:dt(Object)},maxDate:{type:dt(Object)},parsedValue:{type:dt([Object,Array])},rangeState:{type:dt(Object),default:()=>({endDate:null,selecting:!1})}}),o4=un({type:{type:dt(String),required:!0,values:QX},dateFormat:String,timeFormat:String,showNow:{type:Boolean,default:!0}}),EE=un({unlinkPanels:Boolean,parsedValue:{type:dt(Array)}}),ME=e=>({type:String,values:Lte,default:e}),Dte=un({...o4,parsedValue:{type:dt([Object,Array])},visible:{type:Boolean},format:{type:String,default:""}}),zm=e=>{if(!ln(e))return!1;const[t,i]=e;return lr.isDayjs(t)&&lr.isDayjs(i)&&t.isSameOrBefore(i)},IE=(e,{lang:t,unit:i,unlinkPanels:a})=>{let d;if(ln(e)){let[p,_]=e.map(r=>lr(r).locale(t));return a||(_=p.add(1,i)),[p,_]}else e?d=lr(e):d=lr();return d=d.locale(t),[d,d.add(1,i)]},zte=(e,t,{columnIndexOffset:i,startDate:a,nextEndDate:d,now:p,unit:_,relativeDateGetter:r,setCellMetadata:S,setRowMetadata:C})=>{for(let M=0;M<e.row;M++){const k=t[M];for(let z=0;z<e.column;z++){let F=k[z+i];F||(F={row:M,column:z,type:"normal",inRange:!1,start:!1,end:!1});const B=M*e.column+z,N=r(B);F.dayjs=N,F.date=N.toDate(),F.timestamp=N.valueOf(),F.type="normal",F.inRange=!!(a&&N.isSameOrAfter(a,_)&&d&&N.isSameOrBefore(d,_))||!!(a&&N.isSameOrBefore(a,_)&&d&&N.isSameOrAfter(d,_)),a!=null&&a.isSameOrAfter(d)?(F.start=!!d&&N.isSame(d,_),F.end=a&&N.isSame(a,_)):(F.start=!!a&&N.isSame(a,_),F.end=!!d&&N.isSame(d,_)),N.isSame(p,_)&&(F.type="today"),S==null||S(F,{rowIndex:M,columnIndex:z}),k[z+i]=F}C==null||C(k)}},E1=(e,t,i)=>{const a=lr().locale(i).startOf("month").month(t).year(e),d=a.daysInMonth();return jd(d).map(p=>a.add(p,"day").toDate())},J_=(e,t,i,a)=>{const d=lr().year(e).month(t).startOf("month"),p=E1(e,t,i).find(_=>!(a!=null&&a(_)));return p?lr(p).locale(i):d.locale(i)},dT=(e,t,i)=>{const a=e.year();if(!(i!=null&&i(e.toDate())))return e.locale(t);const d=e.month();if(!E1(a,d,t).every(i))return J_(a,d,t,i);for(let p=0;p<12;p++)if(!E1(a,p,t).every(i))return J_(a,p,t,i);return e},Fte=un({...CE,cellClassName:{type:dt(Function)},showWeekNumber:Boolean,selectionMode:ME("date")}),Nte=["changerange","pick","select"],hT=(e="")=>["normal","today"].includes(e),Bte=(e,t)=>{const{lang:i}=Gr(),a=Se(),d=Se(),p=Se(),_=Se(),r=Se([[],[],[],[],[],[]]);let S=!1;const C=e.date.$locale().weekStart||7,M=e.date.locale("en").localeData().weekdaysShort().map(me=>me.toLowerCase()),k=ee(()=>C>3?7-C:-C),z=ee(()=>{const me=e.date.startOf("month");return me.subtract(me.day()||7,"day")}),F=ee(()=>M.concat(M).slice(C,C+7)),B=ee(()=>DD(b(q)).some(me=>me.isCurrent)),N=ee(()=>{const me=e.date.startOf("month"),Be=me.day()||7,Ve=me.daysInMonth(),bt=me.subtract(1,"month").daysInMonth();return{startOfMonthDay:Be,dateCountOfMonth:Ve,dateCountOfLastMonth:bt}}),j=ee(()=>e.selectionMode==="dates"?sa(e.parsedValue):[]),U=(me,{count:Be,rowIndex:Ve,columnIndex:bt})=>{const{startOfMonthDay:Pe,dateCountOfMonth:wt,dateCountOfLastMonth:Mt}=b(N),Nt=b(k);if(Ve>=0&&Ve<=1){const vt=Pe+Nt<0?7+Pe+Nt:Pe+Nt;if(bt+Ve*7>=vt)return me.text=Be,!0;me.text=Mt-(vt-bt%7)+1+Ve*7,me.type="prev-month"}else return Be<=wt?me.text=Be:(me.text=Be-wt,me.type="next-month"),!0;return!1},te=(me,{columnIndex:Be,rowIndex:Ve},bt)=>{const{disabledDate:Pe,cellClassName:wt}=e,Mt=b(j),Nt=U(me,{count:bt,rowIndex:Ve,columnIndex:Be}),vt=me.dayjs.toDate();return me.selected=Mt.find(Bt=>Bt.isSame(me.dayjs,"day")),me.isSelected=!!me.selected,me.isCurrent=ne(me),me.disabled=Pe==null?void 0:Pe(vt),me.customClass=wt==null?void 0:wt(vt),Nt},Y=me=>{if(e.selectionMode==="week"){const[Be,Ve]=e.showWeekNumber?[1,7]:[0,6],bt=Ae(me[Be+1]);me[Be].inRange=bt,me[Be].start=bt,me[Ve].inRange=bt,me[Ve].end=bt}},q=ee(()=>{const{minDate:me,maxDate:Be,rangeState:Ve,showWeekNumber:bt}=e,Pe=b(k),wt=b(r),Mt="day";let Nt=1;if(bt)for(let vt=0;vt<6;vt++)wt[vt][0]||(wt[vt][0]={type:"week",text:b(z).add(vt*7+1,Mt).week()});return zte({row:6,column:7},wt,{startDate:me,columnIndexOffset:bt?1:0,nextEndDate:Ve.endDate||Be||Ve.selecting&&me||null,now:lr().locale(b(i)).startOf(Mt),unit:Mt,relativeDateGetter:vt=>b(z).add(vt-Pe,Mt),setCellMetadata:(...vt)=>{te(...vt,Nt)&&(Nt+=1)},setRowMetadata:Y}),wt});qt(()=>e.date,async()=>{var me;(me=b(a))!=null&&me.contains(document.activeElement)&&(await Vn(),await J())});const J=async()=>{var me;return(me=b(d))==null?void 0:me.focus()},ne=me=>e.selectionMode==="date"&&hT(me.type)&&se(me,e.parsedValue),se=(me,Be)=>Be?lr(Be).locale(b(i)).isSame(e.date.date(Number(me.text)),"day"):!1,fe=(me,Be)=>{const Ve=me*7+(Be-(e.showWeekNumber?1:0))-b(k);return b(z).add(Ve,"day")},ce=me=>{var Be;if(!e.rangeState.selecting)return;let Ve=me.target;if(Ve.tagName==="SPAN"&&(Ve=(Be=Ve.parentNode)==null?void 0:Be.parentNode),Ve.tagName==="DIV"&&(Ve=Ve.parentNode),Ve.tagName!=="TD")return;const bt=Ve.parentNode.rowIndex-1,Pe=Ve.cellIndex;b(q)[bt][Pe].disabled||(bt!==b(p)||Pe!==b(_))&&(p.value=bt,_.value=Pe,t("changerange",{selecting:!0,endDate:fe(bt,Pe)}))},le=me=>!b(B)&&(me==null?void 0:me.text)===1&&me.type==="normal"||me.isCurrent,ge=me=>{S||b(B)||e.selectionMode!=="date"||Me(me,!0)},de=me=>{me.target.closest("td")&&(S=!0)},ke=me=>{me.target.closest("td")&&(S=!1)},We=me=>{!e.rangeState.selecting||!e.minDate?(t("pick",{minDate:me,maxDate:null}),t("select",!0)):(me>=e.minDate?t("pick",{minDate:e.minDate,maxDate:me}):t("pick",{minDate:me,maxDate:e.minDate}),t("select",!1))},we=me=>{const Be=me.week(),Ve=`${me.year()}w${Be}`;t("pick",{year:me.year(),week:Be,value:Ve,date:me.startOf("week")})},be=(me,Be)=>{const Ve=Be?sa(e.parsedValue).filter(bt=>(bt==null?void 0:bt.valueOf())!==me.valueOf()):sa(e.parsedValue).concat([me]);t("pick",Ve)},Me=(me,Be=!1)=>{const Ve=me.target.closest("td");if(!Ve)return;const bt=Ve.parentNode.rowIndex-1,Pe=Ve.cellIndex,wt=b(q)[bt][Pe];if(wt.disabled||wt.type==="week")return;const Mt=fe(bt,Pe);switch(e.selectionMode){case"range":{We(Mt);break}case"date":{t("pick",Mt,Be);break}case"week":{we(Mt);break}case"dates":{be(Mt,!!wt.selected);break}}},Ae=me=>{if(e.selectionMode!=="week")return!1;let Be=e.date.startOf("day");if(me.type==="prev-month"&&(Be=Be.subtract(1,"month")),me.type==="next-month"&&(Be=Be.add(1,"month")),Be=Be.date(Number.parseInt(me.text,10)),e.parsedValue&&!ln(e.parsedValue)){const Ve=(e.parsedValue.day()-C+7)%7-1;return e.parsedValue.subtract(Ve,"day").isSame(Be,"day")}return!1};return{WEEKS:F,rows:q,tbodyRef:a,currentCellRef:d,focus:J,isCurrent:ne,isWeekActive:Ae,isSelectedCell:le,handlePickDate:Me,handleMouseUp:ke,handleMouseDown:de,handleMouseMove:ce,handleFocus:ge}},Vte=(e,{isCurrent:t,isWeekActive:i})=>{const a=en("date-table"),{t:d}=Gr(),p=ee(()=>[a.b(),{"is-week-mode":e.selectionMode==="week"}]),_=ee(()=>d("el.datepicker.dateTablePrompt")),r=ee(()=>d("el.datepicker.week"));return{tableKls:p,tableLabel:_,weekLabel:r,getCellClasses:M=>{const k=[];return hT(M.type)&&!M.disabled?(k.push("available"),M.type==="today"&&k.push("today")):k.push(M.type),t(M)&&k.push("current"),M.inRange&&(hT(M.type)||e.selectionMode==="week")&&(k.push("in-range"),M.start&&k.push("start-date"),M.end&&k.push("end-date")),M.disabled&&k.push("disabled"),M.selected&&k.push("selected"),M.customClass&&k.push(M.customClass),k.join(" ")},getRowKls:M=>[a.e("row"),{current:i(M)}],t:d}},$te=un({cell:{type:dt(Object)}});var AE=qe({name:"ElDatePickerCell",props:$te,setup(e){const t=en("date-table-cell"),{slots:i}=An(xx);return()=>{const{cell:a}=e;return pt(i,"default",{...a},()=>{var d;return[Ze("div",{class:t.b()},[Ze("span",{class:t.e("text")},[(d=a==null?void 0:a.renderText)!=null?d:a==null?void 0:a.text])])]})}}});const Ute=qe({__name:"basic-date-table",props:Fte,emits:Nte,setup(e,{expose:t,emit:i}){const a=e,{WEEKS:d,rows:p,tbodyRef:_,currentCellRef:r,focus:S,isCurrent:C,isWeekActive:M,isSelectedCell:k,handlePickDate:z,handleMouseUp:F,handleMouseDown:B,handleMouseMove:N,handleFocus:j}=Bte(a,i),{tableLabel:U,tableKls:te,weekLabel:Y,getCellClasses:q,getRowKls:J,t:ne}=Vte(a,{isCurrent:C,isWeekActive:M});return t({focus:S}),(se,fe)=>(ae(),Oe("table",{"aria-label":b(U),class:pe(b(te)),cellspacing:"0",cellpadding:"0",role:"grid",onClick:b(z),onMousemove:b(N),onMousedown:Qn(b(B),["prevent"]),onMouseup:b(F)},[Ue("tbody",{ref_key:"tbodyRef",ref:_},[Ue("tr",null,[se.showWeekNumber?(ae(),Oe("th",{key:0,scope:"col"},pn(b(Y)),1)):yt("v-if",!0),(ae(!0),Oe(Bn,null,Or(b(d),(ce,le)=>(ae(),Oe("th",{key:le,"aria-label":b(ne)("el.datepicker.weeksFull."+ce),scope:"col"},pn(b(ne)("el.datepicker.weeks."+ce)),9,["aria-label"]))),128))]),(ae(!0),Oe(Bn,null,Or(b(p),(ce,le)=>(ae(),Oe("tr",{key:le,class:pe(b(J)(ce[1]))},[(ae(!0),Oe(Bn,null,Or(ce,(ge,de)=>(ae(),Oe("td",{key:`${le}.${de}`,ref_for:!0,ref:ke=>b(k)(ge)&&(r.value=ke),class:pe(b(q)(ge)),"aria-current":ge.isCurrent?"date":void 0,"aria-selected":ge.isCurrent,tabindex:b(k)(ge)?0:-1,onFocus:b(j)},[Ze(b(AE),{cell:ge},null,8,["cell"])],42,["aria-current","aria-selected","tabindex","onFocus"]))),128))],2))),128))],512)],42,["aria-label","onClick","onMousemove","onMousedown","onMouseup"]))}});var fT=fn(Ute,[["__file","basic-date-table.vue"]]);const jte=un({...CE,selectionMode:ME("month")}),Hte=qe({__name:"basic-month-table",props:jte,emits:["changerange","pick","select"],setup(e,{expose:t,emit:i}){const a=e,d=en("month-table"),{t:p,lang:_}=Gr(),r=Se(),S=Se(),C=Se(a.date.locale("en").localeData().monthsShort().map(Y=>Y.toLowerCase())),M=Se([[],[],[]]),k=Se(),z=Se(),F=ee(()=>{var Y,q;const J=M.value,ne=lr().locale(_.value).startOf("month");for(let se=0;se<3;se++){const fe=J[se];for(let ce=0;ce<4;ce++){const le=fe[ce]||(fe[ce]={row:se,column:ce,type:"normal",inRange:!1,start:!1,end:!1,text:-1,disabled:!1});le.type="normal";const ge=se*4+ce,de=a.date.startOf("year").month(ge),ke=a.rangeState.endDate||a.maxDate||a.rangeState.selecting&&a.minDate||null;le.inRange=!!(a.minDate&&de.isSameOrAfter(a.minDate,"month")&&ke&&de.isSameOrBefore(ke,"month"))||!!(a.minDate&&de.isSameOrBefore(a.minDate,"month")&&ke&&de.isSameOrAfter(ke,"month")),(Y=a.minDate)!=null&&Y.isSameOrAfter(ke)?(le.start=!!(ke&&de.isSame(ke,"month")),le.end=a.minDate&&de.isSame(a.minDate,"month")):(le.start=!!(a.minDate&&de.isSame(a.minDate,"month")),le.end=!!(ke&&de.isSame(ke,"month"))),ne.isSame(de)&&(le.type="today"),le.text=ge,le.disabled=((q=a.disabledDate)==null?void 0:q.call(a,de.toDate()))||!1}}return J}),B=()=>{var Y;(Y=S.value)==null||Y.focus()},N=Y=>{const q={},J=a.date.year(),ne=new Date,se=Y.text;return q.disabled=a.disabledDate?E1(J,se,_.value).every(a.disabledDate):!1,q.current=sa(a.parsedValue).findIndex(fe=>lr.isDayjs(fe)&&fe.year()===J&&fe.month()===se)>=0,q.today=ne.getFullYear()===J&&ne.getMonth()===se,Y.inRange&&(q["in-range"]=!0,Y.start&&(q["start-date"]=!0),Y.end&&(q["end-date"]=!0)),q},j=Y=>{const q=a.date.year(),J=Y.text;return sa(a.date).findIndex(ne=>ne.year()===q&&ne.month()===J)>=0},U=Y=>{var q;if(!a.rangeState.selecting)return;let J=Y.target;if(J.tagName==="SPAN"&&(J=(q=J.parentNode)==null?void 0:q.parentNode),J.tagName==="DIV"&&(J=J.parentNode),J.tagName!=="TD")return;const ne=J.parentNode.rowIndex,se=J.cellIndex;F.value[ne][se].disabled||(ne!==k.value||se!==z.value)&&(k.value=ne,z.value=se,i("changerange",{selecting:!0,endDate:a.date.startOf("year").month(ne*4+se)}))},te=Y=>{var q;const J=(q=Y.target)==null?void 0:q.closest("td");if((J==null?void 0:J.tagName)!=="TD"||Aa(J,"disabled"))return;const ne=J.cellIndex,fe=J.parentNode.rowIndex*4+ne,ce=a.date.startOf("year").month(fe);if(a.selectionMode==="months"){if(Y.type==="keydown"){i("pick",sa(a.parsedValue),!1);return}const le=J_(a.date.year(),fe,_.value,a.disabledDate),ge=Aa(J,"current")?sa(a.parsedValue).filter(de=>(de==null?void 0:de.month())!==le.month()):sa(a.parsedValue).concat([lr(le)]);i("pick",ge)}else a.selectionMode==="range"?a.rangeState.selecting?(a.minDate&&ce>=a.minDate?i("pick",{minDate:a.minDate,maxDate:ce}):i("pick",{minDate:ce,maxDate:a.minDate}),i("select",!1)):(i("pick",{minDate:ce,maxDate:null}),i("select",!0)):i("pick",fe)};return qt(()=>a.date,async()=>{var Y,q;(Y=r.value)!=null&&Y.contains(document.activeElement)&&(await Vn(),(q=S.value)==null||q.focus())}),t({focus:B}),(Y,q)=>(ae(),Oe("table",{role:"grid","aria-label":b(p)("el.datepicker.monthTablePrompt"),class:pe(b(d).b()),onClick:te,onMousemove:U},[Ue("tbody",{ref_key:"tbodyRef",ref:r},[(ae(!0),Oe(Bn,null,Or(b(F),(J,ne)=>(ae(),Oe("tr",{key:ne},[(ae(!0),Oe(Bn,null,Or(J,(se,fe)=>(ae(),Oe("td",{key:fe,ref_for:!0,ref:ce=>j(se)&&(S.value=ce),class:pe(N(se)),"aria-selected":`${j(se)}`,"aria-label":b(p)(`el.datepicker.month${+se.text+1}`),tabindex:j(se)?0:-1,onKeydown:[Po(Qn(te,["prevent","stop"]),["space"]),Po(Qn(te,["prevent","stop"]),["enter"])]},[Ze(b(AE),{cell:{...se,renderText:b(p)("el.datepicker.months."+C.value[se.text])}},null,8,["cell"])],42,["aria-selected","aria-label","tabindex","onKeydown"]))),128))]))),128))],512)],42,["aria-label"]))}});var pT=fn(Hte,[["__file","basic-month-table.vue"]]);const Gte=un({...CE,selectionMode:ME("year")}),Wte=qe({__name:"basic-year-table",props:Gte,emits:["changerange","pick","select"],setup(e,{expose:t,emit:i}){const a=e,d=(q,J)=>{const ne=lr(String(q)).locale(J).startOf("year"),fe=ne.endOf("year").dayOfYear();return jd(fe).map(ce=>ne.add(ce,"day").toDate())},p=en("year-table"),{t:_,lang:r}=Gr(),S=Se(),C=Se(),M=ee(()=>Math.floor(a.date.year()/10)*10),k=Se([[],[],[]]),z=Se(),F=Se(),B=ee(()=>{var q;const J=k.value,ne=lr().locale(r.value).startOf("year");for(let se=0;se<3;se++){const fe=J[se];for(let ce=0;ce<4&&!(se*4+ce>=10);ce++){let le=fe[ce];le||(le={row:se,column:ce,type:"normal",inRange:!1,start:!1,end:!1,text:-1,disabled:!1}),le.type="normal";const ge=se*4+ce+M.value,de=lr().year(ge),ke=a.rangeState.endDate||a.maxDate||a.rangeState.selecting&&a.minDate||null;le.inRange=!!(a.minDate&&de.isSameOrAfter(a.minDate,"year")&&ke&&de.isSameOrBefore(ke,"year"))||!!(a.minDate&&de.isSameOrBefore(a.minDate,"year")&&ke&&de.isSameOrAfter(ke,"year")),(q=a.minDate)!=null&&q.isSameOrAfter(ke)?(le.start=!!(ke&&de.isSame(ke,"year")),le.end=!!(a.minDate&&de.isSame(a.minDate,"year"))):(le.start=!!(a.minDate&&de.isSame(a.minDate,"year")),le.end=!!(ke&&de.isSame(ke,"year"))),ne.isSame(de)&&(le.type="today"),le.text=ge;const we=de.toDate();le.disabled=a.disabledDate&&a.disabledDate(we)||!1,fe[ce]=le}}return J}),N=()=>{var q;(q=C.value)==null||q.focus()},j=q=>{const J={},ne=lr().locale(r.value),se=q.text;return J.disabled=a.disabledDate?d(se,r.value).every(a.disabledDate):!1,J.today=ne.year()===se,J.current=sa(a.parsedValue).findIndex(fe=>fe.year()===se)>=0,q.inRange&&(J["in-range"]=!0,q.start&&(J["start-date"]=!0),q.end&&(J["end-date"]=!0)),J},U=q=>{const J=q.text;return sa(a.date).findIndex(ne=>ne.year()===J)>=0},te=q=>{var J;const ne=(J=q.target)==null?void 0:J.closest("td");if(!ne||!ne.textContent||Aa(ne,"disabled"))return;const se=ne.cellIndex,ce=ne.parentNode.rowIndex*4+se+M.value,le=lr().year(ce);if(a.selectionMode==="range")a.rangeState.selecting?(a.minDate&&le>=a.minDate?i("pick",{minDate:a.minDate,maxDate:le}):i("pick",{minDate:le,maxDate:a.minDate}),i("select",!1)):(i("pick",{minDate:le,maxDate:null}),i("select",!0));else if(a.selectionMode==="years"){if(q.type==="keydown"){i("pick",sa(a.parsedValue),!1);return}const ge=dT(le.startOf("year"),r.value,a.disabledDate),de=Aa(ne,"current")?sa(a.parsedValue).filter(ke=>(ke==null?void 0:ke.year())!==ce):sa(a.parsedValue).concat([ge]);i("pick",de)}else i("pick",ce)},Y=q=>{var J;if(!a.rangeState.selecting)return;const ne=(J=q.target)==null?void 0:J.closest("td");if(!ne)return;const se=ne.parentNode.rowIndex,fe=ne.cellIndex;B.value[se][fe].disabled||(se!==z.value||fe!==F.value)&&(z.value=se,F.value=fe,i("changerange",{selecting:!0,endDate:lr().year(M.value).add(se*4+fe,"year")}))};return qt(()=>a.date,async()=>{var q,J;(q=S.value)!=null&&q.contains(document.activeElement)&&(await Vn(),(J=C.value)==null||J.focus())}),t({focus:N}),(q,J)=>(ae(),Oe("table",{role:"grid","aria-label":b(_)("el.datepicker.yearTablePrompt"),class:pe(b(p).b()),onClick:te,onMousemove:Y},[Ue("tbody",{ref_key:"tbodyRef",ref:S},[(ae(!0),Oe(Bn,null,Or(b(B),(ne,se)=>(ae(),Oe("tr",{key:se},[(ae(!0),Oe(Bn,null,Or(ne,(fe,ce)=>(ae(),Oe("td",{key:`${se}_${ce}`,ref_for:!0,ref:le=>U(fe)&&(C.value=le),class:pe(["available",j(fe)]),"aria-selected":U(fe),"aria-label":String(fe.text),tabindex:U(fe)?0:-1,onKeydown:[Po(Qn(te,["prevent","stop"]),["space"]),Po(Qn(te,["prevent","stop"]),["enter"])]},[Ze(b(AE),{cell:fe},null,8,["cell"])],42,["aria-selected","aria-label","tabindex","onKeydown"]))),128))]))),128))],512)],42,["aria-label"]))}});var mT=fn(Wte,[["__file","basic-year-table.vue"]]);const qte=qe({__name:"panel-date-pick",props:Dte,emits:["pick","set-picker-option","panel-change"],setup(e,{emit:t}){const i=e,a=(Gt,ct,Ut)=>!0,d=en("picker-panel"),p=en("date-picker"),_=Uu(),r=Hi(),{t:S,lang:C}=Gr(),M=An("EP_PICKER_BASE"),k=An(yx),{shortcuts:z,disabledDate:F,cellClassName:B,defaultTime:N}=M.props,j=po(M.props,"defaultValue"),U=Se(),te=Se(lr().locale(C.value)),Y=Se(!1);let q=!1;const J=ee(()=>lr(N).locale(C.value)),ne=ee(()=>te.value.month()),se=ee(()=>te.value.year()),fe=Se([]),ce=Se(null),le=Se(null),ge=Gt=>fe.value.length>0?a(Gt,fe.value,i.format||"HH:mm:ss"):!0,de=Gt=>N&&!Yt.value&&!Y.value&&!q?J.value.year(Gt.year()).month(Gt.month()).date(Gt.date()):vt.value?Gt.millisecond(0):Gt.startOf("day"),ke=(Gt,...ct)=>{if(!Gt)t("pick",Gt,...ct);else if(ln(Gt)){const Ut=Gt.map(de);t("pick",Ut,...ct)}else t("pick",de(Gt),...ct);ce.value=null,le.value=null,Y.value=!1,q=!1},We=async(Gt,ct)=>{if(Be.value==="date"){Gt=Gt;let Ut=i.parsedValue?i.parsedValue.year(Gt.year()).month(Gt.month()).date(Gt.date()):Gt;ge(Ut)||(Ut=fe.value[0][0].year(Gt.year()).month(Gt.month()).date(Gt.date())),te.value=Ut,ke(Ut,vt.value||ct),i.type==="datetime"&&(await Vn(),tr())}else Be.value==="week"?ke(Gt.date):Be.value==="dates"&&ke(Gt,!0)},we=Gt=>{const ct=Gt?"add":"subtract";te.value=te.value[ct](1,"month"),jn("month")},be=Gt=>{const ct=te.value,Ut=Gt?"add":"subtract";te.value=Me.value==="year"?ct[Ut](10,"year"):ct[Ut](1,"year"),jn("year")},Me=Se("date"),Ae=ee(()=>{const Gt=S("el.datepicker.year");if(Me.value==="year"){const ct=Math.floor(se.value/10)*10;return Gt?`${ct} ${Gt} - ${ct+9} ${Gt}`:`${ct} - ${ct+9}`}return`${se.value} ${Gt}`}),me=Gt=>{const ct=Nn(Gt.value)?Gt.value():Gt.value;if(ct){q=!0,ke(lr(ct).locale(C.value));return}Gt.onClick&&Gt.onClick({attrs:_,slots:r,emit:t})},Be=ee(()=>{const{type:Gt}=i;return["week","month","months","year","years","dates"].includes(Gt)?Gt:"date"}),Ve=ee(()=>Be.value==="dates"||Be.value==="months"||Be.value==="years"),bt=ee(()=>Be.value==="date"?Me.value:Be.value),Pe=ee(()=>!!z.length),wt=async(Gt,ct)=>{Be.value==="month"?(te.value=J_(te.value.year(),Gt,C.value,F),ke(te.value,!1)):Be.value==="months"?ke(Gt,ct??!0):(te.value=J_(te.value.year(),Gt,C.value,F),Me.value="date",["month","year","date","week"].includes(Be.value)&&(ke(te.value,!0),await Vn(),tr())),jn("month")},Mt=async(Gt,ct)=>{if(Be.value==="year"){const Ut=te.value.startOf("year").year(Gt);te.value=dT(Ut,C.value,F),ke(te.value,!1)}else if(Be.value==="years")ke(Gt,ct??!0);else{const Ut=te.value.year(Gt);te.value=dT(Ut,C.value,F),Me.value="month",["month","year","date","week"].includes(Be.value)&&(ke(te.value,!0),await Vn(),tr())}jn("year")},Nt=async Gt=>{Me.value=Gt,await Vn(),tr()},vt=ee(()=>i.type==="datetime"||i.type==="datetimerange"),Bt=ee(()=>{const Gt=vt.value||Be.value==="dates",ct=Be.value==="years",Ut=Be.value==="months",tt=Me.value==="date",yn=Me.value==="year",wn=Me.value==="month";return Gt&&tt||ct&&yn||Ut&&wn}),Wt=ee(()=>F?i.parsedValue?ln(i.parsedValue)?F(i.parsedValue[0].toDate()):F(i.parsedValue.toDate()):!0:!1),Fe=()=>{if(Ve.value)ke(i.parsedValue);else{let Gt=i.parsedValue;if(!Gt){const ct=lr(N).locale(C.value),Ut=vr();Gt=ct.year(Ut.year()).month(Ut.month()).date(Ut.date())}te.value=Gt,ke(Gt)}},cn=ee(()=>F?F(lr().locale(C.value).toDate()):!1),Re=()=>{const ct=lr().locale(C.value).toDate();Y.value=!0,(!F||!F(ct))&&ge(ct)&&(te.value=lr().locale(C.value),ke(te.value))},nt=ee(()=>i.timeFormat||gF(i.format)),Qe=ee(()=>i.dateFormat||mF(i.format)),Yt=ee(()=>{if(le.value)return le.value;if(!(!i.parsedValue&&!j.value))return(i.parsedValue||te.value).format(nt.value)}),Xt=ee(()=>{if(ce.value)return ce.value;if(!(!i.parsedValue&&!j.value))return(i.parsedValue||te.value).format(Qe.value)}),$t=Se(!1),Ot=()=>{$t.value=!0},Ft=()=>{$t.value=!1},sn=Gt=>({hour:Gt.hour(),minute:Gt.minute(),second:Gt.second(),year:Gt.year(),month:Gt.month(),date:Gt.date()}),an=(Gt,ct,Ut)=>{const{hour:tt,minute:yn,second:wn}=sn(Gt),sr=i.parsedValue?i.parsedValue.hour(tt).minute(yn).second(wn):Gt;te.value=sr,ke(te.value,!0),Ut||($t.value=ct)},Pn=Gt=>{const ct=lr(Gt,nt.value).locale(C.value);if(ct.isValid()&&ge(ct)){const{year:Ut,month:tt,date:yn}=sn(te.value);te.value=ct.year(Ut).month(tt).date(yn),le.value=null,$t.value=!1,ke(te.value,!0)}},bn=Gt=>{const ct=lr(Gt,Qe.value).locale(C.value);if(ct.isValid()){if(F&&F(ct.toDate()))return;const{hour:Ut,minute:tt,second:yn}=sn(te.value);te.value=ct.hour(Ut).minute(tt).second(yn),ce.value=null,ke(te.value,!0)}},It=Gt=>lr.isDayjs(Gt)&&Gt.isValid()&&(F?!F(Gt.toDate()):!0),Sn=Gt=>ln(Gt)?Gt.map(ct=>ct.format(i.format)):Gt.format(i.format),Yn=Gt=>lr(Gt,i.format).locale(C.value),vr=()=>{const Gt=lr(j.value).locale(C.value);if(!j.value){const ct=J.value;return lr().hour(ct.hour()).minute(ct.minute()).second(ct.second()).locale(C.value)}return Gt},tr=()=>{var Gt;["week","month","year","date"].includes(Be.value)&&((Gt=U.value)==null||Gt.focus())},zr=()=>{tr(),Be.value==="week"&&Io(En.down)},Cr=Gt=>{const{code:ct}=Gt;[En.up,En.down,En.left,En.right,En.home,En.end,En.pageUp,En.pageDown].includes(ct)&&(Io(ct),Gt.stopPropagation(),Gt.preventDefault()),[En.enter,En.space,En.numpadEnter].includes(ct)&&ce.value===null&&le.value===null&&(Gt.preventDefault(),ke(te.value,!1))},Io=Gt=>{var ct;const{up:Ut,down:tt,left:yn,right:wn,home:sr,end:vo,pageUp:jo,pageDown:Go}=En,bo={year:{[Ut]:-4,[tt]:4,[yn]:-1,[wn]:1,offset:(mo,Fi)=>mo.setFullYear(mo.getFullYear()+Fi)},month:{[Ut]:-4,[tt]:4,[yn]:-1,[wn]:1,offset:(mo,Fi)=>mo.setMonth(mo.getMonth()+Fi)},week:{[Ut]:-1,[tt]:1,[yn]:-1,[wn]:1,offset:(mo,Fi)=>mo.setDate(mo.getDate()+Fi*7)},date:{[Ut]:-7,[tt]:7,[yn]:-1,[wn]:1,[sr]:mo=>-mo.getDay(),[vo]:mo=>-mo.getDay()+6,[jo]:mo=>-new Date(mo.getFullYear(),mo.getMonth(),0).getDate(),[Go]:mo=>new Date(mo.getFullYear(),mo.getMonth()+1,0).getDate(),offset:(mo,Fi)=>mo.setDate(mo.getDate()+Fi)}},oi=te.value.toDate();for(;Math.abs(te.value.diff(oi,"year",!0))<1;){const mo=bo[bt.value];if(!mo)return;if(mo.offset(oi,Nn(mo[Gt])?mo[Gt](oi):(ct=mo[Gt])!=null?ct:0),F&&F(oi))break;const Fi=lr(oi).locale(C.value);te.value=Fi,t("pick",Fi,!0);break}},jn=Gt=>{t("panel-change",te.value.toDate(),Gt,Me.value)};return qt(()=>Be.value,Gt=>{if(["month","year"].includes(Gt)){Me.value=Gt;return}else if(Gt==="years"){Me.value="year";return}else if(Gt==="months"){Me.value="month";return}Me.value="date"},{immediate:!0}),qt(()=>Me.value,()=>{k==null||k.updatePopper()}),qt(()=>j.value,Gt=>{Gt&&(te.value=vr())},{immediate:!0}),qt(()=>i.parsedValue,Gt=>{if(Gt){if(Ve.value||ln(Gt))return;te.value=Gt}else te.value=vr()},{immediate:!0}),t("set-picker-option",["isValidValue",It]),t("set-picker-option",["formatToString",Sn]),t("set-picker-option",["parseUserInput",Yn]),t("set-picker-option",["handleFocusPicker",zr]),(Gt,ct)=>(ae(),Oe("div",{class:pe([b(d).b(),b(p).b(),{"has-sidebar":Gt.$slots.sidebar||b(Pe),"has-time":b(vt)}])},[Ue("div",{class:pe(b(d).e("body-wrapper"))},[pt(Gt.$slots,"sidebar",{class:pe(b(d).e("sidebar"))}),b(Pe)?(ae(),Oe("div",{key:0,class:pe(b(d).e("sidebar"))},[(ae(!0),Oe(Bn,null,Or(b(z),(Ut,tt)=>(ae(),Oe("button",{key:tt,type:"button",class:pe(b(d).e("shortcut")),onClick:yn=>me(Ut)},pn(Ut.text),11,["onClick"]))),128))],2)):yt("v-if",!0),Ue("div",{class:pe(b(d).e("body"))},[b(vt)?(ae(),Oe("div",{key:0,class:pe(b(p).e("time-header"))},[Ue("span",{class:pe(b(p).e("editor-wrap"))},[Ze(b(Us),{placeholder:b(S)("el.datepicker.selectDate"),"model-value":b(Xt),size:"small","validate-event":!1,onInput:Ut=>ce.value=Ut,onChange:bn},null,8,["placeholder","model-value","onInput"])],2),hr((ae(),Oe("span",{class:pe(b(p).e("editor-wrap"))},[Ze(b(Us),{placeholder:b(S)("el.datepicker.selectTime"),"model-value":b(Yt),size:"small","validate-event":!1,onFocus:Ot,onInput:Ut=>le.value=Ut,onChange:Pn},null,8,["placeholder","model-value","onInput"]),Ze(b(C1),{visible:$t.value,format:b(nt),"parsed-value":te.value,onPick:an},null,8,["visible","format","parsed-value"])],2)),[[b(Bu),Ft]])],2)):yt("v-if",!0),hr(Ue("div",{class:pe([b(p).e("header"),(Me.value==="year"||Me.value==="month")&&b(p).e("header--bordered")])},[Ue("span",{class:pe(b(p).e("prev-btn"))},[Ue("button",{type:"button","aria-label":b(S)("el.datepicker.prevYear"),class:pe(["d-arrow-left",b(d).e("icon-btn")]),onClick:Ut=>be(!1)},[pt(Gt.$slots,"prev-year",{},()=>[Ze(b(On),null,{default:st(()=>[Ze(b(Zd))]),_:1})])],10,["aria-label","onClick"]),hr(Ue("button",{type:"button","aria-label":b(S)("el.datepicker.prevMonth"),class:pe([b(d).e("icon-btn"),"arrow-left"]),onClick:Ut=>we(!1)},[pt(Gt.$slots,"prev-month",{},()=>[Ze(b(On),null,{default:st(()=>[Ze(b(Kd))]),_:1})])],10,["aria-label","onClick"]),[[no,Me.value==="date"]])],2),Ue("span",{role:"button",class:pe(b(p).e("header-label")),"aria-live":"polite",tabindex:"0",onKeydown:Po(Ut=>Nt("year"),["enter"]),onClick:Ut=>Nt("year")},pn(b(Ae)),43,["onKeydown","onClick"]),hr(Ue("span",{role:"button","aria-live":"polite",tabindex:"0",class:pe([b(p).e("header-label"),{active:Me.value==="month"}]),onKeydown:Po(Ut=>Nt("month"),["enter"]),onClick:Ut=>Nt("month")},pn(b(S)(`el.datepicker.month${b(ne)+1}`)),43,["onKeydown","onClick"]),[[no,Me.value==="date"]]),Ue("span",{class:pe(b(p).e("next-btn"))},[hr(Ue("button",{type:"button","aria-label":b(S)("el.datepicker.nextMonth"),class:pe([b(d).e("icon-btn"),"arrow-right"]),onClick:Ut=>we(!0)},[pt(Gt.$slots,"next-month",{},()=>[Ze(b(On),null,{default:st(()=>[Ze(b(ca))]),_:1})])],10,["aria-label","onClick"]),[[no,Me.value==="date"]]),Ue("button",{type:"button","aria-label":b(S)("el.datepicker.nextYear"),class:pe([b(d).e("icon-btn"),"d-arrow-right"]),onClick:Ut=>be(!0)},[pt(Gt.$slots,"next-year",{},()=>[Ze(b(On),null,{default:st(()=>[Ze(b(Yd))]),_:1})])],10,["aria-label","onClick"])],2)],2),[[no,Me.value!=="time"]]),Ue("div",{class:pe(b(d).e("content")),onKeydown:Cr},[Me.value==="date"?(ae(),kt(fT,{key:0,ref_key:"currentViewRef",ref:U,"selection-mode":b(Be),date:te.value,"parsed-value":Gt.parsedValue,"disabled-date":b(F),"cell-class-name":b(B),onPick:We},null,8,["selection-mode","date","parsed-value","disabled-date","cell-class-name"])):yt("v-if",!0),Me.value==="year"?(ae(),kt(mT,{key:1,ref_key:"currentViewRef",ref:U,"selection-mode":b(Be),date:te.value,"disabled-date":b(F),"parsed-value":Gt.parsedValue,onPick:Mt},null,8,["selection-mode","date","disabled-date","parsed-value"])):yt("v-if",!0),Me.value==="month"?(ae(),kt(pT,{key:2,ref_key:"currentViewRef",ref:U,"selection-mode":b(Be),date:te.value,"parsed-value":Gt.parsedValue,"disabled-date":b(F),onPick:wt},null,8,["selection-mode","date","parsed-value","disabled-date"])):yt("v-if",!0)],34)],2)],2),hr(Ue("div",{class:pe(b(d).e("footer"))},[hr(Ze(b(ss),{text:"",size:"small",class:pe(b(d).e("link-btn")),disabled:b(cn),onClick:Re},{default:st(()=>[Rr(pn(b(S)("el.datepicker.now")),1)]),_:1},8,["class","disabled"]),[[no,!b(Ve)&&Gt.showNow]]),Ze(b(ss),{plain:"",size:"small",class:pe(b(d).e("link-btn")),disabled:b(Wt),onClick:Fe},{default:st(()=>[Rr(pn(b(S)("el.datepicker.confirm")),1)]),_:1},8,["class","disabled"])],2),[[no,b(Bt)]])],2))}});var Kte=fn(qte,[["__file","panel-date-pick.vue"]]);const Zte=un({...o4,...EE,visible:Boolean}),i4=e=>{const{emit:t}=wr(),i=Uu(),a=Hi();return p=>{const _=Nn(p.value)?p.value():p.value;if(_){t("pick",[lr(_[0]).locale(e.value),lr(_[1]).locale(e.value)]);return}p.onClick&&p.onClick({attrs:i,slots:a,emit:t})}},s4=(e,{defaultValue:t,leftDate:i,rightDate:a,unit:d,onParsedValueChanged:p})=>{const{emit:_}=wr(),{pickerNs:r}=An(xx),S=en("date-range-picker"),{t:C,lang:M}=Gr(),k=i4(M),z=Se(),F=Se(),B=Se({endDate:null,selecting:!1}),N=q=>{B.value=q},j=(q=!1)=>{const J=b(z),ne=b(F);zm([J,ne])&&_("pick",[J,ne],q)},U=q=>{B.value.selecting=q,q||(B.value.endDate=null)},te=q=>{if(ln(q)&&q.length===2){const[J,ne]=q;z.value=J,i.value=J,F.value=ne,p(b(z),b(F))}else Y()},Y=()=>{const[q,J]=IE(b(t),{lang:b(M),unit:d,unlinkPanels:e.unlinkPanels});z.value=void 0,F.value=void 0,i.value=q,a.value=J};return qt(t,q=>{q&&Y()},{immediate:!0}),qt(()=>e.parsedValue,te,{immediate:!0}),{minDate:z,maxDate:F,rangeState:B,lang:M,ppNs:r,drpNs:S,handleChangeRange:N,handleRangeConfirm:j,handleShortcutClick:k,onSelect:U,onReset:te,t:C}},kb="month",Yte=qe({__name:"panel-date-range",props:Zte,emits:["pick","set-picker-option","calendar-change","panel-change"],setup(e,{emit:t}){const i=e,a=An("EP_PICKER_BASE"),{disabledDate:d,cellClassName:p,defaultTime:_,clearable:r}=a.props,S=po(a.props,"format"),C=po(a.props,"shortcuts"),M=po(a.props,"defaultValue"),{lang:k}=Gr(),z=Se(lr().locale(k.value)),F=Se(lr().locale(k.value).add(1,kb)),{minDate:B,maxDate:N,rangeState:j,ppNs:U,drpNs:te,handleChangeRange:Y,handleRangeConfirm:q,handleShortcutClick:J,onSelect:ne,onReset:se,t:fe}=s4(i,{defaultValue:M,leftDate:z,rightDate:F,unit:kb,onParsedValueChanged:Gt});qt(()=>i.visible,ct=>{!ct&&j.value.selecting&&(se(i.parsedValue),ne(!1))});const ce=Se({min:null,max:null}),le=Se({min:null,max:null}),ge=ee(()=>`${z.value.year()} ${fe("el.datepicker.year")} ${fe(`el.datepicker.month${z.value.month()+1}`)}`),de=ee(()=>`${F.value.year()} ${fe("el.datepicker.year")} ${fe(`el.datepicker.month${F.value.month()+1}`)}`),ke=ee(()=>z.value.year()),We=ee(()=>z.value.month()),we=ee(()=>F.value.year()),be=ee(()=>F.value.month()),Me=ee(()=>!!C.value.length),Ae=ee(()=>ce.value.min!==null?ce.value.min:B.value?B.value.format(Pe.value):""),me=ee(()=>ce.value.max!==null?ce.value.max:N.value||B.value?(N.value||B.value).format(Pe.value):""),Be=ee(()=>le.value.min!==null?le.value.min:B.value?B.value.format(bt.value):""),Ve=ee(()=>le.value.max!==null?le.value.max:N.value||B.value?(N.value||B.value).format(bt.value):""),bt=ee(()=>i.timeFormat||gF(S.value)),Pe=ee(()=>i.dateFormat||mF(S.value)),wt=ct=>zm(ct)&&(d?!d(ct[0].toDate())&&!d(ct[1].toDate()):!0),Mt=()=>{z.value=z.value.subtract(1,"year"),i.unlinkPanels||(F.value=z.value.add(1,"month")),nt("year")},Nt=()=>{z.value=z.value.subtract(1,"month"),i.unlinkPanels||(F.value=z.value.add(1,"month")),nt("month")},vt=()=>{i.unlinkPanels?F.value=F.value.add(1,"year"):(z.value=z.value.add(1,"year"),F.value=z.value.add(1,"month")),nt("year")},Bt=()=>{i.unlinkPanels?F.value=F.value.add(1,"month"):(z.value=z.value.add(1,"month"),F.value=z.value.add(1,"month")),nt("month")},Wt=()=>{z.value=z.value.add(1,"year"),nt("year")},Fe=()=>{z.value=z.value.add(1,"month"),nt("month")},cn=()=>{F.value=F.value.subtract(1,"year"),nt("year")},Re=()=>{F.value=F.value.subtract(1,"month"),nt("month")},nt=ct=>{t("panel-change",[z.value.toDate(),F.value.toDate()],ct)},Qe=ee(()=>{const ct=(We.value+1)%12,Ut=We.value+1>=12?1:0;return i.unlinkPanels&&new Date(ke.value+Ut,ct)<new Date(we.value,be.value)}),Yt=ee(()=>i.unlinkPanels&&we.value*12+be.value-(ke.value*12+We.value+1)>=12),Xt=ee(()=>!(B.value&&N.value&&!j.value.selecting&&zm([B.value,N.value]))),$t=ee(()=>i.type==="datetime"||i.type==="datetimerange"),Ot=(ct,Ut)=>{if(ct)return _?lr(_[Ut]||_).locale(k.value).year(ct.year()).month(ct.month()).date(ct.date()):ct},Ft=(ct,Ut=!0)=>{const tt=ct.minDate,yn=ct.maxDate,wn=Ot(tt,0),sr=Ot(yn,1);N.value===sr&&B.value===wn||(t("calendar-change",[tt.toDate(),yn&&yn.toDate()]),N.value=sr,B.value=wn,!(!Ut||$t.value)&&q())},sn=Se(!1),an=Se(!1),Pn=()=>{sn.value=!1},bn=()=>{an.value=!1},It=(ct,Ut)=>{ce.value[Ut]=ct;const tt=lr(ct,Pe.value).locale(k.value);if(tt.isValid()){if(d&&d(tt.toDate()))return;Ut==="min"?(z.value=tt,B.value=(B.value||z.value).year(tt.year()).month(tt.month()).date(tt.date()),!i.unlinkPanels&&(!N.value||N.value.isBefore(B.value))&&(F.value=tt.add(1,"month"),N.value=B.value.add(1,"month"))):(F.value=tt,N.value=(N.value||F.value).year(tt.year()).month(tt.month()).date(tt.date()),!i.unlinkPanels&&(!B.value||B.value.isAfter(N.value))&&(z.value=tt.subtract(1,"month"),B.value=N.value.subtract(1,"month")))}},Sn=(ct,Ut)=>{ce.value[Ut]=null},Yn=(ct,Ut)=>{le.value[Ut]=ct;const tt=lr(ct,bt.value).locale(k.value);tt.isValid()&&(Ut==="min"?(sn.value=!0,B.value=(B.value||z.value).hour(tt.hour()).minute(tt.minute()).second(tt.second())):(an.value=!0,N.value=(N.value||F.value).hour(tt.hour()).minute(tt.minute()).second(tt.second()),F.value=N.value))},vr=(ct,Ut)=>{le.value[Ut]=null,Ut==="min"?(z.value=B.value,sn.value=!1,(!N.value||N.value.isBefore(B.value))&&(N.value=B.value)):(F.value=N.value,an.value=!1,N.value&&N.value.isBefore(B.value)&&(B.value=N.value))},tr=(ct,Ut,tt)=>{le.value.min||(ct&&(z.value=ct,B.value=(B.value||z.value).hour(ct.hour()).minute(ct.minute()).second(ct.second())),tt||(sn.value=Ut),(!N.value||N.value.isBefore(B.value))&&(N.value=B.value,F.value=ct))},zr=(ct,Ut,tt)=>{le.value.max||(ct&&(F.value=ct,N.value=(N.value||F.value).hour(ct.hour()).minute(ct.minute()).second(ct.second())),tt||(an.value=Ut),N.value&&N.value.isBefore(B.value)&&(B.value=N.value))},Cr=()=>{z.value=IE(b(M),{lang:b(k),unit:"month",unlinkPanels:i.unlinkPanels})[0],F.value=z.value.add(1,"month"),N.value=void 0,B.value=void 0,t("pick",null)},Io=ct=>ln(ct)?ct.map(Ut=>Ut.format(S.value)):ct.format(S.value),jn=ct=>ln(ct)?ct.map(Ut=>lr(Ut,S.value).locale(k.value)):lr(ct,S.value).locale(k.value);function Gt(ct,Ut){if(i.unlinkPanels&&Ut){const tt=(ct==null?void 0:ct.year())||0,yn=(ct==null?void 0:ct.month())||0,wn=Ut.year(),sr=Ut.month();F.value=tt===wn&&yn===sr?Ut.add(1,kb):Ut}else F.value=z.value.add(1,kb),Ut&&(F.value=F.value.hour(Ut.hour()).minute(Ut.minute()).second(Ut.second()))}return t("set-picker-option",["isValidValue",wt]),t("set-picker-option",["parseUserInput",jn]),t("set-picker-option",["formatToString",Io]),t("set-picker-option",["handleClear",Cr]),(ct,Ut)=>(ae(),Oe("div",{class:pe([b(U).b(),b(te).b(),{"has-sidebar":ct.$slots.sidebar||b(Me),"has-time":b($t)}])},[Ue("div",{class:pe(b(U).e("body-wrapper"))},[pt(ct.$slots,"sidebar",{class:pe(b(U).e("sidebar"))}),b(Me)?(ae(),Oe("div",{key:0,class:pe(b(U).e("sidebar"))},[(ae(!0),Oe(Bn,null,Or(b(C),(tt,yn)=>(ae(),Oe("button",{key:yn,type:"button",class:pe(b(U).e("shortcut")),onClick:wn=>b(J)(tt)},pn(tt.text),11,["onClick"]))),128))],2)):yt("v-if",!0),Ue("div",{class:pe(b(U).e("body"))},[b($t)?(ae(),Oe("div",{key:0,class:pe(b(te).e("time-header"))},[Ue("span",{class:pe(b(te).e("editors-wrap"))},[Ue("span",{class:pe(b(te).e("time-picker-wrap"))},[Ze(b(Us),{size:"small",disabled:b(j).selecting,placeholder:b(fe)("el.datepicker.startDate"),class:pe(b(te).e("editor")),"model-value":b(Ae),"validate-event":!1,onInput:tt=>It(tt,"min"),onChange:tt=>Sn(tt,"min")},null,8,["disabled","placeholder","class","model-value","onInput","onChange"])],2),hr((ae(),Oe("span",{class:pe(b(te).e("time-picker-wrap"))},[Ze(b(Us),{size:"small",class:pe(b(te).e("editor")),disabled:b(j).selecting,placeholder:b(fe)("el.datepicker.startTime"),"model-value":b(Be),"validate-event":!1,onFocus:tt=>sn.value=!0,onInput:tt=>Yn(tt,"min"),onChange:tt=>vr(tt,"min")},null,8,["class","disabled","placeholder","model-value","onFocus","onInput","onChange"]),Ze(b(C1),{visible:sn.value,format:b(bt),"datetime-role":"start","parsed-value":z.value,onPick:tr},null,8,["visible","format","parsed-value"])],2)),[[b(Bu),Pn]])],2),Ue("span",null,[Ze(b(On),null,{default:st(()=>[Ze(b(ca))]),_:1})]),Ue("span",{class:pe([b(te).e("editors-wrap"),"is-right"])},[Ue("span",{class:pe(b(te).e("time-picker-wrap"))},[Ze(b(Us),{size:"small",class:pe(b(te).e("editor")),disabled:b(j).selecting,placeholder:b(fe)("el.datepicker.endDate"),"model-value":b(me),readonly:!b(B),"validate-event":!1,onInput:tt=>It(tt,"max"),onChange:tt=>Sn(tt,"max")},null,8,["class","disabled","placeholder","model-value","readonly","onInput","onChange"])],2),hr((ae(),Oe("span",{class:pe(b(te).e("time-picker-wrap"))},[Ze(b(Us),{size:"small",class:pe(b(te).e("editor")),disabled:b(j).selecting,placeholder:b(fe)("el.datepicker.endTime"),"model-value":b(Ve),readonly:!b(B),"validate-event":!1,onFocus:tt=>b(B)&&(an.value=!0),onInput:tt=>Yn(tt,"max"),onChange:tt=>vr(tt,"max")},null,8,["class","disabled","placeholder","model-value","readonly","onFocus","onInput","onChange"]),Ze(b(C1),{"datetime-role":"end",visible:an.value,format:b(bt),"parsed-value":F.value,onPick:zr},null,8,["visible","format","parsed-value"])],2)),[[b(Bu),bn]])],2)],2)):yt("v-if",!0),Ue("div",{class:pe([[b(U).e("content"),b(te).e("content")],"is-left"])},[Ue("div",{class:pe(b(te).e("header"))},[Ue("button",{type:"button",class:pe([b(U).e("icon-btn"),"d-arrow-left"]),"aria-label":b(fe)("el.datepicker.prevYear"),onClick:Mt},[pt(ct.$slots,"prev-year",{},()=>[Ze(b(On),null,{default:st(()=>[Ze(b(Zd))]),_:1})])],10,["aria-label"]),Ue("button",{type:"button",class:pe([b(U).e("icon-btn"),"arrow-left"]),"aria-label":b(fe)("el.datepicker.prevMonth"),onClick:Nt},[pt(ct.$slots,"prev-month",{},()=>[Ze(b(On),null,{default:st(()=>[Ze(b(Kd))]),_:1})])],10,["aria-label"]),ct.unlinkPanels?(ae(),Oe("button",{key:0,type:"button",disabled:!b(Yt),class:pe([[b(U).e("icon-btn"),{"is-disabled":!b(Yt)}],"d-arrow-right"]),"aria-label":b(fe)("el.datepicker.nextYear"),onClick:Wt},[pt(ct.$slots,"next-year",{},()=>[Ze(b(On),null,{default:st(()=>[Ze(b(Yd))]),_:1})])],10,["disabled","aria-label"])):yt("v-if",!0),ct.unlinkPanels?(ae(),Oe("button",{key:1,type:"button",disabled:!b(Qe),class:pe([[b(U).e("icon-btn"),{"is-disabled":!b(Qe)}],"arrow-right"]),"aria-label":b(fe)("el.datepicker.nextMonth"),onClick:Fe},[pt(ct.$slots,"next-month",{},()=>[Ze(b(On),null,{default:st(()=>[Ze(b(ca))]),_:1})])],10,["disabled","aria-label"])):yt("v-if",!0),Ue("div",null,pn(b(ge)),1)],2),Ze(fT,{"selection-mode":"range",date:z.value,"min-date":b(B),"max-date":b(N),"range-state":b(j),"disabled-date":b(d),"cell-class-name":b(p),onChangerange:b(Y),onPick:Ft,onSelect:b(ne)},null,8,["date","min-date","max-date","range-state","disabled-date","cell-class-name","onChangerange","onSelect"])],2),Ue("div",{class:pe([[b(U).e("content"),b(te).e("content")],"is-right"])},[Ue("div",{class:pe(b(te).e("header"))},[ct.unlinkPanels?(ae(),Oe("button",{key:0,type:"button",disabled:!b(Yt),class:pe([[b(U).e("icon-btn"),{"is-disabled":!b(Yt)}],"d-arrow-left"]),"aria-label":b(fe)("el.datepicker.prevYear"),onClick:cn},[pt(ct.$slots,"prev-year",{},()=>[Ze(b(On),null,{default:st(()=>[Ze(b(Zd))]),_:1})])],10,["disabled","aria-label"])):yt("v-if",!0),ct.unlinkPanels?(ae(),Oe("button",{key:1,type:"button",disabled:!b(Qe),class:pe([[b(U).e("icon-btn"),{"is-disabled":!b(Qe)}],"arrow-left"]),"aria-label":b(fe)("el.datepicker.prevMonth"),onClick:Re},[pt(ct.$slots,"prev-month",{},()=>[Ze(b(On),null,{default:st(()=>[Ze(b(Kd))]),_:1})])],10,["disabled","aria-label"])):yt("v-if",!0),Ue("button",{type:"button","aria-label":b(fe)("el.datepicker.nextYear"),class:pe([b(U).e("icon-btn"),"d-arrow-right"]),onClick:vt},[pt(ct.$slots,"next-year",{},()=>[Ze(b(On),null,{default:st(()=>[Ze(b(Yd))]),_:1})])],10,["aria-label"]),Ue("button",{type:"button",class:pe([b(U).e("icon-btn"),"arrow-right"]),"aria-label":b(fe)("el.datepicker.nextMonth"),onClick:Bt},[pt(ct.$slots,"next-month",{},()=>[Ze(b(On),null,{default:st(()=>[Ze(b(ca))]),_:1})])],10,["aria-label"]),Ue("div",null,pn(b(de)),1)],2),Ze(fT,{"selection-mode":"range",date:F.value,"min-date":b(B),"max-date":b(N),"range-state":b(j),"disabled-date":b(d),"cell-class-name":b(p),onChangerange:b(Y),onPick:Ft,onSelect:b(ne)},null,8,["date","min-date","max-date","range-state","disabled-date","cell-class-name","onChangerange","onSelect"])],2)],2)],2),b($t)?(ae(),Oe("div",{key:0,class:pe(b(U).e("footer"))},[b(r)?(ae(),kt(b(ss),{key:0,text:"",size:"small",class:pe(b(U).e("link-btn")),onClick:Cr},{default:st(()=>[Rr(pn(b(fe)("el.datepicker.clear")),1)]),_:1},8,["class"])):yt("v-if",!0),Ze(b(ss),{plain:"",size:"small",class:pe(b(U).e("link-btn")),disabled:b(Xt),onClick:tt=>b(q)(!1)},{default:st(()=>[Rr(pn(b(fe)("el.datepicker.confirm")),1)]),_:1},8,["class","disabled","onClick"])],2)):yt("v-if",!0)],2))}});var Xte=fn(Yte,[["__file","panel-date-range.vue"]]);const Jte=un({...EE}),Qte=["pick","set-picker-option","calendar-change"],ene=({unlinkPanels:e,leftDate:t,rightDate:i})=>{const{t:a}=Gr(),d=()=>{t.value=t.value.subtract(1,"year"),e.value||(i.value=i.value.subtract(1,"year"))},p=()=>{e.value||(t.value=t.value.add(1,"year")),i.value=i.value.add(1,"year")},_=()=>{t.value=t.value.add(1,"year")},r=()=>{i.value=i.value.subtract(1,"year")},S=ee(()=>`${t.value.year()} ${a("el.datepicker.year")}`),C=ee(()=>`${i.value.year()} ${a("el.datepicker.year")}`),M=ee(()=>t.value.year()),k=ee(()=>i.value.year()===t.value.year()?t.value.year()+1:i.value.year());return{leftPrevYear:d,rightNextYear:p,leftNextYear:_,rightPrevYear:r,leftLabel:S,rightLabel:C,leftYear:M,rightYear:k}},Pb="year",tne=qe({name:"DatePickerMonthRange"}),nne=qe({...tne,props:Jte,emits:Qte,setup(e,{emit:t}){const i=e,{lang:a}=Gr(),d=An("EP_PICKER_BASE"),{shortcuts:p,disabledDate:_}=d.props,r=po(d.props,"format"),S=po(d.props,"defaultValue"),C=Se(lr().locale(a.value)),M=Se(lr().locale(a.value).add(1,Pb)),{minDate:k,maxDate:z,rangeState:F,ppNs:B,drpNs:N,handleChangeRange:j,handleRangeConfirm:U,handleShortcutClick:te,onSelect:Y}=s4(i,{defaultValue:S,leftDate:C,rightDate:M,unit:Pb,onParsedValueChanged:Ae}),q=ee(()=>!!p.length),{leftPrevYear:J,rightNextYear:ne,leftNextYear:se,rightPrevYear:fe,leftLabel:ce,rightLabel:le,leftYear:ge,rightYear:de}=ene({unlinkPanels:po(i,"unlinkPanels"),leftDate:C,rightDate:M}),ke=ee(()=>i.unlinkPanels&&de.value>ge.value+1),We=(me,Be=!0)=>{const Ve=me.minDate,bt=me.maxDate;z.value===bt&&k.value===Ve||(t("calendar-change",[Ve.toDate(),bt&&bt.toDate()]),z.value=bt,k.value=Ve,Be&&U())},we=()=>{C.value=IE(b(S),{lang:b(a),unit:"year",unlinkPanels:i.unlinkPanels})[0],M.value=C.value.add(1,"year"),t("pick",null)},be=me=>ln(me)?me.map(Be=>Be.format(r.value)):me.format(r.value),Me=me=>ln(me)?me.map(Be=>lr(Be,r.value).locale(a.value)):lr(me,r.value).locale(a.value);function Ae(me,Be){if(i.unlinkPanels&&Be){const Ve=(me==null?void 0:me.year())||0,bt=Be.year();M.value=Ve===bt?Be.add(1,Pb):Be}else M.value=C.value.add(1,Pb)}return t("set-picker-option",["isValidValue",zm]),t("set-picker-option",["formatToString",be]),t("set-picker-option",["parseUserInput",Me]),t("set-picker-option",["handleClear",we]),(me,Be)=>(ae(),Oe("div",{class:pe([b(B).b(),b(N).b(),{"has-sidebar":!!me.$slots.sidebar||b(q)}])},[Ue("div",{class:pe(b(B).e("body-wrapper"))},[pt(me.$slots,"sidebar",{class:pe(b(B).e("sidebar"))}),b(q)?(ae(),Oe("div",{key:0,class:pe(b(B).e("sidebar"))},[(ae(!0),Oe(Bn,null,Or(b(p),(Ve,bt)=>(ae(),Oe("button",{key:bt,type:"button",class:pe(b(B).e("shortcut")),onClick:Pe=>b(te)(Ve)},pn(Ve.text),11,["onClick"]))),128))],2)):yt("v-if",!0),Ue("div",{class:pe(b(B).e("body"))},[Ue("div",{class:pe([[b(B).e("content"),b(N).e("content")],"is-left"])},[Ue("div",{class:pe(b(N).e("header"))},[Ue("button",{type:"button",class:pe([b(B).e("icon-btn"),"d-arrow-left"]),onClick:b(J)},[pt(me.$slots,"prev-year",{},()=>[Ze(b(On),null,{default:st(()=>[Ze(b(Zd))]),_:1})])],10,["onClick"]),me.unlinkPanels?(ae(),Oe("button",{key:0,type:"button",disabled:!b(ke),class:pe([[b(B).e("icon-btn"),{[b(B).is("disabled")]:!b(ke)}],"d-arrow-right"]),onClick:b(se)},[pt(me.$slots,"next-year",{},()=>[Ze(b(On),null,{default:st(()=>[Ze(b(Yd))]),_:1})])],10,["disabled","onClick"])):yt("v-if",!0),Ue("div",null,pn(b(ce)),1)],2),Ze(pT,{"selection-mode":"range",date:C.value,"min-date":b(k),"max-date":b(z),"range-state":b(F),"disabled-date":b(_),onChangerange:b(j),onPick:We,onSelect:b(Y)},null,8,["date","min-date","max-date","range-state","disabled-date","onChangerange","onSelect"])],2),Ue("div",{class:pe([[b(B).e("content"),b(N).e("content")],"is-right"])},[Ue("div",{class:pe(b(N).e("header"))},[me.unlinkPanels?(ae(),Oe("button",{key:0,type:"button",disabled:!b(ke),class:pe([[b(B).e("icon-btn"),{"is-disabled":!b(ke)}],"d-arrow-left"]),onClick:b(fe)},[pt(me.$slots,"prev-year",{},()=>[Ze(b(On),null,{default:st(()=>[Ze(b(Zd))]),_:1})])],10,["disabled","onClick"])):yt("v-if",!0),Ue("button",{type:"button",class:pe([b(B).e("icon-btn"),"d-arrow-right"]),onClick:b(ne)},[pt(me.$slots,"next-year",{},()=>[Ze(b(On),null,{default:st(()=>[Ze(b(Yd))]),_:1})])],10,["onClick"]),Ue("div",null,pn(b(le)),1)],2),Ze(pT,{"selection-mode":"range",date:M.value,"min-date":b(k),"max-date":b(z),"range-state":b(F),"disabled-date":b(_),onChangerange:b(j),onPick:We,onSelect:b(Y)},null,8,["date","min-date","max-date","range-state","disabled-date","onChangerange","onSelect"])],2)],2)],2)],2))}});var rne=fn(nne,[["__file","panel-month-range.vue"]]);const one=un({...EE}),ine=["pick","set-picker-option","calendar-change"],sne=({unlinkPanels:e,leftDate:t,rightDate:i})=>{const a=()=>{t.value=t.value.subtract(10,"year"),e.value||(i.value=i.value.subtract(10,"year"))},d=()=>{e.value||(t.value=t.value.add(10,"year")),i.value=i.value.add(10,"year")},p=()=>{t.value=t.value.add(10,"year")},_=()=>{i.value=i.value.subtract(10,"year")},r=ee(()=>{const k=Math.floor(t.value.year()/10)*10;return`${k}-${k+9}`}),S=ee(()=>{const k=Math.floor(i.value.year()/10)*10;return`${k}-${k+9}`}),C=ee(()=>Math.floor(t.value.year()/10)*10+9),M=ee(()=>Math.floor(i.value.year()/10)*10);return{leftPrevYear:a,rightNextYear:d,leftNextYear:p,rightPrevYear:_,leftLabel:r,rightLabel:S,leftYear:C,rightYear:M}},CR="year",ane=qe({name:"DatePickerYearRange"}),lne=qe({...ane,props:one,emits:ine,setup(e,{emit:t}){const i=e,{lang:a}=Gr(),d=Se(lr().locale(a.value)),p=Se(d.value.add(10,"year")),{pickerNs:_}=An(xx),r=en("date-range-picker"),S=ee(()=>!!We.length),C=ee(()=>[_.b(),r.b(),{"has-sidebar":!!Hi().sidebar||S.value}]),M=ee(()=>({content:[_.e("content"),r.e("content"),"is-left"],arrowLeftBtn:[_.e("icon-btn"),"d-arrow-left"],arrowRightBtn:[_.e("icon-btn"),{[_.is("disabled")]:!J.value},"d-arrow-right"]})),k=ee(()=>({content:[_.e("content"),r.e("content"),"is-right"],arrowLeftBtn:[_.e("icon-btn"),{"is-disabled":!J.value},"d-arrow-left"],arrowRightBtn:[_.e("icon-btn"),"d-arrow-right"]})),z=i4(a),{leftPrevYear:F,rightNextYear:B,leftNextYear:N,rightPrevYear:j,leftLabel:U,rightLabel:te,leftYear:Y,rightYear:q}=sne({unlinkPanels:po(i,"unlinkPanels"),leftDate:d,rightDate:p}),J=ee(()=>i.unlinkPanels&&q.value>Y.value+1),ne=Se(),se=Se(),fe=Se({endDate:null,selecting:!1}),ce=Pe=>{fe.value=Pe},le=(Pe,wt=!0)=>{const Mt=Pe.minDate,Nt=Pe.maxDate;se.value===Nt&&ne.value===Mt||(t("calendar-change",[Mt.toDate(),Nt&&Nt.toDate()]),se.value=Nt,ne.value=Mt,wt&&ge())},ge=(Pe=!1)=>{zm([ne.value,se.value])&&t("pick",[ne.value,se.value],Pe)},de=Pe=>{fe.value.selecting=Pe,Pe||(fe.value.endDate=null)},ke=An("EP_PICKER_BASE"),{shortcuts:We,disabledDate:we}=ke.props,be=po(ke.props,"format"),Me=po(ke.props,"defaultValue"),Ae=()=>{let Pe;if(ln(Me.value)){const wt=lr(Me.value[0]);let Mt=lr(Me.value[1]);return i.unlinkPanels||(Mt=wt.add(10,CR)),[wt,Mt]}else Me.value?Pe=lr(Me.value):Pe=lr();return Pe=Pe.locale(a.value),[Pe,Pe.add(10,CR)]};qt(()=>Me.value,Pe=>{if(Pe){const wt=Ae();d.value=wt[0],p.value=wt[1]}},{immediate:!0}),qt(()=>i.parsedValue,Pe=>{if(Pe&&Pe.length===2)if(ne.value=Pe[0],se.value=Pe[1],d.value=ne.value,i.unlinkPanels&&se.value){const wt=ne.value.year(),Mt=se.value.year();p.value=wt===Mt?se.value.add(10,"year"):se.value}else p.value=d.value.add(10,"year");else{const wt=Ae();ne.value=void 0,se.value=void 0,d.value=wt[0],p.value=wt[1]}},{immediate:!0});const me=Pe=>ln(Pe)?Pe.map(wt=>lr(wt,be.value).locale(a.value)):lr(Pe,be.value).locale(a.value),Be=Pe=>ln(Pe)?Pe.map(wt=>wt.format(be.value)):Pe.format(be.value),Ve=Pe=>zm(Pe)&&(we?!we(Pe[0].toDate())&&!we(Pe[1].toDate()):!0),bt=()=>{const Pe=Ae();d.value=Pe[0],p.value=Pe[1],se.value=void 0,ne.value=void 0,t("pick",null)};return t("set-picker-option",["isValidValue",Ve]),t("set-picker-option",["parseUserInput",me]),t("set-picker-option",["formatToString",Be]),t("set-picker-option",["handleClear",bt]),(Pe,wt)=>(ae(),Oe("div",{class:pe(b(C))},[Ue("div",{class:pe(b(_).e("body-wrapper"))},[pt(Pe.$slots,"sidebar",{class:pe(b(_).e("sidebar"))}),b(S)?(ae(),Oe("div",{key:0,class:pe(b(_).e("sidebar"))},[(ae(!0),Oe(Bn,null,Or(b(We),(Mt,Nt)=>(ae(),Oe("button",{key:Nt,type:"button",class:pe(b(_).e("shortcut")),onClick:vt=>b(z)(Mt)},pn(Mt.text),11,["onClick"]))),128))],2)):yt("v-if",!0),Ue("div",{class:pe(b(_).e("body"))},[Ue("div",{class:pe(b(M).content)},[Ue("div",{class:pe(b(r).e("header"))},[Ue("button",{type:"button",class:pe(b(M).arrowLeftBtn),onClick:b(F)},[pt(Pe.$slots,"prev-year",{},()=>[Ze(b(On),null,{default:st(()=>[Ze(b(Zd))]),_:1})])],10,["onClick"]),Pe.unlinkPanels?(ae(),Oe("button",{key:0,type:"button",disabled:!b(J),class:pe(b(M).arrowRightBtn),onClick:b(N)},[pt(Pe.$slots,"next-year",{},()=>[Ze(b(On),null,{default:st(()=>[Ze(b(Yd))]),_:1})])],10,["disabled","onClick"])):yt("v-if",!0),Ue("div",null,pn(b(U)),1)],2),Ze(mT,{"selection-mode":"range",date:d.value,"min-date":ne.value,"max-date":se.value,"range-state":fe.value,"disabled-date":b(we),onChangerange:ce,onPick:le,onSelect:de},null,8,["date","min-date","max-date","range-state","disabled-date"])],2),Ue("div",{class:pe(b(k).content)},[Ue("div",{class:pe(b(r).e("header"))},[Pe.unlinkPanels?(ae(),Oe("button",{key:0,type:"button",disabled:!b(J),class:pe(b(k).arrowLeftBtn),onClick:b(j)},[pt(Pe.$slots,"prev-year",{},()=>[Ze(b(On),null,{default:st(()=>[Ze(b(Zd))]),_:1})])],10,["disabled","onClick"])):yt("v-if",!0),Ue("button",{type:"button",class:pe(b(k).arrowRightBtn),onClick:b(B)},[pt(Pe.$slots,"next-year",{},()=>[Ze(b(On),null,{default:st(()=>[Ze(b(Yd))]),_:1})])],10,["onClick"]),Ue("div",null,pn(b(te)),1)],2),Ze(mT,{"selection-mode":"range",date:p.value,"min-date":ne.value,"max-date":se.value,"range-state":fe.value,"disabled-date":b(we),onChangerange:ce,onPick:le,onSelect:de},null,8,["date","min-date","max-date","range-state","disabled-date"])],2)],2)],2)],2))}});var cne=fn(lne,[["__file","panel-year-range.vue"]]);const une=function(e){switch(e){case"daterange":case"datetimerange":return Xte;case"monthrange":return rne;case"yearrange":return cne;default:return Kte}};lr.extend(_F);lr.extend(ote);lr.extend(SE);lr.extend(ste);lr.extend(lte);lr.extend(ute);lr.extend(hte);lr.extend(pte);var dne=qe({name:"ElDatePicker",install:null,props:Ote,emits:["update:modelValue"],setup(e,{expose:t,emit:i,slots:a}){const d=en("picker-panel");Dr("ElPopperOptions",lo(po(e,"popperOptions"))),Dr(xx,{slots:a,pickerNs:d});const p=Se();t({focus:()=>{var S;(S=p.value)==null||S.focus()},blur:()=>{var S;(S=p.value)==null||S.blur()},handleOpen:()=>{var S;(S=p.value)==null||S.handleOpen()},handleClose:()=>{var S;(S=p.value)==null||S.handleClose()}});const r=S=>{i("update:modelValue",S)};return()=>{var S;const C=(S=e.format)!=null?S:mte[e.type]||am,M=une(e.type);return Ze(QF,Mr(e,{format:C,type:e.type,ref:p,"onUpdate:modelValue":r}),{default:k=>Ze(M,k,{"prev-month":a["prev-month"],"next-month":a["next-month"],"prev-year":a["prev-year"],"next-year":a["next-year"]}),"range-separator":a["range-separator"]})}}});const hne=ur(dne),kE=Symbol("elDescriptions");var u_=qe({name:"ElDescriptionsCell",props:{cell:{type:Object},tag:{type:String,default:"td"},type:{type:String}},setup(){return{descriptions:An(kE,{})}},render(){var e;const t=SJ(this.cell),i=(((e=this.cell)==null?void 0:e.dirs)||[]).map(U=>{const{dir:te,arg:Y,modifiers:q,value:J}=U;return[te,J,Y,q]}),{border:a,direction:d}=this.descriptions,p=d==="vertical",_=()=>{var U,te,Y;return((Y=(te=(U=this.cell)==null?void 0:U.children)==null?void 0:te.label)==null?void 0:Y.call(te))||t.label},r=()=>{var U,te,Y;return(Y=(te=(U=this.cell)==null?void 0:U.children)==null?void 0:te.default)==null?void 0:Y.call(te)},S=t.span,C=t.rowspan,M=t.align?`is-${t.align}`:"",k=t.labelAlign?`is-${t.labelAlign}`:M,z=t.className,F=t.labelClassName,B=this.type==="label"&&(t.labelWidth||this.descriptions.labelWidth)||t.width,N={width:ui(B),minWidth:ui(t.minWidth)},j=en("descriptions");switch(this.type){case"label":return hr(Kn(this.tag,{style:N,class:[j.e("cell"),j.e("label"),j.is("bordered-label",a),j.is("vertical-label",p),k,F],colSpan:p?S:1,rowspan:p?1:C},_()),i);case"content":return hr(Kn(this.tag,{style:N,class:[j.e("cell"),j.e("content"),j.is("bordered-content",a),j.is("vertical-content",p),M,z],colSpan:p?S:S*2-1,rowspan:p?C*2-1:C},r()),i);default:{const U=_(),te={},Y=ui(t.labelWidth||this.descriptions.labelWidth);return Y&&(te.width=Y,te.display="inline-block"),hr(Kn("td",{style:N,class:[j.e("cell"),M],colSpan:S,rowspan:C},[Ki(U)?void 0:Kn("span",{style:te,class:[j.e("label"),F]},U),Kn("span",{class:[j.e("content"),z]},r())]),i)}}}});const fne=un({row:{type:dt(Array),default:()=>[]}}),pne=qe({name:"ElDescriptionsRow"}),mne=qe({...pne,props:fne,setup(e){const t=An(kE,{});return(i,a)=>b(t).direction==="vertical"?(ae(),Oe(Bn,{key:0},[Ue("tr",null,[(ae(!0),Oe(Bn,null,Or(i.row,(d,p)=>(ae(),kt(b(u_),{key:`tr1-${p}`,cell:d,tag:"th",type:"label"},null,8,["cell"]))),128))]),Ue("tr",null,[(ae(!0),Oe(Bn,null,Or(i.row,(d,p)=>(ae(),kt(b(u_),{key:`tr2-${p}`,cell:d,tag:"td",type:"content"},null,8,["cell"]))),128))])],64)):(ae(),Oe("tr",{key:1},[(ae(!0),Oe(Bn,null,Or(i.row,(d,p)=>(ae(),Oe(Bn,{key:`tr3-${p}`},[b(t).border?(ae(),Oe(Bn,{key:0},[Ze(b(u_),{cell:d,tag:"td",type:"label"},null,8,["cell"]),Ze(b(u_),{cell:d,tag:"td",type:"content"},null,8,["cell"])],64)):(ae(),kt(b(u_),{key:1,cell:d,tag:"td",type:"both"},null,8,["cell"]))],64))),128))]))}});var gne=fn(mne,[["__file","descriptions-row.vue"]]);const vne=un({border:Boolean,column:{type:Number,default:3},direction:{type:String,values:["horizontal","vertical"],default:"horizontal"},size:zi,title:{type:String,default:""},extra:{type:String,default:""},labelWidth:{type:[String,Number],default:""}}),_ne=qe({name:"ElDescriptions"}),yne=qe({..._ne,props:vne,setup(e){const t=e,i=en("descriptions"),a=Li(),d=Hi();Dr(kE,t);const p=ee(()=>[i.b(),i.m(a.value)]),_=(S,C,M,k=!1)=>(S.props||(S.props={}),C>M&&(S.props.span=M),k&&(S.props.span=C),S),r=()=>{if(!d.default)return[];const S=Ou(d.default()).filter(B=>{var N;return((N=B==null?void 0:B.type)==null?void 0:N.name)==="ElDescriptionsItem"}),C=[];let M=[],k=t.column,z=0;const F=[];return S.forEach((B,N)=>{var j,U,te;const Y=((j=B.props)==null?void 0:j.span)||1,q=((U=B.props)==null?void 0:U.rowspan)||1,J=C.length;if(F[J]||(F[J]=0),q>1)for(let ne=1;ne<q;ne++)F[te=J+ne]||(F[te]=0),F[J+ne]++,z++;if(F[J]>0&&(k-=F[J],F[J]=0),N<S.length-1&&(z+=Y>k?k:Y),N===S.length-1){const ne=t.column-z%t.column;M.push(_(B,ne,k,!0)),C.push(M);return}Y<k?(k-=Y,M.push(B)):(M.push(_(B,Y,k)),C.push(M),k=t.column,M=[])}),C};return(S,C)=>(ae(),Oe("div",{class:pe(b(p))},[S.title||S.extra||S.$slots.title||S.$slots.extra?(ae(),Oe("div",{key:0,class:pe(b(i).e("header"))},[Ue("div",{class:pe(b(i).e("title"))},[pt(S.$slots,"title",{},()=>[Rr(pn(S.title),1)])],2),Ue("div",{class:pe(b(i).e("extra"))},[pt(S.$slots,"extra",{},()=>[Rr(pn(S.extra),1)])],2)],2)):yt("v-if",!0),Ue("div",{class:pe(b(i).e("body"))},[Ue("table",{class:pe([b(i).e("table"),b(i).is("bordered",S.border)])},[Ue("tbody",null,[(ae(!0),Oe(Bn,null,Or(r(),(M,k)=>(ae(),kt(gne,{key:k,row:M},null,8,["row"]))),128))])],2)],2)],2))}});var bne=fn(yne,[["__file","description.vue"]]);const xne=un({label:{type:String,default:""},span:{type:Number,default:1},rowspan:{type:Number,default:1},width:{type:[String,Number],default:""},minWidth:{type:[String,Number],default:""},labelWidth:{type:[String,Number],default:""},align:{type:String,default:"left"},labelAlign:{type:String,default:""},className:{type:String,default:""},labelClassName:{type:String,default:""}}),a4=qe({name:"ElDescriptionsItem",props:xne}),wne=ur(bne,{DescriptionsItem:a4}),Sne=ri(a4),PE=e=>{if(!e)return{onClick:_o,onMousedown:_o,onMouseup:_o};let t=!1,i=!1;return{onClick:_=>{t&&i&&e(_),t=i=!1},onMousedown:_=>{t=_.target===_.currentTarget},onMouseup:_=>{i=_.target===_.currentTarget}}},Tne=un({mask:{type:Boolean,default:!0},customMaskEvent:Boolean,overlayClass:{type:dt([String,Array,Object])},zIndex:{type:dt([String,Number])}}),Cne={click:e=>e instanceof MouseEvent},Ene="overlay";var Mne=qe({name:"ElOverlay",props:Tne,emits:Cne,setup(e,{slots:t,emit:i}){const a=en(Ene),d=S=>{i("click",S)},{onClick:p,onMousedown:_,onMouseup:r}=PE(e.customMaskEvent?void 0:d);return()=>e.mask?Ze("div",{class:[a.b(),e.overlayClass],style:{zIndex:e.zIndex},onClick:p,onMousedown:_,onMouseup:r},[pt(t,"default")],vl.STYLE|vl.CLASS|vl.PROPS,["onClick","onMouseup","onMousedown"]):Kn("div",{class:e.overlayClass,style:{zIndex:e.zIndex,position:"fixed",top:"0px",right:"0px",bottom:"0px",left:"0px"}},[pt(t,"default")])}});const RE=Mne,l4=Symbol("dialogInjectionKey"),c4=un({center:Boolean,alignCenter:Boolean,closeIcon:{type:Mo},draggable:Boolean,overflow:Boolean,fullscreen:Boolean,headerClass:String,bodyClass:String,footerClass:String,showClose:{type:Boolean,default:!0},title:{type:String,default:""},ariaLevel:{type:String,default:"2"}}),Ine={close:()=>!0},u4=(e,t,i,a)=>{let d={offsetX:0,offsetY:0};const p=C=>{const M=C.clientX,k=C.clientY,{offsetX:z,offsetY:F}=d,B=e.value.getBoundingClientRect(),N=B.left,j=B.top,U=B.width,te=B.height,Y=document.documentElement.clientWidth,q=document.documentElement.clientHeight,J=-N+z,ne=-j+F,se=Y-N-U+z,fe=q-j-te+F,ce=ge=>{let de=z+ge.clientX-M,ke=F+ge.clientY-k;a!=null&&a.value||(de=Math.min(Math.max(de,J),se),ke=Math.min(Math.max(ke,ne),fe)),d={offsetX:de,offsetY:ke},e.value&&(e.value.style.transform=`translate(${ui(de)}, ${ui(ke)})`)},le=()=>{document.removeEventListener("mousemove",ce),document.removeEventListener("mouseup",le)};document.addEventListener("mousemove",ce),document.addEventListener("mouseup",le)},_=()=>{t.value&&e.value&&t.value.addEventListener("mousedown",p)},r=()=>{t.value&&e.value&&t.value.removeEventListener("mousedown",p)},S=()=>{d={offsetX:0,offsetY:0},e.value&&(e.value.style.transform="none")};return gr(()=>{Cs(()=>{i.value?_():r()})}),Oo(()=>{r()}),{resetPosition:S}},wx=(...e)=>t=>{e.forEach(i=>{Nn(i)?i(t):i.value=t})},Ane=qe({name:"ElDialogContent"}),kne=qe({...Ane,props:c4,emits:Ine,setup(e,{expose:t}){const i=e,{t:a}=Gr(),{Close:d}=nE,{dialogRef:p,headerRef:_,bodyId:r,ns:S,style:C}=An(l4),{focusTrapRef:M}=An(lE),k=ee(()=>[S.b(),S.is("fullscreen",i.fullscreen),S.is("draggable",i.draggable),S.is("align-center",i.alignCenter),{[S.m("center")]:i.center}]),z=wx(M,p),F=ee(()=>i.draggable),B=ee(()=>i.overflow),{resetPosition:N}=u4(p,_,F,B);return t({resetPosition:N}),(j,U)=>(ae(),Oe("div",{ref:b(z),class:pe(b(k)),style:$n(b(C)),tabindex:"-1"},[Ue("header",{ref_key:"headerRef",ref:_,class:pe([b(S).e("header"),j.headerClass,{"show-close":j.showClose}])},[pt(j.$slots,"header",{},()=>[Ue("span",{role:"heading","aria-level":j.ariaLevel,class:pe(b(S).e("title"))},pn(j.title),11,["aria-level"])]),j.showClose?(ae(),Oe("button",{key:0,"aria-label":b(a)("el.dialog.close"),class:pe(b(S).e("headerbtn")),type:"button",onClick:te=>j.$emit("close")},[Ze(b(On),{class:pe(b(S).e("close"))},{default:st(()=>[(ae(),kt(Tr(j.closeIcon||b(d))))]),_:1},8,["class"])],10,["aria-label","onClick"])):yt("v-if",!0)],2),Ue("div",{id:b(r),class:pe([b(S).e("body"),j.bodyClass])},[pt(j.$slots,"default")],10,["id"]),j.$slots.footer?(ae(),Oe("footer",{key:0,class:pe([b(S).e("footer"),j.footerClass])},[pt(j.$slots,"footer")],2)):yt("v-if",!0)],6))}});var Pne=fn(kne,[["__file","dialog-content.vue"]]);const d4=un({...c4,appendToBody:Boolean,appendTo:{type:dt([String,Object]),default:"body"},beforeClose:{type:dt(Function)},destroyOnClose:Boolean,closeOnClickModal:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0},lockScroll:{type:Boolean,default:!0},modal:{type:Boolean,default:!0},openDelay:{type:Number,default:0},closeDelay:{type:Number,default:0},top:{type:String},modelValue:Boolean,modalClass:String,headerClass:String,bodyClass:String,footerClass:String,width:{type:[String,Number]},zIndex:{type:Number},trapFocus:Boolean,headerAriaLevel:{type:String,default:"2"}}),h4={open:()=>!0,opened:()=>!0,close:()=>!0,closed:()=>!0,[mr]:e=>Ro(e),openAutoFocus:()=>!0,closeAutoFocus:()=>!0},OE=(e,t={})=>{To(e)||ji("[useLockscreen]","You need to pass a ref param to this function");const i=t.ns||en("popup"),a=ee(()=>i.bm("parent","hidden"));if(!Hr||Aa(document.body,a.value))return;let d=0,p=!1,_="0";const r=()=>{setTimeout(()=>{typeof document>"u"||p&&document&&(document.body.style.width=_,js(document.body,a.value))},200)};qt(e,S=>{if(!S){r();return}p=!Aa(document.body,a.value),p&&(_=document.body.style.width,bl(document.body,a.value)),d=Tz(i.namespace.value);const C=document.documentElement.clientHeight<document.body.scrollHeight,M=Pu(document.body,"overflowY");d>0&&(C||M==="scroll")&&p&&(document.body.style.width=`calc(100% - ${d}px)`)}),mC(()=>r())},f4=(e,t)=>{var i;const d=wr().emit,{nextZIndex:p}=Jm();let _="";const r=vs(),S=vs(),C=Se(!1),M=Se(!1),k=Se(!1),z=Se((i=e.zIndex)!=null?i:p());let F,B;const N=hx("namespace",C_),j=ee(()=>{const we={},be=`--${N.value}-dialog`;return e.fullscreen||(e.top&&(we[`${be}-margin-top`]=e.top),e.width&&(we[`${be}-width`]=ui(e.width))),we}),U=ee(()=>e.alignCenter?{display:"flex"}:{});function te(){d("opened")}function Y(){d("closed"),d(mr,!1),e.destroyOnClose&&(k.value=!1)}function q(){d("close")}function J(){B==null||B(),F==null||F(),e.openDelay&&e.openDelay>0?{stop:F}=Of(()=>ce(),e.openDelay):ce()}function ne(){F==null||F(),B==null||B(),e.closeDelay&&e.closeDelay>0?{stop:B}=Of(()=>le(),e.closeDelay):le()}function se(){function we(be){be||(M.value=!0,C.value=!1)}e.beforeClose?e.beforeClose(we):ne()}function fe(){e.closeOnClickModal&&se()}function ce(){Hr&&(C.value=!0)}function le(){C.value=!1}function ge(){d("openAutoFocus")}function de(){d("closeAutoFocus")}function ke(we){var be;((be=we.detail)==null?void 0:be.focusReason)==="pointer"&&we.preventDefault()}e.lockScroll&&OE(C);function We(){e.closeOnPressEscape&&se()}return qt(()=>e.modelValue,we=>{we?(M.value=!1,J(),k.value=!0,z.value=sz(e.zIndex)?p():z.value++,Vn(()=>{d("open"),t.value&&(t.value.parentElement.scrollTop=0,t.value.parentElement.scrollLeft=0,t.value.scrollTop=0)})):C.value&&ne()}),qt(()=>e.fullscreen,we=>{t.value&&(we?(_=t.value.style.transform,t.value.style.transform=""):t.value.style.transform=_)}),gr(()=>{e.modelValue&&(C.value=!0,k.value=!0,J())}),{afterEnter:te,afterLeave:Y,beforeLeave:q,handleClose:se,onModalClick:fe,close:ne,doClose:le,onOpenAutoFocus:ge,onCloseAutoFocus:de,onCloseRequested:We,onFocusoutPrevented:ke,titleId:r,bodyId:S,closed:M,style:j,overlayDialogStyle:U,rendered:k,visible:C,zIndex:z}},Rne=qe({name:"ElDialog",inheritAttrs:!1}),One=qe({...Rne,props:d4,emits:h4,setup(e,{expose:t}){const i=e,a=Hi();Ud({scope:"el-dialog",from:"the title slot",replacement:"the header slot",version:"3.0.0",ref:"https://element-plus.org/en-US/component/dialog.html#slots"},ee(()=>!!a.title));const d=en("dialog"),p=Se(),_=Se(),r=Se(),{visible:S,titleId:C,bodyId:M,style:k,overlayDialogStyle:z,rendered:F,zIndex:B,afterEnter:N,afterLeave:j,beforeLeave:U,handleClose:te,onModalClick:Y,onOpenAutoFocus:q,onCloseAutoFocus:J,onCloseRequested:ne,onFocusoutPrevented:se}=f4(i,p);Dr(l4,{dialogRef:p,headerRef:_,bodyId:M,ns:d,rendered:F,style:k});const fe=PE(Y),ce=ee(()=>i.draggable&&!i.fullscreen);return t({visible:S,dialogContentRef:r,resetPosition:()=>{var ge;(ge=r.value)==null||ge.resetPosition()}}),(ge,de)=>(ae(),kt(b(tg),{to:ge.appendTo,disabled:ge.appendTo!=="body"?!1:!ge.appendToBody},{default:st(()=>[Ze(ls,{name:"dialog-fade",onAfterEnter:b(N),onAfterLeave:b(j),onBeforeLeave:b(U),persisted:""},{default:st(()=>[hr(Ze(b(RE),{"custom-mask-event":"",mask:ge.modal,"overlay-class":ge.modalClass,"z-index":b(B)},{default:st(()=>[Ue("div",{role:"dialog","aria-modal":"true","aria-label":ge.title||void 0,"aria-labelledby":ge.title?void 0:b(C),"aria-describedby":b(M),class:pe(`${b(d).namespace.value}-overlay-dialog`),style:$n(b(z)),onClick:b(fe).onClick,onMousedown:b(fe).onMousedown,onMouseup:b(fe).onMouseup},[Ze(b(eg),{loop:"",trapped:b(S),"focus-start-el":"container",onFocusAfterTrapped:b(q),onFocusAfterReleased:b(J),onFocusoutPrevented:b(se),onReleaseRequested:b(ne)},{default:st(()=>[b(F)?(ae(),kt(Pne,Mr({key:0,ref_key:"dialogContentRef",ref:r},ge.$attrs,{center:ge.center,"align-center":ge.alignCenter,"close-icon":ge.closeIcon,draggable:b(ce),overflow:ge.overflow,fullscreen:ge.fullscreen,"header-class":ge.headerClass,"body-class":ge.bodyClass,"footer-class":ge.footerClass,"show-close":ge.showClose,title:ge.title,"aria-level":ge.headerAriaLevel,onClose:b(te)}),Ya({header:st(()=>[ge.$slots.title?pt(ge.$slots,"title",{key:1}):pt(ge.$slots,"header",{key:0,close:b(te),titleId:b(C),titleClass:b(d).e("title")})]),default:st(()=>[pt(ge.$slots,"default")]),_:2},[ge.$slots.footer?{name:"footer",fn:st(()=>[pt(ge.$slots,"footer")])}:void 0]),1040,["center","align-center","close-icon","draggable","overflow","fullscreen","header-class","body-class","footer-class","show-close","title","aria-level","onClose"])):yt("v-if",!0)]),_:3},8,["trapped","onFocusAfterTrapped","onFocusAfterReleased","onFocusoutPrevented","onReleaseRequested"])],46,["aria-label","aria-labelledby","aria-describedby","onClick","onMousedown","onMouseup"])]),_:3},8,["mask","overlay-class","z-index"]),[[no,b(S)]])]),_:3},8,["onAfterEnter","onAfterLeave","onBeforeLeave"])]),_:3},8,["to","disabled"]))}});var Lne=fn(One,[["__file","dialog.vue"]]);const Dne=ur(Lne),zne=un({direction:{type:String,values:["horizontal","vertical"],default:"horizontal"},contentPosition:{type:String,values:["left","center","right"],default:"center"},borderStyle:{type:dt(String),default:"solid"}}),Fne=qe({name:"ElDivider"}),Nne=qe({...Fne,props:zne,setup(e){const t=e,i=en("divider"),a=ee(()=>i.cssVar({"border-style":t.borderStyle}));return(d,p)=>(ae(),Oe("div",{class:pe([b(i).b(),b(i).m(d.direction)]),style:$n(b(a)),role:"separator"},[d.$slots.default&&d.direction!=="vertical"?(ae(),Oe("div",{key:0,class:pe([b(i).e("text"),b(i).is(d.contentPosition)])},[pt(d.$slots,"default")],2)):yt("v-if",!0)],6))}});var Bne=fn(Nne,[["__file","divider.vue"]]);const p4=ur(Bne),Vne=un({...d4,direction:{type:String,default:"rtl",values:["ltr","rtl","ttb","btt"]},size:{type:[String,Number],default:"30%"},withHeader:{type:Boolean,default:!0},modalFade:{type:Boolean,default:!0},headerAriaLevel:{type:String,default:"2"}}),$ne=h4,Une=qe({name:"ElDrawer",inheritAttrs:!1}),jne=qe({...Une,props:Vne,emits:$ne,setup(e,{expose:t}){const i=e,a=Hi();Ud({scope:"el-drawer",from:"the title slot",replacement:"the header slot",version:"3.0.0",ref:"https://element-plus.org/en-US/component/drawer.html#slots"},ee(()=>!!a.title));const d=Se(),p=Se(),_=en("drawer"),{t:r}=Gr(),{afterEnter:S,afterLeave:C,beforeLeave:M,visible:k,rendered:z,titleId:F,bodyId:B,zIndex:N,onModalClick:j,onOpenAutoFocus:U,onCloseAutoFocus:te,onFocusoutPrevented:Y,onCloseRequested:q,handleClose:J}=f4(i,d),ne=ee(()=>i.direction==="rtl"||i.direction==="ltr"),se=ee(()=>ui(i.size));return t({handleClose:J,afterEnter:S,afterLeave:C}),(fe,ce)=>(ae(),kt(b(tg),{to:fe.appendTo,disabled:fe.appendTo!=="body"?!1:!fe.appendToBody},{default:st(()=>[Ze(ls,{name:b(_).b("fade"),onAfterEnter:b(S),onAfterLeave:b(C),onBeforeLeave:b(M),persisted:""},{default:st(()=>[hr(Ze(b(RE),{mask:fe.modal,"overlay-class":fe.modalClass,"z-index":b(N),onClick:b(j)},{default:st(()=>[Ze(b(eg),{loop:"",trapped:b(k),"focus-trap-el":d.value,"focus-start-el":p.value,onFocusAfterTrapped:b(U),onFocusAfterReleased:b(te),onFocusoutPrevented:b(Y),onReleaseRequested:b(q)},{default:st(()=>[Ue("div",Mr({ref_key:"drawerRef",ref:d,"aria-modal":"true","aria-label":fe.title||void 0,"aria-labelledby":fe.title?void 0:b(F),"aria-describedby":b(B)},fe.$attrs,{class:[b(_).b(),fe.direction,b(k)&&"open"],style:b(ne)?"width: "+b(se):"height: "+b(se),role:"dialog",onClick:Qn(()=>{},["stop"])}),[Ue("span",{ref_key:"focusStartRef",ref:p,class:pe(b(_).e("sr-focus")),tabindex:"-1"},null,2),fe.withHeader?(ae(),Oe("header",{key:0,class:pe([b(_).e("header"),fe.headerClass])},[fe.$slots.title?pt(fe.$slots,"title",{key:1},()=>[yt(" DEPRECATED SLOT ")]):pt(fe.$slots,"header",{key:0,close:b(J),titleId:b(F),titleClass:b(_).e("title")},()=>[fe.$slots.title?yt("v-if",!0):(ae(),Oe("span",{key:0,id:b(F),role:"heading","aria-level":fe.headerAriaLevel,class:pe(b(_).e("title"))},pn(fe.title),11,["id","aria-level"]))]),fe.showClose?(ae(),Oe("button",{key:2,"aria-label":b(r)("el.drawer.close"),class:pe(b(_).e("close-btn")),type:"button",onClick:b(J)},[Ze(b(On),{class:pe(b(_).e("close"))},{default:st(()=>[Ze(b(sc))]),_:1},8,["class"])],10,["aria-label","onClick"])):yt("v-if",!0)],2)):yt("v-if",!0),b(z)?(ae(),Oe("div",{key:1,id:b(B),class:pe([b(_).e("body"),fe.bodyClass])},[pt(fe.$slots,"default")],10,["id"])):yt("v-if",!0),fe.$slots.footer?(ae(),Oe("div",{key:2,class:pe([b(_).e("footer"),fe.footerClass])},[pt(fe.$slots,"footer")],2)):yt("v-if",!0)],16,["aria-label","aria-labelledby","aria-describedby","onClick"])]),_:3},8,["trapped","focus-trap-el","focus-start-el","onFocusAfterTrapped","onFocusAfterReleased","onFocusoutPrevented","onReleaseRequested"])]),_:3},8,["mask","overlay-class","z-index","onClick"]),[[no,b(k)]])]),_:3},8,["name","onAfterEnter","onAfterLeave","onBeforeLeave"])]),_:3},8,["to","disabled"]))}});var Hne=fn(jne,[["__file","drawer.vue"]]);const Gne=ur(Hne),Wne=qe({inheritAttrs:!1});function qne(e,t,i,a,d,p){return pt(e.$slots,"default")}var Kne=fn(Wne,[["render",qne],["__file","collection.vue"]]);const Zne=qe({name:"ElCollectionItem",inheritAttrs:!1});function Yne(e,t,i,a,d,p){return pt(e.$slots,"default")}var Xne=fn(Zne,[["render",Yne],["__file","collection-item.vue"]]);const m4="data-el-collection-item",g4=e=>{const t=`El${e}Collection`,i=`${t}Item`,a=Symbol(t),d=Symbol(i),p={...Kne,name:t,setup(){const r=Se(null),S=new Map;Dr(a,{itemMap:S,getItems:()=>{const M=b(r);if(!M)return[];const k=Array.from(M.querySelectorAll(`[${m4}]`));return[...S.values()].sort((F,B)=>k.indexOf(F.ref)-k.indexOf(B.ref))},collectionRef:r})}},_={...Xne,name:i,setup(r,{attrs:S}){const C=Se(null),M=An(a,void 0);Dr(d,{collectionItemRef:C}),gr(()=>{const k=b(C);k&&M.itemMap.set(k,{ref:k,...S})}),Oo(()=>{const k=b(C);M.itemMap.delete(k)})}};return{COLLECTION_INJECTION_KEY:a,COLLECTION_ITEM_INJECTION_KEY:d,ElCollection:p,ElCollectionItem:_}},Jne=un({style:{type:dt([String,Array,Object])},currentTabId:{type:dt(String)},defaultCurrentTabId:String,loop:Boolean,dir:{type:String,values:["ltr","rtl"],default:"ltr"},orientation:{type:dt(String)},onBlur:Function,onFocus:Function,onMousedown:Function}),{ElCollection:Qne,ElCollectionItem:ere,COLLECTION_INJECTION_KEY:LE,COLLECTION_ITEM_INJECTION_KEY:tre}=g4("RovingFocusGroup"),DE=Symbol("elRovingFocusGroup"),v4=Symbol("elRovingFocusGroupItem"),nre={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"},rre=(e,t)=>e,ore=(e,t,i)=>{const a=rre(e.code);return nre[a]},ire=(e,t)=>e.map((i,a)=>e[(a+t)%e.length]),zE=e=>{const{activeElement:t}=document;for(const i of e)if(i===t||(i.focus(),t!==document.activeElement))return},ER="currentTabIdChange",MR="rovingFocusGroup.entryFocus",sre={bubbles:!1,cancelable:!0},are=qe({name:"ElRovingFocusGroupImpl",inheritAttrs:!1,props:Jne,emits:[ER,"entryFocus"],setup(e,{emit:t}){var i;const a=Se((i=e.currentTabId||e.defaultCurrentTabId)!=null?i:null),d=Se(!1),p=Se(!1),_=Se(null),{getItems:r}=An(LE,void 0),S=ee(()=>[{outline:"none"},e.style]),C=N=>{t(ER,N)},M=()=>{d.value=!0},k=_i(N=>{var j;(j=e.onMousedown)==null||j.call(e,N)},()=>{p.value=!0}),z=_i(N=>{var j;(j=e.onFocus)==null||j.call(e,N)},N=>{const j=!b(p),{target:U,currentTarget:te}=N;if(U===te&&j&&!b(d)){const Y=new Event(MR,sre);if(te==null||te.dispatchEvent(Y),!Y.defaultPrevented){const q=r().filter(ce=>ce.focusable),J=q.find(ce=>ce.active),ne=q.find(ce=>ce.id===b(a)),fe=[J,ne,...q].filter(Boolean).map(ce=>ce.ref);zE(fe)}}p.value=!1}),F=_i(N=>{var j;(j=e.onBlur)==null||j.call(e,N)},()=>{d.value=!1}),B=(...N)=>{t("entryFocus",...N)};Dr(DE,{currentTabbedId:Wm(a),loop:po(e,"loop"),tabIndex:ee(()=>b(d)?-1:0),rovingFocusGroupRef:_,rovingFocusGroupRootStyle:S,orientation:po(e,"orientation"),dir:po(e,"dir"),onItemFocus:C,onItemShiftTab:M,onBlur:F,onFocus:z,onMousedown:k}),qt(()=>e.currentTabId,N=>{a.value=N??null}),So(_,MR,B)}});function lre(e,t,i,a,d,p){return pt(e.$slots,"default")}var cre=fn(are,[["render",lre],["__file","roving-focus-group-impl.vue"]]);const ure=qe({name:"ElRovingFocusGroup",components:{ElFocusGroupCollection:Qne,ElRovingFocusGroupImpl:cre}});function dre(e,t,i,a,d,p){const _=Er("el-roving-focus-group-impl"),r=Er("el-focus-group-collection");return ae(),kt(r,null,{default:st(()=>[Ze(_,Ha(Uc(e.$attrs)),{default:st(()=>[pt(e.$slots,"default")]),_:3},16)]),_:3})}var hre=fn(ure,[["render",dre],["__file","roving-focus-group.vue"]]);const Zb=un({trigger:Y_.trigger,triggerKeys:{type:dt(Array),default:()=>[En.enter,En.numpadEnter,En.space,En.down]},effect:{...rs.effect,default:"light"},type:{type:dt(String)},placement:{type:dt(String),default:"bottom"},popperOptions:{type:dt(Object),default:()=>({})},id:String,size:{type:String,default:""},splitButton:Boolean,hideOnClick:{type:Boolean,default:!0},loop:{type:Boolean,default:!0},showTimeout:{type:Number,default:150},hideTimeout:{type:Number,default:150},tabindex:{type:dt([Number,String]),default:0},maxHeight:{type:dt([Number,String]),default:""},popperClass:{type:String,default:""},disabled:Boolean,role:{type:String,default:"menu"},buttonProps:{type:dt(Object)},teleported:rs.teleported,persistent:{type:Boolean,default:!0}}),_4=un({command:{type:[Object,String,Number],default:()=>({})},disabled:Boolean,divided:Boolean,textValue:String,icon:{type:Mo}}),fre=un({onKeydown:{type:dt(Function)}}),pre=[En.down,En.pageDown,En.home],y4=[En.up,En.pageUp,En.end],mre=[...pre,...y4],{ElCollection:gre,ElCollectionItem:vre,COLLECTION_INJECTION_KEY:_re,COLLECTION_ITEM_INJECTION_KEY:yre}=g4("Dropdown"),Sx=Symbol("elDropdown"),{ButtonGroup:bre}=ss,xre=qe({name:"ElDropdown",components:{ElButton:ss,ElButtonGroup:bre,ElScrollbar:Yc,ElDropdownCollection:gre,ElTooltip:Is,ElRovingFocusGroup:hre,ElOnlyChild:$z,ElIcon:On,ArrowDown:Gu},props:Zb,emits:["visible-change","click","command"],setup(e,{emit:t}){const i=wr(),a=en("dropdown"),{t:d}=Gr(),p=Se(),_=Se(),r=Se(null),S=Se(null),C=Se(null),M=Se(null),k=Se(!1),z=ee(()=>({maxHeight:ui(e.maxHeight)})),F=ee(()=>[a.m(q.value)]),B=ee(()=>Vs(e.trigger)),N=vs().value,j=ee(()=>e.id||N);qt([p,B],([be,Me],[Ae])=>{var me,Be,Ve;(me=Ae==null?void 0:Ae.$el)!=null&&me.removeEventListener&&Ae.$el.removeEventListener("pointerenter",ne),(Be=be==null?void 0:be.$el)!=null&&Be.removeEventListener&&be.$el.removeEventListener("pointerenter",ne),(Ve=be==null?void 0:be.$el)!=null&&Ve.addEventListener&&Me.includes("hover")&&be.$el.addEventListener("pointerenter",ne)},{immediate:!0}),Oo(()=>{var be,Me;(Me=(be=p.value)==null?void 0:be.$el)!=null&&Me.removeEventListener&&p.value.$el.removeEventListener("pointerenter",ne)});function U(){te()}function te(){var be;(be=r.value)==null||be.onClose()}function Y(){var be;(be=r.value)==null||be.onOpen()}const q=Li();function J(...be){t("command",...be)}function ne(){var be,Me;(Me=(be=p.value)==null?void 0:be.$el)==null||Me.focus()}function se(){}function fe(){const be=b(S);B.value.includes("hover")&&(be==null||be.focus()),M.value=null}function ce(be){M.value=be}function le(be){k.value||(be.preventDefault(),be.stopImmediatePropagation())}function ge(){t("visible-change",!0)}function de(be){(be==null?void 0:be.type)==="keydown"&&S.value.focus()}function ke(){t("visible-change",!1)}return Dr(Sx,{contentRef:S,role:ee(()=>e.role),triggerId:j,isUsingKeyboard:k,onItemEnter:se,onItemLeave:fe}),Dr("elDropdown",{instance:i,dropdownSize:q,handleClick:U,commandHandler:J,trigger:po(e,"trigger"),hideOnClick:po(e,"hideOnClick")}),{t:d,ns:a,scrollbar:C,wrapStyle:z,dropdownTriggerKls:F,dropdownSize:q,triggerId:j,currentTabId:M,handleCurrentTabIdChange:ce,handlerMainButtonClick:be=>{t("click",be)},handleEntryFocus:le,handleClose:te,handleOpen:Y,handleBeforeShowTooltip:ge,handleShowTooltip:de,handleBeforeHideTooltip:ke,onFocusAfterTrapped:be=>{var Me,Ae;be.preventDefault(),(Ae=(Me=S.value)==null?void 0:Me.focus)==null||Ae.call(Me,{preventScroll:!0})},popperRef:r,contentRef:S,triggeringElementRef:p,referenceElementRef:_}}});function wre(e,t,i,a,d,p){var _;const r=Er("el-dropdown-collection"),S=Er("el-roving-focus-group"),C=Er("el-scrollbar"),M=Er("el-only-child"),k=Er("el-tooltip"),z=Er("el-button"),F=Er("arrow-down"),B=Er("el-icon"),N=Er("el-button-group");return ae(),Oe("div",{class:pe([e.ns.b(),e.ns.is("disabled",e.disabled)])},[Ze(k,{ref:"popperRef",role:e.role,effect:e.effect,"fallback-placements":["bottom","top"],"popper-options":e.popperOptions,"gpu-acceleration":!1,"hide-after":e.trigger==="hover"?e.hideTimeout:0,"manual-mode":!0,placement:e.placement,"popper-class":[e.ns.e("popper"),e.popperClass],"reference-element":(_=e.referenceElementRef)==null?void 0:_.$el,trigger:e.trigger,"trigger-keys":e.triggerKeys,"trigger-target-el":e.contentRef,"show-after":e.trigger==="hover"?e.showTimeout:0,"stop-popper-mouse-event":!1,"virtual-ref":e.triggeringElementRef,"virtual-triggering":e.splitButton,disabled:e.disabled,transition:`${e.ns.namespace.value}-zoom-in-top`,teleported:e.teleported,pure:"",persistent:e.persistent,onBeforeShow:e.handleBeforeShowTooltip,onShow:e.handleShowTooltip,onBeforeHide:e.handleBeforeHideTooltip},Ya({content:st(()=>[Ze(C,{ref:"scrollbar","wrap-style":e.wrapStyle,tag:"div","view-class":e.ns.e("list")},{default:st(()=>[Ze(S,{loop:e.loop,"current-tab-id":e.currentTabId,orientation:"horizontal",onCurrentTabIdChange:e.handleCurrentTabIdChange,onEntryFocus:e.handleEntryFocus},{default:st(()=>[Ze(r,null,{default:st(()=>[pt(e.$slots,"dropdown")]),_:3})]),_:3},8,["loop","current-tab-id","onCurrentTabIdChange","onEntryFocus"])]),_:3},8,["wrap-style","view-class"])]),_:2},[e.splitButton?void 0:{name:"default",fn:st(()=>[Ze(M,{id:e.triggerId,ref:"triggeringElementRef",role:"button",tabindex:e.tabindex},{default:st(()=>[pt(e.$slots,"default")]),_:3},8,["id","tabindex"])])}]),1032,["role","effect","popper-options","hide-after","placement","popper-class","reference-element","trigger","trigger-keys","trigger-target-el","show-after","virtual-ref","virtual-triggering","disabled","transition","teleported","persistent","onBeforeShow","onShow","onBeforeHide"]),e.splitButton?(ae(),kt(N,{key:0},{default:st(()=>[Ze(z,Mr({ref:"referenceElementRef"},e.buttonProps,{size:e.dropdownSize,type:e.type,disabled:e.disabled,tabindex:e.tabindex,onClick:e.handlerMainButtonClick}),{default:st(()=>[pt(e.$slots,"default")]),_:3},16,["size","type","disabled","tabindex","onClick"]),Ze(z,Mr({id:e.triggerId,ref:"triggeringElementRef"},e.buttonProps,{role:"button",size:e.dropdownSize,type:e.type,class:e.ns.e("caret-button"),disabled:e.disabled,tabindex:e.tabindex,"aria-label":e.t("el.dropdown.toggleDropdown")}),{default:st(()=>[Ze(B,{class:pe(e.ns.e("icon"))},{default:st(()=>[Ze(F)]),_:1},8,["class"])]),_:1},16,["id","size","type","class","disabled","tabindex","aria-label"])]),_:3})):yt("v-if",!0)],2)}var Sre=fn(xre,[["render",wre],["__file","dropdown.vue"]]);const Tre=qe({components:{ElRovingFocusCollectionItem:ere},props:{focusable:{type:Boolean,default:!0},active:{type:Boolean,default:!1}},emits:["mousedown","focus","keydown"],setup(e,{emit:t}){const{currentTabbedId:i,loop:a,onItemFocus:d,onItemShiftTab:p}=An(DE,void 0),{getItems:_}=An(LE,void 0),r=vs(),S=Se(null),C=_i(F=>{t("mousedown",F)},F=>{e.focusable?d(b(r)):F.preventDefault()}),M=_i(F=>{t("focus",F)},()=>{d(b(r))}),k=_i(F=>{t("keydown",F)},F=>{const{code:B,shiftKey:N,target:j,currentTarget:U}=F;if(B===En.tab&&N){p();return}if(j!==U)return;const te=ore(F);if(te){F.preventDefault();let q=_().filter(J=>J.focusable).map(J=>J.ref);switch(te){case"last":{q.reverse();break}case"prev":case"next":{te==="prev"&&q.reverse();const J=q.indexOf(U);q=a.value?ire(q,J+1):q.slice(J+1);break}}Vn(()=>{zE(q)})}}),z=ee(()=>i.value===b(r));return Dr(v4,{rovingFocusGroupItemRef:S,tabIndex:ee(()=>b(z)?0:-1),handleMousedown:C,handleFocus:M,handleKeydown:k}),{id:r,handleKeydown:k,handleFocus:M,handleMousedown:C}}});function Cre(e,t,i,a,d,p){const _=Er("el-roving-focus-collection-item");return ae(),kt(_,{id:e.id,focusable:e.focusable,active:e.active},{default:st(()=>[pt(e.$slots,"default")]),_:3},8,["id","focusable","active"])}var Ere=fn(Tre,[["render",Cre],["__file","roving-focus-item.vue"]]);const Mre=qe({name:"DropdownItemImpl",components:{ElIcon:On},props:_4,emits:["pointermove","pointerleave","click","clickimpl"],setup(e,{emit:t}){const i=en("dropdown"),{role:a}=An(Sx,void 0),{collectionItemRef:d}=An(yre,void 0),{collectionItemRef:p}=An(tre,void 0),{rovingFocusGroupItemRef:_,tabIndex:r,handleFocus:S,handleKeydown:C,handleMousedown:M}=An(v4,void 0),k=wx(d,p,_),z=ee(()=>a.value==="menu"?"menuitem":a.value==="navigation"?"link":"button"),F=_i(B=>{if([En.enter,En.numpadEnter,En.space].includes(B.code))return B.preventDefault(),B.stopImmediatePropagation(),t("clickimpl",B),!0},C);return{ns:i,itemRef:k,dataset:{[m4]:""},role:z,tabIndex:r,handleFocus:S,handleKeydown:F,handleMousedown:M}}});function Ire(e,t,i,a,d,p){const _=Er("el-icon");return ae(),Oe(Bn,null,[e.divided?(ae(),Oe("li",{key:0,role:"separator",class:pe(e.ns.bem("menu","item","divided"))},null,2)):yt("v-if",!0),Ue("li",Mr({ref:e.itemRef},{...e.dataset,...e.$attrs},{"aria-disabled":e.disabled,class:[e.ns.be("menu","item"),e.ns.is("disabled",e.disabled)],tabindex:e.tabIndex,role:e.role,onClick:r=>e.$emit("clickimpl",r),onFocus:e.handleFocus,onKeydown:Qn(e.handleKeydown,["self"]),onMousedown:e.handleMousedown,onPointermove:r=>e.$emit("pointermove",r),onPointerleave:r=>e.$emit("pointerleave",r)}),[e.icon?(ae(),kt(_,{key:0},{default:st(()=>[(ae(),kt(Tr(e.icon)))]),_:1})):yt("v-if",!0),pt(e.$slots,"default")],16,["aria-disabled","tabindex","role","onClick","onFocus","onKeydown","onMousedown","onPointermove","onPointerleave"])],64)}var Are=fn(Mre,[["render",Ire],["__file","dropdown-item-impl.vue"]]);const b4=()=>{const e=An("elDropdown",{}),t=ee(()=>e==null?void 0:e.dropdownSize);return{elDropdown:e,_elDropdownSize:t}},kre=qe({name:"ElDropdownItem",components:{ElDropdownCollectionItem:vre,ElRovingFocusItem:Ere,ElDropdownItemImpl:Are},inheritAttrs:!1,props:_4,emits:["pointermove","pointerleave","click"],setup(e,{emit:t,attrs:i}){const{elDropdown:a}=b4(),d=wr(),p=Se(null),_=ee(()=>{var F,B;return(B=(F=b(p))==null?void 0:F.textContent)!=null?B:""}),{onItemEnter:r,onItemLeave:S}=An(Sx,void 0),C=_i(F=>(t("pointermove",F),F.defaultPrevented),rR(F=>{if(e.disabled){S(F);return}const B=F.currentTarget;B===document.activeElement||B.contains(document.activeElement)||(r(F),F.defaultPrevented||B==null||B.focus())})),M=_i(F=>(t("pointerleave",F),F.defaultPrevented),rR(S)),k=_i(F=>{if(!e.disabled)return t("click",F),F.type!=="keydown"&&F.defaultPrevented},F=>{var B,N,j;if(e.disabled){F.stopImmediatePropagation();return}(B=a==null?void 0:a.hideOnClick)!=null&&B.value&&((N=a.handleClick)==null||N.call(a)),(j=a.commandHandler)==null||j.call(a,e.command,d,F)}),z=ee(()=>({...e,...i}));return{handleClick:k,handlePointerMove:C,handlePointerLeave:M,textContent:_,propsAndAttrs:z}}});function Pre(e,t,i,a,d,p){var _;const r=Er("el-dropdown-item-impl"),S=Er("el-roving-focus-item"),C=Er("el-dropdown-collection-item");return ae(),kt(C,{disabled:e.disabled,"text-value":(_=e.textValue)!=null?_:e.textContent},{default:st(()=>[Ze(S,{focusable:!e.disabled},{default:st(()=>[Ze(r,Mr(e.propsAndAttrs,{onPointerleave:e.handlePointerLeave,onPointermove:e.handlePointerMove,onClickimpl:e.handleClick}),{default:st(()=>[pt(e.$slots,"default")]),_:3},16,["onPointerleave","onPointermove","onClickimpl"])]),_:3},8,["focusable"])]),_:3},8,["disabled","text-value"])}var x4=fn(kre,[["render",Pre],["__file","dropdown-item.vue"]]);const Rre=qe({name:"ElDropdownMenu",props:fre,setup(e){const t=en("dropdown"),{_elDropdownSize:i}=b4(),a=i.value,{focusTrapRef:d,onKeydown:p}=An(lE,void 0),{contentRef:_,role:r,triggerId:S}=An(Sx,void 0),{collectionRef:C,getItems:M}=An(_re,void 0),{rovingFocusGroupRef:k,rovingFocusGroupRootStyle:z,tabIndex:F,onBlur:B,onFocus:N,onMousedown:j}=An(DE,void 0),{collectionRef:U}=An(LE,void 0),te=ee(()=>[t.b("menu"),t.bm("menu",a==null?void 0:a.value)]),Y=wx(_,C,d,k,U),q=_i(ne=>{var se;(se=e.onKeydown)==null||se.call(e,ne)},ne=>{const{currentTarget:se,code:fe,target:ce}=ne;if(se.contains(ce),En.tab===fe&&ne.stopImmediatePropagation(),ne.preventDefault(),ce!==b(_)||!mre.includes(fe))return;const ge=M().filter(de=>!de.disabled).map(de=>de.ref);y4.includes(fe)&&ge.reverse(),zE(ge)});return{size:a,rovingFocusGroupRootStyle:z,tabIndex:F,dropdownKls:te,role:r,triggerId:S,dropdownListWrapperRef:Y,handleKeydown:ne=>{q(ne),p(ne)},onBlur:B,onFocus:N,onMousedown:j}}});function Ore(e,t,i,a,d,p){return ae(),Oe("ul",{ref:e.dropdownListWrapperRef,class:pe(e.dropdownKls),style:$n(e.rovingFocusGroupRootStyle),tabindex:-1,role:e.role,"aria-labelledby":e.triggerId,onBlur:e.onBlur,onFocus:e.onFocus,onKeydown:Qn(e.handleKeydown,["self"]),onMousedown:Qn(e.onMousedown,["self"])},[pt(e.$slots,"default")],46,["role","aria-labelledby","onBlur","onFocus","onKeydown","onMousedown"])}var w4=fn(Rre,[["render",Ore],["__file","dropdown-menu.vue"]]);const Lre=ur(Sre,{DropdownItem:x4,DropdownMenu:w4}),Dre=ri(x4),zre=ri(w4),Fre=qe({name:"ImgEmpty"}),Nre=qe({...Fre,setup(e){const t=en("empty"),i=vs();return(a,d)=>(ae(),Oe("svg",{viewBox:"0 0 79 86",version:"1.1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink"},[Ue("defs",null,[Ue("linearGradient",{id:`linearGradient-1-${b(i)}`,x1:"38.8503086%",y1:"0%",x2:"61.1496914%",y2:"100%"},[Ue("stop",{"stop-color":`var(${b(t).cssVarBlockName("fill-color-1")})`,offset:"0%"},null,8,["stop-color"]),Ue("stop",{"stop-color":`var(${b(t).cssVarBlockName("fill-color-4")})`,offset:"100%"},null,8,["stop-color"])],8,["id"]),Ue("linearGradient",{id:`linearGradient-2-${b(i)}`,x1:"0%",y1:"9.5%",x2:"100%",y2:"90.5%"},[Ue("stop",{"stop-color":`var(${b(t).cssVarBlockName("fill-color-1")})`,offset:"0%"},null,8,["stop-color"]),Ue("stop",{"stop-color":`var(${b(t).cssVarBlockName("fill-color-6")})`,offset:"100%"},null,8,["stop-color"])],8,["id"]),Ue("rect",{id:`path-3-${b(i)}`,x:"0",y:"0",width:"17",height:"36"},null,8,["id"])]),Ue("g",{id:"Illustrations",stroke:"none","stroke-width":"1",fill:"none","fill-rule":"evenodd"},[Ue("g",{id:"B-type",transform:"translate(-1268.000000, -535.000000)"},[Ue("g",{id:"Group-2",transform:"translate(1268.000000, 535.000000)"},[Ue("path",{id:"Oval-Copy-2",d:"M39.5,86 C61.3152476,86 79,83.9106622 79,81.3333333 C79,78.7560045 57.3152476,78 35.5,78 C13.6847524,78 0,78.7560045 0,81.3333333 C0,83.9106622 17.6847524,86 39.5,86 Z",fill:`var(${b(t).cssVarBlockName("fill-color-3")})`},null,8,["fill"]),Ue("polygon",{id:"Rectangle-Copy-14",fill:`var(${b(t).cssVarBlockName("fill-color-7")})`,transform:"translate(27.500000, 51.500000) scale(1, -1) translate(-27.500000, -51.500000) ",points:"13 58 53 58 42 45 2 45"},null,8,["fill"]),Ue("g",{id:"Group-Copy",transform:"translate(34.500000, 31.500000) scale(-1, 1) rotate(-25.000000) translate(-34.500000, -31.500000) translate(7.000000, 10.000000)"},[Ue("polygon",{id:"Rectangle-Copy-10",fill:`var(${b(t).cssVarBlockName("fill-color-7")})`,transform:"translate(11.500000, 5.000000) scale(1, -1) translate(-11.500000, -5.000000) ",points:"2.84078316e-14 3 18 3 23 7 5 7"},null,8,["fill"]),Ue("polygon",{id:"Rectangle-Copy-11",fill:`var(${b(t).cssVarBlockName("fill-color-5")})`,points:"-3.69149156e-15 7 38 7 38 43 -3.69149156e-15 43"},null,8,["fill"]),Ue("rect",{id:"Rectangle-Copy-12",fill:`url(#linearGradient-1-${b(i)})`,transform:"translate(46.500000, 25.000000) scale(-1, 1) translate(-46.500000, -25.000000) ",x:"38",y:"7",width:"17",height:"36"},null,8,["fill"]),Ue("polygon",{id:"Rectangle-Copy-13",fill:`var(${b(t).cssVarBlockName("fill-color-2")})`,transform:"translate(39.500000, 3.500000) scale(-1, 1) translate(-39.500000, -3.500000) ",points:"24 7 41 7 55 -3.63806207e-12 38 -3.63806207e-12"},null,8,["fill"])]),Ue("rect",{id:"Rectangle-Copy-15",fill:`url(#linearGradient-2-${b(i)})`,x:"13",y:"45",width:"40",height:"36"},null,8,["fill"]),Ue("g",{id:"Rectangle-Copy-17",transform:"translate(53.000000, 45.000000)"},[Ue("use",{id:"Mask",fill:`var(${b(t).cssVarBlockName("fill-color-8")})`,transform:"translate(8.500000, 18.000000) scale(-1, 1) translate(-8.500000, -18.000000) ","xlink:href":`#path-3-${b(i)}`},null,8,["fill","xlink:href"]),Ue("polygon",{id:"Rectangle-Copy",fill:`var(${b(t).cssVarBlockName("fill-color-9")})`,mask:`url(#mask-4-${b(i)})`,transform:"translate(12.000000, 9.000000) scale(-1, 1) translate(-12.000000, -9.000000) ",points:"7 0 24 0 20 18 7 16.5"},null,8,["fill","mask"])]),Ue("polygon",{id:"Rectangle-Copy-18",fill:`var(${b(t).cssVarBlockName("fill-color-2")})`,transform:"translate(66.000000, 51.500000) scale(-1, 1) translate(-66.000000, -51.500000) ",points:"62 45 79 45 70 58 53 58"},null,8,["fill"])])])])]))}});var Bre=fn(Nre,[["__file","img-empty.vue"]]);const Vre=un({image:{type:String,default:""},imageSize:Number,description:{type:String,default:""}}),$re=qe({name:"ElEmpty"}),Ure=qe({...$re,props:Vre,setup(e){const t=e,{t:i}=Gr(),a=en("empty"),d=ee(()=>t.description||i("el.table.emptyText")),p=ee(()=>({width:ui(t.imageSize)}));return(_,r)=>(ae(),Oe("div",{class:pe(b(a).b())},[Ue("div",{class:pe(b(a).e("image")),style:$n(b(p))},[_.image?(ae(),Oe("img",{key:0,src:_.image,ondragstart:"return false"},null,8,["src"])):pt(_.$slots,"image",{key:1},()=>[Ze(Bre)])],6),Ue("div",{class:pe(b(a).e("description"))},[_.$slots.description?pt(_.$slots,"description",{key:0}):(ae(),Oe("p",{key:1},pn(b(d)),1))],2),_.$slots.default?(ae(),Oe("div",{key:0,class:pe(b(a).e("bottom"))},[pt(_.$slots,"default")],2)):yt("v-if",!0)],2))}});var jre=fn(Ure,[["__file","empty.vue"]]);const S4=ur(jre),Hre=un({size:{type:String,values:Zc},disabled:Boolean}),Gre=un({...Hre,model:Object,rules:{type:dt(Object)},labelPosition:{type:String,values:["left","right","top"],default:"right"},requireAsteriskPosition:{type:String,values:["left","right"],default:"left"},labelWidth:{type:[String,Number],default:""},labelSuffix:{type:String,default:""},inline:Boolean,inlineMessage:Boolean,statusIcon:Boolean,showMessage:{type:Boolean,default:!0},validateOnRuleChange:{type:Boolean,default:!0},hideRequiredAsterisk:Boolean,scrollToError:Boolean,scrollIntoViewOptions:{type:[Object,Boolean]}}),Wre={validate:(e,t,i)=>(ln(e)||Dn(e))&&Ro(t)&&Dn(i)};function qre(){const e=Se([]),t=ee(()=>{if(!e.value.length)return"0";const p=Math.max(...e.value);return p?`${p}px`:""});function i(p){const _=e.value.indexOf(p);return _===-1&&t.value,_}function a(p,_){if(p&&_){const r=i(_);e.value.splice(r,1,p)}else p&&e.value.push(p)}function d(p){const _=i(p);_>-1&&e.value.splice(_,1)}return{autoLabelWidth:t,registerLabelWidth:a,deregisterLabelWidth:d}}const Rb=(e,t)=>{const i=Vs(t);return i.length>0?e.filter(a=>a.prop&&i.includes(a.prop)):e},Kre="ElForm",Zre=qe({name:Kre}),Yre=qe({...Zre,props:Gre,emits:Wre,setup(e,{expose:t,emit:i}){const a=e,d=[],p=Li(),_=en("form"),r=ee(()=>{const{labelPosition:Y,inline:q}=a;return[_.b(),_.m(p.value||"default"),{[_.m(`label-${Y}`)]:Y,[_.m("inline")]:q}]}),S=Y=>d.find(q=>q.prop===Y),C=Y=>{d.push(Y)},M=Y=>{Y.prop&&d.splice(d.indexOf(Y),1)},k=(Y=[])=>{a.model&&Rb(d,Y).forEach(q=>q.resetField())},z=(Y=[])=>{Rb(d,Y).forEach(q=>q.clearValidate())},F=ee(()=>!!a.model),B=Y=>{if(d.length===0)return[];const q=Rb(d,Y);return q.length?q:[]},N=async Y=>U(void 0,Y),j=async(Y=[])=>{if(!F.value)return!1;const q=B(Y);if(q.length===0)return!0;let J={};for(const ne of q)try{await ne.validate(""),ne.validateState==="error"&&ne.resetField()}catch(se){J={...J,...se}}return Object.keys(J).length===0?!0:Promise.reject(J)},U=async(Y=[],q)=>{const J=!Nn(q);try{const ne=await j(Y);return ne===!0&&await(q==null?void 0:q(ne)),ne}catch(ne){if(ne instanceof Error)throw ne;const se=ne;return a.scrollToError&&te(Object.keys(se)[0]),await(q==null?void 0:q(!1,se)),J&&Promise.reject(se)}},te=Y=>{var q;const J=Rb(d,Y)[0];J&&((q=J.$el)==null||q.scrollIntoView(a.scrollIntoViewOptions))};return qt(()=>a.rules,()=>{a.validateOnRuleChange&&N().catch(Y=>void 0)},{deep:!0,flush:"post"}),Dr(Uf,lo({...Zi(a),emit:i,resetFields:k,clearValidate:z,validateField:U,getField:S,addField:C,removeField:M,...qre()})),t({validate:N,validateField:U,resetFields:k,clearValidate:z,scrollToField:te,fields:d}),(Y,q)=>(ae(),Oe("form",{class:pe(b(r))},[pt(Y.$slots,"default")],2))}});var Xre=fn(Yre,[["__file","form.vue"]]);function yf(){return yf=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(e[a]=i[a])}return e},yf.apply(this,arguments)}function Jre(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,Q_(e,t)}function gT(e){return gT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(i){return i.__proto__||Object.getPrototypeOf(i)},gT(e)}function Q_(e,t){return Q_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,d){return a.__proto__=d,a},Q_(e,t)}function Qre(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Yb(e,t,i){return Qre()?Yb=Reflect.construct.bind():Yb=function(d,p,_){var r=[null];r.push.apply(r,p);var S=Function.bind.apply(d,r),C=new S;return _&&Q_(C,_.prototype),C},Yb.apply(null,arguments)}function eoe(e){return Function.toString.call(e).indexOf("[native code]")!==-1}function vT(e){var t=typeof Map=="function"?new Map:void 0;return vT=function(a){if(a===null||!eoe(a))return a;if(typeof a!="function")throw new TypeError("Super expression must either be null or a function");if(typeof t<"u"){if(t.has(a))return t.get(a);t.set(a,d)}function d(){return Yb(a,arguments,gT(this).constructor)}return d.prototype=Object.create(a.prototype,{constructor:{value:d,enumerable:!1,writable:!0,configurable:!0}}),Q_(d,a)},vT(e)}var toe=/%[sdj%]/g,noe=function(){};function _T(e){if(!e||!e.length)return null;var t={};return e.forEach(function(i){var a=i.field;t[a]=t[a]||[],t[a].push(i)}),t}function Wa(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),a=1;a<t;a++)i[a-1]=arguments[a];var d=0,p=i.length;if(typeof e=="function")return e.apply(null,i);if(typeof e=="string"){var _=e.replace(toe,function(r){if(r==="%%")return"%";if(d>=p)return r;switch(r){case"%s":return String(i[d++]);case"%d":return Number(i[d++]);case"%j":try{return JSON.stringify(i[d++])}catch{return"[Circular]"}break;default:return r}});return _}return e}function roe(e){return e==="string"||e==="url"||e==="hex"||e==="email"||e==="date"||e==="pattern"}function cs(e,t){return!!(e==null||t==="array"&&Array.isArray(e)&&!e.length||roe(t)&&typeof e=="string"&&!e)}function ooe(e,t,i){var a=[],d=0,p=e.length;function _(r){a.push.apply(a,r||[]),d++,d===p&&i(a)}e.forEach(function(r){t(r,_)})}function IR(e,t,i){var a=0,d=e.length;function p(_){if(_&&_.length){i(_);return}var r=a;a=a+1,r<d?t(e[r],p):i([])}p([])}function ioe(e){var t=[];return Object.keys(e).forEach(function(i){t.push.apply(t,e[i]||[])}),t}var AR=function(e){Jre(t,e);function t(i,a){var d;return d=e.call(this,"Async Validation Error")||this,d.errors=i,d.fields=a,d}return t}(vT(Error));function soe(e,t,i,a,d){if(t.first){var p=new Promise(function(z,F){var B=function(U){return a(U),U.length?F(new AR(U,_T(U))):z(d)},N=ioe(e);IR(N,i,B)});return p.catch(function(z){return z}),p}var _=t.firstFields===!0?Object.keys(e):t.firstFields||[],r=Object.keys(e),S=r.length,C=0,M=[],k=new Promise(function(z,F){var B=function(j){if(M.push.apply(M,j),C++,C===S)return a(M),M.length?F(new AR(M,_T(M))):z(d)};r.length||(a(M),z(d)),r.forEach(function(N){var j=e[N];_.indexOf(N)!==-1?IR(j,i,B):ooe(j,i,B)})});return k.catch(function(z){return z}),k}function aoe(e){return!!(e&&e.message!==void 0)}function loe(e,t){for(var i=e,a=0;a<t.length;a++){if(i==null)return i;i=i[t[a]]}return i}function kR(e,t){return function(i){var a;return e.fullFields?a=loe(t,e.fullFields):a=t[i.field||e.fullField],aoe(i)?(i.field=i.field||e.fullField,i.fieldValue=a,i):{message:typeof i=="function"?i():i,fieldValue:a,field:i.field||e.fullField}}}function PR(e,t){if(t){for(var i in t)if(t.hasOwnProperty(i)){var a=t[i];typeof a=="object"&&typeof e[i]=="object"?e[i]=yf({},e[i],a):e[i]=a}}return e}var T4=function(t,i,a,d,p,_){t.required&&(!a.hasOwnProperty(t.field)||cs(i,_||t.type))&&d.push(Wa(p.messages.required,t.fullField))},coe=function(t,i,a,d,p){(/^\s+$/.test(i)||i==="")&&d.push(Wa(p.messages.whitespace,t.fullField))},Ob,uoe=function(){if(Ob)return Ob;var e="[a-fA-F\\d:]",t=function(q){return q&&q.includeBoundaries?"(?:(?<=\\s|^)(?="+e+")|(?<="+e+")(?=\\s|$))":""},i="(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}",a="[a-fA-F\\d]{1,4}",d=(`
(?:
(?:`+a+":){7}(?:"+a+`|:)|                                    // 1:2:3:4:5:6:7::  1:2:3:4:5:6:7:8
(?:`+a+":){6}(?:"+i+"|:"+a+`|:)|                             // 1:2:3:4:5:6::    1:2:3:4:5:6::8   1:2:3:4:5:6::8  1:2:3:4:5:6::1.2.3.4
(?:`+a+":){5}(?::"+i+"|(?::"+a+`){1,2}|:)|                   // 1:2:3:4:5::      1:2:3:4:5::7:8   1:2:3:4:5::8    1:2:3:4:5::7:1.2.3.4
(?:`+a+":){4}(?:(?::"+a+"){0,1}:"+i+"|(?::"+a+`){1,3}|:)| // 1:2:3:4::        1:2:3:4::6:7:8   1:2:3:4::8      1:2:3:4::6:7:1.2.3.4
(?:`+a+":){3}(?:(?::"+a+"){0,2}:"+i+"|(?::"+a+`){1,4}|:)| // 1:2:3::          1:2:3::5:6:7:8   1:2:3::8        1:2:3::5:6:7:1.2.3.4
(?:`+a+":){2}(?:(?::"+a+"){0,3}:"+i+"|(?::"+a+`){1,5}|:)| // 1:2::            1:2::4:5:6:7:8   1:2::8          1:2::4:5:6:7:1.2.3.4
(?:`+a+":){1}(?:(?::"+a+"){0,4}:"+i+"|(?::"+a+`){1,6}|:)| // 1::              1::3:4:5:6:7:8   1::8            1::3:4:5:6:7:1.2.3.4
(?::(?:(?::`+a+"){0,5}:"+i+"|(?::"+a+`){1,7}|:))             // ::2:3:4:5:6:7:8  ::2:3:4:5:6:7:8  ::8             ::1.2.3.4
)(?:%[0-9a-zA-Z]{1,})?                                             // %eth0            %1
`).replace(/\s*\/\/.*$/gm,"").replace(/\n/g,"").trim(),p=new RegExp("(?:^"+i+"$)|(?:^"+d+"$)"),_=new RegExp("^"+i+"$"),r=new RegExp("^"+d+"$"),S=function(q){return q&&q.exact?p:new RegExp("(?:"+t(q)+i+t(q)+")|(?:"+t(q)+d+t(q)+")","g")};S.v4=function(Y){return Y&&Y.exact?_:new RegExp(""+t(Y)+i+t(Y),"g")},S.v6=function(Y){return Y&&Y.exact?r:new RegExp(""+t(Y)+d+t(Y),"g")};var C="(?:(?:[a-z]+:)?//)",M="(?:\\S+(?::\\S*)?@)?",k=S.v4().source,z=S.v6().source,F="(?:(?:[a-z\\u00a1-\\uffff0-9][-_]*)*[a-z\\u00a1-\\uffff0-9]+)",B="(?:\\.(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)*",N="(?:\\.(?:[a-z\\u00a1-\\uffff]{2,}))",j="(?::\\d{2,5})?",U='(?:[/?#][^\\s"]*)?',te="(?:"+C+"|www\\.)"+M+"(?:localhost|"+k+"|"+z+"|"+F+B+N+")"+j+U;return Ob=new RegExp("(?:^"+te+"$)","i"),Ob},RR={email:/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+\.)+[a-zA-Z\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]{2,}))$/,hex:/^#?([a-f0-9]{6}|[a-f0-9]{3})$/i},p_={integer:function(t){return p_.number(t)&&parseInt(t,10)===t},float:function(t){return p_.number(t)&&!p_.integer(t)},array:function(t){return Array.isArray(t)},regexp:function(t){if(t instanceof RegExp)return!0;try{return!!new RegExp(t)}catch{return!1}},date:function(t){return typeof t.getTime=="function"&&typeof t.getMonth=="function"&&typeof t.getYear=="function"&&!isNaN(t.getTime())},number:function(t){return isNaN(t)?!1:typeof t=="number"},object:function(t){return typeof t=="object"&&!p_.array(t)},method:function(t){return typeof t=="function"},email:function(t){return typeof t=="string"&&t.length<=320&&!!t.match(RR.email)},url:function(t){return typeof t=="string"&&t.length<=2048&&!!t.match(uoe())},hex:function(t){return typeof t=="string"&&!!t.match(RR.hex)}},doe=function(t,i,a,d,p){if(t.required&&i===void 0){T4(t,i,a,d,p);return}var _=["integer","float","array","regexp","object","method","email","number","date","url","hex"],r=t.type;_.indexOf(r)>-1?p_[r](i)||d.push(Wa(p.messages.types[r],t.fullField,t.type)):r&&typeof i!==t.type&&d.push(Wa(p.messages.types[r],t.fullField,t.type))},hoe=function(t,i,a,d,p){var _=typeof t.len=="number",r=typeof t.min=="number",S=typeof t.max=="number",C=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,M=i,k=null,z=typeof i=="number",F=typeof i=="string",B=Array.isArray(i);if(z?k="number":F?k="string":B&&(k="array"),!k)return!1;B&&(M=i.length),F&&(M=i.replace(C,"_").length),_?M!==t.len&&d.push(Wa(p.messages[k].len,t.fullField,t.len)):r&&!S&&M<t.min?d.push(Wa(p.messages[k].min,t.fullField,t.min)):S&&!r&&M>t.max?d.push(Wa(p.messages[k].max,t.fullField,t.max)):r&&S&&(M<t.min||M>t.max)&&d.push(Wa(p.messages[k].range,t.fullField,t.min,t.max))},tm="enum",foe=function(t,i,a,d,p){t[tm]=Array.isArray(t[tm])?t[tm]:[],t[tm].indexOf(i)===-1&&d.push(Wa(p.messages[tm],t.fullField,t[tm].join(", ")))},poe=function(t,i,a,d,p){if(t.pattern){if(t.pattern instanceof RegExp)t.pattern.lastIndex=0,t.pattern.test(i)||d.push(Wa(p.messages.pattern.mismatch,t.fullField,i,t.pattern));else if(typeof t.pattern=="string"){var _=new RegExp(t.pattern);_.test(i)||d.push(Wa(p.messages.pattern.mismatch,t.fullField,i,t.pattern))}}},Do={required:T4,whitespace:coe,type:doe,range:hoe,enum:foe,pattern:poe},moe=function(t,i,a,d,p){var _=[],r=t.required||!t.required&&d.hasOwnProperty(t.field);if(r){if(cs(i,"string")&&!t.required)return a();Do.required(t,i,d,_,p,"string"),cs(i,"string")||(Do.type(t,i,d,_,p),Do.range(t,i,d,_,p),Do.pattern(t,i,d,_,p),t.whitespace===!0&&Do.whitespace(t,i,d,_,p))}a(_)},goe=function(t,i,a,d,p){var _=[],r=t.required||!t.required&&d.hasOwnProperty(t.field);if(r){if(cs(i)&&!t.required)return a();Do.required(t,i,d,_,p),i!==void 0&&Do.type(t,i,d,_,p)}a(_)},voe=function(t,i,a,d,p){var _=[],r=t.required||!t.required&&d.hasOwnProperty(t.field);if(r){if(i===""&&(i=void 0),cs(i)&&!t.required)return a();Do.required(t,i,d,_,p),i!==void 0&&(Do.type(t,i,d,_,p),Do.range(t,i,d,_,p))}a(_)},_oe=function(t,i,a,d,p){var _=[],r=t.required||!t.required&&d.hasOwnProperty(t.field);if(r){if(cs(i)&&!t.required)return a();Do.required(t,i,d,_,p),i!==void 0&&Do.type(t,i,d,_,p)}a(_)},yoe=function(t,i,a,d,p){var _=[],r=t.required||!t.required&&d.hasOwnProperty(t.field);if(r){if(cs(i)&&!t.required)return a();Do.required(t,i,d,_,p),cs(i)||Do.type(t,i,d,_,p)}a(_)},boe=function(t,i,a,d,p){var _=[],r=t.required||!t.required&&d.hasOwnProperty(t.field);if(r){if(cs(i)&&!t.required)return a();Do.required(t,i,d,_,p),i!==void 0&&(Do.type(t,i,d,_,p),Do.range(t,i,d,_,p))}a(_)},xoe=function(t,i,a,d,p){var _=[],r=t.required||!t.required&&d.hasOwnProperty(t.field);if(r){if(cs(i)&&!t.required)return a();Do.required(t,i,d,_,p),i!==void 0&&(Do.type(t,i,d,_,p),Do.range(t,i,d,_,p))}a(_)},woe=function(t,i,a,d,p){var _=[],r=t.required||!t.required&&d.hasOwnProperty(t.field);if(r){if(i==null&&!t.required)return a();Do.required(t,i,d,_,p,"array"),i!=null&&(Do.type(t,i,d,_,p),Do.range(t,i,d,_,p))}a(_)},Soe=function(t,i,a,d,p){var _=[],r=t.required||!t.required&&d.hasOwnProperty(t.field);if(r){if(cs(i)&&!t.required)return a();Do.required(t,i,d,_,p),i!==void 0&&Do.type(t,i,d,_,p)}a(_)},Toe="enum",Coe=function(t,i,a,d,p){var _=[],r=t.required||!t.required&&d.hasOwnProperty(t.field);if(r){if(cs(i)&&!t.required)return a();Do.required(t,i,d,_,p),i!==void 0&&Do[Toe](t,i,d,_,p)}a(_)},Eoe=function(t,i,a,d,p){var _=[],r=t.required||!t.required&&d.hasOwnProperty(t.field);if(r){if(cs(i,"string")&&!t.required)return a();Do.required(t,i,d,_,p),cs(i,"string")||Do.pattern(t,i,d,_,p)}a(_)},Moe=function(t,i,a,d,p){var _=[],r=t.required||!t.required&&d.hasOwnProperty(t.field);if(r){if(cs(i,"date")&&!t.required)return a();if(Do.required(t,i,d,_,p),!cs(i,"date")){var S;i instanceof Date?S=i:S=new Date(i),Do.type(t,S,d,_,p),S&&Do.range(t,S.getTime(),d,_,p)}}a(_)},Ioe=function(t,i,a,d,p){var _=[],r=Array.isArray(i)?"array":typeof i;Do.required(t,i,d,_,p,r),a(_)},hS=function(t,i,a,d,p){var _=t.type,r=[],S=t.required||!t.required&&d.hasOwnProperty(t.field);if(S){if(cs(i,_)&&!t.required)return a();Do.required(t,i,d,r,p,_),cs(i,_)||Do.type(t,i,d,r,p)}a(r)},Aoe=function(t,i,a,d,p){var _=[],r=t.required||!t.required&&d.hasOwnProperty(t.field);if(r){if(cs(i)&&!t.required)return a();Do.required(t,i,d,_,p)}a(_)},P_={string:moe,method:goe,number:voe,boolean:_oe,regexp:yoe,integer:boe,float:xoe,array:woe,object:Soe,enum:Coe,pattern:Eoe,date:Moe,url:hS,hex:hS,email:hS,required:Ioe,any:Aoe};function yT(){return{default:"Validation error on field %s",required:"%s is required",enum:"%s must be one of %s",whitespace:"%s cannot be empty",date:{format:"%s date %s is invalid for format %s",parse:"%s date could not be parsed, %s is invalid ",invalid:"%s date %s is invalid"},types:{string:"%s is not a %s",method:"%s is not a %s (function)",array:"%s is not an %s",object:"%s is not an %s",number:"%s is not a %s",date:"%s is not a %s",boolean:"%s is not a %s",integer:"%s is not an %s",float:"%s is not a %s",regexp:"%s is not a valid %s",email:"%s is not a valid %s",url:"%s is not a valid %s",hex:"%s is not a valid %s"},string:{len:"%s must be exactly %s characters",min:"%s must be at least %s characters",max:"%s cannot be longer than %s characters",range:"%s must be between %s and %s characters"},number:{len:"%s must equal %s",min:"%s cannot be less than %s",max:"%s cannot be greater than %s",range:"%s must be between %s and %s"},array:{len:"%s must be exactly %s in length",min:"%s cannot be less than %s in length",max:"%s cannot be greater than %s in length",range:"%s must be between %s and %s in length"},pattern:{mismatch:"%s value %s does not match pattern %s"},clone:function(){var t=JSON.parse(JSON.stringify(this));return t.clone=this.clone,t}}}var bT=yT(),Ey=function(){function e(i){this.rules=null,this._messages=bT,this.define(i)}var t=e.prototype;return t.define=function(a){var d=this;if(!a)throw new Error("Cannot configure a schema with no rules");if(typeof a!="object"||Array.isArray(a))throw new Error("Rules must be an object");this.rules={},Object.keys(a).forEach(function(p){var _=a[p];d.rules[p]=Array.isArray(_)?_:[_]})},t.messages=function(a){return a&&(this._messages=PR(yT(),a)),this._messages},t.validate=function(a,d,p){var _=this;d===void 0&&(d={}),p===void 0&&(p=function(){});var r=a,S=d,C=p;if(typeof S=="function"&&(C=S,S={}),!this.rules||Object.keys(this.rules).length===0)return C&&C(null,r),Promise.resolve(r);function M(N){var j=[],U={};function te(q){if(Array.isArray(q)){var J;j=(J=j).concat.apply(J,q)}else j.push(q)}for(var Y=0;Y<N.length;Y++)te(N[Y]);j.length?(U=_T(j),C(j,U)):C(null,r)}if(S.messages){var k=this.messages();k===bT&&(k=yT()),PR(k,S.messages),S.messages=k}else S.messages=this.messages();var z={},F=S.keys||Object.keys(this.rules);F.forEach(function(N){var j=_.rules[N],U=r[N];j.forEach(function(te){var Y=te;typeof Y.transform=="function"&&(r===a&&(r=yf({},r)),U=r[N]=Y.transform(U)),typeof Y=="function"?Y={validator:Y}:Y=yf({},Y),Y.validator=_.getValidationMethod(Y),Y.validator&&(Y.field=N,Y.fullField=Y.fullField||N,Y.type=_.getType(Y),z[N]=z[N]||[],z[N].push({rule:Y,value:U,source:r,field:N}))})});var B={};return soe(z,S,function(N,j){var U=N.rule,te=(U.type==="object"||U.type==="array")&&(typeof U.fields=="object"||typeof U.defaultField=="object");te=te&&(U.required||!U.required&&N.value),U.field=N.field;function Y(ne,se){return yf({},se,{fullField:U.fullField+"."+ne,fullFields:U.fullFields?[].concat(U.fullFields,[ne]):[ne]})}function q(ne){ne===void 0&&(ne=[]);var se=Array.isArray(ne)?ne:[ne];!S.suppressWarning&&se.length&&e.warning("async-validator:",se),se.length&&U.message!==void 0&&(se=[].concat(U.message));var fe=se.map(kR(U,r));if(S.first&&fe.length)return B[U.field]=1,j(fe);if(!te)j(fe);else{if(U.required&&!N.value)return U.message!==void 0?fe=[].concat(U.message).map(kR(U,r)):S.error&&(fe=[S.error(U,Wa(S.messages.required,U.field))]),j(fe);var ce={};U.defaultField&&Object.keys(N.value).map(function(de){ce[de]=U.defaultField}),ce=yf({},ce,N.rule.fields);var le={};Object.keys(ce).forEach(function(de){var ke=ce[de],We=Array.isArray(ke)?ke:[ke];le[de]=We.map(Y.bind(null,de))});var ge=new e(le);ge.messages(S.messages),N.rule.options&&(N.rule.options.messages=S.messages,N.rule.options.error=S.error),ge.validate(N.value,N.rule.options||S,function(de){var ke=[];fe&&fe.length&&ke.push.apply(ke,fe),de&&de.length&&ke.push.apply(ke,de),j(ke.length?ke:null)})}}var J;if(U.asyncValidator)J=U.asyncValidator(U,N.value,q,N.source,S);else if(U.validator){try{J=U.validator(U,N.value,q,N.source,S)}catch(ne){console.error==null||console.error(ne),S.suppressValidatorError||setTimeout(function(){throw ne},0),q(ne.message)}J===!0?q():J===!1?q(typeof U.message=="function"?U.message(U.fullField||U.field):U.message||(U.fullField||U.field)+" fails"):J instanceof Array?q(J):J instanceof Error&&q(J.message)}J&&J.then&&J.then(function(){return q()},function(ne){return q(ne)})},function(N){M(N)},r)},t.getType=function(a){if(a.type===void 0&&a.pattern instanceof RegExp&&(a.type="pattern"),typeof a.validator!="function"&&a.type&&!P_.hasOwnProperty(a.type))throw new Error(Wa("Unknown rule type %s",a.type));return a.type||"string"},t.getValidationMethod=function(a){if(typeof a.validator=="function")return a.validator;var d=Object.keys(a),p=d.indexOf("message");return p!==-1&&d.splice(p,1),d.length===1&&d[0]==="required"?P_.required:P_[this.getType(a)]||void 0},e}();Ey.register=function(t,i){if(typeof i!="function")throw new Error("Cannot register a validator by type, validator is not a function");P_[t]=i};Ey.warning=noe;Ey.messages=bT;Ey.validators=P_;const koe=["","error","validating","success"],Poe=un({label:String,labelWidth:{type:[String,Number],default:""},labelPosition:{type:String,values:["left","right","top",""],default:""},prop:{type:dt([String,Array])},required:{type:Boolean,default:void 0},rules:{type:dt([Object,Array])},error:String,validateStatus:{type:String,values:koe},for:String,inlineMessage:{type:[String,Boolean],default:""},showMessage:{type:Boolean,default:!0},size:{type:String,values:Zc}}),OR="ElLabelWrap";var Roe=qe({name:OR,props:{isAutoWidth:Boolean,updateAll:Boolean},setup(e,{slots:t}){const i=An(Uf,void 0),a=An(Gc);a||ji(OR,"usage: <el-form-item><label-wrap /></el-form-item>");const d=en("form"),p=Se(),_=Se(0),r=()=>{var M;if((M=p.value)!=null&&M.firstElementChild){const k=window.getComputedStyle(p.value.firstElementChild).width;return Math.ceil(Number.parseFloat(k))}else return 0},S=(M="update")=>{Vn(()=>{t.default&&e.isAutoWidth&&(M==="update"?_.value=r():M==="remove"&&(i==null||i.deregisterLabelWidth(_.value)))})},C=()=>S("update");return gr(()=>{C()}),Oo(()=>{S("remove")}),hc(()=>C()),qt(_,(M,k)=>{e.updateAll&&(i==null||i.registerLabelWidth(M,k))}),ti(ee(()=>{var M,k;return(k=(M=p.value)==null?void 0:M.firstElementChild)!=null?k:null}),C),()=>{var M,k;if(!t)return null;const{isAutoWidth:z}=e;if(z){const F=i==null?void 0:i.autoLabelWidth,B=a==null?void 0:a.hasLabel,N={};if(B&&F&&F!=="auto"){const j=Math.max(0,Number.parseInt(F,10)-_.value),te=(a.labelPosition||i.labelPosition)==="left"?"marginRight":"marginLeft";j&&(N[te]=`${j}px`)}return Ze("div",{ref:p,class:[d.be("item","label-wrap")],style:N},[(M=t.default)==null?void 0:M.call(t)])}else return Ze(Bn,{ref:p},[(k=t.default)==null?void 0:k.call(t)])}}});const Ooe=qe({name:"ElFormItem"}),Loe=qe({...Ooe,props:Poe,setup(e,{expose:t}){const i=e,a=Hi(),d=An(Uf,void 0),p=An(Gc,void 0),_=Li(void 0,{formItem:!1}),r=en("form-item"),S=vs().value,C=Se([]),M=Se(""),k=Qq(M,100),z=Se(""),F=Se();let B,N=!1;const j=ee(()=>i.labelPosition||(d==null?void 0:d.labelPosition)),U=ee(()=>{if(j.value==="top")return{};const Bt=ui(i.labelWidth||(d==null?void 0:d.labelWidth)||"");return Bt?{width:Bt}:{}}),te=ee(()=>{if(j.value==="top"||d!=null&&d.inline)return{};if(!i.label&&!i.labelWidth&&le)return{};const Bt=ui(i.labelWidth||(d==null?void 0:d.labelWidth)||"");return!i.label&&!a.label?{marginLeft:Bt}:{}}),Y=ee(()=>[r.b(),r.m(_.value),r.is("error",M.value==="error"),r.is("validating",M.value==="validating"),r.is("success",M.value==="success"),r.is("required",we.value||i.required),r.is("no-asterisk",d==null?void 0:d.hideRequiredAsterisk),(d==null?void 0:d.requireAsteriskPosition)==="right"?"asterisk-right":"asterisk-left",{[r.m("feedback")]:d==null?void 0:d.statusIcon,[r.m(`label-${j.value}`)]:j.value}]),q=ee(()=>Ro(i.inlineMessage)?i.inlineMessage:(d==null?void 0:d.inlineMessage)||!1),J=ee(()=>[r.e("error"),{[r.em("error","inline")]:q.value}]),ne=ee(()=>i.prop?Dn(i.prop)?i.prop:i.prop.join("."):""),se=ee(()=>!!(i.label||a.label)),fe=ee(()=>i.for||(C.value.length===1?C.value[0]:void 0)),ce=ee(()=>!fe.value&&se.value),le=!!p,ge=ee(()=>{const Bt=d==null?void 0:d.model;if(!(!Bt||!i.prop))return M_(Bt,i.prop).value}),de=ee(()=>{const{required:Bt}=i,Wt=[];i.rules&&Wt.push(...Vs(i.rules));const Fe=d==null?void 0:d.rules;if(Fe&&i.prop){const cn=M_(Fe,i.prop).value;cn&&Wt.push(...Vs(cn))}if(Bt!==void 0){const cn=Wt.map((Re,nt)=>[Re,nt]).filter(([Re])=>Object.keys(Re).includes("required"));if(cn.length>0)for(const[Re,nt]of cn)Re.required!==Bt&&(Wt[nt]={...Re,required:Bt});else Wt.push({required:Bt})}return Wt}),ke=ee(()=>de.value.length>0),We=Bt=>de.value.filter(Fe=>!Fe.trigger||!Bt?!0:ln(Fe.trigger)?Fe.trigger.includes(Bt):Fe.trigger===Bt).map(({trigger:Fe,...cn})=>cn),we=ee(()=>de.value.some(Bt=>Bt.required)),be=ee(()=>{var Bt;return k.value==="error"&&i.showMessage&&((Bt=d==null?void 0:d.showMessage)!=null?Bt:!0)}),Me=ee(()=>`${i.label||""}${(d==null?void 0:d.labelSuffix)||""}`),Ae=Bt=>{M.value=Bt},me=Bt=>{var Wt,Fe;const{errors:cn,fields:Re}=Bt;(!cn||!Re)&&console.error(Bt),Ae("error"),z.value=cn?(Fe=(Wt=cn==null?void 0:cn[0])==null?void 0:Wt.message)!=null?Fe:`${i.prop} is required`:"",d==null||d.emit("validate",i.prop,!1,z.value)},Be=()=>{Ae("success"),d==null||d.emit("validate",i.prop,!0,"")},Ve=async Bt=>{const Wt=ne.value;return new Ey({[Wt]:Bt}).validate({[Wt]:ge.value},{firstFields:!0}).then(()=>(Be(),!0)).catch(cn=>(me(cn),Promise.reject(cn)))},bt=async(Bt,Wt)=>{if(N||!i.prop)return!1;const Fe=Nn(Wt);if(!ke.value)return Wt==null||Wt(!1),!1;const cn=We(Bt);return cn.length===0?(Wt==null||Wt(!0),!0):(Ae("validating"),Ve(cn).then(()=>(Wt==null||Wt(!0),!0)).catch(Re=>{const{fields:nt}=Re;return Wt==null||Wt(!1,nt),Fe?!1:Promise.reject(nt)}))},Pe=()=>{Ae(""),z.value="",N=!1},wt=async()=>{const Bt=d==null?void 0:d.model;if(!Bt||!i.prop)return;const Wt=M_(Bt,i.prop);N=!0,Wt.value=d3(B),await Vn(),Pe(),N=!1},Mt=Bt=>{C.value.includes(Bt)||C.value.push(Bt)},Nt=Bt=>{C.value=C.value.filter(Wt=>Wt!==Bt)};qt(()=>i.error,Bt=>{z.value=Bt||"",Ae(Bt?"error":"")},{immediate:!0}),qt(()=>i.validateStatus,Bt=>Ae(Bt||""));const vt=lo({...Zi(i),$el:F,size:_,validateState:M,labelId:S,inputIds:C,isGroup:ce,hasLabel:se,fieldValue:ge,addInputId:Mt,removeInputId:Nt,resetField:wt,clearValidate:Pe,validate:bt});return Dr(Gc,vt),gr(()=>{i.prop&&(d==null||d.addField(vt),B=d3(ge.value))}),Oo(()=>{d==null||d.removeField(vt)}),t({size:_,validateMessage:z,validateState:M,validate:bt,clearValidate:Pe,resetField:wt}),(Bt,Wt)=>{var Fe;return ae(),Oe("div",{ref_key:"formItemRef",ref:F,class:pe(b(Y)),role:b(ce)?"group":void 0,"aria-labelledby":b(ce)?b(S):void 0},[Ze(b(Roe),{"is-auto-width":b(U).width==="auto","update-all":((Fe=b(d))==null?void 0:Fe.labelWidth)==="auto"},{default:st(()=>[b(se)?(ae(),kt(Tr(b(fe)?"label":"div"),{key:0,id:b(S),for:b(fe),class:pe(b(r).e("label")),style:$n(b(U))},{default:st(()=>[pt(Bt.$slots,"label",{label:b(Me)},()=>[Rr(pn(b(Me)),1)])]),_:3},8,["id","for","class","style"])):yt("v-if",!0)]),_:3},8,["is-auto-width","update-all"]),Ue("div",{class:pe(b(r).e("content")),style:$n(b(te))},[pt(Bt.$slots,"default"),Ze(cD,{name:`${b(r).namespace.value}-zoom-in-top`},{default:st(()=>[b(be)?pt(Bt.$slots,"error",{key:0,error:z.value},()=>[Ue("div",{class:pe(b(J))},pn(z.value),3)]):yt("v-if",!0)]),_:3},8,["name"])],6)],10,["role","aria-labelledby"])}}});var C4=fn(Loe,[["__file","form-item.vue"]]);const Doe=ur(Xre,{FormItem:C4}),zoe=ri(C4),Foe=un({urlList:{type:dt(Array),default:()=>ni([])},zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},hideOnClickModal:Boolean,teleported:Boolean,closeOnPressEscape:{type:Boolean,default:!0},zoomRate:{type:Number,default:1.2},minScale:{type:Number,default:.2},maxScale:{type:Number,default:7},showProgress:{type:Boolean,default:!1},crossorigin:{type:dt(String)}}),Noe={close:()=>!0,switch:e=>Gn(e),rotate:e=>Gn(e)},Boe=qe({name:"ElImageViewer"}),Voe=qe({...Boe,props:Foe,emits:Noe,setup(e,{expose:t,emit:i}){var a;const d=e,p={CONTAIN:{name:"contain",icon:tc(p7)},ORIGINAL:{name:"original",icon:tc(L7)}},{t:_}=Gr(),r=en("image-viewer"),{nextZIndex:S}=Jm(),C=Se(),M=Se([]),k=fC(),z=Se(!0),F=Se(d.initialIndex),B=Uo(p.CONTAIN),N=Se({scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}),j=Se((a=d.zIndex)!=null?a:S()),U=ee(()=>{const{urlList:Pe}=d;return Pe.length<=1}),te=ee(()=>F.value===0),Y=ee(()=>F.value===d.urlList.length-1),q=ee(()=>d.urlList[F.value]),J=ee(()=>[r.e("btn"),r.e("prev"),r.is("disabled",!d.infinite&&te.value)]),ne=ee(()=>[r.e("btn"),r.e("next"),r.is("disabled",!d.infinite&&Y.value)]),se=ee(()=>{const{scale:Pe,deg:wt,offsetX:Mt,offsetY:Nt,enableTransition:vt}=N.value;let Bt=Mt/Pe,Wt=Nt/Pe;const Fe=wt*Math.PI/180,cn=Math.cos(Fe),Re=Math.sin(Fe);Bt=Bt*cn+Wt*Re,Wt=Wt*cn-Mt/Pe*Re;const nt={transform:`scale(${Pe}) rotate(${wt}deg) translate(${Bt}px, ${Wt}px)`,transition:vt?"transform .3s":""};return B.value.name===p.CONTAIN.name&&(nt.maxWidth=nt.maxHeight="100%"),nt}),fe=ee(()=>`${F.value+1} / ${d.urlList.length}`);function ce(){ge(),i("close")}function le(){const Pe=Ef(Mt=>{switch(Mt.code){case En.esc:d.closeOnPressEscape&&ce();break;case En.space:be();break;case En.left:Ae();break;case En.up:Be("zoomIn");break;case En.right:me();break;case En.down:Be("zoomOut");break}}),wt=Ef(Mt=>{const Nt=Mt.deltaY||Mt.deltaX;Be(Nt<0?"zoomIn":"zoomOut",{zoomRate:d.zoomRate,enableTransition:!1})});k.run(()=>{So(document,"keydown",Pe),So(document,"wheel",wt)})}function ge(){k.stop()}function de(){z.value=!1}function ke(Pe){z.value=!1,Pe.target.alt=_("el.image.error")}function We(Pe){if(z.value||Pe.button!==0||!C.value)return;N.value.enableTransition=!1;const{offsetX:wt,offsetY:Mt}=N.value,Nt=Pe.pageX,vt=Pe.pageY,Bt=Ef(Fe=>{N.value={...N.value,offsetX:wt+Fe.pageX-Nt,offsetY:Mt+Fe.pageY-vt}}),Wt=So(document,"mousemove",Bt);So(document,"mouseup",()=>{Wt()}),Pe.preventDefault()}function we(){N.value={scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}}function be(){if(z.value)return;const Pe=Am(p),wt=Object.values(p),Mt=B.value.name,vt=(wt.findIndex(Bt=>Bt.name===Mt)+1)%Pe.length;B.value=p[Pe[vt]],we()}function Me(Pe){const wt=d.urlList.length;F.value=(Pe+wt)%wt}function Ae(){te.value&&!d.infinite||Me(F.value-1)}function me(){Y.value&&!d.infinite||Me(F.value+1)}function Be(Pe,wt={}){if(z.value)return;const{minScale:Mt,maxScale:Nt}=d,{zoomRate:vt,rotateDeg:Bt,enableTransition:Wt}={zoomRate:d.zoomRate,rotateDeg:90,enableTransition:!0,...wt};switch(Pe){case"zoomOut":N.value.scale>Mt&&(N.value.scale=Number.parseFloat((N.value.scale/vt).toFixed(3)));break;case"zoomIn":N.value.scale<Nt&&(N.value.scale=Number.parseFloat((N.value.scale*vt).toFixed(3)));break;case"clockwise":N.value.deg+=Bt,i("rotate",N.value.deg);break;case"anticlockwise":N.value.deg-=Bt,i("rotate",N.value.deg);break}N.value.enableTransition=Wt}function Ve(Pe){var wt;((wt=Pe.detail)==null?void 0:wt.focusReason)==="pointer"&&Pe.preventDefault()}function bt(){d.closeOnPressEscape&&ce()}return qt(q,()=>{Vn(()=>{const Pe=M.value[0];Pe!=null&&Pe.complete||(z.value=!0)})}),qt(F,Pe=>{we(),i("switch",Pe)}),gr(()=>{le()}),t({setActiveItem:Me}),(Pe,wt)=>(ae(),kt(b(tg),{to:"body",disabled:!Pe.teleported},{default:st(()=>[Ze(ls,{name:"viewer-fade",appear:""},{default:st(()=>[Ue("div",{ref_key:"wrapper",ref:C,tabindex:-1,class:pe(b(r).e("wrapper")),style:$n({zIndex:j.value})},[Ze(b(eg),{loop:"",trapped:"","focus-trap-el":C.value,"focus-start-el":"container",onFocusoutPrevented:Ve,onReleaseRequested:bt},{default:st(()=>[Ue("div",{class:pe(b(r).e("mask")),onClick:Qn(Mt=>Pe.hideOnClickModal&&ce(),["self"])},null,10,["onClick"]),yt(" CLOSE "),Ue("span",{class:pe([b(r).e("btn"),b(r).e("close")]),onClick:ce},[Ze(b(On),null,{default:st(()=>[Ze(b(sc))]),_:1})],2),yt(" ARROW "),b(U)?yt("v-if",!0):(ae(),Oe(Bn,{key:0},[Ue("span",{class:pe(b(J)),onClick:Ae},[Ze(b(On),null,{default:st(()=>[Ze(b(Kd))]),_:1})],2),Ue("span",{class:pe(b(ne)),onClick:me},[Ze(b(On),null,{default:st(()=>[Ze(b(ca))]),_:1})],2)],64)),Pe.showProgress?(ae(),Oe("div",{key:1,class:pe([b(r).e("btn"),b(r).e("progress")])},[pt(Pe.$slots,"progress",{activeIndex:F.value,total:Pe.urlList.length},()=>[Rr(pn(b(fe)),1)])],2)):yt("v-if",!0),yt(" ACTIONS "),Ue("div",{class:pe([b(r).e("btn"),b(r).e("actions")])},[Ue("div",{class:pe(b(r).e("actions__inner"))},[pt(Pe.$slots,"toolbar",{actions:Be,prev:Ae,next:me,reset:be,activeIndex:F.value},()=>[Ze(b(On),{onClick:Mt=>Be("zoomOut")},{default:st(()=>[Ze(b(Y7))]),_:1},8,["onClick"]),Ze(b(On),{onClick:Mt=>Be("zoomIn")},{default:st(()=>[Ze(b(Pz))]),_:1},8,["onClick"]),Ue("i",{class:pe(b(r).e("actions__divider"))},null,2),Ze(b(On),{onClick:be},{default:st(()=>[(ae(),kt(Tr(b(B).icon)))]),_:1}),Ue("i",{class:pe(b(r).e("actions__divider"))},null,2),Ze(b(On),{onClick:Mt=>Be("anticlockwise")},{default:st(()=>[Ze(b(k7))]),_:1},8,["onClick"]),Ze(b(On),{onClick:Mt=>Be("clockwise")},{default:st(()=>[Ze(b(R7))]),_:1},8,["onClick"])])],2)],2),yt(" CANVAS "),Ue("div",{class:pe(b(r).e("canvas"))},[(ae(!0),Oe(Bn,null,Or(Pe.urlList,(Mt,Nt)=>hr((ae(),Oe("img",{ref_for:!0,ref:vt=>M.value[Nt]=vt,key:Mt,src:Mt,style:$n(b(se)),class:pe(b(r).e("img")),crossorigin:Pe.crossorigin,onLoad:de,onError:ke,onMousedown:We},null,46,["src","crossorigin"])),[[no,Nt===F.value]])),128))],2),pt(Pe.$slots,"default")]),_:3},8,["focus-trap-el"])],6)]),_:3})]),_:3},8,["disabled"]))}});var $oe=fn(Voe,[["__file","image-viewer.vue"]]);const E4=ur($oe),Uoe=un({hideOnClickModal:Boolean,src:{type:String,default:""},fit:{type:String,values:["","contain","cover","fill","none","scale-down"],default:""},loading:{type:String,values:["eager","lazy"]},lazy:Boolean,scrollContainer:{type:dt([String,Object])},previewSrcList:{type:dt(Array),default:()=>ni([])},previewTeleported:Boolean,zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0},zoomRate:{type:Number,default:1.2},minScale:{type:Number,default:.2},maxScale:{type:Number,default:7},showProgress:{type:Boolean,default:!1},crossorigin:{type:dt(String)}}),joe={load:e=>e instanceof Event,error:e=>e instanceof Event,switch:e=>Gn(e),close:()=>!0,show:()=>!0},Hoe=qe({name:"ElImage",inheritAttrs:!1}),Goe=qe({...Hoe,props:Uoe,emits:joe,setup(e,{expose:t,emit:i}){const a=e;let d="";const{t:p}=Gr(),_=en("image"),r=Uu(),S=ee(()=>q_(Object.entries(r).filter(([me])=>/^(data-|on[A-Z])/i.test(me)||["id","style"].includes(me)))),C=wy({excludeListeners:!0,excludeKeys:ee(()=>Object.keys(S.value))}),M=Se(),k=Se(!1),z=Se(!0),F=Se(!1),B=Se(),N=Se(),j=Hr&&"loading"in HTMLImageElement.prototype;let U,te;const Y=ee(()=>[_.e("inner"),J.value&&_.e("preview"),z.value&&_.is("loading")]),q=ee(()=>{const{fit:me}=a;return Hr&&me?{objectFit:me}:{}}),J=ee(()=>{const{previewSrcList:me}=a;return ln(me)&&me.length>0}),ne=ee(()=>{const{previewSrcList:me,initialIndex:Be}=a;let Ve=Be;return Be>me.length-1&&(Ve=0),Ve}),se=ee(()=>a.loading==="eager"?!1:!j&&a.loading==="lazy"||a.lazy),fe=()=>{Hr&&(z.value=!0,k.value=!1,M.value=a.src)};function ce(me){z.value=!1,k.value=!1,i("load",me)}function le(me){z.value=!1,k.value=!0,i("error",me)}function ge(){hee(B.value,N.value)&&(fe(),We())}const de=uz(ge,200,!0);async function ke(){var me;if(!Hr)return;await Vn();const{scrollContainer:Be}=a;la(Be)?N.value=Be:Dn(Be)&&Be!==""?N.value=(me=document.querySelector(Be))!=null?me:void 0:B.value&&(N.value=YC(B.value)),N.value&&(U=So(N,"scroll",de),setTimeout(()=>ge(),100))}function We(){!Hr||!N.value||!de||(U==null||U(),N.value=void 0)}function we(me){if(me.ctrlKey){if(me.deltaY<0)return me.preventDefault(),!1;if(me.deltaY>0)return me.preventDefault(),!1}}function be(){J.value&&(te=So("wheel",we,{passive:!1}),d=document.body.style.overflow,document.body.style.overflow="hidden",F.value=!0,i("show"))}function Me(){te==null||te(),document.body.style.overflow=d,F.value=!1,i("close")}function Ae(me){i("switch",me)}return qt(()=>a.src,()=>{se.value?(z.value=!0,k.value=!1,We(),ke()):fe()}),gr(()=>{se.value?ke():fe()}),t({showPreview:be}),(me,Be)=>(ae(),Oe("div",Mr({ref_key:"container",ref:B},b(S),{class:[b(_).b(),me.$attrs.class]}),[k.value?pt(me.$slots,"error",{key:0},()=>[Ue("div",{class:pe(b(_).e("error"))},pn(b(p)("el.image.error")),3)]):(ae(),Oe(Bn,{key:1},[M.value!==void 0?(ae(),Oe("img",Mr({key:0},b(C),{src:M.value,loading:me.loading,style:b(q),class:b(Y),crossorigin:me.crossorigin,onClick:be,onLoad:ce,onError:le}),null,16,["src","loading","crossorigin"])):yt("v-if",!0),z.value?(ae(),Oe("div",{key:1,class:pe(b(_).e("wrapper"))},[pt(me.$slots,"placeholder",{},()=>[Ue("div",{class:pe(b(_).e("placeholder"))},null,2)])],2)):yt("v-if",!0)],64)),b(J)?(ae(),Oe(Bn,{key:2},[F.value?(ae(),kt(b(E4),{key:0,"z-index":me.zIndex,"initial-index":b(ne),infinite:me.infinite,"zoom-rate":me.zoomRate,"min-scale":me.minScale,"max-scale":me.maxScale,"show-progress":me.showProgress,"url-list":me.previewSrcList,crossorigin:me.crossorigin,"hide-on-click-modal":me.hideOnClickModal,teleported:me.previewTeleported,"close-on-press-escape":me.closeOnPressEscape,onClose:Me,onSwitch:Ae},{progress:st(Ve=>[pt(me.$slots,"progress",Ha(Uc(Ve)))]),toolbar:st(Ve=>[pt(me.$slots,"toolbar",Ha(Uc(Ve)))]),default:st(()=>[me.$slots.viewer?(ae(),Oe("div",{key:0},[pt(me.$slots,"viewer")])):yt("v-if",!0)]),_:3},8,["z-index","initial-index","infinite","zoom-rate","min-scale","max-scale","show-progress","url-list","crossorigin","hide-on-click-modal","teleported","close-on-press-escape"])):yt("v-if",!0)],64)):yt("v-if",!0)],16))}});var Woe=fn(Goe,[["__file","image.vue"]]);const qoe=ur(Woe),Koe=un({id:{type:String,default:void 0},step:{type:Number,default:1},stepStrictly:Boolean,max:{type:Number,default:Number.POSITIVE_INFINITY},min:{type:Number,default:Number.NEGATIVE_INFINITY},modelValue:Number,readonly:Boolean,disabled:Boolean,size:zi,controls:{type:Boolean,default:!0},controlsPosition:{type:String,default:"",values:["","right"]},valueOnClear:{type:[String,Number,null],validator:e=>e===null||Gn(e)||["min","max"].includes(e),default:null},name:String,placeholder:String,precision:{type:Number,validator:e=>e>=0&&e===Number.parseInt(`${e}`,10)},validateEvent:{type:Boolean,default:!0},..._s(["ariaLabel"])}),Zoe={[Eo]:(e,t)=>t!==e,blur:e=>e instanceof FocusEvent,focus:e=>e instanceof FocusEvent,[Es]:e=>Gn(e)||Ki(e),[mr]:e=>Gn(e)||Ki(e)},Yoe=qe({name:"ElInputNumber"}),Xoe=qe({...Yoe,props:Koe,emits:Zoe,setup(e,{expose:t,emit:i}){const a=e,{t:d}=Gr(),p=en("input-number"),_=Se(),r=lo({currentValue:a.modelValue,userInput:null}),{formItem:S}=As(),C=ee(()=>Gn(a.modelValue)&&a.modelValue<=a.min),M=ee(()=>Gn(a.modelValue)&&a.modelValue>=a.max),k=ee(()=>{const we=U(a.step);return oo(a.precision)?Math.max(U(a.modelValue),we):(we>a.precision,a.precision)}),z=ee(()=>a.controls&&a.controlsPosition==="right"),F=Li(),B=ks(),N=ee(()=>{if(r.userInput!==null)return r.userInput;let we=r.currentValue;if(Ki(we))return"";if(Gn(we)){if(Number.isNaN(we))return"";oo(a.precision)||(we=we.toFixed(a.precision))}return we}),j=(we,be)=>{if(oo(be)&&(be=k.value),be===0)return Math.round(we);let Me=String(we);const Ae=Me.indexOf(".");if(Ae===-1||!Me.replace(".","").split("")[Ae+be])return we;const Ve=Me.length;return Me.charAt(Ve-1)==="5"&&(Me=`${Me.slice(0,Math.max(0,Ve-1))}6`),Number.parseFloat(Number(Me).toFixed(be))},U=we=>{if(Ki(we))return 0;const be=we.toString(),Me=be.indexOf(".");let Ae=0;return Me!==-1&&(Ae=be.length-Me-1),Ae},te=(we,be=1)=>Gn(we)?j(we+a.step*be):r.currentValue,Y=()=>{if(a.readonly||B.value||M.value)return;const we=Number(N.value)||0,be=te(we);ne(be),i(Es,r.currentValue),ke()},q=()=>{if(a.readonly||B.value||C.value)return;const we=Number(N.value)||0,be=te(we,-1);ne(be),i(Es,r.currentValue),ke()},J=(we,be)=>{const{max:Me,min:Ae,step:me,precision:Be,stepStrictly:Ve,valueOnClear:bt}=a;Me<Ae&&ji("InputNumber","min should not be greater than max.");let Pe=Number(we);if(Ki(we)||Number.isNaN(Pe))return null;if(we===""){if(bt===null)return null;Pe=Dn(bt)?{min:Ae,max:Me}[bt]:bt}return Ve&&(Pe=j(Math.round(Pe/me)*me,Be),Pe!==we&&be&&i(mr,Pe)),oo(Be)||(Pe=j(Pe,Be)),(Pe>Me||Pe<Ae)&&(Pe=Pe>Me?Me:Ae,be&&i(mr,Pe)),Pe},ne=(we,be=!0)=>{var Me;const Ae=r.currentValue,me=J(we);if(!be){i(mr,me);return}Ae===me&&we||(r.userInput=null,i(mr,me),Ae!==me&&i(Eo,me,Ae),a.validateEvent&&((Me=S==null?void 0:S.validate)==null||Me.call(S,"change").catch(Be=>void 0)),r.currentValue=me)},se=we=>{r.userInput=we;const be=we===""?null:Number(we);i(Es,be),ne(be,!1)},fe=we=>{const be=we!==""?Number(we):"";(Gn(be)&&!Number.isNaN(be)||we==="")&&ne(be),ke(),r.userInput=null},ce=()=>{var we,be;(be=(we=_.value)==null?void 0:we.focus)==null||be.call(we)},le=()=>{var we,be;(be=(we=_.value)==null?void 0:we.blur)==null||be.call(we)},ge=we=>{i("focus",we)},de=we=>{var be,Me;r.userInput=null,gx()&&r.currentValue===null&&((be=_.value)!=null&&be.input)&&(_.value.input.value=""),i("blur",we),a.validateEvent&&((Me=S==null?void 0:S.validate)==null||Me.call(S,"blur").catch(Ae=>void 0))},ke=()=>{r.currentValue!==a.modelValue&&(r.currentValue=a.modelValue)},We=we=>{document.activeElement===we.target&&we.preventDefault()};return qt(()=>a.modelValue,(we,be)=>{const Me=J(we,!0);r.userInput===null&&Me!==be&&(r.currentValue=Me)},{immediate:!0}),gr(()=>{var we;const{min:be,max:Me,modelValue:Ae}=a,me=(we=_.value)==null?void 0:we.input;if(me.setAttribute("role","spinbutton"),Number.isFinite(Me)?me.setAttribute("aria-valuemax",String(Me)):me.removeAttribute("aria-valuemax"),Number.isFinite(be)?me.setAttribute("aria-valuemin",String(be)):me.removeAttribute("aria-valuemin"),me.setAttribute("aria-valuenow",r.currentValue||r.currentValue===0?String(r.currentValue):""),me.setAttribute("aria-disabled",String(B.value)),!Gn(Ae)&&Ae!=null){let Be=Number(Ae);Number.isNaN(Be)&&(Be=null),i(mr,Be)}me.addEventListener("wheel",We,{passive:!1})}),hc(()=>{var we,be;const Me=(we=_.value)==null?void 0:we.input;Me==null||Me.setAttribute("aria-valuenow",`${(be=r.currentValue)!=null?be:""}`)}),t({focus:ce,blur:le}),(we,be)=>(ae(),Oe("div",{class:pe([b(p).b(),b(p).m(b(F)),b(p).is("disabled",b(B)),b(p).is("without-controls",!we.controls),b(p).is("controls-right",b(z))]),onDragstart:Qn(()=>{},["prevent"])},[we.controls?hr((ae(),Oe("span",{key:0,role:"button","aria-label":b(d)("el.inputNumber.decrease"),class:pe([b(p).e("decrease"),b(p).is("disabled",b(C))]),onKeydown:Po(q,["enter"])},[pt(we.$slots,"decrease-icon",{},()=>[Ze(b(On),null,{default:st(()=>[b(z)?(ae(),kt(b(Gu),{key:0})):(ae(),kt(b(b7),{key:1}))]),_:1})])],42,["aria-label","onKeydown"])),[[b(T1),q]]):yt("v-if",!0),we.controls?hr((ae(),Oe("span",{key:1,role:"button","aria-label":b(d)("el.inputNumber.increase"),class:pe([b(p).e("increase"),b(p).is("disabled",b(M))]),onKeydown:Po(Y,["enter"])},[pt(we.$slots,"increase-icon",{},()=>[Ze(b(On),null,{default:st(()=>[b(z)?(ae(),kt(b(JC),{key:0})):(ae(),kt(b(Az),{key:1}))]),_:1})])],42,["aria-label","onKeydown"])),[[b(T1),Y]]):yt("v-if",!0),Ze(b(Us),{id:we.id,ref_key:"input",ref:_,type:"number",step:we.step,"model-value":b(N),placeholder:we.placeholder,readonly:we.readonly,disabled:b(B),size:b(F),max:we.max,min:we.min,name:we.name,"aria-label":we.ariaLabel,"validate-event":!1,onKeydown:[Po(Qn(Y,["prevent"]),["up"]),Po(Qn(q,["prevent"]),["down"])],onBlur:de,onFocus:ge,onInput:se,onChange:fe},Ya({_:2},[we.$slots.prefix?{name:"prefix",fn:st(()=>[pt(we.$slots,"prefix")])}:void 0,we.$slots.suffix?{name:"suffix",fn:st(()=>[pt(we.$slots,"suffix")])}:void 0]),1032,["id","step","model-value","placeholder","readonly","disabled","size","max","min","name","aria-label","onKeydown"])],42,["onDragstart"]))}});var Joe=fn(Xoe,[["__file","input-number.vue"]]);const M4=ur(Joe),Qoe=un({modelValue:{type:dt(Array)},max:Number,tagType:{...Nu.type,default:"info"},tagEffect:Nu.effect,trigger:{type:dt(String),default:En.enter},draggable:{type:Boolean,default:!1},size:zi,clearable:Boolean,disabled:{type:Boolean,default:void 0},validateEvent:{type:Boolean,default:!0},readonly:Boolean,autofocus:Boolean,id:{type:String,default:void 0},tabindex:{type:[String,Number],default:0},maxlength:{type:[String,Number]},minlength:{type:[String,Number]},placeholder:String,autocomplete:{type:String,default:"off"},ariaLabel:String}),eie={[mr]:e=>ln(e)||oo(e),[Eo]:e=>ln(e)||oo(e),[Es]:e=>Dn(e),"add-tag":e=>Dn(e),"remove-tag":e=>Dn(e),focus:e=>e instanceof FocusEvent,blur:e=>e instanceof FocusEvent,clear:()=>!0};function tie({props:e,emit:t,formItem:i}){const a=ks(),d=Li(),p=Uo(),_=Se(),r=ee(()=>["small"].includes(d.value)?"small":"default"),S=ee(()=>{var ce;return(ce=e.modelValue)!=null&&ce.length?void 0:e.placeholder}),C=ee(()=>!(e.readonly||a.value)),M=ee(()=>{var ce,le;return oo(e.max)?!1:((le=(ce=e.modelValue)==null?void 0:ce.length)!=null?le:0)>=e.max}),k=ce=>{if(M.value){_.value=void 0;return}J.value||t(Es,ce.target.value)},z=ce=>{var le;if(!J.value)switch(ce.code){case e.trigger:ce.preventDefault(),ce.stopPropagation(),F();break;case En.numpadEnter:e.trigger===En.enter&&(ce.preventDefault(),ce.stopPropagation(),F());break;case En.backspace:!_.value&&((le=e.modelValue)!=null&&le.length)&&(ce.preventDefault(),ce.stopPropagation(),B(e.modelValue.length-1));break}},F=()=>{var ce,le;const ge=(ce=_.value)==null?void 0:ce.trim();if(!ge||M.value)return;const de=[...(le=e.modelValue)!=null?le:[],ge];t(mr,de),t(Eo,de),t("add-tag",ge),_.value=void 0},B=ce=>{var le;const ge=((le=e.modelValue)!=null?le:[]).slice(),[de]=ge.splice(ce,1);t(mr,ge),t(Eo,ge),t("remove-tag",de)},N=()=>{_.value=void 0,t(mr,void 0),t(Eo,void 0),t("clear")},j=(ce,le,ge)=>{var de;const ke=((de=e.modelValue)!=null?de:[]).slice(),[We]=ke.splice(ce,1),we=le>ce&&ge==="before"?-1:le<ce&&ge==="after"?1:0;ke.splice(le+we,0,We),t(mr,ke),t(Eo,ke)},U=()=>{var ce;(ce=p.value)==null||ce.focus()},te=()=>{var ce;(ce=p.value)==null||ce.blur()},{wrapperRef:Y,isFocused:q}=rh(p,{beforeFocus(){return a.value},afterBlur(){var ce;F(),e.validateEvent&&((ce=i==null?void 0:i.validate)==null||ce.call(i,"blur").catch(le=>void 0))}}),{isComposing:J,handleCompositionStart:ne,handleCompositionUpdate:se,handleCompositionEnd:fe}=Sy({afterComposition:k});return qt(()=>e.modelValue,()=>{var ce;e.validateEvent&&((ce=i==null?void 0:i.validate)==null||ce.call(i,Eo).catch(le=>void 0))}),{inputRef:p,wrapperRef:Y,isFocused:q,isComposing:J,inputValue:_,size:d,tagSize:r,placeholder:S,closable:C,disabled:a,inputLimit:M,handleDragged:j,handleInput:k,handleKeydown:z,handleAddTag:F,handleRemoveTag:B,handleClear:N,handleCompositionStart:ne,handleCompositionUpdate:se,handleCompositionEnd:fe,focus:U,blur:te}}function nie(){const e=Se(!1);return{hovering:e,handleMouseEnter:()=>{e.value=!0},handleMouseLeave:()=>{e.value=!1}}}function FE(){const e=Uo(),t=Se(0),i=11,a=ee(()=>({minWidth:`${Math.max(t.value,i)}px`}));return ti(e,()=>{var p,_;t.value=(_=(p=e.value)==null?void 0:p.getBoundingClientRect().width)!=null?_:0}),{calculatorRef:e,calculatorWidth:t,inputStyle:a}}function rie({wrapperRef:e,handleDragged:t,afterDragged:i}){const a=en("input-tag"),d=Uo(),p=Se(!1);let _,r,S,C;function M(B){return`.${a.e("inner")} .${a.namespace.value}-tag:nth-child(${B+1})`}function k(B,N){_=N,r=e.value.querySelector(M(N)),r&&(r.style.opacity="0.5"),B.dataTransfer.effectAllowed="move"}function z(B,N){if(S=N,B.preventDefault(),B.dataTransfer.dropEffect="move",oo(_)||_===N){p.value=!1;return}const j=e.value.querySelector(M(N)).getBoundingClientRect(),U=_+1!==N,te=_-1!==N,Y=B.clientX-j.left,q=U?te?.5:1:-1,J=te?U?.5:0:1;Y<=j.width*q?C="before":Y>j.width*J?C="after":C=void 0;const ne=e.value.querySelector(`.${a.e("inner")}`),se=ne.getBoundingClientRect(),fe=Number.parseFloat(Pu(ne,"gap"))/2,ce=j.top-se.top;let le=-9999;if(C==="before")le=Math.max(j.left-se.left-fe,Math.floor(-fe/2));else if(C==="after"){const ge=j.right-se.left;le=ge+(se.width===ge?Math.floor(fe/2):fe)}Sz(d.value,{top:`${ce}px`,left:`${le}px`}),p.value=!!C}function F(B){B.preventDefault(),r&&(r.style.opacity=""),C&&!oo(_)&&!oo(S)&&_!==S&&t(_,S,C),p.value=!1,_=void 0,r=null,S=void 0,C=void 0,i==null||i()}return{dropIndicatorRef:d,showDropIndicator:p,handleDragStart:k,handleDragOver:z,handleDragEnd:F}}function oie({props:e,isFocused:t,hovering:i,disabled:a,inputValue:d,size:p,validateState:_,validateIcon:r,needStatusIcon:S}){const C=Uu(),M=Hi(),k=en("input-tag"),z=en("input"),F=ee(()=>[k.b(),k.is("focused",t.value),k.is("hovering",i.value),k.is("disabled",a.value),k.m(p.value),k.e("wrapper"),C.class]),B=ee(()=>[C.style]),N=ee(()=>{var te,Y;return[k.e("inner"),k.is("draggable",e.draggable),k.is("left-space",!((te=e.modelValue)!=null&&te.length)&&!M.prefix),k.is("right-space",!((Y=e.modelValue)!=null&&Y.length)&&!U.value)]}),j=ee(()=>{var te;return e.clearable&&!a.value&&!e.readonly&&(((te=e.modelValue)==null?void 0:te.length)||d.value)&&(t.value||i.value)}),U=ee(()=>M.suffix||j.value||_.value&&r.value&&S.value);return{ns:k,nsInput:z,containerKls:F,containerStyle:B,innerKls:N,showClear:j,showSuffix:U}}const iie=qe({name:"ElInputTag",inheritAttrs:!1}),sie=qe({...iie,props:Qoe,emits:eie,setup(e,{expose:t,emit:i}){const a=e,d=wy(),p=Hi(),{form:_,formItem:r}=As(),{inputId:S}=Al(a,{formItemContext:r}),C=ee(()=>{var Re;return(Re=_==null?void 0:_.statusIcon)!=null?Re:!1}),M=ee(()=>(r==null?void 0:r.validateState)||""),k=ee(()=>M.value&&mx[M.value]),{inputRef:z,wrapperRef:F,isFocused:B,inputValue:N,size:j,tagSize:U,placeholder:te,closable:Y,disabled:q,handleDragged:J,handleInput:ne,handleKeydown:se,handleRemoveTag:fe,handleClear:ce,handleCompositionStart:le,handleCompositionUpdate:ge,handleCompositionEnd:de,focus:ke,blur:We}=tie({props:a,emit:i,formItem:r}),{hovering:we,handleMouseEnter:be,handleMouseLeave:Me}=nie(),{calculatorRef:Ae,inputStyle:me}=FE(),{dropIndicatorRef:Be,showDropIndicator:Ve,handleDragStart:bt,handleDragOver:Pe,handleDragEnd:wt}=rie({wrapperRef:F,handleDragged:J,afterDragged:ke}),{ns:Mt,nsInput:Nt,containerKls:vt,containerStyle:Bt,innerKls:Wt,showClear:Fe,showSuffix:cn}=oie({props:a,hovering:we,isFocused:B,inputValue:N,disabled:q,size:j,validateState:M,validateIcon:k,needStatusIcon:C});return t({focus:ke,blur:We}),(Re,nt)=>(ae(),Oe("div",{ref_key:"wrapperRef",ref:F,class:pe(b(vt)),style:$n(b(Bt)),onMouseenter:b(be),onMouseleave:b(Me)},[b(p).prefix?(ae(),Oe("div",{key:0,class:pe(b(Mt).e("prefix"))},[pt(Re.$slots,"prefix")],2)):yt("v-if",!0),Ue("div",{class:pe(b(Wt))},[(ae(!0),Oe(Bn,null,Or(Re.modelValue,(Qe,Yt)=>(ae(),kt(b(Dm),{key:Yt,size:b(U),closable:b(Y),type:Re.tagType,effect:Re.tagEffect,draggable:b(Y)&&Re.draggable,"disable-transitions":"",onClose:Xt=>b(fe)(Yt),onDragstart:Xt=>b(bt)(Xt,Yt),onDragover:Xt=>b(Pe)(Xt,Yt),onDragend:b(wt),onDrop:Qn(()=>{},["stop"])},{default:st(()=>[pt(Re.$slots,"tag",{value:Qe,index:Yt},()=>[Rr(pn(Qe),1)])]),_:2},1032,["size","closable","type","effect","draggable","onClose","onDragstart","onDragover","onDragend","onDrop"]))),128)),Ue("div",{class:pe(b(Mt).e("input-wrapper"))},[hr(Ue("input",Mr({id:b(S),ref_key:"inputRef",ref:z,"onUpdate:modelValue":Qe=>To(N)?N.value=Qe:null},b(d),{type:"text",minlength:Re.minlength,maxlength:Re.maxlength,disabled:b(q),readonly:Re.readonly,autocomplete:Re.autocomplete,tabindex:Re.tabindex,placeholder:b(te),autofocus:Re.autofocus,ariaLabel:Re.ariaLabel,class:b(Mt).e("input"),style:b(me),onCompositionstart:b(le),onCompositionupdate:b(ge),onCompositionend:b(de),onInput:b(ne),onKeydown:b(se)}),null,16,["id","onUpdate:modelValue","minlength","maxlength","disabled","readonly","autocomplete","tabindex","placeholder","autofocus","ariaLabel","onCompositionstart","onCompositionupdate","onCompositionend","onInput","onKeydown"]),[[tx,b(N)]]),Ue("span",{ref_key:"calculatorRef",ref:Ae,"aria-hidden":"true",class:pe(b(Mt).e("input-calculator")),textContent:pn(b(N))},null,10,["textContent"])],2),hr(Ue("div",{ref_key:"dropIndicatorRef",ref:Be,class:pe(b(Mt).e("drop-indicator"))},null,2),[[no,b(Ve)]])],2),b(cn)?(ae(),Oe("div",{key:1,class:pe(b(Mt).e("suffix"))},[pt(Re.$slots,"suffix"),b(Fe)?(ae(),kt(b(On),{key:0,class:pe([b(Mt).e("icon"),b(Mt).e("clear")]),onMousedown:Qn(b(_o),["prevent"]),onClick:b(ce)},{default:st(()=>[Ze(b(Wu))]),_:1},8,["class","onMousedown","onClick"])):yt("v-if",!0),b(M)&&b(k)&&b(C)?(ae(),kt(b(On),{key:1,class:pe([b(Nt).e("icon"),b(Nt).e("validateIcon"),b(Nt).is("loading",b(M)==="validating")])},{default:st(()=>[(ae(),kt(Tr(b(k))))]),_:1},8,["class"])):yt("v-if",!0)],2)):yt("v-if",!0)],46,["onMouseenter","onMouseleave"]))}});var aie=fn(sie,[["__file","input-tag.vue"]]);const lie=ur(aie),cie=un({type:{type:String,values:["primary","success","warning","info","danger","default"],default:"default"},underline:{type:Boolean,default:!0},disabled:Boolean,href:{type:String,default:""},target:{type:String,default:"_self"},icon:{type:Mo}}),uie={click:e=>e instanceof MouseEvent},die=qe({name:"ElLink"}),hie=qe({...die,props:cie,emits:uie,setup(e,{emit:t}){const i=e,a=en("link"),d=ee(()=>[a.b(),a.m(i.type),a.is("disabled",i.disabled),a.is("underline",i.underline&&!i.disabled)]);function p(_){i.disabled||t("click",_)}return(_,r)=>(ae(),Oe("a",{class:pe(b(d)),href:_.disabled||!_.href?void 0:_.href,target:_.disabled||!_.href?void 0:_.target,onClick:p},[_.icon?(ae(),kt(b(On),{key:0},{default:st(()=>[(ae(),kt(Tr(_.icon)))]),_:1})):yt("v-if",!0),_.$slots.default?(ae(),Oe("span",{key:1,class:pe(b(a).e("inner"))},[pt(_.$slots,"default")],2)):yt("v-if",!0),_.$slots.icon?pt(_.$slots,"icon",{key:2}):yt("v-if",!0)],10,["href","target"]))}});var fie=fn(hie,[["__file","link.vue"]]);const pie=ur(fie);let mie=class{constructor(t,i){this.parent=t,this.domNode=i,this.subIndex=0,this.subIndex=0,this.init()}init(){this.subMenuItems=this.domNode.querySelectorAll("li"),this.addListeners()}gotoSubIndex(t){t===this.subMenuItems.length?t=0:t<0&&(t=this.subMenuItems.length-1),this.subMenuItems[t].focus(),this.subIndex=t}addListeners(){const t=this.parent.domNode;Array.prototype.forEach.call(this.subMenuItems,i=>{i.addEventListener("keydown",a=>{let d=!1;switch(a.code){case En.down:{this.gotoSubIndex(this.subIndex+1),d=!0;break}case En.up:{this.gotoSubIndex(this.subIndex-1),d=!0;break}case En.tab:{Gb(t,"mouseleave");break}case En.enter:case En.numpadEnter:case En.space:{d=!0,a.currentTarget.click();break}}return d&&(a.preventDefault(),a.stopPropagation()),!1})})}},gie=class{constructor(t,i){this.domNode=t,this.submenu=null,this.submenu=null,this.init(i)}init(t){this.domNode.setAttribute("tabindex","0");const i=this.domNode.querySelector(`.${t}-menu`);i&&(this.submenu=new mie(this,i)),this.addListeners()}addListeners(){this.domNode.addEventListener("keydown",t=>{let i=!1;switch(t.code){case En.down:{Gb(t.currentTarget,"mouseenter"),this.submenu&&this.submenu.gotoSubIndex(0),i=!0;break}case En.up:{Gb(t.currentTarget,"mouseenter"),this.submenu&&this.submenu.gotoSubIndex(this.submenu.subMenuItems.length-1),i=!0;break}case En.tab:{Gb(t.currentTarget,"mouseleave");break}case En.enter:case En.numpadEnter:case En.space:{i=!0,t.currentTarget.click();break}}i&&t.preventDefault()})}},vie=class{constructor(t,i){this.domNode=t,this.init(i)}init(t){const i=this.domNode.childNodes;Array.from(i).forEach(a=>{a.nodeType===1&&new gie(a,t)})}};const _ie=qe({name:"ElMenuCollapseTransition"}),yie=qe({..._ie,setup(e){const t=en("menu"),i={onBeforeEnter:a=>a.style.opacity="0.2",onEnter(a,d){bl(a,`${t.namespace.value}-opacity-transition`),a.style.opacity="1",d()},onAfterEnter(a){js(a,`${t.namespace.value}-opacity-transition`),a.style.opacity=""},onBeforeLeave(a){a.dataset||(a.dataset={}),Aa(a,t.m("collapse"))?(js(a,t.m("collapse")),a.dataset.oldOverflow=a.style.overflow,a.dataset.scrollWidth=a.clientWidth.toString(),bl(a,t.m("collapse"))):(bl(a,t.m("collapse")),a.dataset.oldOverflow=a.style.overflow,a.dataset.scrollWidth=a.clientWidth.toString(),js(a,t.m("collapse"))),a.style.width=`${a.scrollWidth}px`,a.style.overflow="hidden"},onLeave(a){bl(a,"horizontal-collapse-transition"),a.style.width=`${a.dataset.scrollWidth}px`}};return(a,d)=>(ae(),kt(ls,Mr({mode:"out-in"},b(i)),{default:st(()=>[pt(a.$slots,"default")]),_:3},16))}});var bie=fn(yie,[["__file","menu-collapse-transition.vue"]]);function I4(e,t){const i=ee(()=>{let d=e.parent;const p=[t.value];for(;d.type.name!=="ElMenu";)d.props.index&&p.unshift(d.props.index),d=d.parent;return p});return{parentMenu:ee(()=>{let d=e.parent;for(;d&&!["ElMenu","ElSubMenu"].includes(d.type.name);)d=d.parent;return d}),indexPath:i}}function xie(e){return ee(()=>{const i=e.backgroundColor;return i?new dF(i).shade(20).toString():""})}const A4=(e,t)=>{const i=en("menu");return ee(()=>i.cssVarBlock({"text-color":e.textColor||"","hover-text-color":e.textColor||"","bg-color":e.backgroundColor||"","hover-bg-color":xie(e).value||"","active-color":e.activeTextColor||"",level:`${t}`}))},wie=un({index:{type:String,required:!0},showTimeout:Number,hideTimeout:Number,popperClass:String,disabled:Boolean,teleported:{type:Boolean,default:void 0},popperOffset:Number,expandCloseIcon:{type:Mo},expandOpenIcon:{type:Mo},collapseCloseIcon:{type:Mo},collapseOpenIcon:{type:Mo}}),fS="ElSubMenu";var NE=qe({name:fS,props:wie,setup(e,{slots:t,expose:i}){const a=wr(),{indexPath:d,parentMenu:p}=I4(a,ee(()=>e.index)),_=en("menu"),r=en("sub-menu"),S=An("rootMenu");S||ji(fS,"can not inject root menu");const C=An(`subMenu:${p.value.uid}`);C||ji(fS,"can not inject sub menu");const M=Se({}),k=Se({});let z;const F=Se(!1),B=Se(),N=Se(),j=ee(()=>fe.value==="horizontal"&&te.value?"bottom-start":"right-start"),U=ee(()=>fe.value==="horizontal"&&te.value||fe.value==="vertical"&&!S.props.collapse?e.expandCloseIcon&&e.expandOpenIcon?ne.value?e.expandOpenIcon:e.expandCloseIcon:Gu:e.collapseCloseIcon&&e.collapseOpenIcon?ne.value?e.collapseOpenIcon:e.collapseCloseIcon:ca),te=ee(()=>C.level===0),Y=ee(()=>{const Ve=e.teleported;return Ve===void 0?te.value:Ve}),q=ee(()=>S.props.collapse?`${_.namespace.value}-zoom-in-left`:`${_.namespace.value}-zoom-in-top`),J=ee(()=>fe.value==="horizontal"&&te.value?["bottom-start","bottom-end","top-start","top-end","right-start","left-start"]:["right-start","right","right-end","left-start","bottom-start","bottom-end","top-start","top-end"]),ne=ee(()=>S.openedMenus.includes(e.index)),se=ee(()=>[...Object.values(M.value),...Object.values(k.value)].some(({active:Ve})=>Ve)),fe=ee(()=>S.props.mode),ce=ee(()=>S.props.persistent),le=lo({index:e.index,indexPath:d,active:se}),ge=A4(S.props,C.level+1),de=ee(()=>{var Ve;return(Ve=e.popperOffset)!=null?Ve:S.props.popperOffset}),ke=ee(()=>{var Ve;return(Ve=e.popperClass)!=null?Ve:S.props.popperClass}),We=ee(()=>{var Ve;return(Ve=e.showTimeout)!=null?Ve:S.props.showTimeout}),we=ee(()=>{var Ve;return(Ve=e.hideTimeout)!=null?Ve:S.props.hideTimeout}),be=()=>{var Ve,bt,Pe;return(Pe=(bt=(Ve=N.value)==null?void 0:Ve.popperRef)==null?void 0:bt.popperInstanceRef)==null?void 0:Pe.destroy()},Me=Ve=>{Ve||be()},Ae=()=>{S.props.menuTrigger==="hover"&&S.props.mode==="horizontal"||S.props.collapse&&S.props.mode==="vertical"||e.disabled||S.handleSubMenuClick({index:e.index,indexPath:d.value,active:se.value})},me=(Ve,bt=We.value)=>{var Pe;if(Ve.type!=="focus"){if(S.props.menuTrigger==="click"&&S.props.mode==="horizontal"||!S.props.collapse&&S.props.mode==="vertical"||e.disabled){C.mouseInChild.value=!0;return}C.mouseInChild.value=!0,z==null||z(),{stop:z}=Of(()=>{S.openMenu(e.index,d.value)},bt),Y.value&&((Pe=p.value.vnode.el)==null||Pe.dispatchEvent(new MouseEvent("mouseenter")))}},Be=(Ve=!1)=>{var bt;if(S.props.menuTrigger==="click"&&S.props.mode==="horizontal"||!S.props.collapse&&S.props.mode==="vertical"){C.mouseInChild.value=!1;return}z==null||z(),C.mouseInChild.value=!1,{stop:z}=Of(()=>!F.value&&S.closeMenu(e.index,d.value),we.value),Y.value&&Ve&&((bt=C.handleMouseleave)==null||bt.call(C,!0))};qt(()=>S.props.collapse,Ve=>Me(!!Ve));{const Ve=Pe=>{k.value[Pe.index]=Pe},bt=Pe=>{delete k.value[Pe.index]};Dr(`subMenu:${a.uid}`,{addSubMenu:Ve,removeSubMenu:bt,handleMouseleave:Be,mouseInChild:F,level:C.level+1})}return i({opened:ne}),gr(()=>{S.addSubMenu(le),C.addSubMenu(le)}),Oo(()=>{C.removeSubMenu(le),S.removeSubMenu(le)}),()=>{var Ve;const bt=[(Ve=t.title)==null?void 0:Ve.call(t),Kn(On,{class:r.e("icon-arrow"),style:{transform:ne.value?e.expandCloseIcon&&e.expandOpenIcon||e.collapseCloseIcon&&e.collapseOpenIcon&&S.props.collapse?"none":"rotateZ(180deg)":"none"}},{default:()=>Dn(U.value)?Kn(a.appContext.components[U.value]):Kn(U.value)})],Pe=S.isMenuPopup?Kn(Is,{ref:N,visible:ne.value,effect:"light",pure:!0,offset:de.value,showArrow:!1,persistent:ce.value,popperClass:ke.value,placement:j.value,teleported:Y.value,fallbackPlacements:J.value,transition:q.value,gpuAcceleration:!1},{content:()=>{var wt;return Kn("div",{class:[_.m(fe.value),_.m("popup-container"),ke.value],onMouseenter:Mt=>me(Mt,100),onMouseleave:()=>Be(!0),onFocus:Mt=>me(Mt,100)},[Kn("ul",{class:[_.b(),_.m("popup"),_.m(`popup-${j.value}`)],style:ge.value},[(wt=t.default)==null?void 0:wt.call(t)])])},default:()=>Kn("div",{class:r.e("title"),onClick:Ae},bt)}):Kn(Bn,{},[Kn("div",{class:r.e("title"),ref:B,onClick:Ae},bt),Kn(bx,{},{default:()=>{var wt;return hr(Kn("ul",{role:"menu",class:[_.b(),_.m("inline")],style:ge.value},[(wt=t.default)==null?void 0:wt.call(t)]),[[no,ne.value]])}})]);return Kn("li",{class:[r.b(),r.is("active",se.value),r.is("opened",ne.value),r.is("disabled",e.disabled)],role:"menuitem",ariaHaspopup:!0,ariaExpanded:ne.value,onMouseenter:me,onMouseleave:()=>Be(),onFocus:me},[Pe])}}});const Sie=un({mode:{type:String,values:["horizontal","vertical"],default:"vertical"},defaultActive:{type:String,default:""},defaultOpeneds:{type:dt(Array),default:()=>ni([])},uniqueOpened:Boolean,router:Boolean,menuTrigger:{type:String,values:["hover","click"],default:"hover"},collapse:Boolean,backgroundColor:String,textColor:String,activeTextColor:String,closeOnClickOutside:Boolean,collapseTransition:{type:Boolean,default:!0},ellipsis:{type:Boolean,default:!0},popperOffset:{type:Number,default:6},ellipsisIcon:{type:Mo,default:()=>S7},popperEffect:{type:dt(String),default:"dark"},popperClass:String,showTimeout:{type:Number,default:300},hideTimeout:{type:Number,default:300},persistent:{type:Boolean,default:!0}}),pS=e=>ln(e)&&e.every(t=>Dn(t)),Tie={close:(e,t)=>Dn(e)&&pS(t),open:(e,t)=>Dn(e)&&pS(t),select:(e,t,i,a)=>Dn(e)&&pS(t)&&yr(i)&&(a===void 0||a instanceof Promise)};var Cie=qe({name:"ElMenu",props:Sie,emits:Tie,setup(e,{emit:t,slots:i,expose:a}){const d=wr(),p=d.appContext.config.globalProperties.$router,_=Se(),r=en("menu"),S=en("sub-menu"),C=Se(-1),M=Se(e.defaultOpeneds&&!e.collapse?e.defaultOpeneds.slice(0):[]),k=Se(e.defaultActive),z=Se({}),F=Se({}),B=ee(()=>e.mode==="horizontal"||e.mode==="vertical"&&e.collapse),N=()=>{const we=k.value&&z.value[k.value];if(!we||e.mode==="horizontal"||e.collapse)return;we.indexPath.forEach(Me=>{const Ae=F.value[Me];Ae&&j(Me,Ae.indexPath)})},j=(we,be)=>{M.value.includes(we)||(e.uniqueOpened&&(M.value=M.value.filter(Me=>be.includes(Me))),M.value.push(we),t("open",we,be))},U=we=>{const be=M.value.indexOf(we);be!==-1&&M.value.splice(be,1)},te=(we,be)=>{U(we),t("close",we,be)},Y=({index:we,indexPath:be})=>{M.value.includes(we)?te(we,be):j(we,be)},q=we=>{(e.mode==="horizontal"||e.collapse)&&(M.value=[]);const{index:be,indexPath:Me}=we;if(!(Ki(be)||Ki(Me)))if(e.router&&p){const Ae=we.route||be,me=p.push(Ae).then(Be=>(Be||(k.value=be),Be));t("select",be,Me,{index:be,indexPath:Me,route:Ae},me)}else k.value=be,t("select",be,Me,{index:be,indexPath:Me})},J=we=>{var be;const Me=z.value,Ae=Me[we]||k.value&&Me[k.value]||Me[e.defaultActive];k.value=(be=Ae==null?void 0:Ae.index)!=null?be:we},ne=we=>{const be=getComputedStyle(we),Me=Number.parseInt(be.marginLeft,10),Ae=Number.parseInt(be.marginRight,10);return we.offsetWidth+Me+Ae||0},se=()=>{var we,be;if(!_.value)return-1;const Me=Array.from((be=(we=_.value)==null?void 0:we.childNodes)!=null?be:[]).filter(Mt=>Mt.nodeName!=="#text"||Mt.nodeValue),Ae=64,me=getComputedStyle(_.value),Be=Number.parseInt(me.paddingLeft,10),Ve=Number.parseInt(me.paddingRight,10),bt=_.value.clientWidth-Be-Ve;let Pe=0,wt=0;return Me.forEach((Mt,Nt)=>{Mt.nodeName!=="#comment"&&(Pe+=ne(Mt),Pe<=bt-Ae&&(wt=Nt+1))}),wt===Me.length?-1:wt},fe=we=>F.value[we].indexPath,ce=(we,be=33.34)=>{let Me;return()=>{Me&&clearTimeout(Me),Me=setTimeout(()=>{we()},be)}};let le=!0;const ge=()=>{if(C.value===se())return;const we=()=>{C.value=-1,Vn(()=>{C.value=se()})};le?we():ce(we)(),le=!1};qt(()=>e.defaultActive,we=>{z.value[we]||(k.value=""),J(we)}),qt(()=>e.collapse,we=>{we&&(M.value=[])}),qt(z.value,N);let de;Cs(()=>{e.mode==="horizontal"&&e.ellipsis?de=ti(_,ge).stop:de==null||de()});const ke=Se(!1);{const we=me=>{F.value[me.index]=me},be=me=>{delete F.value[me.index]};Dr("rootMenu",lo({props:e,openedMenus:M,items:z,subMenus:F,activeIndex:k,isMenuPopup:B,addMenuItem:me=>{z.value[me.index]=me},removeMenuItem:me=>{delete z.value[me.index]},addSubMenu:we,removeSubMenu:be,openMenu:j,closeMenu:te,handleMenuItemClick:q,handleSubMenuClick:Y})),Dr(`subMenu:${d.uid}`,{addSubMenu:we,removeSubMenu:be,mouseInChild:ke,level:0})}gr(()=>{e.mode==="horizontal"&&new vie(d.vnode.el,r.namespace.value)}),a({open:be=>{const{indexPath:Me}=F.value[be];Me.forEach(Ae=>j(Ae,Me))},close:U,handleResize:ge});const We=A4(e,0);return()=>{var we,be;let Me=(be=(we=i.default)==null?void 0:we.call(i))!=null?be:[];const Ae=[];if(e.mode==="horizontal"&&_.value){const Ve=Ou(Me),bt=C.value===-1?Ve:Ve.slice(0,C.value),Pe=C.value===-1?[]:Ve.slice(C.value);Pe!=null&&Pe.length&&e.ellipsis&&(Me=bt,Ae.push(Kn(NE,{index:"sub-menu-more",class:S.e("hide-arrow"),popperOffset:e.popperOffset},{title:()=>Kn(On,{class:S.e("icon-more")},{default:()=>Kn(e.ellipsisIcon)}),default:()=>Pe})))}const me=e.closeOnClickOutside?[[Bu,()=>{M.value.length&&(ke.value||(M.value.forEach(Ve=>t("close",Ve,fe(Ve))),M.value=[]))}]]:[],Be=hr(Kn("ul",{key:String(e.collapse),role:"menubar",ref:_,style:We.value,class:{[r.b()]:!0,[r.m(e.mode)]:!0,[r.m("collapse")]:e.collapse}},[...Me,...Ae]),me);return e.collapseTransition&&e.mode==="vertical"?Kn(bie,()=>Be):Be}}});const Eie=un({index:{type:dt([String,null]),default:null},route:{type:dt([String,Object])},disabled:Boolean}),Mie={click:e=>Dn(e.index)&&ln(e.indexPath)},xT="ElMenuItem",Iie=qe({name:xT}),Aie=qe({...Iie,props:Eie,emits:Mie,setup(e,{expose:t,emit:i}){const a=e,d=wr(),p=An("rootMenu"),_=en("menu"),r=en("menu-item");p||ji(xT,"can not inject root menu");const{parentMenu:S,indexPath:C}=I4(d,po(a,"index")),M=An(`subMenu:${S.value.uid}`);M||ji(xT,"can not inject sub menu");const k=ee(()=>a.index===p.activeIndex),z=lo({index:a.index,indexPath:C,active:k}),F=()=>{a.disabled||(p.handleMenuItemClick({index:a.index,indexPath:C.value,route:a.route}),i("click",z))};return gr(()=>{M.addSubMenu(z),p.addMenuItem(z)}),Oo(()=>{M.removeSubMenu(z),p.removeMenuItem(z)}),t({parentMenu:S,rootMenu:p,active:k,nsMenu:_,nsMenuItem:r,handleClick:F}),(B,N)=>(ae(),Oe("li",{class:pe([b(r).b(),b(r).is("active",b(k)),b(r).is("disabled",B.disabled)]),role:"menuitem",tabindex:"-1",onClick:F},[b(S).type.name==="ElMenu"&&b(p).props.collapse&&B.$slots.title?(ae(),kt(b(Is),{key:0,effect:b(p).props.popperEffect,placement:"right","fallback-placements":["left"],persistent:b(p).props.persistent},{content:st(()=>[pt(B.$slots,"title")]),default:st(()=>[Ue("div",{class:pe(b(_).be("tooltip","trigger"))},[pt(B.$slots,"default")],2)]),_:3},8,["effect","persistent"])):(ae(),Oe(Bn,{key:1},[pt(B.$slots,"default"),pt(B.$slots,"title")],64))],2))}});var k4=fn(Aie,[["__file","menu-item.vue"]]);const kie={title:String},Pie=qe({name:"ElMenuItemGroup"}),Rie=qe({...Pie,props:kie,setup(e){const t=en("menu-item-group");return(i,a)=>(ae(),Oe("li",{class:pe(b(t).b())},[Ue("div",{class:pe(b(t).e("title"))},[i.$slots.title?pt(i.$slots,"title",{key:1}):(ae(),Oe(Bn,{key:0},[Rr(pn(i.title),1)],64))],2),Ue("ul",null,[pt(i.$slots,"default")])],2))}});var P4=fn(Rie,[["__file","menu-item-group.vue"]]);const Oie=ur(Cie,{MenuItem:k4,MenuItemGroup:P4,SubMenu:NE}),Lie=ri(k4),Die=ri(P4),zie=ri(NE),Fie=un({icon:{type:Mo,default:()=>q9},title:String,content:{type:String,default:""}}),Nie={back:()=>!0},Bie=qe({name:"ElPageHeader"}),Vie=qe({...Bie,props:Fie,emits:Nie,setup(e,{emit:t}){const{t:i}=Gr(),a=en("page-header");function d(){t("back")}return(p,_)=>(ae(),Oe("div",{class:pe([b(a).b(),{[b(a).m("has-breadcrumb")]:!!p.$slots.breadcrumb,[b(a).m("has-extra")]:!!p.$slots.extra,[b(a).is("contentful")]:!!p.$slots.default}])},[p.$slots.breadcrumb?(ae(),Oe("div",{key:0,class:pe(b(a).e("breadcrumb"))},[pt(p.$slots,"breadcrumb")],2)):yt("v-if",!0),Ue("div",{class:pe(b(a).e("header"))},[Ue("div",{class:pe(b(a).e("left"))},[Ue("div",{class:pe(b(a).e("back")),role:"button",tabindex:"0",onClick:d},[p.icon||p.$slots.icon?(ae(),Oe("div",{key:0,"aria-label":p.title||b(i)("el.pageHeader.title"),class:pe(b(a).e("icon"))},[pt(p.$slots,"icon",{},()=>[p.icon?(ae(),kt(b(On),{key:0},{default:st(()=>[(ae(),kt(Tr(p.icon)))]),_:1})):yt("v-if",!0)])],10,["aria-label"])):yt("v-if",!0),Ue("div",{class:pe(b(a).e("title"))},[pt(p.$slots,"title",{},()=>[Rr(pn(p.title||b(i)("el.pageHeader.title")),1)])],2)],2),Ze(b(p4),{direction:"vertical"}),Ue("div",{class:pe(b(a).e("content"))},[pt(p.$slots,"content",{},()=>[Rr(pn(p.content),1)])],2)],2),p.$slots.extra?(ae(),Oe("div",{key:0,class:pe(b(a).e("extra"))},[pt(p.$slots,"extra")],2)):yt("v-if",!0)],2),p.$slots.default?(ae(),Oe("div",{key:1,class:pe(b(a).e("main"))},[pt(p.$slots,"default")],2)):yt("v-if",!0)],2))}});var $ie=fn(Vie,[["__file","page-header.vue"]]);const Uie=ur($ie),R4=Symbol("elPaginationKey"),jie=un({disabled:Boolean,currentPage:{type:Number,default:1},prevText:{type:String},prevIcon:{type:Mo}}),Hie={click:e=>e instanceof MouseEvent},Gie=qe({name:"ElPaginationPrev"}),Wie=qe({...Gie,props:jie,emits:Hie,setup(e){const t=e,{t:i}=Gr(),a=ee(()=>t.disabled||t.currentPage<=1);return(d,p)=>(ae(),Oe("button",{type:"button",class:"btn-prev",disabled:b(a),"aria-label":d.prevText||b(i)("el.pagination.prev"),"aria-disabled":b(a),onClick:_=>d.$emit("click",_)},[d.prevText?(ae(),Oe("span",{key:0},pn(d.prevText),1)):(ae(),kt(b(On),{key:1},{default:st(()=>[(ae(),kt(Tr(d.prevIcon)))]),_:1}))],8,["disabled","aria-label","aria-disabled","onClick"]))}});var qie=fn(Wie,[["__file","prev.vue"]]);const Kie=un({disabled:Boolean,currentPage:{type:Number,default:1},pageCount:{type:Number,default:50},nextText:{type:String},nextIcon:{type:Mo}}),Zie=qe({name:"ElPaginationNext"}),Yie=qe({...Zie,props:Kie,emits:["click"],setup(e){const t=e,{t:i}=Gr(),a=ee(()=>t.disabled||t.currentPage===t.pageCount||t.pageCount===0);return(d,p)=>(ae(),Oe("button",{type:"button",class:"btn-next",disabled:b(a),"aria-label":d.nextText||b(i)("el.pagination.next"),"aria-disabled":b(a),onClick:_=>d.$emit("click",_)},[d.nextText?(ae(),Oe("span",{key:0},pn(d.nextText),1)):(ae(),kt(b(On),{key:1},{default:st(()=>[(ae(),kt(Tr(d.nextIcon)))]),_:1}))],8,["disabled","aria-label","aria-disabled","onClick"]))}});var Xie=fn(Yie,[["__file","next.vue"]]);const O4=Symbol("ElSelectGroup"),rg=Symbol("ElSelect");function Jie(e,t){const i=An(rg),a=An(O4,{disabled:!1}),d=ee(()=>M(Vs(i.props.modelValue),e.value)),p=ee(()=>{var F;if(i.props.multiple){const B=Vs((F=i.props.modelValue)!=null?F:[]);return!d.value&&B.length>=i.props.multipleLimit&&i.props.multipleLimit>0}else return!1}),_=ee(()=>e.label||(yr(e.value)?"":e.value)),r=ee(()=>e.value||e.label||""),S=ee(()=>e.disabled||t.groupDisabled||p.value),C=wr(),M=(F=[],B)=>{if(yr(e.value)){const N=i.props.valueKey;return F&&F.some(j=>wo(Ii(j,N))===Ii(B,N))}else return F&&F.includes(B)},k=()=>{!e.disabled&&!a.disabled&&(i.states.hoveringIndex=i.optionsArray.indexOf(C.proxy))},z=F=>{const B=new RegExp(xE(F),"i");t.visible=B.test(_.value)||e.created};return qt(()=>_.value,()=>{!e.created&&!i.props.remote&&i.setSelected()}),qt(()=>e.value,(F,B)=>{const{remote:N,valueKey:j}=i.props;if((N?F!==B:!ms(F,B))&&(i.onOptionDestroy(B,C.proxy),i.onOptionCreate(C.proxy)),!e.created&&!N){if(j&&yr(F)&&yr(B)&&F[j]===B[j])return;i.setSelected()}}),qt(()=>a.disabled,()=>{t.groupDisabled=a.disabled},{immediate:!0}),{select:i,currentLabel:_,currentValue:r,itemSelected:d,isDisabled:S,hoverItem:k,updateOption:z}}const Qie=qe({name:"ElOption",componentName:"ElOption",props:{value:{required:!0,type:[String,Number,Boolean,Object]},label:[String,Number],created:Boolean,disabled:Boolean},setup(e){const t=en("select"),i=vs(),a=ee(()=>[t.be("dropdown","item"),t.is("disabled",b(r)),t.is("selected",b(_)),t.is("hovering",b(z))]),d=lo({index:-1,groupDisabled:!1,visible:!0,hover:!1}),{currentLabel:p,itemSelected:_,isDisabled:r,select:S,hoverItem:C,updateOption:M}=Jie(e,d),{visible:k,hover:z}=Zi(d),F=wr().proxy;S.onOptionCreate(F),Oo(()=>{const N=F.value,{selected:j}=S.states,U=j.some(te=>te.value===F.value);Vn(()=>{S.states.cachedOptions.get(N)===F&&!U&&S.states.cachedOptions.delete(N)}),S.onOptionDestroy(N,F)});function B(){r.value||S.handleOptionSelect(F)}return{ns:t,id:i,containerKls:a,currentLabel:p,itemSelected:_,isDisabled:r,select:S,hoverItem:C,updateOption:M,visible:k,hover:z,selectOptionClick:B,states:d}}});function ese(e,t,i,a,d,p){return hr((ae(),Oe("li",{id:e.id,class:pe(e.containerKls),role:"option","aria-disabled":e.isDisabled||void 0,"aria-selected":e.itemSelected,onMousemove:e.hoverItem,onClick:Qn(e.selectOptionClick,["stop"])},[pt(e.$slots,"default",{},()=>[Ue("span",null,pn(e.currentLabel),1)])],42,["id","aria-disabled","aria-selected","onMousemove","onClick"])),[[no,e.visible]])}var BE=fn(Qie,[["render",ese],["__file","option.vue"]]);const tse=qe({name:"ElSelectDropdown",componentName:"ElSelectDropdown",setup(){const e=An(rg),t=en("select"),i=ee(()=>e.props.popperClass),a=ee(()=>e.props.multiple),d=ee(()=>e.props.fitInputWidth),p=Se("");function _(){var r;p.value=`${(r=e.selectRef)==null?void 0:r.offsetWidth}px`}return gr(()=>{_(),ti(e.selectRef,_)}),{ns:t,minWidth:p,popperClass:i,isMultiple:a,isFitInputWidth:d}}});function nse(e,t,i,a,d,p){return ae(),Oe("div",{class:pe([e.ns.b("dropdown"),e.ns.is("multiple",e.isMultiple),e.popperClass]),style:$n({[e.isFitInputWidth?"width":"minWidth"]:e.minWidth})},[e.$slots.header?(ae(),Oe("div",{key:0,class:pe(e.ns.be("dropdown","header"))},[pt(e.$slots,"header")],2)):yt("v-if",!0),pt(e.$slots,"default"),e.$slots.footer?(ae(),Oe("div",{key:1,class:pe(e.ns.be("dropdown","footer"))},[pt(e.$slots,"footer")],2)):yt("v-if",!0)],6)}var rse=fn(tse,[["render",nse],["__file","select-dropdown.vue"]]);const ose=(e,t)=>{const{t:i}=Gr(),a=vs(),d=en("select"),p=en("input"),_=lo({inputValue:"",options:new Map,cachedOptions:new Map,optionValues:[],selected:[],selectionWidth:0,collapseItemWidth:0,selectedLabel:"",hoveringIndex:-1,previousQuery:null,inputHovering:!1,menuVisibleOnFocus:!1,isBeforeHide:!1}),r=Se(null),S=Se(null),C=Se(null),M=Se(null),k=Se(null),z=Se(null),F=Se(null),B=Se(null),N=Se(null),j=Se(null),U=Se(null),{isComposing:te,handleCompositionStart:Y,handleCompositionUpdate:q,handleCompositionEnd:J}=Sy({afterComposition:he=>tr(he)}),{wrapperRef:ne,isFocused:se,handleBlur:fe}=rh(k,{beforeFocus(){return be.value},afterFocus(){e.automaticDropdown&&!ce.value&&(ce.value=!0,_.menuVisibleOnFocus=!0)},beforeBlur(he){var Ie,je;return((Ie=C.value)==null?void 0:Ie.isFocusInsideContent(he))||((je=M.value)==null?void 0:je.isFocusInsideContent(he))},afterBlur(){ce.value=!1,_.menuVisibleOnFocus=!1}}),ce=Se(!1),le=Se(),{form:ge,formItem:de}=As(),{inputId:ke}=Al(e,{formItemContext:de}),{valueOnClear:We,isEmptyValue:we}=dx(e),be=ee(()=>e.disabled||(ge==null?void 0:ge.disabled)),Me=ee(()=>ln(e.modelValue)?e.modelValue.length>0:!we(e.modelValue)),Ae=ee(()=>{var he;return(he=ge==null?void 0:ge.statusIcon)!=null?he:!1}),me=ee(()=>e.clearable&&!be.value&&_.inputHovering&&Me.value),Be=ee(()=>e.remote&&e.filterable&&!e.remoteShowSuffix?"":e.suffixIcon),Ve=ee(()=>d.is("reverse",Be.value&&ce.value)),bt=ee(()=>(de==null?void 0:de.validateState)||""),Pe=ee(()=>mx[bt.value]),wt=ee(()=>e.remote?300:0),Mt=ee(()=>e.remote&&!_.inputValue&&_.options.size===0),Nt=ee(()=>e.loading?e.loadingText||i("el.select.loading"):e.filterable&&_.inputValue&&_.options.size>0&&vt.value===0?e.noMatchText||i("el.select.noMatch"):_.options.size===0?e.noDataText||i("el.select.noData"):null),vt=ee(()=>Bt.value.filter(he=>he.visible).length),Bt=ee(()=>{const he=Array.from(_.options.values()),Ie=[];return _.optionValues.forEach(je=>{const Je=he.findIndex(lt=>lt.value===je);Je>-1&&Ie.push(he[Je])}),Ie.length>=he.length?Ie:he}),Wt=ee(()=>Array.from(_.cachedOptions.values())),Fe=ee(()=>{const he=Bt.value.filter(Ie=>!Ie.created).some(Ie=>Ie.currentLabel===_.inputValue);return e.filterable&&e.allowCreate&&_.inputValue!==""&&!he}),cn=()=>{e.filterable&&Nn(e.filterMethod)||e.filterable&&e.remote&&Nn(e.remoteMethod)||Bt.value.forEach(he=>{var Ie;(Ie=he.updateOption)==null||Ie.call(he,_.inputValue)})},Re=Li(),nt=ee(()=>["small"].includes(Re.value)?"small":"default"),Qe=ee({get(){return ce.value&&!Mt.value},set(he){ce.value=he}}),Yt=ee(()=>{if(e.multiple&&!oo(e.modelValue))return Vs(e.modelValue).length===0&&!_.inputValue;const he=ln(e.modelValue)?e.modelValue[0]:e.modelValue;return e.filterable||oo(he)?!_.inputValue:!0}),Xt=ee(()=>{var he;const Ie=(he=e.placeholder)!=null?he:i("el.select.placeholder");return e.multiple||!Me.value?Ie:_.selectedLabel}),$t=ee(()=>JS?null:"mouseenter");qt(()=>e.modelValue,(he,Ie)=>{e.multiple&&e.filterable&&!e.reserveKeyword&&(_.inputValue="",Ot("")),sn(),!ms(he,Ie)&&e.validateEvent&&(de==null||de.validate("change").catch(je=>void 0))},{flush:"post",deep:!0}),qt(()=>ce.value,he=>{he?Ot(_.inputValue):(_.inputValue="",_.previousQuery=null,_.isBeforeHide=!0),t("visible-change",he)}),qt(()=>_.options.entries(),()=>{Hr&&(sn(),e.defaultFirstOption&&(e.filterable||e.remote)&&vt.value&&Ft())},{flush:"post"}),qt(()=>_.hoveringIndex,he=>{Gn(he)&&he>-1?le.value=Bt.value[he]||{}:le.value={},Bt.value.forEach(Ie=>{Ie.hover=le.value===Ie})}),Cs(()=>{_.isBeforeHide||cn()});const Ot=he=>{_.previousQuery===he||te.value||(_.previousQuery=he,e.filterable&&Nn(e.filterMethod)?e.filterMethod(he):e.filterable&&e.remote&&Nn(e.remoteMethod)&&e.remoteMethod(he),e.defaultFirstOption&&(e.filterable||e.remote)&&vt.value?Vn(Ft):Vn(Pn))},Ft=()=>{const he=Bt.value.filter(lt=>lt.visible&&!lt.disabled&&!lt.states.groupDisabled),Ie=he.find(lt=>lt.created),je=he[0],Je=Bt.value.map(lt=>lt.value);_.hoveringIndex=tt(Je,Ie||je)},sn=()=>{if(e.multiple)_.selectedLabel="";else{const Ie=ln(e.modelValue)?e.modelValue[0]:e.modelValue,je=an(Ie);_.selectedLabel=je.currentLabel,_.selected=[je];return}const he=[];oo(e.modelValue)||Vs(e.modelValue).forEach(Ie=>{he.push(an(Ie))}),_.selected=he},an=he=>{let Ie;const je=D_(he);for(let St=_.cachedOptions.size-1;St>=0;St--){const ht=Wt.value[St];if(je?Ii(ht.value,e.valueKey)===Ii(he,e.valueKey):ht.value===he){Ie={value:he,currentLabel:ht.currentLabel,get isDisabled(){return ht.isDisabled}};break}}if(Ie)return Ie;const Je=je?he.label:he??"";return{value:he,currentLabel:Je}},Pn=()=>{_.hoveringIndex=Bt.value.findIndex(he=>_.selected.some(Ie=>ga(Ie)===ga(he)))},bn=()=>{_.selectionWidth=S.value.getBoundingClientRect().width},It=()=>{_.collapseItemWidth=j.value.getBoundingClientRect().width},Sn=()=>{var he,Ie;(Ie=(he=C.value)==null?void 0:he.updatePopper)==null||Ie.call(he)},Yn=()=>{var he,Ie;(Ie=(he=M.value)==null?void 0:he.updatePopper)==null||Ie.call(he)},vr=()=>{_.inputValue.length>0&&!ce.value&&(ce.value=!0),Ot(_.inputValue)},tr=he=>{if(_.inputValue=he.target.value,e.remote)zr();else return vr()},zr=Ra(()=>{vr()},wt.value),Cr=he=>{ms(e.modelValue,he)||t(Eo,he)},Io=he=>iz(he,Ie=>{const je=_.cachedOptions.get(Ie);return je&&!je.disabled&&!je.states.groupDisabled}),jn=he=>{if(e.multiple&&he.code!==En.delete&&he.target.value.length<=0){const Ie=Vs(e.modelValue).slice(),je=Io(Ie);if(je<0)return;const Je=Ie[je];Ie.splice(je,1),t(mr,Ie),Cr(Ie),t("remove-tag",Je)}},Gt=(he,Ie)=>{const je=_.selected.indexOf(Ie);if(je>-1&&!be.value){const Je=Vs(e.modelValue).slice();Je.splice(je,1),t(mr,Je),Cr(Je),t("remove-tag",Ie.value)}he.stopPropagation(),Go()},ct=he=>{he.stopPropagation();const Ie=e.multiple?[]:We.value;if(e.multiple)for(const je of _.selected)je.isDisabled&&Ie.push(je.value);t(mr,Ie),Cr(Ie),_.hoveringIndex=-1,ce.value=!1,t("clear"),Go()},Ut=he=>{var Ie;if(e.multiple){const je=Vs((Ie=e.modelValue)!=null?Ie:[]).slice(),Je=tt(je,he);Je>-1?je.splice(Je,1):(e.multipleLimit<=0||je.length<e.multipleLimit)&&je.push(he.value),t(mr,je),Cr(je),he.created&&Ot(""),e.filterable&&!e.reserveKeyword&&(_.inputValue="")}else t(mr,he.value),Cr(he.value),ce.value=!1;Go(),!ce.value&&Vn(()=>{yn(he)})},tt=(he=[],Ie)=>oo(Ie)?-1:yr(Ie.value)?he.findIndex(je=>ms(Ii(je,e.valueKey),ga(Ie))):he.indexOf(Ie.value),yn=he=>{var Ie,je,Je,lt,St;const ht=ln(he)?he[0]:he;let Dt=null;if(ht!=null&&ht.value){const Pt=Bt.value.filter(Ke=>Ke.value===ht.value);Pt.length>0&&(Dt=Pt[0].$el)}if(C.value&&Dt){const Pt=(lt=(Je=(je=(Ie=C.value)==null?void 0:Ie.popperRef)==null?void 0:je.contentRef)==null?void 0:Je.querySelector)==null?void 0:lt.call(Je,`.${d.be("dropdown","wrap")}`);Pt&&XC(Pt,Dt)}(St=U.value)==null||St.handleScroll()},wn=he=>{_.options.set(he.value,he),_.cachedOptions.set(he.value,he)},sr=(he,Ie)=>{_.options.get(he)===Ie&&_.options.delete(he)},vo=ee(()=>{var he,Ie;return(Ie=(he=C.value)==null?void 0:he.popperRef)==null?void 0:Ie.contentRef}),jo=()=>{_.isBeforeHide=!1,Vn(()=>{var he;(he=U.value)==null||he.update(),yn(_.selected)})},Go=()=>{var he;(he=k.value)==null||he.focus()},bo=()=>{var he;if(ce.value){ce.value=!1,Vn(()=>{var Ie;return(Ie=k.value)==null?void 0:Ie.blur()});return}(he=k.value)==null||he.blur()},oi=he=>{ct(he)},mo=he=>{if(ce.value=!1,se.value){const Ie=new FocusEvent("focus",he);Vn(()=>fe(Ie))}},Fi=()=>{_.inputValue.length>0?_.inputValue="":ce.value=!1},Gs=()=>{be.value||(JS&&(_.inputHovering=!0),_.menuVisibleOnFocus?_.menuVisibleOnFocus=!1:ce.value=!ce.value)},kl=()=>{if(!ce.value)Gs();else{const he=Bt.value[_.hoveringIndex];he&&!he.isDisabled&&Ut(he)}},ga=he=>yr(he.value)?Ii(he.value,e.valueKey):he.value,Jo=ee(()=>Bt.value.filter(he=>he.visible).every(he=>he.isDisabled)),va=ee(()=>e.multiple?e.collapseTags?_.selected.slice(0,e.maxCollapseTags):_.selected:[]),vc=ee(()=>e.multiple?e.collapseTags?_.selected.slice(e.maxCollapseTags):[]:[]),Qa=he=>{if(!ce.value){ce.value=!0;return}if(!(_.options.size===0||vt.value===0||te.value)&&!Jo.value){he==="next"?(_.hoveringIndex++,_.hoveringIndex===_.options.size&&(_.hoveringIndex=0)):he==="prev"&&(_.hoveringIndex--,_.hoveringIndex<0&&(_.hoveringIndex=_.options.size-1));const Ie=Bt.value[_.hoveringIndex];(Ie.isDisabled||!Ie.visible)&&Qa(he),Vn(()=>yn(le.value))}},Ci=()=>{if(!S.value)return 0;const he=window.getComputedStyle(S.value);return Number.parseFloat(he.gap||"6px")},Ps=ee(()=>{const he=Ci();return{maxWidth:`${j.value&&e.maxCollapseTags===1?_.selectionWidth-_.collapseItemWidth-he:_.selectionWidth}px`}}),zt=ee(()=>({maxWidth:`${_.selectionWidth}px`})),ye=he=>{t("popup-scroll",he)};return ti(S,bn),ti(B,Sn),ti(ne,Sn),ti(N,Yn),ti(j,It),gr(()=>{sn()}),{inputId:ke,contentId:a,nsSelect:d,nsInput:p,states:_,isFocused:se,expanded:ce,optionsArray:Bt,hoverOption:le,selectSize:Re,filteredOptionsCount:vt,updateTooltip:Sn,updateTagTooltip:Yn,debouncedOnInputChange:zr,onInput:tr,deletePrevTag:jn,deleteTag:Gt,deleteSelected:ct,handleOptionSelect:Ut,scrollToOption:yn,hasModelValue:Me,shouldShowPlaceholder:Yt,currentPlaceholder:Xt,mouseEnterEventName:$t,needStatusIcon:Ae,showClose:me,iconComponent:Be,iconReverse:Ve,validateState:bt,validateIcon:Pe,showNewOption:Fe,updateOptions:cn,collapseTagSize:nt,setSelected:sn,selectDisabled:be,emptyText:Nt,handleCompositionStart:Y,handleCompositionUpdate:q,handleCompositionEnd:J,onOptionCreate:wn,onOptionDestroy:sr,handleMenuEnter:jo,focus:Go,blur:bo,handleClearClick:oi,handleClickOutside:mo,handleEsc:Fi,toggleMenu:Gs,selectOption:kl,getValueKey:ga,navigateOptions:Qa,dropdownMenuVisible:Qe,showTagList:va,collapseTagList:vc,popupScroll:ye,tagStyle:Ps,collapseTagStyle:zt,popperRef:vo,inputRef:k,tooltipRef:C,tagTooltipRef:M,prefixRef:z,suffixRef:F,selectRef:r,wrapperRef:ne,selectionRef:S,scrollbarRef:U,menuRef:B,tagMenuRef:N,collapseItemRef:j}};var ise=qe({name:"ElOptions",setup(e,{slots:t}){const i=An(rg);let a=[];return()=>{var d,p;const _=(d=t.default)==null?void 0:d.call(t),r=[];function S(C){ln(C)&&C.forEach(M=>{var k,z,F,B;const N=(k=(M==null?void 0:M.type)||{})==null?void 0:k.name;N==="ElOptionGroup"?S(!Dn(M.children)&&!ln(M.children)&&Nn((z=M.children)==null?void 0:z.default)?(F=M.children)==null?void 0:F.default():M.children):N==="ElOption"?r.push((B=M.props)==null?void 0:B.value):ln(M.children)&&S(M.children)})}return _.length&&S((p=_[0])==null?void 0:p.children),ms(r,a)||(a=r,i&&(i.states.optionValues=r)),_}}});const sse=un({name:String,id:String,modelValue:{type:[Array,String,Number,Boolean,Object],default:void 0},autocomplete:{type:String,default:"off"},automaticDropdown:Boolean,size:zi,effect:{type:dt(String),default:"light"},disabled:Boolean,clearable:Boolean,filterable:Boolean,allowCreate:Boolean,loading:Boolean,popperClass:{type:String,default:""},popperOptions:{type:dt(Object),default:()=>({})},remote:Boolean,loadingText:String,noMatchText:String,noDataText:String,remoteMethod:Function,filterMethod:Function,multiple:Boolean,multipleLimit:{type:Number,default:0},placeholder:{type:String},defaultFirstOption:Boolean,reserveKeyword:{type:Boolean,default:!0},valueKey:{type:String,default:"value"},collapseTags:Boolean,collapseTagsTooltip:Boolean,maxCollapseTags:{type:Number,default:1},teleported:rs.teleported,persistent:{type:Boolean,default:!0},clearIcon:{type:Mo,default:Wu},fitInputWidth:Boolean,suffixIcon:{type:Mo,default:Gu},tagType:{...Nu.type,default:"info"},tagEffect:{...Nu.effect,default:"light"},validateEvent:{type:Boolean,default:!0},remoteShowSuffix:Boolean,showArrow:{type:Boolean,default:!0},offset:{type:Number,default:12},placement:{type:dt(String),values:qu,default:"bottom-start"},fallbackPlacements:{type:dt(Array),default:["bottom-start","top-start","right","left"]},tabindex:{type:[String,Number],default:0},appendTo:String,...Qm,..._s(["ariaLabel"])}),LR="ElSelect",ase=qe({name:LR,componentName:LR,components:{ElSelectMenu:rse,ElOption:BE,ElOptions:ise,ElTag:Dm,ElScrollbar:Yc,ElTooltip:Is,ElIcon:On},directives:{ClickOutside:Bu},props:sse,emits:[mr,Eo,"remove-tag","clear","visible-change","focus","blur","popup-scroll"],setup(e,{emit:t}){const i=ee(()=>{const{modelValue:S,multiple:C}=e,M=C?[]:void 0;return ln(S)?C?S:M:C?M:S}),a=lo({...Zi(e),modelValue:i}),d=ose(a,t),{calculatorRef:p,inputStyle:_}=FE();Dr(rg,lo({props:a,states:d.states,optionsArray:d.optionsArray,handleOptionSelect:d.handleOptionSelect,onOptionCreate:d.onOptionCreate,onOptionDestroy:d.onOptionDestroy,selectRef:d.selectRef,setSelected:d.setSelected}));const r=ee(()=>e.multiple?d.states.selected.map(S=>S.currentLabel):d.states.selectedLabel);return{...d,modelValue:i,selectedLabel:r,calculatorRef:p,inputStyle:_}}});function lse(e,t,i,a,d,p){const _=Er("el-tag"),r=Er("el-tooltip"),S=Er("el-icon"),C=Er("el-option"),M=Er("el-options"),k=Er("el-scrollbar"),z=Er("el-select-menu"),F=J1("click-outside");return hr((ae(),Oe("div",{ref:"selectRef",class:pe([e.nsSelect.b(),e.nsSelect.m(e.selectSize)]),[__(e.mouseEnterEventName)]:B=>e.states.inputHovering=!0,onMouseleave:B=>e.states.inputHovering=!1},[Ze(r,{ref:"tooltipRef",visible:e.dropdownMenuVisible,placement:e.placement,teleported:e.teleported,"popper-class":[e.nsSelect.e("popper"),e.popperClass],"popper-options":e.popperOptions,"fallback-placements":e.fallbackPlacements,effect:e.effect,pure:"",trigger:"click",transition:`${e.nsSelect.namespace.value}-zoom-in-top`,"stop-popper-mouse-event":!1,"gpu-acceleration":!1,persistent:e.persistent,"append-to":e.appendTo,"show-arrow":e.showArrow,offset:e.offset,onBeforeShow:e.handleMenuEnter,onHide:B=>e.states.isBeforeHide=!1},{default:st(()=>{var B;return[Ue("div",{ref:"wrapperRef",class:pe([e.nsSelect.e("wrapper"),e.nsSelect.is("focused",e.isFocused),e.nsSelect.is("hovering",e.states.inputHovering),e.nsSelect.is("filterable",e.filterable),e.nsSelect.is("disabled",e.selectDisabled)]),onClick:Qn(e.toggleMenu,["prevent"])},[e.$slots.prefix?(ae(),Oe("div",{key:0,ref:"prefixRef",class:pe(e.nsSelect.e("prefix"))},[pt(e.$slots,"prefix")],2)):yt("v-if",!0),Ue("div",{ref:"selectionRef",class:pe([e.nsSelect.e("selection"),e.nsSelect.is("near",e.multiple&&!e.$slots.prefix&&!!e.states.selected.length)])},[e.multiple?pt(e.$slots,"tag",{key:0},()=>[(ae(!0),Oe(Bn,null,Or(e.showTagList,N=>(ae(),Oe("div",{key:e.getValueKey(N),class:pe(e.nsSelect.e("selected-item"))},[Ze(_,{closable:!e.selectDisabled&&!N.isDisabled,size:e.collapseTagSize,type:e.tagType,effect:e.tagEffect,"disable-transitions":"",style:$n(e.tagStyle),onClose:j=>e.deleteTag(j,N)},{default:st(()=>[Ue("span",{class:pe(e.nsSelect.e("tags-text"))},[pt(e.$slots,"label",{label:N.currentLabel,value:N.value},()=>[Rr(pn(N.currentLabel),1)])],2)]),_:2},1032,["closable","size","type","effect","style","onClose"])],2))),128)),e.collapseTags&&e.states.selected.length>e.maxCollapseTags?(ae(),kt(r,{key:0,ref:"tagTooltipRef",disabled:e.dropdownMenuVisible||!e.collapseTagsTooltip,"fallback-placements":["bottom","top","right","left"],effect:e.effect,placement:"bottom",teleported:e.teleported},{default:st(()=>[Ue("div",{ref:"collapseItemRef",class:pe(e.nsSelect.e("selected-item"))},[Ze(_,{closable:!1,size:e.collapseTagSize,type:e.tagType,effect:e.tagEffect,"disable-transitions":"",style:$n(e.collapseTagStyle)},{default:st(()=>[Ue("span",{class:pe(e.nsSelect.e("tags-text"))}," + "+pn(e.states.selected.length-e.maxCollapseTags),3)]),_:1},8,["size","type","effect","style"])],2)]),content:st(()=>[Ue("div",{ref:"tagMenuRef",class:pe(e.nsSelect.e("selection"))},[(ae(!0),Oe(Bn,null,Or(e.collapseTagList,N=>(ae(),Oe("div",{key:e.getValueKey(N),class:pe(e.nsSelect.e("selected-item"))},[Ze(_,{class:"in-tooltip",closable:!e.selectDisabled&&!N.isDisabled,size:e.collapseTagSize,type:e.tagType,effect:e.tagEffect,"disable-transitions":"",onClose:j=>e.deleteTag(j,N)},{default:st(()=>[Ue("span",{class:pe(e.nsSelect.e("tags-text"))},[pt(e.$slots,"label",{label:N.currentLabel,value:N.value},()=>[Rr(pn(N.currentLabel),1)])],2)]),_:2},1032,["closable","size","type","effect","onClose"])],2))),128))],2)]),_:3},8,["disabled","effect","teleported"])):yt("v-if",!0)]):yt("v-if",!0),Ue("div",{class:pe([e.nsSelect.e("selected-item"),e.nsSelect.e("input-wrapper"),e.nsSelect.is("hidden",!e.filterable)])},[hr(Ue("input",{id:e.inputId,ref:"inputRef","onUpdate:modelValue":N=>e.states.inputValue=N,type:"text",name:e.name,class:pe([e.nsSelect.e("input"),e.nsSelect.is(e.selectSize)]),disabled:e.selectDisabled,autocomplete:e.autocomplete,style:$n(e.inputStyle),tabindex:e.tabindex,role:"combobox",readonly:!e.filterable,spellcheck:"false","aria-activedescendant":((B=e.hoverOption)==null?void 0:B.id)||"","aria-controls":e.contentId,"aria-expanded":e.dropdownMenuVisible,"aria-label":e.ariaLabel,"aria-autocomplete":"none","aria-haspopup":"listbox",onKeydown:[Po(Qn(N=>e.navigateOptions("next"),["stop","prevent"]),["down"]),Po(Qn(N=>e.navigateOptions("prev"),["stop","prevent"]),["up"]),Po(Qn(e.handleEsc,["stop","prevent"]),["esc"]),Po(Qn(e.selectOption,["stop","prevent"]),["enter"]),Po(Qn(e.deletePrevTag,["stop"]),["delete"])],onCompositionstart:e.handleCompositionStart,onCompositionupdate:e.handleCompositionUpdate,onCompositionend:e.handleCompositionEnd,onInput:e.onInput,onClick:Qn(e.toggleMenu,["stop"])},null,46,["id","onUpdate:modelValue","name","disabled","autocomplete","tabindex","readonly","aria-activedescendant","aria-controls","aria-expanded","aria-label","onKeydown","onCompositionstart","onCompositionupdate","onCompositionend","onInput","onClick"]),[[tx,e.states.inputValue]]),e.filterable?(ae(),Oe("span",{key:0,ref:"calculatorRef","aria-hidden":"true",class:pe(e.nsSelect.e("input-calculator")),textContent:pn(e.states.inputValue)},null,10,["textContent"])):yt("v-if",!0)],2),e.shouldShowPlaceholder?(ae(),Oe("div",{key:1,class:pe([e.nsSelect.e("selected-item"),e.nsSelect.e("placeholder"),e.nsSelect.is("transparent",!e.hasModelValue||e.expanded&&!e.states.inputValue)])},[e.hasModelValue?pt(e.$slots,"label",{key:0,label:e.currentPlaceholder,value:e.modelValue},()=>[Ue("span",null,pn(e.currentPlaceholder),1)]):(ae(),Oe("span",{key:1},pn(e.currentPlaceholder),1))],2)):yt("v-if",!0)],2),Ue("div",{ref:"suffixRef",class:pe(e.nsSelect.e("suffix"))},[e.iconComponent&&!e.showClose?(ae(),kt(S,{key:0,class:pe([e.nsSelect.e("caret"),e.nsSelect.e("icon"),e.iconReverse])},{default:st(()=>[(ae(),kt(Tr(e.iconComponent)))]),_:1},8,["class"])):yt("v-if",!0),e.showClose&&e.clearIcon?(ae(),kt(S,{key:1,class:pe([e.nsSelect.e("caret"),e.nsSelect.e("icon"),e.nsSelect.e("clear")]),onClick:e.handleClearClick},{default:st(()=>[(ae(),kt(Tr(e.clearIcon)))]),_:1},8,["class","onClick"])):yt("v-if",!0),e.validateState&&e.validateIcon&&e.needStatusIcon?(ae(),kt(S,{key:2,class:pe([e.nsInput.e("icon"),e.nsInput.e("validateIcon"),e.nsInput.is("loading",e.validateState==="validating")])},{default:st(()=>[(ae(),kt(Tr(e.validateIcon)))]),_:1},8,["class"])):yt("v-if",!0)],2)],10,["onClick"])]}),content:st(()=>[Ze(z,{ref:"menuRef"},{default:st(()=>[e.$slots.header?(ae(),Oe("div",{key:0,class:pe(e.nsSelect.be("dropdown","header")),onClick:Qn(()=>{},["stop"])},[pt(e.$slots,"header")],10,["onClick"])):yt("v-if",!0),hr(Ze(k,{id:e.contentId,ref:"scrollbarRef",tag:"ul","wrap-class":e.nsSelect.be("dropdown","wrap"),"view-class":e.nsSelect.be("dropdown","list"),class:pe([e.nsSelect.is("empty",e.filteredOptionsCount===0)]),role:"listbox","aria-label":e.ariaLabel,"aria-orientation":"vertical",onScroll:e.popupScroll},{default:st(()=>[e.showNewOption?(ae(),kt(C,{key:0,value:e.states.inputValue,created:!0},null,8,["value"])):yt("v-if",!0),Ze(M,null,{default:st(()=>[pt(e.$slots,"default")]),_:3})]),_:3},8,["id","wrap-class","view-class","class","aria-label","onScroll"]),[[no,e.states.options.size>0&&!e.loading]]),e.$slots.loading&&e.loading?(ae(),Oe("div",{key:1,class:pe(e.nsSelect.be("dropdown","loading"))},[pt(e.$slots,"loading")],2)):e.loading||e.filteredOptionsCount===0?(ae(),Oe("div",{key:2,class:pe(e.nsSelect.be("dropdown","empty"))},[pt(e.$slots,"empty",{},()=>[Ue("span",null,pn(e.emptyText),1)])],2)):yt("v-if",!0),e.$slots.footer?(ae(),Oe("div",{key:3,class:pe(e.nsSelect.be("dropdown","footer")),onClick:Qn(()=>{},["stop"])},[pt(e.$slots,"footer")],10,["onClick"])):yt("v-if",!0)]),_:3},512)]),_:3},8,["visible","placement","teleported","popper-class","popper-options","fallback-placements","effect","transition","persistent","append-to","show-arrow","offset","onBeforeShow","onHide"])],16,["onMouseleave"])),[[F,e.handleClickOutside,e.popperRef]])}var cse=fn(ase,[["render",lse],["__file","select.vue"]]);const use=qe({name:"ElOptionGroup",componentName:"ElOptionGroup",props:{label:String,disabled:Boolean},setup(e){const t=en("select"),i=Se(null),a=wr(),d=Se([]);Dr(O4,lo({...Zi(e)}));const p=ee(()=>d.value.some(C=>C.visible===!0)),_=C=>{var M,k;return((M=C.type)==null?void 0:M.name)==="ElOption"&&!!((k=C.component)!=null&&k.proxy)},r=C=>{const M=Vs(C),k=[];return M.forEach(z=>{var F,B;_(z)?k.push(z.component.proxy):(F=z.children)!=null&&F.length?k.push(...r(z.children)):(B=z.component)!=null&&B.subTree&&k.push(...r(z.component.subTree))}),k},S=()=>{d.value=r(a.subTree)};return gr(()=>{S()}),hz(i,S,{attributes:!0,subtree:!0,childList:!0}),{groupRef:i,visible:p,ns:t}}});function dse(e,t,i,a,d,p){return hr((ae(),Oe("ul",{ref:"groupRef",class:pe(e.ns.be("group","wrap"))},[Ue("li",{class:pe(e.ns.be("group","title"))},pn(e.label),3),Ue("li",null,[Ue("ul",{class:pe(e.ns.b("group"))},[pt(e.$slots,"default")],2)])],2)),[[no,e.visible]])}var L4=fn(use,[["render",dse],["__file","option-group.vue"]]);const Df=ur(cse,{Option:BE,OptionGroup:L4}),M1=ri(BE),hse=ri(L4),VE=()=>An(R4,{}),fse=un({pageSize:{type:Number,required:!0},pageSizes:{type:dt(Array),default:()=>ni([10,20,30,40,50,100])},popperClass:{type:String},disabled:Boolean,teleported:Boolean,size:{type:String,values:Zc},appendSizeTo:String}),pse=qe({name:"ElPaginationSizes"}),mse=qe({...pse,props:fse,emits:["page-size-change"],setup(e,{emit:t}){const i=e,{t:a}=Gr(),d=en("pagination"),p=VE(),_=Se(i.pageSize);qt(()=>i.pageSizes,(C,M)=>{if(!ms(C,M)&&ln(C)){const k=C.includes(i.pageSize)?i.pageSize:i.pageSizes[0];t("page-size-change",k)}}),qt(()=>i.pageSize,C=>{_.value=C});const r=ee(()=>i.pageSizes);function S(C){var M;C!==_.value&&(_.value=C,(M=p.handleSizeChange)==null||M.call(p,Number(C)))}return(C,M)=>(ae(),Oe("span",{class:pe(b(d).e("sizes"))},[Ze(b(Df),{"model-value":_.value,disabled:C.disabled,"popper-class":C.popperClass,size:C.size,teleported:C.teleported,"validate-event":!1,"append-to":C.appendSizeTo,onChange:S},{default:st(()=>[(ae(!0),Oe(Bn,null,Or(b(r),k=>(ae(),kt(b(M1),{key:k,value:k,label:k+b(a)("el.pagination.pagesize")},null,8,["value","label"]))),128))]),_:1},8,["model-value","disabled","popper-class","size","teleported","append-to"])],2))}});var gse=fn(mse,[["__file","sizes.vue"]]);const vse=un({size:{type:String,values:Zc}}),_se=qe({name:"ElPaginationJumper"}),yse=qe({..._se,props:vse,setup(e){const{t}=Gr(),i=en("pagination"),{pageCount:a,disabled:d,currentPage:p,changeEvent:_}=VE(),r=Se(),S=ee(()=>{var k;return(k=r.value)!=null?k:p==null?void 0:p.value});function C(k){r.value=k?+k:""}function M(k){k=Math.trunc(+k),_==null||_(k),r.value=void 0}return(k,z)=>(ae(),Oe("span",{class:pe(b(i).e("jump")),disabled:b(d)},[Ue("span",{class:pe([b(i).e("goto")])},pn(b(t)("el.pagination.goto")),3),Ze(b(Us),{size:k.size,class:pe([b(i).e("editor"),b(i).is("in-pagination")]),min:1,max:b(a),disabled:b(d),"model-value":b(S),"validate-event":!1,"aria-label":b(t)("el.pagination.page"),type:"number","onUpdate:modelValue":C,onChange:M},null,8,["size","class","max","disabled","model-value","aria-label"]),Ue("span",{class:pe([b(i).e("classifier")])},pn(b(t)("el.pagination.pageClassifier")),3)],10,["disabled"]))}});var bse=fn(yse,[["__file","jumper.vue"]]);const xse=un({total:{type:Number,default:1e3}}),wse=qe({name:"ElPaginationTotal"}),Sse=qe({...wse,props:xse,setup(e){const{t}=Gr(),i=en("pagination"),{disabled:a}=VE();return(d,p)=>(ae(),Oe("span",{class:pe(b(i).e("total")),disabled:b(a)},pn(b(t)("el.pagination.total",{total:d.total})),11,["disabled"]))}});var Tse=fn(Sse,[["__file","total.vue"]]);const Cse=un({currentPage:{type:Number,default:1},pageCount:{type:Number,required:!0},pagerCount:{type:Number,default:7},disabled:Boolean}),Ese=qe({name:"ElPaginationPager"}),Mse=qe({...Ese,props:Cse,emits:["change"],setup(e,{emit:t}){const i=e,a=en("pager"),d=en("icon"),{t:p}=Gr(),_=Se(!1),r=Se(!1),S=Se(!1),C=Se(!1),M=Se(!1),k=Se(!1),z=ee(()=>{const q=i.pagerCount,J=(q-1)/2,ne=Number(i.currentPage),se=Number(i.pageCount);let fe=!1,ce=!1;se>q&&(ne>q-J&&(fe=!0),ne<se-J&&(ce=!0));const le=[];if(fe&&!ce){const ge=se-(q-2);for(let de=ge;de<se;de++)le.push(de)}else if(!fe&&ce)for(let ge=2;ge<q;ge++)le.push(ge);else if(fe&&ce){const ge=Math.floor(q/2)-1;for(let de=ne-ge;de<=ne+ge;de++)le.push(de)}else for(let ge=2;ge<se;ge++)le.push(ge);return le}),F=ee(()=>["more","btn-quickprev",d.b(),a.is("disabled",i.disabled)]),B=ee(()=>["more","btn-quicknext",d.b(),a.is("disabled",i.disabled)]),N=ee(()=>i.disabled?-1:0);Cs(()=>{const q=(i.pagerCount-1)/2;_.value=!1,r.value=!1,i.pageCount>i.pagerCount&&(i.currentPage>i.pagerCount-q&&(_.value=!0),i.currentPage<i.pageCount-q&&(r.value=!0))});function j(q=!1){i.disabled||(q?S.value=!0:C.value=!0)}function U(q=!1){q?M.value=!0:k.value=!0}function te(q){const J=q.target;if(J.tagName.toLowerCase()==="li"&&Array.from(J.classList).includes("number")){const ne=Number(J.textContent);ne!==i.currentPage&&t("change",ne)}else J.tagName.toLowerCase()==="li"&&Array.from(J.classList).includes("more")&&Y(q)}function Y(q){const J=q.target;if(J.tagName.toLowerCase()==="ul"||i.disabled)return;let ne=Number(J.textContent);const se=i.pageCount,fe=i.currentPage,ce=i.pagerCount-2;J.className.includes("more")&&(J.className.includes("quickprev")?ne=fe-ce:J.className.includes("quicknext")&&(ne=fe+ce)),Number.isNaN(+ne)||(ne<1&&(ne=1),ne>se&&(ne=se)),ne!==fe&&t("change",ne)}return(q,J)=>(ae(),Oe("ul",{class:pe(b(a).b()),onClick:Y,onKeyup:Po(te,["enter"])},[q.pageCount>0?(ae(),Oe("li",{key:0,class:pe([[b(a).is("active",q.currentPage===1),b(a).is("disabled",q.disabled)],"number"]),"aria-current":q.currentPage===1,"aria-label":b(p)("el.pagination.currentPage",{pager:1}),tabindex:b(N)}," 1 ",10,["aria-current","aria-label","tabindex"])):yt("v-if",!0),_.value?(ae(),Oe("li",{key:1,class:pe(b(F)),tabindex:b(N),"aria-label":b(p)("el.pagination.prevPages",{pager:q.pagerCount-2}),onMouseenter:ne=>j(!0),onMouseleave:ne=>S.value=!1,onFocus:ne=>U(!0),onBlur:ne=>M.value=!1},[(S.value||M.value)&&!q.disabled?(ae(),kt(b(Zd),{key:0})):(ae(),kt(b(O3),{key:1}))],42,["tabindex","aria-label","onMouseenter","onMouseleave","onFocus","onBlur"])):yt("v-if",!0),(ae(!0),Oe(Bn,null,Or(b(z),ne=>(ae(),Oe("li",{key:ne,class:pe([[b(a).is("active",q.currentPage===ne),b(a).is("disabled",q.disabled)],"number"]),"aria-current":q.currentPage===ne,"aria-label":b(p)("el.pagination.currentPage",{pager:ne}),tabindex:b(N)},pn(ne),11,["aria-current","aria-label","tabindex"]))),128)),r.value?(ae(),Oe("li",{key:2,class:pe(b(B)),tabindex:b(N),"aria-label":b(p)("el.pagination.nextPages",{pager:q.pagerCount-2}),onMouseenter:ne=>j(),onMouseleave:ne=>C.value=!1,onFocus:ne=>U(),onBlur:ne=>k.value=!1},[(C.value||k.value)&&!q.disabled?(ae(),kt(b(Yd),{key:0})):(ae(),kt(b(O3),{key:1}))],42,["tabindex","aria-label","onMouseenter","onMouseleave","onFocus","onBlur"])):yt("v-if",!0),q.pageCount>1?(ae(),Oe("li",{key:3,class:pe([[b(a).is("active",q.currentPage===q.pageCount),b(a).is("disabled",q.disabled)],"number"]),"aria-current":q.currentPage===q.pageCount,"aria-label":b(p)("el.pagination.currentPage",{pager:q.pageCount}),tabindex:b(N)},pn(q.pageCount),11,["aria-current","aria-label","tabindex"])):yt("v-if",!0)],42,["onKeyup"]))}});var Ise=fn(Mse,[["__file","pager.vue"]]);const ea=e=>typeof e!="number",Ase=un({pageSize:Number,defaultPageSize:Number,total:Number,pageCount:Number,pagerCount:{type:Number,validator:e=>Gn(e)&&Math.trunc(e)===e&&e>4&&e<22&&e%2===1,default:7},currentPage:Number,defaultCurrentPage:Number,layout:{type:String,default:["prev","pager","next","jumper","->","total"].join(", ")},pageSizes:{type:dt(Array),default:()=>ni([10,20,30,40,50,100])},popperClass:{type:String,default:""},prevText:{type:String,default:""},prevIcon:{type:Mo,default:()=>Kd},nextText:{type:String,default:""},nextIcon:{type:Mo,default:()=>ca},teleported:{type:Boolean,default:!0},small:Boolean,size:zi,background:Boolean,disabled:Boolean,hideOnSinglePage:Boolean,appendSizeTo:String}),kse={"update:current-page":e=>Gn(e),"update:page-size":e=>Gn(e),"size-change":e=>Gn(e),change:(e,t)=>Gn(e)&&Gn(t),"current-change":e=>Gn(e),"prev-click":e=>Gn(e),"next-click":e=>Gn(e)},DR="ElPagination";var Pse=qe({name:DR,props:Ase,emits:kse,setup(e,{emit:t,slots:i}){const{t:a}=Gr(),d=en("pagination"),p=wr().vnode.props||{},_=yz(),r=ee(()=>{var J;return e.small?"small":(J=e.size)!=null?J:_.value});Ud({from:"small",replacement:"size",version:"3.0.0",scope:"el-pagination",ref:"https://element-plus.org/zh-CN/component/pagination.html"},ee(()=>!!e.small));const S="onUpdate:currentPage"in p||"onUpdate:current-page"in p||"onCurrentChange"in p,C="onUpdate:pageSize"in p||"onUpdate:page-size"in p||"onSizeChange"in p,M=ee(()=>{if(ea(e.total)&&ea(e.pageCount)||!ea(e.currentPage)&&!S)return!1;if(e.layout.includes("sizes")){if(ea(e.pageCount)){if(!ea(e.total)&&!ea(e.pageSize)&&!C)return!1}else if(!C)return!1}return!0}),k=Se(ea(e.defaultPageSize)?10:e.defaultPageSize),z=Se(ea(e.defaultCurrentPage)?1:e.defaultCurrentPage),F=ee({get(){return ea(e.pageSize)?k.value:e.pageSize},set(J){ea(e.pageSize)&&(k.value=J),C&&(t("update:page-size",J),t("size-change",J))}}),B=ee(()=>{let J=0;return ea(e.pageCount)?ea(e.total)||(J=Math.max(1,Math.ceil(e.total/F.value))):J=e.pageCount,J}),N=ee({get(){return ea(e.currentPage)?z.value:e.currentPage},set(J){let ne=J;J<1?ne=1:J>B.value&&(ne=B.value),ea(e.currentPage)&&(z.value=ne),S&&(t("update:current-page",ne),t("current-change",ne))}});qt(B,J=>{N.value>J&&(N.value=J)}),qt([N,F],J=>{t("change",...J)},{flush:"post"});function j(J){N.value=J}function U(J){F.value=J;const ne=B.value;N.value>ne&&(N.value=ne)}function te(){e.disabled||(N.value-=1,t("prev-click",N.value))}function Y(){e.disabled||(N.value+=1,t("next-click",N.value))}function q(J,ne){J&&(J.props||(J.props={}),J.props.class=[J.props.class,ne].join(" "))}return Dr(R4,{pageCount:B,disabled:ee(()=>e.disabled),currentPage:N,changeEvent:j,handleSizeChange:U}),()=>{var J,ne;if(!M.value)return a("el.pagination.deprecationWarning"),null;if(!e.layout||e.hideOnSinglePage&&B.value<=1)return null;const se=[],fe=[],ce=Kn("div",{class:d.e("rightwrapper")},fe),le={prev:Kn(qie,{disabled:e.disabled,currentPage:N.value,prevText:e.prevText,prevIcon:e.prevIcon,onClick:te}),jumper:Kn(bse,{size:r.value}),pager:Kn(Ise,{currentPage:N.value,pageCount:B.value,pagerCount:e.pagerCount,onChange:j,disabled:e.disabled}),next:Kn(Xie,{disabled:e.disabled,currentPage:N.value,pageCount:B.value,nextText:e.nextText,nextIcon:e.nextIcon,onClick:Y}),sizes:Kn(gse,{pageSize:F.value,pageSizes:e.pageSizes,popperClass:e.popperClass,disabled:e.disabled,teleported:e.teleported,size:r.value,appendSizeTo:e.appendSizeTo}),slot:(ne=(J=i==null?void 0:i.default)==null?void 0:J.call(i))!=null?ne:null,total:Kn(Tse,{total:ea(e.total)?0:e.total})},ge=e.layout.split(",").map(ke=>ke.trim());let de=!1;return ge.forEach(ke=>{if(ke==="->"){de=!0;return}de?fe.push(le[ke]):se.push(le[ke])}),q(se[0],d.is("first")),q(se[se.length-1],d.is("last")),de&&fe.length>0&&(q(fe[0],d.is("first")),q(fe[fe.length-1],d.is("last")),se.push(ce)),Kn("div",{class:[d.b(),d.is("background",e.background),d.m(r.value)]},se)}}});const Rse=ur(Pse),Ose=un({title:String,confirmButtonText:String,cancelButtonText:String,confirmButtonType:{type:String,values:eT,default:"primary"},cancelButtonType:{type:String,values:eT,default:"text"},icon:{type:Mo,default:()=>I7},iconColor:{type:String,default:"#f90"},hideIcon:{type:Boolean,default:!1},hideAfter:{type:Number,default:200},teleported:rs.teleported,persistent:rs.persistent,width:{type:[String,Number],default:150}}),Lse={confirm:e=>e instanceof MouseEvent,cancel:e=>e instanceof MouseEvent},Dse=qe({name:"ElPopconfirm"}),zse=qe({...Dse,props:Ose,emits:Lse,setup(e,{emit:t}){const i=e,{t:a}=Gr(),d=en("popconfirm"),p=Se(),_=()=>{var z,F;(F=(z=p.value)==null?void 0:z.onClose)==null||F.call(z)},r=ee(()=>({width:ui(i.width)})),S=z=>{t("confirm",z),_()},C=z=>{t("cancel",z),_()},M=ee(()=>i.confirmButtonText||a("el.popconfirm.confirmButtonText")),k=ee(()=>i.cancelButtonText||a("el.popconfirm.cancelButtonText"));return(z,F)=>(ae(),kt(b(Is),Mr({ref_key:"tooltipRef",ref:p,trigger:"click",effect:"light"},z.$attrs,{"popper-class":`${b(d).namespace.value}-popover`,"popper-style":b(r),teleported:z.teleported,"fallback-placements":["bottom","top","right","left"],"hide-after":z.hideAfter,persistent:z.persistent}),{content:st(()=>[Ue("div",{class:pe(b(d).b())},[Ue("div",{class:pe(b(d).e("main"))},[!z.hideIcon&&z.icon?(ae(),kt(b(On),{key:0,class:pe(b(d).e("icon")),style:$n({color:z.iconColor})},{default:st(()=>[(ae(),kt(Tr(z.icon)))]),_:1},8,["class","style"])):yt("v-if",!0),Rr(" "+pn(z.title),1)],2),Ue("div",{class:pe(b(d).e("action"))},[pt(z.$slots,"actions",{confirm:S,cancel:C},()=>[Ze(b(ss),{size:"small",type:z.cancelButtonType==="text"?"":z.cancelButtonType,text:z.cancelButtonType==="text",onClick:C},{default:st(()=>[Rr(pn(b(k)),1)]),_:1},8,["type","text"]),Ze(b(ss),{size:"small",type:z.confirmButtonType==="text"?"":z.confirmButtonType,text:z.confirmButtonType==="text",onClick:S},{default:st(()=>[Rr(pn(b(M)),1)]),_:1},8,["type","text"])])],2)],2)]),default:st(()=>[z.$slots.reference?pt(z.$slots,"reference",{key:0}):yt("v-if",!0)]),_:3},16,["popper-class","popper-style","teleported","hide-after","persistent"]))}});var Fse=fn(zse,[["__file","popconfirm.vue"]]);const Nse=ur(Fse),Bse=un({trigger:Y_.trigger,placement:Zb.placement,disabled:Y_.disabled,visible:rs.visible,transition:rs.transition,popperOptions:Zb.popperOptions,tabindex:Zb.tabindex,content:rs.content,popperStyle:rs.popperStyle,popperClass:rs.popperClass,enterable:{...rs.enterable,default:!0},effect:{...rs.effect,default:"light"},teleported:rs.teleported,title:String,width:{type:[String,Number],default:150},offset:{type:Number,default:void 0},showAfter:{type:Number,default:0},hideAfter:{type:Number,default:200},autoClose:{type:Number,default:0},showArrow:{type:Boolean,default:!0},persistent:{type:Boolean,default:!0},"onUpdate:visible":{type:Function}}),Vse={"update:visible":e=>Ro(e),"before-enter":()=>!0,"before-leave":()=>!0,"after-enter":()=>!0,"after-leave":()=>!0},$se="onUpdate:visible",Use=qe({name:"ElPopover"}),jse=qe({...Use,props:Bse,emits:Vse,setup(e,{expose:t,emit:i}){const a=e,d=ee(()=>a[$se]),p=en("popover"),_=Se(),r=ee(()=>{var j;return(j=b(_))==null?void 0:j.popperRef}),S=ee(()=>[{width:ui(a.width)},a.popperStyle]),C=ee(()=>[p.b(),a.popperClass,{[p.m("plain")]:!!a.content}]),M=ee(()=>a.transition===`${p.namespace.value}-fade-in-linear`),k=()=>{var j;(j=_.value)==null||j.hide()},z=()=>{i("before-enter")},F=()=>{i("before-leave")},B=()=>{i("after-enter")},N=()=>{i("update:visible",!1),i("after-leave")};return t({popperRef:r,hide:k}),(j,U)=>(ae(),kt(b(Is),Mr({ref_key:"tooltipRef",ref:_},j.$attrs,{trigger:j.trigger,placement:j.placement,disabled:j.disabled,visible:j.visible,transition:j.transition,"popper-options":j.popperOptions,tabindex:j.tabindex,content:j.content,offset:j.offset,"show-after":j.showAfter,"hide-after":j.hideAfter,"auto-close":j.autoClose,"show-arrow":j.showArrow,"aria-label":j.title,effect:j.effect,enterable:j.enterable,"popper-class":b(C),"popper-style":b(S),teleported:j.teleported,persistent:j.persistent,"gpu-acceleration":b(M),"onUpdate:visible":b(d),onBeforeShow:z,onBeforeHide:F,onShow:B,onHide:N}),{content:st(()=>[j.title?(ae(),Oe("div",{key:0,class:pe(b(p).e("title")),role:"title"},pn(j.title),3)):yt("v-if",!0),pt(j.$slots,"default",{},()=>[Rr(pn(j.content),1)])]),default:st(()=>[j.$slots.reference?pt(j.$slots,"reference",{key:0}):yt("v-if",!0)]),_:3},16,["trigger","placement","disabled","visible","transition","popper-options","tabindex","content","offset","show-after","hide-after","auto-close","show-arrow","aria-label","effect","enterable","popper-class","popper-style","teleported","persistent","gpu-acceleration","onUpdate:visible"]))}});var Hse=fn(jse,[["__file","popover.vue"]]);const zR=(e,t)=>{const i=t.arg||t.value,a=i==null?void 0:i.popperRef;a&&(a.triggerRef=e)};var Gse={mounted(e,t){zR(e,t)},updated(e,t){zR(e,t)}};const Wse="popover",D4=z9(Gse,Wse),qse=ur(Hse,{directive:D4}),Kse=un({type:{type:String,default:"line",values:["line","circle","dashboard"]},percentage:{type:Number,default:0,validator:e=>e>=0&&e<=100},status:{type:String,default:"",values:["","success","exception","warning"]},indeterminate:Boolean,duration:{type:Number,default:3},strokeWidth:{type:Number,default:6},strokeLinecap:{type:dt(String),default:"round"},textInside:Boolean,width:{type:Number,default:126},showText:{type:Boolean,default:!0},color:{type:dt([String,Array,Function]),default:""},striped:Boolean,stripedFlow:Boolean,format:{type:dt(Function),default:e=>`${e}%`}}),Zse=qe({name:"ElProgress"}),Yse=qe({...Zse,props:Kse,setup(e){const t=e,i={success:"#13ce66",exception:"#ff4949",warning:"#e6a23c",default:"#20a0ff"},a=en("progress"),d=ee(()=>{const Y={width:`${t.percentage}%`,animationDuration:`${t.duration}s`},q=te(t.percentage);return q.includes("gradient")?Y.background=q:Y.backgroundColor=q,Y}),p=ee(()=>(t.strokeWidth/t.width*100).toFixed(1)),_=ee(()=>["circle","dashboard"].includes(t.type)?Number.parseInt(`${50-Number.parseFloat(p.value)/2}`,10):0),r=ee(()=>{const Y=_.value,q=t.type==="dashboard";return`
          M 50 50
          m 0 ${q?"":"-"}${Y}
          a ${Y} ${Y} 0 1 1 0 ${q?"-":""}${Y*2}
          a ${Y} ${Y} 0 1 1 0 ${q?"":"-"}${Y*2}
          `}),S=ee(()=>2*Math.PI*_.value),C=ee(()=>t.type==="dashboard"?.75:1),M=ee(()=>`${-1*S.value*(1-C.value)/2}px`),k=ee(()=>({strokeDasharray:`${S.value*C.value}px, ${S.value}px`,strokeDashoffset:M.value})),z=ee(()=>({strokeDasharray:`${S.value*C.value*(t.percentage/100)}px, ${S.value}px`,strokeDashoffset:M.value,transition:"stroke-dasharray 0.6s ease 0s, stroke 0.6s ease, opacity ease 0.6s"})),F=ee(()=>{let Y;return t.color?Y=te(t.percentage):Y=i[t.status]||i.default,Y}),B=ee(()=>t.status==="warning"?px:t.type==="line"?t.status==="success"?QC:Wu:t.status==="success"?xy:sc),N=ee(()=>t.type==="line"?12+t.strokeWidth*.4:t.width*.111111+2),j=ee(()=>t.format(t.percentage));function U(Y){const q=100/Y.length;return Y.map((ne,se)=>Dn(ne)?{color:ne,percentage:(se+1)*q}:ne).sort((ne,se)=>ne.percentage-se.percentage)}const te=Y=>{var q;const{color:J}=t;if(Nn(J))return J(Y);if(Dn(J))return J;{const ne=U(J);for(const se of ne)if(se.percentage>Y)return se.color;return(q=ne[ne.length-1])==null?void 0:q.color}};return(Y,q)=>(ae(),Oe("div",{class:pe([b(a).b(),b(a).m(Y.type),b(a).is(Y.status),{[b(a).m("without-text")]:!Y.showText,[b(a).m("text-inside")]:Y.textInside}]),role:"progressbar","aria-valuenow":Y.percentage,"aria-valuemin":"0","aria-valuemax":"100"},[Y.type==="line"?(ae(),Oe("div",{key:0,class:pe(b(a).b("bar"))},[Ue("div",{class:pe(b(a).be("bar","outer")),style:$n({height:`${Y.strokeWidth}px`})},[Ue("div",{class:pe([b(a).be("bar","inner"),{[b(a).bem("bar","inner","indeterminate")]:Y.indeterminate},{[b(a).bem("bar","inner","striped")]:Y.striped},{[b(a).bem("bar","inner","striped-flow")]:Y.stripedFlow}]),style:$n(b(d))},[(Y.showText||Y.$slots.default)&&Y.textInside?(ae(),Oe("div",{key:0,class:pe(b(a).be("bar","innerText"))},[pt(Y.$slots,"default",{percentage:Y.percentage},()=>[Ue("span",null,pn(b(j)),1)])],2)):yt("v-if",!0)],6)],6)],2)):(ae(),Oe("div",{key:1,class:pe(b(a).b("circle")),style:$n({height:`${Y.width}px`,width:`${Y.width}px`})},[(ae(),Oe("svg",{viewBox:"0 0 100 100"},[Ue("path",{class:pe(b(a).be("circle","track")),d:b(r),stroke:`var(${b(a).cssVarName("fill-color-light")}, #e5e9f2)`,"stroke-linecap":Y.strokeLinecap,"stroke-width":b(p),fill:"none",style:$n(b(k))},null,14,["d","stroke","stroke-linecap","stroke-width"]),Ue("path",{class:pe(b(a).be("circle","path")),d:b(r),stroke:b(F),fill:"none",opacity:Y.percentage?1:0,"stroke-linecap":Y.strokeLinecap,"stroke-width":b(p),style:$n(b(z))},null,14,["d","stroke","opacity","stroke-linecap","stroke-width"])]))],6)),(Y.showText||Y.$slots.default)&&!Y.textInside?(ae(),Oe("div",{key:2,class:pe(b(a).e("text")),style:$n({fontSize:`${b(N)}px`})},[pt(Y.$slots,"default",{percentage:Y.percentage},()=>[Y.status?(ae(),kt(b(On),{key:1},{default:st(()=>[(ae(),kt(Tr(b(B))))]),_:1})):(ae(),Oe("span",{key:0},pn(b(j)),1))])],6)):yt("v-if",!0)],10,["aria-valuenow"]))}});var Xse=fn(Yse,[["__file","progress.vue"]]);const z4=ur(Xse),Jse=un({modelValue:{type:Number,default:0},id:{type:String,default:void 0},lowThreshold:{type:Number,default:2},highThreshold:{type:Number,default:4},max:{type:Number,default:5},colors:{type:dt([Array,Object]),default:()=>ni(["","",""])},voidColor:{type:String,default:""},disabledVoidColor:{type:String,default:""},icons:{type:dt([Array,Object]),default:()=>[wb,wb,wb]},voidIcon:{type:Mo,default:()=>j7},disabledVoidIcon:{type:Mo,default:()=>wb},disabled:Boolean,allowHalf:Boolean,showText:Boolean,showScore:Boolean,textColor:{type:String,default:""},texts:{type:dt(Array),default:()=>ni(["Extremely bad","Disappointed","Fair","Satisfied","Surprise"])},scoreTemplate:{type:String,default:"{value}"},size:zi,clearable:Boolean,..._s(["ariaLabel"])}),Qse={[Eo]:e=>Gn(e),[mr]:e=>Gn(e)},eae=qe({name:"ElRate"}),tae=qe({...eae,props:Jse,emits:Qse,setup(e,{expose:t,emit:i}){const a=e;function d(be,Me){const Ae=Ve=>yr(Ve),me=Object.keys(Me).map(Ve=>+Ve).filter(Ve=>{const bt=Me[Ve];return(Ae(bt)?bt.excluded:!1)?be<Ve:be<=Ve}).sort((Ve,bt)=>Ve-bt),Be=Me[me[0]];return Ae(Be)&&Be.value||Be}const p=An(Uf,void 0),_=An(Gc,void 0),r=Li(),S=en("rate"),{inputId:C,isLabeledByFormItem:M}=Al(a,{formItemContext:_}),k=Se(a.modelValue),z=Se(-1),F=Se(!0),B=ee(()=>[S.b(),S.m(r.value)]),N=ee(()=>a.disabled||(p==null?void 0:p.disabled)),j=ee(()=>S.cssVarBlock({"void-color":a.voidColor,"disabled-void-color":a.disabledVoidColor,"fill-color":q.value})),U=ee(()=>{let be="";return a.showScore?be=a.scoreTemplate.replace(/\{\s*value\s*\}/,N.value?`${a.modelValue}`:`${k.value}`):a.showText&&(be=a.texts[Math.ceil(k.value)-1]),be}),te=ee(()=>a.modelValue*100-Math.floor(a.modelValue)*100),Y=ee(()=>ln(a.colors)?{[a.lowThreshold]:a.colors[0],[a.highThreshold]:{value:a.colors[1],excluded:!0},[a.max]:a.colors[2]}:a.colors),q=ee(()=>{const be=d(k.value,Y.value);return yr(be)?"":be}),J=ee(()=>{let be="";return N.value?be=`${te.value}%`:a.allowHalf&&(be="50%"),{color:q.value,width:be}}),ne=ee(()=>{let be=ln(a.icons)?[...a.icons]:{...a.icons};return be=tc(be),ln(be)?{[a.lowThreshold]:be[0],[a.highThreshold]:{value:be[1],excluded:!0},[a.max]:be[2]}:be}),se=ee(()=>d(a.modelValue,ne.value)),fe=ee(()=>N.value?Dn(a.disabledVoidIcon)?a.disabledVoidIcon:tc(a.disabledVoidIcon):Dn(a.voidIcon)?a.voidIcon:tc(a.voidIcon)),ce=ee(()=>d(k.value,ne.value));function le(be){const Me=N.value&&te.value>0&&be-1<a.modelValue&&be>a.modelValue,Ae=a.allowHalf&&F.value&&be-.5<=k.value&&be>k.value;return Me||Ae}function ge(be){a.clearable&&be===a.modelValue&&(be=0),i(mr,be),a.modelValue!==be&&i("change",be)}function de(be){N.value||(a.allowHalf&&F.value?ge(k.value):ge(be))}function ke(be){if(N.value)return;let Me=k.value;const Ae=be.code;return Ae===En.up||Ae===En.right?(a.allowHalf?Me+=.5:Me+=1,be.stopPropagation(),be.preventDefault()):(Ae===En.left||Ae===En.down)&&(a.allowHalf?Me-=.5:Me-=1,be.stopPropagation(),be.preventDefault()),Me=Me<0?0:Me,Me=Me>a.max?a.max:Me,i(mr,Me),i("change",Me),Me}function We(be,Me){if(!N.value){if(a.allowHalf&&Me){let Ae=Me.target;Aa(Ae,S.e("item"))&&(Ae=Ae.querySelector(`.${S.e("icon")}`)),(Ae.clientWidth===0||Aa(Ae,S.e("decimal")))&&(Ae=Ae.parentNode),F.value=Me.offsetX*2<=Ae.clientWidth,k.value=F.value?be-.5:be}else k.value=be;z.value=be}}function we(){N.value||(a.allowHalf&&(F.value=a.modelValue!==Math.floor(a.modelValue)),k.value=a.modelValue,z.value=-1)}return qt(()=>a.modelValue,be=>{k.value=be,F.value=a.modelValue!==Math.floor(a.modelValue)}),a.modelValue||i(mr,0),t({setCurrentValue:We,resetCurrentValue:we}),(be,Me)=>{var Ae;return ae(),Oe("div",{id:b(C),class:pe([b(B),b(S).is("disabled",b(N))]),role:"slider","aria-label":b(M)?void 0:be.ariaLabel||"rating","aria-labelledby":b(M)?(Ae=b(_))==null?void 0:Ae.labelId:void 0,"aria-valuenow":k.value,"aria-valuetext":b(U)||void 0,"aria-valuemin":"0","aria-valuemax":be.max,tabindex:"0",style:$n(b(j)),onKeydown:ke},[(ae(!0),Oe(Bn,null,Or(be.max,(me,Be)=>(ae(),Oe("span",{key:Be,class:pe(b(S).e("item")),onMousemove:Ve=>We(me,Ve),onMouseleave:we,onClick:Ve=>de(me)},[Ze(b(On),{class:pe([b(S).e("icon"),{hover:z.value===me},b(S).is("active",me<=k.value)])},{default:st(()=>[le(me)?yt("v-if",!0):(ae(),Oe(Bn,{key:0},[hr((ae(),kt(Tr(b(ce)),null,null,512)),[[no,me<=k.value]]),hr((ae(),kt(Tr(b(fe)),null,null,512)),[[no,!(me<=k.value)]])],64)),le(me)?(ae(),Oe(Bn,{key:1},[(ae(),kt(Tr(b(fe)),{class:pe([b(S).em("decimal","box")])},null,8,["class"])),Ze(b(On),{style:$n(b(J)),class:pe([b(S).e("icon"),b(S).e("decimal")])},{default:st(()=>[(ae(),kt(Tr(b(se))))]),_:1},8,["style","class"])],64)):yt("v-if",!0)]),_:2},1032,["class"])],42,["onMousemove","onClick"]))),128)),be.showText||be.showScore?(ae(),Oe("span",{key:0,class:pe(b(S).e("text")),style:$n({color:be.textColor})},pn(b(U)),7)):yt("v-if",!0)],46,["id","aria-label","aria-labelledby","aria-valuenow","aria-valuetext","aria-valuemax"])}}});var nae=fn(tae,[["__file","rate.vue"]]);const rae=ur(nae),dm={success:"icon-success",warning:"icon-warning",error:"icon-error",info:"icon-info"},FR={[dm.success]:t7,[dm.warning]:px,[dm.error]:eE,[dm.info]:tE},oae=un({title:{type:String,default:""},subTitle:{type:String,default:""},icon:{type:String,values:["success","warning","info","error"],default:"info"}}),iae=qe({name:"ElResult"}),sae=qe({...iae,props:oae,setup(e){const t=e,i=en("result"),a=ee(()=>{const d=t.icon,p=d&&dm[d]?dm[d]:"icon-info",_=FR[p]||FR["icon-info"];return{class:p,component:_}});return(d,p)=>(ae(),Oe("div",{class:pe(b(i).b())},[Ue("div",{class:pe(b(i).e("icon"))},[pt(d.$slots,"icon",{},()=>[b(a).component?(ae(),kt(Tr(b(a).component),{key:0,class:pe(b(a).class)},null,8,["class"])):yt("v-if",!0)])],2),d.title||d.$slots.title?(ae(),Oe("div",{key:0,class:pe(b(i).e("title"))},[pt(d.$slots,"title",{},()=>[Ue("p",null,pn(d.title),1)])],2)):yt("v-if",!0),d.subTitle||d.$slots["sub-title"]?(ae(),Oe("div",{key:1,class:pe(b(i).e("subtitle"))},[pt(d.$slots,"sub-title",{},()=>[Ue("p",null,pn(d.subTitle),1)])],2)):yt("v-if",!0),d.$slots.extra?(ae(),Oe("div",{key:2,class:pe(b(i).e("extra"))},[pt(d.$slots,"extra")],2)):yt("v-if",!0)],2))}});var aae=fn(sae,[["__file","result.vue"]]);const lae=ur(aae),cae=["start","center","end","space-around","space-between","space-evenly"],uae=["top","middle","bottom"],dae=un({tag:{type:String,default:"div"},gutter:{type:Number,default:0},justify:{type:String,values:cae,default:"start"},align:{type:String,values:uae}}),hae=qe({name:"ElRow"}),fae=qe({...hae,props:dae,setup(e){const t=e,i=en("row"),a=ee(()=>t.gutter);Dr(zF,{gutter:a});const d=ee(()=>{const _={};return t.gutter&&(_.marginRight=_.marginLeft=`-${t.gutter/2}px`),_}),p=ee(()=>[i.b(),i.is(`justify-${t.justify}`,t.justify!=="start"),i.is(`align-${t.align}`,!!t.align)]);return(_,r)=>(ae(),kt(Tr(_.tag),{class:pe(b(p)),style:$n(b(d))},{default:st(()=>[pt(_.$slots,"default")]),_:3},8,["class","style"]))}});var pae=fn(fae,[["__file","row.vue"]]);const mae=ur(pae),gae=qe({props:{item:{type:Object,required:!0},style:{type:Object},height:Number},setup(){return{ns:en("select")}}});function vae(e,t,i,a,d,p){return ae(),Oe("div",{class:pe(e.ns.be("group","title")),style:$n({...e.style,lineHeight:`${e.height}px`})},pn(e.item.label),7)}var _ae=fn(gae,[["render",vae],["__file","group-item.vue"]]);function yae(e,{emit:t}){return{hoverItem:()=>{e.disabled||t("hover",e.index)},selectOptionClick:()=>{e.disabled||t("select",e.item,e.index)}}}const F4={label:"label",value:"value",disabled:"disabled",options:"options"};function Tx(e){const t=ee(()=>({...F4,...e.props}));return{aliasProps:t,getLabel:_=>Ii(_,t.value.label),getValue:_=>Ii(_,t.value.value),getDisabled:_=>Ii(_,t.value.disabled),getOptions:_=>Ii(_,t.value.options)}}const bae=un({allowCreate:Boolean,autocomplete:{type:dt(String),default:"none"},automaticDropdown:Boolean,clearable:Boolean,clearIcon:{type:Mo,default:Wu},effect:{type:dt(String),default:"light"},collapseTags:Boolean,collapseTagsTooltip:Boolean,maxCollapseTags:{type:Number,default:1},defaultFirstOption:Boolean,disabled:Boolean,estimatedOptionHeight:{type:Number,default:void 0},filterable:Boolean,filterMethod:Function,height:{type:Number,default:274},itemHeight:{type:Number,default:34},id:String,loading:Boolean,loadingText:String,modelValue:{type:dt([Array,String,Number,Boolean,Object])},multiple:Boolean,multipleLimit:{type:Number,default:0},name:String,noDataText:String,noMatchText:String,remoteMethod:Function,reserveKeyword:{type:Boolean,default:!0},options:{type:dt(Array),required:!0},placeholder:{type:String},teleported:rs.teleported,persistent:{type:Boolean,default:!0},popperClass:{type:String,default:""},popperOptions:{type:dt(Object),default:()=>({})},remote:Boolean,size:zi,props:{type:dt(Object),default:()=>F4},valueKey:{type:String,default:"value"},scrollbarAlwaysOn:Boolean,validateEvent:{type:Boolean,default:!0},offset:{type:Number,default:12},showArrow:{type:Boolean,default:!0},placement:{type:dt(String),values:qu,default:"bottom-start"},fallbackPlacements:{type:dt(Array),default:["bottom-start","top-start","right","left"]},tagType:{...Nu.type,default:"info"},tagEffect:{...Nu.effect,default:"light"},tabindex:{type:[String,Number],default:0},appendTo:String,fitInputWidth:{type:[Boolean,Number],default:!0,validator(e){return Ro(e)||Gn(e)}},...Qm,..._s(["ariaLabel"])}),xae=un({data:Array,disabled:Boolean,hovering:Boolean,item:{type:dt(Object),required:!0},index:Number,style:Object,selected:Boolean,created:Boolean}),wae={[mr]:e=>!0,[Eo]:e=>!0,"remove-tag":e=>!0,"visible-change":e=>!0,focus:e=>e instanceof FocusEvent,blur:e=>e instanceof FocusEvent,clear:()=>!0},Sae={hover:e=>Gn(e),select:(e,t)=>!0},$E=Symbol("ElSelectV2Injection"),Tae=qe({props:xae,emits:Sae,setup(e,{emit:t}){const i=An($E),a=en("select"),{hoverItem:d,selectOptionClick:p}=yae(e,{emit:t}),{getLabel:_}=Tx(i.props);return{ns:a,hoverItem:d,selectOptionClick:p,getLabel:_}}});function Cae(e,t,i,a,d,p){return ae(),Oe("li",{"aria-selected":e.selected,style:$n(e.style),class:pe([e.ns.be("dropdown","item"),e.ns.is("selected",e.selected),e.ns.is("disabled",e.disabled),e.ns.is("created",e.created),e.ns.is("hovering",e.hovering)]),onMousemove:e.hoverItem,onClick:Qn(e.selectOptionClick,["stop"])},[pt(e.$slots,"default",{item:e.item,index:e.index,disabled:e.disabled},()=>[Ue("span",null,pn(e.getLabel(e.item)),1)])],46,["aria-selected","onMousemove","onClick"])}var Eae=fn(Tae,[["render",Cae],["__file","option-item.vue"]]),NR=Number.isNaN||function(t){return typeof t=="number"&&t!==t};function Mae(e,t){return!!(e===t||NR(e)&&NR(t))}function Iae(e,t){if(e.length!==t.length)return!1;for(var i=0;i<e.length;i++)if(!Mae(e[i],t[i]))return!1;return!0}function Aae(e,t){t===void 0&&(t=Iae);var i=null;function a(){for(var d=[],p=0;p<arguments.length;p++)d[p]=arguments[p];if(i&&i.lastThis===this&&t(d,i.lastArgs))return i.lastResult;var _=e.apply(this,d);return i={lastResult:_,lastArgs:d,lastThis:this},_}return a.clear=function(){i=null},a}const N4=()=>{const t=wr().proxy.$props;return ee(()=>{const i=(a,d,p)=>({});return t.perfMode?ax(i):Aae(i)})},wT=50,I1="itemRendered",A1="scroll",hm="forward",k1="backward",xl="auto",Cx="smart",ey="start",Bc="center",ty="end",Fm="horizontal",UE="vertical",kae="ltr",xm="rtl",ny="negative",jE="positive-ascending",HE="positive-descending",Pae={[Fm]:"left",[UE]:"top"},Rae=20,Oae={[Fm]:"deltaX",[UE]:"deltaY"},Lae=({atEndEdge:e,atStartEdge:t,layout:i},a)=>{let d,p=0;const _=S=>S<0&&t.value||S>0&&e.value;return{hasReachedEdge:_,onWheel:S=>{Lf(d);const C=S[Oae[i.value]];_(p)&&_(p+C)||(p+=C,gx()||S.preventDefault(),d=qd(()=>{a(p),p=0}))}}},ST=pc({type:dt([Number,Function]),required:!0}),TT=pc({type:Number}),CT=pc({type:Number,default:2}),Dae=pc({type:String,values:["ltr","rtl"],default:"ltr"}),ET=pc({type:Number,default:0}),P1=pc({type:Number,required:!0}),B4=pc({type:String,values:["horizontal","vertical"],default:UE}),V4=un({className:{type:String,default:""},containerElement:{type:dt([String,Object]),default:"div"},data:{type:dt(Array),default:()=>ni([])},direction:Dae,height:{type:[String,Number],required:!0},innerElement:{type:[String,Object],default:"div"},style:{type:dt([Object,String,Array])},useIsScrolling:{type:Boolean,default:!1},width:{type:[Number,String],required:!1},perfMode:{type:Boolean,default:!0},scrollbarAlwaysOn:{type:Boolean,default:!1}}),$4=un({cache:CT,estimatedItemSize:TT,layout:B4,initScrollOffset:ET,total:P1,itemSize:ST,...V4}),MT={type:Number,default:6},U4={type:Number,default:0},j4={type:Number,default:2},If=un({columnCache:CT,columnWidth:ST,estimatedColumnWidth:TT,estimatedRowHeight:TT,initScrollLeft:ET,initScrollTop:ET,itemKey:{type:dt(Function),default:({columnIndex:e,rowIndex:t})=>`${t}:${e}`},rowCache:CT,rowHeight:ST,totalColumn:P1,totalRow:P1,hScrollbarSize:MT,vScrollbarSize:MT,scrollbarStartGap:U4,scrollbarEndGap:j4,role:String,...V4}),H4=un({alwaysOn:Boolean,class:String,layout:B4,total:P1,ratio:{type:Number,required:!0},clientSize:{type:Number,required:!0},scrollFrom:{type:Number,required:!0},scrollbarSize:MT,startGap:U4,endGap:j4,visible:Boolean}),bf=(e,t)=>e<t?hm:k1,ry=e=>e===kae||e===xm||e===Fm,BR=e=>e===xm;let nm=null;function R1(e=!1){if(nm===null||e){const t=document.createElement("div"),i=t.style;i.width="50px",i.height="50px",i.overflow="scroll",i.direction="rtl";const a=document.createElement("div"),d=a.style;return d.width="100px",d.height="100px",t.appendChild(a),document.body.appendChild(t),t.scrollLeft>0?nm=HE:(t.scrollLeft=1,t.scrollLeft===0?nm=ny:nm=jE),document.body.removeChild(t),nm}return nm}function zae({move:e,size:t,bar:i},a){const d={},p=`translate${i.axis}(${e}px)`;return d[i.size]=t,d.transform=p,d.msTransform=p,d.webkitTransform=p,a==="horizontal"?d.height="100%":d.width="100%",d}const IT=qe({name:"ElVirtualScrollBar",props:H4,emits:["scroll","start-move","stop-move"],setup(e,{emit:t}){const i=ee(()=>e.startGap+e.endGap),a=en("virtual-scrollbar"),d=en("scrollbar"),p=Se(),_=Se();let r=null,S=null;const C=lo({isDragging:!1,traveled:0}),M=ee(()=>Oz[e.layout]),k=ee(()=>e.clientSize-b(i)),z=ee(()=>({position:"absolute",width:`${Fm===e.layout?k.value:e.scrollbarSize}px`,height:`${Fm===e.layout?e.scrollbarSize:k.value}px`,[Pae[e.layout]]:"2px",right:"2px",bottom:"2px",borderRadius:"4px"})),F=ee(()=>{const ne=e.ratio,se=e.clientSize;if(ne>=100)return Number.POSITIVE_INFINITY;if(ne>=50)return ne*se/100;const fe=se/3;return Math.floor(Math.min(Math.max(ne*se,Rae),fe))}),B=ee(()=>{if(!Number.isFinite(F.value))return{display:"none"};const ne=`${F.value}px`;return zae({bar:M.value,size:ne,move:C.traveled},e.layout)}),N=ee(()=>Math.floor(e.clientSize-F.value-b(i))),j=()=>{window.addEventListener("mousemove",q),window.addEventListener("mouseup",Y);const ne=b(_);ne&&(S=document.onselectstart,document.onselectstart=()=>!1,ne.addEventListener("touchmove",q,{passive:!0}),ne.addEventListener("touchend",Y))},U=()=>{window.removeEventListener("mousemove",q),window.removeEventListener("mouseup",Y),document.onselectstart=S,S=null;const ne=b(_);ne&&(ne.removeEventListener("touchmove",q),ne.removeEventListener("touchend",Y))},te=ne=>{ne.stopImmediatePropagation(),!(ne.ctrlKey||[1,2].includes(ne.button))&&(C.isDragging=!0,C[M.value.axis]=ne.currentTarget[M.value.offset]-(ne[M.value.client]-ne.currentTarget.getBoundingClientRect()[M.value.direction]),t("start-move"),j())},Y=()=>{C.isDragging=!1,C[M.value.axis]=0,t("stop-move"),U()},q=ne=>{const{isDragging:se}=C;if(!se||!_.value||!p.value)return;const fe=C[M.value.axis];if(!fe)return;Lf(r);const ce=(p.value.getBoundingClientRect()[M.value.direction]-ne[M.value.client])*-1,le=_.value[M.value.offset]-fe,ge=ce-le;r=qd(()=>{C.traveled=Math.max(e.startGap,Math.min(ge,N.value)),t("scroll",ge,N.value)})},J=ne=>{const se=Math.abs(ne.target.getBoundingClientRect()[M.value.direction]-ne[M.value.client]),fe=_.value[M.value.offset]/2,ce=se-fe;C.traveled=Math.max(0,Math.min(ce,N.value)),t("scroll",ce,N.value)};return qt(()=>e.scrollFrom,ne=>{C.isDragging||(C.traveled=Math.ceil(ne*N.value))}),Oo(()=>{U()}),()=>Kn("div",{role:"presentation",ref:p,class:[a.b(),e.class,(e.alwaysOn||C.isDragging)&&"always-on"],style:z.value,onMousedown:Qn(J,["stop","prevent"]),onTouchstartPrevent:te},Kn("div",{ref:_,class:d.e("thumb"),style:B.value,onMousedown:te},[]))}}),G4=({name:e,getOffset:t,getItemSize:i,getItemOffset:a,getEstimatedTotalSize:d,getStartIndexForOffset:p,getStopIndexForStartIndex:_,initCache:r,clearCache:S,validateProps:C})=>qe({name:e??"ElVirtualList",props:$4,emits:[I1,A1],setup(M,{emit:k,expose:z}){C(M);const F=wr(),B=en("vl"),N=Se(r(M,F)),j=N4(),U=Se(),te=Se(),Y=Se(),q=Se({isScrolling:!1,scrollDir:"forward",scrollOffset:Gn(M.initScrollOffset)?M.initScrollOffset:0,updateRequested:!1,isScrollbarDragging:!1,scrollbarAlwaysOn:M.scrollbarAlwaysOn}),J=ee(()=>{const{total:Pe,cache:wt}=M,{isScrolling:Mt,scrollDir:Nt,scrollOffset:vt}=b(q);if(Pe===0)return[0,0,0,0];const Bt=p(M,vt,b(N)),Wt=_(M,Bt,vt,b(N)),Fe=!Mt||Nt===k1?Math.max(1,wt):1,cn=!Mt||Nt===hm?Math.max(1,wt):1;return[Math.max(0,Bt-Fe),Math.max(0,Math.min(Pe-1,Wt+cn)),Bt,Wt]}),ne=ee(()=>d(M,b(N))),se=ee(()=>ry(M.layout)),fe=ee(()=>[{position:"relative",[`overflow-${se.value?"x":"y"}`]:"scroll",WebkitOverflowScrolling:"touch",willChange:"transform"},{direction:M.direction,height:Gn(M.height)?`${M.height}px`:M.height,width:Gn(M.width)?`${M.width}px`:M.width},M.style]),ce=ee(()=>{const Pe=b(ne),wt=b(se);return{height:wt?"100%":`${Pe}px`,pointerEvents:b(q).isScrolling?"none":void 0,width:wt?`${Pe}px`:"100%"}}),le=ee(()=>se.value?M.width:M.height),{onWheel:ge}=Lae({atStartEdge:ee(()=>q.value.scrollOffset<=0),atEndEdge:ee(()=>q.value.scrollOffset>=ne.value),layout:ee(()=>M.layout)},Pe=>{var wt,Mt;(Mt=(wt=Y.value).onMouseUp)==null||Mt.call(wt),Me(Math.min(q.value.scrollOffset+Pe,ne.value-le.value))});So(U,"wheel",ge,{passive:!1});const de=()=>{const{total:Pe}=M;if(Pe>0){const[vt,Bt,Wt,Fe]=b(J);k(I1,vt,Bt,Wt,Fe)}const{scrollDir:wt,scrollOffset:Mt,updateRequested:Nt}=b(q);k(A1,wt,Mt,Nt)},ke=Pe=>{const{clientHeight:wt,scrollHeight:Mt,scrollTop:Nt}=Pe.currentTarget,vt=b(q);if(vt.scrollOffset===Nt)return;const Bt=Math.max(0,Math.min(Nt,Mt-wt));q.value={...vt,isScrolling:!0,scrollDir:bf(vt.scrollOffset,Bt),scrollOffset:Bt,updateRequested:!1},Vn(Be)},We=Pe=>{const{clientWidth:wt,scrollLeft:Mt,scrollWidth:Nt}=Pe.currentTarget,vt=b(q);if(vt.scrollOffset===Mt)return;const{direction:Bt}=M;let Wt=Mt;if(Bt===xm)switch(R1()){case ny:{Wt=-Mt;break}case HE:{Wt=Nt-wt-Mt;break}}Wt=Math.max(0,Math.min(Wt,Nt-wt)),q.value={...vt,isScrolling:!0,scrollDir:bf(vt.scrollOffset,Wt),scrollOffset:Wt,updateRequested:!1},Vn(Be)},we=Pe=>{b(se)?We(Pe):ke(Pe),de()},be=(Pe,wt)=>{const Mt=(ne.value-le.value)/wt*Pe;Me(Math.min(ne.value-le.value,Mt))},Me=Pe=>{Pe=Math.max(Pe,0),Pe!==b(q).scrollOffset&&(q.value={...b(q),scrollOffset:Pe,scrollDir:bf(b(q).scrollOffset,Pe),updateRequested:!0},Vn(Be))},Ae=(Pe,wt=xl)=>{const{scrollOffset:Mt}=b(q);Pe=Math.max(0,Math.min(Pe,M.total-1)),Me(t(M,Pe,wt,Mt,b(N)))},me=Pe=>{const{direction:wt,itemSize:Mt,layout:Nt}=M,vt=j.value(S&&Mt,S&&Nt,S&&wt);let Bt;if(to(vt,String(Pe)))Bt=vt[Pe];else{const Wt=a(M,Pe,b(N)),Fe=i(M,Pe,b(N)),cn=b(se),Re=wt===xm,nt=cn?Wt:0;vt[Pe]=Bt={position:"absolute",left:Re?void 0:`${nt}px`,right:Re?`${nt}px`:void 0,top:cn?0:`${Wt}px`,height:cn?"100%":`${Fe}px`,width:cn?`${Fe}px`:"100%"}}return Bt},Be=()=>{q.value.isScrolling=!1,Vn(()=>{j.value(-1,null,null)})},Ve=()=>{const Pe=U.value;Pe&&(Pe.scrollTop=0)};gr(()=>{if(!Hr)return;const{initScrollOffset:Pe}=M,wt=b(U);Gn(Pe)&&wt&&(b(se)?wt.scrollLeft=Pe:wt.scrollTop=Pe),de()}),hc(()=>{const{direction:Pe,layout:wt}=M,{scrollOffset:Mt,updateRequested:Nt}=b(q),vt=b(U);if(Nt&&vt)if(wt===Fm)if(Pe===xm)switch(R1()){case ny:{vt.scrollLeft=-Mt;break}case jE:{vt.scrollLeft=Mt;break}default:{const{clientWidth:Bt,scrollWidth:Wt}=vt;vt.scrollLeft=Wt-Bt-Mt;break}}else vt.scrollLeft=Mt;else vt.scrollTop=Mt}),TC(()=>{b(U).scrollTop=b(q).scrollOffset});const bt={ns:B,clientSize:le,estimatedTotalSize:ne,windowStyle:fe,windowRef:U,innerRef:te,innerStyle:ce,itemsToRender:J,scrollbarRef:Y,states:q,getItemStyle:me,onScroll:we,onScrollbarScroll:be,onWheel:ge,scrollTo:Me,scrollToItem:Ae,resetScrollTop:Ve};return z({windowRef:U,innerRef:te,getItemStyleCache:j,scrollTo:Me,scrollToItem:Ae,resetScrollTop:Ve,states:q}),bt},render(M){var k;const{$slots:z,className:F,clientSize:B,containerElement:N,data:j,getItemStyle:U,innerElement:te,itemsToRender:Y,innerStyle:q,layout:J,total:ne,onScroll:se,onScrollbarScroll:fe,states:ce,useIsScrolling:le,windowStyle:ge,ns:de}=M,[ke,We]=Y,we=Tr(N),be=Tr(te),Me=[];if(ne>0)for(let Ve=ke;Ve<=We;Ve++)Me.push(Kn(Bn,{key:Ve},(k=z.default)==null?void 0:k.call(z,{data:j,index:Ve,isScrolling:le?ce.isScrolling:void 0,style:U(Ve)})));const Ae=[Kn(be,{style:q,ref:"innerRef"},Dn(be)?Me:{default:()=>Me})],me=Kn(IT,{ref:"scrollbarRef",clientSize:B,layout:J,onScroll:fe,ratio:B*100/this.estimatedTotalSize,scrollFrom:ce.scrollOffset/(this.estimatedTotalSize-B),total:ne}),Be=Kn(we,{class:[de.e("window"),F],style:ge,onScroll:se,ref:"windowRef",key:0},Dn(we)?[Ae]:{default:()=>[Ae]});return Kn("div",{key:0,class:[de.e("wrapper"),ce.scrollbarAlwaysOn?"always-on":""]},[Be,me])}}),W4=G4({name:"ElFixedSizeList",getItemOffset:({itemSize:e},t)=>t*e,getItemSize:({itemSize:e})=>e,getEstimatedTotalSize:({total:e,itemSize:t})=>t*e,getOffset:({height:e,total:t,itemSize:i,layout:a,width:d},p,_,r)=>{const S=ry(a)?d:e,C=Math.max(0,t*i-S),M=Math.min(C,p*i),k=Math.max(0,(p+1)*i-S);switch(_===Cx&&(r>=k-S&&r<=M+S?_=xl:_=Bc),_){case ey:return M;case ty:return k;case Bc:{const z=Math.round(k+(M-k)/2);return z<Math.ceil(S/2)?0:z>C+Math.floor(S/2)?C:z}case xl:default:return r>=k&&r<=M?r:r<k?k:M}},getStartIndexForOffset:({total:e,itemSize:t},i)=>Math.max(0,Math.min(e-1,Math.floor(i/t))),getStopIndexForStartIndex:({height:e,total:t,itemSize:i,layout:a,width:d},p,_)=>{const r=p*i,S=ry(a)?d:e,C=Math.ceil((S+_-r)/i);return Math.max(0,Math.min(t-1,p+C-1))},initCache(){},clearCache:!0,validateProps(){}}),fm=(e,t,i)=>{const{itemSize:a}=e,{items:d,lastVisitedIndex:p}=i;if(t>p){let _=0;if(p>=0){const r=d[p];_=r.offset+r.size}for(let r=p+1;r<=t;r++){const S=a(r);d[r]={offset:_,size:S},_+=S}i.lastVisitedIndex=t}return d[t]},Fae=(e,t,i)=>{const{items:a,lastVisitedIndex:d}=t;return(d>0?a[d].offset:0)>=i?q4(e,t,0,d,i):Nae(e,t,Math.max(0,d),i)},q4=(e,t,i,a,d)=>{for(;i<=a;){const p=i+Math.floor((a-i)/2),_=fm(e,p,t).offset;if(_===d)return p;_<d?i=p+1:_>d&&(a=p-1)}return Math.max(0,i-1)},Nae=(e,t,i,a)=>{const{total:d}=e;let p=1;for(;i<d&&fm(e,i,t).offset<a;)i+=p,p*=2;return q4(e,t,Math.floor(i/2),Math.min(i,d-1),a)},VR=({total:e},{items:t,estimatedItemSize:i,lastVisitedIndex:a})=>{let d=0;if(a>=e&&(a=e-1),a>=0){const r=t[a];d=r.offset+r.size}const _=(e-a-1)*i;return d+_},Bae=G4({name:"ElDynamicSizeList",getItemOffset:(e,t,i)=>fm(e,t,i).offset,getItemSize:(e,t,{items:i})=>i[t].size,getEstimatedTotalSize:VR,getOffset:(e,t,i,a,d)=>{const{height:p,layout:_,width:r}=e,S=ry(_)?r:p,C=fm(e,t,d),M=VR(e,d),k=Math.max(0,Math.min(M-S,C.offset)),z=Math.max(0,C.offset-S+C.size);switch(i===Cx&&(a>=z-S&&a<=k+S?i=xl:i=Bc),i){case ey:return k;case ty:return z;case Bc:return Math.round(z+(k-z)/2);case xl:default:return a>=z&&a<=k?a:a<z?z:k}},getStartIndexForOffset:(e,t,i)=>Fae(e,i,t),getStopIndexForStartIndex:(e,t,i,a)=>{const{height:d,total:p,layout:_,width:r}=e,S=ry(_)?r:d,C=fm(e,t,a),M=i+S;let k=C.offset+C.size,z=t;for(;z<p-1&&k<M;)z++,k+=fm(e,z,a).size;return z},initCache({estimatedItemSize:e=wT},t){const i={items:{},estimatedItemSize:e,lastVisitedIndex:-1};return i.clearCacheAfterIndex=(a,d=!0)=>{var p,_;i.lastVisitedIndex=Math.min(i.lastVisitedIndex,a-1),(p=t.exposed)==null||p.getItemStyleCache(-1),d&&((_=t.proxy)==null||_.$forceUpdate())},i},clearCache:!1,validateProps:({itemSize:e})=>{}}),Vae={loading:Boolean,data:{type:Array,required:!0},hoveringIndex:Number,width:Number};var $ae=qe({name:"ElSelectDropdown",props:Vae,setup(e,{slots:t,expose:i}){const a=An($E),d=en("select"),{getLabel:p,getValue:_,getDisabled:r}=Tx(a.props),S=Se([]),C=Se(),M=ee(()=>e.data.length);qt(()=>M.value,()=>{var ge,de;(de=(ge=a.tooltipRef.value).updatePopper)==null||de.call(ge)});const k=ee(()=>oo(a.props.estimatedOptionHeight)),z=ee(()=>k.value?{itemSize:a.props.itemHeight}:{estimatedSize:a.props.estimatedOptionHeight,itemSize:ge=>S.value[ge]}),F=(ge=[],de)=>{const{props:{valueKey:ke}}=a;return yr(de)?ge&&ge.some(We=>wo(Ii(We,ke))===Ii(de,ke)):ge.includes(de)},B=(ge,de)=>{if(yr(de)){const{valueKey:ke}=a.props;return Ii(ge,ke)===Ii(de,ke)}else return ge===de},N=(ge,de)=>a.props.multiple?F(ge,_(de)):B(ge,_(de)),j=(ge,de)=>{const{disabled:ke,multiple:We,multipleLimit:we}=a.props;return ke||!de&&(We?we>0&&ge.length>=we:!1)},U=ge=>e.hoveringIndex===ge;i({listRef:C,isSized:k,isItemDisabled:j,isItemHovering:U,isItemSelected:N,scrollToItem:ge=>{const de=C.value;de&&de.scrollToItem(ge)},resetScrollTop:()=>{const ge=C.value;ge&&ge.resetScrollTop()}});const J=ge=>{const{index:de,data:ke,style:We}=ge,we=b(k),{itemSize:be,estimatedSize:Me}=b(z),{modelValue:Ae}=a.props,{onSelect:me,onHover:Be}=a,Ve=ke[de];if(Ve.type==="Group")return Ze(_ae,{item:Ve,style:We,height:we?be:Me},null);const bt=N(Ae,Ve),Pe=j(Ae,bt),wt=U(de);return Ze(Eae,Mr(ge,{selected:bt,disabled:r(Ve)||Pe,created:!!Ve.created,hovering:wt,item:Ve,onSelect:me,onHover:Be}),{default:Mt=>{var Nt;return((Nt=t.default)==null?void 0:Nt.call(t,Mt))||Ze("span",null,[p(Ve)])}})},{onKeyboardNavigate:ne,onKeyboardSelect:se}=a,fe=()=>{ne("forward")},ce=()=>{ne("backward")},le=ge=>{const{code:de}=ge,{tab:ke,esc:We,down:we,up:be,enter:Me,numpadEnter:Ae}=En;switch(de!==ke&&(ge.preventDefault(),ge.stopPropagation()),de){case ke:case We:break;case we:fe();break;case be:ce();break;case Me:case Ae:se();break}};return()=>{var ge,de,ke,We;const{data:we,width:be}=e,{height:Me,multiple:Ae,scrollbarAlwaysOn:me}=a.props,Be=b(k)?W4:Bae;return Ze("div",{class:[d.b("dropdown"),d.is("multiple",Ae)],style:{width:`${be}px`}},[(ge=t.header)==null?void 0:ge.call(t),((de=t.loading)==null?void 0:de.call(t))||((ke=t.empty)==null?void 0:ke.call(t))||Ze(Be,Mr({ref:C},b(z),{className:d.be("dropdown","list"),scrollbarAlwaysOn:me,data:we,height:Me,width:be,total:we.length,onKeydown:le}),{default:Ve=>Ze(J,Ve,null)}),(We=t.footer)==null?void 0:We.call(t)])}}});function Uae(e,t){const{aliasProps:i,getLabel:a,getValue:d}=Tx(e),p=Se(0),_=Se(),r=ee(()=>e.allowCreate&&e.filterable);function S(F){const B=N=>a(N)===F;return e.options&&e.options.some(B)||t.createdOptions.some(B)}function C(F){r.value&&(e.multiple&&F.created?p.value++:_.value=F)}function M(F){if(r.value)if(F&&F.length>0){if(S(F))return;const B={[i.value.value]:F,[i.value.label]:F,created:!0,[i.value.disabled]:!1};t.createdOptions.length>=p.value?t.createdOptions[p.value]=B:t.createdOptions.push(B)}else if(e.multiple)t.createdOptions.length=p.value;else{const B=_.value;t.createdOptions.length=0,B&&B.created&&t.createdOptions.push(B)}}function k(F){if(!r.value||!F||!F.created||F.created&&e.reserveKeyword&&t.inputValue===a(F))return;const B=t.createdOptions.findIndex(N=>d(N)===d(F));~B&&(t.createdOptions.splice(B,1),p.value--)}function z(){r.value&&(t.createdOptions.length=0,p.value=0)}return{createNewOption:M,removeNewOption:k,selectNewOption:C,clearAllNewOption:z}}const jae=(e,t)=>{const{t:i}=Gr(),a=en("select"),d=en("input"),{form:p,formItem:_}=As(),{inputId:r}=Al(e,{formItemContext:_}),{aliasProps:S,getLabel:C,getValue:M,getDisabled:k,getOptions:z}=Tx(e),{valueOnClear:F,isEmptyValue:B}=dx(e),N=lo({inputValue:"",cachedOptions:[],createdOptions:[],hoveringIndex:-1,inputHovering:!1,selectionWidth:0,collapseItemWidth:0,previousQuery:null,previousValue:void 0,selectedLabel:"",menuVisibleOnFocus:!1,isBeforeHide:!1}),j=Se(-1),U=Se(),te=Se(),Y=Se(),q=Se(),J=Se(),ne=Se(),se=Se(),fe=Se(),ce=Se(),le=Se(),{isComposing:ge,handleCompositionStart:de,handleCompositionEnd:ke,handleCompositionUpdate:We}=Sy({afterComposition:Ke=>Je(Ke)}),{wrapperRef:we,isFocused:be,handleBlur:Me}=rh(J,{beforeFocus(){return Ve.value},afterFocus(){e.automaticDropdown&&!Be.value&&(Be.value=!0,N.menuVisibleOnFocus=!0)},beforeBlur(Ke){var Ct,Qt;return((Ct=Y.value)==null?void 0:Ct.isFocusInsideContent(Ke))||((Qt=q.value)==null?void 0:Qt.isFocusInsideContent(Ke))},afterBlur(){Be.value=!1,N.menuVisibleOnFocus=!1}}),Ae=Se([]),me=Se([]),Be=Se(!1),Ve=ee(()=>e.disabled||(p==null?void 0:p.disabled)),bt=ee(()=>{var Ke;return(Ke=p==null?void 0:p.statusIcon)!=null?Ke:!1}),Pe=ee(()=>{const Ke=me.value.length*e.itemHeight;return Ke>e.height?e.height:Ke}),wt=ee(()=>e.multiple?ln(e.modelValue)&&e.modelValue.length>0:!B(e.modelValue)),Mt=ee(()=>e.clearable&&!Ve.value&&N.inputHovering&&wt.value),Nt=ee(()=>e.remote&&e.filterable?"":Gu),vt=ee(()=>Nt.value&&a.is("reverse",Be.value)),Bt=ee(()=>(_==null?void 0:_.validateState)||""),Wt=ee(()=>{if(Bt.value)return mx[Bt.value]}),Fe=ee(()=>e.remote?300:0),cn=ee(()=>e.loading?e.loadingText||i("el.select.loading"):e.remote&&!N.inputValue&&Ae.value.length===0?!1:e.filterable&&N.inputValue&&Ae.value.length>0&&me.value.length===0?e.noMatchText||i("el.select.noMatch"):Ae.value.length===0?e.noDataText||i("el.select.noData"):null),Re=Ke=>{const Ct=Qt=>{if(e.filterable&&Nn(e.filterMethod)||e.filterable&&e.remote&&Nn(e.remoteMethod))return!0;const on=new RegExp(xE(Ke),"i");return Ke?on.test(C(Qt)||""):!0};return e.loading?[]:[...N.createdOptions,...e.options].reduce((Qt,on)=>{const Wn=z(on);if(ln(Wn)){const er=Wn.filter(Ct);er.length>0&&Qt.push({label:C(on),type:"Group"},...er)}else(e.remote||Ct(on))&&Qt.push(on);return Qt},[])},nt=()=>{Ae.value=Re(""),me.value=Re(N.inputValue)},Qe=ee(()=>{const Ke=new Map;return Ae.value.forEach((Ct,Qt)=>{Ke.set(bo(M(Ct)),{option:Ct,index:Qt})}),Ke}),Yt=ee(()=>{const Ke=new Map;return me.value.forEach((Ct,Qt)=>{Ke.set(bo(M(Ct)),{option:Ct,index:Qt})}),Ke}),Xt=ee(()=>me.value.every(Ke=>k(Ke))),$t=Li(),Ot=ee(()=>$t.value==="small"?"small":"default"),Ft=()=>{var Ke;if(Gn(e.fitInputWidth)){j.value=e.fitInputWidth;return}const Ct=((Ke=U.value)==null?void 0:Ke.offsetWidth)||200;!e.fitInputWidth&&Ae.value.length>0?Vn(()=>{j.value=Math.max(Ct,sn())}):j.value=Ct},sn=()=>{var Ke,Ct;const on=document.createElement("canvas").getContext("2d"),Wn=a.be("dropdown","item"),ar=(((Ct=(Ke=fe.value)==null?void 0:Ke.listRef)==null?void 0:Ct.innerRef)||document).querySelector(`.${Wn}`);if(ar===null||on===null)return 0;const rr=getComputedStyle(ar),$r=Number.parseFloat(rr.paddingLeft)+Number.parseFloat(rr.paddingRight);return on.font=rr.font,me.value.reduce((Pr,Zr)=>{const Jr=on.measureText(C(Zr));return Math.max(Jr.width,Pr)},0)+$r},an=()=>{if(!te.value)return 0;const Ke=window.getComputedStyle(te.value);return Number.parseFloat(Ke.gap||"6px")},Pn=ee(()=>{const Ke=an();return{maxWidth:`${le.value&&e.maxCollapseTags===1?N.selectionWidth-N.collapseItemWidth-Ke:N.selectionWidth}px`}}),bn=ee(()=>({maxWidth:`${N.selectionWidth}px`})),It=ee(()=>ln(e.modelValue)?e.modelValue.length===0&&!N.inputValue:e.filterable?!N.inputValue:!0),Sn=ee(()=>{var Ke;const Ct=(Ke=e.placeholder)!=null?Ke:i("el.select.placeholder");return e.multiple||!wt.value?Ct:N.selectedLabel}),Yn=ee(()=>{var Ke,Ct;return(Ct=(Ke=Y.value)==null?void 0:Ke.popperRef)==null?void 0:Ct.contentRef}),vr=ee(()=>{if(e.multiple){const Ke=e.modelValue.length;if(e.modelValue.length>0&&Yt.value.has(e.modelValue[Ke-1])){const{index:Ct}=Yt.value.get(e.modelValue[Ke-1]);return Ct}}else if(!B(e.modelValue)&&Yt.value.has(e.modelValue)){const{index:Ke}=Yt.value.get(e.modelValue);return Ke}return-1}),tr=ee({get(){return Be.value&&cn.value!==!1},set(Ke){Be.value=Ke}}),zr=ee(()=>e.multiple?e.collapseTags?N.cachedOptions.slice(0,e.maxCollapseTags):N.cachedOptions:[]),Cr=ee(()=>e.multiple?e.collapseTags?N.cachedOptions.slice(e.maxCollapseTags):[]:[]),{createNewOption:Io,removeNewOption:jn,selectNewOption:Gt,clearAllNewOption:ct}=Uae(e,N),Ut=()=>{Ve.value||(N.menuVisibleOnFocus?N.menuVisibleOnFocus=!1:Be.value=!Be.value)},tt=()=>{N.inputValue.length>0&&!Be.value&&(Be.value=!0),Io(N.inputValue),wn(N.inputValue)},yn=Ra(tt,Fe.value),wn=Ke=>{N.previousQuery===Ke||ge.value||(N.previousQuery=Ke,e.filterable&&Nn(e.filterMethod)?e.filterMethod(Ke):e.filterable&&e.remote&&Nn(e.remoteMethod)&&e.remoteMethod(Ke),e.defaultFirstOption&&(e.filterable||e.remote)&&me.value.length?Vn(sr):Vn(je))},sr=()=>{const Ke=me.value.filter(on=>!on.disabled&&on.type!=="Group"),Ct=Ke.find(on=>on.created),Qt=Ke[0];N.hoveringIndex=Go(me.value,Ct||Qt)},vo=Ke=>{ms(e.modelValue,Ke)||t(Eo,Ke)},jo=Ke=>{t(mr,Ke),vo(Ke),N.previousValue=e.multiple?String(Ke):Ke},Go=(Ke=[],Ct)=>{if(!yr(Ct))return Ke.indexOf(Ct);const Qt=e.valueKey;let on=-1;return Ke.some((Wn,er)=>Ii(Wn,Qt)===Ii(Ct,Qt)?(on=er,!0):!1),on},bo=Ke=>yr(Ke)?Ii(Ke,e.valueKey):Ke,oi=()=>{Ft()},mo=()=>{N.selectionWidth=te.value.getBoundingClientRect().width},Fi=()=>{N.collapseItemWidth=le.value.getBoundingClientRect().width},Gs=()=>{var Ke,Ct;(Ct=(Ke=Y.value)==null?void 0:Ke.updatePopper)==null||Ct.call(Ke)},kl=()=>{var Ke,Ct;(Ct=(Ke=q.value)==null?void 0:Ke.updatePopper)==null||Ct.call(Ke)},ga=Ke=>{if(e.multiple){let Ct=e.modelValue.slice();const Qt=Go(Ct,M(Ke));Qt>-1?(Ct=[...Ct.slice(0,Qt),...Ct.slice(Qt+1)],N.cachedOptions.splice(Qt,1),jn(Ke)):(e.multipleLimit<=0||Ct.length<e.multipleLimit)&&(Ct=[...Ct,M(Ke)],N.cachedOptions.push(Ke),Gt(Ke)),jo(Ct),Ke.created&&wn(""),e.filterable&&!e.reserveKeyword&&(N.inputValue="")}else N.selectedLabel=C(Ke),jo(M(Ke)),Be.value=!1,Gt(Ke),Ke.created||ct();va()},Jo=(Ke,Ct)=>{let Qt=e.modelValue.slice();const on=Go(Qt,M(Ct));on>-1&&!Ve.value&&(Qt=[...e.modelValue.slice(0,on),...e.modelValue.slice(on+1)],N.cachedOptions.splice(on,1),jo(Qt),t("remove-tag",M(Ct)),jn(Ct)),Ke.stopPropagation(),va()},va=()=>{var Ke;(Ke=J.value)==null||Ke.focus()},vc=()=>{var Ke;if(Be.value){Be.value=!1,Vn(()=>{var Ct;return(Ct=J.value)==null?void 0:Ct.blur()});return}(Ke=J.value)==null||Ke.blur()},Qa=()=>{N.inputValue.length>0?N.inputValue="":Be.value=!1},Ci=Ke=>iz(Ke,Ct=>!N.cachedOptions.some(Qt=>M(Qt)===Ct&&k(Qt))),Ps=Ke=>{if(e.multiple&&Ke.code!==En.delete&&N.inputValue.length===0){Ke.preventDefault();const Ct=e.modelValue.slice(),Qt=Ci(Ct);if(Qt<0)return;const on=Ct[Qt];Ct.splice(Qt,1);const Wn=N.cachedOptions[Qt];N.cachedOptions.splice(Qt,1),jn(Wn),jo(Ct),t("remove-tag",on)}},zt=()=>{let Ke;ln(e.modelValue)?Ke=[]:Ke=F.value,e.multiple?N.cachedOptions=[]:N.selectedLabel="",Be.value=!1,jo(Ke),t("clear"),ct(),va()},ye=(Ke,Ct=void 0)=>{const Qt=me.value;if(!["forward","backward"].includes(Ke)||Ve.value||Qt.length<=0||Xt.value||ge.value)return;if(!Be.value)return Ut();Ct===void 0&&(Ct=N.hoveringIndex);let on=-1;Ke==="forward"?(on=Ct+1,on>=Qt.length&&(on=0)):Ke==="backward"&&(on=Ct-1,(on<0||on>=Qt.length)&&(on=Qt.length-1));const Wn=Qt[on];if(k(Wn)||Wn.type==="Group")return ye(Ke,on);N.hoveringIndex=on,ht(on)},he=()=>{if(Be.value)~N.hoveringIndex&&me.value[N.hoveringIndex]&&ga(me.value[N.hoveringIndex]);else return Ut()},Ie=Ke=>{N.hoveringIndex=Ke??-1},je=()=>{e.multiple?N.hoveringIndex=me.value.findIndex(Ke=>e.modelValue.some(Ct=>bo(Ct)===bo(Ke))):N.hoveringIndex=me.value.findIndex(Ke=>bo(Ke)===bo(e.modelValue))},Je=Ke=>{if(N.inputValue=Ke.target.value,e.remote)yn();else return tt()},lt=Ke=>{if(Be.value=!1,be.value){const Ct=new FocusEvent("focus",Ke);Me(Ct)}},St=()=>(N.isBeforeHide=!1,Vn(()=>{~vr.value&&ht(N.hoveringIndex)})),ht=Ke=>{fe.value.scrollToItem(Ke)},Dt=(Ke,Ct)=>{const Qt=bo(Ke);if(Qe.value.has(Qt)){const{option:on}=Qe.value.get(Qt);return on}if(Ct&&Ct.length){const on=Ct.find(Wn=>bo(M(Wn))===Qt);if(on)return on}return{[S.value.value]:Ke,[S.value.label]:Ke}},Pt=(Ke=!1)=>{if(e.multiple)if(e.modelValue.length>0){const Ct=N.cachedOptions.slice();N.cachedOptions.length=0,N.previousValue=e.modelValue.toString();for(const Qt of e.modelValue){const on=Dt(Qt,Ct);N.cachedOptions.push(on)}}else N.cachedOptions=[],N.previousValue=void 0;else if(wt.value){N.previousValue=e.modelValue;const Ct=me.value,Qt=Ct.findIndex(on=>bo(M(on))===bo(e.modelValue));~Qt?N.selectedLabel=C(Ct[Qt]):(!N.selectedLabel||Ke)&&(N.selectedLabel=bo(e.modelValue))}else N.selectedLabel="",N.previousValue=void 0;ct(),Ft()};return qt(()=>e.fitInputWidth,()=>{Ft()}),qt(Be,Ke=>{Ke?(e.persistent||Ft(),wn("")):(N.inputValue="",N.previousQuery=null,N.isBeforeHide=!0,Io("")),t("visible-change",Ke)}),qt(()=>e.modelValue,(Ke,Ct)=>{var Qt;(!Ke||ln(Ke)&&Ke.length===0||e.multiple&&!ms(Ke.toString(),N.previousValue)||!e.multiple&&bo(Ke)!==bo(N.previousValue))&&Pt(!0),!ms(Ke,Ct)&&e.validateEvent&&((Qt=_==null?void 0:_.validate)==null||Qt.call(_,"change").catch(Wn=>void 0))},{deep:!0}),qt(()=>e.options,()=>{const Ke=J.value;(!Ke||Ke&&document.activeElement!==Ke)&&Pt()},{deep:!0,flush:"post"}),qt(()=>me.value,()=>(Ft(),fe.value&&Vn(fe.value.resetScrollTop))),Cs(()=>{N.isBeforeHide||nt()}),Cs(()=>{const{valueKey:Ke,options:Ct}=e,Qt=new Map;for(const on of Ct){const Wn=M(on);let er=Wn;if(yr(er)&&(er=Ii(Wn,Ke)),Qt.get(er))break;Qt.set(er,!0)}}),gr(()=>{Pt()}),ti(U,oi),ti(te,mo),ti(fe,Gs),ti(we,Gs),ti(ce,kl),ti(le,Fi),{inputId:r,collapseTagSize:Ot,currentPlaceholder:Sn,expanded:Be,emptyText:cn,popupHeight:Pe,debounce:Fe,allOptions:Ae,filteredOptions:me,iconComponent:Nt,iconReverse:vt,tagStyle:Pn,collapseTagStyle:bn,popperSize:j,dropdownMenuVisible:tr,hasModelValue:wt,shouldShowPlaceholder:It,selectDisabled:Ve,selectSize:$t,needStatusIcon:bt,showClearBtn:Mt,states:N,isFocused:be,nsSelect:a,nsInput:d,inputRef:J,menuRef:fe,tagMenuRef:ce,tooltipRef:Y,tagTooltipRef:q,selectRef:U,wrapperRef:we,selectionRef:te,prefixRef:ne,suffixRef:se,collapseItemRef:le,popperRef:Yn,validateState:Bt,validateIcon:Wt,showTagList:zr,collapseTagList:Cr,debouncedOnInputChange:yn,deleteTag:Jo,getLabel:C,getValue:M,getDisabled:k,getValueKey:bo,handleClear:zt,handleClickOutside:lt,handleDel:Ps,handleEsc:Qa,focus:va,blur:vc,handleMenuEnter:St,handleResize:oi,resetSelectionWidth:mo,updateTooltip:Gs,updateTagTooltip:kl,updateOptions:nt,toggleMenu:Ut,scrollTo:ht,onInput:Je,onKeyboardNavigate:ye,onKeyboardSelect:he,onSelect:ga,onHover:Ie,handleCompositionStart:de,handleCompositionEnd:ke,handleCompositionUpdate:We}},Hae=qe({name:"ElSelectV2",components:{ElSelectMenu:$ae,ElTag:Dm,ElTooltip:Is,ElIcon:On},directives:{ClickOutside:Bu},props:bae,emits:wae,setup(e,{emit:t}){const i=ee(()=>{const{modelValue:r,multiple:S}=e,C=S?[]:void 0;return ln(r)?S?r:C:S?C:r}),a=jae(lo({...Zi(e),modelValue:i}),t),{calculatorRef:d,inputStyle:p}=FE();Dr($E,{props:lo({...Zi(e),height:a.popupHeight,modelValue:i}),expanded:a.expanded,tooltipRef:a.tooltipRef,onSelect:a.onSelect,onHover:a.onHover,onKeyboardNavigate:a.onKeyboardNavigate,onKeyboardSelect:a.onKeyboardSelect});const _=ee(()=>e.multiple?a.states.cachedOptions.map(r=>r.label):a.states.selectedLabel);return{...a,modelValue:i,selectedLabel:_,calculatorRef:d,inputStyle:p}}});function Gae(e,t,i,a,d,p){const _=Er("el-tag"),r=Er("el-tooltip"),S=Er("el-icon"),C=Er("el-select-menu"),M=J1("click-outside");return hr((ae(),Oe("div",{ref:"selectRef",class:pe([e.nsSelect.b(),e.nsSelect.m(e.selectSize)]),onMouseenter:k=>e.states.inputHovering=!0,onMouseleave:k=>e.states.inputHovering=!1},[Ze(r,{ref:"tooltipRef",visible:e.dropdownMenuVisible,teleported:e.teleported,"popper-class":[e.nsSelect.e("popper"),e.popperClass],"gpu-acceleration":!1,"stop-popper-mouse-event":!1,"popper-options":e.popperOptions,"fallback-placements":e.fallbackPlacements,effect:e.effect,placement:e.placement,pure:"",transition:`${e.nsSelect.namespace.value}-zoom-in-top`,trigger:"click",persistent:e.persistent,"append-to":e.appendTo,"show-arrow":e.showArrow,offset:e.offset,onBeforeShow:e.handleMenuEnter,onHide:k=>e.states.isBeforeHide=!1},{default:st(()=>[Ue("div",{ref:"wrapperRef",class:pe([e.nsSelect.e("wrapper"),e.nsSelect.is("focused",e.isFocused),e.nsSelect.is("hovering",e.states.inputHovering),e.nsSelect.is("filterable",e.filterable),e.nsSelect.is("disabled",e.selectDisabled)]),onClick:Qn(e.toggleMenu,["prevent"])},[e.$slots.prefix?(ae(),Oe("div",{key:0,ref:"prefixRef",class:pe(e.nsSelect.e("prefix"))},[pt(e.$slots,"prefix")],2)):yt("v-if",!0),Ue("div",{ref:"selectionRef",class:pe([e.nsSelect.e("selection"),e.nsSelect.is("near",e.multiple&&!e.$slots.prefix&&!!e.modelValue.length)])},[e.multiple?pt(e.$slots,"tag",{key:0},()=>[(ae(!0),Oe(Bn,null,Or(e.showTagList,k=>(ae(),Oe("div",{key:e.getValueKey(e.getValue(k)),class:pe(e.nsSelect.e("selected-item"))},[Ze(_,{closable:!e.selectDisabled&&!e.getDisabled(k),size:e.collapseTagSize,type:e.tagType,effect:e.tagEffect,"disable-transitions":"",style:$n(e.tagStyle),onClose:z=>e.deleteTag(z,k)},{default:st(()=>[Ue("span",{class:pe(e.nsSelect.e("tags-text"))},[pt(e.$slots,"label",{label:e.getLabel(k),value:e.getValue(k)},()=>[Rr(pn(e.getLabel(k)),1)])],2)]),_:2},1032,["closable","size","type","effect","style","onClose"])],2))),128)),e.collapseTags&&e.modelValue.length>e.maxCollapseTags?(ae(),kt(r,{key:0,ref:"tagTooltipRef",disabled:e.dropdownMenuVisible||!e.collapseTagsTooltip,"fallback-placements":["bottom","top","right","left"],effect:e.effect,placement:"bottom",teleported:e.teleported},{default:st(()=>[Ue("div",{ref:"collapseItemRef",class:pe(e.nsSelect.e("selected-item"))},[Ze(_,{closable:!1,size:e.collapseTagSize,type:e.tagType,effect:e.tagEffect,style:$n(e.collapseTagStyle),"disable-transitions":""},{default:st(()=>[Ue("span",{class:pe(e.nsSelect.e("tags-text"))}," + "+pn(e.modelValue.length-e.maxCollapseTags),3)]),_:1},8,["size","type","effect","style"])],2)]),content:st(()=>[Ue("div",{ref:"tagMenuRef",class:pe(e.nsSelect.e("selection"))},[(ae(!0),Oe(Bn,null,Or(e.collapseTagList,k=>(ae(),Oe("div",{key:e.getValueKey(e.getValue(k)),class:pe(e.nsSelect.e("selected-item"))},[Ze(_,{class:"in-tooltip",closable:!e.selectDisabled&&!e.getDisabled(k),size:e.collapseTagSize,type:e.tagType,effect:e.tagEffect,"disable-transitions":"",onClose:z=>e.deleteTag(z,k)},{default:st(()=>[Ue("span",{class:pe(e.nsSelect.e("tags-text"))},[pt(e.$slots,"label",{label:e.getLabel(k),value:e.getValue(k)},()=>[Rr(pn(e.getLabel(k)),1)])],2)]),_:2},1032,["closable","size","type","effect","onClose"])],2))),128))],2)]),_:3},8,["disabled","effect","teleported"])):yt("v-if",!0)]):yt("v-if",!0),Ue("div",{class:pe([e.nsSelect.e("selected-item"),e.nsSelect.e("input-wrapper"),e.nsSelect.is("hidden",!e.filterable)])},[hr(Ue("input",{id:e.inputId,ref:"inputRef","onUpdate:modelValue":k=>e.states.inputValue=k,style:$n(e.inputStyle),autocomplete:e.autocomplete,tabindex:e.tabindex,"aria-autocomplete":"list","aria-haspopup":"listbox",autocapitalize:"off","aria-expanded":e.expanded,"aria-label":e.ariaLabel,class:pe([e.nsSelect.e("input"),e.nsSelect.is(e.selectSize)]),disabled:e.selectDisabled,role:"combobox",readonly:!e.filterable,spellcheck:"false",type:"text",name:e.name,onInput:e.onInput,onCompositionstart:e.handleCompositionStart,onCompositionupdate:e.handleCompositionUpdate,onCompositionend:e.handleCompositionEnd,onKeydown:[Po(Qn(k=>e.onKeyboardNavigate("backward"),["stop","prevent"]),["up"]),Po(Qn(k=>e.onKeyboardNavigate("forward"),["stop","prevent"]),["down"]),Po(Qn(e.onKeyboardSelect,["stop","prevent"]),["enter"]),Po(Qn(e.handleEsc,["stop","prevent"]),["esc"]),Po(Qn(e.handleDel,["stop"]),["delete"])],onClick:Qn(e.toggleMenu,["stop"])},null,46,["id","onUpdate:modelValue","autocomplete","tabindex","aria-expanded","aria-label","disabled","readonly","name","onInput","onCompositionstart","onCompositionupdate","onCompositionend","onKeydown","onClick"]),[[tx,e.states.inputValue]]),e.filterable?(ae(),Oe("span",{key:0,ref:"calculatorRef","aria-hidden":"true",class:pe(e.nsSelect.e("input-calculator")),textContent:pn(e.states.inputValue)},null,10,["textContent"])):yt("v-if",!0)],2),e.shouldShowPlaceholder?(ae(),Oe("div",{key:1,class:pe([e.nsSelect.e("selected-item"),e.nsSelect.e("placeholder"),e.nsSelect.is("transparent",!e.hasModelValue||e.expanded&&!e.states.inputValue)])},[e.hasModelValue?pt(e.$slots,"label",{key:0,label:e.currentPlaceholder,value:e.modelValue},()=>[Ue("span",null,pn(e.currentPlaceholder),1)]):(ae(),Oe("span",{key:1},pn(e.currentPlaceholder),1))],2)):yt("v-if",!0)],2),Ue("div",{ref:"suffixRef",class:pe(e.nsSelect.e("suffix"))},[e.iconComponent?hr((ae(),kt(S,{key:0,class:pe([e.nsSelect.e("caret"),e.nsInput.e("icon"),e.iconReverse])},{default:st(()=>[(ae(),kt(Tr(e.iconComponent)))]),_:1},8,["class"])),[[no,!e.showClearBtn]]):yt("v-if",!0),e.showClearBtn&&e.clearIcon?(ae(),kt(S,{key:1,class:pe([e.nsSelect.e("caret"),e.nsInput.e("icon"),e.nsSelect.e("clear")]),onClick:Qn(e.handleClear,["prevent","stop"])},{default:st(()=>[(ae(),kt(Tr(e.clearIcon)))]),_:1},8,["class","onClick"])):yt("v-if",!0),e.validateState&&e.validateIcon&&e.needStatusIcon?(ae(),kt(S,{key:2,class:pe([e.nsInput.e("icon"),e.nsInput.e("validateIcon"),e.nsInput.is("loading",e.validateState==="validating")])},{default:st(()=>[(ae(),kt(Tr(e.validateIcon)))]),_:1},8,["class"])):yt("v-if",!0)],2)],10,["onClick"])]),content:st(()=>[Ze(C,{ref:"menuRef",data:e.filteredOptions,width:e.popperSize,"hovering-index":e.states.hoveringIndex,"scrollbar-always-on":e.scrollbarAlwaysOn},Ya({default:st(k=>[pt(e.$slots,"default",Ha(Uc(k)))]),_:2},[e.$slots.header?{name:"header",fn:st(()=>[Ue("div",{class:pe(e.nsSelect.be("dropdown","header"))},[pt(e.$slots,"header")],2)])}:void 0,e.$slots.loading&&e.loading?{name:"loading",fn:st(()=>[Ue("div",{class:pe(e.nsSelect.be("dropdown","loading"))},[pt(e.$slots,"loading")],2)])}:e.loading||e.filteredOptions.length===0?{name:"empty",fn:st(()=>[Ue("div",{class:pe(e.nsSelect.be("dropdown","empty"))},[pt(e.$slots,"empty",{},()=>[Ue("span",null,pn(e.emptyText),1)])],2)])}:void 0,e.$slots.footer?{name:"footer",fn:st(()=>[Ue("div",{class:pe(e.nsSelect.be("dropdown","footer"))},[pt(e.$slots,"footer")],2)])}:void 0]),1032,["data","width","hovering-index","scrollbar-always-on"])]),_:3},8,["visible","teleported","popper-class","popper-options","fallback-placements","effect","placement","transition","persistent","append-to","show-arrow","offset","onBeforeShow","onHide"])],42,["onMouseenter","onMouseleave"])),[[M,e.handleClickOutside,e.popperRef]])}var Wae=fn(Hae,[["render",Gae],["__file","select.vue"]]);const qae=ur(Wae),Kae=un({animated:{type:Boolean,default:!1},count:{type:Number,default:1},rows:{type:Number,default:3},loading:{type:Boolean,default:!0},throttle:{type:dt([Number,Object])}}),Zae=un({variant:{type:String,values:["circle","rect","h1","h3","text","caption","p","image","button"],default:"text"}}),Yae=qe({name:"ElSkeletonItem"}),Xae=qe({...Yae,props:Zae,setup(e){const t=en("skeleton");return(i,a)=>(ae(),Oe("div",{class:pe([b(t).e("item"),b(t).e(i.variant)])},[i.variant==="image"?(ae(),kt(b(C7),{key:0})):yt("v-if",!0)],2))}});var O1=fn(Xae,[["__file","skeleton-item.vue"]]);const Jae=(e,t=0)=>{if(t===0)return e;const i=yr(t)&&!!t.initVal,a=Se(i);let d=null;const p=r=>{if(oo(r)){a.value=e.value;return}d&&clearTimeout(d),d=setTimeout(()=>{a.value=e.value},r)},_=r=>{r==="leading"?Gn(t)?p(t):p(t.leading):yr(t)?p(t.trailing):a.value=!1};return gr(()=>_("leading")),qt(()=>e.value,r=>{_(r?"leading":"trailing")}),a},Qae=qe({name:"ElSkeleton"}),ele=qe({...Qae,props:Kae,setup(e,{expose:t}){const i=e,a=en("skeleton"),d=Jae(po(i,"loading"),i.throttle);return t({uiLoading:d}),(p,_)=>b(d)?(ae(),Oe("div",Mr({key:0,class:[b(a).b(),b(a).is("animated",p.animated)]},p.$attrs),[(ae(!0),Oe(Bn,null,Or(p.count,r=>(ae(),Oe(Bn,{key:r},[b(d)?pt(p.$slots,"template",{key:r},()=>[Ze(O1,{class:pe(b(a).is("first")),variant:"p"},null,8,["class"]),(ae(!0),Oe(Bn,null,Or(p.rows,S=>(ae(),kt(O1,{key:S,class:pe([b(a).e("paragraph"),b(a).is("last",S===p.rows&&p.rows>1)]),variant:"p"},null,8,["class"]))),128))]):yt("v-if",!0)],64))),128))],16)):pt(p.$slots,"default",Ha(Mr({key:1},p.$attrs)))}});var tle=fn(ele,[["__file","skeleton.vue"]]);const nle=ur(tle,{SkeletonItem:O1}),rle=ri(O1),K4=Symbol("sliderContextKey"),ole=un({modelValue:{type:dt([Number,Array]),default:0},id:{type:String,default:void 0},min:{type:Number,default:0},max:{type:Number,default:100},step:{type:Number,default:1},showInput:Boolean,showInputControls:{type:Boolean,default:!0},size:zi,inputSize:zi,showStops:Boolean,showTooltip:{type:Boolean,default:!0},formatTooltip:{type:dt(Function),default:void 0},disabled:Boolean,range:Boolean,vertical:Boolean,height:String,debounce:{type:Number,default:300},rangeStartLabel:{type:String,default:void 0},rangeEndLabel:{type:String,default:void 0},formatValueText:{type:dt(Function),default:void 0},tooltipClass:{type:String,default:void 0},placement:{type:String,values:qu,default:"top"},marks:{type:dt(Object)},validateEvent:{type:Boolean,default:!0},persistent:{type:Boolean,default:!0},..._s(["ariaLabel"])}),mS=e=>Gn(e)||ln(e)&&e.every(Gn),ile={[mr]:mS,[Es]:mS,[Eo]:mS},sle=un({modelValue:{type:Number,default:0},vertical:Boolean,tooltipClass:String,placement:{type:String,values:qu,default:"top"}}),ale={[mr]:e=>Gn(e)},lle=(e,t,i)=>{const a=Se(),d=Se(!1),p=ee(()=>t.value instanceof Function),_=ee(()=>p.value&&t.value(e.modelValue)||e.modelValue),r=Ra(()=>{i.value&&(d.value=!0)},50),S=Ra(()=>{i.value&&(d.value=!1)},50);return{tooltip:a,tooltipVisible:d,formatValue:_,displayTooltip:r,hideTooltip:S}},cle=(e,t,i)=>{const{disabled:a,min:d,max:p,step:_,showTooltip:r,persistent:S,precision:C,sliderSize:M,formatTooltip:k,emitChange:z,resetSize:F,updateDragging:B}=An(K4),{tooltip:N,tooltipVisible:j,formatValue:U,displayTooltip:te,hideTooltip:Y}=lle(e,k,r),q=Se(),J=ee(()=>`${(e.modelValue-d.value)/(p.value-d.value)*100}%`),ne=ee(()=>e.vertical?{bottom:J.value}:{left:J.value}),se=()=>{t.hovering=!0,te()},fe=()=>{t.hovering=!1,t.dragging||Y()},ce=Pe=>{a.value||(Pe.preventDefault(),me(Pe),window.addEventListener("mousemove",Be),window.addEventListener("touchmove",Be),window.addEventListener("mouseup",Ve),window.addEventListener("touchend",Ve),window.addEventListener("contextmenu",Ve),q.value.focus())},le=Pe=>{a.value||(t.newPosition=Number.parseFloat(J.value)+Pe/(p.value-d.value)*100,bt(t.newPosition),z())},ge=()=>{le(-_.value)},de=()=>{le(_.value)},ke=()=>{le(-_.value*4)},We=()=>{le(_.value*4)},we=()=>{a.value||(bt(0),z())},be=()=>{a.value||(bt(100),z())},Me=Pe=>{let wt=!0;switch(Pe.code){case En.left:case En.down:ge();break;case En.right:case En.up:de();break;case En.home:we();break;case En.end:be();break;case En.pageDown:ke();break;case En.pageUp:We();break;default:wt=!1;break}wt&&Pe.preventDefault()},Ae=Pe=>{let wt,Mt;return Pe.type.startsWith("touch")?(Mt=Pe.touches[0].clientY,wt=Pe.touches[0].clientX):(Mt=Pe.clientY,wt=Pe.clientX),{clientX:wt,clientY:Mt}},me=Pe=>{t.dragging=!0,t.isClick=!0;const{clientX:wt,clientY:Mt}=Ae(Pe);e.vertical?t.startY=Mt:t.startX=wt,t.startPosition=Number.parseFloat(J.value),t.newPosition=t.startPosition},Be=Pe=>{if(t.dragging){t.isClick=!1,te(),F();let wt;const{clientX:Mt,clientY:Nt}=Ae(Pe);e.vertical?(t.currentY=Nt,wt=(t.startY-t.currentY)/M.value*100):(t.currentX=Mt,wt=(t.currentX-t.startX)/M.value*100),t.newPosition=t.startPosition+wt,bt(t.newPosition)}},Ve=()=>{t.dragging&&(setTimeout(()=>{t.dragging=!1,t.hovering||Y(),t.isClick||bt(t.newPosition),z()},0),window.removeEventListener("mousemove",Be),window.removeEventListener("touchmove",Be),window.removeEventListener("mouseup",Ve),window.removeEventListener("touchend",Ve),window.removeEventListener("contextmenu",Ve))},bt=async Pe=>{if(Pe===null||Number.isNaN(+Pe))return;Pe<0?Pe=0:Pe>100&&(Pe=100);const wt=100/((p.value-d.value)/_.value);let Nt=Math.round(Pe/wt)*wt*(p.value-d.value)*.01+d.value;Nt=Number.parseFloat(Nt.toFixed(C.value)),Nt!==e.modelValue&&i(mr,Nt),!t.dragging&&e.modelValue!==t.oldValue&&(t.oldValue=e.modelValue),await Vn(),t.dragging&&te(),N.value.updatePopper()};return qt(()=>t.dragging,Pe=>{B(Pe)}),So(q,"touchstart",ce,{passive:!1}),{disabled:a,button:q,tooltip:N,tooltipVisible:j,showTooltip:r,persistent:S,wrapperStyle:ne,formatValue:U,handleMouseEnter:se,handleMouseLeave:fe,onButtonDown:ce,onKeyDown:Me,setPosition:bt}},ule=qe({name:"ElSliderButton"}),dle=qe({...ule,props:sle,emits:ale,setup(e,{expose:t,emit:i}){const a=e,d=en("slider"),p=lo({hovering:!1,dragging:!1,isClick:!1,startX:0,currentX:0,startY:0,currentY:0,startPosition:0,newPosition:0,oldValue:a.modelValue}),_=ee(()=>M.value?k.value:!1),{disabled:r,button:S,tooltip:C,showTooltip:M,persistent:k,tooltipVisible:z,wrapperStyle:F,formatValue:B,handleMouseEnter:N,handleMouseLeave:j,onButtonDown:U,onKeyDown:te,setPosition:Y}=cle(a,p,i),{hovering:q,dragging:J}=Zi(p);return t({onButtonDown:U,onKeyDown:te,setPosition:Y,hovering:q,dragging:J}),(ne,se)=>(ae(),Oe("div",{ref_key:"button",ref:S,class:pe([b(d).e("button-wrapper"),{hover:b(q),dragging:b(J)}]),style:$n(b(F)),tabindex:b(r)?-1:0,onMouseenter:b(N),onMouseleave:b(j),onMousedown:b(U),onFocus:b(N),onBlur:b(j),onKeydown:b(te)},[Ze(b(Is),{ref_key:"tooltip",ref:C,visible:b(z),placement:ne.placement,"fallback-placements":["top","bottom","right","left"],"stop-popper-mouse-event":!1,"popper-class":ne.tooltipClass,disabled:!b(M),persistent:b(_)},{content:st(()=>[Ue("span",null,pn(b(B)),1)]),default:st(()=>[Ue("div",{class:pe([b(d).e("button"),{hover:b(q),dragging:b(J)}])},null,2)]),_:1},8,["visible","placement","popper-class","disabled","persistent"])],46,["tabindex","onMouseenter","onMouseleave","onMousedown","onFocus","onBlur","onKeydown"]))}});var $R=fn(dle,[["__file","button.vue"]]);const hle=un({mark:{type:dt([String,Object]),default:void 0}});var fle=qe({name:"ElSliderMarker",props:hle,setup(e){const t=en("slider"),i=ee(()=>Dn(e.mark)?e.mark:e.mark.label),a=ee(()=>Dn(e.mark)?void 0:e.mark.style);return()=>Kn("div",{class:t.e("marks-text"),style:a.value},i.value)}});const ple=(e,t,i)=>{const{form:a,formItem:d}=As(),p=Uo(),_=Se(),r=Se(),S={firstButton:_,secondButton:r},C=ee(()=>e.disabled||(a==null?void 0:a.disabled)||!1),M=ee(()=>Math.min(t.firstValue,t.secondValue)),k=ee(()=>Math.max(t.firstValue,t.secondValue)),z=ee(()=>e.range?`${100*(k.value-M.value)/(e.max-e.min)}%`:`${100*(t.firstValue-e.min)/(e.max-e.min)}%`),F=ee(()=>e.range?`${100*(M.value-e.min)/(e.max-e.min)}%`:"0%"),B=ee(()=>e.vertical?{height:e.height}:{}),N=ee(()=>e.vertical?{height:z.value,bottom:F.value}:{width:z.value,left:F.value}),j=()=>{p.value&&(t.sliderSize=p.value[`client${e.vertical?"Height":"Width"}`])},U=de=>{const ke=e.min+de*(e.max-e.min)/100;if(!e.range)return _;let We;return Math.abs(M.value-ke)<Math.abs(k.value-ke)?We=t.firstValue<t.secondValue?"firstButton":"secondButton":We=t.firstValue>t.secondValue?"firstButton":"secondButton",S[We]},te=de=>{const ke=U(de);return ke.value.setPosition(de),ke},Y=de=>{t.firstValue=de??e.min,J(e.range?[M.value,k.value]:de??e.min)},q=de=>{t.secondValue=de,e.range&&J([M.value,k.value])},J=de=>{i(mr,de),i(Es,de)},ne=async()=>{await Vn(),i(Eo,e.range?[M.value,k.value]:e.modelValue)},se=de=>{var ke,We,we,be,Me,Ae;if(C.value||t.dragging)return;j();let me=0;if(e.vertical){const Be=(we=(We=(ke=de.touches)==null?void 0:ke.item(0))==null?void 0:We.clientY)!=null?we:de.clientY;me=(p.value.getBoundingClientRect().bottom-Be)/t.sliderSize*100}else{const Be=(Ae=(Me=(be=de.touches)==null?void 0:be.item(0))==null?void 0:Me.clientX)!=null?Ae:de.clientX,Ve=p.value.getBoundingClientRect().left;me=(Be-Ve)/t.sliderSize*100}if(!(me<0||me>100))return te(me)};return{elFormItem:d,slider:p,firstButton:_,secondButton:r,sliderDisabled:C,minValue:M,maxValue:k,runwayStyle:B,barStyle:N,resetSize:j,setPosition:te,emitChange:ne,onSliderWrapperPrevent:de=>{var ke,We;((ke=S.firstButton.value)!=null&&ke.dragging||(We=S.secondButton.value)!=null&&We.dragging)&&de.preventDefault()},onSliderClick:de=>{se(de)&&ne()},onSliderDown:async de=>{const ke=se(de);ke&&(await Vn(),ke.value.onButtonDown(de))},onSliderMarkerDown:de=>{C.value||t.dragging||te(de)},setFirstValue:Y,setSecondValue:q}},mle=(e,t,i,a)=>({stops:ee(()=>{if(!e.showStops||e.min>e.max)return[];if(e.step===0)return[];const _=(e.max-e.min)/e.step,r=100*e.step/(e.max-e.min),S=Array.from({length:_-1}).map((C,M)=>(M+1)*r);return e.range?S.filter(C=>C<100*(i.value-e.min)/(e.max-e.min)||C>100*(a.value-e.min)/(e.max-e.min)):S.filter(C=>C>100*(t.firstValue-e.min)/(e.max-e.min))}),getStopStyle:_=>e.vertical?{bottom:`${_}%`}:{left:`${_}%`}}),gle=e=>ee(()=>e.marks?Object.keys(e.marks).map(Number.parseFloat).sort((i,a)=>i-a).filter(i=>i<=e.max&&i>=e.min).map(i=>({point:i,position:(i-e.min)*100/(e.max-e.min),mark:e.marks[i]})):[]),vle=(e,t,i,a,d,p)=>{const _=C=>{d(mr,C),d(Es,C)},r=()=>e.range?![i.value,a.value].every((C,M)=>C===t.oldValue[M]):e.modelValue!==t.oldValue,S=()=>{var C,M;e.min>e.max&&ji("Slider","min should not be greater than max.");const k=e.modelValue;e.range&&ln(k)?k[1]<e.min?_([e.min,e.min]):k[0]>e.max?_([e.max,e.max]):k[0]<e.min?_([e.min,k[1]]):k[1]>e.max?_([k[0],e.max]):(t.firstValue=k[0],t.secondValue=k[1],r()&&(e.validateEvent&&((C=p==null?void 0:p.validate)==null||C.call(p,"change").catch(z=>void 0)),t.oldValue=k.slice())):!e.range&&Gn(k)&&!Number.isNaN(k)&&(k<e.min?_(e.min):k>e.max?_(e.max):(t.firstValue=k,r()&&(e.validateEvent&&((M=p==null?void 0:p.validate)==null||M.call(p,"change").catch(z=>void 0)),t.oldValue=k)))};S(),qt(()=>t.dragging,C=>{C||S()}),qt(()=>e.modelValue,(C,M)=>{t.dragging||ln(C)&&ln(M)&&C.every((k,z)=>k===M[z])&&t.firstValue===C[0]&&t.secondValue===C[1]||S()},{deep:!0}),qt(()=>[e.min,e.max],()=>{S()})},_le=(e,t,i)=>{const a=Se();return gr(async()=>{e.range?(ln(e.modelValue)?(t.firstValue=Math.max(e.min,e.modelValue[0]),t.secondValue=Math.min(e.max,e.modelValue[1])):(t.firstValue=e.min,t.secondValue=e.max),t.oldValue=[t.firstValue,t.secondValue]):(!Gn(e.modelValue)||Number.isNaN(e.modelValue)?t.firstValue=e.min:t.firstValue=Math.min(e.max,Math.max(e.min,e.modelValue)),t.oldValue=t.firstValue),So(window,"resize",i),await Vn(),i()}),{sliderWrapper:a}},yle=qe({name:"ElSlider"}),ble=qe({...yle,props:ole,emits:ile,setup(e,{expose:t,emit:i}){const a=e,d=en("slider"),{t:p}=Gr(),_=lo({firstValue:0,secondValue:0,oldValue:0,dragging:!1,sliderSize:1}),{elFormItem:r,slider:S,firstButton:C,secondButton:M,sliderDisabled:k,minValue:z,maxValue:F,runwayStyle:B,barStyle:N,resetSize:j,emitChange:U,onSliderWrapperPrevent:te,onSliderClick:Y,onSliderDown:q,onSliderMarkerDown:J,setFirstValue:ne,setSecondValue:se}=ple(a,_,i),{stops:fe,getStopStyle:ce}=mle(a,_,z,F),{inputId:le,isLabeledByFormItem:ge}=Al(a,{formItemContext:r}),de=Li(),ke=ee(()=>a.inputSize||de.value),We=ee(()=>a.ariaLabel||p("el.slider.defaultLabel",{min:a.min,max:a.max})),we=ee(()=>a.range?a.rangeStartLabel||p("el.slider.defaultRangeStartLabel"):We.value),be=ee(()=>a.formatValueText?a.formatValueText(Pe.value):`${Pe.value}`),Me=ee(()=>a.rangeEndLabel||p("el.slider.defaultRangeEndLabel")),Ae=ee(()=>a.formatValueText?a.formatValueText(wt.value):`${wt.value}`),me=ee(()=>[d.b(),d.m(de.value),d.is("vertical",a.vertical),{[d.m("with-input")]:a.showInput}]),Be=gle(a);vle(a,_,z,F,i,r);const Ve=ee(()=>{const vt=[a.min,a.max,a.step].map(Bt=>{const Wt=`${Bt}`.split(".")[1];return Wt?Wt.length:0});return Math.max.apply(null,vt)}),{sliderWrapper:bt}=_le(a,_,j),{firstValue:Pe,secondValue:wt,sliderSize:Mt}=Zi(_),Nt=vt=>{_.dragging=vt};return So(bt,"touchstart",te,{passive:!1}),So(bt,"touchmove",te,{passive:!1}),Dr(K4,{...Zi(a),sliderSize:Mt,disabled:k,precision:Ve,emitChange:U,resetSize:j,updateDragging:Nt}),t({onSliderClick:Y}),(vt,Bt)=>{var Wt,Fe;return ae(),Oe("div",{id:vt.range?b(le):void 0,ref_key:"sliderWrapper",ref:bt,class:pe(b(me)),role:vt.range?"group":void 0,"aria-label":vt.range&&!b(ge)?b(We):void 0,"aria-labelledby":vt.range&&b(ge)?(Wt=b(r))==null?void 0:Wt.labelId:void 0},[Ue("div",{ref_key:"slider",ref:S,class:pe([b(d).e("runway"),{"show-input":vt.showInput&&!vt.range},b(d).is("disabled",b(k))]),style:$n(b(B)),onMousedown:b(q),onTouchstartPassive:b(q)},[Ue("div",{class:pe(b(d).e("bar")),style:$n(b(N))},null,6),Ze($R,{id:vt.range?void 0:b(le),ref_key:"firstButton",ref:C,"model-value":b(Pe),vertical:vt.vertical,"tooltip-class":vt.tooltipClass,placement:vt.placement,role:"slider","aria-label":vt.range||!b(ge)?b(we):void 0,"aria-labelledby":!vt.range&&b(ge)?(Fe=b(r))==null?void 0:Fe.labelId:void 0,"aria-valuemin":vt.min,"aria-valuemax":vt.range?b(wt):vt.max,"aria-valuenow":b(Pe),"aria-valuetext":b(be),"aria-orientation":vt.vertical?"vertical":"horizontal","aria-disabled":b(k),"onUpdate:modelValue":b(ne)},null,8,["id","model-value","vertical","tooltip-class","placement","aria-label","aria-labelledby","aria-valuemin","aria-valuemax","aria-valuenow","aria-valuetext","aria-orientation","aria-disabled","onUpdate:modelValue"]),vt.range?(ae(),kt($R,{key:0,ref_key:"secondButton",ref:M,"model-value":b(wt),vertical:vt.vertical,"tooltip-class":vt.tooltipClass,placement:vt.placement,role:"slider","aria-label":b(Me),"aria-valuemin":b(Pe),"aria-valuemax":vt.max,"aria-valuenow":b(wt),"aria-valuetext":b(Ae),"aria-orientation":vt.vertical?"vertical":"horizontal","aria-disabled":b(k),"onUpdate:modelValue":b(se)},null,8,["model-value","vertical","tooltip-class","placement","aria-label","aria-valuemin","aria-valuemax","aria-valuenow","aria-valuetext","aria-orientation","aria-disabled","onUpdate:modelValue"])):yt("v-if",!0),vt.showStops?(ae(),Oe("div",{key:1},[(ae(!0),Oe(Bn,null,Or(b(fe),(cn,Re)=>(ae(),Oe("div",{key:Re,class:pe(b(d).e("stop")),style:$n(b(ce)(cn))},null,6))),128))])):yt("v-if",!0),b(Be).length>0?(ae(),Oe(Bn,{key:2},[Ue("div",null,[(ae(!0),Oe(Bn,null,Or(b(Be),(cn,Re)=>(ae(),Oe("div",{key:Re,style:$n(b(ce)(cn.position)),class:pe([b(d).e("stop"),b(d).e("marks-stop")])},null,6))),128))]),Ue("div",{class:pe(b(d).e("marks"))},[(ae(!0),Oe(Bn,null,Or(b(Be),(cn,Re)=>(ae(),kt(b(fle),{key:Re,mark:cn.mark,style:$n(b(ce)(cn.position)),onMousedown:Qn(nt=>b(J)(cn.position),["stop"])},null,8,["mark","style","onMousedown"]))),128))],2)],64)):yt("v-if",!0)],46,["onMousedown","onTouchstartPassive"]),vt.showInput&&!vt.range?(ae(),kt(b(M4),{key:0,ref:"input","model-value":b(Pe),class:pe(b(d).e("input")),step:vt.step,disabled:b(k),controls:vt.showInputControls,min:vt.min,max:vt.max,precision:b(Ve),debounce:vt.debounce,size:b(ke),"onUpdate:modelValue":b(ne),onChange:b(U)},null,8,["model-value","class","step","disabled","controls","min","max","precision","debounce","size","onUpdate:modelValue","onChange"])):yt("v-if",!0)],10,["id","role","aria-label","aria-labelledby"])}}});var xle=fn(ble,[["__file","slider.vue"]]);const wle=ur(xle),Sle=un({prefixCls:{type:String}}),UR=qe({name:"ElSpaceItem",props:Sle,setup(e,{slots:t}){const i=en("space"),a=ee(()=>`${e.prefixCls||i.b()}__item`);return()=>Kn("div",{class:a.value},pt(t,"default"))}}),jR={small:8,default:12,large:16};function Tle(e){const t=en("space"),i=ee(()=>[t.b(),t.m(e.direction),e.class]),a=Se(0),d=Se(0),p=ee(()=>{const r=e.wrap||e.fill?{flexWrap:"wrap"}:{},S={alignItems:e.alignment},C={rowGap:`${d.value}px`,columnGap:`${a.value}px`};return[r,S,C,e.style]}),_=ee(()=>e.fill?{flexGrow:1,minWidth:`${e.fillRatio}%`}:{});return Cs(()=>{const{size:r="small",wrap:S,direction:C,fill:M}=e;if(ln(r)){const[k=0,z=0]=r;a.value=k,d.value=z}else{let k;Gn(r)?k=r:k=jR[r||"small"]||jR.small,(S||M)&&C==="horizontal"?a.value=d.value=k:C==="horizontal"?(a.value=k,d.value=0):(d.value=k,a.value=0)}}),{classes:i,containerStyle:p,itemStyle:_}}const Cle=un({direction:{type:String,values:["horizontal","vertical"],default:"horizontal"},class:{type:dt([String,Object,Array]),default:""},style:{type:dt([String,Array,Object]),default:""},alignment:{type:dt(String),default:"center"},prefixCls:{type:String},spacer:{type:dt([Object,String,Number,Array]),default:null,validator:e=>Ho(e)||Gn(e)||Dn(e)},wrap:Boolean,fill:Boolean,fillRatio:{type:Number,default:100},size:{type:[String,Array,Number],values:Zc,validator:e=>Gn(e)||ln(e)&&e.length===2&&e.every(Gn)}}),Ele=qe({name:"ElSpace",props:Cle,setup(e,{slots:t}){const{classes:i,containerStyle:a,itemStyle:d}=Tle(e);function p(_,r="",S=[]){const{prefixCls:C}=e;return _.forEach((M,k)=>{oT(M)?ln(M.children)&&M.children.forEach((z,F)=>{oT(z)&&ln(z.children)?p(z.children,`${r+F}-`,S):S.push(Ze(UR,{style:d.value,prefixCls:C,key:`nested-${r+F}`},{default:()=>[z]},vl.PROPS|vl.STYLE,["style","prefixCls"]))}):wJ(M)&&S.push(Ze(UR,{style:d.value,prefixCls:C,key:`LoopKey${r+k}`},{default:()=>[M]},vl.PROPS|vl.STYLE,["style","prefixCls"]))}),S}return()=>{var _;const{spacer:r,direction:S}=e,C=pt(t,"default",{key:0},()=>[]);if(((_=C.children)!=null?_:[]).length===0)return null;if(ln(C.children)){let M=p(C.children);if(r){const k=M.length-1;M=M.reduce((z,F,B)=>{const N=[...z,F];return B!==k&&N.push(Ze("span",{style:[d.value,S==="vertical"?"width: 100%":null],key:B},[Ho(r)?r:Rr(r,vl.TEXT)],vl.STYLE)),N},[])}return Ze("div",{class:i.value,style:a.value},M,vl.STYLE|vl.CLASS)}return C.children}}}),Mle=ur(Ele),Ile=un({decimalSeparator:{type:String,default:"."},groupSeparator:{type:String,default:","},precision:{type:Number,default:0},formatter:Function,value:{type:dt([Number,Object]),default:0},prefix:String,suffix:String,title:String,valueStyle:{type:dt([String,Object,Array])}}),Ale=qe({name:"ElStatistic"}),kle=qe({...Ale,props:Ile,setup(e,{expose:t}){const i=e,a=en("statistic"),d=ee(()=>{const{value:p,formatter:_,precision:r,decimalSeparator:S,groupSeparator:C}=i;if(Nn(_))return _(p);if(!Gn(p)||Number.isNaN(p))return p;let[M,k=""]=String(p).split(".");return k=k.padEnd(r,"0").slice(0,r>0?r:0),M=M.replace(/\B(?=(\d{3})+(?!\d))/g,C),[M,k].join(k?S:"")});return t({displayValue:d}),(p,_)=>(ae(),Oe("div",{class:pe(b(a).b())},[p.$slots.title||p.title?(ae(),Oe("div",{key:0,class:pe(b(a).e("head"))},[pt(p.$slots,"title",{},()=>[Rr(pn(p.title),1)])],2)):yt("v-if",!0),Ue("div",{class:pe(b(a).e("content"))},[p.$slots.prefix||p.prefix?(ae(),Oe("div",{key:0,class:pe(b(a).e("prefix"))},[pt(p.$slots,"prefix",{},()=>[Ue("span",null,pn(p.prefix),1)])],2)):yt("v-if",!0),Ue("span",{class:pe(b(a).e("number")),style:$n(p.valueStyle)},pn(b(d)),7),p.$slots.suffix||p.suffix?(ae(),Oe("div",{key:1,class:pe(b(a).e("suffix"))},[pt(p.$slots,"suffix",{},()=>[Ue("span",null,pn(p.suffix),1)])],2)):yt("v-if",!0)],2)],2))}});var Ple=fn(kle,[["__file","statistic.vue"]]);const Z4=ur(Ple),Rle=un({format:{type:String,default:"HH:mm:ss"},prefix:String,suffix:String,title:String,value:{type:dt([Number,Object]),default:0},valueStyle:{type:dt([String,Object,Array])}}),Ole={finish:()=>!0,[Eo]:e=>Gn(e)},Lle=[["Y",1e3*60*60*24*365],["M",1e3*60*60*24*30],["D",1e3*60*60*24],["H",1e3*60*60],["m",1e3*60],["s",1e3],["S",1]],HR=e=>Gn(e)?new Date(e).getTime():e.valueOf(),GR=(e,t)=>{let i=e;const a=/\[([^\]]*)]/g;return Lle.reduce((p,[_,r])=>{const S=new RegExp(`${_}+(?![^\\[\\]]*\\])`,"g");if(S.test(p)){const C=Math.floor(i/r);return i-=C*r,p.replace(S,M=>String(C).padStart(M.length,"0"))}return p},t).replace(a,"$1")},Dle=qe({name:"ElCountdown"}),zle=qe({...Dle,props:Rle,emits:Ole,setup(e,{expose:t,emit:i}){const a=e;let d;const p=Se(0),_=ee(()=>GR(p.value,a.format)),r=M=>GR(M,a.format),S=()=>{d&&(Lf(d),d=void 0)},C=()=>{const M=HR(a.value),k=()=>{let z=M-Date.now();i("change",z),z<=0?(z=0,S(),i("finish")):d=qd(k),p.value=z};d=qd(k)};return gr(()=>{p.value=HR(a.value)-Date.now(),qt(()=>[a.value,a.format],()=>{S(),C()},{immediate:!0})}),Oo(()=>{S()}),t({displayValue:_}),(M,k)=>(ae(),kt(b(Z4),{value:p.value,title:M.title,prefix:M.prefix,suffix:M.suffix,"value-style":M.valueStyle,formatter:r},Ya({_:2},[Or(M.$slots,(z,F)=>({name:F,fn:st(()=>[pt(M.$slots,F)])}))]),1032,["value","title","prefix","suffix","value-style"]))}});var Fle=fn(zle,[["__file","countdown.vue"]]);const Nle=ur(Fle),Ble=un({space:{type:[Number,String],default:""},active:{type:Number,default:0},direction:{type:String,default:"horizontal",values:["horizontal","vertical"]},alignCenter:{type:Boolean},simple:{type:Boolean},finishStatus:{type:String,values:["wait","process","finish","error","success"],default:"finish"},processStatus:{type:String,values:["wait","process","finish","error","success"],default:"process"}}),Vle={[Eo]:(e,t)=>[e,t].every(Gn)},$le=qe({name:"ElSteps"}),Ule=qe({...$le,props:Ble,emits:Vle,setup(e,{emit:t}){const i=e,a=en("steps"),{children:d,addChild:p,removeChild:_}=yE(wr(),"ElStep");return qt(d,()=>{d.value.forEach((r,S)=>{r.setIndex(S)})}),Dr("ElSteps",{props:i,steps:d,addStep:p,removeStep:_}),qt(()=>i.active,(r,S)=>{t(Eo,r,S)}),(r,S)=>(ae(),Oe("div",{class:pe([b(a).b(),b(a).m(r.simple?"simple":r.direction)])},[pt(r.$slots,"default")],2))}});var jle=fn(Ule,[["__file","steps.vue"]]);const Hle=un({title:{type:String,default:""},icon:{type:Mo},description:{type:String,default:""},status:{type:String,values:["","wait","process","finish","error","success"],default:""}}),Gle=qe({name:"ElStep"}),Wle=qe({...Gle,props:Hle,setup(e){const t=e,i=en("step"),a=Se(-1),d=Se({}),p=Se(""),_=An("ElSteps"),r=wr();gr(()=>{qt([()=>_.props.active,()=>_.props.processStatus,()=>_.props.finishStatus],([ne])=>{q(ne)},{immediate:!0})}),Oo(()=>{_.removeStep(J.uid)});const S=ee(()=>t.status||p.value),C=ee(()=>{const ne=_.steps.value[a.value-1];return ne?ne.currentStatus:"wait"}),M=ee(()=>_.props.alignCenter),k=ee(()=>_.props.direction==="vertical"),z=ee(()=>_.props.simple),F=ee(()=>_.steps.value.length),B=ee(()=>{var ne;return((ne=_.steps.value[F.value-1])==null?void 0:ne.uid)===(r==null?void 0:r.uid)}),N=ee(()=>z.value?"":_.props.space),j=ee(()=>[i.b(),i.is(z.value?"simple":_.props.direction),i.is("flex",B.value&&!N.value&&!M.value),i.is("center",M.value&&!k.value&&!z.value)]),U=ee(()=>{const ne={flexBasis:Gn(N.value)?`${N.value}px`:N.value?N.value:`${100/(F.value-(M.value?0:1))}%`};return k.value||B.value&&(ne.maxWidth=`${100/F.value}%`),ne}),te=ne=>{a.value=ne},Y=ne=>{const se=ne==="wait",fe={transitionDelay:`${se?"-":""}${150*a.value}ms`},ce=ne===_.props.processStatus||se?0:100;fe.borderWidth=ce&&!z.value?"1px":0,fe[_.props.direction==="vertical"?"height":"width"]=`${ce}%`,d.value=fe},q=ne=>{ne>a.value?p.value=_.props.finishStatus:ne===a.value&&C.value!=="error"?p.value=_.props.processStatus:p.value="wait";const se=_.steps.value[a.value-1];se&&se.calcProgress(p.value)},J=lo({uid:r.uid,currentStatus:S,setIndex:te,calcProgress:Y});return _.addStep(J),(ne,se)=>(ae(),Oe("div",{style:$n(b(U)),class:pe(b(j))},[yt(" icon & line "),Ue("div",{class:pe([b(i).e("head"),b(i).is(b(S))])},[b(z)?yt("v-if",!0):(ae(),Oe("div",{key:0,class:pe(b(i).e("line"))},[Ue("i",{class:pe(b(i).e("line-inner")),style:$n(d.value)},null,6)],2)),Ue("div",{class:pe([b(i).e("icon"),b(i).is(ne.icon||ne.$slots.icon?"icon":"text")])},[pt(ne.$slots,"icon",{},()=>[ne.icon?(ae(),kt(b(On),{key:0,class:pe(b(i).e("icon-inner"))},{default:st(()=>[(ae(),kt(Tr(ne.icon)))]),_:1},8,["class"])):b(S)==="success"?(ae(),kt(b(On),{key:1,class:pe([b(i).e("icon-inner"),b(i).is("status")])},{default:st(()=>[Ze(b(xy))]),_:1},8,["class"])):b(S)==="error"?(ae(),kt(b(On),{key:2,class:pe([b(i).e("icon-inner"),b(i).is("status")])},{default:st(()=>[Ze(b(sc))]),_:1},8,["class"])):b(z)?yt("v-if",!0):(ae(),Oe("div",{key:3,class:pe(b(i).e("icon-inner"))},pn(a.value+1),3))])],2)],2),yt(" title & description "),Ue("div",{class:pe(b(i).e("main"))},[Ue("div",{class:pe([b(i).e("title"),b(i).is(b(S))])},[pt(ne.$slots,"title",{},()=>[Rr(pn(ne.title),1)])],2),b(z)?(ae(),Oe("div",{key:0,class:pe(b(i).e("arrow"))},null,2)):(ae(),Oe("div",{key:1,class:pe([b(i).e("description"),b(i).is(b(S))])},[pt(ne.$slots,"description",{},()=>[Rr(pn(ne.description),1)])],2))],2)],6))}});var Y4=fn(Wle,[["__file","item.vue"]]);const qle=ur(jle,{Step:Y4}),Kle=ri(Y4),X4=e=>["",...Zc].includes(e),Zle=un({modelValue:{type:[Boolean,String,Number],default:!1},disabled:Boolean,loading:Boolean,size:{type:String,validator:X4},width:{type:[String,Number],default:""},inlinePrompt:Boolean,inactiveActionIcon:{type:Mo},activeActionIcon:{type:Mo},activeIcon:{type:Mo},inactiveIcon:{type:Mo},activeText:{type:String,default:""},inactiveText:{type:String,default:""},activeValue:{type:[Boolean,String,Number],default:!0},inactiveValue:{type:[Boolean,String,Number],default:!1},name:{type:String,default:""},validateEvent:{type:Boolean,default:!0},beforeChange:{type:dt(Function)},id:String,tabindex:{type:[String,Number]},..._s(["ariaLabel"])}),Yle={[mr]:e=>Ro(e)||Dn(e)||Gn(e),[Eo]:e=>Ro(e)||Dn(e)||Gn(e),[Es]:e=>Ro(e)||Dn(e)||Gn(e)},J4="ElSwitch",Xle=qe({name:J4}),Jle=qe({...Xle,props:Zle,emits:Yle,setup(e,{expose:t,emit:i}){const a=e,{formItem:d}=As(),p=Li(),_=en("switch"),{inputId:r}=Al(a,{formItemContext:d}),S=ks(ee(()=>a.loading)),C=Se(a.modelValue!==!1),M=Se(),k=Se(),z=ee(()=>[_.b(),_.m(p.value),_.is("disabled",S.value),_.is("checked",U.value)]),F=ee(()=>[_.e("label"),_.em("label","left"),_.is("active",!U.value)]),B=ee(()=>[_.e("label"),_.em("label","right"),_.is("active",U.value)]),N=ee(()=>({width:ui(a.width)}));qt(()=>a.modelValue,()=>{C.value=!0});const j=ee(()=>C.value?a.modelValue:!1),U=ee(()=>j.value===a.activeValue);[a.activeValue,a.inactiveValue].includes(j.value)||(i(mr,a.inactiveValue),i(Eo,a.inactiveValue),i(Es,a.inactiveValue)),qt(U,J=>{var ne;M.value.checked=J,a.validateEvent&&((ne=d==null?void 0:d.validate)==null||ne.call(d,"change").catch(se=>void 0))});const te=()=>{const J=U.value?a.inactiveValue:a.activeValue;i(mr,J),i(Eo,J),i(Es,J),Vn(()=>{M.value.checked=U.value})},Y=()=>{if(S.value)return;const{beforeChange:J}=a;if(!J){te();return}const ne=J();[L_(ne),Ro(ne)].includes(!0)||ji(J4,"beforeChange must return type `Promise<boolean>` or `boolean`"),L_(ne)?ne.then(fe=>{fe&&te()}).catch(fe=>{}):ne&&te()},q=()=>{var J,ne;(ne=(J=M.value)==null?void 0:J.focus)==null||ne.call(J)};return gr(()=>{M.value.checked=U.value}),t({focus:q,checked:U}),(J,ne)=>(ae(),Oe("div",{class:pe(b(z)),onClick:Qn(Y,["prevent"])},[Ue("input",{id:b(r),ref_key:"input",ref:M,class:pe(b(_).e("input")),type:"checkbox",role:"switch","aria-checked":b(U),"aria-disabled":b(S),"aria-label":J.ariaLabel,name:J.name,"true-value":J.activeValue,"false-value":J.inactiveValue,disabled:b(S),tabindex:J.tabindex,onChange:te,onKeydown:Po(Y,["enter"])},null,42,["id","aria-checked","aria-disabled","aria-label","name","true-value","false-value","disabled","tabindex","onKeydown"]),!J.inlinePrompt&&(J.inactiveIcon||J.inactiveText)?(ae(),Oe("span",{key:0,class:pe(b(F))},[J.inactiveIcon?(ae(),kt(b(On),{key:0},{default:st(()=>[(ae(),kt(Tr(J.inactiveIcon)))]),_:1})):yt("v-if",!0),!J.inactiveIcon&&J.inactiveText?(ae(),Oe("span",{key:1,"aria-hidden":b(U)},pn(J.inactiveText),9,["aria-hidden"])):yt("v-if",!0)],2)):yt("v-if",!0),Ue("span",{ref_key:"core",ref:k,class:pe(b(_).e("core")),style:$n(b(N))},[J.inlinePrompt?(ae(),Oe("div",{key:0,class:pe(b(_).e("inner"))},[J.activeIcon||J.inactiveIcon?(ae(),kt(b(On),{key:0,class:pe(b(_).is("icon"))},{default:st(()=>[(ae(),kt(Tr(b(U)?J.activeIcon:J.inactiveIcon)))]),_:1},8,["class"])):J.activeText||J.inactiveText?(ae(),Oe("span",{key:1,class:pe(b(_).is("text")),"aria-hidden":!b(U)},pn(b(U)?J.activeText:J.inactiveText),11,["aria-hidden"])):yt("v-if",!0)],2)):yt("v-if",!0),Ue("div",{class:pe(b(_).e("action"))},[J.loading?(ae(),kt(b(On),{key:0,class:pe(b(_).is("loading"))},{default:st(()=>[Ze(b(Hc))]),_:1},8,["class"])):b(U)?pt(J.$slots,"active-action",{key:1},()=>[J.activeActionIcon?(ae(),kt(b(On),{key:0},{default:st(()=>[(ae(),kt(Tr(J.activeActionIcon)))]),_:1})):yt("v-if",!0)]):b(U)?yt("v-if",!0):pt(J.$slots,"inactive-action",{key:2},()=>[J.inactiveActionIcon?(ae(),kt(b(On),{key:0},{default:st(()=>[(ae(),kt(Tr(J.inactiveActionIcon)))]),_:1})):yt("v-if",!0)])],2)],6),!J.inlinePrompt&&(J.activeIcon||J.activeText)?(ae(),Oe("span",{key:1,class:pe(b(B))},[J.activeIcon?(ae(),kt(b(On),{key:0},{default:st(()=>[(ae(),kt(Tr(J.activeIcon)))]),_:1})):yt("v-if",!0),!J.activeIcon&&J.activeText?(ae(),Oe("span",{key:1,"aria-hidden":!b(U)},pn(J.activeText),9,["aria-hidden"])):yt("v-if",!0)],2)):yt("v-if",!0)],10,["onClick"]))}});var Qle=fn(Jle,[["__file","switch.vue"]]);const ece=ur(Qle),gS=function(e){var t;return(t=e.target)==null?void 0:t.closest("td")},tce=function(e,t,i,a,d){if(!t&&!a&&(!d||ln(d)&&!d.length))return e;Dn(i)?i=i==="descending"?-1:1:i=i&&i<0?-1:1;const p=a?null:function(r,S){return d?(ln(d)||(d=[d]),d.map(C=>Dn(C)?Ii(r,C):C(r,S,e))):(t!=="$key"&&yr(r)&&"$value"in r&&(r=r.$value),[yr(r)?Ii(r,t):r])},_=function(r,S){if(a)return a(r.value,S.value);for(let C=0,M=r.key.length;C<M;C++){if(r.key[C]<S.key[C])return-1;if(r.key[C]>S.key[C])return 1}return 0};return e.map((r,S)=>({value:r,index:S,key:p?p(r,S):null})).sort((r,S)=>{let C=_(r,S);return C||(C=r.index-S.index),C*+i}).map(r=>r.value)},Q4=function(e,t){let i=null;return e.columns.forEach(a=>{a.id===t&&(i=a)}),i},nce=function(e,t){let i=null;for(let a=0;a<e.columns.length;a++){const d=e.columns[a];if(d.columnKey===t){i=d;break}}return i||ji("ElTable",`No column matching with column-key: ${t}`),i},WR=function(e,t,i){const a=(t.className||"").match(new RegExp(`${i}-table_[^\\s]+`,"gm"));return a?Q4(e,a[0]):null},$s=(e,t)=>{if(!e)throw new Error("Row is required when get row identity");if(Dn(t)){if(!t.includes("."))return`${e[t]}`;const i=t.split(".");let a=e;for(const d of i)a=a[d];return`${a}`}else if(Nn(t))return t.call(null,e)},R_=function(e,t){const i={};return(e||[]).forEach((a,d)=>{i[$s(a,t)]={row:a,index:d}}),i};function rce(e,t){const i={};let a;for(a in e)i[a]=e[a];for(a in t)if(to(t,a)){const d=t[a];oo(d)||(i[a]=d)}return i}function GE(e){return e===""||oo(e)||(e=Number.parseInt(e,10),Number.isNaN(e)&&(e="")),e}function eN(e){return e===""||oo(e)||(e=GE(e),Number.isNaN(e)&&(e=80)),e}function oce(e){return Gn(e)?e:Dn(e)?/^\d+(?:px)?$/.test(e)?Number.parseInt(e,10):e:null}function ice(...e){return e.length===0?t=>t:e.length===1?e[0]:e.reduce((t,i)=>(...a)=>t(i(...a)))}function L1(e,t,i,a,d,p){let _=p??0,r=!1;const S=e.indexOf(t),C=S!==-1,M=d==null?void 0:d.call(null,t,_),k=F=>{F==="add"?e.push(t):e.splice(S,1),r=!0},z=F=>{let B=0;const N=(a==null?void 0:a.children)&&F[a.children];return N&&ln(N)&&(B+=N.length,N.forEach(j=>{B+=z(j)})),B};return(!d||M)&&(Ro(i)?i&&!C?k("add"):!i&&C&&k("remove"):k(C?"remove":"add")),!(a!=null&&a.checkStrictly)&&(a!=null&&a.children)&&ln(t[a.children])&&t[a.children].forEach(F=>{const B=L1(e,F,i??!C,a,d,_+1);_+=z(F)+1,B&&(r=B)}),r}function sce(e,t,i="children",a="hasChildren"){const d=_=>!(ln(_)&&_.length);function p(_,r,S){t(_,r,S),r.forEach(C=>{if(C[a]){t(C,null,S+1);return}const M=C[i];d(M)||p(C,M,S+1)})}e.forEach(_=>{if(_[a]){t(_,null,0);return}const r=_[i];d(r)||p(_,r,0)})}const ace=(e,t,i,a)=>{const d={strategy:"fixed",...e.popperOptions},p=Nn(a.tooltipFormatter)?a.tooltipFormatter({row:i,column:a,cellValue:M_(i,a.property).value}):void 0;return Ho(p)?{slotContent:p,content:null,...e,popperOptions:d}:{slotContent:null,content:p??t,...e,popperOptions:d}};let Ea=null;function lce(e,t,i,a,d,p){const _=ace(e,t,i,a),r={..._,slotContent:void 0};if((Ea==null?void 0:Ea.trigger)===d){const F=Ea.vm.component;az(F.props,r),_.slotContent&&(F.slots.content=()=>[_.slotContent]);return}Ea==null||Ea();const S=p==null?void 0:p.refs.tableWrapper,C=S==null?void 0:S.dataset.prefix,M=Ze(Is,{virtualTriggering:!0,virtualRef:d,appendTo:S,placement:"top",transition:"none",offset:0,hideAfter:0,...r},_.slotContent?{content:()=>_.slotContent}:void 0);M.appContext={...p.appContext,...p};const k=document.createElement("div");Gd(M,k),M.component.exposed.onOpen();const z=S==null?void 0:S.querySelector(`.${C}-scrollbar__wrap`);Ea=()=>{Gd(null,k),z==null||z.removeEventListener("scroll",Ea),Ea=null},Ea.trigger=d,Ea.vm=M,z==null||z.addEventListener("scroll",Ea)}function tN(e){return e.children?bq(e.children,tN):[e]}function qR(e,t){return e+t.colSpan}const nN=(e,t,i,a)=>{let d=0,p=e;const _=i.states.columns.value;if(a){const S=tN(a[e]);d=_.slice(0,_.indexOf(S[0])).reduce(qR,0),p=d+S.reduce(qR,0)-1}else d=e;let r;switch(t){case"left":p<i.states.fixedLeafColumnsLength.value&&(r="left");break;case"right":d>=_.length-i.states.rightFixedLeafColumnsLength.value&&(r="right");break;default:p<i.states.fixedLeafColumnsLength.value?r="left":d>=_.length-i.states.rightFixedLeafColumnsLength.value&&(r="right")}return r?{direction:r,start:d,after:p}:{}},WE=(e,t,i,a,d,p=0)=>{const _=[],{direction:r,start:S,after:C}=nN(t,i,a,d);if(r){const M=r==="left";_.push(`${e}-fixed-column--${r}`),M&&C+p===a.states.fixedLeafColumnsLength.value-1?_.push("is-last-column"):!M&&S-p===a.states.columns.value.length-a.states.rightFixedLeafColumnsLength.value&&_.push("is-first-column")}return _};function KR(e,t){return e+(yy(t.realWidth)||Number.isNaN(t.realWidth)?Number(t.width):t.realWidth)}const qE=(e,t,i,a)=>{const{direction:d,start:p=0,after:_=0}=nN(e,t,i,a);if(!d)return;const r={},S=d==="left",C=i.states.columns.value;return S?r.left=C.slice(0,p).reduce(KR,0):r.right=C.slice(_+1).reverse().reduce(KR,0),r},Nm=(e,t)=>{e&&(Number.isNaN(e[t])||(e[t]=`${e[t]}px`))};function cce(e){const t=wr(),i=Se(!1),a=Se([]);return{updateExpandRows:()=>{const S=e.data.value||[],C=e.rowKey.value;if(i.value)a.value=S.slice();else if(C){const M=R_(a.value,C);a.value=S.reduce((k,z)=>{const F=$s(z,C);return M[F]&&k.push(z),k},[])}else a.value=[]},toggleRowExpansion:(S,C)=>{L1(a.value,S,C)&&t.emit("expand-change",S,a.value.slice())},setExpandRowKeys:S=>{t.store.assertRowKey();const C=e.data.value||[],M=e.rowKey.value,k=R_(C,M);a.value=S.reduce((z,F)=>{const B=k[F];return B&&z.push(B.row),z},[])},isRowExpanded:S=>{const C=e.rowKey.value;return C?!!R_(a.value,C)[$s(S,C)]:a.value.includes(S)},states:{expandRows:a,defaultExpandAll:i}}}function uce(e){const t=wr(),i=Se(null),a=Se(null),d=C=>{t.store.assertRowKey(),i.value=C,_(C)},p=()=>{i.value=null},_=C=>{const{data:M,rowKey:k}=e;let z=null;k.value&&(z=(b(M)||[]).find(F=>$s(F,k.value)===C)),a.value=z,t.emit("current-change",a.value,null)};return{setCurrentRowKey:d,restoreCurrentRowKey:p,setCurrentRowByKey:_,updateCurrentRow:C=>{const M=a.value;if(C&&C!==M){a.value=C,t.emit("current-change",a.value,M);return}!C&&M&&(a.value=null,t.emit("current-change",null,M))},updateCurrentRowData:()=>{const C=e.rowKey.value,M=e.data.value||[],k=a.value;if(!M.includes(k)&&k){if(C){const z=$s(k,C);_(z)}else a.value=null;yy(a.value)&&t.emit("current-change",null,k)}else i.value&&(_(i.value),p())},states:{_currentRowKey:i,currentRow:a}}}function dce(e){const t=Se([]),i=Se({}),a=Se(16),d=Se(!1),p=Se({}),_=Se("hasChildren"),r=Se("children"),S=Se(!1),C=wr(),M=ee(()=>{if(!e.rowKey.value)return{};const q=e.data.value||[];return z(q)}),k=ee(()=>{const q=e.rowKey.value,J=Object.keys(p.value),ne={};return J.length&&J.forEach(se=>{if(p.value[se].length){const fe={children:[]};p.value[se].forEach(ce=>{const le=$s(ce,q);fe.children.push(le),ce[_.value]&&!ne[le]&&(ne[le]={children:[]})}),ne[se]=fe}}),ne}),z=q=>{const J=e.rowKey.value,ne={};return sce(q,(se,fe,ce)=>{const le=$s(se,J);ln(fe)?ne[le]={children:fe.map(ge=>$s(ge,J)),level:ce}:d.value&&(ne[le]={children:[],lazy:!0,level:ce})},r.value,_.value),ne},F=(q=!1,J=(ne=>(ne=C.store)==null?void 0:ne.states.defaultExpandAll.value)())=>{var ne;const se=M.value,fe=k.value,ce=Object.keys(se),le={};if(ce.length){const ge=b(i),de=[],ke=(we,be)=>{if(q)return t.value?J||t.value.includes(be):!!(J||we!=null&&we.expanded);{const Me=J||t.value&&t.value.includes(be);return!!(we!=null&&we.expanded||Me)}};ce.forEach(we=>{const be=ge[we],Me={...se[we]};if(Me.expanded=ke(be,we),Me.lazy){const{loaded:Ae=!1,loading:me=!1}=be||{};Me.loaded=!!Ae,Me.loading=!!me,de.push(we)}le[we]=Me});const We=Object.keys(fe);d.value&&We.length&&de.length&&We.forEach(we=>{const be=ge[we],Me=fe[we].children;if(de.includes(we)){if(le[we].children.length!==0)throw new Error("[ElTable]children must be an empty array.");le[we].children=Me}else{const{loaded:Ae=!1,loading:me=!1}=be||{};le[we]={lazy:!0,loaded:!!Ae,loading:!!me,expanded:ke(be,we),children:Me,level:""}}})}i.value=le,(ne=C.store)==null||ne.updateTableScrollY()};qt(()=>t.value,()=>{F(!0)}),qt(()=>M.value,()=>{F()}),qt(()=>k.value,()=>{F()});const B=q=>{t.value=q,F()},N=q=>d.value&&q&&"loaded"in q&&!q.loaded,j=(q,J)=>{C.store.assertRowKey();const ne=e.rowKey.value,se=$s(q,ne),fe=se&&i.value[se];if(se&&fe&&"expanded"in fe){const ce=fe.expanded;J=oo(J)?!fe.expanded:J,i.value[se].expanded=J,ce!==J&&C.emit("expand-change",q,J),N(fe)&&te(q,se,fe),C.store.updateTableScrollY()}},U=q=>{C.store.assertRowKey();const J=e.rowKey.value,ne=$s(q,J),se=i.value[ne];N(se)?te(q,ne,se):j(q,void 0)},te=(q,J,ne)=>{const{load:se}=C.props;se&&!i.value[J].loaded&&(i.value[J].loading=!0,se(q,ne,fe=>{if(!ln(fe))throw new TypeError("[ElTable] data must be an array");i.value[J].loading=!1,i.value[J].loaded=!0,i.value[J].expanded=!0,fe.length&&(p.value[J]=fe),C.emit("expand-change",q,!0)}))};return{loadData:te,loadOrToggle:U,toggleTreeExpansion:j,updateTreeExpandKeys:B,updateTreeData:F,updateKeyChildren:(q,J)=>{const{lazy:ne,rowKey:se}=C.props;if(ne){if(!se)throw new Error("[Table] rowKey is required in updateKeyChild");p.value[q]&&(p.value[q]=J)}},normalize:z,states:{expandRowKeys:t,treeData:i,indent:a,lazy:d,lazyTreeNodeMap:p,lazyColumnIdentifier:_,childrenColumnName:r,checkStrictly:S}}}const hce=(e,t)=>{const i=t.sortingColumn;return!i||Dn(i.sortable)?e:tce(e,t.sortProp,t.sortOrder,i.sortMethod,i.sortBy)},Xb=e=>{const t=[];return e.forEach(i=>{i.children&&i.children.length>0?t.push.apply(t,Xb(i.children)):t.push(i)}),t};function fce(){var e;const t=wr(),{size:i}=Zi((e=t.proxy)==null?void 0:e.$props),a=Se(null),d=Se([]),p=Se([]),_=Se(!1),r=Se([]),S=Se([]),C=Se([]),M=Se([]),k=Se([]),z=Se([]),F=Se([]),B=Se([]),N=[],j=Se(0),U=Se(0),te=Se(0),Y=Se(!1),q=Se([]),J=Se(!1),ne=Se(!1),se=Se(null),fe=Se({}),ce=Se(null),le=Se(null),ge=Se(null),de=Se(null),ke=Se(null),We=ee(()=>a.value?R_(q.value,a.value):void 0);qt(d,()=>{var jn;t.state&&(Ae(!1),t.props.tableLayout==="auto"&&((jn=t.refs.tableHeaderRef)==null||jn.updateFixedColumnStyle()))},{deep:!0});const we=()=>{if(!a.value)throw new Error("[ElTable] prop row-key is required")},be=jn=>{var Gt;(Gt=jn.children)==null||Gt.forEach(ct=>{ct.fixed=jn.fixed,be(ct)})},Me=()=>{var jn,Gt;r.value.forEach(sr=>{be(sr)}),M.value=r.value.filter(sr=>sr.type!=="selection"&&[!0,"left"].includes(sr.fixed));let ct;if(((Gt=(jn=r.value)==null?void 0:jn[0])==null?void 0:Gt.type)==="selection"){const sr=r.value[0];ct=[!0,"left"].includes(sr.fixed)||M.value.length&&sr.fixed!=="right",ct&&M.value.unshift(sr)}k.value=r.value.filter(sr=>sr.fixed==="right");const Ut=r.value.filter(sr=>(ct?sr.type!=="selection":!0)&&!sr.fixed);S.value=[].concat(M.value).concat(Ut).concat(k.value);const tt=Xb(Ut),yn=Xb(M.value),wn=Xb(k.value);j.value=tt.length,U.value=yn.length,te.value=wn.length,C.value=[].concat(yn).concat(tt).concat(wn),_.value=M.value.length>0||k.value.length>0},Ae=(jn,Gt=!1)=>{jn&&Me(),Gt?t.state.doLayout():t.state.debouncedUpdateLayout()},me=jn=>We.value?!!We.value[$s(jn,a.value)]:q.value.includes(jn),Be=()=>{Y.value=!1;const jn=q.value;q.value=[],jn.length&&t.emit("selection-change",[])},Ve=()=>{let jn;if(a.value){jn=[];const Gt=R_(d.value,a.value);for(const ct in We.value)to(We.value,ct)&&!Gt[ct]&&jn.push(We.value[ct].row)}else jn=q.value.filter(Gt=>!d.value.includes(Gt));if(jn.length){const Gt=q.value.filter(ct=>!jn.includes(ct));q.value=Gt,t.emit("selection-change",Gt.slice())}},bt=()=>(q.value||[]).slice(),Pe=(jn,Gt,ct=!0,Ut=!1)=>{var tt,yn,wn,sr;const vo={children:(yn=(tt=t==null?void 0:t.store)==null?void 0:tt.states)==null?void 0:yn.childrenColumnName.value,checkStrictly:(sr=(wn=t==null?void 0:t.store)==null?void 0:wn.states)==null?void 0:sr.checkStrictly.value};if(L1(q.value,jn,Gt,vo,Ut?void 0:se.value,d.value.indexOf(jn))){const Go=(q.value||[]).slice();ct&&t.emit("select",Go,jn),t.emit("selection-change",Go)}},wt=()=>{var jn,Gt;const ct=ne.value?!Y.value:!(Y.value||q.value.length);Y.value=ct;let Ut=!1,tt=0;const yn=(Gt=(jn=t==null?void 0:t.store)==null?void 0:jn.states)==null?void 0:Gt.rowKey.value,{childrenColumnName:wn}=t.store.states,sr={children:wn.value,checkStrictly:!1};d.value.forEach((vo,jo)=>{const Go=jo+tt;L1(q.value,vo,ct,sr,se.value,Go)&&(Ut=!0),tt+=vt($s(vo,yn))}),Ut&&t.emit("selection-change",q.value?q.value.slice():[]),t.emit("select-all",(q.value||[]).slice())},Mt=()=>{d.value.forEach(jn=>{const Gt=$s(jn,a.value),ct=We.value[Gt];ct&&(q.value[ct.index]=jn)})},Nt=()=>{var jn;if(((jn=d.value)==null?void 0:jn.length)===0){Y.value=!1;return}const{childrenColumnName:Gt}=t.store.states;let ct=0,Ut=0;const tt=wn=>{var sr;for(const vo of wn){const jo=se.value&&se.value.call(null,vo,ct);if(me(vo))Ut++;else if(!se.value||jo)return!1;if(ct++,(sr=vo[Gt.value])!=null&&sr.length&&!tt(vo[Gt.value]))return!1}return!0},yn=tt(d.value||[]);Y.value=Ut===0?!1:yn},vt=jn=>{var Gt;if(!t||!t.store)return 0;const{treeData:ct}=t.store.states;let Ut=0;const tt=(Gt=ct.value[jn])==null?void 0:Gt.children;return tt&&(Ut+=tt.length,tt.forEach(yn=>{Ut+=vt(yn)})),Ut},Bt=(jn,Gt)=>{ln(jn)||(jn=[jn]);const ct={};return jn.forEach(Ut=>{fe.value[Ut.id]=Gt,ct[Ut.columnKey||Ut.id]=Gt}),ct},Wt=(jn,Gt,ct)=>{le.value&&le.value!==jn&&(le.value.order=null),le.value=jn,ge.value=Gt,de.value=ct},Fe=()=>{let jn=b(p);Object.keys(fe.value).forEach(Gt=>{const ct=fe.value[Gt];if(!ct||ct.length===0)return;const Ut=Q4({columns:C.value},Gt);Ut&&Ut.filterMethod&&(jn=jn.filter(tt=>ct.some(yn=>Ut.filterMethod.call(null,yn,tt,Ut))))}),ce.value=jn},cn=()=>{d.value=hce(ce.value,{sortingColumn:le.value,sortProp:ge.value,sortOrder:de.value})},Re=(jn=void 0)=>{jn&&jn.filter||Fe(),cn()},nt=jn=>{const{tableHeaderRef:Gt}=t.refs;if(!Gt)return;const ct=Object.assign({},Gt.filterPanels),Ut=Object.keys(ct);if(Ut.length)if(Dn(jn)&&(jn=[jn]),ln(jn)){const tt=jn.map(yn=>nce({columns:C.value},yn));Ut.forEach(yn=>{const wn=tt.find(sr=>sr.id===yn);wn&&(wn.filteredValue=[])}),t.store.commit("filterChange",{column:tt,values:[],silent:!0,multi:!0})}else Ut.forEach(tt=>{const yn=C.value.find(wn=>wn.id===tt);yn&&(yn.filteredValue=[])}),fe.value={},t.store.commit("filterChange",{column:{},values:[],silent:!0})},Qe=()=>{le.value&&(Wt(null,null,null),t.store.commit("changeSortCondition",{silent:!0}))},{setExpandRowKeys:Yt,toggleRowExpansion:Xt,updateExpandRows:$t,states:Ot,isRowExpanded:Ft}=cce({data:d,rowKey:a}),{updateTreeExpandKeys:sn,toggleTreeExpansion:an,updateTreeData:Pn,updateKeyChildren:bn,loadOrToggle:It,states:Sn}=dce({data:d,rowKey:a}),{updateCurrentRowData:Yn,updateCurrentRow:vr,setCurrentRowKey:tr,states:zr}=uce({data:d,rowKey:a});return{assertRowKey:we,updateColumns:Me,scheduleLayout:Ae,isSelected:me,clearSelection:Be,cleanSelection:Ve,getSelectionRows:bt,toggleRowSelection:Pe,_toggleAllSelection:wt,toggleAllSelection:null,updateSelectionByRowKey:Mt,updateAllSelected:Nt,updateFilters:Bt,updateCurrentRow:vr,updateSort:Wt,execFilter:Fe,execSort:cn,execQuery:Re,clearFilter:nt,clearSort:Qe,toggleRowExpansion:Xt,setExpandRowKeysAdapter:jn=>{Yt(jn),sn(jn)},setCurrentRowKey:tr,toggleRowExpansionAdapter:(jn,Gt)=>{C.value.some(({type:Ut})=>Ut==="expand")?Xt(jn,Gt):an(jn,Gt)},isRowExpanded:Ft,updateExpandRows:$t,updateCurrentRowData:Yn,loadOrToggle:It,updateTreeData:Pn,updateKeyChildren:bn,states:{tableSize:i,rowKey:a,data:d,_data:p,isComplex:_,_columns:r,originColumns:S,columns:C,fixedColumns:M,rightFixedColumns:k,leafColumns:z,fixedLeafColumns:F,rightFixedLeafColumns:B,updateOrderFns:N,leafColumnsLength:j,fixedLeafColumnsLength:U,rightFixedLeafColumnsLength:te,isAllSelected:Y,selection:q,reserveSelection:J,selectOnIndeterminate:ne,selectable:se,filters:fe,filteredData:ce,sortingColumn:le,sortProp:ge,sortOrder:de,hoverRow:ke,...Ot,...Sn,...zr}}}function AT(e,t){return e.map(i=>{var a;return i.id===t.id?t:((a=i.children)!=null&&a.length&&(i.children=AT(i.children,t)),i)})}function kT(e){e.forEach(t=>{var i,a;t.no=(i=t.getColumnIndex)==null?void 0:i.call(t),(a=t.children)!=null&&a.length&&kT(t.children)}),e.sort((t,i)=>t.no-i.no)}function pce(){const e=wr(),t=fce();return{ns:en("table"),...t,mutations:{setData(_,r){const S=b(_._data)!==r;_.data.value=r,_._data.value=r,e.store.execQuery(),e.store.updateCurrentRowData(),e.store.updateExpandRows(),e.store.updateTreeData(e.store.states.defaultExpandAll.value),b(_.reserveSelection)?(e.store.assertRowKey(),e.store.updateSelectionByRowKey()):S?e.store.clearSelection():e.store.cleanSelection(),e.store.updateAllSelected(),e.$ready&&e.store.scheduleLayout()},insertColumn(_,r,S,C){const M=b(_._columns);let k=[];S?(S&&!S.children&&(S.children=[]),S.children.push(r),k=AT(M,S)):(M.push(r),k=M),kT(k),_._columns.value=k,_.updateOrderFns.push(C),r.type==="selection"&&(_.selectable.value=r.selectable,_.reserveSelection.value=r.reserveSelection),e.$ready&&(e.store.updateColumns(),e.store.scheduleLayout())},updateColumnOrder(_,r){var S;((S=r.getColumnIndex)==null?void 0:S.call(r))!==r.no&&(kT(_._columns.value),e.$ready&&e.store.updateColumns())},removeColumn(_,r,S,C){const M=b(_._columns)||[];if(S)S.children.splice(S.children.findIndex(z=>z.id===r.id),1),Vn(()=>{var z;((z=S.children)==null?void 0:z.length)===0&&delete S.children}),_._columns.value=AT(M,S);else{const z=M.indexOf(r);z>-1&&(M.splice(z,1),_._columns.value=M)}const k=_.updateOrderFns.indexOf(C);k>-1&&_.updateOrderFns.splice(k,1),e.$ready&&(e.store.updateColumns(),e.store.scheduleLayout())},sort(_,r){const{prop:S,order:C,init:M}=r;if(S){const k=b(_.columns).find(z=>z.property===S);k&&(k.order=C,e.store.updateSort(k,S,C),e.store.commit("changeSortCondition",{init:M}))}},changeSortCondition(_,r){const{sortingColumn:S,sortProp:C,sortOrder:M}=_,k=b(S),z=b(C),F=b(M);yy(F)&&(_.sortingColumn.value=null,_.sortProp.value=null);const B={filter:!0};e.store.execQuery(B),(!r||!(r.silent||r.init))&&e.emit("sort-change",{column:k,prop:z,order:F}),e.store.updateTableScrollY()},filterChange(_,r){const{column:S,values:C,silent:M}=r,k=e.store.updateFilters(S,C);e.store.execQuery(),M||e.emit("filter-change",k),e.store.updateTableScrollY()},toggleAllSelection(){e.store.toggleAllSelection()},rowSelectedChanged(_,r){e.store.toggleRowSelection(r),e.store.updateAllSelected()},setHoverRow(_,r){_.hoverRow.value=r},setCurrentRow(_,r){e.store.updateCurrentRow(r)}},commit:function(_,...r){const S=e.store.mutations;if(S[_])S[_].apply(e,[e.store.states].concat(r));else throw new Error(`Action not found: ${_}`)},updateTableScrollY:function(){Vn(()=>e.layout.updateScrollY.apply(e.layout))}}}const O_={rowKey:"rowKey",defaultExpandAll:"defaultExpandAll",selectOnIndeterminate:"selectOnIndeterminate",indent:"indent",lazy:"lazy",data:"data","treeProps.hasChildren":{key:"lazyColumnIdentifier",default:"hasChildren"},"treeProps.children":{key:"childrenColumnName",default:"children"},"treeProps.checkStrictly":{key:"checkStrictly",default:!1}};function mce(e,t){if(!e)throw new Error("Table is required.");const i=pce();return i.toggleAllSelection=Ra(i._toggleAllSelection,10),Object.keys(O_).forEach(a=>{rN(oN(t,a),a,i)}),gce(i,t),i}function gce(e,t){Object.keys(O_).forEach(i=>{qt(()=>oN(t,i),a=>{rN(a,i,e)})})}function rN(e,t,i){let a=e,d=O_[t];yr(O_[t])&&(d=d.key,a=a||O_[t].default),i.states[d].value=a}function oN(e,t){if(t.includes(".")){const i=t.split(".");let a=e;return i.forEach(d=>{a=a[d]}),a}else return e[t]}class vce{constructor(t){this.observers=[],this.table=null,this.store=null,this.columns=[],this.fit=!0,this.showHeader=!0,this.height=Se(null),this.scrollX=Se(!1),this.scrollY=Se(!1),this.bodyWidth=Se(null),this.fixedWidth=Se(null),this.rightFixedWidth=Se(null),this.gutterWidth=0;for(const i in t)to(t,i)&&(To(this[i])?this[i].value=t[i]:this[i]=t[i]);if(!this.table)throw new Error("Table is required for Table Layout");if(!this.store)throw new Error("Store is required for Table Layout")}updateScrollY(){const t=this.height.value;if(yy(t))return!1;const i=this.table.refs.scrollBarRef;if(this.table.vnode.el&&(i!=null&&i.wrapRef)){let a=!0;const d=this.scrollY.value;return a=i.wrapRef.scrollHeight>i.wrapRef.clientHeight,this.scrollY.value=a,d!==a}return!1}setHeight(t,i="height"){if(!Hr)return;const a=this.table.vnode.el;if(t=oce(t),this.height.value=Number(t),!a&&(t||t===0))return Vn(()=>this.setHeight(t,i));Gn(t)?(a.style[i]=`${t}px`,this.updateElsHeight()):Dn(t)&&(a.style[i]=t,this.updateElsHeight())}setMaxHeight(t){this.setHeight(t,"max-height")}getFlattenColumns(){const t=[];return this.table.store.states.columns.value.forEach(a=>{a.isColumnGroup?t.push.apply(t,a.columns):t.push(a)}),t}updateElsHeight(){this.updateScrollY(),this.notifyObservers("scrollable")}headerDisplayNone(t){if(!t)return!0;let i=t;for(;i.tagName!=="DIV";){if(getComputedStyle(i).display==="none")return!0;i=i.parentElement}return!1}updateColumnsWidth(){if(!Hr)return;const t=this.fit,i=this.table.vnode.el.clientWidth;let a=0;const d=this.getFlattenColumns(),p=d.filter(S=>!Gn(S.width));if(d.forEach(S=>{Gn(S.width)&&S.realWidth&&(S.realWidth=null)}),p.length>0&&t){if(d.forEach(S=>{a+=Number(S.width||S.minWidth||80)}),a<=i){this.scrollX.value=!1;const S=i-a;if(p.length===1)p[0].realWidth=Number(p[0].minWidth||80)+S;else{const C=p.reduce((z,F)=>z+Number(F.minWidth||80),0),M=S/C;let k=0;p.forEach((z,F)=>{if(F===0)return;const B=Math.floor(Number(z.minWidth||80)*M);k+=B,z.realWidth=Number(z.minWidth||80)+B}),p[0].realWidth=Number(p[0].minWidth||80)+S-k}}else this.scrollX.value=!0,p.forEach(S=>{S.realWidth=Number(S.minWidth)});this.bodyWidth.value=Math.max(a,i),this.table.state.resizeState.value.width=this.bodyWidth.value}else d.forEach(S=>{!S.width&&!S.minWidth?S.realWidth=80:S.realWidth=Number(S.width||S.minWidth),a+=S.realWidth}),this.scrollX.value=a>i,this.bodyWidth.value=a;const _=this.store.states.fixedColumns.value;if(_.length>0){let S=0;_.forEach(C=>{S+=Number(C.realWidth||C.width)}),this.fixedWidth.value=S}const r=this.store.states.rightFixedColumns.value;if(r.length>0){let S=0;r.forEach(C=>{S+=Number(C.realWidth||C.width)}),this.rightFixedWidth.value=S}this.notifyObservers("columns")}addObserver(t){this.observers.push(t)}removeObserver(t){const i=this.observers.indexOf(t);i!==-1&&this.observers.splice(i,1)}notifyObservers(t){this.observers.forEach(a=>{var d,p;switch(t){case"columns":(d=a.state)==null||d.onColumnsChange(this);break;case"scrollable":(p=a.state)==null||p.onScrollableChange(this);break;default:throw new Error(`Table Layout don't have event ${t}.`)}})}}const{CheckboxGroup:_ce}=Il,yce=qe({name:"ElTableFilterPanel",components:{ElCheckbox:Il,ElCheckboxGroup:_ce,ElScrollbar:Yc,ElTooltip:Is,ElIcon:On,ArrowDown:Gu,ArrowUp:JC},directives:{ClickOutside:Bu},props:{placement:{type:String,default:"bottom-start"},store:{type:Object},column:{type:Object},upDataColumn:{type:Function},appendTo:{type:String}},setup(e){const t=wr(),{t:i}=Gr(),a=en("table-filter"),d=t==null?void 0:t.parent;d.filterPanels.value[e.column.id]||(d.filterPanels.value[e.column.id]=t);const p=Se(!1),_=Se(null),r=ee(()=>e.column&&e.column.filters),S=ee(()=>e.column.filterClassName?`${a.b()} ${e.column.filterClassName}`:a.b()),C=ee({get:()=>{var J;return(((J=e.column)==null?void 0:J.filteredValue)||[])[0]},set:J=>{M.value&&(rc(J)?M.value.splice(0,1):M.value.splice(0,1,J))}}),M=ee({get(){return e.column?e.column.filteredValue||[]:[]},set(J){e.column&&e.upDataColumn("filteredValue",J)}}),k=ee(()=>e.column?e.column.filterMultiple:!0),z=J=>J.value===C.value,F=()=>{p.value=!1},B=J=>{J.stopPropagation(),p.value=!p.value},N=()=>{p.value=!1},j=()=>{Y(M.value),F()},U=()=>{M.value=[],Y(M.value),F()},te=J=>{C.value=J,rc(J)?Y([]):Y(M.value),F()},Y=J=>{e.store.commit("filterChange",{column:e.column,values:J}),e.store.updateAllSelected()};qt(p,J=>{e.column&&e.upDataColumn("filterOpened",J)},{immediate:!0});const q=ee(()=>{var J,ne;return(ne=(J=_.value)==null?void 0:J.popperRef)==null?void 0:ne.contentRef});return{tooltipVisible:p,multiple:k,filterClassName:S,filteredValue:M,filterValue:C,filters:r,handleConfirm:j,handleReset:U,handleSelect:te,isPropAbsent:rc,isActive:z,t:i,ns:a,showFilterPanel:B,hideFilterPanel:N,popperPaneRef:q,tooltip:_}}});function bce(e,t,i,a,d,p){const _=Er("el-checkbox"),r=Er("el-checkbox-group"),S=Er("el-scrollbar"),C=Er("arrow-up"),M=Er("arrow-down"),k=Er("el-icon"),z=Er("el-tooltip"),F=J1("click-outside");return ae(),kt(z,{ref:"tooltip",visible:e.tooltipVisible,offset:0,placement:e.placement,"show-arrow":!1,"stop-popper-mouse-event":!1,teleported:"",effect:"light",pure:"","popper-class":e.filterClassName,persistent:"","append-to":e.appendTo},{content:st(()=>[e.multiple?(ae(),Oe("div",{key:0},[Ue("div",{class:pe(e.ns.e("content"))},[Ze(S,{"wrap-class":e.ns.e("wrap")},{default:st(()=>[Ze(r,{modelValue:e.filteredValue,"onUpdate:modelValue":B=>e.filteredValue=B,class:pe(e.ns.e("checkbox-group"))},{default:st(()=>[(ae(!0),Oe(Bn,null,Or(e.filters,B=>(ae(),kt(_,{key:B.value,value:B.value},{default:st(()=>[Rr(pn(B.text),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue","onUpdate:modelValue","class"])]),_:1},8,["wrap-class"])],2),Ue("div",{class:pe(e.ns.e("bottom"))},[Ue("button",{class:pe({[e.ns.is("disabled")]:e.filteredValue.length===0}),disabled:e.filteredValue.length===0,type:"button",onClick:e.handleConfirm},pn(e.t("el.table.confirmFilter")),11,["disabled","onClick"]),Ue("button",{type:"button",onClick:e.handleReset},pn(e.t("el.table.resetFilter")),9,["onClick"])],2)])):(ae(),Oe("ul",{key:1,class:pe(e.ns.e("list"))},[Ue("li",{class:pe([e.ns.e("list-item"),{[e.ns.is("active")]:e.isPropAbsent(e.filterValue)}]),onClick:B=>e.handleSelect(null)},pn(e.t("el.table.clearFilter")),11,["onClick"]),(ae(!0),Oe(Bn,null,Or(e.filters,B=>(ae(),Oe("li",{key:B.value,class:pe([e.ns.e("list-item"),e.ns.is("active",e.isActive(B))]),label:B.value,onClick:N=>e.handleSelect(B.value)},pn(B.text),11,["label","onClick"]))),128))],2))]),default:st(()=>[hr((ae(),Oe("span",{class:pe([`${e.ns.namespace.value}-table__column-filter-trigger`,`${e.ns.namespace.value}-none-outline`]),onClick:e.showFilterPanel},[Ze(k,null,{default:st(()=>[pt(e.$slots,"filter-icon",{},()=>[e.column.filterOpened?(ae(),kt(C,{key:0})):(ae(),kt(M,{key:1}))])]),_:3})],10,["onClick"])),[[F,e.hideFilterPanel,e.popperPaneRef]])]),_:3},8,["visible","placement","popper-class","append-to"])}var xce=fn(yce,[["render",bce],["__file","filter-panel.vue"]]);function KE(e){const t=wr();fy(()=>{i.value.addObserver(t)}),gr(()=>{a(i.value),d(i.value)}),hc(()=>{a(i.value),d(i.value)}),th(()=>{i.value.removeObserver(t)});const i=ee(()=>{const p=e.layout;if(!p)throw new Error("Can not find table layout.");return p}),a=p=>{var _;const r=((_=e.vnode.el)==null?void 0:_.querySelectorAll("colgroup > col"))||[];if(!r.length)return;const S=p.getFlattenColumns(),C={};S.forEach(M=>{C[M.id]=M});for(let M=0,k=r.length;M<k;M++){const z=r[M],F=z.getAttribute("name"),B=C[F];B&&z.setAttribute("width",B.realWidth||B.width)}},d=p=>{var _,r;const S=((_=e.vnode.el)==null?void 0:_.querySelectorAll("colgroup > col[name=gutter]"))||[];for(let M=0,k=S.length;M<k;M++)S[M].setAttribute("width",p.scrollY.value?p.gutterWidth:"0");const C=((r=e.vnode.el)==null?void 0:r.querySelectorAll("th.gutter"))||[];for(let M=0,k=C.length;M<k;M++){const z=C[M];z.style.width=p.scrollY.value?`${p.gutterWidth}px`:"0",z.style.display=p.scrollY.value?"":"none"}};return{tableLayout:i.value,onColumnsChange:a,onScrollableChange:d}}const gc=Symbol("ElTable");function wce(e,t){const i=wr(),a=An(gc),d=N=>{N.stopPropagation()},p=(N,j)=>{!j.filters&&j.sortable?B(N,j,!1):j.filterable&&!j.sortable&&d(N),a==null||a.emit("header-click",j,N)},_=(N,j)=>{a==null||a.emit("header-contextmenu",j,N)},r=Se(null),S=Se(!1),C=Se({}),M=(N,j)=>{if(Hr&&!(j.children&&j.children.length>0)&&r.value&&e.border){S.value=!0;const U=a;t("set-drag-visible",!0);const Y=(U==null?void 0:U.vnode.el).getBoundingClientRect().left,q=i.vnode.el.querySelector(`th.${j.id}`),J=q.getBoundingClientRect(),ne=J.left-Y+30;bl(q,"noclick"),C.value={startMouseLeft:N.clientX,startLeft:J.right-Y,startColumnLeft:J.left-Y,tableLeft:Y};const se=U==null?void 0:U.refs.resizeProxy;se.style.left=`${C.value.startLeft}px`,document.onselectstart=function(){return!1},document.ondragstart=function(){return!1};const fe=le=>{const ge=le.clientX-C.value.startMouseLeft,de=C.value.startLeft+ge;se.style.left=`${Math.max(ne,de)}px`},ce=()=>{if(S.value){const{startColumnLeft:le,startLeft:ge}=C.value,ke=Number.parseInt(se.style.left,10)-le;j.width=j.realWidth=ke,U==null||U.emit("header-dragend",j.width,ge-le,j,N),requestAnimationFrame(()=>{e.store.scheduleLayout(!1,!0)}),document.body.style.cursor="",S.value=!1,r.value=null,C.value={},t("set-drag-visible",!1)}document.removeEventListener("mousemove",fe),document.removeEventListener("mouseup",ce),document.onselectstart=null,document.ondragstart=null,setTimeout(()=>{js(q,"noclick")},0)};document.addEventListener("mousemove",fe),document.addEventListener("mouseup",ce)}},k=(N,j)=>{var U;if(j.children&&j.children.length>0)return;const te=N.target;if(!la(te))return;const Y=te==null?void 0:te.closest("th");if(!(!j||!j.resizable||!Y)&&!S.value&&e.border){const q=Y.getBoundingClientRect(),J=document.body.style,ne=((U=Y.parentNode)==null?void 0:U.lastElementChild)===Y,se=e.allowDragLastColumn||!ne;q.width>12&&q.right-N.pageX<8&&se?(J.cursor="col-resize",Aa(Y,"is-sortable")&&(Y.style.cursor="col-resize"),r.value=j):S.value||(J.cursor="",Aa(Y,"is-sortable")&&(Y.style.cursor="pointer"),r.value=null)}},z=()=>{Hr&&(document.body.style.cursor="")},F=({order:N,sortOrders:j})=>{if(N==="")return j[0];const U=j.indexOf(N||null);return j[U>j.length-2?0:U+1]},B=(N,j,U)=>{var te;N.stopPropagation();const Y=j.order===U?null:U||F(j),q=(te=N.target)==null?void 0:te.closest("th");if(q&&Aa(q,"noclick")){js(q,"noclick");return}if(!j.sortable)return;const J=N.currentTarget;if(["ascending","descending"].some(le=>Aa(J,le)&&!j.sortOrders.includes(le)))return;const ne=e.store.states;let se=ne.sortProp.value,fe;const ce=ne.sortingColumn.value;(ce!==j||ce===j&&yy(ce.order))&&(ce&&(ce.order=null),ne.sortingColumn.value=j,se=j.property),Y?fe=j.order=Y:fe=j.order=null,ne.sortProp.value=se,ne.sortOrder.value=fe,a==null||a.store.commit("changeSortCondition")};return{handleHeaderClick:p,handleHeaderContextMenu:_,handleMouseDown:M,handleMouseMove:k,handleMouseOut:z,handleSortClick:B,handleFilterClick:d}}function Sce(e){const t=An(gc),i=en("table");return{getHeaderRowStyle:r=>{const S=t==null?void 0:t.props.headerRowStyle;return Nn(S)?S.call(null,{rowIndex:r}):S},getHeaderRowClass:r=>{const S=[],C=t==null?void 0:t.props.headerRowClassName;return Dn(C)?S.push(C):Nn(C)&&S.push(C.call(null,{rowIndex:r})),S.join(" ")},getHeaderCellStyle:(r,S,C,M)=>{var k;let z=(k=t==null?void 0:t.props.headerCellStyle)!=null?k:{};Nn(z)&&(z=z.call(null,{rowIndex:r,columnIndex:S,row:C,column:M}));const F=qE(S,M.fixed,e.store,C);return Nm(F,"left"),Nm(F,"right"),Object.assign({},z,F)},getHeaderCellClass:(r,S,C,M)=>{const k=WE(i.b(),S,M.fixed,e.store,C),z=[M.id,M.order,M.headerAlign,M.className,M.labelClassName,...k];M.children||z.push("is-leaf"),M.sortable&&z.push("is-sortable");const F=t==null?void 0:t.props.headerCellClassName;return Dn(F)?z.push(F):Nn(F)&&z.push(F.call(null,{rowIndex:r,columnIndex:S,row:C,column:M})),z.push(i.e("cell")),z.filter(B=>!!B).join(" ")}}}const iN=e=>{const t=[];return e.forEach(i=>{i.children?(t.push(i),t.push.apply(t,iN(i.children))):t.push(i)}),t},sN=e=>{let t=1;const i=(p,_)=>{if(_&&(p.level=_.level+1,t<p.level&&(t=p.level)),p.children){let r=0;p.children.forEach(S=>{i(S,p),r+=S.colSpan}),p.colSpan=r}else p.colSpan=1};e.forEach(p=>{p.level=1,i(p,void 0)});const a=[];for(let p=0;p<t;p++)a.push([]);return iN(e).forEach(p=>{p.children?(p.rowSpan=1,p.children.forEach(_=>_.isSubColumn=!0)):p.rowSpan=t-p.level+1,a[p.level-1].push(p)}),a};function Tce(e){const t=An(gc),i=ee(()=>sN(e.store.states.originColumns.value));return{isGroup:ee(()=>{const p=i.value.length>1;return p&&t&&(t.state.isGroup.value=!0),p}),toggleAllSelection:p=>{p.stopPropagation(),t==null||t.store.commit("toggleAllSelection")},columnRows:i}}var Cce=qe({name:"ElTableHeader",components:{ElCheckbox:Il},props:{fixed:{type:String,default:""},store:{required:!0,type:Object},border:Boolean,defaultSort:{type:Object,default:()=>({prop:"",order:""})},appendFilterPanelTo:{type:String},allowDragLastColumn:{type:Boolean}},setup(e,{emit:t}){const i=wr(),a=An(gc),d=en("table"),p=Se({}),{onColumnsChange:_,onScrollableChange:r}=KE(a),S=(a==null?void 0:a.props.tableLayout)==="auto",C=lo(new Map),M=Se(),k=()=>{setTimeout(()=>{C.size>0&&(C.forEach((le,ge)=>{const de=M.value.querySelector(`.${ge.replace(/\s/g,".")}`);if(de){const ke=de.getBoundingClientRect().width;le.width=ke}}),C.clear())})};qt(C,k),gr(async()=>{await Vn(),await Vn();const{prop:le,order:ge}=e.defaultSort;a==null||a.store.commit("sort",{prop:le,order:ge,init:!0}),k()});const{handleHeaderClick:z,handleHeaderContextMenu:F,handleMouseDown:B,handleMouseMove:N,handleMouseOut:j,handleSortClick:U,handleFilterClick:te}=wce(e,t),{getHeaderRowStyle:Y,getHeaderRowClass:q,getHeaderCellStyle:J,getHeaderCellClass:ne}=Sce(e),{isGroup:se,toggleAllSelection:fe,columnRows:ce}=Tce(e);return i.state={onColumnsChange:_,onScrollableChange:r},i.filterPanels=p,{ns:d,filterPanels:p,onColumnsChange:_,onScrollableChange:r,columnRows:ce,getHeaderRowClass:q,getHeaderRowStyle:Y,getHeaderCellClass:ne,getHeaderCellStyle:J,handleHeaderClick:z,handleHeaderContextMenu:F,handleMouseDown:B,handleMouseMove:N,handleMouseOut:j,handleSortClick:U,handleFilterClick:te,isGroup:se,toggleAllSelection:fe,saveIndexSelection:C,isTableLayoutAuto:S,theadRef:M,updateFixedColumnStyle:k}},render(){const{ns:e,isGroup:t,columnRows:i,getHeaderCellStyle:a,getHeaderCellClass:d,getHeaderRowClass:p,getHeaderRowStyle:_,handleHeaderClick:r,handleHeaderContextMenu:S,handleMouseDown:C,handleMouseMove:M,handleSortClick:k,handleMouseOut:z,store:F,$parent:B,saveIndexSelection:N,isTableLayoutAuto:j}=this;let U=1;return Kn("thead",{ref:"theadRef",class:{[e.is("group")]:t}},i.map((te,Y)=>Kn("tr",{class:p(Y),key:Y,style:_(Y)},te.map((q,J)=>{q.rowSpan>U&&(U=q.rowSpan);const ne=d(Y,J,te,q);return j&&q.fixed&&N.set(ne,q),Kn("th",{class:ne,colspan:q.colSpan,key:`${q.id}-thead`,rowspan:q.rowSpan,style:a(Y,J,te,q),onClick:se=>{se.currentTarget.classList.contains("noclick")||r(se,q)},onContextmenu:se=>S(se,q),onMousedown:se=>C(se,q),onMousemove:se=>M(se,q),onMouseout:z},[Kn("div",{class:["cell",q.filteredValue&&q.filteredValue.length>0?"highlight":""]},[q.renderHeader?q.renderHeader({column:q,$index:J,store:F,_self:B}):q.label,q.sortable&&Kn("span",{onClick:se=>k(se,q),class:"caret-wrapper"},[Kn("i",{onClick:se=>k(se,q,"ascending"),class:"sort-caret ascending"}),Kn("i",{onClick:se=>k(se,q,"descending"),class:"sort-caret descending"})]),q.filterable&&Kn(xce,{store:F,placement:q.filterPlacement||"bottom-start",appendTo:B.appendFilterPanelTo,column:q,upDataColumn:(se,fe)=>{q[se]=fe}},{"filter-icon":()=>q.renderFilterIcon?q.renderFilterIcon({filterOpened:q.filterOpened}):null})])])}))))}});function vS(e,t,i=.03){return e-t>i}function Ece(e){const t=An(gc),i=Se(""),a=Se(Kn("div")),d=(B,N,j)=>{var U;const te=t,Y=gS(B);let q;const J=(U=te==null?void 0:te.vnode.el)==null?void 0:U.dataset.prefix;Y&&(q=WR({columns:e.store.states.columns.value},Y,J),q&&(te==null||te.emit(`cell-${j}`,N,q,Y,B))),te==null||te.emit(`row-${j}`,N,q,B)},p=(B,N)=>{d(B,N,"dblclick")},_=(B,N)=>{e.store.commit("setCurrentRow",N),d(B,N,"click")},r=(B,N)=>{d(B,N,"contextmenu")},S=Ra(B=>{e.store.commit("setHoverRow",B)},30),C=Ra(()=>{e.store.commit("setHoverRow",null)},30),M=B=>{const N=window.getComputedStyle(B,null),j=Number.parseInt(N.paddingLeft,10)||0,U=Number.parseInt(N.paddingRight,10)||0,te=Number.parseInt(N.paddingTop,10)||0,Y=Number.parseInt(N.paddingBottom,10)||0;return{left:j,right:U,top:te,bottom:Y}},k=(B,N,j)=>{let U=N.target.parentNode;for(;B>1&&(U=U==null?void 0:U.nextSibling,!(!U||U.nodeName!=="TR"));)j(U,"hover-row hover-fixed-row"),B--};return{handleDoubleClick:p,handleClick:_,handleContextMenu:r,handleMouseEnter:S,handleMouseLeave:C,handleCellMouseEnter:(B,N,j)=>{var U,te,Y;const q=t,J=gS(B),ne=(U=q==null?void 0:q.vnode.el)==null?void 0:U.dataset.prefix;let se;if(J){se=WR({columns:e.store.states.columns.value},J,ne),J.rowSpan>1&&k(J.rowSpan,B,bl);const Be=q.hoverState={cell:J,column:se,row:N};q==null||q.emit("cell-mouse-enter",Be.row,Be.column,Be.cell,B)}if(!j)return;const fe=B.target.querySelector(".cell");if(!(Aa(fe,`${ne}-tooltip`)&&fe.childNodes.length))return;const ce=document.createRange();ce.setStart(fe,0),ce.setEnd(fe,fe.childNodes.length);const{width:le,height:ge}=ce.getBoundingClientRect(),{width:de,height:ke}=fe.getBoundingClientRect(),{top:We,left:we,right:be,bottom:Me}=M(fe),Ae=we+be,me=We+Me;vS(le+Ae,de)||vS(ge+me,ke)||vS(fe.scrollWidth,de)?lce(j,J.innerText||J.textContent,N,se,J,q):((te=Ea)==null?void 0:te.trigger)===J&&((Y=Ea)==null||Y())},handleCellMouseLeave:B=>{const N=gS(B);if(!N)return;N.rowSpan>1&&k(N.rowSpan,B,js);const j=t==null?void 0:t.hoverState;t==null||t.emit("cell-mouse-leave",j==null?void 0:j.row,j==null?void 0:j.column,j==null?void 0:j.cell,B)},tooltipContent:i,tooltipTrigger:a}}function Mce(e){const t=An(gc),i=en("table");return{getRowStyle:(C,M)=>{const k=t==null?void 0:t.props.rowStyle;return Nn(k)?k.call(null,{row:C,rowIndex:M}):k||null},getRowClass:(C,M)=>{const k=[i.e("row")];t!=null&&t.props.highlightCurrentRow&&C===e.store.states.currentRow.value&&k.push("current-row"),e.stripe&&M%2===1&&k.push(i.em("row","striped"));const z=t==null?void 0:t.props.rowClassName;return Dn(z)?k.push(z):Nn(z)&&k.push(z.call(null,{row:C,rowIndex:M})),k},getCellStyle:(C,M,k,z)=>{const F=t==null?void 0:t.props.cellStyle;let B=F??{};Nn(F)&&(B=F.call(null,{rowIndex:C,columnIndex:M,row:k,column:z}));const N=qE(M,e==null?void 0:e.fixed,e.store);return Nm(N,"left"),Nm(N,"right"),Object.assign({},B,N)},getCellClass:(C,M,k,z,F)=>{const B=WE(i.b(),M,e==null?void 0:e.fixed,e.store,void 0,F),N=[z.id,z.align,z.className,...B],j=t==null?void 0:t.props.cellClassName;return Dn(j)?N.push(j):Nn(j)&&N.push(j.call(null,{rowIndex:C,columnIndex:M,row:k,column:z})),N.push(i.e("cell")),N.filter(U=>!!U).join(" ")},getSpan:(C,M,k,z)=>{let F=1,B=1;const N=t==null?void 0:t.props.spanMethod;if(Nn(N)){const j=N({row:C,column:M,rowIndex:k,columnIndex:z});ln(j)?(F=j[0],B=j[1]):yr(j)&&(F=j.rowspan,B=j.colspan)}return{rowspan:F,colspan:B}},getColspanRealWidth:(C,M,k)=>{if(M<1)return C[k].realWidth;const z=C.map(({realWidth:F,width:B})=>F||B).slice(k,k+M);return Number(z.reduce((F,B)=>Number(F)+Number(B),-1))}}}const Ice=qe({name:"TableTdWrapper"}),Ace=qe({...Ice,props:{colspan:{type:Number,default:1},rowspan:{type:Number,default:1}},setup(e){return(t,i)=>(ae(),Oe("td",{colspan:e.colspan,rowspan:e.rowspan},[pt(t.$slots,"default")],8,["colspan","rowspan"]))}});var kce=fn(Ace,[["__file","td-wrapper.vue"]]);function Pce(e){const t=An(gc),i=en("table"),{handleDoubleClick:a,handleClick:d,handleContextMenu:p,handleMouseEnter:_,handleMouseLeave:r,handleCellMouseEnter:S,handleCellMouseLeave:C,tooltipContent:M,tooltipTrigger:k}=Ece(e),{getRowStyle:z,getRowClass:F,getCellStyle:B,getCellClass:N,getSpan:j,getColspanRealWidth:U}=Mce(e),te=ee(()=>e.store.states.columns.value.findIndex(({type:se})=>se==="default")),Y=(se,fe)=>{const ce=t.props.rowKey;return ce?$s(se,ce):fe},q=(se,fe,ce,le=!1)=>{const{tooltipEffect:ge,tooltipOptions:de,store:ke}=e,{indent:We,columns:we}=ke.states,be=F(se,fe);let Me=!0;return ce&&(be.push(i.em("row",`level-${ce.level}`)),Me=ce.display),Kn("tr",{style:[Me?null:{display:"none"},z(se,fe)],class:be,key:Y(se,fe),onDblclick:me=>a(me,se),onClick:me=>d(me,se),onContextmenu:me=>p(me,se),onMouseenter:()=>_(fe),onMouseleave:r},we.value.map((me,Be)=>{const{rowspan:Ve,colspan:bt}=j(se,me,fe,Be);if(!Ve||!bt)return null;const Pe=Object.assign({},me);Pe.realWidth=U(we.value,bt,Be);const wt={store:e.store,_self:e.context||t,column:Pe,row:se,$index:fe,cellIndex:Be,expanded:le};Be===te.value&&ce&&(wt.treeNode={indent:ce.level*We.value,level:ce.level},Ro(ce.expanded)&&(wt.treeNode.expanded=ce.expanded,"loading"in ce&&(wt.treeNode.loading=ce.loading),"noLazyChildren"in ce&&(wt.treeNode.noLazyChildren=ce.noLazyChildren)));const Mt=`${Y(se,fe)},${Be}`,Nt=Pe.columnKey||Pe.rawColumnKey||"",vt=me.showOverflowTooltip&&az({effect:ge},de,me.showOverflowTooltip);return Kn(kce,{style:B(fe,Be,se,me),class:N(fe,Be,se,me,bt-1),key:`${Nt}${Mt}`,rowspan:Ve,colspan:bt,onMouseenter:Bt=>S(Bt,se,vt),onMouseleave:C},{default:()=>J(Be,me,wt)})}))},J=(se,fe,ce)=>fe.renderCell(ce);return{wrappedRowRender:(se,fe)=>{const ce=e.store,{isRowExpanded:le,assertRowKey:ge}=ce,{treeData:de,lazyTreeNodeMap:ke,childrenColumnName:We,rowKey:we}=ce.states,be=ce.states.columns.value;if(be.some(({type:Ae})=>Ae==="expand")){const Ae=le(se),me=q(se,fe,void 0,Ae),Be=t.renderExpanded;return Ae?Be?[[me,Kn("tr",{key:`expanded-row__${me.key}`},[Kn("td",{colspan:be.length,class:`${i.e("cell")} ${i.e("expanded-cell")}`},[Be({row:se,$index:fe,store:ce,expanded:Ae})])])]]:(console.error("[Element Error]renderExpanded is required."),me):[[me]]}else if(Object.keys(de.value).length){ge();const Ae=$s(se,we.value);let me=de.value[Ae],Be=null;me&&(Be={expanded:me.expanded,level:me.level,display:!0},Ro(me.lazy)&&(Ro(me.loaded)&&me.loaded&&(Be.noLazyChildren=!(me.children&&me.children.length)),Be.loading=me.loading));const Ve=[q(se,fe,Be)];if(me){let bt=0;const Pe=(Mt,Nt)=>{Mt&&Mt.length&&Nt&&Mt.forEach(vt=>{const Bt={display:Nt.display&&Nt.expanded,level:Nt.level+1,expanded:!1,noLazyChildren:!1,loading:!1},Wt=$s(vt,we.value);if(rc(Wt))throw new Error("For nested data item, row-key is required.");if(me={...de.value[Wt]},me&&(Bt.expanded=me.expanded,me.level=me.level||Bt.level,me.display=!!(me.expanded&&Bt.display),Ro(me.lazy)&&(Ro(me.loaded)&&me.loaded&&(Bt.noLazyChildren=!(me.children&&me.children.length)),Bt.loading=me.loading)),bt++,Ve.push(q(vt,fe+bt,Bt)),me){const Fe=ke.value[Wt]||vt[We.value];Pe(Fe,me)}})};me.display=!0;const wt=ke.value[Ae]||se[We.value];Pe(wt,me)}return Ve}else return q(se,fe,void 0)},tooltipContent:M,tooltipTrigger:k}}const Rce={store:{required:!0,type:Object},stripe:Boolean,tooltipEffect:String,tooltipOptions:{type:Object},context:{default:()=>({}),type:Object},rowClassName:[String,Function],rowStyle:[Object,Function],fixed:{type:String,default:""},highlight:Boolean};var Oce=qe({name:"ElTableBody",props:Rce,setup(e){const t=wr(),i=An(gc),a=en("table"),{wrappedRowRender:d,tooltipContent:p,tooltipTrigger:_}=Pce(e),{onColumnsChange:r,onScrollableChange:S}=KE(i),C=[];return qt(e.store.states.hoverRow,(M,k)=>{var z;const F=t==null?void 0:t.vnode.el,B=Array.from((F==null?void 0:F.children)||[]).filter(U=>U==null?void 0:U.classList.contains(`${a.e("row")}`));let N=M;const j=(z=B[N])==null?void 0:z.childNodes;if(j!=null&&j.length){let U=0;Array.from(j).reduce((Y,q,J)=>{var ne,se;return((ne=j[J])==null?void 0:ne.colSpan)>1&&(U=(se=j[J])==null?void 0:se.colSpan),q.nodeName!=="TD"&&U===0&&Y.push(J),U>0&&U--,Y},[]).forEach(Y=>{var q;for(N=M;N>0;){const J=(q=B[N-1])==null?void 0:q.childNodes;if(J[Y]&&J[Y].nodeName==="TD"&&J[Y].rowSpan>1){bl(J[Y],"hover-cell"),C.push(J[Y]);break}N--}})}else C.forEach(U=>js(U,"hover-cell")),C.length=0;!e.store.states.isComplex.value||!Hr||qd(()=>{const U=B[k],te=B[M];U&&!U.classList.contains("hover-fixed-row")&&js(U,"hover-row"),te&&bl(te,"hover-row")})}),th(()=>{var M;(M=Ea)==null||M()}),{ns:a,onColumnsChange:r,onScrollableChange:S,wrappedRowRender:d,tooltipContent:p,tooltipTrigger:_}},render(){const{wrappedRowRender:e,store:t}=this,i=t.states.data.value||[];return Kn("tbody",{tabIndex:-1},[i.reduce((a,d)=>a.concat(e(d,a.length)),[])])}});function Lce(){const e=An(gc),t=e==null?void 0:e.store,i=ee(()=>t.states.fixedLeafColumnsLength.value),a=ee(()=>t.states.rightFixedColumns.value.length),d=ee(()=>t.states.columns.value.length),p=ee(()=>t.states.fixedColumns.value.length),_=ee(()=>t.states.rightFixedColumns.value.length);return{leftFixedLeafCount:i,rightFixedLeafCount:a,columnsCount:d,leftFixedCount:p,rightFixedCount:_,columns:t.states.columns}}function Dce(e){const{columns:t}=Lce(),i=en("table");return{getCellClasses:(p,_)=>{const r=p[_],S=[i.e("cell"),r.id,r.align,r.labelClassName,...WE(i.b(),_,r.fixed,e.store)];return r.className&&S.push(r.className),r.children||S.push(i.is("leaf")),S},getCellStyles:(p,_)=>{const r=qE(_,p.fixed,e.store);return Nm(r,"left"),Nm(r,"right"),r},columns:t}}var zce=qe({name:"ElTableFooter",props:{fixed:{type:String,default:""},store:{required:!0,type:Object},summaryMethod:Function,sumText:String,border:Boolean,defaultSort:{type:Object,default:()=>({prop:"",order:""})}},setup(e){const t=An(gc),i=en("table"),{getCellClasses:a,getCellStyles:d,columns:p}=Dce(e),{onScrollableChange:_,onColumnsChange:r}=KE(t);return{ns:i,onScrollableChange:_,onColumnsChange:r,getCellClasses:a,getCellStyles:d,columns:p}},render(){const{columns:e,getCellStyles:t,getCellClasses:i,summaryMethod:a,sumText:d}=this,p=this.store.states.data.value;let _=[];return a?_=a({columns:e,data:p}):e.forEach((r,S)=>{if(S===0){_[S]=d;return}const C=p.map(F=>Number(F[r.property])),M=[];let k=!0;C.forEach(F=>{if(!Number.isNaN(+F)){k=!1;const B=`${F}`.split(".")[1];M.push(B?B.length:0)}});const z=Math.max.apply(null,M);k?_[S]="":_[S]=C.reduce((F,B)=>{const N=Number(B);return Number.isNaN(+N)?F:Number.parseFloat((F+B).toFixed(Math.min(z,20)))},0)}),Kn(Kn("tfoot",[Kn("tr",{},[...e.map((r,S)=>Kn("td",{key:S,colspan:r.colSpan,rowspan:r.rowSpan,class:i(e,S),style:t(r,S)},[Kn("div",{class:["cell",r.labelClassName]},[_[S]])]))])]))}});function Fce(e){return{setCurrentRow:k=>{e.commit("setCurrentRow",k)},getSelectionRows:()=>e.getSelectionRows(),toggleRowSelection:(k,z,F=!0)=>{e.toggleRowSelection(k,z,!1,F),e.updateAllSelected()},clearSelection:()=>{e.clearSelection()},clearFilter:k=>{e.clearFilter(k)},toggleAllSelection:()=>{e.commit("toggleAllSelection")},toggleRowExpansion:(k,z)=>{e.toggleRowExpansionAdapter(k,z)},clearSort:()=>{e.clearSort()},sort:(k,z)=>{e.commit("sort",{prop:k,order:z})},updateKeyChildren:(k,z)=>{e.updateKeyChildren(k,z)}}}function Nce(e,t,i,a){const d=Se(!1),p=Se(null),_=Se(!1),r=Ae=>{_.value=Ae},S=Se({width:null,height:null,headerHeight:null}),C=Se(!1),M={display:"inline-block",verticalAlign:"middle"},k=Se(),z=Se(0),F=Se(0),B=Se(0),N=Se(0),j=Se(0);Cs(()=>{t.setHeight(e.height)}),Cs(()=>{t.setMaxHeight(e.maxHeight)}),qt(()=>[e.currentRowKey,i.states.rowKey],([Ae,me])=>{!b(me)||!b(Ae)||i.setCurrentRowKey(`${Ae}`)},{immediate:!0}),qt(()=>e.data,Ae=>{a.store.commit("setData",Ae)},{immediate:!0,deep:!0}),Cs(()=>{e.expandRowKeys&&i.setExpandRowKeysAdapter(e.expandRowKeys)});const U=()=>{a.store.commit("setHoverRow",null),a.hoverState&&(a.hoverState=null)},te=(Ae,me)=>{const{pixelX:Be,pixelY:Ve}=me;Math.abs(Be)>=Math.abs(Ve)&&(a.refs.bodyWrapper.scrollLeft+=me.pixelX/5)},Y=ee(()=>e.height||e.maxHeight||i.states.fixedColumns.value.length>0||i.states.rightFixedColumns.value.length>0),q=ee(()=>({width:t.bodyWidth.value?`${t.bodyWidth.value}px`:""})),J=()=>{Y.value&&t.updateElsHeight(),t.updateColumnsWidth(),!(typeof window>"u")&&requestAnimationFrame(ce)};gr(async()=>{await Vn(),i.updateColumns(),le(),requestAnimationFrame(J);const Ae=a.vnode.el,me=a.refs.headerWrapper;e.flexible&&Ae&&Ae.parentElement&&(Ae.parentElement.style.minWidth="0"),S.value={width:k.value=Ae.offsetWidth,height:Ae.offsetHeight,headerHeight:e.showHeader&&me?me.offsetHeight:null},i.states.columns.value.forEach(Be=>{Be.filteredValue&&Be.filteredValue.length&&a.store.commit("filterChange",{column:Be,values:Be.filteredValue,silent:!0})}),a.$ready=!0});const ne=(Ae,me)=>{if(!Ae)return;const Be=Array.from(Ae.classList).filter(Ve=>!Ve.startsWith("is-scrolling-"));Be.push(t.scrollX.value?me:"is-scrolling-none"),Ae.className=Be.join(" ")},se=Ae=>{const{tableWrapper:me}=a.refs;ne(me,Ae)},fe=Ae=>{const{tableWrapper:me}=a.refs;return!!(me&&me.classList.contains(Ae))},ce=function(){if(!a.refs.scrollBarRef)return;if(!t.scrollX.value){const Mt="is-scrolling-none";fe(Mt)||se(Mt);return}const Ae=a.refs.scrollBarRef.wrapRef;if(!Ae)return;const{scrollLeft:me,offsetWidth:Be,scrollWidth:Ve}=Ae,{headerWrapper:bt,footerWrapper:Pe}=a.refs;bt&&(bt.scrollLeft=me),Pe&&(Pe.scrollLeft=me);const wt=Ve-Be-1;me>=wt?se("is-scrolling-right"):se(me===0?"is-scrolling-left":"is-scrolling-middle")},le=()=>{a.refs.scrollBarRef&&(a.refs.scrollBarRef.wrapRef&&So(a.refs.scrollBarRef.wrapRef,"scroll",ce,{passive:!0}),e.fit?ti(a.vnode.el,ge):So(window,"resize",ge),ti(a.refs.bodyWrapper,()=>{var Ae,me;ge(),(me=(Ae=a.refs)==null?void 0:Ae.scrollBarRef)==null||me.update()}))},ge=()=>{var Ae,me,Be,Ve;const bt=a.vnode.el;if(!a.$ready||!bt)return;let Pe=!1;const{width:wt,height:Mt,headerHeight:Nt}=S.value,vt=k.value=bt.offsetWidth;wt!==vt&&(Pe=!0);const Bt=bt.offsetHeight;(e.height||Y.value)&&Mt!==Bt&&(Pe=!0);const Wt=e.tableLayout==="fixed"?a.refs.headerWrapper:(Ae=a.refs.tableHeaderRef)==null?void 0:Ae.$el;e.showHeader&&(Wt==null?void 0:Wt.offsetHeight)!==Nt&&(Pe=!0),z.value=((me=a.refs.tableWrapper)==null?void 0:me.scrollHeight)||0,B.value=(Wt==null?void 0:Wt.scrollHeight)||0,N.value=((Be=a.refs.footerWrapper)==null?void 0:Be.offsetHeight)||0,j.value=((Ve=a.refs.appendWrapper)==null?void 0:Ve.offsetHeight)||0,F.value=z.value-B.value-N.value-j.value,Pe&&(S.value={width:vt,height:Bt,headerHeight:e.showHeader&&(Wt==null?void 0:Wt.offsetHeight)||0},J())},de=Li(),ke=ee(()=>{const{bodyWidth:Ae,scrollY:me,gutterWidth:Be}=t;return Ae.value?`${Ae.value-(me.value?Be:0)}px`:""}),We=ee(()=>e.maxHeight?"fixed":e.tableLayout),we=ee(()=>{if(e.data&&e.data.length)return null;let Ae="100%";e.height&&F.value&&(Ae=`${F.value}px`);const me=k.value;return{width:me?`${me}px`:"",height:Ae}}),be=ee(()=>e.height?{height:"100%"}:e.maxHeight?Number.isNaN(Number(e.maxHeight))?{maxHeight:`calc(${e.maxHeight} - ${B.value+N.value}px)`}:{maxHeight:`${e.maxHeight-B.value-N.value}px`}:{});return{isHidden:d,renderExpanded:p,setDragVisible:r,isGroup:C,handleMouseLeave:U,handleHeaderFooterMousewheel:te,tableSize:de,emptyBlockStyle:we,handleFixedMousewheel:(Ae,me)=>{const Be=a.refs.bodyWrapper;if(Math.abs(me.spinY)>0){const Ve=Be.scrollTop;me.pixelY<0&&Ve!==0&&Ae.preventDefault(),me.pixelY>0&&Be.scrollHeight-Be.clientHeight>Ve&&Ae.preventDefault(),Be.scrollTop+=Math.ceil(me.pixelY/5)}else Be.scrollLeft+=Math.ceil(me.pixelX/5)},resizeProxyVisible:_,bodyWidth:ke,resizeState:S,doLayout:J,tableBodyStyles:q,tableLayout:We,scrollbarViewStyle:M,scrollbarStyle:be}}function Bce(e){const t=Se(),i=()=>{const d=e.vnode.el.querySelector(".hidden-columns"),p={childList:!0,subtree:!0},_=e.store.states.updateOrderFns;t.value=new MutationObserver(()=>{_.forEach(r=>r())}),t.value.observe(d,p)};gr(()=>{i()}),th(()=>{var a;(a=t.value)==null||a.disconnect()})}var Vce={data:{type:Array,default:()=>[]},size:zi,width:[String,Number],height:[String,Number],maxHeight:[String,Number],fit:{type:Boolean,default:!0},stripe:Boolean,border:Boolean,rowKey:[String,Function],showHeader:{type:Boolean,default:!0},showSummary:Boolean,sumText:String,summaryMethod:Function,rowClassName:[String,Function],rowStyle:[Object,Function],cellClassName:[String,Function],cellStyle:[Object,Function],headerRowClassName:[String,Function],headerRowStyle:[Object,Function],headerCellClassName:[String,Function],headerCellStyle:[Object,Function],highlightCurrentRow:Boolean,currentRowKey:[String,Number],emptyText:String,expandRowKeys:Array,defaultExpandAll:Boolean,defaultSort:Object,tooltipEffect:String,tooltipOptions:Object,spanMethod:Function,selectOnIndeterminate:{type:Boolean,default:!0},indent:{type:Number,default:16},treeProps:{type:Object,default:()=>({hasChildren:"hasChildren",children:"children",checkStrictly:!1})},lazy:Boolean,load:Function,style:{type:Object,default:()=>({})},className:{type:String,default:""},tableLayout:{type:String,default:"fixed"},scrollbarAlwaysOn:Boolean,flexible:Boolean,showOverflowTooltip:[Boolean,Object],tooltipFormatter:Function,appendFilterPanelTo:String,scrollbarTabindex:{type:[Number,String],default:void 0},allowDragLastColumn:{type:Boolean,default:!0}};function aN(e){const t=e.tableLayout==="auto";let i=e.columns||[];t&&i.every(({width:d})=>oo(d))&&(i=[]);const a=d=>{const p={key:`${e.tableLayout}_${d.id}`,style:{},name:void 0};return t?p.style={width:`${d.width}px`}:p.name=d.id,p};return Kn("colgroup",{},i.map(d=>Kn("col",a(d))))}aN.props=["columns","tableLayout"];const $ce=()=>{const e=Se(),t=(p,_)=>{const r=e.value;r&&r.scrollTo(p,_)},i=(p,_)=>{const r=e.value;r&&Gn(_)&&["Top","Left"].includes(p)&&r[`setScroll${p}`](_)};return{scrollBarRef:e,scrollTo:t,setScrollTop:p=>i("Top",p),setScrollLeft:p=>i("Left",p)}};var ZR=!1,gf,PT,RT,Jb,Qb,lN,e1,OT,LT,DT,cN,zT,FT,uN,dN;function Ca(){if(!ZR){ZR=!0;var e=navigator.userAgent,t=/(?:MSIE.(\d+\.\d+))|(?:(?:Firefox|GranParadiso|Iceweasel).(\d+\.\d+))|(?:Opera(?:.+Version.|.)(\d+\.\d+))|(?:AppleWebKit.(\d+(?:\.\d+)?))|(?:Trident\/\d+\.\d+.*rv:(\d+\.\d+))/.exec(e),i=/(Mac OS X)|(Windows)|(Linux)/.exec(e);if(zT=/\b(iPhone|iP[ao]d)/.exec(e),FT=/\b(iP[ao]d)/.exec(e),DT=/Android/i.exec(e),uN=/FBAN\/\w+;/i.exec(e),dN=/Mobile/i.exec(e),cN=!!/Win64/.exec(e),t){gf=t[1]?parseFloat(t[1]):t[5]?parseFloat(t[5]):NaN,gf&&document&&document.documentMode&&(gf=document.documentMode);var a=/(?:Trident\/(\d+.\d+))/.exec(e);lN=a?parseFloat(a[1])+4:gf,PT=t[2]?parseFloat(t[2]):NaN,RT=t[3]?parseFloat(t[3]):NaN,Jb=t[4]?parseFloat(t[4]):NaN,Jb?(t=/(?:Chrome\/(\d+\.\d+))/.exec(e),Qb=t&&t[1]?parseFloat(t[1]):NaN):Qb=NaN}else gf=PT=RT=Qb=Jb=NaN;if(i){if(i[1]){var d=/(?:Mac OS X (\d+(?:[._]\d+)?))/.exec(e);e1=d?parseFloat(d[1].replace("_",".")):!0}else e1=!1;OT=!!i[2],LT=!!i[3]}else e1=OT=LT=!1}}var NT={ie:function(){return Ca()||gf},ieCompatibilityMode:function(){return Ca()||lN>gf},ie64:function(){return NT.ie()&&cN},firefox:function(){return Ca()||PT},opera:function(){return Ca()||RT},webkit:function(){return Ca()||Jb},safari:function(){return NT.webkit()},chrome:function(){return Ca()||Qb},windows:function(){return Ca()||OT},osx:function(){return Ca()||e1},linux:function(){return Ca()||LT},iphone:function(){return Ca()||zT},mobile:function(){return Ca()||zT||FT||DT||dN},nativeApp:function(){return Ca()||uN},android:function(){return Ca()||DT},ipad:function(){return Ca()||FT}},Uce=NT,jce=!!(typeof window<"u"&&window.document&&window.document.createElement),Hce={canUseDOM:jce},hN=Hce,fN;hN.canUseDOM&&(fN=document.implementation&&document.implementation.hasFeature&&document.implementation.hasFeature("","")!==!0);function Gce(e,t){if(!hN.canUseDOM||t&&!("addEventListener"in document))return!1;var i="on"+e,a=i in document;if(!a){var d=document.createElement("div");d.setAttribute(i,"return;"),a=typeof d[i]=="function"}return!a&&fN&&e==="wheel"&&(a=document.implementation.hasFeature("Events.wheel","3.0")),a}var Wce=Gce,YR=10,XR=40,JR=800;function pN(e){var t=0,i=0,a=0,d=0;return"detail"in e&&(i=e.detail),"wheelDelta"in e&&(i=-e.wheelDelta/120),"wheelDeltaY"in e&&(i=-e.wheelDeltaY/120),"wheelDeltaX"in e&&(t=-e.wheelDeltaX/120),"axis"in e&&e.axis===e.HORIZONTAL_AXIS&&(t=i,i=0),a=t*YR,d=i*YR,"deltaY"in e&&(d=e.deltaY),"deltaX"in e&&(a=e.deltaX),(a||d)&&e.deltaMode&&(e.deltaMode==1?(a*=XR,d*=XR):(a*=JR,d*=JR)),a&&!t&&(t=a<1?-1:1),d&&!i&&(i=d<1?-1:1),{spinX:t,spinY:i,pixelX:a,pixelY:d}}pN.getEventType=function(){return Uce.firefox()?"DOMMouseScroll":Wce("wheel")?"wheel":"mousewheel"};var qce=pN;/**
* Checks if an event is supported in the current execution environment.
*
* NOTE: This will not work correctly for non-generic events such as `change`,
* `reset`, `load`, `error`, and `select`.
*
* Borrows from Modernizr.
*
* @param {string} eventNameSuffix Event name, e.g. "click".
* @param {?boolean} capture Check if the capture phase is supported.
* @return {boolean} True if the event is supported.
* @internal
* @license Modernizr 3.0.0pre (Custom Build) | MIT
*/const Kce=function(e,t){if(e&&e.addEventListener){const i=function(a){const d=qce(a);t&&Reflect.apply(t,this,[a,d])};e.addEventListener("wheel",i,{passive:!0})}},Zce={beforeMount(e,t){Kce(e,t.value)}};let Yce=1;const Xce=qe({name:"ElTable",directives:{Mousewheel:Zce},components:{TableHeader:Cce,TableBody:Oce,TableFooter:zce,ElScrollbar:Yc,hColgroup:aN},props:Vce,emits:["select","select-all","selection-change","cell-mouse-enter","cell-mouse-leave","cell-contextmenu","cell-click","cell-dblclick","row-click","row-contextmenu","row-dblclick","header-click","header-contextmenu","sort-change","filter-change","current-change","header-dragend","expand-change","scroll"],setup(e){const{t}=Gr(),i=en("table"),a=wr();Dr(gc,a);const d=mce(a,e);a.store=d;const p=new vce({store:a.store,table:a,fit:e.fit,showHeader:e.showHeader});a.layout=p;const _=ee(()=>(d.states.data.value||[]).length===0),{setCurrentRow:r,getSelectionRows:S,toggleRowSelection:C,clearSelection:M,clearFilter:k,toggleAllSelection:z,toggleRowExpansion:F,clearSort:B,sort:N,updateKeyChildren:j}=Fce(d),{isHidden:U,renderExpanded:te,setDragVisible:Y,isGroup:q,handleMouseLeave:J,handleHeaderFooterMousewheel:ne,tableSize:se,emptyBlockStyle:fe,handleFixedMousewheel:ce,resizeProxyVisible:le,bodyWidth:ge,resizeState:de,doLayout:ke,tableBodyStyles:We,tableLayout:we,scrollbarViewStyle:be,scrollbarStyle:Me}=Nce(e,p,d,a),{scrollBarRef:Ae,scrollTo:me,setScrollLeft:Be,setScrollTop:Ve}=$ce(),bt=Ra(ke,50),Pe=`${i.namespace.value}-table_${Yce++}`;a.tableId=Pe,a.state={isGroup:q,resizeState:de,doLayout:ke,debouncedUpdateLayout:bt};const wt=ee(()=>{var vt;return(vt=e.sumText)!=null?vt:t("el.table.sumText")}),Mt=ee(()=>{var vt;return(vt=e.emptyText)!=null?vt:t("el.table.emptyText")}),Nt=ee(()=>sN(d.states.originColumns.value)[0]);return Bce(a),Oo(()=>{bt.cancel()}),{ns:i,layout:p,store:d,columns:Nt,handleHeaderFooterMousewheel:ne,handleMouseLeave:J,tableId:Pe,tableSize:se,isHidden:U,isEmpty:_,renderExpanded:te,resizeProxyVisible:le,resizeState:de,isGroup:q,bodyWidth:ge,tableBodyStyles:We,emptyBlockStyle:fe,debouncedUpdateLayout:bt,handleFixedMousewheel:ce,setCurrentRow:r,getSelectionRows:S,toggleRowSelection:C,clearSelection:M,clearFilter:k,toggleAllSelection:z,toggleRowExpansion:F,clearSort:B,doLayout:ke,sort:N,updateKeyChildren:j,t,setDragVisible:Y,context:a,computedSumText:wt,computedEmptyText:Mt,tableLayout:we,scrollbarViewStyle:be,scrollbarStyle:Me,scrollBarRef:Ae,scrollTo:me,setScrollLeft:Be,setScrollTop:Ve,allowDragLastColumn:e.allowDragLastColumn}}});function Jce(e,t,i,a,d,p){const _=Er("hColgroup"),r=Er("table-header"),S=Er("table-body"),C=Er("table-footer"),M=Er("el-scrollbar"),k=J1("mousewheel");return ae(),Oe("div",{ref:"tableWrapper",class:pe([{[e.ns.m("fit")]:e.fit,[e.ns.m("striped")]:e.stripe,[e.ns.m("border")]:e.border||e.isGroup,[e.ns.m("hidden")]:e.isHidden,[e.ns.m("group")]:e.isGroup,[e.ns.m("fluid-height")]:e.maxHeight,[e.ns.m("scrollable-x")]:e.layout.scrollX.value,[e.ns.m("scrollable-y")]:e.layout.scrollY.value,[e.ns.m("enable-row-hover")]:!e.store.states.isComplex.value,[e.ns.m("enable-row-transition")]:(e.store.states.data.value||[]).length!==0&&(e.store.states.data.value||[]).length<100,"has-footer":e.showSummary},e.ns.m(e.tableSize),e.className,e.ns.b(),e.ns.m(`layout-${e.tableLayout}`)]),style:$n(e.style),"data-prefix":e.ns.namespace.value,onMouseleave:e.handleMouseLeave},[Ue("div",{class:pe(e.ns.e("inner-wrapper"))},[Ue("div",{ref:"hiddenColumns",class:"hidden-columns"},[pt(e.$slots,"default")],512),e.showHeader&&e.tableLayout==="fixed"?hr((ae(),Oe("div",{key:0,ref:"headerWrapper",class:pe(e.ns.e("header-wrapper"))},[Ue("table",{ref:"tableHeader",class:pe(e.ns.e("header")),style:$n(e.tableBodyStyles),border:"0",cellpadding:"0",cellspacing:"0"},[Ze(_,{columns:e.store.states.columns.value,"table-layout":e.tableLayout},null,8,["columns","table-layout"]),Ze(r,{ref:"tableHeaderRef",border:e.border,"default-sort":e.defaultSort,store:e.store,"append-filter-panel-to":e.appendFilterPanelTo,"allow-drag-last-column":e.allowDragLastColumn,onSetDragVisible:e.setDragVisible},null,8,["border","default-sort","store","append-filter-panel-to","allow-drag-last-column","onSetDragVisible"])],6)],2)),[[k,e.handleHeaderFooterMousewheel]]):yt("v-if",!0),Ue("div",{ref:"bodyWrapper",class:pe(e.ns.e("body-wrapper"))},[Ze(M,{ref:"scrollBarRef","view-style":e.scrollbarViewStyle,"wrap-style":e.scrollbarStyle,always:e.scrollbarAlwaysOn,tabindex:e.scrollbarTabindex,onScroll:z=>e.$emit("scroll",z)},{default:st(()=>[Ue("table",{ref:"tableBody",class:pe(e.ns.e("body")),cellspacing:"0",cellpadding:"0",border:"0",style:$n({width:e.bodyWidth,tableLayout:e.tableLayout})},[Ze(_,{columns:e.store.states.columns.value,"table-layout":e.tableLayout},null,8,["columns","table-layout"]),e.showHeader&&e.tableLayout==="auto"?(ae(),kt(r,{key:0,ref:"tableHeaderRef",class:pe(e.ns.e("body-header")),border:e.border,"default-sort":e.defaultSort,store:e.store,"append-filter-panel-to":e.appendFilterPanelTo,onSetDragVisible:e.setDragVisible},null,8,["class","border","default-sort","store","append-filter-panel-to","onSetDragVisible"])):yt("v-if",!0),Ze(S,{context:e.context,highlight:e.highlightCurrentRow,"row-class-name":e.rowClassName,"tooltip-effect":e.tooltipEffect,"tooltip-options":e.tooltipOptions,"row-style":e.rowStyle,store:e.store,stripe:e.stripe},null,8,["context","highlight","row-class-name","tooltip-effect","tooltip-options","row-style","store","stripe"]),e.showSummary&&e.tableLayout==="auto"?(ae(),kt(C,{key:1,class:pe(e.ns.e("body-footer")),border:e.border,"default-sort":e.defaultSort,store:e.store,"sum-text":e.computedSumText,"summary-method":e.summaryMethod},null,8,["class","border","default-sort","store","sum-text","summary-method"])):yt("v-if",!0)],6),e.isEmpty?(ae(),Oe("div",{key:0,ref:"emptyBlock",style:$n(e.emptyBlockStyle),class:pe(e.ns.e("empty-block"))},[Ue("span",{class:pe(e.ns.e("empty-text"))},[pt(e.$slots,"empty",{},()=>[Rr(pn(e.computedEmptyText),1)])],2)],6)):yt("v-if",!0),e.$slots.append?(ae(),Oe("div",{key:1,ref:"appendWrapper",class:pe(e.ns.e("append-wrapper"))},[pt(e.$slots,"append")],2)):yt("v-if",!0)]),_:3},8,["view-style","wrap-style","always","tabindex","onScroll"])],2),e.showSummary&&e.tableLayout==="fixed"?hr((ae(),Oe("div",{key:1,ref:"footerWrapper",class:pe(e.ns.e("footer-wrapper"))},[Ue("table",{class:pe(e.ns.e("footer")),cellspacing:"0",cellpadding:"0",border:"0",style:$n(e.tableBodyStyles)},[Ze(_,{columns:e.store.states.columns.value,"table-layout":e.tableLayout},null,8,["columns","table-layout"]),Ze(C,{border:e.border,"default-sort":e.defaultSort,store:e.store,"sum-text":e.computedSumText,"summary-method":e.summaryMethod},null,8,["border","default-sort","store","sum-text","summary-method"])],6)],2)),[[no,!e.isEmpty],[k,e.handleHeaderFooterMousewheel]]):yt("v-if",!0),e.border||e.isGroup?(ae(),Oe("div",{key:2,class:pe(e.ns.e("border-left-patch"))},null,2)):yt("v-if",!0)],2),hr(Ue("div",{ref:"resizeProxy",class:pe(e.ns.e("column-resize-proxy"))},null,2),[[no,e.resizeProxyVisible]])],46,["data-prefix","onMouseleave"])}var Qce=fn(Xce,[["render",Jce],["__file","table.vue"]]);const eue={selection:"table-column--selection",expand:"table__expand-column"},tue={default:{order:""},selection:{width:48,minWidth:48,realWidth:48,order:""},expand:{width:48,minWidth:48,realWidth:48,order:""},index:{width:48,minWidth:48,realWidth:48,order:""}},nue=e=>eue[e]||"",rue={selection:{renderHeader({store:e,column:t}){function i(){return e.states.data.value&&e.states.data.value.length===0}return Kn(Il,{disabled:i(),size:e.states.tableSize.value,indeterminate:e.states.selection.value.length>0&&!e.states.isAllSelected.value,"onUpdate:modelValue":e.toggleAllSelection,modelValue:e.states.isAllSelected.value,ariaLabel:t.label})},renderCell({row:e,column:t,store:i,$index:a}){return Kn(Il,{disabled:t.selectable?!t.selectable.call(null,e,a):!1,size:i.states.tableSize.value,onChange:()=>{i.commit("rowSelectedChanged",e)},onClick:d=>d.stopPropagation(),modelValue:i.isSelected(e),ariaLabel:t.label})},sortable:!1,resizable:!1},index:{renderHeader({column:e}){return e.label||"#"},renderCell({column:e,$index:t}){let i=t+1;const a=e.index;return Gn(a)?i=t+a:Nn(a)&&(i=a(t)),Kn("div",{},[i])},sortable:!1},expand:{renderHeader({column:e}){return e.label||""},renderCell({row:e,store:t,expanded:i}){const{ns:a}=t,d=[a.e("expand-icon")];return i&&d.push(a.em("expand-icon","expanded")),Kn("div",{class:d,onClick:function(_){_.stopPropagation(),t.toggleRowExpansion(e)}},{default:()=>[Kn(On,null,{default:()=>[Kn(ca)]})]})},sortable:!1,resizable:!1}};function oue({row:e,column:t,$index:i}){var a;const d=t.property,p=d&&M_(e,d).value;return t&&t.formatter?t.formatter(e,t,p,i):((a=p==null?void 0:p.toString)==null?void 0:a.call(p))||""}function iue({row:e,treeNode:t,store:i},a=!1){const{ns:d}=i;if(!t)return a?[Kn("span",{class:d.e("placeholder")})]:null;const p=[],_=function(r){r.stopPropagation(),!t.loading&&i.loadOrToggle(e)};if(t.indent&&p.push(Kn("span",{class:d.e("indent"),style:{"padding-left":`${t.indent}px`}})),Ro(t.expanded)&&!t.noLazyChildren){const r=[d.e("expand-icon"),t.expanded?d.em("expand-icon","expanded"):""];let S=ca;t.loading&&(S=Hc),p.push(Kn("div",{class:r,onClick:_},{default:()=>[Kn(On,{class:{[d.is("loading")]:t.loading}},{default:()=>[Kn(S)]})]}))}else p.push(Kn("span",{class:d.e("placeholder")}));return p}function QR(e,t){return e.reduce((i,a)=>(i[a]=a,i),t)}function sue(e,t){const i=wr();return{registerComplexWatchers:()=>{const p=["fixed"],_={realWidth:"width",realMinWidth:"minWidth"},r=QR(p,_);Object.keys(r).forEach(S=>{const C=_[S];to(t,C)&&qt(()=>t[C],M=>{let k=M;C==="width"&&S==="realWidth"&&(k=GE(M)),C==="minWidth"&&S==="realMinWidth"&&(k=eN(M)),i.columnConfig.value[C]=k,i.columnConfig.value[S]=k;const z=C==="fixed";e.value.store.scheduleLayout(z)})})},registerNormalWatchers:()=>{const p=["label","filters","filterMultiple","filteredValue","sortable","index","formatter","className","labelClassName","filterClassName","showOverflowTooltip","tooltipFormatter"],_={property:"prop",align:"realAlign",headerAlign:"realHeaderAlign"},r=QR(p,_);Object.keys(r).forEach(S=>{const C=_[S];to(t,C)&&qt(()=>t[C],M=>{i.columnConfig.value[S]=M})})}}}function aue(e,t,i){const a=wr(),d=Se(""),p=Se(!1),_=Se(),r=Se(),S=en("table");Cs(()=>{_.value=e.align?`is-${e.align}`:null,_.value}),Cs(()=>{r.value=e.headerAlign?`is-${e.headerAlign}`:_.value,r.value});const C=ee(()=>{let q=a.vnode.vParent||a.parent;for(;q&&!q.tableId&&!q.columnId;)q=q.vnode.vParent||q.parent;return q}),M=ee(()=>{const{store:q}=a.parent;if(!q)return!1;const{treeData:J}=q.states,ne=J.value;return ne&&Object.keys(ne).length>0}),k=Se(GE(e.width)),z=Se(eN(e.minWidth)),F=q=>(k.value&&(q.width=k.value),z.value&&(q.minWidth=z.value),!k.value&&z.value&&(q.width=void 0),q.minWidth||(q.minWidth=80),q.realWidth=Number(oo(q.width)?q.minWidth:q.width),q),B=q=>{const J=q.type,ne=rue[J]||{};Object.keys(ne).forEach(fe=>{const ce=ne[fe];fe!=="className"&&!oo(ce)&&(q[fe]=ce)});const se=nue(J);if(se){const fe=`${b(S.namespace)}-${se}`;q.className=q.className?`${q.className} ${fe}`:fe}return q},N=q=>{ln(q)?q.forEach(ne=>J(ne)):J(q);function J(ne){var se;((se=ne==null?void 0:ne.type)==null?void 0:se.name)==="ElTableColumn"&&(ne.vParent=a)}};return{columnId:d,realAlign:_,isSubColumn:p,realHeaderAlign:r,columnOrTableParent:C,setColumnWidth:F,setColumnForcedProps:B,setColumnRenders:q=>{e.renderHeader||q.type!=="selection"&&(q.renderHeader=ne=>(a.columnConfig.value.label,pt(t,"header",ne,()=>[q.label]))),t["filter-icon"]&&(q.renderFilterIcon=ne=>pt(t,"filter-icon",ne));let J=q.renderCell;return q.type==="expand"?(q.renderCell=ne=>Kn("div",{class:"cell"},[J(ne)]),i.value.renderExpanded=ne=>t.default?t.default(ne):t.default):(J=J||oue,q.renderCell=ne=>{let se=null;if(t.default){const ke=t.default(ne);se=ke.some(We=>We.type!==os)?ke:J(ne)}else se=J(ne);const{columns:fe}=i.value.store.states,ce=fe.value.findIndex(ke=>ke.type==="default"),le=M.value&&ne.cellIndex===ce,ge=iue(ne,le),de={class:"cell",style:{}};return q.showOverflowTooltip&&(de.class=`${de.class} ${b(S.namespace)}-tooltip`,de.style={width:`${(ne.column.realWidth||Number(ne.column.width))-1}px`}),N(se),Kn("div",de,[ge,se])}),q},getPropsData:(...q)=>q.reduce((J,ne)=>(ln(ne)&&ne.forEach(se=>{J[se]=e[se]}),J),{}),getColumnElIndex:(q,J)=>Array.prototype.indexOf.call(q,J),updateColumnOrder:()=>{i.value.store.commit("updateColumnOrder",a.columnConfig.value)}}}var lue={type:{type:String,default:"default"},label:String,className:String,labelClassName:String,property:String,prop:String,width:{type:[String,Number],default:""},minWidth:{type:[String,Number],default:""},renderHeader:Function,sortable:{type:[Boolean,String],default:!1},sortMethod:Function,sortBy:[String,Function,Array],resizable:{type:Boolean,default:!0},columnKey:String,align:String,headerAlign:String,showOverflowTooltip:{type:[Boolean,Object],default:void 0},tooltipFormatter:Function,fixed:[Boolean,String],formatter:Function,selectable:Function,reserveSelection:Boolean,filterMethod:Function,filteredValue:Array,filters:Array,filterPlacement:String,filterMultiple:{type:Boolean,default:!0},filterClassName:String,index:[Number,Function],sortOrders:{type:Array,default:()=>["ascending","descending",null],validator:e=>e.every(t=>["ascending","descending",null].includes(t))}};let cue=1;var mN=qe({name:"ElTableColumn",components:{ElCheckbox:Il},props:lue,setup(e,{slots:t}){const i=wr(),a=Se({}),d=ee(()=>{let Y=i.parent;for(;Y&&!Y.tableId;)Y=Y.parent;return Y}),{registerNormalWatchers:p,registerComplexWatchers:_}=sue(d,e),{columnId:r,isSubColumn:S,realHeaderAlign:C,columnOrTableParent:M,setColumnWidth:k,setColumnForcedProps:z,setColumnRenders:F,getPropsData:B,getColumnElIndex:N,realAlign:j,updateColumnOrder:U}=aue(e,t,d),te=M.value;r.value=`${te.tableId||te.columnId}_column_${cue++}`,fy(()=>{S.value=d.value!==te;const Y=e.type||"default",q=e.sortable===""?!0:e.sortable,J=oo(e.showOverflowTooltip)?te.props.showOverflowTooltip:e.showOverflowTooltip,ne=oo(e.tooltipFormatter)?te.props.tooltipFormatter:e.tooltipFormatter,se={...tue[Y],id:r.value,type:Y,property:e.prop||e.property,align:j,headerAlign:C,showOverflowTooltip:J,tooltipFormatter:ne,filterable:e.filters||e.filterMethod,filteredValue:[],filterPlacement:"",filterClassName:"",isColumnGroup:!1,isSubColumn:!1,filterOpened:!1,sortable:q,index:e.index,rawColumnKey:i.vnode.key};let de=B(["columnKey","label","className","labelClassName","type","renderHeader","formatter","fixed","resizable"],["sortMethod","sortBy","sortOrders"],["selectable","reserveSelection"],["filterMethod","filters","filterMultiple","filterOpened","filteredValue","filterPlacement","filterClassName"]);de=rce(se,de),de=ice(F,k,z)(de),a.value=de,p(),_()}),gr(()=>{var Y;const q=M.value,J=S.value?q.vnode.el.children:(Y=q.refs.hiddenColumns)==null?void 0:Y.children,ne=()=>N(J||[],i.vnode.el);a.value.getColumnIndex=ne,ne()>-1&&d.value.store.commit("insertColumn",a.value,S.value?q.columnConfig.value:null,U)}),Oo(()=>{const Y=a.value.getColumnIndex;(Y?Y():-1)>-1&&d.value.store.commit("removeColumn",a.value,S.value?te.columnConfig.value:null,U)}),i.columnId=r.value,i.columnConfig=a},render(){var e,t,i;try{const a=(t=(e=this.$slots).default)==null?void 0:t.call(e,{row:{},column:{},$index:-1}),d=[];if(ln(a))for(const _ of a)((i=_.type)==null?void 0:i.name)==="ElTableColumn"||_.shapeFlag&2?d.push(_):_.type===Bn&&ln(_.children)&&_.children.forEach(r=>{(r==null?void 0:r.patchFlag)!==1024&&!Dn(r==null?void 0:r.children)&&d.push(r)});return Kn("div",d)}catch{return Kn("div",[])}}});const uue=ur(Qce,{TableColumn:mN}),due=ri(mN);var oy=(e=>(e.ASC="asc",e.DESC="desc",e))(oy||{}),iy=(e=>(e.CENTER="center",e.RIGHT="right",e))(iy||{}),gN=(e=>(e.LEFT="left",e.RIGHT="right",e))(gN||{});const BT={asc:"desc",desc:"asc"},sy=Symbol("placeholder"),hue=(e,t,i)=>{var a;const d={flexGrow:0,flexShrink:0,...i?{}:{flexGrow:e.flexGrow||0,flexShrink:e.flexShrink||1}};i||(d.flexShrink=1);const p={...(a=e.style)!=null?a:{},...d,flexBasis:"auto",width:e.width};return t||(e.maxWidth&&(p.maxWidth=e.maxWidth),e.minWidth&&(p.minWidth=e.minWidth)),p};function fue(e,t,i){const a=ee(()=>b(t).map((j,U)=>{var te,Y;return{...j,key:(Y=(te=j.key)!=null?te:j.dataKey)!=null?Y:U}})),d=ee(()=>b(a).filter(j=>!j.hidden)),p=ee(()=>b(d).filter(j=>j.fixed==="left"||j.fixed===!0)),_=ee(()=>b(d).filter(j=>j.fixed==="right")),r=ee(()=>b(d).filter(j=>!j.fixed)),S=ee(()=>{const j=[];return b(p).forEach(U=>{j.push({...U,placeholderSign:sy})}),b(r).forEach(U=>{j.push(U)}),b(_).forEach(U=>{j.push({...U,placeholderSign:sy})}),j}),C=ee(()=>b(p).length||b(_).length),M=ee(()=>b(a).reduce((j,U)=>(j[U.key]=hue(U,b(i),e.fixed),j),{})),k=ee(()=>b(d).reduce((j,U)=>j+U.width,0)),z=j=>b(a).find(U=>U.key===j),F=j=>b(M)[j],B=(j,U)=>{j.width=U};function N(j){var U;const{key:te}=j.currentTarget.dataset;if(!te)return;const{sortState:Y,sortBy:q}=e;let J=oy.ASC;yr(Y)?J=BT[Y[te]]:J=BT[q.order],(U=e.onColumnSort)==null||U.call(e,{column:z(te),key:te,order:J})}return{columns:a,columnsStyles:M,columnsTotalWidth:k,fixedColumnsOnLeft:p,fixedColumnsOnRight:_,hasFixedColumns:C,mainColumns:S,normalColumns:r,visibleColumns:d,getColumn:z,getColumnStyle:F,updateColumnWidth:B,onColumnSorted:N}}const pue=(e,{mainTableRef:t,leftTableRef:i,rightTableRef:a,onMaybeEndReached:d})=>{const p=Se({scrollLeft:0,scrollTop:0});function _(F){var B,N,j;const{scrollTop:U}=F;(B=t.value)==null||B.scrollTo(F),(N=i.value)==null||N.scrollToTop(U),(j=a.value)==null||j.scrollToTop(U)}function r(F){p.value=F,_(F)}function S(F){p.value.scrollTop=F,_(b(p))}function C(F){var B,N;p.value.scrollLeft=F,(N=(B=t.value)==null?void 0:B.scrollTo)==null||N.call(B,b(p))}function M(F){var B;r(F),(B=e.onScroll)==null||B.call(e,F)}function k({scrollTop:F}){const{scrollTop:B}=b(p);F!==B&&S(F)}function z(F,B="auto"){var N;(N=t.value)==null||N.scrollToRow(F,B)}return qt(()=>b(p).scrollTop,(F,B)=>{F>B&&d()}),{scrollPos:p,scrollTo:r,scrollToLeft:C,scrollToTop:S,scrollToRow:z,onScroll:M,onVerticalScroll:k}},mue=(e,{mainTableRef:t,leftTableRef:i,rightTableRef:a,tableInstance:d,ns:p,isScrolling:_})=>{const r=wr(),{emit:S}=r,C=Uo(!1),M=Se(e.defaultExpandedRowKeys||[]),k=Se(-1),z=Uo(null),F=Se({}),B=Se({}),N=Uo({}),j=Uo({}),U=Uo({}),te=ee(()=>Gn(e.estimatedRowHeight));function Y(le){var ge;(ge=e.onRowsRendered)==null||ge.call(e,le),le.rowCacheEnd>b(k)&&(k.value=le.rowCacheEnd)}function q({hovered:le,rowKey:ge}){if(_.value)return;d.vnode.el.querySelectorAll(`[rowkey="${String(ge)}"]`).forEach(We=>{le?We.classList.add(p.is("hovered")):We.classList.remove(p.is("hovered"))})}function J({expanded:le,rowData:ge,rowIndex:de,rowKey:ke}){var We,we;const be=[...b(M)],Me=be.indexOf(ke);le?Me===-1&&be.push(ke):Me>-1&&be.splice(Me,1),M.value=be,S("update:expandedRowKeys",be),(We=e.onRowExpand)==null||We.call(e,{expanded:le,rowData:ge,rowIndex:de,rowKey:ke}),(we=e.onExpandedRowsChange)==null||we.call(e,be)}const ne=Ra(()=>{var le,ge,de,ke;C.value=!0,F.value={...b(F),...b(B)},se(b(z),!1),B.value={},z.value=null,(le=t.value)==null||le.forceUpdate(),(ge=i.value)==null||ge.forceUpdate(),(de=a.value)==null||de.forceUpdate(),(ke=r.proxy)==null||ke.$forceUpdate(),C.value=!1},0);function se(le,ge=!1){b(te)&&[t,i,a].forEach(de=>{const ke=b(de);ke&&ke.resetAfterRowIndex(le,ge)})}function fe(le,ge,de){const ke=b(z);(ke===null||ke>de)&&(z.value=de),B.value[le]=ge}function ce({rowKey:le,height:ge,rowIndex:de},ke){ke?ke===gN.RIGHT?U.value[le]=ge:N.value[le]=ge:j.value[le]=ge;const We=Math.max(...[N,U,j].map(we=>we.value[le]||0));b(F)[le]!==We&&(fe(le,We,de),ne())}return{expandedRowKeys:M,lastRenderedRowIndex:k,isDynamic:te,isResetting:C,rowHeights:F,resetAfterIndex:se,onRowExpanded:J,onRowHovered:q,onRowsRendered:Y,onRowHeightChange:ce}},gue=(e,{expandedRowKeys:t,lastRenderedRowIndex:i,resetAfterIndex:a})=>{const d=Se({}),p=ee(()=>{const r={},{data:S,rowKey:C}=e,M=b(t);if(!M||!M.length)return S;const k=[],z=new Set;M.forEach(B=>z.add(B));let F=S.slice();for(F.forEach(B=>r[B[C]]=0);F.length>0;){const B=F.shift();k.push(B),z.has(B[C])&&ln(B.children)&&B.children.length>0&&(F=[...B.children,...F],B.children.forEach(N=>r[N[C]]=r[B[C]]+1))}return d.value=r,k}),_=ee(()=>{const{data:r,expandColumnKey:S}=e;return S?b(p):r});return qt(_,(r,S)=>{r!==S&&(i.value=-1,a(0,!0))}),{data:_,depthMap:d}},vue=(e,t)=>e+t,t1=e=>ln(e)?e.reduce(vue,0):e,zf=(e,t,i={})=>Nn(e)?e(t):e??i,Bd=e=>(["width","maxWidth","minWidth","height"].forEach(t=>{e[t]=ui(e[t])}),e),vN=e=>Ho(e)?t=>Kn(e,t):e,_ue=(e,{columnsTotalWidth:t,rowsHeight:i,fixedColumnsOnLeft:a,fixedColumnsOnRight:d})=>{const p=ee(()=>{const{fixed:te,width:Y,vScrollbarSize:q}=e,J=Y-q;return te?Math.max(Math.round(b(t)),J):J}),_=ee(()=>b(p)+e.vScrollbarSize),r=ee(()=>{const{height:te=0,maxHeight:Y=0,footerHeight:q,hScrollbarSize:J}=e;if(Y>0){const ne=b(F),se=b(i),ce=b(z)+ne+se+J;return Math.min(ce,Y-q)}return te-q}),S=ee(()=>{const{maxHeight:te}=e,Y=b(r);if(Gn(te)&&te>0)return Y;const q=b(i)+b(z)+b(F);return Math.min(Y,q)}),C=te=>te.width,M=ee(()=>t1(b(a).map(C))),k=ee(()=>t1(b(d).map(C))),z=ee(()=>t1(e.headerHeight)),F=ee(()=>{var te;return(((te=e.fixedData)==null?void 0:te.length)||0)*e.rowHeight}),B=ee(()=>b(r)-b(z)-b(F)),N=ee(()=>{const{style:te={},height:Y,width:q}=e;return Bd({...te,height:Y,width:q})}),j=ee(()=>Bd({height:e.footerHeight})),U=ee(()=>({top:ui(b(z)),bottom:ui(e.footerHeight),width:ui(e.width)}));return{bodyWidth:p,fixedTableHeight:S,mainTableHeight:r,leftTableWidth:M,rightTableWidth:k,headerWidth:_,windowHeight:B,footerHeight:j,emptyStyle:U,rootStyle:N,headerHeight:z}};function yue(e){const t=Se(),i=Se(),a=Se(),{columns:d,columnsStyles:p,columnsTotalWidth:_,fixedColumnsOnLeft:r,fixedColumnsOnRight:S,hasFixedColumns:C,mainColumns:M,onColumnSorted:k}=fue(e,po(e,"columns"),po(e,"fixed")),{scrollTo:z,scrollToLeft:F,scrollToTop:B,scrollToRow:N,onScroll:j,onVerticalScroll:U,scrollPos:te}=pue(e,{mainTableRef:t,leftTableRef:i,rightTableRef:a,onMaybeEndReached:nt}),Y=en("table-v2"),q=wr(),J=Uo(!1),{expandedRowKeys:ne,lastRenderedRowIndex:se,isDynamic:fe,isResetting:ce,rowHeights:le,resetAfterIndex:ge,onRowExpanded:de,onRowHeightChange:ke,onRowHovered:We,onRowsRendered:we}=mue(e,{mainTableRef:t,leftTableRef:i,rightTableRef:a,tableInstance:q,ns:Y,isScrolling:J}),{data:be,depthMap:Me}=gue(e,{expandedRowKeys:ne,lastRenderedRowIndex:se,resetAfterIndex:ge}),Ae=ee(()=>{const{estimatedRowHeight:Qe,rowHeight:Yt}=e,Xt=b(be);return Gn(Qe)?Object.values(b(le)).reduce(($t,Ot)=>$t+Ot,0):Xt.length*Yt}),{bodyWidth:me,fixedTableHeight:Be,mainTableHeight:Ve,leftTableWidth:bt,rightTableWidth:Pe,headerWidth:wt,windowHeight:Mt,footerHeight:Nt,emptyStyle:vt,rootStyle:Bt,headerHeight:Wt}=_ue(e,{columnsTotalWidth:_,fixedColumnsOnLeft:r,fixedColumnsOnRight:S,rowsHeight:Ae}),Fe=Se(),cn=ee(()=>{const Qe=b(be).length===0;return ln(e.fixedData)?e.fixedData.length===0&&Qe:Qe});function Re(Qe){const{estimatedRowHeight:Yt,rowHeight:Xt,rowKey:$t}=e;return Yt?b(le)[b(be)[Qe][$t]]||Yt:Xt}function nt(){const{onEndReached:Qe}=e;if(!Qe)return;const{scrollTop:Yt}=b(te),Xt=b(Ae),$t=b(Mt),Ot=Xt-(Yt+$t)+e.hScrollbarSize;b(se)>=0&&Xt===Yt+b(Ve)-b(Wt)&&Qe(Ot)}return qt(()=>e.expandedRowKeys,Qe=>ne.value=Qe,{deep:!0}),{columns:d,containerRef:Fe,mainTableRef:t,leftTableRef:i,rightTableRef:a,isDynamic:fe,isResetting:ce,isScrolling:J,hasFixedColumns:C,columnsStyles:p,columnsTotalWidth:_,data:be,expandedRowKeys:ne,depthMap:Me,fixedColumnsOnLeft:r,fixedColumnsOnRight:S,mainColumns:M,bodyWidth:me,emptyStyle:vt,rootStyle:Bt,headerWidth:wt,footerHeight:Nt,mainTableHeight:Ve,fixedTableHeight:Be,leftTableWidth:bt,rightTableWidth:Pe,showEmpty:cn,getRowHeight:Re,onColumnSorted:k,onRowHovered:We,onRowExpanded:de,onRowsRendered:we,onRowHeightChange:ke,scrollTo:z,scrollToLeft:F,scrollToTop:B,scrollToRow:N,onScroll:j,onVerticalScroll:U}}const ZE=Symbol("tableV2"),_N=String,My={type:dt(Array),required:!0},YE={type:dt(Array)},yN={...YE,required:!0},bue=String,eO={type:dt(Array),default:()=>ni([])},vf={type:Number,required:!0},bN={type:dt([String,Number,Symbol]),default:"id"},tO={type:dt(Object)},xf=un({class:String,columns:My,columnsStyles:{type:dt(Object),required:!0},depth:Number,expandColumnKey:bue,estimatedRowHeight:{...If.estimatedRowHeight,default:void 0},isScrolling:Boolean,onRowExpand:{type:dt(Function)},onRowHover:{type:dt(Function)},onRowHeightChange:{type:dt(Function)},rowData:{type:dt(Object),required:!0},rowEventHandlers:{type:dt(Object)},rowIndex:{type:Number,required:!0},rowKey:bN,style:{type:dt(Object)}}),_S={type:Number,required:!0},XE=un({class:String,columns:My,fixedHeaderData:{type:dt(Array)},headerData:{type:dt(Array),required:!0},headerHeight:{type:dt([Number,Array]),default:50},rowWidth:_S,rowHeight:{type:Number,default:50},height:_S,width:_S}),n1=un({columns:My,data:yN,fixedData:YE,estimatedRowHeight:xf.estimatedRowHeight,width:vf,height:vf,headerWidth:vf,headerHeight:XE.headerHeight,bodyWidth:vf,rowHeight:vf,cache:$4.cache,useIsScrolling:Boolean,scrollbarAlwaysOn:If.scrollbarAlwaysOn,scrollbarStartGap:If.scrollbarStartGap,scrollbarEndGap:If.scrollbarEndGap,class:_N,style:tO,containerStyle:tO,getRowHeight:{type:dt(Function),required:!0},rowKey:xf.rowKey,onRowsRendered:{type:dt(Function)},onScroll:{type:dt(Function)}}),xue=un({cache:n1.cache,estimatedRowHeight:xf.estimatedRowHeight,rowKey:bN,headerClass:{type:dt([String,Function])},headerProps:{type:dt([Object,Function])},headerCellProps:{type:dt([Object,Function])},headerHeight:XE.headerHeight,footerHeight:{type:Number,default:0},rowClass:{type:dt([String,Function])},rowProps:{type:dt([Object,Function])},rowHeight:{type:Number,default:50},cellProps:{type:dt([Object,Function])},columns:My,data:yN,dataGetter:{type:dt(Function)},fixedData:YE,expandColumnKey:xf.expandColumnKey,expandedRowKeys:eO,defaultExpandedRowKeys:eO,class:_N,fixed:Boolean,style:{type:dt(Object)},width:vf,height:vf,maxHeight:Number,useIsScrolling:Boolean,indentSize:{type:Number,default:12},iconSize:{type:Number,default:12},hScrollbarSize:If.hScrollbarSize,vScrollbarSize:If.vScrollbarSize,scrollbarAlwaysOn:H4.alwaysOn,sortBy:{type:dt(Object),default:()=>({})},sortState:{type:dt(Object),default:void 0},onColumnSort:{type:dt(Function)},onExpandedRowsChange:{type:dt(Function)},onEndReached:{type:dt(Function)},onRowExpand:xf.onRowExpand,onScroll:n1.onScroll,onRowsRendered:n1.onRowsRendered,rowEventHandlers:xf.rowEventHandlers}),wue="ElTableV2Header",Sue=qe({name:wue,props:XE,setup(e,{slots:t,expose:i}){const a=en("table-v2"),d=An("tableV2GridScrollLeft"),p=Se(),_=ee(()=>Bd({width:e.width,height:e.height})),r=ee(()=>Bd({width:e.rowWidth,height:e.height})),S=ee(()=>Vs(b(e.headerHeight))),C=z=>{const F=b(p);Vn(()=>{F!=null&&F.scroll&&F.scroll({left:z})})},M=()=>{const z=a.e("fixed-header-row"),{columns:F,fixedHeaderData:B,rowHeight:N}=e;return B==null?void 0:B.map((j,U)=>{var te;const Y=Bd({height:N,width:"100%"});return(te=t.fixed)==null?void 0:te.call(t,{class:z,columns:F,rowData:j,rowIndex:-(U+1),style:Y})})},k=()=>{const z=a.e("dynamic-header-row"),{columns:F}=e;return b(S).map((B,N)=>{var j;const U=Bd({width:"100%",height:B});return(j=t.dynamic)==null?void 0:j.call(t,{class:z,columns:F,headerIndex:N,style:U})})};return hc(()=>{d!=null&&d.value&&C(d.value)}),i({scrollToLeft:C}),()=>{if(!(e.height<=0))return Ze("div",{ref:p,class:e.class,style:b(_),role:"rowgroup"},[Ze("div",{style:b(r),class:a.e("header")},[k(),M()])])}}});var Tue=Sue;const Cue=({atXEndEdge:e,atXStartEdge:t,atYEndEdge:i,atYStartEdge:a},d)=>{let p=null,_=0,r=0;const S=(M,k)=>{const z=M<=0&&t.value||M>=0&&e.value,F=k<=0&&a.value||k>=0&&i.value;return z&&F};return{hasReachedEdge:S,onWheel:M=>{Lf(p);let k=M.deltaX,z=M.deltaY;Math.abs(k)>Math.abs(z)?z=0:k=0,M.shiftKey&&z!==0&&(k=z,z=0),!(S(_,r)&&S(_+k,r+z))&&(_+=k,r+=z,M.preventDefault(),p=qd(()=>{d(_,r),_=0,r=0}))}}},xN=({name:e,clearCache:t,getColumnPosition:i,getColumnStartIndexForOffset:a,getColumnStopIndexForStartIndex:d,getEstimatedTotalHeight:p,getEstimatedTotalWidth:_,getColumnOffset:r,getRowOffset:S,getRowPosition:C,getRowStartIndexForOffset:M,getRowStopIndexForStartIndex:k,initCache:z,injectToInstance:F,validateProps:B})=>qe({name:e??"ElVirtualList",props:If,emits:[I1,A1],setup(N,{emit:j,expose:U,slots:te}){const Y=en("vl");B(N);const q=wr(),J=Se(z(N,q));F==null||F(q,J);const ne=Se(),se=Se(),fe=Se(),ce=Se(null),le=Se({isScrolling:!1,scrollLeft:Gn(N.initScrollLeft)?N.initScrollLeft:0,scrollTop:Gn(N.initScrollTop)?N.initScrollTop:0,updateRequested:!1,xAxisScrollDir:hm,yAxisScrollDir:hm}),ge=N4(),de=ee(()=>Number.parseInt(`${N.height}`,10)),ke=ee(()=>Number.parseInt(`${N.width}`,10)),We=ee(()=>{const{totalColumn:$t,totalRow:Ot,columnCache:Ft}=N,{isScrolling:sn,xAxisScrollDir:an,scrollLeft:Pn}=b(le);if($t===0||Ot===0)return[0,0,0,0];const bn=a(N,Pn,b(J)),It=d(N,bn,Pn,b(J)),Sn=!sn||an===k1?Math.max(1,Ft):1,Yn=!sn||an===hm?Math.max(1,Ft):1;return[Math.max(0,bn-Sn),Math.max(0,Math.min($t-1,It+Yn)),bn,It]}),we=ee(()=>{const{totalColumn:$t,totalRow:Ot,rowCache:Ft}=N,{isScrolling:sn,yAxisScrollDir:an,scrollTop:Pn}=b(le);if($t===0||Ot===0)return[0,0,0,0];const bn=M(N,Pn,b(J)),It=k(N,bn,Pn,b(J)),Sn=!sn||an===k1?Math.max(1,Ft):1,Yn=!sn||an===hm?Math.max(1,Ft):1;return[Math.max(0,bn-Sn),Math.max(0,Math.min(Ot-1,It+Yn)),bn,It]}),be=ee(()=>p(N,b(J))),Me=ee(()=>_(N,b(J))),Ae=ee(()=>{var $t;return[{position:"relative",overflow:"hidden",WebkitOverflowScrolling:"touch",willChange:"transform"},{direction:N.direction,height:Gn(N.height)?`${N.height}px`:N.height,width:Gn(N.width)?`${N.width}px`:N.width},($t=N.style)!=null?$t:{}]}),me=ee(()=>{const $t=`${b(Me)}px`;return{height:`${b(be)}px`,pointerEvents:b(le).isScrolling?"none":void 0,width:$t}}),Be=()=>{const{totalColumn:$t,totalRow:Ot}=N;if($t>0&&Ot>0){const[It,Sn,Yn,vr]=b(We),[tr,zr,Cr,Io]=b(we);j(I1,{columnCacheStart:It,columnCacheEnd:Sn,rowCacheStart:tr,rowCacheEnd:zr,columnVisibleStart:Yn,columnVisibleEnd:vr,rowVisibleStart:Cr,rowVisibleEnd:Io})}const{scrollLeft:Ft,scrollTop:sn,updateRequested:an,xAxisScrollDir:Pn,yAxisScrollDir:bn}=b(le);j(A1,{xAxisScrollDir:Pn,scrollLeft:Ft,yAxisScrollDir:bn,scrollTop:sn,updateRequested:an})},Ve=$t=>{const{clientHeight:Ot,clientWidth:Ft,scrollHeight:sn,scrollLeft:an,scrollTop:Pn,scrollWidth:bn}=$t.currentTarget,It=b(le);if(It.scrollTop===Pn&&It.scrollLeft===an)return;let Sn=an;if(BR(N.direction))switch(R1()){case ny:Sn=-an;break;case HE:Sn=bn-Ft-an;break}le.value={...It,isScrolling:!0,scrollLeft:Sn,scrollTop:Math.max(0,Math.min(Pn,sn-Ot)),updateRequested:!0,xAxisScrollDir:bf(It.scrollLeft,Sn),yAxisScrollDir:bf(It.scrollTop,Pn)},Vn(()=>Bt()),Wt(),Be()},bt=($t,Ot)=>{const Ft=b(de),sn=(be.value-Ft)/Ot*$t;Mt({scrollTop:Math.min(be.value-Ft,sn)})},Pe=($t,Ot)=>{const Ft=b(ke),sn=(Me.value-Ft)/Ot*$t;Mt({scrollLeft:Math.min(Me.value-Ft,sn)})},{onWheel:wt}=Cue({atXStartEdge:ee(()=>le.value.scrollLeft<=0),atXEndEdge:ee(()=>le.value.scrollLeft>=Me.value-b(ke)),atYStartEdge:ee(()=>le.value.scrollTop<=0),atYEndEdge:ee(()=>le.value.scrollTop>=be.value-b(de))},($t,Ot)=>{var Ft,sn,an,Pn;(sn=(Ft=se.value)==null?void 0:Ft.onMouseUp)==null||sn.call(Ft),(Pn=(an=fe.value)==null?void 0:an.onMouseUp)==null||Pn.call(an);const bn=b(ke),It=b(de);Mt({scrollLeft:Math.min(le.value.scrollLeft+$t,Me.value-bn),scrollTop:Math.min(le.value.scrollTop+Ot,be.value-It)})});So(ne,"wheel",wt,{passive:!1});const Mt=({scrollLeft:$t=le.value.scrollLeft,scrollTop:Ot=le.value.scrollTop})=>{$t=Math.max($t,0),Ot=Math.max(Ot,0);const Ft=b(le);Ot===Ft.scrollTop&&$t===Ft.scrollLeft||(le.value={...Ft,xAxisScrollDir:bf(Ft.scrollLeft,$t),yAxisScrollDir:bf(Ft.scrollTop,Ot),scrollLeft:$t,scrollTop:Ot,updateRequested:!0},Vn(()=>Bt()),Wt(),Be())},Nt=($t=0,Ot=0,Ft=xl)=>{const sn=b(le);Ot=Math.max(0,Math.min(Ot,N.totalColumn-1)),$t=Math.max(0,Math.min($t,N.totalRow-1));const an=Tz(Y.namespace.value),Pn=b(J),bn=p(N,Pn),It=_(N,Pn);Mt({scrollLeft:r(N,Ot,Ft,sn.scrollLeft,Pn,It>N.width?an:0),scrollTop:S(N,$t,Ft,sn.scrollTop,Pn,bn>N.height?an:0)})},vt=($t,Ot)=>{const{columnWidth:Ft,direction:sn,rowHeight:an}=N,Pn=ge.value(t&&Ft,t&&an,t&&sn),bn=`${$t},${Ot}`;if(to(Pn,bn))return Pn[bn];{const[,It]=i(N,Ot,b(J)),Sn=b(J),Yn=BR(sn),[vr,tr]=C(N,$t,Sn),[zr]=i(N,Ot,Sn);return Pn[bn]={position:"absolute",left:Yn?void 0:`${It}px`,right:Yn?`${It}px`:void 0,top:`${tr}px`,height:`${vr}px`,width:`${zr}px`},Pn[bn]}},Bt=()=>{le.value.isScrolling=!1,Vn(()=>{ge.value(-1,null,null)})};gr(()=>{if(!Hr)return;const{initScrollLeft:$t,initScrollTop:Ot}=N,Ft=b(ne);Ft&&(Gn($t)&&(Ft.scrollLeft=$t),Gn(Ot)&&(Ft.scrollTop=Ot)),Be()});const Wt=()=>{const{direction:$t}=N,{scrollLeft:Ot,scrollTop:Ft,updateRequested:sn}=b(le),an=b(ne);if(sn&&an){if($t===xm)switch(R1()){case ny:{an.scrollLeft=-Ot;break}case jE:{an.scrollLeft=Ot;break}default:{const{clientWidth:Pn,scrollWidth:bn}=an;an.scrollLeft=bn-Pn-Ot;break}}else an.scrollLeft=Math.max(0,Ot);an.scrollTop=Math.max(0,Ft)}},{resetAfterColumnIndex:Fe,resetAfterRowIndex:cn,resetAfter:Re}=q.proxy;U({windowRef:ne,innerRef:ce,getItemStyleCache:ge,scrollTo:Mt,scrollToItem:Nt,states:le,resetAfterColumnIndex:Fe,resetAfterRowIndex:cn,resetAfter:Re});const nt=()=>{const{scrollbarAlwaysOn:$t,scrollbarStartGap:Ot,scrollbarEndGap:Ft,totalColumn:sn,totalRow:an}=N,Pn=b(ke),bn=b(de),It=b(Me),Sn=b(be),{scrollLeft:Yn,scrollTop:vr}=b(le),tr=Kn(IT,{ref:se,alwaysOn:$t,startGap:Ot,endGap:Ft,class:Y.e("horizontal"),clientSize:Pn,layout:"horizontal",onScroll:Pe,ratio:Pn*100/It,scrollFrom:Yn/(It-Pn),total:an,visible:!0}),zr=Kn(IT,{ref:fe,alwaysOn:$t,startGap:Ot,endGap:Ft,class:Y.e("vertical"),clientSize:bn,layout:"vertical",onScroll:bt,ratio:bn*100/Sn,scrollFrom:vr/(Sn-bn),total:sn,visible:!0});return{horizontalScrollbar:tr,verticalScrollbar:zr}},Qe=()=>{var $t;const[Ot,Ft]=b(We),[sn,an]=b(we),{data:Pn,totalColumn:bn,totalRow:It,useIsScrolling:Sn,itemKey:Yn}=N,vr=[];if(It>0&&bn>0)for(let tr=sn;tr<=an;tr++)for(let zr=Ot;zr<=Ft;zr++){const Cr=Yn({columnIndex:zr,data:Pn,rowIndex:tr});vr.push(Kn(Bn,{key:Cr},($t=te.default)==null?void 0:$t.call(te,{columnIndex:zr,data:Pn,isScrolling:Sn?b(le).isScrolling:void 0,style:vt(tr,zr),rowIndex:tr})))}return vr},Yt=()=>{const $t=Tr(N.innerElement),Ot=Qe();return[Kn($t,{style:b(me),ref:ce},Dn($t)?Ot:{default:()=>Ot})]};return()=>{const $t=Tr(N.containerElement),{horizontalScrollbar:Ot,verticalScrollbar:Ft}=nt(),sn=Yt();return Kn("div",{key:0,class:Y.e("wrapper"),role:N.role},[Kn($t,{class:N.className,style:b(Ae),onScroll:Ve,ref:ne},Dn($t)?sn:{default:()=>sn}),Ot,Ft])}}}),{max:D1,min:wN,floor:SN}=Math,Eue={column:"columnWidth",row:"rowHeight"},VT={column:"lastVisitedColumnIndex",row:"lastVisitedRowIndex"},Iu=(e,t,i,a)=>{const[d,p,_]=[i[a],e[Eue[a]],i[VT[a]]];if(t>_){let r=0;if(_>=0){const S=d[_];r=S.offset+S.size}for(let S=_+1;S<=t;S++){const C=p(S);d[S]={offset:r,size:C},r+=C}i[VT[a]]=t}return d[t]},TN=(e,t,i,a,d,p)=>{for(;i<=a;){const _=i+SN((a-i)/2),r=Iu(e,_,t,p).offset;if(r===d)return _;r<d?i=_+1:a=_-1}return D1(0,i-1)},Mue=(e,t,i,a,d)=>{const p=d==="column"?e.totalColumn:e.totalRow;let _=1;for(;i<p&&Iu(e,i,t,d).offset<a;)i+=_,_*=2;return TN(e,t,SN(i/2),wN(i,p-1),a,d)},nO=(e,t,i,a)=>{const[d,p]=[t[a],t[VT[a]]];return(p>0?d[p].offset:0)>=i?TN(e,t,0,p,i,a):Mue(e,t,D1(0,p),i,a)},CN=({totalRow:e},{estimatedRowHeight:t,lastVisitedRowIndex:i,row:a})=>{let d=0;if(i>=e&&(i=e-1),i>=0){const r=a[i];d=r.offset+r.size}const _=(e-i-1)*t;return d+_},EN=({totalColumn:e},{column:t,estimatedColumnWidth:i,lastVisitedColumnIndex:a})=>{let d=0;if(a>e&&(a=e-1),a>=0){const r=t[a];d=r.offset+r.size}const _=(e-a-1)*i;return d+_},Iue={column:EN,row:CN},rO=(e,t,i,a,d,p,_)=>{const[r,S]=[p==="row"?e.height:e.width,Iue[p]],C=Iu(e,t,d,p),M=S(e,d),k=D1(0,wN(M-r,C.offset)),z=D1(0,C.offset-r+_+C.size);switch(i===Cx&&(a>=z-r&&a<=k+r?i=xl:i=Bc),i){case ey:return k;case ty:return z;case Bc:return Math.round(z+(k-z)/2);case xl:default:return a>=z&&a<=k?a:z>k||a<z?z:k}},Aue=xN({name:"ElDynamicSizeGrid",getColumnPosition:(e,t,i)=>{const a=Iu(e,t,i,"column");return[a.size,a.offset]},getRowPosition:(e,t,i)=>{const a=Iu(e,t,i,"row");return[a.size,a.offset]},getColumnOffset:(e,t,i,a,d,p)=>rO(e,t,i,a,d,"column",p),getRowOffset:(e,t,i,a,d,p)=>rO(e,t,i,a,d,"row",p),getColumnStartIndexForOffset:(e,t,i)=>nO(e,i,t,"column"),getColumnStopIndexForStartIndex:(e,t,i,a)=>{const d=Iu(e,t,a,"column"),p=i+e.width;let _=d.offset+d.size,r=t;for(;r<e.totalColumn-1&&_<p;)r++,_+=Iu(e,t,a,"column").size;return r},getEstimatedTotalHeight:CN,getEstimatedTotalWidth:EN,getRowStartIndexForOffset:(e,t,i)=>nO(e,i,t,"row"),getRowStopIndexForStartIndex:(e,t,i,a)=>{const{totalRow:d,height:p}=e,_=Iu(e,t,a,"row"),r=i+p;let S=_.size+_.offset,C=t;for(;C<d-1&&S<r;)C++,S+=Iu(e,C,a,"row").size;return C},injectToInstance:(e,t)=>{const i=({columnIndex:p,rowIndex:_},r)=>{var S,C;r=oo(r)?!0:r,Gn(p)&&(t.value.lastVisitedColumnIndex=Math.min(t.value.lastVisitedColumnIndex,p-1)),Gn(_)&&(t.value.lastVisitedRowIndex=Math.min(t.value.lastVisitedRowIndex,_-1)),(S=e.exposed)==null||S.getItemStyleCache.value(-1,null,null),r&&((C=e.proxy)==null||C.$forceUpdate())},a=(p,_)=>{i({columnIndex:p},_)},d=(p,_)=>{i({rowIndex:p},_)};Object.assign(e.proxy,{resetAfterColumnIndex:a,resetAfterRowIndex:d,resetAfter:i})},initCache:({estimatedColumnWidth:e=wT,estimatedRowHeight:t=wT})=>({column:{},estimatedColumnWidth:e,estimatedRowHeight:t,lastVisitedColumnIndex:-1,lastVisitedRowIndex:-1,row:{}}),clearCache:!1,validateProps:({columnWidth:e,rowHeight:t})=>{}}),kue=xN({name:"ElFixedSizeGrid",getColumnPosition:({columnWidth:e},t)=>[e,t*e],getRowPosition:({rowHeight:e},t)=>[e,t*e],getEstimatedTotalHeight:({totalRow:e,rowHeight:t})=>t*e,getEstimatedTotalWidth:({totalColumn:e,columnWidth:t})=>t*e,getColumnOffset:({totalColumn:e,columnWidth:t,width:i},a,d,p,_,r)=>{i=Number(i);const S=Math.max(0,e*t-i),C=Math.min(S,a*t),M=Math.max(0,a*t-i+r+t);switch(d==="smart"&&(p>=M-i&&p<=C+i?d=xl:d=Bc),d){case ey:return C;case ty:return M;case Bc:{const k=Math.round(M+(C-M)/2);return k<Math.ceil(i/2)?0:k>S+Math.floor(i/2)?S:k}case xl:default:return p>=M&&p<=C?p:M>C||p<M?M:C}},getRowOffset:({rowHeight:e,height:t,totalRow:i},a,d,p,_,r)=>{t=Number(t);const S=Math.max(0,i*e-t),C=Math.min(S,a*e),M=Math.max(0,a*e-t+r+e);switch(d===Cx&&(p>=M-t&&p<=C+t?d=xl:d=Bc),d){case ey:return C;case ty:return M;case Bc:{const k=Math.round(M+(C-M)/2);return k<Math.ceil(t/2)?0:k>S+Math.floor(t/2)?S:k}case xl:default:return p>=M&&p<=C?p:M>C||p<M?M:C}},getColumnStartIndexForOffset:({columnWidth:e,totalColumn:t},i)=>Math.max(0,Math.min(t-1,Math.floor(i/e))),getColumnStopIndexForStartIndex:({columnWidth:e,totalColumn:t,width:i},a,d)=>{const p=a*e,_=Math.ceil((i+d-p)/e);return Math.max(0,Math.min(t-1,a+_-1))},getRowStartIndexForOffset:({rowHeight:e,totalRow:t},i)=>Math.max(0,Math.min(t-1,Math.floor(i/e))),getRowStopIndexForStartIndex:({rowHeight:e,totalRow:t,height:i},a,d)=>{const p=a*e,_=Math.ceil((i+d-p)/e);return Math.max(0,Math.min(t-1,a+_-1))},initCache:()=>{},clearCache:!0,validateProps:({columnWidth:e,rowHeight:t})=>{}}),Pue="ElTableV2Grid",Rue=e=>{const t=Se(),i=Se(),a=Se(0),d=ee(()=>{const{data:j,rowHeight:U,estimatedRowHeight:te}=e;if(!te)return j.length*U}),p=ee(()=>{const{fixedData:j,rowHeight:U}=e;return((j==null?void 0:j.length)||0)*U}),_=ee(()=>t1(e.headerHeight)),r=ee(()=>{const{height:j}=e;return Math.max(0,j-b(_)-b(p))}),S=ee(()=>b(_)+b(p)>0),C=({data:j,rowIndex:U})=>j[U][e.rowKey];function M({rowCacheStart:j,rowCacheEnd:U,rowVisibleStart:te,rowVisibleEnd:Y}){var q;(q=e.onRowsRendered)==null||q.call(e,{rowCacheStart:j,rowCacheEnd:U,rowVisibleStart:te,rowVisibleEnd:Y})}function k(j,U){var te;(te=i.value)==null||te.resetAfterRowIndex(j,U)}function z(j,U){const te=b(t),Y=b(i);yr(j)?(te==null||te.scrollToLeft(j.scrollLeft),a.value=j.scrollLeft,Y==null||Y.scrollTo(j)):(te==null||te.scrollToLeft(j),a.value=j,Y==null||Y.scrollTo({scrollLeft:j,scrollTop:U}))}function F(j){var U;(U=b(i))==null||U.scrollTo({scrollTop:j})}function B(j,U){var te;(te=b(i))==null||te.scrollToItem(j,1,U)}function N(){var j,U;(j=b(i))==null||j.$forceUpdate(),(U=b(t))==null||U.$forceUpdate()}return qt(()=>e.bodyWidth,()=>{var j;Gn(e.estimatedRowHeight)&&((j=i.value)==null||j.resetAfter({columnIndex:0},!1))}),{bodyRef:i,forceUpdate:N,fixedRowHeight:p,gridHeight:r,hasHeader:S,headerHeight:_,headerRef:t,totalHeight:d,itemKey:C,onItemRendered:M,resetAfterRowIndex:k,scrollTo:z,scrollToTop:F,scrollToRow:B,scrollLeft:a}},Oue=qe({name:Pue,props:n1,setup(e,{slots:t,expose:i}){const{ns:a}=An(ZE),{bodyRef:d,fixedRowHeight:p,gridHeight:_,hasHeader:r,headerRef:S,headerHeight:C,totalHeight:M,forceUpdate:k,itemKey:z,onItemRendered:F,resetAfterRowIndex:B,scrollTo:N,scrollToTop:j,scrollToRow:U,scrollLeft:te}=Rue(e);Dr("tableV2GridScrollLeft",te),i({forceUpdate:k,totalHeight:M,scrollTo:N,scrollToTop:j,scrollToRow:U,resetAfterRowIndex:B});const Y=()=>e.bodyWidth;return()=>{const{cache:q,columns:J,data:ne,fixedData:se,useIsScrolling:fe,scrollbarAlwaysOn:ce,scrollbarEndGap:le,scrollbarStartGap:ge,style:de,rowHeight:ke,bodyWidth:We,estimatedRowHeight:we,headerWidth:be,height:Me,width:Ae,getRowHeight:me,onScroll:Be}=e,Ve=Gn(we),bt=Ve?Aue:kue,Pe=b(C);return Ze("div",{role:"table",class:[a.e("table"),e.class],style:de},[Ze(bt,{ref:d,data:ne,useIsScrolling:fe,itemKey:z,columnCache:0,columnWidth:Ve?Y:We,totalColumn:1,totalRow:ne.length,rowCache:q,rowHeight:Ve?me:ke,width:Ae,height:b(_),class:a.e("body"),role:"rowgroup",scrollbarStartGap:ge,scrollbarEndGap:le,scrollbarAlwaysOn:ce,onScroll:Be,onItemRendered:F,perfMode:!1},{default:wt=>{var Mt;const Nt=ne[wt.rowIndex];return(Mt=t.row)==null?void 0:Mt.call(t,{...wt,columns:J,rowData:Nt})}}),b(r)&&Ze(Tue,{ref:S,class:a.e("header-wrapper"),columns:J,headerData:ne,headerHeight:e.headerHeight,fixedHeaderData:se,rowWidth:be,rowHeight:ke,width:Ae,height:Math.min(Pe+b(p),Me)},{dynamic:t.header,fixed:t.row})])}}});var JE=Oue;function Lue(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!Ho(e)}const Due=(e,{slots:t})=>{const{mainTableRef:i,...a}=e;return Ze(JE,Mr({ref:i},a),Lue(t)?t:{default:()=>[t]})};var zue=Due;function Fue(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!Ho(e)}const Nue=(e,{slots:t})=>{if(!e.columns.length)return;const{leftTableRef:i,...a}=e;return Ze(JE,Mr({ref:i},a),Fue(t)?t:{default:()=>[t]})};var Bue=Nue;function Vue(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!Ho(e)}const $ue=(e,{slots:t})=>{if(!e.columns.length)return;const{rightTableRef:i,...a}=e;return Ze(JE,Mr({ref:i},a),Vue(t)?t:{default:()=>[t]})};var Uue=$ue;const jue=e=>{const{isScrolling:t}=An(ZE),i=Se(!1),a=Se(),d=ee(()=>Gn(e.estimatedRowHeight)&&e.rowIndex>=0),p=(S=!1)=>{const C=b(a);if(!C)return;const{columns:M,onRowHeightChange:k,rowKey:z,rowIndex:F,style:B}=e,{height:N}=C.getBoundingClientRect();i.value=!0,Vn(()=>{if(S||N!==Number.parseInt(B.height)){const j=M[0],U=(j==null?void 0:j.placeholderSign)===sy;k==null||k({rowKey:z,height:N,rowIndex:F},j&&!U&&j.fixed)}})},_=ee(()=>{const{rowData:S,rowIndex:C,rowKey:M,onRowHover:k}=e,z=e.rowEventHandlers||{},F={};return Object.entries(z).forEach(([B,N])=>{Nn(N)&&(F[B]=j=>{N({event:j,rowData:S,rowIndex:C,rowKey:M})})}),k&&[{name:"onMouseleave",hovered:!1},{name:"onMouseenter",hovered:!0}].forEach(({name:B,hovered:N})=>{const j=F[B];F[B]=U=>{k({event:U,hovered:N,rowData:S,rowIndex:C,rowKey:M}),j==null||j(U)}}),F}),r=S=>{const{onRowExpand:C,rowData:M,rowIndex:k,rowKey:z}=e;C==null||C({expanded:S,rowData:M,rowIndex:k,rowKey:z})};return gr(()=>{b(d)&&p(!0)}),{isScrolling:t,measurable:d,measured:i,rowRef:a,eventHandlers:_,onExpand:r}},Hue="ElTableV2TableRow",Gue=qe({name:Hue,props:xf,setup(e,{expose:t,slots:i,attrs:a}){const{eventHandlers:d,isScrolling:p,measurable:_,measured:r,rowRef:S,onExpand:C}=jue(e);return t({onExpand:C}),()=>{const{columns:M,columnsStyles:k,expandColumnKey:z,depth:F,rowData:B,rowIndex:N,style:j}=e;let U=M.map((te,Y)=>{const q=ln(B.children)&&B.children.length>0&&te.key===z;return i.cell({column:te,columns:M,columnIndex:Y,depth:F,style:k[te.key],rowData:B,rowIndex:N,isScrolling:b(p),expandIconProps:q?{rowData:B,rowIndex:N,onExpand:C}:void 0})});if(i.row&&(U=i.row({cells:U.map(te=>ln(te)&&te.length===1?te[0]:te),style:j,columns:M,depth:F,rowData:B,rowIndex:N,isScrolling:b(p)})),b(_)){const{height:te,...Y}=j||{},q=b(r);return Ze("div",Mr({ref:S,class:e.class,style:q?j:Y,role:"row"},a,b(d)),[U])}return Ze("div",Mr(a,{ref:S,class:e.class,style:j,role:"row"},b(d)),[U])}}});var Wue=Gue;function que(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!Ho(e)}const Kue=(e,{slots:t})=>{const{columns:i,columnsStyles:a,depthMap:d,expandColumnKey:p,expandedRowKeys:_,estimatedRowHeight:r,hasFixedColumns:S,rowData:C,rowIndex:M,style:k,isScrolling:z,rowProps:F,rowClass:B,rowKey:N,rowEventHandlers:j,ns:U,onRowHovered:te,onRowExpanded:Y}=e,q=zf(B,{columns:i,rowData:C,rowIndex:M},""),J=zf(F,{columns:i,rowData:C,rowIndex:M}),ne=C[N],se=d[ne]||0,fe=!!p,ce=M<0,le=[U.e("row"),q,{[U.e(`row-depth-${se}`)]:fe&&M>=0,[U.is("expanded")]:fe&&_.includes(ne),[U.is("fixed")]:!se&&ce,[U.is("customized")]:!!t.row}],ge=S?te:void 0,de={...J,columns:i,columnsStyles:a,class:le,depth:se,expandColumnKey:p,estimatedRowHeight:ce?void 0:r,isScrolling:z,rowIndex:M,rowData:C,rowKey:ne,rowEventHandlers:j,style:k};return Ze(Wue,Mr(de,{onRowExpand:Y,onMouseenter:we=>{ge==null||ge({hovered:!0,rowKey:ne,event:we,rowData:C,rowIndex:M})},onMouseleave:we=>{ge==null||ge({hovered:!1,rowKey:ne,event:we,rowData:C,rowIndex:M})},rowkey:ne}),que(t)?t:{default:()=>[t]})};var Zue=Kue;const QE=(e,{slots:t})=>{var i;const{cellData:a,style:d}=e,p=((i=a==null?void 0:a.toString)==null?void 0:i.call(a))||"",_=pt(t,"default",e,()=>[p]);return Ze("div",{class:e.class,title:p,style:d},[_])};QE.displayName="ElTableV2Cell";QE.inheritAttrs=!1;var Yue=QE;const Xue=e=>{const{expanded:t,expandable:i,onExpand:a,style:d,size:p}=e,_={onClick:i?()=>a(!t):void 0,class:e.class};return Ze(On,Mr(_,{size:p,style:d}),{default:()=>[Ze(ca,null,null)]})};var Jue=Xue;const MN=({columns:e,column:t,columnIndex:i,depth:a,expandIconProps:d,isScrolling:p,rowData:_,rowIndex:r,style:S,expandedRowKeys:C,ns:M,cellProps:k,expandColumnKey:z,indentSize:F,iconSize:B,rowKey:N},{slots:j})=>{const U=Bd(S);if(t.placeholderSign===sy)return Ze("div",{class:M.em("row-cell","placeholder"),style:U},null);const{cellRenderer:te,dataKey:Y,dataGetter:q}=t,J=Nn(q)?q({columns:e,column:t,columnIndex:i,rowData:_,rowIndex:r}):Ii(_,Y??""),ne=zf(k,{cellData:J,columns:e,column:t,columnIndex:i,rowIndex:r,rowData:_}),se={class:M.e("cell-text"),columns:e,column:t,columnIndex:i,cellData:J,isScrolling:p,rowData:_,rowIndex:r},fe=vN(te),ce=fe?fe(se):pt(j,"default",se,()=>[Ze(Yue,se,null)]),le=[M.e("row-cell"),t.class,t.align===iy.CENTER&&M.is("align-center"),t.align===iy.RIGHT&&M.is("align-right")],ge=r>=0&&z&&t.key===z,de=r>=0&&C.includes(_[N]);let ke;const We=`margin-inline-start: ${a*F}px;`;return ge&&(yr(d)?ke=Ze(Jue,Mr(d,{class:[M.e("expand-icon"),M.is("expanded",de)],size:B,expanded:de,style:We,expandable:!0}),null):ke=Ze("div",{style:[We,`width: ${B}px; height: ${B}px;`].join(" ")},null)),Ze("div",Mr({class:le,style:U},ne,{role:"cell"}),[ke,ce])};MN.inheritAttrs=!1;var oO=MN;const Que=un({class:String,columns:My,columnsStyles:{type:dt(Object),required:!0},headerIndex:Number,style:{type:dt(Object)}}),ede=qe({name:"ElTableV2HeaderRow",props:Que,setup(e,{slots:t}){return()=>{const{columns:i,columnsStyles:a,headerIndex:d,style:p}=e;let _=i.map((r,S)=>t.cell({columns:i,column:r,columnIndex:S,headerIndex:d,style:a[r.key]}));return t.header&&(_=t.header({cells:_.map(r=>ln(r)&&r.length===1?r[0]:r),columns:i,headerIndex:d})),Ze("div",{class:e.class,style:p,role:"row"},[_])}}});var tde=ede;function nde(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!Ho(e)}const rde=({columns:e,columnsStyles:t,headerIndex:i,style:a,headerClass:d,headerProps:p,ns:_},{slots:r})=>{const S={columns:e,headerIndex:i},C=[_.e("header-row"),zf(d,S,""),{[_.is("customized")]:!!r.header}],M={...zf(p,S),columnsStyles:t,class:C,columns:e,headerIndex:i,style:a};return Ze(tde,M,nde(r)?r:{default:()=>[r]})};var ode=rde;const eM=(e,{slots:t})=>pt(t,"default",e,()=>{var i,a;return[Ze("div",{class:e.class,title:(i=e.column)==null?void 0:i.title},[(a=e.column)==null?void 0:a.title])]});eM.displayName="ElTableV2HeaderCell";eM.inheritAttrs=!1;var ide=eM;const sde=e=>{const{sortOrder:t}=e;return Ze(On,{size:14,class:e.class},{default:()=>[t===oy.ASC?Ze(V7,null,null):Ze(N7,null,null)]})};var ade=sde;const lde=(e,{slots:t})=>{const{column:i,ns:a,style:d,onColumnSorted:p}=e,_=Bd(d);if(i.placeholderSign===sy)return Ze("div",{class:a.em("header-row-cell","placeholder"),style:_},null);const{headerCellRenderer:r,headerClass:S,sortable:C}=i,M={...e,class:a.e("header-cell-text")},k=vN(r),z=k?k(M):pt(t,"default",M,()=>[Ze(ide,M,null)]),{sortBy:F,sortState:B,headerCellProps:N}=e;let j,U;if(B){const q=B[i.key];j=!!BT[q],U=j?q:oy.ASC}else j=i.key===F.key,U=j?F.order:oy.ASC;const te=[a.e("header-cell"),zf(S,e,""),i.align===iy.CENTER&&a.is("align-center"),i.align===iy.RIGHT&&a.is("align-right"),C&&a.is("sortable")],Y={...zf(N,e),onClick:i.sortable?p:void 0,class:te,style:_,"data-key":i.key};return Ze("div",Mr(Y,{role:"columnheader"}),[z,C&&Ze(ade,{class:[a.e("sort-icon"),j&&a.is("sorting")],sortOrder:U},null)])};var iO=lde;const IN=(e,{slots:t})=>{var i;return Ze("div",{class:e.class,style:e.style},[(i=t.default)==null?void 0:i.call(t)])};IN.displayName="ElTableV2Footer";var cde=IN;const AN=(e,{slots:t})=>{const i=pt(t,"default",{},()=>[Ze(S4,null,null)]);return Ze("div",{class:e.class,style:e.style},[i])};AN.displayName="ElTableV2Empty";var ude=AN;const kN=(e,{slots:t})=>{var i;return Ze("div",{class:e.class,style:e.style},[(i=t.default)==null?void 0:i.call(t)])};kN.displayName="ElTableV2Overlay";var dde=kN;function d_(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!Ho(e)}const hde="ElTableV2",fde=qe({name:hde,props:xue,setup(e,{slots:t,expose:i}){const a=en("table-v2"),{columnsStyles:d,fixedColumnsOnLeft:p,fixedColumnsOnRight:_,mainColumns:r,mainTableHeight:S,fixedTableHeight:C,leftTableWidth:M,rightTableWidth:k,data:z,depthMap:F,expandedRowKeys:B,hasFixedColumns:N,mainTableRef:j,leftTableRef:U,rightTableRef:te,isDynamic:Y,isResetting:q,isScrolling:J,bodyWidth:ne,emptyStyle:se,rootStyle:fe,headerWidth:ce,footerHeight:le,showEmpty:ge,scrollTo:de,scrollToLeft:ke,scrollToTop:We,scrollToRow:we,getRowHeight:be,onColumnSorted:Me,onRowHeightChange:Ae,onRowHovered:me,onRowExpanded:Be,onRowsRendered:Ve,onScroll:bt,onVerticalScroll:Pe}=yue(e);return i({scrollTo:de,scrollToLeft:ke,scrollToTop:We,scrollToRow:we}),Dr(ZE,{ns:a,isResetting:q,isScrolling:J}),()=>{const{cache:wt,cellProps:Mt,estimatedRowHeight:Nt,expandColumnKey:vt,fixedData:Bt,headerHeight:Wt,headerClass:Fe,headerProps:cn,headerCellProps:Re,sortBy:nt,sortState:Qe,rowHeight:Yt,rowClass:Xt,rowEventHandlers:$t,rowKey:Ot,rowProps:Ft,scrollbarAlwaysOn:sn,indentSize:an,iconSize:Pn,useIsScrolling:bn,vScrollbarSize:It,width:Sn}=e,Yn=b(z),vr={cache:wt,class:a.e("main"),columns:b(r),data:Yn,fixedData:Bt,estimatedRowHeight:Nt,bodyWidth:b(ne)+It,headerHeight:Wt,headerWidth:b(ce),height:b(S),mainTableRef:j,rowKey:Ot,rowHeight:Yt,scrollbarAlwaysOn:sn,scrollbarStartGap:2,scrollbarEndGap:It,useIsScrolling:bn,width:Sn,getRowHeight:be,onRowsRendered:Ve,onScroll:bt},tr=b(M),zr=b(C),Cr={cache:wt,class:a.e("left"),columns:b(p),data:Yn,fixedData:Bt,estimatedRowHeight:Nt,leftTableRef:U,rowHeight:Yt,bodyWidth:tr,headerWidth:tr,headerHeight:Wt,height:zr,rowKey:Ot,scrollbarAlwaysOn:sn,scrollbarStartGap:2,scrollbarEndGap:It,useIsScrolling:bn,width:tr,getRowHeight:be,onScroll:Pe},jn=b(k)+It,Gt={cache:wt,class:a.e("right"),columns:b(_),data:Yn,fixedData:Bt,estimatedRowHeight:Nt,rightTableRef:te,rowHeight:Yt,bodyWidth:jn,headerWidth:jn,headerHeight:Wt,height:zr,rowKey:Ot,scrollbarAlwaysOn:sn,scrollbarStartGap:2,scrollbarEndGap:It,width:jn,style:`--${b(a.namespace)}-table-scrollbar-size: ${It}px`,useIsScrolling:bn,getRowHeight:be,onScroll:Pe},ct=b(d),Ut={ns:a,depthMap:b(F),columnsStyles:ct,expandColumnKey:vt,expandedRowKeys:b(B),estimatedRowHeight:Nt,hasFixedColumns:b(N),rowProps:Ft,rowClass:Xt,rowKey:Ot,rowEventHandlers:$t,onRowHovered:me,onRowExpanded:Be,onRowHeightChange:Ae},tt={cellProps:Mt,expandColumnKey:vt,indentSize:an,iconSize:Pn,rowKey:Ot,expandedRowKeys:b(B),ns:a},yn={ns:a,headerClass:Fe,headerProps:cn,columnsStyles:ct},wn={ns:a,sortBy:nt,sortState:Qe,headerCellProps:Re,onColumnSorted:Me},sr={row:Go=>Ze(Zue,Mr(Go,Ut),{row:t.row,cell:bo=>{let oi;return t.cell?Ze(oO,Mr(bo,tt,{style:ct[bo.column.key]}),d_(oi=t.cell(bo))?oi:{default:()=>[oi]}):Ze(oO,Mr(bo,tt,{style:ct[bo.column.key]}),null)}}),header:Go=>Ze(ode,Mr(Go,yn),{header:t.header,cell:bo=>{let oi;return t["header-cell"]?Ze(iO,Mr(bo,wn,{style:ct[bo.column.key]}),d_(oi=t["header-cell"](bo))?oi:{default:()=>[oi]}):Ze(iO,Mr(bo,wn,{style:ct[bo.column.key]}),null)}})},vo=[e.class,a.b(),a.e("root"),{[a.is("dynamic")]:b(Y)}],jo={class:a.e("footer"),style:b(le)};return Ze("div",{class:vo,style:b(fe)},[Ze(zue,vr,d_(sr)?sr:{default:()=>[sr]}),Ze(Bue,Cr,d_(sr)?sr:{default:()=>[sr]}),Ze(Uue,Gt,d_(sr)?sr:{default:()=>[sr]}),t.footer&&Ze(cde,jo,{default:t.footer}),b(ge)&&Ze(ude,{class:a.e("empty"),style:b(se)},{default:t.empty}),t.overlay&&Ze(dde,{class:a.e("overlay")},{default:t.overlay})])}}});var pde=fde;const mde=un({disableWidth:Boolean,disableHeight:Boolean,onResize:{type:dt(Function)}}),gde=e=>{const t=Se(),i=Se(0),a=Se(0);let d;return gr(()=>{d=ti(t,([p])=>{const{width:_,height:r}=p.contentRect,{paddingLeft:S,paddingRight:C,paddingTop:M,paddingBottom:k}=getComputedStyle(p.target),z=Number.parseInt(S)||0,F=Number.parseInt(C)||0,B=Number.parseInt(M)||0,N=Number.parseInt(k)||0;i.value=_-z-F,a.value=r-B-N}).stop}),Oo(()=>{d==null||d()}),qt([i,a],([p,_])=>{var r;(r=e.onResize)==null||r.call(e,{width:p,height:_})}),{sizer:t,width:i,height:a}},vde=qe({name:"ElAutoResizer",props:mde,setup(e,{slots:t}){const i=en("auto-resizer"),{height:a,width:d,sizer:p}=gde(e),_={width:"100%",height:"100%"};return()=>{var r;return Ze("div",{ref:p,class:i.b(),style:_},[(r=t.default)==null?void 0:r.call(t,{height:a.value,width:d.value})])}}});var _de=vde;const yde=ur(pde),bde=ur(_de),Ex=Symbol("tabsRootContextKey"),xde=un({tabs:{type:dt(Array),default:()=>ni([])}}),PN="ElTabBar",wde=qe({name:PN}),Sde=qe({...wde,props:xde,setup(e,{expose:t}){const i=e,a=wr(),d=An(Ex);d||ji(PN,"<el-tabs><el-tab-bar /></el-tabs>");const p=en("tabs"),_=Se(),r=Se(),S=()=>{let F=0,B=0;const N=["top","bottom"].includes(d.props.tabPosition)?"width":"height",j=N==="width"?"x":"y",U=j==="x"?"left":"top";return i.tabs.every(te=>{var Y,q;const J=(q=(Y=a.parent)==null?void 0:Y.refs)==null?void 0:q[`tab-${te.uid}`];if(!J)return!1;if(!te.active)return!0;F=J[`offset${Nc(U)}`],B=J[`client${Nc(N)}`];const ne=window.getComputedStyle(J);return N==="width"&&(B-=Number.parseFloat(ne.paddingLeft)+Number.parseFloat(ne.paddingRight),F+=Number.parseFloat(ne.paddingLeft)),!1}),{[N]:`${B}px`,transform:`translate${Nc(j)}(${F}px)`}},C=()=>r.value=S(),M=[],k=()=>{var F;M.forEach(N=>N.stop()),M.length=0;const B=(F=a.parent)==null?void 0:F.refs;if(B){for(const N in B)if(N.startsWith("tab-")){const j=B[N];j&&M.push(ti(j,C))}}};qt(()=>i.tabs,async()=>{await Vn(),C(),k()},{immediate:!0});const z=ti(_,()=>C());return Oo(()=>{M.forEach(F=>F.stop()),M.length=0,z.stop()}),t({ref:_,update:C}),(F,B)=>(ae(),Oe("div",{ref_key:"barRef",ref:_,class:pe([b(p).e("active-bar"),b(p).is(b(d).props.tabPosition)]),style:$n(r.value)},null,6))}});var Tde=fn(Sde,[["__file","tab-bar.vue"]]);const Cde=un({panes:{type:dt(Array),default:()=>ni([])},currentName:{type:[String,Number],default:""},editable:Boolean,type:{type:String,values:["card","border-card",""],default:""},stretch:Boolean}),Ede={tabClick:(e,t,i)=>i instanceof Event,tabRemove:(e,t)=>t instanceof Event},sO="ElTabNav",Mde=qe({name:sO,props:Cde,emits:Ede,setup(e,{expose:t,emit:i}){const a=An(Ex);a||ji(sO,"<el-tabs><tab-nav /></el-tabs>");const d=en("tabs"),p=o9(),_=g9(),r=Se(),S=Se(),C=Se(),M=Se(),k=Se(!1),z=Se(0),F=Se(!1),B=Se(!0),N=ee(()=>["top","bottom"].includes(a.props.tabPosition)?"width":"height"),j=ee(()=>({transform:`translate${N.value==="width"?"X":"Y"}(-${z.value}px)`})),U=()=>{if(!r.value)return;const fe=r.value[`offset${Nc(N.value)}`],ce=z.value;if(!ce)return;const le=ce>fe?ce-fe:0;z.value=le},te=()=>{if(!r.value||!S.value)return;const fe=S.value[`offset${Nc(N.value)}`],ce=r.value[`offset${Nc(N.value)}`],le=z.value;if(fe-le<=ce)return;const ge=fe-le>ce*2?le+ce:fe-ce;z.value=ge},Y=async()=>{const fe=S.value;if(!k.value||!C.value||!r.value||!fe)return;await Vn();const ce=C.value.querySelector(".is-active");if(!ce)return;const le=r.value,ge=["top","bottom"].includes(a.props.tabPosition),de=ce.getBoundingClientRect(),ke=le.getBoundingClientRect(),We=ge?fe.offsetWidth-ke.width:fe.offsetHeight-ke.height,we=z.value;let be=we;ge?(de.left<ke.left&&(be=we-(ke.left-de.left)),de.right>ke.right&&(be=we+de.right-ke.right)):(de.top<ke.top&&(be=we-(ke.top-de.top)),de.bottom>ke.bottom&&(be=we+(de.bottom-ke.bottom))),be=Math.max(be,0),z.value=Math.min(be,We)},q=()=>{var fe;if(!S.value||!r.value)return;e.stretch&&((fe=M.value)==null||fe.update());const ce=S.value[`offset${Nc(N.value)}`],le=r.value[`offset${Nc(N.value)}`],ge=z.value;le<ce?(k.value=k.value||{},k.value.prev=ge,k.value.next=ge+le<ce,ce-ge<le&&(z.value=ce-le)):(k.value=!1,ge>0&&(z.value=0))},J=fe=>{let ce=0;switch(fe.code){case En.left:case En.up:ce=-1;break;case En.right:case En.down:ce=1;break;default:return}const le=Array.from(fe.currentTarget.querySelectorAll("[role=tab]:not(.is-disabled)"));let de=le.indexOf(fe.target)+ce;de<0?de=le.length-1:de>=le.length&&(de=0),le[de].focus({preventScroll:!0}),le[de].click(),ne()},ne=()=>{B.value&&(F.value=!0)},se=()=>F.value=!1;return qt(p,fe=>{fe==="hidden"?B.value=!1:fe==="visible"&&setTimeout(()=>B.value=!0,50)}),qt(_,fe=>{fe?setTimeout(()=>B.value=!0,50):B.value=!1}),ti(C,q),gr(()=>setTimeout(()=>Y(),0)),hc(()=>q()),t({scrollToActiveTab:Y,removeFocus:se}),()=>{const fe=k.value?[Ze("span",{class:[d.e("nav-prev"),d.is("disabled",!k.value.prev)],onClick:U},[Ze(On,null,{default:()=>[Ze(Kd,null,null)]})]),Ze("span",{class:[d.e("nav-next"),d.is("disabled",!k.value.next)],onClick:te},[Ze(On,null,{default:()=>[Ze(ca,null,null)]})])]:null,ce=e.panes.map((le,ge)=>{var de,ke,We,we;const be=le.uid,Me=le.props.disabled,Ae=(ke=(de=le.props.name)!=null?de:le.index)!=null?ke:`${ge}`,me=!Me&&(le.isClosable||e.editable);le.index=`${ge}`;const Be=me?Ze(On,{class:"is-icon-close",onClick:Pe=>i("tabRemove",le,Pe)},{default:()=>[Ze(sc,null,null)]}):null,Ve=((we=(We=le.slots).label)==null?void 0:we.call(We))||le.props.label,bt=!Me&&le.active?0:-1;return Ze("div",{ref:`tab-${be}`,class:[d.e("item"),d.is(a.props.tabPosition),d.is("active",le.active),d.is("disabled",Me),d.is("closable",me),d.is("focus",F.value)],id:`tab-${Ae}`,key:`tab-${be}`,"aria-controls":`pane-${Ae}`,role:"tab","aria-selected":le.active,tabindex:bt,onFocus:()=>ne(),onBlur:()=>se(),onClick:Pe=>{se(),i("tabClick",le,Ae,Pe)},onKeydown:Pe=>{me&&(Pe.code===En.delete||Pe.code===En.backspace)&&i("tabRemove",le,Pe)}},[Ve,Be])});return Ze("div",{ref:C,class:[d.e("nav-wrap"),d.is("scrollable",!!k.value),d.is(a.props.tabPosition)]},[fe,Ze("div",{class:d.e("nav-scroll"),ref:r},[Ze("div",{class:[d.e("nav"),d.is(a.props.tabPosition),d.is("stretch",e.stretch&&["top","bottom"].includes(a.props.tabPosition))],ref:S,style:j.value,role:"tablist",onKeydown:J},[e.type?null:Ze(Tde,{ref:M,tabs:[...e.panes]},null),ce])])])}}}),Ide=un({type:{type:String,values:["card","border-card",""],default:""},closable:Boolean,addable:Boolean,modelValue:{type:[String,Number]},editable:Boolean,tabPosition:{type:String,values:["top","right","bottom","left"],default:"top"},beforeLeave:{type:dt(Function),default:()=>!0},stretch:Boolean}),yS=e=>Dn(e)||Gn(e),Ade={[mr]:e=>yS(e),tabClick:(e,t)=>t instanceof Event,tabChange:e=>yS(e),edit:(e,t)=>["remove","add"].includes(t),tabRemove:e=>yS(e),tabAdd:()=>!0},kde=qe({name:"ElTabs",props:Ide,emits:Ade,setup(e,{emit:t,slots:i,expose:a}){var d;const p=en("tabs"),_=ee(()=>["left","right"].includes(e.tabPosition)),{children:r,addChild:S,removeChild:C}=yE(wr(),"ElTabPane"),M=Se(),k=Se((d=e.modelValue)!=null?d:"0"),z=async(U,te=!1)=>{var Y,q;if(!(k.value===U||oo(U)))try{let J;if(e.beforeLeave){const ne=e.beforeLeave(U,k.value);J=ne instanceof Promise?await ne:ne}else J=!0;J!==!1&&(k.value=U,te&&(t(mr,U),t("tabChange",U)),(q=(Y=M.value)==null?void 0:Y.removeFocus)==null||q.call(Y))}catch{}},F=(U,te,Y)=>{U.props.disabled||(z(te,!0),t("tabClick",U,Y))},B=(U,te)=>{U.props.disabled||oo(U.props.name)||(te.stopPropagation(),t("edit",U.props.name,"remove"),t("tabRemove",U.props.name))},N=()=>{t("edit",void 0,"add"),t("tabAdd")};qt(()=>e.modelValue,U=>z(U)),qt(k,async()=>{var U;await Vn(),(U=M.value)==null||U.scrollToActiveTab()}),Dr(Ex,{props:e,currentName:k,registerPane:U=>{r.value.push(U)},sortPane:S,unregisterPane:C}),a({currentName:k});const j=({render:U})=>U();return()=>{const U=i["add-icon"],te=e.editable||e.addable?Ze("div",{class:[p.e("new-tab"),_.value&&p.e("new-tab-vertical")],tabindex:"0",onClick:N,onKeydown:J=>{[En.enter,En.numpadEnter].includes(J.code)&&N()}},[U?pt(i,"add-icon"):Ze(On,{class:p.is("icon-plus")},{default:()=>[Ze(Az,null,null)]})]):null,Y=Ze("div",{class:[p.e("header"),_.value&&p.e("header-vertical"),p.is(e.tabPosition)]},[Ze(j,{render:()=>{const J=r.value.some(ne=>ne.slots.label);return Ze(Mde,{ref:M,currentName:k.value,editable:e.editable,type:e.type,panes:r.value,stretch:e.stretch,onTabClick:F,onTabRemove:B},{$stable:!J})}},null),te]),q=Ze("div",{class:p.e("content")},[pt(i,"default")]);return Ze("div",{class:[p.b(),p.m(e.tabPosition),{[p.m("card")]:e.type==="card",[p.m("border-card")]:e.type==="border-card"}]},[q,Y])}}});var Pde=kde;const Rde=un({label:{type:String,default:""},name:{type:[String,Number]},closable:Boolean,disabled:Boolean,lazy:Boolean}),RN="ElTabPane",Ode=qe({name:RN}),Lde=qe({...Ode,props:Rde,setup(e){const t=e,i=wr(),a=Hi(),d=An(Ex);d||ji(RN,"usage: <el-tabs><el-tab-pane /></el-tabs/>");const p=en("tab-pane"),_=Se(),r=ee(()=>t.closable||d.props.closable),S=YS(()=>{var F;return d.currentName.value===((F=t.name)!=null?F:_.value)}),C=Se(S.value),M=ee(()=>{var F;return(F=t.name)!=null?F:_.value}),k=YS(()=>!t.lazy||C.value||S.value);qt(S,F=>{F&&(C.value=!0)});const z=lo({uid:i.uid,slots:a,props:t,paneName:M,active:S,index:_,isClosable:r});return d.registerPane(z),gr(()=>{d.sortPane(z)}),th(()=>{d.unregisterPane(z.uid)}),(F,B)=>b(k)?hr((ae(),Oe("div",{key:0,id:`pane-${b(M)}`,class:pe(b(p).b()),role:"tabpanel","aria-hidden":!b(S),"aria-labelledby":`tab-${b(M)}`},[pt(F.$slots,"default")],10,["id","aria-hidden","aria-labelledby"])),[[no,b(S)]]):yt("v-if",!0)}});var ON=fn(Lde,[["__file","tab-pane.vue"]]);const Dde=ur(Pde,{TabPane:ON}),zde=ri(ON),Fde=un({type:{type:String,values:["primary","success","info","warning","danger",""],default:""},size:{type:String,values:Zc,default:""},truncated:Boolean,lineClamp:{type:[String,Number]},tag:{type:String,default:"span"}}),Nde=qe({name:"ElText"}),Bde=qe({...Nde,props:Fde,setup(e){const t=e,i=Se(),a=Li(),d=en("text"),p=ee(()=>[d.b(),d.m(t.type),d.m(a.value),d.is("truncated",t.truncated),d.is("line-clamp",!oo(t.lineClamp))]),_=Uu().title,r=()=>{var S,C,M,k,z;if(_)return;let F=!1;const B=((S=i.value)==null?void 0:S.textContent)||"";if(t.truncated){const N=(C=i.value)==null?void 0:C.offsetWidth,j=(M=i.value)==null?void 0:M.scrollWidth;N&&j&&j>N&&(F=!0)}else if(!oo(t.lineClamp)){const N=(k=i.value)==null?void 0:k.offsetHeight,j=(z=i.value)==null?void 0:z.scrollHeight;N&&j&&j>N&&(F=!0)}F?i.value.setAttribute("title",B):i.value.removeAttribute("title")};return gr(r),hc(r),(S,C)=>(ae(),kt(Tr(S.tag),{ref_key:"textRef",ref:i,class:pe(b(p)),style:$n({"-webkit-line-clamp":S.lineClamp})},{default:st(()=>[pt(S.$slots,"default")]),_:3},8,["class","style"]))}});var Vde=fn(Bde,[["__file","text.vue"]]);const $de=ur(Vde),Ude=un({format:{type:String,default:"HH:mm"},modelValue:String,disabled:Boolean,editable:{type:Boolean,default:!0},effect:{type:dt(String),default:"light"},clearable:{type:Boolean,default:!0},size:zi,placeholder:String,start:{type:String,default:"09:00"},end:{type:String,default:"18:00"},step:{type:String,default:"00:30"},minTime:String,maxTime:String,includeEndTime:{type:Boolean,default:!1},name:String,prefixIcon:{type:dt([String,Object]),default:()=>Iz},clearIcon:{type:dt([String,Object]),default:()=>Wu},...Qm}),Ru=e=>{const t=(e||"").split(":");if(t.length>=2){let i=Number.parseInt(t[0],10);const a=Number.parseInt(t[1],10),d=e.toUpperCase();return d.includes("AM")&&i===12?i=0:d.includes("PM")&&i!==12&&(i+=12),{hours:i,minutes:a}}return null},bS=(e,t)=>{const i=Ru(e);if(!i)return-1;const a=Ru(t);if(!a)return-1;const d=i.minutes+i.hours*60,p=a.minutes+a.hours*60;return d===p?0:d>p?1:-1},aO=e=>`${e}`.padStart(2,"0"),lm=e=>`${aO(e.hours)}:${aO(e.minutes)}`,jde=(e,t)=>{const i=Ru(e);if(!i)return"";const a=Ru(t);if(!a)return"";const d={hours:i.hours,minutes:i.minutes};return d.minutes+=a.minutes,d.hours+=a.hours,d.hours+=Math.floor(d.minutes/60),d.minutes=d.minutes%60,lm(d)},Hde=qe({name:"ElTimeSelect"}),Gde=qe({...Hde,props:Ude,emits:["change","blur","focus","clear","update:modelValue"],setup(e,{expose:t}){const i=e;lr.extend(SE);const{Option:a}=Df,d=en("input"),p=Se(),_=ks(),{lang:r}=Gr(),S=ee(()=>i.modelValue),C=ee(()=>{const U=Ru(i.start);return U?lm(U):null}),M=ee(()=>{const U=Ru(i.end);return U?lm(U):null}),k=ee(()=>{const U=Ru(i.step);return U?lm(U):null}),z=ee(()=>{const U=Ru(i.minTime||"");return U?lm(U):null}),F=ee(()=>{const U=Ru(i.maxTime||"");return U?lm(U):null}),B=ee(()=>{var U;const te=[],Y=(q,J)=>{te.push({value:q,disabled:bS(J,z.value||"-1:-1")<=0||bS(J,F.value||"100:100")>=0})};if(i.start&&i.end&&i.step){let q=C.value,J;for(;q&&M.value&&bS(q,M.value)<=0;)J=lr(q,"HH:mm").locale(r.value).format(i.format),Y(J,q),q=jde(q,k.value);if(i.includeEndTime&&M.value&&((U=te[te.length-1])==null?void 0:U.value)!==M.value){const ne=lr(M.value,"HH:mm").locale(r.value).format(i.format);Y(ne,M.value)}}return te});return t({blur:()=>{var U,te;(te=(U=p.value)==null?void 0:U.blur)==null||te.call(U)},focus:()=>{var U,te;(te=(U=p.value)==null?void 0:U.focus)==null||te.call(U)}}),(U,te)=>(ae(),kt(b(Df),{ref_key:"select",ref:p,"model-value":b(S),disabled:b(_),clearable:U.clearable,"clear-icon":U.clearIcon,size:U.size,effect:U.effect,placeholder:U.placeholder,"default-first-option":"",filterable:U.editable,"empty-values":U.emptyValues,"value-on-clear":U.valueOnClear,"onUpdate:modelValue":Y=>U.$emit("update:modelValue",Y),onChange:Y=>U.$emit("change",Y),onBlur:Y=>U.$emit("blur",Y),onFocus:Y=>U.$emit("focus",Y),onClear:()=>U.$emit("clear")},{prefix:st(()=>[U.prefixIcon?(ae(),kt(b(On),{key:0,class:pe(b(d).e("prefix-icon"))},{default:st(()=>[(ae(),kt(Tr(U.prefixIcon)))]),_:1},8,["class"])):yt("v-if",!0)]),default:st(()=>[(ae(!0),Oe(Bn,null,Or(b(B),Y=>(ae(),kt(b(a),{key:Y.value,label:Y.value,value:Y.value,disabled:Y.disabled},null,8,["label","value","disabled"]))),128))]),_:1},8,["model-value","disabled","clearable","clear-icon","size","effect","placeholder","filterable","empty-values","value-on-clear","onUpdate:modelValue","onChange","onBlur","onFocus","onClear"]))}});var Wde=fn(Gde,[["__file","time-select.vue"]]);const qde=ur(Wde),Kde=qe({name:"ElTimeline",setup(e,{slots:t}){const i=en("timeline");return Dr("timeline",t),()=>Kn("ul",{class:[i.b()]},[pt(t,"default")])}}),Zde=un({timestamp:{type:String,default:""},hideTimestamp:Boolean,center:Boolean,placement:{type:String,values:["top","bottom"],default:"bottom"},type:{type:String,values:["primary","success","warning","danger","info"],default:""},color:{type:String,default:""},size:{type:String,values:["normal","large"],default:"normal"},icon:{type:Mo},hollow:Boolean}),Yde=qe({name:"ElTimelineItem"}),Xde=qe({...Yde,props:Zde,setup(e){const t=e,i=en("timeline-item"),a=ee(()=>[i.e("node"),i.em("node",t.size||""),i.em("node",t.type||""),i.is("hollow",t.hollow)]);return(d,p)=>(ae(),Oe("li",{class:pe([b(i).b(),{[b(i).e("center")]:d.center}])},[Ue("div",{class:pe(b(i).e("tail"))},null,2),d.$slots.dot?yt("v-if",!0):(ae(),Oe("div",{key:0,class:pe(b(a)),style:$n({backgroundColor:d.color})},[d.icon?(ae(),kt(b(On),{key:0,class:pe(b(i).e("icon"))},{default:st(()=>[(ae(),kt(Tr(d.icon)))]),_:1},8,["class"])):yt("v-if",!0)],6)),d.$slots.dot?(ae(),Oe("div",{key:1,class:pe(b(i).e("dot"))},[pt(d.$slots,"dot")],2)):yt("v-if",!0),Ue("div",{class:pe(b(i).e("wrapper"))},[!d.hideTimestamp&&d.placement==="top"?(ae(),Oe("div",{key:0,class:pe([b(i).e("timestamp"),b(i).is("top")])},pn(d.timestamp),3)):yt("v-if",!0),Ue("div",{class:pe(b(i).e("content"))},[pt(d.$slots,"default")],2),!d.hideTimestamp&&d.placement==="bottom"?(ae(),Oe("div",{key:1,class:pe([b(i).e("timestamp"),b(i).is("bottom")])},pn(d.timestamp),3)):yt("v-if",!0)],2)],2))}});var LN=fn(Xde,[["__file","timeline-item.vue"]]);const Jde=ur(Kde,{TimelineItem:LN}),Qde=ri(LN),DN=un({nowrap:Boolean});var zN=(e=>(e.top="top",e.bottom="bottom",e.left="left",e.right="right",e))(zN||{});const ehe=Object.values(zN),tM=un({width:{type:Number,default:10},height:{type:Number,default:10},style:{type:dt(Object),default:null}}),the=un({side:{type:dt(String),values:ehe,required:!0}}),nhe=["absolute","fixed"],rhe=["top-start","top-end","top","bottom-start","bottom-end","bottom","left-start","left-end","left","right-start","right-end","right"],nM=un({arrowPadding:{type:dt(Number),default:5},effect:{type:dt(String),default:"light"},contentClass:String,placement:{type:dt(String),values:rhe,default:"bottom"},reference:{type:dt(Object),default:null},offset:{type:Number,default:8},strategy:{type:dt(String),values:nhe,default:"absolute"},showArrow:Boolean,..._s(["ariaLabel"])}),rM=un({delayDuration:{type:Number,default:300},defaultOpen:Boolean,open:{type:Boolean,default:void 0},onOpenChange:{type:dt(Function)},"onUpdate:open":{type:dt(Function)}}),rm={type:dt(Function)},oM=un({onBlur:rm,onClick:rm,onFocus:rm,onMouseDown:rm,onMouseEnter:rm,onMouseLeave:rm}),ohe=un({...rM,...tM,...oM,...nM,alwaysOn:Boolean,fullTransition:Boolean,transitionProps:{type:dt(Object),default:null},teleported:Boolean,to:{type:dt(String),default:"body"}}),Mx=Symbol("tooltipV2"),FN=Symbol("tooltipV2Content"),xS="tooltip_v2.open",ihe=qe({name:"ElTooltipV2Root"}),she=qe({...ihe,props:rM,setup(e,{expose:t}){const i=e,a=Se(i.defaultOpen),d=Se(null),p=ee({get:()=>rc(i.open)?a.value:i.open,set:j=>{var U;a.value=j,(U=i["onUpdate:open"])==null||U.call(i,j)}}),_=ee(()=>Gn(i.delayDuration)&&i.delayDuration>0),{start:r,stop:S}=Of(()=>{p.value=!0},ee(()=>i.delayDuration),{immediate:!1}),C=en("tooltip-v2"),M=vs(),k=()=>{S(),p.value=!0},z=()=>{b(_)?r():k()},F=k,B=()=>{S(),p.value=!1};return qt(p,j=>{var U;j&&(document.dispatchEvent(new CustomEvent(xS)),F()),(U=i.onOpenChange)==null||U.call(i,j)}),gr(()=>{document.addEventListener(xS,B)}),Oo(()=>{S(),document.removeEventListener(xS,B)}),Dr(Mx,{contentId:M,triggerRef:d,ns:C,onClose:B,onDelayOpen:z,onOpen:F}),t({onOpen:F,onClose:B}),(j,U)=>pt(j.$slots,"default",{open:b(p)})}});var ahe=fn(she,[["__file","root.vue"]]);const lhe=qe({name:"ElTooltipV2Arrow"}),che=qe({...lhe,props:{...tM,...the},setup(e){const t=e,{ns:i}=An(Mx),{arrowRef:a}=An(FN),d=ee(()=>{const{style:p,width:_,height:r}=t,S=i.namespace.value;return{[`--${S}-tooltip-v2-arrow-width`]:`${_}px`,[`--${S}-tooltip-v2-arrow-height`]:`${r}px`,[`--${S}-tooltip-v2-arrow-border-width`]:`${_/2}px`,[`--${S}-tooltip-v2-arrow-cover-width`]:_/2-1,...p||{}}});return(p,_)=>(ae(),Oe("span",{ref_key:"arrowRef",ref:a,style:$n(b(d)),class:pe(b(i).e("arrow"))},null,6))}});var lO=fn(che,[["__file","arrow.vue"]]);const Bm=Math.min,Af=Math.max,z1=Math.round,Lb=Math.floor,$c=e=>({x:e,y:e}),uhe={left:"right",right:"left",bottom:"top",top:"bottom"},dhe={start:"end",end:"start"};function $T(e,t,i){return Af(e,Bm(t,i))}function Iy(e,t){return typeof e=="function"?e(t):e}function Ff(e){return e.split("-")[0]}function Ay(e){return e.split("-")[1]}function NN(e){return e==="x"?"y":"x"}function iM(e){return e==="y"?"height":"width"}function Vm(e){return["top","bottom"].includes(Ff(e))?"y":"x"}function sM(e){return NN(Vm(e))}function hhe(e,t,i){i===void 0&&(i=!1);const a=Ay(e),d=sM(e),p=iM(d);let _=d==="x"?a===(i?"end":"start")?"right":"left":a==="start"?"bottom":"top";return t.reference[p]>t.floating[p]&&(_=F1(_)),[_,F1(_)]}function fhe(e){const t=F1(e);return[UT(e),t,UT(t)]}function UT(e){return e.replace(/start|end/g,t=>dhe[t])}function phe(e,t,i){const a=["left","right"],d=["right","left"],p=["top","bottom"],_=["bottom","top"];switch(e){case"top":case"bottom":return i?t?d:a:t?a:d;case"left":case"right":return t?p:_;default:return[]}}function mhe(e,t,i,a){const d=Ay(e);let p=phe(Ff(e),i==="start",a);return d&&(p=p.map(_=>_+"-"+d),t&&(p=p.concat(p.map(UT)))),p}function F1(e){return e.replace(/left|right|bottom|top/g,t=>uhe[t])}function ghe(e){return{top:0,right:0,bottom:0,left:0,...e}}function BN(e){return typeof e!="number"?ghe(e):{top:e,right:e,bottom:e,left:e}}function N1(e){const{x:t,y:i,width:a,height:d}=e;return{width:a,height:d,top:i,left:t,right:t+a,bottom:i+d,x:t,y:i}}function cO(e,t,i){let{reference:a,floating:d}=e;const p=Vm(t),_=sM(t),r=iM(_),S=Ff(t),C=p==="y",M=a.x+a.width/2-d.width/2,k=a.y+a.height/2-d.height/2,z=a[r]/2-d[r]/2;let F;switch(S){case"top":F={x:M,y:a.y-d.height};break;case"bottom":F={x:M,y:a.y+a.height};break;case"right":F={x:a.x+a.width,y:k};break;case"left":F={x:a.x-d.width,y:k};break;default:F={x:a.x,y:a.y}}switch(Ay(t)){case"start":F[_]-=z*(i&&C?-1:1);break;case"end":F[_]+=z*(i&&C?-1:1);break}return F}const vhe=async(e,t,i)=>{const{placement:a="bottom",strategy:d="absolute",middleware:p=[],platform:_}=i,r=p.filter(Boolean),S=await(_.isRTL==null?void 0:_.isRTL(t));let C=await _.getElementRects({reference:e,floating:t,strategy:d}),{x:M,y:k}=cO(C,a,S),z=a,F={},B=0;for(let N=0;N<r.length;N++){const{name:j,fn:U}=r[N],{x:te,y:Y,data:q,reset:J}=await U({x:M,y:k,initialPlacement:a,placement:z,strategy:d,middlewareData:F,rects:C,platform:_,elements:{reference:e,floating:t}});M=te??M,k=Y??k,F={...F,[j]:{...F[j],...q}},J&&B<=50&&(B++,typeof J=="object"&&(J.placement&&(z=J.placement),J.rects&&(C=J.rects===!0?await _.getElementRects({reference:e,floating:t,strategy:d}):J.rects),{x:M,y:k}=cO(C,z,S)),N=-1)}return{x:M,y:k,placement:z,strategy:d,middlewareData:F}};async function aM(e,t){var i;t===void 0&&(t={});const{x:a,y:d,platform:p,rects:_,elements:r,strategy:S}=e,{boundary:C="clippingAncestors",rootBoundary:M="viewport",elementContext:k="floating",altBoundary:z=!1,padding:F=0}=Iy(t,e),B=BN(F),j=r[z?k==="floating"?"reference":"floating":k],U=N1(await p.getClippingRect({element:(i=await(p.isElement==null?void 0:p.isElement(j)))==null||i?j:j.contextElement||await(p.getDocumentElement==null?void 0:p.getDocumentElement(r.floating)),boundary:C,rootBoundary:M,strategy:S})),te=k==="floating"?{x:a,y:d,width:_.floating.width,height:_.floating.height}:_.reference,Y=await(p.getOffsetParent==null?void 0:p.getOffsetParent(r.floating)),q=await(p.isElement==null?void 0:p.isElement(Y))?await(p.getScale==null?void 0:p.getScale(Y))||{x:1,y:1}:{x:1,y:1},J=N1(p.convertOffsetParentRelativeRectToViewportRelativeRect?await p.convertOffsetParentRelativeRectToViewportRelativeRect({elements:r,rect:te,offsetParent:Y,strategy:S}):te);return{top:(U.top-J.top+B.top)/q.y,bottom:(J.bottom-U.bottom+B.bottom)/q.y,left:(U.left-J.left+B.left)/q.x,right:(J.right-U.right+B.right)/q.x}}const _he=e=>({name:"arrow",options:e,async fn(t){const{x:i,y:a,placement:d,rects:p,platform:_,elements:r,middlewareData:S}=t,{element:C,padding:M=0}=Iy(e,t)||{};if(C==null)return{};const k=BN(M),z={x:i,y:a},F=sM(d),B=iM(F),N=await _.getDimensions(C),j=F==="y",U=j?"top":"left",te=j?"bottom":"right",Y=j?"clientHeight":"clientWidth",q=p.reference[B]+p.reference[F]-z[F]-p.floating[B],J=z[F]-p.reference[F],ne=await(_.getOffsetParent==null?void 0:_.getOffsetParent(C));let se=ne?ne[Y]:0;(!se||!await(_.isElement==null?void 0:_.isElement(ne)))&&(se=r.floating[Y]||p.floating[B]);const fe=q/2-J/2,ce=se/2-N[B]/2-1,le=Bm(k[U],ce),ge=Bm(k[te],ce),de=le,ke=se-N[B]-ge,We=se/2-N[B]/2+fe,we=$T(de,We,ke),be=!S.arrow&&Ay(d)!=null&&We!==we&&p.reference[B]/2-(We<de?le:ge)-N[B]/2<0,Me=be?We<de?We-de:We-ke:0;return{[F]:z[F]+Me,data:{[F]:we,centerOffset:We-we-Me,...be&&{alignmentOffset:Me}},reset:be}}}),yhe=function(e){return e===void 0&&(e={}),{name:"flip",options:e,async fn(t){var i,a;const{placement:d,middlewareData:p,rects:_,initialPlacement:r,platform:S,elements:C}=t,{mainAxis:M=!0,crossAxis:k=!0,fallbackPlacements:z,fallbackStrategy:F="bestFit",fallbackAxisSideDirection:B="none",flipAlignment:N=!0,...j}=Iy(e,t);if((i=p.arrow)!=null&&i.alignmentOffset)return{};const U=Ff(d),te=Vm(r),Y=Ff(r)===r,q=await(S.isRTL==null?void 0:S.isRTL(C.floating)),J=z||(Y||!N?[F1(r)]:fhe(r)),ne=B!=="none";!z&&ne&&J.push(...mhe(r,N,B,q));const se=[r,...J],fe=await aM(t,j),ce=[];let le=((a=p.flip)==null?void 0:a.overflows)||[];if(M&&ce.push(fe[U]),k){const We=hhe(d,_,q);ce.push(fe[We[0]],fe[We[1]])}if(le=[...le,{placement:d,overflows:ce}],!ce.every(We=>We<=0)){var ge,de;const We=(((ge=p.flip)==null?void 0:ge.index)||0)+1,we=se[We];if(we)return{data:{index:We,overflows:le},reset:{placement:we}};let be=(de=le.filter(Me=>Me.overflows[0]<=0).sort((Me,Ae)=>Me.overflows[1]-Ae.overflows[1])[0])==null?void 0:de.placement;if(!be)switch(F){case"bestFit":{var ke;const Me=(ke=le.filter(Ae=>{if(ne){const me=Vm(Ae.placement);return me===te||me==="y"}return!0}).map(Ae=>[Ae.placement,Ae.overflows.filter(me=>me>0).reduce((me,Be)=>me+Be,0)]).sort((Ae,me)=>Ae[1]-me[1])[0])==null?void 0:ke[0];Me&&(be=Me);break}case"initialPlacement":be=r;break}if(d!==be)return{reset:{placement:be}}}return{}}}};async function bhe(e,t){const{placement:i,platform:a,elements:d}=e,p=await(a.isRTL==null?void 0:a.isRTL(d.floating)),_=Ff(i),r=Ay(i),S=Vm(i)==="y",C=["left","top"].includes(_)?-1:1,M=p&&S?-1:1,k=Iy(t,e);let{mainAxis:z,crossAxis:F,alignmentAxis:B}=typeof k=="number"?{mainAxis:k,crossAxis:0,alignmentAxis:null}:{mainAxis:k.mainAxis||0,crossAxis:k.crossAxis||0,alignmentAxis:k.alignmentAxis};return r&&typeof B=="number"&&(F=r==="end"?B*-1:B),S?{x:F*M,y:z*C}:{x:z*C,y:F*M}}const xhe=function(e){return e===void 0&&(e=0),{name:"offset",options:e,async fn(t){var i,a;const{x:d,y:p,placement:_,middlewareData:r}=t,S=await bhe(t,e);return _===((i=r.offset)==null?void 0:i.placement)&&(a=r.arrow)!=null&&a.alignmentOffset?{}:{x:d+S.x,y:p+S.y,data:{...S,placement:_}}}}},whe=function(e){return e===void 0&&(e={}),{name:"shift",options:e,async fn(t){const{x:i,y:a,placement:d}=t,{mainAxis:p=!0,crossAxis:_=!1,limiter:r={fn:j=>{let{x:U,y:te}=j;return{x:U,y:te}}},...S}=Iy(e,t),C={x:i,y:a},M=await aM(t,S),k=Vm(Ff(d)),z=NN(k);let F=C[z],B=C[k];if(p){const j=z==="y"?"top":"left",U=z==="y"?"bottom":"right",te=F+M[j],Y=F-M[U];F=$T(te,F,Y)}if(_){const j=k==="y"?"top":"left",U=k==="y"?"bottom":"right",te=B+M[j],Y=B-M[U];B=$T(te,B,Y)}const N=r.fn({...t,[z]:F,[k]:B});return{...N,data:{x:N.x-i,y:N.y-a,enabled:{[z]:p,[k]:_}}}}}};function Ix(){return typeof window<"u"}function og(e){return VN(e)?(e.nodeName||"").toLowerCase():"#document"}function Za(e){var t;return(e==null||(t=e.ownerDocument)==null?void 0:t.defaultView)||window}function Jc(e){var t;return(t=(VN(e)?e.ownerDocument:e.document)||window.document)==null?void 0:t.documentElement}function VN(e){return Ix()?e instanceof Node||e instanceof Za(e).Node:!1}function ac(e){return Ix()?e instanceof Element||e instanceof Za(e).Element:!1}function qc(e){return Ix()?e instanceof HTMLElement||e instanceof Za(e).HTMLElement:!1}function uO(e){return!Ix()||typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof Za(e).ShadowRoot}function ky(e){const{overflow:t,overflowX:i,overflowY:a,display:d}=lc(e);return/auto|scroll|overlay|hidden|clip/.test(t+a+i)&&!["inline","contents"].includes(d)}function She(e){return["table","td","th"].includes(og(e))}function Ax(e){return[":popover-open",":modal"].some(t=>{try{return e.matches(t)}catch{return!1}})}function lM(e){const t=cM(),i=ac(e)?lc(e):e;return["transform","translate","scale","rotate","perspective"].some(a=>i[a]?i[a]!=="none":!1)||(i.containerType?i.containerType!=="normal":!1)||!t&&(i.backdropFilter?i.backdropFilter!=="none":!1)||!t&&(i.filter?i.filter!=="none":!1)||["transform","translate","scale","rotate","perspective","filter"].some(a=>(i.willChange||"").includes(a))||["paint","layout","strict","content"].some(a=>(i.contain||"").includes(a))}function The(e){let t=Jd(e);for(;qc(t)&&!$m(t);){if(lM(t))return t;if(Ax(t))return null;t=Jd(t)}return null}function cM(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function $m(e){return["html","body","#document"].includes(og(e))}function lc(e){return Za(e).getComputedStyle(e)}function kx(e){return ac(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function Jd(e){if(og(e)==="html")return e;const t=e.assignedSlot||e.parentNode||uO(e)&&e.host||Jc(e);return uO(t)?t.host:t}function $N(e){const t=Jd(e);return $m(t)?e.ownerDocument?e.ownerDocument.body:e.body:qc(t)&&ky(t)?t:$N(t)}function ay(e,t,i){var a;t===void 0&&(t=[]),i===void 0&&(i=!0);const d=$N(e),p=d===((a=e.ownerDocument)==null?void 0:a.body),_=Za(d);if(p){const r=jT(_);return t.concat(_,_.visualViewport||[],ky(d)?d:[],r&&i?ay(r):[])}return t.concat(d,ay(d,[],i))}function jT(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function UN(e){const t=lc(e);let i=parseFloat(t.width)||0,a=parseFloat(t.height)||0;const d=qc(e),p=d?e.offsetWidth:i,_=d?e.offsetHeight:a,r=z1(i)!==p||z1(a)!==_;return r&&(i=p,a=_),{width:i,height:a,$:r}}function uM(e){return ac(e)?e:e.contextElement}function wm(e){const t=uM(e);if(!qc(t))return $c(1);const i=t.getBoundingClientRect(),{width:a,height:d,$:p}=UN(t);let _=(p?z1(i.width):i.width)/a,r=(p?z1(i.height):i.height)/d;return(!_||!Number.isFinite(_))&&(_=1),(!r||!Number.isFinite(r))&&(r=1),{x:_,y:r}}const Che=$c(0);function jN(e){const t=Za(e);return!cM()||!t.visualViewport?Che:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function Ehe(e,t,i){return t===void 0&&(t=!1),!i||t&&i!==Za(e)?!1:t}function Nf(e,t,i,a){t===void 0&&(t=!1),i===void 0&&(i=!1);const d=e.getBoundingClientRect(),p=uM(e);let _=$c(1);t&&(a?ac(a)&&(_=wm(a)):_=wm(e));const r=Ehe(p,i,a)?jN(p):$c(0);let S=(d.left+r.x)/_.x,C=(d.top+r.y)/_.y,M=d.width/_.x,k=d.height/_.y;if(p){const z=Za(p),F=a&&ac(a)?Za(a):a;let B=z,N=jT(B);for(;N&&a&&F!==B;){const j=wm(N),U=N.getBoundingClientRect(),te=lc(N),Y=U.left+(N.clientLeft+parseFloat(te.paddingLeft))*j.x,q=U.top+(N.clientTop+parseFloat(te.paddingTop))*j.y;S*=j.x,C*=j.y,M*=j.x,k*=j.y,S+=Y,C+=q,B=Za(N),N=jT(B)}}return N1({width:M,height:k,x:S,y:C})}function dM(e,t){const i=kx(e).scrollLeft;return t?t.left+i:Nf(Jc(e)).left+i}function HN(e,t,i){i===void 0&&(i=!1);const a=e.getBoundingClientRect(),d=a.left+t.scrollLeft-(i?0:dM(e,a)),p=a.top+t.scrollTop;return{x:d,y:p}}function Mhe(e){let{elements:t,rect:i,offsetParent:a,strategy:d}=e;const p=d==="fixed",_=Jc(a),r=t?Ax(t.floating):!1;if(a===_||r&&p)return i;let S={scrollLeft:0,scrollTop:0},C=$c(1);const M=$c(0),k=qc(a);if((k||!k&&!p)&&((og(a)!=="body"||ky(_))&&(S=kx(a)),qc(a))){const F=Nf(a);C=wm(a),M.x=F.x+a.clientLeft,M.y=F.y+a.clientTop}const z=_&&!k&&!p?HN(_,S,!0):$c(0);return{width:i.width*C.x,height:i.height*C.y,x:i.x*C.x-S.scrollLeft*C.x+M.x+z.x,y:i.y*C.y-S.scrollTop*C.y+M.y+z.y}}function Ihe(e){return Array.from(e.getClientRects())}function Ahe(e){const t=Jc(e),i=kx(e),a=e.ownerDocument.body,d=Af(t.scrollWidth,t.clientWidth,a.scrollWidth,a.clientWidth),p=Af(t.scrollHeight,t.clientHeight,a.scrollHeight,a.clientHeight);let _=-i.scrollLeft+dM(e);const r=-i.scrollTop;return lc(a).direction==="rtl"&&(_+=Af(t.clientWidth,a.clientWidth)-d),{width:d,height:p,x:_,y:r}}function khe(e,t){const i=Za(e),a=Jc(e),d=i.visualViewport;let p=a.clientWidth,_=a.clientHeight,r=0,S=0;if(d){p=d.width,_=d.height;const C=cM();(!C||C&&t==="fixed")&&(r=d.offsetLeft,S=d.offsetTop)}return{width:p,height:_,x:r,y:S}}function Phe(e,t){const i=Nf(e,!0,t==="fixed"),a=i.top+e.clientTop,d=i.left+e.clientLeft,p=qc(e)?wm(e):$c(1),_=e.clientWidth*p.x,r=e.clientHeight*p.y,S=d*p.x,C=a*p.y;return{width:_,height:r,x:S,y:C}}function dO(e,t,i){let a;if(t==="viewport")a=khe(e,i);else if(t==="document")a=Ahe(Jc(e));else if(ac(t))a=Phe(t,i);else{const d=jN(e);a={x:t.x-d.x,y:t.y-d.y,width:t.width,height:t.height}}return N1(a)}function GN(e,t){const i=Jd(e);return i===t||!ac(i)||$m(i)?!1:lc(i).position==="fixed"||GN(i,t)}function Rhe(e,t){const i=t.get(e);if(i)return i;let a=ay(e,[],!1).filter(r=>ac(r)&&og(r)!=="body"),d=null;const p=lc(e).position==="fixed";let _=p?Jd(e):e;for(;ac(_)&&!$m(_);){const r=lc(_),S=lM(_);!S&&r.position==="fixed"&&(d=null),(p?!S&&!d:!S&&r.position==="static"&&!!d&&["absolute","fixed"].includes(d.position)||ky(_)&&!S&&GN(e,_))?a=a.filter(M=>M!==_):d=r,_=Jd(_)}return t.set(e,a),a}function Ohe(e){let{element:t,boundary:i,rootBoundary:a,strategy:d}=e;const _=[...i==="clippingAncestors"?Ax(t)?[]:Rhe(t,this._c):[].concat(i),a],r=_[0],S=_.reduce((C,M)=>{const k=dO(t,M,d);return C.top=Af(k.top,C.top),C.right=Bm(k.right,C.right),C.bottom=Bm(k.bottom,C.bottom),C.left=Af(k.left,C.left),C},dO(t,r,d));return{width:S.right-S.left,height:S.bottom-S.top,x:S.left,y:S.top}}function Lhe(e){const{width:t,height:i}=UN(e);return{width:t,height:i}}function Dhe(e,t,i){const a=qc(t),d=Jc(t),p=i==="fixed",_=Nf(e,!0,p,t);let r={scrollLeft:0,scrollTop:0};const S=$c(0);if(a||!a&&!p)if((og(t)!=="body"||ky(d))&&(r=kx(t)),a){const z=Nf(t,!0,p,t);S.x=z.x+t.clientLeft,S.y=z.y+t.clientTop}else d&&(S.x=dM(d));const C=d&&!a&&!p?HN(d,r):$c(0),M=_.left+r.scrollLeft-S.x-C.x,k=_.top+r.scrollTop-S.y-C.y;return{x:M,y:k,width:_.width,height:_.height}}function wS(e){return lc(e).position==="static"}function hO(e,t){if(!qc(e)||lc(e).position==="fixed")return null;if(t)return t(e);let i=e.offsetParent;return Jc(e)===i&&(i=i.ownerDocument.body),i}function WN(e,t){const i=Za(e);if(Ax(e))return i;if(!qc(e)){let d=Jd(e);for(;d&&!$m(d);){if(ac(d)&&!wS(d))return d;d=Jd(d)}return i}let a=hO(e,t);for(;a&&She(a)&&wS(a);)a=hO(a,t);return a&&$m(a)&&wS(a)&&!lM(a)?i:a||The(e)||i}const zhe=async function(e){const t=this.getOffsetParent||WN,i=this.getDimensions,a=await i(e.floating);return{reference:Dhe(e.reference,await t(e.floating),e.strategy),floating:{x:0,y:0,width:a.width,height:a.height}}};function Fhe(e){return lc(e).direction==="rtl"}const Nhe={convertOffsetParentRelativeRectToViewportRelativeRect:Mhe,getDocumentElement:Jc,getClippingRect:Ohe,getOffsetParent:WN,getElementRects:zhe,getClientRects:Ihe,getDimensions:Lhe,getScale:wm,isElement:ac,isRTL:Fhe};function qN(e,t){return e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height}function Bhe(e,t){let i=null,a;const d=Jc(e);function p(){var r;clearTimeout(a),(r=i)==null||r.disconnect(),i=null}function _(r,S){r===void 0&&(r=!1),S===void 0&&(S=1),p();const C=e.getBoundingClientRect(),{left:M,top:k,width:z,height:F}=C;if(r||t(),!z||!F)return;const B=Lb(k),N=Lb(d.clientWidth-(M+z)),j=Lb(d.clientHeight-(k+F)),U=Lb(M),Y={rootMargin:-B+"px "+-N+"px "+-j+"px "+-U+"px",threshold:Af(0,Bm(1,S))||1};let q=!0;function J(ne){const se=ne[0].intersectionRatio;if(se!==S){if(!q)return _();se?_(!1,se):a=setTimeout(()=>{_(!1,1e-7)},1e3)}se===1&&!qN(C,e.getBoundingClientRect())&&_(),q=!1}try{i=new IntersectionObserver(J,{...Y,root:d.ownerDocument})}catch{i=new IntersectionObserver(J,Y)}i.observe(e)}return _(!0),p}function Vhe(e,t,i,a){a===void 0&&(a={});const{ancestorScroll:d=!0,ancestorResize:p=!0,elementResize:_=typeof ResizeObserver=="function",layoutShift:r=typeof IntersectionObserver=="function",animationFrame:S=!1}=a,C=uM(e),M=d||p?[...C?ay(C):[],...ay(t)]:[];M.forEach(U=>{d&&U.addEventListener("scroll",i,{passive:!0}),p&&U.addEventListener("resize",i)});const k=C&&r?Bhe(C,i):null;let z=-1,F=null;_&&(F=new ResizeObserver(U=>{let[te]=U;te&&te.target===C&&F&&(F.unobserve(t),cancelAnimationFrame(z),z=requestAnimationFrame(()=>{var Y;(Y=F)==null||Y.observe(t)})),i()}),C&&!S&&F.observe(C),F.observe(t));let B,N=S?Nf(e):null;S&&j();function j(){const U=Nf(e);N&&!qN(N,U)&&i(),N=U,B=requestAnimationFrame(j)}return i(),()=>{var U;M.forEach(te=>{d&&te.removeEventListener("scroll",i),p&&te.removeEventListener("resize",i)}),k==null||k(),(U=F)==null||U.disconnect(),F=null,S&&cancelAnimationFrame(B)}}const $he=aM,KN=xhe,Uhe=whe,jhe=yhe,ZN=_he,YN=(e,t,i)=>{const a=new Map,d={platform:Nhe,...i},p={...d.platform,_c:a};return vhe(e,t,{...d,platform:p})},Hhe=un({style:{type:dt([String,Object,Array]),default:()=>({})}}),Ghe=qe({name:"ElVisuallyHidden"}),Whe=qe({...Ghe,props:Hhe,setup(e){const t=e,i=ee(()=>[t.style,{position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}]);return(a,d)=>(ae(),Oe("span",Mr(a.$attrs,{style:b(i)}),[pt(a.$slots,"default")],16))}});var qhe=fn(Whe,[["__file","visual-hidden.vue"]]);un({});const Khe=e=>{if(!Hr)return;if(!e)return e;const t=aa(e);return t||(To(e)?t:e)},Zhe=({middleware:e,placement:t,strategy:i})=>{const a=Se(),d=Se(),p=Se(),_=Se(),r=Se({}),S={x:p,y:_,placement:t,strategy:i,middlewareData:r},C=async()=>{if(!Hr)return;const M=Khe(a),k=aa(d);if(!M||!k)return;const z=await YN(M,k,{placement:b(t),strategy:b(i),middleware:b(e)});Am(S).forEach(F=>{S[F].value=z[F]})};return gr(()=>{Cs(()=>{C()})}),{...S,update:C,referenceRef:a,contentRef:d}},Yhe=({arrowRef:e,padding:t})=>({name:"arrow",options:{element:e,padding:t},fn(i){const a=b(e);return a?ZN({element:a,padding:t}).fn(i):{}}}),Xhe=qe({name:"ElTooltipV2Content"}),Jhe=qe({...Xhe,props:{...nM,...DN},setup(e){const t=e,{triggerRef:i,contentId:a}=An(Mx),d=Se(t.placement),p=Se(t.strategy),_=Se(null),{referenceRef:r,contentRef:S,middlewareData:C,x:M,y:k,update:z}=Zhe({placement:d,strategy:p,middleware:ee(()=>{const Y=[KN(t.offset)];return t.showArrow&&Y.push(Yhe({arrowRef:_})),Y})}),F=Jm().nextZIndex(),B=en("tooltip-v2"),N=ee(()=>d.value.split("-")[0]),j=ee(()=>({position:b(p),top:`${b(k)||0}px`,left:`${b(M)||0}px`,zIndex:F})),U=ee(()=>{if(!t.showArrow)return{};const{arrow:Y}=b(C);return{[`--${B.namespace.value}-tooltip-v2-arrow-x`]:`${Y==null?void 0:Y.x}px`||"",[`--${B.namespace.value}-tooltip-v2-arrow-y`]:`${Y==null?void 0:Y.y}px`||""}}),te=ee(()=>[B.e("content"),B.is("dark",t.effect==="dark"),B.is(b(p)),t.contentClass]);return qt(_,()=>z()),qt(()=>t.placement,Y=>d.value=Y),gr(()=>{qt(()=>t.reference||i.value,Y=>{r.value=Y||void 0},{immediate:!0})}),Dr(FN,{arrowRef:_}),(Y,q)=>(ae(),Oe("div",{ref_key:"contentRef",ref:S,style:$n(b(j)),"data-tooltip-v2-root":""},[Y.nowrap?yt("v-if",!0):(ae(),Oe("div",{key:0,"data-side":b(N),class:pe(b(te))},[pt(Y.$slots,"default",{contentStyle:b(j),contentClass:b(te)}),Ze(b(qhe),{id:b(a),role:"tooltip"},{default:st(()=>[Y.ariaLabel?(ae(),Oe(Bn,{key:0},[Rr(pn(Y.ariaLabel),1)],64)):pt(Y.$slots,"default",{key:1})]),_:3},8,["id"]),pt(Y.$slots,"arrow",{style:$n(b(U)),side:b(N)})],10,["data-side"]))],4))}});var fO=fn(Jhe,[["__file","content.vue"]]);const Qhe=un({setRef:{type:dt(Function),required:!0},onlyChild:Boolean});var efe=qe({props:Qhe,setup(e,{slots:t}){const i=Se(),a=wx(i,d=>{d?e.setRef(d.nextElementSibling):e.setRef(null)});return()=>{var d;const[p]=((d=t.default)==null?void 0:d.call(t))||[],_=e.onlyChild?TJ(p.children):p.children;return Ze(Bn,{ref:a},[_])}}});const tfe=qe({name:"ElTooltipV2Trigger"}),nfe=qe({...tfe,props:{...DN,...oM},setup(e){const t=e,{onClose:i,onOpen:a,onDelayOpen:d,triggerRef:p,contentId:_}=An(Mx);let r=!1;const S=te=>{p.value=te},C=()=>{r=!1},M=_i(t.onMouseEnter,d),k=_i(t.onMouseLeave,i),z=_i(t.onMouseDown,()=>{i(),r=!0,document.addEventListener("mouseup",C,{once:!0})}),F=_i(t.onFocus,()=>{r||a()}),B=_i(t.onBlur,i),N=_i(t.onClick,te=>{te.detail===0&&i()}),j={blur:B,click:N,focus:F,mousedown:z,mouseenter:M,mouseleave:k},U=(te,Y,q)=>{te&&Object.entries(Y).forEach(([J,ne])=>{te[q](J,ne)})};return qt(p,(te,Y)=>{U(te,j,"addEventListener"),U(Y,j,"removeEventListener"),te&&te.setAttribute("aria-describedby",_.value)}),Oo(()=>{U(p.value,j,"removeEventListener"),document.removeEventListener("mouseup",C)}),(te,Y)=>te.nowrap?(ae(),kt(b(efe),{key:0,"set-ref":S,"only-child":""},{default:st(()=>[pt(te.$slots,"default")]),_:3})):(ae(),Oe("button",Mr({key:1,ref_key:"triggerRef",ref:p},te.$attrs),[pt(te.$slots,"default")],16))}});var rfe=fn(nfe,[["__file","trigger.vue"]]);const ofe=qe({name:"ElTooltipV2"}),ife=qe({...ofe,props:ohe,setup(e){const i=Zi(e),a=lo(Jl(i,Object.keys(tM))),d=lo(Jl(i,Object.keys(nM))),p=lo(Jl(i,Object.keys(rM))),_=lo(Jl(i,Object.keys(oM)));return(r,S)=>(ae(),kt(ahe,Ha(Uc(p)),{default:st(({open:C})=>[Ze(rfe,Mr(_,{nowrap:""}),{default:st(()=>[pt(r.$slots,"trigger")]),_:3},16),Ze(b(tg),{to:r.to,disabled:!r.teleported},{default:st(()=>[r.fullTransition?(ae(),kt(ls,Ha(Mr({key:0},r.transitionProps)),{default:st(()=>[r.alwaysOn||C?(ae(),kt(fO,Ha(Mr({key:0},d)),{arrow:st(({style:M,side:k})=>[r.showArrow?(ae(),kt(lO,Mr({key:0},a,{style:M,side:k}),null,16,["style","side"])):yt("v-if",!0)]),default:st(()=>[pt(r.$slots,"default")]),_:3},16)):yt("v-if",!0)]),_:2},1040)):(ae(),Oe(Bn,{key:1},[r.alwaysOn||C?(ae(),kt(fO,Ha(Mr({key:0},d)),{arrow:st(({style:M,side:k})=>[r.showArrow?(ae(),kt(lO,Mr({key:0},a,{style:M,side:k}),null,16,["style","side"])):yt("v-if",!0)]),default:st(()=>[pt(r.$slots,"default")]),_:3},16)):yt("v-if",!0)],64))]),_:2},1032,["to","disabled"])]),_:3},16))}});var sfe=fn(ife,[["__file","tooltip.vue"]]);const afe=ur(sfe),XN="left-check-change",JN="right-check-change",cm=un({data:{type:dt(Array),default:()=>[]},titles:{type:dt(Array),default:()=>[]},buttonTexts:{type:dt(Array),default:()=>[]},filterPlaceholder:String,filterMethod:{type:dt(Function)},leftDefaultChecked:{type:dt(Array),default:()=>[]},rightDefaultChecked:{type:dt(Array),default:()=>[]},renderContent:{type:dt(Function)},modelValue:{type:dt(Array),default:()=>[]},format:{type:dt(Object),default:()=>({})},filterable:Boolean,props:{type:dt(Object),default:()=>ni({label:"label",key:"key",disabled:"disabled"})},targetOrder:{type:String,values:["original","push","unshift"],default:"original"},validateEvent:{type:Boolean,default:!0}}),HT=(e,t)=>[e,t].every(ln)||ln(e)&&Ki(t),lfe={[Eo]:(e,t,i)=>[e,i].every(ln)&&["left","right"].includes(t),[mr]:e=>ln(e),[XN]:HT,[JN]:HT},GT="checked-change",cfe=un({data:cm.data,optionRender:{type:dt(Function)},placeholder:String,title:String,filterable:Boolean,format:cm.format,filterMethod:cm.filterMethod,defaultChecked:cm.leftDefaultChecked,props:cm.props}),ufe={[GT]:HT},Py=e=>{const t={label:"label",key:"key",disabled:"disabled"};return ee(()=>({...t,...e.props}))},dfe=(e,t,i)=>{const a=Py(e),d=ee(()=>e.data.filter(M=>Nn(e.filterMethod)?e.filterMethod(t.query,M):String(M[a.value.label]||M[a.value.key]).toLowerCase().includes(t.query.toLowerCase()))),p=ee(()=>d.value.filter(M=>!M[a.value.disabled])),_=ee(()=>{const M=t.checked.length,k=e.data.length,{noChecked:z,hasChecked:F}=e.format;return z&&F?M>0?F.replace(/\${checked}/g,M.toString()).replace(/\${total}/g,k.toString()):z.replace(/\${total}/g,k.toString()):`${M}/${k}`}),r=ee(()=>{const M=t.checked.length;return M>0&&M<p.value.length}),S=()=>{const M=p.value.map(k=>k[a.value.key]);t.allChecked=M.length>0&&M.every(k=>t.checked.includes(k))},C=M=>{t.checked=M?p.value.map(k=>k[a.value.key]):[]};return qt(()=>t.checked,(M,k)=>{if(S(),t.checkChangeByUser){const z=M.concat(k).filter(F=>!M.includes(F)||!k.includes(F));i(GT,M,z)}else i(GT,M),t.checkChangeByUser=!0}),qt(p,()=>{S()}),qt(()=>e.data,()=>{const M=[],k=d.value.map(z=>z[a.value.key]);t.checked.forEach(z=>{k.includes(z)&&M.push(z)}),t.checkChangeByUser=!1,t.checked=M}),qt(()=>e.defaultChecked,(M,k)=>{if(k&&M.length===k.length&&M.every(B=>k.includes(B)))return;const z=[],F=p.value.map(B=>B[a.value.key]);M.forEach(B=>{F.includes(B)&&z.push(B)}),t.checkChangeByUser=!1,t.checked=z},{immediate:!0}),{filteredData:d,checkableData:p,checkedSummary:_,isIndeterminate:r,updateAllChecked:S,handleAllCheckedChange:C}},hfe=qe({name:"ElTransferPanel"}),ffe=qe({...hfe,props:cfe,emits:ufe,setup(e,{expose:t,emit:i}){const a=e,d=Hi(),p=({option:Y})=>Y,{t:_}=Gr(),r=en("transfer"),S=lo({checked:[],allChecked:!1,query:"",checkChangeByUser:!0}),C=Py(a),{filteredData:M,checkedSummary:k,isIndeterminate:z,handleAllCheckedChange:F}=dfe(a,S,i),B=ee(()=>!ja(S.query)&&ja(M.value)),N=ee(()=>!ja(d.default()[0].children)),{checked:j,allChecked:U,query:te}=Zi(S);return t({query:te}),(Y,q)=>(ae(),Oe("div",{class:pe(b(r).b("panel"))},[Ue("p",{class:pe(b(r).be("panel","header"))},[Ze(b(Il),{modelValue:b(U),"onUpdate:modelValue":J=>To(U)?U.value=J:null,indeterminate:b(z),"validate-event":!1,onChange:b(F)},{default:st(()=>[Rr(pn(Y.title)+" ",1),Ue("span",null,pn(b(k)),1)]),_:1},8,["modelValue","onUpdate:modelValue","indeterminate","onChange"])],2),Ue("div",{class:pe([b(r).be("panel","body"),b(r).is("with-footer",b(N))])},[Y.filterable?(ae(),kt(b(Us),{key:0,modelValue:b(te),"onUpdate:modelValue":J=>To(te)?te.value=J:null,class:pe(b(r).be("panel","filter")),size:"default",placeholder:Y.placeholder,"prefix-icon":b(z7),clearable:"","validate-event":!1},null,8,["modelValue","onUpdate:modelValue","class","placeholder","prefix-icon"])):yt("v-if",!0),hr(Ze(b(EF),{modelValue:b(j),"onUpdate:modelValue":J=>To(j)?j.value=J:null,"validate-event":!1,class:pe([b(r).is("filterable",Y.filterable),b(r).be("panel","list")])},{default:st(()=>[(ae(!0),Oe(Bn,null,Or(b(M),J=>(ae(),kt(b(Il),{key:J[b(C).key],class:pe(b(r).be("panel","item")),value:J[b(C).key],disabled:J[b(C).disabled],"validate-event":!1},{default:st(()=>{var ne;return[Ze(p,{option:(ne=Y.optionRender)==null?void 0:ne.call(Y,J)},null,8,["option"])]}),_:2},1032,["class","value","disabled"]))),128))]),_:1},8,["modelValue","onUpdate:modelValue","class"]),[[no,!b(B)&&!b(ja)(Y.data)]]),hr(Ue("div",{class:pe(b(r).be("panel","empty"))},[pt(Y.$slots,"empty",{},()=>[Rr(pn(b(B)?b(_)("el.transfer.noMatch"):b(_)("el.transfer.noData")),1)])],2),[[no,b(B)||b(ja)(Y.data)]])],2),b(N)?(ae(),Oe("p",{key:0,class:pe(b(r).be("panel","footer"))},[pt(Y.$slots,"default")],2)):yt("v-if",!0)],2))}});var pO=fn(ffe,[["__file","transfer-panel.vue"]]);const pfe=e=>{const t=Py(e),i=ee(()=>e.data.reduce((p,_)=>(p[_[t.value.key]]=_)&&p,{})),a=ee(()=>e.data.filter(p=>!e.modelValue.includes(p[t.value.key]))),d=ee(()=>e.targetOrder==="original"?e.data.filter(p=>e.modelValue.includes(p[t.value.key])):e.modelValue.reduce((p,_)=>{const r=i.value[_];return r&&p.push(r),p},[]));return{sourceData:a,targetData:d}},mfe=(e,t,i)=>{const a=Py(e),d=(r,S,C)=>{i(mr,r),i(Eo,r,S,C)};return{addToLeft:()=>{const r=e.modelValue.slice();t.rightChecked.forEach(S=>{const C=r.indexOf(S);C>-1&&r.splice(C,1)}),d(r,"left",t.rightChecked)},addToRight:()=>{let r=e.modelValue.slice();const S=e.data.filter(C=>{const M=C[a.value.key];return t.leftChecked.includes(M)&&!e.modelValue.includes(M)}).map(C=>C[a.value.key]);r=e.targetOrder==="unshift"?S.concat(r):r.concat(S),e.targetOrder==="original"&&(r=e.data.filter(C=>r.includes(C[a.value.key])).map(C=>C[a.value.key])),d(r,"right",t.leftChecked)}}},gfe=(e,t)=>({onSourceCheckedChange:(d,p)=>{e.leftChecked=d,p&&t(XN,d,p)},onTargetCheckedChange:(d,p)=>{e.rightChecked=d,p&&t(JN,d,p)}}),vfe=qe({name:"ElTransfer"}),_fe=qe({...vfe,props:cm,emits:lfe,setup(e,{expose:t,emit:i}){const a=e,d=Hi(),{t:p}=Gr(),_=en("transfer"),{formItem:r}=As(),S=lo({leftChecked:[],rightChecked:[]}),C=Py(a),{sourceData:M,targetData:k}=pfe(a),{onSourceCheckedChange:z,onTargetCheckedChange:F}=gfe(S,i),{addToLeft:B,addToRight:N}=mfe(a,S,i),j=Se(),U=Se(),te=fe=>{switch(fe){case"left":j.value.query="";break;case"right":U.value.query="";break}},Y=ee(()=>a.buttonTexts.length===2),q=ee(()=>a.titles[0]||p("el.transfer.titles.0")),J=ee(()=>a.titles[1]||p("el.transfer.titles.1")),ne=ee(()=>a.filterPlaceholder||p("el.transfer.filterPlaceholder"));qt(()=>a.modelValue,()=>{var fe;a.validateEvent&&((fe=r==null?void 0:r.validate)==null||fe.call(r,"change").catch(ce=>void 0))});const se=ee(()=>fe=>{var ce;if(a.renderContent)return a.renderContent(Kn,fe);const le=(((ce=d.default)==null?void 0:ce.call(d,{option:fe}))||[]).filter(ge=>ge.type!==os);return le.length?le:Kn("span",fe[C.value.label]||fe[C.value.key])});return t({clearQuery:te,leftPanel:j,rightPanel:U}),(fe,ce)=>(ae(),Oe("div",{class:pe(b(_).b())},[Ze(pO,{ref_key:"leftPanel",ref:j,data:b(M),"option-render":b(se),placeholder:b(ne),title:b(q),filterable:fe.filterable,format:fe.format,"filter-method":fe.filterMethod,"default-checked":fe.leftDefaultChecked,props:a.props,onCheckedChange:b(z)},{empty:st(()=>[pt(fe.$slots,"left-empty")]),default:st(()=>[pt(fe.$slots,"left-footer")]),_:3},8,["data","option-render","placeholder","title","filterable","format","filter-method","default-checked","props","onCheckedChange"]),Ue("div",{class:pe(b(_).e("buttons"))},[Ze(b(ss),{type:"primary",class:pe([b(_).e("button"),b(_).is("with-texts",b(Y))]),disabled:b(ja)(S.rightChecked),onClick:b(B)},{default:st(()=>[Ze(b(On),null,{default:st(()=>[Ze(b(Kd))]),_:1}),b(oo)(fe.buttonTexts[0])?yt("v-if",!0):(ae(),Oe("span",{key:0},pn(fe.buttonTexts[0]),1))]),_:1},8,["class","disabled","onClick"]),Ze(b(ss),{type:"primary",class:pe([b(_).e("button"),b(_).is("with-texts",b(Y))]),disabled:b(ja)(S.leftChecked),onClick:b(N)},{default:st(()=>[b(oo)(fe.buttonTexts[1])?yt("v-if",!0):(ae(),Oe("span",{key:0},pn(fe.buttonTexts[1]),1)),Ze(b(On),null,{default:st(()=>[Ze(b(ca))]),_:1})]),_:1},8,["class","disabled","onClick"])],2),Ze(pO,{ref_key:"rightPanel",ref:U,data:b(k),"option-render":b(se),placeholder:b(ne),filterable:fe.filterable,format:fe.format,"filter-method":fe.filterMethod,title:b(J),"default-checked":fe.rightDefaultChecked,props:a.props,onCheckedChange:b(F)},{empty:st(()=>[pt(fe.$slots,"right-empty")]),default:st(()=>[pt(fe.$slots,"right-footer")]),_:3},8,["data","option-render","placeholder","filterable","format","filter-method","title","default-checked","props","onCheckedChange"])],2))}});var yfe=fn(_fe,[["__file","transfer.vue"]]);const bfe=ur(yfe),Sm="$treeNodeId",mO=function(e,t){!t||t[Sm]||Object.defineProperty(t,Sm,{value:e.id,enumerable:!1,configurable:!1,writable:!1})},hM=(e,t)=>t==null?void 0:t[e||Sm],WT=(e,t,i)=>{const a=e.value.currentNode;i();const d=e.value.currentNode;a!==d&&t("current-change",d?d.data:null,d)},qT=e=>{let t=!0,i=!0,a=!0;for(let d=0,p=e.length;d<p;d++){const _=e[d];(_.checked!==!0||_.indeterminate)&&(t=!1,_.disabled||(a=!1)),(_.checked!==!1||_.indeterminate)&&(i=!1)}return{all:t,none:i,allWithoutDisable:a,half:!t&&!i}},m_=function(e){if(e.childNodes.length===0||e.loading)return;const{all:t,none:i,half:a}=qT(e.childNodes);t?(e.checked=!0,e.indeterminate=!1):a?(e.checked=!1,e.indeterminate=!0):i&&(e.checked=!1,e.indeterminate=!1);const d=e.parent;!d||d.level===0||e.store.checkStrictly||m_(d)},Db=function(e,t){const i=e.store.props,a=e.data||{},d=i[t];if(Nn(d))return d(a,e);if(Dn(d))return a[d];if(oo(d)){const p=a[t];return p===void 0?"":p}};let xfe=0,KT=class r1{constructor(t){this.id=xfe++,this.text=null,this.checked=!1,this.indeterminate=!1,this.data=null,this.expanded=!1,this.parent=null,this.visible=!0,this.isCurrent=!1,this.canFocus=!1;for(const i in t)to(t,i)&&(this[i]=t[i]);this.level=0,this.loaded=!1,this.childNodes=[],this.loading=!1,this.parent&&(this.level=this.parent.level+1)}initialize(){const t=this.store;if(!t)throw new Error("[Node]store is required!");t.registerNode(this);const i=t.props;if(i&&typeof i.isLeaf<"u"){const p=Db(this,"isLeaf");Ro(p)&&(this.isLeafByUser=p)}if(t.lazy!==!0&&this.data?(this.setData(this.data),t.defaultExpandAll&&(this.expanded=!0,this.canFocus=!0)):this.level>0&&t.lazy&&t.defaultExpandAll&&!this.isLeafByUser&&this.expand(),ln(this.data)||mO(this,this.data),!this.data)return;const a=t.defaultExpandedKeys,d=t.key;d&&a&&a.includes(this.key)&&this.expand(null,t.autoExpandParent),d&&t.currentNodeKey!==void 0&&this.key===t.currentNodeKey&&(t.currentNode=this,t.currentNode.isCurrent=!0),t.lazy&&t._initDefaultCheckedNode(this),this.updateLeafState(),this.parent&&(this.level===1||this.parent.expanded===!0)&&(this.canFocus=!0)}setData(t){ln(t)||mO(this,t),this.data=t,this.childNodes=[];let i;this.level===0&&ln(this.data)?i=this.data:i=Db(this,"children")||[];for(let a=0,d=i.length;a<d;a++)this.insertChild({data:i[a]})}get label(){return Db(this,"label")}get key(){const t=this.store.key;return this.data?this.data[t]:null}get disabled(){return Db(this,"disabled")}get nextSibling(){const t=this.parent;if(t){const i=t.childNodes.indexOf(this);if(i>-1)return t.childNodes[i+1]}return null}get previousSibling(){const t=this.parent;if(t){const i=t.childNodes.indexOf(this);if(i>-1)return i>0?t.childNodes[i-1]:null}return null}contains(t,i=!0){return(this.childNodes||[]).some(a=>a===t||i&&a.contains(t))}remove(){const t=this.parent;t&&t.removeChild(this)}insertChild(t,i,a){if(!t)throw new Error("InsertChild error: child is required.");if(!(t instanceof r1)){if(!a){const d=this.getChildren(!0);d.includes(t.data)||(oo(i)||i<0?d.push(t.data):d.splice(i,0,t.data))}Object.assign(t,{parent:this,store:this.store}),t=lo(new r1(t)),t instanceof r1&&t.initialize()}t.level=this.level+1,oo(i)||i<0?this.childNodes.push(t):this.childNodes.splice(i,0,t),this.updateLeafState()}insertBefore(t,i){let a;i&&(a=this.childNodes.indexOf(i)),this.insertChild(t,a)}insertAfter(t,i){let a;i&&(a=this.childNodes.indexOf(i),a!==-1&&(a+=1)),this.insertChild(t,a)}removeChild(t){const i=this.getChildren()||[],a=i.indexOf(t.data);a>-1&&i.splice(a,1);const d=this.childNodes.indexOf(t);d>-1&&(this.store&&this.store.deregisterNode(t),t.parent=null,this.childNodes.splice(d,1)),this.updateLeafState()}removeChildByData(t){let i=null;for(let a=0;a<this.childNodes.length;a++)if(this.childNodes[a].data===t){i=this.childNodes[a];break}i&&this.removeChild(i)}expand(t,i){const a=()=>{if(i){let d=this.parent;for(;d.level>0;)d.expanded=!0,d=d.parent}this.expanded=!0,t&&t(),this.childNodes.forEach(d=>{d.canFocus=!0})};this.shouldLoadData()?this.loadData(d=>{ln(d)&&(this.checked?this.setChecked(!0,!0):this.store.checkStrictly||m_(this),a())}):a()}doCreateChildren(t,i={}){t.forEach(a=>{this.insertChild(Object.assign({data:a},i),void 0,!0)})}collapse(){this.expanded=!1,this.childNodes.forEach(t=>{t.canFocus=!1})}shouldLoadData(){return this.store.lazy===!0&&this.store.load&&!this.loaded}updateLeafState(){if(this.store.lazy===!0&&this.loaded!==!0&&typeof this.isLeafByUser<"u"){this.isLeaf=this.isLeafByUser;return}const t=this.childNodes;if(!this.store.lazy||this.store.lazy===!0&&this.loaded===!0){this.isLeaf=!t||t.length===0;return}this.isLeaf=!1}setChecked(t,i,a,d){if(this.indeterminate=t==="half",this.checked=t===!0,this.store.checkStrictly)return;if(!(this.shouldLoadData()&&!this.store.checkDescendants)){const{all:_,allWithoutDisable:r}=qT(this.childNodes);!this.isLeaf&&!_&&r&&(this.checked=!1,t=!1);const S=()=>{if(i){const C=this.childNodes;for(let z=0,F=C.length;z<F;z++){const B=C[z];d=d||t!==!1;const N=B.disabled?B.checked:d;B.setChecked(N,i,!0,d)}const{half:M,all:k}=qT(C);k||(this.checked=k,this.indeterminate=M)}};if(this.shouldLoadData()){this.loadData(()=>{S(),m_(this)},{checked:t!==!1});return}else S()}const p=this.parent;!p||p.level===0||a||m_(p)}getChildren(t=!1){if(this.level===0)return this.data;const i=this.data;if(!i)return null;const a=this.store.props;let d="children";return a&&(d=a.children||"children"),i[d]===void 0&&(i[d]=null),t&&!i[d]&&(i[d]=[]),i[d]}updateChildren(){const t=this.getChildren()||[],i=this.childNodes.map(p=>p.data),a={},d=[];t.forEach((p,_)=>{const r=p[Sm];!!r&&i.findIndex(C=>C[Sm]===r)>=0?a[r]={index:_,data:p}:d.push({index:_,data:p})}),this.store.lazy||i.forEach(p=>{a[p[Sm]]||this.removeChildByData(p)}),d.forEach(({index:p,data:_})=>{this.insertChild({data:_},p)}),this.updateLeafState()}loadData(t,i={}){if(this.store.lazy===!0&&this.store.load&&!this.loaded&&(!this.loading||Object.keys(i).length)){this.loading=!0;const a=p=>{this.childNodes=[],this.doCreateChildren(p,i),this.loaded=!0,this.loading=!1,this.updateLeafState(),t&&t.call(this,p)},d=()=>{this.loading=!1};this.store.load(this,a,d)}else t&&t.call(this)}eachNode(t){const i=[this];for(;i.length;){const a=i.shift();i.unshift(...a.childNodes),t(a)}}reInitChecked(){this.store.checkStrictly||m_(this)}};class wfe{constructor(t){this.currentNode=null,this.currentNodeKey=null;for(const i in t)to(t,i)&&(this[i]=t[i]);this.nodesMap={}}initialize(){if(this.root=new KT({data:this.data,store:this}),this.root.initialize(),this.lazy&&this.load){const t=this.load;t(this.root,i=>{this.root.doCreateChildren(i),this._initDefaultCheckedNodes()})}else this._initDefaultCheckedNodes()}filter(t){const i=this.filterNodeMethod,a=this.lazy,d=async function(p){const _=p.root?p.root.childNodes:p.childNodes;for(const[r,S]of _.entries())S.visible=i.call(S,t,S.data,S),r%80===0&&r>0&&await Vn(),d(S);if(!p.visible&&_.length){let r=!0;r=!_.some(S=>S.visible),p.root?p.root.visible=r===!1:p.visible=r===!1}t&&p.visible&&!p.isLeaf&&(!a||p.loaded)&&p.expand()};d(this)}setData(t){t!==this.root.data?(this.nodesMap={},this.root.setData(t),this._initDefaultCheckedNodes(),this.setCurrentNodeKey(this.currentNodeKey)):this.root.updateChildren()}getNode(t){if(t instanceof KT)return t;const i=yr(t)?hM(this.key,t):t;return this.nodesMap[i]||null}insertBefore(t,i){const a=this.getNode(i);a.parent.insertBefore({data:t},a)}insertAfter(t,i){const a=this.getNode(i);a.parent.insertAfter({data:t},a)}remove(t){const i=this.getNode(t);i&&i.parent&&(i===this.currentNode&&(this.currentNode=null),i.parent.removeChild(i))}append(t,i){const a=rc(i)?this.root:this.getNode(i);a&&a.insertChild({data:t})}_initDefaultCheckedNodes(){const t=this.defaultCheckedKeys||[],i=this.nodesMap;t.forEach(a=>{const d=i[a];d&&d.setChecked(!0,!this.checkStrictly)})}_initDefaultCheckedNode(t){(this.defaultCheckedKeys||[]).includes(t.key)&&t.setChecked(!0,!this.checkStrictly)}setDefaultCheckedKey(t){t!==this.defaultCheckedKeys&&(this.defaultCheckedKeys=t,this._initDefaultCheckedNodes())}registerNode(t){const i=this.key;!t||!t.data||(i?t.key!==void 0&&(this.nodesMap[t.key]=t):this.nodesMap[t.id]=t)}deregisterNode(t){!this.key||!t||!t.data||(t.childNodes.forEach(a=>{this.deregisterNode(a)}),delete this.nodesMap[t.key])}getCheckedNodes(t=!1,i=!1){const a=[],d=function(p){(p.root?p.root.childNodes:p.childNodes).forEach(r=>{(r.checked||i&&r.indeterminate)&&(!t||t&&r.isLeaf)&&a.push(r.data),d(r)})};return d(this),a}getCheckedKeys(t=!1){return this.getCheckedNodes(t).map(i=>(i||{})[this.key])}getHalfCheckedNodes(){const t=[],i=function(a){(a.root?a.root.childNodes:a.childNodes).forEach(p=>{p.indeterminate&&t.push(p.data),i(p)})};return i(this),t}getHalfCheckedKeys(){return this.getHalfCheckedNodes().map(t=>(t||{})[this.key])}_getAllNodes(){const t=[],i=this.nodesMap;for(const a in i)to(i,a)&&t.push(i[a]);return t}updateChildren(t,i){const a=this.nodesMap[t];if(!a)return;const d=a.childNodes;for(let p=d.length-1;p>=0;p--){const _=d[p];this.remove(_.data)}for(let p=0,_=i.length;p<_;p++){const r=i[p];this.append(r,a.data)}}_setCheckedKeys(t,i=!1,a){const d=this._getAllNodes().sort((S,C)=>S.level-C.level),p=Object.create(null),_=Object.keys(a);d.forEach(S=>S.setChecked(!1,!1));const r=S=>{S.childNodes.forEach(C=>{var M;p[C.data[t]]=!0,(M=C.childNodes)!=null&&M.length&&r(C)})};for(let S=0,C=d.length;S<C;S++){const M=d[S],k=M.data[t].toString();if(!_.includes(k)){M.checked&&!p[k]&&M.setChecked(!1,!1);continue}if(M.childNodes.length&&r(M),M.isLeaf||this.checkStrictly){M.setChecked(!0,!1);continue}if(M.setChecked(!0,!0),i){M.setChecked(!1,!1);const F=function(B){B.childNodes.forEach(j=>{j.isLeaf||j.setChecked(!1,!1),F(j)})};F(M)}}}setCheckedNodes(t,i=!1){const a=this.key,d={};t.forEach(p=>{d[(p||{})[a]]=!0}),this._setCheckedKeys(a,i,d)}setCheckedKeys(t,i=!1){this.defaultCheckedKeys=t;const a=this.key,d={};t.forEach(p=>{d[p]=!0}),this._setCheckedKeys(a,i,d)}setDefaultExpandedKeys(t){t=t||[],this.defaultExpandedKeys=t,t.forEach(i=>{const a=this.getNode(i);a&&a.expand(null,this.autoExpandParent)})}setChecked(t,i,a){const d=this.getNode(t);d&&d.setChecked(!!i,a)}getCurrentNode(){return this.currentNode}setCurrentNode(t){const i=this.currentNode;i&&(i.isCurrent=!1),this.currentNode=t,this.currentNode.isCurrent=!0}setUserCurrentNode(t,i=!0){const a=t[this.key],d=this.nodesMap[a];this.setCurrentNode(d),i&&this.currentNode.level>1&&this.currentNode.parent.expand(null,!0)}setCurrentNodeKey(t,i=!0){if(this.currentNodeKey=t,t==null){this.currentNode&&(this.currentNode.isCurrent=!1),this.currentNode=null;return}const a=this.getNode(t);a&&(this.setCurrentNode(a),i&&this.currentNode.level>1&&this.currentNode.parent.expand(null,!0))}}const Sfe=qe({name:"ElTreeNodeContent",props:{node:{type:Object,required:!0},renderContent:Function},setup(e){const t=en("tree"),i=An("NodeInstance"),a=An("RootTree");return()=>{const d=e.node,{data:p,store:_}=d;return e.renderContent?e.renderContent(Kn,{_self:i,node:d,data:p,store:_}):pt(a.ctx.slots,"default",{node:d,data:p},()=>[Kn("span",{class:t.be("node","label")},[d.label])])}}});var Tfe=fn(Sfe,[["__file","tree-node-content.vue"]]);function QN(e){const t=An("TreeNodeMap",null),i={treeNodeExpand:a=>{e.node!==a&&e.node.collapse()},children:[]};return t&&t.children.push(i),Dr("TreeNodeMap",i),{broadcastExpanded:a=>{if(e.accordion)for(const d of i.children)d.treeNodeExpand(a)}}}const eB=Symbol("dragEvents");function Cfe({props:e,ctx:t,el$:i,dropIndicator$:a,store:d}){const p=en("tree"),_=Se({showDropIndicator:!1,draggingNode:null,dropNode:null,allowDrop:!0,dropType:null});return Dr(eB,{treeNodeDragStart:({event:M,treeNode:k})=>{if(Nn(e.allowDrag)&&!e.allowDrag(k.node))return M.preventDefault(),!1;M.dataTransfer.effectAllowed="move";try{M.dataTransfer.setData("text/plain","")}catch{}_.value.draggingNode=k,t.emit("node-drag-start",k.node,M)},treeNodeDragOver:({event:M,treeNode:k})=>{const z=k,F=_.value.dropNode;F&&F.node.id!==z.node.id&&js(F.$el,p.is("drop-inner"));const B=_.value.draggingNode;if(!B||!z)return;let N=!0,j=!0,U=!0,te=!0;Nn(e.allowDrop)&&(N=e.allowDrop(B.node,z.node,"prev"),te=j=e.allowDrop(B.node,z.node,"inner"),U=e.allowDrop(B.node,z.node,"next")),M.dataTransfer.dropEffect=j||N||U?"move":"none",(N||j||U)&&(F==null?void 0:F.node.id)!==z.node.id&&(F&&t.emit("node-drag-leave",B.node,F.node,M),t.emit("node-drag-enter",B.node,z.node,M)),N||j||U?_.value.dropNode=z:_.value.dropNode=null,z.node.nextSibling===B.node&&(U=!1),z.node.previousSibling===B.node&&(N=!1),z.node.contains(B.node,!1)&&(j=!1),(B.node===z.node||B.node.contains(z.node))&&(N=!1,j=!1,U=!1);const Y=z.$el.querySelector(`.${p.be("node","content")}`).getBoundingClientRect(),q=i.value.getBoundingClientRect();let J;const ne=N?j?.25:U?.45:1:-1,se=U?j?.75:N?.55:0:1;let fe=-9999;const ce=M.clientY-Y.top;ce<Y.height*ne?J="before":ce>Y.height*se?J="after":j?J="inner":J="none";const le=z.$el.querySelector(`.${p.be("node","expand-icon")}`).getBoundingClientRect(),ge=a.value;J==="before"?fe=le.top-q.top:J==="after"&&(fe=le.bottom-q.top),ge.style.top=`${fe}px`,ge.style.left=`${le.right-q.left}px`,J==="inner"?bl(z.$el,p.is("drop-inner")):js(z.$el,p.is("drop-inner")),_.value.showDropIndicator=J==="before"||J==="after",_.value.allowDrop=_.value.showDropIndicator||te,_.value.dropType=J,t.emit("node-drag-over",B.node,z.node,M)},treeNodeDragEnd:M=>{const{draggingNode:k,dropType:z,dropNode:F}=_.value;if(M.preventDefault(),M.dataTransfer&&(M.dataTransfer.dropEffect="move"),k&&F){const B={data:k.node.data};z!=="none"&&k.node.remove(),z==="before"?F.node.parent.insertBefore(B,F.node):z==="after"?F.node.parent.insertAfter(B,F.node):z==="inner"&&F.node.insertChild(B),z!=="none"&&(d.value.registerNode(B),d.value.key&&k.node.eachNode(N=>{var j;(j=d.value.nodesMap[N.data[d.value.key]])==null||j.setChecked(N.checked,!d.value.checkStrictly)})),js(F.$el,p.is("drop-inner")),t.emit("node-drag-end",k.node,F.node,z,M),z!=="none"&&t.emit("node-drop",k.node,F.node,z,M)}k&&!F&&t.emit("node-drag-end",k.node,null,z,M),_.value.showDropIndicator=!1,_.value.draggingNode=null,_.value.dropNode=null,_.value.allowDrop=!0}}),{dragState:_}}const Efe=qe({name:"ElTreeNode",components:{ElCollapseTransition:bx,ElCheckbox:Il,NodeContent:Tfe,ElIcon:On,Loading:Hc},props:{node:{type:KT,default:()=>({})},props:{type:Object,default:()=>({})},accordion:Boolean,renderContent:Function,renderAfterExpand:Boolean,showCheckbox:{type:Boolean,default:!1}},emits:["node-expand"],setup(e,t){const i=en("tree"),{broadcastExpanded:a}=QN(e),d=An("RootTree"),p=Se(!1),_=Se(!1),r=Se(),S=Se(),C=Se(),M=An(eB),k=wr();Dr("NodeInstance",k),e.node.expanded&&(p.value=!0,_.value=!0);const z=d.props.props.children||"children";qt(()=>{var ce;const le=(ce=e.node.data)==null?void 0:ce[z];return le&&[...le]},()=>{e.node.updateChildren()}),qt(()=>e.node.indeterminate,ce=>{N(e.node.checked,ce)}),qt(()=>e.node.checked,ce=>{N(ce,e.node.indeterminate)}),qt(()=>e.node.childNodes.length,()=>e.node.reInitChecked()),qt(()=>e.node.expanded,ce=>{Vn(()=>p.value=ce),ce&&(_.value=!0)});const F=ce=>hM(d.props.nodeKey,ce.data),B=ce=>{const le=e.props.class;if(!le)return{};let ge;if(Nn(le)){const{data:de}=ce;ge=le(de,ce)}else ge=le;return Dn(ge)?{[ge]:!0}:ge},N=(ce,le)=>{(r.value!==ce||S.value!==le)&&d.ctx.emit("check-change",e.node.data,ce,le),r.value=ce,S.value=le},j=ce=>{WT(d.store,d.ctx.emit,()=>{var le;if((le=d==null?void 0:d.props)==null?void 0:le.nodeKey){const de=F(e.node);d.store.value.setCurrentNodeKey(de)}else d.store.value.setCurrentNode(e.node)}),d.currentNode.value=e.node,d.props.expandOnClickNode&&te(),d.props.checkOnClickNode&&!e.node.disabled&&Y(!e.node.checked),d.ctx.emit("node-click",e.node.data,e.node,k,ce)},U=ce=>{var le;(le=d.instance.vnode.props)!=null&&le.onNodeContextmenu&&(ce.stopPropagation(),ce.preventDefault()),d.ctx.emit("node-contextmenu",ce,e.node.data,e.node,k)},te=()=>{e.node.isLeaf||(p.value?(d.ctx.emit("node-collapse",e.node.data,e.node,k),e.node.collapse()):e.node.expand(()=>{t.emit("node-expand",e.node.data,e.node,k)}))},Y=ce=>{e.node.setChecked(ce,!(d!=null&&d.props.checkStrictly)),Vn(()=>{const le=d.store.value;d.ctx.emit("check",e.node.data,{checkedNodes:le.getCheckedNodes(),checkedKeys:le.getCheckedKeys(),halfCheckedNodes:le.getHalfCheckedNodes(),halfCheckedKeys:le.getHalfCheckedKeys()})})};return{ns:i,node$:C,tree:d,expanded:p,childNodeRendered:_,oldChecked:r,oldIndeterminate:S,getNodeKey:F,getNodeClass:B,handleSelectChange:N,handleClick:j,handleContextMenu:U,handleExpandIconClick:te,handleCheckChange:Y,handleChildNodeExpand:(ce,le,ge)=>{a(le),d.ctx.emit("node-expand",ce,le,ge)},handleDragStart:ce=>{d.props.draggable&&M.treeNodeDragStart({event:ce,treeNode:e})},handleDragOver:ce=>{ce.preventDefault(),d.props.draggable&&M.treeNodeDragOver({event:ce,treeNode:{$el:C.value,node:e.node}})},handleDrop:ce=>{ce.preventDefault()},handleDragEnd:ce=>{d.props.draggable&&M.treeNodeDragEnd(ce)},CaretRight:Mz}}});function Mfe(e,t,i,a,d,p){const _=Er("el-icon"),r=Er("el-checkbox"),S=Er("loading"),C=Er("node-content"),M=Er("el-tree-node"),k=Er("el-collapse-transition");return hr((ae(),Oe("div",{ref:"node$",class:pe([e.ns.b("node"),e.ns.is("expanded",e.expanded),e.ns.is("current",e.node.isCurrent),e.ns.is("hidden",!e.node.visible),e.ns.is("focusable",!e.node.disabled),e.ns.is("checked",!e.node.disabled&&e.node.checked),e.getNodeClass(e.node)]),role:"treeitem",tabindex:"-1","aria-expanded":e.expanded,"aria-disabled":e.node.disabled,"aria-checked":e.node.checked,draggable:e.tree.props.draggable,"data-key":e.getNodeKey(e.node),onClick:Qn(e.handleClick,["stop"]),onContextmenu:e.handleContextMenu,onDragstart:Qn(e.handleDragStart,["stop"]),onDragover:Qn(e.handleDragOver,["stop"]),onDragend:Qn(e.handleDragEnd,["stop"]),onDrop:Qn(e.handleDrop,["stop"])},[Ue("div",{class:pe(e.ns.be("node","content")),style:$n({paddingLeft:(e.node.level-1)*e.tree.props.indent+"px"})},[e.tree.props.icon||e.CaretRight?(ae(),kt(_,{key:0,class:pe([e.ns.be("node","expand-icon"),e.ns.is("leaf",e.node.isLeaf),{expanded:!e.node.isLeaf&&e.expanded}]),onClick:Qn(e.handleExpandIconClick,["stop"])},{default:st(()=>[(ae(),kt(Tr(e.tree.props.icon||e.CaretRight)))]),_:1},8,["class","onClick"])):yt("v-if",!0),e.showCheckbox?(ae(),kt(r,{key:1,"model-value":e.node.checked,indeterminate:e.node.indeterminate,disabled:!!e.node.disabled,onClick:Qn(()=>{},["stop"]),onChange:e.handleCheckChange},null,8,["model-value","indeterminate","disabled","onClick","onChange"])):yt("v-if",!0),e.node.loading?(ae(),kt(_,{key:2,class:pe([e.ns.be("node","loading-icon"),e.ns.is("loading")])},{default:st(()=>[Ze(S)]),_:1},8,["class"])):yt("v-if",!0),Ze(C,{node:e.node,"render-content":e.renderContent},null,8,["node","render-content"])],6),Ze(k,null,{default:st(()=>[!e.renderAfterExpand||e.childNodeRendered?hr((ae(),Oe("div",{key:0,class:pe(e.ns.be("node","children")),role:"group","aria-expanded":e.expanded},[(ae(!0),Oe(Bn,null,Or(e.node.childNodes,z=>(ae(),kt(M,{key:e.getNodeKey(z),"render-content":e.renderContent,"render-after-expand":e.renderAfterExpand,"show-checkbox":e.showCheckbox,node:z,accordion:e.accordion,props:e.props,onNodeExpand:e.handleChildNodeExpand},null,8,["render-content","render-after-expand","show-checkbox","node","accordion","props","onNodeExpand"]))),128))],10,["aria-expanded"])),[[no,e.expanded]]):yt("v-if",!0)]),_:1})],42,["aria-expanded","aria-disabled","aria-checked","draggable","data-key","onClick","onContextmenu","onDragstart","onDragover","onDragend","onDrop"])),[[no,e.node.visible]])}var Ife=fn(Efe,[["render",Mfe],["__file","tree-node.vue"]]);function Afe({el$:e},t){const i=en("tree"),a=Uo([]),d=Uo([]);gr(()=>{_()}),hc(()=>{a.value=Array.from(e.value.querySelectorAll("[role=treeitem]")),d.value=Array.from(e.value.querySelectorAll("input[type=checkbox]"))}),qt(d,r=>{r.forEach(S=>{S.setAttribute("tabindex","-1")})}),So(e,"keydown",r=>{const S=r.target;if(!S.className.includes(i.b("node")))return;const C=r.code;a.value=Array.from(e.value.querySelectorAll(`.${i.is("focusable")}[role=treeitem]`));const M=a.value.indexOf(S);let k;if([En.up,En.down].includes(C)){if(r.preventDefault(),C===En.up){k=M===-1?0:M!==0?M-1:a.value.length-1;const F=k;for(;!t.value.getNode(a.value[k].dataset.key).canFocus;){if(k--,k===F){k=-1;break}k<0&&(k=a.value.length-1)}}else{k=M===-1?0:M<a.value.length-1?M+1:0;const F=k;for(;!t.value.getNode(a.value[k].dataset.key).canFocus;){if(k++,k===F){k=-1;break}k>=a.value.length&&(k=0)}}k!==-1&&a.value[k].focus()}[En.left,En.right].includes(C)&&(r.preventDefault(),S.click());const z=S.querySelector('[type="checkbox"]');[En.enter,En.numpadEnter,En.space].includes(C)&&z&&(r.preventDefault(),z.click())});const _=()=>{var r;a.value=Array.from(e.value.querySelectorAll(`.${i.is("focusable")}[role=treeitem]`)),d.value=Array.from(e.value.querySelectorAll("input[type=checkbox]"));const S=e.value.querySelectorAll(`.${i.is("checked")}[role=treeitem]`);if(S.length){S[0].setAttribute("tabindex","0");return}(r=a.value[0])==null||r.setAttribute("tabindex","0")}}const kfe=qe({name:"ElTree",components:{ElTreeNode:Ife},props:{data:{type:Array,default:()=>[]},emptyText:{type:String},renderAfterExpand:{type:Boolean,default:!0},nodeKey:String,checkStrictly:Boolean,defaultExpandAll:Boolean,expandOnClickNode:{type:Boolean,default:!0},checkOnClickNode:Boolean,checkDescendants:{type:Boolean,default:!1},autoExpandParent:{type:Boolean,default:!0},defaultCheckedKeys:Array,defaultExpandedKeys:Array,currentNodeKey:[String,Number],renderContent:Function,showCheckbox:{type:Boolean,default:!1},draggable:{type:Boolean,default:!1},allowDrag:Function,allowDrop:Function,props:{type:Object,default:()=>({children:"children",label:"label",disabled:"disabled"})},lazy:{type:Boolean,default:!1},highlightCurrent:Boolean,load:Function,filterNodeMethod:Function,accordion:Boolean,indent:{type:Number,default:18},icon:{type:Mo}},emits:["check-change","current-change","node-click","node-contextmenu","node-collapse","node-expand","check","node-drag-start","node-drag-end","node-drop","node-drag-leave","node-drag-enter","node-drag-over"],setup(e,t){const{t:i}=Gr(),a=en("tree"),d=An(rg,null),p=Se(new wfe({key:e.nodeKey,data:e.data,lazy:e.lazy,props:e.props,load:e.load,currentNodeKey:e.currentNodeKey,checkStrictly:e.checkStrictly,checkDescendants:e.checkDescendants,defaultCheckedKeys:e.defaultCheckedKeys,defaultExpandedKeys:e.defaultExpandedKeys,autoExpandParent:e.autoExpandParent,defaultExpandAll:e.defaultExpandAll,filterNodeMethod:e.filterNodeMethod}));p.value.initialize();const _=Se(p.value.root),r=Se(null),S=Se(null),C=Se(null),{broadcastExpanded:M}=QN(e),{dragState:k}=Cfe({props:e,ctx:t,el$:S,dropIndicator$:C,store:p});Afe({el$:S},p);const z=ee(()=>{const{childNodes:Ae}=_.value,me=d?d.hasFilteredOptions!==0:!1;return(!Ae||Ae.length===0||Ae.every(({visible:Be})=>!Be))&&!me});qt(()=>e.currentNodeKey,Ae=>{p.value.setCurrentNodeKey(Ae)}),qt(()=>e.defaultCheckedKeys,Ae=>{p.value.setDefaultCheckedKey(Ae)}),qt(()=>e.defaultExpandedKeys,Ae=>{p.value.setDefaultExpandedKeys(Ae)}),qt(()=>e.data,Ae=>{p.value.setData(Ae)},{deep:!0}),qt(()=>e.checkStrictly,Ae=>{p.value.checkStrictly=Ae});const F=Ae=>{if(!e.filterNodeMethod)throw new Error("[Tree] filterNodeMethod is required when filter");p.value.filter(Ae)},B=Ae=>hM(e.nodeKey,Ae.data),N=Ae=>{if(!e.nodeKey)throw new Error("[Tree] nodeKey is required in getNodePath");const me=p.value.getNode(Ae);if(!me)return[];const Be=[me.data];let Ve=me.parent;for(;Ve&&Ve!==_.value;)Be.push(Ve.data),Ve=Ve.parent;return Be.reverse()},j=(Ae,me)=>p.value.getCheckedNodes(Ae,me),U=Ae=>p.value.getCheckedKeys(Ae),te=()=>{const Ae=p.value.getCurrentNode();return Ae?Ae.data:null},Y=()=>{if(!e.nodeKey)throw new Error("[Tree] nodeKey is required in getCurrentKey");const Ae=te();return Ae?Ae[e.nodeKey]:null},q=(Ae,me)=>{if(!e.nodeKey)throw new Error("[Tree] nodeKey is required in setCheckedNodes");p.value.setCheckedNodes(Ae,me)},J=(Ae,me)=>{if(!e.nodeKey)throw new Error("[Tree] nodeKey is required in setCheckedKeys");p.value.setCheckedKeys(Ae,me)},ne=(Ae,me,Be)=>{p.value.setChecked(Ae,me,Be)},se=()=>p.value.getHalfCheckedNodes(),fe=()=>p.value.getHalfCheckedKeys(),ce=(Ae,me=!0)=>{if(!e.nodeKey)throw new Error("[Tree] nodeKey is required in setCurrentNode");WT(p,t.emit,()=>{M(Ae),p.value.setUserCurrentNode(Ae,me)})},le=(Ae,me=!0)=>{if(!e.nodeKey)throw new Error("[Tree] nodeKey is required in setCurrentKey");WT(p,t.emit,()=>{M(),p.value.setCurrentNodeKey(Ae,me)})},ge=Ae=>p.value.getNode(Ae),de=Ae=>{p.value.remove(Ae)},ke=(Ae,me)=>{p.value.append(Ae,me)},We=(Ae,me)=>{p.value.insertBefore(Ae,me)},we=(Ae,me)=>{p.value.insertAfter(Ae,me)},be=(Ae,me,Be)=>{M(me),t.emit("node-expand",Ae,me,Be)},Me=(Ae,me)=>{if(!e.nodeKey)throw new Error("[Tree] nodeKey is required in updateKeyChild");p.value.updateChildren(Ae,me)};return Dr("RootTree",{ctx:t,props:e,store:p,root:_,currentNode:r,instance:wr()}),Dr(Gc,void 0),{ns:a,store:p,root:_,currentNode:r,dragState:k,el$:S,dropIndicator$:C,isEmpty:z,filter:F,getNodeKey:B,getNodePath:N,getCheckedNodes:j,getCheckedKeys:U,getCurrentNode:te,getCurrentKey:Y,setCheckedNodes:q,setCheckedKeys:J,setChecked:ne,getHalfCheckedNodes:se,getHalfCheckedKeys:fe,setCurrentNode:ce,setCurrentKey:le,t:i,getNode:ge,remove:de,append:ke,insertBefore:We,insertAfter:we,handleNodeExpand:be,updateKeyChildren:Me}}});function Pfe(e,t,i,a,d,p){const _=Er("el-tree-node");return ae(),Oe("div",{ref:"el$",class:pe([e.ns.b(),e.ns.is("dragging",!!e.dragState.draggingNode),e.ns.is("drop-not-allow",!e.dragState.allowDrop),e.ns.is("drop-inner",e.dragState.dropType==="inner"),{[e.ns.m("highlight-current")]:e.highlightCurrent}]),role:"tree"},[(ae(!0),Oe(Bn,null,Or(e.root.childNodes,r=>(ae(),kt(_,{key:e.getNodeKey(r),node:r,props:e.props,accordion:e.accordion,"render-after-expand":e.renderAfterExpand,"show-checkbox":e.showCheckbox,"render-content":e.renderContent,onNodeExpand:e.handleNodeExpand},null,8,["node","props","accordion","render-after-expand","show-checkbox","render-content","onNodeExpand"]))),128)),e.isEmpty?(ae(),Oe("div",{key:0,class:pe(e.ns.e("empty-block"))},[pt(e.$slots,"empty",{},()=>{var r;return[Ue("span",{class:pe(e.ns.e("empty-text"))},pn((r=e.emptyText)!=null?r:e.t("el.tree.emptyText")),3)]})],2)):yt("v-if",!0),hr(Ue("div",{ref:"dropIndicator$",class:pe(e.ns.e("drop-indicator"))},null,2),[[no,e.dragState.showDropIndicator]])],2)}var Rfe=fn(kfe,[["render",Pfe],["__file","tree.vue"]]);const B1=ur(Rfe),Ofe=(e,{attrs:t,emit:i},{select:a,tree:d,key:p})=>{const _=en("tree-select");return qt(()=>e.data,()=>{e.filterable&&Vn(()=>{var S,C;(C=d.value)==null||C.filter((S=a.value)==null?void 0:S.states.inputValue)})},{flush:"post"}),{...Jl(Zi(e),Object.keys(Df.props)),...t,class:ee(()=>t.class),style:ee(()=>t.style),"onUpdate:modelValue":S=>i(mr,S),valueKey:p,popperClass:ee(()=>{const S=[_.e("popper")];return e.popperClass&&S.push(e.popperClass),S.join(" ")}),filterMethod:(S="")=>{var C;e.filterMethod?e.filterMethod(S):e.remoteMethod?e.remoteMethod(S):(C=d.value)==null||C.filter(S)}}},Lfe=qe({extends:M1,setup(e,t){const i=M1.setup(e,t);delete i.selectOptionClick;const a=wr().proxy;return Vn(()=>{i.select.states.cachedOptions.get(a.value)||i.select.onOptionCreate(a)}),qt(()=>t.attrs.visible,d=>{Vn(()=>{i.states.visible=d})},{immediate:!0}),i},methods:{selectOptionClick(){this.$el.parentElement.click()}}});function ZT(e){return e||e===0}function fM(e){return ln(e)&&e.length}function om(e){return ln(e)?e:ZT(e)?[e]:[]}function o1(e,t,i,a,d){for(let p=0;p<e.length;p++){const _=e[p];if(t(_,p,e,d))return a?a(_,p,e,d):_;{const r=i(_);if(fM(r)){const S=o1(r,t,i,a,_);if(S)return S}}}}function i1(e,t,i,a){for(let d=0;d<e.length;d++){const p=e[d];t(p,d,e,a);const _=i(p);fM(_)&&i1(_,t,i,p)}}const Dfe=(e,{attrs:t,slots:i,emit:a},{select:d,tree:p,key:_})=>{qt(()=>e.modelValue,()=>{e.showCheckbox&&Vn(()=>{const z=p.value;z&&!ms(z.getCheckedKeys(),om(e.modelValue))&&z.setCheckedKeys(om(e.modelValue))})},{immediate:!0,deep:!0});const r=ee(()=>({value:_.value,label:"label",children:"children",disabled:"disabled",isLeaf:"isLeaf",...e.props})),S=(z,F)=>{var B;const N=r.value[z];return Nn(N)?N(F,(B=p.value)==null?void 0:B.getNode(S("value",F))):F[N]},C=om(e.modelValue).map(z=>o1(e.data||[],F=>S("value",F)===z,F=>S("children",F),(F,B,N,j)=>j&&S("value",j))).filter(z=>ZT(z)),M=ee(()=>{if(!e.renderAfterExpand&&!e.lazy)return[];const z=[];return i1(e.data.concat(e.cacheData),F=>{const B=S("value",F);z.push({value:B,currentLabel:S("label",F),isDisabled:S("disabled",F)})},F=>S("children",F)),z}),k=()=>{var z;return(z=p.value)==null?void 0:z.getCheckedKeys().filter(F=>{var B;const N=(B=p.value)==null?void 0:B.getNode(F);return!Ki(N)&&ja(N.childNodes)})};return{...Jl(Zi(e),Object.keys(B1.props)),...t,nodeKey:_,expandOnClickNode:ee(()=>!e.checkStrictly&&e.expandOnClickNode),defaultExpandedKeys:ee(()=>e.defaultExpandedKeys?e.defaultExpandedKeys.concat(C):C),renderContent:(z,{node:F,data:B,store:N})=>z(Lfe,{value:S("value",B),label:S("label",B),disabled:S("disabled",B),visible:F.visible},e.renderContent?()=>e.renderContent(z,{node:F,data:B,store:N}):i.default?()=>i.default({node:F,data:B,store:N}):void 0),filterNodeMethod:(z,F,B)=>e.filterNodeMethod?e.filterNodeMethod(z,F,B):z?new RegExp(xE(z),"i").test(S("label",F)||""):!0,onNodeClick:(z,F,B)=>{var N,j,U,te;if((N=t.onNodeClick)==null||N.call(t,z,F,B),!(e.showCheckbox&&e.checkOnClickNode)){if(!e.showCheckbox&&(e.checkStrictly||F.isLeaf)){if(!S("disabled",z)){const Y=(j=d.value)==null?void 0:j.states.options.get(S("value",z));(U=d.value)==null||U.handleOptionSelect(Y)}}else e.expandOnClickNode&&B.proxy.handleExpandIconClick();(te=d.value)==null||te.focus()}},onCheck:(z,F)=>{var B;if(!e.showCheckbox)return;const N=S("value",z),j={};i1([p.value.store.root],q=>j[q.key]=q,q=>q.childNodes);const U=F.checkedKeys,te=e.multiple?om(e.modelValue).filter(q=>!(q in j)&&!U.includes(q)):[],Y=te.concat(U);if(e.checkStrictly)a(mr,e.multiple?Y:Y.includes(N)?N:void 0);else if(e.multiple){const q=k();a(mr,te.concat(q))}else{const q=o1([z],se=>!fM(S("children",se))&&!S("disabled",se),se=>S("children",se)),J=q?S("value",q):void 0,ne=ZT(e.modelValue)&&!!o1([z],se=>S("value",se)===e.modelValue,se=>S("children",se));a(mr,J===e.modelValue||ne?void 0:J)}Vn(()=>{var q;const J=om(e.modelValue);p.value.setCheckedKeys(J),(q=t.onCheck)==null||q.call(t,z,{checkedKeys:p.value.getCheckedKeys(),checkedNodes:p.value.getCheckedNodes(),halfCheckedKeys:p.value.getHalfCheckedKeys(),halfCheckedNodes:p.value.getHalfCheckedNodes()})}),(B=d.value)==null||B.focus()},onNodeExpand:(z,F,B)=>{var N;(N=t.onNodeExpand)==null||N.call(t,z,F,B),Vn(()=>{if(!e.checkStrictly&&e.lazy&&e.multiple&&F.checked){const j={},U=p.value.getCheckedKeys();i1([p.value.store.root],q=>j[q.key]=q,q=>q.childNodes);const te=om(e.modelValue).filter(q=>!(q in j)&&!U.includes(q)),Y=k();a(mr,te.concat(Y))}})},cacheOptions:M}};var zfe=qe({props:{data:{type:Array,default:()=>[]}},setup(e){const t=An(rg);return qt(()=>e.data,()=>{var i;e.data.forEach(d=>{t.states.cachedOptions.has(d.value)||t.states.cachedOptions.set(d.value,d)});const a=((i=t.selectRef)==null?void 0:i.querySelectorAll("input"))||[];Hr&&!Array.from(a).includes(document.activeElement)&&t.setSelected()},{flush:"post",immediate:!0}),()=>{}}});const Ffe=qe({name:"ElTreeSelect",inheritAttrs:!1,props:{...Df.props,...B1.props,cacheData:{type:Array,default:()=>[]}},setup(e,t){const{slots:i,expose:a}=t,d=Se(),p=Se(),_=ee(()=>e.nodeKey||e.valueKey||"value"),r=Ofe(e,t,{select:d,tree:p,key:_}),{cacheOptions:S,...C}=Dfe(e,t,{select:d,tree:p,key:_}),M=lo({});return a(M),gr(()=>{Object.assign(M,{...Jl(p.value,["filter","updateKeyChildren","getCheckedNodes","setCheckedNodes","getCheckedKeys","setCheckedKeys","setChecked","getHalfCheckedNodes","getHalfCheckedKeys","getCurrentKey","getCurrentNode","setCurrentKey","setCurrentNode","getNode","remove","append","insertBefore","insertAfter"]),...Jl(d.value,["focus","blur","selectedLabel"])})}),()=>Kn(Df,lo({...r,ref:k=>d.value=k}),{...i,default:()=>[Kn(zfe,{data:S.value}),Kn(B1,lo({...C,ref:k=>p.value=k}))]})}});var Nfe=fn(Ffe,[["__file","tree-select.vue"]]);const Bfe=ur(Nfe),pM=Symbol(),Vfe={key:-1,level:-1,data:{}};var g_=(e=>(e.KEY="id",e.LABEL="label",e.CHILDREN="children",e.DISABLED="disabled",e.CLASS="",e))(g_||{}),YT=(e=>(e.ADD="add",e.DELETE="delete",e))(YT||{});const tB={type:Number,default:26},$fe=un({data:{type:dt(Array),default:()=>ni([])},emptyText:{type:String},height:{type:Number,default:200},props:{type:dt(Object),default:()=>ni({children:"children",label:"label",disabled:"disabled",value:"id",class:""})},highlightCurrent:{type:Boolean,default:!1},showCheckbox:{type:Boolean,default:!1},defaultCheckedKeys:{type:dt(Array),default:()=>ni([])},checkStrictly:{type:Boolean,default:!1},defaultExpandedKeys:{type:dt(Array),default:()=>ni([])},indent:{type:Number,default:16},itemSize:tB,icon:{type:Mo},expandOnClickNode:{type:Boolean,default:!0},checkOnClickNode:{type:Boolean,default:!1},currentNodeKey:{type:dt([String,Number])},accordion:{type:Boolean,default:!1},filterMethod:{type:dt(Function)},perfMode:{type:Boolean,default:!0}}),Ufe=un({node:{type:dt(Object),default:()=>ni(Vfe)},expanded:{type:Boolean,default:!1},checked:{type:Boolean,default:!1},indeterminate:{type:Boolean,default:!1},showCheckbox:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},current:{type:Boolean,default:!1},hiddenExpandIcon:{type:Boolean,default:!1},itemSize:tB}),jfe=un({node:{type:dt(Object),required:!0}}),nB="node-click",rB="node-drop",oB="node-expand",iB="node-collapse",sB="current-change",aB="check",lB="check-change",cB="node-contextmenu",Hfe={[nB]:(e,t,i)=>e&&t&&i,[rB]:(e,t,i)=>e&&t&&i,[oB]:(e,t)=>e&&t,[iB]:(e,t)=>e&&t,[sB]:(e,t)=>e&&t,[aB]:(e,t)=>e&&t,[lB]:(e,t)=>e&&Ro(t),[cB]:(e,t,i)=>e&&t&&i},Gfe={click:(e,t)=>!!(e&&t),drop:(e,t)=>!!(e&&t),toggle:e=>!!e,check:(e,t)=>e&&Ro(t)};function Wfe(e,t){const i=Se(new Set),a=Se(new Set),{emit:d}=wr();qt([()=>t.value,()=>e.defaultCheckedKeys],()=>Vn(()=>{te(e.defaultCheckedKeys)}),{immediate:!0});const p=()=>{if(!t.value||!e.showCheckbox||e.checkStrictly)return;const{levelTreeNodeMap:Y,maxLevel:q}=t.value,J=i.value,ne=new Set;for(let se=q-1;se>=1;--se){const fe=Y.get(se);fe&&fe.forEach(ce=>{const le=ce.children;if(le){let ge=!0,de=!1;for(const ke of le){const We=ke.key;if(J.has(We))de=!0;else if(ne.has(We)){ge=!1,de=!0;break}else ge=!1}ge?J.add(ce.key):de?(ne.add(ce.key),J.delete(ce.key)):(J.delete(ce.key),ne.delete(ce.key))}})}a.value=ne},_=Y=>i.value.has(Y.key),r=Y=>a.value.has(Y.key),S=(Y,q,J=!0,ne=!0)=>{const se=i.value,fe=(ce,le)=>{se[le?YT.ADD:YT.DELETE](ce.key);const ge=ce.children;!e.checkStrictly&&ge&&ge.forEach(de=>{de.disabled||fe(de,le)})};fe(Y,q),ne&&p(),J&&C(Y,q)},C=(Y,q)=>{const{checkedNodes:J,checkedKeys:ne}=B(),{halfCheckedNodes:se,halfCheckedKeys:fe}=N();d(aB,Y.data,{checkedKeys:ne,checkedNodes:J,halfCheckedKeys:fe,halfCheckedNodes:se}),d(lB,Y.data,q)};function M(Y=!1){return B(Y).checkedKeys}function k(Y=!1){return B(Y).checkedNodes}function z(){return N().halfCheckedKeys}function F(){return N().halfCheckedNodes}function B(Y=!1){const q=[],J=[];if(t!=null&&t.value&&e.showCheckbox){const{treeNodeMap:ne}=t.value;i.value.forEach(se=>{const fe=ne.get(se);fe&&(!Y||Y&&fe.isLeaf)&&(J.push(se),q.push(fe.data))})}return{checkedKeys:J,checkedNodes:q}}function N(){const Y=[],q=[];if(t!=null&&t.value&&e.showCheckbox){const{treeNodeMap:J}=t.value;a.value.forEach(ne=>{const se=J.get(ne);se&&(q.push(ne),Y.push(se.data))})}return{halfCheckedNodes:Y,halfCheckedKeys:q}}function j(Y){i.value.clear(),a.value.clear(),Vn(()=>{te(Y)})}function U(Y,q){if(t!=null&&t.value&&e.showCheckbox){const J=t.value.treeNodeMap.get(Y);J&&S(J,q,!1)}}function te(Y){if(t!=null&&t.value){const{treeNodeMap:q}=t.value;if(e.showCheckbox&&q&&(Y==null?void 0:Y.length)>0){for(const J of Y){const ne=q.get(J);ne&&!_(ne)&&S(ne,!0,!1,!1)}p()}}}return{updateCheckedKeys:p,toggleCheckbox:S,isChecked:_,isIndeterminate:r,getCheckedKeys:M,getCheckedNodes:k,getHalfCheckedKeys:z,getHalfCheckedNodes:F,setChecked:U,setCheckedKeys:j}}function qfe(e,t){const i=Se(new Set([])),a=Se(new Set([])),d=ee(()=>Nn(e.filterMethod));function p(r){var S;if(!d.value)return;const C=new Set,M=a.value,k=i.value,z=[],F=((S=t.value)==null?void 0:S.treeNodes)||[],B=e.filterMethod;k.clear();function N(j){j.forEach(U=>{z.push(U),B!=null&&B(r,U.data,U)?z.forEach(Y=>{C.add(Y.key)}):U.isLeaf&&k.add(U.key);const te=U.children;if(te&&N(te),!U.isLeaf){if(!C.has(U.key))k.add(U.key);else if(te){let Y=!0;for(const q of te)if(!k.has(q.key)){Y=!1;break}Y?M.add(U.key):M.delete(U.key)}}z.pop()})}return N(F),C}function _(r){return a.value.has(r.key)}return{hiddenExpandIconKeySet:a,hiddenNodeKeySet:i,doFilter:p,isForceHiddenExpandIcon:_}}function Kfe(e,t){const i=Se(new Set(e.defaultExpandedKeys)),a=Se(),d=Uo(),p=Se();qt(()=>e.currentNodeKey,Re=>{a.value=Re},{immediate:!0}),qt(()=>e.data,Re=>{Bt(Re)},{immediate:!0});const{isIndeterminate:_,isChecked:r,toggleCheckbox:S,getCheckedKeys:C,getCheckedNodes:M,getHalfCheckedKeys:k,getHalfCheckedNodes:z,setChecked:F,setCheckedKeys:B}=Wfe(e,d),{doFilter:N,hiddenNodeKeySet:j,isForceHiddenExpandIcon:U}=qfe(e,d),te=ee(()=>{var Re;return((Re=e.props)==null?void 0:Re.value)||g_.KEY}),Y=ee(()=>{var Re;return((Re=e.props)==null?void 0:Re.children)||g_.CHILDREN}),q=ee(()=>{var Re;return((Re=e.props)==null?void 0:Re.disabled)||g_.DISABLED}),J=ee(()=>{var Re;return((Re=e.props)==null?void 0:Re.label)||g_.LABEL}),ne=ee(()=>{var Re;const nt=i.value,Qe=j.value,Yt=[],Xt=((Re=d.value)==null?void 0:Re.treeNodes)||[],$t=[];for(let Ot=Xt.length-1;Ot>=0;--Ot)$t.push(Xt[Ot]);for(;$t.length;){const Ot=$t.pop();if(!Qe.has(Ot.key)&&(Yt.push(Ot),Ot.children&&nt.has(Ot.key)))for(let Ft=Ot.children.length-1;Ft>=0;--Ft)$t.push(Ot.children[Ft])}return Yt}),se=ee(()=>ne.value.length>0);function fe(Re){const nt=new Map,Qe=new Map;let Yt=1;function Xt(Ot,Ft=1,sn=void 0){var an;const Pn=[];for(const bn of Ot){const It=ge(bn),Sn={level:Ft,key:It,data:bn};Sn.label=ke(bn),Sn.parent=sn;const Yn=le(bn);Sn.disabled=de(bn),Sn.isLeaf=!Yn||Yn.length===0,Yn&&Yn.length&&(Sn.children=Xt(Yn,Ft+1,Sn)),Pn.push(Sn),nt.set(It,Sn),Qe.has(Ft)||Qe.set(Ft,[]),(an=Qe.get(Ft))==null||an.push(Sn)}return Ft>Yt&&(Yt=Ft),Pn}const $t=Xt(Re);return{treeNodeMap:nt,levelTreeNodeMap:Qe,maxLevel:Yt,treeNodes:$t}}function ce(Re){const nt=N(Re);nt&&(i.value=nt)}function le(Re){return Re[Y.value]}function ge(Re){return Re?Re[te.value]:""}function de(Re){return Re[q.value]}function ke(Re){return Re[J.value]}function We(Re){i.value.has(Re.key)?Ve(Re):Be(Re)}function we(Re){const nt=new Set,Qe=d.value.treeNodeMap;Re.forEach(Yt=>{let Xt=Qe.get(Yt);for(;Xt&&!nt.has(Xt.key);)nt.add(Xt.key),Xt=Xt.parent}),i.value=nt}function be(Re,nt){t(nB,Re.data,Re,nt),Ae(Re),e.expandOnClickNode&&We(Re),e.showCheckbox&&e.checkOnClickNode&&!Re.disabled&&S(Re,!r(Re),!0)}function Me(Re,nt){t(rB,Re.data,Re,nt)}function Ae(Re){wt(Re)||(a.value=Re.key,t(sB,Re.data,Re))}function me(Re,nt){S(Re,nt)}function Be(Re){const nt=i.value;if(d.value&&e.accordion){const{treeNodeMap:Qe}=d.value;nt.forEach(Yt=>{const Xt=Qe.get(Yt);Re&&Re.level===(Xt==null?void 0:Xt.level)&&nt.delete(Yt)})}nt.add(Re.key),t(oB,Re.data,Re)}function Ve(Re){i.value.delete(Re.key),t(iB,Re.data,Re)}function bt(Re){return i.value.has(Re.key)}function Pe(Re){return!!Re.disabled}function wt(Re){const nt=a.value;return nt!==void 0&&nt===Re.key}function Mt(){var Re,nt;if(a.value)return(nt=(Re=d.value)==null?void 0:Re.treeNodeMap.get(a.value))==null?void 0:nt.data}function Nt(){return a.value}function vt(Re){a.value=Re}function Bt(Re){Vn(()=>d.value=fe(Re))}function Wt(Re){var nt;const Qe=yr(Re)?ge(Re):Re;return(nt=d.value)==null?void 0:nt.treeNodeMap.get(Qe)}function Fe(Re,nt="auto"){const Qe=Wt(Re);Qe&&p.value&&p.value.scrollToItem(ne.value.indexOf(Qe),nt)}function cn(Re){var nt;(nt=p.value)==null||nt.scrollTo(Re)}return{tree:d,flattenTree:ne,isNotEmpty:se,listRef:p,getKey:ge,getChildren:le,toggleExpand:We,toggleCheckbox:S,isExpanded:bt,isChecked:r,isIndeterminate:_,isDisabled:Pe,isCurrent:wt,isForceHiddenExpandIcon:U,handleNodeClick:be,handleNodeDrop:Me,handleNodeCheck:me,getCurrentNode:Mt,getCurrentKey:Nt,setCurrentKey:vt,getCheckedKeys:C,getCheckedNodes:M,getHalfCheckedKeys:k,getHalfCheckedNodes:z,setChecked:F,setCheckedKeys:B,filter:ce,setData:Bt,getNode:Wt,expandNode:Be,collapseNode:Ve,setExpandedKeys:we,scrollToNode:Fe,scrollTo:cn}}var Zfe=qe({name:"ElTreeNodeContent",props:jfe,setup(e){const t=An(pM),i=en("tree");return()=>{const a=e.node,{data:d}=a;return t!=null&&t.ctx.slots.default?t.ctx.slots.default({node:a,data:d}):Kn("span",{class:i.be("node","label")},[a==null?void 0:a.label])}}});const Yfe=qe({name:"ElTreeNode"}),Xfe=qe({...Yfe,props:Ufe,emits:Gfe,setup(e,{emit:t}){const i=e,a=An(pM),d=en("tree"),p=ee(()=>{var F;return(F=a==null?void 0:a.props.indent)!=null?F:16}),_=ee(()=>{var F;return(F=a==null?void 0:a.props.icon)!=null?F:Mz}),r=F=>{const B=a==null?void 0:a.props.props.class;if(!B)return{};let N;if(Nn(B)){const{data:j}=F;N=B(j,F)}else N=B;return Dn(N)?{[N]:!0}:N},S=F=>{t("click",i.node,F)},C=F=>{t("drop",i.node,F)},M=()=>{t("toggle",i.node)},k=F=>{t("check",i.node,F)},z=F=>{var B,N,j,U;(j=(N=(B=a==null?void 0:a.instance)==null?void 0:B.vnode)==null?void 0:N.props)!=null&&j.onNodeContextmenu&&(F.stopPropagation(),F.preventDefault()),a==null||a.ctx.emit(cB,F,(U=i.node)==null?void 0:U.data,i.node)};return(F,B)=>{var N,j,U;return ae(),Oe("div",{ref:"node$",class:pe([b(d).b("node"),b(d).is("expanded",F.expanded),b(d).is("current",F.current),b(d).is("focusable",!F.disabled),b(d).is("checked",!F.disabled&&F.checked),r(F.node)]),role:"treeitem",tabindex:"-1","aria-expanded":F.expanded,"aria-disabled":F.disabled,"aria-checked":F.checked,"data-key":(N=F.node)==null?void 0:N.key,onClick:Qn(S,["stop"]),onContextmenu:z,onDragover:Qn(()=>{},["prevent"]),onDragenter:Qn(()=>{},["prevent"]),onDrop:Qn(C,["stop"])},[Ue("div",{class:pe(b(d).be("node","content")),style:$n({paddingLeft:`${(F.node.level-1)*b(p)}px`,height:F.itemSize+"px"})},[b(_)?(ae(),kt(b(On),{key:0,class:pe([b(d).is("leaf",!!((j=F.node)!=null&&j.isLeaf)),b(d).is("hidden",F.hiddenExpandIcon),{expanded:!((U=F.node)!=null&&U.isLeaf)&&F.expanded},b(d).be("node","expand-icon")]),onClick:Qn(M,["stop"])},{default:st(()=>[(ae(),kt(Tr(b(_))))]),_:1},8,["class","onClick"])):yt("v-if",!0),F.showCheckbox?(ae(),kt(b(Il),{key:1,"model-value":F.checked,indeterminate:F.indeterminate,disabled:F.disabled,onChange:k,onClick:Qn(()=>{},["stop"])},null,8,["model-value","indeterminate","disabled","onClick"])):yt("v-if",!0),Ze(b(Zfe),{node:F.node},null,8,["node"])],6)],42,["aria-expanded","aria-disabled","aria-checked","data-key","onClick","onDragover","onDragenter","onDrop"])}}});var Jfe=fn(Xfe,[["__file","tree-node.vue"]]);const Qfe=qe({name:"ElTreeV2"}),epe=qe({...Qfe,props:$fe,emits:Hfe,setup(e,{expose:t,emit:i}){const a=e,d=Hi(),p=ee(()=>a.itemSize);Dr(pM,{ctx:{emit:i,slots:d},props:a,instance:wr()}),Dr(Gc,void 0);const{t:_}=Gr(),r=en("tree"),{flattenTree:S,isNotEmpty:C,listRef:M,toggleExpand:k,isExpanded:z,isIndeterminate:F,isChecked:B,isDisabled:N,isCurrent:j,isForceHiddenExpandIcon:U,handleNodeClick:te,handleNodeDrop:Y,handleNodeCheck:q,toggleCheckbox:J,getCurrentNode:ne,getCurrentKey:se,setCurrentKey:fe,getCheckedKeys:ce,getCheckedNodes:le,getHalfCheckedKeys:ge,getHalfCheckedNodes:de,setChecked:ke,setCheckedKeys:We,filter:we,setData:be,getNode:Me,expandNode:Ae,collapseNode:me,setExpandedKeys:Be,scrollToNode:Ve,scrollTo:bt}=Kfe(a,i);return t({toggleCheckbox:J,getCurrentNode:ne,getCurrentKey:se,setCurrentKey:fe,getCheckedKeys:ce,getCheckedNodes:le,getHalfCheckedKeys:ge,getHalfCheckedNodes:de,setChecked:ke,setCheckedKeys:We,filter:we,setData:be,getNode:Me,expandNode:Ae,collapseNode:me,setExpandedKeys:Be,scrollToNode:Ve,scrollTo:bt}),(Pe,wt)=>(ae(),Oe("div",{class:pe([b(r).b(),{[b(r).m("highlight-current")]:Pe.highlightCurrent}]),role:"tree"},[b(C)?(ae(),kt(b(W4),{key:0,ref_key:"listRef",ref:M,"class-name":b(r).b("virtual-list"),data:b(S),total:b(S).length,height:Pe.height,"item-size":b(p),"perf-mode":Pe.perfMode},{default:st(({data:Mt,index:Nt,style:vt})=>[(ae(),kt(Jfe,{key:Mt[Nt].key,style:$n(vt),node:Mt[Nt],expanded:b(z)(Mt[Nt]),"show-checkbox":Pe.showCheckbox,checked:b(B)(Mt[Nt]),indeterminate:b(F)(Mt[Nt]),"item-size":b(p),disabled:b(N)(Mt[Nt]),current:b(j)(Mt[Nt]),"hidden-expand-icon":b(U)(Mt[Nt]),onClick:b(te),onToggle:b(k),onCheck:b(q),onDrop:b(Y)},null,8,["style","node","expanded","show-checkbox","checked","indeterminate","item-size","disabled","current","hidden-expand-icon","onClick","onToggle","onCheck","onDrop"]))]),_:1},8,["class-name","data","total","height","item-size","perf-mode"])):(ae(),Oe("div",{key:1,class:pe(b(r).e("empty-block"))},[pt(Pe.$slots,"empty",{},()=>{var Mt;return[Ue("span",{class:pe(b(r).e("empty-text"))},pn((Mt=Pe.emptyText)!=null?Mt:b(_)("el.tree.emptyText")),3)]})],2))],2))}});var tpe=fn(epe,[["__file","tree.vue"]]);const npe=ur(tpe),uB=Symbol("uploadContextKey"),rpe="ElUpload";class ope extends Error{constructor(t,i,a,d){super(t),this.name="UploadAjaxError",this.status=i,this.method=a,this.url=d}}function gO(e,t,i){let a;return i.response?a=`${i.response.error||i.response}`:i.responseText?a=`${i.responseText}`:a=`fail to ${t.method} ${e} ${i.status}`,new ope(a,i.status,t.method,e)}function ipe(e){const t=e.responseText||e.response;if(!t)return t;try{return JSON.parse(t)}catch{return t}}const spe=e=>{typeof XMLHttpRequest>"u"&&ji(rpe,"XMLHttpRequest is undefined");const t=new XMLHttpRequest,i=e.action;t.upload&&t.upload.addEventListener("progress",p=>{const _=p;_.percent=p.total>0?p.loaded/p.total*100:0,e.onProgress(_)});const a=new FormData;if(e.data)for(const[p,_]of Object.entries(e.data))ln(_)&&_.length?a.append(p,..._):a.append(p,_);a.append(e.filename,e.file,e.file.name),t.addEventListener("error",()=>{e.onError(gO(i,e,t))}),t.addEventListener("load",()=>{if(t.status<200||t.status>=300)return e.onError(gO(i,e,t));e.onSuccess(ipe(t))}),t.open(e.method,i,!0),e.withCredentials&&"withCredentials"in t&&(t.withCredentials=!0);const d=e.headers||{};if(d instanceof Headers)d.forEach((p,_)=>t.setRequestHeader(_,p));else for(const[p,_]of Object.entries(d))Ki(_)||t.setRequestHeader(p,String(_));return t.send(a),t},dB=["text","picture","picture-card"];let ape=1;const XT=()=>Date.now()+ape++,hB=un({action:{type:String,default:"#"},headers:{type:dt(Object)},method:{type:String,default:"post"},data:{type:dt([Object,Function,Promise]),default:()=>ni({})},multiple:Boolean,name:{type:String,default:"file"},drag:Boolean,withCredentials:Boolean,showFileList:{type:Boolean,default:!0},accept:{type:String,default:""},fileList:{type:dt(Array),default:()=>ni([])},autoUpload:{type:Boolean,default:!0},listType:{type:String,values:dB,default:"text"},httpRequest:{type:dt(Function),default:spe},disabled:Boolean,limit:Number}),lpe=un({...hB,beforeUpload:{type:dt(Function),default:_o},beforeRemove:{type:dt(Function)},onRemove:{type:dt(Function),default:_o},onChange:{type:dt(Function),default:_o},onPreview:{type:dt(Function),default:_o},onSuccess:{type:dt(Function),default:_o},onProgress:{type:dt(Function),default:_o},onError:{type:dt(Function),default:_o},onExceed:{type:dt(Function),default:_o},crossorigin:{type:dt(String)}}),cpe=un({files:{type:dt(Array),default:()=>ni([])},disabled:{type:Boolean,default:!1},handlePreview:{type:dt(Function),default:_o},listType:{type:String,values:dB,default:"text"},crossorigin:{type:dt(String)}}),upe={remove:e=>!!e},dpe=qe({name:"ElUploadList"}),hpe=qe({...dpe,props:cpe,emits:upe,setup(e,{emit:t}){const i=e,{t:a}=Gr(),d=en("upload"),p=en("icon"),_=en("list"),r=ks(),S=Se(!1),C=ee(()=>[d.b("list"),d.bm("list",i.listType),d.is("disabled",i.disabled)]),M=k=>{t("remove",k)};return(k,z)=>(ae(),kt(cD,{tag:"ul",class:pe(b(C)),name:b(_).b()},{default:st(()=>[(ae(!0),Oe(Bn,null,Or(k.files,(F,B)=>(ae(),Oe("li",{key:F.uid||F.name,class:pe([b(d).be("list","item"),b(d).is(F.status),{focusing:S.value}]),tabindex:"0",onKeydown:Po(N=>!b(r)&&M(F),["delete"]),onFocus:N=>S.value=!0,onBlur:N=>S.value=!1,onClick:N=>S.value=!1},[pt(k.$slots,"default",{file:F,index:B},()=>[k.listType==="picture"||F.status!=="uploading"&&k.listType==="picture-card"?(ae(),Oe("img",{key:0,class:pe(b(d).be("list","item-thumbnail")),src:F.url,crossorigin:k.crossorigin,alt:""},null,10,["src","crossorigin"])):yt("v-if",!0),F.status==="uploading"||k.listType!=="picture-card"?(ae(),Oe("div",{key:1,class:pe(b(d).be("list","item-info"))},[Ue("a",{class:pe(b(d).be("list","item-name")),onClick:Qn(N=>k.handlePreview(F),["prevent"])},[Ze(b(On),{class:pe(b(p).m("document"))},{default:st(()=>[Ze(b(h7))]),_:1},8,["class"]),Ue("span",{class:pe(b(d).be("list","item-file-name")),title:F.name},pn(F.name),11,["title"])],10,["onClick"]),F.status==="uploading"?(ae(),kt(b(z4),{key:0,type:k.listType==="picture-card"?"circle":"line","stroke-width":k.listType==="picture-card"?6:2,percentage:Number(F.percentage),style:$n(k.listType==="picture-card"?"":"margin-top: 0.5rem")},null,8,["type","stroke-width","percentage","style"])):yt("v-if",!0)],2)):yt("v-if",!0),Ue("label",{class:pe(b(d).be("list","item-status-label"))},[k.listType==="text"?(ae(),kt(b(On),{key:0,class:pe([b(p).m("upload-success"),b(p).m("circle-check")])},{default:st(()=>[Ze(b(QC))]),_:1},8,["class"])):["picture-card","picture"].includes(k.listType)?(ae(),kt(b(On),{key:1,class:pe([b(p).m("upload-success"),b(p).m("check")])},{default:st(()=>[Ze(b(xy))]),_:1},8,["class"])):yt("v-if",!0)],2),b(r)?yt("v-if",!0):(ae(),kt(b(On),{key:2,class:pe(b(p).m("close")),onClick:N=>M(F)},{default:st(()=>[Ze(b(sc))]),_:2},1032,["class","onClick"])),yt(" Due to close btn only appears when li gets focused disappears after li gets blurred, thus keyboard navigation can never reach close btn"),yt(" This is a bug which needs to be fixed "),yt(" TODO: Fix the incorrect navigation interaction "),b(r)?yt("v-if",!0):(ae(),Oe("i",{key:3,class:pe(b(p).m("close-tip"))},pn(b(a)("el.upload.deleteTip")),3)),k.listType==="picture-card"?(ae(),Oe("span",{key:4,class:pe(b(d).be("list","item-actions"))},[Ue("span",{class:pe(b(d).be("list","item-preview")),onClick:N=>k.handlePreview(F)},[Ze(b(On),{class:pe(b(p).m("zoom-in"))},{default:st(()=>[Ze(b(Pz))]),_:1},8,["class"])],10,["onClick"]),b(r)?yt("v-if",!0):(ae(),Oe("span",{key:0,class:pe(b(d).be("list","item-delete")),onClick:N=>M(F)},[Ze(b(On),{class:pe(b(p).m("delete"))},{default:st(()=>[Ze(b(u7))]),_:1},8,["class"])],10,["onClick"]))],2)):yt("v-if",!0)])],42,["onKeydown","onFocus","onBlur","onClick"]))),128)),pt(k.$slots,"append")]),_:3},8,["class","name"]))}});var vO=fn(hpe,[["__file","upload-list.vue"]]);const fpe=un({disabled:{type:Boolean,default:!1}}),ppe={file:e=>ln(e)},fB="ElUploadDrag",mpe=qe({name:fB}),gpe=qe({...mpe,props:fpe,emits:ppe,setup(e,{emit:t}){An(uB)||ji(fB,"usage: <el-upload><el-upload-dragger /></el-upload>");const a=en("upload"),d=Se(!1),p=ks(),_=S=>{if(p.value)return;d.value=!1,S.stopPropagation();const C=Array.from(S.dataTransfer.files);t("file",C)},r=()=>{p.value||(d.value=!0)};return(S,C)=>(ae(),Oe("div",{class:pe([b(a).b("dragger"),b(a).is("dragover",d.value)]),onDrop:Qn(_,["prevent"]),onDragover:Qn(r,["prevent"]),onDragleave:Qn(M=>d.value=!1,["prevent"])},[pt(S.$slots,"default")],42,["onDrop","onDragover","onDragleave"]))}});var vpe=fn(gpe,[["__file","upload-dragger.vue"]]);const _pe=un({...hB,beforeUpload:{type:dt(Function),default:_o},onRemove:{type:dt(Function),default:_o},onStart:{type:dt(Function),default:_o},onSuccess:{type:dt(Function),default:_o},onProgress:{type:dt(Function),default:_o},onError:{type:dt(Function),default:_o},onExceed:{type:dt(Function),default:_o}}),ype=qe({name:"ElUploadContent",inheritAttrs:!1}),bpe=qe({...ype,props:_pe,setup(e,{expose:t}){const i=e,a=en("upload"),d=ks(),p=Uo({}),_=Uo(),r=N=>{if(N.length===0)return;const{autoUpload:j,limit:U,fileList:te,multiple:Y,onStart:q,onExceed:J}=i;if(U&&te.length+N.length>U){J(N,te);return}Y||(N=N.slice(0,1));for(const ne of N){const se=ne;se.uid=XT(),q(se),j&&S(se)}},S=async N=>{if(_.value.value="",!i.beforeUpload)return M(N);let j,U={};try{const Y=i.data,q=i.beforeUpload(N);U=D_(i.data)?b1(i.data):i.data,j=await q,D_(i.data)&&ms(Y,U)&&(U=b1(i.data))}catch{j=!1}if(j===!1){i.onRemove(N);return}let te=N;j instanceof Blob&&(j instanceof File?te=j:te=new File([j],N.name,{type:N.type})),M(Object.assign(te,{uid:N.uid}),U)},C=async(N,j)=>Nn(N)?N(j):N,M=async(N,j)=>{const{headers:U,data:te,method:Y,withCredentials:q,name:J,action:ne,onProgress:se,onSuccess:fe,onError:ce,httpRequest:le}=i;try{j=await C(j??te,N)}catch{i.onRemove(N);return}const{uid:ge}=N,de={headers:U||{},withCredentials:q,file:N,data:j,method:Y,filename:J,action:ne,onProgress:We=>{se(We,N)},onSuccess:We=>{fe(We,N),delete p.value[ge]},onError:We=>{ce(We,N),delete p.value[ge]}},ke=le(de);p.value[ge]=ke,ke instanceof Promise&&ke.then(de.onSuccess,de.onError)},k=N=>{const j=N.target.files;j&&r(Array.from(j))},z=()=>{d.value||(_.value.value="",_.value.click())},F=()=>{z()};return t({abort:N=>{xz(p.value).filter(N?([U])=>String(N.uid)===U:()=>!0).forEach(([U,te])=>{te instanceof XMLHttpRequest&&te.abort(),delete p.value[U]})},upload:S}),(N,j)=>(ae(),Oe("div",{class:pe([b(a).b(),b(a).m(N.listType),b(a).is("drag",N.drag),b(a).is("disabled",b(d))]),tabindex:b(d)?"-1":"0",onClick:z,onKeydown:Po(Qn(F,["self"]),["enter","space"])},[N.drag?(ae(),kt(vpe,{key:0,disabled:b(d),onFile:r},{default:st(()=>[pt(N.$slots,"default")]),_:3},8,["disabled"])):pt(N.$slots,"default",{key:1}),Ue("input",{ref_key:"inputRef",ref:_,class:pe(b(a).e("input")),name:N.name,disabled:b(d),multiple:N.multiple,accept:N.accept,type:"file",onChange:k,onClick:Qn(()=>{},["stop"])},null,42,["name","disabled","multiple","accept","onClick"])],42,["tabindex","onKeydown"]))}});var _O=fn(bpe,[["__file","upload-content.vue"]]);const yO="ElUpload",bO=e=>{var t;(t=e.url)!=null&&t.startsWith("blob:")&&URL.revokeObjectURL(e.url)},xpe=(e,t)=>{const i=fz(e,"fileList",void 0,{passive:!0}),a=F=>i.value.find(B=>B.uid===F.uid);function d(F){var B;(B=t.value)==null||B.abort(F)}function p(F=["ready","uploading","success","fail"]){i.value=i.value.filter(B=>!F.includes(B.status))}function _(F){i.value=i.value.filter(B=>B.uid!==F.uid)}const r=(F,B)=>{const N=a(B);N&&(console.error(F),N.status="fail",_(N),e.onError(F,N,i.value),e.onChange(N,i.value))},S=(F,B)=>{const N=a(B);N&&(e.onProgress(F,N,i.value),N.status="uploading",N.percentage=Math.round(F.percent))},C=(F,B)=>{const N=a(B);N&&(N.status="success",N.response=F,e.onSuccess(F,N,i.value),e.onChange(N,i.value))},M=F=>{Ki(F.uid)&&(F.uid=XT());const B={name:F.name,percentage:0,status:"ready",size:F.size,raw:F,uid:F.uid};if(e.listType==="picture-card"||e.listType==="picture")try{B.url=URL.createObjectURL(F)}catch(N){N.message,e.onError(N,B,i.value)}i.value=[...i.value,B],e.onChange(B,i.value)},k=async F=>{const B=F instanceof File?a(F):F;B||ji(yO,"file to be removed not found");const N=j=>{d(j),_(j),e.onRemove(j,i.value),bO(j)};e.beforeRemove?await e.beforeRemove(B,i.value)!==!1&&N(B):N(B)};function z(){i.value.filter(({status:F})=>F==="ready").forEach(({raw:F})=>{var B;return F&&((B=t.value)==null?void 0:B.upload(F))})}return qt(()=>e.listType,F=>{F!=="picture-card"&&F!=="picture"||(i.value=i.value.map(B=>{const{raw:N,url:j}=B;if(!j&&N)try{B.url=URL.createObjectURL(N)}catch(U){e.onError(U,B,i.value)}return B}))}),qt(i,F=>{for(const B of F)B.uid||(B.uid=XT()),B.status||(B.status="success")},{immediate:!0,deep:!0}),{uploadFiles:i,abort:d,clearFiles:p,handleError:r,handleProgress:S,handleStart:M,handleSuccess:C,handleRemove:k,submit:z,revokeFileObjectURL:bO}},wpe=qe({name:"ElUpload"}),Spe=qe({...wpe,props:lpe,setup(e,{expose:t}){const i=e,a=ks(),d=Uo(),{abort:p,submit:_,clearFiles:r,uploadFiles:S,handleStart:C,handleError:M,handleRemove:k,handleSuccess:z,handleProgress:F,revokeFileObjectURL:B}=xpe(i,d),N=ee(()=>i.listType==="picture-card"),j=ee(()=>({...i,fileList:S.value,onStart:C,onProgress:F,onSuccess:z,onError:M,onRemove:k}));return Oo(()=>{S.value.forEach(B)}),Dr(uB,{accept:po(i,"accept")}),t({abort:p,submit:_,clearFiles:r,handleStart:C,handleRemove:k}),(U,te)=>(ae(),Oe("div",null,[b(N)&&U.showFileList?(ae(),kt(vO,{key:0,disabled:b(a),"list-type":U.listType,files:b(S),crossorigin:U.crossorigin,"handle-preview":U.onPreview,onRemove:b(k)},Ya({append:st(()=>[Ze(_O,Mr({ref_key:"uploadRef",ref:d},b(j)),{default:st(()=>[U.$slots.trigger?pt(U.$slots,"trigger",{key:0}):yt("v-if",!0),!U.$slots.trigger&&U.$slots.default?pt(U.$slots,"default",{key:1}):yt("v-if",!0)]),_:3},16)]),_:2},[U.$slots.file?{name:"default",fn:st(({file:Y,index:q})=>[pt(U.$slots,"file",{file:Y,index:q})])}:void 0]),1032,["disabled","list-type","files","crossorigin","handle-preview","onRemove"])):yt("v-if",!0),!b(N)||b(N)&&!U.showFileList?(ae(),kt(_O,Mr({key:1,ref_key:"uploadRef",ref:d},b(j)),{default:st(()=>[U.$slots.trigger?pt(U.$slots,"trigger",{key:0}):yt("v-if",!0),!U.$slots.trigger&&U.$slots.default?pt(U.$slots,"default",{key:1}):yt("v-if",!0)]),_:3},16)):yt("v-if",!0),U.$slots.trigger?pt(U.$slots,"default",{key:2}):yt("v-if",!0),pt(U.$slots,"tip"),!b(N)&&U.showFileList?(ae(),kt(vO,{key:3,disabled:b(a),"list-type":U.listType,files:b(S),crossorigin:U.crossorigin,"handle-preview":U.onPreview,onRemove:b(k)},Ya({_:2},[U.$slots.file?{name:"default",fn:st(({file:Y,index:q})=>[pt(U.$slots,"file",{file:Y,index:q})])}:void 0]),1032,["disabled","list-type","files","crossorigin","handle-preview","onRemove"])):yt("v-if",!0)]))}});var Tpe=fn(Spe,[["__file","upload.vue"]]);const Cpe=ur(Tpe),Epe=un({zIndex:{type:Number,default:9},rotate:{type:Number,default:-22},width:Number,height:Number,image:String,content:{type:dt([String,Array]),default:"Element Plus"},font:{type:dt(Object)},gap:{type:dt(Array),default:()=>[100,100]},offset:{type:dt(Array)}});function Mpe(e){return e.replace(/([A-Z])/g,"-$1").toLowerCase()}function Ipe(e){return Object.keys(e).map(t=>`${Mpe(t)}: ${e[t]};`).join(" ")}function Ape(){return window.devicePixelRatio||1}const kpe=(e,t)=>{let i=!1;return e.removedNodes.length&&t&&(i=Array.from(e.removedNodes).includes(t)),e.type==="attributes"&&e.target===t&&(i=!0),i},pB=3;function SS(e,t,i=1){const a=document.createElement("canvas"),d=a.getContext("2d"),p=e*i,_=t*i;return a.setAttribute("width",`${p}px`),a.setAttribute("height",`${_}px`),d.save(),[d,a,p,_]}function Ppe(){function e(t,i,a,d,p,_,r,S){const[C,M,k,z]=SS(d,p,a);if(t instanceof HTMLImageElement)C.drawImage(t,0,0,k,z);else{const{color:Ve,fontSize:bt,fontStyle:Pe,fontWeight:wt,fontFamily:Mt,textAlign:Nt,textBaseline:vt}=_,Bt=Number(bt)*a;C.font=`${Pe} normal ${wt} ${Bt}px/${p}px ${Mt}`,C.fillStyle=Ve,C.textAlign=Nt,C.textBaseline=vt;const Wt=ln(t)?t:[t];Wt==null||Wt.forEach((Fe,cn)=>{C.fillText(Fe??"",k/2,cn*(Bt+pB*a))})}const F=Math.PI/180*Number(i),B=Math.max(d,p),[N,j,U]=SS(B,B,a);N.translate(U/2,U/2),N.rotate(F),k>0&&z>0&&N.drawImage(M,-k/2,-z/2);function te(Ve,bt){const Pe=Ve*Math.cos(F)-bt*Math.sin(F),wt=Ve*Math.sin(F)+bt*Math.cos(F);return[Pe,wt]}let Y=0,q=0,J=0,ne=0;const se=k/2,fe=z/2;[[0-se,0-fe],[0+se,0-fe],[0+se,0+fe],[0-se,0+fe]].forEach(([Ve,bt])=>{const[Pe,wt]=te(Ve,bt);Y=Math.min(Y,Pe),q=Math.max(q,Pe),J=Math.min(J,wt),ne=Math.max(ne,wt)});const le=Y+U/2,ge=J+U/2,de=q-Y,ke=ne-J,We=r*a,we=S*a,be=(de+We)*2,Me=ke+we,[Ae,me]=SS(be,Me);function Be(Ve=0,bt=0){Ae.drawImage(j,le,ge,de,ke,Ve,bt,de,ke)}return Be(),Be(de+We,-ke/2-we/2),Be(de+We,+ke/2+we/2),[me.toDataURL(),be/a,Me/a]}return e}const Rpe=qe({name:"ElWatermark"}),Ope=qe({...Rpe,props:Epe,setup(e){const t=e,i={position:"relative"},a=ee(()=>{var le,ge;return(ge=(le=t.font)==null?void 0:le.color)!=null?ge:"rgba(0,0,0,.15)"}),d=ee(()=>{var le,ge;return(ge=(le=t.font)==null?void 0:le.fontSize)!=null?ge:16}),p=ee(()=>{var le,ge;return(ge=(le=t.font)==null?void 0:le.fontWeight)!=null?ge:"normal"}),_=ee(()=>{var le,ge;return(ge=(le=t.font)==null?void 0:le.fontStyle)!=null?ge:"normal"}),r=ee(()=>{var le,ge;return(ge=(le=t.font)==null?void 0:le.fontFamily)!=null?ge:"sans-serif"}),S=ee(()=>{var le,ge;return(ge=(le=t.font)==null?void 0:le.textAlign)!=null?ge:"center"}),C=ee(()=>{var le,ge;return(ge=(le=t.font)==null?void 0:le.textBaseline)!=null?ge:"hanging"}),M=ee(()=>t.gap[0]),k=ee(()=>t.gap[1]),z=ee(()=>M.value/2),F=ee(()=>k.value/2),B=ee(()=>{var le,ge;return(ge=(le=t.offset)==null?void 0:le[0])!=null?ge:z.value}),N=ee(()=>{var le,ge;return(ge=(le=t.offset)==null?void 0:le[1])!=null?ge:F.value}),j=()=>{const le={zIndex:t.zIndex,position:"absolute",left:0,top:0,width:"100%",height:"100%",pointerEvents:"none",backgroundRepeat:"repeat"};let ge=B.value-z.value,de=N.value-F.value;return ge>0&&(le.left=`${ge}px`,le.width=`calc(100% - ${ge}px)`,ge=0),de>0&&(le.top=`${de}px`,le.height=`calc(100% - ${de}px)`,de=0),le.backgroundPosition=`${ge}px ${de}px`,le},U=Uo(null),te=Uo(),Y=Se(!1),q=()=>{te.value&&(te.value.remove(),te.value=void 0)},J=(le,ge)=>{var de;U.value&&te.value&&(Y.value=!0,te.value.setAttribute("style",Ipe({...j(),backgroundImage:`url('${le}')`,backgroundSize:`${Math.floor(ge)}px`})),(de=U.value)==null||de.append(te.value),setTimeout(()=>{Y.value=!1}))},ne=le=>{let ge=120,de=64;const ke=t.image,We=t.content,we=t.width,be=t.height;if(!ke&&le.measureText){le.font=`${Number(d.value)}px ${r.value}`;const Me=ln(We)?We:[We],Ae=Me.map(me=>{const Be=le.measureText(me);return[Be.width,Be.fontBoundingBoxAscent!==void 0?Be.fontBoundingBoxAscent+Be.fontBoundingBoxDescent:Be.actualBoundingBoxAscent+Be.actualBoundingBoxDescent]});ge=Math.ceil(Math.max(...Ae.map(me=>me[0]))),de=Math.ceil(Math.max(...Ae.map(me=>me[1])))*Me.length+(Me.length-1)*pB}return[we??ge,be??de]},se=Ppe(),fe=()=>{const ge=document.createElement("canvas").getContext("2d"),de=t.image,ke=t.content,We=t.rotate;if(ge){te.value||(te.value=document.createElement("div"));const we=Ape(),[be,Me]=ne(ge),Ae=me=>{const[Be,Ve]=se(me||"",We,we,be,Me,{color:a.value,fontSize:d.value,fontStyle:_.value,fontWeight:p.value,fontFamily:r.value,textAlign:S.value,textBaseline:C.value},M.value,k.value);J(Be,Ve)};if(de){const me=new Image;me.onload=()=>{Ae(me)},me.onerror=()=>{Ae(ke)},me.crossOrigin="anonymous",me.referrerPolicy="no-referrer",me.src=de}else Ae(ke)}};return gr(()=>{fe()}),qt(()=>t,()=>{fe()},{deep:!0,flush:"post"}),Oo(()=>{q()}),hz(U,le=>{Y.value||le.forEach(ge=>{kpe(ge,te.value)&&(q(),fe())})},{attributes:!0,subtree:!0,childList:!0}),(le,ge)=>(ae(),Oe("div",{ref_key:"containerRef",ref:U,style:$n([i])},[pt(le.$slots,"default")],4))}});var Lpe=fn(Ope,[["__file","watermark.vue"]]);const Dpe=ur(Lpe),zpe=un({zIndex:{type:Number,default:1001},visible:Boolean,fill:{type:String,default:"rgba(0,0,0,0.5)"},pos:{type:dt(Object)},targetAreaClickable:{type:Boolean,default:!0}}),Fpe=(e,t,i,a,d)=>{const p=Se(null),_=()=>{let k;return Dn(e.value)?k=document.querySelector(e.value):Nn(e.value)?k=e.value():k=e.value,k},r=()=>{const k=_();if(!k||!t.value){p.value=null;return}Npe(k)||k.scrollIntoView(d.value);const{left:z,top:F,width:B,height:N}=k.getBoundingClientRect();p.value={left:z,top:F,width:B,height:N,radius:0}};gr(()=>{qt([t,e],()=>{r()},{immediate:!0}),window.addEventListener("resize",r)}),Oo(()=>{window.removeEventListener("resize",r)});const S=k=>{var z;return(z=ln(i.value.offset)?i.value.offset[k]:i.value.offset)!=null?z:6},C=ee(()=>{var k;if(!p.value)return p.value;const z=S(0),F=S(1),B=((k=i.value)==null?void 0:k.radius)||2;return{left:p.value.left-z,top:p.value.top-F,width:p.value.width+z*2,height:p.value.height+F*2,radius:B}}),M=ee(()=>{const k=_();return!a.value||!k||!window.DOMRect?k||void 0:{getBoundingClientRect(){var z,F,B,N;return window.DOMRect.fromRect({width:((z=C.value)==null?void 0:z.width)||0,height:((F=C.value)==null?void 0:F.height)||0,x:((B=C.value)==null?void 0:B.left)||0,y:((N=C.value)==null?void 0:N.top)||0})}}});return{mergedPosInfo:C,triggerTarget:M}},Px=Symbol("ElTour");function Npe(e){const t=window.innerWidth||document.documentElement.clientWidth,i=window.innerHeight||document.documentElement.clientHeight,{top:a,right:d,bottom:p,left:_}=e.getBoundingClientRect();return a>=0&&_>=0&&d<=t&&p<=i}const Bpe=(e,t,i,a,d,p,_,r)=>{const S=Se(),C=Se(),M=Se({}),k={x:S,y:C,placement:a,strategy:d,middlewareData:M},z=ee(()=>{const U=[KN(b(p)),jhe(),Uhe(),Vpe()];return b(r)&&b(i)&&U.push(ZN({element:b(i)})),U}),F=async()=>{if(!Hr)return;const U=b(e),te=b(t);if(!U||!te)return;const Y=await YN(U,te,{placement:b(a),strategy:b(d),middleware:b(z)});Am(k).forEach(q=>{k[q].value=Y[q]})},B=ee(()=>{if(!b(e))return{position:"fixed",top:"50%",left:"50%",transform:"translate3d(-50%, -50%, 0)",maxWidth:"100vw",zIndex:b(_)};const{overflow:U}=b(M);return{position:b(d),zIndex:b(_),top:b(C)!=null?`${b(C)}px`:"",left:b(S)!=null?`${b(S)}px`:"",maxWidth:U!=null&&U.maxWidth?`${U==null?void 0:U.maxWidth}px`:""}}),N=ee(()=>{if(!b(r))return{};const{arrow:U}=b(M);return{left:(U==null?void 0:U.x)!=null?`${U==null?void 0:U.x}px`:"",top:(U==null?void 0:U.y)!=null?`${U==null?void 0:U.y}px`:""}});let j;return gr(()=>{const U=b(e),te=b(t);U&&te&&(j=Vhe(U,te,F)),Cs(()=>{F()})}),Oo(()=>{j&&j()}),{update:F,contentStyle:B,arrowStyle:N}},Vpe=()=>({name:"overflow",async fn(e){const t=await $he(e);let i=0;return t.left>0&&(i=t.left),t.right>0&&(i=t.right),{data:{maxWidth:e.rects.floating.width-i}}}}),$pe=qe({name:"ElTourMask",inheritAttrs:!1}),Upe=qe({...$pe,props:zpe,setup(e){const t=e,{ns:i}=An(Px),a=ee(()=>{var r,S;return(S=(r=t.pos)==null?void 0:r.radius)!=null?S:2}),d=ee(()=>{const r=a.value,S=`a${r},${r} 0 0 1`;return{topRight:`${S} ${r},${r}`,bottomRight:`${S} ${-r},${r}`,bottomLeft:`${S} ${-r},${-r}`,topLeft:`${S} ${r},${-r}`}}),p=ee(()=>{const r=window.innerWidth,S=window.innerHeight,C=d.value,M=`M${r},0 L0,0 L0,${S} L${r},${S} L${r},0 Z`,k=a.value;return t.pos?`${M} M${t.pos.left+k},${t.pos.top} h${t.pos.width-k*2} ${C.topRight} v${t.pos.height-k*2} ${C.bottomRight} h${-t.pos.width+k*2} ${C.bottomLeft} v${-t.pos.height+k*2} ${C.topLeft} z`:M}),_=ee(()=>({fill:t.fill,pointerEvents:"auto",cursor:"auto"}));return OE(po(t,"visible"),{ns:i}),(r,S)=>r.visible?(ae(),Oe("div",Mr({key:0,class:b(i).e("mask"),style:{position:"fixed",left:0,right:0,top:0,bottom:0,zIndex:r.zIndex,pointerEvents:r.pos&&r.targetAreaClickable?"none":"auto"}},r.$attrs),[(ae(),Oe("svg",{style:{width:"100%",height:"100%"}},[Ue("path",{class:pe(b(i).e("hollow")),style:$n(b(_)),d:b(p)},null,14,["d"])]))],16)):yt("v-if",!0)}});var jpe=fn(Upe,[["__file","mask.vue"]]);const Hpe=["absolute","fixed"],Gpe=["top-start","top-end","top","bottom-start","bottom-end","bottom","left-start","left-end","left","right-start","right-end","right"],mM=un({placement:{type:dt(String),values:Gpe,default:"bottom"},reference:{type:dt(Object),default:null},strategy:{type:dt(String),values:Hpe,default:"absolute"},offset:{type:Number,default:10},showArrow:Boolean,zIndex:{type:Number,default:2001}}),Wpe={close:()=>!0},qpe=qe({name:"ElTourContent"}),Kpe=qe({...qpe,props:mM,emits:Wpe,setup(e,{emit:t}){const i=e,a=Se(i.placement),d=Se(i.strategy),p=Se(null),_=Se(null);qt(()=>i.placement,()=>{a.value=i.placement});const{contentStyle:r,arrowStyle:S}=Bpe(po(i,"reference"),p,_,a,d,po(i,"offset"),po(i,"zIndex"),po(i,"showArrow")),C=ee(()=>a.value.split("-")[0]),{ns:M}=An(Px),k=()=>{t("close")},z=F=>{F.detail.focusReason==="pointer"&&F.preventDefault()};return(F,B)=>(ae(),Oe("div",{ref_key:"contentRef",ref:p,style:$n(b(r)),class:pe(b(M).e("content")),"data-side":b(C),tabindex:"-1"},[Ze(b(eg),{loop:"",trapped:"","focus-start-el":"container","focus-trap-el":p.value||void 0,onReleaseRequested:k,onFocusoutPrevented:z},{default:st(()=>[pt(F.$slots,"default")]),_:3},8,["focus-trap-el"]),F.showArrow?(ae(),Oe("span",{key:0,ref_key:"arrowRef",ref:_,style:$n(b(S)),class:pe(b(M).e("arrow"))},null,6)):yt("v-if",!0)],14,["data-side"]))}});var Zpe=fn(Kpe,[["__file","content.vue"]]),Ype=qe({name:"ElTourSteps",props:{current:{type:Number,default:0}},emits:["update-total"],setup(e,{slots:t,emit:i}){let a=0;return()=>{var d,p;const _=(d=t.default)==null?void 0:d.call(t),r=[];let S=0;function C(M){ln(M)&&M.forEach(k=>{var z;((z=(k==null?void 0:k.type)||{})==null?void 0:z.name)==="ElTourStep"&&(r.push(k),S+=1)})}return _.length&&C(Ou((p=_[0])==null?void 0:p.children)),a!==S&&(a=S,i("update-total",S)),r.length?r[e.current]:null}}});const Xpe=un({modelValue:Boolean,current:{type:Number,default:0},showArrow:{type:Boolean,default:!0},showClose:{type:Boolean,default:!0},closeIcon:{type:Mo},placement:mM.placement,contentStyle:{type:dt([Object])},mask:{type:dt([Boolean,Object]),default:!0},gap:{type:dt(Object),default:()=>({offset:6,radius:2})},zIndex:{type:Number},scrollIntoViewOptions:{type:dt([Boolean,Object]),default:()=>({block:"center"})},type:{type:dt(String)},appendTo:{type:dt([String,Object]),default:"body"},closeOnPressEscape:{type:Boolean,default:!0},targetAreaClickable:{type:Boolean,default:!0}}),Jpe={[mr]:e=>Ro(e),"update:current":e=>Gn(e),close:e=>Gn(e),finish:()=>!0,change:e=>Gn(e)},Qpe=qe({name:"ElTour"}),eme=qe({...Qpe,props:Xpe,emits:Jpe,setup(e,{emit:t}){const i=e,a=en("tour"),d=Se(0),p=Se(),_=fz(i,"current",t,{passive:!0}),r=ee(()=>{var ce;return(ce=p.value)==null?void 0:ce.target}),S=ee(()=>[a.b(),j.value==="primary"?a.m("primary"):""]),C=ee(()=>{var ce;return((ce=p.value)==null?void 0:ce.placement)||i.placement}),M=ee(()=>{var ce,le;return(le=(ce=p.value)==null?void 0:ce.contentStyle)!=null?le:i.contentStyle}),k=ee(()=>{var ce,le;return(le=(ce=p.value)==null?void 0:ce.mask)!=null?le:i.mask}),z=ee(()=>!!k.value&&i.modelValue),F=ee(()=>Ro(k.value)?void 0:k.value),B=ee(()=>{var ce,le;return!!r.value&&((le=(ce=p.value)==null?void 0:ce.showArrow)!=null?le:i.showArrow)}),N=ee(()=>{var ce,le;return(le=(ce=p.value)==null?void 0:ce.scrollIntoViewOptions)!=null?le:i.scrollIntoViewOptions}),j=ee(()=>{var ce,le;return(le=(ce=p.value)==null?void 0:ce.type)!=null?le:i.type}),{nextZIndex:U}=Jm(),te=U(),Y=ee(()=>{var ce;return(ce=i.zIndex)!=null?ce:te}),{mergedPosInfo:q,triggerTarget:J}=Fpe(r,po(i,"modelValue"),po(i,"gap"),k,N);qt(()=>i.modelValue,ce=>{ce||(_.value=0)});const ne=()=>{i.closeOnPressEscape&&(t("update:modelValue",!1),t("close",_.value))},se=ce=>{d.value=ce},fe=Hi();return Dr(Px,{currentStep:p,current:_,total:d,showClose:po(i,"showClose"),closeIcon:po(i,"closeIcon"),mergedType:j,ns:a,slots:fe,updateModelValue(ce){t("update:modelValue",ce)},onClose(){t("close",_.value)},onFinish(){t("finish")},onChange(){t("change",_.value)}}),(ce,le)=>(ae(),Oe(Bn,null,[Ze(b(tg),{to:ce.appendTo},{default:st(()=>{var ge,de;return[Ue("div",Mr({class:b(S)},ce.$attrs),[Ze(jpe,{visible:b(z),fill:(ge=b(F))==null?void 0:ge.color,style:$n((de=b(F))==null?void 0:de.style),pos:b(q),"z-index":b(Y),"target-area-clickable":ce.targetAreaClickable},null,8,["visible","fill","style","pos","z-index","target-area-clickable"]),ce.modelValue?(ae(),kt(Zpe,{key:b(_),reference:b(J),placement:b(C),"show-arrow":b(B),"z-index":b(Y),style:$n(b(M)),onClose:ne},{default:st(()=>[Ze(b(Ype),{current:b(_),onUpdateTotal:se},{default:st(()=>[pt(ce.$slots,"default")]),_:3},8,["current"])]),_:3},8,["reference","placement","show-arrow","z-index","style"])):yt("v-if",!0)],16)]}),_:3},8,["to"]),yt(" just for IDE "),yt("v-if",!0)],64))}});var tme=fn(eme,[["__file","tour.vue"]]);const nme=un({target:{type:dt([String,Object,Function])},title:String,description:String,showClose:{type:Boolean,default:void 0},closeIcon:{type:Mo},showArrow:{type:Boolean,default:void 0},placement:mM.placement,mask:{type:dt([Boolean,Object]),default:void 0},contentStyle:{type:dt([Object])},prevButtonProps:{type:dt(Object)},nextButtonProps:{type:dt(Object)},scrollIntoViewOptions:{type:dt([Boolean,Object]),default:void 0},type:{type:dt(String)}}),rme={close:()=>!0},ome=qe({name:"ElTourStep"}),ime=qe({...ome,props:nme,emits:rme,setup(e,{emit:t}){const i=e,{Close:a}=nE,{t:d}=Gr(),{currentStep:p,current:_,total:r,showClose:S,closeIcon:C,mergedType:M,ns:k,slots:z,updateModelValue:F,onClose:B,onFinish:N,onChange:j}=An(Px);qt(i,fe=>{p.value=fe},{immediate:!0});const U=ee(()=>{var fe;return(fe=i.showClose)!=null?fe:S.value}),te=ee(()=>{var fe,ce;return(ce=(fe=i.closeIcon)!=null?fe:C.value)!=null?ce:a}),Y=fe=>{if(fe)return Aq(fe,["children","onClick"])},q=()=>{var fe,ce;_.value-=1,(fe=i.prevButtonProps)!=null&&fe.onClick&&((ce=i.prevButtonProps)==null||ce.onClick()),j()},J=()=>{var fe;_.value>=r.value-1?ne():_.value+=1,(fe=i.nextButtonProps)!=null&&fe.onClick&&i.nextButtonProps.onClick(),j()},ne=()=>{se(),N()},se=()=>{F(!1),B(),t("close")};return(fe,ce)=>(ae(),Oe(Bn,null,[b(U)?(ae(),Oe("button",{key:0,"aria-label":"Close",class:pe(b(k).e("closebtn")),type:"button",onClick:se},[Ze(b(On),{class:pe(b(k).e("close"))},{default:st(()=>[(ae(),kt(Tr(b(te))))]),_:1},8,["class"])],2)):yt("v-if",!0),Ue("header",{class:pe([b(k).e("header"),{"show-close":b(S)}])},[pt(fe.$slots,"header",{},()=>[Ue("span",{role:"heading",class:pe(b(k).e("title"))},pn(fe.title),3)])],2),Ue("div",{class:pe(b(k).e("body"))},[pt(fe.$slots,"default",{},()=>[Ue("span",null,pn(fe.description),1)])],2),Ue("footer",{class:pe(b(k).e("footer"))},[Ue("div",{class:pe(b(k).b("indicators"))},[b(z).indicators?(ae(),kt(Tr(b(z).indicators),{key:0,current:b(_),total:b(r)},null,8,["current","total"])):(ae(!0),Oe(Bn,{key:1},Or(b(r),(le,ge)=>(ae(),Oe("span",{key:le,class:pe([b(k).b("indicator"),ge===b(_)?"is-active":""])},null,2))),128))],2),Ue("div",{class:pe(b(k).b("buttons"))},[b(_)>0?(ae(),kt(b(ss),Mr({key:0,size:"small",type:b(M)},Y(fe.prevButtonProps),{onClick:q}),{default:st(()=>{var le,ge;return[Rr(pn((ge=(le=fe.prevButtonProps)==null?void 0:le.children)!=null?ge:b(d)("el.tour.previous")),1)]}),_:1},16,["type"])):yt("v-if",!0),b(_)<=b(r)-1?(ae(),kt(b(ss),Mr({key:1,size:"small",type:b(M)==="primary"?"default":"primary"},Y(fe.nextButtonProps),{onClick:J}),{default:st(()=>{var le,ge;return[Rr(pn((ge=(le=fe.nextButtonProps)==null?void 0:le.children)!=null?ge:b(_)===b(r)-1?b(d)("el.tour.finish"):b(d)("el.tour.next")),1)]}),_:1},16,["type"])):yt("v-if",!0)],2)],2)],64))}});var mB=fn(ime,[["__file","step.vue"]]);const sme=ur(tme,{TourStep:mB}),ame=ri(mB),lme=un({container:{type:dt([String,Object])},offset:{type:Number,default:0},bound:{type:Number,default:15},duration:{type:Number,default:300},marker:{type:Boolean,default:!0},type:{type:dt(String),default:"default"},direction:{type:dt(String),default:"vertical"},selectScrollTop:{type:Boolean,default:!1}}),cme={change:e=>Dn(e),click:(e,t)=>e instanceof MouseEvent&&(Dn(t)||oo(t))},gB=Symbol("anchor"),zb=e=>{if(!Hr||e==="")return null;if(Dn(e))try{return document.querySelector(e)}catch{return null}return e};function ume(e){let t=0;const i=(...a)=>{t&&Lf(t),t=qd(()=>{e(...a),t=0})};return i.cancel=()=>{Lf(t),t=0},i}const dme=qe({name:"ElAnchor"}),hme=qe({...dme,props:lme,emits:cme,setup(e,{expose:t,emit:i}){const a=e,d=Se(""),p=Se(null),_=Se(null),r=Se(),S={};let C=!1,M=0;const k=en("anchor"),z=ee(()=>[k.b(),a.type==="underline"?k.m("underline"):"",k.m(a.direction)]),F=fe=>{S[fe.href]=fe.el},B=fe=>{delete S[fe]},N=fe=>{d.value!==fe&&(d.value=fe,i("change",fe))};let j=null;const U=fe=>{if(!r.value)return;const ce=zb(fe);if(!ce)return;j&&j(),C=!0;const le=P3(ce,r.value),ge=lT(ce,le),de=le.scrollHeight-le.clientHeight,ke=Math.min(ge-a.offset,de);j=R9(r.value,M,ke,a.duration,()=>{setTimeout(()=>{C=!1},20)})},te=fe=>{fe&&(N(fe),U(fe))},Y=(fe,ce)=>{i("click",fe,ce),te(ce)},q=ume(()=>{r.value&&(M=R3(r.value));const fe=J();C||oo(fe)||N(fe)}),J=()=>{if(!r.value)return;const fe=R3(r.value),ce=[];for(const le of Object.keys(S)){const ge=zb(le);if(!ge)continue;const de=P3(ge,r.value),ke=lT(ge,de);ce.push({top:ke-a.offset-a.bound,href:le})}ce.sort((le,ge)=>le.top-ge.top);for(let le=0;le<ce.length;le++){const ge=ce[le],de=ce[le+1];if(le===0&&fe===0)return a.selectScrollTop?ge.href:"";if(ge.top<=fe&&(!de||de.top>fe))return ge.href}},ne=()=>{const fe=zb(a.container);!fe||ux(fe)?r.value=window:r.value=fe};So(r,"scroll",q);const se=ee(()=>{if(!p.value||!_.value||!d.value)return{};const fe=S[d.value];if(!fe)return{};const ce=p.value.getBoundingClientRect(),le=_.value.getBoundingClientRect(),ge=fe.getBoundingClientRect();return a.direction==="horizontal"?{left:`${ge.left-ce.left}px`,width:`${ge.width}px`,opacity:1}:{top:`${ge.top-ce.top+(ge.height-le.height)/2}px`,opacity:1}});return gr(()=>{ne();const fe=decodeURIComponent(window.location.hash);zb(fe)?te(fe):q()}),qt(()=>a.container,()=>{ne()}),Dr(gB,{ns:k,direction:a.direction,currentAnchor:d,addLink:F,removeLink:B,handleClick:Y}),t({scrollTo:te}),(fe,ce)=>(ae(),Oe("div",{ref_key:"anchorRef",ref:p,class:pe(b(z))},[fe.marker?(ae(),Oe("div",{key:0,ref_key:"markerRef",ref:_,class:pe(b(k).e("marker")),style:$n(b(se))},null,6)):yt("v-if",!0),Ue("div",{class:pe(b(k).e("list"))},[pt(fe.$slots,"default")],2)],2))}});var fme=fn(hme,[["__file","anchor.vue"]]);const pme=un({title:String,href:String}),mme=qe({name:"ElAnchorLink"}),gme=qe({...mme,props:pme,setup(e){const t=e,i=Se(null),{ns:a,direction:d,currentAnchor:p,addLink:_,removeLink:r,handleClick:S}=An(gB),C=ee(()=>[a.e("link"),a.is("active",p.value===t.href)]),M=k=>{S(k,t.href)};return qt(()=>t.href,(k,z)=>{Vn(()=>{z&&r(z),k&&_({href:k,el:i.value})})}),gr(()=>{const{href:k}=t;k&&_({href:k,el:i.value})}),Oo(()=>{const{href:k}=t;k&&r(k)}),(k,z)=>(ae(),Oe("div",{class:pe(b(a).e("item"))},[Ue("a",{ref_key:"linkRef",ref:i,class:pe(b(C)),href:k.href,onClick:M},[pt(k.$slots,"default",{},()=>[Rr(pn(k.title),1)])],10,["href"]),k.$slots["sub-link"]&&b(d)==="vertical"?(ae(),Oe("div",{key:0,class:pe(b(a).e("list"))},[pt(k.$slots,"sub-link")],2)):yt("v-if",!0)],2))}});var vB=fn(gme,[["__file","anchor-link.vue"]]);const vme=ur(fme,{AnchorLink:vB}),_me=ri(vB),yme=un({direction:{type:dt(String),default:"horizontal"},options:{type:dt(Array),default:()=>[]},modelValue:{type:[String,Number,Boolean],default:void 0},block:Boolean,size:zi,disabled:Boolean,validateEvent:{type:Boolean,default:!0},id:String,name:String,..._s(["ariaLabel"])}),bme={[mr]:e=>Dn(e)||Gn(e)||Ro(e),[Eo]:e=>Dn(e)||Gn(e)||Ro(e)},xme=qe({name:"ElSegmented"}),wme=qe({...xme,props:yme,emits:bme,setup(e,{emit:t}){const i=e,a=en("segmented"),d=vs(),p=Li(),_=ks(),{formItem:r}=As(),{inputId:S,isLabeledByFormItem:C}=Al(i,{formItemContext:r}),M=Se(null),k=t9(),z=lo({isInit:!1,width:0,height:0,translateX:0,translateY:0,focusVisible:!1}),F=ce=>{const le=B(ce);t(mr,le),t(Eo,le)},B=ce=>yr(ce)?ce.value:ce,N=ce=>yr(ce)?ce.label:ce,j=ce=>!!(_.value||yr(ce)&&ce.disabled),U=ce=>i.modelValue===B(ce),te=ce=>i.options.find(le=>B(le)===ce),Y=ce=>[a.e("item"),a.is("selected",U(ce)),a.is("disabled",j(ce))],q=()=>{if(!M.value)return;const ce=M.value.querySelector(".is-selected"),le=M.value.querySelector(".is-selected input");if(!ce||!le){z.width=0,z.height=0,z.translateX=0,z.translateY=0,z.focusVisible=!1;return}const ge=ce.getBoundingClientRect();z.isInit=!0,i.direction==="vertical"?(z.height=ge.height,z.translateY=ce.offsetTop):(z.width=ge.width,z.translateX=ce.offsetLeft);try{z.focusVisible=le.matches(":focus-visible")}catch{}},J=ee(()=>[a.b(),a.m(p.value),a.is("block",i.block)]),ne=ee(()=>({width:i.direction==="vertical"?"100%":`${z.width}px`,height:i.direction==="vertical"?`${z.height}px`:"100%",transform:i.direction==="vertical"?`translateY(${z.translateY}px)`:`translateX(${z.translateX}px)`,display:z.isInit?"block":"none"})),se=ee(()=>[a.e("item-selected"),a.is("disabled",j(te(i.modelValue))),a.is("focus-visible",z.focusVisible)]),fe=ee(()=>i.name||d.value);return ti(M,q),qt(k,q),qt(()=>i.modelValue,()=>{var ce;q(),i.validateEvent&&((ce=r==null?void 0:r.validate)==null||ce.call(r,"change").catch(le=>void 0))},{flush:"post"}),(ce,le)=>ce.options.length?(ae(),Oe("div",{key:0,id:b(S),ref_key:"segmentedRef",ref:M,class:pe(b(J)),role:"radiogroup","aria-label":b(C)?void 0:ce.ariaLabel||"segmented","aria-labelledby":b(C)?b(r).labelId:void 0},[Ue("div",{class:pe([b(a).e("group"),b(a).m(i.direction)])},[Ue("div",{style:$n(b(ne)),class:pe(b(se))},null,6),(ae(!0),Oe(Bn,null,Or(ce.options,(ge,de)=>(ae(),Oe("label",{key:de,class:pe(Y(ge))},[Ue("input",{class:pe(b(a).e("item-input")),type:"radio",name:b(fe),disabled:j(ge),checked:U(ge),onChange:ke=>F(ge)},null,42,["name","disabled","checked","onChange"]),Ue("div",{class:pe(b(a).e("item-label"))},[pt(ce.$slots,"default",{item:ge},()=>[Rr(pn(N(ge)),1)])],2)],2))),128))],2)],10,["id","aria-label","aria-labelledby"])):yt("v-if",!0)}});var Sme=fn(wme,[["__file","segmented.vue"]]);const Tme=ur(Sme),Cme=(e,t)=>{const i=e.toLowerCase();return(t.label||t.value).toLowerCase().includes(i)},Eme=(e,t,i)=>{const{selectionEnd:a}=e;if(a===null)return;const d=e.value,p=Vs(t);let _=-1,r;for(let S=a-1;S>=0;--S){const C=d[S];if(C===i||C===`
`||C==="\r"){_=S;continue}if(p.includes(C)){const M=_===-1?a:_;r={pattern:d.slice(S+1,M),start:S+1,end:M,prefix:C,prefixIndex:S,splitIndex:_,selectionEnd:a};break}}return r},Mme=(e,t={debug:!1,useSelectionEnd:!1})=>{const i=e.selectionStart!==null?e.selectionStart:0,a=e.selectionEnd!==null?e.selectionEnd:0,d=t.useSelectionEnd?a:i,p=["direction","boxSizing","width","height","overflowX","overflowY","borderTopWidth","borderRightWidth","borderBottomWidth","borderLeftWidth","borderStyle","paddingTop","paddingRight","paddingBottom","paddingLeft","fontStyle","fontVariant","fontWeight","fontStretch","fontSize","fontSizeAdjust","lineHeight","fontFamily","textAlign","textTransform","textIndent","textDecoration","letterSpacing","wordSpacing","tabSize","MozTabSize"];if(t.debug){const z=document.querySelector("#input-textarea-caret-position-mirror-div");z!=null&&z.parentNode&&z.parentNode.removeChild(z)}const _=document.createElement("div");_.id="input-textarea-caret-position-mirror-div",document.body.appendChild(_);const r=_.style,S=window.getComputedStyle(e),C=e.nodeName==="INPUT";r.whiteSpace=C?"nowrap":"pre-wrap",C||(r.wordWrap="break-word"),r.position="absolute",t.debug||(r.visibility="hidden"),p.forEach(z=>{if(C&&z==="lineHeight")if(S.boxSizing==="border-box"){const F=Number.parseInt(S.height),B=Number.parseInt(S.paddingTop)+Number.parseInt(S.paddingBottom)+Number.parseInt(S.borderTopWidth)+Number.parseInt(S.borderBottomWidth),N=B+Number.parseInt(S.lineHeight);F>N?r.lineHeight=`${F-B}px`:F===N?r.lineHeight=S.lineHeight:r.lineHeight="0"}else r.lineHeight=S.height;else r[z]=S[z]}),gx()?e.scrollHeight>Number.parseInt(S.height)&&(r.overflowY="scroll"):r.overflow="hidden",_.textContent=e.value.slice(0,Math.max(0,d)),C&&_.textContent&&(_.textContent=_.textContent.replace(/\s/g,""));const M=document.createElement("span");M.textContent=e.value.slice(Math.max(0,d))||".",M.style.position="relative",M.style.left=`${-e.scrollLeft}px`,M.style.top=`${-e.scrollTop}px`,_.appendChild(M);const k={top:M.offsetTop+Number.parseInt(S.borderTopWidth),left:M.offsetLeft+Number.parseInt(S.borderLeftWidth),height:Number.parseInt(S.fontSize)*1.5};return t.debug?M.style.backgroundColor="#aaa":document.body.removeChild(_),k.left>=e.clientWidth&&(k.left=e.clientWidth),k},Ime=un({...oE,options:{type:dt(Array),default:()=>[]},prefix:{type:dt([String,Array]),default:"@",validator:e=>Dn(e)?e.length===1:e.every(t=>Dn(t)&&t.length===1)},split:{type:String,default:" ",validator:e=>e.length===1},filterOption:{type:dt([Boolean,Function]),default:()=>Cme,validator:e=>e===!1?!0:Nn(e)},placement:{type:dt(String),default:"bottom"},showArrow:Boolean,offset:{type:Number,default:0},whole:Boolean,checkIsWhole:{type:dt(Function)},modelValue:String,loading:Boolean,popperClass:{type:String,default:""},popperOptions:{type:dt(Object),default:()=>({})}}),Ame={[mr]:e=>Dn(e),search:(e,t)=>Dn(e)&&Dn(t),select:(e,t)=>Dn(e.value)&&Dn(t),focus:e=>e instanceof FocusEvent,blur:e=>e instanceof FocusEvent},kme=un({options:{type:dt(Array),default:()=>[]},loading:Boolean,disabled:Boolean,contentId:String,ariaLabel:String}),Pme={select:e=>Dn(e.value)},Rme=qe({name:"ElMentionDropdown"}),Ome=qe({...Rme,props:kme,emits:Pme,setup(e,{expose:t,emit:i}){const a=e,d=en("mention"),{t:p}=Gr(),_=Se(-1),r=Se(),S=Se(),C=Se(),M=(Y,q)=>[d.be("dropdown","item"),d.is("hovering",_.value===q),d.is("disabled",Y.disabled||a.disabled)],k=Y=>{Y.disabled||a.disabled||i("select",Y)},z=Y=>{_.value=Y},F=ee(()=>a.disabled||a.options.every(Y=>Y.disabled)),B=ee(()=>a.options[_.value]),N=()=>{B.value&&i("select",B.value)},j=Y=>{const{options:q}=a;if(q.length===0||F.value)return;Y==="next"?(_.value++,_.value===q.length&&(_.value=0)):Y==="prev"&&(_.value--,_.value<0&&(_.value=q.length-1));const J=q[_.value];if(J.disabled){j(Y);return}Vn(()=>U(J))},U=Y=>{var q,J,ne,se;const{options:fe}=a,ce=fe.findIndex(ge=>ge.value===Y.value),le=(q=S.value)==null?void 0:q[ce];if(le){const ge=(ne=(J=C.value)==null?void 0:J.querySelector)==null?void 0:ne.call(J,`.${d.be("dropdown","wrap")}`);ge&&XC(ge,le)}(se=r.value)==null||se.handleScroll()};return qt(()=>a.options,()=>{F.value||a.options.length===0?_.value=-1:_.value=0},{immediate:!0}),t({hoveringIndex:_,navigateOptions:j,selectHoverOption:N,hoverOption:B}),(Y,q)=>(ae(),Oe("div",{ref_key:"dropdownRef",ref:C,class:pe(b(d).b("dropdown"))},[Y.$slots.header?(ae(),Oe("div",{key:0,class:pe(b(d).be("dropdown","header"))},[pt(Y.$slots,"header")],2)):yt("v-if",!0),hr(Ze(b(Yc),{id:Y.contentId,ref_key:"scrollbarRef",ref:r,tag:"ul","wrap-class":b(d).be("dropdown","wrap"),"view-class":b(d).be("dropdown","list"),role:"listbox","aria-label":Y.ariaLabel,"aria-orientation":"vertical"},{default:st(()=>[(ae(!0),Oe(Bn,null,Or(Y.options,(J,ne)=>(ae(),Oe("li",{id:`${Y.contentId}-${ne}`,ref_for:!0,ref_key:"optionRefs",ref:S,key:ne,class:pe(M(J,ne)),role:"option","aria-disabled":J.disabled||Y.disabled||void 0,"aria-selected":_.value===ne,onMousemove:se=>z(ne),onClick:Qn(se=>k(J),["stop"])},[pt(Y.$slots,"label",{item:J,index:ne},()=>{var se;return[Ue("span",null,pn((se=J.label)!=null?se:J.value),1)]})],42,["id","aria-disabled","aria-selected","onMousemove","onClick"]))),128))]),_:3},8,["id","wrap-class","view-class","aria-label"]),[[no,Y.options.length>0&&!Y.loading]]),Y.loading?(ae(),Oe("div",{key:1,class:pe(b(d).be("dropdown","loading"))},[pt(Y.$slots,"loading",{},()=>[Rr(pn(b(p)("el.mention.loading")),1)])],2)):yt("v-if",!0),Y.$slots.footer?(ae(),Oe("div",{key:2,class:pe(b(d).be("dropdown","footer"))},[pt(Y.$slots,"footer")],2)):yt("v-if",!0)],2))}});var Lme=fn(Ome,[["__file","mention-dropdown.vue"]]);const Dme=qe({name:"ElMention",inheritAttrs:!1}),zme=qe({...Dme,props:Ime,emits:Ame,setup(e,{expose:t,emit:i}){const a=e,d=ee(()=>Jl(a,Object.keys(oE))),p=en("mention"),_=ks(),r=vs(),S=Se(),C=Se(),M=Se(),k=Se(!1),z=Se(),F=Se(),B=ee(()=>a.showArrow?a.placement:`${a.placement}-start`),N=ee(()=>a.showArrow?["bottom","top"]:["bottom-start","top-start"]),j=ee(()=>{const{filterOption:de,options:ke}=a;return!F.value||!de?ke:ke.filter(We=>de(F.value.pattern,We))}),U=ee(()=>k.value&&(!!j.value.length||a.loading)),te=ee(()=>{var de;return`${r.value}-${(de=M.value)==null?void 0:de.hoveringIndex}`}),Y=de=>{i("update:modelValue",de),ce()},q=de=>{var ke,We,we,be;if(!(!("code"in de)||(ke=S.value)!=null&&ke.isComposing))switch(de.code){case En.left:case En.right:ce();break;case En.up:case En.down:if(!k.value)return;de.preventDefault(),(We=M.value)==null||We.navigateOptions(de.code===En.up?"prev":"next");break;case En.enter:case En.numpadEnter:if(!k.value)return;de.preventDefault(),(we=M.value)!=null&&we.hoverOption?(be=M.value)==null||be.selectHoverOption():k.value=!1;break;case En.esc:if(!k.value)return;de.preventDefault(),k.value=!1;break;case En.backspace:if(a.whole&&F.value){const{splitIndex:Me,selectionEnd:Ae,pattern:me,prefixIndex:Be,prefix:Ve}=F.value,bt=fe();if(!bt)return;const Pe=bt.value,wt=a.options.find(Nt=>Nt.value===me);if((Nn(a.checkIsWhole)?a.checkIsWhole(me,Ve):wt)&&Me!==-1&&Me+1===Ae){de.preventDefault();const Nt=Pe.slice(0,Be)+Pe.slice(Me+1);i(mr,Nt);const vt=Be;Vn(()=>{bt.selectionStart=vt,bt.selectionEnd=vt,ge()})}}}},{wrapperRef:J}=rh(S,{beforeFocus(){return _.value},afterFocus(){ce()},beforeBlur(de){var ke;return(ke=C.value)==null?void 0:ke.isFocusInsideContent(de)},afterBlur(){k.value=!1}}),ne=()=>{ce()},se=de=>{if(!F.value)return;const ke=fe();if(!ke)return;const We=ke.value,{split:we}=a,be=We.slice(F.value.end),Me=be.startsWith(we),Ae=`${de.value}${Me?"":we}`,me=We.slice(0,F.value.start)+Ae+be;i(mr,me),i("select",de,F.value.prefix);const Be=F.value.start+Ae.length+(Me?1:0);Vn(()=>{ke.selectionStart=Be,ke.selectionEnd=Be,ke.focus(),ge()})},fe=()=>{var de,ke;return a.type==="textarea"?(de=S.value)==null?void 0:de.textarea:(ke=S.value)==null?void 0:ke.input},ce=()=>{setTimeout(()=>{le(),ge(),Vn(()=>{var de;return(de=C.value)==null?void 0:de.updatePopper()})},0)},le=()=>{const de=fe();if(!de)return;const ke=Mme(de),We=de.getBoundingClientRect(),we=S.value.$el.getBoundingClientRect();z.value={position:"absolute",width:0,height:`${ke.height}px`,left:`${ke.left+We.left-we.left}px`,top:`${ke.top+We.top-we.top}px`}},ge=()=>{const de=fe();if(document.activeElement!==de){k.value=!1;return}const{prefix:ke,split:We}=a;if(F.value=Eme(de,ke,We),F.value&&F.value.splitIndex===-1){k.value=!0,i("search",F.value.pattern,F.value.prefix);return}k.value=!1};return t({input:S,tooltip:C,dropdownVisible:U}),(de,ke)=>(ae(),Oe("div",{ref_key:"wrapperRef",ref:J,class:pe([b(p).b(),b(p).is("disabled",b(_))])},[Ze(b(Us),Mr(Mr(b(d),de.$attrs),{ref_key:"elInputRef",ref:S,"model-value":de.modelValue,disabled:b(_),role:b(U)?"combobox":void 0,"aria-activedescendant":b(U)?b(te)||"":void 0,"aria-controls":b(U)?b(r):void 0,"aria-expanded":b(U)||void 0,"aria-label":de.ariaLabel,"aria-autocomplete":b(U)?"none":void 0,"aria-haspopup":b(U)?"listbox":void 0,onInput:Y,onKeydown:q,onMousedown:ne}),Ya({_:2},[Or(de.$slots,(We,we)=>({name:we,fn:st(be=>[pt(de.$slots,we,Ha(Uc(be)))])}))]),1040,["model-value","disabled","role","aria-activedescendant","aria-controls","aria-expanded","aria-label","aria-autocomplete","aria-haspopup"]),Ze(b(Is),{ref_key:"tooltipRef",ref:C,visible:b(U),"popper-class":[b(p).e("popper"),de.popperClass],"popper-options":de.popperOptions,placement:b(B),"fallback-placements":b(N),effect:"light",pure:"",offset:de.offset,"show-arrow":de.showArrow},{default:st(()=>[Ue("div",{style:$n(z.value)},null,4)]),content:st(()=>{var We;return[Ze(Lme,{ref_key:"dropdownRef",ref:M,options:b(j),disabled:b(_),loading:de.loading,"content-id":b(r),"aria-label":de.ariaLabel,onSelect:se,onClick:Qn((We=S.value)==null?void 0:We.focus,["stop"])},Ya({_:2},[Or(de.$slots,(we,be)=>({name:be,fn:st(Me=>[pt(de.$slots,be,Ha(Uc(Me)))])}))]),1032,["options","disabled","loading","content-id","aria-label","onClick"])]}),_:3},8,["visible","popper-class","popper-options","placement","fallback-placements","offset","show-arrow"])],2))}});var Fme=fn(zme,[["__file","mention.vue"]]);const Nme=ur(Fme);var Bme=[F9,rK,XY,bde,rX,uX,sF,wX,SX,ss,fF,fJ,_J,DJ,zJ,zQ,DF,UQ,Il,YJ,EF,qQ,cee,uee,bx,zee,Bee,Xee,Jee,Qee,ete,tte,hne,wne,Sne,Dne,p4,Gne,Lre,Dre,zre,S4,Doe,zoe,On,qoe,E4,Us,M4,lie,pie,Oie,Lie,Die,zie,Uie,Rse,Nse,qse,nF,z4,OF,cQ,lQ,rae,lae,mae,Yc,Df,M1,hse,qae,nle,rle,wle,Mle,Z4,Nle,qle,Kle,ece,uue,due,yde,Dde,zde,Dm,$de,Rte,qde,Jde,Qde,Is,afe,bfe,B1,Bfe,npe,Cpe,Dpe,sme,ame,vme,_me,Tme,Nme];const _l="ElInfiniteScroll",Vme=50,$me=200,Ume=0,jme={delay:{type:Number,default:$me},distance:{type:Number,default:Ume},disabled:{type:Boolean,default:!1},immediate:{type:Boolean,default:!0}},gM=(e,t)=>Object.entries(jme).reduce((i,[a,d])=>{var p,_;const{type:r,default:S}=d,C=e.getAttribute(`infinite-scroll-${a}`);let M=(_=(p=t[C])!=null?p:C)!=null?_:S;return M=M==="false"?!1:M,M=r(M),i[a]=Number.isNaN(M)?S:M,i},{}),_B=e=>{const{observer:t}=e[_l];t&&(t.disconnect(),delete e[_l].observer)},Hme=(e,t)=>{const{container:i,containerEl:a,instance:d,observer:p,lastScrollTop:_}=e[_l],{disabled:r,distance:S}=gM(e,d),{clientHeight:C,scrollHeight:M,scrollTop:k}=a,z=k-_;if(e[_l].lastScrollTop=k,p||r||z<0)return;let F=!1;if(i===e)F=M-(C+k)<=S;else{const{clientTop:B,scrollHeight:N}=e,j=lT(e,a);F=k+C>=j+B+N-S}F&&t.call(d)};function TS(e,t){const{containerEl:i,instance:a}=e[_l],{disabled:d}=gM(e,a);d||i.clientHeight===0||(i.scrollHeight<=i.clientHeight?t.call(a):_B(e))}const Gme={async mounted(e,t){const{instance:i,value:a}=t;Nn(a)||ji(_l,"'v-infinite-scroll' binding value must be a function"),await Vn();const{delay:d,immediate:p}=gM(e,i),_=YC(e,!0),r=_===window?document.documentElement:_,S=Ef(Hme.bind(null,e,a),d);if(_){if(e[_l]={instance:i,container:_,containerEl:r,delay:d,cb:a,onScroll:S,lastScrollTop:r.scrollTop},p){const C=new MutationObserver(Ef(TS.bind(null,e,a),Vme));e[_l].observer=C,C.observe(e,{childList:!0,subtree:!0}),TS(e,a)}_.addEventListener("scroll",S)}},unmounted(e){if(!e[_l])return;const{container:t,onScroll:i}=e[_l];t==null||t.removeEventListener("scroll",i),_B(e)},async updated(e){if(!e[_l])await Vn();else{const{containerEl:t,cb:i,observer:a}=e[_l];t.clientHeight&&a&&TS(e,i)}}},JT=Gme;JT.install=e=>{e.directive("InfiniteScroll",JT)};const Wme=JT;function qme(e){let t;const i=Se(!1),a=lo({...e,originalPosition:"",originalOverflow:"",visible:!1});function d(z){a.text=z}function p(){const z=a.parent,F=k.ns;if(!z.vLoadingAddClassList){let B=z.getAttribute("loading-number");B=Number.parseInt(B)-1,B?z.setAttribute("loading-number",B.toString()):(js(z,F.bm("parent","relative")),z.removeAttribute("loading-number")),js(z,F.bm("parent","hidden"))}_(),M.unmount()}function _(){var z,F;(F=(z=k.$el)==null?void 0:z.parentNode)==null||F.removeChild(k.$el)}function r(){var z;e.beforeClose&&!e.beforeClose()||(i.value=!0,clearTimeout(t),t=setTimeout(S,400),a.visible=!1,(z=e.closed)==null||z.call(e))}function S(){if(!i.value)return;const z=a.parent;i.value=!1,z.vLoadingAddClassList=void 0,p()}const M=pD(qe({name:"ElLoading",setup(z,{expose:F}){const{ns:B,zIndex:N}=fx("loading");return F({ns:B,zIndex:N}),()=>{const j=a.spinner||a.svg,U=Kn("svg",{class:"circular",viewBox:a.svgViewBox?a.svgViewBox:"0 0 50 50",...j?{innerHTML:j}:{}},[Kn("circle",{class:"path",cx:"25",cy:"25",r:"20",fill:"none"})]),te=a.text?Kn("p",{class:B.b("text")},[a.text]):void 0;return Kn(ls,{name:B.b("fade"),onAfterLeave:S},{default:st(()=>[hr(Ze("div",{style:{backgroundColor:a.background||""},class:[B.b("mask"),a.customClass,a.fullscreen?"is-fullscreen":""]},[Kn("div",{class:B.b("spinner")},[U,te])]),[[no,a.visible]])])})}}})),k=M.mount(document.createElement("div"));return{...Zi(a),setText:d,removeElLoadingChild:_,close:r,handleAfterLeave:S,vm:k,get $el(){return k.$el}}}let Fb;const QT=function(e={}){if(!Hr)return;const t=Kme(e);if(t.fullscreen&&Fb)return Fb;const i=qme({...t,closed:()=>{var d;(d=t.closed)==null||d.call(t),t.fullscreen&&(Fb=void 0)}});Zme(t,t.parent,i),xO(t,t.parent,i),t.parent.vLoadingAddClassList=()=>xO(t,t.parent,i);let a=t.parent.getAttribute("loading-number");return a?a=`${Number.parseInt(a)+1}`:a="1",t.parent.setAttribute("loading-number",a),t.parent.appendChild(i.$el),Vn(()=>i.visible.value=t.visible),t.fullscreen&&(Fb=i),i},Kme=e=>{var t,i,a,d;let p;return Dn(e.target)?p=(t=document.querySelector(e.target))!=null?t:document.body:p=e.target||document.body,{parent:p===document.body||e.body?document.body:p,background:e.background||"",svg:e.svg||"",svgViewBox:e.svgViewBox||"",spinner:e.spinner||!1,text:e.text||"",fullscreen:p===document.body&&((i=e.fullscreen)!=null?i:!0),lock:(a=e.lock)!=null?a:!1,customClass:e.customClass||"",visible:(d=e.visible)!=null?d:!0,beforeClose:e.beforeClose,closed:e.closed,target:p}},Zme=async(e,t,i)=>{const{nextZIndex:a}=i.vm.zIndex||i.vm._.exposed.zIndex,d={};if(e.fullscreen)i.originalPosition.value=Pu(document.body,"position"),i.originalOverflow.value=Pu(document.body,"overflow"),d.zIndex=a();else if(e.parent===document.body){i.originalPosition.value=Pu(document.body,"position"),await Vn();for(const p of["top","left"]){const _=p==="top"?"scrollTop":"scrollLeft";d[p]=`${e.target.getBoundingClientRect()[p]+document.body[_]+document.documentElement[_]-Number.parseInt(Pu(document.body,`margin-${p}`),10)}px`}for(const p of["height","width"])d[p]=`${e.target.getBoundingClientRect()[p]}px`}else i.originalPosition.value=Pu(t,"position");for(const[p,_]of Object.entries(d))i.$el.style[p]=_},xO=(e,t,i)=>{const a=i.vm.ns||i.vm._.exposed.ns;["absolute","fixed","sticky"].includes(i.originalPosition.value)?js(t,a.bm("parent","relative")):bl(t,a.bm("parent","relative")),e.fullscreen&&e.lock?bl(t,a.bm("parent","hidden")):js(t,a.bm("parent","hidden"))},s1=Symbol("ElLoading"),wO=(e,t)=>{var i,a,d,p;const _=t.instance,r=z=>yr(t.value)?t.value[z]:void 0,S=z=>{const F=Dn(z)&&(_==null?void 0:_[z])||z;return F&&Se(F)},C=z=>S(r(z)||e.getAttribute(`element-loading-${Vu(z)}`)),M=(i=r("fullscreen"))!=null?i:t.modifiers.fullscreen,k={text:C("text"),svg:C("svg"),svgViewBox:C("svgViewBox"),spinner:C("spinner"),background:C("background"),customClass:C("customClass"),fullscreen:M,target:(a=r("target"))!=null?a:M?void 0:e,body:(d=r("body"))!=null?d:t.modifiers.body,lock:(p=r("lock"))!=null?p:t.modifiers.lock};e[s1]={options:k,instance:QT(k)}},Yme=(e,t)=>{for(const i of Object.keys(t))To(t[i])&&(t[i].value=e[i])},SO={mounted(e,t){t.value&&wO(e,t)},updated(e,t){const i=e[s1];t.oldValue!==t.value&&(t.value&&!t.oldValue?wO(e,t):t.value&&t.oldValue?yr(t.value)&&Yme(t.value,i.options):i==null||i.instance.close())},unmounted(e){var t;(t=e[s1])==null||t.instance.close(),e[s1]=null}},Xme={install(e){e.directive("loading",SO),e.config.globalProperties.$loading=QT},directive:SO,service:QT},yB=["success","info","warning","error"],Fs=ni({customClass:"",center:!1,dangerouslyUseHTMLString:!1,duration:3e3,icon:void 0,id:"",message:"",onClose:void 0,showClose:!1,type:"info",plain:!1,offset:16,zIndex:0,grouping:!1,repeatNum:1,appendTo:Hr?document.body:void 0}),Jme=un({customClass:{type:String,default:Fs.customClass},center:{type:Boolean,default:Fs.center},dangerouslyUseHTMLString:{type:Boolean,default:Fs.dangerouslyUseHTMLString},duration:{type:Number,default:Fs.duration},icon:{type:Mo,default:Fs.icon},id:{type:String,default:Fs.id},message:{type:dt([String,Object,Function]),default:Fs.message},onClose:{type:dt(Function),default:Fs.onClose},showClose:{type:Boolean,default:Fs.showClose},type:{type:String,values:yB,default:Fs.type},plain:{type:Boolean,default:Fs.plain},offset:{type:Number,default:Fs.offset},zIndex:{type:Number,default:Fs.zIndex},grouping:{type:Boolean,default:Fs.grouping},repeatNum:{type:Number,default:Fs.repeatNum}}),Qme={destroy:()=>!0},Ql=cL([]),ege=e=>{const t=Ql.findIndex(d=>d.id===e),i=Ql[t];let a;return t>0&&(a=Ql[t-1]),{current:i,prev:a}},tge=e=>{const{prev:t}=ege(e);return t?t.vm.exposed.bottom.value:0},nge=(e,t)=>Ql.findIndex(a=>a.id===e)>0?16:t,rge=qe({name:"ElMessage"}),oge=qe({...rge,props:Jme,emits:Qme,setup(e,{expose:t}){const i=e,{Close:a}=rE,{ns:d,zIndex:p}=fx("message"),{currentZIndex:_,nextZIndex:r}=p,S=Se(),C=Se(!1),M=Se(0);let k;const z=ee(()=>i.type?i.type==="error"?"danger":i.type:"info"),F=ee(()=>{const se=i.type;return{[d.bm("icon",se)]:se&&Xd[se]}}),B=ee(()=>i.icon||Xd[i.type]||""),N=ee(()=>tge(i.id)),j=ee(()=>nge(i.id,i.offset)+N.value),U=ee(()=>M.value+j.value),te=ee(()=>({top:`${j.value}px`,zIndex:_.value}));function Y(){i.duration!==0&&({stop:k}=Of(()=>{J()},i.duration))}function q(){k==null||k()}function J(){C.value=!1}function ne({code:se}){se===En.esc&&J()}return gr(()=>{Y(),r(),C.value=!0}),qt(()=>i.repeatNum,()=>{q(),Y()}),So(document,"keydown",ne),ti(S,()=>{M.value=S.value.getBoundingClientRect().height}),t({visible:C,bottom:U,close:J}),(se,fe)=>(ae(),kt(ls,{name:b(d).b("fade"),onBeforeLeave:se.onClose,onAfterLeave:ce=>se.$emit("destroy"),persisted:""},{default:st(()=>[hr(Ue("div",{id:se.id,ref_key:"messageRef",ref:S,class:pe([b(d).b(),{[b(d).m(se.type)]:se.type},b(d).is("center",se.center),b(d).is("closable",se.showClose),b(d).is("plain",se.plain),se.customClass]),style:$n(b(te)),role:"alert",onMouseenter:q,onMouseleave:Y},[se.repeatNum>1?(ae(),kt(b(sF),{key:0,value:se.repeatNum,type:b(z),class:pe(b(d).e("badge"))},null,8,["value","type","class"])):yt("v-if",!0),b(B)?(ae(),kt(b(On),{key:1,class:pe([b(d).e("icon"),b(F)])},{default:st(()=>[(ae(),kt(Tr(b(B))))]),_:1},8,["class"])):yt("v-if",!0),pt(se.$slots,"default",{},()=>[se.dangerouslyUseHTMLString?(ae(),Oe(Bn,{key:1},[yt(" Caution here, message could've been compromised, never use user's input as message "),Ue("p",{class:pe(b(d).e("content")),innerHTML:se.message},null,10,["innerHTML"])],2112)):(ae(),Oe("p",{key:0,class:pe(b(d).e("content"))},pn(se.message),3))]),se.showClose?(ae(),kt(b(On),{key:2,class:pe(b(d).e("closeBtn")),onClick:Qn(J,["stop"])},{default:st(()=>[Ze(b(a))]),_:1},8,["class","onClick"])):yt("v-if",!0)],46,["id"]),[[no,C.value]])]),_:3},8,["name","onBeforeLeave","onAfterLeave"]))}});var ige=fn(oge,[["__file","message.vue"]]);let sge=1;const bB=e=>{const t=!e||Dn(e)||Ho(e)||Nn(e)?{message:e}:e,i={...Fs,...t};if(!i.appendTo)i.appendTo=document.body;else if(Dn(i.appendTo)){let a=document.querySelector(i.appendTo);la(a)||(a=document.body),i.appendTo=a}return Ro(Yl.grouping)&&!i.grouping&&(i.grouping=Yl.grouping),Gn(Yl.duration)&&i.duration===3e3&&(i.duration=Yl.duration),Gn(Yl.offset)&&i.offset===16&&(i.offset=Yl.offset),Ro(Yl.showClose)&&!i.showClose&&(i.showClose=Yl.showClose),i},age=e=>{const t=Ql.indexOf(e);if(t===-1)return;Ql.splice(t,1);const{handler:i}=e;i.close()},lge=({appendTo:e,...t},i)=>{const a=`message_${sge++}`,d=t.onClose,p=document.createElement("div"),_={...t,id:a,onClose:()=>{d==null||d(),age(M)},onDestroy:()=>{Gd(null,p)}},r=Ze(ige,_,Nn(_.message)||Ho(_.message)?{default:Nn(_.message)?_.message:()=>_.message}:null);r.appContext=i||Um._context,Gd(r,p),e.appendChild(p.firstElementChild);const S=r.component,M={id:a,vnode:r,vm:S,handler:{close:()=>{S.exposed.visible.value=!1}},props:r.component.props};return M},Um=(e={},t)=>{if(!Hr)return{close:()=>{}};const i=bB(e);if(i.grouping&&Ql.length){const d=Ql.find(({vnode:p})=>{var _;return((_=p.props)==null?void 0:_.message)===i.message});if(d)return d.props.repeatNum+=1,d.props.type=i.type,d.handler}if(Gn(Yl.max)&&Ql.length>=Yl.max)return{close:()=>{}};const a=lge(i,t);return Ql.push(a),a.handler};yB.forEach(e=>{Um[e]=(t={},i)=>{const a=bB(t);return Um({...a,type:e},i)}});function cge(e){for(const t of Ql)(!e||e===t.props.type)&&t.handler.close()}Um.closeAll=cge;Um._context=null;const uge=Ez(Um,"$message"),eC="_trap-focus-children",wf=[],TO=e=>{if(wf.length===0)return;const t=wf[wf.length-1][eC];if(t.length>0&&e.code===En.tab){if(t.length===1){e.preventDefault(),document.activeElement!==t[0]&&t[0].focus();return}const i=e.shiftKey,a=e.target===t[0],d=e.target===t[t.length-1];a&&i&&(e.preventDefault(),t[t.length-1].focus()),d&&!i&&(e.preventDefault(),t[0].focus())}},dge={beforeMount(e){e[eC]=F3(e),wf.push(e),wf.length<=1&&document.addEventListener("keydown",TO)},updated(e){Vn(()=>{e[eC]=F3(e)})},unmounted(){wf.shift(),wf.length===0&&document.removeEventListener("keydown",TO)}},hge=qe({name:"ElMessageBox",directives:{TrapFocus:dge},components:{ElButton:ss,ElFocusTrap:eg,ElInput:Us,ElOverlay:RE,ElIcon:On,...rE},inheritAttrs:!1,props:{buttonSize:{type:String,validator:X4},modal:{type:Boolean,default:!0},lockScroll:{type:Boolean,default:!0},showClose:{type:Boolean,default:!0},closeOnClickModal:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0},closeOnHashChange:{type:Boolean,default:!0},center:Boolean,draggable:Boolean,overflow:Boolean,roundButton:{default:!1,type:Boolean},container:{type:String,default:"body"},boxType:{type:String,default:""}},emits:["vanish","action"],setup(e,{emit:t}){const{locale:i,zIndex:a,ns:d,size:p}=fx("message-box",ee(()=>e.buttonSize)),{t:_}=i,{nextZIndex:r}=a,S=Se(!1),C=lo({autofocus:!0,beforeClose:null,callback:null,cancelButtonText:"",cancelButtonClass:"",confirmButtonText:"",confirmButtonClass:"",customClass:"",customStyle:{},dangerouslyUseHTMLString:!1,distinguishCancelAndClose:!1,icon:"",closeIcon:"",inputPattern:null,inputPlaceholder:"",inputType:"text",inputValue:"",inputValidator:void 0,inputErrorMessage:"",message:"",modalFade:!0,modalClass:"",showCancelButton:!1,showConfirmButton:!0,type:"",title:void 0,showInput:!1,action:"",confirmButtonLoading:!1,cancelButtonLoading:!1,confirmButtonLoadingIcon:tc(Hc),cancelButtonLoadingIcon:tc(Hc),confirmButtonDisabled:!1,editorErrorMessage:"",validateError:!1,zIndex:r()}),M=ee(()=>{const be=C.type;return{[d.bm("icon",be)]:be&&Xd[be]}}),k=vs(),z=vs(),F=ee(()=>{const be=C.type;return C.icon||be&&Xd[be]||""}),B=ee(()=>!!C.message),N=Se(),j=Se(),U=Se(),te=Se(),Y=Se(),q=ee(()=>C.confirmButtonClass);qt(()=>C.inputValue,async be=>{await Vn(),e.boxType==="prompt"&&be&&de()},{immediate:!0}),qt(()=>S.value,be=>{var Me,Ae;be&&(e.boxType!=="prompt"&&(C.autofocus?U.value=(Ae=(Me=Y.value)==null?void 0:Me.$el)!=null?Ae:N.value:U.value=N.value),C.zIndex=r()),e.boxType==="prompt"&&(be?Vn().then(()=>{var me;te.value&&te.value.$el&&(C.autofocus?U.value=(me=ke())!=null?me:N.value:U.value=N.value)}):(C.editorErrorMessage="",C.validateError=!1))});const J=ee(()=>e.draggable),ne=ee(()=>e.overflow);u4(N,j,J,ne),gr(async()=>{await Vn(),e.closeOnHashChange&&window.addEventListener("hashchange",se)}),Oo(()=>{e.closeOnHashChange&&window.removeEventListener("hashchange",se)});function se(){S.value&&(S.value=!1,Vn(()=>{C.action&&t("action",C.action)}))}const fe=()=>{e.closeOnClickModal&&ge(C.distinguishCancelAndClose?"close":"cancel")},ce=PE(fe),le=be=>{if(C.inputType!=="textarea")return be.preventDefault(),ge("confirm")},ge=be=>{var Me;e.boxType==="prompt"&&be==="confirm"&&!de()||(C.action=be,C.beforeClose?(Me=C.beforeClose)==null||Me.call(C,be,C,se):se())},de=()=>{if(e.boxType==="prompt"){const be=C.inputPattern;if(be&&!be.test(C.inputValue||""))return C.editorErrorMessage=C.inputErrorMessage||_("el.messagebox.error"),C.validateError=!0,!1;const Me=C.inputValidator;if(Nn(Me)){const Ae=Me(C.inputValue);if(Ae===!1)return C.editorErrorMessage=C.inputErrorMessage||_("el.messagebox.error"),C.validateError=!0,!1;if(Dn(Ae))return C.editorErrorMessage=Ae,C.validateError=!0,!1}}return C.editorErrorMessage="",C.validateError=!1,!0},ke=()=>{var be,Me;const Ae=(be=te.value)==null?void 0:be.$refs;return(Me=Ae==null?void 0:Ae.input)!=null?Me:Ae==null?void 0:Ae.textarea},We=()=>{ge("close")},we=()=>{e.closeOnPressEscape&&We()};return e.lockScroll&&OE(S),{...Zi(C),ns:d,overlayEvent:ce,visible:S,hasMessage:B,typeClass:M,contentId:k,inputId:z,btnSize:p,iconComponent:F,confirmButtonClasses:q,rootRef:N,focusStartRef:U,headerRef:j,inputRef:te,confirmRef:Y,doClose:se,handleClose:We,onCloseRequested:we,handleWrapperClick:fe,handleInputEnter:le,handleAction:ge,t:_}}});function fge(e,t,i,a,d,p){const _=Er("el-icon"),r=Er("el-input"),S=Er("el-button"),C=Er("el-focus-trap"),M=Er("el-overlay");return ae(),kt(ls,{name:"fade-in-linear",onAfterLeave:k=>e.$emit("vanish"),persisted:""},{default:st(()=>[hr(Ze(M,{"z-index":e.zIndex,"overlay-class":[e.ns.is("message-box"),e.modalClass],mask:e.modal},{default:st(()=>[Ue("div",{role:"dialog","aria-label":e.title,"aria-modal":"true","aria-describedby":e.showInput?void 0:e.contentId,class:pe(`${e.ns.namespace.value}-overlay-message-box`),onClick:e.overlayEvent.onClick,onMousedown:e.overlayEvent.onMousedown,onMouseup:e.overlayEvent.onMouseup},[Ze(C,{loop:"",trapped:e.visible,"focus-trap-el":e.rootRef,"focus-start-el":e.focusStartRef,onReleaseRequested:e.onCloseRequested},{default:st(()=>[Ue("div",{ref:"rootRef",class:pe([e.ns.b(),e.customClass,e.ns.is("draggable",e.draggable),{[e.ns.m("center")]:e.center}]),style:$n(e.customStyle),tabindex:"-1",onClick:Qn(()=>{},["stop"])},[e.title!==null&&e.title!==void 0?(ae(),Oe("div",{key:0,ref:"headerRef",class:pe([e.ns.e("header"),{"show-close":e.showClose}])},[Ue("div",{class:pe(e.ns.e("title"))},[e.iconComponent&&e.center?(ae(),kt(_,{key:0,class:pe([e.ns.e("status"),e.typeClass])},{default:st(()=>[(ae(),kt(Tr(e.iconComponent)))]),_:1},8,["class"])):yt("v-if",!0),Ue("span",null,pn(e.title),1)],2),e.showClose?(ae(),Oe("button",{key:0,type:"button",class:pe(e.ns.e("headerbtn")),"aria-label":e.t("el.messagebox.close"),onClick:k=>e.handleAction(e.distinguishCancelAndClose?"close":"cancel"),onKeydown:Po(Qn(k=>e.handleAction(e.distinguishCancelAndClose?"close":"cancel"),["prevent"]),["enter"])},[Ze(_,{class:pe(e.ns.e("close"))},{default:st(()=>[(ae(),kt(Tr(e.closeIcon||"close")))]),_:1},8,["class"])],42,["aria-label","onClick","onKeydown"])):yt("v-if",!0)],2)):yt("v-if",!0),Ue("div",{id:e.contentId,class:pe(e.ns.e("content"))},[Ue("div",{class:pe(e.ns.e("container"))},[e.iconComponent&&!e.center&&e.hasMessage?(ae(),kt(_,{key:0,class:pe([e.ns.e("status"),e.typeClass])},{default:st(()=>[(ae(),kt(Tr(e.iconComponent)))]),_:1},8,["class"])):yt("v-if",!0),e.hasMessage?(ae(),Oe("div",{key:1,class:pe(e.ns.e("message"))},[pt(e.$slots,"default",{},()=>[e.dangerouslyUseHTMLString?(ae(),kt(Tr(e.showInput?"label":"p"),{key:1,for:e.showInput?e.inputId:void 0,innerHTML:e.message},null,8,["for","innerHTML"])):(ae(),kt(Tr(e.showInput?"label":"p"),{key:0,for:e.showInput?e.inputId:void 0},{default:st(()=>[Rr(pn(e.dangerouslyUseHTMLString?"":e.message),1)]),_:1},8,["for"]))])],2)):yt("v-if",!0)],2),hr(Ue("div",{class:pe(e.ns.e("input"))},[Ze(r,{id:e.inputId,ref:"inputRef",modelValue:e.inputValue,"onUpdate:modelValue":k=>e.inputValue=k,type:e.inputType,placeholder:e.inputPlaceholder,"aria-invalid":e.validateError,class:pe({invalid:e.validateError}),onKeydown:Po(e.handleInputEnter,["enter"])},null,8,["id","modelValue","onUpdate:modelValue","type","placeholder","aria-invalid","class","onKeydown"]),Ue("div",{class:pe(e.ns.e("errormsg")),style:$n({visibility:e.editorErrorMessage?"visible":"hidden"})},pn(e.editorErrorMessage),7)],2),[[no,e.showInput]])],10,["id"]),Ue("div",{class:pe(e.ns.e("btns"))},[e.showCancelButton?(ae(),kt(S,{key:0,loading:e.cancelButtonLoading,"loading-icon":e.cancelButtonLoadingIcon,class:pe([e.cancelButtonClass]),round:e.roundButton,size:e.btnSize,onClick:k=>e.handleAction("cancel"),onKeydown:Po(Qn(k=>e.handleAction("cancel"),["prevent"]),["enter"])},{default:st(()=>[Rr(pn(e.cancelButtonText||e.t("el.messagebox.cancel")),1)]),_:1},8,["loading","loading-icon","class","round","size","onClick","onKeydown"])):yt("v-if",!0),hr(Ze(S,{ref:"confirmRef",type:"primary",loading:e.confirmButtonLoading,"loading-icon":e.confirmButtonLoadingIcon,class:pe([e.confirmButtonClasses]),round:e.roundButton,disabled:e.confirmButtonDisabled,size:e.btnSize,onClick:k=>e.handleAction("confirm"),onKeydown:Po(Qn(k=>e.handleAction("confirm"),["prevent"]),["enter"])},{default:st(()=>[Rr(pn(e.confirmButtonText||e.t("el.messagebox.confirm")),1)]),_:1},8,["loading","loading-icon","class","round","disabled","size","onClick","onKeydown"]),[[no,e.showConfirmButton]])],2)],14,["onClick"])]),_:3},8,["trapped","focus-trap-el","focus-start-el","onReleaseRequested"])],42,["aria-label","aria-describedby","onClick","onMousedown","onMouseup"])]),_:3},8,["z-index","overlay-class","mask"]),[[no,e.visible]])]),_:3},8,["onAfterLeave"])}var pge=fn(hge,[["render",fge],["__file","index.vue"]]);const ly=new Map,mge=e=>{let t=document.body;return e.appendTo&&(Dn(e.appendTo)&&(t=document.querySelector(e.appendTo)),la(e.appendTo)&&(t=e.appendTo),la(t)||(t=document.body)),t},gge=(e,t,i=null)=>{const a=Ze(pge,e,Nn(e.message)||Ho(e.message)?{default:Nn(e.message)?e.message:()=>e.message}:null);return a.appContext=i,Gd(a,t),mge(e).appendChild(t.firstElementChild),a.component},vge=()=>document.createElement("div"),_ge=(e,t)=>{const i=vge();e.onVanish=()=>{Gd(null,i),ly.delete(d)},e.onAction=p=>{const _=ly.get(d);let r;e.showInput?r={value:d.inputValue,action:p}:r=p,e.callback?e.callback(r,a.proxy):p==="cancel"||p==="close"?e.distinguishCancelAndClose&&p!=="cancel"?_.reject("close"):_.reject("cancel"):_.resolve(r)};const a=gge(e,i,t),d=a.proxy;for(const p in e)to(e,p)&&!to(d.$props,p)&&(p==="closeIcon"&&yr(e[p])?d[p]=tc(e[p]):d[p]=e[p]);return d.visible=!0,d};function ig(e,t=null){if(!Hr)return Promise.reject();let i;return Dn(e)||Ho(e)?e={message:e}:i=e.callback,new Promise((a,d)=>{const p=_ge(e,t??ig._context);ly.set(p,{options:e,callback:i,resolve:a,reject:d})})}const yge=["alert","confirm","prompt"],bge={alert:{closeOnPressEscape:!1,closeOnClickModal:!1},confirm:{showCancelButton:!0},prompt:{showCancelButton:!0,showInput:!0}};yge.forEach(e=>{ig[e]=xge(e)});function xge(e){return(t,i,a,d)=>{let p="";return yr(i)?(a=i,p=""):oo(i)?p="":p=i,ig(Object.assign({title:p,message:t,type:"",...bge[e]},a,{boxType:e}),d)}}ig.close=()=>{ly.forEach((e,t)=>{t.doClose()}),ly.clear()};ig._context=null;const Od=ig;Od.install=e=>{Od._context=e._context,e.config.globalProperties.$msgbox=Od,e.config.globalProperties.$messageBox=Od,e.config.globalProperties.$alert=Od.alert,e.config.globalProperties.$confirm=Od.confirm,e.config.globalProperties.$prompt=Od.prompt};const wge=Od,xB=["success","info","warning","error"],Sge=un({customClass:{type:String,default:""},dangerouslyUseHTMLString:Boolean,duration:{type:Number,default:4500},icon:{type:Mo},id:{type:String,default:""},message:{type:dt([String,Object,Function]),default:""},offset:{type:Number,default:0},onClick:{type:dt(Function),default:()=>{}},onClose:{type:dt(Function),required:!0},position:{type:String,values:["top-right","top-left","bottom-right","bottom-left"],default:"top-right"},showClose:{type:Boolean,default:!0},title:{type:String,default:""},type:{type:String,values:[...xB,""],default:""},zIndex:Number}),Tge={destroy:()=>!0},Cge=qe({name:"ElNotification"}),Ege=qe({...Cge,props:Sge,emits:Tge,setup(e,{expose:t}){const i=e,{ns:a,zIndex:d}=fx("notification"),{nextZIndex:p,currentZIndex:_}=d,{Close:r}=nE,S=Se(!1);let C;const M=ee(()=>{const Y=i.type;return Y&&Xd[i.type]?a.m(Y):""}),k=ee(()=>i.type&&Xd[i.type]||i.icon),z=ee(()=>i.position.endsWith("right")?"right":"left"),F=ee(()=>i.position.startsWith("top")?"top":"bottom"),B=ee(()=>{var Y;return{[F.value]:`${i.offset}px`,zIndex:(Y=i.zIndex)!=null?Y:_.value}});function N(){i.duration>0&&({stop:C}=Of(()=>{S.value&&U()},i.duration))}function j(){C==null||C()}function U(){S.value=!1}function te({code:Y}){Y===En.delete||Y===En.backspace?j():Y===En.esc?S.value&&U():N()}return gr(()=>{N(),p(),S.value=!0}),So(document,"keydown",te),t({visible:S,close:U}),(Y,q)=>(ae(),kt(ls,{name:b(a).b("fade"),onBeforeLeave:Y.onClose,onAfterLeave:J=>Y.$emit("destroy"),persisted:""},{default:st(()=>[hr(Ue("div",{id:Y.id,class:pe([b(a).b(),Y.customClass,b(z)]),style:$n(b(B)),role:"alert",onMouseenter:j,onMouseleave:N,onClick:Y.onClick},[b(k)?(ae(),kt(b(On),{key:0,class:pe([b(a).e("icon"),b(M)])},{default:st(()=>[(ae(),kt(Tr(b(k))))]),_:1},8,["class"])):yt("v-if",!0),Ue("div",{class:pe(b(a).e("group"))},[Ue("h2",{class:pe(b(a).e("title")),textContent:pn(Y.title)},null,10,["textContent"]),hr(Ue("div",{class:pe(b(a).e("content")),style:$n(Y.title?void 0:{margin:0})},[pt(Y.$slots,"default",{},()=>[Y.dangerouslyUseHTMLString?(ae(),Oe(Bn,{key:1},[yt(" Caution here, message could've been compromised, never use user's input as message "),Ue("p",{innerHTML:Y.message},null,8,["innerHTML"])],2112)):(ae(),Oe("p",{key:0},pn(Y.message),1))])],6),[[no,Y.message]]),Y.showClose?(ae(),kt(b(On),{key:0,class:pe(b(a).e("closeBtn")),onClick:Qn(U,["stop"])},{default:st(()=>[Ze(b(r))]),_:1},8,["class","onClick"])):yt("v-if",!0)],2)],46,["id","onClick"]),[[no,S.value]])]),_:3},8,["name","onBeforeLeave","onAfterLeave"]))}});var Mge=fn(Ege,[["__file","notification.vue"]]);const V1={"top-left":[],"top-right":[],"bottom-left":[],"bottom-right":[]},tC=16;let Ige=1;const jm=function(e={},t){if(!Hr)return{close:()=>{}};(Dn(e)||Ho(e))&&(e={message:e});const i=e.position||"top-right";let a=e.offset||0;V1[i].forEach(({vm:M})=>{var k;a+=(((k=M.el)==null?void 0:k.offsetHeight)||0)+tC}),a+=tC;const d=`notification_${Ige++}`,p=e.onClose,_={...e,offset:a,id:d,onClose:()=>{Age(d,i,p)}};let r=document.body;la(e.appendTo)?r=e.appendTo:Dn(e.appendTo)&&(r=document.querySelector(e.appendTo)),la(r)||(r=document.body);const S=document.createElement("div"),C=Ze(Mge,_,Nn(_.message)?_.message:Ho(_.message)?()=>_.message:null);return C.appContext=oo(t)?jm._context:t,C.props.onDestroy=()=>{Gd(null,S)},Gd(C,S),V1[i].push({vm:C}),r.appendChild(S.firstElementChild),{close:()=>{C.component.exposed.visible.value=!1}}};xB.forEach(e=>{jm[e]=(t={},i)=>((Dn(t)||Ho(t))&&(t={message:t}),jm({...t,type:e},i))});function Age(e,t,i){const a=V1[t],d=a.findIndex(({vm:C})=>{var M;return((M=C.component)==null?void 0:M.props.id)===e});if(d===-1)return;const{vm:p}=a[d];if(!p)return;i==null||i(p);const _=p.el.offsetHeight,r=t.split("-")[0];a.splice(d,1);const S=a.length;if(!(S<1))for(let C=d;C<S;C++){const{el:M,component:k}=a[C].vm,z=Number.parseInt(M.style[r],10)-_-tC;k.props.offset=z}}function kge(){for(const e of Object.values(V1))e.forEach(({vm:t})=>{t.component.exposed.visible.value=!1})}jm.closeAll=kge;jm._context=null;const Pge=Ez(jm,"$notify");var Rge=[Wme,Xme,uge,wge,Pge,D4],Oge=M9([...Bme,...Rge]),Rx={};/*!
 * vite-plugin-qiankun.js v1.0.14
 * (c) 2021-2022 Teng Mao Qing
 * Released under the MIT License.
 */Object.defineProperty(Rx,"__esModule",{value:!0});var um=typeof window<"u"?window.proxy||window:{},wB=function(e){um!=null&&um.__POWERED_BY_QIANKUN__&&(window.moudleQiankunAppLifeCycles||(window.moudleQiankunAppLifeCycles={}),um.qiankunName&&(window.moudleQiankunAppLifeCycles[um.qiankunName]=e))};Rx.default=wB;var Lge=Rx.qiankunWindow=um,Dge=Rx.renderWithQiankun=wB,SB={exports:{}};(function(e,t){(function(i,a){e.exports=a()})(Xc,function(){var i,a,d;function p(r,S){if(!i)i=S;else if(!a)a=S;else{var C="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+i+")(sharedChunk); ("+a+")(sharedChunk); self.onerror = null;",M={};i(M),d=S(M),typeof window<"u"&&window&&window.URL&&window.URL.createObjectURL&&(d.workerUrl=window.URL.createObjectURL(new Blob([C],{type:"text/javascript"})))}}p(["exports"],function(r){function S(c){return c&&c.__esModule&&Object.prototype.hasOwnProperty.call(c,"default")?c.default:c}var C,M={},k={};function z(){if(C)return k;C=1,Object.defineProperty(k,"__esModule",{value:!0}),k.setMatrixArrayType=function(g){k.ARRAY_TYPE=n=g},k.toRadian=function(g){return g*u},k.equals=function(g,h){return Math.abs(g-h)<=c*Math.max(1,Math.abs(g),Math.abs(h))},k.RANDOM=k.ARRAY_TYPE=k.EPSILON=void 0;var c=1e-6;k.EPSILON=c;var n=typeof Float32Array<"u"?Float32Array:Array;k.ARRAY_TYPE=n;var s=Math.random;k.RANDOM=s;var u=Math.PI/180;return Math.hypot||(Math.hypot=function(){for(var g=0,h=arguments.length;h--;)g+=arguments[h]*arguments[h];return Math.sqrt(g)}),k}var F,B={};function N(){if(F)return B;function c(h){return c=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(v){return typeof v}:function(v){return v&&typeof Symbol=="function"&&v.constructor===Symbol&&v!==Symbol.prototype?"symbol":typeof v},c(h)}F=1,Object.defineProperty(B,"__esModule",{value:!0}),B.create=function(){var h=new n.ARRAY_TYPE(4);return n.ARRAY_TYPE!=Float32Array&&(h[1]=0,h[2]=0),h[0]=1,h[3]=1,h},B.clone=function(h){var v=new n.ARRAY_TYPE(4);return v[0]=h[0],v[1]=h[1],v[2]=h[2],v[3]=h[3],v},B.copy=function(h,v){return h[0]=v[0],h[1]=v[1],h[2]=v[2],h[3]=v[3],h},B.identity=function(h){return h[0]=1,h[1]=0,h[2]=0,h[3]=1,h},B.fromValues=function(h,v,T,A){var D=new n.ARRAY_TYPE(4);return D[0]=h,D[1]=v,D[2]=T,D[3]=A,D},B.set=function(h,v,T,A,D){return h[0]=v,h[1]=T,h[2]=A,h[3]=D,h},B.transpose=function(h,v){if(h===v){var T=v[1];h[1]=v[2],h[2]=T}else h[0]=v[0],h[1]=v[2],h[2]=v[1],h[3]=v[3];return h},B.invert=function(h,v){var T=v[0],A=v[1],D=v[2],x=v[3],P=T*x-D*A;return P?(h[0]=x*(P=1/P),h[1]=-A*P,h[2]=-D*P,h[3]=T*P,h):null},B.adjoint=function(h,v){var T=v[0];return h[0]=v[3],h[1]=-v[1],h[2]=-v[2],h[3]=T,h},B.determinant=function(h){return h[0]*h[3]-h[2]*h[1]},B.multiply=u,B.rotate=function(h,v,T){var A=v[0],D=v[1],x=v[2],P=v[3],L=Math.sin(T),I=Math.cos(T);return h[0]=A*I+x*L,h[1]=D*I+P*L,h[2]=A*-L+x*I,h[3]=D*-L+P*I,h},B.scale=function(h,v,T){var A=v[1],D=v[2],x=v[3],P=T[0],L=T[1];return h[0]=v[0]*P,h[1]=A*P,h[2]=D*L,h[3]=x*L,h},B.fromRotation=function(h,v){var T=Math.sin(v),A=Math.cos(v);return h[0]=A,h[1]=T,h[2]=-T,h[3]=A,h},B.fromScaling=function(h,v){return h[0]=v[0],h[1]=0,h[2]=0,h[3]=v[1],h},B.str=function(h){return"mat2("+h[0]+", "+h[1]+", "+h[2]+", "+h[3]+")"},B.frob=function(h){return Math.hypot(h[0],h[1],h[2],h[3])},B.LDU=function(h,v,T,A){return h[2]=A[2]/A[0],T[0]=A[0],T[1]=A[1],T[3]=A[3]-h[2]*T[1],[h,v,T]},B.add=function(h,v,T){return h[0]=v[0]+T[0],h[1]=v[1]+T[1],h[2]=v[2]+T[2],h[3]=v[3]+T[3],h},B.subtract=g,B.exactEquals=function(h,v){return h[0]===v[0]&&h[1]===v[1]&&h[2]===v[2]&&h[3]===v[3]},B.equals=function(h,v){var T=h[0],A=h[1],D=h[2],x=h[3],P=v[0],L=v[1],I=v[2],R=v[3];return Math.abs(T-P)<=n.EPSILON*Math.max(1,Math.abs(T),Math.abs(P))&&Math.abs(A-L)<=n.EPSILON*Math.max(1,Math.abs(A),Math.abs(L))&&Math.abs(D-I)<=n.EPSILON*Math.max(1,Math.abs(D),Math.abs(I))&&Math.abs(x-R)<=n.EPSILON*Math.max(1,Math.abs(x),Math.abs(R))},B.multiplyScalar=function(h,v,T){return h[0]=v[0]*T,h[1]=v[1]*T,h[2]=v[2]*T,h[3]=v[3]*T,h},B.multiplyScalarAndAdd=function(h,v,T,A){return h[0]=v[0]+T[0]*A,h[1]=v[1]+T[1]*A,h[2]=v[2]+T[2]*A,h[3]=v[3]+T[3]*A,h},B.sub=B.mul=void 0;var n=function(h,v){if(h&&h.__esModule)return h;if(h===null||c(h)!=="object"&&typeof h!="function")return{default:h};var T=s(void 0);if(T&&T.has(h))return T.get(h);var A={},D=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var x in h)if(x!=="default"&&Object.prototype.hasOwnProperty.call(h,x)){var P=D?Object.getOwnPropertyDescriptor(h,x):null;P&&(P.get||P.set)?Object.defineProperty(A,x,P):A[x]=h[x]}return A.default=h,T&&T.set(h,A),A}(z());function s(h){if(typeof WeakMap!="function")return null;var v=new WeakMap,T=new WeakMap;return(s=function(A){return A?T:v})(h)}function u(h,v,T){var A=v[0],D=v[1],x=v[2],P=v[3],L=T[0],I=T[1],R=T[2],V=T[3];return h[0]=A*L+x*I,h[1]=D*L+P*I,h[2]=A*R+x*V,h[3]=D*R+P*V,h}function g(h,v,T){return h[0]=v[0]-T[0],h[1]=v[1]-T[1],h[2]=v[2]-T[2],h[3]=v[3]-T[3],h}return B.mul=u,B.sub=g,B}var j,U={};function te(){if(j)return U;function c(h){return c=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(v){return typeof v}:function(v){return v&&typeof Symbol=="function"&&v.constructor===Symbol&&v!==Symbol.prototype?"symbol":typeof v},c(h)}j=1,Object.defineProperty(U,"__esModule",{value:!0}),U.create=function(){var h=new n.ARRAY_TYPE(6);return n.ARRAY_TYPE!=Float32Array&&(h[1]=0,h[2]=0,h[4]=0,h[5]=0),h[0]=1,h[3]=1,h},U.clone=function(h){var v=new n.ARRAY_TYPE(6);return v[0]=h[0],v[1]=h[1],v[2]=h[2],v[3]=h[3],v[4]=h[4],v[5]=h[5],v},U.copy=function(h,v){return h[0]=v[0],h[1]=v[1],h[2]=v[2],h[3]=v[3],h[4]=v[4],h[5]=v[5],h},U.identity=function(h){return h[0]=1,h[1]=0,h[2]=0,h[3]=1,h[4]=0,h[5]=0,h},U.fromValues=function(h,v,T,A,D,x){var P=new n.ARRAY_TYPE(6);return P[0]=h,P[1]=v,P[2]=T,P[3]=A,P[4]=D,P[5]=x,P},U.set=function(h,v,T,A,D,x,P){return h[0]=v,h[1]=T,h[2]=A,h[3]=D,h[4]=x,h[5]=P,h},U.invert=function(h,v){var T=v[0],A=v[1],D=v[2],x=v[3],P=v[4],L=v[5],I=T*x-A*D;return I?(h[0]=x*(I=1/I),h[1]=-A*I,h[2]=-D*I,h[3]=T*I,h[4]=(D*L-x*P)*I,h[5]=(A*P-T*L)*I,h):null},U.determinant=function(h){return h[0]*h[3]-h[1]*h[2]},U.multiply=u,U.rotate=function(h,v,T){var A=v[0],D=v[1],x=v[2],P=v[3],L=v[4],I=v[5],R=Math.sin(T),V=Math.cos(T);return h[0]=A*V+x*R,h[1]=D*V+P*R,h[2]=A*-R+x*V,h[3]=D*-R+P*V,h[4]=L,h[5]=I,h},U.scale=function(h,v,T){var A=v[1],D=v[2],x=v[3],P=v[4],L=v[5],I=T[0],R=T[1];return h[0]=v[0]*I,h[1]=A*I,h[2]=D*R,h[3]=x*R,h[4]=P,h[5]=L,h},U.translate=function(h,v,T){var A=v[0],D=v[1],x=v[2],P=v[3],L=v[4],I=v[5],R=T[0],V=T[1];return h[0]=A,h[1]=D,h[2]=x,h[3]=P,h[4]=A*R+x*V+L,h[5]=D*R+P*V+I,h},U.fromRotation=function(h,v){var T=Math.sin(v),A=Math.cos(v);return h[0]=A,h[1]=T,h[2]=-T,h[3]=A,h[4]=0,h[5]=0,h},U.fromScaling=function(h,v){return h[0]=v[0],h[1]=0,h[2]=0,h[3]=v[1],h[4]=0,h[5]=0,h},U.fromTranslation=function(h,v){return h[0]=1,h[1]=0,h[2]=0,h[3]=1,h[4]=v[0],h[5]=v[1],h},U.str=function(h){return"mat2d("+h[0]+", "+h[1]+", "+h[2]+", "+h[3]+", "+h[4]+", "+h[5]+")"},U.frob=function(h){return Math.hypot(h[0],h[1],h[2],h[3],h[4],h[5],1)},U.add=function(h,v,T){return h[0]=v[0]+T[0],h[1]=v[1]+T[1],h[2]=v[2]+T[2],h[3]=v[3]+T[3],h[4]=v[4]+T[4],h[5]=v[5]+T[5],h},U.subtract=g,U.multiplyScalar=function(h,v,T){return h[0]=v[0]*T,h[1]=v[1]*T,h[2]=v[2]*T,h[3]=v[3]*T,h[4]=v[4]*T,h[5]=v[5]*T,h},U.multiplyScalarAndAdd=function(h,v,T,A){return h[0]=v[0]+T[0]*A,h[1]=v[1]+T[1]*A,h[2]=v[2]+T[2]*A,h[3]=v[3]+T[3]*A,h[4]=v[4]+T[4]*A,h[5]=v[5]+T[5]*A,h},U.exactEquals=function(h,v){return h[0]===v[0]&&h[1]===v[1]&&h[2]===v[2]&&h[3]===v[3]&&h[4]===v[4]&&h[5]===v[5]},U.equals=function(h,v){var T=h[0],A=h[1],D=h[2],x=h[3],P=h[4],L=h[5],I=v[0],R=v[1],V=v[2],W=v[3],K=v[4],re=v[5];return Math.abs(T-I)<=n.EPSILON*Math.max(1,Math.abs(T),Math.abs(I))&&Math.abs(A-R)<=n.EPSILON*Math.max(1,Math.abs(A),Math.abs(R))&&Math.abs(D-V)<=n.EPSILON*Math.max(1,Math.abs(D),Math.abs(V))&&Math.abs(x-W)<=n.EPSILON*Math.max(1,Math.abs(x),Math.abs(W))&&Math.abs(P-K)<=n.EPSILON*Math.max(1,Math.abs(P),Math.abs(K))&&Math.abs(L-re)<=n.EPSILON*Math.max(1,Math.abs(L),Math.abs(re))},U.sub=U.mul=void 0;var n=function(h,v){if(h&&h.__esModule)return h;if(h===null||c(h)!=="object"&&typeof h!="function")return{default:h};var T=s(void 0);if(T&&T.has(h))return T.get(h);var A={},D=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var x in h)if(x!=="default"&&Object.prototype.hasOwnProperty.call(h,x)){var P=D?Object.getOwnPropertyDescriptor(h,x):null;P&&(P.get||P.set)?Object.defineProperty(A,x,P):A[x]=h[x]}return A.default=h,T&&T.set(h,A),A}(z());function s(h){if(typeof WeakMap!="function")return null;var v=new WeakMap,T=new WeakMap;return(s=function(A){return A?T:v})(h)}function u(h,v,T){var A=v[0],D=v[1],x=v[2],P=v[3],L=v[4],I=v[5],R=T[0],V=T[1],W=T[2],K=T[3],re=T[4],ie=T[5];return h[0]=A*R+x*V,h[1]=D*R+P*V,h[2]=A*W+x*K,h[3]=D*W+P*K,h[4]=A*re+x*ie+L,h[5]=D*re+P*ie+I,h}function g(h,v,T){return h[0]=v[0]-T[0],h[1]=v[1]-T[1],h[2]=v[2]-T[2],h[3]=v[3]-T[3],h[4]=v[4]-T[4],h[5]=v[5]-T[5],h}return U.mul=u,U.sub=g,U}var Y,q={};function J(){if(Y)return q;function c(h){return c=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(v){return typeof v}:function(v){return v&&typeof Symbol=="function"&&v.constructor===Symbol&&v!==Symbol.prototype?"symbol":typeof v},c(h)}Y=1,Object.defineProperty(q,"__esModule",{value:!0}),q.create=function(){var h=new n.ARRAY_TYPE(9);return n.ARRAY_TYPE!=Float32Array&&(h[1]=0,h[2]=0,h[3]=0,h[5]=0,h[6]=0,h[7]=0),h[0]=1,h[4]=1,h[8]=1,h},q.fromMat4=function(h,v){return h[0]=v[0],h[1]=v[1],h[2]=v[2],h[3]=v[4],h[4]=v[5],h[5]=v[6],h[6]=v[8],h[7]=v[9],h[8]=v[10],h},q.clone=function(h){var v=new n.ARRAY_TYPE(9);return v[0]=h[0],v[1]=h[1],v[2]=h[2],v[3]=h[3],v[4]=h[4],v[5]=h[5],v[6]=h[6],v[7]=h[7],v[8]=h[8],v},q.copy=function(h,v){return h[0]=v[0],h[1]=v[1],h[2]=v[2],h[3]=v[3],h[4]=v[4],h[5]=v[5],h[6]=v[6],h[7]=v[7],h[8]=v[8],h},q.fromValues=function(h,v,T,A,D,x,P,L,I){var R=new n.ARRAY_TYPE(9);return R[0]=h,R[1]=v,R[2]=T,R[3]=A,R[4]=D,R[5]=x,R[6]=P,R[7]=L,R[8]=I,R},q.set=function(h,v,T,A,D,x,P,L,I,R){return h[0]=v,h[1]=T,h[2]=A,h[3]=D,h[4]=x,h[5]=P,h[6]=L,h[7]=I,h[8]=R,h},q.identity=function(h){return h[0]=1,h[1]=0,h[2]=0,h[3]=0,h[4]=1,h[5]=0,h[6]=0,h[7]=0,h[8]=1,h},q.transpose=function(h,v){if(h===v){var T=v[1],A=v[2],D=v[5];h[1]=v[3],h[2]=v[6],h[3]=T,h[5]=v[7],h[6]=A,h[7]=D}else h[0]=v[0],h[1]=v[3],h[2]=v[6],h[3]=v[1],h[4]=v[4],h[5]=v[7],h[6]=v[2],h[7]=v[5],h[8]=v[8];return h},q.invert=function(h,v){var T=v[0],A=v[1],D=v[2],x=v[3],P=v[4],L=v[5],I=v[6],R=v[7],V=v[8],W=V*P-L*R,K=-V*x+L*I,re=R*x-P*I,ie=T*W+A*K+D*re;return ie?(h[0]=W*(ie=1/ie),h[1]=(-V*A+D*R)*ie,h[2]=(L*A-D*P)*ie,h[3]=K*ie,h[4]=(V*T-D*I)*ie,h[5]=(-L*T+D*x)*ie,h[6]=re*ie,h[7]=(-R*T+A*I)*ie,h[8]=(P*T-A*x)*ie,h):null},q.adjoint=function(h,v){var T=v[0],A=v[1],D=v[2],x=v[3],P=v[4],L=v[5],I=v[6],R=v[7],V=v[8];return h[0]=P*V-L*R,h[1]=D*R-A*V,h[2]=A*L-D*P,h[3]=L*I-x*V,h[4]=T*V-D*I,h[5]=D*x-T*L,h[6]=x*R-P*I,h[7]=A*I-T*R,h[8]=T*P-A*x,h},q.determinant=function(h){var v=h[3],T=h[4],A=h[5],D=h[6],x=h[7],P=h[8];return h[0]*(P*T-A*x)+h[1]*(-P*v+A*D)+h[2]*(x*v-T*D)},q.multiply=u,q.translate=function(h,v,T){var A=v[0],D=v[1],x=v[2],P=v[3],L=v[4],I=v[5],R=v[6],V=v[7],W=v[8],K=T[0],re=T[1];return h[0]=A,h[1]=D,h[2]=x,h[3]=P,h[4]=L,h[5]=I,h[6]=K*A+re*P+R,h[7]=K*D+re*L+V,h[8]=K*x+re*I+W,h},q.rotate=function(h,v,T){var A=v[0],D=v[1],x=v[2],P=v[3],L=v[4],I=v[5],R=v[6],V=v[7],W=v[8],K=Math.sin(T),re=Math.cos(T);return h[0]=re*A+K*P,h[1]=re*D+K*L,h[2]=re*x+K*I,h[3]=re*P-K*A,h[4]=re*L-K*D,h[5]=re*I-K*x,h[6]=R,h[7]=V,h[8]=W,h},q.scale=function(h,v,T){var A=T[0],D=T[1];return h[0]=A*v[0],h[1]=A*v[1],h[2]=A*v[2],h[3]=D*v[3],h[4]=D*v[4],h[5]=D*v[5],h[6]=v[6],h[7]=v[7],h[8]=v[8],h},q.fromTranslation=function(h,v){return h[0]=1,h[1]=0,h[2]=0,h[3]=0,h[4]=1,h[5]=0,h[6]=v[0],h[7]=v[1],h[8]=1,h},q.fromRotation=function(h,v){var T=Math.sin(v),A=Math.cos(v);return h[0]=A,h[1]=T,h[2]=0,h[3]=-T,h[4]=A,h[5]=0,h[6]=0,h[7]=0,h[8]=1,h},q.fromScaling=function(h,v){return h[0]=v[0],h[1]=0,h[2]=0,h[3]=0,h[4]=v[1],h[5]=0,h[6]=0,h[7]=0,h[8]=1,h},q.fromMat2d=function(h,v){return h[0]=v[0],h[1]=v[1],h[2]=0,h[3]=v[2],h[4]=v[3],h[5]=0,h[6]=v[4],h[7]=v[5],h[8]=1,h},q.fromQuat=function(h,v){var T=v[0],A=v[1],D=v[2],x=v[3],P=T+T,L=A+A,I=D+D,R=T*P,V=A*P,W=A*L,K=D*P,re=D*L,ie=D*I,Q=x*P,ue=x*L,_e=x*I;return h[0]=1-W-ie,h[3]=V-_e,h[6]=K+ue,h[1]=V+_e,h[4]=1-R-ie,h[7]=re-Q,h[2]=K-ue,h[5]=re+Q,h[8]=1-R-W,h},q.normalFromMat4=function(h,v){var T=v[0],A=v[1],D=v[2],x=v[3],P=v[4],L=v[5],I=v[6],R=v[7],V=v[8],W=v[9],K=v[10],re=v[11],ie=v[12],Q=v[13],ue=v[14],_e=v[15],Ee=T*L-A*P,Ne=T*I-D*P,ze=T*R-x*P,De=A*I-D*L,ot=A*R-x*L,$e=D*R-x*I,it=V*Q-W*ie,ft=V*ue-K*ie,ut=V*_e-re*ie,mt=W*ue-K*Q,xt=W*_e-re*Q,At=K*_e-re*ue,_t=Ee*At-Ne*xt+ze*mt+De*ut-ot*ft+$e*it;return _t?(h[0]=(L*At-I*xt+R*mt)*(_t=1/_t),h[1]=(I*ut-P*At-R*ft)*_t,h[2]=(P*xt-L*ut+R*it)*_t,h[3]=(D*xt-A*At-x*mt)*_t,h[4]=(T*At-D*ut+x*ft)*_t,h[5]=(A*ut-T*xt-x*it)*_t,h[6]=(Q*$e-ue*ot+_e*De)*_t,h[7]=(ue*ze-ie*$e-_e*Ne)*_t,h[8]=(ie*ot-Q*ze+_e*Ee)*_t,h):null},q.projection=function(h,v,T){return h[0]=2/v,h[1]=0,h[2]=0,h[3]=0,h[4]=-2/T,h[5]=0,h[6]=-1,h[7]=1,h[8]=1,h},q.str=function(h){return"mat3("+h[0]+", "+h[1]+", "+h[2]+", "+h[3]+", "+h[4]+", "+h[5]+", "+h[6]+", "+h[7]+", "+h[8]+")"},q.frob=function(h){return Math.hypot(h[0],h[1],h[2],h[3],h[4],h[5],h[6],h[7],h[8])},q.add=function(h,v,T){return h[0]=v[0]+T[0],h[1]=v[1]+T[1],h[2]=v[2]+T[2],h[3]=v[3]+T[3],h[4]=v[4]+T[4],h[5]=v[5]+T[5],h[6]=v[6]+T[6],h[7]=v[7]+T[7],h[8]=v[8]+T[8],h},q.subtract=g,q.multiplyScalar=function(h,v,T){return h[0]=v[0]*T,h[1]=v[1]*T,h[2]=v[2]*T,h[3]=v[3]*T,h[4]=v[4]*T,h[5]=v[5]*T,h[6]=v[6]*T,h[7]=v[7]*T,h[8]=v[8]*T,h},q.multiplyScalarAndAdd=function(h,v,T,A){return h[0]=v[0]+T[0]*A,h[1]=v[1]+T[1]*A,h[2]=v[2]+T[2]*A,h[3]=v[3]+T[3]*A,h[4]=v[4]+T[4]*A,h[5]=v[5]+T[5]*A,h[6]=v[6]+T[6]*A,h[7]=v[7]+T[7]*A,h[8]=v[8]+T[8]*A,h},q.exactEquals=function(h,v){return h[0]===v[0]&&h[1]===v[1]&&h[2]===v[2]&&h[3]===v[3]&&h[4]===v[4]&&h[5]===v[5]&&h[6]===v[6]&&h[7]===v[7]&&h[8]===v[8]},q.equals=function(h,v){var T=h[0],A=h[1],D=h[2],x=h[3],P=h[4],L=h[5],I=h[6],R=h[7],V=h[8],W=v[0],K=v[1],re=v[2],ie=v[3],Q=v[4],ue=v[5],_e=v[6],Ee=v[7],Ne=v[8];return Math.abs(T-W)<=n.EPSILON*Math.max(1,Math.abs(T),Math.abs(W))&&Math.abs(A-K)<=n.EPSILON*Math.max(1,Math.abs(A),Math.abs(K))&&Math.abs(D-re)<=n.EPSILON*Math.max(1,Math.abs(D),Math.abs(re))&&Math.abs(x-ie)<=n.EPSILON*Math.max(1,Math.abs(x),Math.abs(ie))&&Math.abs(P-Q)<=n.EPSILON*Math.max(1,Math.abs(P),Math.abs(Q))&&Math.abs(L-ue)<=n.EPSILON*Math.max(1,Math.abs(L),Math.abs(ue))&&Math.abs(I-_e)<=n.EPSILON*Math.max(1,Math.abs(I),Math.abs(_e))&&Math.abs(R-Ee)<=n.EPSILON*Math.max(1,Math.abs(R),Math.abs(Ee))&&Math.abs(V-Ne)<=n.EPSILON*Math.max(1,Math.abs(V),Math.abs(Ne))},q.sub=q.mul=void 0;var n=function(h,v){if(h&&h.__esModule)return h;if(h===null||c(h)!=="object"&&typeof h!="function")return{default:h};var T=s(void 0);if(T&&T.has(h))return T.get(h);var A={},D=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var x in h)if(x!=="default"&&Object.prototype.hasOwnProperty.call(h,x)){var P=D?Object.getOwnPropertyDescriptor(h,x):null;P&&(P.get||P.set)?Object.defineProperty(A,x,P):A[x]=h[x]}return A.default=h,T&&T.set(h,A),A}(z());function s(h){if(typeof WeakMap!="function")return null;var v=new WeakMap,T=new WeakMap;return(s=function(A){return A?T:v})(h)}function u(h,v,T){var A=v[0],D=v[1],x=v[2],P=v[3],L=v[4],I=v[5],R=v[6],V=v[7],W=v[8],K=T[0],re=T[1],ie=T[2],Q=T[3],ue=T[4],_e=T[5],Ee=T[6],Ne=T[7],ze=T[8];return h[0]=K*A+re*P+ie*R,h[1]=K*D+re*L+ie*V,h[2]=K*x+re*I+ie*W,h[3]=Q*A+ue*P+_e*R,h[4]=Q*D+ue*L+_e*V,h[5]=Q*x+ue*I+_e*W,h[6]=Ee*A+Ne*P+ze*R,h[7]=Ee*D+Ne*L+ze*V,h[8]=Ee*x+Ne*I+ze*W,h}function g(h,v,T){return h[0]=v[0]-T[0],h[1]=v[1]-T[1],h[2]=v[2]-T[2],h[3]=v[3]-T[3],h[4]=v[4]-T[4],h[5]=v[5]-T[5],h[6]=v[6]-T[6],h[7]=v[7]-T[7],h[8]=v[8]-T[8],h}return q.mul=u,q.sub=g,q}var ne,se={};function fe(){if(ne)return se;function c(x){return c=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(P){return typeof P}:function(P){return P&&typeof Symbol=="function"&&P.constructor===Symbol&&P!==Symbol.prototype?"symbol":typeof P},c(x)}ne=1,Object.defineProperty(se,"__esModule",{value:!0}),se.create=function(){var x=new n.ARRAY_TYPE(16);return n.ARRAY_TYPE!=Float32Array&&(x[1]=0,x[2]=0,x[3]=0,x[4]=0,x[6]=0,x[7]=0,x[8]=0,x[9]=0,x[11]=0,x[12]=0,x[13]=0,x[14]=0),x[0]=1,x[5]=1,x[10]=1,x[15]=1,x},se.clone=function(x){var P=new n.ARRAY_TYPE(16);return P[0]=x[0],P[1]=x[1],P[2]=x[2],P[3]=x[3],P[4]=x[4],P[5]=x[5],P[6]=x[6],P[7]=x[7],P[8]=x[8],P[9]=x[9],P[10]=x[10],P[11]=x[11],P[12]=x[12],P[13]=x[13],P[14]=x[14],P[15]=x[15],P},se.copy=function(x,P){return x[0]=P[0],x[1]=P[1],x[2]=P[2],x[3]=P[3],x[4]=P[4],x[5]=P[5],x[6]=P[6],x[7]=P[7],x[8]=P[8],x[9]=P[9],x[10]=P[10],x[11]=P[11],x[12]=P[12],x[13]=P[13],x[14]=P[14],x[15]=P[15],x},se.fromValues=function(x,P,L,I,R,V,W,K,re,ie,Q,ue,_e,Ee,Ne,ze){var De=new n.ARRAY_TYPE(16);return De[0]=x,De[1]=P,De[2]=L,De[3]=I,De[4]=R,De[5]=V,De[6]=W,De[7]=K,De[8]=re,De[9]=ie,De[10]=Q,De[11]=ue,De[12]=_e,De[13]=Ee,De[14]=Ne,De[15]=ze,De},se.set=function(x,P,L,I,R,V,W,K,re,ie,Q,ue,_e,Ee,Ne,ze,De){return x[0]=P,x[1]=L,x[2]=I,x[3]=R,x[4]=V,x[5]=W,x[6]=K,x[7]=re,x[8]=ie,x[9]=Q,x[10]=ue,x[11]=_e,x[12]=Ee,x[13]=Ne,x[14]=ze,x[15]=De,x},se.identity=u,se.transpose=function(x,P){if(x===P){var L=P[1],I=P[2],R=P[3],V=P[6],W=P[7],K=P[11];x[1]=P[4],x[2]=P[8],x[3]=P[12],x[4]=L,x[6]=P[9],x[7]=P[13],x[8]=I,x[9]=V,x[11]=P[14],x[12]=R,x[13]=W,x[14]=K}else x[0]=P[0],x[1]=P[4],x[2]=P[8],x[3]=P[12],x[4]=P[1],x[5]=P[5],x[6]=P[9],x[7]=P[13],x[8]=P[2],x[9]=P[6],x[10]=P[10],x[11]=P[14],x[12]=P[3],x[13]=P[7],x[14]=P[11],x[15]=P[15];return x},se.invert=function(x,P){var L=P[0],I=P[1],R=P[2],V=P[3],W=P[4],K=P[5],re=P[6],ie=P[7],Q=P[8],ue=P[9],_e=P[10],Ee=P[11],Ne=P[12],ze=P[13],De=P[14],ot=P[15],$e=L*K-I*W,it=L*re-R*W,ft=L*ie-V*W,ut=I*re-R*K,mt=I*ie-V*K,xt=R*ie-V*re,At=Q*ze-ue*Ne,_t=Q*De-_e*Ne,Zt=Q*ot-Ee*Ne,hn=ue*De-_e*ze,Kt=ue*ot-Ee*ze,kn=_e*ot-Ee*De,Mn=$e*kn-it*Kt+ft*hn+ut*Zt-mt*_t+xt*At;return Mn?(x[0]=(K*kn-re*Kt+ie*hn)*(Mn=1/Mn),x[1]=(R*Kt-I*kn-V*hn)*Mn,x[2]=(ze*xt-De*mt+ot*ut)*Mn,x[3]=(_e*mt-ue*xt-Ee*ut)*Mn,x[4]=(re*Zt-W*kn-ie*_t)*Mn,x[5]=(L*kn-R*Zt+V*_t)*Mn,x[6]=(De*ft-Ne*xt-ot*it)*Mn,x[7]=(Q*xt-_e*ft+Ee*it)*Mn,x[8]=(W*Kt-K*Zt+ie*At)*Mn,x[9]=(I*Zt-L*Kt-V*At)*Mn,x[10]=(Ne*mt-ze*ft+ot*$e)*Mn,x[11]=(ue*ft-Q*mt-Ee*$e)*Mn,x[12]=(K*_t-W*hn-re*At)*Mn,x[13]=(L*hn-I*_t+R*At)*Mn,x[14]=(ze*it-Ne*ut-De*$e)*Mn,x[15]=(Q*ut-ue*it+_e*$e)*Mn,x):null},se.adjoint=function(x,P){var L=P[0],I=P[1],R=P[2],V=P[3],W=P[4],K=P[5],re=P[6],ie=P[7],Q=P[8],ue=P[9],_e=P[10],Ee=P[11],Ne=P[12],ze=P[13],De=P[14],ot=P[15];return x[0]=K*(_e*ot-Ee*De)-ue*(re*ot-ie*De)+ze*(re*Ee-ie*_e),x[1]=-(I*(_e*ot-Ee*De)-ue*(R*ot-V*De)+ze*(R*Ee-V*_e)),x[2]=I*(re*ot-ie*De)-K*(R*ot-V*De)+ze*(R*ie-V*re),x[3]=-(I*(re*Ee-ie*_e)-K*(R*Ee-V*_e)+ue*(R*ie-V*re)),x[4]=-(W*(_e*ot-Ee*De)-Q*(re*ot-ie*De)+Ne*(re*Ee-ie*_e)),x[5]=L*(_e*ot-Ee*De)-Q*(R*ot-V*De)+Ne*(R*Ee-V*_e),x[6]=-(L*(re*ot-ie*De)-W*(R*ot-V*De)+Ne*(R*ie-V*re)),x[7]=L*(re*Ee-ie*_e)-W*(R*Ee-V*_e)+Q*(R*ie-V*re),x[8]=W*(ue*ot-Ee*ze)-Q*(K*ot-ie*ze)+Ne*(K*Ee-ie*ue),x[9]=-(L*(ue*ot-Ee*ze)-Q*(I*ot-V*ze)+Ne*(I*Ee-V*ue)),x[10]=L*(K*ot-ie*ze)-W*(I*ot-V*ze)+Ne*(I*ie-V*K),x[11]=-(L*(K*Ee-ie*ue)-W*(I*Ee-V*ue)+Q*(I*ie-V*K)),x[12]=-(W*(ue*De-_e*ze)-Q*(K*De-re*ze)+Ne*(K*_e-re*ue)),x[13]=L*(ue*De-_e*ze)-Q*(I*De-R*ze)+Ne*(I*_e-R*ue),x[14]=-(L*(K*De-re*ze)-W*(I*De-R*ze)+Ne*(I*re-R*K)),x[15]=L*(K*_e-re*ue)-W*(I*_e-R*ue)+Q*(I*re-R*K),x},se.determinant=function(x){var P=x[0],L=x[1],I=x[2],R=x[3],V=x[4],W=x[5],K=x[6],re=x[7],ie=x[8],Q=x[9],ue=x[10],_e=x[11],Ee=x[12],Ne=x[13],ze=x[14],De=x[15];return(P*W-L*V)*(ue*De-_e*ze)-(P*K-I*V)*(Q*De-_e*Ne)+(P*re-R*V)*(Q*ze-ue*Ne)+(L*K-I*W)*(ie*De-_e*Ee)-(L*re-R*W)*(ie*ze-ue*Ee)+(I*re-R*K)*(ie*Ne-Q*Ee)},se.multiply=g,se.translate=function(x,P,L){var I,R,V,W,K,re,ie,Q,ue,_e,Ee,Ne,ze=L[0],De=L[1],ot=L[2];return P===x?(x[12]=P[0]*ze+P[4]*De+P[8]*ot+P[12],x[13]=P[1]*ze+P[5]*De+P[9]*ot+P[13],x[14]=P[2]*ze+P[6]*De+P[10]*ot+P[14],x[15]=P[3]*ze+P[7]*De+P[11]*ot+P[15]):(R=P[1],V=P[2],W=P[3],K=P[4],re=P[5],ie=P[6],Q=P[7],ue=P[8],_e=P[9],Ee=P[10],Ne=P[11],x[0]=I=P[0],x[1]=R,x[2]=V,x[3]=W,x[4]=K,x[5]=re,x[6]=ie,x[7]=Q,x[8]=ue,x[9]=_e,x[10]=Ee,x[11]=Ne,x[12]=I*ze+K*De+ue*ot+P[12],x[13]=R*ze+re*De+_e*ot+P[13],x[14]=V*ze+ie*De+Ee*ot+P[14],x[15]=W*ze+Q*De+Ne*ot+P[15]),x},se.scale=function(x,P,L){var I=L[0],R=L[1],V=L[2];return x[0]=P[0]*I,x[1]=P[1]*I,x[2]=P[2]*I,x[3]=P[3]*I,x[4]=P[4]*R,x[5]=P[5]*R,x[6]=P[6]*R,x[7]=P[7]*R,x[8]=P[8]*V,x[9]=P[9]*V,x[10]=P[10]*V,x[11]=P[11]*V,x[12]=P[12],x[13]=P[13],x[14]=P[14],x[15]=P[15],x},se.rotate=function(x,P,L,I){var R,V,W,K,re,ie,Q,ue,_e,Ee,Ne,ze,De,ot,$e,it,ft,ut,mt,xt,At,_t,Zt,hn,Kt=I[0],kn=I[1],Mn=I[2],_n=Math.hypot(Kt,kn,Mn);return _n<n.EPSILON?null:(Kt*=_n=1/_n,kn*=_n,Mn*=_n,R=Math.sin(L),V=Math.cos(L),re=P[1],ie=P[2],Q=P[3],_e=P[5],Ee=P[6],Ne=P[7],De=P[9],ot=P[10],$e=P[11],it=Kt*Kt*(W=1-V)+V,mt=Kt*kn*W-Mn*R,xt=kn*kn*W+V,At=Mn*kn*W+Kt*R,_t=Kt*Mn*W+kn*R,Zt=kn*Mn*W-Kt*R,hn=Mn*Mn*W+V,x[0]=(K=P[0])*it+(ue=P[4])*(ft=kn*Kt*W+Mn*R)+(ze=P[8])*(ut=Mn*Kt*W-kn*R),x[1]=re*it+_e*ft+De*ut,x[2]=ie*it+Ee*ft+ot*ut,x[3]=Q*it+Ne*ft+$e*ut,x[4]=K*mt+ue*xt+ze*At,x[5]=re*mt+_e*xt+De*At,x[6]=ie*mt+Ee*xt+ot*At,x[7]=Q*mt+Ne*xt+$e*At,x[8]=K*_t+ue*Zt+ze*hn,x[9]=re*_t+_e*Zt+De*hn,x[10]=ie*_t+Ee*Zt+ot*hn,x[11]=Q*_t+Ne*Zt+$e*hn,P!==x&&(x[12]=P[12],x[13]=P[13],x[14]=P[14],x[15]=P[15]),x)},se.rotateX=function(x,P,L){var I=Math.sin(L),R=Math.cos(L),V=P[4],W=P[5],K=P[6],re=P[7],ie=P[8],Q=P[9],ue=P[10],_e=P[11];return P!==x&&(x[0]=P[0],x[1]=P[1],x[2]=P[2],x[3]=P[3],x[12]=P[12],x[13]=P[13],x[14]=P[14],x[15]=P[15]),x[4]=V*R+ie*I,x[5]=W*R+Q*I,x[6]=K*R+ue*I,x[7]=re*R+_e*I,x[8]=ie*R-V*I,x[9]=Q*R-W*I,x[10]=ue*R-K*I,x[11]=_e*R-re*I,x},se.rotateY=function(x,P,L){var I=Math.sin(L),R=Math.cos(L),V=P[0],W=P[1],K=P[2],re=P[3],ie=P[8],Q=P[9],ue=P[10],_e=P[11];return P!==x&&(x[4]=P[4],x[5]=P[5],x[6]=P[6],x[7]=P[7],x[12]=P[12],x[13]=P[13],x[14]=P[14],x[15]=P[15]),x[0]=V*R-ie*I,x[1]=W*R-Q*I,x[2]=K*R-ue*I,x[3]=re*R-_e*I,x[8]=V*I+ie*R,x[9]=W*I+Q*R,x[10]=K*I+ue*R,x[11]=re*I+_e*R,x},se.rotateZ=function(x,P,L){var I=Math.sin(L),R=Math.cos(L),V=P[0],W=P[1],K=P[2],re=P[3],ie=P[4],Q=P[5],ue=P[6],_e=P[7];return P!==x&&(x[8]=P[8],x[9]=P[9],x[10]=P[10],x[11]=P[11],x[12]=P[12],x[13]=P[13],x[14]=P[14],x[15]=P[15]),x[0]=V*R+ie*I,x[1]=W*R+Q*I,x[2]=K*R+ue*I,x[3]=re*R+_e*I,x[4]=ie*R-V*I,x[5]=Q*R-W*I,x[6]=ue*R-K*I,x[7]=_e*R-re*I,x},se.fromTranslation=function(x,P){return x[0]=1,x[1]=0,x[2]=0,x[3]=0,x[4]=0,x[5]=1,x[6]=0,x[7]=0,x[8]=0,x[9]=0,x[10]=1,x[11]=0,x[12]=P[0],x[13]=P[1],x[14]=P[2],x[15]=1,x},se.fromScaling=function(x,P){return x[0]=P[0],x[1]=0,x[2]=0,x[3]=0,x[4]=0,x[5]=P[1],x[6]=0,x[7]=0,x[8]=0,x[9]=0,x[10]=P[2],x[11]=0,x[12]=0,x[13]=0,x[14]=0,x[15]=1,x},se.fromRotation=function(x,P,L){var I,R,V,W=L[0],K=L[1],re=L[2],ie=Math.hypot(W,K,re);return ie<n.EPSILON?null:(W*=ie=1/ie,K*=ie,re*=ie,I=Math.sin(P),R=Math.cos(P),x[0]=W*W*(V=1-R)+R,x[1]=K*W*V+re*I,x[2]=re*W*V-K*I,x[3]=0,x[4]=W*K*V-re*I,x[5]=K*K*V+R,x[6]=re*K*V+W*I,x[7]=0,x[8]=W*re*V+K*I,x[9]=K*re*V-W*I,x[10]=re*re*V+R,x[11]=0,x[12]=0,x[13]=0,x[14]=0,x[15]=1,x)},se.fromXRotation=function(x,P){var L=Math.sin(P),I=Math.cos(P);return x[0]=1,x[1]=0,x[2]=0,x[3]=0,x[4]=0,x[5]=I,x[6]=L,x[7]=0,x[8]=0,x[9]=-L,x[10]=I,x[11]=0,x[12]=0,x[13]=0,x[14]=0,x[15]=1,x},se.fromYRotation=function(x,P){var L=Math.sin(P),I=Math.cos(P);return x[0]=I,x[1]=0,x[2]=-L,x[3]=0,x[4]=0,x[5]=1,x[6]=0,x[7]=0,x[8]=L,x[9]=0,x[10]=I,x[11]=0,x[12]=0,x[13]=0,x[14]=0,x[15]=1,x},se.fromZRotation=function(x,P){var L=Math.sin(P),I=Math.cos(P);return x[0]=I,x[1]=L,x[2]=0,x[3]=0,x[4]=-L,x[5]=I,x[6]=0,x[7]=0,x[8]=0,x[9]=0,x[10]=1,x[11]=0,x[12]=0,x[13]=0,x[14]=0,x[15]=1,x},se.fromRotationTranslation=h,se.fromQuat2=function(x,P){var L=new n.ARRAY_TYPE(3),I=-P[0],R=-P[1],V=-P[2],W=P[3],K=P[4],re=P[5],ie=P[6],Q=P[7],ue=I*I+R*R+V*V+W*W;return ue>0?(L[0]=2*(K*W+Q*I+re*V-ie*R)/ue,L[1]=2*(re*W+Q*R+ie*I-K*V)/ue,L[2]=2*(ie*W+Q*V+K*R-re*I)/ue):(L[0]=2*(K*W+Q*I+re*V-ie*R),L[1]=2*(re*W+Q*R+ie*I-K*V),L[2]=2*(ie*W+Q*V+K*R-re*I)),h(x,P,L),x},se.getTranslation=function(x,P){return x[0]=P[12],x[1]=P[13],x[2]=P[14],x},se.getScaling=v,se.getRotation=function(x,P){var L=new n.ARRAY_TYPE(3);v(L,P);var I=1/L[0],R=1/L[1],V=1/L[2],W=P[0]*I,K=P[1]*R,re=P[2]*V,ie=P[4]*I,Q=P[5]*R,ue=P[6]*V,_e=P[8]*I,Ee=P[9]*R,Ne=P[10]*V,ze=W+Q+Ne,De=0;return ze>0?(De=2*Math.sqrt(ze+1),x[3]=.25*De,x[0]=(ue-Ee)/De,x[1]=(_e-re)/De,x[2]=(K-ie)/De):W>Q&&W>Ne?(De=2*Math.sqrt(1+W-Q-Ne),x[3]=(ue-Ee)/De,x[0]=.25*De,x[1]=(K+ie)/De,x[2]=(_e+re)/De):Q>Ne?(De=2*Math.sqrt(1+Q-W-Ne),x[3]=(_e-re)/De,x[0]=(K+ie)/De,x[1]=.25*De,x[2]=(ue+Ee)/De):(De=2*Math.sqrt(1+Ne-W-Q),x[3]=(K-ie)/De,x[0]=(_e+re)/De,x[1]=(ue+Ee)/De,x[2]=.25*De),x},se.fromRotationTranslationScale=function(x,P,L,I){var R=P[0],V=P[1],W=P[2],K=P[3],re=R+R,ie=V+V,Q=W+W,ue=R*re,_e=R*ie,Ee=R*Q,Ne=V*ie,ze=V*Q,De=W*Q,ot=K*re,$e=K*ie,it=K*Q,ft=I[0],ut=I[1],mt=I[2];return x[0]=(1-(Ne+De))*ft,x[1]=(_e+it)*ft,x[2]=(Ee-$e)*ft,x[3]=0,x[4]=(_e-it)*ut,x[5]=(1-(ue+De))*ut,x[6]=(ze+ot)*ut,x[7]=0,x[8]=(Ee+$e)*mt,x[9]=(ze-ot)*mt,x[10]=(1-(ue+Ne))*mt,x[11]=0,x[12]=L[0],x[13]=L[1],x[14]=L[2],x[15]=1,x},se.fromRotationTranslationScaleOrigin=function(x,P,L,I,R){var V=P[0],W=P[1],K=P[2],re=P[3],ie=V+V,Q=W+W,ue=K+K,_e=V*ie,Ee=V*Q,Ne=V*ue,ze=W*Q,De=W*ue,ot=K*ue,$e=re*ie,it=re*Q,ft=re*ue,ut=I[0],mt=I[1],xt=I[2],At=R[0],_t=R[1],Zt=R[2],hn=(1-(ze+ot))*ut,Kt=(Ee+ft)*ut,kn=(Ne-it)*ut,Mn=(Ee-ft)*mt,_n=(1-(_e+ot))*mt,mn=(De+$e)*mt,Zn=(Ne+it)*xt,Rn=(De-$e)*xt,Fn=(1-(_e+ze))*xt;return x[0]=hn,x[1]=Kt,x[2]=kn,x[3]=0,x[4]=Mn,x[5]=_n,x[6]=mn,x[7]=0,x[8]=Zn,x[9]=Rn,x[10]=Fn,x[11]=0,x[12]=L[0]+At-(hn*At+Mn*_t+Zn*Zt),x[13]=L[1]+_t-(Kt*At+_n*_t+Rn*Zt),x[14]=L[2]+Zt-(kn*At+mn*_t+Fn*Zt),x[15]=1,x},se.fromQuat=function(x,P){var L=P[0],I=P[1],R=P[2],V=P[3],W=L+L,K=I+I,re=R+R,ie=L*W,Q=I*W,ue=I*K,_e=R*W,Ee=R*K,Ne=R*re,ze=V*W,De=V*K,ot=V*re;return x[0]=1-ue-Ne,x[1]=Q+ot,x[2]=_e-De,x[3]=0,x[4]=Q-ot,x[5]=1-ie-Ne,x[6]=Ee+ze,x[7]=0,x[8]=_e+De,x[9]=Ee-ze,x[10]=1-ie-ue,x[11]=0,x[12]=0,x[13]=0,x[14]=0,x[15]=1,x},se.frustum=function(x,P,L,I,R,V,W){var K=1/(L-P),re=1/(R-I),ie=1/(V-W);return x[0]=2*V*K,x[1]=0,x[2]=0,x[3]=0,x[4]=0,x[5]=2*V*re,x[6]=0,x[7]=0,x[8]=(L+P)*K,x[9]=(R+I)*re,x[10]=(W+V)*ie,x[11]=-1,x[12]=0,x[13]=0,x[14]=W*V*2*ie,x[15]=0,x},se.perspectiveNO=T,se.perspectiveZO=function(x,P,L,I,R){var V,W=1/Math.tan(P/2);return x[0]=W/L,x[1]=0,x[2]=0,x[3]=0,x[4]=0,x[5]=W,x[6]=0,x[7]=0,x[8]=0,x[9]=0,x[11]=-1,x[12]=0,x[13]=0,x[15]=0,R!=null&&R!==1/0?(x[10]=R*(V=1/(I-R)),x[14]=R*I*V):(x[10]=-1,x[14]=-I),x},se.perspectiveFromFieldOfView=function(x,P,L,I){var R=Math.tan(P.upDegrees*Math.PI/180),V=Math.tan(P.downDegrees*Math.PI/180),W=Math.tan(P.leftDegrees*Math.PI/180),K=Math.tan(P.rightDegrees*Math.PI/180),re=2/(W+K),ie=2/(R+V);return x[0]=re,x[1]=0,x[2]=0,x[3]=0,x[4]=0,x[5]=ie,x[6]=0,x[7]=0,x[8]=-(W-K)*re*.5,x[9]=(R-V)*ie*.5,x[10]=I/(L-I),x[11]=-1,x[12]=0,x[13]=0,x[14]=I*L/(L-I),x[15]=0,x},se.orthoNO=A,se.orthoZO=function(x,P,L,I,R,V,W){var K=1/(P-L),re=1/(I-R),ie=1/(V-W);return x[0]=-2*K,x[1]=0,x[2]=0,x[3]=0,x[4]=0,x[5]=-2*re,x[6]=0,x[7]=0,x[8]=0,x[9]=0,x[10]=ie,x[11]=0,x[12]=(P+L)*K,x[13]=(R+I)*re,x[14]=V*ie,x[15]=1,x},se.lookAt=function(x,P,L,I){var R,V,W,K,re,ie,Q,ue,_e,Ee,Ne=P[0],ze=P[1],De=P[2],ot=I[0],$e=I[1],it=I[2],ft=L[0],ut=L[1],mt=L[2];return Math.abs(Ne-ft)<n.EPSILON&&Math.abs(ze-ut)<n.EPSILON&&Math.abs(De-mt)<n.EPSILON?u(x):(Q=Ne-ft,ue=ze-ut,_e=De-mt,R=$e*(_e*=Ee=1/Math.hypot(Q,ue,_e))-it*(ue*=Ee),V=it*(Q*=Ee)-ot*_e,W=ot*ue-$e*Q,(Ee=Math.hypot(R,V,W))?(R*=Ee=1/Ee,V*=Ee,W*=Ee):(R=0,V=0,W=0),K=ue*W-_e*V,re=_e*R-Q*W,ie=Q*V-ue*R,(Ee=Math.hypot(K,re,ie))?(K*=Ee=1/Ee,re*=Ee,ie*=Ee):(K=0,re=0,ie=0),x[0]=R,x[1]=K,x[2]=Q,x[3]=0,x[4]=V,x[5]=re,x[6]=ue,x[7]=0,x[8]=W,x[9]=ie,x[10]=_e,x[11]=0,x[12]=-(R*Ne+V*ze+W*De),x[13]=-(K*Ne+re*ze+ie*De),x[14]=-(Q*Ne+ue*ze+_e*De),x[15]=1,x)},se.targetTo=function(x,P,L,I){var R=P[0],V=P[1],W=P[2],K=I[0],re=I[1],ie=I[2],Q=R-L[0],ue=V-L[1],_e=W-L[2],Ee=Q*Q+ue*ue+_e*_e;Ee>0&&(Q*=Ee=1/Math.sqrt(Ee),ue*=Ee,_e*=Ee);var Ne=re*_e-ie*ue,ze=ie*Q-K*_e,De=K*ue-re*Q;return(Ee=Ne*Ne+ze*ze+De*De)>0&&(Ne*=Ee=1/Math.sqrt(Ee),ze*=Ee,De*=Ee),x[0]=Ne,x[1]=ze,x[2]=De,x[3]=0,x[4]=ue*De-_e*ze,x[5]=_e*Ne-Q*De,x[6]=Q*ze-ue*Ne,x[7]=0,x[8]=Q,x[9]=ue,x[10]=_e,x[11]=0,x[12]=R,x[13]=V,x[14]=W,x[15]=1,x},se.str=function(x){return"mat4("+x[0]+", "+x[1]+", "+x[2]+", "+x[3]+", "+x[4]+", "+x[5]+", "+x[6]+", "+x[7]+", "+x[8]+", "+x[9]+", "+x[10]+", "+x[11]+", "+x[12]+", "+x[13]+", "+x[14]+", "+x[15]+")"},se.frob=function(x){return Math.hypot(x[0],x[1],x[2],x[3],x[4],x[5],x[6],x[7],x[8],x[9],x[10],x[11],x[12],x[13],x[14],x[15])},se.add=function(x,P,L){return x[0]=P[0]+L[0],x[1]=P[1]+L[1],x[2]=P[2]+L[2],x[3]=P[3]+L[3],x[4]=P[4]+L[4],x[5]=P[5]+L[5],x[6]=P[6]+L[6],x[7]=P[7]+L[7],x[8]=P[8]+L[8],x[9]=P[9]+L[9],x[10]=P[10]+L[10],x[11]=P[11]+L[11],x[12]=P[12]+L[12],x[13]=P[13]+L[13],x[14]=P[14]+L[14],x[15]=P[15]+L[15],x},se.subtract=D,se.multiplyScalar=function(x,P,L){return x[0]=P[0]*L,x[1]=P[1]*L,x[2]=P[2]*L,x[3]=P[3]*L,x[4]=P[4]*L,x[5]=P[5]*L,x[6]=P[6]*L,x[7]=P[7]*L,x[8]=P[8]*L,x[9]=P[9]*L,x[10]=P[10]*L,x[11]=P[11]*L,x[12]=P[12]*L,x[13]=P[13]*L,x[14]=P[14]*L,x[15]=P[15]*L,x},se.multiplyScalarAndAdd=function(x,P,L,I){return x[0]=P[0]+L[0]*I,x[1]=P[1]+L[1]*I,x[2]=P[2]+L[2]*I,x[3]=P[3]+L[3]*I,x[4]=P[4]+L[4]*I,x[5]=P[5]+L[5]*I,x[6]=P[6]+L[6]*I,x[7]=P[7]+L[7]*I,x[8]=P[8]+L[8]*I,x[9]=P[9]+L[9]*I,x[10]=P[10]+L[10]*I,x[11]=P[11]+L[11]*I,x[12]=P[12]+L[12]*I,x[13]=P[13]+L[13]*I,x[14]=P[14]+L[14]*I,x[15]=P[15]+L[15]*I,x},se.exactEquals=function(x,P){return x[0]===P[0]&&x[1]===P[1]&&x[2]===P[2]&&x[3]===P[3]&&x[4]===P[4]&&x[5]===P[5]&&x[6]===P[6]&&x[7]===P[7]&&x[8]===P[8]&&x[9]===P[9]&&x[10]===P[10]&&x[11]===P[11]&&x[12]===P[12]&&x[13]===P[13]&&x[14]===P[14]&&x[15]===P[15]},se.equals=function(x,P){var L=x[0],I=x[1],R=x[2],V=x[3],W=x[4],K=x[5],re=x[6],ie=x[7],Q=x[8],ue=x[9],_e=x[10],Ee=x[11],Ne=x[12],ze=x[13],De=x[14],ot=x[15],$e=P[0],it=P[1],ft=P[2],ut=P[3],mt=P[4],xt=P[5],At=P[6],_t=P[7],Zt=P[8],hn=P[9],Kt=P[10],kn=P[11],Mn=P[12],_n=P[13],mn=P[14],Zn=P[15];return Math.abs(L-$e)<=n.EPSILON*Math.max(1,Math.abs(L),Math.abs($e))&&Math.abs(I-it)<=n.EPSILON*Math.max(1,Math.abs(I),Math.abs(it))&&Math.abs(R-ft)<=n.EPSILON*Math.max(1,Math.abs(R),Math.abs(ft))&&Math.abs(V-ut)<=n.EPSILON*Math.max(1,Math.abs(V),Math.abs(ut))&&Math.abs(W-mt)<=n.EPSILON*Math.max(1,Math.abs(W),Math.abs(mt))&&Math.abs(K-xt)<=n.EPSILON*Math.max(1,Math.abs(K),Math.abs(xt))&&Math.abs(re-At)<=n.EPSILON*Math.max(1,Math.abs(re),Math.abs(At))&&Math.abs(ie-_t)<=n.EPSILON*Math.max(1,Math.abs(ie),Math.abs(_t))&&Math.abs(Q-Zt)<=n.EPSILON*Math.max(1,Math.abs(Q),Math.abs(Zt))&&Math.abs(ue-hn)<=n.EPSILON*Math.max(1,Math.abs(ue),Math.abs(hn))&&Math.abs(_e-Kt)<=n.EPSILON*Math.max(1,Math.abs(_e),Math.abs(Kt))&&Math.abs(Ee-kn)<=n.EPSILON*Math.max(1,Math.abs(Ee),Math.abs(kn))&&Math.abs(Ne-Mn)<=n.EPSILON*Math.max(1,Math.abs(Ne),Math.abs(Mn))&&Math.abs(ze-_n)<=n.EPSILON*Math.max(1,Math.abs(ze),Math.abs(_n))&&Math.abs(De-mn)<=n.EPSILON*Math.max(1,Math.abs(De),Math.abs(mn))&&Math.abs(ot-Zn)<=n.EPSILON*Math.max(1,Math.abs(ot),Math.abs(Zn))},se.sub=se.mul=se.ortho=se.perspective=void 0;var n=function(x,P){if(x&&x.__esModule)return x;if(x===null||c(x)!=="object"&&typeof x!="function")return{default:x};var L=s(void 0);if(L&&L.has(x))return L.get(x);var I={},R=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var V in x)if(V!=="default"&&Object.prototype.hasOwnProperty.call(x,V)){var W=R?Object.getOwnPropertyDescriptor(x,V):null;W&&(W.get||W.set)?Object.defineProperty(I,V,W):I[V]=x[V]}return I.default=x,L&&L.set(x,I),I}(z());function s(x){if(typeof WeakMap!="function")return null;var P=new WeakMap,L=new WeakMap;return(s=function(I){return I?L:P})(x)}function u(x){return x[0]=1,x[1]=0,x[2]=0,x[3]=0,x[4]=0,x[5]=1,x[6]=0,x[7]=0,x[8]=0,x[9]=0,x[10]=1,x[11]=0,x[12]=0,x[13]=0,x[14]=0,x[15]=1,x}function g(x,P,L){var I=P[0],R=P[1],V=P[2],W=P[3],K=P[4],re=P[5],ie=P[6],Q=P[7],ue=P[8],_e=P[9],Ee=P[10],Ne=P[11],ze=P[12],De=P[13],ot=P[14],$e=P[15],it=L[0],ft=L[1],ut=L[2],mt=L[3];return x[0]=it*I+ft*K+ut*ue+mt*ze,x[1]=it*R+ft*re+ut*_e+mt*De,x[2]=it*V+ft*ie+ut*Ee+mt*ot,x[3]=it*W+ft*Q+ut*Ne+mt*$e,x[4]=(it=L[4])*I+(ft=L[5])*K+(ut=L[6])*ue+(mt=L[7])*ze,x[5]=it*R+ft*re+ut*_e+mt*De,x[6]=it*V+ft*ie+ut*Ee+mt*ot,x[7]=it*W+ft*Q+ut*Ne+mt*$e,x[8]=(it=L[8])*I+(ft=L[9])*K+(ut=L[10])*ue+(mt=L[11])*ze,x[9]=it*R+ft*re+ut*_e+mt*De,x[10]=it*V+ft*ie+ut*Ee+mt*ot,x[11]=it*W+ft*Q+ut*Ne+mt*$e,x[12]=(it=L[12])*I+(ft=L[13])*K+(ut=L[14])*ue+(mt=L[15])*ze,x[13]=it*R+ft*re+ut*_e+mt*De,x[14]=it*V+ft*ie+ut*Ee+mt*ot,x[15]=it*W+ft*Q+ut*Ne+mt*$e,x}function h(x,P,L){var I=P[0],R=P[1],V=P[2],W=P[3],K=I+I,re=R+R,ie=V+V,Q=I*K,ue=I*re,_e=I*ie,Ee=R*re,Ne=R*ie,ze=V*ie,De=W*K,ot=W*re,$e=W*ie;return x[0]=1-(Ee+ze),x[1]=ue+$e,x[2]=_e-ot,x[3]=0,x[4]=ue-$e,x[5]=1-(Q+ze),x[6]=Ne+De,x[7]=0,x[8]=_e+ot,x[9]=Ne-De,x[10]=1-(Q+Ee),x[11]=0,x[12]=L[0],x[13]=L[1],x[14]=L[2],x[15]=1,x}function v(x,P){var L=P[4],I=P[5],R=P[6],V=P[8],W=P[9],K=P[10];return x[0]=Math.hypot(P[0],P[1],P[2]),x[1]=Math.hypot(L,I,R),x[2]=Math.hypot(V,W,K),x}function T(x,P,L,I,R){var V,W=1/Math.tan(P/2);return x[0]=W/L,x[1]=0,x[2]=0,x[3]=0,x[4]=0,x[5]=W,x[6]=0,x[7]=0,x[8]=0,x[9]=0,x[11]=-1,x[12]=0,x[13]=0,x[15]=0,R!=null&&R!==1/0?(x[10]=(R+I)*(V=1/(I-R)),x[14]=2*R*I*V):(x[10]=-1,x[14]=-2*I),x}function A(x,P,L,I,R,V,W){var K=1/(P-L),re=1/(I-R),ie=1/(V-W);return x[0]=-2*K,x[1]=0,x[2]=0,x[3]=0,x[4]=0,x[5]=-2*re,x[6]=0,x[7]=0,x[8]=0,x[9]=0,x[10]=2*ie,x[11]=0,x[12]=(P+L)*K,x[13]=(R+I)*re,x[14]=(W+V)*ie,x[15]=1,x}function D(x,P,L){return x[0]=P[0]-L[0],x[1]=P[1]-L[1],x[2]=P[2]-L[2],x[3]=P[3]-L[3],x[4]=P[4]-L[4],x[5]=P[5]-L[5],x[6]=P[6]-L[6],x[7]=P[7]-L[7],x[8]=P[8]-L[8],x[9]=P[9]-L[9],x[10]=P[10]-L[10],x[11]=P[11]-L[11],x[12]=P[12]-L[12],x[13]=P[13]-L[13],x[14]=P[14]-L[14],x[15]=P[15]-L[15],x}return se.perspective=T,se.ortho=A,se.mul=g,se.sub=D,se}var ce,le={},ge={};function de(){if(ce)return ge;function c(R){return c=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(V){return typeof V}:function(V){return V&&typeof Symbol=="function"&&V.constructor===Symbol&&V!==Symbol.prototype?"symbol":typeof V},c(R)}ce=1,Object.defineProperty(ge,"__esModule",{value:!0}),ge.create=u,ge.clone=function(R){var V=new n.ARRAY_TYPE(3);return V[0]=R[0],V[1]=R[1],V[2]=R[2],V},ge.length=g,ge.fromValues=function(R,V,W){var K=new n.ARRAY_TYPE(3);return K[0]=R,K[1]=V,K[2]=W,K},ge.copy=function(R,V){return R[0]=V[0],R[1]=V[1],R[2]=V[2],R},ge.set=function(R,V,W,K){return R[0]=V,R[1]=W,R[2]=K,R},ge.add=function(R,V,W){return R[0]=V[0]+W[0],R[1]=V[1]+W[1],R[2]=V[2]+W[2],R},ge.subtract=h,ge.multiply=v,ge.divide=T,ge.ceil=function(R,V){return R[0]=Math.ceil(V[0]),R[1]=Math.ceil(V[1]),R[2]=Math.ceil(V[2]),R},ge.floor=function(R,V){return R[0]=Math.floor(V[0]),R[1]=Math.floor(V[1]),R[2]=Math.floor(V[2]),R},ge.min=function(R,V,W){return R[0]=Math.min(V[0],W[0]),R[1]=Math.min(V[1],W[1]),R[2]=Math.min(V[2],W[2]),R},ge.max=function(R,V,W){return R[0]=Math.max(V[0],W[0]),R[1]=Math.max(V[1],W[1]),R[2]=Math.max(V[2],W[2]),R},ge.round=function(R,V){return R[0]=Math.round(V[0]),R[1]=Math.round(V[1]),R[2]=Math.round(V[2]),R},ge.scale=function(R,V,W){return R[0]=V[0]*W,R[1]=V[1]*W,R[2]=V[2]*W,R},ge.scaleAndAdd=function(R,V,W,K){return R[0]=V[0]+W[0]*K,R[1]=V[1]+W[1]*K,R[2]=V[2]+W[2]*K,R},ge.distance=A,ge.squaredDistance=D,ge.squaredLength=x,ge.negate=function(R,V){return R[0]=-V[0],R[1]=-V[1],R[2]=-V[2],R},ge.inverse=function(R,V){return R[0]=1/V[0],R[1]=1/V[1],R[2]=1/V[2],R},ge.normalize=function(R,V){var W=V[0],K=V[1],re=V[2],ie=W*W+K*K+re*re;return ie>0&&(ie=1/Math.sqrt(ie)),R[0]=V[0]*ie,R[1]=V[1]*ie,R[2]=V[2]*ie,R},ge.dot=P,ge.cross=function(R,V,W){var K=V[0],re=V[1],ie=V[2],Q=W[0],ue=W[1],_e=W[2];return R[0]=re*_e-ie*ue,R[1]=ie*Q-K*_e,R[2]=K*ue-re*Q,R},ge.lerp=function(R,V,W,K){var re=V[0],ie=V[1],Q=V[2];return R[0]=re+K*(W[0]-re),R[1]=ie+K*(W[1]-ie),R[2]=Q+K*(W[2]-Q),R},ge.hermite=function(R,V,W,K,re,ie){var Q=ie*ie,ue=Q*(2*ie-3)+1,_e=Q*(ie-2)+ie,Ee=Q*(ie-1),Ne=Q*(3-2*ie);return R[0]=V[0]*ue+W[0]*_e+K[0]*Ee+re[0]*Ne,R[1]=V[1]*ue+W[1]*_e+K[1]*Ee+re[1]*Ne,R[2]=V[2]*ue+W[2]*_e+K[2]*Ee+re[2]*Ne,R},ge.bezier=function(R,V,W,K,re,ie){var Q=1-ie,ue=Q*Q,_e=ie*ie,Ee=ue*Q,Ne=3*ie*ue,ze=3*_e*Q,De=_e*ie;return R[0]=V[0]*Ee+W[0]*Ne+K[0]*ze+re[0]*De,R[1]=V[1]*Ee+W[1]*Ne+K[1]*ze+re[1]*De,R[2]=V[2]*Ee+W[2]*Ne+K[2]*ze+re[2]*De,R},ge.random=function(R,V){V=V||1;var W=2*n.RANDOM()*Math.PI,K=2*n.RANDOM()-1,re=Math.sqrt(1-K*K)*V;return R[0]=Math.cos(W)*re,R[1]=Math.sin(W)*re,R[2]=K*V,R},ge.transformMat4=function(R,V,W){var K=V[0],re=V[1],ie=V[2],Q=W[3]*K+W[7]*re+W[11]*ie+W[15];return R[0]=(W[0]*K+W[4]*re+W[8]*ie+W[12])/(Q=Q||1),R[1]=(W[1]*K+W[5]*re+W[9]*ie+W[13])/Q,R[2]=(W[2]*K+W[6]*re+W[10]*ie+W[14])/Q,R},ge.transformMat3=function(R,V,W){var K=V[0],re=V[1],ie=V[2];return R[0]=K*W[0]+re*W[3]+ie*W[6],R[1]=K*W[1]+re*W[4]+ie*W[7],R[2]=K*W[2]+re*W[5]+ie*W[8],R},ge.transformQuat=function(R,V,W){var K=W[0],re=W[1],ie=W[2],Q=V[0],ue=V[1],_e=V[2],Ee=re*_e-ie*ue,Ne=ie*Q-K*_e,ze=K*ue-re*Q,De=re*ze-ie*Ne,ot=ie*Ee-K*ze,$e=K*Ne-re*Ee,it=2*W[3];return Ne*=it,ze*=it,ot*=2,$e*=2,R[0]=Q+(Ee*=it)+(De*=2),R[1]=ue+Ne+ot,R[2]=_e+ze+$e,R},ge.rotateX=function(R,V,W,K){var re=[],ie=[];return re[0]=V[0]-W[0],re[1]=V[1]-W[1],re[2]=V[2]-W[2],ie[0]=re[0],ie[1]=re[1]*Math.cos(K)-re[2]*Math.sin(K),ie[2]=re[1]*Math.sin(K)+re[2]*Math.cos(K),R[0]=ie[0]+W[0],R[1]=ie[1]+W[1],R[2]=ie[2]+W[2],R},ge.rotateY=function(R,V,W,K){var re=[],ie=[];return re[0]=V[0]-W[0],re[1]=V[1]-W[1],re[2]=V[2]-W[2],ie[0]=re[2]*Math.sin(K)+re[0]*Math.cos(K),ie[1]=re[1],ie[2]=re[2]*Math.cos(K)-re[0]*Math.sin(K),R[0]=ie[0]+W[0],R[1]=ie[1]+W[1],R[2]=ie[2]+W[2],R},ge.rotateZ=function(R,V,W,K){var re=[],ie=[];return re[0]=V[0]-W[0],re[1]=V[1]-W[1],re[2]=V[2]-W[2],ie[0]=re[0]*Math.cos(K)-re[1]*Math.sin(K),ie[1]=re[0]*Math.sin(K)+re[1]*Math.cos(K),ie[2]=re[2],R[0]=ie[0]+W[0],R[1]=ie[1]+W[1],R[2]=ie[2]+W[2],R},ge.angle=function(R,V){var W=R[0],K=R[1],re=R[2],ie=V[0],Q=V[1],ue=V[2],_e=Math.sqrt(W*W+K*K+re*re)*Math.sqrt(ie*ie+Q*Q+ue*ue),Ee=_e&&P(R,V)/_e;return Math.acos(Math.min(Math.max(Ee,-1),1))},ge.zero=function(R){return R[0]=0,R[1]=0,R[2]=0,R},ge.str=function(R){return"vec3("+R[0]+", "+R[1]+", "+R[2]+")"},ge.exactEquals=function(R,V){return R[0]===V[0]&&R[1]===V[1]&&R[2]===V[2]},ge.equals=function(R,V){var W=R[0],K=R[1],re=R[2],ie=V[0],Q=V[1],ue=V[2];return Math.abs(W-ie)<=n.EPSILON*Math.max(1,Math.abs(W),Math.abs(ie))&&Math.abs(K-Q)<=n.EPSILON*Math.max(1,Math.abs(K),Math.abs(Q))&&Math.abs(re-ue)<=n.EPSILON*Math.max(1,Math.abs(re),Math.abs(ue))},ge.forEach=ge.sqrLen=ge.len=ge.sqrDist=ge.dist=ge.div=ge.mul=ge.sub=void 0;var n=function(R,V){if(R&&R.__esModule)return R;if(R===null||c(R)!=="object"&&typeof R!="function")return{default:R};var W=s(void 0);if(W&&W.has(R))return W.get(R);var K={},re=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var ie in R)if(ie!=="default"&&Object.prototype.hasOwnProperty.call(R,ie)){var Q=re?Object.getOwnPropertyDescriptor(R,ie):null;Q&&(Q.get||Q.set)?Object.defineProperty(K,ie,Q):K[ie]=R[ie]}return K.default=R,W&&W.set(R,K),K}(z());function s(R){if(typeof WeakMap!="function")return null;var V=new WeakMap,W=new WeakMap;return(s=function(K){return K?W:V})(R)}function u(){var R=new n.ARRAY_TYPE(3);return n.ARRAY_TYPE!=Float32Array&&(R[0]=0,R[1]=0,R[2]=0),R}function g(R){return Math.hypot(R[0],R[1],R[2])}function h(R,V,W){return R[0]=V[0]-W[0],R[1]=V[1]-W[1],R[2]=V[2]-W[2],R}function v(R,V,W){return R[0]=V[0]*W[0],R[1]=V[1]*W[1],R[2]=V[2]*W[2],R}function T(R,V,W){return R[0]=V[0]/W[0],R[1]=V[1]/W[1],R[2]=V[2]/W[2],R}function A(R,V){return Math.hypot(V[0]-R[0],V[1]-R[1],V[2]-R[2])}function D(R,V){var W=V[0]-R[0],K=V[1]-R[1],re=V[2]-R[2];return W*W+K*K+re*re}function x(R){var V=R[0],W=R[1],K=R[2];return V*V+W*W+K*K}function P(R,V){return R[0]*V[0]+R[1]*V[1]+R[2]*V[2]}ge.sub=h,ge.mul=v,ge.div=T,ge.dist=A,ge.sqrDist=D,ge.len=g,ge.sqrLen=x;var L,I=(L=u(),function(R,V,W,K,re,ie){var Q,ue;for(V||(V=3),W||(W=0),ue=K?Math.min(K*V+W,R.length):R.length,Q=W;Q<ue;Q+=V)L[0]=R[Q],L[1]=R[Q+1],L[2]=R[Q+2],re(L,L,ie),R[Q]=L[0],R[Q+1]=L[1],R[Q+2]=L[2];return R});return ge.forEach=I,ge}var ke,We,we={};function be(){if(ke)return we;function c(I){return c=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(R){return typeof R}:function(R){return R&&typeof Symbol=="function"&&R.constructor===Symbol&&R!==Symbol.prototype?"symbol":typeof R},c(I)}ke=1,Object.defineProperty(we,"__esModule",{value:!0}),we.create=u,we.clone=function(I){var R=new n.ARRAY_TYPE(4);return R[0]=I[0],R[1]=I[1],R[2]=I[2],R[3]=I[3],R},we.fromValues=function(I,R,V,W){var K=new n.ARRAY_TYPE(4);return K[0]=I,K[1]=R,K[2]=V,K[3]=W,K},we.copy=function(I,R){return I[0]=R[0],I[1]=R[1],I[2]=R[2],I[3]=R[3],I},we.set=function(I,R,V,W,K){return I[0]=R,I[1]=V,I[2]=W,I[3]=K,I},we.add=function(I,R,V){return I[0]=R[0]+V[0],I[1]=R[1]+V[1],I[2]=R[2]+V[2],I[3]=R[3]+V[3],I},we.subtract=g,we.multiply=h,we.divide=v,we.ceil=function(I,R){return I[0]=Math.ceil(R[0]),I[1]=Math.ceil(R[1]),I[2]=Math.ceil(R[2]),I[3]=Math.ceil(R[3]),I},we.floor=function(I,R){return I[0]=Math.floor(R[0]),I[1]=Math.floor(R[1]),I[2]=Math.floor(R[2]),I[3]=Math.floor(R[3]),I},we.min=function(I,R,V){return I[0]=Math.min(R[0],V[0]),I[1]=Math.min(R[1],V[1]),I[2]=Math.min(R[2],V[2]),I[3]=Math.min(R[3],V[3]),I},we.max=function(I,R,V){return I[0]=Math.max(R[0],V[0]),I[1]=Math.max(R[1],V[1]),I[2]=Math.max(R[2],V[2]),I[3]=Math.max(R[3],V[3]),I},we.round=function(I,R){return I[0]=Math.round(R[0]),I[1]=Math.round(R[1]),I[2]=Math.round(R[2]),I[3]=Math.round(R[3]),I},we.scale=function(I,R,V){return I[0]=R[0]*V,I[1]=R[1]*V,I[2]=R[2]*V,I[3]=R[3]*V,I},we.scaleAndAdd=function(I,R,V,W){return I[0]=R[0]+V[0]*W,I[1]=R[1]+V[1]*W,I[2]=R[2]+V[2]*W,I[3]=R[3]+V[3]*W,I},we.distance=T,we.squaredDistance=A,we.length=D,we.squaredLength=x,we.negate=function(I,R){return I[0]=-R[0],I[1]=-R[1],I[2]=-R[2],I[3]=-R[3],I},we.inverse=function(I,R){return I[0]=1/R[0],I[1]=1/R[1],I[2]=1/R[2],I[3]=1/R[3],I},we.normalize=function(I,R){var V=R[0],W=R[1],K=R[2],re=R[3],ie=V*V+W*W+K*K+re*re;return ie>0&&(ie=1/Math.sqrt(ie)),I[0]=V*ie,I[1]=W*ie,I[2]=K*ie,I[3]=re*ie,I},we.dot=function(I,R){return I[0]*R[0]+I[1]*R[1]+I[2]*R[2]+I[3]*R[3]},we.cross=function(I,R,V,W){var K=V[0]*W[1]-V[1]*W[0],re=V[0]*W[2]-V[2]*W[0],ie=V[0]*W[3]-V[3]*W[0],Q=V[1]*W[2]-V[2]*W[1],ue=V[1]*W[3]-V[3]*W[1],_e=V[2]*W[3]-V[3]*W[2],Ee=R[0],Ne=R[1],ze=R[2],De=R[3];return I[0]=Ne*_e-ze*ue+De*Q,I[1]=-Ee*_e+ze*ie-De*re,I[2]=Ee*ue-Ne*ie+De*K,I[3]=-Ee*Q+Ne*re-ze*K,I},we.lerp=function(I,R,V,W){var K=R[0],re=R[1],ie=R[2],Q=R[3];return I[0]=K+W*(V[0]-K),I[1]=re+W*(V[1]-re),I[2]=ie+W*(V[2]-ie),I[3]=Q+W*(V[3]-Q),I},we.random=function(I,R){var V,W,K,re,ie,Q;R=R||1;do ie=(V=2*n.RANDOM()-1)*V+(W=2*n.RANDOM()-1)*W;while(ie>=1);do Q=(K=2*n.RANDOM()-1)*K+(re=2*n.RANDOM()-1)*re;while(Q>=1);var ue=Math.sqrt((1-ie)/Q);return I[0]=R*V,I[1]=R*W,I[2]=R*K*ue,I[3]=R*re*ue,I},we.transformMat4=function(I,R,V){var W=R[0],K=R[1],re=R[2],ie=R[3];return I[0]=V[0]*W+V[4]*K+V[8]*re+V[12]*ie,I[1]=V[1]*W+V[5]*K+V[9]*re+V[13]*ie,I[2]=V[2]*W+V[6]*K+V[10]*re+V[14]*ie,I[3]=V[3]*W+V[7]*K+V[11]*re+V[15]*ie,I},we.transformQuat=function(I,R,V){var W=R[0],K=R[1],re=R[2],ie=V[0],Q=V[1],ue=V[2],_e=V[3],Ee=_e*W+Q*re-ue*K,Ne=_e*K+ue*W-ie*re,ze=_e*re+ie*K-Q*W,De=-ie*W-Q*K-ue*re;return I[0]=Ee*_e+De*-ie+Ne*-ue-ze*-Q,I[1]=Ne*_e+De*-Q+ze*-ie-Ee*-ue,I[2]=ze*_e+De*-ue+Ee*-Q-Ne*-ie,I[3]=R[3],I},we.zero=function(I){return I[0]=0,I[1]=0,I[2]=0,I[3]=0,I},we.str=function(I){return"vec4("+I[0]+", "+I[1]+", "+I[2]+", "+I[3]+")"},we.exactEquals=function(I,R){return I[0]===R[0]&&I[1]===R[1]&&I[2]===R[2]&&I[3]===R[3]},we.equals=function(I,R){var V=I[0],W=I[1],K=I[2],re=I[3],ie=R[0],Q=R[1],ue=R[2],_e=R[3];return Math.abs(V-ie)<=n.EPSILON*Math.max(1,Math.abs(V),Math.abs(ie))&&Math.abs(W-Q)<=n.EPSILON*Math.max(1,Math.abs(W),Math.abs(Q))&&Math.abs(K-ue)<=n.EPSILON*Math.max(1,Math.abs(K),Math.abs(ue))&&Math.abs(re-_e)<=n.EPSILON*Math.max(1,Math.abs(re),Math.abs(_e))},we.forEach=we.sqrLen=we.len=we.sqrDist=we.dist=we.div=we.mul=we.sub=void 0;var n=function(I,R){if(I&&I.__esModule)return I;if(I===null||c(I)!=="object"&&typeof I!="function")return{default:I};var V=s(void 0);if(V&&V.has(I))return V.get(I);var W={},K=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var re in I)if(re!=="default"&&Object.prototype.hasOwnProperty.call(I,re)){var ie=K?Object.getOwnPropertyDescriptor(I,re):null;ie&&(ie.get||ie.set)?Object.defineProperty(W,re,ie):W[re]=I[re]}return W.default=I,V&&V.set(I,W),W}(z());function s(I){if(typeof WeakMap!="function")return null;var R=new WeakMap,V=new WeakMap;return(s=function(W){return W?V:R})(I)}function u(){var I=new n.ARRAY_TYPE(4);return n.ARRAY_TYPE!=Float32Array&&(I[0]=0,I[1]=0,I[2]=0,I[3]=0),I}function g(I,R,V){return I[0]=R[0]-V[0],I[1]=R[1]-V[1],I[2]=R[2]-V[2],I[3]=R[3]-V[3],I}function h(I,R,V){return I[0]=R[0]*V[0],I[1]=R[1]*V[1],I[2]=R[2]*V[2],I[3]=R[3]*V[3],I}function v(I,R,V){return I[0]=R[0]/V[0],I[1]=R[1]/V[1],I[2]=R[2]/V[2],I[3]=R[3]/V[3],I}function T(I,R){return Math.hypot(R[0]-I[0],R[1]-I[1],R[2]-I[2],R[3]-I[3])}function A(I,R){var V=R[0]-I[0],W=R[1]-I[1],K=R[2]-I[2],re=R[3]-I[3];return V*V+W*W+K*K+re*re}function D(I){return Math.hypot(I[0],I[1],I[2],I[3])}function x(I){var R=I[0],V=I[1],W=I[2],K=I[3];return R*R+V*V+W*W+K*K}we.sub=g,we.mul=h,we.div=v,we.dist=T,we.sqrDist=A,we.len=D,we.sqrLen=x;var P,L=(P=u(),function(I,R,V,W,K,re){var ie,Q;for(R||(R=4),V||(V=0),Q=W?Math.min(W*R+V,I.length):I.length,ie=V;ie<Q;ie+=R)P[0]=I[ie],P[1]=I[ie+1],P[2]=I[ie+2],P[3]=I[ie+3],K(P,P,re),I[ie]=P[0],I[ie+1]=P[1],I[ie+2]=P[2],I[ie+3]=P[3];return I});return we.forEach=L,we}function Me(){if(We)return le;function c($e){return c=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(it){return typeof it}:function(it){return it&&typeof Symbol=="function"&&it.constructor===Symbol&&it!==Symbol.prototype?"symbol":typeof it},c($e)}We=1,Object.defineProperty(le,"__esModule",{value:!0}),le.create=T,le.identity=function($e){return $e[0]=0,$e[1]=0,$e[2]=0,$e[3]=1,$e},le.setAxisAngle=A,le.getAxisAngle=function($e,it){var ft=2*Math.acos(it[3]),ut=Math.sin(ft/2);return ut>n.EPSILON?($e[0]=it[0]/ut,$e[1]=it[1]/ut,$e[2]=it[2]/ut):($e[0]=1,$e[1]=0,$e[2]=0),ft},le.getAngle=function($e,it){var ft=V($e,it);return Math.acos(2*ft*ft-1)},le.multiply=D,le.rotateX=function($e,it,ft){ft*=.5;var ut=it[0],mt=it[1],xt=it[2],At=it[3],_t=Math.sin(ft),Zt=Math.cos(ft);return $e[0]=ut*Zt+At*_t,$e[1]=mt*Zt+xt*_t,$e[2]=xt*Zt-mt*_t,$e[3]=At*Zt-ut*_t,$e},le.rotateY=function($e,it,ft){ft*=.5;var ut=it[0],mt=it[1],xt=it[2],At=it[3],_t=Math.sin(ft),Zt=Math.cos(ft);return $e[0]=ut*Zt-xt*_t,$e[1]=mt*Zt+At*_t,$e[2]=xt*Zt+ut*_t,$e[3]=At*Zt-mt*_t,$e},le.rotateZ=function($e,it,ft){ft*=.5;var ut=it[0],mt=it[1],xt=it[2],At=it[3],_t=Math.sin(ft),Zt=Math.cos(ft);return $e[0]=ut*Zt+mt*_t,$e[1]=mt*Zt-ut*_t,$e[2]=xt*Zt+At*_t,$e[3]=At*Zt-xt*_t,$e},le.calculateW=function($e,it){var ft=it[0],ut=it[1],mt=it[2];return $e[0]=ft,$e[1]=ut,$e[2]=mt,$e[3]=Math.sqrt(Math.abs(1-ft*ft-ut*ut-mt*mt)),$e},le.exp=x,le.ln=P,le.pow=function($e,it,ft){return P($e,it),R($e,$e,ft),x($e,$e),$e},le.slerp=L,le.random=function($e){var it=n.RANDOM(),ft=n.RANDOM(),ut=n.RANDOM(),mt=Math.sqrt(1-it),xt=Math.sqrt(it);return $e[0]=mt*Math.sin(2*Math.PI*ft),$e[1]=mt*Math.cos(2*Math.PI*ft),$e[2]=xt*Math.sin(2*Math.PI*ut),$e[3]=xt*Math.cos(2*Math.PI*ut),$e},le.invert=function($e,it){var ft=it[0],ut=it[1],mt=it[2],xt=it[3],At=ft*ft+ut*ut+mt*mt+xt*xt,_t=At?1/At:0;return $e[0]=-ft*_t,$e[1]=-ut*_t,$e[2]=-mt*_t,$e[3]=xt*_t,$e},le.conjugate=function($e,it){return $e[0]=-it[0],$e[1]=-it[1],$e[2]=-it[2],$e[3]=it[3],$e},le.fromMat3=I,le.fromEuler=function($e,it,ft,ut){var mt=.5*Math.PI/180;it*=mt,ft*=mt,ut*=mt;var xt=Math.sin(it),At=Math.cos(it),_t=Math.sin(ft),Zt=Math.cos(ft),hn=Math.sin(ut),Kt=Math.cos(ut);return $e[0]=xt*Zt*Kt-At*_t*hn,$e[1]=At*_t*Kt+xt*Zt*hn,$e[2]=At*Zt*hn-xt*_t*Kt,$e[3]=At*Zt*Kt+xt*_t*hn,$e},le.str=function($e){return"quat("+$e[0]+", "+$e[1]+", "+$e[2]+", "+$e[3]+")"},le.setAxes=le.sqlerp=le.rotationTo=le.equals=le.exactEquals=le.normalize=le.sqrLen=le.squaredLength=le.len=le.length=le.lerp=le.dot=le.scale=le.mul=le.add=le.set=le.copy=le.fromValues=le.clone=void 0;var n=v(z()),s=v(J()),u=v(de()),g=v(be());function h($e){if(typeof WeakMap!="function")return null;var it=new WeakMap,ft=new WeakMap;return(h=function(ut){return ut?ft:it})($e)}function v($e,it){if($e&&$e.__esModule)return $e;if($e===null||c($e)!=="object"&&typeof $e!="function")return{default:$e};var ft=h(it);if(ft&&ft.has($e))return ft.get($e);var ut={},mt=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var xt in $e)if(xt!=="default"&&Object.prototype.hasOwnProperty.call($e,xt)){var At=mt?Object.getOwnPropertyDescriptor($e,xt):null;At&&(At.get||At.set)?Object.defineProperty(ut,xt,At):ut[xt]=$e[xt]}return ut.default=$e,ft&&ft.set($e,ut),ut}function T(){var $e=new n.ARRAY_TYPE(4);return n.ARRAY_TYPE!=Float32Array&&($e[0]=0,$e[1]=0,$e[2]=0),$e[3]=1,$e}function A($e,it,ft){ft*=.5;var ut=Math.sin(ft);return $e[0]=ut*it[0],$e[1]=ut*it[1],$e[2]=ut*it[2],$e[3]=Math.cos(ft),$e}function D($e,it,ft){var ut=it[0],mt=it[1],xt=it[2],At=it[3],_t=ft[0],Zt=ft[1],hn=ft[2],Kt=ft[3];return $e[0]=ut*Kt+At*_t+mt*hn-xt*Zt,$e[1]=mt*Kt+At*Zt+xt*_t-ut*hn,$e[2]=xt*Kt+At*hn+ut*Zt-mt*_t,$e[3]=At*Kt-ut*_t-mt*Zt-xt*hn,$e}function x($e,it){var ft=it[0],ut=it[1],mt=it[2],xt=it[3],At=Math.sqrt(ft*ft+ut*ut+mt*mt),_t=Math.exp(xt),Zt=At>0?_t*Math.sin(At)/At:0;return $e[0]=ft*Zt,$e[1]=ut*Zt,$e[2]=mt*Zt,$e[3]=_t*Math.cos(At),$e}function P($e,it){var ft=it[0],ut=it[1],mt=it[2],xt=it[3],At=Math.sqrt(ft*ft+ut*ut+mt*mt),_t=At>0?Math.atan2(At,xt)/At:0;return $e[0]=ft*_t,$e[1]=ut*_t,$e[2]=mt*_t,$e[3]=.5*Math.log(ft*ft+ut*ut+mt*mt+xt*xt),$e}function L($e,it,ft,ut){var mt,xt,At,_t,Zt,hn=it[0],Kt=it[1],kn=it[2],Mn=it[3],_n=ft[0],mn=ft[1],Zn=ft[2],Rn=ft[3];return(xt=hn*_n+Kt*mn+kn*Zn+Mn*Rn)<0&&(xt=-xt,_n=-_n,mn=-mn,Zn=-Zn,Rn=-Rn),1-xt>n.EPSILON?(mt=Math.acos(xt),At=Math.sin(mt),_t=Math.sin((1-ut)*mt)/At,Zt=Math.sin(ut*mt)/At):(_t=1-ut,Zt=ut),$e[0]=_t*hn+Zt*_n,$e[1]=_t*Kt+Zt*mn,$e[2]=_t*kn+Zt*Zn,$e[3]=_t*Mn+Zt*Rn,$e}function I($e,it){var ft,ut=it[0]+it[4]+it[8];if(ut>0)ft=Math.sqrt(ut+1),$e[3]=.5*ft,$e[0]=(it[5]-it[7])*(ft=.5/ft),$e[1]=(it[6]-it[2])*ft,$e[2]=(it[1]-it[3])*ft;else{var mt=0;it[4]>it[0]&&(mt=1),it[8]>it[3*mt+mt]&&(mt=2);var xt=(mt+1)%3,At=(mt+2)%3;ft=Math.sqrt(it[3*mt+mt]-it[3*xt+xt]-it[3*At+At]+1),$e[mt]=.5*ft,$e[3]=(it[3*xt+At]-it[3*At+xt])*(ft=.5/ft),$e[xt]=(it[3*xt+mt]+it[3*mt+xt])*ft,$e[At]=(it[3*At+mt]+it[3*mt+At])*ft}return $e}le.clone=g.clone,le.fromValues=g.fromValues,le.copy=g.copy,le.set=g.set,le.add=g.add,le.mul=D;var R=g.scale;le.scale=R;var V=g.dot;le.dot=V,le.lerp=g.lerp;var W=g.length;le.length=W,le.len=W;var K=g.squaredLength;le.squaredLength=K,le.sqrLen=K;var re=g.normalize;le.normalize=re,le.exactEquals=g.exactEquals,le.equals=g.equals;var ie,Q,ue,_e=(ie=u.create(),Q=u.fromValues(1,0,0),ue=u.fromValues(0,1,0),function($e,it,ft){var ut=u.dot(it,ft);return ut<-.999999?(u.cross(ie,Q,it),u.len(ie)<1e-6&&u.cross(ie,ue,it),u.normalize(ie,ie),A($e,ie,Math.PI),$e):ut>.999999?($e[0]=0,$e[1]=0,$e[2]=0,$e[3]=1,$e):(u.cross(ie,it,ft),$e[0]=ie[0],$e[1]=ie[1],$e[2]=ie[2],$e[3]=1+ut,re($e,$e))});le.rotationTo=_e;var Ee,Ne,ze=(Ee=T(),Ne=T(),function($e,it,ft,ut,mt,xt){return L(Ee,it,mt,xt),L(Ne,ft,ut,xt),L($e,Ee,Ne,2*xt*(1-xt)),$e});le.sqlerp=ze;var De,ot=(De=s.create(),function($e,it,ft,ut){return De[0]=ft[0],De[3]=ft[1],De[6]=ft[2],De[1]=ut[0],De[4]=ut[1],De[7]=ut[2],De[2]=-it[0],De[5]=-it[1],De[8]=-it[2],re($e,I($e,De))});return le.setAxes=ot,le}var Ae,me={};function Be(){if(Ae)return me;function c(L){return c=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(I){return typeof I}:function(I){return I&&typeof Symbol=="function"&&I.constructor===Symbol&&I!==Symbol.prototype?"symbol":typeof I},c(L)}Ae=1,Object.defineProperty(me,"__esModule",{value:!0}),me.create=function(){var L=new n.ARRAY_TYPE(8);return n.ARRAY_TYPE!=Float32Array&&(L[0]=0,L[1]=0,L[2]=0,L[4]=0,L[5]=0,L[6]=0,L[7]=0),L[3]=1,L},me.clone=function(L){var I=new n.ARRAY_TYPE(8);return I[0]=L[0],I[1]=L[1],I[2]=L[2],I[3]=L[3],I[4]=L[4],I[5]=L[5],I[6]=L[6],I[7]=L[7],I},me.fromValues=function(L,I,R,V,W,K,re,ie){var Q=new n.ARRAY_TYPE(8);return Q[0]=L,Q[1]=I,Q[2]=R,Q[3]=V,Q[4]=W,Q[5]=K,Q[6]=re,Q[7]=ie,Q},me.fromRotationTranslationValues=function(L,I,R,V,W,K,re){var ie=new n.ARRAY_TYPE(8);ie[0]=L,ie[1]=I,ie[2]=R,ie[3]=V;var Q=.5*W,ue=.5*K,_e=.5*re;return ie[4]=Q*V+ue*R-_e*I,ie[5]=ue*V+_e*L-Q*R,ie[6]=_e*V+Q*I-ue*L,ie[7]=-Q*L-ue*I-_e*R,ie},me.fromRotationTranslation=v,me.fromTranslation=function(L,I){return L[0]=0,L[1]=0,L[2]=0,L[3]=1,L[4]=.5*I[0],L[5]=.5*I[1],L[6]=.5*I[2],L[7]=0,L},me.fromRotation=function(L,I){return L[0]=I[0],L[1]=I[1],L[2]=I[2],L[3]=I[3],L[4]=0,L[5]=0,L[6]=0,L[7]=0,L},me.fromMat4=function(L,I){var R=s.create();u.getRotation(R,I);var V=new n.ARRAY_TYPE(3);return u.getTranslation(V,I),v(L,R,V),L},me.copy=T,me.identity=function(L){return L[0]=0,L[1]=0,L[2]=0,L[3]=1,L[4]=0,L[5]=0,L[6]=0,L[7]=0,L},me.set=function(L,I,R,V,W,K,re,ie,Q){return L[0]=I,L[1]=R,L[2]=V,L[3]=W,L[4]=K,L[5]=re,L[6]=ie,L[7]=Q,L},me.getDual=function(L,I){return L[0]=I[4],L[1]=I[5],L[2]=I[6],L[3]=I[7],L},me.setDual=function(L,I){return L[4]=I[0],L[5]=I[1],L[6]=I[2],L[7]=I[3],L},me.getTranslation=function(L,I){var R=I[4],V=I[5],W=I[6],K=I[7],re=-I[0],ie=-I[1],Q=-I[2],ue=I[3];return L[0]=2*(R*ue+K*re+V*Q-W*ie),L[1]=2*(V*ue+K*ie+W*re-R*Q),L[2]=2*(W*ue+K*Q+R*ie-V*re),L},me.translate=function(L,I,R){var V=I[0],W=I[1],K=I[2],re=I[3],ie=.5*R[0],Q=.5*R[1],ue=.5*R[2],_e=I[4],Ee=I[5],Ne=I[6],ze=I[7];return L[0]=V,L[1]=W,L[2]=K,L[3]=re,L[4]=re*ie+W*ue-K*Q+_e,L[5]=re*Q+K*ie-V*ue+Ee,L[6]=re*ue+V*Q-W*ie+Ne,L[7]=-V*ie-W*Q-K*ue+ze,L},me.rotateX=function(L,I,R){var V=-I[0],W=-I[1],K=-I[2],re=I[3],ie=I[4],Q=I[5],ue=I[6],_e=I[7],Ee=ie*re+_e*V+Q*K-ue*W,Ne=Q*re+_e*W+ue*V-ie*K,ze=ue*re+_e*K+ie*W-Q*V,De=_e*re-ie*V-Q*W-ue*K;return s.rotateX(L,I,R),L[4]=Ee*(re=L[3])+De*(V=L[0])+Ne*(K=L[2])-ze*(W=L[1]),L[5]=Ne*re+De*W+ze*V-Ee*K,L[6]=ze*re+De*K+Ee*W-Ne*V,L[7]=De*re-Ee*V-Ne*W-ze*K,L},me.rotateY=function(L,I,R){var V=-I[0],W=-I[1],K=-I[2],re=I[3],ie=I[4],Q=I[5],ue=I[6],_e=I[7],Ee=ie*re+_e*V+Q*K-ue*W,Ne=Q*re+_e*W+ue*V-ie*K,ze=ue*re+_e*K+ie*W-Q*V,De=_e*re-ie*V-Q*W-ue*K;return s.rotateY(L,I,R),L[4]=Ee*(re=L[3])+De*(V=L[0])+Ne*(K=L[2])-ze*(W=L[1]),L[5]=Ne*re+De*W+ze*V-Ee*K,L[6]=ze*re+De*K+Ee*W-Ne*V,L[7]=De*re-Ee*V-Ne*W-ze*K,L},me.rotateZ=function(L,I,R){var V=-I[0],W=-I[1],K=-I[2],re=I[3],ie=I[4],Q=I[5],ue=I[6],_e=I[7],Ee=ie*re+_e*V+Q*K-ue*W,Ne=Q*re+_e*W+ue*V-ie*K,ze=ue*re+_e*K+ie*W-Q*V,De=_e*re-ie*V-Q*W-ue*K;return s.rotateZ(L,I,R),L[4]=Ee*(re=L[3])+De*(V=L[0])+Ne*(K=L[2])-ze*(W=L[1]),L[5]=Ne*re+De*W+ze*V-Ee*K,L[6]=ze*re+De*K+Ee*W-Ne*V,L[7]=De*re-Ee*V-Ne*W-ze*K,L},me.rotateByQuatAppend=function(L,I,R){var V=R[0],W=R[1],K=R[2],re=R[3],ie=I[0],Q=I[1],ue=I[2],_e=I[3];return L[0]=ie*re+_e*V+Q*K-ue*W,L[1]=Q*re+_e*W+ue*V-ie*K,L[2]=ue*re+_e*K+ie*W-Q*V,L[3]=_e*re-ie*V-Q*W-ue*K,L[4]=(ie=I[4])*re+(_e=I[7])*V+(Q=I[5])*K-(ue=I[6])*W,L[5]=Q*re+_e*W+ue*V-ie*K,L[6]=ue*re+_e*K+ie*W-Q*V,L[7]=_e*re-ie*V-Q*W-ue*K,L},me.rotateByQuatPrepend=function(L,I,R){var V=I[0],W=I[1],K=I[2],re=I[3],ie=R[0],Q=R[1],ue=R[2],_e=R[3];return L[0]=V*_e+re*ie+W*ue-K*Q,L[1]=W*_e+re*Q+K*ie-V*ue,L[2]=K*_e+re*ue+V*Q-W*ie,L[3]=re*_e-V*ie-W*Q-K*ue,L[4]=V*(_e=R[7])+re*(ie=R[4])+W*(ue=R[6])-K*(Q=R[5]),L[5]=W*_e+re*Q+K*ie-V*ue,L[6]=K*_e+re*ue+V*Q-W*ie,L[7]=re*_e-V*ie-W*Q-K*ue,L},me.rotateAroundAxis=function(L,I,R,V){if(Math.abs(V)<n.EPSILON)return T(L,I);var W=Math.hypot(R[0],R[1],R[2]);V*=.5;var K=Math.sin(V),re=K*R[0]/W,ie=K*R[1]/W,Q=K*R[2]/W,ue=Math.cos(V),_e=I[0],Ee=I[1],Ne=I[2],ze=I[3];L[0]=_e*ue+ze*re+Ee*Q-Ne*ie,L[1]=Ee*ue+ze*ie+Ne*re-_e*Q,L[2]=Ne*ue+ze*Q+_e*ie-Ee*re,L[3]=ze*ue-_e*re-Ee*ie-Ne*Q;var De=I[4],ot=I[5],$e=I[6],it=I[7];return L[4]=De*ue+it*re+ot*Q-$e*ie,L[5]=ot*ue+it*ie+$e*re-De*Q,L[6]=$e*ue+it*Q+De*ie-ot*re,L[7]=it*ue-De*re-ot*ie-$e*Q,L},me.add=function(L,I,R){return L[0]=I[0]+R[0],L[1]=I[1]+R[1],L[2]=I[2]+R[2],L[3]=I[3]+R[3],L[4]=I[4]+R[4],L[5]=I[5]+R[5],L[6]=I[6]+R[6],L[7]=I[7]+R[7],L},me.multiply=A,me.scale=function(L,I,R){return L[0]=I[0]*R,L[1]=I[1]*R,L[2]=I[2]*R,L[3]=I[3]*R,L[4]=I[4]*R,L[5]=I[5]*R,L[6]=I[6]*R,L[7]=I[7]*R,L},me.lerp=function(L,I,R,V){var W=1-V;return D(I,R)<0&&(V=-V),L[0]=I[0]*W+R[0]*V,L[1]=I[1]*W+R[1]*V,L[2]=I[2]*W+R[2]*V,L[3]=I[3]*W+R[3]*V,L[4]=I[4]*W+R[4]*V,L[5]=I[5]*W+R[5]*V,L[6]=I[6]*W+R[6]*V,L[7]=I[7]*W+R[7]*V,L},me.invert=function(L,I){var R=P(I);return L[0]=-I[0]/R,L[1]=-I[1]/R,L[2]=-I[2]/R,L[3]=I[3]/R,L[4]=-I[4]/R,L[5]=-I[5]/R,L[6]=-I[6]/R,L[7]=I[7]/R,L},me.conjugate=function(L,I){return L[0]=-I[0],L[1]=-I[1],L[2]=-I[2],L[3]=I[3],L[4]=-I[4],L[5]=-I[5],L[6]=-I[6],L[7]=I[7],L},me.normalize=function(L,I){var R=P(I);if(R>0){R=Math.sqrt(R);var V=I[0]/R,W=I[1]/R,K=I[2]/R,re=I[3]/R,ie=I[4],Q=I[5],ue=I[6],_e=I[7],Ee=V*ie+W*Q+K*ue+re*_e;L[0]=V,L[1]=W,L[2]=K,L[3]=re,L[4]=(ie-V*Ee)/R,L[5]=(Q-W*Ee)/R,L[6]=(ue-K*Ee)/R,L[7]=(_e-re*Ee)/R}return L},me.str=function(L){return"quat2("+L[0]+", "+L[1]+", "+L[2]+", "+L[3]+", "+L[4]+", "+L[5]+", "+L[6]+", "+L[7]+")"},me.exactEquals=function(L,I){return L[0]===I[0]&&L[1]===I[1]&&L[2]===I[2]&&L[3]===I[3]&&L[4]===I[4]&&L[5]===I[5]&&L[6]===I[6]&&L[7]===I[7]},me.equals=function(L,I){var R=L[0],V=L[1],W=L[2],K=L[3],re=L[4],ie=L[5],Q=L[6],ue=L[7],_e=I[0],Ee=I[1],Ne=I[2],ze=I[3],De=I[4],ot=I[5],$e=I[6],it=I[7];return Math.abs(R-_e)<=n.EPSILON*Math.max(1,Math.abs(R),Math.abs(_e))&&Math.abs(V-Ee)<=n.EPSILON*Math.max(1,Math.abs(V),Math.abs(Ee))&&Math.abs(W-Ne)<=n.EPSILON*Math.max(1,Math.abs(W),Math.abs(Ne))&&Math.abs(K-ze)<=n.EPSILON*Math.max(1,Math.abs(K),Math.abs(ze))&&Math.abs(re-De)<=n.EPSILON*Math.max(1,Math.abs(re),Math.abs(De))&&Math.abs(ie-ot)<=n.EPSILON*Math.max(1,Math.abs(ie),Math.abs(ot))&&Math.abs(Q-$e)<=n.EPSILON*Math.max(1,Math.abs(Q),Math.abs($e))&&Math.abs(ue-it)<=n.EPSILON*Math.max(1,Math.abs(ue),Math.abs(it))},me.sqrLen=me.squaredLength=me.len=me.length=me.dot=me.mul=me.setReal=me.getReal=void 0;var n=h(z()),s=h(Me()),u=h(fe());function g(L){if(typeof WeakMap!="function")return null;var I=new WeakMap,R=new WeakMap;return(g=function(V){return V?R:I})(L)}function h(L,I){if(L&&L.__esModule)return L;if(L===null||c(L)!=="object"&&typeof L!="function")return{default:L};var R=g(I);if(R&&R.has(L))return R.get(L);var V={},W=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var K in L)if(K!=="default"&&Object.prototype.hasOwnProperty.call(L,K)){var re=W?Object.getOwnPropertyDescriptor(L,K):null;re&&(re.get||re.set)?Object.defineProperty(V,K,re):V[K]=L[K]}return V.default=L,R&&R.set(L,V),V}function v(L,I,R){var V=.5*R[0],W=.5*R[1],K=.5*R[2],re=I[0],ie=I[1],Q=I[2],ue=I[3];return L[0]=re,L[1]=ie,L[2]=Q,L[3]=ue,L[4]=V*ue+W*Q-K*ie,L[5]=W*ue+K*re-V*Q,L[6]=K*ue+V*ie-W*re,L[7]=-V*re-W*ie-K*Q,L}function T(L,I){return L[0]=I[0],L[1]=I[1],L[2]=I[2],L[3]=I[3],L[4]=I[4],L[5]=I[5],L[6]=I[6],L[7]=I[7],L}function A(L,I,R){var V=I[0],W=I[1],K=I[2],re=I[3],ie=R[4],Q=R[5],ue=R[6],_e=R[7],Ee=I[4],Ne=I[5],ze=I[6],De=I[7],ot=R[0],$e=R[1],it=R[2],ft=R[3];return L[0]=V*ft+re*ot+W*it-K*$e,L[1]=W*ft+re*$e+K*ot-V*it,L[2]=K*ft+re*it+V*$e-W*ot,L[3]=re*ft-V*ot-W*$e-K*it,L[4]=V*_e+re*ie+W*ue-K*Q+Ee*ft+De*ot+Ne*it-ze*$e,L[5]=W*_e+re*Q+K*ie-V*ue+Ne*ft+De*$e+ze*ot-Ee*it,L[6]=K*_e+re*ue+V*Q-W*ie+ze*ft+De*it+Ee*$e-Ne*ot,L[7]=re*_e-V*ie-W*Q-K*ue+De*ft-Ee*ot-Ne*$e-ze*it,L}me.getReal=s.copy,me.setReal=s.copy,me.mul=A;var D=s.dot;me.dot=D;var x=s.length;me.length=x,me.len=x;var P=s.squaredLength;return me.squaredLength=P,me.sqrLen=P,me}var Ve,bt,Pe={};function wt(){if(Ve)return Pe;function c(I){return c=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(R){return typeof R}:function(R){return R&&typeof Symbol=="function"&&R.constructor===Symbol&&R!==Symbol.prototype?"symbol":typeof R},c(I)}Ve=1,Object.defineProperty(Pe,"__esModule",{value:!0}),Pe.create=u,Pe.clone=function(I){var R=new n.ARRAY_TYPE(2);return R[0]=I[0],R[1]=I[1],R},Pe.fromValues=function(I,R){var V=new n.ARRAY_TYPE(2);return V[0]=I,V[1]=R,V},Pe.copy=function(I,R){return I[0]=R[0],I[1]=R[1],I},Pe.set=function(I,R,V){return I[0]=R,I[1]=V,I},Pe.add=function(I,R,V){return I[0]=R[0]+V[0],I[1]=R[1]+V[1],I},Pe.subtract=g,Pe.multiply=h,Pe.divide=v,Pe.ceil=function(I,R){return I[0]=Math.ceil(R[0]),I[1]=Math.ceil(R[1]),I},Pe.floor=function(I,R){return I[0]=Math.floor(R[0]),I[1]=Math.floor(R[1]),I},Pe.min=function(I,R,V){return I[0]=Math.min(R[0],V[0]),I[1]=Math.min(R[1],V[1]),I},Pe.max=function(I,R,V){return I[0]=Math.max(R[0],V[0]),I[1]=Math.max(R[1],V[1]),I},Pe.round=function(I,R){return I[0]=Math.round(R[0]),I[1]=Math.round(R[1]),I},Pe.scale=function(I,R,V){return I[0]=R[0]*V,I[1]=R[1]*V,I},Pe.scaleAndAdd=function(I,R,V,W){return I[0]=R[0]+V[0]*W,I[1]=R[1]+V[1]*W,I},Pe.distance=T,Pe.squaredDistance=A,Pe.length=D,Pe.squaredLength=x,Pe.negate=function(I,R){return I[0]=-R[0],I[1]=-R[1],I},Pe.inverse=function(I,R){return I[0]=1/R[0],I[1]=1/R[1],I},Pe.normalize=function(I,R){var V=R[0],W=R[1],K=V*V+W*W;return K>0&&(K=1/Math.sqrt(K)),I[0]=R[0]*K,I[1]=R[1]*K,I},Pe.dot=function(I,R){return I[0]*R[0]+I[1]*R[1]},Pe.cross=function(I,R,V){var W=R[0]*V[1]-R[1]*V[0];return I[0]=I[1]=0,I[2]=W,I},Pe.lerp=function(I,R,V,W){var K=R[0],re=R[1];return I[0]=K+W*(V[0]-K),I[1]=re+W*(V[1]-re),I},Pe.random=function(I,R){R=R||1;var V=2*n.RANDOM()*Math.PI;return I[0]=Math.cos(V)*R,I[1]=Math.sin(V)*R,I},Pe.transformMat2=function(I,R,V){var W=R[0],K=R[1];return I[0]=V[0]*W+V[2]*K,I[1]=V[1]*W+V[3]*K,I},Pe.transformMat2d=function(I,R,V){var W=R[0],K=R[1];return I[0]=V[0]*W+V[2]*K+V[4],I[1]=V[1]*W+V[3]*K+V[5],I},Pe.transformMat3=function(I,R,V){var W=R[0],K=R[1];return I[0]=V[0]*W+V[3]*K+V[6],I[1]=V[1]*W+V[4]*K+V[7],I},Pe.transformMat4=function(I,R,V){var W=R[0],K=R[1];return I[0]=V[0]*W+V[4]*K+V[12],I[1]=V[1]*W+V[5]*K+V[13],I},Pe.rotate=function(I,R,V,W){var K=R[0]-V[0],re=R[1]-V[1],ie=Math.sin(W),Q=Math.cos(W);return I[0]=K*Q-re*ie+V[0],I[1]=K*ie+re*Q+V[1],I},Pe.angle=function(I,R){var V=I[0],W=I[1],K=R[0],re=R[1],ie=Math.sqrt(V*V+W*W)*Math.sqrt(K*K+re*re);return Math.acos(Math.min(Math.max(ie&&(V*K+W*re)/ie,-1),1))},Pe.zero=function(I){return I[0]=0,I[1]=0,I},Pe.str=function(I){return"vec2("+I[0]+", "+I[1]+")"},Pe.exactEquals=function(I,R){return I[0]===R[0]&&I[1]===R[1]},Pe.equals=function(I,R){var V=I[0],W=I[1],K=R[0],re=R[1];return Math.abs(V-K)<=n.EPSILON*Math.max(1,Math.abs(V),Math.abs(K))&&Math.abs(W-re)<=n.EPSILON*Math.max(1,Math.abs(W),Math.abs(re))},Pe.forEach=Pe.sqrLen=Pe.sqrDist=Pe.dist=Pe.div=Pe.mul=Pe.sub=Pe.len=void 0;var n=function(I,R){if(I&&I.__esModule)return I;if(I===null||c(I)!=="object"&&typeof I!="function")return{default:I};var V=s(void 0);if(V&&V.has(I))return V.get(I);var W={},K=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var re in I)if(re!=="default"&&Object.prototype.hasOwnProperty.call(I,re)){var ie=K?Object.getOwnPropertyDescriptor(I,re):null;ie&&(ie.get||ie.set)?Object.defineProperty(W,re,ie):W[re]=I[re]}return W.default=I,V&&V.set(I,W),W}(z());function s(I){if(typeof WeakMap!="function")return null;var R=new WeakMap,V=new WeakMap;return(s=function(W){return W?V:R})(I)}function u(){var I=new n.ARRAY_TYPE(2);return n.ARRAY_TYPE!=Float32Array&&(I[0]=0,I[1]=0),I}function g(I,R,V){return I[0]=R[0]-V[0],I[1]=R[1]-V[1],I}function h(I,R,V){return I[0]=R[0]*V[0],I[1]=R[1]*V[1],I}function v(I,R,V){return I[0]=R[0]/V[0],I[1]=R[1]/V[1],I}function T(I,R){return Math.hypot(R[0]-I[0],R[1]-I[1])}function A(I,R){var V=R[0]-I[0],W=R[1]-I[1];return V*V+W*W}function D(I){return Math.hypot(I[0],I[1])}function x(I){var R=I[0],V=I[1];return R*R+V*V}Pe.len=D,Pe.sub=g,Pe.mul=h,Pe.div=v,Pe.dist=T,Pe.sqrDist=A,Pe.sqrLen=x;var P,L=(P=u(),function(I,R,V,W,K,re){var ie,Q;for(R||(R=2),V||(V=0),Q=W?Math.min(W*R+V,I.length):I.length,ie=V;ie<Q;ie+=R)P[0]=I[ie],P[1]=I[ie+1],K(P,P,re),I[ie]=P[0],I[ie+1]=P[1];return I});return Pe.forEach=L,Pe}function Mt(){if(bt)return M;function c(I){return c=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(R){return typeof R}:function(R){return R&&typeof Symbol=="function"&&R.constructor===Symbol&&R!==Symbol.prototype?"symbol":typeof R},c(I)}bt=1,Object.defineProperty(M,"__esModule",{value:!0}),M.vec4=M.vec3=M.vec2=M.quat2=M.quat=M.mat4=M.mat3=M.mat2d=M.mat2=M.glMatrix=void 0;var n=L(z());M.glMatrix=n;var s=L(N());M.mat2=s;var u=L(te());M.mat2d=u;var g=L(J());M.mat3=g;var h=L(fe());M.mat4=h;var v=L(Me());M.quat=v;var T=L(Be());M.quat2=T;var A=L(wt());M.vec2=A;var D=L(de());M.vec3=D;var x=L(be());function P(I){if(typeof WeakMap!="function")return null;var R=new WeakMap,V=new WeakMap;return(P=function(W){return W?V:R})(I)}function L(I,R){if(I&&I.__esModule)return I;if(I===null||c(I)!=="object"&&typeof I!="function")return{default:I};var V=P(R);if(V&&V.has(I))return V.get(I);var W={},K=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var re in I)if(re!=="default"&&Object.prototype.hasOwnProperty.call(I,re)){var ie=K?Object.getOwnPropertyDescriptor(I,re):null;ie&&(ie.get||ie.set)?Object.defineProperty(W,re,ie):W[re]=I[re]}return W.default=I,V&&V.set(I,W),W}return M.vec4=x,M}var Nt,vt,Bt,Wt,Fe=Mt(),cn=function(){if(vt)return Nt;function c(n,s,u,g){this.cx=3*n,this.bx=3*(u-n)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*s,this.by=3*(g-s)-this.cy,this.ay=1-this.cy-this.by,this.p1x=n,this.p1y=s,this.p2x=u,this.p2y=g}return vt=1,Nt=c,c.prototype={sampleCurveX:function(n){return((this.ax*n+this.bx)*n+this.cx)*n},sampleCurveY:function(n){return((this.ay*n+this.by)*n+this.cy)*n},sampleCurveDerivativeX:function(n){return(3*this.ax*n+2*this.bx)*n+this.cx},solveCurveX:function(n,s){if(s===void 0&&(s=1e-6),n<0)return 0;if(n>1)return 1;for(var u=n,g=0;g<8;g++){var h=this.sampleCurveX(u)-n;if(Math.abs(h)<s)return u;var v=this.sampleCurveDerivativeX(u);if(Math.abs(v)<1e-6)break;u-=h/v}var T=0,A=1;for(u=n,g=0;g<20&&(h=this.sampleCurveX(u),!(Math.abs(h-n)<s));g++)n>h?T=u:A=u,u=.5*(A-T)+T;return u},solve:function(n,s){return this.sampleCurveY(this.solveCurveX(n,s))}},Nt}(),Re=S(cn);function nt(){if(Wt)return Bt;function c(n,s){this.x=n,this.y=s}return Wt=1,Bt=c,c.prototype={clone:function(){return new c(this.x,this.y)},add:function(n){return this.clone()._add(n)},sub:function(n){return this.clone()._sub(n)},multByPoint:function(n){return this.clone()._multByPoint(n)},divByPoint:function(n){return this.clone()._divByPoint(n)},mult:function(n){return this.clone()._mult(n)},div:function(n){return this.clone()._div(n)},rotate:function(n){return this.clone()._rotate(n)},rotateAround:function(n,s){return this.clone()._rotateAround(n,s)},matMult:function(n){return this.clone()._matMult(n)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(n){return this.x===n.x&&this.y===n.y},dist:function(n){return Math.sqrt(this.distSqr(n))},distSqr:function(n){var s=n.x-this.x,u=n.y-this.y;return s*s+u*u},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(n){return Math.atan2(this.y-n.y,this.x-n.x)},angleWith:function(n){return this.angleWithSep(n.x,n.y)},angleWithSep:function(n,s){return Math.atan2(this.x*s-this.y*n,this.x*n+this.y*s)},_matMult:function(n){var s=n[2]*this.x+n[3]*this.y;return this.x=n[0]*this.x+n[1]*this.y,this.y=s,this},_add:function(n){return this.x+=n.x,this.y+=n.y,this},_sub:function(n){return this.x-=n.x,this.y-=n.y,this},_mult:function(n){return this.x*=n,this.y*=n,this},_div:function(n){return this.x/=n,this.y/=n,this},_multByPoint:function(n){return this.x*=n.x,this.y*=n.y,this},_divByPoint:function(n){return this.x/=n.x,this.y/=n.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var n=this.y;return this.y=this.x,this.x=-n,this},_rotate:function(n){var s=Math.cos(n),u=Math.sin(n),g=u*this.x+s*this.y;return this.x=s*this.x-u*this.y,this.y=g,this},_rotateAround:function(n,s){var u=Math.cos(n),g=Math.sin(n),h=s.y+g*(this.x-s.x)+u*(this.y-s.y);return this.x=s.x+u*(this.x-s.x)-g*(this.y-s.y),this.y=h,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},c.convert=function(n){return n instanceof c?n:Array.isArray(n)?new c(n[0],n[1]):n},Bt}var Qe=S(nt());function Yt(c,n){if(Array.isArray(c)){if(!Array.isArray(n)||c.length!==n.length)return!1;for(let s=0;s<c.length;s++)if(!Yt(c[s],n[s]))return!1;return!0}if(typeof c=="object"&&c!==null&&n!==null){if(typeof n!="object"||Object.keys(c).length!==Object.keys(n).length)return!1;for(const s in c)if(!Yt(c[s],n[s]))return!1;return!0}return c===n}const Xt=Math.PI/180,$t=180/Math.PI;function Ot(c){return c*Xt}function Ft(c){return c*$t}const sn=[[0,0],[1,0],[1,1],[0,1]];function an(c){if(c<=0)return 0;if(c>=1)return 1;const n=c*c,s=n*c;return 4*(c<.5?s:3*(c-n)+s-.75)}function Pn(c,n,s,u){const g=new Re(c,n,s,u);return function(h){return g.solve(h)}}const bn=Pn(.25,.1,.25,1);function It(c,n,s){return Math.min(s,Math.max(n,c))}function Sn(c,n,s){return(s=It((s-c)/(n-c),0,1))*s*(3-2*s)}function Yn(c,n,s){const u=s-n,g=((c-n)%u+u)%u+n;return g===n?s:g}function vr(c,n,s){if(!c.length)return s(null,[]);let u=c.length;const g=new Array(c.length);let h=null;c.forEach((v,T)=>{n(v,(A,D)=>{A&&(h=A),g[T]=D,--u==0&&s(h,g)})})}function tr(c,...n){for(const s of n)for(const u in s)c[u]=s[u];return c}let zr=1;function Cr(){return zr++}function Io(c){return c<=1?1:Math.pow(2,Math.ceil(Math.log(c)/Math.LN2))}function jn(c,n){c.forEach(s=>{n[s]&&(n[s]=n[s].bind(n))})}function Gt(c,n){return c.indexOf(n,c.length-n.length)!==-1}function ct(c,n,s){const u={};for(const g in c)u[g]=n.call(this,c[g],g,c);return u}function Ut(c,n,s){const u={};for(const g in c)n.call(this,c[g],g,c)&&(u[g]=c[g]);return u}function tt(c){return Array.isArray(c)?c.map(tt):typeof c=="object"&&c?ct(c,tt):c}const yn={};function wn(c){yn[c]||(typeof console<"u"&&console.warn(c),yn[c]=!0)}function sr(c,n,s){return(s.y-c.y)*(n.x-c.x)>(n.y-c.y)*(s.x-c.x)}function vo(c){let n=0;for(let s,u,g=0,h=c.length,v=h-1;g<h;v=g++)s=c[g],u=c[v],n+=(u.x-s.x)*(s.y+u.y);return n}function jo([c,n,s]){const u=Ot(n+90),g=Ot(s);return{x:c*Math.cos(u)*Math.sin(g),y:c*Math.sin(u)*Math.sin(g),z:c*Math.cos(g),azimuthal:n,polar:s}}function Go(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function bo(c){const n={};if(c.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(s,u,g,h)=>{const v=g||h;return n[u]=!v||v.toLowerCase(),""}),n["max-age"]){const s=parseInt(n["max-age"],10);isNaN(s)?delete n["max-age"]:n["max-age"]=s}return n}let oi=null;function mo(c,n){return[c[4*n],c[4*n+1],c[4*n+2],c[4*n+3]]}function Fi(c,n,s,u){for(;n<s;){const g=n+s>>1;c[g]<u?n=g+1:s=g}return n}function Gs(c,n,s,u){for(;n<s;){const g=n+s>>1;c[g]<=u?n=g+1:s=g}return n}function kl(c){return c>0?1/(1.001-c):1+c}function ga(c){return c>0?1-1/(1.001-c):-c}const Jo={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){if(!Jo.API_URL)return null;try{const c=new URL(Jo.API_URL);return c.hostname==="api.mapbox.cn"?"https://events.mapbox.cn/events/v2":c.hostname==="api.mapbox.com"?"https://events.mapbox.com/events/v2":null}catch{return null}},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",RASTERARRAYS_URL_PREFIX:"rasterarrays/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,DEFAULT_STYLE:"mapbox://styles/mapbox/standard",MAX_PARALLEL_IMAGE_REQUESTS:16,DRACO_URL:"https://api.mapbox.com/mapbox-gl-js/draco_decoder_gltf_v1.5.6.wasm",MESHOPT_URL:"https://api.mapbox.com/mapbox-gl-js/meshopt_base_v0.20.wasm",MESHOPT_SIMD_URL:"https://api.mapbox.com/mapbox-gl-js/meshopt_simd_v0.20.wasm",GLYPHS_URL:"mapbox://fonts/mapbox/{fontstack}/{range}.pbf",TILES3D_URL_PREFIX:"3dtiles/v1"};function va(c){return Jo.API_URL_REGEX.test(c)}function vc(c){return Jo.API_SPRITE_REGEX.test(c)}let Qa,Ci,Ps,zt,ye,he;function Ie(){return Qa==null&&(Qa=self.OffscreenCanvas&&new OffscreenCanvas(1,1).getContext("2d")&&typeof self.createImageBitmap=="function"),Qa}const je={now:()=>zt!==void 0?zt:performance.now(),setNow(c){zt=c},restoreNow(){zt=void 0},frame(c){const n=requestAnimationFrame(c);return{cancel:()=>cancelAnimationFrame(n)}},getImageData(c,n=0){const{width:s,height:u}=c;ye||(ye=document.createElement("canvas"));const g=ye.getContext("2d",{willReadFrequently:!0});if(!g)throw new Error("failed to create canvas 2d context");return(s>ye.width||u>ye.height)&&(ye.width=s,ye.height=u),g.clearRect(-n,-n,s+2*n,u+2*n),g.drawImage(c,0,0,s,u),g.getImageData(-n,-n,s+2*n,u+2*n)},resolveURL:c=>(Ci||(Ci=document.createElement("a")),Ci.href=c,Ci.href),get devicePixelRatio(){return window.devicePixelRatio},get prefersReducedMotion(){return!!window.matchMedia&&(Ps==null&&(Ps=window.matchMedia("(prefers-reduced-motion: reduce)")),Ps.matches)},hasCanvasFingerprintNoise(){if(he!==void 0)return he;if(!Ie())return he=!1,!1;const c=new OffscreenCanvas(85,1),n=c.getContext("2d",{willReadFrequently:!0});let s=0;for(let g=0;g<c.width;++g)n.fillStyle=`rgba(${s++},${s++},${s++}, 255)`,n.fillRect(g,0,1,1);const u=n.getImageData(0,0,c.width,c.height);s=0;for(let g=0;g<u.data.length;++g)if(g%4!=3&&s++!==u.data[g])return he=!0,!0;return he=!1,!1}};function Je(c,n){const s=c.indexOf("?");if(s<0)return`${c}?${new URLSearchParams(n).toString()}`;const u=new URLSearchParams(c.slice(s));for(const g in n)u.set(g,n[g]);return`${c.slice(0,s)}?${u.toString()}`}function lt(c,n={persistentParams:[]}){const s=c.indexOf("?");if(s<0)return c;const u=new URLSearchParams,g=new URLSearchParams(c.slice(s));for(const v of n.persistentParams){const T=g.get(v);T&&u.set(v,T)}const h=u.toString();return`${c.slice(0,s)}${h.length>0?`?${h}`:""}`}const St="mapbox-tiles";let ht=500,Dt=50;const Pt=["language","worldview","jobid"];let Ke,Ct;function Qt(){try{return caches}catch{}}function on(){const c=Qt();c&&Ke==null&&(Ke=c.open(St))}let Wn=1/0;const er={supported:!1,testSupport:function(c){!$r&&rr&&(Kr?Zr(c):ar=c)}};let ar,rr,$r=!1,Kr=!1;const Pr=typeof self<"u"?self:{};function Zr(c){const n=c.createTexture();c.bindTexture(c.TEXTURE_2D,n);try{if(c.texImage2D(c.TEXTURE_2D,0,c.RGBA,c.RGBA,c.UNSIGNED_BYTE,rr),c.isContextLost())return;er.supported=!0}catch{}c.deleteTexture(n),$r=!0}Pr.document&&(rr=Pr.document.createElement("img"),rr.onload=function(){ar&&Zr(ar),ar=null,Kr=!0},rr.onerror=function(){$r=!0,ar=null},rr.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const Jr={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Iconset:"Iconset",Image:"Image",Model:"Model"};typeof Object.freeze=="function"&&Object.freeze(Jr);class fi extends Error{constructor(n,s,u){s===401&&va(u)&&(n+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(n),this.status=s,this.url=u}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const el=Go()?()=>self.worker&&self.worker.referrer:()=>(location.protocol==="blob:"?parent:self).location.href,Ei=function(c,n){if(!(/^file:/.test(s=c.url)||/^file:/.test(el())&&!/^\w+:/.test(s))){if(self.fetch&&self.Request&&self.AbortController&&Request.prototype.hasOwnProperty("signal"))return function(u,g){const h=new AbortController,v=new Request(u.url,{method:u.method||"GET",body:u.body,credentials:u.credentials,headers:u.headers,referrer:el(),referrerPolicy:u.referrerPolicy,signal:h.signal});let T=!1,A=!1;const D=(x=v.url).indexOf("sku=")>0&&va(x);var x;u.type==="json"&&v.headers.set("Accept","application/json");const P=(I,R,V)=>{if(A)return;if(I&&I.message!=="SecurityError"&&wn(I.toString()),R&&V)return L(R);const W=Date.now();fetch(v).then(K=>{if(K.ok){const re=D?K.clone():null;return L(K,re,W)}return g(new fi(K.statusText,K.status,u.url))}).catch(K=>{K.name!=="AbortError"&&g(new Error(`${K.message} ${u.url}`))})},L=(I,R,V)=>{(u.type==="arrayBuffer"?I.arrayBuffer():u.type==="json"?I.json():I.text()).then(W=>{A||(R&&V&&function(K,re,ie){if(on(),Ke==null)return;const Q=bo(re.headers.get("Cache-Control")||"");if(Q["no-store"])return;const ue={status:re.status,statusText:re.statusText,headers:new Headers};re.headers.forEach((Ne,ze)=>ue.headers.set(ze,Ne)),Q["max-age"]&&ue.headers.set("Expires",new Date(ie+1e3*Q["max-age"]).toUTCString());const _e=ue.headers.get("Expires");if(!_e||new Date(_e).getTime()-ie<42e4)return;let Ee=lt(K.url,{persistentParams:Pt});if(re.status===206){const Ne=K.headers.get("Range");if(!Ne)return;ue.status=200,Ee=Je(Ee,{range:Ne})}(function(Ne,ze){if(Ct===void 0)try{new Response(new ReadableStream),Ct=!0}catch{Ct=!1}Ct?ze(Ne.body):Ne.blob().then(ze)})(re,Ne=>{const ze=new Response((De=re.status)!==200&&De!==404&&[101,103,204,205,304].includes(De)?null:Ne,ue);var De;on(),Ke!=null&&Ke.then(ot=>ot.put(Ee,ze)).catch(ot=>wn(ot.message))})}(v,R,V),T=!0,g(null,W,I.headers.get("Cache-Control"),I.headers.get("Expires")))}).catch(W=>{A||g(new Error(W.message))})};return D?function(I,R){if(on(),Ke==null)return R(null);Ke.then(V=>{let W=lt(I.url,{persistentParams:Pt});const K=I.headers.get("Range");K&&(W=Je(W,{range:K})),V.match(W).then(re=>{const ie=function(Q){if(!Q)return!1;const ue=new Date(Q.headers.get("Expires")||0),_e=bo(Q.headers.get("Cache-Control")||"");return ue>Date.now()&&!_e["no-cache"]}(re);V.delete(W),ie&&V.put(W,re.clone()),R(null,re,ie)}).catch(R)}).catch(R)}(v,P):P(null,null),{cancel:()=>{A=!0,T||h.abort()}}}(c,n);if(Go()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",c,n,void 0,!0)}var s;return function(u,g){const h=new XMLHttpRequest;h.open(u.method||"GET",u.url,!0),u.type==="arrayBuffer"&&(h.responseType="arraybuffer");for(const v in u.headers)h.setRequestHeader(v,u.headers[v]);return u.type==="json"&&(h.responseType="text",h.setRequestHeader("Accept","application/json")),h.withCredentials=u.credentials==="include",h.onerror=()=>{g(new Error(h.statusText))},h.onload=()=>{if((h.status>=200&&h.status<300||h.status===0)&&h.response!==null){let v=h.response;if(u.type==="json")try{v=JSON.parse(h.response)}catch(T){return g(T)}g(null,v,h.getResponseHeader("Cache-Control"),h.getResponseHeader("Expires"))}else g(new fi(h.statusText,h.status,u.url))},h.send(u.body),{cancel:()=>h.abort()}}(c,n)},ki=function(c,n){return Ei(tr(c,{type:"arrayBuffer"}),n)};function us(c){const n=document.createElement("a");return n.href=c,n.protocol===location.protocol&&n.host===location.host}const sh="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let Pl,ah;Pl=[],ah=0;const sg=function(c,n){if(er.supported&&(c.headers||(c.headers={}),c.headers.accept="image/webp,*/*"),ah>=Jo.MAX_PARALLEL_IMAGE_REQUESTS){const h={requestParameters:c,callback:n,cancelled:!1,cancel(){this.cancelled=!0}};return Pl.push(h),h}ah++;let s=!1;const u=()=>{if(!s)for(s=!0,ah--;Pl.length&&ah<Jo.MAX_PARALLEL_IMAGE_REQUESTS;){const h=Pl.shift(),{requestParameters:v,callback:T,cancelled:A}=h;A||(h.cancel=sg(v,T).cancel)}},g=ki(c,(h,v,T,A)=>{u(),h?n(h):v&&(self.createImageBitmap?function(D,x){const P=new Blob([new Uint8Array(D)],{type:"image/png"});createImageBitmap(P).then(L=>{x(null,L)}).catch(L=>{x(new Error(`Could not load image because of ${L.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(v,(D,x)=>n(D,x,T,A)):function(D,x){const P=new Image;P.onload=()=>{x(null,P),URL.revokeObjectURL(P.src),P.onload=null,requestAnimationFrame(()=>{P.src=sh})},P.onerror=()=>x(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const L=new Blob([new Uint8Array(D)],{type:"image/png"});P.src=D.byteLength?URL.createObjectURL(L):sh}(v,(D,x)=>n(D,x,T,A)))});return{cancel:()=>{g.cancel(),u()}}};var Dy,ag,lg,ds={exports:{}},Oa={exports:{}},Rl={exports:{}},tl=function(){if(lg)return ds.exports;lg=1;var c=(Dy||(Dy=1,Oa.exports=function(s,u){var g,h,v,T,A,D,x,P;for(h=s.length-(g=3&s.length),v=u,A=3432918353,D=461845907,P=0;P<h;)x=255&s.charCodeAt(P)|(255&s.charCodeAt(++P))<<8|(255&s.charCodeAt(++P))<<16|(255&s.charCodeAt(++P))<<24,++P,v=27492+(65535&(T=5*(65535&(v=(v^=x=(65535&(x=(x=(65535&x)*A+(((x>>>16)*A&65535)<<16)&4294967295)<<15|x>>>17))*D+(((x>>>16)*D&65535)<<16)&4294967295)<<13|v>>>19))+((5*(v>>>16)&65535)<<16)&4294967295))+((58964+(T>>>16)&65535)<<16);switch(x=0,g){case 3:x^=(255&s.charCodeAt(P+2))<<16;case 2:x^=(255&s.charCodeAt(P+1))<<8;case 1:v^=x=(65535&(x=(x=(65535&(x^=255&s.charCodeAt(P)))*A+(((x>>>16)*A&65535)<<16)&4294967295)<<15|x>>>17))*D+(((x>>>16)*D&65535)<<16)&4294967295}return v^=s.length,v=2246822507*(65535&(v^=v>>>16))+((2246822507*(v>>>16)&65535)<<16)&4294967295,v=3266489909*(65535&(v^=v>>>13))+((3266489909*(v>>>16)&65535)<<16)&4294967295,(v^=v>>>16)>>>0}),Oa.exports),n=(ag||(ag=1,Rl.exports=function(s,u){for(var g,h=s.length,v=u^h,T=0;h>=4;)g=1540483477*(65535&(g=255&s.charCodeAt(T)|(255&s.charCodeAt(++T))<<8|(255&s.charCodeAt(++T))<<16|(255&s.charCodeAt(++T))<<24))+((1540483477*(g>>>16)&65535)<<16),v=1540483477*(65535&v)+((1540483477*(v>>>16)&65535)<<16)^(g=1540483477*(65535&(g^=g>>>24))+((1540483477*(g>>>16)&65535)<<16)),h-=4,++T;switch(h){case 3:v^=(255&s.charCodeAt(T+2))<<16;case 2:v^=(255&s.charCodeAt(T+1))<<8;case 1:v=1540483477*(65535&(v^=255&s.charCodeAt(T)))+((1540483477*(v>>>16)&65535)<<16)}return v=1540483477*(65535&(v^=v>>>13))+((1540483477*(v>>>16)&65535)<<16),(v^=v>>>15)>>>0}),Rl.exports);return ds.exports=c,ds.exports.murmur3=c,ds.exports.murmur2=n,ds.exports}(),La=S(tl);class nl{constructor(n,...s){tr(this,s[0]||{}),this.type=n}}class Hf extends nl{constructor(n,s={}){super("error",tr({error:n},s))}}function cg(c,n,s){s[c]&&s[c].indexOf(n)!==-1||(s[c]=s[c]||[],s[c].push(n))}function _c(c,n,s){if(s&&s[c]){const u=s[c].indexOf(n);u!==-1&&s[c].splice(u,1)}}class yc{on(n,s){return this._listeners=this._listeners||{},cg(n,s,this._listeners),this}off(n,s){return _c(n,s,this._listeners),_c(n,s,this._oneTimeListeners),this}once(n,s){return s?(this._oneTimeListeners=this._oneTimeListeners||{},cg(n,s,this._oneTimeListeners),this):new Promise(u=>this.once(n,u))}fire(n,s){const u=typeof n=="string"?new nl(n,s):n,g=u.type;if(this.listens(g)){u.target=this;const h=this._listeners&&this._listeners[g]?this._listeners[g].slice():[];for(const A of h)A.call(this,u);const v=this._oneTimeListeners&&this._oneTimeListeners[g]?this._oneTimeListeners[g].slice():[];for(const A of v)_c(g,A,this._oneTimeListeners),A.call(this,u);const T=this._eventedParent;T&&(tr(u,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),T.fire(u))}else u instanceof Hf&&console.error(u.error);return this}listens(n){return!!(this._listeners&&this._listeners[n]&&this._listeners[n].length>0||this._oneTimeListeners&&this._oneTimeListeners[n]&&this._oneTimeListeners[n].length>0||this._eventedParent&&this._eventedParent.listens(n))}setEventedParent(n,s){return this._eventedParent=n,this._eventedParentData=s,this}}var zy,ug={},_a=function(){if(zy)return ug;zy=1;var c={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function n(h){return(h=Math.round(h))<0?0:h>255?255:h}function s(h){return n(h[h.length-1]==="%"?parseFloat(h)/100*255:parseInt(h))}function u(h){return(v=h[h.length-1]==="%"?parseFloat(h)/100:parseFloat(h))<0?0:v>1?1:v;var v}function g(h,v,T){return T<0?T+=1:T>1&&(T-=1),6*T<1?h+(v-h)*T*6:2*T<1?v:3*T<2?h+(v-h)*(2/3-T)*6:h}try{ug.parseCSSColor=function(h){var v,T=h.replace(/ /g,"").toLowerCase();if(T in c)return c[T].slice();if(T[0]==="#")return T.length===4?(v=parseInt(T.substr(1),16))>=0&&v<=4095?[(3840&v)>>4|(3840&v)>>8,240&v|(240&v)>>4,15&v|(15&v)<<4,1]:null:T.length===7&&(v=parseInt(T.substr(1),16))>=0&&v<=16777215?[(16711680&v)>>16,(65280&v)>>8,255&v,1]:null;var A=T.indexOf("("),D=T.indexOf(")");if(A!==-1&&D+1===T.length){var x=T.substr(0,A),P=T.substr(A+1,D-(A+1)).split(","),L=1;switch(x){case"rgba":if(P.length!==4)return null;L=u(P.pop());case"rgb":return P.length!==3?null:[s(P[0]),s(P[1]),s(P[2]),L];case"hsla":if(P.length!==4)return null;L=u(P.pop());case"hsl":if(P.length!==3)return null;var I=(parseFloat(P[0])%360+360)%360/360,R=u(P[1]),V=u(P[2]),W=V<=.5?V*(R+1):V+R-V*R,K=2*V-W;return[n(255*g(K,W,I+1/3)),n(255*g(K,W,I)),n(255*g(K,W,I-1/3)),L];default:return null}}return null}}catch{}return ug}();class io{constructor(n,s,u,g=1){this.r=n,this.g=s,this.b=u,this.a=g}static parse(n){if(!n)return;if(n instanceof io)return n;if(typeof n!="string")return;const s=_a.parseCSSColor(n);return s?new io(s[0]/255*s[3],s[1]/255*s[3],s[2]/255*s[3],s[3]):void 0}toStringPremultipliedAlpha(){const[n,s,u,g]=this.a===0?[0,0,0,0]:[255*this.r/this.a,255*this.g/this.a,255*this.b/this.a,this.a];return`rgba(${Math.round(n)},${Math.round(s)},${Math.round(u)},${g})`}toString(){const[n,s,u,g]=[this.r,this.g,this.b,this.a];return`rgba(${Math.round(255*n)},${Math.round(255*s)},${Math.round(255*u)},${g})`}toRenderColor(n){const{r:s,g:u,b:g,a:h}=this;return new dg(n,s,u,g,h)}clone(){return new io(this.r,this.g,this.b,this.a)}}class dg{constructor(n,s,u,g,h){if(n){const v=n.image.height,T=v*v;s=h===0?0:s/h*(v-1),u=h===0?0:u/h*(v-1),g=h===0?0:g/h*(v-1);const A=Math.floor(s),D=Math.floor(u),x=Math.floor(g),P=Math.ceil(s),L=Math.ceil(u),I=Math.ceil(g),R=s-A,V=u-D,W=g-x,K=n.image.data,re=4*(A+D*T+x*v),ie=4*(A+D*T+I*v),Q=4*(A+L*T+x*v),ue=4*(A+L*T+I*v),_e=4*(P+D*T+x*v),Ee=4*(P+D*T+I*v),Ne=4*(P+L*T+x*v),ze=4*(P+L*T+I*v);if(re<0||ze>=K.length)throw new Error("out of range");this.r=cr(cr(cr(K[re],K[ie],W),cr(K[Q],K[ue],W),V),cr(cr(K[_e],K[Ee],W),cr(K[Ne],K[ze],W),V),R)/255*h,this.g=cr(cr(cr(K[re+1],K[ie+1],W),cr(K[Q+1],K[ue+1],W),V),cr(cr(K[_e+1],K[Ee+1],W),cr(K[Ne+1],K[ze+1],W),V),R)/255*h,this.b=cr(cr(cr(K[re+2],K[ie+2],W),cr(K[Q+2],K[ue+2],W),V),cr(cr(K[_e+2],K[Ee+2],W),cr(K[Ne+2],K[ze+2],W),V),R)/255*h,this.a=h}else this.r=s,this.g=u,this.b=g,this.a=h}toArray(){const{r:n,g:s,b:u,a:g}=this;return g===0?[0,0,0,0]:[255*n/g,255*s/g,255*u/g,g]}toHslaArray(){if(this.a===0)return[0,0,0,0];const{r:n,g:s,b:u,a:g}=this,h=Math.min(Math.max(n/g,0),1),v=Math.min(Math.max(s/g,0),1),T=Math.min(Math.max(u/g,0),1),A=Math.min(h,v,T),D=Math.max(h,v,T),x=(A+D)/2;if(A===D)return[0,0,100*x,g];const P=D-A,L=x>.5?P/(2-D-A):P/(D+A);let I=0;return D===h?I=(v-T)/P+(v<T?6:0):D===v?I=(T-h)/P+2:D===T&&(I=(h-v)/P+4),I*=60,[Math.min(Math.max(I,0),360),Math.min(Math.max(100*L,0),100),Math.min(Math.max(100*x,0),100),g]}toArray01(){const{r:n,g:s,b:u,a:g}=this;return g===0?[0,0,0,0]:[n/g,s/g,u/g,g]}toArray01Scaled(n){const{r:s,g:u,b:g,a:h}=this;return h===0?[0,0,0]:[s/h*n,u/h*n,g/h*n]}toArray01PremultipliedAlpha(){const{r:n,g:s,b:u,a:g}=this;return[n,s,u,g]}toArray01Linear(){const{r:n,g:s,b:u,a:g}=this;return g===0?[0,0,0,0]:[Math.pow(n/g,2.2),Math.pow(s/g,2.2),Math.pow(u/g,2.2),g]}}function cr(c,n,s){return c*(1-s)+n*s}function Fy(c,n,s){return c.map((u,g)=>cr(u,n[g],s))}io.black=new io(0,0,0,1),io.white=new io(1,1,1,1),io.transparent=new io(0,0,0,0),io.red=new io(1,0,0,1),io.blue=new io(0,0,1,1);var Gf=Object.freeze({__proto__:null,array:Fy,color:function(c,n,s){return new io(cr(c.r,n.r,s),cr(c.g,n.g,s),cr(c.b,n.b,s),cr(c.a,n.a,s))},number:cr});function Wf(c,...n){for(const s of n)for(const u in s)c[u]=s[u];return c}class Fr extends Error{constructor(n,s){super(s),this.message=s,this.key=n}}class qf{constructor(n,s=[]){this.parent=n,this.bindings={};for(const[u,g]of s)this.bindings[u]=g}concat(n){return new qf(this,n)}get(n){if(this.bindings[n])return this.bindings[n];if(this.parent)return this.parent.get(n);throw new Error(`${n} not found in scope.`)}has(n){return!!this.bindings[n]||!!this.parent&&this.parent.has(n)}}const eu={kind:"null"},qn={kind:"number"},co={kind:"string"},Yr={kind:"boolean"},Yi={kind:"color"},Ol={kind:"object"},eo={kind:"value"},lh={kind:"collator"},rl={kind:"formatted"},ch={kind:"resolvedImage"};function Ni(c,n){return{kind:"array",itemType:c,N:n}}function Qo(c){if(c.kind==="array"){const n=Qo(c.itemType);return typeof c.N=="number"?`array<${n}, ${c.N}>`:c.itemType.kind==="value"?"array":`array<${n}>`}return c.kind}const hg=[eu,qn,co,Yr,Yi,rl,Ol,Ni(eo),ch];function ys(c,n){if(n.kind==="error")return null;if(c.kind==="array"){if(n.kind==="array"&&(n.N===0&&n.itemType.kind==="value"||!ys(c.itemType,n.itemType))&&(typeof c.N!="number"||c.N===n.N))return null}else{if(c.kind===n.kind)return null;if(c.kind==="value"){for(const s of hg)if(!ys(s,n))return null}}return`Expected ${Qo(c)} but found ${Qo(n)} instead.`}function Kf(c,n){return n.some(s=>s.kind===c.kind)}function uh(c,n){return n.some(s=>s==="null"?c===null:s==="array"?Array.isArray(c):s==="object"?c&&!Array.isArray(c)&&typeof c=="object":s===typeof c)}class Zf{constructor(n,s,u){this.sensitivity=n?s?"variant":"case":s?"accent":"base",this.locale=u,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(n,s){return this.collator.compare(n,s)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class dh{constructor(n,s,u,g,h){this.text=n.normalize?n.normalize():n,this.image=s,this.scale=u,this.fontStack=g,this.textColor=h}}class Xi{constructor(n){this.sections=n}static fromString(n){return new Xi([new dh(n,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(n=>n.text.length!==0||n.image&&n.image.namePrimary)}static factory(n){return n instanceof Xi?n:Xi.fromString(n)}toString(){return this.sections.length===0?"":this.sections.map(n=>n.text).join("")}serialize(){const n=["format"];for(const s of this.sections){if(s.image){n.push(["image",s.image.namePrimary]);continue}n.push(s.text);const u={};s.fontStack&&(u["text-font"]=["literal",s.fontStack.split(",")]),s.scale&&(u["font-scale"]=s.scale),s.textColor&&(u["text-color"]=["rgba"].concat(s.textColor.toRenderColor(null).toArray())),n.push(u)}return n}}class ol{constructor(n,s){if(this.id=n,this.options=s||{params:{}},this.options.transform){const{a:u,b:g,c:h,d:v,e:T,f:A}=this.options.transform;this.options.transform=new DOMMatrix([u,g,h,v,T,A])}else this.options.transform=new DOMMatrix([1,0,0,1,0,0])}static deserializeId(n){return JSON.parse(n).id}static deserializeFromString(n){const s=JSON.parse(n),{a:u,b:g,c:h,d:v,e:T,f:A}=s.options.transform;return new DOMMatrix([u,g,h,v,T,A]),new ol(s.id,s.options)}scaleSelf(n){return this.options.transform=this.options.transform.scale(n),this}serialize(){const n={id:this.id};this.options&&(n.options=this.options);const{a:s,b:u,c:g,d:h,e:v,f:T}=this.options.transform;return n.options.transform={a:s,b:u,c:g,d:h,e:v,f:T},JSON.stringify(n)}}class Gi{constructor(n){this.namePrimary=n.namePrimary,n.nameSecondary&&(this.nameSecondary=n.nameSecondary),n.optionsPrimary&&(this.optionsPrimary=n.optionsPrimary),n.optionsSecondary&&(this.optionsSecondary=n.optionsSecondary),this.available=n.available}toString(){return this.namePrimary&&this.nameSecondary?`[${this.namePrimary},${this.nameSecondary}]`:this.namePrimary}getPrimary(){return new ol(this.namePrimary,{params:this.optionsPrimary&&this.optionsPrimary.params||{}})}getSerializedPrimary(){return this.getPrimary().serialize()}getSecondary(){return this.nameSecondary?new ol(this.nameSecondary,{params:this.optionsSecondary&&this.optionsSecondary.params||{}}):null}static from(n){return typeof n=="string"?Gi.build(n):n}static build(n,s,u,g){return n?new Gi({namePrimary:n,nameSecondary:s,optionsPrimary:u,optionsSecondary:g,available:!1}):null}}function fg(c,n,s,u){return typeof c=="number"&&c>=0&&c<=255&&typeof n=="number"&&n>=0&&n<=255&&typeof s=="number"&&s>=0&&s<=255?u===void 0||typeof u=="number"&&u>=0&&u<=1?null:`Invalid rgba value [${[c,n,s,u].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof u=="number"?[c,n,s,u]:[c,n,s]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Ll(c){if(c===null||typeof c=="string"||typeof c=="boolean"||typeof c=="number"||c instanceof io||c instanceof Zf||c instanceof Xi||c instanceof Gi)return!0;if(Array.isArray(c)){for(const n of c)if(!Ll(n))return!1;return!0}if(typeof c=="object"){for(const n in c)if(!Ll(c[n]))return!1;return!0}return!1}function Yo(c){if(c===null)return eu;if(typeof c=="string")return co;if(typeof c=="boolean")return Yr;if(typeof c=="number")return qn;if(c instanceof io)return Yi;if(c instanceof Zf)return lh;if(c instanceof Xi)return rl;if(c instanceof Gi)return ch;if(Array.isArray(c)){const n=c.length;let s;for(const u of c){const g=Yo(u);if(s){if(s===g)continue;s=eo;break}s=g}return Ni(s||eo,n)}return Ol}function ya(c){const n=typeof c;return c===null?"":n==="string"||n==="number"||n==="boolean"?String(c):c instanceof io?c.toStringPremultipliedAlpha():c instanceof Xi||c instanceof Gi?c.toString():JSON.stringify(c)}class Bi{constructor(n,s){this.type=n,this.value=s}static parse(n,s){if(n.length!==2)return s.error(`'literal' expression requires exactly one argument, but found ${n.length-1} instead.`);if(!Ll(n[1]))return s.error("invalid value");const u=n[1];let g=Yo(u);const h=s.expectedType;return g.kind!=="array"||g.N!==0||!h||h.kind!=="array"||typeof h.N=="number"&&h.N!==0||(g=h),new Bi(g,u)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof io?["rgba"].concat(this.value.toRenderColor(null).toArray()):this.value instanceof Xi?this.value.serialize():this.value}}class pi{constructor(n){this.name="ExpressionEvaluationError",this.message=n}toJSON(){return this.message}}const hh={string:co,number:qn,boolean:Yr,object:Ol};class Da{constructor(n,s){this.type=n,this.args=s}static parse(n,s){if(n.length<2)return s.error("Expected at least one argument.");let u,g=1;const h=n[0];if(h==="array"){let T,A;if(n.length>2){const D=n[1];if(typeof D!="string"||!(D in hh)||D==="object")return s.error('The item type argument of "array" must be one of string, number, boolean',1);T=hh[D],g++}else T=eo;if(n.length>3){if(n[2]!==null&&(typeof n[2]!="number"||n[2]<0||n[2]!==Math.floor(n[2])))return s.error('The length argument to "array" must be a positive integer literal',2);A=n[2],g++}u=Ni(T,A)}else u=hh[h];const v=[];for(;g<n.length;g++){const T=s.parse(n[g],g,eo);if(!T)return null;v.push(T)}return new Da(u,v)}evaluate(n){for(let s=0;s<this.args.length;s++){const u=this.args[s].evaluate(n);if(!ys(this.type,Yo(u)))return u;if(s===this.args.length-1)throw new pi(`The expression ${JSON.stringify(this.args[s].serialize())} evaluated to ${Qo(Yo(u))} but was expected to be of type ${Qo(this.type)}.`)}return null}eachChild(n){this.args.forEach(n)}outputDefined(){return this.args.every(n=>n.outputDefined())}serialize(){const n=this.type,s=[n.kind];if(n.kind==="array"){const u=n.itemType;if(u.kind==="string"||u.kind==="number"||u.kind==="boolean"){s.push(u.kind);const g=n.N;(typeof g=="number"||this.args.length>1)&&s.push(g)}}return s.concat(this.args.map(u=>u.serialize()))}}class tu{constructor(n){this.type=rl,this.sections=n}static parse(n,s){if(n.length<2)return s.error("Expected at least one argument.");const u=n[1];if(!Array.isArray(u)&&typeof u=="object")return s.error("First argument must be an image or text section.");const g=[];let h=!1;for(let v=1;v<=n.length-1;++v){const T=n[v];if(h&&typeof T=="object"&&!Array.isArray(T)){h=!1;let A=null;if(T["font-scale"]&&(A=s.parseObjectValue(T["font-scale"],v,"font-scale",qn),!A))return null;let D=null;if(T["text-font"]&&(D=s.parseObjectValue(T["text-font"],v,"text-font",Ni(co)),!D))return null;let x=null;if(T["text-color"]&&(x=s.parseObjectValue(T["text-color"],v,"text-color",Yi),!x))return null;const P=g[g.length-1];P.scale=A,P.font=D,P.textColor=x}else{const A=s.parse(n[v],v,eo);if(!A)return null;const D=A.type.kind;if(D!=="string"&&D!=="value"&&D!=="null"&&D!=="resolvedImage")return s.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");h=!0,g.push({content:A,scale:null,font:null,textColor:null})}}return new tu(g)}evaluate(n){return new Xi(this.sections.map(s=>{const u=s.content.evaluate(n);return Yo(u)===ch?new dh("",u,null,null,null):new dh(ya(u),null,s.scale?s.scale.evaluate(n):null,s.font?s.font.evaluate(n).join(","):null,s.textColor?s.textColor.evaluate(n):null)}))}eachChild(n){for(const s of this.sections)n(s.content),s.scale&&n(s.scale),s.font&&n(s.font),s.textColor&&n(s.textColor)}outputDefined(){return!1}serialize(){const n=["format"];for(const s of this.sections){n.push(s.content.serialize());const u={};s.scale&&(u["font-scale"]=s.scale.serialize()),s.font&&(u["text-font"]=s.font.serialize()),s.textColor&&(u["text-color"]=s.textColor.serialize()),n.push(u)}return n}}class fh{constructor(n,s,u,g){this._imageWarnHistory={},this.type=ch,this.inputPrimary=n,this.inputSecondary=s,this.inputPrimaryParams=u,this.inputSecondaryParams=g}static parse(n,s){if(n.length<2)return s.error("Expected two or more arguments.");let u=1;const g=[];function h(){if(u<n.length){const T=s.parse(n[u],u++,co);return T?(g.push({image:T,options:void 0}),!0):(s.error(g.length?"Secondary image variant is not a string.":"No image name provided."),!1)}return!0}function v(){if(u<n.length){if((T=n[u])===null||typeof T!="object"||Array.isArray(T))return!0;const A=n[u].params,D=s.concat(u);if(!A)return u++,!0;if(typeof A!="object"||A.constructor!==Object)return D.error('Image options "params" should be an object'),!1;const x={},P=D.concat(void 0,"params");for(const L in A){if(!L)return P.error("Image parameter name should be non-empty"),!1;const I=P.concat(void 0,L).parse(A[L],void 0,Yi,void 0,{typeAnnotation:"coerce"});if(!I)return!1;x[L]=I}return g[g.length-1].options=x,u++,!0}var T;return!0}for(let T=0;T<2;T++)if(!h()||!v())return;return new fh(g[0].image,g[1]?g[1].image:void 0,g[0].options,g[1]?g[1].options:void 0)}evaluateParams(n,s){const u={};if(s){for(const g in s)if(s[g])try{const h=s[g].evaluate(n),v=`Ignoring image parameter "${g}" with semi-transparent color ${h.toString()}`;if(h.a!==1){this._imageWarnHistory[v]||(console.warn(v),this._imageWarnHistory[v]=!0);continue}u[g]=h}catch{continue}if(Object.keys(u).length!==0)return{params:u}}}evaluate(n){const s=Gi.build(this.inputPrimary.evaluate(n),this.inputSecondary?this.inputSecondary.evaluate(n):void 0,this.inputPrimaryParams?this.evaluateParams(n,this.inputPrimaryParams):void 0,this.inputSecondaryParams?this.evaluateParams(n,this.inputSecondaryParams):void 0);return s&&n.availableImages&&(s.available=n.availableImages.indexOf(s.namePrimary)>-1,s.nameSecondary&&s.available&&n.availableImages&&(s.available=n.availableImages.indexOf(s.nameSecondary)>-1)),s}eachChild(n){if(n(this.inputPrimary),this.inputPrimaryParams)for(const s in this.inputPrimaryParams)this.inputPrimaryParams[s]&&n(this.inputPrimaryParams[s]);if(this.inputSecondary&&(n(this.inputSecondary),this.inputSecondaryParams))for(const s in this.inputSecondaryParams)this.inputSecondaryParams[s]&&n(this.inputSecondaryParams[s])}outputDefined(){return!1}serializeParams(n){const s={};if(n){for(const u in n)n[u]&&(s[u]=n[u].serialize());return{params:s}}}serialize(){const n=["image",this.inputPrimary.serialize()];return this.inputPrimaryParams&&n.push(this.serializeParams(this.inputPrimaryParams)),this.inputSecondary&&(n.push(this.inputSecondary.serialize()),this.inputSecondaryParams&&n.push(this.serializeParams(this.inputSecondaryParams))),n}}function za(c){return c instanceof Number?"number":c instanceof String?"string":c instanceof Boolean?"boolean":Array.isArray(c)?"array":c===null?"null":typeof c}const pg={"to-boolean":Yr,"to-color":Yi,"to-number":qn,"to-string":co};class Dl{constructor(n,s){this.type=n,this.args=s}static parse(n,s){if(n.length<2)return s.error("Expected at least one argument.");const u=n[0],g=[];let h=eu;if(u==="to-array"){if(!Array.isArray(n[1]))return null;const v=n[1].length;if(s.expectedType){if(s.expectedType.kind!=="array")return s.error(`Expected ${s.expectedType.kind} but found array.`);h=Ni(s.expectedType.itemType,v)}else{if(!(v>0&&Ll(n[1][0])))return null;h=Ni(Yo(n[1][0]),v)}for(let T=0;T<v;T++){const A=n[1][T];let D;if(za(A)==="array")D=s.parse(A,void 0,h.itemType);else{const x=za(A);if(x!==h.itemType.kind)return s.error(`Expected ${h.itemType.kind} but found ${x}.`);D=s.registry.literal.parse(["literal",A===void 0?null:A],s)}if(!D)return null;g.push(D)}}else{if((u==="to-boolean"||u==="to-string")&&n.length!==2)return s.error("Expected one argument.");h=pg[u];for(let v=1;v<n.length;v++){const T=s.parse(n[v],v,eo);if(!T)return null;g.push(T)}}return new Dl(h,g)}evaluate(n){if(this.type.kind==="boolean")return!!this.args[0].evaluate(n);if(this.type.kind==="color"){let s,u;for(const g of this.args){if(s=g.evaluate(n),u=null,s instanceof io)return s;if(typeof s=="string"){const h=n.parseColor(s);if(h)return h}else if(Array.isArray(s)&&(u=s.length<3||s.length>4?`Invalid rbga value ${JSON.stringify(s)}: expected an array containing either three or four numeric values.`:fg(s[0],s[1],s[2],s[3]),!u))return new io(s[0]/255,s[1]/255,s[2]/255,s[3])}throw new pi(u||`Could not parse color from value '${typeof s=="string"?s:String(JSON.stringify(s))}'`)}if(this.type.kind==="number"){let s=null;for(const u of this.args){if(s=u.evaluate(n),s===null)return 0;const g=Number(s);if(!isNaN(g))return g}throw new pi(`Could not convert ${JSON.stringify(s)} to number.`)}return this.type.kind==="formatted"?Xi.fromString(ya(this.args[0].evaluate(n))):this.type.kind==="resolvedImage"?Gi.build(ya(this.args[0].evaluate(n))):this.type.kind==="array"?this.args.map(s=>s.evaluate(n)):ya(this.args[0].evaluate(n))}eachChild(n){this.args.forEach(n)}outputDefined(){return this.args.every(n=>n.outputDefined())}serialize(){if(this.type.kind==="formatted")return new tu([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new fh(this.args[0]).serialize();const n=this.type.kind==="array"?[]:[`to-${this.type.kind}`];return this.eachChild(s=>{n.push(s.serialize())}),n}}const Vx=["Unknown","Point","LineString","Polygon"];class mg{constructor(n,s){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null,this.scope=n,this.options=s}id(){return this.feature&&this.feature.id!==void 0?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?Vx[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}measureLight(n){return this.globals.brightness||0}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const n=this.featureDistanceData.center,s=this.featureDistanceData.scale,{x:u,y:g}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(u*s-n[0])+this.featureDistanceData.bearing[1]*(g*s-n[1])}return 0}parseColor(n){let s=this._parseColorCache[n];return s||(s=this._parseColorCache[n]=io.parse(n)),s}getConfig(n){return this.options?this.options.get(n):null}}class bs{constructor(n,s,u,g,h){this.name=n,this.type=s,this._evaluate=u,this.args=g,this._overloadIndex=h}evaluate(n){if(!this._evaluate){const s=bs.definitions[this.name];this._evaluate=Array.isArray(s)?s[2]:s.overloads[this._overloadIndex][1]}return this._evaluate(n,this.args)}eachChild(n){this.args.forEach(n)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(n=>n.serialize()))}static parse(n,s){const u=n[0],g=bs.definitions[u];if(!g)return s.error(`Unknown expression "${u}". If you wanted a literal array, use ["literal", [...]].`,0);const h=Array.isArray(g)?g[0]:g.type,v=Array.isArray(g)?[[g[1],g[2]]]:g.overloads,T=[];let A=null,D=-1;for(const[x,P]of v){if(Array.isArray(x)&&x.length!==n.length-1)continue;T.push(x),D++,A=new Sh(s.registry,s.path,null,s.scope,void 0,s._scope,s.options);const L=[];let I=!1;for(let R=1;R<n.length;R++){const V=n[R],W=Array.isArray(x)?x[R-1]:x.type,K=A.parse(V,1+L.length,W);if(!K){I=!0;break}L.push(K)}if(!I)if(Array.isArray(x)&&x.length!==L.length)A.error(`Expected ${x.length} arguments, but found ${L.length} instead.`);else{for(let R=0;R<L.length;R++){const V=Array.isArray(x)?x[R]:x.type,W=L[R];A.concat(R+1).checkSubtype(V,W.type)}if(A.errors.length===0)return new bs(u,h,P,L,D)}}if(T.length===1)s.errors.push(...A.errors);else{const x=(T.length?T:v.map(([L])=>L)).map(gg).join(" | "),P=[];for(let L=1;L<n.length;L++){const I=s.parse(n[L],1+P.length);if(!I)return null;P.push(Qo(I.type))}s.error(`Expected arguments of type ${x}, but found (${P.join(", ")}) instead.`)}return null}static register(n,s){bs.definitions=s;for(const u in s)n[u]=bs}}function gg(c){return Array.isArray(c)?`(${c.map(Qo).join(", ")})`:`(${Qo(c.type)}...)`}class Yf{constructor(n,s,u){this.type=lh,this.locale=u,this.caseSensitive=n,this.diacriticSensitive=s}static parse(n,s){if(n.length!==2)return s.error("Expected one argument.");const u=n[1];if(typeof u!="object"||Array.isArray(u))return s.error("Collator options argument must be an object.");const g=u["case-sensitive"]===void 0?s.parse(!1,1,Yr):s.parseObjectValue(u["case-sensitive"],1,"case-sensitive",Yr);if(!g)return null;const h=u["diacritic-sensitive"]===void 0?s.parse(!1,1,Yr):s.parseObjectValue(u["diacritic-sensitive"],1,"diacritic-sensitive",Yr);if(!h)return null;let v=null;return u.locale&&(v=s.parseObjectValue(u.locale,1,"locale",co),!v)?null:new Yf(g,h,v)}evaluate(n){return new Zf(this.caseSensitive.evaluate(n),this.diacriticSensitive.evaluate(n),this.locale?this.locale.evaluate(n):null)}eachChild(n){n(this.caseSensitive),n(this.diacriticSensitive),this.locale&&n(this.locale)}outputDefined(){return!1}serialize(){const n={};return n["case-sensitive"]=this.caseSensitive.serialize(),n["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(n.locale=this.locale.serialize()),["collator",n]}}function ph(c,n,s=0,u=c.length-1,g=$x){for(;u>s;){if(u-s>600){const A=u-s+1,D=n-s+1,x=Math.log(A),P=.5*Math.exp(2*x/3),L=.5*Math.sqrt(x*P*(A-P)/A)*(D-A/2<0?-1:1);ph(c,n,Math.max(s,Math.floor(n-D*P/A+L)),Math.min(u,Math.floor(n+(A-D)*P/A+L)),g)}const h=c[n];let v=s,T=u;for(mh(c,s,n),g(c[u],h)>0&&mh(c,s,u);v<T;){for(mh(c,v,T),v++,T--;g(c[v],h)<0;)v++;for(;g(c[T],h)>0;)T--}g(c[s],h)===0?mh(c,s,T):(T++,mh(c,T,u)),T<=n&&(s=T+1),n<=T&&(u=T-1)}}function mh(c,n,s){const u=c[n];c[n]=c[s],c[s]=u}function $x(c,n){return c<n?-1:c>n?1:0}function Ux(c){let n=0;for(let s,u,g=0,h=c.length,v=h-1;g<h;v=g++)s=c[g],u=c[v],n+=(u.x-s.x)*(s.y+u.y);return n}function gh(c,n){c[0]=Math.min(c[0],n[0]),c[1]=Math.min(c[1],n[1]),c[2]=Math.max(c[2],n[0]),c[3]=Math.max(c[3],n[1])}function vh(c,n){return!(c[0]<=n[0]||c[2]>=n[2]||c[1]<=n[1]||c[3]>=n[3])}function jx(c,n,s){const u=c[0]-n[0],g=c[1]-n[1],h=c[0]-s[0],v=c[1]-s[1];return u*v-h*g==0&&u*h<=0&&g*v<=0}function Ku(c,n,s=!1){let u=!1;for(let T=0,A=n.length;T<A;T++){const D=n[T];for(let x=0,P=D.length,L=P-1;x<P;L=x++){const I=D[L],R=D[x];if(jx(c,I,R))return s;(h=I)[1]>(g=c)[1]!=(v=R)[1]>g[1]&&g[0]<(v[0]-h[0])*(g[1]-h[1])/(v[1]-h[1])+h[0]&&(u=!u)}}var g,h,v;return u}function vg(c,n,s,u){const g=u[0]-s[0],h=u[1]-s[1],v=(c[0]-s[0])*h-g*(c[1]-s[1]),T=(n[0]-s[0])*h-g*(n[1]-s[1]);return v>0&&T<0||v<0&&T>0}function zl(c,n,s,u){return(g=[u[0]-s[0],u[1]-s[1]])[0]*(h=[n[0]-c[0],n[1]-c[1]])[1]-g[1]*h[0]!=0&&!(!vg(c,n,s,u)||!vg(s,u,c,n));var g,h}const bc=8192;function Hx(c,n){const s=(180+c[0])/360,u=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+c[1]*Math.PI/360)))/360,g=Math.pow(2,n.z);return[Math.round(s*g*bc),Math.round(u*g*bc)]}function _g(c,n){for(let s=0;s<n.length;s++)if(Ku(c,n[s]))return!0;return!1}function Gx(c,n,s){for(const u of s)for(let g=0,h=u.length,v=h-1;g<h;v=g++)if(zl(c,n,u[v],u[g]))return!0;return!1}function Ny(c,n){for(let s=0;s<c.length;++s)if(!Ku(c[s],n))return!1;for(let s=0;s<c.length-1;++s)if(Gx(c[s],c[s+1],n))return!1;return!0}function Wx(c,n){for(let s=0;s<n.length;s++)if(Ny(c,n[s]))return!0;return!1}function yg(c,n,s){const u=[];for(let g=0;g<c.length;g++){const h=[];for(let v=0;v<c[g].length;v++){const T=Hx(c[g][v],s);gh(n,T),h.push(T)}u.push(h)}return u}function nu(c,n,s){const u=[];for(let g=0;g<c.length;g++){const h=yg(c[g],n,s);u.push(h)}return u}function Lr(c,n,s,u){if(c[0]<s[0]||c[0]>s[2]){const g=.5*u;let h=c[0]-s[0]>g?-u:s[0]-c[0]>g?u:0;h===0&&(h=c[0]-s[2]>g?-u:s[2]-c[0]>g?u:0),c[0]+=h}gh(n,c)}function or(c,n,s,u){const g=Math.pow(2,u.z)*bc,h=[u.x*bc,u.y*bc],v=[];if(!c)return v;for(const T of c)for(const A of T){const D=[A.x+h[0],A.y+h[1]];Lr(D,n,s,g),v.push(D)}return v}function Xf(c,n,s,u){const g=Math.pow(2,u.z)*bc,h=[u.x*bc,u.y*bc],v=[];if(!c)return v;for(const A of c){const D=[];for(const x of A){const P=[x.x+h[0],x.y+h[1]];gh(n,P),D.push(P)}v.push(D)}if(n[2]-n[0]<=g/2){(T=n)[0]=T[1]=1/0,T[2]=T[3]=-1/0;for(const A of v)for(const D of A)Lr(D,n,s,g)}var T;return v}class fr{constructor(n,s){this.type=Yr,this.geojson=n,this.geometries=s}static parse(n,s){if(n.length!==2)return s.error(`'within' expression requires exactly one argument, but found ${n.length-1} instead.`);if(Ll(n[1])){const u=n[1];if(u.type==="FeatureCollection")for(let g=0;g<u.features.length;++g){const h=u.features[g].geometry.type;if(h==="Polygon"||h==="MultiPolygon")return new fr(u,u.features[g].geometry)}else if(u.type==="Feature"){const g=u.geometry.type;if(g==="Polygon"||g==="MultiPolygon")return new fr(u,u.geometry)}else if(u.type==="Polygon"||u.type==="MultiPolygon")return new fr(u,u)}return s.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(n){if(n.geometry()!=null&&n.canonicalID()!=null){if(n.geometryType()==="Point")return function(s,u){const g=[1/0,1/0,-1/0,-1/0],h=[1/0,1/0,-1/0,-1/0],v=s.canonicalID();if(!v)return!1;if(u.type==="Polygon"){const T=yg(u.coordinates,h,v),A=or(s.geometry(),g,h,v);if(!vh(g,h))return!1;for(const D of A)if(!Ku(D,T))return!1}if(u.type==="MultiPolygon"){const T=nu(u.coordinates,h,v),A=or(s.geometry(),g,h,v);if(!vh(g,h))return!1;for(const D of A)if(!_g(D,T))return!1}return!0}(n,this.geometries);if(n.geometryType()==="LineString")return function(s,u){const g=[1/0,1/0,-1/0,-1/0],h=[1/0,1/0,-1/0,-1/0],v=s.canonicalID();if(!v)return!1;if(u.type==="Polygon"){const T=yg(u.coordinates,h,v),A=Xf(s.geometry(),g,h,v);if(!vh(g,h))return!1;for(const D of A)if(!Ny(D,T))return!1}if(u.type==="MultiPolygon"){const T=nu(u.coordinates,h,v),A=Xf(s.geometry(),g,h,v);if(!vh(g,h))return!1;for(const D of A)if(!Wx(D,T))return!1}return!0}(n,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}const Zu={kilometers:1,miles:1e3/1609.344,nauticalmiles:1e3/1852,meters:1e3,metres:1e3,yards:1e3/.9144,feet:1e3/.3048,inches:1e3/.0254},Jf=1/298.257223563,_r=Jf*(2-Jf),Yu=Math.PI/180;class ru{static fromTile(n,s,u){const g=Math.PI*(1-2*(n+.5)/Math.pow(2,s)),h=Math.atan(.5*(Math.exp(g)-Math.exp(-g)))/Yu;return new ru(h,u)}static get units(){return Zu}constructor(n,s){if(n===void 0)throw new Error("No latitude given.");if(s&&!Zu[s])throw new Error(`Unknown unit ${s}. Use one of: ${Object.keys(Zu).join(", ")}`);const u=6378.137*Yu*(s?Zu[s]:1),g=Math.cos(n*Yu),h=1/(1-_r*(1-g*g)),v=Math.sqrt(h);this.kx=u*v*g,this.ky=u*v*h*(1-_r)}distance(n,s){const u=xs(n[0]-s[0])*this.kx,g=(n[1]-s[1])*this.ky;return Math.sqrt(u*u+g*g)}bearing(n,s){const u=xs(s[0]-n[0])*this.kx;return Math.atan2(u,(s[1]-n[1])*this.ky)/Yu}destination(n,s,u){const g=u*Yu;return this.offset(n,Math.sin(g)*s,Math.cos(g)*s)}offset(n,s,u){return[n[0]+s/this.kx,n[1]+u/this.ky]}lineDistance(n){let s=0;for(let u=0;u<n.length-1;u++)s+=this.distance(n[u],n[u+1]);return s}area(n){let s=0;for(let u=0;u<n.length;u++){const g=n[u];for(let h=0,v=g.length,T=v-1;h<v;T=h++)s+=xs(g[h][0]-g[T][0])*(g[h][1]+g[T][1])*(u?-1:1)}return Math.abs(s)/2*this.kx*this.ky}along(n,s){let u=0;if(s<=0)return n[0];for(let g=0;g<n.length-1;g++){const h=n[g],v=n[g+1],T=this.distance(h,v);if(u+=T,u>s)return Qf(h,v,(s-(u-T))/T)}return n[n.length-1]}pointToSegmentDistance(n,s,u){let[g,h]=s,v=xs(u[0]-g)*this.kx,T=(u[1]-h)*this.ky;if(v!==0||T!==0){const A=(xs(n[0]-g)*this.kx*v+(n[1]-h)*this.ky*T)/(v*v+T*T);A>1?(g=u[0],h=u[1]):A>0&&(g+=v/this.kx*A,h+=T/this.ky*A)}return v=xs(n[0]-g)*this.kx,T=(n[1]-h)*this.ky,Math.sqrt(v*v+T*T)}pointOnLine(n,s){let u=1/0,g=n[0][0],h=n[0][1],v=0,T=0;for(let A=0;A<n.length-1;A++){let D=n[A][0],x=n[A][1],P=xs(n[A+1][0]-D)*this.kx,L=(n[A+1][1]-x)*this.ky,I=0;P===0&&L===0||(I=(xs(s[0]-D)*this.kx*P+(s[1]-x)*this.ky*L)/(P*P+L*L),I>1?(D=n[A+1][0],x=n[A+1][1]):I>0&&(D+=P/this.kx*I,x+=L/this.ky*I)),P=xs(s[0]-D)*this.kx,L=(s[1]-x)*this.ky;const R=P*P+L*L;R<u&&(u=R,g=D,h=x,v=A,T=I)}return{point:[g,h],index:v,t:Math.max(0,Math.min(1,T))}}lineSlice(n,s,u){let g=this.pointOnLine(u,n),h=this.pointOnLine(u,s);if(g.index>h.index||g.index===h.index&&g.t>h.t){const D=g;g=h,h=D}const v=[g.point],T=g.index+1,A=h.index;!bg(u[T],v[0])&&T<=A&&v.push(u[T]);for(let D=T+1;D<=A;D++)v.push(u[D]);return bg(u[A],h.point)||v.push(h.point),v}lineSliceAlong(n,s,u){let g=0;const h=[];for(let v=0;v<u.length-1;v++){const T=u[v],A=u[v+1],D=this.distance(T,A);if(g+=D,g>n&&h.length===0&&h.push(Qf(T,A,(n-(g-D))/D)),g>=s)return h.push(Qf(T,A,(s-(g-D))/D)),h;g>n&&h.push(A)}return h}bufferPoint(n,s){const u=s/this.ky,g=s/this.kx;return[n[0]-g,n[1]-u,n[0]+g,n[1]+u]}bufferBBox(n,s){const u=s/this.ky,g=s/this.kx;return[n[0]-g,n[1]-u,n[2]+g,n[3]+u]}insideBBox(n,s){return xs(n[0]-s[0])>=0&&xs(n[0]-s[2])<=0&&n[1]>=s[1]&&n[1]<=s[3]}}function bg(c,n){return c[0]===n[0]&&c[1]===n[1]}function Qf(c,n,s){const u=xs(n[0]-c[0]);return[c[0]+u*s,c[1]+(n[1]-c[1])*s]}function xs(c){for(;c<-180;)c+=360;for(;c>180;)c-=360;return c}class Wi{constructor(n=[],s=(u,g)=>u<g?-1:u>g?1:0){if(this.data=n,this.length=this.data.length,this.compare=s,this.length>0)for(let u=(this.length>>1)-1;u>=0;u--)this._down(u)}push(n){this.data.push(n),this._up(this.length++)}pop(){if(this.length===0)return;const n=this.data[0],s=this.data.pop();return--this.length>0&&(this.data[0]=s,this._down(0)),n}peek(){return this.data[0]}_up(n){const{data:s,compare:u}=this,g=s[n];for(;n>0;){const h=n-1>>1,v=s[h];if(u(g,v)>=0)break;s[n]=v,n=h}s[n]=g}_down(n){const{data:s,compare:u}=this,g=this.length>>1,h=s[n];for(;n<g;){let v=1+(n<<1);const T=v+1;if(T<this.length&&u(s[T],s[v])<0&&(v=T),u(s[v],h)>=0)break;s[n]=s[v],n=v}s[n]=h}}var In=8192;function xg(c,n){return n.dist-c.dist}const ep=100,_h=50;function xc(c){const n=[1/0,1/0,-1/0,-1/0];if(n.length!==c.length)return!1;for(let s=0;s<n.length;s++)if(n[s]!==c[s])return!1;return!0}function Vi(c){return c[1]-c[0]+1}function Fl(c,n){const s=c[1]>=c[0]&&c[1]<n;return s||console.warn("Distance Expression: Index is out of range"),s}function wg(c,n){if(c[0]>c[1])return[null,null];const s=Vi(c);if(n){if(s===2)return[c,null];const u=Math.floor(s/2);return[[c[0],c[0]+u],[c[0]+u,c[1]]]}{if(s===1)return[c,null];const u=Math.floor(s/2)-1;return[[c[0],c[0]+u],[c[0]+u+1,c[1]]]}}function ou(c,n){const s=[1/0,1/0,-1/0,-1/0];if(!Fl(n,c.length))return s;for(let u=n[0];u<=n[1];++u)gh(s,c[u]);return s}function iu(c){const n=[1/0,1/0,-1/0,-1/0];for(let s=0;s<c.length;++s)for(let u=0;u<c[s].length;++u)gh(n,c[s][u]);return n}function su(c,n,s){if(xc(c)||xc(n))return NaN;let u=0,g=0;return c[2]<n[0]&&(u=n[0]-c[2]),c[0]>n[2]&&(u=c[0]-n[2]),c[1]>n[3]&&(g=c[1]-n[3]),c[3]<n[1]&&(g=n[1]-c[3]),s.distance([0,0],[u,g])}function Sg(c){return 360*c-180}function qx(c){return 360/Math.PI*Math.atan(Math.exp((180-360*c)*Math.PI/180))-90}function Tg(c,n){const s=Math.pow(2,n.z),u=(c.y/In+n.y)/s;return[Sg((c.x/In+n.x)/s),qx(u)]}function Kx(c,n){const s=[];for(let u=0;u<c.length;++u)s.push(Tg(c[u],n));return s}function By(c,n,s){const u=s.pointOnLine(n,c).point;return s.distance(c,u)}function Cg(c,n,s,u,g){const h=s.slice(u[0],u[1]+1);let v=1/0;for(let T=n[0];T<=n[1];++T)if((v=Math.min(v,By(c[T],h,g)))===0)return 0;return v}function Eg(c,n,s,u,g){const h=Math.min(g.pointToSegmentDistance(c,s,u),g.pointToSegmentDistance(n,s,u)),v=Math.min(g.pointToSegmentDistance(s,c,n),g.pointToSegmentDistance(u,c,n));return Math.min(h,v)}function Zx(c,n,s,u,g){if(!Fl(n,c.length)||!Fl(u,s.length))return NaN;let h=1/0;for(let v=n[0];v<n[1];++v)for(let T=u[0];T<u[1];++T){if(zl(c[v],c[v+1],s[T],s[T+1]))return 0;h=Math.min(h,Eg(c[v],c[v+1],s[T],s[T+1],g))}return h}function Vy(c,n,s,u,g){if(!Fl(n,c.length)||!Fl(u,s.length))return NaN;let h=1/0;for(let v=n[0];v<=n[1];++v)for(let T=u[0];T<=u[1];++T)if((h=Math.min(h,g.distance(c[v],s[T])))===0)return h;return h}function au(c,n,s){if(Ku(c,n,!0))return 0;let u=1/0;for(const g of n){const h=g.length;if(h<2)return console.warn("Distance Expression: Invalid polygon!"),NaN;if(g[0]!==g[h-1]&&(u=Math.min(u,s.pointToSegmentDistance(c,g[h-1],g[0])))===0||(u=Math.min(u,By(c,g,s)))===0)return u}return u}function Yx(c,n,s,u){if(!Fl(n,c.length))return NaN;for(let h=n[0];h<=n[1];++h)if(Ku(c[h],s,!0))return 0;let g=1/0;for(let h=n[0];h<n[1];++h)for(const v of s)for(let T=0,A=v.length,D=A-1;T<A;D=T++){if(zl(c[h],c[h+1],v[D],v[T]))return 0;g=Math.min(g,Eg(c[h],c[h+1],v[D],v[T],u))}return g}function $y(c,n){for(const s of c)for(let u=0;u<=s.length-1;++u)if(Ku(s[u],n,!0))return!0;return!1}function Mg(c,n,s,u=1/0){const g=iu(c),h=iu(n);if(u!==1/0&&su(g,h,s)>=u)return u;if(vh(g,h)){if($y(c,n))return 0}else if($y(n,c))return 0;let v=u;for(const T of c)for(let A=0,D=T.length,x=D-1;A<D;x=A++)for(const P of n)for(let L=0,I=P.length,R=I-1;L<I;R=L++){if(zl(T[x],T[A],P[R],P[L]))return 0;v=Math.min(v,Eg(T[x],T[A],P[R],P[L],s))}return v}function yh(c,n,s,u,g,h,v){if(h===null||v===null)return;const T=su(ou(u,h),ou(g,v),s);T<n&&c.push({dist:T,range1:h,range2:v})}function Uy(c,n,s,u,g=1/0){let h=Math.min(u.distance(c[0],s[0][0]),g);if(h===0)return h;const v=new Wi([{dist:0,range1:[0,c.length-1],range2:[0,0]}],xg),T=n?_h:ep,A=iu(s);for(;v.length;){const D=v.pop();if(D.dist>=h)continue;const x=D.range1;if(Vi(x)<=T){if(!Fl(x,c.length))return NaN;if(n){const P=Yx(c,x,s,u);if((h=Math.min(h,P))===0)return h}else for(let P=x[0];P<=x[1];++P){const L=au(c[P],s,u);if((h=Math.min(h,L))===0)return h}}else{const P=wg(x,n);if(P[0]!==null){const L=su(ou(c,P[0]),A,u);L<h&&v.push({dist:L,range1:P[0],range2:[0,0]})}if(P[1]!==null){const L=su(ou(c,P[1]),A,u);L<h&&v.push({dist:L,range1:P[1],range2:[0,0]})}}}return h}function ba(c,n,s,u,g,h=1/0){let v=Math.min(h,g.distance(c[0],s[0]));if(v===0)return v;const T=new Wi([{dist:0,range1:[0,c.length-1],range2:[0,s.length-1]}],xg),A=n?_h:ep,D=u?_h:ep;for(;T.length;){const x=T.pop();if(x.dist>=v)continue;const P=x.range1,L=x.range2;if(Vi(P)<=A&&Vi(L)<=D){if(!Fl(P,c.length)||!Fl(L,s.length))return NaN;if(n&&u?v=Math.min(v,Zx(c,P,s,L,g)):n||u?n&&!u?v=Math.min(v,Cg(s,L,c,P,g)):!n&&u&&(v=Math.min(v,Cg(c,P,s,L,g))):v=Math.min(v,Vy(c,P,s,L,g)),v===0)return v}else{const I=wg(P,n),R=wg(L,u);yh(T,v,g,c,s,I[0],R[0]),yh(T,v,g,c,s,I[0],R[1]),yh(T,v,g,c,s,I[1],R[0]),yh(T,v,g,c,s,I[1],R[1])}}return v}function tp(c,n,s,u,g=1/0){let h=g;const v=ou(c,[0,c.length-1]);for(const T of s)if(!(h!==1/0&&su(v,ou(T,[0,T.length-1]),u)>=h)&&(h=Math.min(h,ba(c,n,T,!0,u,h)),h===0))return h;return h}function bh(c,n,s,u,g=1/0){let h=g;const v=ou(c,[0,c.length-1]);for(const T of s){if(h!==1/0&&su(v,iu(T),u)>=h)continue;const A=Uy(c,n,T,u,h);if(isNaN(A))return A;if((h=Math.min(h,A))===0)return h}return h}function np(c){return c==="Point"||c==="MultiPoint"||c==="LineString"||c==="MultiLineString"||c==="Polygon"||c==="MultiPolygon"}class wc{constructor(n,s){this.type=qn,this.geojson=n,this.geometries=s}static parse(n,s){if(n.length!==2)return s.error(`'distance' expression requires either one argument, but found ' ${n.length-1} instead.`);if(Ll(n[1])){const u=n[1];if(u.type==="FeatureCollection"){for(let g=0;g<u.features.length;++g)if(np(u.features[g].geometry.type))return new wc(u,u.features[g].geometry)}else if(u.type==="Feature"){if(np(u.geometry.type))return new wc(u,u.geometry)}else if(np(u.type))return new wc(u,u)}return s.error("'distance' expression needs to be an array with format ['Distance', GeoJSONObj].")}evaluate(n){const s=n.geometry(),u=n.canonicalID();if(s!=null&&u!=null){if(n.geometryType()==="Point")return function(g,h,v){const T=[];for(const D of g)for(const x of D)T.push(Tg(x,h));const A=new ru(T[0][1],"meters");return v.type==="Point"||v.type==="MultiPoint"||v.type==="LineString"?ba(T,!1,v.type==="Point"?[v.coordinates]:v.coordinates,v.type==="LineString",A):v.type==="MultiLineString"?tp(T,!1,v.coordinates,A):v.type==="Polygon"||v.type==="MultiPolygon"?bh(T,!1,v.type==="Polygon"?[v.coordinates]:v.coordinates,A):null}(s,u,this.geometries);if(n.geometryType()==="LineString")return function(g,h,v){const T=[];for(const D of g){const x=[];for(const P of D)x.push(Tg(P,h));T.push(x)}const A=new ru(T[0][0][1],"meters");if(v.type==="Point"||v.type==="MultiPoint"||v.type==="LineString")return tp(v.type==="Point"?[v.coordinates]:v.coordinates,v.type==="LineString",T,A);if(v.type==="MultiLineString"){let D=1/0;for(let x=0;x<v.coordinates.length;x++){const P=tp(v.coordinates[x],!0,T,A,D);if(isNaN(P))return P;if((D=Math.min(D,P))===0)return D}return D}if(v.type==="Polygon"||v.type==="MultiPolygon"){let D=1/0;for(let x=0;x<T.length;x++){const P=bh(T[x],!0,v.type==="Polygon"?[v.coordinates]:v.coordinates,A,D);if(isNaN(P))return P;if((D=Math.min(D,P))===0)return D}return D}return null}(s,u,this.geometries);if(n.geometryType()==="Polygon")return function(g,h,v){const T=[];for(const D of function(x,P){const L=x.length;if(L<=1)return[x];const I=[];let R,V;for(let W=0;W<L;W++){const K=Ux(x[W]);K!==0&&(x[W].area=Math.abs(K),V===void 0&&(V=K<0),V===K<0?(R&&I.push(R),R=[x[W]]):R.push(x[W]))}return R&&I.push(R),I}(g)){const x=[];for(let P=0;P<D.length;++P)x.push(Kx(D[P],h));T.push(x)}const A=new ru(T[0][0][0][1],"meters");if(v.type==="Point"||v.type==="MultiPoint"||v.type==="LineString")return bh(v.type==="Point"?[v.coordinates]:v.coordinates,v.type==="LineString",T,A);if(v.type==="MultiLineString"){let D=1/0;for(let x=0;x<v.coordinates.length;x++){const P=bh(v.coordinates[x],!0,T,A,D);if(isNaN(P))return P;if((D=Math.min(D,P))===0)return D}return D}return v.type==="Polygon"||v.type==="MultiPolygon"?function(D,x,P){let L=1/0;for(const I of D)for(const R of x){const V=Mg(I,R,P,L);if(isNaN(V))return V;if((L=Math.min(L,V))===0)return L}return L}(v.type==="Polygon"?[v.coordinates]:v.coordinates,T,A):null}(s,u,this.geometries);console.warn("Distance Expression: currently only evaluates valid Point/LineString/Polygon geometries.")}else console.warn("Distance Expression: requirs valid feature and canonical information.");return null}eachChild(){}outputDefined(){return!0}serialize(){return["distance",this.geojson]}}function rp(c,n){switch(c){case"string":return ya(n);case"number":return+n;case"boolean":return!!n;case"color":return io.parse(n);case"formatted":return Xi.fromString(ya(n));case"resolvedImage":return Gi.build(ya(n))}return n}function Ig(c,n,s,u){return u!==void 0&&(c=u*Math.round(c/u)),n!==void 0&&c<n&&(c=n),s!==void 0&&c>s&&(c=s),c}class lu{constructor(n,s,u){this.type=n,this.key=s,this.scope=u}static parse(n,s){let u=s.expectedType;if(u==null&&(u=eo),n.length<2||n.length>3)return s.error("Invalid number of arguments for 'config' expression.");const g=s.parse(n[1],1);if(!(g instanceof Bi))return s.error("Key name of 'config' expression must be a string literal.");if(n.length>=3){const h=s.parse(n[2],2);return h instanceof Bi?new lu(u,ya(g.value),ya(h.value)):s.error("Scope of 'config' expression must be a string literal.")}return new lu(u,ya(g.value))}evaluate(n){const s=[this.key,this.scope,n.scope].filter(Boolean).join(""),u=n.getConfig(s);if(!u)return null;const{type:g,value:h,values:v,minValue:T,maxValue:A,stepValue:D}=u,x=u.default.evaluate(n);let P=x;if(h){const L=n.scope;n.scope=(L||"").split("").slice(1).join(""),P=h.evaluate(n),n.scope=L}return g&&(P=rp(g,P)),P===void 0||T===void 0&&A===void 0&&D===void 0||(typeof P=="number"?P=Ig(P,T,A,D):Array.isArray(P)&&(P=P.map(L=>typeof L=="number"?Ig(L,T,A,D):L))),h!==void 0&&P!==void 0&&v&&!v.includes(P)&&(P=x,g&&(P=rp(g,P))),(g&&g!==this.type||P!==void 0&&Yo(P)!==this.type)&&(P=rp(this.type.kind,P)),P}eachChild(){}outputDefined(){return!1}serialize(){const n=["config",this.key];return this.scope&&n.concat(this.key),n}}function Xu(c){if(c instanceof bs&&(c.name==="get"&&c.args.length===1||c.name==="feature-state"||c.name==="has"&&c.args.length===1||c.name==="properties"||c.name==="geometry-type"||c.name==="id"||/^filter-/.test(c.name))||c instanceof fr||c instanceof wc)return!1;let n=!0;return c.eachChild(s=>{n&&!Xu(s)&&(n=!1)}),n}function xh(c){if(c instanceof bs&&c.name==="feature-state")return!1;let n=!0;return c.eachChild(s=>{n&&!xh(s)&&(n=!1)}),n}function wh(c){if(c instanceof lu)return new Set([c.key]);let n=new Set;return c.eachChild(s=>{n=new Set([...n,...wh(s)])}),n}function cu(c,n){if(c instanceof bs&&n.indexOf(c.name)>=0)return!1;let s=!0;return c.eachChild(u=>{s&&!cu(u,n)&&(s=!1)}),s}class uu{constructor(n,s){this.type=s.type,this.name=n,this.boundExpression=s}static parse(n,s){if(n.length!==2||typeof n[1]!="string")return s.error("'var' expression requires exactly one string literal argument.");const u=n[1];return s.scope.has(u)?new uu(u,s.scope.get(u)):s.error(`Unknown variable "${u}". Make sure "${u}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(n){return this.boundExpression.evaluate(n)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}class Ju{constructor(n,s=[],u,g=new qf,h=[],v,T){this.registry=n,this.path=s,this.key=s.map(A=>typeof A=="string"?`['${A}']`:`[${A}]`).join(""),this.scope=g,this.errors=h,this.expectedType=u,this._scope=v,this.options=T}parse(n,s,u,g,h={}){return s||u?this.concat(s,null,u,g)._parse(n,h):this._parse(n,h)}parseObjectValue(n,s,u,g,h,v={}){return this.concat(s,u,g,h)._parse(n,v)}_parse(n,s){function u(g,h,v){return v==="assert"?new Da(h,[g]):v==="coerce"?new Dl(h,[g]):g}if(n!==null&&typeof n!="string"&&typeof n!="boolean"&&typeof n!="number"||(n=["literal",n]),Array.isArray(n)){if(n.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const g=typeof n[0]=="string"?this.registry[n[0]]:void 0;if(g){let h=g.parse(n,this);if(!h)return null;if(this.expectedType){const v=this.expectedType,T=h.type;if(v.kind!=="string"&&v.kind!=="number"&&v.kind!=="boolean"&&v.kind!=="object"&&v.kind!=="array"||T.kind!=="value")if(v.kind!=="color"&&v.kind!=="formatted"&&v.kind!=="resolvedImage"||T.kind!=="value"&&T.kind!=="string"){if(this.checkSubtype(v,T))return null}else h=u(h,v,s.typeAnnotation||"coerce");else h=u(h,v,s.typeAnnotation||"assert")}if(!(h instanceof Bi)&&h.type.kind!=="resolvedImage"&&op(h)){const v=new mg(this._scope,this.options);try{h=new Bi(h.type,h.evaluate(v))}catch(T){return this.error(T.message),null}}return h}return Dl.parse(["to-array",n],this)}return this.error(n===void 0?"'undefined' value invalid. Use null instead.":typeof n=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof n} instead.`)}concat(n,s,u,g){let h=typeof n=="number"?this.path.concat(n):this.path;h=typeof s=="string"?h.concat(s):h;const v=g?this.scope.concat(g):this.scope;return new Ju(this.registry,h,u||null,v,this.errors,this._scope,this.options)}error(n,...s){const u=`${this.key}${s.map(g=>`[${g}]`).join("")}`;this.errors.push(new Fr(u,n))}checkSubtype(n,s){const u=ys(n,s);return u&&this.error(u),u}}var Sh=Ju;function op(c){if(c instanceof uu)return op(c.boundExpression);if(c instanceof bs&&c.name==="error"||c instanceof Yf||c instanceof fr||c instanceof wc||c instanceof lu)return!1;const n=c instanceof Dl||c instanceof Da;let s=!0;return c.eachChild(u=>{s=n?s&&op(u):s&&u instanceof Bi}),!!s&&Xu(c)&&cu(c,["zoom","heatmap-density","line-progress","raster-value","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center","measure-light","raster-particle-speed"])}function Th(c,n){const s=c.length-1;let u,g,h=0,v=s,T=0;for(;h<=v;)if(T=Math.floor((h+v)/2),u=c[T],g=c[T+1],u<=n){if(T===s||n<g)return T;h=T+1}else{if(!(u>n))throw new pi("Input is not a number.");v=T-1}return 0}class Qu{constructor(n,s,u){this.type=n,this.input=s,this.labels=[],this.outputs=[];for(const[g,h]of u)this.labels.push(g),this.outputs.push(h)}static parse(n,s){if(n.length-1<4)return s.error(`Expected at least 4 arguments, but found only ${n.length-1}.`);if((n.length-1)%2!=0)return s.error("Expected an even number of arguments.");const u=s.parse(n[1],1,qn);if(!u)return null;const g=[];let h=null;s.expectedType&&s.expectedType.kind!=="value"&&(h=s.expectedType);for(let v=1;v<n.length;v+=2){const T=v===1?-1/0:n[v],A=n[v+1],D=v,x=v+1;if(typeof T!="number")return s.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',D);if(g.length&&g[g.length-1][0]>=T)return s.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',D);const P=s.parse(A,x,h);if(!P)return null;h=h||P.type,g.push([T,P])}return new Qu(h,u,g)}evaluate(n){const s=this.labels,u=this.outputs;if(s.length===1)return u[0].evaluate(n);const g=this.input.evaluate(n);if(g<=s[0])return u[0].evaluate(n);const h=s.length;return g>=s[h-1]?u[h-1].evaluate(n):u[Th(s,g)].evaluate(n)}eachChild(n){n(this.input);for(const s of this.outputs)n(s)}outputDefined(){return this.outputs.every(n=>n.outputDefined())}serialize(){const n=["step",this.input.serialize()];for(let s=0;s<this.labels.length;s++)s>0&&n.push(this.labels[s]),n.push(this.outputs[s].serialize());return n}}const du=.95047,Wr=1.08883,jy=4/29,ed=6/29,Hy=3*ed*ed,Gy=ed*ed*ed,Xx=Math.PI/180,Vo=180/Math.PI;function Ag(c){return c>Gy?Math.pow(c,1/3):c/Hy+jy}function kg(c){return c>ed?c*c*c:Hy*(c-jy)}function Pg(c){return 255*(c<=.0031308?12.92*c:1.055*Math.pow(c,1/2.4)-.055)}function Rg(c){return(c/=255)<=.04045?c/12.92:Math.pow((c+.055)/1.055,2.4)}function Wy(c){const n=Rg(c.r),s=Rg(c.g),u=Rg(c.b),g=Ag((.4124564*n+.3575761*s+.1804375*u)/du),h=Ag((.2126729*n+.7151522*s+.072175*u)/1);return{l:116*h-16,a:500*(g-h),b:200*(h-Ag((.0193339*n+.119192*s+.9503041*u)/Wr)),alpha:c.a}}function qy(c){let n=(c.l+16)/116,s=isNaN(c.a)?n:n+c.a/500,u=isNaN(c.b)?n:n-c.b/200;return n=1*kg(n),s=du*kg(s),u=Wr*kg(u),new io(Pg(3.2404542*s-1.5371385*n-.4985314*u),Pg(-.969266*s+1.8760108*n+.041556*u),Pg(.0556434*s-.2040259*n+1.0572252*u),c.alpha)}function Jx(c,n,s){const u=n-c;return c+s*(u>180||u<-180?u-360*Math.round(u/360):u)}const Ch={forward:Wy,reverse:qy,interpolate:function(c,n,s){return{l:cr(c.l,n.l,s),a:cr(c.a,n.a,s),b:cr(c.b,n.b,s),alpha:cr(c.alpha,n.alpha,s)}}},Eh={forward:function(c){const{l:n,a:s,b:u}=Wy(c),g=Math.atan2(u,s)*Vo;return{h:g<0?g+360:g,c:Math.sqrt(s*s+u*u),l:n,alpha:c.a}},reverse:function(c){const n=c.h*Xx,s=c.c;return qy({l:c.l,a:Math.cos(n)*s,b:Math.sin(n)*s,alpha:c.alpha})},interpolate:function(c,n,s){return{h:Jx(c.h,n.h,s),c:cr(c.c,n.c,s),l:cr(c.l,n.l,s),alpha:cr(c.alpha,n.alpha,s)}}};var Ky=Object.freeze({__proto__:null,hcl:Eh,lab:Ch});class Rs{constructor(n,s,u,g,h,v){this.type=n,this.operator=s,this.interpolation=u,this.input=g,this.dynamicStops=h,this.labels=[],this.outputs=[];for(const[T,A]of v)this.labels.push(T),this.outputs.push(A)}static interpolationFactor(n,s,u,g){let h=0;if(n.name==="exponential")h=Og(s,n.base,u,g);else if(n.name==="linear")h=Og(s,1,u,g);else if(n.name==="cubic-bezier"){const v=n.controlPoints;h=new Re(v[0],v[1],v[2],v[3]).solve(Og(s,1,u,g))}return h}static parse(n,s){let[u,g,h,...v]=n;if(!Array.isArray(g)||g.length===0)return s.error("Expected an interpolation type expression.",1);if(g[0]==="linear")g={name:"linear"};else if(g[0]==="exponential"){const D=g[1];if(typeof D!="number")return s.error("Exponential interpolation requires a numeric base.",1,1);g={name:"exponential",base:D}}else{if(g[0]!=="cubic-bezier")return s.error(`Unknown interpolation type ${String(g[0])}`,1,0);{const D=g.slice(1);if(D.length!==4||D.some(x=>typeof x!="number"||x<0||x>1))return s.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);g={name:"cubic-bezier",controlPoints:D}}}if(n.length-1<3)return s.error(`Expected at least 3 arguments, but found only ${n.length-1}.`);if(n.length-1>3&&(n.length-1)%2!=0)return s.error("Expected an even number of arguments.");if(h=s.parse(h,2,qn),!h)return null;const T=[];let A=null;if(u==="interpolate-hcl"||u==="interpolate-lab"?A=Yi:s.expectedType&&s.expectedType.kind!=="value"&&(A=s.expectedType),n.length-1==3){const D=s.parse(v[0],3,eo);return D?new Rs(A,u,g,h,D,T):null}for(let D=0;D<v.length;D+=2){const x=v[D],P=v[D+1],L=D+3,I=D+4;if(typeof x!="number")return s.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',L);if(T.length&&T[T.length-1][0]>=x)return s.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',L);const R=s.parse(P,I,A);if(!R)return null;A=A||R.type,T.push([x,R])}return A.kind==="number"||A.kind==="color"||A.kind==="array"&&A.itemType.kind==="number"&&typeof A.N=="number"?new Rs(A,u,g,h,null,T):s.error(`Type ${Qo(A)} is not interpolatable.`)}evaluate(n){let s=this.labels,u=this.outputs;if(this.dynamicStops){const x=this.dynamicStops.evaluate(n);if(x.length%2!=0)throw new pi("Expected an even number of arguments.");s=[],u=[];for(let P=0;P<x.length;P+=2){const L=x[P],I=new Bi(qn,x[P+1]);if(typeof L!="number")throw new pi('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.');if(s.length&&s[s.length-1]>=L)throw new pi('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.');s.push(L),u.push(I)}if(s.length===0)throw new pi("Expected at least one input/output pair.")}if(s.length===1)return u[0].evaluate(n);const g=this.input.evaluate(n);if(g<=s[0])return u[0].evaluate(n);const h=s.length;if(g>=s[h-1])return u[h-1].evaluate(n);const v=Th(s,g),T=Rs.interpolationFactor(this.interpolation,g,s[v],s[v+1]),A=u[v].evaluate(n),D=u[v+1].evaluate(n);return this.operator==="interpolate"?Gf[this.type.kind.toLowerCase()](A,D,T):this.operator==="interpolate-hcl"?Eh.reverse(Eh.interpolate(Eh.forward(A),Eh.forward(D),T)):Ch.reverse(Ch.interpolate(Ch.forward(A),Ch.forward(D),T))}eachChild(n){n(this.input);for(const s of this.outputs)n(s)}outputDefined(){return this.outputs.every(n=>n.outputDefined())}serialize(){let n;n=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const s=[this.operator,n,this.input.serialize()];if(this.dynamicStops)s.push(this.dynamicStops.serialize());else for(let u=0;u<this.labels.length;u++)s.push(this.labels[u],this.outputs[u].serialize());return s}}function Og(c,n,s,u){const g=u-s,h=c-s;return g===0?0:n===1?h/g:(Math.pow(n,h)-1)/(Math.pow(n,g)-1)}class ip{constructor(n,s){this.type=n,this.args=s}static parse(n,s){if(n.length<2)return s.error("Expectected at least one argument.");let u=null;const g=s.expectedType;g&&g.kind!=="value"&&(u=g);const h=[];for(const T of n.slice(1)){const A=s.parse(T,1+h.length,u,void 0,{typeAnnotation:"omit"});if(!A)return null;u=u||A.type,h.push(A)}const v=g&&h.some(T=>ys(g,T.type));return new ip(v?eo:u,h)}evaluate(n){let s,u=null,g=0;for(const h of this.args){if(g++,u=h.evaluate(n),u&&u instanceof Gi&&!u.available&&(s||(s=u),u=null,g===this.args.length))return s;if(u!==null)break}return u}eachChild(n){this.args.forEach(n)}outputDefined(){return this.args.every(n=>n.outputDefined())}serialize(){const n=["coalesce"];return this.eachChild(s=>{n.push(s.serialize())}),n}}class sp{constructor(n,s){this.type=s.type,this.bindings=[].concat(n),this.result=s}evaluate(n){return this.result.evaluate(n)}eachChild(n){for(const s of this.bindings)n(s[1]);n(this.result)}static parse(n,s){if(n.length<4)return s.error(`Expected at least 3 arguments, but found ${n.length-1} instead.`);const u=[];for(let h=1;h<n.length-1;h+=2){const v=n[h];if(typeof v!="string")return s.error(`Expected string, but found ${typeof v} instead.`,h);if(/[^a-zA-Z0-9_]/.test(v))return s.error("Variable names must contain only alphanumeric characters or '_'.",h);const T=s.parse(n[h+1],h+1);if(!T)return null;u.push([v,T])}const g=s.parse(n[n.length-1],n.length-1,s.expectedType,u);return g?new sp(u,g):null}outputDefined(){return this.result.outputDefined()}serialize(){const n=["let"];for(const[s,u]of this.bindings)n.push(s,u.serialize());return n.push(this.result.serialize()),n}}class Lg{constructor(n,s,u){this.type=n,this.index=s,this.input=u}static parse(n,s){if(n.length!==3)return s.error(`Expected 2 arguments, but found ${n.length-1} instead.`);const u=s.parse(n[1],1,qn),g=s.parse(n[2],2,Ni(s.expectedType||eo));return u&&g?new Lg(g.type.itemType,u,g):null}evaluate(n){const s=this.index.evaluate(n),u=this.input.evaluate(n);if(s<0)throw new pi(`Array index out of bounds: ${s} < 0.`);if(s>u.length-1)throw new pi(`Array index out of bounds: ${s} > ${u.length-1}.`);if(s===Math.floor(s))return u[s];const g=Math.floor(s),h=Math.ceil(s),v=u[g],T=u[h];if(typeof v!="number"||typeof T!="number")throw new pi(`Cannot interpolate between non-number values at index ${s}.`);const A=s-g;return v*(1-A)+T*A}eachChild(n){n(this.index),n(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}class Dg{constructor(n,s){this.type=Yr,this.needle=n,this.haystack=s}static parse(n,s){if(n.length!==3)return s.error(`Expected 2 arguments, but found ${n.length-1} instead.`);const u=s.parse(n[1],1,eo),g=s.parse(n[2],2,eo);return u&&g?Kf(u.type,[Yr,co,qn,eu,eo])?new Dg(u,g):s.error(`Expected first argument to be of type boolean, string, number or null, but found ${Qo(u.type)} instead`):null}evaluate(n){const s=this.needle.evaluate(n),u=this.haystack.evaluate(n);if(u==null)return!1;if(!uh(s,["boolean","string","number","null"]))throw new pi(`Expected first argument to be of type boolean, string, number or null, but found ${Qo(Yo(s))} instead.`);if(!uh(u,["string","array"]))throw new pi(`Expected second argument to be of type array or string, but found ${Qo(Yo(u))} instead.`);return u.indexOf(s)>=0}eachChild(n){n(this.needle),n(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}class ap{constructor(n,s,u){this.type=qn,this.needle=n,this.haystack=s,this.fromIndex=u}static parse(n,s){if(n.length<=2||n.length>=5)return s.error(`Expected 3 or 4 arguments, but found ${n.length-1} instead.`);const u=s.parse(n[1],1,eo),g=s.parse(n[2],2,eo);if(!u||!g)return null;if(!Kf(u.type,[Yr,co,qn,eu,eo]))return s.error(`Expected first argument to be of type boolean, string, number or null, but found ${Qo(u.type)} instead`);if(n.length===4){const h=s.parse(n[3],3,qn);return h?new ap(u,g,h):null}return new ap(u,g)}evaluate(n){const s=this.needle.evaluate(n),u=this.haystack.evaluate(n);if(!uh(s,["boolean","string","number","null"]))throw new pi(`Expected first argument to be of type boolean, string, number or null, but found ${Qo(Yo(s))} instead.`);if(!uh(u,["string","array"]))throw new pi(`Expected second argument to be of type array or string, but found ${Qo(Yo(u))} instead.`);if(this.fromIndex){const g=this.fromIndex.evaluate(n);return u.indexOf(s,g)}return u.indexOf(s)}eachChild(n){n(this.needle),n(this.haystack),this.fromIndex&&n(this.fromIndex)}outputDefined(){return!1}serialize(){if(this.fromIndex!=null&&this.fromIndex!==void 0){const n=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),n]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}class zg{constructor(n,s,u,g,h,v){this.inputType=n,this.type=s,this.input=u,this.cases=g,this.outputs=h,this.otherwise=v}static parse(n,s){if(n.length<5)return s.error(`Expected at least 4 arguments, but found only ${n.length-1}.`);if(n.length%2!=1)return s.error("Expected an even number of arguments.");let u,g;s.expectedType&&s.expectedType.kind!=="value"&&(g=s.expectedType);const h={},v=[];for(let D=2;D<n.length-1;D+=2){let x=n[D];const P=n[D+1];Array.isArray(x)||(x=[x]);const L=s.concat(D);if(x.length===0)return L.error("Expected at least one branch label.");for(const R of x){if(typeof R!="number"&&typeof R!="string")return L.error("Branch labels must be numbers or strings.");if(typeof R=="number"&&Math.abs(R)>Number.MAX_SAFE_INTEGER)return L.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof R=="number"&&Math.floor(R)!==R)return L.error("Numeric branch labels must be integer values.");if(u){if(L.checkSubtype(u,Yo(R)))return null}else u=Yo(R);if(h[String(R)]!==void 0)return L.error("Branch labels must be unique.");h[String(R)]=v.length}const I=s.parse(P,D,g);if(!I)return null;g=g||I.type,v.push(I)}const T=s.parse(n[1],1,eo);if(!T)return null;const A=s.parse(n[n.length-1],n.length-1,g);return A?T.type.kind!=="value"&&s.concat(1).checkSubtype(u,T.type)?null:new zg(u,g,T,h,v,A):null}evaluate(n){const s=this.input.evaluate(n);return(Yo(s)===this.inputType&&this.outputs[this.cases[s]]||this.otherwise).evaluate(n)}eachChild(n){n(this.input),this.outputs.forEach(n),n(this.otherwise)}outputDefined(){return this.outputs.every(n=>n.outputDefined())&&this.otherwise.outputDefined()}serialize(){const n=["match",this.input.serialize()],s=Object.keys(this.cases).sort(),u=[],g={};for(const v of s){const T=g[this.cases[v]];T===void 0?(g[this.cases[v]]=u.length,u.push([this.cases[v],[v]])):u[T][1].push(v)}const h=v=>this.inputType.kind==="number"?Number(v):v;for(const[v,T]of u)n.push(T.length===1?h(T[0]):T.map(h)),n.push(this.outputs[v].serialize());return n.push(this.otherwise.serialize()),n}}class Fg{constructor(n,s,u){this.type=n,this.branches=s,this.otherwise=u}static parse(n,s){if(n.length<4)return s.error(`Expected at least 3 arguments, but found only ${n.length-1}.`);if(n.length%2!=0)return s.error("Expected an odd number of arguments.");let u;s.expectedType&&s.expectedType.kind!=="value"&&(u=s.expectedType);const g=[];for(let v=1;v<n.length-1;v+=2){const T=s.parse(n[v],v,Yr);if(!T)return null;const A=s.parse(n[v+1],v+1,u);if(!A)return null;g.push([T,A]),u=u||A.type}const h=s.parse(n[n.length-1],n.length-1,u);return h?new Fg(u,g,h):null}evaluate(n){for(const[s,u]of this.branches)if(s.evaluate(n))return u.evaluate(n);return this.otherwise.evaluate(n)}eachChild(n){for(const[s,u]of this.branches)n(s),n(u);n(this.otherwise)}outputDefined(){return this.branches.every(([n,s])=>s.outputDefined())&&this.otherwise.outputDefined()}serialize(){const n=["case"];return this.eachChild(s=>{n.push(s.serialize())}),n}}class lp{constructor(n,s,u,g){this.type=n,this.input=s,this.beginIndex=u,this.endIndex=g}static parse(n,s){if(n.length<=2||n.length>=5)return s.error(`Expected 3 or 4 arguments, but found ${n.length-1} instead.`);const u=s.parse(n[1],1,eo),g=s.parse(n[2],2,qn);if(!u||!g)return null;if(!Kf(u.type,[Ni(eo),co,eo]))return s.error(`Expected first argument to be of type array or string, but found ${Qo(u.type)} instead`);if(n.length===4){const h=s.parse(n[3],3,qn);return h?new lp(u.type,u,g,h):null}return new lp(u.type,u,g)}evaluate(n){const s=this.input.evaluate(n),u=this.beginIndex.evaluate(n);if(!uh(s,["string","array"]))throw new pi(`Expected first argument to be of type array or string, but found ${Qo(Yo(s))} instead.`);if(this.endIndex){const g=this.endIndex.evaluate(n);return s.slice(u,g)}return s.slice(u)}eachChild(n){n(this.input),n(this.beginIndex),this.endIndex&&n(this.endIndex)}outputDefined(){return!1}serialize(){if(this.endIndex!=null&&this.endIndex!==void 0){const n=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),n]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}function Zy(c,n){return c==="=="||c==="!="?n.kind==="boolean"||n.kind==="string"||n.kind==="number"||n.kind==="null"||n.kind==="value":n.kind==="string"||n.kind==="number"||n.kind==="value"}function Yy(c,n,s,u){return u.compare(n,s)===0}function td(c,n,s){const u=c!=="=="&&c!=="!=";return class TB{constructor(h,v,T){this.type=Yr,this.lhs=h,this.rhs=v,this.collator=T,this.hasUntypedArgument=h.type.kind==="value"||v.type.kind==="value"}static parse(h,v){if(h.length!==3&&h.length!==4)return v.error("Expected two or three arguments.");const T=h[0];let A=v.parse(h[1],1,eo);if(!A)return null;if(!Zy(T,A.type))return v.concat(1).error(`"${T}" comparisons are not supported for type '${Qo(A.type)}'.`);let D=v.parse(h[2],2,eo);if(!D)return null;if(!Zy(T,D.type))return v.concat(2).error(`"${T}" comparisons are not supported for type '${Qo(D.type)}'.`);if(A.type.kind!==D.type.kind&&A.type.kind!=="value"&&D.type.kind!=="value")return v.error(`Cannot compare types '${Qo(A.type)}' and '${Qo(D.type)}'.`);u&&(A.type.kind==="value"&&D.type.kind!=="value"?A=new Da(D.type,[A]):A.type.kind!=="value"&&D.type.kind==="value"&&(D=new Da(A.type,[D])));let x=null;if(h.length===4){if(A.type.kind!=="string"&&D.type.kind!=="string"&&A.type.kind!=="value"&&D.type.kind!=="value")return v.error("Cannot use collator to compare non-string types.");if(x=v.parse(h[3],3,lh),!x)return null}return new TB(A,D,x)}evaluate(h){const v=this.lhs.evaluate(h),T=this.rhs.evaluate(h);if(u&&this.hasUntypedArgument){const A=Yo(v),D=Yo(T);if(A.kind!==D.kind||A.kind!=="string"&&A.kind!=="number")throw new pi(`Expected arguments for "${c}" to be (string, string) or (number, number), but found (${A.kind}, ${D.kind}) instead.`)}if(this.collator&&!u&&this.hasUntypedArgument){const A=Yo(v),D=Yo(T);if(A.kind!=="string"||D.kind!=="string")return n(h,v,T)}return this.collator?s(h,v,T,this.collator.evaluate(h)):n(h,v,T)}eachChild(h){h(this.lhs),h(this.rhs),this.collator&&h(this.collator)}outputDefined(){return!0}serialize(){const h=[c];return this.eachChild(v=>{h.push(v.serialize())}),h}}}const Qx=td("==",function(c,n,s){return n===s},Yy),ew=td("!=",function(c,n,s){return n!==s},function(c,n,s,u){return!Yy(0,n,s,u)}),tw=td("<",function(c,n,s){return n<s},function(c,n,s,u){return u.compare(n,s)<0}),nw=td(">",function(c,n,s){return n>s},function(c,n,s,u){return u.compare(n,s)>0}),rw=td("<=",function(c,n,s){return n<=s},function(c,n,s,u){return u.compare(n,s)<=0}),ow=td(">=",function(c,n,s){return n>=s},function(c,n,s,u){return u.compare(n,s)>=0});class Ng{constructor(n,s,u,g,h,v){this.type=co,this.number=n,this.locale=s,this.currency=u,this.unit=g,this.minFractionDigits=h,this.maxFractionDigits=v}static parse(n,s){if(n.length!==3)return s.error("Expected two arguments.");const u=s.parse(n[1],1,qn);if(!u)return null;const g=n[2];if(typeof g!="object"||Array.isArray(g))return s.error("NumberFormat options argument must be an object.");let h=null;if(g.locale&&(h=s.parseObjectValue(g.locale,2,"locale",co),!h))return null;let v=null;if(g.currency&&(v=s.parseObjectValue(g.currency,2,"currency",co),!v))return null;let T=null;if(g.unit&&(T=s.parseObjectValue(g.unit,2,"unit",co),!T))return null;let A=null;if(g["min-fraction-digits"]&&(A=s.parseObjectValue(g["min-fraction-digits"],2,"min-fraction-digits",qn),!A))return null;let D=null;return g["max-fraction-digits"]&&(D=s.parseObjectValue(g["max-fraction-digits"],2,"max-fraction-digits",qn),!D)?null:new Ng(u,h,v,T,A,D)}evaluate(n){return new Intl.NumberFormat(this.locale?this.locale.evaluate(n):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(n):void 0,unit:this.unit?this.unit.evaluate(n):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(n):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(n):void 0}).format(this.number.evaluate(n))}eachChild(n){n(this.number),this.locale&&n(this.locale),this.currency&&n(this.currency),this.unit&&n(this.unit),this.minFractionDigits&&n(this.minFractionDigits),this.maxFractionDigits&&n(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const n={};return this.locale&&(n.locale=this.locale.serialize()),this.currency&&(n.currency=this.currency.serialize()),this.unit&&(n.unit=this.unit.serialize()),this.minFractionDigits&&(n["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(n["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),n]}}class Bg{constructor(n){this.type=qn,this.input=n}static parse(n,s){if(n.length!==2)return s.error(`Expected 1 argument, but found ${n.length-1} instead.`);const u=s.parse(n[1],1);return u?u.type.kind!=="array"&&u.type.kind!=="string"&&u.type.kind!=="value"?s.error(`Expected argument of type string or array, but found ${Qo(u.type)} instead.`):new Bg(u):null}evaluate(n){const s=this.input.evaluate(n);if(typeof s=="string"||Array.isArray(s))return s.length;throw new pi(`Expected value to be of type string or array, but found ${Qo(Yo(s))} instead.`)}eachChild(n){n(this.input)}outputDefined(){return!1}serialize(){const n=["length"];return this.eachChild(s=>{n.push(s.serialize())}),n}}function cp(c){return function(){c=1831565813+(c|=0)|0;let n=Math.imul(c^c>>>15,1|c);return n=n+Math.imul(n^n>>>7,61|n)^n,((n^n>>>14)>>>0)/4294967296}}const nd={"==":Qx,"!=":ew,">":nw,"<":tw,">=":ow,"<=":rw,array:Da,at:Lg,boolean:Da,case:Fg,coalesce:ip,collator:Yf,format:tu,image:fh,in:Dg,"index-of":ap,interpolate:Rs,"interpolate-hcl":Rs,"interpolate-lab":Rs,length:Bg,let:sp,literal:Bi,match:zg,number:Da,"number-format":Ng,object:Da,slice:lp,step:Qu,string:Da,"to-boolean":Dl,"to-color":Dl,"to-number":Dl,"to-string":Dl,var:uu,within:fr,distance:wc,config:lu};function Vg(c,[n,s,u,g]){n=n.evaluate(c),s=s.evaluate(c),u=u.evaluate(c);const h=g?g.evaluate(c):1,v=fg(n,s,u,h);if(v)throw new pi(v);return new io(n/255*h,s/255*h,u/255*h,h)}function Xy(c,[n,s,u,g]){n=n.evaluate(c),s=s.evaluate(c),u=u.evaluate(c);const h=g?g.evaluate(c):1,v=function(D,x,P,L){return typeof D=="number"&&D>=0&&D<=360?typeof x=="number"&&x>=0&&x<=100&&typeof P=="number"&&P>=0&&P<=100?L===void 0||typeof L=="number"&&L>=0&&L<=1?null:`Invalid hsla value [${[D,x,P,L].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid hsla value [${(typeof L=="number"?[D,x,P,L]:[D,x,P]).join(", ")}]: 's', and 'l' must be between 0 and 100.`:`Invalid hsla value [${(typeof L=="number"?[D,x,P,L]:[D,x,P]).join(", ")}]: 'h' must be between 0 and 360.`}(n,s,u,h);if(v)throw new pi(v);const T=`hsla(${n}, ${s}%, ${u}%, ${h})`,A=io.parse(T);if(!A)throw new pi(`Failed to parse HSLA color: ${T}`);return A}function Jy(c,n){return c in n}function $g(c,n){const s=n[c];return s===void 0?null:s}function Sc(c){return{type:c}}function Ug(c){return{result:"success",value:c}}function Ws(c){return{result:"error",value:c}}function up(c,n){return!!c&&!!c.parameters&&c.parameters.indexOf(n)>-1}function Mh(c){return c["property-type"]==="data-driven"}function Qy(c){return up(c.expression,"measure-light")}function dp(c){return up(c.expression,"zoom")}function Ih(c){return!!c.expression&&c.expression.interpolated}function jg(c){return typeof c=="object"&&c!==null&&!Array.isArray(c)}function iw(c){return c}function Hg(c,n){const s=n.type==="color",u=c.stops&&typeof c.stops[0][0]=="object",g=u||!(u||c.property!==void 0),h=c.type||(Ih(n)?"exponential":"interval");if(s&&((c=Wf({},c)).stops&&(c.stops=c.stops.map(D=>[D[0],io.parse(D[1])])),c.default=io.parse(c.default?c.default:n.default)),c.colorSpace&&c.colorSpace!=="rgb"&&!Ky[c.colorSpace])throw new Error(`Unknown color space: ${c.colorSpace}`);let v,T,A;if(h==="exponential")v=e0;else if(h==="interval")v=aw;else if(h==="categorical"){v=sw,T=Object.create(null);for(const D of c.stops)T[D[0]]=D[1];A=typeof c.stops[0][0]}else{if(h!=="identity")throw new Error(`Unknown function type "${h}"`);v=t0}if(u){const D={},x=[];for(let I=0;I<c.stops.length;I++){const R=c.stops[I],V=R[0].zoom;D[V]===void 0&&(D[V]={zoom:V,type:c.type,property:c.property,default:c.default,stops:[]},x.push(V)),D[V].stops.push([R[0].value,R[1]])}const P=[];for(const I of x)P.push([D[I].zoom,Hg(D[I],n)]);const L={name:"linear"};return{kind:"composite",interpolationType:L,interpolationFactor:Rs.interpolationFactor.bind(void 0,L),zoomStops:P.map(I=>I[0]),evaluate:({zoom:I},R)=>e0({stops:P,base:c.base},n,I).evaluate(I,R)}}if(g){const D=h==="exponential"?{name:"exponential",base:c.base!==void 0?c.base:1}:null;return{kind:"camera",interpolationType:D,interpolationFactor:Rs.interpolationFactor.bind(void 0,D),zoomStops:c.stops.map(x=>x[0]),evaluate:({zoom:x})=>v(c,n,x,T,A)}}return{kind:"source",evaluate(D,x){const P=x&&x.properties?x.properties[c.property]:void 0;return P===void 0?rd(c.default,n.default):v(c,n,P,T,A)}}}function rd(c,n,s){return c!==void 0?c:n!==void 0?n:s!==void 0?s:void 0}function sw(c,n,s,u,g){return rd(typeof s===g?u[s]:void 0,c.default,n.default)}function aw(c,n,s){if(za(s)!=="number")return rd(c.default,n.default);const u=c.stops.length;if(u===1||s<=c.stops[0][0])return c.stops[0][1];if(s>=c.stops[u-1][0])return c.stops[u-1][1];const g=Th(c.stops.map(h=>h[0]),s);return c.stops[g][1]}function e0(c,n,s){const u=c.base!==void 0?c.base:1;if(za(s)!=="number")return rd(c.default,n.default);const g=c.stops.length;if(g===1||s<=c.stops[0][0])return c.stops[0][1];if(s>=c.stops[g-1][0])return c.stops[g-1][1];const h=Th(c.stops.map(x=>x[0]),s),v=function(x,P,L,I){const R=I-L,V=x-L;return R===0?0:P===1?V/R:(Math.pow(P,V)-1)/(Math.pow(P,R)-1)}(s,u,c.stops[h][0],c.stops[h+1][0]),T=c.stops[h][1],A=c.stops[h+1][1];let D=Gf[n.type]||iw;if(c.colorSpace&&c.colorSpace!=="rgb"){const x=Ky[c.colorSpace];D=(P,L)=>x.reverse(x.interpolate(x.forward(P),x.forward(L),v))}return typeof T.evaluate=="function"?{evaluate(...x){const P=T.evaluate.apply(void 0,x),L=A.evaluate.apply(void 0,x);if(P!==void 0&&L!==void 0)return D(P,L,v)}}:D(T,A,v)}function t0(c,n,s){return n.type==="color"?s=io.parse(s):n.type==="formatted"?s=Xi.fromString(s.toString()):n.type==="resolvedImage"?s=Gi.build(s.toString()):za(s)===n.type||n.type==="enum"&&n.values[s]||(s=void 0),rd(s,c.default,n.default)}bs.register(nd,{error:[{kind:"error"},[co],(c,[n])=>{throw new pi(n.evaluate(c))}],typeof:[co,[eo],(c,[n])=>Qo(Yo(n.evaluate(c)))],"to-rgba":[Ni(qn,4),[Yi],(c,[n])=>n.evaluate(c).toRenderColor(null).toArray()],"to-hsla":[Ni(qn,4),[Yi],(c,[n])=>n.evaluate(c).toRenderColor(null).toHslaArray()],rgb:[Yi,[qn,qn,qn],Vg],rgba:[Yi,[qn,qn,qn,qn],Vg],hsl:[Yi,[qn,qn,qn],Xy],hsla:[Yi,[qn,qn,qn,qn],Xy],has:{type:Yr,overloads:[[[co],(c,[n])=>Jy(n.evaluate(c),c.properties())],[[co,Ol],(c,[n,s])=>Jy(n.evaluate(c),s.evaluate(c))]]},get:{type:eo,overloads:[[[co],(c,[n])=>$g(n.evaluate(c),c.properties())],[[co,Ol],(c,[n,s])=>$g(n.evaluate(c),s.evaluate(c))]]},"feature-state":[eo,[co],(c,[n])=>$g(n.evaluate(c),c.featureState||{})],properties:[Ol,[],c=>c.properties()],"geometry-type":[co,[],c=>c.geometryType()],id:[eo,[],c=>c.id()],zoom:[qn,[],c=>c.globals.zoom],pitch:[qn,[],c=>c.globals.pitch||0],"distance-from-center":[qn,[],c=>c.distanceFromCenter()],"measure-light":[qn,[co],(c,[n])=>c.measureLight(n.evaluate(c))],"heatmap-density":[qn,[],c=>c.globals.heatmapDensity||0],"line-progress":[qn,[],c=>c.globals.lineProgress||0],"raster-value":[qn,[],c=>c.globals.rasterValue||0],"raster-particle-speed":[qn,[],c=>c.globals.rasterParticleSpeed||0],"sky-radial-progress":[qn,[],c=>c.globals.skyRadialProgress||0],accumulated:[eo,[],c=>c.globals.accumulated===void 0?null:c.globals.accumulated],"+":[qn,Sc(qn),(c,n)=>{let s=0;for(const u of n)s+=u.evaluate(c);return s}],"*":[qn,Sc(qn),(c,n)=>{let s=1;for(const u of n)s*=u.evaluate(c);return s}],"-":{type:qn,overloads:[[[qn,qn],(c,[n,s])=>n.evaluate(c)-s.evaluate(c)],[[qn],(c,[n])=>-n.evaluate(c)]]},"/":[qn,[qn,qn],(c,[n,s])=>n.evaluate(c)/s.evaluate(c)],"%":[qn,[qn,qn],(c,[n,s])=>n.evaluate(c)%s.evaluate(c)],ln2:[qn,[],()=>Math.LN2],pi:[qn,[],()=>Math.PI],e:[qn,[],()=>Math.E],"^":[qn,[qn,qn],(c,[n,s])=>Math.pow(n.evaluate(c),s.evaluate(c))],sqrt:[qn,[qn],(c,[n])=>Math.sqrt(n.evaluate(c))],log10:[qn,[qn],(c,[n])=>Math.log(n.evaluate(c))/Math.LN10],ln:[qn,[qn],(c,[n])=>Math.log(n.evaluate(c))],log2:[qn,[qn],(c,[n])=>Math.log(n.evaluate(c))/Math.LN2],sin:[qn,[qn],(c,[n])=>Math.sin(n.evaluate(c))],cos:[qn,[qn],(c,[n])=>Math.cos(n.evaluate(c))],tan:[qn,[qn],(c,[n])=>Math.tan(n.evaluate(c))],asin:[qn,[qn],(c,[n])=>Math.asin(n.evaluate(c))],acos:[qn,[qn],(c,[n])=>Math.acos(n.evaluate(c))],atan:[qn,[qn],(c,[n])=>Math.atan(n.evaluate(c))],min:[qn,Sc(qn),(c,n)=>Math.min(...n.map(s=>s.evaluate(c)))],max:[qn,Sc(qn),(c,n)=>Math.max(...n.map(s=>s.evaluate(c)))],abs:[qn,[qn],(c,[n])=>Math.abs(n.evaluate(c))],round:[qn,[qn],(c,[n])=>{const s=n.evaluate(c);return s<0?-Math.round(-s):Math.round(s)}],floor:[qn,[qn],(c,[n])=>Math.floor(n.evaluate(c))],ceil:[qn,[qn],(c,[n])=>Math.ceil(n.evaluate(c))],"filter-==":[Yr,[co,eo],(c,[n,s])=>c.properties()[n.value]===s.value],"filter-id-==":[Yr,[eo],(c,[n])=>c.id()===n.value],"filter-type-==":[Yr,[co],(c,[n])=>c.geometryType()===n.value],"filter-<":[Yr,[co,eo],(c,[n,s])=>{const u=c.properties()[n.value],g=s.value;return typeof u==typeof g&&u<g}],"filter-id-<":[Yr,[eo],(c,[n])=>{const s=c.id(),u=n.value;return typeof s==typeof u&&s<u}],"filter->":[Yr,[co,eo],(c,[n,s])=>{const u=c.properties()[n.value],g=s.value;return typeof u==typeof g&&u>g}],"filter-id->":[Yr,[eo],(c,[n])=>{const s=c.id(),u=n.value;return typeof s==typeof u&&s>u}],"filter-<=":[Yr,[co,eo],(c,[n,s])=>{const u=c.properties()[n.value],g=s.value;return typeof u==typeof g&&u<=g}],"filter-id-<=":[Yr,[eo],(c,[n])=>{const s=c.id(),u=n.value;return typeof s==typeof u&&s<=u}],"filter->=":[Yr,[co,eo],(c,[n,s])=>{const u=c.properties()[n.value],g=s.value;return typeof u==typeof g&&u>=g}],"filter-id->=":[Yr,[eo],(c,[n])=>{const s=c.id(),u=n.value;return typeof s==typeof u&&s>=u}],"filter-has":[Yr,[eo],(c,[n])=>n.value in c.properties()],"filter-has-id":[Yr,[],c=>c.id()!==null&&c.id()!==void 0],"filter-type-in":[Yr,[Ni(co)],(c,[n])=>n.value.indexOf(c.geometryType())>=0],"filter-id-in":[Yr,[Ni(eo)],(c,[n])=>n.value.indexOf(c.id())>=0],"filter-in-small":[Yr,[co,Ni(eo)],(c,[n,s])=>s.value.indexOf(c.properties()[n.value])>=0],"filter-in-large":[Yr,[co,Ni(eo)],(c,[n,s])=>function(u,g,h,v){for(;h<=v;){const T=h+v>>1;if(g[T]===u)return!0;g[T]>u?v=T-1:h=T+1}return!1}(c.properties()[n.value],s.value,0,s.value.length-1)],all:{type:Yr,overloads:[[[Yr,Yr],(c,[n,s])=>n.evaluate(c)&&s.evaluate(c)],[Sc(Yr),(c,n)=>{for(const s of n)if(!s.evaluate(c))return!1;return!0}]]},any:{type:Yr,overloads:[[[Yr,Yr],(c,[n,s])=>n.evaluate(c)||s.evaluate(c)],[Sc(Yr),(c,n)=>{for(const s of n)if(s.evaluate(c))return!0;return!1}]]},"!":[Yr,[Yr],(c,[n])=>!n.evaluate(c)],"is-supported-script":[Yr,[co],(c,[n])=>{const s=c.globals&&c.globals.isSupportedScript;return!s||s(n.evaluate(c))}],upcase:[co,[co],(c,[n])=>n.evaluate(c).toUpperCase()],downcase:[co,[co],(c,[n])=>n.evaluate(c).toLowerCase()],concat:[co,Sc(eo),(c,n)=>n.map(s=>ya(s.evaluate(c))).join("")],"resolved-locale":[co,[lh],(c,[n])=>n.evaluate(c).resolvedLocale()],random:[qn,[qn,qn,eo],(c,n)=>{const[s,u,g]=n.map(v=>v.evaluate(c));if(s>u||s===u)return s;let h;if(typeof g=="string")h=function(v){let T=0;if(v.length===0)return T;for(let A=0;A<v.length;A++)T=(T<<5)-T+v.charCodeAt(A),T|=0;return T}(g);else{if(typeof g!="number")throw new pi(`Invalid seed input: ${g}`);h=g}return s+cp(h)()*(u-s)}]});class hp{constructor(n,s,u,g){this.expression=n,this._warningHistory={},this._evaluator=new mg(u,g),this._defaultValue=s?function(h){return h.type==="color"&&(jg(h.default)||Array.isArray(h.default))?new io(0,0,0,0):h.type==="color"?io.parse(h.default)||null:h.default===void 0?null:h.default}(s):null,this._enumValues=s&&s.type==="enum"?s.values:null,this.configDependencies=wh(n)}evaluateWithoutErrorHandling(n,s,u,g,h,v,T,A){return this._evaluator.globals=n,this._evaluator.feature=s,this._evaluator.featureState=u,this._evaluator.canonical=g||null,this._evaluator.availableImages=h||null,this._evaluator.formattedSection=v,this._evaluator.featureTileCoord=T||null,this._evaluator.featureDistanceData=A||null,this.expression.evaluate(this._evaluator)}evaluate(n,s,u,g,h,v,T,A){this._evaluator.globals=n,this._evaluator.feature=s||null,this._evaluator.featureState=u||null,this._evaluator.canonical=g||null,this._evaluator.availableImages=h||null,this._evaluator.formattedSection=v||null,this._evaluator.featureTileCoord=T||null,this._evaluator.featureDistanceData=A||null;try{const D=this.expression.evaluate(this._evaluator);if(D==null||typeof D=="number"&&D!=D)return this._defaultValue;if(this._enumValues&&!(D in this._enumValues))throw new pi(`Expected value to be one of ${Object.keys(this._enumValues).map(x=>JSON.stringify(x)).join(", ")}, but found ${JSON.stringify(D)} instead.`);return D}catch(D){return this._warningHistory[D.message]||(this._warningHistory[D.message]=!0,typeof console<"u"&&console.warn(`Failed to evaluate expression "${JSON.stringify(this.expression.serialize())}". ${D.message}`)),this._defaultValue}}}function od(c){return Array.isArray(c)&&c.length>0&&typeof c[0]=="string"&&c[0]in nd}function id(c,n,s,u){const g=new Sh(nd,[],n?function(v){const T={color:Yi,string:co,number:qn,enum:co,boolean:Yr,formatted:rl,resolvedImage:ch};return v.type==="array"?Ni(T[v.value]||eo,v.length):T[v.type]}(n):void 0,void 0,void 0,s,u),h=g.parse(c,void 0,void 0,void 0,n&&n.type==="string"?{typeAnnotation:"coerce"}:void 0);return h?Ug(new hp(h,n,s,u)):Ws(g.errors)}class fp{constructor(n,s,u,g){this.kind=n,this._styleExpression=s,this.isLightConstant=u,this.isLineProgressConstant=g,this.isStateDependent=n!=="constant"&&!xh(s.expression),this.configDependencies=wh(s.expression)}evaluateWithoutErrorHandling(n,s,u,g,h,v){return this._styleExpression.evaluateWithoutErrorHandling(n,s,u,g,h,v)}evaluate(n,s,u,g,h,v){return this._styleExpression.evaluate(n,s,u,g,h,v)}}class Ah{constructor(n,s,u,g,h,v){this.kind=n,this.zoomStops=u,this._styleExpression=s,this.isStateDependent=n!=="camera"&&!xh(s.expression),this.isLightConstant=h,this.isLineProgressConstant=v,this.configDependencies=wh(s.expression),this.interpolationType=g}evaluateWithoutErrorHandling(n,s,u,g,h,v){return this._styleExpression.evaluateWithoutErrorHandling(n,s,u,g,h,v)}evaluate(n,s,u,g,h,v){return this._styleExpression.evaluate(n,s,u,g,h,v)}interpolationFactor(n,s,u){return this.interpolationType?Rs.interpolationFactor(this.interpolationType,n,s,u):0}}function n0(c,n,s,u){if((c=id(c,n,s,u)).result==="error")return c;const g=c.value.expression,h=Xu(g);if(!h&&!Mh(n))return Ws([new Fr("","data expressions not supported")]);const v=cu(g,["zoom","pitch","distance-from-center"]);if(!v&&!dp(n))return Ws([new Fr("","zoom expressions not supported")]);const T=cu(g,["measure-light"]);if(!T&&!Qy(n))return Ws([new Fr("","measure-light expression not supported")]);const A=cu(g,["line-progress"]);if(!A&&!function(P){return up(P.expression,"line-progress")}(n))return Ws([new Fr("","line-progress expression not supported")]);const D=n.expression&&n.expression.relaxZoomRestriction,x=Ph(g);return x||v||D?x instanceof Fr?Ws([x]):x instanceof Rs&&!Ih(n)?Ws([new Fr("",'"interpolate" expressions cannot be used with this property')]):Ug(x?new Ah(h&&A?"camera":"composite",c.value,x.labels,x instanceof Rs?x.interpolation:void 0,T,A):new fp(h&&A?"constant":"source",c.value,T,A)):Ws([new Fr("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression, or in the properties of atmosphere.')])}class kh{constructor(n,s){this._parameters=n,this._specification=s,Wf(this,Hg(this._parameters,this._specification))}static deserialize(n){return new kh(n._parameters,n._specification)}static serialize(n){return{_parameters:n._parameters,_specification:n._specification}}}function Ph(c){let n=null;if(c instanceof sp)n=Ph(c.result);else if(c instanceof ip){for(const s of c.args)if(n=Ph(s),n)break}else(c instanceof Qu||c instanceof Rs)&&c.input instanceof bs&&c.input.name==="zoom"&&(n=c);return n instanceof Fr||c.eachChild(s=>{const u=Ph(s);u instanceof Fr?n=u:n&&u&&n!==u&&(n=new Fr("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),n}var Gg,r0,lw=function(){if(r0)return Gg;r0=1,Gg=n;var c=3;function n(s,u,g){var h=this.cells=[];if(s instanceof ArrayBuffer){this.arrayBuffer=s;var v=new Int32Array(this.arrayBuffer);s=v[0],this.d=(u=v[1])+2*(g=v[2]);for(var T=0;T<this.d*this.d;T++){var A=v[c+T],D=v[c+T+1];h.push(A===D?null:v.subarray(A,D))}var x=v[c+h.length+1];this.keys=v.subarray(v[c+h.length],x),this.bboxes=v.subarray(x),this.insert=this._insertReadonly}else{this.d=u+2*g;for(var P=0;P<this.d*this.d;P++)h.push([]);this.keys=[],this.bboxes=[]}this.n=u,this.extent=s,this.padding=g,this.scale=u/s,this.uid=0;var L=g/u*s;this.min=-L,this.max=s+L}return n.prototype.insert=function(s,u,g,h,v){this._forEachCell(u,g,h,v,this._insertCell,this.uid++),this.keys.push(s),this.bboxes.push(u),this.bboxes.push(g),this.bboxes.push(h),this.bboxes.push(v)},n.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},n.prototype._insertCell=function(s,u,g,h,v,T){this.cells[v].push(T)},n.prototype.query=function(s,u,g,h,v){var T=this.min,A=this.max;if(s<=T&&u<=T&&A<=g&&A<=h&&!v)return Array.prototype.slice.call(this.keys);var D=[];return this._forEachCell(s,u,g,h,this._queryCell,D,{},v),D},n.prototype._queryCell=function(s,u,g,h,v,T,A,D){var x=this.cells[v];if(x!==null)for(var P=this.keys,L=this.bboxes,I=0;I<x.length;I++){var R=x[I];if(A[R]===void 0){var V=4*R;(D?D(L[V+0],L[V+1],L[V+2],L[V+3]):s<=L[V+2]&&u<=L[V+3]&&g>=L[V+0]&&h>=L[V+1])?(A[R]=!0,T.push(P[R])):A[R]=!1}}},n.prototype._forEachCell=function(s,u,g,h,v,T,A,D){for(var x=this._convertToCellCoord(s),P=this._convertToCellCoord(u),L=this._convertToCellCoord(g),I=this._convertToCellCoord(h),R=x;R<=L;R++)for(var V=P;V<=I;V++){var W=this.d*V+R;if((!D||D(this._convertFromCellCoord(R),this._convertFromCellCoord(V),this._convertFromCellCoord(R+1),this._convertFromCellCoord(V+1)))&&v.call(this,s,u,g,h,W,T,A,D))return}},n.prototype._convertFromCellCoord=function(s){return(s-this.padding)/this.scale},n.prototype._convertToCellCoord=function(s){return Math.max(0,Math.min(this.d-1,Math.floor(s*this.scale)+this.padding))},n.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var s=this.cells,u=c+this.cells.length+1+1,g=0,h=0;h<this.cells.length;h++)g+=this.cells[h].length;var v=new Int32Array(u+g+this.keys.length+this.bboxes.length);v[0]=this.extent,v[1]=this.n,v[2]=this.padding;for(var T=u,A=0;A<s.length;A++){var D=s[A];v[c+A]=T,v.set(D,T),T+=D.length}return v[c+s.length]=T,v.set(this.keys,T),v[c+s.length+1]=T+=this.keys.length,v.set(this.bboxes,T),T+=this.bboxes.length,v.buffer},Gg}(),hu=S(lw);const pp={};function Hn(c,n,s={}){Object.defineProperty(c,"_classRegistryKey",{value:n,writable:!1}),pp[n]={klass:c,omit:s.omit||[]}}Hn(Object,"Object"),hu.serialize=function(c,n){const s=c.toArrayBuffer();return n&&n.add(s),{buffer:s}},hu.deserialize=function(c){return new hu(c.buffer)},Object.defineProperty(hu,"name",{value:"Grid"}),Hn(hu,"Grid"),typeof DOMMatrix<"u"&&Hn(DOMMatrix,"DOMMatrix"),Hn(io,"Color"),Hn(Error,"Error"),Hn(Xi,"Formatted"),Hn(dh,"FormattedSection"),Hn(fi,"AJAXError"),Hn(Gi,"ResolvedImage"),Hn(kh,"StylePropertyFunction"),Hn(hp,"StyleExpression",{omit:["_evaluator"]}),Hn(ol,"ImageIdWithOptions"),Hn(Ah,"ZoomDependentExpression"),Hn(fp,"ZoomConstantExpression"),Hn(bs,"CompoundExpression",{omit:["_evaluate"]});for(const c in nd)pp[nd[c]._classRegistryKey]||Hn(nd[c],`Expression${c}`);function Wg(c){return c&&typeof ArrayBuffer<"u"&&(c instanceof ArrayBuffer||c.constructor&&c.constructor.name==="ArrayBuffer")}function qg(c){return self.ImageBitmap&&c instanceof ImageBitmap}function Tc(c,n){if(c==null||typeof c=="boolean"||typeof c=="number"||typeof c=="string"||c instanceof Boolean||c instanceof Number||c instanceof String||c instanceof Date||c instanceof RegExp)return c;if(Wg(c)||qg(c))return n&&n.add(c),c;if(ArrayBuffer.isView(c))return n&&n.add(c.buffer),c;if(c instanceof ImageData)return n&&n.add(c.data.buffer),c;if(Array.isArray(c)){const s=[];for(const u of c)s.push(Tc(u,n));return s}if(c instanceof Map){const s={$name:"Map"};for(const[u,g]of c.entries())s[u]=Tc(g);return s}if(c instanceof Set){const s={$name:"Set"};let u=0;for(const g of c.values())s[++u]=Tc(g);return s}if(typeof c=="object"){const s=c.constructor,u=s._classRegistryKey;if(!u)throw new Error(`Can't serialize object of unregistered class "${u}".`);const g=s.serialize?s.serialize(c,n):{};if(!s.serialize){for(const h in c)c.hasOwnProperty(h)&&(pp[u].omit.indexOf(h)>=0||(g[h]=Tc(c[h],n)));c instanceof Error&&(g.message=c.message)}if(g.$name)throw new Error("$name property is reserved for worker serialization logic.");return u!=="Object"&&(g.$name=u),g}throw new Error("can't serialize object of type "+typeof c)}function fu(c){if(c==null||typeof c=="boolean"||typeof c=="number"||typeof c=="string"||c instanceof Boolean||c instanceof Number||c instanceof String||c instanceof Date||c instanceof RegExp||Wg(c)||qg(c)||ArrayBuffer.isView(c)||c instanceof ImageData)return c;if(Array.isArray(c))return c.map(fu);if(typeof c=="object"){const n=c.$name||"Object";if(n==="Map"){const g=new Map;for(const h of Object.keys(c))h!=="$name"&&g.set(h,fu(c[h]));return g}if(n==="Set"){const g=new Set;for(const h of Object.keys(c))h!=="$name"&&g.add(fu(c[h]));return g}const{klass:s}=pp[n];if(!s)throw new Error(`Can't deserialize unregistered class "${n}".`);if(s.deserialize)return s.deserialize(c);const u=Object.create(s.prototype);for(const g of Object.keys(c))g!=="$name"&&(u[g]=fu(c[g]));return u}throw new Error("can't deserialize object of type "+typeof c)}const Xn={"Latin-1 Supplement":c=>c>=128&&c<=255,Arabic:c=>c>=1536&&c<=1791,"Arabic Supplement":c=>c>=1872&&c<=1919,"Arabic Extended-A":c=>c>=2208&&c<=2303,"Hangul Jamo":c=>c>=4352&&c<=4607,"Unified Canadian Aboriginal Syllabics":c=>c>=5120&&c<=5759,Khmer:c=>c>=6016&&c<=6143,"Unified Canadian Aboriginal Syllabics Extended":c=>c>=6320&&c<=6399,"General Punctuation":c=>c>=8192&&c<=8303,"Letterlike Symbols":c=>c>=8448&&c<=8527,"Number Forms":c=>c>=8528&&c<=8591,"Miscellaneous Technical":c=>c>=8960&&c<=9215,"Control Pictures":c=>c>=9216&&c<=9279,"Optical Character Recognition":c=>c>=9280&&c<=9311,"Enclosed Alphanumerics":c=>c>=9312&&c<=9471,"Geometric Shapes":c=>c>=9632&&c<=9727,"Miscellaneous Symbols":c=>c>=9728&&c<=9983,"Miscellaneous Symbols and Arrows":c=>c>=11008&&c<=11263,"CJK Radicals Supplement":c=>c>=11904&&c<=12031,"Kangxi Radicals":c=>c>=12032&&c<=12255,"Ideographic Description Characters":c=>c>=12272&&c<=12287,"CJK Symbols and Punctuation":c=>c>=12288&&c<=12351,Hiragana:c=>c>=12352&&c<=12447,Katakana:c=>c>=12448&&c<=12543,Bopomofo:c=>c>=12544&&c<=12591,"Hangul Compatibility Jamo":c=>c>=12592&&c<=12687,Kanbun:c=>c>=12688&&c<=12703,"Bopomofo Extended":c=>c>=12704&&c<=12735,"CJK Strokes":c=>c>=12736&&c<=12783,"Katakana Phonetic Extensions":c=>c>=12784&&c<=12799,"Enclosed CJK Letters and Months":c=>c>=12800&&c<=13055,"CJK Compatibility":c=>c>=13056&&c<=13311,"CJK Unified Ideographs Extension A":c=>c>=13312&&c<=19903,"Yijing Hexagram Symbols":c=>c>=19904&&c<=19967,"CJK Unified Ideographs":c=>c>=19968&&c<=40959,"Yi Syllables":c=>c>=40960&&c<=42127,"Yi Radicals":c=>c>=42128&&c<=42191,"Hangul Jamo Extended-A":c=>c>=43360&&c<=43391,"Hangul Syllables":c=>c>=44032&&c<=55215,"Hangul Jamo Extended-B":c=>c>=55216&&c<=55295,"Private Use Area":c=>c>=57344&&c<=63743,"CJK Compatibility Ideographs":c=>c>=63744&&c<=64255,"Arabic Presentation Forms-A":c=>c>=64336&&c<=65023,"Vertical Forms":c=>c>=65040&&c<=65055,"CJK Compatibility Forms":c=>c>=65072&&c<=65103,"Small Form Variants":c=>c>=65104&&c<=65135,"Arabic Presentation Forms-B":c=>c>=65136&&c<=65279,"Halfwidth and Fullwidth Forms":c=>c>=65280&&c<=65519,Osage:c=>c>=66736&&c<=66815,"CJK Unified Ideographs Extension B":c=>c>=131072&&c<=173791};function Kg(c){for(const n of c)if(mp(n.charCodeAt(0)))return!0;return!1}function cw(c){for(const n of c)if(!uw(n.charCodeAt(0)))return!1;return!0}function uw(c){return!(Xn.Arabic(c)||Xn["Arabic Supplement"](c)||Xn["Arabic Extended-A"](c)||Xn["Arabic Presentation Forms-A"](c)||Xn["Arabic Presentation Forms-B"](c))}function mp(c){return!(c!==746&&c!==747&&(c<4352||!(Xn["Bopomofo Extended"](c)||Xn.Bopomofo(c)||Xn["CJK Compatibility Forms"](c)&&!(c>=65097&&c<=65103)||Xn["CJK Compatibility Ideographs"](c)||Xn["CJK Compatibility"](c)||Xn["CJK Radicals Supplement"](c)||Xn["CJK Strokes"](c)||!(!Xn["CJK Symbols and Punctuation"](c)||c>=12296&&c<=12305||c>=12308&&c<=12319||c===12336)||Xn["CJK Unified Ideographs Extension A"](c)||Xn["CJK Unified Ideographs"](c)||Xn["Enclosed CJK Letters and Months"](c)||Xn["Hangul Compatibility Jamo"](c)||Xn["Hangul Jamo Extended-A"](c)||Xn["Hangul Jamo Extended-B"](c)||Xn["Hangul Jamo"](c)||Xn["Hangul Syllables"](c)||Xn.Hiragana(c)||Xn["Ideographic Description Characters"](c)||Xn.Kanbun(c)||Xn["Kangxi Radicals"](c)||Xn["Katakana Phonetic Extensions"](c)||Xn.Katakana(c)&&c!==12540||!(!Xn["Halfwidth and Fullwidth Forms"](c)||c===65288||c===65289||c===65293||c>=65306&&c<=65310||c===65339||c===65341||c===65343||c>=65371&&c<=65503||c===65507||c>=65512&&c<=65519)||!(!Xn["Small Form Variants"](c)||c>=65112&&c<=65118||c>=65123&&c<=65126)||Xn["Unified Canadian Aboriginal Syllabics"](c)||Xn["Unified Canadian Aboriginal Syllabics Extended"](c)||Xn["Vertical Forms"](c)||Xn["Yijing Hexagram Symbols"](c)||Xn["Yi Syllables"](c)||Xn["Yi Radicals"](c))))}function Zg(c){return!(mp(c)||function(n){return!!(Xn["Latin-1 Supplement"](n)&&(n===167||n===169||n===174||n===177||n===188||n===189||n===190||n===215||n===247)||Xn["General Punctuation"](n)&&(n===8214||n===8224||n===8225||n===8240||n===8241||n===8251||n===8252||n===8258||n===8263||n===8264||n===8265||n===8273)||Xn["Letterlike Symbols"](n)||Xn["Number Forms"](n)||Xn["Miscellaneous Technical"](n)&&(n>=8960&&n<=8967||n>=8972&&n<=8991||n>=8996&&n<=9e3||n===9003||n>=9085&&n<=9114||n>=9150&&n<=9165||n===9167||n>=9169&&n<=9179||n>=9186&&n<=9215)||Xn["Control Pictures"](n)&&n!==9251||Xn["Optical Character Recognition"](n)||Xn["Enclosed Alphanumerics"](n)||Xn["Geometric Shapes"](n)||Xn["Miscellaneous Symbols"](n)&&!(n>=9754&&n<=9759)||Xn["Miscellaneous Symbols and Arrows"](n)&&(n>=11026&&n<=11055||n>=11088&&n<=11097||n>=11192&&n<=11243)||Xn["CJK Symbols and Punctuation"](n)||Xn.Katakana(n)||Xn["Private Use Area"](n)||Xn["CJK Compatibility Forms"](n)||Xn["Small Form Variants"](n)||Xn["Halfwidth and Fullwidth Forms"](n)||n===8734||n===8756||n===8757||n>=9984&&n<=10087||n>=10102&&n<=10131||n===65532||n===65533)}(c))}function Yg(c){return c>=1424&&c<=2303||Xn["Arabic Presentation Forms-A"](c)||Xn["Arabic Presentation Forms-B"](c)}function o0(c,n){return!(!n&&Yg(c)||c>=2304&&c<=3583||c>=3840&&c<=4255||Xn.Khmer(c))}function Xg(c){for(const n of c)if(Yg(n.charCodeAt(0)))return!0;return!1}const Rh="deferred",gp="loading",Jg="loaded";let il=null,Os="unavailable",Cc=null;const Qg=function(c){c&&typeof c=="string"&&c.indexOf("NetworkError")>-1&&(Os="error"),il&&il(c)};function ev(){sd.fire(new nl("pluginStateChange",{pluginStatus:Os,pluginURL:Cc}))}const sd=new yc,vp=function(){return Os},Oh=function(){if(Os!==Rh||!Cc)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");Os=gp,ev(),Cc&&ki({url:Cc},c=>{c?Qg(c):(Os=Jg,ev())})},qs={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>Os===Jg||qs.applyArabicShaping!=null,isLoading:()=>Os===gp,setState(c){Os=c.pluginStatus,Cc=c.pluginURL},isParsed:()=>qs.applyArabicShaping!=null&&qs.processBidirectionalText!=null&&qs.processStyledBidirectionalText!=null,getPluginURL:()=>Cc};class zo{constructor(n,s){this.zoom=n,s?(this.now=s.now,this.fadeDuration=s.fadeDuration,this.transition=s.transition,this.pitch=s.pitch,this.brightness=s.brightness):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0,this.brightness=0)}isSupportedScript(n){return function(s,u){for(const g of s)if(!o0(g.charCodeAt(0),u))return!1;return!0}(n,qs.isLoaded())}}class _p{constructor(n,s,u,g){this.property=n,this.value=s,this.expression=function(h,v,T,A){if(jg(h))return new kh(h,v);if(od(h)||Array.isArray(h)&&h.length>0){const D=n0(h,v,T,A);if(D.result==="error")throw new Error(D.value.map(x=>`${x.key}: ${x.message}`).join(", "));return D.value}{let D=h;return typeof h=="string"&&v.type==="color"&&(D=io.parse(h)),{kind:"constant",configDependencies:new Set,evaluate:()=>D}}}(s===void 0?n.specification.default:s,n.specification,u,g)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(n,s,u){return this.property.possiblyEvaluate(this,n,s,u)}}class Lh{constructor(n,s,u){this.property=n,this.value=new _p(n,void 0,s,u)}transitioned(n,s){return new tv(this.property,this.value,s,tr({},n.transition,this.transition),n.now)}untransitioned(){return new tv(this.property,this.value,null,{},0)}}class yp{constructor(n,s,u){this._properties=n,this._values=Object.create(n.defaultTransitionablePropertyValues),this._scope=s,this._options=u,this.configDependencies=new Set}getValue(n){return tt(this._values[n].value.value)}setValue(n,s){this._values.hasOwnProperty(n)||(this._values[n]=new Lh(this._values[n].property,this._scope,this._options)),this._values[n].value=new _p(this._values[n].property,s===null?void 0:tt(s),this._scope,this._options),this._values[n].value.expression.configDependencies&&(this.configDependencies=new Set([...this.configDependencies,...this._values[n].value.expression.configDependencies]))}setTransitionOrValue(n,s){s&&(this._options=s);const u=this._properties.properties;if(n)for(const g in n){const h=n[g];if(Gt(g,"-transition")){const v=g.slice(0,-11);u[v]&&this.setTransition(v,h)}else u.hasOwnProperty(g)&&this.setValue(g,h)}}getTransition(n){return tt(this._values[n].transition)}setTransition(n,s){this._values.hasOwnProperty(n)||(this._values[n]=new Lh(this._values[n].property)),this._values[n].transition=tt(s)||void 0}serialize(){const n={};for(const s of Object.keys(this._values)){const u=this.getValue(s);u!==void 0&&(n[s]=u);const g=this.getTransition(s);g!==void 0&&(n[`${s}-transition`]=g)}return n}transitioned(n,s){const u=new Dh(this._properties);for(const g of Object.keys(this._values))u._values[g]=this._values[g].transitioned(n,s._values[g]);return u}untransitioned(){const n=new Dh(this._properties);for(const s of Object.keys(this._values))n._values[s]=this._values[s].untransitioned();return n}}class tv{constructor(n,s,u,g,h){const v=g.delay||0,T=g.duration||0;h=h||0,this.property=n,this.value=s,this.begin=h+v,this.end=this.begin+T,n.specification.transition&&(g.delay||g.duration)&&(this.prior=u)}possiblyEvaluate(n,s,u){const g=n.now||0,h=this.value.possiblyEvaluate(n,s,u),v=this.prior;if(v){if(g>this.end)return this.prior=null,h;if(this.value.isDataDriven())return this.prior=null,h;if(g<this.begin)return v.possiblyEvaluate(n,s,u);{const T=(g-this.begin)/(this.end-this.begin);return this.property.interpolate(v.possiblyEvaluate(n,s,u),h,an(T))}}return h}}class Dh{constructor(n){this._properties=n,this._values=Object.create(n.defaultTransitioningPropertyValues)}possiblyEvaluate(n,s,u){const g=new cd(this._properties);for(const h of Object.keys(this._values))g._values[h]=this._values[h].possiblyEvaluate(n,s,u);return g}hasTransition(){for(const n of Object.keys(this._values))if(this._values[n].prior)return!0;return!1}}class ad{constructor(n,s,u){this._properties=n,this._values=Object.create(n.defaultPropertyValues),this._scope=s,this._options=u,this.configDependencies=new Set}getValue(n){return tt(this._values[n].value)}setValue(n,s){this._values[n]=new _p(this._values[n].property,s===null?void 0:tt(s),this._scope,this._options),this._values[n].expression.configDependencies&&(this.configDependencies=new Set([...this.configDependencies,...this._values[n].expression.configDependencies]))}serialize(){const n={};for(const s of Object.keys(this._values)){const u=this.getValue(s);u!==void 0&&(n[s]=u)}return n}possiblyEvaluate(n,s,u){const g=new cd(this._properties);for(const h of Object.keys(this._values))g._values[h]=this._values[h].possiblyEvaluate(n,s,u);return g}}class ld{constructor(n,s,u){this.property=n,this.value=s,this.parameters=u}isConstant(){return this.value.kind==="constant"}constantOr(n){return this.value.kind==="constant"?this.value.value:n}evaluate(n,s,u,g){return this.property.evaluate(this.value,this.parameters,n,s,u,g)}}class cd{constructor(n){this._properties=n,this._values=Object.create(n.defaultPossiblyEvaluatedValues)}get(n){return this._values[n]}}class xn{constructor(n){this.specification=n}possiblyEvaluate(n,s){return n.expression.evaluate(s)}interpolate(n,s,u){const g=Gf[this.specification.type];return g?g(n,s,u):n}}class zn{constructor(n,s){this.specification=n,this.overrides=s}possiblyEvaluate(n,s,u,g){return new ld(this,n.expression.kind==="constant"||n.expression.kind==="camera"?{kind:"constant",value:n.expression.evaluate(s,null,{},u,g)}:n.expression,s)}interpolate(n,s,u){if(n.value.kind!=="constant"||s.value.kind!=="constant")return n;if(n.value.value===void 0||s.value.value===void 0)return new ld(this,{kind:"constant",value:void 0},n.parameters);const g=Gf[this.specification.type];return g?new ld(this,{kind:"constant",value:g(n.value.value,s.value.value,u)},n.parameters):n}evaluate(n,s,u,g,h,v){return n.kind==="constant"?n.value:n.evaluate(s,u,g,h,v)}}class ud{constructor(n){this.specification=n}possiblyEvaluate(n,s,u,g){return!!n.expression.evaluate(s,null,{},u,g)}interpolate(){return!1}}class Wo{constructor(n){this.properties=n,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const s=new zo(0,{});for(const u in n){const g=n[u];g.specification.overridable&&this.overridableProperties.push(u);const h=this.defaultPropertyValues[u]=new _p(g,void 0),v=this.defaultTransitionablePropertyValues[u]=new Lh(g);this.defaultTransitioningPropertyValues[u]=v.untransitioned(),this.defaultPossiblyEvaluatedValues[u]=h.possiblyEvaluate(s)}}}Hn(zn,"DataDrivenProperty"),Hn(xn,"DataConstantProperty"),Hn(ud,"ColorRampProperty");var Lt=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"fragment":{"type":"boolean"},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360},"pitch":{"type":"number","default":0},"light":{"type":"light"},"lights":{"required":false,"type":"array","value":"light-3d"},"terrain":{"type":"terrain","optional":true},"fog":{"type":"fog"},"snow":{"type":"snow","experimental":true},"rain":{"type":"rain","experimental":true},"camera":{"type":"camera"},"color-theme":{"type":"colorTheme"},"indoor":{"type":"indoor","experimental":true},"imports":{"type":"array","value":"import"},"schema":{"type":"schema"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string","default":"mapbox://fonts/mapbox/{fontstack}/{range}.pbf"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"},"models":{"type":"models"},"featuresets":{"experimental":true,"type":"featuresets"}},"featuresets":{"experimental":true,"*":{"type":"featureset"}},"featureset":{"experimental":true,"metadata":{"experimental":true,"type":"*"},"selectors":{"experimental":true,"type":"array","value":"selector"}},"selector":{"experimental":true,"layer":{"experimental":true,"type":"string","required":true},"properties":{"experimental":true,"type":"selectorProperty","required":false},"featureNamespace":{"experimental":true,"type":"string","required":false},"_uniqueFeatureID":{"experimental":true,"type":"boolean","private":true,"required":false}},"selectorProperty":{"experimental":true,"*":{"experimental":true,"type":"*"}},"model":{"type":"string","required":true},"import":{"id":{"type":"string","required":true},"url":{"type":"string","required":true},"config":{"type":"config"},"data":{"type":"$root"},"color-theme":{"type":"colorTheme","optional":true}},"config":{"*":{"type":"*"}},"schema":{"*":{"type":"option"}},"option":{"default":{"type":"*","property-type":"data-constant","expression":{},"required":true},"type":{"type":"enum","values":{"string":1,"number":1,"boolean":1,"color":1}},"array":{"type":"boolean"},"minValue":{"type":"number"},"maxValue":{"type":"number"},"stepValue":{"type":"number"},"values":{"type":"array","value":"*"},"metadata":{"type":"*"}},"models":{"*":{"type":"model"}},"light-3d":{"id":{"type":"string","required":true},"properties":{"type":"properties"},"type":{"type":"enum","values":{"ambient":{},"directional":{},"flat":{}}}},"properties":["properties_light_directional","properties_light_ambient","properties_light_flat"],"properties_light_directional":{"direction":{"type":"array","default":[210,30],"minimum":[0,0],"maximum":[360,90],"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"cast-shadows":{"type":"boolean","default":false,"property-type":"data-constant"},"shadow-quality":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"expression":{"parameters":["zoom"]},"experimental":true},"shadow-intensity":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_ambient":{"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_flat":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"property-type":"data-constant","expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_raster_array","source_geojson","source_video","source_image","source_model"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":1,"mapbox":1},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_array":{"experimental":true,"type":{"required":true,"type":"enum","values":{"raster-array":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"rasterLayers":{"type":"*"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":1}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"minzoom":{"type":"number","default":0},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"},"dynamic":{"type":"boolean","default":false}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":1}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":1}},"url":{"required":false,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_model":{"type":{"required":true,"type":"enum","values":{"model":1,"batched-model":1}},"maxzoom":{"type":"number","default":18},"minzoom":{"type":"number","default":0},"tiles":{"type":"array","value":"string"}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"raster-particle":{"experimental":true},"hillshade":{},"model":{"experimental":true},"background":{},"sky":{},"slot":{},"clip":{}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"slot":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_clip","layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_raster-particle","layout_hillshade","layout_background","layout_sky","layout_model"],"layout_background":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_model":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"model-id":{"type":"string","default":"","property-type":"data-driven","expression":{"parameters":["zoom","feature"]}}},"layout_clip":{"clip-layer-types":{"type":"array","value":"enum","values":{"model":1,"symbol":1},"default":[],"expression":{},"property-type":"data-constant"},"clip-layer-scope":{"type":"array","value":"string","default":[],"expression":{},"property-type":"data-constant"}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"fill-elevation-reference":{"type":"enum","values":{"none":1,"hd-road-base":1,"hd-road-markup":1},"default":"none","experimental":true,"private":true,"expression":{},"property-type":"data-constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"circle-elevation-reference":{"type":"enum","values":{"none":1,"hd-road-markup":1},"default":"none","experimental":true,"expression":{},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"fill-extrusion-edge-radius":{"type":"number","experimental":true,"default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":1,"round":1,"square":1},"default":"butt","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":1,"round":1,"miter":1,"none":1},"default":"miter","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-z-offset":{"type":"number","experimental":true,"default":0,"expression":{"parameters":["zoom","feature","line-progress"]},"property-type":"data-driven"},"line-elevation-reference":{"type":"enum","values":{"none":1,"sea":1,"ground":1,"hd-road-markup":1},"default":"none","experimental":true,"expression":{},"property-type":"data-constant"},"line-cross-slope":{"type":"number","experimental":true,"expression":{},"property-type":"constant"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"line-width-unit":{"type":"enum","values":{"pixels":1,"meters":1},"default":"pixels","experimental":true,"private":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":1,"line":1,"line-center":1},"default":"point","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":1,"viewport-y":1,"source":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-z-elevate":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-elevation-reference":{"type":"enum","values":{"sea":1,"ground":1,"hd-road-markup":1},"default":"ground","experimental":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-size-scale-range":{"type":"array","value":"number","length":2,"default":[0.8,2],"minimum":0.1,"maximum":10,"experimental":true,"private":true,"expression":{},"property-type":"data-constant"},"icon-text-fit":{"type":"enum","values":{"none":1,"width":1,"height":1,"both":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size-scale-range":{"type":"array","value":"number","length":2,"default":[0.8,2],"minimum":0.1,"maximum":10,"experimental":true,"private":true,"expression":{},"property-type":"data-constant"},"text-max-width":{"type":"number","default":10,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":1,"left":1,"center":1,"right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","default":0,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":1,"vertical":1},"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":1,"uppercase":1,"lowercase":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","length":2,"default":[0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_raster-particle":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_hillshade":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_raster":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_raster-particle":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_clip":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_model":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":1,"!=":1,">":1,">=":1,"<":1,"<=":1,"in":1,"!in":1,"all":1,"any":1,"none":1,"has":1,"!has":1}},"geometry_type":{"type":"enum","values":{"Point":1,"LineString":1,"Polygon":1}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":1,"exponential":1,"interval":1,"categorical":1},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":1,"lab":1,"hcl":1},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"high-color":{"type":"color","property-type":"data-constant","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"space-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"star-intensity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vertical-range":{"type":"array","default":[0,0],"minimum":0,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}}},"snow":{"density":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],11,0,13,0.85],"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"opacity":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],11,0,13,0.3],"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette-color":{"type":"color","property-type":"data-constant","default":"#ffffff","experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"center-thinning":{"type":"number","property-type":"data-constant","default":0.4,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"direction":{"type":"array","default":[0,50],"minimum":0,"maximum":360,"length":2,"value":"number","property-type":"data-constant","transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"flake-size":{"type":"number","property-type":"data-constant","default":0.71,"minimum":0,"maximum":5,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true}},"rain":{"density":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],11,0,13,0.5],"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["measure-light","brightness"],0,"#03113d",0.3,"#a8adbc"],"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"opacity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["measure-light","brightness"],0,0.88,1,0.7],"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],11,0,13,1],"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["measure-light","brightness"],0,"#001736",0.3,"#464646"],"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"center-thinning":{"type":"number","property-type":"data-constant","default":0.57,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"direction":{"type":"array","default":[0,80],"minimum":0,"maximum":360,"length":2,"value":"number","property-type":"data-constant","transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"droplet-size":{"type":"array","default":[2.6,18.2],"minimum":0,"maximum":50,"length":2,"value":"number","property-type":"data-constant","transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"distortion-strength":{"type":"number","property-type":"data-constant","default":0.7,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true}},"camera":{"camera-projection":{"type":"enum","values":{"perspective":1,"orthographic":1},"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"default":"perspective","property-type":"data-constant"}},"colorTheme":{"data":{"type":"string","property-type":"data-constant","expression":{}}},"indoor":{"floorplanFeaturesetId":{"type":"string","experimental":true,"property-type":"data-constant","expression":{}},"buildingFeaturesetId":{"type":"string","experimental":true,"property-type":"data-constant","expression":{}}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"property-type":"data-constant","expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":1,"equalEarth":1,"equirectangular":1,"lambertConformalConic":1,"mercator":1,"naturalEarth":1,"winkelTripel":1,"globe":1},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-180,-90],"maximum":[180,90]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-90,-90],"maximum":[90,90]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_raster-particle","paint_hillshade","paint_background","paint_sky","paint_model"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"fill-z-offset":{"type":"number","default":0,"minimum":0,"transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-height-alignment":{"type":"enum","experimental":true,"values":{"terrain":1,"flat":1},"default":"flat","property-type":"data-constant"},"fill-extrusion-base-alignment":{"type":"enum","experimental":true,"values":{"terrain":1,"flat":1},"default":"terrain","property-type":"data-constant"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-ambient-occlusion-intensity":{"property-type":"data-constant","type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"property-type":"data-constant","type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-wall-radius":{"property-type":"data-constant","type":"number","experimental":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-radius":{"property-type":"data-constant","type":"number","experimental":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-attenuation":{"property-type":"data-constant","type":"number","experimental":true,"default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-flood-light-color":{"property-type":"data-constant","type":"color","experimental":true,"default":"#ffffff","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-intensity":{"property-type":"data-constant","type":"number","experimental":true,"default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-wall-radius":{"property-type":"data-driven","type":"number","experimental":true,"default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-radius":{"property-type":"data-driven","type":"number","experimental":true,"default":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-attenuation":{"property-type":"data-constant","type":"number","experimental":true,"default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-vertical-scale":{"property-type":"data-constant","type":"number","experimental":true,"default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-rounded-roof":{"property-type":"data-constant","type":"boolean","default":true,"experimental":true,"expression":{"parameters":["zoom"]}},"fill-extrusion-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"fill-extrusion-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"fill-extrusion-line-width":{"type":"number","default":0,"minimum":0,"transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-extrusion-cast-shadows":{"type":"boolean","default":true,"property-type":"data-constant"}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light","line-progress"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-gradient":{"type":"color","expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"property-type":"constant"},"line-trim-fade-range":{"type":"array","value":"number","experimental":true,"length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"line-trim-color":{"type":"color","experimental":true,"default":"transparent","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"line-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"line-border-width":{"type":"number","private":true,"default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-border-color":{"type":"color","private":true,"default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-occlusion-opacity":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"property-type":"data-constant"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-occlusion-opacity":{"type":"number","minimum":0,"maximum":1,"default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"text-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-image-cross-fade":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"transition":true},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-occlusion-opacity":{"type":"number","minimum":0,"maximum":1,"default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-color-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"expression":{},"property-type":"data-constant"},"icon-color-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"expression":{},"property-type":"data-constant"},"icon-color-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"icon-color-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"symbol-z-offset":{"type":"number","default":0,"minimum":0,"transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-color":{"type":"color","expression":{"interpolated":true,"parameters":["raster-value"]},"property-type":"color-ramp"},"raster-color-mix":{"type":"array","default":[0.2126,0.7152,0.0722,0],"length":4,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-color-range":{"type":"array","length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":1,"nearest":1},"default":"linear","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"raster-array-band":{"type":"string","required":false,"experimental":true,"property-type":"data-constant"},"raster-elevation":{"type":"number","default":0,"minimum":0,"transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster-particle":{"raster-particle-array-band":{"type":"string","required":false,"property-type":"data-constant"},"raster-particle-count":{"type":"number","default":512,"minimum":1,"property-type":"data-constant"},"raster-particle-color":{"type":"color","expression":{"interpolated":true,"parameters":["raster-particle-speed"]},"property-type":"color-ramp"},"raster-particle-max-speed":{"type":"number","default":1,"minimum":1,"property-type":"data-constant"},"raster-particle-speed-factor":{"type":"number","default":0.2,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-particle-fade-opacity-factor":{"type":"number","default":0.98,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-particle-reset-rate-factor":{"type":"number","default":0.8,"minimum":0,"maximum":1,"property-type":"data-constant"},"raster-particle-elevation":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_background":{"background-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":[]},"experimental":true,"property-type":"data-constant"},"background-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":1,"atmosphere":1},"default":"atmosphere","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","default":10,"minimum":0,"maximum":100,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","value":"number","default":[0,0],"length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","default":90,"minimum":0,"maximum":180,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_model":{"model-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"property-type":"data-driven"},"model-rotation":{"type":"array","value":"number","length":3,"default":[0,0,0],"period":360,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-scale":{"type":"array","value":"number","length":3,"default":[1,1,1],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-translation":{"type":"array","value":"number","length":3,"default":[0,0,0],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-color":{"type":"color","default":"#ffffff","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light","zoom"]},"transition":true},"model-color-mix-intensity":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-type":{"type":"enum","values":{"common-3d":1,"location-indicator":1},"default":"common-3d","property-type":"data-constant"},"model-cast-shadows":{"type":"boolean","default":true,"property-type":"data-constant"},"model-receive-shadows":{"type":"boolean","default":true,"property-type":"data-constant"},"model-ambient-occlusion-intensity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant","transition":true},"model-emissive-strength":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":5,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-roughness":{"type":"number","default":1,"minimum":0,"maximum":1,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state"]},"transition":true},"model-height-based-emissive-strength-multiplier":{"type":"array","default":[1,1,1,1,0],"length":5,"value":"number","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"model-front-cutoff":{"type":"array","private":true,"value":"number","property-type":"data-constant","expression":{"interpolated":true,"parameters":["zoom"]},"length":3,"default":[0,0,1],"minimum":[0,0,0],"maximum":[1,1,1]}},"transition":{"duration":{"type":"number","default":300,"minimum":0},"delay":{"type":"number","default":0,"minimum":0}},"property-type":{"data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"*"}}}');function i0(c){return c instanceof Number||c instanceof String||c instanceof Boolean?c.valueOf():c}function bp(c){if(Array.isArray(c))return c.map(bp);if(c instanceof Object&&!(c instanceof Number||c instanceof String||c instanceof Boolean)){const n={};for(const s in c)n[s]=bp(c[s]);return n}return i0(c)}function nv(c){if(c===!0||c===!1)return!0;if(!Array.isArray(c)||c.length===0)return!1;switch(c[0]){case"has":return c.length>=2&&c[1]!=="$id"&&c[1]!=="$type";case"in":return c.length>=3&&(typeof c[1]!="string"||Array.isArray(c[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return c.length!==3||Array.isArray(c[1])||Array.isArray(c[2]);case"any":case"all":for(const n of c.slice(1))if(!nv(n)&&typeof n!="boolean")return!1;return!0;default:return!0}}function s0(c,n="",s=null,u="fill"){if(c==null)return{filter:()=>!0,needGeometry:!1,needFeature:!1};nv(c)||(c=xp(c));const g=c;let h=!0;try{h=function(x){if(!dd(x))return x;let P=bp(x);return l0(P),P=a0(P),P}(g)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.
This is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md
and paste the contents of this message in the report.
Thank you!
Filter Expression:
${JSON.stringify(g,null,2)}
        `)}let v=null,T=null;if(u!=="background"&&u!=="sky"&&u!=="slot"){T=Lt[`filter_${u}`];const x=id(h,T,n,s);if(x.result==="error")throw new Error(x.value.map(P=>`${P.key}: ${P.message}`).join(", "));v=(P,L,I)=>x.value.evaluate(P,L,{},I)}let A=null,D=null;if(h!==g){const x=id(g,T,n,s);if(x.result==="error")throw new Error(x.value.map(P=>`${P.key}: ${P.message}`).join(", "));A=(P,L,I,R,V)=>x.value.evaluate(P,L,{},I,void 0,void 0,R,V),D=!Xu(x.value.expression)}return{filter:v,dynamicFilter:A||void 0,needGeometry:c0(h),needFeature:!!D}}function a0(c){if(!Array.isArray(c))return c;const n=function(s){if(dw.has(s[0])){for(let u=1;u<s.length;u++)if(dd(s[u]))return!0}return s}(c);return n===!0?n:n.map(s=>a0(s))}function l0(c){let n=!1;const s=[];if(c[0]==="case"){for(let u=1;u<c.length-1;u+=2)n=n||dd(c[u]),s.push(c[u+1]);s.push(c[c.length-1])}else if(c[0]==="match"){n=n||dd(c[1]);for(let u=2;u<c.length-1;u+=2)s.push(c[u+1]);s.push(c[c.length-1])}else if(c[0]==="step"){n=n||dd(c[1]);for(let u=1;u<c.length-1;u+=2)s.push(c[u+1])}n&&(c.length=0,c.push("any",...s));for(let u=1;u<c.length;u++)l0(c[u])}function dd(c){if(!Array.isArray(c))return!1;if((n=c[0])==="pitch"||n==="distance-from-center")return!0;var n;for(let s=1;s<c.length;s++)if(dd(c[s]))return!0;return!1}const dw=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function hw(c,n){return c<n?-1:c>n?1:0}function c0(c){if(!Array.isArray(c))return!1;if(c[0]==="within"||c[0]==="distance")return!0;for(let n=1;n<c.length;n++)if(c0(c[n]))return!0;return!1}function xp(c){if(!c)return!0;const n=c[0];return c.length<=1?n!=="any":n==="=="?Ec(c[1],c[2],"=="):n==="!="?pu(Ec(c[1],c[2],"==")):n==="<"||n===">"||n==="<="||n===">="?Ec(c[1],c[2],n):n==="any"?(s=c.slice(1),["any"].concat(s.map(xp))):n==="all"?["all"].concat(c.slice(1).map(xp)):n==="none"?["all"].concat(c.slice(1).map(xp).map(pu)):n==="in"?rv(c[1],c.slice(2)):n==="!in"?pu(rv(c[1],c.slice(2))):n==="has"?ov(c[1]):n!=="!has"||pu(ov(c[1]));var s}function Ec(c,n,s){switch(c){case"$type":return[`filter-type-${s}`,n];case"$id":return[`filter-id-${s}`,n];default:return[`filter-${s}`,c,n]}}function rv(c,n){if(n.length===0)return!1;switch(c){case"$type":return["filter-type-in",["literal",n]];case"$id":return["filter-id-in",["literal",n]];default:return n.length>200&&!n.some(s=>typeof s!=typeof n[0])?["filter-in-large",c,["literal",n.sort(hw)]]:["filter-in-small",c,["literal",n]]}}function ov(c){switch(c){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",c]}}function pu(c){return["!",c]}const wp="";function sl(c,n){return n?`${c}${wp}${n}`:c}const Nl="-transition",u0=new Set(["fill","line","background","hillshade","raster"]);class Di extends yc{constructor(n,s,u,g,h){if(super(),this.id=n.id,this.fqid=sl(this.id,u),this.type=n.type,this.scope=u,this.lut=g,this.options=h,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,this.configDependencies=new Set,n.type!=="custom"){if(this.metadata=n.metadata,this.minzoom=n.minzoom,this.maxzoom=n.maxzoom,n.type&&n.type!=="background"&&n.type!=="sky"&&n.type!=="slot"){this.source=n.source,this.sourceLayer=n["source-layer"],this.filter=n.filter;const v=id(this.filter,Lt[`filter_${n.type}`]);v.result!=="error"&&(this.configDependencies=new Set([...this.configDependencies,...v.value.configDependencies]))}if(n.slot&&(this.slot=n.slot),s.layout&&(this._unevaluatedLayout=new ad(s.layout,this.scope,h),this.configDependencies=new Set([...this.configDependencies,...this._unevaluatedLayout.configDependencies])),s.paint){this._transitionablePaint=new yp(s.paint,this.scope,h);for(const v in n.paint)this.setPaintProperty(v,n.paint[v]);for(const v in n.layout)this.setLayoutProperty(v,n.layout[v]);this.configDependencies=new Set([...this.configDependencies,...this._transitionablePaint.configDependencies]),this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new cd(s.paint)}}}onAdd(n){}onRemove(n){}isDraped(n){return!this.is3D()&&u0.has(this.type)}getLayoutProperty(n){return n==="visibility"?this.visibility:this._unevaluatedLayout.getValue(n)}setLayoutProperty(n,s){if(this.type==="custom"&&n==="visibility")return void(this.visibility=s);const u=this._unevaluatedLayout;u._properties.properties[n]&&(u.setValue(n,s),this.configDependencies=new Set([...this.configDependencies,...u.configDependencies]),n==="visibility"&&this.possiblyEvaluateVisibility())}possiblyEvaluateVisibility(){this._unevaluatedLayout._values.visibility&&(this.visibility=this._unevaluatedLayout._values.visibility.possiblyEvaluate({zoom:0}))}getPaintProperty(n){return Gt(n,Nl)?this._transitionablePaint.getTransition(n.slice(0,-11)):this._transitionablePaint.getValue(n)}setPaintProperty(n,s){const u=this._transitionablePaint,g=u._properties.properties;if(Gt(n,Nl)){const P=n.slice(0,-11);return g[P]&&u.setTransition(P,s||void 0),!1}if(!g[n])return!1;const h=u._values[n],v=h.value.isDataDriven(),T=h.value;u.setValue(n,s),this.configDependencies=new Set([...this.configDependencies,...u.configDependencies]),this._handleSpecialPaintPropertyUpdate(n);const A=u._values[n].value,D=A.isDataDriven(),x=Gt(n,"pattern")||n==="line-dasharray";return D||v||x||this._handleOverridablePaintPropertyUpdate(n,T,A)}_handleSpecialPaintPropertyUpdate(n){}getProgramIds(){return null}getDefaultProgramParams(n,s,u){return null}_handleOverridablePaintPropertyUpdate(n,s,u){return!1}isHidden(n){return!!(this.minzoom&&n<this.minzoom)||!!(this.maxzoom&&n>=this.maxzoom)||this.visibility==="none"}updateTransitions(n){this._transitioningPaint=this._transitionablePaint.transitioned(n,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(n,s){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(n,void 0,s)),this.paint=this._transitioningPaint.possiblyEvaluate(n,void 0,s)}serialize(){return Ut({id:this.id,type:this.type,slot:this.slot,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()},(n,s)=>!(n===void 0||s==="layout"&&!Object.keys(n).length||s==="paint"&&!Object.keys(n).length))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}hasShadowPass(){return!1}canCastShadows(){return!1}hasLightBeamPass(){return!1}cutoffRange(){return 0}tileCoverLift(){return 0}resize(){}isStateDependent(){for(const n in this.paint._values){const s=this.paint.get(n);if(s instanceof ld&&Mh(s.property.specification)&&(s.value.kind==="source"||s.value.kind==="composite")&&s.value.isStateDependent)return!0}return!1}compileFilter(n){this._filterCompiled||(this._featureFilter=s0(this.filter,this.scope,n),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}getLayerRenderingStats(){return this._stats}resetLayerRenderingStats(n){this._stats&&(n.renderPass==="shadow"?this._stats.numRenderedVerticesInShadowPass=0:this._stats.numRenderedVerticesInTransparentPass=0)}queryRadius(n){}queryIntersectsFeature(n,s,u,g,h,v,T,A,D){}}const fw={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class zh{constructor(n,s){this._structArray=n,this._pos1=s*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Fo{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(n,s){return n._trim(),s&&(n.isTransferred=!0,s.add(n.arrayBuffer)),{length:n.length,arrayBuffer:n.arrayBuffer}}static deserialize(n){const s=Object.create(this.prototype);return s.arrayBuffer=n.arrayBuffer,s.length=n.length,s.capacity=n.arrayBuffer.byteLength/s.bytesPerElement,s._refreshViews(),s}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(n){this.reserve(n),this.length=n}reserve(n){if(n>this.capacity){this.capacity=Math.max(n,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const s=this.uint8;this._refreshViews(),s&&this.uint8.set(s)}}_refreshViews(){throw new Error("StructArray#_refreshViews() must be implemented by each concrete StructArray layout")}emplace(...n){throw new Error("StructArray#emplace() must be implemented by each concrete StructArray layout")}emplaceBack(...n){throw new Error("StructArray#emplaceBack() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function so(c,n=1){let s=0,u=0;return{members:c.map(g=>{const h=fw[g.type].BYTES_PER_ELEMENT,v=s=d0(s,Math.max(n,h)),T=g.components||1;return u=Math.max(u,h),s+=h*T,{name:g.name,type:g.type,components:T,offset:v}}),size:d0(s,Math.max(u,n)),alignment:n}}function d0(c,n){return Math.ceil(c/n)*n}class Bl extends Fo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,s){const u=this.length;return this.resize(u+1),this.emplace(u,n,s)}emplace(n,s,u){const g=2*n;return this.int16[g+0]=s,this.int16[g+1]=u,n}}Bl.prototype.bytesPerElement=4,Hn(Bl,"StructArrayLayout2i4");class hd extends Fo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,s,u){const g=this.length;return this.resize(g+1),this.emplace(g,n,s,u)}emplace(n,s,u,g){const h=3*n;return this.int16[h+0]=s,this.int16[h+1]=u,this.int16[h+2]=g,n}}hd.prototype.bytesPerElement=6,Hn(hd,"StructArrayLayout3i6");class Vl extends Fo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,s,u,g){const h=this.length;return this.resize(h+1),this.emplace(h,n,s,u,g)}emplace(n,s,u,g,h){const v=4*n;return this.int16[v+0]=s,this.int16[v+1]=u,this.int16[v+2]=g,this.int16[v+3]=h,n}}Vl.prototype.bytesPerElement=8,Hn(Vl,"StructArrayLayout4i8");class Sp extends Fo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,s,u,g,h){const v=this.length;return this.resize(v+1),this.emplace(v,n,s,u,g,h)}emplace(n,s,u,g,h,v){const T=5*n;return this.int16[T+0]=s,this.int16[T+1]=u,this.int16[T+2]=g,this.int16[T+3]=h,this.int16[T+4]=v,n}}Sp.prototype.bytesPerElement=10,Hn(Sp,"StructArrayLayout5i10");class Fh extends Fo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,s,u,g,h,v,T){const A=this.length;return this.resize(A+1),this.emplace(A,n,s,u,g,h,v,T)}emplace(n,s,u,g,h,v,T,A){const D=6*n,x=12*n,P=3*n;return this.int16[D+0]=s,this.int16[D+1]=u,this.uint8[x+4]=g,this.uint8[x+5]=h,this.uint8[x+6]=v,this.uint8[x+7]=T,this.float32[P+2]=A,n}}Fh.prototype.bytesPerElement=12,Hn(Fh,"StructArrayLayout2i4ub1f12");class al extends Fo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,s,u){const g=this.length;return this.resize(g+1),this.emplace(g,n,s,u)}emplace(n,s,u,g){const h=3*n;return this.float32[h+0]=s,this.float32[h+1]=u,this.float32[h+2]=g,n}}al.prototype.bytesPerElement=12,Hn(al,"StructArrayLayout3f12");class Ji extends Fo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,s,u,g,h){const v=this.length;return this.resize(v+1),this.emplace(v,n,s,u,g,h)}emplace(n,s,u,g,h,v){const T=6*n,A=3*n;return this.uint16[T+0]=s,this.uint16[T+1]=u,this.uint16[T+2]=g,this.uint16[T+3]=h,this.float32[A+2]=v,n}}Ji.prototype.bytesPerElement=12,Hn(Ji,"StructArrayLayout4ui1f12");class Tp extends Fo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,s,u,g){const h=this.length;return this.resize(h+1),this.emplace(h,n,s,u,g)}emplace(n,s,u,g,h){const v=4*n;return this.uint16[v+0]=s,this.uint16[v+1]=u,this.uint16[v+2]=g,this.uint16[v+3]=h,n}}Tp.prototype.bytesPerElement=8,Hn(Tp,"StructArrayLayout4ui8");class Nh extends Fo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,s,u,g,h,v){const T=this.length;return this.resize(T+1),this.emplace(T,n,s,u,g,h,v)}emplace(n,s,u,g,h,v,T){const A=6*n;return this.int16[A+0]=s,this.int16[A+1]=u,this.int16[A+2]=g,this.int16[A+3]=h,this.int16[A+4]=v,this.int16[A+5]=T,n}}Nh.prototype.bytesPerElement=12,Hn(Nh,"StructArrayLayout6i12");class iv extends Fo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,s,u,g,h,v,T,A,D,x,P,L){const I=this.length;return this.resize(I+1),this.emplace(I,n,s,u,g,h,v,T,A,D,x,P,L)}emplace(n,s,u,g,h,v,T,A,D,x,P,L,I){const R=12*n;return this.int16[R+0]=s,this.int16[R+1]=u,this.int16[R+2]=g,this.int16[R+3]=h,this.uint16[R+4]=v,this.uint16[R+5]=T,this.uint16[R+6]=A,this.uint16[R+7]=D,this.int16[R+8]=x,this.int16[R+9]=P,this.int16[R+10]=L,this.int16[R+11]=I,n}}iv.prototype.bytesPerElement=24,Hn(iv,"StructArrayLayout4i4ui4i24");class sv extends Fo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,s,u,g,h,v){const T=this.length;return this.resize(T+1),this.emplace(T,n,s,u,g,h,v)}emplace(n,s,u,g,h,v,T){const A=10*n,D=5*n;return this.int16[A+0]=s,this.int16[A+1]=u,this.int16[A+2]=g,this.float32[D+2]=h,this.float32[D+3]=v,this.float32[D+4]=T,n}}sv.prototype.bytesPerElement=20,Hn(sv,"StructArrayLayout3i3f20");class mu extends Fo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,s,u,g){const h=this.length;return this.resize(h+1),this.emplace(h,n,s,u,g)}emplace(n,s,u,g,h){const v=4*n;return this.float32[v+0]=s,this.float32[v+1]=u,this.float32[v+2]=g,this.float32[v+3]=h,n}}mu.prototype.bytesPerElement=16,Hn(mu,"StructArrayLayout4f16");class av extends Fo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(n){const s=this.length;return this.resize(s+1),this.emplace(s,n)}emplace(n,s){return this.uint32[1*n+0]=s,n}}av.prototype.bytesPerElement=4,Hn(av,"StructArrayLayout1ul4");class Mc extends Fo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,s){const u=this.length;return this.resize(u+1),this.emplace(u,n,s)}emplace(n,s,u){const g=2*n;return this.uint16[g+0]=s,this.uint16[g+1]=u,n}}Mc.prototype.bytesPerElement=4,Hn(Mc,"StructArrayLayout2ui4");class lv extends Fo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,s,u,g,h,v,T,A,D,x,P,L,I){const R=this.length;return this.resize(R+1),this.emplace(R,n,s,u,g,h,v,T,A,D,x,P,L,I)}emplace(n,s,u,g,h,v,T,A,D,x,P,L,I,R){const V=20*n,W=10*n;return this.int16[V+0]=s,this.int16[V+1]=u,this.int16[V+2]=g,this.int16[V+3]=h,this.int16[V+4]=v,this.float32[W+3]=T,this.float32[W+4]=A,this.float32[W+5]=D,this.float32[W+6]=x,this.int16[V+14]=P,this.uint32[W+8]=L,this.uint16[V+18]=I,this.uint16[V+19]=R,n}}lv.prototype.bytesPerElement=40,Hn(lv,"StructArrayLayout5i4f1i1ul2ui40");class Cp extends Fo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,s,u,g,h,v,T){const A=this.length;return this.resize(A+1),this.emplace(A,n,s,u,g,h,v,T)}emplace(n,s,u,g,h,v,T,A){const D=8*n;return this.int16[D+0]=s,this.int16[D+1]=u,this.int16[D+2]=g,this.int16[D+4]=h,this.int16[D+5]=v,this.int16[D+6]=T,this.int16[D+7]=A,n}}Cp.prototype.bytesPerElement=16,Hn(Cp,"StructArrayLayout3i2i2i16");class cv extends Fo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,s,u,g,h){const v=this.length;return this.resize(v+1),this.emplace(v,n,s,u,g,h)}emplace(n,s,u,g,h,v){const T=4*n,A=8*n;return this.float32[T+0]=s,this.float32[T+1]=u,this.float32[T+2]=g,this.int16[A+6]=h,this.int16[A+7]=v,n}}cv.prototype.bytesPerElement=16,Hn(cv,"StructArrayLayout2f1f2i16");class uv extends Fo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,s,u,g,h,v){const T=this.length;return this.resize(T+1),this.emplace(T,n,s,u,g,h,v)}emplace(n,s,u,g,h,v,T){const A=20*n,D=5*n;return this.uint8[A+0]=s,this.uint8[A+1]=u,this.float32[D+1]=g,this.float32[D+2]=h,this.float32[D+3]=v,this.float32[D+4]=T,n}}uv.prototype.bytesPerElement=20,Hn(uv,"StructArrayLayout2ub4f20");class $i extends Fo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,s,u){const g=this.length;return this.resize(g+1),this.emplace(g,n,s,u)}emplace(n,s,u,g){const h=3*n;return this.uint16[h+0]=s,this.uint16[h+1]=u,this.uint16[h+2]=g,n}}$i.prototype.bytesPerElement=6,Hn($i,"StructArrayLayout3ui6");class dv extends Fo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(n,s,u,g,h,v,T,A,D,x,P,L,I,R,V,W,K,re,ie,Q,ue){const _e=this.length;return this.resize(_e+1),this.emplace(_e,n,s,u,g,h,v,T,A,D,x,P,L,I,R,V,W,K,re,ie,Q,ue)}emplace(n,s,u,g,h,v,T,A,D,x,P,L,I,R,V,W,K,re,ie,Q,ue,_e){const Ee=30*n,Ne=15*n,ze=60*n;return this.int16[Ee+0]=s,this.int16[Ee+1]=u,this.int16[Ee+2]=g,this.float32[Ne+2]=h,this.float32[Ne+3]=v,this.uint16[Ee+8]=T,this.uint16[Ee+9]=A,this.uint32[Ne+5]=D,this.uint32[Ne+6]=x,this.uint32[Ne+7]=P,this.uint16[Ee+16]=L,this.uint16[Ee+17]=I,this.uint16[Ee+18]=R,this.float32[Ne+10]=V,this.float32[Ne+11]=W,this.uint8[ze+48]=K,this.uint8[ze+49]=re,this.uint8[ze+50]=ie,this.uint32[Ne+13]=Q,this.int16[Ee+28]=ue,this.uint8[ze+58]=_e,n}}dv.prototype.bytesPerElement=60,Hn(dv,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class hv extends Fo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(n,s,u,g,h,v,T,A,D,x,P,L,I,R,V,W,K,re,ie,Q,ue,_e,Ee,Ne,ze,De,ot,$e,it,ft,ut,mt){const xt=this.length;return this.resize(xt+1),this.emplace(xt,n,s,u,g,h,v,T,A,D,x,P,L,I,R,V,W,K,re,ie,Q,ue,_e,Ee,Ne,ze,De,ot,$e,it,ft,ut,mt)}emplace(n,s,u,g,h,v,T,A,D,x,P,L,I,R,V,W,K,re,ie,Q,ue,_e,Ee,Ne,ze,De,ot,$e,it,ft,ut,mt,xt){const At=20*n,_t=40*n,Zt=80*n;return this.float32[At+0]=s,this.float32[At+1]=u,this.int16[_t+4]=g,this.int16[_t+5]=h,this.int16[_t+6]=v,this.int16[_t+7]=T,this.int16[_t+8]=A,this.int16[_t+9]=D,this.int16[_t+10]=x,this.int16[_t+11]=P,this.int16[_t+12]=L,this.uint16[_t+13]=I,this.uint16[_t+14]=R,this.uint16[_t+15]=V,this.uint16[_t+16]=W,this.uint16[_t+17]=K,this.uint16[_t+18]=re,this.uint16[_t+19]=ie,this.uint16[_t+20]=Q,this.uint16[_t+21]=ue,this.uint16[_t+22]=_e,this.uint16[_t+23]=Ee,this.uint16[_t+24]=Ne,this.uint16[_t+25]=ze,this.uint16[_t+26]=De,this.uint16[_t+27]=ot,this.uint32[At+14]=$e,this.float32[At+15]=it,this.float32[At+16]=ft,this.float32[At+17]=ut,this.float32[At+18]=mt,this.uint8[Zt+76]=xt,n}}hv.prototype.bytesPerElement=80,Hn(hv,"StructArrayLayout2f9i15ui1ul4f1ub80");class Bh extends Fo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n){const s=this.length;return this.resize(s+1),this.emplace(s,n)}emplace(n,s){return this.float32[1*n+0]=s,n}}Bh.prototype.bytesPerElement=4,Hn(Bh,"StructArrayLayout1f4");class Ic extends Fo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,s,u,g,h){const v=this.length;return this.resize(v+1),this.emplace(v,n,s,u,g,h)}emplace(n,s,u,g,h,v){const T=5*n;return this.float32[T+0]=s,this.float32[T+1]=u,this.float32[T+2]=g,this.float32[T+3]=h,this.float32[T+4]=v,n}}Ic.prototype.bytesPerElement=20,Hn(Ic,"StructArrayLayout5f20");class Ep extends Fo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,s,u,g,h,v,T){const A=this.length;return this.resize(A+1),this.emplace(A,n,s,u,g,h,v,T)}emplace(n,s,u,g,h,v,T,A){const D=7*n;return this.float32[D+0]=s,this.float32[D+1]=u,this.float32[D+2]=g,this.float32[D+3]=h,this.float32[D+4]=v,this.float32[D+5]=T,this.float32[D+6]=A,n}}Ep.prototype.bytesPerElement=28,Hn(Ep,"StructArrayLayout7f28");class ll extends Fo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,s,u,g,h,v,T,A,D,x,P){const L=this.length;return this.resize(L+1),this.emplace(L,n,s,u,g,h,v,T,A,D,x,P)}emplace(n,s,u,g,h,v,T,A,D,x,P,L){const I=11*n;return this.float32[I+0]=s,this.float32[I+1]=u,this.float32[I+2]=g,this.float32[I+3]=h,this.float32[I+4]=v,this.float32[I+5]=T,this.float32[I+6]=A,this.float32[I+7]=D,this.float32[I+8]=x,this.float32[I+9]=P,this.float32[I+10]=L,n}}ll.prototype.bytesPerElement=44,Hn(ll,"StructArrayLayout11f44");class Mp extends Fo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,s,u,g,h,v,T,A,D){const x=this.length;return this.resize(x+1),this.emplace(x,n,s,u,g,h,v,T,A,D)}emplace(n,s,u,g,h,v,T,A,D,x){const P=9*n;return this.float32[P+0]=s,this.float32[P+1]=u,this.float32[P+2]=g,this.float32[P+3]=h,this.float32[P+4]=v,this.float32[P+5]=T,this.float32[P+6]=A,this.float32[P+7]=D,this.float32[P+8]=x,n}}Mp.prototype.bytesPerElement=36,Hn(Mp,"StructArrayLayout9f36");class fd extends Fo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,s){const u=this.length;return this.resize(u+1),this.emplace(u,n,s)}emplace(n,s,u){const g=2*n;return this.float32[g+0]=s,this.float32[g+1]=u,n}}fd.prototype.bytesPerElement=8,Hn(fd,"StructArrayLayout2f8");class fv extends Fo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,s,u,g){const h=this.length;return this.resize(h+1),this.emplace(h,n,s,u,g)}emplace(n,s,u,g,h){const v=6*n;return this.uint32[3*n+0]=s,this.uint16[v+2]=u,this.uint16[v+3]=g,this.uint16[v+4]=h,n}}fv.prototype.bytesPerElement=12,Hn(fv,"StructArrayLayout1ul3ui12");class pv extends Fo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n){const s=this.length;return this.resize(s+1),this.emplace(s,n)}emplace(n,s){return this.uint16[1*n+0]=s,n}}pv.prototype.bytesPerElement=2,Hn(pv,"StructArrayLayout1ui2");class Vh extends Fo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,s,u,g,h,v,T,A,D,x,P,L,I,R,V,W){const K=this.length;return this.resize(K+1),this.emplace(K,n,s,u,g,h,v,T,A,D,x,P,L,I,R,V,W)}emplace(n,s,u,g,h,v,T,A,D,x,P,L,I,R,V,W,K){const re=16*n;return this.float32[re+0]=s,this.float32[re+1]=u,this.float32[re+2]=g,this.float32[re+3]=h,this.float32[re+4]=v,this.float32[re+5]=T,this.float32[re+6]=A,this.float32[re+7]=D,this.float32[re+8]=x,this.float32[re+9]=P,this.float32[re+10]=L,this.float32[re+11]=I,this.float32[re+12]=R,this.float32[re+13]=V,this.float32[re+14]=W,this.float32[re+15]=K,n}}Vh.prototype.bytesPerElement=64,Hn(Vh,"StructArrayLayout16f64");class $h extends Fo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,s,u,g,h,v,T){const A=this.length;return this.resize(A+1),this.emplace(A,n,s,u,g,h,v,T)}emplace(n,s,u,g,h,v,T,A){const D=10*n,x=5*n;return this.uint16[D+0]=s,this.uint16[D+1]=u,this.uint16[D+2]=g,this.uint16[D+3]=h,this.float32[x+2]=v,this.float32[x+3]=T,this.float32[x+4]=A,n}}$h.prototype.bytesPerElement=20,Hn($h,"StructArrayLayout4ui3f20");class mv extends Fo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n){const s=this.length;return this.resize(s+1),this.emplace(s,n)}emplace(n,s){return this.int16[1*n+0]=s,n}}mv.prototype.bytesPerElement=2,Hn(mv,"StructArrayLayout1i2");class Ip extends Fo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer)}emplaceBack(n){const s=this.length;return this.resize(s+1),this.emplace(s,n)}emplace(n,s){return this.uint8[1*n+0]=s,n}}Ip.prototype.bytesPerElement=1,Hn(Ip,"StructArrayLayout1ub1");class h0 extends zh{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}h0.prototype.size=40;class gv extends lv{get(n){return new h0(this,n)}}Hn(gv,"CollisionBoxArray");class Uh extends zh{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(n){this._structArray.uint8[this._pos1+49]=n}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(n){this._structArray.uint8[this._pos1+50]=n}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(n){this._structArray.uint32[this._pos4+13]=n}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(n){this._structArray.uint8[this._pos1+58]=n}}Uh.prototype.size=60;class f0 extends dv{get(n){return new Uh(this,n)}}Hn(f0,"PlacedSymbolArray");class p0 extends zh{get tileAnchorX(){return this._structArray.float32[this._pos4+0]}get tileAnchorY(){return this._structArray.float32[this._pos4+1]}get projectedAnchorX(){return this._structArray.int16[this._pos2+4]}get projectedAnchorY(){return this._structArray.int16[this._pos2+5]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+6]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+7]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+11]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get key(){return this._structArray.uint16[this._pos2+13]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+14]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+15]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+17]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+19]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+21]}get featureIndex(){return this._structArray.uint16[this._pos2+22]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+23]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numIconVertices(){return this._structArray.uint16[this._pos2+25]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+26]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+27]}get crossTileID(){return this._structArray.uint32[this._pos4+14]}set crossTileID(n){this._structArray.uint32[this._pos4+14]=n}get textOffset0(){return this._structArray.float32[this._pos4+15]}get textOffset1(){return this._structArray.float32[this._pos4+16]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+17]}get zOffset(){return this._structArray.float32[this._pos4+18]}set zOffset(n){this._structArray.float32[this._pos4+18]=n}get hasIconTextFit(){return this._structArray.uint8[this._pos1+76]}}p0.prototype.size=80;class m0 extends hv{get(n){return new p0(this,n)}}Hn(m0,"SymbolInstanceArray");class g0 extends Bh{getoffsetX(n){return this.float32[1*n+0]}}Hn(g0,"GlyphOffsetArray");class v0 extends Bl{getx(n){return this.int16[2*n+0]}gety(n){return this.int16[2*n+1]}}Hn(v0,"SymbolLineVertexArray");class jh extends zh{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}jh.prototype.size=12;class Hh extends fv{get(n){return new jh(this,n)}}Hn(Hh,"FeatureIndexArray");class Ls extends Mc{geta_centroid_pos0(n){return this.uint16[2*n+0]}geta_centroid_pos1(n){return this.uint16[2*n+1]}}Hn(Ls,"FillExtrusionCentroidArray");class Gh extends zh{get a_join_normal_inside0(){return this._structArray.int16[this._pos2+0]}get a_join_normal_inside1(){return this._structArray.int16[this._pos2+1]}get a_join_normal_inside2(){return this._structArray.int16[this._pos2+2]}}Gh.prototype.size=6;class _0 extends hd{get(n){return new Gh(this,n)}}Hn(_0,"FillExtrusionWallArray");const pw=so([{name:"a_pos",components:2,type:"Int16"}],4),mw=so([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class ei{constructor(n=[]){this.segments=n}_prepareSegment(n,s,u,g){let h=this.segments[this.segments.length-1];return n>ei.MAX_VERTEX_ARRAY_LENGTH&&wn(`Max vertices per segment is ${ei.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${n}`),(!h||h.vertexLength+n>ei.MAX_VERTEX_ARRAY_LENGTH||h.sortKey!==g)&&(h={vertexOffset:s,primitiveOffset:u,vertexLength:0,primitiveLength:0},g!==void 0&&(h.sortKey=g),this.segments.push(h)),h}prepareSegment(n,s,u,g){return this._prepareSegment(n,s.length,u.length,g)}get(){return this.segments}destroy(){for(const n of this.segments)for(const s in n.vaos)n.vaos[s].destroy()}static simpleSegment(n,s,u,g){return new ei([{vertexOffset:n,primitiveOffset:s,vertexLength:u,primitiveLength:g,vaos:{},sortKey:0}])}}function Ap(c,n){return 256*(c=It(Math.floor(c),0,255))+It(Math.floor(n),0,255)}ei.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Hn(ei,"SegmentVector");const gw=so([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),vv=so([{name:"a_dash",components:4,type:"Uint16"}]);class Wh{constructor(){this.ids=[],this.uniqueIds=[],this.positions=[],this.indexed=!1}add(n,s,u,g){this.ids.push(y0(n)),this.positions.push(s,u,g)}eachPosition(n,s){const u=y0(n);let g=0,h=this.ids.length-1;for(;g<h;){const v=g+h>>1;this.ids[v]>=u?h=v:g=v+1}for(;this.ids[g]===u;)s(this.positions[3*g],this.positions[3*g+1],this.positions[3*g+2]),g++}static serialize(n,s){const u=new Float64Array(n.ids),g=new Uint32Array(n.positions);return qh(u,g,0,u.length-1),s&&(s.add(u.buffer),s.add(g.buffer)),{ids:u,positions:g}}static deserialize(n){const s=new Wh;let u;s.ids=n.ids,s.positions=n.positions;for(const g of s.ids)g!==u&&s.uniqueIds.push(g),u=g;return s.indexed=!0,s}}function y0(c){const n=+c;return!isNaN(n)&&Number.MIN_SAFE_INTEGER<=n&&n<=Number.MAX_SAFE_INTEGER?n:La(String(c))}function qh(c,n,s,u){for(;s<u;){const g=c[s+u>>1];let h=s-1,v=u+1;for(;;){do h++;while(c[h]<g);do v--;while(c[v]>g);if(h>=v)break;kp(c,h,v),kp(n,3*h,3*v),kp(n,3*h+1,3*v+1),kp(n,3*h+2,3*v+2)}v-s<u-v?(qh(c,n,s,v),s=v+1):(qh(c,n,v+1,u),u=v)}}function kp(c,n,s){const u=c[n];c[n]=c[s],c[s]=u}Hn(Wh,"FeaturePositionMap");class cl{constructor(n){this.gl=n.gl,this.initialized=!1}fetchUniformLocation(n,s){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(n,s),this.initialized=!0),!!this.location}set(n,s,u){throw new Error("Uniform#set() must be implemented by each concrete Uniform")}}class Kh extends cl{constructor(n){super(n),this.current=0}set(n,s,u){this.fetchUniformLocation(n,s)&&this.current!==u&&(this.current=u,this.gl.uniform1i(this.location,u))}}class ii extends cl{constructor(n){super(n),this.current=0}set(n,s,u){this.fetchUniformLocation(n,s)&&this.current!==u&&(this.current=u,this.gl.uniform1f(this.location,u))}}class xa extends cl{constructor(n){super(n),this.current=[0,0]}set(n,s,u){this.fetchUniformLocation(n,s)&&(u[0]===this.current[0]&&u[1]===this.current[1]||(this.current=u,this.gl.uniform2f(this.location,u[0],u[1])))}}class pd extends cl{constructor(n){super(n),this.current=[0,0,0]}set(n,s,u){this.fetchUniformLocation(n,s)&&(u[0]===this.current[0]&&u[1]===this.current[1]&&u[2]===this.current[2]||(this.current=u,this.gl.uniform3f(this.location,u[0],u[1],u[2])))}}class Zh extends cl{constructor(n){super(n),this.current=[0,0,0,0]}set(n,s,u){this.fetchUniformLocation(n,s)&&(u[0]===this.current[0]&&u[1]===this.current[1]&&u[2]===this.current[2]&&u[3]===this.current[3]||(this.current=u,this.gl.uniform4f(this.location,u[0],u[1],u[2],u[3])))}}class b0 extends cl{constructor(n){super(n),this.current=io.transparent.toRenderColor(null)}set(n,s,u){this.fetchUniformLocation(n,s)&&(u.r===this.current.r&&u.g===this.current.g&&u.b===this.current.b&&u.a===this.current.a||(this.current=u,this.gl.uniform4f(this.location,u.r,u.g,u.b,u.a)))}}const x0=new Float32Array(16);class Yh extends cl{constructor(n){super(n),this.current=x0}set(n,s,u){if(this.fetchUniformLocation(n,s)){if(u[12]!==this.current[12]||u[0]!==this.current[0])return this.current=u,void this.gl.uniformMatrix4fv(this.location,!1,u);for(let g=1;g<16;g++)if(u[g]!==this.current[g]){this.current=u,this.gl.uniformMatrix4fv(this.location,!1,u);break}}}}const _v=new Float32Array(9),vw=new Float32Array(4);class yv extends cl{constructor(n){super(n),this.current=vw}set(n,s,u){if(this.fetchUniformLocation(n,s)){for(let g=0;g<4;g++)if(u[g]!==this.current[g]){this.current=u,this.gl.uniformMatrix2fv(this.location,!1,u);break}}}}function bv(c){return[Ap(255*c.r,255*c.g),Ap(255*c.b,255*c.a)]}class gu{constructor(n,s,u,g){this.value=n,this.uniformNames=s.map(h=>`u_${h}`),this.type=u,this.context=g}setUniform(n,s,u,g,h){const v=g.constantOr(this.value);s.set(n,h,v instanceof io?v.toRenderColor(this.ignoreLut?null:this.context.lut):v)}getBinding(n,s){return this.type==="color"?new b0(n):new ii(n)}}class vu{constructor(n,s){this.uniformNames=s.map(u=>`u_${u}`),this.pattern=null,this.pixelRatio=1}setConstantPatternPositions(n){this.pixelRatio=n.pixelRatio||1,this.pattern=n.tl.concat(n.br)}setUniform(n,s,u,g,h){const v=h==="u_pattern"||h==="u_dash"?this.pattern:h==="u_pixel_ratio"?this.pixelRatio:null;v&&s.set(n,h,v)}getBinding(n,s){return s==="u_pattern"||s==="u_dash"?new Zh(n):new ii(n)}}class $l{constructor(n,s,u,g){this.expression=n,this.type=u,this.maxValue=0,this.paintVertexAttributes=s.map(h=>({name:`a_${h}`,type:"Float32",components:u==="color"?2:1,offset:0})),this.paintVertexArray=new g}populatePaintArray(n,s,u,g,h,v,T){const A=this.paintVertexArray.length,D=this.expression.kind==="composite"||this.expression.kind==="source"?this.expression.evaluate(new zo(0,{brightness:v}),s,{},h,g,T):this.expression.kind==="constant"&&this.expression.value;!this.lutExpression||this.lutExpression.kind!=="composite"&&this.lutExpression.kind!=="source"||(this.ignoreLut=this.lutExpression.evaluate(new zo(0,{brightness:v}),s,{},h,g,T)==="none"),this.paintVertexArray.resize(n),this._setPaintValue(A,n,D,this.context)}updatePaintArray(n,s,u,g,h,v,T){const A=this.expression.kind==="composite"||this.expression.kind==="source"?this.expression.evaluate({zoom:0,brightness:T},u,g,void 0,h):this.expression.kind==="constant"&&this.expression.value;!this.lutExpression||this.lutExpression.kind!=="composite"&&this.lutExpression.kind!=="source"||(this.ignoreLut=this.lutExpression.evaluate({zoom:0,brightness:T},u,g,void 0,h)==="none"),this._setPaintValue(n,s,A,this.context)}_setPaintValue(n,s,u,g){if(this.type==="color"){const h=bv(u.toRenderColor(this.ignoreLut?null:g.lut));for(let v=n;v<s;v++)this.paintVertexArray.emplace(v,h[0],h[1])}else{for(let h=n;h<s;h++)this.paintVertexArray.emplace(h,u);this.maxValue=Math.max(this.maxValue,Math.abs(u))}}upload(n){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=n.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.lutExpression&&this.lutExpression.kind!=="constant"&&(this.lutExpression.isStateDependent||!this.lutExpression.isLightConstant)||this.expression.kind!=="constant"&&(this.expression.isStateDependent||!this.expression.isLightConstant)))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Fa{constructor(n,s,u,g,h,v){this.expression=n,this.uniformNames=s.map(T=>`u_${T}_t`),this.type=u,this.useIntegerZoom=g,this.context=h,this.maxValue=0,this.paintVertexAttributes=s.map(T=>({name:`a_${T}`,type:"Float32",components:u==="color"?4:2,offset:0})),this.paintVertexArray=new v}populatePaintArray(n,s,u,g,h,v,T){const A=this.expression.evaluate(new zo(this.context.zoom,{brightness:v}),s,{},h,g,T),D=this.expression.evaluate(new zo(this.context.zoom+1,{brightness:v}),s,{},h,g,T);!this.lutExpression||this.lutExpression.kind!=="composite"&&this.lutExpression.kind!=="source"||(this.ignoreLut=this.lutExpression.evaluate(new zo(this.context.zoom,{brightness:v}),s,{},h,g,T)==="none");const x=this.paintVertexArray.length;this.paintVertexArray.resize(n),this._setPaintValue(x,n,A,D,this.context)}updatePaintArray(n,s,u,g,h,v,T){const A=this.expression.evaluate({zoom:this.context.zoom,brightness:T},u,g,void 0,h),D=this.expression.evaluate({zoom:this.context.zoom+1,brightness:T},u,g,void 0,h);!this.lutExpression||this.lutExpression.kind!=="composite"&&this.lutExpression.kind!=="source"||(this.ignoreLut=this.lutExpression.evaluate({zoom:this.context.zoom,brightness:T},u,g,void 0,h)==="none"),this._setPaintValue(n,s,A,D,this.context)}_setPaintValue(n,s,u,g,h){if(this.type==="color"){const v=bv(u.toRenderColor(this.ignoreLut?null:h.lut)),T=bv(u.toRenderColor(this.ignoreLut?null:h.lut));for(let A=n;A<s;A++)this.paintVertexArray.emplace(A,v[0],v[1],T[0],T[1])}else{for(let v=n;v<s;v++)this.paintVertexArray.emplace(v,u,g);this.maxValue=Math.max(this.maxValue,Math.abs(u),Math.abs(g))}}upload(n){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=n.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(n,s,u,g,h){const v=this.useIntegerZoom?Math.floor(u.zoom):u.zoom,T=It(this.expression.interpolationFactor(v,this.context.zoom,this.context.zoom+1),0,1);s.set(n,h,T)}getBinding(n,s){return new ii(n)}}class Ac{constructor(n,s,u,g,h){this.expression=n,this.layerId=h,this.paintVertexAttributes=(u==="array"?vv:gw).members;for(let v=0;v<s.length;++v);this.paintVertexArray=new g}populatePaintArray(n,s,u,g){const h=this.paintVertexArray.length;this.paintVertexArray.resize(n),this._setPaintValues(h,n,s.patterns&&s.patterns[this.layerId],u)}updatePaintArray(n,s,u,g,h,v,T){this._setPaintValues(n,s,u.patterns&&u.patterns[this.layerId],v)}_setPaintValues(n,s,u,g){if(!g||!u)return;const h=g[u];if(!h)return;const{tl:v,br:T,pixelRatio:A}=h;for(let D=n;D<s;D++)this.paintVertexArray.emplace(D,v[0],v[1],T[0],T[1],A)}upload(n){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=n.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class _u{constructor(n,s,u=()=>!0){this.binders={},this._buffers=[],this.context=s;const g=[];for(const h in n.paint._values){const v=n.paint.get(h),T=n.paint.get(`${h}-use-theme`);if(h.endsWith("-use-theme")||!u(h)||!(v instanceof ld&&Mh(v.property.specification)))continue;const A=yw(h,n.type),D=v.value,x=v.property.specification.type,P=!!v.property.useIntegerZoom,L=h==="line-dasharray"||h.endsWith("pattern"),I=h==="line-dasharray"&&n.layout.get("line-cap").value.kind!=="constant"||T&&T.value.kind!=="constant";if(D.kind!=="constant"||I)if(D.kind==="source"||I||L){const R=w0(h,x,"source");this.binders[h]=L?new Ac(D,A,x,R,n.id):new $l(D,A,x,R),g.push(`/a_${h}`)}else{const R=w0(h,x,"composite");this.binders[h]=new Fa(D,A,x,P,s,R),g.push(`/z_${h}`)}else this.binders[h]=L?new vu(D.value,A):new gu(D.value,A,x,s),g.push(`/u_${h}`);T&&(this.binders[h].ignoreLut=T.constantOr("default")==="none",this.binders[h].lutExpression=T.value,this.binders[h].checkUseTheme=!0)}this.cacheKey=g.sort().join("")}getMaxValue(n){const s=this.binders[n];return s instanceof $l||s instanceof Fa?s.maxValue:0}populatePaintArrays(n,s,u,g,h,v,T){for(const A in this.binders){const D=this.binders[A];D.context=this.context,D instanceof $l||D instanceof Fa||D instanceof Ac?D.populatePaintArray(n,s,u,g,h,v,T):D.lutExpression&&D instanceof gu&&D.lutExpression&&(D.lutExpression.kind==="composite"||D.lutExpression.kind==="source")&&(D.ignoreLut=D.lutExpression.evaluate(new zo(0,{brightness:v}),s,{},h,g,T)==="none")}}setConstantPatternPositions(n){for(const s in this.binders){const u=this.binders[s];u instanceof vu&&u.setConstantPatternPositions(n)}}updatePaintArrays(n,s,u,g,h,v,T,A,D){let x=!1;const P=Object.keys(n),L=P.length!==0&&!A,I=L?P:s.uniqueIds;this.context.lut=h.lut;for(const R in this.binders){const V=this.binders[R];if(V.context=this.context,(V instanceof $l||V instanceof Fa||V instanceof Ac)&&V.expression&&V.expression.kind&&V.expression.kind!=="constant"&&(V.expression.isStateDependent===!0||V.expression.isLightConstant===!1)){const W=h.paint.get(R);V.expression=W.value;for(const K of I){const re=n[K.toString()];s.eachPosition(K,(ie,Q,ue)=>{const _e=g.feature(ie);V.updatePaintArray(Q,ue,_e,re,v,T,D)})}if(!L)for(const K of u.uniqueIds){const re=n[K.toString()];u.eachPosition(K,(ie,Q,ue)=>{const _e=g.feature(ie);V.updatePaintArray(Q,ue,_e,re,v,T,D)})}x=!0}}return x}defines(){const n=[];for(const s in this.binders){const u=this.binders[s];(u instanceof gu||u instanceof vu)&&n.push(...u.uniformNames.map(g=>`#define HAS_UNIFORM_${g}`))}return n}getBinderAttributes(){const n=[];for(const s in this.binders){const u=this.binders[s];if(u instanceof $l||u instanceof Fa||u instanceof Ac)for(let g=0;g<u.paintVertexAttributes.length;g++)n.push(u.paintVertexAttributes[g].name)}return n}getBinderUniforms(){const n=[];for(const s in this.binders){const u=this.binders[s];if(u instanceof gu||u instanceof vu||u instanceof Fa)for(const g of u.uniformNames)n.push(g)}return n}getPaintVertexBuffers(){return this._buffers}getUniforms(n){const s=[];for(const u in this.binders){const g=this.binders[u];if(g instanceof gu||g instanceof vu||g instanceof Fa)for(const h of g.uniformNames)s.push({name:h,property:u,binding:g.getBinding(n,h)})}return s}setUniforms(n,s,u,g,h){for(const{name:v,property:T,binding:A}of u){if(this.binders[T].checkUseTheme&&this.binders[T]instanceof gu){const D=g.get(`${T}-use-theme`);D.isConstant()&&(this.binders[T].ignoreLut=D.constantOr("default")==="none")}this.binders[T].setUniform(n,A,h,g.get(T),v)}}updatePaintBuffers(){this._buffers=[];for(const n in this.binders){const s=this.binders[n];(s instanceof $l||s instanceof Fa||s instanceof Ac)&&s.paintVertexBuffer&&this._buffers.push(s.paintVertexBuffer)}}upload(n){for(const s in this.binders){const u=this.binders[s];(u instanceof $l||u instanceof Fa||u instanceof Ac)&&u.upload(n)}this.updatePaintBuffers()}destroy(){for(const n in this.binders){const s=this.binders[n];(s instanceof $l||s instanceof Fa||s instanceof Ac)&&s.destroy()}}}class kc{constructor(n,s,u=()=>!0){this.programConfigurations={};for(const g of n)this.programConfigurations[g.id]=new _u(g,s,u);this.needsUpload=!1,this._featureMap=new Wh,this._featureMapWithoutIds=new Wh,this._bufferOffset=0,this._idlessCounter=0}populatePaintArrays(n,s,u,g,h,v,T,A){for(const D in this.programConfigurations)this.programConfigurations[D].populatePaintArrays(n,s,g,h,v,T,A);s.id!==void 0?this._featureMap.add(s.id,u,this._bufferOffset,n):(this._featureMapWithoutIds.add(this._idlessCounter,u,this._bufferOffset,n),this._idlessCounter+=1),this._bufferOffset=n,this.needsUpload=!0}updatePaintArrays(n,s,u,g,h,v,T){for(const A of u)this.needsUpload=this.programConfigurations[A.id].updatePaintArrays(n,this._featureMap,this._featureMapWithoutIds,s,A,g,h,v,T||0)||this.needsUpload}get(n){return this.programConfigurations[n]}upload(n){if(this.needsUpload){for(const s in this.programConfigurations)this.programConfigurations[s].upload(n);this.needsUpload=!1}}destroy(){for(const n in this.programConfigurations)this.programConfigurations[n].destroy()}}const _w={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-occlusion-opacity":["occlusion_opacity"],"icon-occlusion-opacity":["occlusion_opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-emissive-strength":["emissive_strength"],"icon-emissive-strength":["emissive_strength"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"symbol-z-offset":["z_offset"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio"],"fill-pattern":["pattern","pixel_ratio"],"fill-extrusion-pattern":["pattern","pixel_ratio"],"line-dasharray":["dash"]};function yw(c,n){return _w[c]||[c.replace(`${n}-`,"").replace(/-/g,"_")]}const bw={"line-pattern":{source:Ji,composite:Ji},"fill-pattern":{source:Ji,composite:Ji},"fill-extrusion-pattern":{source:Ji,composite:Ji},"line-dasharray":{source:Tp,composite:Tp}},Pp={color:{source:fd,composite:mu},number:{source:Bh,composite:fd}};function w0(c,n,s){const u=bw[c];return u&&u[s]||Pp[n][s]}Hn(gu,"ConstantBinder"),Hn(vu,"PatternConstantBinder"),Hn($l,"SourceExpressionBinder"),Hn(Ac,"PatternCompositeBinder"),Hn(Fa,"CompositeExpressionBinder"),Hn(_u,"ProgramConfiguration",{omit:["_buffers"]}),Hn(kc,"ProgramConfigurationSet");const hs=In/Math.PI/2,md=5,S0=6,T0=16383,gd=64,Rp=[gd,32,16],Ks=-hs,Zs=hs;function vd(c,n,s,u=hs){return s=Ot(s),[c*Math.sin(s)*u,-n*u,c*Math.cos(s)*u]}function yu(c,n,s){return vd(Math.cos(Ot(c)),Math.sin(Ot(c)),n,s)}const bu=63710088e-1,xv=2*Math.PI*bu;class Qr{constructor(n,s){if(isNaN(n)||isNaN(s))throw new Error(`Invalid LngLat object: (${n}, ${s})`);if(this.lng=+n,this.lat=+s,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Qr(Yn(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(n){const s=Math.PI/180,u=this.lat*s,g=n.lat*s,h=Math.sin(u)*Math.sin(g)+Math.cos(u)*Math.cos(g)*Math.cos((n.lng-this.lng)*s);return bu*Math.acos(Math.min(h,1))}toBounds(n=0){const s=360*n/40075017,u=s/Math.cos(Math.PI/180*this.lat);return new Pc({lng:this.lng-u,lat:this.lat-s},{lng:this.lng+u,lat:this.lat+s})}toEcef(n){return yu(this.lat,this.lng,hs+n*hs/bu)}static convert(n){if(n instanceof Qr)return n;if(Array.isArray(n)&&(n.length===2||n.length===3))return new Qr(Number(n[0]),Number(n[1]));if(!Array.isArray(n)&&typeof n=="object"&&n!==null)return new Qr(Number("lng"in n?n.lng:n.lon),Number(n.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}class Pc{constructor(n,s){if(n)if(s)this.setSouthWest(n).setNorthEast(s);else if(n.length===4){const u=n;this.setSouthWest([u[0],u[1]]).setNorthEast([u[2],u[3]])}else{const u=n;this.setSouthWest(u[0]).setNorthEast(u[1])}}setNorthEast(n){return this._ne=n instanceof Qr?new Qr(n.lng,n.lat):Qr.convert(n),this}setSouthWest(n){return this._sw=n instanceof Qr?new Qr(n.lng,n.lat):Qr.convert(n),this}extend(n){const s=this._sw,u=this._ne;let g,h;if(n instanceof Qr)g=n,h=n;else{if(!(n instanceof Pc))return Array.isArray(n)?n.length===4||n.every(Array.isArray)?this.extend(Pc.convert(n)):this.extend(Qr.convert(n)):typeof n=="object"&&n!==null&&n.hasOwnProperty("lat")&&(n.hasOwnProperty("lon")||n.hasOwnProperty("lng"))?this.extend(Qr.convert(n)):this;if(g=n._sw,h=n._ne,!g||!h)return this}return s||u?(s.lng=Math.min(g.lng,s.lng),s.lat=Math.min(g.lat,s.lat),u.lng=Math.max(h.lng,u.lng),u.lat=Math.max(h.lat,u.lat)):(this._sw=new Qr(g.lng,g.lat),this._ne=new Qr(h.lng,h.lat)),this}getCenter(){return new Qr((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new Qr(this.getWest(),this.getNorth())}getSouthEast(){return new Qr(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(n){const{lng:s,lat:u}=Qr.convert(n);let g=this._sw.lng<=s&&s<=this._ne.lng;return this._sw.lng>this._ne.lng&&(g=this._sw.lng>=s&&s>=this._ne.lng),this._sw.lat<=u&&u<=this._ne.lat&&g}static convert(n){if(n)return n instanceof Pc?n:new Pc(n)}}const xw=0,ww=25.5;function Op(c){return xv*Math.cos(c*Math.PI/180)}function ul(c){return(180+c)/360}function Na(c){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+c*Math.PI/360)))/360}function fs(c,n){return c/Op(n)}function Ds(c){return 360*c-180}function Ui(c){return 360/Math.PI*Math.atan(Math.exp((180-360*c)*Math.PI/180))-90}function C0(c,n){return c*Op(Ui(n))}const ws=85.051129;function wv(c){return Math.cos(Ot(It(c,-85.051129,ws)))}function _d(c,n){const s=It(n,xw,ww),u=Math.pow(2,s);return wv(c)*xv/(512*u)}function f(c){return 1/Math.cos(c*Math.PI/180)}function o(c,n=0){const s=Math.exp(Math.PI*(1-(c.y+n/In)/(1<<c.z)*2));return 80150034*s/(s*s+1)/In/(1<<c.z)}class l{constructor(n,s,u=0){this.x=+n,this.y=+s,this.z=+u}static fromLngLat(n,s=0){const u=Qr.convert(n);return new l(ul(u.lng),Na(u.lat),fs(s,u.lat))}toLngLat(){return new Qr(Ds(this.x),Ui(this.y))}toAltitude(){return C0(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/xv*f(Ui(this.y))}}function m(c,n,s,u,g,h,v,T,A){const D=(n+u)/2,x=(s+g)/2,P=new Qe(D,x);T(P),function(L,I,R,V,W,K){const re=R-W,ie=V-K;return Math.abs((V-I)*re-(R-L)*ie)/Math.hypot(re,ie)}(P.x,P.y,h.x,h.y,v.x,v.y)>=A?(m(c,n,s,D,x,h,P,T,A),m(c,D,x,u,g,P,v,T,A)):c.push(v)}function y(c,n,s){let u=c[0],g=u.x,h=u.y;n(u);const v=[u];for(let T=1;T<c.length;T++){const A=c[T],{x:D,y:x}=A;n(A),m(v,g,h,D,x,u,A,n,s),g=D,h=x,u=A}return v}function w(c,n,s,u){if(u(n,s)){const g=n.add(s)._mult(.5);w(c,n,g,u),w(c,g,s,u)}else c.push(s)}function E(c,n){let s=c[0];const u=[s];for(let g=1;g<c.length;g++){const h=c[g];w(u,s,h,n),s=h}return u}const O=Math.pow(2,14)-1,$=-O-1;function H(c,n){const s=Math.round(c.x*n),u=Math.round(c.y*n);return c.x=It(s,$,O),c.y=It(u,$,O),(s<c.x||s>c.x+1||u<c.y||u>c.y+1)&&wn("Geometry exceeds allowed extent, reduce your vector tile buffer size"),c}function G(c,n,s){const u=c.loadGeometry(),g=c.extent,h=In/g;if(n&&s&&s.projection.isReprojectedInTileSpace){const v=1<<n.z,{scale:T,x:A,y:D,projection:x}=s,P=L=>{const I=Ds((n.x+L.x/g)/v),R=Ui((n.y+L.y/g)/v),V=x.project(I,R);L.x=(V.x*T-A)*g,L.y=(V.y*T-D)*g};for(let L=0;L<u.length;L++)if(c.type!==1)u[L]=y(u[L],P,1);else{const I=[];for(const R of u[L])R.x<0||R.x>=g||R.y<0||R.y>=g||(P(R),I.push(R));u[L]=I}}for(const v of u)for(const T of v)H(T,h);return u}function Z(c,n){return{type:c.type,id:c.id,properties:c.properties,geometry:n?G(c):[]}}function X(c,n,s,u,g){c.emplaceBack(2*n+(u+1)/2,2*s+(g+1)/2)}function oe(c,n,s){c.emplaceBack(n.x,n.y,n.z,s[0]*16384,s[1]*16384,s[2]*16384)}class xe{constructor(n){this.zoom=n.zoom,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map(s=>s.fqid),this.index=n.index,this.hasPattern=!1,this.projection=n.projection,this.layoutVertexArray=new Bl,this.indexArray=new $i,this.segments=new ei,this.programConfigurations=new kc(n.layers,{zoom:n.zoom,lut:n.lut}),this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id)}updateFootprints(n,s){}populate(n,s,u,g){const h=this.layers[0],v=[];let T=null;h.type==="circle"&&(T=h.layout.get("circle-sort-key"));for(const{feature:D,id:x,index:P,sourceLayerIndex:L}of n){const I=this.layers[0]._featureFilter.needGeometry,R=Z(D,I);if(!this.layers[0]._featureFilter.filter(new zo(this.zoom),R,u))continue;const V=T?T.evaluate(R,{},u):void 0,W={id:x,properties:D.properties,type:D.type,sourceLayerIndex:L,index:P,geometry:I?R.geometry:G(D,u,g),patterns:{},sortKey:V};v.push(W)}T&&v.sort((D,x)=>D.sortKey-x.sortKey);let A=null;g.projection.name==="globe"&&(this.globeExtVertexArray=new Nh,A=g.projection);for(const D of v){const{geometry:x,index:P,sourceLayerIndex:L}=D,I=n[P].feature;this.addFeature(D,x,P,s.availableImages,u,A,s.brightness),s.featureIndex.insert(I,x,P,L,this.index)}}update(n,s,u,g,h,v,T){this.programConfigurations.updatePaintArrays(n,s,h,u,g,v,T)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(n){this.uploaded||(this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,pw.members),this.indexBuffer=n.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=n.createVertexBuffer(this.globeExtVertexArray,mw.members))),this.programConfigurations.upload(n),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(n,s,u,g,h,v,T){for(const A of s)for(const D of A){const x=D.x,P=D.y;if(x<0||x>=In||P<0||P>=In)continue;if(v){const R=v.projectTilePoint(x,P,h),V=v.upVector(h,x,P),W=this.globeExtVertexArray;oe(W,R,V),oe(W,R,V),oe(W,R,V),oe(W,R,V)}const L=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,n.sortKey),I=L.vertexLength;X(this.layoutVertexArray,x,P,-1,-1),X(this.layoutVertexArray,x,P,1,-1),X(this.layoutVertexArray,x,P,1,1),X(this.layoutVertexArray,x,P,-1,1),this.indexArray.emplaceBack(I,I+1,I+2),this.indexArray.emplaceBack(I,I+2,I+3),L.vertexLength+=4,L.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,n,u,{},g,h,T)}}function ve(c,n){for(let s=0;s<c.length;s++)if(Ye(n,c[s]))return!0;for(let s=0;s<n.length;s++)if(Ye(c,n[s]))return!0;return!!Ge(c,n)}function Ce(c,n,s){return!!Ye(c,n)||!!rt(n,c,s)}function Te(c,n){if(c.length===1)return et(n,c[0]);for(let s=0;s<n.length;s++){const u=n[s];for(let g=0;g<u.length;g++)if(Ye(c,u[g]))return!0}for(let s=0;s<c.length;s++)if(et(n,c[s]))return!0;for(let s=0;s<n.length;s++)if(Ge(c,n[s]))return!0;return!1}function Le(c,n,s){if(c.length>1){if(Ge(c,n))return!0;for(let u=0;u<n.length;u++)if(rt(n[u],c,s))return!0}for(let u=0;u<c.length;u++)if(rt(c[u],n,s))return!0;return!1}function Ge(c,n){if(c.length===0||n.length===0)return!1;for(let s=0;s<c.length-1;s++){const u=c[s],g=c[s+1];for(let h=0;h<n.length-1;h++)if(He(u,g,n[h],n[h+1]))return!0}return!1}function He(c,n,s,u){return sr(c,s,u)!==sr(n,s,u)&&sr(c,n,s)!==sr(c,n,u)}function rt(c,n,s){const u=s*s;if(n.length===1)return c.distSqr(n[0])<u;for(let g=1;g<n.length;g++)if(Xe(c,n[g-1],n[g])<u)return!0;return!1}function Xe(c,n,s){const u=n.distSqr(s);if(u===0)return c.distSqr(n);const g=((c.x-n.x)*(s.x-n.x)+(c.y-n.y)*(s.y-n.y))/u;return c.distSqr(g<0?n:g>1?s:s.sub(n)._mult(g)._add(n))}function et(c,n){let s,u,g,h=!1;for(let v=0;v<c.length;v++){s=c[v];for(let T=0,A=s.length-1;T<s.length;A=T++)u=s[T],g=s[A],u.y>n.y!=g.y>n.y&&n.x<(g.x-u.x)*(n.y-u.y)/(g.y-u.y)+u.x&&(h=!h)}return h}function Ye(c,n){let s=!1;for(let u=0,g=c.length-1;u<c.length;g=u++){const h=c[u],v=c[g];h.y>n.y!=v.y>n.y&&n.x<(v.x-h.x)*(n.y-h.y)/(v.y-h.y)+h.x&&(s=!s)}return s}function at(c,n,s,u,g){for(const v of c)if(n<=v.x&&s<=v.y&&u>=v.x&&g>=v.y)return!0;const h=[new Qe(n,s),new Qe(n,g),new Qe(u,g),new Qe(u,s)];if(c.length>2){for(const v of h)if(Ye(c,v))return!0}for(let v=0;v<c.length-1;v++)if(gt(c[v],c[v+1],h))return!0;return!1}function gt(c,n,s){const u=s[0],g=s[2];if(c.x<u.x&&n.x<u.x||c.x>g.x&&n.x>g.x||c.y<u.y&&n.y<u.y||c.y>g.y&&n.y>g.y)return!1;const h=sr(c,n,s[0]);return h!==sr(c,n,s[1])||h!==sr(c,n,s[2])||h!==sr(c,n,s[3])}function Vt(c,n,s,u,g,h){let v=n.y-c.y,T=c.x-n.x;if(h=h||0){const A=v*v+T*T;if(A===0)return!0;const D=Math.sqrt(A);v/=D,T/=D}return!((s.x-c.x)*v+(s.y-c.y)*T-h<0||(u.x-c.x)*v+(u.y-c.y)*T-h<0||(g.x-c.x)*v+(g.y-c.y)*T-h<0)}function Rt(c,n,s,u,g,h,v){return!(Vt(c,n,u,g,h,v)||Vt(n,s,u,g,h,v)||Vt(s,c,u,g,h,v)||Vt(u,g,c,n,s,v)||Vt(g,h,c,n,s,v)||Vt(h,u,c,n,s,v))}function tn(c,n,s){const u=n.paint.get(c).value;return u.kind==="constant"?u.value:s.programConfigurations.get(n.id).getMaxValue(c)}function Jt(c){return Math.sqrt(c[0]*c[0]+c[1]*c[1])}function Et(c,n,s,u,g){if(!n[0]&&!n[1])return c;const h=Qe.convert(n)._mult(g);s==="viewport"&&h._rotate(-u);const v=[];for(let T=0;T<c.length;T++)v.push(c[T].sub(h));return v}function jt(c,n,s,u){const g=Qe.convert(c)._mult(u);return n==="viewport"&&g._rotate(-s),g}let gn,Tt;Hn(xe,"CircleBucket",{omit:["layers"]});var rn,Ht={exports:{}},Cn=(rn||(rn=1,function(c,n){(function(s){function u(h,v,T){var A=g(256*h,256*(v=Math.pow(2,T)-v-1),T),D=g(256*(h+1),256*(v+1),T);return A[0]+","+A[1]+","+D[0]+","+D[1]}function g(h,v,T){var A=2*Math.PI*6378137/256/Math.pow(2,T);return[h*A-2*Math.PI*6378137/2,v*A-2*Math.PI*6378137/2]}s.getURL=function(h,v,T,A,D,x){return x=x||{},h+"?"+["bbox="+u(T,A,D),"format="+(x.format||"image/png"),"service="+(x.service||"WMS"),"version="+(x.version||"1.1.1"),"request="+(x.request||"GetMap"),"srs="+(x.srs||"EPSG:3857"),"width="+(x.width||256),"height="+(x.height||256),"layers="+v].join("&")},s.getTileBBox=u,s.getMercCoords=g,Object.defineProperty(s,"__esModule",{value:!0})})(n)}(0,Ht.exports)),Ht.exports);class dn{constructor(n,s,u){this.z=n,this.x=s,this.y=u,this.key=Tn(0,n,n,s,u)}equals(n){return this.z===n.z&&this.x===n.x&&this.y===n.y}url(n,s){const u=Cn.getTileBBox(this.x,this.y,this.z),g=function(h,v,T){let A,D="";for(let x=h;x>0;x--)A=1<<x-1,D+=(v&A?1:0)+(T&A?2:0);return D}(this.z,this.x,this.y);return n[(this.x+this.y)%n.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(s==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",g).replace("{bbox-epsg-3857}",u)}toString(){return`${this.z}/${this.x}/${this.y}`}}class nn{constructor(n,s){this.wrap=n,this.canonical=s,this.key=Tn(n,s.z,s.z,s.x,s.y)}}class vn{constructor(n,s,u,g,h){this.overscaledZ=n,this.wrap=s,this.canonical=new dn(u,+g,+h),this.key=s===0&&n===u?this.canonical.key:Tn(s,n,u,g,h)}equals(n){return this.overscaledZ===n.overscaledZ&&this.wrap===n.wrap&&this.canonical.equals(n.canonical)}scaledTo(n){const s=this.canonical.z-n;return n>this.canonical.z?new vn(n,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new vn(n,this.wrap,n,this.canonical.x>>s,this.canonical.y>>s)}calculateScaledKey(n,s=!0){if(this.overscaledZ===n&&s)return this.key;if(n>this.canonical.z)return Tn(this.wrap*+s,n,this.canonical.z,this.canonical.x,this.canonical.y);{const u=this.canonical.z-n;return Tn(this.wrap*+s,n,n,this.canonical.x>>u,this.canonical.y>>u)}}isChildOf(n){if(n.wrap!==this.wrap)return!1;const s=this.canonical.z-n.canonical.z;return n.overscaledZ===0||n.overscaledZ<this.overscaledZ&&n.canonical.z<this.canonical.z&&n.canonical.x===this.canonical.x>>s&&n.canonical.y===this.canonical.y>>s}children(n){if(this.overscaledZ>=n)return[new vn(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const s=this.canonical.z+1,u=2*this.canonical.x,g=2*this.canonical.y;return[new vn(s,this.wrap,s,u,g),new vn(s,this.wrap,s,u+1,g),new vn(s,this.wrap,s,u,g+1),new vn(s,this.wrap,s,u+1,g+1)]}isLessThan(n){return this.wrap<n.wrap||!(this.wrap>n.wrap)&&(this.overscaledZ<n.overscaledZ||!(this.overscaledZ>n.overscaledZ)&&(this.canonical.x<n.canonical.x||!(this.canonical.x>n.canonical.x)&&this.canonical.y<n.canonical.y))}wrapped(){return new vn(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(n){return new vn(this.overscaledZ,n,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new nn(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function Tn(c,n,s,u,g){const h=1<<Math.min(s,22);let v=h*(g%h)+u%h;return c&&s<22&&(v+=h*h*((c<0?-2*c-1:2*c)%(1<<2*(22-s)))),16*(32*v+s)+(n-s)}const Ln=[c=>{let n=c.canonical.x-1,s=c.wrap;return n<0&&(n=(1<<c.canonical.z)-1,s--),new vn(c.overscaledZ,s,c.canonical.z,n,c.canonical.y)},c=>{let n=c.canonical.x+1,s=c.wrap;return n===1<<c.canonical.z&&(n=0,s++),new vn(c.overscaledZ,s,c.canonical.z,n,c.canonical.y)},c=>new vn(c.overscaledZ,c.wrap,c.canonical.z,c.canonical.x,(c.canonical.y===0?1<<c.canonical.z:c.canonical.y)-1),c=>new vn(c.overscaledZ,c.wrap,c.canonical.z,c.canonical.x,c.canonical.y===(1<<c.canonical.z)-1?0:c.canonical.y+1)];Hn(dn,"CanonicalTileID"),Hn(vn,"OverscaledTileID",{omit:["projMatrix","expandedProjMatrix"]});const Un=so([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:dr}=Un,nr=so([{name:"a_pos_3",components:3,type:"Int16"}]);var ir=so([{name:"a_pos",type:"Int16",components:2}]);class br{constructor(n,s){this.pos=n,this.dir=s}intersectsPlane(n,s,u){const g=Fe.vec3.dot(s,this.dir);if(Math.abs(g)<1e-6)return!1;const h=((n[0]-this.pos[0])*s[0]+(n[1]-this.pos[1])*s[1]+(n[2]-this.pos[2])*s[2])/g;return u[0]=this.pos[0]+this.dir[0]*h,u[1]=this.pos[1]+this.dir[1]*h,u[2]=this.pos[2]+this.dir[2]*h,!0}closestPointOnSphere(n,s,u){if(Fe.vec3.equals(this.pos,n)||s===0)return u[0]=u[1]=u[2]=0,!1;const[g,h,v]=this.dir,T=this.pos[0]-n[0],A=this.pos[1]-n[1],D=this.pos[2]-n[2],x=g*g+h*h+v*v,P=2*(T*g+A*h+D*v),L=P*P-4*x*(T*T+A*A+D*D-s*s);if(L<0){const I=Math.max(-P/2,0),R=T+g*I,V=A+h*I,W=D+v*I,K=Math.hypot(R,V,W);return u[0]=R*s/K,u[1]=V*s/K,u[2]=W*s/K,!1}{const I=(-P-Math.sqrt(L))/(2*x);if(I<0){const R=Math.hypot(T,A,D);return u[0]=T*s/R,u[1]=A*s/R,u[2]=D*s/R,!1}return u[0]=T+g*I,u[1]=A+h*I,u[2]=D+v*I,!0}}}class jr{constructor(n,s,u,g,h){this.TL=n,this.TR=s,this.BR=u,this.BL=g,this.horizon=h}static fromInvProjectionMatrix(n,s,u){const g=[-1,1,1],h=[1,1,1],v=[1,-1,1],T=[-1,-1,1],A=Fe.vec3.transformMat4(g,g,n),D=Fe.vec3.transformMat4(h,h,n),x=Fe.vec3.transformMat4(v,v,n),P=Fe.vec3.transformMat4(T,T,n);return new jr(A,D,x,P,s/u)}}function ho(c,n,s){let u=1/0,g=-1/0;const h=[];for(const v of c){Fe.vec3.sub(h,v,n);const T=Fe.vec3.dot(h,s);u=Math.min(u,T),g=Math.max(g,T)}return[u,g]}function Zo(c,n){let s=!0;for(let u=0;u<c.planes.length;u++){const g=c.planes[u];let h=0;for(let v=0;v<n.length;v++)h+=Fe.vec3.dot(g,n[v])+g[3]>=0;if(h===0)return 0;h!==n.length&&(s=!1)}return s?2:1}function No(c,n){for(const s of c.projections){const u=ho(n,c.points[0],s.axis);if(s.projection[1]<u[0]||s.projection[0]>u[1])return 0}return 1}function Sr(c,n){let s=0;const u=[0,0,0,0];for(let g=0;g<c.length;g++)u[0]=c[g][0],u[1]=c[g][1],u[2]=c[g][2],u[3]=1,Fe.vec4.dot(u,n)>=0&&s++;return s}class Xr{constructor(n,s){this.points=n||new Array(8).fill([0,0,0]),this.planes=s||new Array(6).fill([0,0,0,0]),this.bounds=Jn.fromPoints(this.points),this.projections=[],this.frustumEdges=[Fe.vec3.sub([],this.points[2],this.points[3]),Fe.vec3.sub([],this.points[0],this.points[3]),Fe.vec3.sub([],this.points[4],this.points[0]),Fe.vec3.sub([],this.points[5],this.points[1]),Fe.vec3.sub([],this.points[6],this.points[2]),Fe.vec3.sub([],this.points[7],this.points[3])];for(const u of this.frustumEdges){const g=[0,-u[2],u[1]],h=[u[2],0,-u[0]];this.projections.push({axis:g,projection:ho(this.points,this.points[0],g)}),this.projections.push({axis:h,projection:ho(this.points,this.points[0],h)})}}static fromInvProjectionMatrix(n,s,u,g){const h=Math.pow(2,u),v=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(D=>{const x=Fe.vec4.transformMat4([],D,n),P=1/x[3]/s*h;return Fe.vec4.mul(x,x,[P,P,g?1/x[3]:P,P])}),T=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(D=>{const x=Fe.vec3.sub([],v[D[0]],v[D[1]]),P=Fe.vec3.sub([],v[D[2]],v[D[1]]),L=Fe.vec3.normalize([],Fe.vec3.cross([],x,P)),I=-Fe.vec3.dot(L,v[D[1]]);return L.concat(I)}),A=[];for(let D=0;D<v.length;D++)A.push([v[D][0],v[D][1],v[D][2]]);return new Xr(A,T)}intersectsPrecise(n,s,u){for(let g=0;g<s.length;g++)if(!Sr(n,s[g]))return 0;for(let g=0;g<this.planes.length;g++)if(!Sr(n,this.planes[g]))return 0;for(const g of u)for(const h of this.frustumEdges){const v=Fe.vec3.cross([],g,h),T=Fe.vec3.length(v);if(T===0)continue;Fe.vec3.scale(v,v,1/T);const A=ho(this.points,this.points[0],v),D=ho(n,this.points[0],v);if(A[0]>D[1]||D[0]>A[1])return 0}return 1}containsPoint(n){for(const s of this.planes){const u=s[3];if(Fe.vec3.dot([s[0],s[1],s[2]],n)+u<0)return!1}return!0}}class Jn{static fromPoints(n){const s=[1/0,1/0,1/0],u=[-1/0,-1/0,-1/0];for(const g of n)Fe.vec3.min(s,s,g),Fe.vec3.max(u,u,g);return new Jn(s,u)}static fromTileIdAndHeight(n,s,u){const g=1<<n.canonical.z,h=n.canonical.x,v=n.canonical.y;return new Jn([h/g,v/g,s],[(h+1)/g,(v+1)/g,u])}static applyTransform(n,s){const u=n.getCorners();for(let g=0;g<u.length;++g)Fe.vec3.transformMat4(u[g],u[g],s);return Jn.fromPoints(u)}static applyTransformFast(n,s){const u=[s[12],s[13],s[14]],g=[...u];for(let h=0;h<3;h++)for(let v=0;v<3;v++){const T=s[4*v+h],A=T*n.min[v],D=T*n.max[v];u[h]+=Math.min(A,D),g[h]+=Math.max(A,D)}return new Jn(u,g)}static projectAabbCorners(n,s){const u=n.getCorners();for(let g=0;g<u.length;++g)Fe.vec3.transformMat4(u[g],u[g],s);return u}constructor(n,s){this.min=n,this.max=s,this.center=Fe.vec3.scale([],Fe.vec3.add([],this.min,this.max),.5)}quadrant(n){const s=[n%2==0,n<2],u=Fe.vec3.clone(this.min),g=Fe.vec3.clone(this.max);for(let h=0;h<s.length;h++)u[h]=s[h]?this.min[h]:this.center[h],g[h]=s[h]?this.center[h]:this.max[h];return g[2]=this.max[2],new Jn(u,g)}distanceX(n){return Math.max(Math.min(this.max[0],n[0]),this.min[0])-n[0]}distanceY(n){return Math.max(Math.min(this.max[1],n[1]),this.min[1])-n[1]}distanceZ(n){return Math.max(Math.min(this.max[2],n[2]),this.min[2])-n[2]}getCorners(){const n=this.min,s=this.max;return[[n[0],n[1],n[2]],[s[0],n[1],n[2]],[s[0],s[1],n[2]],[n[0],s[1],n[2]],[n[0],n[1],s[2]],[s[0],n[1],s[2]],[s[0],s[1],s[2]],[n[0],s[1],s[2]]]}intersects(n){return this.intersectsAabb(n.bounds)?Zo(n,this.getCorners()):0}intersectsFlat(n){return this.intersectsAabb(n.bounds)?Zo(n,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsPrecise(n,s){return s||this.intersects(n)?No(n,this.getCorners()):0}intersectsPreciseFlat(n,s){return s||this.intersectsFlat(n)?No(n,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsAabb(n){for(let s=0;s<3;++s)if(this.min[s]>n.max[s]||n.min[s]>this.max[s])return!1;return!0}intersectsAabbXY(n){return!(this.min[0]>n.max[0]||n.min[0]>this.max[0]||this.min[1]>n.max[1]||n.min[1]>this.max[1])}encapsulate(n){for(let s=0;s<3;s++)this.min[s]=Math.min(this.min[s],n.min[s]),this.max[s]=Math.max(this.max[s],n.max[s])}encapsulatePoint(n){for(let s=0;s<3;s++)this.min[s]=Math.min(this.min[s],n[s]),this.max[s]=Math.max(this.max[s],n[s])}closestPoint(n){return[Math.max(Math.min(this.max[0],n[0]),this.min[0]),Math.max(Math.min(this.max[1],n[1]),this.min[1]),Math.max(Math.min(this.max[2],n[2]),this.min[2])]}}function Ur(c){return c*hs/bu}Hn(Jn,"Aabb");const ro=[new Jn([Ks,Ks,Ks],[Zs,Zs,Zs]),new Jn([Ks,Ks,Ks],[0,0,Zs]),new Jn([0,Ks,Ks],[Zs,0,Zs]),new Jn([Ks,0,Ks],[0,Zs,Zs]),new Jn([0,0,Ks],[Zs,Zs,Zs])];function ao(c,n,s,u=!0){const g=Fe.vec3.scale([],c._camera.position,c.worldSize),h=[n,s,1,1];Fe.vec4.transformMat4(h,h,c.pixelMatrixInverse),Fe.vec4.scale(h,h,1/h[3]);const v=Fe.vec3.sub([],h,g),T=Fe.vec3.normalize([],v),A=c.globeMatrix,D=[A[12],A[13],A[14]],x=Fe.vec3.sub([],D,g),P=Fe.vec3.length(x),L=Fe.vec3.normalize([],x),I=c.worldSize/(2*Math.PI),R=Fe.vec3.dot(L,T),V=Math.asin(I/P);if(V<Math.acos(R)){if(!u)return null;const ot=[],$e=[];Fe.vec3.scale(ot,T,P/R),Fe.vec3.normalize($e,Fe.vec3.sub($e,ot,x)),Fe.vec3.normalize(T,Fe.vec3.add(T,x,Fe.vec3.scale(T,$e,Math.tan(V)*P)))}const W=[];new br(g,T).closestPointOnSphere(D,I,W);const K=Fe.vec3.normalize([],mo(A,0)),re=Fe.vec3.normalize([],mo(A,1)),ie=Fe.vec3.normalize([],mo(A,2)),Q=Fe.vec3.dot(K,W),ue=Fe.vec3.dot(re,W),_e=Fe.vec3.dot(ie,W),Ee=Ft(Math.asin(-ue/I));let Ne=Ft(Math.atan2(Q,_e));Ne=c.center.lng+function(ot,$e){const it=($e-ot+180)%360-180;return it<-180?it+360:it}(c.center.lng,Ne);const ze=ul(Ne),De=It(Na(Ee),0,1);return new l(ze,De)}class qo{constructor(n,s,u){this.a=Fe.vec3.sub([],n,u),this.b=Fe.vec3.sub([],s,u),this.center=u;const g=Fe.vec3.normalize([],this.a),h=Fe.vec3.normalize([],this.b);this.angle=Math.acos(Fe.vec3.dot(g,h))}}function Pi(c,n){if(c.angle===0)return null;let s;return s=c.a[n]===0?1/c.angle*.5*Math.PI:1/c.angle*Math.atan(c.b[n]/c.a[n]/Math.sin(c.angle)-1/Math.tan(c.angle)),s<0||s>1?null:function(u,g,h,v){const T=Math.sin(h);return u*(Math.sin((1-v)*h)/T)+g*(Math.sin(v*h)/T)}(c.a[n],c.b[n],c.angle,It(s,0,1))+c.center[n]}function bi(c){if(c.z<=1)return ro[c.z+2*c.y+c.x];const n=Ao(Ko(c));return Jn.fromPoints(n)}function xi(c,n,s){return Fe.vec3.scale(c,c,1-s),Fe.vec3.scaleAndAdd(c,c,n,s)}function Ys(c,n,s){for(const u of c)Fe.vec3.transformMat4(u,u,n),Fe.vec3.scale(u,u,s)}function Qi(c,n,s,u){const g=n/c.worldSize,h=c.globeMatrix;if(s.z<=1){const ze=bi(s).getCorners();return Ys(ze,h,g),Jn.fromPoints(ze)}const v=Ko(s,u),T=Ao(v,hs+Ur(c._tileCoverLift));Ys(T,h,g);const A=Number.MAX_VALUE,D=[-A,-A,-A],x=[A,A,A];if(v.contains(c.center)){for(const ot of T)Fe.vec3.min(x,x,ot),Fe.vec3.max(D,D,ot);D[2]=0;const ze=c.point,De=[ze.x*g,ze.y*g,0];return Fe.vec3.min(x,x,De),Fe.vec3.max(D,D,De),new Jn(x,D)}if(c._tileCoverLift>0){for(const ze of T)Fe.vec3.min(x,x,ze),Fe.vec3.max(D,D,ze);return new Jn(x,D)}const P=[h[12]*g,h[13]*g,h[14]*g],L=v.getCenter(),I=It(c.center.lat,-85.051129,ws),R=It(L.lat,-85.051129,ws),V=ul(c.center.lng),W=Na(I);let K=V-ul(L.lng);const re=W-Na(R);K>.5?K-=1:K<-.5&&(K+=1);let ie=0;if(Math.abs(K)>Math.abs(re))ie=K>=0?1:3;else{ie=re>=0?0:2;const ze=[h[4]*g,h[5]*g,h[6]*g],De=-Math.sin(Ot(re>=0?v.getSouth():v.getNorth()))*hs;Fe.vec3.scaleAndAdd(P,P,ze,De)}const Q=T[ie],ue=T[(ie+1)%4],_e=new qo(Q,ue,P),Ee=[Pi(_e,0)||Q[0],Pi(_e,1)||Q[1],Pi(_e,2)||Q[2]],Ne=Ss(c.zoom);if(Ne>0){const ze=function({x:ot,y:$e,z:it},ft,ut,mt,xt){const At=1/(1<<it);let _t=ot*At,Zt=_t+At,hn=$e*At,Kt=hn+At,kn=0;const Mn=(_t+Zt)/2-mt;return Mn>.5?kn=-1:Mn<-.5&&(kn=1),_t=((_t+kn)*ft-(mt*=ft))*ut+mt,Zt=((Zt+kn)*ft-mt)*ut+mt,hn=(hn*ft-(xt*=ft))*ut+xt,Kt=(Kt*ft-xt)*ut+xt,[[_t,Kt,0],[Zt,Kt,0],[Zt,hn,0],[_t,hn,0]]}(s,n,c._pixelsPerMercatorPixel,V,W);for(let ot=0;ot<T.length;ot++)xi(T[ot],ze[ot],Ne);const De=Fe.vec3.add([],ze[ie],ze[(ie+1)%4]);Fe.vec3.scale(De,De,.5),xi(Ee,De,Ne)}for(const ze of T)Fe.vec3.min(x,x,ze),Fe.vec3.max(D,D,ze);return x[2]=Math.min(Q[2],ue[2]),Fe.vec3.min(x,x,Ee),Fe.vec3.max(D,D,Ee),new Jn(x,D)}function Ko({x:c,y:n,z:s},u=!1){const g=1/(1<<s),h=new Qr(Ds(c*g),n===(1<<s)-1&&u?-90:Ui((n+1)*g)),v=new Qr(Ds((c+1)*g),n===0&&u?90:Ui(n*g));return new Pc(h,v)}function Ao(c,n=hs){const s=Ot(c.getNorth()),u=Ot(c.getSouth()),g=Math.cos(s),h=Math.cos(u),v=Math.sin(s),T=Math.sin(u),A=c.getWest(),D=c.getEast();return[vd(h,T,A,n),vd(h,T,D,n),vd(g,v,D,n),vd(g,v,A,n)]}function xo(c,n,s,u){const g=1<<s.z,h=(c/In+s.x)/g;return yu(Ui((n/In+s.y)/g),Ds(h),u)}function qr({min:c,max:n}){return T0/Math.max(n[0]-c[0],n[1]-c[1],n[2]-c[2])}const si=new Float64Array(16);function Ri(c){const n=qr(c),s=Fe.mat4.fromScaling(si,[n,n,n]);return Fe.mat4.translate(s,s,Fe.vec3.negate([],c.min))}function Co(c){const n=Fe.mat4.fromTranslation(si,c.min),s=1/qr(c);return Fe.mat4.scale(n,n,[s,s,s])}function es(c){const n=In/(2*Math.PI);return c/(2*Math.PI)/n}function wa(c,n){return In/(512*Math.pow(2,c))*qr(bi(n))}function zs(c,n,s,u,g){const h=es(s),v=[c,n,-s/(2*Math.PI)],T=Fe.mat4.identity(new Float64Array(16));return Fe.mat4.translate(T,T,v),Fe.mat4.scale(T,T,[h,h,h]),Fe.mat4.rotateX(T,T,Ot(-g)),Fe.mat4.rotateY(T,T,Ot(-u)),T}function Ss(c){return Sn(md,S0,c)}function dl(c,n){const s=yu(n.lat,n.lng),u=function(h){const v=yu(h._center.lat,h._center.lng),T=Fe.vec3.fromValues(0,1,0);let A=Fe.vec3.cross([],T,v);const D=Fe.mat4.fromRotation([],-h.angle,v);A=Fe.vec3.transformMat4(A,A,D),Fe.mat4.fromRotation(D,-h._pitch,A);const x=Fe.vec3.normalize([],v);return Fe.vec3.scale(x,x,Ur(h.cameraToCenterDistance/h.pixelsPerMeter)),Fe.vec3.transformMat4(x,x,D),Fe.vec3.add([],v,x)}(c),g=Fe.vec3.subtract([],u,s);return Fe.vec3.angle(g,s)}function Sa(c,n){return dl(c,n)>Math.PI/2*1.01}const Xs=Ot(85),xu=Math.cos(Xs),hl=Math.sin(Xs),wu=Fe.mat4.create(),yd=c=>{const n=[];return c.paint.get("circle-pitch-alignment")==="map"&&n.push("PITCH_WITH_MAP"),c.paint.get("circle-pitch-scale")==="map"&&n.push("SCALE_WITH_MAP"),n};function Lp(c,n,s,u,g,h,v,T,A){if(h&&c.queryGeometry.isAboveHorizon)return!1;h&&(A*=c.pixelToTileUnitsFactor);const D=c.tileID.canonical,x=s.projection.upVectorScale(D,s.center.lat,s.worldSize).metersToTile;for(const P of n)for(const L of P){const I=L.add(T),R=g&&s.elevation?s.elevation.exaggeration()*g.getElevationAt(I.x,I.y,!0):0,V=s.projection.projectTilePoint(I.x,I.y,D);if(R>0){const ie=s.projection.upVector(D,I.x,I.y);V.x+=ie[0]*x*R,V.y+=ie[1]*x*R,V.z+=ie[2]*x*R}const W=h?I:Sv(V.x,V.y,V.z,u),K=h?c.tilespaceRays.map(ie=>GB(ie,R)):c.queryGeometry.screenGeometry,re=Fe.vec4.transformMat4([],[V.x,V.y,V.z,1],u);if(!v&&h?A*=re[3]/s.cameraToCenterDistance:v&&!h&&(A*=s.cameraToCenterDistance/re[3]),h){const ie=Ui((L.y/In+D.y)/(1<<D.z));A/=s.projection.pixelsPerMeter(ie,1)/fs(1,ie)}if(Ce(K,W,A))return!0}return!1}function Sv(c,n,s,u){const g=Fe.vec4.transformMat4([],[c,n,s,1],u);return new Qe(g[0]/g[3],g[1]/g[3])}const IM=Fe.vec3.fromValues(0,0,0),HB=Fe.vec3.fromValues(0,0,1);function GB(c,n){const s=Fe.vec3.create();return IM[2]=n,c.intersectsPlane(IM,HB,s),new Qe(s[0],s[1])}class AM extends xe{}let kM,PM,RM,OM;function LM(c,{width:n,height:s},u,g){if(g){if(g instanceof Uint8ClampedArray)g=new Uint8Array(g.buffer);else if(g.length!==n*s*u)throw new RangeError("mismatched image size")}else g=new Uint8Array(n*s*u);return c.width=n,c.height=s,c.data=g,c}function DM(c,n,s){const{width:u,height:g}=n;u===c.width&&g===c.height||(Sw(c,n,{x:0,y:0},{x:0,y:0},{width:Math.min(c.width,u),height:Math.min(c.height,g)},s,null),c.width=u,c.height=g,c.data=n.data)}function Sw(c,n,s,u,g,h,v,T){if(g.width===0||g.height===0)return n;if(g.width>c.width||g.height>c.height||s.x>c.width-g.width||s.y>c.height-g.height)throw new RangeError("out of range source coordinates for image copy");if(g.width>n.width||g.height>n.height||u.x>n.width-g.width||u.y>n.height-g.height)throw new RangeError("out of range destination coordinates for image copy");const A=c.data,D=n.data,x=h===4&&T;for(let P=0;P<g.height;P++){const L=((s.y+P)*c.width+s.x)*h,I=((u.y+P)*n.width+u.x)*h;if(x)for(let R=0;R<g.width;R++){const V=L+R*h+3,W=I+R*h;D[W+0]=255,D[W+1]=255,D[W+2]=255,D[W+3]=A[V]}else if(v)for(let R=0;R<g.width;R++){const V=L+R*h,W=I+R*h,K=A[V+3],re=new io(A[V+0]/255*K,A[V+1]/255*K,A[V+2]/255*K,K).toRenderColor(v).toArray();D[W+0]=re[0],D[W+1]=re[1],D[W+2]=re[2],D[W+3]=re[3]}else for(let R=0;R<g.width*h;R++)D[I+R]=A[L+R]}return n}Hn(AM,"HeatmapBucket",{omit:["layers"]});class bd{constructor(n,s){LM(this,n,1,s)}resize(n){DM(this,new bd(n),1)}clone(){return new bd({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(n,s,u,g,h){Sw(n,s,u,g,h,1,null)}}class qi{constructor(n,s){LM(this,n,4,s)}resize(n){DM(this,new qi(n),4)}replace(n,s){s?this.data.set(n):this.data=n instanceof Uint8ClampedArray?new Uint8Array(n.buffer):n}clone(){return new qi({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(n,s,u,g,h,v,T){Sw(n,s,u,g,h,4,v,T)}}class zM{constructor(n,s){this.width=n.width,this.height=n.height,this.data=s instanceof Uint8Array?new Float32Array(s.buffer):s}}function Tv(c){const n={},s=c.resolution||256,u=c.clips?c.clips.length:1,g=c.image||new qi({width:s,height:u}),h=(v,T,A)=>{n[c.evaluationKey]=A;const D=c.expression.evaluate(n);D&&(g.data[v+T+0]=Math.floor(255*D.r/D.a),g.data[v+T+1]=Math.floor(255*D.g/D.a),g.data[v+T+2]=Math.floor(255*D.b/D.a),g.data[v+T+3]=Math.floor(255*D.a))};if(c.clips)for(let v=0,T=0;v<u;++v,T+=4*s)for(let A=0,D=0;A<s;A++,D+=4){const x=A/(s-1),{start:P,end:L}=c.clips[v];h(T,D,P*(1-x)+L*x)}else for(let v=0,T=0;v<s;v++,T+=4)h(0,T,v/(s-1));return g}Hn(bd,"AlphaImage"),Hn(qi,"RGBAImage");const WB=so([{name:"a_pos",components:2,type:"Int16"}],4),{members:qB}=WB;function Cv(c,n,s=2){const u=n&&n.length,g=u?n[0]*s:c.length;let h=FM(c,0,g,s,!0);const v=[];if(!h||h.next===h.prev)return v;let T,A,D;if(u&&(h=function(x,P,L,I){const R=[];for(let V=0,W=P.length;V<W;V++){const K=FM(x,P[V]*I,V<W-1?P[V+1]*I:x.length,I,!1);K===K.next&&(K.steiner=!0),R.push(t5(K))}R.sort(JB);for(let V=0;V<R.length;V++)L=QB(R[V],L);return L}(c,n,h,s)),c.length>80*s){T=1/0,A=1/0;let x=-1/0,P=-1/0;for(let L=s;L<g;L+=s){const I=c[L],R=c[L+1];I<T&&(T=I),R<A&&(A=R),I>x&&(x=I),R>P&&(P=R)}D=Math.max(x-T,P-A),D=D!==0?32767/D:0}return Ev(h,v,s,T,A,D,0),v}function FM(c,n,s,u,g){let h;if(g===function(v,T,A,D){let x=0;for(let P=T,L=A-D;P<A;P+=D)x+=(v[L]-v[P])*(v[P+1]+v[L+1]),L=P;return x}(c,n,s,u)>0)for(let v=n;v<s;v+=u)h=VM(v/u|0,c[v],c[v+1],h);else for(let v=s-u;v>=n;v-=u)h=VM(v/u|0,c[v],c[v+1],h);return h&&E0(h,h.next)&&(Iv(h),h=h.next),h}function Xh(c,n){if(!c)return c;n||(n=c);let s,u=c;do if(s=!1,u.steiner||!E0(u,u.next)&&Oi(u.prev,u,u.next)!==0)u=u.next;else{if(Iv(u),u=n=u.prev,u===u.next)break;s=!0}while(s||u!==n);return n}function Ev(c,n,s,u,g,h,v){if(!c)return;!v&&h&&function(A,D,x,P){let L=A;do L.z===0&&(L.z=Tw(L.x,L.y,D,x,P)),L.prevZ=L.prev,L.nextZ=L.next,L=L.next;while(L!==A);L.prevZ.nextZ=null,L.prevZ=null,function(I){let R,V=1;do{let W,K=I;I=null;let re=null;for(R=0;K;){R++;let ie=K,Q=0;for(let _e=0;_e<V&&(Q++,ie=ie.nextZ,ie);_e++);let ue=V;for(;Q>0||ue>0&&ie;)Q!==0&&(ue===0||!ie||K.z<=ie.z)?(W=K,K=K.nextZ,Q--):(W=ie,ie=ie.nextZ,ue--),re?re.nextZ=W:I=W,W.prevZ=re,re=W;K=ie}re.nextZ=null,V*=2}while(R>1)}(L)}(c,u,g,h);let T=c;for(;c.prev!==c.next;){const A=c.prev,D=c.next;if(h?ZB(c,u,g,h):KB(c))n.push(A.i,c.i,D.i),Iv(c),c=D.next,T=D.next;else if((c=D)===T){v?v===1?Ev(c=YB(Xh(c),n),n,s,u,g,h,2):v===2&&XB(c,n,s,u,g,h):Ev(Xh(c),n,s,u,g,h,1);break}}}function KB(c){const n=c.prev,s=c,u=c.next;if(Oi(n,s,u)>=0)return!1;const g=n.x,h=s.x,v=u.x,T=n.y,A=s.y,D=u.y,x=g<h?g<v?g:v:h<v?h:v,P=T<A?T<D?T:D:A<D?A:D,L=g>h?g>v?g:v:h>v?h:v,I=T>A?T>D?T:D:A>D?A:D;let R=u.next;for(;R!==n;){if(R.x>=x&&R.x<=L&&R.y>=P&&R.y<=I&&Dp(g,T,h,A,v,D,R.x,R.y)&&Oi(R.prev,R,R.next)>=0)return!1;R=R.next}return!0}function ZB(c,n,s,u){const g=c.prev,h=c,v=c.next;if(Oi(g,h,v)>=0)return!1;const T=g.x,A=h.x,D=v.x,x=g.y,P=h.y,L=v.y,I=T<A?T<D?T:D:A<D?A:D,R=x<P?x<L?x:L:P<L?P:L,V=T>A?T>D?T:D:A>D?A:D,W=x>P?x>L?x:L:P>L?P:L,K=Tw(I,R,n,s,u),re=Tw(V,W,n,s,u);let ie=c.prevZ,Q=c.nextZ;for(;ie&&ie.z>=K&&Q&&Q.z<=re;){if(ie.x>=I&&ie.x<=V&&ie.y>=R&&ie.y<=W&&ie!==g&&ie!==v&&Dp(T,x,A,P,D,L,ie.x,ie.y)&&Oi(ie.prev,ie,ie.next)>=0||(ie=ie.prevZ,Q.x>=I&&Q.x<=V&&Q.y>=R&&Q.y<=W&&Q!==g&&Q!==v&&Dp(T,x,A,P,D,L,Q.x,Q.y)&&Oi(Q.prev,Q,Q.next)>=0))return!1;Q=Q.nextZ}for(;ie&&ie.z>=K;){if(ie.x>=I&&ie.x<=V&&ie.y>=R&&ie.y<=W&&ie!==g&&ie!==v&&Dp(T,x,A,P,D,L,ie.x,ie.y)&&Oi(ie.prev,ie,ie.next)>=0)return!1;ie=ie.prevZ}for(;Q&&Q.z<=re;){if(Q.x>=I&&Q.x<=V&&Q.y>=R&&Q.y<=W&&Q!==g&&Q!==v&&Dp(T,x,A,P,D,L,Q.x,Q.y)&&Oi(Q.prev,Q,Q.next)>=0)return!1;Q=Q.nextZ}return!0}function YB(c,n){let s=c;do{const u=s.prev,g=s.next.next;!E0(u,g)&&NM(u,s,s.next,g)&&Mv(u,g)&&Mv(g,u)&&(n.push(u.i,s.i,g.i),Iv(s),Iv(s.next),s=c=g),s=s.next}while(s!==c);return Xh(s)}function XB(c,n,s,u,g,h){let v=c;do{let T=v.next.next;for(;T!==v.prev;){if(v.i!==T.i&&n5(v,T)){let A=BM(v,T);return v=Xh(v,v.next),A=Xh(A,A.next),Ev(v,n,s,u,g,h,0),void Ev(A,n,s,u,g,h,0)}T=T.next}v=v.next}while(v!==c)}function JB(c,n){return c.x-n.x}function QB(c,n){const s=function(g,h){let v=h;const T=g.x,A=g.y;let D,x=-1/0;do{if(A<=v.y&&A>=v.next.y&&v.next.y!==v.y){const V=v.x+(A-v.y)*(v.next.x-v.x)/(v.next.y-v.y);if(V<=T&&V>x&&(x=V,D=v.x<v.next.x?v:v.next,V===T))return D}v=v.next}while(v!==h);if(!D)return null;const P=D,L=D.x,I=D.y;let R=1/0;v=D;do{if(T>=v.x&&v.x>=L&&T!==v.x&&Dp(A<I?T:x,A,L,I,A<I?x:T,A,v.x,v.y)){const V=Math.abs(A-v.y)/(T-v.x);Mv(v,g)&&(V<R||V===R&&(v.x>D.x||v.x===D.x&&e5(D,v)))&&(D=v,R=V)}v=v.next}while(v!==P);return D}(c,n);if(!s)return n;const u=BM(s,c);return Xh(u,u.next),Xh(s,s.next)}function e5(c,n){return Oi(c.prev,c,n.prev)<0&&Oi(n.next,c,c.next)<0}function Tw(c,n,s,u,g){return(c=1431655765&((c=858993459&((c=252645135&((c=16711935&((c=(c-s)*g|0)|c<<8))|c<<4))|c<<2))|c<<1))|(n=1431655765&((n=858993459&((n=252645135&((n=16711935&((n=(n-u)*g|0)|n<<8))|n<<4))|n<<2))|n<<1))<<1}function t5(c){let n=c,s=c;do(n.x<s.x||n.x===s.x&&n.y<s.y)&&(s=n),n=n.next;while(n!==c);return s}function Dp(c,n,s,u,g,h,v,T){return(g-v)*(n-T)>=(c-v)*(h-T)&&(c-v)*(u-T)>=(s-v)*(n-T)&&(s-v)*(h-T)>=(g-v)*(u-T)}function n5(c,n){return c.next.i!==n.i&&c.prev.i!==n.i&&!function(s,u){let g=s;do{if(g.i!==s.i&&g.next.i!==s.i&&g.i!==u.i&&g.next.i!==u.i&&NM(g,g.next,s,u))return!0;g=g.next}while(g!==s);return!1}(c,n)&&(Mv(c,n)&&Mv(n,c)&&function(s,u){let g=s,h=!1;const v=(s.x+u.x)/2,T=(s.y+u.y)/2;do g.y>T!=g.next.y>T&&g.next.y!==g.y&&v<(g.next.x-g.x)*(T-g.y)/(g.next.y-g.y)+g.x&&(h=!h),g=g.next;while(g!==s);return h}(c,n)&&(Oi(c.prev,c,n.prev)||Oi(c,n.prev,n))||E0(c,n)&&Oi(c.prev,c,c.next)>0&&Oi(n.prev,n,n.next)>0)}function Oi(c,n,s){return(n.y-c.y)*(s.x-n.x)-(n.x-c.x)*(s.y-n.y)}function E0(c,n){return c.x===n.x&&c.y===n.y}function NM(c,n,s,u){const g=I0(Oi(c,n,s)),h=I0(Oi(c,n,u)),v=I0(Oi(s,u,c)),T=I0(Oi(s,u,n));return g!==h&&v!==T||!(g!==0||!M0(c,s,n))||!(h!==0||!M0(c,u,n))||!(v!==0||!M0(s,c,u))||!(T!==0||!M0(s,n,u))}function M0(c,n,s){return n.x<=Math.max(c.x,s.x)&&n.x>=Math.min(c.x,s.x)&&n.y<=Math.max(c.y,s.y)&&n.y>=Math.min(c.y,s.y)}function I0(c){return c>0?1:c<0?-1:0}function Mv(c,n){return Oi(c.prev,c,c.next)<0?Oi(c,n,c.next)>=0&&Oi(c,c.prev,n)>=0:Oi(c,n,c.prev)<0||Oi(c,c.next,n)<0}function BM(c,n){const s=Cw(c.i,c.x,c.y),u=Cw(n.i,n.x,n.y),g=c.next,h=n.prev;return c.next=n,n.prev=c,s.next=g,g.prev=s,u.next=s,s.prev=u,h.next=u,u.prev=h,u}function VM(c,n,s,u){const g=Cw(c,n,s);return u?(g.next=u.next,g.prev=u,u.next.prev=g,u.next=g):(g.prev=g,g.next=g),g}function Iv(c){c.next.prev=c.prev,c.prev.next=c.next,c.prevZ&&(c.prevZ.nextZ=c.nextZ),c.nextZ&&(c.nextZ.prevZ=c.prevZ)}function Cw(c,n,s){return{i:c,x:n,y:s,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function A0(c,n){const s=c.length;if(s<=1)return[c];const u=[];let g,h;for(let v=0;v<s;v++){const T=vo(c[v]);T!==0&&(c[v].area=Math.abs(T),h===void 0&&(h=T<0),h===T<0?(g&&u.push(g),g=[c[v]]):g.push(c[v]))}if(g&&u.push(g),n>1)for(let v=0;v<u.length;v++)u[v].length<=n||(ph(u[v],n,1,u[v].length-1,r5),u[v]=u[v].slice(0,n));return u}function r5(c,n){return n.area-c.area}function $M(c,n,s=1){if(!c)return null;const u=typeof c=="string"?c:c.getPrimary().id;n[u]||(n[u]=[]);const g=Gi.from(u).getPrimary().scaleSelf(s);return n[u].push(g),g.serialize()}function Ew(c,n,s,u){const g=u.patternDependencies;let h=!1;for(const v of n){const T=v.paint.get(`${c}-pattern`);T.isConstant()||(h=!0),$M(T.constantOr(null),g,s)&&(h=!0)}return h}function Mw(c,n,s,u,g,h){const v=h.patternDependencies;for(const T of n){const A=T.paint.get(`${c}-pattern`).value;if(A.kind!=="constant"){let D=A.evaluate({zoom:u},s,{},h.availableImages);D=D&&D.name?D.name:D;const x=$M(D,v,g);x&&(s.patterns[T.id]=x)}}return s}class Iw{constructor(n){this.zoom=n.zoom,this.pixelRatio=n.pixelRatio,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map(s=>s.fqid),this.index=n.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Bl,this.indexArray=new $i,this.indexArray2=new Mc,this.programConfigurations=new kc(n.layers,{zoom:n.zoom,lut:n.lut}),this.segments=new ei,this.segments2=new ei,this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id),this.projection=n.projection}updateFootprints(n,s){}populate(n,s,u,g){this.hasPattern=Ew("fill",this.layers,this.pixelRatio,s);const h=this.layers[0].layout.get("fill-sort-key"),v=[];for(const{feature:T,id:A,index:D,sourceLayerIndex:x}of n){const P=this.layers[0]._featureFilter.needGeometry,L=Z(T,P);if(!this.layers[0]._featureFilter.filter(new zo(this.zoom),L,u))continue;const I=h?h.evaluate(L,{},u,s.availableImages):void 0,R={id:A,properties:T.properties,type:T.type,sourceLayerIndex:x,index:D,geometry:P?L.geometry:G(T,u,g),patterns:{},sortKey:I};v.push(R)}h&&v.sort((T,A)=>T.sortKey-A.sortKey);for(const T of v){const{geometry:A,index:D,sourceLayerIndex:x}=T;if(this.hasPattern){const P=Mw("fill",this.layers,T,this.zoom,this.pixelRatio,s);this.patternFeatures.push(P)}else this.addFeature(T,A,D,u,{},s.availableImages,s.brightness,s.elevationFeatures);s.featureIndex.insert(n[D].feature,A,D,x,this.index)}}update(n,s,u,g,h,v,T){this.programConfigurations.updatePaintArrays(n,s,h,u,g,v,T)}addFeatures(n,s,u,g,h,v){for(const T of this.patternFeatures)this.addFeature(T,T.geometry,T.index,s,u,g,v,n.elevationFeatures)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(n){this.uploaded||(this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,qB),this.indexBuffer=n.createIndexBuffer(this.indexArray),this.indexBuffer2=n.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(n),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(n,s,u,g,h,v=[],T,A){for(const D of A0(s,500)){let x=0;for(const W of D)x+=W.length;const P=this.segments.prepareSegment(x,this.layoutVertexArray,this.indexArray),L=P.vertexLength,I=[],R=[];for(const W of D){if(W.length===0)continue;W!==D[0]&&R.push(I.length/2);const K=this.segments2.prepareSegment(W.length,this.layoutVertexArray,this.indexArray2),re=K.vertexLength;this.layoutVertexArray.emplaceBack(W[0].x,W[0].y),this.indexArray2.emplaceBack(re+W.length-1,re),I.push(W[0].x),I.push(W[0].y);for(let ie=1;ie<W.length;ie++)this.layoutVertexArray.emplaceBack(W[ie].x,W[ie].y),this.indexArray2.emplaceBack(re+ie-1,re+ie),I.push(W[ie].x),I.push(W[ie].y);K.vertexLength+=W.length,K.primitiveLength+=W.length}const V=Cv(I,R);for(let W=0;W<V.length;W+=3)this.indexArray.emplaceBack(L+V[W],L+V[W+1],L+V[W+2]);P.vertexLength+=x,P.primitiveLength+=V.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,n,u,h,v,g,T)}}let UM,jM,HM,GM;Hn(Iw,"FillBucket",{omit:["layers","patternFeatures"]});class Aw{constructor(n,s,u,g){if(this.triangleCount=s.length/3,this.min=new Qe(0,0),this.max=new Qe(0,0),this.xScale=0,this.yScale=0,this.cellsX=0,this.cellsY=0,this.cells=[],this.payload=[],this.triangleCount===0||n.length===0)return;const[h,v]=[n[0].clone(),n[0].clone()];for(let P=1;P<n.length;++P){const L=n[P];h.x=Math.min(h.x,L.x),h.y=Math.min(h.y,L.y),v.x=Math.max(v.x,L.x),v.y=Math.max(v.y,L.y)}if(g){const P=Math.ceil(Math.max(v.x-h.x,v.y-h.y)/g);u=Math.max(u,P)}if(u===0)return;this.min=h,this.max=v;const T=this.max.sub(this.min);T.x=Math.max(T.x,1),T.y=Math.max(T.y,1);const A=Math.max(T.x,T.y)/u;this.cellsX=Math.max(1,Math.ceil(T.x/A)),this.cellsY=Math.max(1,Math.ceil(T.y/A)),this.xScale=1/A,this.yScale=1/A;const D=[];for(let P=0;P<this.triangleCount;P++){const L=n[s[3*P+0]].sub(this.min),I=n[s[3*P+1]].sub(this.min),R=n[s[3*P+2]].sub(this.min),V=Rc(Math.floor(Math.min(L.x,I.x,R.x)),this.xScale,this.cellsX),W=Rc(Math.floor(Math.max(L.x,I.x,R.x)),this.xScale,this.cellsX),K=Rc(Math.floor(Math.min(L.y,I.y,R.y)),this.yScale,this.cellsY),re=Rc(Math.floor(Math.max(L.y,I.y,R.y)),this.yScale,this.cellsY),ie=new Qe(0,0),Q=new Qe(0,0),ue=new Qe(0,0),_e=new Qe(0,0);for(let Ee=K;Ee<=re;++Ee){ie.y=Q.y=Ee*A,ue.y=_e.y=(Ee+1)*A;for(let Ne=V;Ne<=W;++Ne)ie.x=ue.x=Ne*A,Q.x=_e.x=(Ne+1)*A,(Rt(L,I,R,ie,Q,_e)||Rt(L,I,R,ie,_e,ue))&&D.push({cellIdx:Ee*this.cellsX+Ne,triIdx:P})}}if(D.length===0)return;D.sort((P,L)=>P.cellIdx-L.cellIdx||P.triIdx-L.triIdx);let x=0;for(;x<D.length;){const P=D[x].cellIdx,L={start:this.payload.length,len:0};for(;x<D.length&&D[x].cellIdx===P;)++L.len,this.payload.push(D[x++].triIdx);this.cells[P]=L}}_lazyInitLookup(){this.lookup||(this.lookup=new Uint8Array(Math.ceil(this.triangleCount/8))),this.lookup.fill(0)}queryPoint(n,s){if(this.triangleCount===0||this.cells.length===0||n.x>this.max.x||this.min.x>n.x||n.y>this.max.y||this.min.y>n.y)return;const u=Rc(n.x-this.min.x,this.xScale,this.cellsX),g=Rc(n.y-this.min.y,this.yScale,this.cellsY),h=this.cells[g*this.cellsX+u];if(h){this._lazyInitLookup();for(let v=0;v<h.len;v++){const T=this.payload[h.start+v],A=Math.floor(T/8),D=1<<T%8;if(!(this.lookup[A]&D)&&(this.lookup[A]|=D,s.push(T),s.length===this.triangleCount))return}}}query(n,s,u){if(this.triangleCount===0||this.cells.length===0||n.x>this.max.x||this.min.x>s.x||n.y>this.max.y||this.min.y>s.y)return;this._lazyInitLookup();const g=Rc(n.x-this.min.x,this.xScale,this.cellsX),h=Rc(s.x-this.min.x,this.xScale,this.cellsX),v=Rc(n.y-this.min.y,this.yScale,this.cellsY),T=Rc(s.y-this.min.y,this.yScale,this.cellsY);for(let A=v;A<=T;A++)for(let D=g;D<=h;D++){const x=this.cells[A*this.cellsX+D];if(x)for(let P=0;P<x.len;P++){const L=this.payload[x.start+P],I=Math.floor(L/8),R=1<<L%8;if(!(this.lookup[I]&R)&&(this.lookup[I]|=R,u.push(L),u.length===this.triangleCount))return}}}}function Rc(c,n,s){return Math.max(0,Math.min(s-1,Math.floor(c*n)))}Hn(Aw,"TriangleGridIndex");class WM{constructor(n){this.zoom=n.zoom,this.layers=n.layers,this.layerIds=this.layers.map(s=>s.fqid),this.index=n.index,this.hasPattern=!1,this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id),this.footprints=[]}updateFootprints(n,s){for(const u of this.footprints)s.push({footprint:u,id:n})}populate(n,s,u,g){const h=[];for(const{feature:v,id:T,index:A,sourceLayerIndex:D}of n){const x=this.layers[0]._featureFilter.needGeometry,P=Z(v,x);if(!this.layers[0]._featureFilter.filter(new zo(this.zoom),P,u))continue;const L={id:T,properties:v.properties,type:v.type,sourceLayerIndex:D,index:A,geometry:x?P.geometry:G(v,u,g),patterns:{}};h.push(L)}for(const v of h){const{geometry:T,index:A,sourceLayerIndex:D}=v;this.addFeature(v,T,A,u,{},s.availableImages,s.brightness),s.featureIndex.insert(n[A].feature,T,A,D,this.index)}}isEmpty(){return this.footprints.length===0}uploadPending(){return!1}upload(n){}update(n,s,u,g,h,v,T){}destroy(){}addFeature(n,s,u,g,h,v=[],T){for(const A of A0(s,2)){const D=[],x=[],P=[],L=new Qe(1/0,1/0),I=new Qe(-1/0,-1/0);for(const W of A)if(W.length!==0){W!==A[0]&&P.push(x.length/2);for(let K=0;K<W.length;K++)x.push(W[K].x),x.push(W[K].y),D.push(W[K]),L.x=Math.min(L.x,W[K].x),L.y=Math.min(L.y,W[K].y),I.x=Math.max(I.x,W[K].x),I.y=Math.max(I.y,W[K].y)}const R=Cv(x,P),V=new Aw(D,R,8,256);this.footprints.push({vertices:D,indices:R,grid:V,min:L,max:I})}}}Hn(WM,"ClipBucket",{omit:["layers"]});const o5=so([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),i5=so([{name:"a_pos_end",components:4,type:"Int16"},{name:"a_angular_offset_factor",components:1,type:"Int16"}]),s5=so([{name:"a_centroid_pos",components:2,type:"Uint16"}]),a5=so([{name:"a_join_normal_inside",components:3,type:"Int16"}]),l5=so([{name:"a_hidden_by_landmark",components:1,type:"Uint8"}]),c5=so([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:u5}=o5;var kw,qM,Pw,KM,Rw,ZM,YM,k0={};function XM(){if(qM)return kw;qM=1;var c=nt();function n(g,h,v,T,A){this.properties={},this.extent=v,this.type=0,this._pbf=g,this._geometry=-1,this._keys=T,this._values=A,g.readFields(s,this,h)}function s(g,h,v){g==1?h.id=v.readVarint():g==2?function(T,A){for(var D=T.readVarint()+T.pos;T.pos<D;){var x=A._keys[T.readVarint()],P=A._values[T.readVarint()];A.properties[x]=P}}(v,h):g==3?h.type=v.readVarint():g==4&&(h._geometry=v.pos)}function u(g){for(var h,v,T=0,A=0,D=g.length,x=D-1;A<D;x=A++)T+=((v=g[x]).x-(h=g[A]).x)*(h.y+v.y);return T}return kw=n,n.types=["Unknown","Point","LineString","Polygon"],n.prototype.loadGeometry=function(){var g=this._pbf;g.pos=this._geometry;for(var h,v=g.readVarint()+g.pos,T=1,A=0,D=0,x=0,P=[];g.pos<v;){if(A<=0){var L=g.readVarint();T=7&L,A=L>>3}if(A--,T===1||T===2)D+=g.readSVarint(),x+=g.readSVarint(),T===1&&(h&&P.push(h),h=[]),h.push(new c(D,x));else{if(T!==7)throw new Error("unknown command "+T);h&&h.push(h[0].clone())}}return h&&P.push(h),P},n.prototype.bbox=function(){var g=this._pbf;g.pos=this._geometry;for(var h=g.readVarint()+g.pos,v=1,T=0,A=0,D=0,x=1/0,P=-1/0,L=1/0,I=-1/0;g.pos<h;){if(T<=0){var R=g.readVarint();v=7&R,T=R>>3}if(T--,v===1||v===2)(A+=g.readSVarint())<x&&(x=A),A>P&&(P=A),(D+=g.readSVarint())<L&&(L=D),D>I&&(I=D);else if(v!==7)throw new Error("unknown command "+v)}return[x,L,P,I]},n.prototype.toGeoJSON=function(g,h,v){var T,A,D=this.extent*Math.pow(2,v),x=this.extent*g,P=this.extent*h,L=this.loadGeometry(),I=n.types[this.type];function R(K){for(var re=0;re<K.length;re++){var ie=K[re];K[re]=[360*(ie.x+x)/D-180,360/Math.PI*Math.atan(Math.exp((180-360*(ie.y+P)/D)*Math.PI/180))-90]}}switch(this.type){case 1:var V=[];for(T=0;T<L.length;T++)V[T]=L[T][0];R(L=V);break;case 2:for(T=0;T<L.length;T++)R(L[T]);break;case 3:for(L=function(K){var re=K.length;if(re<=1)return[K];for(var ie,Q,ue=[],_e=0;_e<re;_e++){var Ee=u(K[_e]);Ee!==0&&(Q===void 0&&(Q=Ee<0),Q===Ee<0?(ie&&ue.push(ie),ie=[K[_e]]):ie.push(K[_e]))}return ie&&ue.push(ie),ue}(L),T=0;T<L.length;T++)for(A=0;A<L[T].length;A++)R(L[T][A])}L.length===1?L=L[0]:I="Multi"+I;var W={type:"Feature",geometry:{type:I,coordinates:L},properties:this.properties};return"id"in this&&(W.id=this.id),W},kw}function JM(){if(KM)return Pw;KM=1;var c=XM();function n(u,g){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=u,this._keys=[],this._values=[],this._features=[],u.readFields(s,this,g),this.length=this._features.length}function s(u,g,h){u===15?g.version=h.readVarint():u===1?g.name=h.readString():u===5?g.extent=h.readVarint():u===2?g._features.push(h.pos):u===3?g._keys.push(h.readString()):u===4&&g._values.push(function(v){for(var T=null,A=v.readVarint()+v.pos;v.pos<A;){var D=v.readVarint()>>3;T=D===1?v.readString():D===2?v.readFloat():D===3?v.readDouble():D===4?v.readVarint64():D===5?v.readVarint():D===6?v.readSVarint():D===7?v.readBoolean():null}return T}(h))}return Pw=n,n.prototype.feature=function(u){if(u<0||u>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[u];var g=this._pbf.readVarint()+this._pbf.pos;return new c(this._pbf,g,this.extent,this._keys,this._values)},Pw}function QM(){return YM||(YM=1,k0.VectorTile=function(){if(ZM)return Rw;ZM=1;var c=JM();function n(s,u,g){if(s===3){var h=new c(g,g.readVarint()+g.pos);h.length&&(u[h.name]=h)}}return Rw=function(s,u){this.layers=s.readFields(n,{},u)},Rw}(),k0.VectorTileFeature=XM(),k0.VectorTileLayer=JM()),k0}var zp=QM();class Jh extends Qe{constructor(n,s,u){super(n,s),this.z=u}}class eI extends Jh{constructor(n,s,u,g){super(n,s,u),this.w=g}}function P0(c,n,s,u){const g=[],h=u===0?(v,T,A,D,x,P)=>{v.push(new Qe(P,A+(P-T)/(D-T)*(x-A)))}:(v,T,A,D,x,P)=>{v.push(new Qe(T+(P-A)/(x-A)*(D-T),P))};for(const v of c){const T=[];for(const A of v){if(A.length<=2)continue;const D=[];for(let L=0;L<A.length-1;L++){const I=A[L].x,R=A[L].y,V=A[L+1].x,W=A[L+1].y,K=u===0?I:R,re=u===0?V:W;K<n?re>n&&h(D,I,R,V,W,n):K>s?re<s&&h(D,I,R,V,W,s):D.push(A[L]),re<n&&K>=n&&h(D,I,R,V,W,n),re>s&&K<=s&&h(D,I,R,V,W,s)}let x=A[A.length-1];const P=u===0?x.x:x.y;P>=n&&P<=s&&D.push(x),D.length&&(x=D[D.length-1],D[0].x===x.x&&D[0].y===x.y||D.push(D[0]),T.push(D))}T.length&&g.push(T)}return g}function tI(c,n,s,u){const g=s==="x"?"y":"x",h=(u-c[s])/(n[s]-c[s]);c[g]=c[g]+(n[g]-c[g])*h,c[s]=u,c.hasOwnProperty("z")&&(c.z=cr(c.z,n.z,h)),c.hasOwnProperty("w")&&(c.w=cr(c.w,n.w,h))}function nI(c,n,s,u){const g=s,h=u;for(const v of["x","y"]){let T=c,A=n;T[v]>=A[v]&&(T=n,A=c),T[v]<g&&A[v]>g&&tI(T,A,v,g),T[v]<h&&A[v]>h&&tI(A,T,v,h)}}const R0=Number.MAX_SAFE_INTEGER;function rI(c,n,s,u){return c.order<n||c.order===R0||!(c.clipMask&s)||function(g,h){return h.length!==0&&h.find(v=>v===g)===void 0}(u,c.clipScope)}function O0(c,n){return c.x-n.x||c.y-n.y}function oI(c,n){return O0(c.min,n.min)===0&&O0(c.max,n.max)===0}function Ow(c,n){return!(c.min.x>n.max.x||c.max.x<n.min.x||c.min.y>n.max.y||c.max.y<n.min.y)}function Lw(c,n){if(c.length!==n.length)return!1;for(let s=0;s<c.length;s++)if(c[s].sourceId!==n[s].sourceId||!oI(c[s],n[s])||c[s].order!==n[s].order||c[s].clipMask!==n[s].clipMask||!Yt(c[s].clipScope,n[s].clipScope))return!1;return!0}function iI(c,n,s){const u=1/In,g=1/(1<<s.canonical.z),h=(n.x*u+s.canonical.x)*g+s.wrap,v=(n.y*u+s.canonical.y)*g;return{min:new Qe((c.x*u+s.canonical.x)*g+s.wrap,(c.y*u+s.canonical.y)*g),max:new Qe(h,v)}}function d5(c,n,s){const u=1<<s.canonical.z,g=((n.x-s.wrap)*u-s.canonical.x)*In,h=(n.y*u-s.canonical.y)*In;return{min:new Qe(((c.x-s.wrap)*u-s.canonical.x)*In,(c.y*u-s.canonical.y)*In),max:new Qe(g,h)}}function sI(c,n,s,u,g,h,v){const T=c.indices,A=c.vertices,D=[];for(let x=u;x<u+g;x+=3){const P=n[s[x+0]+h],L=n[s[x+1]+h],I=n[s[x+2]+h],R=Math.min(P.x,L.x,I.x),V=Math.max(P.x,L.x,I.x),W=Math.min(P.y,L.y,I.y),K=Math.max(P.y,L.y,I.y);D.length=0,c.grid.query(new Qe(R,W),new Qe(V,K),D);for(let re=0;re<D.length;re++){const ie=D[re];if(Rt(A[T[3*ie+0]],A[T[3*ie+1]],A[T[3*ie+2]],P,L,I,v))return!0}}return!1}function aI(c,n,s,u){if(!c||!s)return!1;let g=c.vertices;if(!n.canonical.equals(u.canonical)||n.wrap!==u.wrap){if(s.vertices.length<c.vertices.length)return aI(s,u,c,n);const h=n.canonical,v=u.canonical,T=Math.pow(2,v.z-h.z);g=c.vertices.map(A=>new Qe((A.x+h.x*In)*T-v.x*In,(A.y+h.y*In)*T-v.y*In))}return sI(s,g,c.indices,0,c.indices.length,0,0)}function lI(c,n,s,u){const g=Math.pow(2,u.z-s.z);return new Qe((c+s.x*In)*g-u.x*In,(n+s.y*In)*g-u.y*In)}function cI(c,n){const s=[];n.grid.queryPoint(c,s);const u=n.indices,g=n.vertices;for(let h=0;h<s.length;h++){const v=s[h];if(Ye([g[u[3*v+0]],g[u[3*v+1]],g[u[3*v+2]]],c))return!0}return!1}const Dw=[new Qe(0,0),new Qe(In,0),new Qe(In,In),new Qe(0,In)];function uI(c,n){const s=[];let u=[];if(!n||c.length<2)return[c];if(c.length===2)return gt(c[0],c[1],Dw)?[c]:[];for(let g=0;g<c.length+2;g++){const h=c[g%c.length],v=c[(g+1)%c.length],T=gt(g===0?c[c.length-1]:c[(g-1)%c.length],h,Dw),A=gt(h,v,Dw),D=T||A;D&&u.push(h),D&&A||u.length>0&&(u.length>1&&s.push(u),u=[])}return u.length>1&&s.push(u),s}const zw=zp.VectorTileFeature.types,h5=["fill-extrusion-base","fill-extrusion-height","fill-extrusion-color","fill-extrusion-pattern","fill-extrusion-flood-light-wall-radius","fill-extrusion-line-width","fill-extrusion-emissive-strength"],f5=["fill-extrusion-flood-light-ground-radius"],p5=Math.pow(2,13),m5=Math.pow(2,15)-1,dI=new Qe(0,1),xd=2147483648;function Av(c,n,s,u,g,h,v,T){c.emplaceBack((n<<1)+v,(s<<1)+h,(Math.floor(u*p5)<<1)+g,Math.round(T))}function kv(c,n,s){c.emplaceBack(n.x*In,n.y*In,s?1:0)}function L0(c,n,s,u,g,h){c.emplaceBack(n.x,n.y,(s.x<<1)+u,(s.y<<1)+g,h)}function Pv(c,n,s){c.emplaceBack(n.x,n.y,n.z,s[0]*16384,s[1]*16384,s[2]*16384)}class hI{constructor(){this.vertexOffset=0,this.vertexCount=0,this.indexOffset=0,this.indexCount=0}}class fI{constructor(){this.centroidXY=new Qe(0,0),this.vertexArrayOffset=0,this.vertexCount=0,this.groundVertexArrayOffset=0,this.groundVertexCount=0,this.flags=0,this.footprintSegIdx=-1,this.footprintSegLen=0,this.polygonSegIdx=-1,this.polygonSegLen=0,this.min=new Qe(Number.MAX_VALUE,Number.MAX_VALUE),this.max=new Qe(-Number.MAX_VALUE,-Number.MAX_VALUE),this.height=0}span(){return new Qe(this.max.x-this.min.x,this.max.y-this.min.y)}}class pI{constructor(){this.acc=new Qe(0,0),this.accCount=0,this.centroidDataIndex=0}startRing(n,s){n.min.x===Number.MAX_VALUE&&(n.min.x=n.max.x=s.x,n.min.y=n.max.y=s.y)}appendEdge(n,s,u){this.accCount++,this.acc._add(s);let g=!!this.borders;s.x<n.min.x?(n.min.x=s.x,g=!0):s.x>n.max.x&&(n.max.x=s.x,g=!0),s.y<n.min.y?(n.min.y=s.y,g=!0):s.y>n.max.y&&(n.max.y=s.y,g=!0),((s.x===0||s.x===In)&&s.x===u.x)!=((s.y===0||s.y===In)&&s.y===u.y)&&this.processBorderOverlap(s,u),g&&this.checkBorderIntersection(s,u)}checkBorderIntersection(n,s){s.x<0!=n.x<0&&this.addBorderIntersection(0,cr(s.y,n.y,(0-s.x)/(n.x-s.x))),s.x>In!=n.x>In&&this.addBorderIntersection(1,cr(s.y,n.y,(In-s.x)/(n.x-s.x))),s.y<0!=n.y<0&&this.addBorderIntersection(2,cr(s.x,n.x,(0-s.y)/(n.y-s.y))),s.y>In!=n.y>In&&this.addBorderIntersection(3,cr(s.x,n.x,(In-s.y)/(n.y-s.y)))}addBorderIntersection(n,s){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const u=this.borders[n];s<u[0]&&(u[0]=s),s>u[1]&&(u[1]=s)}processBorderOverlap(n,s){if(n.x===s.x){if(n.y===s.y)return;const u=n.x===0?0:1;this.addBorderIntersection(u,s.y),this.addBorderIntersection(u,n.y)}else{const u=n.y===0?2:3;this.addBorderIntersection(u,s.x),this.addBorderIntersection(u,n.x)}}centroid(){return this.accCount===0?new Qe(0,0):new Qe(Math.floor(Math.max(0,this.acc.x)/this.accCount),Math.floor(Math.max(0,this.acc.y)/this.accCount))}intersectsCount(){return this.borders?this.borders.reduce((n,s)=>n+ +(s[0]!==Number.MAX_VALUE),0):0}}function mI(c,n){const s=c.add(n)._unit(),u=It(c.x*s.x+c.y*s.y,-1,1);var g,h,v;return v=Math.acos(u),Math.min(4,Math.max(-4,Math.tan(v)))/4*m5*((g=c).x*(h=n).y-g.y*h.x<0?-1:1)}const g5=[c=>c.x<0,c=>c.x>In,c=>c.y<0,c=>c.y>In];function v5(c,n,s,u){const g=[4];if(u===0)return g;s._mult(u);const h=c.sub(s),v=n.sub(s),T=[c,n,h,v];for(let A=0;A<4;A++)for(const D of T)if(g5[A](D)){g.push(A);break}return g}class gI{constructor(n){this.vertexArray=new Sp,this.indexArray=new $i,this.programConfigurations=new kc(n.layers,{zoom:n.zoom,lut:n.lut},s=>f5.includes(s)),this._segments=new ei,this.hiddenByLandmarkVertexArray=new Ip,this._segmentToGroundQuads={},this._segmentToGroundQuads[0]=[],this._segmentToRegionTriCounts={},this._segmentToRegionTriCounts[0]=[0,0,0,0,0],this.regionSegments={},this.regionSegments[4]=new ei}getDefaultSegment(){return this.regionSegments[4]}hasData(){return this.vertexArray.length!==0}addData(n,s,u,g=!1){const h=n.length;if(h>2){let v=Math.max(0,this._segments.get().length-1);const T=this._segments._prepareSegment(4*h,this.vertexArray.length,2*this._segmentToGroundQuads[v].length);let A;v!==this._segments.get().length-1&&(v++,this._segmentToGroundQuads[v]=[],this._segmentToRegionTriCounts[v]=[0,0,0,0,0]);{const D=n[0],x=n[1];A=mI(D.sub(n[h-1])._perp()._unit(),x.sub(D)._perp()._unit())}for(let D=0;D<h;D++){const x=D===h-1?0:D+1,P=n[D],L=n[x],I=n[x===h-1?0:x+1],R=L.sub(P)._perp()._unit(),V=mI(R,I.sub(L)._perp()._unit()),W=A,K=V;if(Fw(P,L,s)||g&&yI(P,s)&&yI(L,s)){A=V;continue}const re=T.vertexLength;L0(this.vertexArray,P,L,1,1,W),L0(this.vertexArray,P,L,1,0,W),L0(this.vertexArray,P,L,0,1,K),L0(this.vertexArray,P,L,0,0,K),T.vertexLength+=4;const ie=v5(P,L,R,u);for(const Q of ie)this._segmentToGroundQuads[v].push({id:re,region:Q}),this._segmentToRegionTriCounts[v][Q]+=2,T.primitiveLength+=2;A=V}}}prepareBorderSegments(){if(!this.hasData())return;const n=this._segments.get(),s=n.length;for(let u=0;u<s;u++)this._segmentToGroundQuads[u].sort((g,h)=>g.region-h.region);for(let u=0;u<s;u++){const g=this._segmentToGroundQuads[u],h=n[u],v=this._segmentToRegionTriCounts[u];v.reduce((A,D)=>A+D,0);let T=0;for(let A=0;A<=4;A++){const D=v[A];if(D!==0){let x=this.regionSegments[A];x||(x=this.regionSegments[A]=new ei);const P={vertexOffset:h.vertexOffset,primitiveOffset:h.primitiveOffset+T,vertexLength:h.vertexLength,primitiveLength:D};x.get().push(P)}T+=D}for(let A=0;A<g.length;A++){const D=g[A].id;this.indexArray.emplaceBack(D,D+1,D+3),this.indexArray.emplaceBack(D,D+3,D+2)}}this._segmentToGroundQuads=null,this._segmentToRegionTriCounts=null,this._segments.destroy(),this._segments=null}addPaintPropertiesData(n,s,u,g,h,v){this.hasData()&&this.programConfigurations.populatePaintArrays(this.vertexArray.length,n,s,u,g,h,v)}upload(n){this.hasData()&&(this.vertexBuffer=n.createVertexBuffer(this.vertexArray,i5.members),this.indexBuffer=n.createIndexBuffer(this.indexArray))}uploadPaintProperties(n){this.hasData()&&this.programConfigurations.upload(n)}update(n,s,u,g,h,v,T){this.hasData()&&this.programConfigurations.updatePaintArrays(n,s,u,g,h,v,T)}updateHiddenByLandmark(n){if(!this.hasData())return;const s=n.groundVertexCount+n.groundVertexArrayOffset;if(n.groundVertexCount===0)return;const u=n.flags&xd?1:0;for(let g=n.groundVertexArrayOffset;g<s;++g)this.hiddenByLandmarkVertexArray.emplace(g,u);this._needsHiddenByLandmarkUpdate=!0}uploadHiddenByLandmark(n){this.hasData()&&this._needsHiddenByLandmarkUpdate&&(!this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexArray.length>0?this.hiddenByLandmarkVertexBuffer=n.createVertexBuffer(this.hiddenByLandmarkVertexArray,l5.members,!0):this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.updateData(this.hiddenByLandmarkVertexArray),this._needsHiddenByLandmarkUpdate=!1)}destroy(){if(this.vertexBuffer){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.destroy(),this._segments&&this._segments.destroy(),this.programConfigurations.destroy();for(let n=0;n<=4;n++){const s=this.regionSegments[n];s&&s.destroy()}}}}class D0{constructor(n){this.zoom=n.zoom,this.canonical=n.canonical,this.overscaling=n.overscaling,this.layers=n.layers,this.pixelRatio=n.pixelRatio,this.layerIds=this.layers.map(s=>s.fqid),this.index=n.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=n.projection,this.activeReplacements=[],this.replacementUpdateTime=0,this.centroidData=[],this.footprintIndices=new $i,this.footprintVertices=new Bl,this.footprintSegments=[],this.layoutVertexArray=new Vl,this.centroidVertexArray=new Ls,this.wallVertexArray=new _0,this.indexArray=new $i,this.programConfigurations=new kc(n.layers,{zoom:n.zoom,lut:n.lut},s=>h5.includes(s)),this.segments=new ei,this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id),this.groundEffect=new gI(n),this.maxHeight=0,this.partLookup={},this.triangleSubSegments=[],this.polygonSegments=[]}updateFootprints(n,s){}populate(n,s,u,g){this.features=[],this.hasPattern=Ew("fill-extrusion",this.layers,this.pixelRatio,s),this.featuresOnBorder=[],this.borderFeatureIndices=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.selfDEMTileTimestamp=Number.MAX_VALUE,this.borderDEMTileTimestamp=[Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE],this.tileToMeter=o(u),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter,this.wallMode=this.layers[0].paint.get("fill-extrusion-line-width").constantOr(1)!==0;for(const{feature:h,id:v,index:T,sourceLayerIndex:A}of n){const D=this.layers[0]._featureFilter.needGeometry,x=Z(h,D);if(!this.layers[0]._featureFilter.filter(new zo(this.zoom),x,u))continue;const P={id:v,sourceLayerIndex:A,index:T,geometry:D?x.geometry:G(h,u,g),properties:h.properties,type:h.type,patterns:{}},L=this.layoutVertexArray.length,I=zw[P.type]==="Polygon";if(this.hasPattern)this.features.push(Mw("fill-extrusion",this.layers,P,this.zoom,this.pixelRatio,s));else if(this.wallMode)for(const R of P.geometry)for(const V of uI(R,I))this.addFeature(P,[V],T,u,{},s.availableImages,g,s.brightness);else this.addFeature(P,P.geometry,T,u,{},s.availableImages,g,s.brightness);s.featureIndex.insert(h,P.geometry,T,A,this.index,L)}this.sortBorders(),this.projection.name==="mercator"&&this.splitToSubtiles(),this.groundEffect.prepareBorderSegments(),this.polygonSegments.length=0}addFeatures(n,s,u,g,h,v){for(const T of this.features){const A=zw[T.type]==="Polygon",{geometry:D}=T;if(this.wallMode)for(const x of D)for(const P of uI(x,A))this.addFeature(T,[P],T.index,s,u,g,h,v);else this.addFeature(T,D,T.index,s,u,g,h,v)}this.sortBorders(),this.projection.name==="mercator"&&this.splitToSubtiles()}update(n,s,u,g,h,v,T){this.programConfigurations.updatePaintArrays(n,s,h,u,g,v,T),this.groundEffect.update(n,s,h,u,g,v,T)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload||this.groundEffect.programConfigurations.needsUpload}upload(n){this.uploaded||(this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,u5),this.indexBuffer=n.createIndexBuffer(this.indexArray),this.wallVertexBuffer=n.createVertexBuffer(this.wallVertexArray,a5.members),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=n.createVertexBuffer(this.layoutVertexExtArray,c5.members,!0)),this.groundEffect.upload(n)),this.groundEffect.uploadPaintProperties(n),this.programConfigurations.upload(n),this.uploaded=!0}uploadCentroid(n){this.groundEffect.uploadHiddenByLandmark(n),this.needsCentroidUpdate&&(!this.centroidVertexBuffer&&this.centroidVertexArray.length>0?this.centroidVertexBuffer=n.createVertexBuffer(this.centroidVertexArray,s5.members,!0):this.centroidVertexBuffer&&this.centroidVertexBuffer.updateData(this.centroidVertexArray),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.groundEffect.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(n,s,u,g,h,v,T,A){const D=this.layers[0].paint.get("fill-extrusion-flood-light-ground-radius").evaluate(n,{})/this.tileToMeter,x=[new Qe(0,0),new Qe(In,In)],P=T.projection,L=P.name==="globe",I=this.wallMode||zw[n.type]==="Polygon",R=new pI;R.centroidDataIndex=this.centroidData.length;const V=new fI,W=this.layers[0].paint.get("fill-extrusion-base").evaluate(n,{},g)<=0,K=this.layers[0].paint.get("fill-extrusion-height").evaluate(n,{},g);let re;if(V.height=K,V.vertexArrayOffset=this.layoutVertexArray.length,V.groundVertexArrayOffset=this.groundEffect.vertexArray.length,L&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new Nh),this.wallMode){if(L)return void wn("Non zero fill-extrusion-line-width is not yet supported on globe.");if(s.length!==1)return;re=function(De){const ot=De[0].x===De[De.length-1].x&&De[0].y===De[De.length-1].y;(function(_n){let mn=0;const Zn=_n.length;for(let Rn=0;Rn<Zn;Rn++)mn+=(_n[(Rn+1)%Zn].x-_n[Rn].x)*(_n[(Rn+1)%Zn].y+_n[Rn].y);return mn>=0})(De)||(De=De.reverse());const it={geometry:[],joinNormals:[],indices:[]},ft=[],ut=[],mt=[];let xt=De.length;for(;xt>=2&&De[xt-1].equals(De[xt-2]);)xt--;if(xt<(ot?3:2))return it;let At,_t,Zt,hn,Kt,kn=0;for(;kn<xt-1&&De[kn].equals(De[kn+1]);)kn++;ot&&(At=De[xt-2],Kt=De[kn].sub(At)._unit()._perp());for(let _n=kn;_n<xt;_n++){if(Zt=_n===xt-1?ot?De[kn+1]:void 0:De[_n+1],Zt&&De[_n].equals(Zt))continue;Kt&&(hn=Kt),At&&(_t=At),At=De[_n],Kt=Zt?Zt.sub(At)._unit()._perp():hn,hn=hn||Kt;let mn=hn.add(Kt);mn.x===0&&mn.y===0||mn._unit();const Zn=mn.x*Kt.x+mn.y*Kt.y,Rn=Zn!==0?1/Zn:1/0,Fn=hn.x*Kt.y-hn.y*Kt.x>0;let pr="miter";const Ir=2;pr==="miter"&&Rn>Ir&&(pr="bevel"),pr==="bevel"&&(Rn>100&&(pr="flipbevel"),Rn<Ir&&(pr="miter"));const Ar=(kr,Nr,Vr,ko)=>{const go=new Qe(kr.x,kr.y),xr=new Qe(kr.x,kr.y);go.x+=Nr.x*ko,go.y+=Nr.y*ko,xr.x-=Nr.x*Math.max(Vr,1),xr.y-=Nr.y*Math.max(Vr,1),mt.push(Nr),ft.push(go),ut.push(xr)};if(pr==="miter")mn._mult(Rn),Ar(At,mn,0,0);else if(pr==="flipbevel")mn=Kt.mult(-1),Ar(At,mn,0,0),Ar(At,mn.mult(-1),0,0);else{const kr=-Math.sqrt(Rn*Rn-1),Nr=Fn?kr:0,Vr=Fn?0:kr;_t&&Ar(At,hn,Nr,Vr),Zt&&Ar(At,Kt,Nr,Vr)}}it.geometry=[...ft,...ut.reverse(),ft[0]],it.joinNormals=[...mt,...mt.reverse(),mt[mt.length-1]];const Mn=it.geometry.length-1;for(let _n=0;_n<Mn/2;_n++)if(_n+1<Mn/2){let mn=_n,Zn=_n+1,Rn=Mn-1-_n,Fn=Mn-2-_n;mn=mn===0?Mn-1:mn-1,Zn=Zn===0?Mn-1:Zn-1,Rn=Rn===0?Mn-1:Rn-1,Fn=Fn===0?Mn-1:Fn-1,it.indices.push(Rn),it.indices.push(Zn),it.indices.push(mn),it.indices.push(Rn),it.indices.push(Fn),it.indices.push(Zn)}return it}(s[0]),s=[re.geometry]}const ie=(De,ot)=>De<(ot.length-1)/2||De===ot.length-1,Q=this.wallMode?[s]:A0(s,500);for(let De=Q.length-1;De>=0;De--){const ot=Q[De];(ot.length===0||(ue=ot[0]).every($e=>$e.x<=0)||ue.every($e=>$e.x>=In)||ue.every($e=>$e.y<=0)||ue.every($e=>$e.y>=In))&&Q.splice(De,1)}var ue;let _e;if(L)_e=SI(Q,x,g);else{_e=[];for(const De of Q)_e.push({polygon:De,bounds:x})}const Ee=I?this.edgeRadius:0,Ne=Ee>0&&this.zoom<17,ze=(De,ot)=>{if(De.length===0)return!1;const $e=De[De.length-1];return ot.x===$e.x&&ot.y===$e.y};for(const{polygon:De,bounds:ot}of _e){let $e=0,it=0;for(const xt of De)I&&!xt[0].equals(xt[xt.length-1])&&xt.push(xt[0]),it+=I?xt.length-1:xt.length;const ft=this.segments.prepareSegment((I?5:4)*it,this.layoutVertexArray,this.indexArray);V.footprintSegIdx<0&&(V.footprintSegIdx=this.footprintSegments.length),V.polygonSegIdx<0&&(V.polygonSegIdx=this.polygonSegments.length);const ut={triangleArrayOffset:this.indexArray.length,triangleCount:0,triangleSegIdx:this.segments.segments.length-1},mt=new hI;if(mt.vertexOffset=this.footprintVertices.length,mt.indexOffset=3*this.footprintIndices.length,mt.ringIndices=[],I){const xt=[],At=[];$e=ft.vertexLength;for(let Zt=0;Zt<De.length;Zt++){const hn=De[Zt];hn.length&&Zt!==0&&At.push(xt.length/2);const Kt=[];let kn,Mn;kn=hn[1].sub(hn[0])._perp()._unit(),mt.ringIndices.push(hn.length-1);for(let _n=1;_n<hn.length;_n++){const mn=hn[_n],Zn=hn[_n===hn.length-1?1:_n+1],Rn=mn.clone();if(Ee){Mn=Zn.sub(mn)._perp()._unit();const Fn=kn.add(Mn)._unit(),pr=Ee*Math.min(4,1/(kn.x*Fn.x+kn.y*Fn.y));Rn.x+=pr*Fn.x,Rn.y+=pr*Fn.y,Rn.x=Math.round(Rn.x),Rn.y=Math.round(Rn.y),kn=Mn}if(!W||Ee!==0&&!Ne||ze(Kt,Rn)||Kt.push(Rn),Av(this.layoutVertexArray,Rn.x,Rn.y,0,0,1,1,0),this.wallMode){const Fn=ie(_n,hn);kv(this.wallVertexArray,re.joinNormals[_n],!Fn)}ft.vertexLength++,this.footprintVertices.emplaceBack(mn.x,mn.y),xt.push(mn.x,mn.y),L&&Pv(this.layoutVertexExtArray,P.projectTilePoint(Rn.x,Rn.y,g),P.upVector(g,Rn.x,Rn.y))}W&&(Ee===0||Ne)&&(Kt.length!==0&&ze(Kt,Kt[0])&&Kt.pop(),this.groundEffect.addData(Kt,ot,D))}const _t=this.wallMode?re.indices:Cv(xt,At);for(let Zt=0;Zt<_t.length;Zt+=3)this.footprintIndices.emplaceBack(mt.vertexOffset+_t[Zt+0],mt.vertexOffset+_t[Zt+1],mt.vertexOffset+_t[Zt+2]),this.indexArray.emplaceBack($e+_t[Zt],$e+_t[Zt+2],$e+_t[Zt+1]),ft.primitiveLength++;mt.indexCount+=_t.length,mt.vertexCount+=this.footprintVertices.length-mt.vertexOffset}for(let xt=0;xt<De.length;xt++){const At=De[xt];R.startRing(V,At[0]);let _t=At.length>4&&bI(At[At.length-2],At[0],At[1]),Zt=Ee?_5(At[At.length-2],At[0],At[1],Ee):0;const hn=[];let Kt,kn,Mn;kn=At[1].sub(At[0])._perp()._unit();let _n=!0;for(let mn=1,Zn=0;mn<At.length;mn++){let Rn=At[mn-1],Fn=At[mn];const pr=At[mn===At.length-1?1:mn+1];if(R.appendEdge(V,Fn,Rn),Fw(Fn,Rn,ot)){Ee&&(kn=pr.sub(Fn)._perp()._unit(),_n=!_n);continue}const Ir=Fn.sub(Rn)._perp(),Ar=Ir.x/(Math.abs(Ir.x)+Math.abs(Ir.y)),kr=Ir.y>0?1:0,Nr=Rn.dist(Fn);if(Zn+Nr>32768&&(Zn=0),Ee){Mn=pr.sub(Fn)._perp()._unit();let xr=_I(Rn,Fn,pr,vI(kn,Mn),Ee);isNaN(xr)&&(xr=0);const uo=Fn.sub(Rn)._unit();Rn=Rn.add(uo.mult(Zt))._round(),Fn=Fn.add(uo.mult(-xr))._round(),Zt=xr,kn=Mn,W&&this.zoom>=17&&(ze(hn,Rn)||hn.push(Rn),ze(hn,Fn)||hn.push(Fn))}const Vr=ft.vertexLength,ko=At.length>4&&bI(Rn,Fn,pr);let go=xI(Zn,_t,_n);if(Av(this.layoutVertexArray,Rn.x,Rn.y,Ar,kr,0,0,go),Av(this.layoutVertexArray,Rn.x,Rn.y,Ar,kr,0,1,go),this.wallMode){const xr=ie(mn-1,At),uo=re.joinNormals[mn-1];kv(this.wallVertexArray,uo,xr),kv(this.wallVertexArray,uo,xr)}if(Zn+=Nr,go=xI(Zn,ko,!_n),_t=ko,Av(this.layoutVertexArray,Fn.x,Fn.y,Ar,kr,0,0,go),Av(this.layoutVertexArray,Fn.x,Fn.y,Ar,kr,0,1,go),this.wallMode){const xr=ie(mn,At),uo=re.joinNormals[mn];kv(this.wallVertexArray,uo,xr),kv(this.wallVertexArray,uo,xr)}if(ft.vertexLength+=4,this.indexArray.emplaceBack(Vr+0,Vr+1,Vr+2),this.indexArray.emplaceBack(Vr+1,Vr+3,Vr+2),ft.primitiveLength+=2,Ee){const xr=$e+(mn===1?At.length-2:mn-2),uo=mn===1?$e:xr+1;if(this.indexArray.emplaceBack(Vr+1,xr,Vr+3),this.indexArray.emplaceBack(xr,uo,Vr+3),ft.primitiveLength+=2,Kt===void 0&&(Kt=Vr),!Fw(pr,At[mn],ot)){const fo=mn===At.length-1?Kt:ft.vertexLength;this.indexArray.emplaceBack(Vr+2,Vr+3,fo),this.indexArray.emplaceBack(Vr+3,fo+1,fo),this.indexArray.emplaceBack(Vr+3,uo,fo+1),ft.primitiveLength+=3}_n=!_n}if(L){const xr=this.layoutVertexExtArray,uo=P.projectTilePoint(Rn.x,Rn.y,g),fo=P.projectTilePoint(Fn.x,Fn.y,g),$o=P.upVector(g,Rn.x,Rn.y),ai=P.upVector(g,Fn.x,Fn.y);Pv(xr,uo,$o),Pv(xr,uo,$o),Pv(xr,fo,ai),Pv(xr,fo,ai)}}I&&($e+=At.length-1),W&&Ee&&this.zoom>=17&&(hn.length!==0&&ze(hn,hn[0])&&hn.pop(),this.groundEffect.addData(hn,ot,D,Ee>0))}this.footprintSegments.push(mt),ut.triangleCount=this.indexArray.length-ut.triangleArrayOffset,this.polygonSegments.push(ut),++V.footprintSegLen,++V.polygonSegLen}if(V.vertexCount=this.layoutVertexArray.length-V.vertexArrayOffset,V.groundVertexCount=this.groundEffect.vertexArray.length-V.groundVertexArrayOffset,V.vertexCount!==0){if(V.centroidXY=R.borders?dI:this.encodeCentroid(R,V),this.centroidData.push(V),R.borders){this.featuresOnBorder.push(R);const De=this.featuresOnBorder.length-1;for(let ot=0;ot<R.borders.length;ot++)R.borders[ot][0]!==Number.MAX_VALUE&&this.borderFeatureIndices[ot].push(De)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,n,u,h,v,g,A),this.groundEffect.addPaintPropertiesData(n,u,h,v,g,A),this.maxHeight=Math.max(this.maxHeight,K)}}sortBorders(){for(let n=0;n<this.borderFeatureIndices.length;n++)this.borderFeatureIndices[n].sort((s,u)=>this.featuresOnBorder[s].borders[n][0]-this.featuresOnBorder[u].borders[n][0])}splitToSubtiles(){const n=[];for(let T=0;T<this.centroidData.length;T++){const A=this.centroidData[T],D=+(A.min.y+A.max.y>In),x=2*D+(+(A.min.x+A.max.x>In)^D);for(let P=0;P<A.polygonSegLen;P++){const L=A.polygonSegIdx+P;n.push({centroidIdx:T,subtile:x,polygonSegmentIdx:L,triangleSegmentIdx:this.polygonSegments[L].triangleSegIdx})}}const s=new $i;n.sort((T,A)=>T.triangleSegmentIdx===A.triangleSegmentIdx?T.subtile-A.subtile:T.triangleSegmentIdx-A.triangleSegmentIdx);let u=0,g=0,h=0;for(const T of n){if(T.triangleSegmentIdx!==u)break;h++}const v=n.length;for(;g!==n.length;){u=n[g].triangleSegmentIdx;let T=0,A=g,D=g;for(let x=A;x<h&&n[x].subtile===T;x++)D++;for(;A!==h;){const x=n[A];T=x.subtile;const P=this.centroidData[x.centroidIdx].min.clone(),L=this.centroidData[x.centroidIdx].max.clone(),I={vertexOffset:this.segments.segments[u].vertexOffset,primitiveOffset:s.length,vertexLength:this.segments.segments[u].vertexLength,primitiveLength:0,sortKey:void 0,vaos:{}};for(let R=A;R<D;R++){const V=n[R],W=this.polygonSegments[V.polygonSegmentIdx],K=this.centroidData[V.centroidIdx].min,re=this.centroidData[V.centroidIdx].max,ie=this.indexArray.uint16;for(let Q=W.triangleArrayOffset;Q<W.triangleArrayOffset+W.triangleCount;Q++)s.emplaceBack(ie[3*Q],ie[3*Q+1],ie[3*Q+2]);I.primitiveLength+=W.triangleCount,P.x=Math.min(P.x,K.x),P.y=Math.min(P.y,K.y),L.x=Math.max(L.x,re.x),L.y=Math.max(L.y,re.y)}I.primitiveLength>0&&this.triangleSubSegments.push({segment:I,min:P,max:L}),A=D;for(let R=A;R<h&&n[R].subtile===n[A].subtile;R++)D++}g=h;for(let x=g;x<v&&n[x].triangleSegmentIdx===n[g].triangleSegmentIdx;x++)h++}s._trim(),this.indexArray=s}getVisibleSegments(n,s,u){const g=new ei;if(this.wallMode){for(const V of this.triangleSubSegments)g.segments.push(V.segment);return g}let h=0,v=0;const T=1<<n.canonical.z;if(s){const V=s.getMinMaxForTile(n);V&&(h=V.min,v=V.max)}v+=this.maxHeight;const A=n.toUnwrapped();let D;const x=[A.canonical.x/T+A.wrap,A.canonical.y/T],P=[(A.canonical.x+1)/T+A.wrap,(A.canonical.y+1)/T],L=(V,W,K)=>[V[0]*(1-K[0])+W[0]*K[0],V[1]*(1-K[1])+W[1]*K[1]],I=[],R=[];for(const V of this.triangleSubSegments){I[0]=V.min.x/In,I[1]=V.min.y/In,R[0]=V.max.x/In,R[1]=V.max.y/In;const W=L(x,P,I),K=L(x,P,R);if(new Jn([W[0],W[1],h],[K[0],K[1],v]).intersectsPrecise(u)===0){D&&(g.segments.push(D),D=void 0);continue}const re=V.segment;D&&D.vertexOffset!==re.vertexOffset&&(g.segments.push(D),D=void 0),D?(D.vertexLength+=re.vertexLength,D.primitiveLength+=re.primitiveLength):D={vertexOffset:re.vertexOffset,primitiveLength:re.primitiveLength,vertexLength:re.vertexLength,primitiveOffset:re.primitiveOffset,sortKey:void 0,vaos:{}}}return D&&g.segments.push(D),g}encodeCentroid(n,s){const u=n.centroid(),g=s.span(),h=Math.min(7,Math.round(g.x*this.tileToMeter/10)),v=Math.min(7,Math.round(g.y*this.tileToMeter/10));return new Qe(It(u.x,1,In-1)<<3|h,It(u.y,1,In-1)<<3|v)}encodeBorderCentroid(n){if(!n.borders)return new Qe(0,0);const s=n.borders,u=Number.MAX_VALUE;if(s[0][0]!==u||s[1][0]!==u){const g=s[0][0]!==u?0:1;return new Qe(6|(s[0][0]!==u?0:65528),(s[g][0]+s[g][1])/2<<3|6)}{const g=s[2][0]!==u?2:3;return new Qe((s[g][0]+s[g][1])/2<<3|6,6|(s[2][0]!==u?0:65528))}}showCentroid(n){const s=this.centroidData[n.centroidDataIndex];s.flags&=xd,s.centroidXY.x=0,s.centroidXY.y=0,this.writeCentroidToBuffer(s)}writeCentroidToBuffer(n){this.groundEffect.updateHiddenByLandmark(n);const s=n.vertexArrayOffset,u=n.vertexCount+n.vertexArrayOffset,g=n.flags&xd?dI:n.centroidXY,h=this.centroidVertexArray.geta_centroid_pos0(s);if(this.centroidVertexArray.geta_centroid_pos1(s)!==g.y||h!==g.x){for(let v=s;v<u;++v)this.centroidVertexArray.emplace(v,g.x,g.y);this.needsCentroidUpdate=!0}}createCentroidsBuffer(){this.centroidVertexArray.resize(this.layoutVertexArray.length),this.groundEffect.hiddenByLandmarkVertexArray.resize(this.groundEffect.vertexArray.length);for(const n of this.centroidData)this.writeCentroidToBuffer(n)}updateReplacement(n,s,u){if(s.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=s.updateTime;const g=s.getReplacementRegionsForTile(n.toUnwrapped());if(Lw(this.activeReplacements,g))return;if(this.activeReplacements=g,this.centroidVertexArray.length===0)this.createCentroidsBuffer();else for(const v of this.centroidData)v.flags&=2147483647;const h=[];for(const v of this.activeReplacements){if(v.order<u)continue;const T=Math.max(1,Math.pow(2,v.footprintTileId.canonical.z-n.canonical.z));for(const A of this.centroidData)if(!(A.flags&xd||v.min.x>A.max.x||A.min.x>v.max.x||v.min.y>A.max.y||A.min.y>v.max.y))for(let D=0;D<A.footprintSegLen;D++){const x=this.footprintSegments[A.footprintSegIdx+D];if(h.length=0,y5(this.footprintVertices,x.vertexOffset,x.vertexCount,v.footprintTileId.canonical,n.canonical,h),sI(v.footprint,h,this.footprintIndices.uint16,x.indexOffset,x.indexCount,-x.vertexOffset,-T)){A.flags|=xd;break}}}for(const v of this.centroidData)this.writeCentroidToBuffer(v);this.borderDoneWithNeighborZ=[-1,-1,-1,-1]}footprintContainsPoint(n,s,u){let g=!1;for(let h=0;h<u.footprintSegLen;h++){const v=this.footprintSegments[u.footprintSegIdx+h];let T=0;for(const A of v.ringIndices){for(let D=T,x=A+T-1;D<A+T;x=D++){const P=this.footprintVertices.int16[2*(D+v.vertexOffset)+0],L=this.footprintVertices.int16[2*(D+v.vertexOffset)+1],I=this.footprintVertices.int16[2*(x+v.vertexOffset)+1];L>s!=I>s&&n<(this.footprintVertices.int16[2*(x+v.vertexOffset)+0]-P)*(s-L)/(I-L)+P&&(g=!g)}T=A}}return g}getHeightAtTileCoord(n,s){let u=Number.NEGATIVE_INFINITY,g=!0;const h=4*(n+In)*In+(s+In);if(this.partLookup.hasOwnProperty(h)){const v=this.partLookup[h];return v?{height:v.height,hidden:!!(v.flags&xd)}:void 0}for(const v of this.centroidData)n>v.max.x||v.min.x>n||s>v.max.y||v.min.y>s||this.footprintContainsPoint(n,s,v)&&v&&v.height>u&&(u=v.height,this.partLookup[h]=v,g=!!(v.flags&xd));if(u!==Number.NEGATIVE_INFINITY)return{height:u,hidden:g};this.partLookup[h]=void 0}}function vI(c,n){const s=c.add(n)._unit();return c.x*s.x+c.y*s.y}function _5(c,n,s,u){const g=n.sub(c)._perp()._unit(),h=s.sub(n)._perp()._unit();return _I(c,n,s,vI(g,h),u)}function _I(c,n,s,u,g){const h=Math.sqrt(1-u*u);return Math.min(c.dist(n)/3,n.dist(s)/3,g*h/u)}function Fw(c,n,s){return c.x<s[0].x&&n.x<s[0].x||c.x>s[1].x&&n.x>s[1].x||c.y<s[0].y&&n.y<s[0].y||c.y>s[1].y&&n.y>s[1].y}function yI(c,n){return c.x<n[0].x||c.x>n[1].x||c.y<n[0].y||c.y>n[1].y}function bI(c,n,s){if(c.x<0||c.x>=In||n.x<0||n.x>=In||s.x<0||s.x>=In)return!1;const u=s.sub(n),g=u.perp(),h=c.sub(n);return(u.x*h.x+u.y*h.y)/Math.sqrt((u.x*u.x+u.y*u.y)*(h.x*h.x+h.y*h.y))>-.866&&g.x*h.x+g.y*h.y<0}function xI(c,n,s){const u=n?2|c:-3&c;return s?1|u:-2&u}function wI(){const c=Math.PI/32,n=Math.tan(c),s=bu;return s*Math.sqrt(1+2*n*n)-s}function SI(c,n,s){const u=1<<s.z,g=Ds(s.x/u),h=Ds((s.x+1)/u),v=Ui(s.y/u),T=Ui((s.y+1)/u);return function(A,D,x,P,L=0,I){const R=[];if(!A.length||!x||!P)return R;const V=(_e,Ee)=>{for(const Ne of _e)R.push({polygon:Ne,bounds:Ee})},W=Math.ceil(Math.log2(x)),K=Math.ceil(Math.log2(P)),re=W-K,ie=[];for(let _e=0;_e<Math.abs(re);_e++)ie.push(re>0?0:1);for(let _e=0;_e<Math.min(W,K);_e++)ie.push(0),ie.push(1);let Q=A;if(Q=P0(Q,D[0].y-L,D[1].y+L,1),Q=P0(Q,D[0].x-L,D[1].x+L,0),!Q.length)return R;const ue=[];for(ie.length?ue.push({polygons:Q,bounds:D,depth:0}):V(Q,D);ue.length;){const _e=ue.pop(),Ee=_e.depth,Ne=ie[Ee],ze=_e.bounds[0],De=_e.bounds[1],ot=Ne===0?ze.x:ze.y,$e=Ne===0?De.x:De.y,it=I?I(Ne,ot,$e):.5*(ot+$e),ft=P0(_e.polygons,ot-L,it+L,Ne),ut=P0(_e.polygons,it-L,$e+L,Ne);if(ft.length){const mt=[ze,new Qe(Ne===0?it:De.x,Ne===1?it:De.y)];ie.length>Ee+1?ue.push({polygons:ft,bounds:mt,depth:Ee+1}):V(ft,mt)}if(ut.length){const mt=[new Qe(Ne===0?it:ze.x,Ne===1?it:ze.y),De];ie.length>Ee+1?ue.push({polygons:ut,bounds:mt,depth:Ee+1}):V(ut,mt)}}return R}(c,n,Math.ceil((h-g)/11.25),Math.ceil((v-T)/11.25),1,(A,D,x)=>{if(A===0)return .5*(D+x);{const P=Ui((s.y+D/In)/u);return(Na(.5*(Ui((s.y+x/In)/u)+P))*u-s.y)*In}})}function y5(c,n,s,u,g,h){const v=Math.pow(2,u.z-g.z);for(let T=0;T<s;T++){let A=c.int16[2*(T+n)+0],D=c.int16[2*(T+n)+1];A=(A+g.x*In)*v-u.x*In,D=(D+g.y*In)*v-u.y*In,h.push(new Qe(A,D))}}let TI,CI;function Rv(c,n){return c.x*n.x+c.y*n.y}function EI(c,n){if(c.length===1){let s=0;const u=n[s++];let g;for(;!g||u.equals(g);)if(g=n[s++],!g)return 1/0;for(;s<n.length;s++){const h=n[s],v=c[0],T=g.sub(u),A=h.sub(u),D=v.sub(u),x=Rv(T,T),P=Rv(T,A),L=Rv(A,A),I=Rv(D,T),R=Rv(D,A),V=x*L-P*P,W=(L*I-P*R)/V,K=(x*R-P*I)/V,re=u.z*(1-W-K)+g.z*W+h.z*K;if(isFinite(re))return re}return 1/0}{let s=1/0;for(const u of n)s=Math.min(s,u.z);return s}}function MI(c,n,s,u,g,h,v,T){const A=v*g.getElevationAt(c,n,!0,!0),D=h[0]!==0,x=D?h[1]===0?v*(h[0]/7-450):v*function(P,L,I){const R=Math.floor(L[0]/8),V=Math.floor(L[1]/8),W=10*(L[0]-8*R),K=10*(L[1]-8*V),re=P.getElevationAt(R,V,!0,!0),ie=P.getMeterToDEM(I),Q=Math.floor(.5*(W*ie-1)),ue=Math.floor(.5*(K*ie-1)),_e=P.tileCoordToPixel(R,V),Ee=2*Q+1,Ne=2*ue+1,ze=function(ut,mt,xt,At,_t){return[ut.getElevationAtPixel(mt,xt,!0),ut.getElevationAtPixel(mt+_t,xt,!0),ut.getElevationAtPixel(mt,xt+_t,!0),ut.getElevationAtPixel(mt+At,xt+_t,!0)]}(P,_e.x-Q,_e.y-ue,Ee,Ne),De=Math.abs(ze[0]-ze[1]),ot=Math.abs(ze[2]-ze[3]),$e=Math.abs(ze[0]-ze[2])+Math.abs(ze[1]-ze[3]),it=Math.min(.25,.5*ie*(De+ot)/Ee),ft=Math.min(.25,.5*ie*$e/Ne);return re+Math.max(it*W,ft*K)}(g,h,T):A;return{base:A+(s===0?-1:s),top:D?Math.max(x+u,A+s+2):A+u}}Hn(D0,"FillExtrusionBucket",{omit:["layers","features"]}),Hn(fI,"PartData"),Hn(hI,"FootprintSegment"),Hn(pI,"BorderCentroidData"),Hn(gI,"GroundEffect");const b5=so([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),x5=so([{name:"a_z_offset_width",components:3,type:"Float32"}],4),{members:w5}=b5,S5=so([{name:"a_packed",components:3,type:"Float32"}]),{members:T5}=S5,C5=so([{name:"a_pattern_data",components:3,type:"Float32"}]),{members:E5}=C5;class II{constructor(n,s){this.width=n,this.height=s,this.nextRow=0,this.image=new bd({width:n,height:s}),this.positions={},this.uploaded=!1}getDash(n,s){const u=this.getKey(n,s);return this.positions[u]}trim(){const n=this.width,s=this.height=Io(this.nextRow);this.image.resize({width:n,height:s})}getKey(n,s){return n.join(",")+s}getDashRanges(n,s,u){const g=[];let h=n.length%2==1?-n[n.length-1]*u:0,v=n[0]*u,T=!0;g.push({left:h,right:v,isDash:T,zeroLength:n[0]===0});let A=n[0];for(let D=1;D<n.length;D++){T=!T;const x=n[D];h=A*u,A+=x,v=A*u,g.push({left:h,right:v,isDash:T,zeroLength:x===0})}return g}addRoundDash(n,s,u){const g=s/2;for(let h=-u;h<=u;h++){const v=this.width*(this.nextRow+u+h);let T=0,A=n[T];for(let D=0;D<this.width;D++){D/A.right>1&&(A=n[++T]);const x=Math.abs(D-A.left),P=Math.abs(D-A.right),L=Math.min(x,P);let I;const R=h/u*(g+1);if(A.isDash){const V=g-Math.abs(R);I=Math.sqrt(L*L+V*V)}else I=g-Math.sqrt(L*L+R*R);this.image.data[v+D]=Math.max(0,Math.min(255,I+128))}}}addRegularDash(n,s){for(let A=n.length-1;A>=0;--A){const D=n[A],x=n[A+1];D.zeroLength?n.splice(A,1):x&&x.isDash===D.isDash&&(x.left=D.left,n.splice(A,1))}const u=n[0],g=n[n.length-1];u.isDash===g.isDash&&(u.left=g.left-this.width,g.right=u.right+this.width);const h=this.width*this.nextRow;let v=0,T=n[v];for(let A=0;A<this.width;A++){A/T.right>1&&(T=n[++v]);const D=Math.abs(A-T.left),x=Math.abs(A-T.right),P=Math.min(D,x);this.image.data[h+A]=Math.max(0,Math.min(255,(T.isDash?P:-P)+s+128))}}addDash(n,s){const u=this.getKey(n,s);if(this.positions[u])return this.positions[u];const g=s==="round",h=g?7:0,v=2*h+1;if(this.nextRow+v>this.height)return wn("LineAtlas out of space"),null;n.length===0&&n.push(1);let T=0;for(let x=0;x<n.length;x++)n[x]<0&&(wn("Negative value is found in line dasharray, replacing values with 0"),n[x]=0),T+=n[x];if(T!==0){const x=this.width/T,P=this.getDashRanges(n,this.width,x);g?this.addRoundDash(P,x,h):this.addRegularDash(P,s==="square"?.5*x:0)}const A=this.nextRow+h;this.nextRow+=v;const D={tl:[A,h],br:[T,0]};return this.positions[u]=D,D}}Hn(II,"LineAtlas");const M5=zp.VectorTileFeature.types,I5=Math.cos(Math.PI/180*37.5),A5=Math.cos(Math.PI/180*5);class Nw{constructor(n){this.evaluationGlobals={zoom:0,lineProgress:void 0},this.zoom=n.zoom,this.evaluationGlobals.zoom=this.zoom,this.overscaling=n.overscaling,this.pixelRatio=n.pixelRatio,this.layers=n.layers,this.layerIds=this.layers.map(s=>s.fqid),this.index=n.index,this.projection=n.projection,this.hasPattern=!1,this.hasZOffset=!1,this.hasCrossSlope=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(s=>{this.gradients[s.id]={}}),this.layoutVertexArray=new Fh,this.layoutVertexArray2=new al,this.patternVertexArray=new al,this.indexArray=new $i,this.programConfigurations=new kc(n.layers,{zoom:n.zoom,lut:n.lut}),this.segments=new ei,this.maxLineLength=0,this.zOffsetVertexArray=new al,this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id),this.tessellationStep=n.tessellationStep?n.tessellationStep:In/64}updateFootprints(n,s){}populate(n,s,u,g){this.hasPattern=Ew("line",this.layers,this.pixelRatio,s);const h=this.layers[0].layout.get("line-sort-key");this.tileToMeter=o(u);const v=this.layers[0].layout.get("line-z-offset"),T=v.isConstant()&&!v.constantOr(0),A=this.layers[0].layout.get("line-elevation-reference");this.hasZOffset=A==="sea"||A==="ground"||!T&&A==="none",this.hasZOffset&&A==="none"&&wn(`line-elevation-reference: ground is used for the layer ${this.layerIds[0]} because non-zero line-z-offset value was found.`);const D=this.layers[0].layout.get("line-cross-slope");this.hasCrossSlope=this.hasZOffset&&D!==void 0;const x=[];for(const{feature:R,id:V,index:W,sourceLayerIndex:K}of n){const re=this.layers[0]._featureFilter.needGeometry,ie=Z(R,re);if(!this.layers[0]._featureFilter.filter(new zo(this.zoom),ie,u))continue;const Q=h?h.evaluate(ie,{},u):void 0,ue={id:V,properties:R.properties,type:R.type,sourceLayerIndex:K,index:W,geometry:re?ie.geometry:G(R,u,g),patterns:{},sortKey:Q};x.push(ue)}h&&x.sort((R,V)=>R.sortKey-V.sortKey);const{lineAtlas:P,featureIndex:L}=s,I=this.addConstantDashes(P);for(const R of x){const{geometry:V,index:W,sourceLayerIndex:K}=R;if(I&&this.addFeatureDashes(R,P),this.hasPattern){const re=Mw("line",this.layers,R,this.zoom,this.pixelRatio,s);this.patternFeatures.push(re)}else this.addFeature(R,V,W,u,P.positions,s.availableImages,s.brightness);L.insert(n[W].feature,V,W,K,this.index)}}addConstantDashes(n){let s=!1;for(const u of this.layers){const g=u.paint.get("line-dasharray").value,h=u.layout.get("line-cap").value;if(g.kind!=="constant"||h.kind!=="constant")s=!0;else{const v=h.value,T=g.value;if(!T)continue;n.addDash(T,v)}}return s}addFeatureDashes(n,s){const u=this.zoom;for(const g of this.layers){const h=g.paint.get("line-dasharray").value,v=g.layout.get("line-cap").value;if(h.kind==="constant"&&v.kind==="constant")continue;let T,A;if(h.kind==="constant"){if(T=h.value,!T)continue}else T=h.evaluate({zoom:u},n);A=v.kind==="constant"?v.value:v.evaluate({zoom:u},n),s.addDash(T,A),n.patterns[g.id]=s.getKey(T,A)}}update(n,s,u,g,h,v,T){this.programConfigurations.updatePaintArrays(n,s,h,u,g,v,T)}addFeatures(n,s,u,g,h,v){for(const T of this.patternFeatures)this.addFeature(T,T.geometry,T.index,s,u,g,v)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(n){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=n.createVertexBuffer(this.layoutVertexArray2,T5)),this.patternVertexArray.length!==0&&(this.patternVertexBuffer=n.createVertexBuffer(this.patternVertexArray,E5)),!this.zOffsetVertexBuffer&&this.zOffsetVertexArray.length>0&&(this.zOffsetVertexBuffer=n.createVertexBuffer(this.zOffsetVertexArray,x5.members,!0)),this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,w5),this.indexBuffer=n.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(n),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.zOffsetVertexBuffer&&this.zOffsetVertexBuffer.destroy(),this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(n){if(n.properties&&n.properties.hasOwnProperty("mapbox_clip_start")&&n.properties.hasOwnProperty("mapbox_clip_end"))return{start:+n.properties.mapbox_clip_start,end:+n.properties.mapbox_clip_end}}addFeature(n,s,u,g,h,v,T){const A=this.layers[0].layout,D=A.get("line-join").evaluate(n,{}),x=A.get("line-cap").evaluate(n,{}),P=A.get("line-miter-limit"),L=A.get("line-round-limit");this.lineClips=this.lineFeatureClips(n),this.lineFeature=n,this.zOffsetValue=A.get("line-z-offset").value;const I=this.layers[0].paint.get("line-width").value;I.kind!=="constant"&&I.isLineProgressConstant===!1&&(this.variableWidthValue=I);for(const R of s)this.addLine(R,n,g,D,x,P,L);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,n,u,h,v,g,T)}addLine(n,s,u,g,h,v,T){this.distance=0,this.prevDistance=0,this.scaledDistance=0,this.totalDistance=0,this.totalFeatureLength=0,this.lineSoFar=0,this.currentVertex=void 0;const A=g==="none";if(this.patternJoinNone=this.hasPattern&&A,this.segmentStart=0,this.segmentStartf32=0,this.segmentPoints=[],this.lineClips){this.lineClipsArray.push(this.lineClips);for(let ie=0;ie<n.length-1;ie++)this.totalDistance+=n[ie].dist(n[ie+1]);this.totalFeatureLength=this.totalDistance/(this.lineClips.end-this.lineClips.start),this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const D=M5[s.type]==="Polygon";let x=n.length;for(;x>=2&&n[x-1].equals(n[x-2]);)x--;let P=0;for(;P<x-1&&n[P].equals(n[P+1]);)P++;if(x<(D?3:2))return;g==="bevel"&&(v=1.05);const L=this.segments.prepareSegment(10*x,this.layoutVertexArray,this.indexArray);let I,R,V,W,K,re;this.e1=this.e2=-1,D&&(I=n[x-2],K=n[P].sub(I)._unit()._perp());for(let ie=P;ie<x;ie++){if(V=ie===x-1?D?n[P+1]:void 0:n[ie+1],V&&n[ie].equals(V))continue;K&&(W=K),I&&(R=I),I=n[ie],re=this.evaluateLineProgressFeatures(R?R.dist(I):0),K=V?V.sub(I)._unit()._perp():W,W=W||K;const Q=R&&V;let ue=Q?g:D||A?"butt":h;const _e=W.x*K.x+W.y*K.y;if(A){const ft=function(ut){if(ut.patternJoinNone){const mt=ut.segmentPoints.length/2,xt=ut.lineSoFar-ut.segmentStart;for(let At=0;At<mt;++At){const _t=ut.segmentPoints[2*At+1],Zt=Math.round(ut.segmentPoints[2*At])+.5+.25*_t;ut.patternVertexArray.emplaceBack(Zt,xt,ut.segmentStart),ut.patternVertexArray.emplaceBack(Zt,xt,ut.segmentStart)}ut.segmentPoints.length=0}ut.e1=ut.e2=-1};if(Q&&_e<A5){this.updateDistance(R,I),this.addCurrentVertex(I,W,1,1,L,re),ft(this),this.addCurrentVertex(I,K,-1,-1,L,re);continue}if(R){if(!V){this.updateDistance(R,I),this.addCurrentVertex(I,W,1,1,L,re),ft(this);continue}ue="miter"}}let Ee=W.add(K);Ee.x===0&&Ee.y===0||Ee._unit();const Ne=Ee.x*K.x+Ee.y*K.y,ze=Ne!==0?1/Ne:1/0,De=2*Math.sqrt(2-2*Ne),ot=Ne<I5&&R&&V,$e=W.x*K.y-W.y*K.x>0,it=this.overscaling<=16?15*In/(512*this.overscaling):0;if(Q&&ue==="round"){if(ze<T)ue="miter";else if(ze<=2){const ft=Bw(I,-10,In+10);ue=this.hasZOffset&&(ft||this.hasCrossSlope)?"miter":"fakeround"}}if(ue==="miter"&&ze>v&&(ue="bevel"),ue==="bevel"&&(ze>2&&(ue="flipbevel"),ze<v&&(ue="miter")),R&&!(ue==="miter"&&ot)&&this.updateDistance(R,I),ue==="miter")if(ot){const ft=I.dist(R);if(ft>2*it){const mt=I.sub(I.sub(R)._mult(it/ft)._round());this.updateDistance(R,mt),this.addCurrentVertex(mt,W,0,0,L,re),R=mt}this.updateDistance(R,I),Ee._mult(ze),this.addCurrentVertex(I,Ee,0,0,L,re);const ut=I.dist(V);if(ut>2*it){const mt=I.add(V.sub(I)._mult(it/ut)._round());this.updateDistance(I,mt),this.addCurrentVertex(mt,K,0,0,L,re),I=mt}}else Ee._mult(ze),this.addCurrentVertex(I,Ee,0,0,L,re);else if(ue==="flipbevel"){if(ze>100)Ee=K.mult(-1);else{const ft=ze*W.add(K).mag()/W.sub(K).mag();Ee._perp()._mult(ft*($e?-1:1))}this.addCurrentVertex(I,Ee,0,0,L,re),this.addCurrentVertex(I,Ee.mult(-1),0,0,L,re)}else if(ue==="bevel"||ue==="fakeround"){re!=null&&R&&this.addCurrentVertex(I,W,-1,-1,L,re);const ft=I.dist(R)<=2*it&&ue!=="bevel",ut=Ee.mult($e?1:-1);ut._mult(ze);const mt=K.mult($e?-1:1),xt=W.mult($e?-1:1),At=this.evaluateLineProgressFeatures(this.distance);if(re==null&&(this.addHalfVertex(I,ut.x,ut.y,!1,!$e,0,L,At),ft||this.addHalfVertex(I,ut.x+2*xt.x,ut.y+2*xt.y,!1,$e,0,L,At)),ue==="fakeround"){const _t=Math.round(180*De/Math.PI/20);this.addHalfVertex(I,xt.x,xt.y,!1,$e,0,L,At);for(let Zt=0;Zt<_t;Zt++){let hn=Zt/_t;if(hn!==.5){const kn=hn-.5;hn+=hn*kn*(hn-1)*((1.0904+_e*(_e*(3.55645-1.43519*_e)-3.2452))*kn*kn+(.848013+_e*(.215638*_e-1.06021)))}const Kt=mt.sub(xt)._mult(hn)._add(xt)._unit();this.addHalfVertex(I,Kt.x,Kt.y,!1,$e,0,L,At)}this.addHalfVertex(I,mt.x,mt.y,!1,$e,0,L,At)}ft||re!=null||this.addHalfVertex(I,ut.x+2*mt.x,ut.y+2*mt.y,!1,$e,0,L,At),re!=null&&V&&this.addCurrentVertex(I,K,1,1,L,re)}else ue==="butt"?this.addCurrentVertex(I,Ee,0,0,L,re):ue==="square"?(R||this.addCurrentVertex(I,Ee,-1,-1,L,re),this.addCurrentVertex(I,Ee,0,0,L,re),R&&this.addCurrentVertex(I,Ee,1,1,L,re)):ue==="round"&&(R&&(this.addCurrentVertex(I,W,0,0,L,re),this.addCurrentVertex(I,W,1,1,L,re,!0)),V&&(this.addCurrentVertex(I,K,-1,-1,L,re,!0),this.addCurrentVertex(I,K,0,0,L,re)))}}addVerticesTo(n,s,u,g,h,v,T,A,D,x){const P=(s.w-n.w)/this.tessellationStep|0;let L=0;const I=this.scaledDistance;if(P>1){this.lineSoFar=n.w;const V=(s.x-n.x)/P,W=(s.y-n.y)/P,K=(s.z-n.z)/P,re=(s.w-n.w)/P;for(let ie=1;ie<P;++ie){n.x+=V,n.y+=W,n.z+=K,this.lineSoFar+=re,L+=re;const Q=this.evaluateLineProgressFeatures(this.prevDistance+L);this.scaledDistance=(this.prevDistance+L)/this.totalDistance,this.addHalfVertex(n,u,g,x,!1,T,D,Q),this.addHalfVertex(n,h,v,x,!0,-A,D,Q)}}this.lineSoFar=s.w,this.scaledDistance=I;const R=this.evaluateLineProgressFeatures(this.distance);this.addHalfVertex(s,u,g,x,!1,T,D,R),this.addHalfVertex(s,h,v,x,!0,-A,D,R)}evaluateLineProgressFeatures(n){if(!this.variableWidthValue&&!this.hasZOffset)return null;this.evaluationGlobals.lineProgress=0,this.lineClips?this.evaluationGlobals.lineProgress=Math.min(1,(this.totalFeatureLength*this.lineClips.start+n)/this.totalFeatureLength):wn(`line-progress evaluation for ${this.layerIds[0]} requires enabling 'lineMetrics' for the source.`);let s=0;return this.variableWidthValue&&this.variableWidthValue.kind!=="constant"&&(s=this.variableWidthValue.evaluate(this.evaluationGlobals,this.lineFeature)||0),this.hasZOffset?this.zOffsetValue.kind==="constant"?{zOffset:this.zOffsetValue.value,variableWidth:s}:{zOffset:this.zOffsetValue.evaluate(this.evaluationGlobals,this.lineFeature)||0,variableWidth:s}:{zOffset:0,variableWidth:s}}addCurrentVertex(n,s,u,g,h,v,T=!1){const A=s.x+s.y*u,D=s.y-s.x*u,x=s.y*g-s.x,P=-s.y-s.x*g;if(v!=null){const L=this.hasZOffset,I=-10,R=In+10,V=v.zOffset,W=new eI(n.x,n.y,V,this.lineSoFar),K=!!L&&Bw(n,I,R),re=this.lineSoFar,ie=this.distance;if(this.currentVertex)if(K){const Q=this.currentVertexIsOutside,ue=this.currentVertex,_e=new eI(n.x,n.y,V,this.lineSoFar);if(nI(ue,_e,I,R),!Bw(_e,I,R)){if(Q){this.e1=this.e2=-1,this.distance-=ue.dist(W),this.lineSoFar=ue.w;const Ee=this.evaluateLineProgressFeatures(ue.w-this.totalFeatureLength*(this.lineClips?this.lineClips.start:0));this.addHalfVertex(ue,A,D,T,!1,u,h,Ee),this.addHalfVertex(ue,x,P,T,!0,-g,h,Ee),this.prevDistance=this.distance}this.distance=this.prevDistance+ue.dist(_e),this.scaledDistance=this.distance/this.totalDistance,this.addVerticesTo(ue,_e,A,D,x,P,u,g,h,T),this.distance=ie,this.scaledDistance=this.distance/this.totalDistance}}else{const Q=this.currentVertex;if(this.currentVertexIsOutside){nI(Q,W,I,R),this.e1=this.e2=-1,this.distance-=Q.dist(W),this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=Q.w;const ue=this.evaluateLineProgressFeatures(Q.w-this.totalFeatureLength*(this.lineClips?this.lineClips.start:0));this.addHalfVertex(Q,A,D,T,!1,u,h,ue),this.addHalfVertex(Q,x,P,T,!0,-g,h,ue),this.prevDistance=this.distance,this.distance=ie,this.scaledDistance=this.distance/this.totalDistance}this.addVerticesTo(Q,W,A,D,x,P,u,g,h,T)}else K||(this.addHalfVertex(n,A,D,T,!1,u,h,v),this.addHalfVertex(n,x,P,T,!0,-g,h,v));this.currentVertex=W,this.currentVertexIsOutside=K,this.lineSoFar=re}else this.addHalfVertex(n,A,D,T,!1,u,h,v),this.addHalfVertex(n,x,P,T,!0,-g,h,v)}addHalfVertex({x:n,y:s},u,g,h,v,T,A,D){if(this.patternJoinNone&&(this.segmentPoints.length===0&&(this.segmentStart=this.lineSoFar,this.segmentStartf32=Math.fround(this.lineSoFar)),v||this.segmentPoints.push(this.lineSoFar-this.segmentStart,T)),this.layoutVertexArray.emplaceBack((n<<1)+(h?1:0),(s<<1)+(v?1:0),Math.round(63*u)+128,Math.round(63*g)+128,1+(T===0?0:T<0?-1:1),0,this.lineSoFar-this.segmentStartf32),this.lineClips){const P=cr(this.lineClips.start,this.lineClips.end,this.scaledDistance);this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,P)}const x=A.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,x),A.primitiveLength++),v?this.e2=x:this.e1=x,D!=null&&this.zOffsetVertexArray.emplaceBack(D.zOffset,D.variableWidth,D.variableWidth)}updateScaledDistance(){this.lineClips?(this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=this.totalFeatureLength*this.lineClips.start+this.distance):this.lineSoFar=this.distance}updateDistance(n,s){this.prevDistance=this.distance,this.distance+=n.dist(s),this.updateScaledDistance()}}function Bw(c,n,s){return c.x<n||c.x>s||c.y<n||c.y>s}let AI,kI;function PI(c,n,s){return n*(In/(c.tileSize*Math.pow(2,s-c.tileID.overscaledZ)))}Hn(Nw,"LineBucket",{omit:["layers","patternFeatures","currentVertex","currentVertexIsOutside"]});const RI=(c,n,s)=>(1-s)*c+s*n;function OI(c,n){return 1/PI(c,1,n.tileZoom)}function LI(c,n,s,u){return c.translatePosMatrix(u||n.tileID.projMatrix,n,s.paint.get("line-translate"),s.paint.get("line-translate-anchor"))}const DI=c=>{const n=[];zI(c)&&n.push("RENDER_LINE_DASH"),c.paint.get("line-gradient")&&n.push("RENDER_LINE_GRADIENT");const s=c.paint.get("line-trim-offset");s[0]===0&&s[1]===0||n.push("RENDER_LINE_TRIM_OFFSET"),c.paint.get("line-border-width").constantOr(1)!==0&&n.push("RENDER_LINE_BORDER");const u=c.layout.get("line-join").constantOr("miter")==="none",g=!!c.paint.get("line-pattern").constantOr(1);return u&&g&&n.push("LINE_JOIN_NONE"),n};function zI(c){const n=c.paint.get("line-dasharray").value;return n.value||n.kind!=="constant"}let Vw;const FI=()=>Vw||(Vw={layout:AI||(AI=new Wo({"line-cap":new zn(Lt.layout_line["line-cap"]),"line-join":new zn(Lt.layout_line["line-join"]),"line-miter-limit":new xn(Lt.layout_line["line-miter-limit"]),"line-round-limit":new xn(Lt.layout_line["line-round-limit"]),"line-sort-key":new zn(Lt.layout_line["line-sort-key"]),"line-z-offset":new zn(Lt.layout_line["line-z-offset"]),"line-elevation-reference":new xn(Lt.layout_line["line-elevation-reference"]),"line-cross-slope":new xn(Lt.layout_line["line-cross-slope"]),visibility:new xn(Lt.layout_line.visibility),"line-width-unit":new xn(Lt.layout_line["line-width-unit"])})),paint:kI||(kI=new Wo({"line-opacity":new zn(Lt.paint_line["line-opacity"]),"line-color":new zn(Lt.paint_line["line-color"]),"line-translate":new xn(Lt.paint_line["line-translate"]),"line-translate-anchor":new xn(Lt.paint_line["line-translate-anchor"]),"line-width":new zn(Lt.paint_line["line-width"]),"line-gap-width":new zn(Lt.paint_line["line-gap-width"]),"line-offset":new zn(Lt.paint_line["line-offset"]),"line-blur":new zn(Lt.paint_line["line-blur"]),"line-dasharray":new zn(Lt.paint_line["line-dasharray"]),"line-pattern":new zn(Lt.paint_line["line-pattern"]),"line-gradient":new ud(Lt.paint_line["line-gradient"]),"line-trim-offset":new xn(Lt.paint_line["line-trim-offset"]),"line-trim-fade-range":new xn(Lt.paint_line["line-trim-fade-range"]),"line-trim-color":new xn(Lt.paint_line["line-trim-color"]),"line-emissive-strength":new xn(Lt.paint_line["line-emissive-strength"]),"line-border-width":new zn(Lt.paint_line["line-border-width"]),"line-border-color":new zn(Lt.paint_line["line-border-color"]),"line-occlusion-opacity":new xn(Lt.paint_line["line-occlusion-opacity"]),"line-color-use-theme":new zn({type:"string",default:"default","property-type":"data-driven"}),"line-gradient-use-theme":new zn({type:"string",default:"default","property-type":"data-driven"}),"line-trim-color-use-theme":new zn({type:"string",default:"default","property-type":"data-driven"}),"line-border-color-use-theme":new zn({type:"string",default:"default","property-type":"data-driven"})}))},Vw);class k5 extends zn{possiblyEvaluate(n,s){return s=new zo(Math.floor(s.zoom),{now:s.now,fadeDuration:s.fadeDuration,transition:s.transition}),super.possiblyEvaluate(n,s)}evaluate(n,s,u,g){return s=tr({},s,{zoom:Math.floor(s.zoom)}),super.evaluate(n,s,u,g)}}let Ov;function NI(c,n){return n>0?n+2*c:c}const P5=so([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),R5=so([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),O5=so([{name:"a_projected_pos",components:4,type:"Float32"}],4);so([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const L5=so([{name:"a_auto_z_offset",components:1,type:"Float32"}],4),D5=so([{name:"a_texb",components:2,type:"Uint16"}]),z5=so([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_elevation_from_sea",components:2,type:"Float32"}]),F5=so([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"},{name:"a_auto_z_offset",components:1,type:"Float32"}]);so([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const BI=so([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),N5=so([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);so([{name:"triangle",components:3,type:"Uint16"}]),so([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),so([{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Float32",name:"zOffset"},{type:"Uint8",name:"hasIconTextFit"}]),so([{type:"Float32",name:"offsetX"}]),so([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);var ts=24;const Ul=128;function $w(c,n,s,u,g){if(c.kind==="camera")return c.maxSize;if(c.kind==="composite"){const h=n.possiblyEvaluate(new zo(c.maxZoom),s).evaluate(g,{},s),v=n.possiblyEvaluate(new zo(c.minZoom),s).evaluate(g,{},s);return Math.max(h,v)}return n.possiblyEvaluate(new zo(u)).evaluate(g,{},s)}function Uw(c,n){const{expression:s}=n;if(s.kind==="constant")return{kind:"constant",layoutSize:s.evaluate(new zo(c+1))};if(s.kind==="source")return{kind:"source"};{const{zoomStops:u,interpolationType:g}=s;let h=0;for(;h<u.length&&u[h]<=c;)h++;h=Math.max(0,h-1);let v=h;for(;v<u.length&&u[v]<c+1;)v++;v=Math.min(u.length-1,v);const T=u[h],A=u[v];return s.kind==="composite"?{kind:"composite",minZoom:T,maxZoom:A,interpolationType:g}:{kind:"camera",minZoom:T,maxZoom:A,minSize:s.evaluate(new zo(T)),maxSize:s.evaluate(new zo(A)),interpolationType:g}}}function z0(c,{uSize:n,uSizeT:s},{lowerSize:u,upperSize:g}){return c.kind==="source"?u/Ul:c.kind==="composite"?cr(u/Ul,g/Ul,s):n}function Fp(c,n,s=1){let u=0,g=0;if(c.kind==="constant")g=c.layoutSize*s;else if(c.kind!=="source"){const{interpolationType:h,minZoom:v,maxZoom:T}=c,A=h?It(Rs.interpolationFactor(h,n,v,T),0,1):0;c.kind==="camera"?g=cr(c.minSize,c.maxSize,A)*s:u=A*s}return{uSizeT:u,uSize:g}}var B5=Object.freeze({__proto__:null,SIZE_PACK_FACTOR:Ul,evaluateSizeForFeature:z0,evaluateSizeForZoom:Fp,getRasterizedIconSize:$w,getSizeData:Uw});function V5(c,n,s){return c.sections.forEach(u=>{u.text=function(g,h,v){const T=h.layout.get("text-transform").evaluate(v,{});return T==="uppercase"?g=g.toLocaleUpperCase():T==="lowercase"&&(g=g.toLocaleLowerCase()),qs.applyArabicShaping&&(g=qs.applyArabicShaping(g)),g}(u.text,n,s)}),c}const Lv={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};function $5(c){return c===""||c===""||c===""||c===""||c===""||c===""||c===""||c===""||c===""||c===""||c===""||c===""||c===""||c===""||c===""||c===""||c===""}function U5(c){return c===""||c===""||c===""||c===""||c===""||c===""||c===""||c===""||c===""||c===""}var VI,jw,$I,Hw={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */function j5(){return VI||(VI=1,Hw.read=function(c,n,s,u,g){var h,v,T=8*g-u-1,A=(1<<T)-1,D=A>>1,x=-7,P=s?g-1:0,L=s?-1:1,I=c[n+P];for(P+=L,h=I&(1<<-x)-1,I>>=-x,x+=T;x>0;h=256*h+c[n+P],P+=L,x-=8);for(v=h&(1<<-x)-1,h>>=-x,x+=u;x>0;v=256*v+c[n+P],P+=L,x-=8);if(h===0)h=1-D;else{if(h===A)return v?NaN:1/0*(I?-1:1);v+=Math.pow(2,u),h-=D}return(I?-1:1)*v*Math.pow(2,h-u)},Hw.write=function(c,n,s,u,g,h){var v,T,A,D=8*h-g-1,x=(1<<D)-1,P=x>>1,L=g===23?Math.pow(2,-24)-Math.pow(2,-77):0,I=u?0:h-1,R=u?1:-1,V=n<0||n===0&&1/n<0?1:0;for(n=Math.abs(n),isNaN(n)||n===1/0?(T=isNaN(n)?1:0,v=x):(v=Math.floor(Math.log(n)/Math.LN2),n*(A=Math.pow(2,-v))<1&&(v--,A*=2),(n+=v+P>=1?L/A:L*Math.pow(2,1-P))*A>=2&&(v++,A/=2),v+P>=x?(T=0,v=x):v+P>=1?(T=(n*A-1)*Math.pow(2,g),v+=P):(T=n*Math.pow(2,P-1)*Math.pow(2,g),v=0));g>=8;c[s+I]=255&T,I+=R,T/=256,g-=8);for(v=v<<g|T,D+=g;D>0;c[s+I]=255&v,I+=R,v/=256,D-=8);c[s+I-R]|=128*V}),Hw}function UI(){if($I)return jw;$I=1,jw=n;var c=j5();function n(Q){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(Q)?Q:new Uint8Array(Q||0),this.pos=0,this.type=0,this.length=this.buf.length}n.Varint=0,n.Fixed64=1,n.Bytes=2,n.Fixed32=5;var s=4294967296,u=1/s,g=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function h(Q){return Q.type===n.Bytes?Q.readVarint()+Q.pos:Q.pos+1}function v(Q,ue,_e){return _e?4294967296*ue+(Q>>>0):4294967296*(ue>>>0)+(Q>>>0)}function T(Q,ue,_e){var Ee=ue<=16383?1:ue<=2097151?2:ue<=268435455?3:Math.floor(Math.log(ue)/(7*Math.LN2));_e.realloc(Ee);for(var Ne=_e.pos-1;Ne>=Q;Ne--)_e.buf[Ne+Ee]=_e.buf[Ne]}function A(Q,ue){for(var _e=0;_e<Q.length;_e++)ue.writeVarint(Q[_e])}function D(Q,ue){for(var _e=0;_e<Q.length;_e++)ue.writeSVarint(Q[_e])}function x(Q,ue){for(var _e=0;_e<Q.length;_e++)ue.writeFloat(Q[_e])}function P(Q,ue){for(var _e=0;_e<Q.length;_e++)ue.writeDouble(Q[_e])}function L(Q,ue){for(var _e=0;_e<Q.length;_e++)ue.writeBoolean(Q[_e])}function I(Q,ue){for(var _e=0;_e<Q.length;_e++)ue.writeFixed32(Q[_e])}function R(Q,ue){for(var _e=0;_e<Q.length;_e++)ue.writeSFixed32(Q[_e])}function V(Q,ue){for(var _e=0;_e<Q.length;_e++)ue.writeFixed64(Q[_e])}function W(Q,ue){for(var _e=0;_e<Q.length;_e++)ue.writeSFixed64(Q[_e])}function K(Q,ue){return(Q[ue]|Q[ue+1]<<8|Q[ue+2]<<16)+16777216*Q[ue+3]}function re(Q,ue,_e){Q[_e]=ue,Q[_e+1]=ue>>>8,Q[_e+2]=ue>>>16,Q[_e+3]=ue>>>24}function ie(Q,ue){return(Q[ue]|Q[ue+1]<<8|Q[ue+2]<<16)+(Q[ue+3]<<24)}return n.prototype={destroy:function(){this.buf=null},readFields:function(Q,ue,_e){for(_e=_e||this.length;this.pos<_e;){var Ee=this.readVarint(),Ne=Ee>>3,ze=this.pos;this.type=7&Ee,Q(Ne,ue,this),this.pos===ze&&this.skip(Ee)}return ue},readMessage:function(Q,ue){return this.readFields(Q,ue,this.readVarint()+this.pos)},readFixed32:function(){var Q=K(this.buf,this.pos);return this.pos+=4,Q},readSFixed32:function(){var Q=ie(this.buf,this.pos);return this.pos+=4,Q},readFixed64:function(){var Q=K(this.buf,this.pos)+K(this.buf,this.pos+4)*s;return this.pos+=8,Q},readSFixed64:function(){var Q=K(this.buf,this.pos)+ie(this.buf,this.pos+4)*s;return this.pos+=8,Q},readFloat:function(){var Q=c.read(this.buf,this.pos,!0,23,4);return this.pos+=4,Q},readDouble:function(){var Q=c.read(this.buf,this.pos,!0,52,8);return this.pos+=8,Q},readVarint:function(Q){var ue,_e,Ee=this.buf;return ue=127&(_e=Ee[this.pos++]),_e<128?ue:(ue|=(127&(_e=Ee[this.pos++]))<<7,_e<128?ue:(ue|=(127&(_e=Ee[this.pos++]))<<14,_e<128?ue:(ue|=(127&(_e=Ee[this.pos++]))<<21,_e<128?ue:function(Ne,ze,De){var ot,$e,it=De.buf;if(ot=(112&($e=it[De.pos++]))>>4,$e<128||(ot|=(127&($e=it[De.pos++]))<<3,$e<128)||(ot|=(127&($e=it[De.pos++]))<<10,$e<128)||(ot|=(127&($e=it[De.pos++]))<<17,$e<128)||(ot|=(127&($e=it[De.pos++]))<<24,$e<128)||(ot|=(1&($e=it[De.pos++]))<<31,$e<128))return v(Ne,ot,ze);throw new Error("Expected varint not more than 10 bytes")}(ue|=(15&(_e=Ee[this.pos]))<<28,Q,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var Q=this.readVarint();return Q%2==1?(Q+1)/-2:Q/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var Q=this.readVarint()+this.pos,ue=this.pos;return this.pos=Q,Q-ue>=12&&g?function(_e,Ee,Ne){return g.decode(_e.subarray(Ee,Ne))}(this.buf,ue,Q):function(_e,Ee,Ne){for(var ze="",De=Ee;De<Ne;){var ot,$e,it,ft=_e[De],ut=null,mt=ft>239?4:ft>223?3:ft>191?2:1;if(De+mt>Ne)break;mt===1?ft<128&&(ut=ft):mt===2?(192&(ot=_e[De+1]))==128&&(ut=(31&ft)<<6|63&ot)<=127&&(ut=null):mt===3?($e=_e[De+2],(192&(ot=_e[De+1]))==128&&(192&$e)==128&&((ut=(15&ft)<<12|(63&ot)<<6|63&$e)<=2047||ut>=55296&&ut<=57343)&&(ut=null)):mt===4&&($e=_e[De+2],it=_e[De+3],(192&(ot=_e[De+1]))==128&&(192&$e)==128&&(192&it)==128&&((ut=(15&ft)<<18|(63&ot)<<12|(63&$e)<<6|63&it)<=65535||ut>=1114112)&&(ut=null)),ut===null?(ut=65533,mt=1):ut>65535&&(ut-=65536,ze+=String.fromCharCode(ut>>>10&1023|55296),ut=56320|1023&ut),ze+=String.fromCharCode(ut),De+=mt}return ze}(this.buf,ue,Q)},readBytes:function(){var Q=this.readVarint()+this.pos,ue=this.buf.subarray(this.pos,Q);return this.pos=Q,ue},readPackedVarint:function(Q,ue){if(this.type!==n.Bytes)return Q.push(this.readVarint(ue));var _e=h(this);for(Q=Q||[];this.pos<_e;)Q.push(this.readVarint(ue));return Q},readPackedSVarint:function(Q){if(this.type!==n.Bytes)return Q.push(this.readSVarint());var ue=h(this);for(Q=Q||[];this.pos<ue;)Q.push(this.readSVarint());return Q},readPackedBoolean:function(Q){if(this.type!==n.Bytes)return Q.push(this.readBoolean());var ue=h(this);for(Q=Q||[];this.pos<ue;)Q.push(this.readBoolean());return Q},readPackedFloat:function(Q){if(this.type!==n.Bytes)return Q.push(this.readFloat());var ue=h(this);for(Q=Q||[];this.pos<ue;)Q.push(this.readFloat());return Q},readPackedDouble:function(Q){if(this.type!==n.Bytes)return Q.push(this.readDouble());var ue=h(this);for(Q=Q||[];this.pos<ue;)Q.push(this.readDouble());return Q},readPackedFixed32:function(Q){if(this.type!==n.Bytes)return Q.push(this.readFixed32());var ue=h(this);for(Q=Q||[];this.pos<ue;)Q.push(this.readFixed32());return Q},readPackedSFixed32:function(Q){if(this.type!==n.Bytes)return Q.push(this.readSFixed32());var ue=h(this);for(Q=Q||[];this.pos<ue;)Q.push(this.readSFixed32());return Q},readPackedFixed64:function(Q){if(this.type!==n.Bytes)return Q.push(this.readFixed64());var ue=h(this);for(Q=Q||[];this.pos<ue;)Q.push(this.readFixed64());return Q},readPackedSFixed64:function(Q){if(this.type!==n.Bytes)return Q.push(this.readSFixed64());var ue=h(this);for(Q=Q||[];this.pos<ue;)Q.push(this.readSFixed64());return Q},skip:function(Q){var ue=7&Q;if(ue===n.Varint)for(;this.buf[this.pos++]>127;);else if(ue===n.Bytes)this.pos=this.readVarint()+this.pos;else if(ue===n.Fixed32)this.pos+=4;else{if(ue!==n.Fixed64)throw new Error("Unimplemented type: "+ue);this.pos+=8}},writeTag:function(Q,ue){this.writeVarint(Q<<3|ue)},realloc:function(Q){for(var ue=this.length||16;ue<this.pos+Q;)ue*=2;if(ue!==this.length){var _e=new Uint8Array(ue);_e.set(this.buf),this.buf=_e,this.length=ue}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(Q){this.realloc(4),re(this.buf,Q,this.pos),this.pos+=4},writeSFixed32:function(Q){this.realloc(4),re(this.buf,Q,this.pos),this.pos+=4},writeFixed64:function(Q){this.realloc(8),re(this.buf,-1&Q,this.pos),re(this.buf,Math.floor(Q*u),this.pos+4),this.pos+=8},writeSFixed64:function(Q){this.realloc(8),re(this.buf,-1&Q,this.pos),re(this.buf,Math.floor(Q*u),this.pos+4),this.pos+=8},writeVarint:function(Q){(Q=+Q||0)>268435455||Q<0?function(ue,_e){var Ee,Ne;if(ue>=0?(Ee=ue%4294967296|0,Ne=ue/4294967296|0):(Ne=~(-ue/4294967296),4294967295^(Ee=~(-ue%4294967296))?Ee=Ee+1|0:(Ee=0,Ne=Ne+1|0)),ue>=18446744073709552e3||ue<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");_e.realloc(10),function(ze,De,ot){ot.buf[ot.pos++]=127&ze|128,ze>>>=7,ot.buf[ot.pos++]=127&ze|128,ze>>>=7,ot.buf[ot.pos++]=127&ze|128,ze>>>=7,ot.buf[ot.pos++]=127&ze|128,ot.buf[ot.pos]=127&(ze>>>=7)}(Ee,0,_e),function(ze,De){var ot=(7&ze)<<4;De.buf[De.pos++]|=ot|((ze>>>=3)?128:0),ze&&(De.buf[De.pos++]=127&ze|((ze>>>=7)?128:0),ze&&(De.buf[De.pos++]=127&ze|((ze>>>=7)?128:0),ze&&(De.buf[De.pos++]=127&ze|((ze>>>=7)?128:0),ze&&(De.buf[De.pos++]=127&ze|((ze>>>=7)?128:0),ze&&(De.buf[De.pos++]=127&ze)))))}(Ne,_e)}(Q,this):(this.realloc(4),this.buf[this.pos++]=127&Q|(Q>127?128:0),Q<=127||(this.buf[this.pos++]=127&(Q>>>=7)|(Q>127?128:0),Q<=127||(this.buf[this.pos++]=127&(Q>>>=7)|(Q>127?128:0),Q<=127||(this.buf[this.pos++]=Q>>>7&127))))},writeSVarint:function(Q){this.writeVarint(Q<0?2*-Q-1:2*Q)},writeBoolean:function(Q){this.writeVarint(!!Q)},writeString:function(Q){Q=String(Q),this.realloc(4*Q.length),this.pos++;var ue=this.pos;this.pos=function(Ee,Ne,ze){for(var De,ot,$e=0;$e<Ne.length;$e++){if((De=Ne.charCodeAt($e))>55295&&De<57344){if(!ot){De>56319||$e+1===Ne.length?(Ee[ze++]=239,Ee[ze++]=191,Ee[ze++]=189):ot=De;continue}if(De<56320){Ee[ze++]=239,Ee[ze++]=191,Ee[ze++]=189,ot=De;continue}De=ot-55296<<10|De-56320|65536,ot=null}else ot&&(Ee[ze++]=239,Ee[ze++]=191,Ee[ze++]=189,ot=null);De<128?Ee[ze++]=De:(De<2048?Ee[ze++]=De>>6|192:(De<65536?Ee[ze++]=De>>12|224:(Ee[ze++]=De>>18|240,Ee[ze++]=De>>12&63|128),Ee[ze++]=De>>6&63|128),Ee[ze++]=63&De|128)}return ze}(this.buf,Q,this.pos);var _e=this.pos-ue;_e>=128&&T(ue,_e,this),this.pos=ue-1,this.writeVarint(_e),this.pos+=_e},writeFloat:function(Q){this.realloc(4),c.write(this.buf,Q,this.pos,!0,23,4),this.pos+=4},writeDouble:function(Q){this.realloc(8),c.write(this.buf,Q,this.pos,!0,52,8),this.pos+=8},writeBytes:function(Q){var ue=Q.length;this.writeVarint(ue),this.realloc(ue);for(var _e=0;_e<ue;_e++)this.buf[this.pos++]=Q[_e]},writeRawMessage:function(Q,ue){this.pos++;var _e=this.pos;Q(ue,this);var Ee=this.pos-_e;Ee>=128&&T(_e,Ee,this),this.pos=_e-1,this.writeVarint(Ee),this.pos+=Ee},writeMessage:function(Q,ue,_e){this.writeTag(Q,n.Bytes),this.writeRawMessage(ue,_e)},writePackedVarint:function(Q,ue){ue.length&&this.writeMessage(Q,A,ue)},writePackedSVarint:function(Q,ue){ue.length&&this.writeMessage(Q,D,ue)},writePackedBoolean:function(Q,ue){ue.length&&this.writeMessage(Q,L,ue)},writePackedFloat:function(Q,ue){ue.length&&this.writeMessage(Q,x,ue)},writePackedDouble:function(Q,ue){ue.length&&this.writeMessage(Q,P,ue)},writePackedFixed32:function(Q,ue){ue.length&&this.writeMessage(Q,I,ue)},writePackedSFixed32:function(Q,ue){ue.length&&this.writeMessage(Q,R,ue)},writePackedFixed64:function(Q,ue){ue.length&&this.writeMessage(Q,V,ue)},writePackedSFixed64:function(Q,ue){ue.length&&this.writeMessage(Q,W,ue)},writeBytesField:function(Q,ue){this.writeTag(Q,n.Bytes),this.writeBytes(ue)},writeFixed32Field:function(Q,ue){this.writeTag(Q,n.Fixed32),this.writeFixed32(ue)},writeSFixed32Field:function(Q,ue){this.writeTag(Q,n.Fixed32),this.writeSFixed32(ue)},writeFixed64Field:function(Q,ue){this.writeTag(Q,n.Fixed64),this.writeFixed64(ue)},writeSFixed64Field:function(Q,ue){this.writeTag(Q,n.Fixed64),this.writeSFixed64(ue)},writeVarintField:function(Q,ue){this.writeTag(Q,n.Varint),this.writeVarint(ue)},writeSVarintField:function(Q,ue){this.writeTag(Q,n.Varint),this.writeSVarint(ue)},writeStringField:function(Q,ue){this.writeTag(Q,n.Bytes),this.writeString(ue)},writeFloatField:function(Q,ue){this.writeTag(Q,n.Fixed32),this.writeFloat(ue)},writeDoubleField:function(Q,ue){this.writeTag(Q,n.Fixed64),this.writeDouble(ue)},writeBooleanField:function(Q,ue){this.writeVarintField(Q,!!ue)}},jw}var F0=S(UI());const Gw=3;function H5(c,n,s){n.glyphs=[],c===1&&s.readMessage(G5,n)}function G5(c,n,s){if(c===3){const{id:u,bitmap:g,width:h,height:v,left:T,top:A,advance:D}=s.readMessage(W5,{});n.glyphs.push({id:u,bitmap:new bd({width:h+2*Gw,height:v+2*Gw},g),metrics:{width:h,height:v,left:T,top:A,advance:D}})}else c===4?n.ascender=s.readSVarint():c===5&&(n.descender=s.readSVarint())}function W5(c,n,s){c===1?n.id=s.readVarint():c===2?n.bitmap=s.readBytes():c===3?n.width=s.readVarint():c===4?n.height=s.readVarint():c===5?n.left=s.readSVarint():c===6?n.top=s.readSVarint():c===7&&(n.advance=s.readVarint())}const q5=Gw,Ba={horizontal:1,vertical:2,horizontalOnly:3};class Dv{constructor(){this.scale=1,this.fontStack="",this.image=null}static forText(n,s){const u=new Dv;return u.scale=n||1,u.fontStack=s,u}static forImage(n){const s=new Dv;return s.image=n,s}}class Np{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(n,s){const u=new Np;for(let g=0;g<n.sections.length;g++){const h=n.sections[g];h.image?u.addImageSection(h):u.addTextSection(h,s)}return u}length(){return this.text.length}getSection(n){return this.sections[this.sectionIndex[n]]}getSections(){return this.sections}getSectionIndex(n){return this.sectionIndex[n]}getCodePoint(n){return this.text.codePointAt(n)}verticalizePunctuation(n){this.text=function(s,u){let g="";for(let h=0;h<s.length;h++){const v=s.charCodeAt(h+1)||null,T=s.charCodeAt(h-1)||null;g+=!u&&(v&&Zg(v)&&!Lv[s[h+1]]||T&&Zg(T)&&!Lv[s[h-1]])||!Lv[s[h]]?s[h]:Lv[s[h]]}return g}(this.text,n)}trim(){let n=0;for(let u=0;u<this.text.length&&N0[this.text.charCodeAt(u)];u++)n++;let s=this.text.length;for(let u=this.text.length-1;u>=0&&u>=n&&N0[this.text.charCodeAt(u)];u--)s--;this.text=this.text.substring(n,s),this.sectionIndex=this.sectionIndex.slice(n,s)}substring(n,s){const u=new Np;return u.text=this.text.substring(n,s),u.sectionIndex=this.sectionIndex.slice(n,s),u.sections=this.sections,u}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((n,s)=>Math.max(n,this.sections[s].scale),0)}addTextSection(n,s){this.text+=n.text,this.sections.push(Dv.forText(n.scale,n.fontStack||s));const u=this.sections.length-1;for(let g=0;g<n.text.length;++g)this.sectionIndex.push(u)}addImageSection(n){const s=n.image&&n.image.namePrimary?n.image.getPrimary():null;if(!s)return void wn("Can't add FormattedSection with an empty image.");const u=this.getNextImageSectionCharCode();u?(this.text+=String.fromCodePoint(u),this.sections.push(Dv.forImage(s)),this.sectionIndex.push(this.sections.length-1)):wn("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function Ww(c,n,s,u,g,h,v,T,A,D,x,P,L,I,R){const V=Np.fromFeature(c,g);P===Ba.vertical&&V.verticalizePunctuation(L);let W=[];const K=function(_e,Ee,Ne,ze,De,ot){if(!_e)return[];const $e=[],it=function(xt,At,_t,Zt,hn,Kt){let kn=0;for(let Mn=0;Mn<xt.length();Mn++){const _n=xt.getSection(Mn);kn+=jI(xt.getCodePoint(Mn),_n,Zt,hn,At,Kt)}return kn/Math.max(1,Math.ceil(kn/_t))}(_e,Ee,Ne,ze,De,ot),ft=_e.text.indexOf("")>=0;let ut=0;for(let xt=0;xt<_e.length();xt++){const At=_e.getSection(xt),_t=_e.getCodePoint(xt);if(N0[_t]||(ut+=jI(_t,At,ze,De,Ee,ot)),xt<_e.length()-1){const Zt=!((mt=_t)<11904||!(Xn["Bopomofo Extended"](mt)||Xn.Bopomofo(mt)||Xn["CJK Compatibility Forms"](mt)||Xn["CJK Compatibility Ideographs"](mt)||Xn["CJK Compatibility"](mt)||Xn["CJK Radicals Supplement"](mt)||Xn["CJK Strokes"](mt)||Xn["CJK Symbols and Punctuation"](mt)||Xn["CJK Unified Ideographs Extension A"](mt)||Xn["CJK Unified Ideographs"](mt)||Xn["Enclosed CJK Letters and Months"](mt)||Xn["Halfwidth and Fullwidth Forms"](mt)||Xn.Hiragana(mt)||Xn["Ideographic Description Characters"](mt)||Xn["Kangxi Radicals"](mt)||Xn["Katakana Phonetic Extensions"](mt)||Xn.Katakana(mt)||Xn["Vertical Forms"](mt)||Xn["Yi Radicals"](mt)||Xn["Yi Syllables"](mt)));(K5[_t]||Zt||At.image)&&$e.push(GI(xt+1,ut,it,$e,Z5(_t,_e.getCodePoint(xt+1),Zt&&ft),!1))}}var mt;return WI(GI(_e.length(),ut,it,$e,0,!0))}(V,D,h,n,u,I),{processBidirectionalText:re,processStyledBidirectionalText:ie}=qs;if(re&&V.sections.length===1){const _e=re(V.toString(),K);for(const Ee of _e){const Ne=new Np;Ne.text=Ee,Ne.sections=V.sections;for(let ze=0;ze<Ee.length;ze++)Ne.sectionIndex.push(0);W.push(Ne)}}else if(ie){const _e=ie(V.text,V.sectionIndex,K);for(const Ee of _e){const Ne=new Np;Ne.text=Ee[0],Ne.sectionIndex=Ee[1],Ne.sections=V.sections,W.push(Ne)}}else W=function(_e,Ee){const Ne=[],ze=_e.text;let De=0;for(const ot of Ee)Ne.push(_e.substring(De,ot)),De=ot;return De<ze.length&&Ne.push(_e.substring(De,ze.length)),Ne}(V,K);const Q=[],ue={positionedLines:Q,text:V.toString(),top:x[1],bottom:x[1],left:x[0],right:x[0],writingMode:P,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(_e,Ee,Ne,ze,De,ot,$e,it,ft,ut,mt,xt){let At=0,_t=0,Zt=0;const hn=it==="right"?1:it==="left"?0:.5;let Kt=!1;for(const Rn of De){const Fn=Rn.getSections();for(const pr of Fn){if(pr.image)continue;const Ir=Ee[pr.fontStack];if(Ir&&(Kt=Ir.ascender!==void 0&&Ir.descender!==void 0,!Kt))break}if(!Kt)break}let kn=0;for(const Rn of De){Rn.trim();const Fn=Rn.getMaxScale(),pr=(Fn-1)*ts,Ir={positionedGlyphs:[],lineOffset:0};_e.positionedLines[kn]=Ir;const Ar=Ir.positionedGlyphs;let kr=0;if(!Rn.length()){_t+=ot,++kn;continue}let Nr=0,Vr=0;for(let go=0;go<Rn.length();go++){const xr=Rn.getSection(go),uo=Rn.getSectionIndex(go),fo=Rn.getCodePoint(go);let $o=xr.scale,ai=null,Si=null,li=null,Xo=ts,mi=0;const Mi=!(ft===Ba.horizontal||!mt&&!mp(fo)||mt&&(N0[fo]||(Mn=fo,Xn.Arabic(Mn)||Xn["Arabic Supplement"](Mn)||Xn["Arabic Extended-A"](Mn)||Xn["Arabic Presentation Forms-A"](Mn)||Xn["Arabic Presentation Forms-B"](Mn))));if(xr.image){const ns=ze[xr.image.serialize()];if(!ns)continue;li=xr.image.id,_e.iconsInText=_e.iconsInText||!0,Si=ns.paddedRect;const Bo=ns.displaySize;$o=$o*ts/xt,ai={width:Bo[0],height:Bo[1],left:0,top:-3,advance:Mi?Bo[1]:Bo[0],localGlyph:!1},mi=Kt?-ai.height*$o:Fn*ts-17-Bo[1]*$o,Xo=ai.advance;const Js=(Mi?Bo[0]:Bo[1])*$o-ts*Fn;Js>0&&Js>kr&&(kr=Js)}else{const ns=Ne[xr.fontStack];if(!ns)continue;ns[fo]&&(Si=ns[fo]);const Bo=Ee[xr.fontStack];if(!Bo)continue;const Js=Bo.glyphs[fo];if(!Js)continue;if(ai=Js.metrics,Xo=fo!==8203?ts:0,Kt){const ql=Bo.ascender!==void 0?Math.abs(Bo.ascender):0,pl=Bo.descender!==void 0?Math.abs(Bo.descender):0,ml=(ql+pl)*$o;Nr<ml&&(Nr=ml,Vr=(ql-pl)/2*$o),mi=-ql*$o}else mi=(Fn-$o)*ts-17}Mi?(_e.verticalizable=!0,Ar.push({glyph:fo,imageName:li,x:At,y:_t+mi,vertical:Mi,scale:$o,localGlyph:ai.localGlyph,fontStack:xr.fontStack,sectionIndex:uo,metrics:ai,rect:Si}),At+=Xo*$o+ut):(Ar.push({glyph:fo,imageName:li,x:At,y:_t+mi,vertical:Mi,scale:$o,localGlyph:ai.localGlyph,fontStack:xr.fontStack,sectionIndex:uo,metrics:ai,rect:Si}),At+=ai.advance*$o+ut)}Ar.length!==0&&(Zt=Math.max(At-ut,Zt),Kt?qI(Ar,hn,kr,Vr,ot*Fn/2):qI(Ar,hn,kr,0,ot/2)),At=0;const ko=ot*Fn+kr;Ir.lineOffset=Math.max(kr,pr),_t+=ko,++kn}var Mn;const _n=_t,{horizontalAlign:mn,verticalAlign:Zn}=qw($e);(function(Rn,Fn,pr,Ir,Ar,kr){const Nr=(Fn-pr)*Ar,Vr=-kr*Ir;for(const ko of Rn)for(const go of ko.positionedGlyphs)go.x+=Nr,go.y+=Vr})(_e.positionedLines,hn,mn,Zn,Zt,_n),_e.top+=-Zn*_n,_e.bottom=_e.top+_n,_e.left+=-mn*Zt,_e.right=_e.left+Zt,_e.hasBaseline=Kt}(ue,n,s,u,W,v,T,A,P,D,L,R),!function(_e){for(const Ee of _e)if(Ee.positionedGlyphs.length!==0)return!1;return!0}(Q)&&ue}const N0={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},K5={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function jI(c,n,s,u,g,h){if(n.image){const v=u[n.image.serialize()];return v?v.displaySize[0]*n.scale*ts/h+g:0}{const v=s[n.fontStack],T=v&&v.glyphs[c];return T?T.metrics.advance*n.scale+g:0}}function HI(c,n,s,u){const g=Math.pow(c-n,2);return u?c<n?g/2:2*g:g+Math.abs(s)*s}function Z5(c,n,s){let u=0;return c===10&&(u-=1e4),s&&(u+=150),c!==40&&c!==65288||(u+=50),n!==41&&n!==65289||(u+=50),u}function GI(c,n,s,u,g,h){let v=null,T=HI(n,s,g,h);for(const A of u){const D=HI(n-A.x,s,g,h)+A.badness;D<=T&&(v=A,T=D)}return{index:c,x:n,priorBreak:v,badness:T}}function WI(c){return c?WI(c.priorBreak).concat(c.index):[]}function qw(c){let n=.5,s=.5;switch(c){case"right":case"top-right":case"bottom-right":n=1;break;case"left":case"top-left":case"bottom-left":n=0}switch(c){case"bottom":case"bottom-right":case"bottom-left":s=1;break;case"top":case"top-right":case"top-left":s=0}return{horizontalAlign:n,verticalAlign:s}}function qI(c,n,s,u,g){if(!(n||s||u||g))return;const h=c.length-1,v=c[h],T=(v.x+v.metrics.advance*v.scale)*n;for(let A=0;A<=h;A++)c[A].x-=T,c[A].y+=s+u+g}function Y5(c,n,s,u){const{horizontalAlign:g,verticalAlign:h}=qw(u),v=s[0]-c.displaySize[0]*g,T=s[1]-c.displaySize[1]*h;return{imagePrimary:c,imageSecondary:n,top:T,bottom:T+c.displaySize[1],left:v,right:v+c.displaySize[0]}}function KI(c,n,s,u,g,h){const v=c.imagePrimary;let T;if(v.content){const W=v.content,K=v.pixelRatio||1;T=[W[0]/K,W[1]/K,v.displaySize[0]-W[2]/K,v.displaySize[1]-W[3]/K]}const A=n.left*h,D=n.right*h;let x,P,L,I;s==="width"||s==="both"?(I=g[0]+A-u[3],P=g[0]+D+u[1]):(I=g[0]+(A+D-v.displaySize[0])/2,P=I+v.displaySize[0]);const R=n.top*h,V=n.bottom*h;return s==="height"||s==="both"?(x=g[1]+R-u[0],L=g[1]+V+u[2]):(x=g[1]+(R+V-v.displaySize[1])/2,L=x+v.displaySize[1]),{imagePrimary:v,imageSecondary:void 0,top:x,right:P,bottom:L,left:I,collisionPadding:T}}class Su extends Qe{constructor(n,s,u,g,h){super(n,s),this.angle=g,this.z=u,h!==void 0&&(this.segment=h)}clone(){return new Su(this.x,this.y,this.z,this.angle,this.segment)}}function ZI(c,n,s,u,g){if(n.segment===void 0)return!0;let h=n,v=n.segment+1,T=0;for(;T>-s/2;){if(v--,v<0)return!1;T-=c[v].dist(h),h=c[v]}T+=c[v].dist(c[v+1]),v++;const A=[];let D=0;for(;T<s/2;){const x=c[v],P=c[v+1];if(!P)return!1;let L=c[v-1].angleTo(x)-x.angleTo(P);for(L=Math.abs((L+3*Math.PI)%(2*Math.PI)-Math.PI),A.push({distance:T,angleDelta:L}),D+=L;T-A[0].distance>u;)D-=A.shift().angleDelta;if(D>g)return!1;v++,T+=x.dist(P)}return!0}function YI(c){let n=0;for(let s=0;s<c.length-1;s++)n+=c[s].dist(c[s+1]);return n}function XI(c,n,s){return c?.6*n*s:0}function JI(c,n){return Math.max(c?c.right-c.left:0,n?n.right-n.left:0)}function X5(c,n,s,u,g,h){const v=XI(s,g,h),T=JI(s,u)*h;let A=0;const D=YI(c)/2;for(let x=0;x<c.length-1;x++){const P=c[x],L=c[x+1],I=P.dist(L);if(A+I>D){const R=(D-A)/I,V=cr(P.x,L.x,R),W=cr(P.y,L.y,R),K=new Su(V,W,0,L.angleTo(P),x);return!v||ZI(c,K,T,v,n)?K:void 0}A+=I}}function J5(c,n,s,u,g,h,v,T,A){const D=XI(u,h,v),x=JI(u,g),P=x*v,L=c[0].x===0||c[0].x===A||c[0].y===0||c[0].y===A;return n-P<n/4&&(n=P+n/4),QI(c,L?n/2*T%n:(x/2+2*h)*v*T%n,n,D,s,P,L,!1,A)}function QI(c,n,s,u,g,h,v,T,A){const D=h/2,x=YI(c);let P=0,L=n-s,I=[];for(let R=0;R<c.length-1;R++){const V=c[R],W=c[R+1],K=V.dist(W),re=W.angleTo(V);for(;L+s<P+K;){L+=s;const ie=(L-P)/K,Q=cr(V.x,W.x,ie),ue=cr(V.y,W.y,ie);if(Q>=0&&Q<A&&ue>=0&&ue<A&&L-D>=0&&L+D<=x){const _e=new Su(Q,ue,0,re,R);u&&!ZI(c,_e,h,u,g)||I.push(_e)}}P+=K}return T||I.length||v||(I=QI(c,P/2,s,u,g,h,v,!0,A)),I}function eA(c,n,s,u,g){const h=[];for(let v=0;v<c.length;v++){const T=c[v];let A;for(let D=0;D<T.length-1;D++){let x=T[D],P=T[D+1];x.x<n&&P.x<n||(x.x<n?x=new Qe(n,x.y+(n-x.x)/(P.x-x.x)*(P.y-x.y))._round():P.x<n&&(P=new Qe(n,x.y+(n-x.x)/(P.x-x.x)*(P.y-x.y))._round()),x.y<s&&P.y<s||(x.y<s?x=new Qe(x.x+(s-x.y)/(P.y-x.y)*(P.x-x.x),s)._round():P.y<s&&(P=new Qe(x.x+(s-x.y)/(P.y-x.y)*(P.x-x.x),s)._round()),x.x>=u&&P.x>=u||(x.x>=u?x=new Qe(u,x.y+(u-x.x)/(P.x-x.x)*(P.y-x.y))._round():P.x>=u&&(P=new Qe(u,x.y+(u-x.x)/(P.x-x.x)*(P.y-x.y))._round()),x.y>=g&&P.y>=g||(x.y>=g?x=new Qe(x.x+(g-x.y)/(P.y-x.y)*(P.x-x.x),g)._round():P.y>=g&&(P=new Qe(x.x+(g-x.y)/(P.y-x.y)*(P.x-x.x),g)._round()),A&&x.equals(A[A.length-1])||(A=[x],h.push(A)),A.push(P)))))}}return h}function tA(c){let n=0,s=0;for(const v of c)n+=v.w*v.h,s=Math.max(s,v.w);c.sort((v,T)=>T.h-v.h);const u=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(n/.95)),s),h:1/0}];let g=0,h=0;for(const v of c)for(let T=u.length-1;T>=0;T--){const A=u[T];if(!(v.w>A.w||v.h>A.h)){if(v.x=A.x,v.y=A.y,h=Math.max(h,v.y+v.h),g=Math.max(g,v.x+v.w),v.w===A.w&&v.h===A.h){const D=u.pop();T<u.length&&(u[T]=D)}else v.h===A.h?(A.x+=v.w,A.w-=v.w):v.w===A.w?(A.y+=v.h,A.h-=v.h):(u.push({x:A.x+v.w,y:A.y,w:A.w-v.w,h:v.h}),A.y+=v.h,A.h-=v.h);break}}return{w:g,h,fill:n/(g*h)||0}}Hn(Su,"Anchor");const zv=1;class Fv{static getImagePositionScale(n,s,u){return s&&n&&n.options&&n.options.transform?{x:n.options.transform.a,y:n.options.transform.d}:{x:u,y:u}}constructor(n,{pixelRatio:s,version:u,stretchX:g,stretchY:h,content:v,sdf:T,usvg:A},D,x){this.paddedRect=n,this.pixelRatio=s,this.stretchX=g,this.stretchY=h,this.content=v,this.version=u,this.padding=D,this.sdf=T,this.scale=Fv.getImagePositionScale(x,A,s)}get tl(){return[this.paddedRect.x+this.padding,this.paddedRect.y+this.padding]}get br(){return[this.paddedRect.x+this.paddedRect.w-this.padding,this.paddedRect.y+this.paddedRect.h-this.padding]}get displaySize(){return[(this.paddedRect.w-2*this.padding)/this.scale.x,(this.paddedRect.h-2*this.padding)/this.scale.y]}}class nA{constructor(n,s,u){const g={},h={};this.haveRenderCallbacks=[];const v=[];this.addImages(n,g,zv,v),this.addImages(s,h,2,v);const{w:T,h:A}=tA(v),D=new qi({width:T||1,height:A||1});for(const x in n){const P=n[x],L=g[x].paddedRect;qi.copy(P.data,D,{x:0,y:0},{x:L.x+zv,y:L.y+zv},P.data,u,P.sdf)}for(const x in s){const P=s[x],L=h[x].paddedRect;let I=h[x].padding;const R=L.x+I,V=L.y+I,W=P.data.width,K=P.data.height;I=I>1?I-1:I,qi.copy(P.data,D,{x:0,y:0},{x:R,y:V},P.data,u),qi.copy(P.data,D,{x:0,y:K-I},{x:R,y:V-I},{width:W,height:I},u),qi.copy(P.data,D,{x:0,y:0},{x:R,y:V+K},{width:W,height:I},u),qi.copy(P.data,D,{x:W-I,y:0},{x:R-I,y:V},{width:I,height:K},u),qi.copy(P.data,D,{x:0,y:0},{x:R+W,y:V},{width:I,height:K},u),qi.copy(P.data,D,{x:W-I,y:K-I},{x:R-I,y:V-I},{width:I,height:I},u),qi.copy(P.data,D,{x:0,y:K-I},{x:R+W,y:V-I},{width:I,height:I},u),qi.copy(P.data,D,{x:0,y:0},{x:R+W,y:V+K},{width:I,height:I},u),qi.copy(P.data,D,{x:W-I,y:0},{x:R-I,y:V+K},{width:I,height:I},u)}this.lut=u,this.image=D,this.iconPositions=g,this.patternPositions=h}addImages(n,s,u,g){for(const h in n){const v=n[h],T={x:0,y:0,w:v.data.width+2*u,h:v.data.height+2*u};g.push(T);const A=ol.deserializeFromString(h);s[h]=new Fv(T,v,u,A),v.hasRenderCallback&&this.haveRenderCallbacks.push(A.id)}}patchUpdatedImages(n,s,u){this.haveRenderCallbacks=this.haveRenderCallbacks.filter(g=>n.hasImage(g,u)),n.dispatchRenderCallbacks(this.haveRenderCallbacks,u);for(const g in n.getUpdatedImages(u)){for(const h of Object.keys(this.iconPositions))ol.deserializeId(h)===g&&this.patchUpdatedImage(this.iconPositions[h],n.getImage(g,u),s);for(const h of Object.keys(this.patternPositions))ol.deserializeId(h)===g&&this.patchUpdatedImage(this.patternPositions[h],n.getImage(g,u),s)}}patchUpdatedImage(n,s,u){if(!n||!s||n.version===s.version)return;n.version=s.version;const[g,h]=n.tl,v=n.sdf;if(this.lut||v){const T={width:s.data.width,height:s.data.height},A=new qi(T);qi.copy(s.data,A,{x:0,y:0},{x:0,y:0},T,this.lut,v),u.update(A,{position:{x:g,y:h}})}else u.update(s.data,{position:{x:g,y:h}})}}Hn(Fv,"ImagePosition"),Hn(nA,"ImageAtlas");const B0=1e20;function rA(c,n,s,u,g,h,v,T,A){for(let D=n;D<n+u;D++)oA(c,s*h+D,h,g,v,T,A);for(let D=s;D<s+g;D++)oA(c,D*h+n,1,u,v,T,A)}function oA(c,n,s,u,g,h,v){h[0]=0,v[0]=-1e20,v[1]=B0,g[0]=c[n];for(let T=1,A=0,D=0;T<u;T++){g[T]=c[n+T*s];const x=T*T;do{const P=h[A];D=(g[T]-g[P]+x-P*P)/(T-P)/2}while(D<=v[A]&&--A>-1);A++,h[A]=T,v[A]=D,v[A+1]=B0}for(let T=0,A=0;T<u;T++){for(;v[A+1]<T;)A++;const D=h[A],x=T-D;c[n+T*s]=g[D]+x*x}}const jl=2,Kw={none:0,ideographs:1,all:2};class Bp{constructor(n,s,u){this.requestManager=n,this.localGlyphMode=s,this.localFontFamily=u,this.urls={},this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(n,s){this.urls[s]=n}getGlyphs(n,s,u){const g=[],h=this.urls[s]||Jo.GLYPHS_URL;for(const v in n)for(const T of n[v])g.push({stack:v,id:T});vr(g,({stack:v,id:T},A)=>{let D=this.entries[v];D||(D=this.entries[v]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let x=D.glyphs[T];if(x!==void 0)return void A(null,{stack:v,id:T,glyph:x});if(x=this._tinySDF(D,v,T),x)return D.glyphs[T]=x,void A(null,{stack:v,id:T,glyph:x});const P=Math.floor(T/256);if(256*P>65535)return wn("glyphs > 65535 not supported"),void A(null,{stack:v,id:T,glyph:x});if(D.ranges[P])return void A(null,{stack:v,id:T,glyph:x});let L=D.requests[P];L||(L=D.requests[P]=[],Bp.loadGlyphRange(v,P,h,this.requestManager,(I,R)=>{if(R){D.ascender=R.ascender,D.descender=R.descender;for(const V in R.glyphs)this._doesCharSupportLocalGlyph(+V)||(D.glyphs[+V]=R.glyphs[+V]);D.ranges[P]=!0}for(const V of L)V(I,R);delete D.requests[P]})),L.push((I,R)=>{I?A(I):R&&A(null,{stack:v,id:T,glyph:R.glyphs[T]||null})})},(v,T)=>{if(v)u(v);else if(T){const A={};for(const{stack:D,id:x,glyph:P}of T)A[D]===void 0&&(A[D]={}),A[D].glyphs===void 0&&(A[D].glyphs={}),A[D].glyphs[x]=P&&{id:P.id,bitmap:P.bitmap.clone(),metrics:P.metrics},A[D].ascender=this.entries[D].ascender,A[D].descender=this.entries[D].descender;u(null,A)}})}_doesCharSupportLocalGlyph(n){return this.localGlyphMode!==Kw.none&&(this.localGlyphMode===Kw.all?!!this.localFontFamily:!!this.localFontFamily&&(Xn["CJK Unified Ideographs"](n)||Xn["Hangul Syllables"](n)||Xn.Hiragana(n)||Xn.Katakana(n)||Xn["CJK Symbols and Punctuation"](n)||Xn["CJK Unified Ideographs Extension A"](n)||Xn["CJK Unified Ideographs Extension B"](n)||Xn.Osage(n)))}_tinySDF(n,s,u){const g=this.localFontFamily;if(!g||!this._doesCharSupportLocalGlyph(u))return;let h=n.tinySDF;if(!h){let V="400";/bold/i.test(s)?V="900":/medium/i.test(s)?V="500":/light/i.test(s)&&(V="200"),h=n.tinySDF=new Bp.TinySDF({fontFamily:g,fontWeight:V,fontSize:24*jl,buffer:3*jl,radius:8*jl}),h.fontWeight=V}if(this.localGlyphs[h.fontWeight][u])return this.localGlyphs[h.fontWeight][u];const v=String.fromCodePoint(u),{data:T,width:A,height:D,glyphWidth:x,glyphHeight:P,glyphLeft:L,glyphTop:I,glyphAdvance:R}=h.draw(v);return this.localGlyphs[h.fontWeight][u]={id:u,bitmap:new bd({width:A,height:D},T),metrics:{width:x/jl,height:P/jl,left:L/jl,top:I/jl-27,advance:R/jl,localGlyph:!0}}}}Bp.loadGlyphRange=function(c,n,s,u,g){const h=256*n,v=h+255,T=u.transformRequest(u.normalizeGlyphsURL(s).replace("{fontstack}",c).replace("{range}",`${h}-${v}`),Jr.Glyphs);ki(T,(A,D)=>{if(A)g(A);else if(D){const x={},P=function(L){return new F0(L).readFields(H5,{})}(D);for(const L of P.glyphs)x[L.id]=L;g(null,{glyphs:x,ascender:P.ascender,descender:P.descender})}})},Bp.TinySDF=class{constructor({fontSize:c=24,buffer:n=3,radius:s=8,cutoff:u=.25,fontFamily:g="sans-serif",fontWeight:h="normal",fontStyle:v="normal"}={}){this.buffer=n,this.cutoff=u,this.radius=s;const T=this.size=c+4*n,A=this._createCanvas(T),D=this.ctx=A.getContext("2d",{willReadFrequently:!0});D.font=`${v} ${h} ${c}px ${g}`,D.textBaseline="alphabetic",D.textAlign="left",D.fillStyle="black",this.gridOuter=new Float64Array(T*T),this.gridInner=new Float64Array(T*T),this.f=new Float64Array(T),this.z=new Float64Array(T+1),this.v=new Uint16Array(T)}_createCanvas(c){const n=document.createElement("canvas");return n.width=n.height=c,n}draw(c){const{width:n,actualBoundingBoxAscent:s,actualBoundingBoxDescent:u,actualBoundingBoxLeft:g,actualBoundingBoxRight:h}=this.ctx.measureText(c),v=Math.ceil(s),T=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(h-g))),A=Math.min(this.size-this.buffer,v+Math.ceil(u)),D=T+2*this.buffer,x=A+2*this.buffer,P=Math.max(D*x,0),L=new Uint8ClampedArray(P),I={data:L,width:D,height:x,glyphWidth:T,glyphHeight:A,glyphTop:v,glyphLeft:0,glyphAdvance:n};if(T===0||A===0)return I;const{ctx:R,buffer:V,gridInner:W,gridOuter:K}=this;R.clearRect(V,V,T,A),R.fillText(c,V,V+v);const re=R.getImageData(V,V,T,A);K.fill(B0,0,P),W.fill(0,0,P);for(let ie=0;ie<A;ie++)for(let Q=0;Q<T;Q++){const ue=re.data[4*(ie*T+Q)+3]/255;if(ue===0)continue;const _e=(ie+V)*D+Q+V;if(ue===1)K[_e]=0,W[_e]=B0;else{const Ee=.5-ue;K[_e]=Ee>0?Ee*Ee:0,W[_e]=Ee<0?Ee*Ee:0}}rA(K,0,0,D,x,D,this.f,this.v,this.z),rA(W,V,V,T,A,D,this.f,this.v,this.z);for(let ie=0;ie<P;ie++){const Q=Math.sqrt(K[ie])-Math.sqrt(W[ie]);L[ie]=Math.round(255-255*(Q/this.radius+this.cutoff))}return I}};const Qh=zv;function iA(c,n){return c+n[1]-n[0]}function sA(c,n,s,u,g=1){const h=[],v=c.imagePrimary,T=v.pixelRatio,A=v.paddedRect.w-2*Qh,D=v.paddedRect.h-2*Qh,x=(c.right-c.left)*g,P=(c.bottom-c.top)*g,L=v.stretchX||[[0,A]],I=v.stretchY||[[0,D]],R=L.reduce(iA,0),V=I.reduce(iA,0),W=A-R,K=D-V;let re=0,ie=R,Q=0,ue=V,_e=0,Ee=W,Ne=0,ze=K;if(v.content&&u){const ot=v.content;re=V0(L,0,ot[0]),Q=V0(I,0,ot[1]),ie=V0(L,ot[0],ot[2]),ue=V0(I,ot[1],ot[3]),_e=ot[0]-re,Ne=ot[1]-Q,Ee=ot[2]-ot[0]-ie,ze=ot[3]-ot[1]-ue}const De=(ot,$e,it,ft)=>{const ut=$0(ot.stretch-re,ie,x,c.left*g),mt=U0(ot.fixed-_e,Ee,ot.stretch,R),xt=$0($e.stretch-Q,ue,P,c.top*g),At=U0($e.fixed-Ne,ze,$e.stretch,V),_t=$0(it.stretch-re,ie,x,c.left*g),Zt=U0(it.fixed-_e,Ee,it.stretch,R),hn=$0(ft.stretch-Q,ue,P,c.top*g),Kt=U0(ft.fixed-Ne,ze,ft.stretch,V),kn=new Qe(ut,xt),Mn=new Qe(_t,xt),_n=new Qe(_t,hn),mn=new Qe(ut,hn),Zn=new Qe(mt/T,At/T),Rn=new Qe(Zt/T,Kt/T),Fn=n*Math.PI/180;if(Fn){const Vr=Math.sin(Fn),ko=Math.cos(Fn),go=[ko,-Vr,Vr,ko];kn._matMult(go),Mn._matMult(go),mn._matMult(go),_n._matMult(go)}const pr=ot.stretch+ot.fixed,Ir=it.stretch+it.fixed,Ar=$e.stretch+$e.fixed,kr=ft.stretch+ft.fixed,Nr=c.imageSecondary;return{tl:kn,tr:Mn,bl:mn,br:_n,texPrimary:{x:v.paddedRect.x+Qh+pr,y:v.paddedRect.y+Qh+Ar,w:Ir-pr,h:kr-Ar},texSecondary:Nr?{x:Nr.paddedRect.x+Qh+pr,y:Nr.paddedRect.y+Qh+Ar,w:Ir-pr,h:kr-Ar}:void 0,writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Zn,pixelOffsetBR:Rn,minFontScaleX:Ee/T/x,minFontScaleY:ze/T/P,isSDF:s}};if(u&&(v.stretchX||v.stretchY)){const ot=aA(L,W,R),$e=aA(I,K,V);for(let it=0;it<ot.length-1;it++){const ft=ot[it],ut=ot[it+1];for(let mt=0;mt<$e.length-1;mt++)h.push(De(ft,$e[mt],ut,$e[mt+1]))}}else h.push(De({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:A+1},{fixed:0,stretch:D+1}));return h}function V0(c,n,s){let u=0;for(const g of c)u+=Math.max(n,Math.min(s,g[1]))-Math.max(n,Math.min(s,g[0]));return u}function aA(c,n,s){const u=[{fixed:-1,stretch:0}];for(const[g,h]of c){const v=u[u.length-1];u.push({fixed:g-v.stretch,stretch:v.stretch}),u.push({fixed:g-v.stretch,stretch:v.stretch+(h-g)})}return u.push({fixed:n+Qh,stretch:s}),u}function $0(c,n,s,u){return c/n*s+u}function U0(c,n,s,u){return c-n*s/u}function Q5(c,n,s,u){const g=n+c.positionedLines[u].lineOffset;return u===0?s+g/2:s+(g+(n+c.positionedLines[u-1].lineOffset))/2}function eV(c,n=1,s=!1){let u=1/0,g=1/0,h=-1/0,v=-1/0;const T=c[0];for(let I=0;I<T.length;I++){const R=T[I];(!I||R.x<u)&&(u=R.x),(!I||R.y<g)&&(g=R.y),(!I||R.x>h)&&(h=R.x),(!I||R.y>v)&&(v=R.y)}const A=Math.min(h-u,v-g);let D=A/2;const x=new Wi([],tV);if(A===0)return new Qe(u,g);for(let I=u;I<h;I+=A)for(let R=g;R<v;R+=A)x.push(new Vp(I+D,R+D,D,c));let P=function(I){let R=0,V=0,W=0;const K=I[0];for(let re=0,ie=K.length,Q=ie-1;re<ie;Q=re++){const ue=K[re],_e=K[Q],Ee=ue.x*_e.y-_e.x*ue.y;V+=(ue.x+_e.x)*Ee,W+=(ue.y+_e.y)*Ee,R+=3*Ee}return new Vp(V/R,W/R,0,I)}(c),L=x.length;for(;x.length;){const I=x.pop();(I.d>P.d||!P.d)&&(P=I,s&&console.log("found best %d after %d probes",Math.round(1e4*I.d)/1e4,L)),I.max-P.d<=n||(D=I.h/2,x.push(new Vp(I.p.x-D,I.p.y-D,D,c)),x.push(new Vp(I.p.x+D,I.p.y-D,D,c)),x.push(new Vp(I.p.x-D,I.p.y+D,D,c)),x.push(new Vp(I.p.x+D,I.p.y+D,D,c)),L+=4)}return s&&(console.log(`num probes: ${L}`),console.log(`best distance: ${P.d}`)),P.p}function tV(c,n){return n.max-c.max}class Vp{constructor(n,s,u,g){this.p=new Qe(n,s),this.h=u,this.d=function(h,v){let T=!1,A=1/0;for(let D=0;D<v.length;D++){const x=v[D];for(let P=0,L=x.length,I=L-1;P<L;I=P++){const R=x[P],V=x[I];R.y>h.y!=V.y>h.y&&h.x<(V.x-R.x)*(h.y-R.y)/(V.y-R.y)+R.x&&(T=!T),A=Math.min(A,Xe(h,R,V))}}return(T?1:-1)*Math.sqrt(A)}(this.p,g),this.max=this.d+this.h*Math.SQRT2}}const Zw=Number.POSITIVE_INFINITY,nV=Math.sqrt(2);function lA(c,[n,s]){let u=0,g=0;if(s===Zw){n<0&&(n=0);const h=n/nV;switch(c){case"top-right":case"top-left":g=h-7;break;case"bottom-right":case"bottom-left":g=7-h;break;case"bottom":g=7-n;break;case"top":g=n-7}switch(c){case"top-right":case"bottom-right":u=-h;break;case"top-left":case"bottom-left":u=h;break;case"left":u=n;break;case"right":u=-n}}else{switch(n=Math.abs(n),s=Math.abs(s),c){case"top-right":case"top-left":case"top":g=s-7;break;case"bottom-right":case"bottom-left":case"bottom":g=7-s}switch(c){case"top-right":case"bottom-right":case"right":u=-n;break;case"top-left":case"bottom-left":case"left":u=n}}return[u,g]}function Yw(c){switch(c){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function rV(c,n,s,u,g,h,v,T,A,D,x,P,L,I,R){let V=h.textMaxSize.evaluate(n,{},P);V===void 0?V=v*h.textScaleFactor:V*=h.textScaleFactor;const W=c.layers[0].layout,K=W.get("icon-offset").evaluate(n,{},P),re=uA(s.horizontal)||s.vertical,ie=L.name==="globe",Q=ts,ue=v*h.textScaleFactor/Q,_e=c.tilePixelRatio*V/Q,Ee=(ut=c.overscaling,c.zoom>18&&ut>2&&(ut>>=1),Math.max(In/(512*ut),1)*W.get("symbol-spacing")),Ne=W.get("text-padding")*c.tilePixelRatio,ze=W.get("icon-padding")*c.tilePixelRatio,De=Ot(W.get("text-max-angle")),ot=W.get("text-rotation-alignment")==="map"&&W.get("symbol-placement")!=="point",$e=W.get("icon-rotation-alignment")==="map"&&W.get("symbol-placement")!=="point",it=W.get("symbol-placement"),ft=Ee/2;var ut;const mt=W.get("icon-text-fit").evaluate(n,{},P),xt=W.get("icon-text-fit-padding").evaluate(n,{},P),At=mt!=="none";let _t;c.hasAnyIconTextFit===!1&&At&&(c.hasAnyIconTextFit=!0),u&&At&&(c.allowVerticalPlacement&&s.vertical&&(_t=KI(u,s.vertical,mt,xt,K,ue)),re&&(u=KI(u,re,mt,xt,K,ue)));const Zt=(hn,Kt,kn)=>{if(Kt.x<0||Kt.x>=In||Kt.y<0||Kt.y>=In)return;let Mn=null;if(ie){const{x:_n,y:mn,z:Zn}=L.projectTilePoint(Kt.x,Kt.y,kn);Mn={anchor:new Su(_n,mn,Zn,0,void 0),up:L.upVector(kn,Kt.x,Kt.y)}}(function(_n,mn,Zn,Rn,Fn,pr,Ir,Ar,kr,Nr,Vr,ko,go,xr,uo,fo,$o,ai,Si,li,Xo,mi,Mi,ns,Bo,Js,ql){const pl=_n.addToLineVertexArray(mn,Rn);let ml,of,Ed,sf,n_,Hk,Gk,Wk=0,qk=0,Kk=0,Zk=0,P2=-1,R2=-1;const Oc={};let Yk=La("");const af=Zn?Zn.anchor:mn,O2=kr.layout.get("icon-text-fit").evaluate(Xo,{},Bo)!=="none";let L2=0,D2=0;if(kr._unevaluatedLayout.getValue("text-radial-offset")===void 0?[L2,D2]=kr.layout.get("text-offset").evaluate(Xo,{},Bo).map($a=>$a*ts):(L2=kr.layout.get("text-radial-offset").evaluate(Xo,{},Bo)*ts,D2=Zw),_n.allowVerticalPlacement&&Fn.vertical){const $a=Fn.vertical;if(uo)Hk=Xw($a),Ar&&(Gk=Xw(Ar));else{const Qs=kr.layout.get("text-rotate").evaluate(Xo,{},Bo)+90;Ed=j0(Nr,af,mn,Vr,ko,go,$a,xr,Qs,fo),Ar&&(sf=j0(Nr,af,mn,Vr,ko,go,Ar,ai,Qs))}}if(pr){const $a=_n.iconSizeData,Qs=kr.layout.get("icon-rotate").evaluate(Xo,{},Bo),r_=sA(pr,Qs,Mi,O2,mi.iconScaleFactor),F2=Ar?sA(Ar,Qs,Mi,O2,mi.iconScaleFactor):void 0;of=j0(Nr,af,mn,Vr,ko,go,pr,ai,Qs,null),Wk=4*r_.length;let lf=null;$a.kind==="source"?(lf=[Ul*kr.layout.get("icon-size").evaluate(Xo,{},Bo)*mi.iconScaleFactor],lf[0]>wd&&wn(`${_n.layerIds[0]}: Value for "icon-size" is >= ${Nv}. Reduce your "icon-size".`)):$a.kind==="composite"&&(lf=[Ul*mi.compositeIconSizes[0].evaluate(Xo,{},Bo)*mi.iconScaleFactor,Ul*mi.compositeIconSizes[1].evaluate(Xo,{},Bo)*mi.iconScaleFactor],(lf[0]>wd||lf[1]>wd)&&wn(`${_n.layerIds[0]}: Value for "icon-size" is >= ${Nv}. Reduce your "icon-size".`)),_n.addSymbols(_n.icon,r_,lf,li,Si,Xo,!1,Zn,mn,pl.lineStartIndex,pl.lineLength,-1,ns,Bo,Js,ql),P2=_n.icon.placedSymbolArray.length-1,F2&&(qk=4*F2.length,_n.addSymbols(_n.icon,F2,lf,li,Si,Xo,Ba.vertical,Zn,mn,pl.lineStartIndex,pl.lineLength,-1,ns,Bo,Js,ql),R2=_n.icon.placedSymbolArray.length-1)}for(const $a in Fn.horizontal){const Qs=Fn.horizontal[$a];ml||(Yk=La(Qs.text),uo?n_=Xw(Qs):ml=j0(Nr,af,mn,Vr,ko,go,Qs,xr,kr.layout.get("text-rotate").evaluate(Xo,{},Bo),fo));const r_=Qs.positionedLines.length===1;if(Kk+=cA(_n,Zn,mn,Qs,Ir,kr,uo,Xo,fo,pl,Fn.vertical?Ba.horizontal:Ba.horizontalOnly,r_?Object.keys(Fn.horizontal):[$a],Oc,P2,mi,ns,Bo,Js),r_)break}Fn.vertical&&(Zk+=cA(_n,Zn,mn,Fn.vertical,Ir,kr,uo,Xo,fo,pl,Ba.vertical,["vertical"],Oc,R2,mi,ns,Bo,Js));let Md=-1;const z2=($a,Qs)=>$a?Math.max($a,Qs):Qs;Md=z2(n_,Md),Md=z2(Hk,Md),Md=z2(Gk,Md);const z$=Md>-1?1:0;_n.glyphOffsetArray.length>=65535&&wn("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Xo.sortKey!==void 0&&_n.addToSortKeyRanges(_n.symbolInstances.length,Xo.sortKey),_n.symbolInstances.emplaceBack(mn.x,mn.y,af.x,af.y,af.z,Oc.right>=0?Oc.right:-1,Oc.center>=0?Oc.center:-1,Oc.left>=0?Oc.left:-1,Oc.vertical>=0?Oc.vertical:-1,P2,R2,Yk,ml!==void 0?ml:_n.collisionBoxArray.length,ml!==void 0?ml+1:_n.collisionBoxArray.length,Ed!==void 0?Ed:_n.collisionBoxArray.length,Ed!==void 0?Ed+1:_n.collisionBoxArray.length,of!==void 0?of:_n.collisionBoxArray.length,of!==void 0?of+1:_n.collisionBoxArray.length,sf||_n.collisionBoxArray.length,sf?sf+1:_n.collisionBoxArray.length,Vr,Kk,Zk,Wk,qk,z$,0,L2,D2,Md,0,O2?1:0)})(c,Kt,Mn,hn,s,u,g,_t,c.layers[0],c.collisionBoxArray,n.index,n.sourceLayerIndex,c.index,Ne,ot,A,0,ze,$e,K,n,h,D,x,P,I,R)};if(it==="line")for(const hn of eA(n.geometry,0,0,In,In)){const Kt=J5(hn,Ee,De,s.vertical||re,u,Q,_e,c.overscaling,In);for(const kn of Kt)re&&oV(c,re.text,ft,kn)||Zt(hn,kn,P)}else if(it==="line-center"){for(const hn of n.geometry)if(hn.length>1){const Kt=X5(hn,De,s.vertical||re,u,Q,_e);Kt&&Zt(hn,Kt,P)}}else if(n.type==="Polygon")for(const hn of A0(n.geometry,0)){const Kt=eV(hn,16);Zt(hn[0],new Su(Kt.x,Kt.y,0,0,void 0),P)}else if(n.type==="LineString")for(const hn of n.geometry)Zt(hn,new Su(hn[0].x,hn[0].y,0,0,void 0),P);else if(n.type==="Point")for(const hn of n.geometry)for(const Kt of hn)Zt([Kt],new Su(Kt.x,Kt.y,0,0,void 0),P)}const Nv=255,wd=Nv*Ul;function cA(c,n,s,u,g,h,v,T,A,D,x,P,L,I,R,V,W,K){const re=function(ue,_e,Ee,Ne,ze,De,ot,$e){const it=[];if(_e.positionedLines.length===0)return it;const ft=Ne.layout.get("text-rotate").evaluate(De,{})*Math.PI/180,ut=function(Zt){const hn=Zt[0],Kt=Zt[1],kn=hn*Kt;return kn>0?[hn,-Kt]:kn<0?[-hn,Kt]:hn===0?[Kt,hn]:[Kt,-hn]}(Ee);let mt=Math.abs(_e.top-_e.bottom);for(const Zt of _e.positionedLines)mt-=Zt.lineOffset;const xt=_e.positionedLines.length,At=mt/xt;let _t=_e.top-Ee[1];for(let Zt=0;Zt<xt;++Zt){const hn=_e.positionedLines[Zt];_t=Q5(_e,At,_t,Zt);for(const Kt of hn.positionedGlyphs){if(!Kt.rect)continue;const kn=Kt.rect||{};let Mn=q5+1,_n=!0,mn=1,Zn=0;if(Kt.imageName){const li=ot[Gi.build(Kt.imageName).getSerializedPrimary()];if(!li)continue;if(li.sdf){wn("SDF images are not supported in formatted text and will be ignored.");continue}_n=!1,mn=li.pixelRatio,Mn=zv/mn}const Rn=(ze||$e)&&Kt.vertical,Fn=Kt.metrics.advance*Kt.scale/2,pr=Kt.metrics,Ir=Kt.rect;if(Ir===null)continue;$e&&_e.verticalizable&&(Zn=Kt.imageName?Fn-Kt.metrics.width*Kt.scale/2:0);const Ar=ze?[Kt.x+Fn,Kt.y]:[0,0];let kr=[0,0],Nr=[0,0],Vr=!1;ze||(Rn?(Nr=[Kt.x+Fn+ut[0],Kt.y+ut[1]-Zn],Vr=!0):kr=[Kt.x+Fn+Ee[0],Kt.y+Ee[1]-Zn]);const ko=Ir.w*Kt.scale/(mn*(Kt.localGlyph?jl:1)),go=Ir.h*Kt.scale/(mn*(Kt.localGlyph?jl:1));let xr,uo,fo,$o;if(Rn){const li=Kt.y-_t,Xo=new Qe(-Fn,Fn-li),mi=-Math.PI/2,Mi=new Qe(...Nr);xr=new Qe(-Fn+kr[0],kr[1]),xr._rotateAround(mi,Xo)._add(Mi),xr.x+=-li+Fn,xr.y-=(pr.left-Mn)*Kt.scale;const ns=Kt.imageName?pr.advance*Kt.scale:ts*Kt.scale,Bo=String.fromCodePoint(Kt.glyph);$5(Bo)?xr.x+=(1-Mn)*Kt.scale:U5(Bo)?xr.x+=ns-pr.height*Kt.scale+(-Mn-1)*Kt.scale:xr.x+=Kt.imageName||pr.width+2*Mn===Ir.w&&pr.height+2*Mn===Ir.h?(ns-go)/2:(ns-(pr.height+2*Mn)*Kt.scale)/2,uo=new Qe(xr.x,xr.y-ko),fo=new Qe(xr.x+go,xr.y),$o=new Qe(xr.x+go,xr.y-ko)}else{const li=(pr.left-Mn)*Kt.scale-Fn+kr[0],Xo=(-pr.top-Mn)*Kt.scale+kr[1],mi=li+ko,Mi=Xo+go;xr=new Qe(li,Xo),uo=new Qe(mi,Xo),fo=new Qe(li,Mi),$o=new Qe(mi,Mi)}if(ft){let li;li=ze?new Qe(0,0):Vr?new Qe(ut[0],ut[1]):new Qe(Ee[0],Ee[1]),xr._rotateAround(ft,li),uo._rotateAround(ft,li),fo._rotateAround(ft,li),$o._rotateAround(ft,li)}const ai=new Qe(0,0),Si=new Qe(0,0);it.push({tl:xr,tr:uo,bl:fo,br:$o,texPrimary:kn,texSecondary:void 0,writingMode:_e.writingMode,glyphOffset:Ar,sectionIndex:Kt.sectionIndex,isSDF:_n,pixelOffsetTL:ai,pixelOffsetBR:Si,minFontScaleX:0,minFontScaleY:0})}}return it}(0,u,A,h,v,T,g,c.allowVerticalPlacement),ie=c.textSizeData;let Q=null;ie.kind==="source"?(Q=[Ul*h.layout.get("text-size").evaluate(T,{},W)*R.textScaleFactor],Q[0]>wd&&wn(`${c.layerIds[0]}: Value for "text-size" is >= ${Nv}. Reduce your "text-size".`)):ie.kind==="composite"&&(Q=[Ul*R.compositeTextSizes[0].evaluate(T,{},W)*R.textScaleFactor,Ul*R.compositeTextSizes[1].evaluate(T,{},W)*R.textScaleFactor],(Q[0]>wd||Q[1]>wd)&&wn(`${c.layerIds[0]}: Value for "text-size" is >= ${Nv}. Reduce your "text-size".`)),c.addSymbols(c.text,re,Q,A,v,T,x,n,s,D.lineStartIndex,D.lineLength,I,V,W,K,!1);for(const ue of P)L[ue]=c.text.placedSymbolArray.length-1;return 4*re.length}function uA(c){for(const n in c)return c[n];return null}function j0(c,n,s,u,g,h,v,T,A,D){let x=v.top,P=v.bottom,L=v.left,I=v.right;const R=v.collisionPadding;if(R&&(L-=R[0],x-=R[1],I+=R[2],P+=R[3]),A){const V=new Qe(L,x),W=new Qe(I,x),K=new Qe(L,P),re=new Qe(I,P),ie=Ot(A);let Q=new Qe(0,0);D&&(Q=new Qe(D[0],D[1])),V._rotateAround(ie,Q),W._rotateAround(ie,Q),K._rotateAround(ie,Q),re._rotateAround(ie,Q),L=Math.min(V.x,W.x,K.x,re.x),I=Math.max(V.x,W.x,K.x,re.x),x=Math.min(V.y,W.y,K.y,re.y),P=Math.max(V.y,W.y,K.y,re.y)}return c.emplaceBack(n.x,n.y,n.z,s.x,s.y,L,x,I,P,T,u,g,h),c.length-1}function Xw(c){c.collisionPadding&&(c.top-=c.collisionPadding[1],c.bottom+=c.collisionPadding[3]);const n=c.bottom-c.top;return n>0?Math.max(10,n):null}function oV(c,n,s,u){const g=c.compareText;if(n in g){const h=g[n];for(let v=h.length-1;v>=0;v--)if(u.dist(h[v])<s)return!0}else g[n]=[];return g[n].push(u),!1}function dA(c,n){const s=c.fovAboveCenter,u=c.elevation?c.elevation.getMinElevationBelowMSL()*n:0,g=(c._camera.position[2]*c.worldSize-u)/Math.cos(c._pitch),h=Math.sin(s)*g/Math.sin(Math.max(Math.PI/2-c._pitch-s,.01));let v=Math.sin(c._pitch)*h+g;const T=g*(1/c._horizonShift);if(!c.elevation||c.elevation.exaggeration()===0){let A=Math.max(c.zoom-17,0);c.isOrthographic&&(A/=10),v*=1+A}return Math.min(1.01*v,T)}function Bv(c,n){if(!n.isReprojectedInTileSpace)return{scale:1<<c.z,x:c.x,y:c.y,x2:c.x+1,y2:c.y+1,projection:n};const s=Math.pow(2,-c.z),u=c.x*s,g=(c.x+1)*s,h=c.y*s,v=(c.y+1)*s,T=Ds(u),A=Ds(g),D=Ui(h),x=Ui(v),P=n.project(T,D),L=n.project(A,D),I=n.project(A,x),R=n.project(T,x);let V=Math.min(P.x,L.x,I.x,R.x),W=Math.min(P.y,L.y,I.y,R.y),K=Math.max(P.x,L.x,I.x,R.x),re=Math.max(P.y,L.y,I.y,R.y);const ie=s/16;function Q(_e,Ee,Ne,ze,De,ot){const $e=(Ne+De)/2,it=(ze+ot)/2,ft=n.project(Ds($e),Ui(it)),ut=Math.max(0,V-ft.x,W-ft.y,ft.x-K,ft.y-re);V=Math.min(V,ft.x),K=Math.max(K,ft.x),W=Math.min(W,ft.y),re=Math.max(re,ft.y),ut>ie&&(Q(_e,ft,Ne,ze,$e,it),Q(ft,Ee,$e,it,De,ot))}Q(P,L,u,h,g,h),Q(L,I,g,h,g,v),Q(I,R,g,v,u,v),Q(R,P,u,v,u,h),V-=ie,W-=ie,K+=ie,re+=ie;const ue=1/Math.max(K-V,re-W);return{scale:ue,x:V*ue,y:W*ue,x2:K*ue,y2:re*ue,projection:n}}function hA(c,{x:n,y:s},u=0){return new Qe(((n-u)*c.scale-c.x)*In,(s*c.scale-c.y)*In)}const iV=Fe.mat4.identity(new Float32Array(16));class Sd{constructor(n){this.spec=n,this.name=n.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(n,s){return{x:0,y:0,z:0}}unproject(n,s){return new Qr(0,0)}projectTilePoint(n,s,u){return{x:n,y:s,z:0}}locationPoint(n,s,u=!0){return n._coordinatePoint(n.locationCoordinate(s),u)}pixelsPerMeter(n,s){return fs(1,n)*s}pixelSpaceConversion(n,s,u){return 1}farthestPixelDistance(n){return dA(n,n.pixelsPerMeter)}pointCoordinate(n,s,u,g){const h=n.horizonLineFromTop(!1),v=new Qe(s,Math.max(h,u));return n.rayIntersectionCoordinate(n.pointRayIntersection(v,g))}pointCoordinate3D(n,s,u){const g=new Qe(s,u);if(n.elevation)return n.elevation.pointCoordinate(g);{const h=this.pointCoordinate(n,g.x,g.y,0);return[h.x,h.y,h.z]}}isPointAboveHorizon(n,s){if(n.elevation&&n.elevation.visibleDemTiles.length)return!this.pointCoordinate3D(n,s.x,s.y);const u=n.horizonLineFromTop();return s.y<u}createInversionMatrix(n,s){return iV}createTileMatrix(n,s,u){let g,h,v;const T=u.canonical,A=Fe.mat4.identity(new Float64Array(16));if(this.isReprojectedInTileSpace){const D=Bv(T,this);g=1,h=D.x+u.wrap*D.scale,v=D.y,Fe.mat4.scale(A,A,[g/D.scale,g/D.scale,n.pixelsPerMeter/s])}else g=s/n.zoomScale(T.z),h=(T.x+Math.pow(2,T.z)*u.wrap)*g,v=T.y*g;return Fe.mat4.translate(A,A,[h,v,0]),Fe.mat4.scale(A,A,[g/In,g/In,1]),A}upVector(n,s,u){return[0,0,1]}upVectorScale(n,s,u){return{metersToTile:1}}}class sV extends Sd{constructor(n){super(n),this.range=[4,7],this.center=n.center||[-96,37.5];const[s,u]=this.parallels=n.parallels||[29.5,45.5],g=Math.sin(Ot(s));this.n=(g+Math.sin(Ot(u)))/2,this.c=1+g*(2*this.n-g),this.r0=Math.sqrt(this.c)/this.n}project(n,s){const{n:u,c:g,r0:h}=this,v=Ot(n-this.center[0]),T=Ot(s),A=Math.sqrt(g-2*u*Math.sin(T))/u;return{x:A*Math.sin(v*u),y:A*Math.cos(v*u)-h,z:0}}unproject(n,s){const{n:u,c:g,r0:h}=this,v=h+s;let T=Math.atan2(n,Math.abs(v))*Math.sign(v);v*u<0&&(T-=Math.PI*Math.sign(n)*Math.sign(v));const A=Ot(this.center[0])*u;T=Yn(T,-Math.PI-A,Math.PI-A);const D=It(Ft(T/u)+this.center[0],-180,180),x=Math.asin(It((g-(n*n+v*v)*u*u)/(2*u),-1,1)),P=It(Ft(x),-85.051129,ws);return new Qr(D,P)}}const Vv=1.340264,$v=-.081106,Uv=893e-6,jv=.003796,H0=Math.sqrt(3)/2;class aV extends Sd{project(n,s){s=s/180*Math.PI,n=n/180*Math.PI;const u=Math.asin(H0*Math.sin(s)),g=u*u,h=g*g*g;return{x:.5*(n*Math.cos(u)/(H0*(Vv+3*$v*g+h*(7*Uv+9*jv*g)))/Math.PI+.5),y:1-.5*(u*(Vv+$v*g+h*(Uv+jv*g))/Math.PI+1),z:0}}unproject(n,s){n=(2*n-.5)*Math.PI;let u=s=(2*(1-s)-1)*Math.PI,g=u*u,h=g*g*g;for(let x,P,L,I=0;I<12&&(P=u*(Vv+$v*g+h*(Uv+jv*g))-s,L=Vv+3*$v*g+h*(7*Uv+9*jv*g),x=P/L,u=It(u-x,-Math.PI/3,Math.PI/3),g=u*u,h=g*g*g,!(Math.abs(x)<1e-12));++I);const v=H0*n*(Vv+3*$v*g+h*(7*Uv+9*jv*g))/Math.cos(u),T=Math.asin(Math.sin(u)/H0),A=It(180*v/Math.PI,-180,180),D=It(180*T/Math.PI,-85.051129,ws);return new Qr(A,D)}}class lV extends Sd{constructor(n){super(n),this.wrap=!0,this.supportsWorldCopies=!0}project(n,s){return{x:.5+n/360,y:.5-s/360,z:0}}unproject(n,s){const u=360*(n-.5),g=It(360*(.5-s),-85.051129,ws);return new Qr(u,g)}}const $p=Math.PI/2;function G0(c){return Math.tan(($p+c)/2)}class cV extends Sd{constructor(n){super(n),this.center=n.center||[0,30];const[s,u]=this.parallels=n.parallels||[30,30];let g=Ot(s),h=Ot(u);this.southernCenter=g+h<0,this.southernCenter&&(g=-g,h=-h);const v=Math.cos(g),T=G0(g);this.n=g===h?Math.sin(g):Math.log(v/Math.cos(h))/Math.log(G0(h)/T),this.f=v*Math.pow(G0(g),this.n)/this.n}project(n,s){s=Ot(s),this.southernCenter&&(s=-s),n=Ot(n-this.center[0]);const u=1e-6,{n:g,f:h}=this;h>0?s<-$p+u&&(s=-$p+u):s>$p-u&&(s=$p-u);const v=h/Math.pow(G0(s),g);let T=v*Math.sin(g*n),A=h-v*Math.cos(g*n);return T=.5*(T/Math.PI+.5),A=.5*(A/Math.PI+.5),{x:T,y:this.southernCenter?A:1-A,z:0}}unproject(n,s){n=(2*n-.5)*Math.PI,this.southernCenter&&(s=1-s),s=(2*(1-s)-.5)*Math.PI;const{n:u,f:g}=this,h=g-s,v=Math.sign(h),T=Math.sign(u)*Math.sqrt(n*n+h*h);let A=Math.atan2(n,Math.abs(h))*v;h*u<0&&(A-=Math.PI*Math.sign(n)*v);const D=It(Ft(A/u)+this.center[0],-180,180),x=It(Ft(2*Math.atan(Math.pow(g/T,1/u))-$p),-85.051129,ws);return new Qr(D,this.southernCenter?-x:x)}}class fA extends Sd{constructor(n){super(n),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(n,s){return{x:ul(n),y:Na(s),z:0}}unproject(n,s){const u=Ds(n),g=Ui(s);return new Qr(u,g)}}const pA=Ot(ws);class uV extends Sd{project(n,s){const u=(s=Ot(s))*s,g=u*u;return{x:.5*((n=Ot(n))*(.8707-.131979*u+g*(g*(.003971*u-.001529*g)-.013791))/Math.PI+.5),y:1-.5*(s*(1.007226+u*(.015085+g*(.028874*u-.044475-.005916*g)))/Math.PI+1),z:0}}unproject(n,s){n=(2*n-.5)*Math.PI;let u=s=(2*(1-s)-1)*Math.PI,g=25,h=0,v=u*u;do{v=u*u;const D=v*v;h=(u*(1.007226+v*(.015085+D*(.028874*v-.044475-.005916*D)))-s)/(1.007226+v*(.045255+D*(.259866*v-.311325-.005916*11*D))),u=It(u-h,-pA,pA)}while(Math.abs(h)>1e-6&&--g>0);v=u*u;const T=It(Ft(n/(.8707+v*(v*(v*v*v*(.003971-.001529*v)-.013791)-.131979))),-180,180),A=Ft(u);return new Qr(T,A)}}const mA=Ot(ws);class dV extends Sd{project(n,s){s=Ot(s),n=Ot(n);const u=Math.cos(s),g=2/Math.PI,h=Math.acos(u*Math.cos(n/2)),v=Math.sin(h)/h,T=.5*(n*g+2*u*Math.sin(n/2)/v)||0,A=.5*(s+Math.sin(s)/v)||0;return{x:.5*(T/Math.PI+.5),y:1-.5*(A/Math.PI+1),z:0}}unproject(n,s){let u=n=(2*n-.5)*Math.PI,g=s=(2*(1-s)-1)*Math.PI,h=25;const v=1e-6;let T=0,A=0;do{const D=Math.cos(g),x=Math.sin(g),P=2*x*D,L=x*x,I=D*D,R=Math.cos(u/2),V=Math.sin(u/2),W=2*R*V,K=V*V,re=1-I*R*R,ie=re?1/re:0,Q=re?Math.acos(D*R)*Math.sqrt(1/re):0,ue=.5*(2*Q*D*V+2*u/Math.PI)-n,_e=.5*(Q*x+g)-s,Ee=.5*ie*(I*K+Q*D*R*L)+1/Math.PI,Ne=ie*(W*P/4-Q*x*V),ze=.125*ie*(P*V-Q*x*I*W),De=.5*ie*(L*R+Q*K*D)+.5,ot=Ne*ze-De*Ee;T=(_e*Ne-ue*De)/ot,A=(ue*ze-_e*Ee)/ot,u=It(u-T,-Math.PI,Math.PI),g=It(g-A,-mA,mA)}while((Math.abs(T)>v||Math.abs(A)>v)&&--h>0);return new Qr(Ft(u),Ft(g))}}class gA extends Sd{constructor(n){super(n),this.center=n.center||[0,0],this.parallels=n.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(Ot(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(n,s){const{scale:u,cosPhi:g}=this;return{x:Ot(n)*g*u+.5,y:-Math.sin(Ot(s))/g*u+.5,z:0}}unproject(n,s){const{scale:u,cosPhi:g}=this,h=-(s-.5)/u,v=It(Ft((n-.5)/u)/g,-180,180),T=Math.asin(It(h*g,-1,1)),A=It(Ft(T),-85.051129,ws);return new Qr(v,A)}}class hV extends fA{constructor(n){super(n),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug"],this.range=[3,5]}projectTilePoint(n,s,u){const g=xo(n,s,u),h=Ri(bi(u));return Fe.vec3.transformMat4(g,g,h),{x:g[0],y:g[1],z:g[2]}}locationPoint(n,s){const u=yu(s.lat,s.lng),g=Fe.vec3.normalize([],u),h=n.elevation?n.elevation.getAtPointOrZero(n.locationCoordinate(s),n._centerAltitude):n._centerAltitude,v=fs(1,0)*In*h;Fe.vec3.scaleAndAdd(u,u,g,v);const T=Fe.mat4.identity(new Float64Array(16));return Fe.mat4.multiply(T,n.pixelMatrix,n.globeMatrix),Fe.vec3.transformMat4(u,u,T),new Qe(u[0],u[1])}pixelsPerMeter(n,s){return fs(1,0)*s}pixelSpaceConversion(n,s,u){const g=fs(1,n)*s,h=cr(fs(1,45)*s,g,u);return this.pixelsPerMeter(n,s)/h}createTileMatrix(n,s,u){const g=Co(bi(u.canonical));return Fe.mat4.multiply(new Float64Array(16),n.globeMatrix,g)}createInversionMatrix(n,s){const{center:u}=n,g=Ri(bi(s));return Fe.mat4.rotateY(g,g,Ot(u.lng)),Fe.mat4.rotateX(g,g,Ot(u.lat)),Fe.mat4.scale(g,g,[n._pixelsPerMercatorPixel,n._pixelsPerMercatorPixel,1]),Float32Array.from(g)}pointCoordinate(n,s,u,g){return ao(n,s,u,!0)||new l(0,0)}pointCoordinate3D(n,s,u){const g=this.pointCoordinate(n,s,u,0);return[g.x,g.y,g.z]}isPointAboveHorizon(n,s){return!ao(n,s.x,s.y,!1)}farthestPixelDistance(n){const s=function(g,h){const v=g.cameraToCenterDistance,T=g._centerAltitude*h,A=g._camera,D=g._camera.forward(),x=Fe.vec3.add([],Fe.vec3.scale([],D,-v),[0,0,T]),P=g.worldSize/(2*Math.PI),L=[0,0,-P],I=g.width/g.height,R=Math.tan(g.fovAboveCenter),V=Fe.vec3.scale([],A.up(),R),W=Fe.vec3.scale([],A.right(),R*I),K=Fe.vec3.normalize([],Fe.vec3.add([],Fe.vec3.add([],D,V),W)),re=[];let ie;if(new br(x,K).closestPointOnSphere(L,P,re)){const Q=Fe.vec3.add([],re,L),ue=Fe.vec3.sub([],Q,x);ie=Math.cos(g.fovAboveCenter)*Fe.vec3.length(ue)}else{const Q=Fe.vec3.sub([],x,L),ue=Fe.vec3.sub([],L,x);Fe.vec3.normalize(ue,ue);const _e=Fe.vec3.length(Q)-P;ie=Math.sqrt(_e*(_e+2*P));const Ee=Math.acos(ie/(P+_e))-Math.acos(Fe.vec3.dot(D,ue));ie*=Math.cos(Ee)}return 1.01*ie}(n,this.pixelsPerMeter(n.center.lat,n.worldSize)),u=Ss(n.zoom);if(u>0){const g=dA(n,fs(1,n.center.lat)*n.worldSize),h=n.worldSize/(2*Math.PI),v=Math.max(n.width,n.height)/n.worldSize*Math.PI;return cr(s,g+h*(1-Math.cos(v)),Math.pow(u,10))}return s}upVector(n,s,u){return xo(s,u,n,1)}upVectorScale(n){return{metersToTile:Ur(qr(bi(n)))}}}function vA(c){const n=c.parallels,s=!!n&&Math.abs(n[0]+n[1])<.01;switch(c.name){case"mercator":return new fA(c);case"equirectangular":return new lV(c);case"naturalEarth":return new uV(c);case"equalEarth":return new aV(c);case"winkelTripel":return new dV(c);case"albers":return s?new gA(c):new sV(c);case"lambertConformalConic":return s?new gA(c):new cV(c);case"globe":return new hV(c)}throw new Error(`Invalid projection name: ${c.name}`)}const fV=zp.VectorTileFeature.types,pV=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function W0(c,n,s,u,g,h,v,T,A,D,x,P,L){const I=T?Math.min(wd,Math.round(T[0])):0,R=T?Math.min(wd,Math.round(T[1])):0;c.emplaceBack(n,s,Math.round(32*u),Math.round(32*g),h,v,(I<<1)+(A?1:0),R,16*D,16*x,256*P,256*L)}function q0(c,n,s){c.emplaceBack(n,s)}function K0(c,n,s,u,g,h,v){c.emplaceBack(n,s,u,g,h,v)}function Z0(c,n,s,u,g){c.emplaceBack(n,s,u,g),c.emplaceBack(n,s,u,g),c.emplaceBack(n,s,u,g),c.emplaceBack(n,s,u,g)}function mV(c){for(const n of c.sections)if(Xg(n.text))return!0;return!1}class Jw{constructor(n){this.layoutVertexArray=new iv,this.indexArray=new $i,this.programConfigurations=n,this.segments=new ei,this.dynamicLayoutVertexArray=new mu,this.opacityVertexArray=new av,this.placedSymbolArray=new f0,this.iconTransitioningVertexArray=new Mc,this.globeExtVertexArray=new sv,this.zOffsetVertexArray=new Bh}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0&&this.iconTransitioningVertexArray.length===0}upload(n,s,u,g,h){this.isEmpty()||(u&&(this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,P5.members),this.indexBuffer=n.createIndexBuffer(this.indexArray,s),this.dynamicLayoutVertexBuffer=n.createVertexBuffer(this.dynamicLayoutVertexArray,O5.members,!0),this.opacityVertexBuffer=n.createVertexBuffer(this.opacityVertexArray,pV,!0),this.iconTransitioningVertexArray.length>0&&(this.iconTransitioningVertexBuffer=n.createVertexBuffer(this.iconTransitioningVertexArray,D5.members,!0)),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=n.createVertexBuffer(this.globeExtVertexArray,R5.members,!0)),!this.zOffsetVertexBuffer&&(this.zOffsetVertexArray.length>0||h)&&(this.zOffsetVertexBuffer=n.createVertexBuffer(this.zOffsetVertexArray,L5.members,!0)),this.opacityVertexBuffer.itemSize=1),(u||g)&&this.programConfigurations.upload(n))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.iconTransitioningVertexBuffer&&this.iconTransitioningVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy(),this.zOffsetVertexBuffer&&this.zOffsetVertexBuffer.destroy())}}Hn(Jw,"SymbolBuffers");class Qw{constructor(n,s,u){this.layoutVertexArray=new n,this.layoutAttributes=s,this.indexArray=new u,this.segments=new ei,this.collisionVertexArray=new uv,this.collisionVertexArrayExt=new mu}upload(n){this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=n.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=n.createVertexBuffer(this.collisionVertexArray,z5.members,!0),this.collisionVertexBufferExt=n.createVertexBuffer(this.collisionVertexArrayExt,F5.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}Hn(Qw,"CollisionBuffers");class Y0{constructor(n){this.collisionBoxArray=n.collisionBoxArray,this.zoom=n.zoom,this.lut=n.lut,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map(v=>v.fqid),this.index=n.index,this.pixelRatio=n.pixelRatio,this.sourceLayerIndex=n.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.hasAnyIconTextFit=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Fe.mat4.identity([]),this.placementViewportMatrix=Fe.mat4.identity([]);const s=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Uw(this.zoom,s["text-size"]),this.iconSizeData=Uw(this.zoom,s["icon-size"]);const u=this.layers[0].layout,g=u.get("symbol-sort-key"),h=u.get("symbol-z-order");this.canOverlap=u.get("text-allow-overlap")||u.get("icon-allow-overlap")||u.get("text-ignore-placement")||u.get("icon-ignore-placement"),this.sortFeaturesByKey=h!=="viewport-y"&&g.constantOr(1)!==void 0,this.sortFeaturesByY=(h==="viewport-y"||h==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=u.get("text-writing-mode").map(v=>Ba[v]),this.stateDependentLayerIds=this.layers.filter(v=>v.isStateDependent()).map(v=>v.id),this.sourceID=n.sourceID,this.projection=n.projection,this.hasAnyZOffset=!1,this.zOffsetSortDirty=!1,this.zOffsetBuffersNeedUpload=u.get("symbol-z-elevate"),this.activeReplacements=[],this.replacementUpdateTime=0}createArrays(){this.text=new Jw(new kc(this.layers,{zoom:this.zoom,lut:this.lut},n=>n.startsWith("text")||n.startsWith("symbol"))),this.icon=new Jw(new kc(this.layers,{zoom:this.zoom,lut:this.lut},n=>n.startsWith("icon")||n.startsWith("symbol"))),this.glyphOffsetArray=new g0,this.lineVertexArray=new v0,this.symbolInstances=new m0}calculateGlyphDependencies(n,s,u,g,h){for(const v of n){const T=v.codePointAt(0);if(T===void 0)break;if(s[T]=!0,g&&h&&T<=65535){const A=Lv[v];A&&(s[A.charCodeAt(0)]=!0)}}}updateFootprints(n,s){}updateReplacement(n,s){if(s.updateTime===this.replacementUpdateTime)return!1;this.replacementUpdateTime=s.updateTime;const u=s.getReplacementRegionsForTile(n.toUnwrapped(),!0);return!Lw(this.activeReplacements,u)&&(this.activeReplacements=u,!0)}populate(n,s,u,g){const h=this.layers[0],v=h.layout,T=this.projection.name==="globe",A=v.get("text-font"),D=v.get("text-field"),x=v.get("icon-image"),[P,L]=v.get("icon-size-scale-range"),I=It(s.scaleFactor||1,P,L),R=(D.value.kind!=="constant"||D.value.value instanceof Xi&&!D.value.value.isEmpty()||D.value.value.toString().length>0)&&(A.value.kind!=="constant"||A.value.value.length>0),V=x.value.kind!=="constant"||!!x.value.value||Object.keys(x.parameters).length>0,W=v.get("symbol-sort-key");if(this.features=[],!R&&!V)return;const K=s.iconDependencies,re=s.glyphDependencies,ie=s.availableImages,Q=new zo(this.zoom);for(const{feature:ue,id:_e,index:Ee,sourceLayerIndex:Ne}of n){const ze=h._featureFilter.needGeometry,De=Z(ue,ze);if(!h._featureFilter.filter(Q,De,u))continue;if(ze||(De.geometry=G(ue,u,g)),T&&ue.type!==1&&u.z<=5){const ut=De.geometry,mt=.98078528056,xt=(At,_t)=>{const Zt=xo(At.x,At.y,u,1),hn=xo(_t.x,_t.y,u,1);return Fe.vec3.dot(Zt,hn)<mt};for(let At=0;At<ut.length;At++)ut[At]=E(ut[At],xt)}let ot,$e;if(R){const ut=h.getValueAndResolveTokens("text-field",De,u,ie),mt=Xi.factory(ut);mV(mt)&&(this.hasRTLText=!0),(!this.hasRTLText||vp()==="unavailable"||this.hasRTLText&&qs.isParsed())&&(ot=V5(mt,h,De))}if(V){const ut=h.getValueAndResolveTokens("icon-image",De,u,ie);$e=ut instanceof Gi?ut:Gi.build(ut)}if(!ot&&!$e)continue;const it=this.sortFeaturesByKey?W.evaluate(De,{},u):void 0,ft={id:_e,text:ot,icon:$e,index:Ee,sourceLayerIndex:Ne,geometry:De.geometry,properties:ue.properties,type:fV[ue.type],sortKey:it};if(this.features.push(ft),$e){const ut=$w(this.iconSizeData,this.layers[0]._unevaluatedLayout._values["icon-size"],u,this.zoom,ft)*I*this.pixelRatio,mt=$e.getPrimary().scaleSelf(ut);if(K[mt.id]=K[mt.id]||[],K[mt.id].push(mt),$e.nameSecondary){const xt=$e.getSecondary().scaleSelf(ut);K[xt.id]=K[xt.id]||[],K[xt.id].push(xt)}}if(ot){const ut=A.evaluate(De,{},u).join(","),mt=v.get("text-rotation-alignment")==="map"&&v.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(Ba.vertical)>=0;for(const xt of ot.sections)if(xt.image){const At=xt.image.getPrimary().scaleSelf(this.pixelRatio);K[At.id]=K[At.id]||[],K[At.id].push(At)}else{const At=Kg(ot.toString()),_t=xt.fontStack||ut,Zt=re[_t]=re[_t]||{};this.calculateGlyphDependencies(xt.text,Zt,mt,this.allowVerticalPlacement,At)}}}v.get("symbol-placement")==="line"&&(this.features=function(ue){const _e={},Ee={},Ne=[];let ze=0;function De(ft){Ne.push(ue[ft]),ze++}function ot(ft,ut,mt){const xt=Ee[ft];return delete Ee[ft],Ee[ut]=xt,Ne[xt].geometry[0].pop(),Ne[xt].geometry[0]=Ne[xt].geometry[0].concat(mt[0]),xt}function $e(ft,ut,mt){const xt=_e[ut];return delete _e[ut],_e[ft]=xt,Ne[xt].geometry[0].shift(),Ne[xt].geometry[0]=mt[0].concat(Ne[xt].geometry[0]),xt}function it(ft,ut,mt){const xt=mt?ut[0][ut[0].length-1]:ut[0][0];return`${ft}:${xt.x}:${xt.y}`}for(let ft=0;ft<ue.length;ft++){const ut=ue[ft],mt=ut.geometry,xt=ut.text?ut.text.toString():null;if(!xt){De(ft);continue}const At=it(xt,mt),_t=it(xt,mt,!0);if(At in Ee&&_t in _e&&Ee[At]!==_e[_t]){const Zt=$e(At,_t,mt),hn=ot(At,_t,Ne[Zt].geometry);delete _e[At],delete Ee[_t],Ee[it(xt,Ne[hn].geometry,!0)]=hn,Ne[Zt].geometry=null}else At in Ee?ot(At,_t,mt):_t in _e?$e(At,_t,mt):(De(ft),_e[At]=ze-1,Ee[_t]=ze-1)}return Ne.filter(ft=>ft.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((ue,_e)=>ue.sortKey-_e.sortKey)}update(n,s,u,g,h,v,T){this.text.programConfigurations.updatePaintArrays(n,s,h,u,g,v,T),this.icon.programConfigurations.updatePaintArrays(n,s,h,u,g,v,T)}updateZOffset(){const n=(h,v,T)=>{u+=v,u>h.length&&h.resize(u);for(let A=-v;A<0;A++)h.emplace(A+u,T)},s=(h,v,T)=>{g+=v,g>h.length&&h.resize(g);for(let A=-v;A<0;A++)h.emplace(A+g,T)};if(!this.zOffsetBuffersNeedUpload)return;this.zOffsetBuffersNeedUpload=!1;let u=0,g=0;for(let h=0;h<this.symbolInstances.length;h++){const v=this.symbolInstances.get(h),{numHorizontalGlyphVertices:T,numVerticalGlyphVertices:A,numIconVertices:D}=v,x=v.zOffset,P=D>0;if((T>0||A>0)&&(n(this.text.zOffsetVertexArray,T,x),n(this.text.zOffsetVertexArray,A,x)),P){const{placedIconSymbolIndex:L,verticalPlacedIconSymbolIndex:I}=v;L>=0&&s(this.icon.zOffsetVertexArray,D,x),I>=0&&s(this.icon.zOffsetVertexArray,v.numVerticalIconVertices,x)}}this.text.zOffsetVertexBuffer&&this.text.zOffsetVertexBuffer.updateData(this.text.zOffsetVertexArray),this.icon.zOffsetVertexBuffer&&this.icon.zOffsetVertexBuffer.updateData(this.icon.zOffsetVertexArray)}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(n){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(n),this.iconCollisionBox.upload(n)),this.text.upload(n,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload),this.icon.upload(n,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=vA(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(n,s){const u=this.lineVertexArray.length;if(n.segment!==void 0)for(const{x:g,y:h}of s)this.lineVertexArray.emplaceBack(g,h);return{lineStartIndex:u,lineLength:this.lineVertexArray.length-u}}addSymbols(n,s,u,g,h,v,T,A,D,x,P,L,I,R,V,W){const K=n.indexArray,re=n.layoutVertexArray,ie=n.globeExtVertexArray,Q=n.segments.prepareSegment(4*s.length,re,K,this.canOverlap?v.sortKey:void 0),ue=this.glyphOffsetArray.length,_e=Q.vertexLength,Ee=this.allowVerticalPlacement&&T===Ba.vertical?Math.PI/2:0,Ne=v.text&&v.text.sections;for(let De=0;De<s.length;De++){const{tl:ot,tr:$e,bl:it,br:ft,texPrimary:ut,texSecondary:mt,pixelOffsetTL:xt,pixelOffsetBR:At,minFontScaleX:_t,minFontScaleY:Zt,glyphOffset:hn,isSDF:Kt,sectionIndex:kn}=s[De],Mn=Q.vertexLength,_n=hn[1];if(W0(re,D.x,D.y,ot.x,_n+ot.y,ut.x,ut.y,u,Kt,xt.x,xt.y,_t,Zt),W0(re,D.x,D.y,$e.x,_n+$e.y,ut.x+ut.w,ut.y,u,Kt,At.x,xt.y,_t,Zt),W0(re,D.x,D.y,it.x,_n+it.y,ut.x,ut.y+ut.h,u,Kt,xt.x,At.y,_t,Zt),W0(re,D.x,D.y,ft.x,_n+ft.y,ut.x+ut.w,ut.y+ut.h,u,Kt,At.x,At.y,_t,Zt),A){const{x:mn,y:Zn,z:Rn}=A.anchor,[Fn,pr,Ir]=A.up;K0(ie,mn,Zn,Rn,Fn,pr,Ir),K0(ie,mn,Zn,Rn,Fn,pr,Ir),K0(ie,mn,Zn,Rn,Fn,pr,Ir),K0(ie,mn,Zn,Rn,Fn,pr,Ir),Z0(n.dynamicLayoutVertexArray,mn,Zn,Rn,Ee)}else Z0(n.dynamicLayoutVertexArray,D.x,D.y,D.z,Ee);if(W){const mn=mt||ut;q0(n.iconTransitioningVertexArray,mn.x,mn.y),q0(n.iconTransitioningVertexArray,mn.x+mn.w,mn.y),q0(n.iconTransitioningVertexArray,mn.x,mn.y+mn.h),q0(n.iconTransitioningVertexArray,mn.x+mn.w,mn.y+mn.h)}K.emplaceBack(Mn,Mn+1,Mn+2),K.emplaceBack(Mn+1,Mn+2,Mn+3),Q.vertexLength+=4,Q.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(hn[0]),De!==s.length-1&&kn===s[De+1].sectionIndex||n.programConfigurations.populatePaintArrays(re.length,v,v.index,{},I,R,V,Ne&&Ne[kn])}const ze=A?A.anchor:D;n.placedSymbolArray.emplaceBack(ze.x,ze.y,ze.z,D.x,D.y,ue,this.glyphOffsetArray.length-ue,_e,x,P,D.segment,u?u[0]:0,u?u[1]:0,g[0],g[1],T,0,!1,0,L,0)}_commitLayoutVertex(n,s,u,g,h,v,T){n.emplaceBack(s,u,g,h,v,Math.round(T.x),Math.round(T.y))}_addCollisionDebugVertices(n,s,u,g,h,v,T){const A=u.segments.prepareSegment(4,u.layoutVertexArray,u.indexArray),D=A.vertexLength,x=T.tileAnchorX,P=T.tileAnchorY;for(let I=0;I<4;I++)u.collisionVertexArray.emplaceBack(0,0,0,0,0,0);this._commitDebugCollisionVertexUpdate(u.collisionVertexArrayExt,s,n.padding,T.zOffset),this._commitLayoutVertex(u.layoutVertexArray,g,h,v,x,P,new Qe(n.x1,n.y1)),this._commitLayoutVertex(u.layoutVertexArray,g,h,v,x,P,new Qe(n.x2,n.y1)),this._commitLayoutVertex(u.layoutVertexArray,g,h,v,x,P,new Qe(n.x2,n.y2)),this._commitLayoutVertex(u.layoutVertexArray,g,h,v,x,P,new Qe(n.x1,n.y2)),A.vertexLength+=4;const L=u.indexArray;L.emplaceBack(D,D+1),L.emplaceBack(D+1,D+2),L.emplaceBack(D+2,D+3),L.emplaceBack(D+3,D),A.primitiveLength+=4}_addTextDebugCollisionBoxes(n,s,u,g,h,v){for(let T=g;T<h;T++){const A=u.get(T),D=this.getSymbolInstanceTextSize(n,v,s,T);this._addCollisionDebugVertices(A,D,this.textCollisionBox,A.projectedAnchorX,A.projectedAnchorY,A.projectedAnchorZ,v)}}_addIconDebugCollisionBoxes(n,s,u,g,h,v){for(let T=g;T<h;T++){const A=u.get(T),D=this.getSymbolInstanceIconSize(n,s,v.placedIconSymbolIndex);this._addCollisionDebugVertices(A,D,this.iconCollisionBox,A.projectedAnchorX,A.projectedAnchorY,A.projectedAnchorZ,v)}}generateCollisionDebugBuffers(n,s,u){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Qw(Cp,BI.members,Mc),this.iconCollisionBox=new Qw(Cp,BI.members,Mc);const g=Fp(this.iconSizeData,n),h=Fp(this.textSizeData,n,u);for(let v=0;v<this.symbolInstances.length;v++){const T=this.symbolInstances.get(v);this._addTextDebugCollisionBoxes(h,n,s,T.textBoxStartIndex,T.textBoxEndIndex,T),this._addTextDebugCollisionBoxes(h,n,s,T.verticalTextBoxStartIndex,T.verticalTextBoxEndIndex,T),this._addIconDebugCollisionBoxes(g,n,s,T.iconBoxStartIndex,T.iconBoxEndIndex,T),this._addIconDebugCollisionBoxes(g,n,s,T.verticalIconBoxStartIndex,T.verticalIconBoxEndIndex,T)}}getSymbolInstanceTextSize(n,s,u,g){const h=this.text.placedSymbolArray.get(s.rightJustifiedTextSymbolIndex>=0?s.rightJustifiedTextSymbolIndex:s.centerJustifiedTextSymbolIndex>=0?s.centerJustifiedTextSymbolIndex:s.leftJustifiedTextSymbolIndex>=0?s.leftJustifiedTextSymbolIndex:s.verticalPlacedTextSymbolIndex>=0?s.verticalPlacedTextSymbolIndex:g),v=z0(this.textSizeData,n,h)/ts;return this.tilePixelRatio*v}getSymbolInstanceIconSize(n,s,u){const g=this.icon.placedSymbolArray.get(u),h=z0(this.iconSizeData,n,g);return this.tilePixelRatio*h}_commitDebugCollisionVertexUpdate(n,s,u,g){n.emplaceBack(s,-u,-u,g),n.emplaceBack(s,u,-u,g),n.emplaceBack(s,u,u,g),n.emplaceBack(s,-u,u,g)}_updateTextDebugCollisionBoxes(n,s,u,g,h,v,T){for(let A=g;A<h;A++){const D=u.get(A),x=this.getSymbolInstanceTextSize(n,v,s,A);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,x,D.padding,v.zOffset)}}_updateIconDebugCollisionBoxes(n,s,u,g,h,v,T){for(let A=g;A<h;A++){const D=u.get(A),x=this.getSymbolInstanceIconSize(n,s,v.placedIconSymbolIndex);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,x,D.padding,v.zOffset)}}updateCollisionDebugBuffers(n,s,u,g){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const h=Fp(this.iconSizeData,n,g),v=Fp(this.textSizeData,n,u);for(let T=0;T<this.symbolInstances.length;T++){const A=this.symbolInstances.get(T);this._updateTextDebugCollisionBoxes(v,n,s,A.textBoxStartIndex,A.textBoxEndIndex,A,u),this._updateTextDebugCollisionBoxes(v,n,s,A.verticalTextBoxStartIndex,A.verticalTextBoxEndIndex,A,u),this._updateIconDebugCollisionBoxes(h,n,s,A.iconBoxStartIndex,A.iconBoxEndIndex,A,g),this._updateIconDebugCollisionBoxes(h,n,s,A.verticalIconBoxStartIndex,A.verticalIconBoxEndIndex,A,g)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(n,s,u,g,h,v,T,A,D){const x={};if(s<u){const{x1:P,y1:L,x2:I,y2:R,padding:V,projectedAnchorX:W,projectedAnchorY:K,projectedAnchorZ:re,tileAnchorX:ie,tileAnchorY:Q,featureIndex:ue}=n.get(s);x.textBox={x1:P,y1:L,x2:I,y2:R,padding:V,projectedAnchorX:W,projectedAnchorY:K,projectedAnchorZ:re,tileAnchorX:ie,tileAnchorY:Q},x.textFeatureIndex=ue}if(g<h){const{x1:P,y1:L,x2:I,y2:R,padding:V,projectedAnchorX:W,projectedAnchorY:K,projectedAnchorZ:re,tileAnchorX:ie,tileAnchorY:Q,featureIndex:ue}=n.get(g);x.verticalTextBox={x1:P,y1:L,x2:I,y2:R,padding:V,projectedAnchorX:W,projectedAnchorY:K,projectedAnchorZ:re,tileAnchorX:ie,tileAnchorY:Q},x.verticalTextFeatureIndex=ue}if(v<T){const{x1:P,y1:L,x2:I,y2:R,padding:V,projectedAnchorX:W,projectedAnchorY:K,projectedAnchorZ:re,tileAnchorX:ie,tileAnchorY:Q,featureIndex:ue}=n.get(v);x.iconBox={x1:P,y1:L,x2:I,y2:R,padding:V,projectedAnchorX:W,projectedAnchorY:K,projectedAnchorZ:re,tileAnchorX:ie,tileAnchorY:Q},x.iconFeatureIndex=ue}if(A<D){const{x1:P,y1:L,x2:I,y2:R,padding:V,projectedAnchorX:W,projectedAnchorY:K,projectedAnchorZ:re,tileAnchorX:ie,tileAnchorY:Q,featureIndex:ue}=n.get(A);x.verticalIconBox={x1:P,y1:L,x2:I,y2:R,padding:V,projectedAnchorX:W,projectedAnchorY:K,projectedAnchorZ:re,tileAnchorX:ie,tileAnchorY:Q},x.verticalIconFeatureIndex=ue}return x}deserializeCollisionBoxes(n){this.collisionArrays=[];for(let s=0;s<this.symbolInstances.length;s++){const u=this.symbolInstances.get(s);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(n,u.textBoxStartIndex,u.textBoxEndIndex,u.verticalTextBoxStartIndex,u.verticalTextBoxEndIndex,u.iconBoxStartIndex,u.iconBoxEndIndex,u.verticalIconBoxStartIndex,u.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}hasIconTextFit(){return this.hasAnyIconTextFit}addIndicesForPlacedSymbol(n,s){const u=n.placedSymbolArray.get(s),g=u.vertexStartIndex+4*u.numGlyphs;for(let h=u.vertexStartIndex;h<g;h+=4)n.indexArray.emplaceBack(h,h+1,h+2),n.indexArray.emplaceBack(h+1,h+2,h+3)}getSortedSymbolIndexes(n){if(this.sortedAngle===n&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const s=Math.sin(n),u=Math.cos(n),g=[],h=[],v=[];for(let T=0;T<this.symbolInstances.length;++T){v.push(T);const A=this.symbolInstances.get(T);g.push(0|Math.round(s*A.tileAnchorX+u*A.tileAnchorY)),h.push(A.featureIndex)}return v.sort((T,A)=>g[T]-g[A]||h[A]-h[T]),v}getSortedIndexesByZOffset(){if(!this.zOffsetSortDirty)return this.symbolInstanceIndexesSortedZOffset;if(!this.symbolInstanceIndexesSortedZOffset){this.symbolInstanceIndexesSortedZOffset=[];for(let n=0;n<this.symbolInstances.length;++n)this.symbolInstanceIndexesSortedZOffset.push(n)}return this.zOffsetSortDirty=!1,this.symbolInstanceIndexesSortedZOffset.sort((n,s)=>this.symbolInstances.get(s).zOffset-this.symbolInstances.get(n).zOffset)}addToSortKeyRanges(n,s){const u=this.sortKeyRanges[this.sortKeyRanges.length-1];u&&u.sortKey===s?u.symbolInstanceEnd=n+1:this.sortKeyRanges.push({sortKey:s,symbolInstanceStart:n,symbolInstanceEnd:n+1})}sortFeatures(n){if(this.sortFeaturesByY&&this.sortedAngle!==n&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(n),this.sortedAngle=n,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const s of this.symbolInstanceIndexes){const u=this.symbolInstances.get(s);this.featureSortOrder.push(u.featureIndex);const{rightJustifiedTextSymbolIndex:g,centerJustifiedTextSymbolIndex:h,leftJustifiedTextSymbolIndex:v,verticalPlacedTextSymbolIndex:T,placedIconSymbolIndex:A,verticalPlacedIconSymbolIndex:D}=u;g>=0&&this.addIndicesForPlacedSymbol(this.text,g),h>=0&&h!==g&&this.addIndicesForPlacedSymbol(this.text,h),v>=0&&v!==h&&v!==g&&this.addIndicesForPlacedSymbol(this.text,v),T>=0&&this.addIndicesForPlacedSymbol(this.text,T),A>=0&&this.addIndicesForPlacedSymbol(this.icon,A),D>=0&&this.addIndicesForPlacedSymbol(this.icon,D)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let _A,yA,e2;Hn(Y0,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),Y0.addDynamicAttributes=Z0;class bA{constructor(n){this.type=n.property.overrides?n.property.overrides.runtimeType:eu,this.defaultValue=n}evaluate(n){if(n.formattedSection){const s=this.defaultValue.property.overrides;if(s&&s.hasOverride(n.formattedSection))return s.getOverride(n.formattedSection)}return n.feature&&n.featureState?this.defaultValue.evaluate(n.feature,n.featureState):this.defaultValue.property.specification.default}eachChild(n){this.defaultValue.isConstant()||n(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Hn(bA,"FormatSectionOverride",{omit:["defaultValue"]});const t2=()=>e2||(e2={layout:_A||(_A=new Wo({"symbol-placement":new xn(Lt.layout_symbol["symbol-placement"]),"symbol-spacing":new xn(Lt.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new xn(Lt.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new zn(Lt.layout_symbol["symbol-sort-key"]),"symbol-z-order":new xn(Lt.layout_symbol["symbol-z-order"]),"symbol-z-elevate":new xn(Lt.layout_symbol["symbol-z-elevate"]),"symbol-elevation-reference":new xn(Lt.layout_symbol["symbol-elevation-reference"]),"icon-allow-overlap":new xn(Lt.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new xn(Lt.layout_symbol["icon-ignore-placement"]),"icon-optional":new xn(Lt.layout_symbol["icon-optional"]),"icon-rotation-alignment":new xn(Lt.layout_symbol["icon-rotation-alignment"]),"icon-size":new zn(Lt.layout_symbol["icon-size"]),"icon-size-scale-range":new xn(Lt.layout_symbol["icon-size-scale-range"]),"icon-text-fit":new zn(Lt.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new zn(Lt.layout_symbol["icon-text-fit-padding"]),"icon-image":new zn(Lt.layout_symbol["icon-image"]),"icon-rotate":new zn(Lt.layout_symbol["icon-rotate"]),"icon-padding":new xn(Lt.layout_symbol["icon-padding"]),"icon-keep-upright":new xn(Lt.layout_symbol["icon-keep-upright"]),"icon-offset":new zn(Lt.layout_symbol["icon-offset"]),"icon-anchor":new zn(Lt.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new xn(Lt.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new xn(Lt.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new xn(Lt.layout_symbol["text-rotation-alignment"]),"text-field":new zn(Lt.layout_symbol["text-field"]),"text-font":new zn(Lt.layout_symbol["text-font"]),"text-size":new zn(Lt.layout_symbol["text-size"]),"text-size-scale-range":new xn(Lt.layout_symbol["text-size-scale-range"]),"text-max-width":new zn(Lt.layout_symbol["text-max-width"]),"text-line-height":new zn(Lt.layout_symbol["text-line-height"]),"text-letter-spacing":new zn(Lt.layout_symbol["text-letter-spacing"]),"text-justify":new zn(Lt.layout_symbol["text-justify"]),"text-radial-offset":new zn(Lt.layout_symbol["text-radial-offset"]),"text-variable-anchor":new xn(Lt.layout_symbol["text-variable-anchor"]),"text-anchor":new zn(Lt.layout_symbol["text-anchor"]),"text-max-angle":new xn(Lt.layout_symbol["text-max-angle"]),"text-writing-mode":new xn(Lt.layout_symbol["text-writing-mode"]),"text-rotate":new zn(Lt.layout_symbol["text-rotate"]),"text-padding":new xn(Lt.layout_symbol["text-padding"]),"text-keep-upright":new xn(Lt.layout_symbol["text-keep-upright"]),"text-transform":new zn(Lt.layout_symbol["text-transform"]),"text-offset":new zn(Lt.layout_symbol["text-offset"]),"text-allow-overlap":new xn(Lt.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new xn(Lt.layout_symbol["text-ignore-placement"]),"text-optional":new xn(Lt.layout_symbol["text-optional"]),visibility:new xn(Lt.layout_symbol.visibility)})),paint:yA||(yA=new Wo({"icon-opacity":new zn(Lt.paint_symbol["icon-opacity"]),"icon-occlusion-opacity":new zn(Lt.paint_symbol["icon-occlusion-opacity"]),"icon-emissive-strength":new zn(Lt.paint_symbol["icon-emissive-strength"]),"text-emissive-strength":new zn(Lt.paint_symbol["text-emissive-strength"]),"icon-color":new zn(Lt.paint_symbol["icon-color"]),"icon-halo-color":new zn(Lt.paint_symbol["icon-halo-color"]),"icon-halo-width":new zn(Lt.paint_symbol["icon-halo-width"]),"icon-halo-blur":new zn(Lt.paint_symbol["icon-halo-blur"]),"icon-translate":new xn(Lt.paint_symbol["icon-translate"]),"icon-translate-anchor":new xn(Lt.paint_symbol["icon-translate-anchor"]),"icon-image-cross-fade":new zn(Lt.paint_symbol["icon-image-cross-fade"]),"text-opacity":new zn(Lt.paint_symbol["text-opacity"]),"text-occlusion-opacity":new zn(Lt.paint_symbol["text-occlusion-opacity"]),"text-color":new zn(Lt.paint_symbol["text-color"],{runtimeType:Yi,getOverride:c=>c.textColor,hasOverride:c=>!!c.textColor}),"text-halo-color":new zn(Lt.paint_symbol["text-halo-color"]),"text-halo-width":new zn(Lt.paint_symbol["text-halo-width"]),"text-halo-blur":new zn(Lt.paint_symbol["text-halo-blur"]),"text-translate":new xn(Lt.paint_symbol["text-translate"]),"text-translate-anchor":new xn(Lt.paint_symbol["text-translate-anchor"]),"icon-color-saturation":new xn(Lt.paint_symbol["icon-color-saturation"]),"icon-color-contrast":new xn(Lt.paint_symbol["icon-color-contrast"]),"icon-color-brightness-min":new xn(Lt.paint_symbol["icon-color-brightness-min"]),"icon-color-brightness-max":new xn(Lt.paint_symbol["icon-color-brightness-max"]),"symbol-z-offset":new zn(Lt.paint_symbol["symbol-z-offset"]),"icon-color-use-theme":new zn({type:"string",default:"default","property-type":"data-driven"}),"icon-halo-color-use-theme":new zn({type:"string",default:"default","property-type":"data-driven"}),"text-color-use-theme":new zn({type:"string",default:"default","property-type":"data-driven"}),"text-halo-color-use-theme":new zn({type:"string",default:"default","property-type":"data-driven"})}))},e2);class X0 extends Di{constructor(n,s,u,g){super(n,t2(),s,u,g),this._colorAdjustmentMatrix=Fe.mat4.identity([]),this.hasInitialOcclusionOpacityProperties=n.paint!==void 0&&("icon-occlusion-opacity"in n.paint||"text-occlusion-opacity"in n.paint)}recalculate(n,s){super.recalculate(n,s),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const u=this.layout.get("text-writing-mode");if(u){const g=[];for(const h of u)g.indexOf(h)<0&&g.push(h);this.layout._values["text-writing-mode"]=g}else this.layout._values["text-writing-mode"]=this.layout.get("symbol-placement")==="point"?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getColorAdjustmentMatrix(n,s,u,g){return this._saturation===n&&this._contrast===s&&this._brightnessMin===u&&this._brightnessMax===g||(this._colorAdjustmentMatrix=function(h,v,T,A){h=ga(h),v=kl(v);const D=Fe.mat4.create(),x=h/3,P=1-2*x,L=[P,x,x,0,x,P,x,0,x,x,P,0,0,0,0,1],I=.5-.5*v,R=A-T;return Fe.mat4.multiply(D,[R,0,0,0,0,R,0,0,0,0,R,0,T,T,T,1],[v,0,0,0,0,v,0,0,0,0,v,0,I,I,I,1]),Fe.mat4.multiply(D,D,L),D}(n,s,u,g),this._saturation=n,this._contrast=s,this._brightnessMin=u,this._brightnessMax=g),this._colorAdjustmentMatrix}getValueAndResolveTokens(n,s,u,g){const h=this.layout.get(n).evaluate(s,{},u,g),v=this._unevaluatedLayout._values[n];return v.isDataDriven()||od(v.value)||!h?h:function(T,A){return A.replace(/{([^{}]+)}/g,(D,x)=>x in T?String(T[x]):"")}(s.properties,h)}createBucket(n){return new Y0(n)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const n of t2().paint.overridableProperties){if(!X0.hasPaintOverride(this.layout,n))continue;const s=this.paint.get(n),u=new bA(s),g=new hp(u,s.property.specification,this.scope,this.options);let h=null;h=s.value.kind==="constant"||s.value.kind==="source"?new fp("source",g):new Ah("composite",g,s.value.zoomStops,s.value._interpolationType),this.paint._values[n]=new ld(s.property,h,s.parameters)}}_handleOverridablePaintPropertyUpdate(n,s,u){return!(!this.layout||s.isDataDriven()||u.isDataDriven())&&X0.hasPaintOverride(this.layout,n)}static hasPaintOverride(n,s){const u=n.get("text-field"),g=t2().paint.properties[s];let h=!1;const v=T=>{for(const A of T)if(g.overrides&&g.overrides.hasOverride(A))return void(h=!0)};if(u.value.kind==="constant"&&u.value.value instanceof Xi)v(u.value.value.sections);else if(u.value.kind==="source"){const T=D=>{h||(D instanceof Bi&&Yo(D.value)===rl?v(D.value.sections):D instanceof tu?v(D.sections):D.eachChild(T))},A=u.value;A._styleExpression&&T(A._styleExpression.expression)}return h}getProgramIds(){return["symbol"]}getDefaultProgramParams(n,s,u){return{config:new _u(this,{zoom:s,lut:u}),overrideFog:!1}}}let xA,wA,SA,TA;var n2=so([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);function r2(c){switch(c){case WebGL2RenderingContext.RGBA8:return WebGL2RenderingContext.RGBA;case WebGL2RenderingContext.DEPTH_COMPONENT16:return WebGL2RenderingContext.DEPTH_COMPONENT;case WebGL2RenderingContext.DEPTH24_STENCIL8:return WebGL2RenderingContext.DEPTH_STENCIL;case WebGL2RenderingContext.R8:case WebGL2RenderingContext.R32F:return WebGL2RenderingContext.RED}}function o2(c){switch(c){case WebGL2RenderingContext.RGBA8:return WebGL2RenderingContext.UNSIGNED_BYTE;case WebGL2RenderingContext.DEPTH_COMPONENT16:return WebGL2RenderingContext.UNSIGNED_SHORT;case WebGL2RenderingContext.DEPTH24_STENCIL8:return WebGL2RenderingContext.UNSIGNED_INT_24_8;case WebGL2RenderingContext.R8:return WebGL2RenderingContext.UNSIGNED_BYTE;case WebGL2RenderingContext.R32F:return WebGL2RenderingContext.FLOAT}}class i2{constructor(n,s,u,g){this.context=n,this.format=u,this.useMipmap=g&&g.useMipmap,this.texture=n.gl.createTexture(),this.update(s,{premultiply:g&&g.premultiply})}update(n,s){const u=n&&n instanceof HTMLVideoElement&&n.width===0?n.videoWidth:n.width,g=n&&n instanceof HTMLVideoElement&&n.height===0?n.videoHeight:n.height,{context:h}=this,{gl:v}=h,{x:T,y:A}=s&&s.position?s.position:{x:0,y:0},D=T+u,x=A+g;!this.size||this.size[0]===D&&this.size[1]===x||(v.bindTexture(v.TEXTURE_2D,null),v.deleteTexture(this.texture),this.texture=v.createTexture(),this.size=null),v.bindTexture(v.TEXTURE_2D,this.texture),h.pixelStoreUnpackFlipY.set(!1),h.pixelStoreUnpack.set(1),h.pixelStoreUnpackPremultiplyAlpha.set(this.format===v.RGBA8&&(!s||s.premultiply!==!1));const P=n instanceof HTMLImageElement||n instanceof HTMLCanvasElement||n instanceof HTMLVideoElement||n instanceof ImageData||ImageBitmap&&n instanceof ImageBitmap;if(!this.size&&D>0&&x>0){const L=this.useMipmap?Math.floor(Math.log2(Math.max(D,x)))+1:1;v.texStorage2D(v.TEXTURE_2D,L,this.format,D,x),this.size=[D,x]}if(this.size)if(P)v.texSubImage2D(v.TEXTURE_2D,0,T,A,r2(this.format),o2(this.format),n);else{const L=n.data;L&&v.texSubImage2D(v.TEXTURE_2D,0,T,A,u,g,r2(this.format),o2(this.format),L)}this.useMipmap&&v.generateMipmap(v.TEXTURE_2D)}bind(n,s,u=!1){const{context:g}=this,{gl:h}=g;h.bindTexture(h.TEXTURE_2D,this.texture),n!==this.minFilter&&(h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MAG_FILTER,n),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MIN_FILTER,this.useMipmap&&!u?n===h.NEAREST?h.NEAREST_MIPMAP_NEAREST:h.LINEAR_MIPMAP_LINEAR:n),this.minFilter=n),s!==this.wrapS&&(h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_S,s),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_T,s),this.wrapS=s)}bindExtraParam(n,s,u,g){const{context:h}=this,{gl:v}=h;v.bindTexture(v.TEXTURE_2D,this.texture),s!==this.magFilter&&(v.texParameteri(v.TEXTURE_2D,v.TEXTURE_MAG_FILTER,s),this.magFilter=s),n!==this.minFilter&&(v.texParameteri(v.TEXTURE_2D,v.TEXTURE_MIN_FILTER,this.useMipmap?n===v.NEAREST?v.NEAREST_MIPMAP_NEAREST:v.LINEAR_MIPMAP_LINEAR:n),this.minFilter=n),u!==this.wrapS&&(v.texParameteri(v.TEXTURE_2D,v.TEXTURE_WRAP_S,u),this.wrapS=u),g!==this.wrapT&&(v.texParameteri(v.TEXTURE_2D,v.TEXTURE_WRAP_T,g),this.wrapT=g)}destroy(){const{gl:n}=this.context;n.deleteTexture(this.texture),this.texture=null}}class J0{constructor(n,s){this.context=n,this.texture=s}bind(n,s){const{context:u}=this,{gl:g}=u;g.bindTexture(g.TEXTURE_2D,this.texture),n!==this.minFilter&&(g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MAG_FILTER,n),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MIN_FILTER,n),this.minFilter=n),s!==this.wrapS&&(g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_S,s),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_T,s),this.wrapS=s)}}function Q0(c,n,s,u,g,h,v,T){const A=[c,n,1,s,u,1,g,h,1],D=[v,T,1],x=Fe.mat3.adjoint([],A),[P,L,I]=Fe.vec3.transformMat3(D,D,x);return Fe.mat3.multiply(A,A,[P,0,0,0,L,0,0,0,I])}function CA(c,n,s,u,g,h,v,T){const A=function(D,x,P,L,I,R,V,W){const K=Q0(0,0,1,0,1,1,0,1),re=Q0(D,x,P,L,I,R,V,W),ie=Fe.mat3.adjoint([],K);return Fe.mat3.multiply(re,re,ie)}(c,n,s,u,g,h,v,T);return[A[2]/A[8]/In,A[5]/A[8]/In]}function eb(c){return[c[0],Math.min(Math.max(c[1],-85.051129),ws)]}class EA extends yc{constructor(n,s,u,g){super(),this.id=n,this.dispatcher=u,this.coordinates=s.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.onNorthPole=!1,this.onSouthPole=!1,this.setEventedParent(g),this.options=s,this._dirty=!1}load(n,s){if(this._loaded=s||!1,this.fire(new nl("dataloading",{dataType:"source"})),this.url=this.options.url,!this.url)return n&&(this.coordinates=n),this._loaded=!0,void this._finishLoading();this._imageRequest=sg(this.map._requestManager.transformRequest(this.url,Jr.Image),(u,g)=>{this._imageRequest=null,this._loaded=!0,u?this.fire(new Hf(u)):g&&(this.image=g instanceof HTMLImageElement?je.getImageData(g):g,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,n&&(this.coordinates=n),this._finishLoading())})}loaded(){return this._loaded}updateImage(n){return n.url?(this._imageRequest&&n.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=n.url,this.load(n.coordinates,this._loaded),this):this}setTexture(n){if(!(n.handle instanceof WebGLTexture))throw new Error("The provided handle is not a WebGLTexture instance");return this.texture=new J0(this.map.painter.context,n.handle),this.width=n.dimensions[0],this.height=n.dimensions[1],this._dirty=!1,this._loaded=!0,this._finishLoading(),this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new nl("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(n){this.map=n,this.load()}onRemove(n){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),!this.texture||this.texture instanceof J0||this.texture.destroy(),this.boundsBuffer&&(this.boundsBuffer.destroy(),this.elevatedGlobeVertexBuffer&&this.elevatedGlobeVertexBuffer.destroy(),this.elevatedGlobeIndexBuffer&&this.elevatedGlobeIndexBuffer.destroy())}setCoordinates(n){if(this.coordinates=n,this._boundsArray=void 0,this._unsupportedCoords=!1,!n.length)return this;this.onNorthPole=!1,this.onSouthPole=!1;let s=n[0][1],u=n[0][1];for(const h of n)h[1]>u&&(u=h[1]),h[1]<s&&(s=h[1]);const g=(u+s)/2;if(g>ws?this.onNorthPole=!0:g<-85.051129&&(this.onSouthPole=!0),!this.onNorthPole&&!this.onSouthPole){const h=n.map(l.fromLngLat);this.tileID=function(v){let T=1/0,A=1/0,D=-1/0,x=-1/0;for(const V of v)T=Math.min(T,V.x),A=Math.min(A,V.y),D=Math.max(D,V.x),x=Math.max(x,V.y);const P=Math.max(D-T,x-A),L=Math.max(0,Math.floor(-Math.log(P)/Math.LN2)),I=Math.pow(2,L);let R=Math.floor((T+D)/2*I);return R>1&&(R-=1),new dn(L,R,Math.floor((A+x)/2*I))}(h),this.minzoom=this.maxzoom=this.tileID.z}return this.fire(new nl("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0,this._unsupportedCoords=!1}_prepareData(n){for(const K in this.tiles){const re=this.tiles[K];re.state!=="loaded"&&(re.state="loaded",re.texture=this.texture)}if(this._boundsArray||this.onNorthPole||this.onSouthPole||this._unsupportedCoords)return;const s=Bv(new dn(0,0,0),this.map.transform.projection),u=[s.projection.project(this.coordinates[0][0],this.coordinates[0][1]),s.projection.project(this.coordinates[1][0],this.coordinates[1][1]),s.projection.project(this.coordinates[2][0],this.coordinates[2][1]),s.projection.project(this.coordinates[3][0],this.coordinates[3][1])];if(!function(K){const re=K[1].x-K[0].x,ie=K[1].y-K[0].y,Q=K[2].x-K[1].x,ue=K[2].y-K[1].y,_e=K[3].x-K[2].x,Ee=K[3].y-K[2].y,Ne=K[0].x-K[3].x,ze=K[0].y-K[3].y,De=re*ue-Q*ie,ot=Q*Ee-_e*ue,$e=_e*ze-Ne*Ee,it=Ne*ie-re*ze;return De>0&&ot>0&&$e>0&&it>0||De<0&&ot<0&&$e<0&&it<0}(u))return console.warn("Image source coordinates are defining non-convex area in the Mercator projection"),void(this._unsupportedCoords=!0);const g=Bv(this.tileID,this.map.transform.projection),[h,v,T,A]=this.coordinates.map(K=>{const re=g.projection.project(K[0],K[1]);return hA(g,re)._round()});this.perspectiveTransform=CA(h.x,h.y,v.x,v.y,T.x,T.y,A.x,A.y);const D=this._boundsArray=new Vl;D.emplaceBack(h.x,h.y,0,0),D.emplaceBack(v.x,v.y,In,0),D.emplaceBack(A.x,A.y,0,In),D.emplaceBack(T.x,T.y,In,In),this.boundsBuffer&&(this.boundsBuffer.destroy(),this.elevatedGlobeVertexBuffer&&this.elevatedGlobeVertexBuffer.destroy(),this.elevatedGlobeIndexBuffer&&this.elevatedGlobeIndexBuffer.destroy()),this.boundsBuffer=n.createVertexBuffer(D,n2.members),this.boundsSegments=ei.simpleSegment(0,0,4,2);const x=[],P=[eb((L=this.coordinates)[0]),eb(L[1]),eb(L[2]),eb(L[3])];var L;const[I,R,V,W]=function(K){let re=K[0][0],ie=re,Q=K[0][1],ue=Q;for(let _e=1;_e<K.length;_e++)K[_e][0]<re?re=K[_e][0]:K[_e][0]>ie&&(ie=K[_e][0]),K[_e][1]<Q?Q=K[_e][1]:K[_e][1]>ue&&(ue=K[_e][1]);return[re,Q,ie-re,ue-Q]}(P);{const K=new Vl,[re,ie,Q,ue]=function(xt){let At=xt[0].x,_t=At,Zt=xt[0].y,hn=Zt;for(let Kt=1;Kt<xt.length;Kt++)xt[Kt].x<At?At=xt[Kt].x:xt[Kt].x>_t&&(_t=xt[Kt].x),xt[Kt].y<Zt?Zt=xt[Kt].y:xt[Kt].y>hn&&(hn=xt[Kt].y);return[At,Zt,_t-At,hn-Zt]}(u),_e=xt=>[(xt.x-re)/Q,(xt.y-ie)/ue],[Ee,Ne,ze,De]=u.map(_e),ot=function(xt,At,_t,Zt,hn,Kt,kn,Mn){const _n=Q0(0,0,1,0,1,1,0,1),mn=Q0(xt,At,_t,Zt,hn,Kt,kn,Mn),Zn=Fe.mat3.adjoint([],mn);return Fe.mat3.multiply(_n,_n,Zn)}(Ee[0],Ee[1],Ne[0],Ne[1],ze[0],ze[1],De[0],De[1]);this.elevatedGlobePerspectiveTransform=CA(Ee[0],Ee[1],Ne[0],Ne[1],ze[0],ze[1],De[0],De[1]);const $e=(xt,At)=>{x.push(xt.lng);const _t=Math.round((xt.lng-I)/V*In),Zt=Math.round((xt.lat-R)/W*In),hn=_e(At),Kt=Fe.vec3.transformMat3([],[hn[0],hn[1],1],ot),kn=Math.round(Kt[0]/Kt[2]*In),Mn=Math.round(Kt[1]/Kt[2]*In);K.emplaceBack(_t,Zt,kn,Mn)},it=u[3].x-u[0].x,ft=u[3].y-u[0].y,ut=u[2].x-u[1].x,mt=u[2].y-u[1].y;for(let xt=0;xt<65;xt++){const At=xt/64,_t=[u[0].x+At*it,u[0].y+At*ft],Zt=[u[1].x+At*ut,u[1].y+At*mt],hn=Zt[0]-_t[0],Kt=Zt[1]-_t[1];for(let kn=0;kn<65;kn++){const Mn=kn/64,_n={x:_t[0]+hn*Mn,y:_t[1]+Kt*Mn};$e(s.projection.unproject(_n.x,_n.y),_n)}}this.elevatedGlobeVertexBuffer=n.createVertexBuffer(K,n2.members)}{this.maxLongitudeTriangleSize=0;let K=[],re=new $i;const ie=(Q,ue,_e)=>{re.emplaceBack(Q,ue,_e);const Ee=x[Q],Ne=x[ue],ze=x[_e],De=Math.min(Math.min(Ee,Ne),ze),ot=Math.max(Math.max(Ee,Ne),ze)-De;ot>this.maxLongitudeTriangleSize&&(this.maxLongitudeTriangleSize=ot),K.push(De+ot/2)};for(let Q=0;Q<64;Q++)for(let ue=0;ue<64;ue++){const _e=65*Q+ue,Ee=_e+1,Ne=_e+65,ze=Ne+1;ie(_e,Ne,Ee),ie(Ee,Ne,ze)}[K,re]=function(Q,ue){const _e=Array.from({length:Q.length},(ze,De)=>De);_e.sort((ze,De)=>Q[ze]-Q[De]);const Ee=[],Ne=new $i;for(let ze=0;ze<_e.length;ze++){const De=_e[ze];Ee.push(Q[De]);const ot=3*De,$e=ot+1;Ne.emplaceBack(ue.uint16[ot],ue.uint16[$e],ue.uint16[$e+1])}return[Ee,Ne]}(K,re),this.elevatedGlobeTrianglesCenterLongitudes=K,this.elevatedGlobeIndexBuffer=n.createIndexBuffer(re)}this.elevatedGlobeSegments=ei.simpleSegment(0,0,4225,8192),this.elevatedGlobeGridMatrix=new Float32Array([0,V/In,0,W/In,0,0,R,I,0])}prepare(){const n=Object.keys(this.tiles).length!==0;if(this.tileID&&!n)return;const s=this.map.painter.context,u=s.gl;!this._dirty||this.texture instanceof J0||(this.texture?this.texture.update(this.image):(this.texture=new i2(s,this.image,u.RGBA8),this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE)),this._dirty=!1),n&&this._prepareData(s)}loadTile(n,s){this.tileID&&this.tileID.equals(n.tileID.canonical)?(this.tiles[String(n.tileID.wrap)]=n,n.buckets={},s(null)):(n.state="errored",s(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}getSegmentsForLongitude(n){const s=this.elevatedGlobeSegments;if(!this.elevatedGlobeTrianglesCenterLongitudes||!s)return null;const u=this.elevatedGlobeTrianglesCenterLongitudes;let g=(h=n+180)+360*Math.round((u[0]-h)/360);var h;const v=new ei,T=(P,L)=>{v.segments.push({vertexOffset:0,primitiveOffset:P,vertexLength:s.segments[0].vertexLength,primitiveLength:L,sortKey:void 0,vaos:{}})},A=.51*this.maxLongitudeTriangleSize;if(Math.abs(u[0]-g)<=A){const P=Gs(u,0,u.length,g+A);return P===u.length||T(P,Fi(u,P+1,u.length,g+360-A)-P),v}g<u[0]&&(g+=360);const D=Fi(u,0,u.length,g-A);if(D===u.length)return T(0,u.length),v;T(0,D-0);const x=Gs(u,D+1,u.length,g+A);return x!==u.length&&T(x,u.length-x),v}}const gV=(Math.pow(256,2)-1)/16907520;class MA extends Di{constructor(n,s,u,g){super(n,{layout:SA||(SA=new Wo({visibility:new xn(Lt.layout_raster.visibility)})),paint:TA||(TA=new Wo({"raster-opacity":new xn(Lt.paint_raster["raster-opacity"]),"raster-color":new ud(Lt.paint_raster["raster-color"]),"raster-color-mix":new xn(Lt.paint_raster["raster-color-mix"]),"raster-color-range":new xn(Lt.paint_raster["raster-color-range"]),"raster-hue-rotate":new xn(Lt.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new xn(Lt.paint_raster["raster-brightness-min"]),"raster-brightness-max":new xn(Lt.paint_raster["raster-brightness-max"]),"raster-saturation":new xn(Lt.paint_raster["raster-saturation"]),"raster-contrast":new xn(Lt.paint_raster["raster-contrast"]),"raster-resampling":new xn(Lt.paint_raster["raster-resampling"]),"raster-fade-duration":new xn(Lt.paint_raster["raster-fade-duration"]),"raster-emissive-strength":new xn(Lt.paint_raster["raster-emissive-strength"]),"raster-array-band":new xn(Lt.paint_raster["raster-array-band"]),"raster-elevation":new xn(Lt.paint_raster["raster-elevation"]),"raster-color-use-theme":new zn({type:"string",default:"default","property-type":"data-driven"})}))},s,u,g),this.updateColorRamp(),this._curRampRange=[NaN,NaN]}getProgramIds(){return["raster"]}hasColorMap(){return!!this._transitionablePaint._values["raster-color"].value.value}tileCoverLift(){return this.paint.get("raster-elevation")}isDraped(n){return!(n&&n._source instanceof EA&&(n._source.onNorthPole||n._source.onSouthPole))&&this.paint.get("raster-elevation")===0}_handleSpecialPaintPropertyUpdate(n){n!=="raster-color"&&n!=="raster-color-range"||(this._curRampRange=[NaN,NaN],this.updateColorRamp())}updateColorRamp(n){if(!this.hasColorMap()||!this._curRampRange)return;const s=this._transitionablePaint._values["raster-color"].value.expression,[u,g]=n||this._transitionablePaint._values["raster-color-range"].value.expression.evaluate({zoom:0})||[NaN,NaN];isNaN(u)&&isNaN(g)||u===this._curRampRange[0]&&g===this._curRampRange[1]||(this.colorRamp=Tv({expression:s,evaluationKey:"rasterValue",image:this.colorRamp,clips:[{start:u,end:g}],resolution:256}),this.colorRampTexture=null,this._curRampRange=[u,g])}}let IA,AA,kA,PA,RA;class OA extends Di{constructor(n,s,u,g){super(n,{layout:IA||(IA=new Wo({visibility:new xn(Lt["layout_raster-particle"].visibility)})),paint:AA||(AA=new Wo({"raster-particle-array-band":new xn(Lt["paint_raster-particle"]["raster-particle-array-band"]),"raster-particle-count":new xn(Lt["paint_raster-particle"]["raster-particle-count"]),"raster-particle-color":new ud(Lt["paint_raster-particle"]["raster-particle-color"]),"raster-particle-max-speed":new xn(Lt["paint_raster-particle"]["raster-particle-max-speed"]),"raster-particle-speed-factor":new xn(Lt["paint_raster-particle"]["raster-particle-speed-factor"]),"raster-particle-fade-opacity-factor":new xn(Lt["paint_raster-particle"]["raster-particle-fade-opacity-factor"]),"raster-particle-reset-rate-factor":new xn(Lt["paint_raster-particle"]["raster-particle-reset-rate-factor"]),"raster-particle-elevation":new xn(Lt["paint_raster-particle"]["raster-particle-elevation"]),"raster-particle-color-use-theme":new zn({type:"string",default:"default","property-type":"data-driven"})}))},s,u,g),this._updateColorRamp(),this.lastInvalidatedAt=je.now()}onRemove(n){this.colorRampTexture&&this.colorRampTexture.destroy(),this.tileFramebuffer&&this.tileFramebuffer.destroy(),this.particleFramebuffer&&this.particleFramebuffer.destroy()}hasColorMap(){return!!this._transitionablePaint._values["raster-particle-color"].value.value}getProgramIds(){return["rasterParticle"]}hasOffscreenPass(){return this.visibility!=="none"}isDraped(n){return!1}_handleSpecialPaintPropertyUpdate(n){n!=="raster-particle-color"&&n!=="raster-particle-max-speed"||(this._updateColorRamp(),this._invalidateAnimationState()),n==="raster-particle-count"&&this._invalidateAnimationState()}_updateColorRamp(){if(!this.hasColorMap())return;const n=this._transitionablePaint._values["raster-particle-color"].value.expression,s=this._transitionablePaint._values["raster-particle-max-speed"].value.expression.evaluate({zoom:0});this.colorRamp=Tv({expression:n,evaluationKey:"rasterParticleSpeed",image:this.colorRamp,clips:[{start:0,end:s}],resolution:256}),this.colorRampTexture=null}_invalidateAnimationState(){this.lastInvalidatedAt=je.now()}tileCoverLift(){return this.paint.get("raster-particle-elevation")}}class vV extends Di{constructor(n,s){super(n,{},s,null),this.implementation=n,n.slot&&(this.slot=n.slot)}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}isDraped(n){return this.implementation.renderToTile!==void 0}shouldRedrape(){return!!this.implementation.shouldRerenderTiles&&this.implementation.shouldRerenderTiles()}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(n){this.implementation.onAdd&&this.implementation.onAdd(n,n.painter.context.gl)}onRemove(n){this.implementation.onRemove&&this.implementation.onRemove(n,n.painter.context.gl)}}function s2(c,n,s){const u=[0,0,1],g=Fe.quat.identity([]);return Fe.quat.rotateY(g,g,s?-Ot(c)+Math.PI:Ot(c)),Fe.quat.rotateX(g,g,-Ot(n)),Fe.vec3.transformQuat(u,u,g),Fe.vec3.normalize(u,u)}function LA(c,n){const s=tb(c.projection,c.zoom,c.width,c.height),u=function(h,v,T,A,D){const x=new Qr(T.lng-180*Td,T.lat),P=new Qr(T.lng+180*Td,T.lat),L=h.project(x.lng,x.lat),I=h.project(P.lng,P.lat),R=-Math.atan2(I.y-L.y,I.x-L.x),V=l.fromLngLat(T);V.y=It(V.y,-1+Td,1-Td);const W=V.toLngLat(),K=h.project(W.lng,W.lat),re=l.fromLngLat(W);re.x+=Td;const ie=re.toLngLat(),Q=h.project(ie.lng,ie.lat),ue=zA(Q.x-K.x,Q.y-K.y,R),_e=l.fromLngLat(W);_e.y+=Td;const Ee=_e.toLngLat(),Ne=h.project(Ee.lng,Ee.lat),ze=zA(Ne.x-K.x,Ne.y-K.y,R),De=Math.abs(ue.x)/Math.abs(ze.y),ot=Fe.mat4.identity([]);Fe.mat4.rotateZ(ot,ot,-R*(1-(D?0:A)));const $e=Fe.mat4.identity([]);return Fe.mat4.scale($e,$e,[1,1-(1-De)*A,1]),$e[4]=-ze.x/ze.y*A,Fe.mat4.rotateZ($e,$e,R),Fe.mat4.multiply($e,ot,$e),$e}(c.projection,0,c.center,s,n),g=DA(c);return Fe.mat4.scale(u,u,[g,g,1]),u}function DA(c){const n=c.projection,s=tb(c.projection,c.zoom,c.width,c.height),u=a2(n,c.center),g=a2(n,Qr.convert(n.center));return Math.pow(2,u*s+(1-s)*g)}function tb(c,n,s,u,g=1/0){const h=c.range;if(!h)return 0;const v=Math.min(g,Math.max(s,u)),T=Math.log(v/1024)/Math.LN2;return Sn(h[0]+T,h[1]+T,n)}const Td=1/4e4;function a2(c,n){const s=It(n.lat,-85.051129,ws),u=new Qr(n.lng-180*Td,s),g=new Qr(n.lng+180*Td,s),h=c.project(u.lng,s),v=c.project(g.lng,s),T=l.fromLngLat(u),A=l.fromLngLat(g),D=v.x-h.x,x=v.y-h.y,P=A.x-T.x,L=A.y-T.y,I=Math.sqrt((P*P+L*L)/(D*D+x*x));return Math.log(I)/Math.LN2}function zA(c,n,s){const u=Math.cos(s),g=Math.sin(s);return{x:c*u-n*g,y:c*g+n*u}}function FA(c,n,s){Fe.mat4.identity(c),Fe.mat4.rotateZ(c,c,Ot(n[2])),Fe.mat4.rotateX(c,c,Ot(n[0])),Fe.mat4.rotateY(c,c,Ot(n[1])),Fe.mat4.scale(c,c,s),Fe.mat4.multiply(c,c,[1,0,0,0,0,0,1,0,0,1,0,0,0,0,0,1])}function nb(c,n,s,u,g,h,v,T){const A=[s[0]-n[0],s[1]-n[1],0],D=[u[0]-n[0],u[1]-n[1],0];if(Fe.vec3.length(A)<1e-12||Fe.vec3.length(D)<1e-12)return Fe.quat.identity(c);const x=Fe.vec3.cross([],A,D);Fe.vec3.normalize(x,x),Fe.vec3.subtract(D,u,n),A[2]=(h-g)*T,D[2]=(v-g)*T;const P=A;return Fe.vec3.cross(P,A,D),Fe.vec3.normalize(P,P),Fe.quat.rotationTo(c,x,P)}function l2(c,n,s=!1){const u=Ss(n.zoom),g=function(h,v,T){const A=v.worldSize,D=[h[12],h[13],h[14]],x=Ui(D[1]/A),P=Ds(D[0]/A),L=Fe.mat4.identity([]),I=fs(1,x)*A,R=fs(1,0)*A*_d(x,v.zoom),V=1/es(A);let W=R*V;if(T){const Q=tb(v.projection,v.zoom,v.width,v.height,1024);W=V*v.projection.pixelSpaceConversion(v.center.lat,A,Q)}const K=yu(x,P);Fe.vec3.add(K,K,Fe.vec3.scale([],Fe.vec3.normalize([],K),I*W*D[2]));const re=function(Q){const ue=[Q[0],Q[1],Q[2]];let _e=[0,1,0];const Ee=Fe.vec3.cross([],_e,ue);return Fe.vec3.cross(_e,ue,Ee),Fe.vec3.squaredLength(_e)===0&&(_e=[0,1,0],Fe.vec3.cross(Ee,ue,_e)),Fe.vec3.normalize(Ee,Ee),Fe.vec3.normalize(_e,_e),Fe.vec3.normalize(ue,ue),[Ee[0],Ee[1],Ee[2],0,_e[0],_e[1],_e[2],0,ue[0],ue[1],ue[2],0,Q[0],Q[1],Q[2],1]}(K);Fe.mat4.scale(L,L,[W,W,W*I]),Fe.mat4.translate(L,L,[-D[0],-D[1],-D[2]]);const ie=Fe.mat4.multiply([],v.globeMatrix,re);return Fe.mat4.multiply(ie,ie,L),Fe.mat4.multiply(ie,ie,h),ie}(c,n,s);if(u>0){const h=function(v,T){const A=T.worldSize,D=fs(1,0)*A*_d(T.center.lat,T.zoom)/es(A),x=fs(1,T.center.lat)*A,P=Fe.mat4.identity([]);return Fe.mat4.rotateY(P,P,Ot(T.center.lng)),Fe.mat4.rotateX(P,P,Ot(T.center.lat)),Fe.mat4.translate(P,P,[0,0,hs]),Fe.mat4.scale(P,P,[D,D,D*x]),Fe.mat4.translate(P,P,[T.point.x-.5*A,T.point.y-.5*A,0]),Fe.mat4.multiply(P,P,v),Fe.mat4.multiply(P,T.globeMatrix,P)}(c,n);return function(v,T,A){const D=(R,V,W)=>{const K=Fe.vec3.length(R),re=Fe.vec3.length(V),ie=xi(R,V,W);return Fe.vec3.scale(ie,ie,1/Fe.vec3.length(ie)*cr(K,re,W))},x=D([v[0],v[1],v[2]],[T[0],T[1],T[2]],A),P=D([v[4],v[5],v[6]],[T[4],T[5],T[6]],A),L=D([v[8],v[9],v[10]],[T[8],T[9],T[10]],A),I=xi([v[12],v[13],v[14]],[T[12],T[13],T[14]],A);return[x[0],x[1],x[2],0,P[0],P[1],P[2],0,L[0],L[1],L[2],0,I[0],I[1],I[2],1]}(g,h,u)}return g}function NA(c,n,s,u){const g=Jn.projectAabbCorners(u,s);let h=Number.MAX_VALUE,v=-1;for(let D=0;D<g.length;++D){const x=g[D];x[0]=(.5*x[0]+.5)*n.width,x[1]=(.5-.5*x[1])*n.height,x[2]<h&&(v=D,h=x[2])}const T=D=>new Qe(g[D][0],g[D][1]);let A;switch(v){case 0:case 6:A=[T(1),T(5),T(4),T(7),T(3),T(2),T(1)];break;case 1:case 7:A=[T(0),T(4),T(5),T(6),T(2),T(3),T(0)];break;case 3:case 5:A=[T(1),T(0),T(4),T(7),T(6),T(2),T(1)];break;default:A=[T(1),T(5),T(6),T(7),T(3),T(0),T(1)]}if(ve(c,A))return h}const _V=so([{name:"a_pos_3f",components:3,type:"Float32"}]),yV=so([{name:"a_color_3f",components:3,type:"Float32"}]),bV=so([{name:"a_color_4f",components:4,type:"Float32"}]),xV=so([{name:"a_uv_2f",components:2,type:"Float32"}]),wV=so([{name:"a_normal_3f",components:3,type:"Float32"}]),SV=so([{name:"a_normal_matrix0",components:4,type:"Float32"},{name:"a_normal_matrix1",components:4,type:"Float32"},{name:"a_normal_matrix2",components:4,type:"Float32"},{name:"a_normal_matrix3",components:4,type:"Float32"}]),TV=so([{name:"a_pbr",components:4,type:"Uint16"},{name:"a_heightBasedEmissiveStrength",components:3,type:"Float32"}]),BA={None:0,Model:1,Symbol:2,FillExtrusion:4,All:7};class rb{constructor(n,s,u,g){this.message=(n?`${n}: `:"")+u,g&&(this.identifier=g),s!=null&&s.__line__&&(this.line=s.__line__)}}function VA(c,n){const s=c.indexOf("://")===-1;try{return new URL(c,s&&n?"http://example.com":void 0),!0}catch{return!1}}class $A{constructor(n,s){this.feature=n,this.instancedDataOffset=s,this.instancedDataCount=0,this.rotation=[0,0,0],this.scale=[1,1,1],this.translation=[0,0,0]}}class UA{constructor(){this.instancedDataArray=new Vh,this.instancesEvaluatedElevation=[],this.features=[],this.idToFeaturesIndex={}}}class c2{constructor(n){this.zoom=n.zoom,this.canonical=n.canonical,this.layers=n.layers,this.layerIds=this.layers.map(s=>s.fqid),this.projection=n.projection,this.index=n.index,this.hasZoomDependentProperties=this.layers[0].isZoomDependent(),this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id),this.hasPattern=!1,this.instancesPerModel={},this.validForExaggeration=0,this.maxVerticalOffset=0,this.maxScale=0,this.maxHeight=0,this.lookupDim=this.zoom>this.canonical.z?256:this.zoom>15?75:100,this.instanceCount=0,this.terrainElevationMin=0,this.terrainElevationMax=0,this.validForDEMTile={id:null,timestamp:0},this.modelUris=[],this.modelsRequested=!1,this.activeReplacements=[],this.replacementUpdateTime=0}updateFootprints(n,s){}populate(n,s,u,g){this.tileToMeter=o(u);const h=this.layers[0]._featureFilter.needGeometry;this.lookup=new Uint8Array(this.lookupDim*this.lookupDim);for(const{feature:v,id:T,index:A,sourceLayerIndex:D}of n){const x=T??(v.properties&&v.properties.hasOwnProperty("id")?v.properties.id:void 0),P=Z(v,h);if(!this.layers[0]._featureFilter.filter(new zo(this.zoom),P,u))continue;const L={id:x,sourceLayerIndex:D,index:A,geometry:h?P.geometry:G(v,u,g),properties:v.properties,type:v.type,patterns:{}},I=this.addFeature(L,L.geometry,P);I&&s.featureIndex.insert(v,L.geometry,A,D,this.index,this.instancesPerModel[I].instancedDataArray.length,In/32)}this.lookup=null}update(n,s,u,g){for(const h in this.instancesPerModel){const v=this.instancesPerModel[h];for(const T in n)v.idToFeaturesIndex.hasOwnProperty(T)&&(this.evaluate(v.features[v.idToFeaturesIndex[T]],n[T],v,!0),this.uploaded=!1)}this.maxHeight=0}updateZoomBasedPaintProperties(){if(!this.hasZoomDependentProperties)return!1;let n=!1;for(const s in this.instancesPerModel){const u=this.instancesPerModel[s];for(const g of u.features){const h=this.layers[0],v=g.feature,T=this.canonical,A=h.paint.get("model-rotation").evaluate(v,{},T),D=h.paint.get("model-scale").evaluate(v,{},T),x=h.paint.get("model-translation").evaluate(v,{},T);Fe.vec3.exactEquals(g.rotation,A)&&Fe.vec3.exactEquals(g.scale,D)&&Fe.vec3.exactEquals(g.translation,x)||(this.evaluate(g,g.featureStates,u,!0),n=!0)}}return n}updateReplacement(n,s,u,g){if(s.updateTime===this.replacementUpdateTime)return!1;this.replacementUpdateTime=s.updateTime;const h=s.getReplacementRegionsForTile(n.toUnwrapped(),!0);if(Lw(this.activeReplacements,h))return!1;this.activeReplacements=h;let v=!1;for(const T in this.instancesPerModel){const A=this.instancesPerModel[T],D=A.instancedDataArray;for(const x of A.features){const P=x.instancedDataOffset,L=x.instancedDataCount;for(let I=0;I<L;I++){const R=16*(I+P);let V=D.float32[R+0];const W=V>In;V=W?V-In:V;const K=Math.floor(V),re=D.float32[R+1];let ie=!1;for(const Q of this.activeReplacements)if(!rI(Q,u,BA.Model,g)&&!(Q.min.x>K||K>Q.max.x||Q.min.y>re||re>Q.max.y)&&(ie=cI(lI(K,re,n.canonical,Q.footprintTileId.canonical),Q.footprint),ie))break;D.float32[R]=ie?V+In:V,v=v||ie!==W}}}return v}isEmpty(){for(const n in this.instancesPerModel)if(this.instancesPerModel[n].instancedDataArray.length!==0)return!1;return!0}uploadPending(){return!this.uploaded}upload(n){if(!this.uploaded)for(const s in this.instancesPerModel){const u=this.instancesPerModel[s];u.instancedDataArray.length<0||u.instancedDataArray.length===0||(u.instancedDataBuffer?u.instancedDataBuffer.updateData(u.instancedDataArray):u.instancedDataBuffer=n.createVertexBuffer(u.instancedDataArray,SV.members,!0,void 0,this.instanceCount))}this.uploaded=!0}destroy(){for(const s in this.instancesPerModel){const u=this.instancesPerModel[s];u.instancedDataArray.length!==0&&u.instancedDataBuffer&&u.instancedDataBuffer.destroy()}const n=this.layers[0].modelManager;if(n&&this.modelUris)for(const s of this.modelUris)n.removeModel(s,"")}addFeature(n,s,u){const g=this.layers[0],h=g.layout.get("model-id").evaluate(u,{},this.canonical);if(!h)return wn(`modelId is not evaluated for layer ${g.id} and it is not going to get rendered.`),h;VA(h,!1)&&(this.modelUris.includes(h)||this.modelUris.push(h)),this.instancesPerModel[h]||(this.instancesPerModel[h]=new UA);const v=this.instancesPerModel[h],T=v.instancedDataArray,A=new $A(u,T.length);for(const D of s)for(const x of D){if(x.x<0||x.x>=In||x.y<0||x.y>=In)continue;const P=(this.lookupDim-1)/In,L=this.lookupDim*(x.y*P|0)+x.x*P|0;if(this.lookup){if(this.lookup[L]!==0)continue;this.lookup[L]=1}this.instanceCount++;const I=T.length;T.resize(I+1),v.instancesEvaluatedElevation.push(0),T.float32[16*I]=x.x,T.float32[16*I+1]=x.y}return A.instancedDataCount=v.instancedDataArray.length-A.instancedDataOffset,A.instancedDataCount>0&&(n.id&&(v.idToFeaturesIndex[n.id]=v.features.length),v.features.push(A),this.evaluate(A,{},v,!1)),h}getModelUris(){return this.modelUris}evaluate(n,s,u,g){const h=this.layers[0],v=n.feature,T=this.canonical,A=n.rotation=h.paint.get("model-rotation").evaluate(v,s,T),D=n.scale=h.paint.get("model-scale").evaluate(v,s,T),x=n.translation=h.paint.get("model-translation").evaluate(v,s,T),P=h.paint.get("model-color").evaluate(v,s,T);P.a=h.paint.get("model-color-mix-intensity").evaluate(v,s,T);const L=[];this.maxVerticalOffset<x[2]&&(this.maxVerticalOffset=x[2]),this.maxScale=Math.max(Math.max(this.maxScale,D[0]),Math.max(D[1],D[2])),FA(L,A,D);const I=Math.round(100*P.a)+P.b/1.05;for(let R=0;R<n.instancedDataCount;++R){const V=n.instancedDataOffset+R,W=16*V,K=u.instancedDataArray.float32;let re=0;g&&(re=K[W+6]-u.instancesEvaluatedElevation[V]);const ie=0|K[W+1];K[W]=(0|K[W])+P.r/1.05,K[W+1]=ie+P.g/1.05,K[W+2]=I,K[W+3]=1/(T.z>10?this.tileToMeter:o(T,ie)),K[W+4]=x[0],K[W+5]=x[1],K[W+6]=x[2]+re,K[W+7]=L[0],K[W+8]=L[1],K[W+9]=L[2],K[W+10]=L[4],K[W+11]=L[5],K[W+12]=L[6],K[W+13]=L[8],K[W+14]=L[9],K[W+15]=L[10],u.instancesEvaluatedElevation[V]=x[2]}}}let jA,HA;Hn(c2,"ModelBucket",{omit:["layers"]}),Hn(UA,"PerModelAttributes"),Hn($A,"ModelFeature");const ef=64,Up={CoordinateSpaceTile:1,CoordinateSpaceYUp:2,HasMapboxMeshFeatures:4,HasMeshoptCompression:8};function GA(c,n,s,u,g,h,v,T,A,D=!1){const x=s.zoom,P=s.project(u),L=_d(u.lat,x),I=1/L;Fe.mat4.identity(c),Fe.mat4.translate(c,c,[P.x+v[0]*I,P.y+v[1]*I,v[2]]);let R=1,V=1;const W=s.worldSize;if(D){if(s.projection.name==="mercator"){let Q=0;s.elevation&&(Q=s.elevation.getAtPointOrZero(new l(P.x/W,P.y/W),0));const ue=Fe.vec4.transformMat4([],[P.x,P.y,Q,1],s.projMatrix)[3]/s.cameraToCenterDistance;R=ue,V=ue*_d(s.center.lat,x)}else if(s.projection.name==="globe"){const Q=l2(c,s),ue=Fe.mat4.multiply([],s.projMatrix,Q),_e=[0,0,0,1];Fe.vec4.transformMat4(_e,_e,ue);const Ee=_e[3]/s.cameraToCenterDistance,Ne=Ss(x),ze=s.projection.pixelsPerMeter(u.lat,W)*_d(u.lat,x),De=s.projection.pixelsPerMeter(s.center.lat,W)*_d(s.center.lat,x);R=Ee/cr(ze,wv(s.center.lat),Ne),V=Ee*L/ze,R*=De,V*=De}}else R=I;Fe.mat4.scale(c,c,[R,R,V]);const K=[...c],re=n.orientation,ie=[];if(FA(ie,[re[0]+g[0],re[1]+g[1],re[2]+g[2]],h),Fe.mat4.multiply(c,K,ie),T&&s.elevation){let Q=0;const ue=[];if(A&&s.elevation){Q=function(Ne,ze,De,ot,$e){const it=ze.elevation;if(!it)return 0;const ft=Jn.projectAabbCorners(De,ot),ut=fs(1,$e.lat)*ze.worldSize,mt=function(Zn,Rn){const Fn=[0,0,1],pr=[{corners:[0,1,3,2],dotProductWithUp:0},{corners:[1,5,2,6],dotProductWithUp:0},{corners:[0,4,1,5],dotProductWithUp:0},{corners:[2,6,3,7],dotProductWithUp:0},{corners:[4,7,5,6],dotProductWithUp:0},{corners:[0,3,4,7],dotProductWithUp:0}];for(const Ir of pr){const Ar=Zn[Ir.corners[0]],kr=Zn[Ir.corners[1]],Nr=Zn[Ir.corners[2]],Vr=[kr[0]-Ar[0],kr[1]-Ar[1],Rn*(kr[2]-Ar[2])],ko=Fe.vec3.cross(Vr,Vr,[Nr[0]-Ar[0],Nr[1]-Ar[1],Rn*(Nr[2]-Ar[2])]);Fe.vec3.normalize(ko,ko),Ir.dotProductWithUp=Fe.vec3.dot(ko,Fn)}return pr.sort((Ir,Ar)=>Ir.dotProductWithUp-Ar.dotProductWithUp),pr[0].corners}(ft,ut),xt=ft[mt[0]],At=ft[mt[1]],_t=ft[mt[2]],Zt=ft[mt[3]],hn=it.getAtPointOrZero(new l(xt[0]/ze.worldSize,xt[1]/ze.worldSize),0),Kt=it.getAtPointOrZero(new l(At[0]/ze.worldSize,At[1]/ze.worldSize),0),kn=it.getAtPointOrZero(new l(_t[0]/ze.worldSize,_t[1]/ze.worldSize),0),Mn=it.getAtPointOrZero(new l(Zt[0]/ze.worldSize,Zt[1]/ze.worldSize),0),_n=(hn+Mn)/2,mn=(Kt+kn)/2;return _n>mn?Kt<kn?nb(Ne,At,Zt,xt,Kt,Mn,hn,ut):nb(Ne,_t,xt,Zt,kn,hn,Mn,ut):hn<Mn?nb(Ne,xt,At,_t,hn,Kt,kn,ut):nb(Ne,Zt,_t,At,Mn,kn,Kt,ut),Math.max(_n,mn)}(ue,s,n.aabb,c,u);const _e=Fe.mat4.fromQuat([],ue),Ee=Fe.mat4.multiply([],_e,ie);Fe.mat4.multiply(c,K,Ee)}else Q=s.elevation.getAtPointOrZero(new l(P.x/W,P.y/W),0);Q!==0&&(c[14]+=Q)}}function Hv(c,n,s=!1){c.uploaded||(c.gfxTexture=new i2(n,c.image,s?n.gl.R8:n.gl.RGBA8,{useMipmap:c.sampler.minFilter>=n.gl.NEAREST_MIPMAP_NEAREST}),c.uploaded=!0,c.image=null)}function CV(c,n,s){c.indexBuffer=n.createIndexBuffer(c.indexArray,!1,!0),c.vertexBuffer=n.createVertexBuffer(c.vertexArray,_V.members,!1,!0),c.normalArray&&(c.normalBuffer=n.createVertexBuffer(c.normalArray,wV.members,!1,!0)),c.texcoordArray&&(c.texcoordBuffer=n.createVertexBuffer(c.texcoordArray,xV.members,!1,!0)),c.colorArray&&(c.colorBuffer=n.createVertexBuffer(c.colorArray,(c.colorArray.bytesPerElement===12?yV:bV).members,!1,!0)),c.featureArray&&(c.pbrBuffer=n.createVertexBuffer(c.featureArray,TV.members,!0)),c.segments=ei.simpleSegment(0,0,c.vertexArray.length,c.indexArray.length);const u=c.material;u.pbrMetallicRoughness.baseColorTexture&&Hv(u.pbrMetallicRoughness.baseColorTexture,n),u.pbrMetallicRoughness.metallicRoughnessTexture&&Hv(u.pbrMetallicRoughness.metallicRoughnessTexture,n),u.normalTexture&&Hv(u.normalTexture,n),u.occlusionTexture&&Hv(u.occlusionTexture,n,s),u.emissionTexture&&Hv(u.emissionTexture,n)}function u2(c,n,s){if(c.meshes)for(const u of c.meshes)CV(u,n,s);if(c.children)for(const u of c.children)u2(u,n,s)}function ob(c){if(c.meshes)for(const n of c.meshes)n.indexArray.destroy(),n.vertexArray.destroy(),n.colorArray&&n.colorArray.destroy(),n.normalArray&&n.normalArray.destroy(),n.texcoordArray&&n.texcoordArray.destroy(),n.featureArray&&n.featureArray.destroy();if(c.children)for(const n of c.children)ob(n)}function d2(c){if(c.meshes)for(const s of c.meshes)s.vertexBuffer&&(s.vertexBuffer.destroy(),s.indexBuffer.destroy(),s.normalBuffer&&s.normalBuffer.destroy(),s.texcoordBuffer&&s.texcoordBuffer.destroy(),s.colorBuffer&&s.colorBuffer.destroy(),s.pbrBuffer&&s.pbrBuffer.destroy(),s.segments.destroy(),s.material&&((n=s.material).pbrMetallicRoughness.baseColorTexture&&n.pbrMetallicRoughness.baseColorTexture.gfxTexture&&n.pbrMetallicRoughness.baseColorTexture.gfxTexture.destroy(),n.pbrMetallicRoughness.metallicRoughnessTexture&&n.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture&&n.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture.destroy(),n.normalTexture&&n.normalTexture.gfxTexture&&n.normalTexture.gfxTexture.destroy(),n.emissionTexture&&n.emissionTexture.gfxTexture&&n.emissionTexture.gfxTexture.destroy(),n.occlusionTexture&&n.occlusionTexture.gfxTexture&&n.occlusionTexture.gfxTexture.destroy()));var n;if(c.children)for(const s of c.children)d2(s)}class jp{constructor(n,s,u){this._demTile=n,this._dem=this._demTile.dem,this._scale=s,this._offset=u}static create(n,s,u){const g=u||n.findDEMTileFor(s);if(!g||!g.dem)return;const h=g.dem,v=g.tileID,T=1<<s.canonical.z-v.canonical.z;return new jp(g,h.dim/In/T,[(s.canonical.x/T-v.canonical.x)*h.dim,(s.canonical.y/T-v.canonical.y)*h.dim])}tileCoordToPixel(n,s){const u=s*this._scale+this._offset[1],g=Math.floor(n*this._scale+this._offset[0]),h=Math.floor(u);return new Qe(g,h)}getElevationAt(n,s,u,g){const h=n*this._scale+this._offset[0],v=s*this._scale+this._offset[1],T=Math.floor(h),A=Math.floor(v),D=this._dem;return g=!!g,u?cr(cr(D.get(T,A,g),D.get(T,A+1,g),v-A),cr(D.get(T+1,A,g),D.get(T+1,A+1,g),v-A),h-T):D.get(T,A,g)}getElevationAtPixel(n,s,u){return this._dem.get(n,s,!!u)}getMeterToDEM(n){return(1<<this._demTile.tileID.canonical.z)*fs(1,n)*this._dem.stride}}const h2=new Float32Array(262144),tf=new Uint8Array(262144);function WA(c){let n=0;if(c.meshes)for(const s of c.meshes)n=Math.max(n,s.aabb.max[2]);if(c.children)for(const s of c.children)n=Math.max(n,WA(s));return n}function qA(c,n,s){if(c.meshes)for(const u of c.meshes){if(u.aabb.min[0]===1/0)continue;const g=Jn.applyTransform(u.aabb,c.matrix);s.insert(n,g.min[0],g.min[1],g.max[0],g.max[1])}if(c.children)for(const u of c.children)qA(u,n,s)}const KA=["","wall","door","roof","window","lamp","logo"];class ZA{constructor(n){this.node=n,this.evaluatedRMEA=[[1,0,0,1],[1,0,0,1],[1,0,0,1],[1,0,0,1],[.4,1,0,1],[1,0,0,1],[1,0,0,1]],this.hiddenByReplacement=!1,this.evaluatedScale=[1,1,1],this.evaluatedColor=[],this.emissionHeightBasedParams=[],this.cameraCollisionOpacity=1,this.feature={type:"Point",id:n.id,geometry:[],properties:{height:WA(n)}},this.aabb=this._getLocalBounds(),this.state=null}_getLocalBounds(){if(!this.node.meshes)return new Jn([1/0,1/0,1/0],[-1/0,-1/0,-1/0]);if(!this.aabb){let n=0;const s=new Jn([1/0,1/0,1/0],[-1/0,-1/0,-1/0]);for(const u of this.node.meshes)this.node.lightMeshIndex!==n&&(u.transformedAabb=Jn.applyTransformFast(u.aabb,this.node.matrix),s.encapsulate(u.transformedAabb)),n++;this.aabb=s}return this.aabb}}class ib{constructor(n,s,u,g,h,v,T){this.id=u,this.layers=n,this.layerIds=this.layers.map(A=>A.fqid),this.stateDependentLayerIds=this.layers.filter(A=>A.isStateDependent()).map(A=>A.id),this.modelTraits|=Up.CoordinateSpaceTile,this.uploaded=!1,this.hasPattern=!1,g&&(this.modelTraits|=Up.HasMapboxMeshFeatures),h&&(this.modelTraits|=Up.HasMeshoptCompression),this.zoom=-1,this.terrainExaggeration=1,this.projection={name:"mercator"},this.replacementUpdateTime=0,this.elevationReadFromZ=255,this.brightness=v,this.dirty=!0,this.needsUpload=!1,this.nodesInfo=[];for(const A of s)this.nodesInfo.push(new ZA(A)),qA(A,T.featureIndexArray.length,T.grid),T.featureIndexArray.emplaceBack(this.nodesInfo.length-1,0,T.bucketLayerIDs.length-1,0);this.states={}}updateFootprints(n,s){for(const u of this.getNodesInfo()){const g=u.node;g.footprint&&s.push({footprint:g.footprint,id:n})}}update(n){const s=Object.keys(n).length!==0;if(s&&!this.stateDependentLayers.length)return;const u=s?this.stateDependentLayers:this.layers;if(!Yt(n,this.states))for(const g of u)this.evaluate(g,n);this.states=structuredClone(n)}populate(){console.log("populate 3D model bucket")}uploadPending(){return!this.uploaded||this.needsUpload}upload(n){if(!this.needsUpload)return;const s=this.getNodesInfo();for(const u of s){const g=u.node;this.uploaded?this.updatePbrBuffer(g):u2(g,n,!0)}for(const u of s)ob(u.node);this.uploaded=!0,this.needsUpload=!1}updatePbrBuffer(n){let s=!1;if(!n.meshes)return s;for(const u of n.meshes)u.pbrBuffer&&(u.pbrBuffer.updateData(u.featureArray),s=!0);return s}needsReEvaluation(n,s,u){const g=n.transform.projectionOptions,h=n.style.getBrightness(),v=this.brightness!==h;if(!this.uploaded||this.dirty||g.name!==this.projection.name||Gv(u.paint.get("model-color").value,v)||Gv(u.paint.get("model-color-mix-intensity").value,v)||Gv(u.paint.get("model-roughness").value,v)||Gv(u.paint.get("model-emissive-strength").value,v)||Gv(u.paint.get("model-height-based-emissive-strength-multiplier").value,v)){this.projection=g,this.brightness=h;const T=this.getNodesInfo();for(const A of T)A.state=null;return!0}return!1}evaluateScale(n,s){if(n.transform.zoom===this.zoom)return;this.zoom=n.transform.zoom;const u=this.getNodesInfo(),g=this.id.canonical;for(const h of u){const v=h.feature;h.evaluatedScale=s.paint.get("model-scale").evaluate(v,{},g)}}evaluate(n,s){const u=this.getNodesInfo();for(const g of u){if(!g.node.meshes)continue;const h=g.feature,v=s&&s[h.id];if(Yt(v,g.state))continue;g.state=structuredClone(v);const T=g.node.meshes&&g.node.meshes[0].featureData,A=g.evaluatedColor[2],D=g.evaluatedRMEA[2],x=this.id.canonical;if(g.hasTranslucentParts=!1,T){for(let P=0;P<KA.length;P++){const L=KA[P];L.length&&(h.properties.part=L);const I=n.paint.get("model-color").evaluate(h,v,x).toRenderColor(null),R=n.paint.get("model-color-mix-intensity").evaluate(h,v,x);g.evaluatedColor[P]=[I.r,I.g,I.b,R],g.evaluatedRMEA[P][0]=n.paint.get("model-roughness").evaluate(h,v,x),g.evaluatedRMEA[P][2]=n.paint.get("model-emissive-strength").evaluate(h,v,x),g.evaluatedRMEA[P][3]=I.a,g.emissionHeightBasedParams[P]=n.paint.get("model-height-based-emissive-strength-multiplier").evaluate(h,v,x),!g.hasTranslucentParts&&I.a<1&&(g.hasTranslucentParts=!0)}delete h.properties.part,MV(g,A!==g.evaluatedColor[2]||D!==g.evaluatedRMEA[2],this.modelTraits)}else g.evaluatedRMEA[0][2]=n.paint.get("model-emissive-strength").evaluate(h,v,x);g.evaluatedScale=n.paint.get("model-scale").evaluate(h,v,x),this.updatePbrBuffer(g.node)||(this.needsUpload=!0)}this.dirty=!1}elevationUpdate(n,s,u,g){const h=n.findDEMTileFor(u);if(h&&(h.tileID.canonical!==this.terrainTile||s!==this.terrainExaggeration)){if(h.dem&&h.tileID.overscaledZ!==this.elevationReadFromZ){this.elevationReadFromZ=h.tileID.overscaledZ;const v=jp.create(n,u,h);if(!v)return;this.modelTraits&Up.HasMapboxMeshFeatures&&this.updateDEM(n,v,u,g);for(const T of this.getNodesInfo()){const A=T.node;if(!A.footprint||!A.footprint.vertices||!A.footprint.vertices.length)continue;const D=A.footprint.vertices;let x=v.getElevationAt(D[0].x,D[0].y,!0,!0);for(let P=1;P<D.length;P++)x=Math.min(x,v.getElevationAt(D[P].x,D[P].y,!0,!0));A.elevation=x}}this.terrainTile=h.tileID.canonical,this.terrainExaggeration=s}}updateDEM(n,s,u,g){let h=s._dem._modifiedForSources[g];if(h===void 0&&(s._dem._modifiedForSources[g]=[],h=s._dem._modifiedForSources[g]),h.includes(u.canonical))return;const v=s._dem.dim;h.push(u.canonical);let T=!1;for(const A of this.getNodesInfo()){const D=A.node;if(!D.footprint||!D.footprint.grid)continue;const x=D.footprint.grid,P=s.tileCoordToPixel(x.min.x,x.min.y),L=s.tileCoordToPixel(x.max.x,x.max.y),I=Math.min(Math.min(v-L.y,P.x),Math.min(P.y,v-L.x));if(I<0)continue;const R=It(I,2,5);let V=Math.max(0,P.x-R),W=Math.max(0,P.y-R),K=Math.min(L.x+R,v-1),re=Math.min(L.y+R,v-1);for(let _e=W;_e<=re;++_e)for(let Ee=V;Ee<=K;++Ee)tf[_e*v+Ee]=255;let ie=0,Q=0;for(let _e=0;_e<x.cellsY;++_e)for(let Ee=0;Ee<x.cellsX;++Ee){if(!x.cells[_e*x.cellsX+Ee])continue;const Ne=s.tileCoordToPixel(x.min.x+Ee/x.xScale,x.min.y+_e/x.yScale),ze=s.tileCoordToPixel(x.min.x+(Ee+1)/x.xScale,x.min.y+(_e+1)/x.yScale);for(let De=Ne.y;De<=Math.min(ze.y+1,v-1);++De)for(let ot=Ne.x;ot<=Math.min(ze.x+1,v-1);++ot)tf[De*v+ot]===255&&(tf[De*v+ot]=0,ie+=s.getElevationAtPixel(ot,De),Q++)}const ue=ie/Q;V=Math.max(1,P.x-R),W=Math.max(1,P.y-R),K=Math.min(L.x+R,v-2),re=Math.min(L.y+R,v-2),T=!0;for(let _e=W;_e<=re;++_e)for(let Ee=V;Ee<=K;++Ee)tf[_e*v+Ee]===0&&(h2[_e*v+Ee]=s._dem.set(Ee,_e,ue));for(let _e=1;_e<R;++_e){V=Math.max(1,P.x-_e),W=Math.max(1,P.y-_e),K=Math.min(L.x+_e,v-2),re=Math.min(L.y+_e,v-2);for(let Ee=W;Ee<=re;++Ee)for(let Ne=V;Ne<=K;++Ne){const ze=Ee*v+Ne;if(tf[ze]===255){let De=0,ot=0,$e=-1,it=-1;for(let ft=-1;ft<=1;++ft)for(let ut=-1;ut<=1;++ut){const mt=(Ee+ft)*v+Ne+ut;if(tf[mt]>=_e)continue;const xt=h2[mt],At=Math.abs(xt);At>ot&&(De=xt,ot=At,$e=ut,it=ft)}if(ot>.1){const ft=1-(_e+.5*Math.abs($e*it))/R;let ut=s._dem.get(Ne,Ee)+De*ft;const mt=s._dem.get(Ne+$e,Ee+it),xt=s._dem.get(Ne-$e,Ee-it,!0);(ut-mt)*(ut-xt)>0&&(ut=(mt+xt)/2),h2[ze]=s._dem.set(Ne,Ee,ut),tf[ze]=_e}}}}}T&&(s._demTile.needsDEMTextureUpload=!0,s._dem._timestamp=je.now())}getNodesInfo(){return this.nodesInfo}destroy(){const n=this.getNodesInfo();for(const s of n)ob(s.node),d2(s.node)}isEmpty(){return!this.nodesInfo.length}updateReplacement(n,s){if(s.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=s.updateTime;const u=s.getReplacementRegionsForTile(n.toUnwrapped()),g=this.getNodesInfo();for(let h=0;h<this.nodesInfo.length;h++){const v=g[h].node;g[h].hiddenByReplacement=!!v.footprint&&!u.find(T=>T.footprint===v.footprint)}}getHeightAtTileCoord(n,s){const u=this.getNodesInfo(),g=[],h=[0,0,0],v=Fe.mat4.identity([]);for(let T=0;T<this.nodesInfo.length;T++){const A=u[T],D=A.node.meshes[0],x=D.transformedAabb;if(n<x.min[0]||s<x.min[1]||n>x.max[0]||s>x.max[1])continue;if(A.node.hidden===!0)return{height:1/0,maxHeight:A.feature.properties.height,hidden:!1,verticalScale:A.evaluatedScale[2]};Fe.mat4.invert(v,A.node.matrix),h[0]=n,h[1]=s,Fe.vec3.transformMat4(h,h,v);const P=(h[0]-D.aabb.min[0])/(D.aabb.max[0]-D.aabb.min[0])*ef|0,L=Math.min(63,(h[1]-D.aabb.min[1])/(D.aabb.max[1]-D.aabb.min[1])*ef|0)*ef+Math.min(63,P),I=D.heightmap[L];if(!(I<0&&A.node.footprint))return A.hiddenByReplacement?void 0:{height:I,maxHeight:A.feature.properties.height,hidden:!1,verticalScale:A.evaluatedScale[2]};if(A.node.footprint.grid.query(new Qe(n,s),new Qe(n,s),g),g.length>0)return{height:void 0,maxHeight:A.feature.properties.height,hidden:A.hiddenByReplacement,verticalScale:A.evaluatedScale[2]}}}}function Gv(c,n){return!c.isLightConstant&&n}function EV(c,n,s,u,g,h,v,T){let A=(61440&n|(61440&n)>>4)>>8,D=(3840&n|(3840&n)>>4)>>4,x=240&n|(240&n)>>4;s[3]>0&&(A=cr(A,255*s[0],s[3]),D=cr(D,255*s[1],s[3]),x=cr(x,255*s[2],s[3]));const P=A<<8|D,L=x<<8|Math.floor(255*u[3]),I=function(_e){const Ee=It(_e,0,2);return Math.min(Math.round(.5*Ee*255),255)}(u[2])<<8|15*u[0]<<4|15*u[1],R=It(g[0],0,1),V=It(g[1],0,1),W=It(g[2],0,1),K=It(g[3],0,1);let re,ie,Q,ue;if(R!==V&&v!==h&&V!==R){const _e=v-h;ie=1/(_e*(V-R)),Q=-(h+_e*R)/(_e*(V-R));const Ee=It(g[4],-1,1);ue=Math.pow(10,Ee),re=255*W<<8|255*K}else re=65535,ie=0,Q=1,ue=1;if(c.emplaceBack(P,L,I,re,ie,Q,ue),T){const _e=T.length;T.clear();for(let Ee=0;Ee<_e;Ee++)T.emplaceBack(P,L,I,re,ie,Q,ue)}}function MV(c,n,s){const u=c.node;let g=0;const h=s&Up.HasMeshoptCompression;for(const v of u.meshes){if(u.lights&&u.lightMeshIndex===g||!v.featureData)continue;v.featureArray=new $h,v.featureArray.reserve(v.featureData.length);let T=n;for(const A of v.featureData){const D=h?65535&A:A>>16&65535,x=h?A>>16&65535:65535&A,P=(15&x)<8?15&x:0,L=c.evaluatedRMEA[P],I=c.evaluatedColor[P],R=c.emissionHeightBasedParams[P];let V;if(T&&P===2&&u.lights&&(V=new $h,V.resize(10*u.lights.length)),EV(v.featureArray,D,I,L,R,v.aabb.min[2],v.aabb.max[2],V),V&&T){T=!1;const W=u.meshes[u.lightMeshIndex];W.featureArray=V,W.featureArray._trim()}}v.featureArray._trim(),g++}}function YA(c,n,s,u){const g=1<<c.z;n.lat=Ui((u/In+c.y)/g),n.lng=Ds((s/In+c.x)/g)}Hn(ib,"Tiled3dModelBucket",{omit:["layers"]}),Hn(ZA,"Tiled3dModelFeature");const IV={circle:class extends Di{constructor(c,n,s,u){super(c,{layout:gn||(gn=new Wo({"circle-sort-key":new zn(Lt.layout_circle["circle-sort-key"]),"circle-elevation-reference":new xn(Lt.layout_circle["circle-elevation-reference"]),visibility:new xn(Lt.layout_circle.visibility)})),paint:Tt||(Tt=new Wo({"circle-radius":new zn(Lt.paint_circle["circle-radius"]),"circle-color":new zn(Lt.paint_circle["circle-color"]),"circle-blur":new zn(Lt.paint_circle["circle-blur"]),"circle-opacity":new zn(Lt.paint_circle["circle-opacity"]),"circle-translate":new xn(Lt.paint_circle["circle-translate"]),"circle-translate-anchor":new xn(Lt.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new xn(Lt.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new xn(Lt.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new zn(Lt.paint_circle["circle-stroke-width"]),"circle-stroke-color":new zn(Lt.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new zn(Lt.paint_circle["circle-stroke-opacity"]),"circle-emissive-strength":new xn(Lt.paint_circle["circle-emissive-strength"]),"circle-color-use-theme":new zn({type:"string",default:"default","property-type":"data-driven"}),"circle-stroke-color-use-theme":new zn({type:"string",default:"default","property-type":"data-driven"})}))},n,s,u)}createBucket(c){return new xe(c)}queryRadius(c){const n=c;return tn("circle-radius",this,n)+tn("circle-stroke-width",this,n)+Jt(this.paint.get("circle-translate"))}queryIntersectsFeature(c,n,s,u,g,h,v,T){const A=jt(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),h.angle,c.pixelToTileUnitsFactor),D=this.paint.get("circle-radius").evaluate(n,s)+this.paint.get("circle-stroke-width").evaluate(n,s);return Lp(c,u,h,v,T,this.paint.get("circle-pitch-alignment")==="map",this.paint.get("circle-pitch-scale")==="map",A,D)}getProgramIds(){return["circle"]}getDefaultProgramParams(c,n,s){const u=yd(this);return{config:new _u(this,{zoom:n,lut:s}),defines:u,overrideFog:!1}}},heatmap:class extends Di{createBucket(c){return new AM(c)}constructor(c,n,s,u){super(c,{layout:kM||(kM=new Wo({visibility:new xn(Lt.layout_heatmap.visibility)})),paint:PM||(PM=new Wo({"heatmap-radius":new zn(Lt.paint_heatmap["heatmap-radius"]),"heatmap-weight":new zn(Lt.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new xn(Lt.paint_heatmap["heatmap-intensity"]),"heatmap-color":new ud(Lt.paint_heatmap["heatmap-color"]),"heatmap-opacity":new xn(Lt.paint_heatmap["heatmap-opacity"]),"heatmap-color-use-theme":new zn({type:"string",default:"default","property-type":"data-driven"})}))},n,s,u),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(c){c==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=Tv({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(c){return tn("heatmap-radius",this,c)}queryIntersectsFeature(c,n,s,u,g,h,v,T){const A=this.paint.get("heatmap-radius").evaluate(n,s);return Lp(c,u,h,v,T,!0,!0,new Qe(0,0),A)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}getProgramIds(){return["heatmap","heatmapTexture"]}getDefaultProgramParams(c,n,s){return c==="heatmap"?{config:new _u(this,{zoom:n,lut:s}),overrideFog:!1}:{}}},hillshade:class extends Di{constructor(c,n,s,u){super(c,{layout:RM||(RM=new Wo({visibility:new xn(Lt.layout_hillshade.visibility)})),paint:OM||(OM=new Wo({"hillshade-illumination-direction":new xn(Lt.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new xn(Lt.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new xn(Lt.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new xn(Lt.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new xn(Lt.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new xn(Lt.paint_hillshade["hillshade-accent-color"]),"hillshade-emissive-strength":new xn(Lt.paint_hillshade["hillshade-emissive-strength"]),"hillshade-shadow-color-use-theme":new zn({type:"string",default:"default","property-type":"data-driven"}),"hillshade-highlight-color-use-theme":new zn({type:"string",default:"default","property-type":"data-driven"}),"hillshade-accent-color-use-theme":new zn({type:"string",default:"default","property-type":"data-driven"})}))},n,s,u)}shouldRedrape(){return this.hasOffscreenPass()&&this.paint.get("hillshade-illumination-anchor")==="viewport"}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}getProgramIds(){return["hillshade","hillshadePrepare"]}getDefaultProgramParams(c,n,s){return{overrideFog:!1}}},fill:class extends Di{constructor(c,n,s,u){super(c,{layout:UM||(UM=new Wo({"fill-sort-key":new zn(Lt.layout_fill["fill-sort-key"]),visibility:new xn(Lt.layout_fill.visibility),"fill-elevation-reference":new xn(Lt.layout_fill["fill-elevation-reference"])})),paint:jM||(jM=new Wo({"fill-antialias":new xn(Lt.paint_fill["fill-antialias"]),"fill-opacity":new zn(Lt.paint_fill["fill-opacity"]),"fill-color":new zn(Lt.paint_fill["fill-color"]),"fill-outline-color":new zn(Lt.paint_fill["fill-outline-color"]),"fill-translate":new xn(Lt.paint_fill["fill-translate"]),"fill-translate-anchor":new xn(Lt.paint_fill["fill-translate-anchor"]),"fill-pattern":new zn(Lt.paint_fill["fill-pattern"]),"fill-emissive-strength":new xn(Lt.paint_fill["fill-emissive-strength"]),"fill-z-offset":new zn(Lt.paint_fill["fill-z-offset"]),"fill-color-use-theme":new zn({type:"string",default:"default","property-type":"data-driven"}),"fill-outline-color-use-theme":new zn({type:"string",default:"default","property-type":"data-driven"})}))},n,s,u)}getProgramIds(){const c=this.paint.get("fill-pattern"),n=c&&c.constantOr(1),s=[n?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&s.push(n&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),s}getDefaultProgramParams(c,n,s){return{config:new _u(this,{zoom:n,lut:s}),overrideFog:!1}}recalculate(c,n){super.recalculate(c,n);const s=this.paint._values["fill-outline-color"];s.value.kind==="constant"&&s.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(c){return new Iw(c)}queryRadius(){return Jt(this.paint.get("fill-translate"))}queryIntersectsFeature(c,n,s,u,g,h){return!c.queryGeometry.isAboveHorizon&&Te(Et(c.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),h.angle,c.pixelToTileUnitsFactor),u)}isTileClipped(){return!0}is3D(){return this.paint.get("fill-z-offset").constantOr(1)!==0}},"fill-extrusion":class extends Di{constructor(c,n,s,u){super(c,{layout:TI||(TI=new Wo({visibility:new xn(Lt["layout_fill-extrusion"].visibility),"fill-extrusion-edge-radius":new xn(Lt["layout_fill-extrusion"]["fill-extrusion-edge-radius"])})),paint:CI||(CI=new Wo({"fill-extrusion-opacity":new xn(Lt["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new zn(Lt["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new xn(Lt["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new xn(Lt["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new zn(Lt["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new zn(Lt["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new zn(Lt["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-height-alignment":new xn(Lt["paint_fill-extrusion"]["fill-extrusion-height-alignment"]),"fill-extrusion-base-alignment":new xn(Lt["paint_fill-extrusion"]["fill-extrusion-base-alignment"]),"fill-extrusion-vertical-gradient":new xn(Lt["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new xn(Lt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new xn(Lt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"]),"fill-extrusion-ambient-occlusion-wall-radius":new xn(Lt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-wall-radius"]),"fill-extrusion-ambient-occlusion-ground-radius":new xn(Lt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-radius"]),"fill-extrusion-ambient-occlusion-ground-attenuation":new xn(Lt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-attenuation"]),"fill-extrusion-flood-light-color":new xn(Lt["paint_fill-extrusion"]["fill-extrusion-flood-light-color"]),"fill-extrusion-flood-light-intensity":new xn(Lt["paint_fill-extrusion"]["fill-extrusion-flood-light-intensity"]),"fill-extrusion-flood-light-wall-radius":new zn(Lt["paint_fill-extrusion"]["fill-extrusion-flood-light-wall-radius"]),"fill-extrusion-flood-light-ground-radius":new zn(Lt["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-radius"]),"fill-extrusion-flood-light-ground-attenuation":new xn(Lt["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-attenuation"]),"fill-extrusion-vertical-scale":new xn(Lt["paint_fill-extrusion"]["fill-extrusion-vertical-scale"]),"fill-extrusion-rounded-roof":new xn(Lt["paint_fill-extrusion"]["fill-extrusion-rounded-roof"]),"fill-extrusion-cutoff-fade-range":new xn(Lt["paint_fill-extrusion"]["fill-extrusion-cutoff-fade-range"]),"fill-extrusion-emissive-strength":new zn(Lt["paint_fill-extrusion"]["fill-extrusion-emissive-strength"]),"fill-extrusion-line-width":new zn(Lt["paint_fill-extrusion"]["fill-extrusion-line-width"]),"fill-extrusion-cast-shadows":new xn(Lt["paint_fill-extrusion"]["fill-extrusion-cast-shadows"]),"fill-extrusion-color-use-theme":new zn({type:"string",default:"default","property-type":"data-driven"}),"fill-extrusion-flood-light-color-use-theme":new zn({type:"string",default:"default","property-type":"data-driven"})}))},n,s,u),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(c){return new D0(c)}queryRadius(){return Jt(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}hasShadowPass(){return this.paint.get("fill-extrusion-cast-shadows")}cutoffRange(){return this.paint.get("fill-extrusion-cutoff-fade-range")}canCastShadows(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}queryIntersectsFeature(c,n,s,u,g,h,v,T,A){const D=jt(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),h.angle,c.pixelToTileUnitsFactor),x=this.paint.get("fill-extrusion-height").evaluate(n,s),P=this.paint.get("fill-extrusion-base").evaluate(n,s),L=[0,0],I=T&&h.elevation,R=h.elevation?h.elevation.exaggeration():1,V=c.tile.getBucket(this);if(I&&V instanceof D0){const Q=V.centroidVertexArray,ue=A+1;ue<Q.length&&(L[0]=Q.geta_centroid_pos0(ue),L[1]=Q.geta_centroid_pos1(ue))}if(L[0]===0&&L[1]===1)return!1;h.projection.name==="globe"&&(u=SI([u],[new Qe(0,0),new Qe(In,In)],c.tileID.canonical).map(Q=>Q.polygon).flat());const W=I?T:null,[K,re]=function(Q,ue,_e,Ee,Ne,ze,De,ot,$e,it,ft){return Q.projection.name==="globe"?function(ut,mt,xt,At,_t,Zt,hn,Kt,kn,Mn,_n){const mn=[],Zn=[],Rn=ut.projection.upVectorScale(_n,ut.center.lat,ut.worldSize).metersToTile,Fn=[0,0,0,1],pr=[0,0,0,1],Ir=(kr,Nr,Vr,ko)=>{kr[0]=Nr,kr[1]=Vr,kr[2]=ko,kr[3]=1},Ar=wI();xt>0&&(xt+=Ar),At+=Ar;for(const kr of mt){const Nr=[],Vr=[];for(const ko of kr){const go=ko.x+_t.x,xr=ko.y+_t.y,uo=ut.projection.projectTilePoint(go,xr,_n),fo=ut.projection.upVector(_n,ko.x,ko.y);let $o=xt,ai=At;if(hn){const Si=MI(go,xr,xt,At,hn,Kt,kn,Mn);$o+=Si.base,ai+=Si.top}xt!==0?Ir(Fn,uo.x+fo[0]*Rn*$o,uo.y+fo[1]*Rn*$o,uo.z+fo[2]*Rn*$o):Ir(Fn,uo.x,uo.y,uo.z),Ir(pr,uo.x+fo[0]*Rn*ai,uo.y+fo[1]*Rn*ai,uo.z+fo[2]*Rn*ai),Fe.vec3.transformMat4(Fn,Fn,Zt),Fe.vec3.transformMat4(pr,pr,Zt),Nr.push(new Jh(Fn[0],Fn[1],Fn[2])),Vr.push(new Jh(pr[0],pr[1],pr[2]))}mn.push(Nr),Zn.push(Vr)}return[mn,Zn]}(Q,ue,_e,Ee,Ne,ze,De,ot,$e,it,ft):De?function(ut,mt,xt,At,_t,Zt,hn,Kt,kn){const Mn=[],_n=[],mn=[0,0,0,1];for(const Zn of ut){const Rn=[],Fn=[];for(const pr of Zn){const Ir=pr.x+At.x,Ar=pr.y+At.y,kr=MI(Ir,Ar,mt,xt,Zt,hn,Kt,kn);mn[0]=Ir,mn[1]=Ar,mn[2]=kr.base,mn[3]=1,Fe.vec4.transformMat4(mn,mn,_t),mn[3]=Math.max(mn[3],1e-5);const Nr=new Jh(mn[0]/mn[3],mn[1]/mn[3],mn[2]/mn[3]);mn[0]=Ir,mn[1]=Ar,mn[2]=kr.top,mn[3]=1,Fe.vec4.transformMat4(mn,mn,_t),mn[3]=Math.max(mn[3],1e-5);const Vr=new Jh(mn[0]/mn[3],mn[1]/mn[3],mn[2]/mn[3]);Rn.push(Nr),Fn.push(Vr)}Mn.push(Rn),_n.push(Fn)}return[Mn,_n]}(ue,_e,Ee,Ne,ze,De,ot,$e,it):function(ut,mt,xt,At,_t){const Zt=[],hn=[],Kt=_t[8]*mt,kn=_t[9]*mt,Mn=_t[10]*mt,_n=_t[11]*mt,mn=_t[8]*xt,Zn=_t[9]*xt,Rn=_t[10]*xt,Fn=_t[11]*xt;for(const pr of ut){const Ir=[],Ar=[];for(const kr of pr){const Nr=kr.x+At.x,Vr=kr.y+At.y,ko=_t[0]*Nr+_t[4]*Vr+_t[12],go=_t[1]*Nr+_t[5]*Vr+_t[13],xr=_t[2]*Nr+_t[6]*Vr+_t[14],uo=_t[3]*Nr+_t[7]*Vr+_t[15],fo=ko+Kt,$o=go+kn,ai=xr+Mn,Si=Math.max(uo+_n,1e-5),li=ko+mn,Xo=go+Zn,mi=xr+Rn,Mi=Math.max(uo+Fn,1e-5);Ir.push(new Jh(fo/Si,$o/Si,ai/Si)),Ar.push(new Jh(li/Mi,Xo/Mi,mi/Mi))}Zt.push(Ir),hn.push(Ar)}return[Zt,hn]}(ue,_e,Ee,Ne,ze)}(h,u,P,x,D,v,W,L,R,h.center.lat,c.tileID.canonical),ie=c.queryGeometry;return function(Q,ue,_e){let Ee=1/0;Te(_e,ue)&&(Ee=EI(_e,ue[0]));for(let Ne=0;Ne<ue.length;Ne++){const ze=ue[Ne],De=Q[Ne];for(let ot=0;ot<ze.length-1;ot++){const $e=ze[ot],it=[$e,ze[ot+1],De[ot+1],De[ot],$e];ve(_e,it)&&(Ee=Math.min(Ee,EI(_e,it)))}}return Ee!==1/0&&Ee}(K,re,ie.isPointQuery()?ie.screenBounds:ie.screenGeometry)}},line:class extends Di{constructor(c,n,s,u){const g=FI();super(c,g,n,s,u),g.layout&&(this.layout=new cd(g.layout)),this.gradientVersion=0,this.hasElevatedBuckets=!1,this.hasNonElevatedBuckets=!1}_handleSpecialPaintPropertyUpdate(c){if(c==="line-gradient"){const n=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=n._styleExpression&&n._styleExpression.expression instanceof Qu,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}widthExpression(){return this._transitionablePaint._values["line-width"].value.expression}recalculate(c,n){super.recalculate(c,n),this.paint._values["line-floorwidth"]=(()=>{if(Ov)return Ov;const s=FI();return Ov=new k5(s.paint.properties["line-width"].specification),Ov.useIntegerZoom=!0,Ov})().possiblyEvaluate(this._transitioningPaint._values["line-width"].value,c)}createBucket(c){return new Nw(c)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getDefaultProgramParams(c,n,s){const u=DI(this);return{config:new _u(this,{zoom:n,lut:s}),defines:u,overrideFog:!1}}queryRadius(c){const n=c,s=NI(tn("line-width",this,n),tn("line-gap-width",this,n)),u=tn("line-offset",this,n);return s/2+Math.abs(u)+Jt(this.paint.get("line-translate"))}queryIntersectsFeature(c,n,s,u,g,h){if(c.queryGeometry.isAboveHorizon)return!1;const v=Et(c.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),h.angle,c.pixelToTileUnitsFactor),T=c.pixelToTileUnitsFactor/2*NI(this.paint.get("line-width").evaluate(n,s),this.paint.get("line-gap-width").evaluate(n,s)),A=this.paint.get("line-offset").evaluate(n,s);return A&&(u=function(D,x){const P=[],L=new Qe(0,0);for(let I=0;I<D.length;I++){const R=D[I],V=[];for(let W=0;W<R.length;W++){const K=R[W],re=R[W+1],ie=W===0?L:K.sub(R[W-1])._unit()._perp(),Q=W===R.length-1?L:re.sub(K)._unit()._perp(),ue=ie._add(Q)._unit();ue._mult(1/(ue.x*Q.x+ue.y*Q.y)),V.push(ue._mult(x)._add(K))}P.push(V)}return P}(u,A*c.pixelToTileUnitsFactor)),function(D,x,P){for(let L=0;L<x.length;L++){const I=x[L];if(D.length>=3){for(let R=0;R<I.length;R++)if(Ye(D,I[R]))return!0}if(Le(D,I,P))return!0}return!1}(v,u,T)}isTileClipped(){return!0}isDraped(c){return!this.hasElevatedBuckets}},symbol:X0,background:class extends Di{constructor(c,n,s,u){super(c,{layout:xA||(xA=new Wo({visibility:new xn(Lt.layout_background.visibility)})),paint:wA||(wA=new Wo({"background-pitch-alignment":new xn(Lt.paint_background["background-pitch-alignment"]),"background-color":new xn(Lt.paint_background["background-color"]),"background-pattern":new xn(Lt.paint_background["background-pattern"]),"background-opacity":new xn(Lt.paint_background["background-opacity"]),"background-emissive-strength":new xn(Lt.paint_background["background-emissive-strength"]),"background-color-use-theme":new zn({type:"string",default:"default","property-type":"data-driven"})}))},n,s,u)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}getDefaultProgramParams(c,n,s){return{overrideFog:!1}}is3D(){return this.paint.get("background-pitch-alignment")==="viewport"}},raster:MA,"raster-particle":OA,sky:class extends Di{constructor(c,n,s,u){super(c,{layout:kA||(kA=new Wo({visibility:new xn(Lt.layout_sky.visibility)})),paint:PA||(PA=new Wo({"sky-type":new xn(Lt.paint_sky["sky-type"]),"sky-atmosphere-sun":new xn(Lt.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new xn(Lt.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new xn(Lt.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new xn(Lt.paint_sky["sky-gradient-radius"]),"sky-gradient":new ud(Lt.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new xn(Lt.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new xn(Lt.paint_sky["sky-atmosphere-color"]),"sky-opacity":new xn(Lt.paint_sky["sky-opacity"]),"sky-gradient-use-theme":new zn({type:"string",default:"default","property-type":"data-driven"}),"sky-atmosphere-halo-color-use-theme":new zn({type:"string",default:"default","property-type":"data-driven"}),"sky-atmosphere-color-use-theme":new zn({type:"string",default:"default","property-type":"data-driven"})}))},n,s,u),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(c){c==="sky-gradient"?this._updateColorRamp():c!=="sky-atmosphere-sun"&&c!=="sky-atmosphere-halo-color"&&c!=="sky-atmosphere-color"&&c!=="sky-atmosphere-sun-intensity"||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=Tv({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(c){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const n=c.style.light.properties.get("position");return this._lightPosition.azimuthal!==n.azimuthal||this._lightPosition.polar!==n.polar}return!1}getCenter(c,n){if(this.paint.get("sky-type")==="atmosphere"){const u=this.paint.get("sky-atmosphere-sun"),g=!u,h=c.style.light,v=h.properties.get("position");return g&&h.properties.get("anchor")==="viewport"&&wn("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),g?s2(v.azimuthal,90-v.polar,n):s2(u[0],90-u[1],n)}const s=this.paint.get("sky-gradient-center");return s2(s[0],90-s[1],n)}isSky(){return!0}markSkyboxValid(c){this._skyboxInvalidated=!1,this._lightPosition=c.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const c=this.paint.get("sky-type");return c==="atmosphere"?["skyboxCapture","skybox"]:c==="gradient"?["skyboxGradient"]:null}},slot:class extends Di{constructor(c,n,s,u){super(c,{paint:RA||(RA=new Wo({}))},n,null)}},model:class extends Di{constructor(c,n,s,u){super(c,{layout:jA||(jA=new Wo({visibility:new xn(Lt.layout_model.visibility),"model-id":new zn(Lt.layout_model["model-id"])})),paint:HA||(HA=new Wo({"model-opacity":new zn(Lt.paint_model["model-opacity"]),"model-rotation":new zn(Lt.paint_model["model-rotation"]),"model-scale":new zn(Lt.paint_model["model-scale"]),"model-translation":new zn(Lt.paint_model["model-translation"]),"model-color":new zn(Lt.paint_model["model-color"]),"model-color-mix-intensity":new zn(Lt.paint_model["model-color-mix-intensity"]),"model-type":new xn(Lt.paint_model["model-type"]),"model-cast-shadows":new xn(Lt.paint_model["model-cast-shadows"]),"model-receive-shadows":new xn(Lt.paint_model["model-receive-shadows"]),"model-ambient-occlusion-intensity":new xn(Lt.paint_model["model-ambient-occlusion-intensity"]),"model-emissive-strength":new zn(Lt.paint_model["model-emissive-strength"]),"model-roughness":new zn(Lt.paint_model["model-roughness"]),"model-height-based-emissive-strength-multiplier":new zn(Lt.paint_model["model-height-based-emissive-strength-multiplier"]),"model-cutoff-fade-range":new xn(Lt.paint_model["model-cutoff-fade-range"]),"model-front-cutoff":new xn(Lt.paint_model["model-front-cutoff"]),"model-color-use-theme":new zn({type:"string",default:"default","property-type":"data-driven"})}))},n,s,u),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(c){return new c2(c)}getProgramIds(){return["model"]}is3D(){return!0}hasShadowPass(){return!0}canCastShadows(){return!0}hasLightBeamPass(){return!0}cutoffRange(){return this.paint.get("model-cutoff-fade-range")}queryRadius(c){return c instanceof ib?In-1:0}queryIntersectsFeature(c,n,s,u,g,h){if(!this.modelManager)return!1;const v=this.modelManager,T=c.tile.getBucket(this);if(!(T&&T instanceof c2))return!1;for(const A in T.instancesPerModel){const D=T.instancesPerModel[A],x=n.id!==void 0?n.id:n.properties&&n.properties.hasOwnProperty("id")?n.properties.id:void 0;if(D.idToFeaturesIndex.hasOwnProperty(x)){const P=D.features[D.idToFeaturesIndex[x]],L=v.getModel(A,this.scope);if(!L)return!1;let I=Fe.mat4.create();const R=new Qr(0,0),V=T.canonical;let W=Number.MAX_VALUE;for(let K=0;K<P.instancedDataCount;++K){const re=16*(P.instancedDataOffset+K),ie=D.instancedDataArray.float32,Q=[ie[re+4],ie[re+5],ie[re+6]];YA(V,R,ie[re],0|ie[re+1]),GA(I,L,h,R,P.rotation,P.scale,Q,!1,!1,!1),h.projection.name==="globe"&&(I=l2(I,h));const ue=Fe.mat4.multiply([],h.projMatrix,I),_e=c.queryGeometry,Ee=NA(_e.isPointQuery()?_e.screenBounds:_e.screenGeometry,h,ue,L.aabb);Ee!=null&&(W=Math.min(Ee,W))}return W!==Number.MAX_VALUE&&W}}return!1}_handleOverridablePaintPropertyUpdate(c,n,s){return!(!this.layout||n.isDataDriven()||s.isDataDriven()||c!=="model-color"&&c!=="model-color-mix-intensity"&&c!=="model-rotation"&&c!=="model-scale"&&c!=="model-translation"&&c!=="model-emissive-strength")}_isPropertyZoomDependent(c){const n=this._transitionablePaint._values[c];return n!=null&&n.value!=null&&n.value.expression!=null&&n.value.expression instanceof Ah}isZoomDependent(){return this._isPropertyZoomDependent("model-scale")||this._isPropertyZoomDependent("model-rotation")||this._isPropertyZoomDependent("model-translation")}},clip:class extends Di{constructor(c,n,s,u){super(c,{layout:HM||(HM=new Wo({"clip-layer-types":new xn(Lt.layout_clip["clip-layer-types"]),"clip-layer-scope":new xn(Lt.layout_clip["clip-layer-scope"])})),paint:GM||(GM=new Wo({}))},n,s,u)}recalculate(c,n){super.recalculate(c,n)}createBucket(c){return new WM(c)}isTileClipped(){return!0}is3D(){return!0}}};class AV{constructor(n){this._callback=n,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){this._channel=void 0,this._callback=()=>{}}}class kV{constructor(){this.tasks={},this.taskQueue=[],jn(["process"],this),this.invoker=new AV(this.process),this.nextId=0}add(n,s){const u=this.nextId++,g=function({type:h,isSymbolTile:v,zoom:T}){return T=T||0,h==="message"?0:h!=="maybePrepare"||v?h!=="parseTile"||v?h==="parseTile"&&v?300-T:h==="maybePrepare"&&v?400-T:500:200-T:100-T}(s);if(g===0){try{n()}finally{}return null}return this.tasks[u]={fn:n,metadata:s,priority:g,id:u},this.taskQueue.push(u),this.invoker.trigger(),{cancel:()=>{delete this.tasks[u]}}}process(){try{if(this.taskQueue=this.taskQueue.filter(u=>!!this.tasks[u]),!this.taskQueue.length)return;const n=this.pick();if(n===null)return;const s=this.tasks[n];if(delete this.tasks[n],this.taskQueue.length&&this.invoker.trigger(),!s)return;s.fn()}finally{}}pick(){let n=null,s=1/0;for(let g=0;g<this.taskQueue.length;g++){const h=this.tasks[this.taskQueue[g]];h.priority<s&&(s=h.priority,n=g)}if(n===null)return null;const u=this.taskQueue[n];return this.taskQueue.splice(n,1),u}remove(){this.invoker.remove()}}class XA{constructor(n,s,u){this.target=n,this.parent=s,this.mapId=u,this.callbacks={},this.cancelCallbacks={},jn(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.scheduler=new kV}send(n,s,u,g,h=!1,v){const T=Math.round(1e18*Math.random()).toString(36).substring(0,10);u&&(u.metadata=v,this.callbacks[T]=u);const A=new Set;return this.target.postMessage({id:T,type:n,hasCallback:!!u,targetMapId:g,mustQueue:h,sourceMapId:this.mapId,data:Tc(s,A)},A),{cancel:()=>{u&&delete this.callbacks[T],this.target.postMessage({id:T,type:"<cancel>",targetMapId:g,sourceMapId:this.mapId})}}}receive(n){const s=n.data,u=s.id;if(u&&(!s.targetMapId||this.mapId===s.targetMapId))if(s.type==="<cancel>"){const g=this.cancelCallbacks[u];delete this.cancelCallbacks[u],g&&g.cancel()}else if(s.mustQueue||Go()){const g=this.callbacks[u],h=this.scheduler.add(()=>this.processTask(u,s),g&&g.metadata||{type:"message"});h&&(this.cancelCallbacks[u]=h)}else this.processTask(u,s)}processTask(n,s){if(delete this.cancelCallbacks[n],s.type==="<response>"){const u=this.callbacks[n];delete this.callbacks[n],u&&(s.error?u(fu(s.error)):u(null,fu(s.data)))}else{const u=new Set,g=s.hasCallback?(v,T)=>{this.target.postMessage({id:n,type:"<response>",sourceMapId:this.mapId,error:v?Tc(v):null,data:Tc(T,u)},u)}:()=>{},h=fu(s.data);if(this.parent[s.type])this.parent[s.type](s.sourceMapId,h,g);else if(this.parent.getWorkerSource){const v=s.type.split(".");this.parent.getWorkerSource(s.sourceMapId,v[0],h.source,h.scope)[v[1]](h,g)}else g(new Error(`Could not find function ${s.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}}var Wv={workerUrl:"",workerClass:null,workerParams:void 0};const f2="mapboxgl_preloaded_worker_pool";class nf{constructor(){this.active={}}acquire(n,s=nf.workerCount){if(!this.workers)for(this.workers=[];this.workers.length<s;)this.workers.push(Wv.workerClass!=null?new Wv.workerClass:new self.Worker(Wv.workerUrl,Wv.workerParams));return this.active[n]=!0,this.workers.slice()}release(n){delete this.active[n],this.workers&&this.numActive()===0&&(this.workers.forEach(s=>{s.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[f2]}numActive(){return Object.keys(this.active).length}}nf.workerCount=2;class Hp{constructor(n,s,u="Worker",g=nf.workerCount){this.workerPool=n,this.actors=[],this.currentActor=0,this.id=Cr();const h=this.workerPool.acquire(this.id,g);for(let v=0;v<h.length;v++){const T=new Hp.Actor(h[v],s,this.id);T.name=`${u} ${v}`,this.actors.push(T)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(n,s,u){vr(this.actors,(g,h)=>{g.send(n,s,h)},u=u||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(n=>{n.remove()}),this.actors=[],this.workerPool.release(this.id)}}let qv,p2;function sb(){return qv||(qv=new nf),qv}Hp.Actor=XA;const m2=new io(0,0,0);var g2=(c=>(c[c.PATH_RULE_UNSPECIFIED=0]="PATH_RULE_UNSPECIFIED",c[c.PATH_RULE_NON_ZERO=1]="PATH_RULE_NON_ZERO",c[c.PATH_RULE_EVEN_ODD=2]="PATH_RULE_EVEN_ODD",c))(g2||{}),ab=(c=>(c[c.LINE_CAP_UNSPECIFIED=0]="LINE_CAP_UNSPECIFIED",c[c.LINE_CAP_BUTT=1]="LINE_CAP_BUTT",c[c.LINE_CAP_ROUND=2]="LINE_CAP_ROUND",c[c.LINE_CAP_SQUARE=3]="LINE_CAP_SQUARE",c))(ab||{}),Kv=(c=>(c[c.LINE_JOIN_UNSPECIFIED=0]="LINE_JOIN_UNSPECIFIED",c[c.LINE_JOIN_MITER=1]="LINE_JOIN_MITER",c[c.LINE_JOIN_MITER_CLIP=2]="LINE_JOIN_MITER_CLIP",c[c.LINE_JOIN_ROUND=3]="LINE_JOIN_ROUND",c[c.LINE_JOIN_BEVEL=4]="LINE_JOIN_BEVEL",c))(Kv||{}),JA=(c=>(c[c.PAINT_ORDER_UNSPECIFIED=0]="PAINT_ORDER_UNSPECIFIED",c[c.PAINT_ORDER_FILL_AND_STROKE=1]="PAINT_ORDER_FILL_AND_STROKE",c[c.PAINT_ORDER_STROKE_AND_FILL=2]="PAINT_ORDER_STROKE_AND_FILL",c))(JA||{}),Gp=(c=>(c[c.PATH_COMMAND_UNSPECIFIED=0]="PATH_COMMAND_UNSPECIFIED",c[c.PATH_COMMAND_MOVE=1]="PATH_COMMAND_MOVE",c[c.PATH_COMMAND_LINE=2]="PATH_COMMAND_LINE",c[c.PATH_COMMAND_QUAD=3]="PATH_COMMAND_QUAD",c[c.PATH_COMMAND_CUBIC=4]="PATH_COMMAND_CUBIC",c[c.PATH_COMMAND_CLOSE=5]="PATH_COMMAND_CLOSE",c))(Gp||{}),QA=(c=>(c[c.MASK_TYPE_UNSPECIFIED=0]="MASK_TYPE_UNSPECIFIED",c[c.MASK_TYPE_LUMINANCE=1]="MASK_TYPE_LUMINANCE",c[c.MASK_TYPE_ALPHA=2]="MASK_TYPE_ALPHA",c))(QA||{});function PV(c,n,s){c===1&&n.icons.push(function(u,g){return function(h){if(h.usvg_tree.height||(h.usvg_tree.height=h.usvg_tree.width),!h.metadata)return h;const{metadata:v}=h;if(v.content_area){const{content_area:T}=v;T.top==null&&(T.top=T.left),T.width==null&&(T.width=h.usvg_tree.width),T.height==null&&(T.height=T.width)}return v.stretch_x&&v.stretch_x.length&&ek(v,"x"),v.stretch_y&&v.stretch_y.length&&ek(v,"y"),h}(u.readFields(RV,{name:void 0},g))}(s,s.readVarint()+s.pos))}function ek(c,n){const s=[],u=c[`stretch_${n}`];let g=null;for(let h=0;h<u.length;h++)g===null?g=s.length===0?u[0]:s[s.length-1][1]+u[h]:(s.push([g,g+u[h]]),g=null);c[`stretch_${n}_areas`]=s}function RV(c,n,s){c===1?n.name=s.readString():c===2?n.metadata=function(u,g){return u.readFields(OV,{stretch_x:null,stretch_y:null,stretch_x_areas:null,stretch_y_areas:null,variables:[]},g)}(s,s.readVarint()+s.pos):c===3&&(n.usvg_tree=function(u,g){return u.readFields(zV,{width:20,children:[],linear_gradients:[],radial_gradients:[],clip_paths:[],masks:[]},g)}(s,s.readVarint()+s.pos),n.data="usvg_tree")}function OV(c,n,s){c===1?n.stretch_x=s.readPackedVarint():c===2?n.stretch_y=s.readPackedVarint():c===3?n.content_area=function(u,g){return u.readFields(LV,{left:0},g)}(s,s.readVarint()+s.pos):c===4&&n.variables.push(function(u,g){return u.readFields(DV,{name:void 0},g)}(s,s.readVarint()+s.pos))}function LV(c,n,s){c===1?n.left=s.readVarint():c===2?n.width=s.readVarint():c===3?n.top=s.readVarint():c===4&&(n.height=s.readVarint())}function DV(c,n,s){c===1?n.name=s.readString():c===2&&(n.rgb_color=ub(s.readVarint()),n.value="rgb_color")}function zV(c,n,s){c===1?n.width=n.height=s.readVarint():c===2?n.height=s.readVarint():c===3?n.children.push(lb(s,s.readVarint()+s.pos)):c===4?n.linear_gradients.push(function(u,g){return u.readFields(jV,{spread_method:1,stops:[],x1:0,y1:0,x2:1,y2:0},g)}(s,s.readVarint()+s.pos)):c===5?n.radial_gradients.push(function(u,g){return u.readFields(GV,{spread_method:1,stops:[],cx:.5,cy:.5,r:.5,fx:.5,fy:.5,fr:0},g)}(s,s.readVarint()+s.pos)):c===7?n.clip_paths.push(function(u,g){return u.readFields(WV,{children:[]},g)}(s,s.readVarint()+s.pos)):c===8&&n.masks.push(function(u,g){const h=u.readFields(qV,{left:0,width:20,mask_type:1,children:[]},g);return h.height==null&&(h.height=h.width),h.top==null&&(h.top=h.left),h}(s,s.readVarint()+s.pos))}function lb(c,n){return c.readFields(FV,{},n)}function FV(c,n,s){c===1?(n.group=function(u,g){return u.readFields(NV,{opacity:255,children:[]},g)}(s,s.readVarint()+s.pos),n.node="group"):c===2&&(n.path=function(u,g){return u.readFields(VV,{paint_order:1,commands:[],step:1,diffs:[],rule:1},g)}(s,s.readVarint()+s.pos),n.node="path")}function NV(c,n,s){c===1?n.transform=cb(s,s.readVarint()+s.pos):c===2?n.opacity=s.readVarint():c===5?n.clip_path_idx=s.readVarint():c===6?n.mask_idx=s.readVarint():c===7&&n.children.push(lb(s,s.readVarint()+s.pos))}function cb(c,n){return c.readFields(BV,{sx:1,ky:0,kx:0,sy:1,tx:0,ty:0},n)}function BV(c,n,s){c===1?n.sx=s.readFloat():c===2?n.ky=s.readFloat():c===3?n.kx=s.readFloat():c===4?n.sy=s.readFloat():c===5?n.tx=s.readFloat():c===6&&(n.ty=s.readFloat())}function VV(c,n,s){c===1?n.fill=function(u,g){return u.readFields($V,{rgb_color:m2,paint:"rgb_color",opacity:255},g)}(s,s.readVarint()+s.pos):c===2?n.stroke=function(u,g){return u.readFields(UV,{rgb_color:m2,paint:"rgb_color",dasharray:[],dashoffset:0,miterlimit:4,opacity:255,width:1,linecap:1,linejoin:1},g)}(s,s.readVarint()+s.pos):c===3?n.paint_order=s.readVarint():c===5?s.readPackedVarint(n.commands):c===6?n.step=s.readFloat():c===7?s.readPackedSVarint(n.diffs):c===8&&(n.rule=s.readVarint())}function $V(c,n,s){c===1?(n.rgb_color=ub(s.readVarint()),n.paint="rgb_color"):c===2?(n.linear_gradient_idx=s.readVarint(),n.paint="linear_gradient_idx"):c===3?(n.radial_gradient_idx=s.readVarint(),n.paint="radial_gradient_idx"):c===5&&(n.opacity=s.readVarint())}function ub(c){return new io((c>>16&255)/255,(c>>8&255)/255,(255&c)/255,1)}function UV(c,n,s){c===1?(n.rgb_color=ub(s.readVarint()),n.paint="rgb_color"):c===2?(n.linear_gradient_idx=s.readVarint(),n.paint="linear_gradient_idx"):c===3?(n.radial_gradient_idx=s.readVarint(),n.paint="radial_gradient_idx"):c===5?s.readPackedFloat(n.dasharray):c===6?n.dashoffset=s.readFloat():c===7?n.miterlimit=s.readFloat():c===8?n.opacity=s.readVarint():c===9?n.width=s.readFloat():c===10?n.linecap=s.readVarint():c===11&&(n.linejoin=s.readVarint())}function jV(c,n,s){c===1?n.transform=cb(s,s.readVarint()+s.pos):c===2?n.spread_method=s.readVarint():c===3?n.stops.push(tk(s,s.readVarint()+s.pos)):c===4?n.x1=s.readFloat():c===5?n.y1=s.readFloat():c===6?n.x2=s.readFloat():c===7&&(n.y2=s.readFloat())}function tk(c,n){return c.readFields(HV,{offset:0,opacity:255,rgb_color:m2},n)}function HV(c,n,s){c===1?n.offset=s.readFloat():c===2?n.opacity=s.readVarint():c===3&&(n.rgb_color=ub(s.readVarint()))}function GV(c,n,s){c===1?n.transform=cb(s,s.readVarint()+s.pos):c===2?n.spread_method=s.readVarint():c===3?n.stops.push(tk(s,s.readVarint()+s.pos)):c===4?n.cx=s.readFloat():c===5?n.cy=s.readFloat():c===6?n.r=s.readFloat():c===7?n.fx=s.readFloat():c===8?n.fy=s.readFloat():c===9&&(n.fr=s.readFloat())}function WV(c,n,s){c===1?n.transform=cb(s,s.readVarint()+s.pos):c===2?n.clip_path_idx=s.readVarint():c===3&&n.children.push(lb(s,s.readVarint()+s.pos))}function qV(c,n,s){c===1?n.left=n.top=s.readFloat():c===2?n.width=n.height=s.readFloat():c===3?n.top=s.readFloat():c===4?n.height=s.readFloat():c===5?n.mask_type=s.readVarint():c===6?n.mask_idx=s.readVarint():c===7&&n.children.push(lb(s,s.readVarint()+s.pos))}class KV{static calculate(n,s){const u=new Map,g=new Map;if(Object.keys(n).length===0)return u;s.forEach(h=>{g.set(h.name,h.rgb_color||new io(0,0,0))});for(const[h,v]of Object.entries(n))g.has(h)?u.set(g.get(h).toStringPremultipliedAlpha(),v):console.warn(`Ignoring unknown image variable "${h}"`);return u}}function Wp(c,n=255,s){const u=n/255,g=c.toStringPremultipliedAlpha(),h=s.has(g)?s.get(g).clone():c.clone();return h.a=u,h.toString()}function Zv(c,n){if(!Ie()){const s=document.createElement("canvas");return s.width=c,s.height=n,s}return new OffscreenCanvas(c,n)}function ZV(c,n){const s=KV.calculate(n.params,c.metadata?c.metadata.variables:[]),u=c.usvg_tree,g=u.width,h=u.height,v=n.transform?n.transform:new DOMMatrix,T=Math.max(1,Math.round(g*v.a)),A=Math.max(1,Math.round(h*v.d)),D=new DOMMatrix([T/g,0,0,A/h,0,0]),x=Zv(T,A).getContext("2d");return v2(x,D,u,u,s),x.getImageData(0,0,T,A)}function v2(c,n,s,u,g){for(const h of u.children)nk(c,n,s,h,g)}function nk(c,n,s,u,g){u.group?(c.save(),function(h,v,T,A,D){const x=A.mask_idx!=null?T.masks[A.mask_idx]:null,P=A.clip_path_idx!=null?T.clip_paths[A.clip_path_idx]:null;if(A.transform&&(v=db(A.transform).preMultiplySelf(v)),!function(R,V,W){return R.opacity!==255||V||W}(A,P!=null,x!=null))return void v2(h,v,T,A,D);const L=Zv(h.canvas.width,h.canvas.height),I=L.getContext("2d");v2(I,v,T,A,D),P&&ck(I,v,T,P),x&&uk(I,v,T,x,D),h.globalAlpha=A.opacity/255,h.drawImage(L,0,0)}(c,n,s,u.group,g),c.restore()):u.path&&(c.save(),function(h,v,T,A,D){const x=dk(A);h.setTransform(v),A.paint_order===JA.PAINT_ORDER_FILL_AND_STROKE?(rk(h,T,A,x,D),ik(h,T,A,x,D)):(ik(h,T,A,x,D),rk(h,T,A,x,D))}(c,n,s,u.path,g),c.restore())}function rk(c,n,s,u,g){const h=s.fill;if(!h)return;const v=h.opacity/255;switch(h.paint){case"rgb_color":c.fillStyle=Wp(h.rgb_color,h.opacity,g);break;case"linear_gradient_idx":c.fillStyle=sk(c,n.linear_gradients[h.linear_gradient_idx],v,g);break;case"radial_gradient_idx":c.fillStyle=ak(c,n.radial_gradients[h.radial_gradient_idx],v,g)}c.fill(u,ok(s))}function ok(c){return c.rule===g2.PATH_RULE_NON_ZERO?"nonzero":c.rule===g2.PATH_RULE_EVEN_ODD?"evenodd":void 0}function ik(c,n,s,u,g){const h=s.stroke;if(!h)return;c.lineWidth=h.width,c.miterLimit=h.miterlimit,c.setLineDash(h.dasharray),c.lineDashOffset=h.dashoffset;const v=h.opacity/255;switch(h.paint){case"rgb_color":c.strokeStyle=Wp(h.rgb_color,h.opacity,g);break;case"linear_gradient_idx":c.strokeStyle=sk(c,n.linear_gradients[h.linear_gradient_idx],v,g);break;case"radial_gradient_idx":c.strokeStyle=ak(c,n.radial_gradients[h.radial_gradient_idx],v,g)}switch(h.linejoin){case Kv.LINE_JOIN_MITER_CLIP:case Kv.LINE_JOIN_MITER:c.lineJoin="miter";break;case Kv.LINE_JOIN_ROUND:c.lineJoin="round";break;case Kv.LINE_JOIN_BEVEL:c.lineJoin="bevel"}switch(h.linecap){case ab.LINE_CAP_BUTT:c.lineCap="butt";break;case ab.LINE_CAP_ROUND:c.lineCap="round";break;case ab.LINE_CAP_SQUARE:c.lineCap="square"}c.stroke(u)}function sk(c,n,s,u){if(n.stops.length===1){const L=n.stops[0];return Wp(L.rgb_color,L.opacity*s,u)}const g=db(n.transform),{x1:h,y1:v,x2:T,y2:A}=n,D=g.transformPoint(new DOMPoint(h,v)),x=g.transformPoint(new DOMPoint(T,A)),P=c.createLinearGradient(D.x,D.y,x.x,x.y);for(const L of n.stops)P.addColorStop(L.offset,Wp(L.rgb_color,L.opacity*s,u));return P}function ak(c,n,s,u){if(n.stops.length===1){const L=n.stops[0];return Wp(L.rgb_color,L.opacity*s,u)}const g=db(n.transform),{fx:h,fy:v,cx:T,cy:A}=n,D=g.transformPoint(new DOMPoint(h,v)),x=g.transformPoint(new DOMPoint(T,A)),P=c.createRadialGradient(D.x,D.y,0,x.x,x.y,n.r*((g.a+g.d)/2));for(const L of n.stops)P.addColorStop(L.offset,Wp(L.rgb_color,L.opacity*s,u));return P}function lk(c,n,s,u){const g=u.transform?db(u.transform).preMultiplySelf(n):n,h=Zv(c.canvas.width,c.canvas.height),v=h.getContext("2d");for(const A of u.children)if(A.group)lk(v,g,s,A.group);else if(A.path){const D=A.path,x=new Path2D;x.addPath(dk(D),g),v.fill(x,ok(D))}const T=u.clip_path_idx!=null?s.clip_paths[u.clip_path_idx]:null;T&&ck(v,g,s,T),c.globalCompositeOperation="source-over",c.drawImage(h,0,0)}function ck(c,n,s,u){const g=Zv(c.canvas.width,c.canvas.height);lk(g.getContext("2d"),n,s,u),c.globalCompositeOperation="destination-in",c.drawImage(g,0,0)}function uk(c,n,s,u,g){if(u.children.length===0)return;const h=u.mask_idx!=null?s.masks[u.mask_idx]:null;h&&uk(c,n,s,h,g);const v=c.canvas.width,T=c.canvas.height,A=Zv(v,T),D=A.getContext("2d"),x=u.width,P=u.height,L=u.left,I=u.top,R=new Path2D,V=new Path2D;V.rect(L,I,x,P),R.addPath(V,n),D.clip(R);for(const re of u.children)nk(D,n,s,re,g);const W=D.getImageData(0,0,v,T),K=W.data;if(u.mask_type===QA.MASK_TYPE_LUMINANCE)for(let re=0;re<K.length;re+=4)K[re+3]=K[re+3]/255*(.2126*K[re]+.7152*K[re+1]+.0722*K[re+2]);D.putImageData(W,0,0),c.globalCompositeOperation="destination-in",c.drawImage(A,0,0)}function db(c){return c?new DOMMatrix([c.sx,c.ky,c.kx,c.sy,c.tx,c.ty]):new DOMMatrix}function dk(c){const n=new Path2D,s=c.step;let u=c.diffs[0]*s,g=c.diffs[1]*s;n.moveTo(u,g);for(let h=0,v=2;h<c.commands.length;h++)switch(c.commands[h]){case Gp.PATH_COMMAND_MOVE:u+=c.diffs[v++]*s,g+=c.diffs[v++]*s,n.moveTo(u,g);break;case Gp.PATH_COMMAND_LINE:u+=c.diffs[v++]*s,g+=c.diffs[v++]*s,n.lineTo(u,g);break;case Gp.PATH_COMMAND_QUAD:{const T=u+c.diffs[v++]*s,A=g+c.diffs[v++]*s;u=T+c.diffs[v++]*s,g=A+c.diffs[v++]*s,n.quadraticCurveTo(T,A,u,g);break}case Gp.PATH_COMMAND_CUBIC:{const T=u+c.diffs[v++]*s,A=g+c.diffs[v++]*s,D=T+c.diffs[v++]*s,x=A+c.diffs[v++]*s;u=D+c.diffs[v++]*s,g=x+c.diffs[v++]*s,n.bezierCurveTo(T,A,D,x,u,g);break}case Gp.PATH_COMMAND_CLOSE:n.closePath()}return n}class _2{constructor(n){this.capacity=n,this.cache=new Map}get(n){if(!this.cache.has(n))return;const s=this.cache.get(n);return this.cache.delete(n),this.cache.set(n,s),s}put(n,s){this.cache.has(n)?this.cache.delete(n):this.cache.size===this.capacity&&this.cache.delete(this.cache.keys().next().value),this.cache.set(n,s)}delete(n){this.cache.delete(n)}}class y2{constructor(){this.cacheMap=new Map,this.cacheDependenciesMap=new Map}static _getImage(n){return new qi(n,n.data)}getFromCache(n,s,u){return this.cacheMap.has(u)||this.cacheMap.set(u,new _2(150)),this.cacheMap.get(u).get(sl(n.serialize(),s))}setInCache(n,s,u,g){this.cacheDependenciesMap.has(g)||this.cacheDependenciesMap.set(g,new Map),this.cacheMap.has(g)||this.cacheMap.set(g,new _2(150));const h=this.cacheDependenciesMap.get(g);h.get(sl(n.id,u))||h.set(sl(n.id,u),new Set);const v=this.cacheMap.get(g),T=n.serialize();h.get(sl(n.id,u)).add(T),v.put(sl(n.serialize(),u),s)}removeImagesFromCacheByIds(n,s,u=""){if(!this.cacheMap.has(u)||!this.cacheDependenciesMap.has(u))return;const g=this.cacheMap.get(u),h=this.cacheDependenciesMap.get(u);for(const v of n)if(h.has(sl(v,s))){for(const T of h.get(sl(v,s)))g.delete(T);h.delete(sl(v,s))}}rasterize(n,s,u,g,h=ZV){const v=this.getFromCache(n,u,g);if(v)return v.clone();const T=h(s.icon,n.options),A=y2._getImage(T);return this.setInCache(n,A,u,g),A.clone()}}class hk{constructor(n){this.size=n,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(n,s){const u=this.toIdx(n,s);return{min:this.minimums[u],max:this.maximums[u]}}isLeaf(n,s){return this.leaves[this.toIdx(n,s)]}toIdx(n,s){return s*this.size+n}}function fk(c,n,s,u){let g=0,h=Number.MAX_VALUE;for(let v=0;v<3;v++)if(Math.abs(u[v])<1e-15){if(s[v]<c[v]||s[v]>n[v])return null}else{const T=1/u[v];let A=(c[v]-s[v])*T,D=(n[v]-s[v])*T;if(A>D){const x=A;A=D,D=x}if(A>g&&(g=A),D<h&&(h=D),g>h)return null}return g}function pk(c,n,s,u,g,h,v,T,A,D,x){const P=u-c,L=g-n,I=h-s,R=v-c,V=T-n,W=A-s,K=x[1]*W-x[2]*V,re=x[2]*R-x[0]*W,ie=x[0]*V-x[1]*R,Q=P*K+L*re+I*ie;if(Math.abs(Q)<1e-15)return null;const ue=1/Q,_e=D[0]-c,Ee=D[1]-n,Ne=D[2]-s,ze=(_e*K+Ee*re+Ne*ie)*ue;if(ze<0||ze>1)return null;const De=Ee*I-Ne*L,ot=Ne*P-_e*I,$e=_e*L-Ee*P,it=(x[0]*De+x[1]*ot+x[2]*$e)*ue;return it<0||ze+it>1?null:(R*De+V*ot+W*$e)*ue}function mk(c,n,s){return(c-n)/(s-n)}function gk(c,n,s,u,g,h,v,T,A){const D=1<<s,x=h-u,P=v-g,L=(c+1)/D*x+u,I=(n+0)/D*P+g,R=(n+1)/D*P+g;T[0]=(c+0)/D*x+u,T[1]=I,A[0]=L,A[1]=R}class vk{constructor(n){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=n,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const s=function(h){const v=Math.ceil(Math.log2(h.dim/8)),T=[];let A=Math.ceil(Math.pow(2,v));const D=1/A,x=(I,R,V,W,K)=>{const re=W?1:0,ie=(I+1)*V-re,Q=R*V,ue=(R+1)*V-re;K[0]=I*V,K[1]=Q,K[2]=ie,K[3]=ue};let P=new hk(A);const L=[];for(let I=0;I<A*A;I++){x(I%A,Math.floor(I/A),D,!1,L);const R=Cd(L[0],L[1],h),V=Cd(L[2],L[1],h),W=Cd(L[2],L[3],h),K=Cd(L[0],L[3],h);P.minimums.push(Math.min(R,V,W,K)),P.maximums.push(Math.max(R,V,W,K)),P.leaves.push(1)}for(T.push(P),A/=2;A>=1;A/=2){const I=T[T.length-1];P=new hk(A);for(let R=0;R<A*A;R++){x(R%A,Math.floor(R/A),2,!0,L);const V=I.getElevation(L[0],L[1]),W=I.getElevation(L[2],L[1]),K=I.getElevation(L[2],L[3]),re=I.getElevation(L[0],L[3]),ie=I.isLeaf(L[0],L[1]),Q=I.isLeaf(L[2],L[1]),ue=I.isLeaf(L[2],L[3]),_e=I.isLeaf(L[0],L[3]),Ee=Math.min(V.min,W.min,K.min,re.min),Ne=Math.max(V.max,W.max,K.max,re.max),ze=ie&&Q&&ue&&_e;P.maximums.push(Ne),P.minimums.push(Ee),P.leaves.push(Ne-Ee<=5&&ze?1:0)}T.push(P)}return T}(this.dem),u=s.length-1,g=s[u];this._addNode(g.minimums[0],g.maximums[0],g.leaves[0]),this._construct(s,0,0,u,0)}raycastRoot(n,s,u,g,h,v,T=1){return fk([n,s,-100],[u,g,this.maximums[0]*T],h,v)}raycast(n,s,u,g,h,v,T=1){if(!this.nodeCount)return null;const A=this.raycastRoot(n,s,u,g,h,v,T);if(A==null)return null;const D=[],x=[],P=[],L=[],I=[{idx:0,t:A,nodex:0,nodey:0,depth:0}];for(;I.length>0;){const{idx:R,t:V,nodex:W,nodey:K,depth:re}=I.pop();if(this.leaves[R]){gk(W,K,re,n,s,u,g,P,L);const Q=1<<re,ue=(W+0)/Q,_e=(W+1)/Q,Ee=(K+0)/Q,Ne=(K+1)/Q,ze=Cd(ue,Ee,this.dem)*T,De=Cd(_e,Ee,this.dem)*T,ot=Cd(_e,Ne,this.dem)*T,$e=Cd(ue,Ne,this.dem)*T,it=pk(P[0],P[1],ze,L[0],P[1],De,L[0],L[1],ot,h,v),ft=pk(L[0],L[1],ot,P[0],L[1],$e,P[0],P[1],ze,h,v),ut=Math.min(it!==null?it:Number.MAX_VALUE,ft!==null?ft:Number.MAX_VALUE);if(ut!==Number.MAX_VALUE)return ut;{const mt=Fe.vec3.scaleAndAdd([],h,v,V);if(_k(ze,De,$e,ot,mk(mt[0],P[0],L[0]),mk(mt[1],P[1],L[1]))>=mt[2])return V}continue}let ie=0;for(let Q=0;Q<this._siblingOffset.length;Q++){gk((W<<1)+this._siblingOffset[Q][0],(K<<1)+this._siblingOffset[Q][1],re+1,n,s,u,g,P,L),P[2]=-100,L[2]=this.maximums[this.childOffsets[R]+Q]*T;const ue=fk(P,L,h,v);if(ue!=null){const _e=ue;D[Q]=_e;let Ee=!1;for(let Ne=0;Ne<ie&&!Ee;Ne++)_e>=D[x[Ne]]&&(x.splice(Ne,0,Q),Ee=!0);Ee||(x[ie]=Q),ie++}}for(let Q=0;Q<ie;Q++){const ue=x[Q];I.push({idx:this.childOffsets[R]+ue,t:D[ue],nodex:(W<<1)+this._siblingOffset[ue][0],nodey:(K<<1)+this._siblingOffset[ue][1],depth:re+1})}}return null}_addNode(n,s,u){return this.minimums.push(n),this.maximums.push(s),this.leaves.push(u),this.childOffsets.push(0),this.nodeCount++}_construct(n,s,u,g,h){if(n[g].isLeaf(s,u)===1)return;this.childOffsets[h]||(this.childOffsets[h]=this.nodeCount);const v=g-1,T=n[v];let A=0,D=0;for(let x=0;x<this._siblingOffset.length;x++){const P=2*s+this._siblingOffset[x][0],L=2*u+this._siblingOffset[x][1],I=T.getElevation(P,L),R=T.isLeaf(P,L),V=this._addNode(I.min,I.max,R);R&&(A|=1<<x),D||(D=V)}for(let x=0;x<this._siblingOffset.length;x++)A&1<<x||this._construct(n,2*s+this._siblingOffset[x][0],2*u+this._siblingOffset[x][1],v,D+x)}}function _k(c,n,s,u,g,h){return cr(cr(c,s,h),cr(n,u,h),g)}function Cd(c,n,s){const u=s.dim,g=It(c*u-.5,0,u-1),h=It(n*u-.5,0,u-1),v=Math.floor(g),T=Math.floor(h),A=Math.min(v+1,u-1),D=Math.min(T+1,u-1);return _k(s.get(v,T),s.get(A,T),s.get(v,D),s.get(A,D),g-v,h-T)}const YV={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};function XV(c,n,s){return(256*c*256+256*n+s)/10-1e4}function JV(c,n,s){return 256*c+n+s/256-32768}class hb{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(n,s,u,g=!1){if(this.uid=n,s.height!==s.width)throw new RangeError("DEM tiles must be square");if(u&&u!=="mapbox"&&u!=="terrarium")return void wn(`"${u}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=s.height;const h=this.dim=s.height-2,v=new Uint32Array(s.data.buffer);if(this.pixels=new Uint8Array(s.data.buffer),this.floatView=new Float32Array(s.data.buffer),this.borderReady=g,this._modifiedForSources={},!g){for(let A=0;A<h;A++)v[this._idx(-1,A)]=v[this._idx(0,A)],v[this._idx(h,A)]=v[this._idx(h-1,A)],v[this._idx(A,-1)]=v[this._idx(A,0)],v[this._idx(A,h)]=v[this._idx(A,h-1)];v[this._idx(-1,-1)]=v[this._idx(0,0)],v[this._idx(h,-1)]=v[this._idx(h-1,0)],v[this._idx(-1,h)]=v[this._idx(0,h-1)],v[this._idx(h,h)]=v[this._idx(h-1,h-1)]}const T=u==="terrarium"?JV:XV;for(let A=0;A<v.length;++A){const D=4*A;this.floatView[A]=T(this.pixels[D],this.pixels[D+1],this.pixels[D+2])}this._timestamp=je.now()}_buildQuadTree(){this._tree=new vk(this)}get(n,s,u=!1){u&&(n=It(n,-1,this.dim),s=It(s,-1,this.dim));const g=this._idx(n,s);return this.floatView[g]}set(n,s,u){const g=this._idx(n,s),h=this.floatView[g];return this.floatView[g]=u,u-h}static getUnpackVector(n){return YV[n]}_idx(n,s){if(n<-1||n>=this.dim+1||s<-1||s>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(s+1)*this.stride+(n+1)}static pack(n,s){const u=[0,0,0,0],g=hb.getUnpackVector(s);let h=Math.floor((n+g[3])/g[2]);return u[2]=h%256,h=Math.floor(h/256),u[1]=h%256,h=Math.floor(h/256),u[0]=h,u}getPixels(){return new zM({width:this.stride,height:this.stride},this.pixels)}backfillBorder(n,s,u){if(this.dim!==n.dim)throw new Error("dem dimension mismatch");let g=s*this.dim,h=s*this.dim+this.dim,v=u*this.dim,T=u*this.dim+this.dim;switch(s){case-1:g=h-1;break;case 1:h=g+1}switch(u){case-1:v=T-1;break;case 1:T=v+1}const A=-s*this.dim,D=-u*this.dim;for(let x=v;x<T;x++)for(let P=g;P<h;P++){const L=4*this._idx(P,x),I=4*this._idx(P+A,x+D);this.pixels[L+0]=n.pixels[I+0],this.pixels[L+1]=n.pixels[I+1],this.pixels[L+2]=n.pixels[I+2],this.pixels[L+3]=n.pixels[I+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}function QV(c,n,s){c===1?n.headerLength=s.readFixed32():c===2?n.x=s.readVarint():c===3?n.y=s.readVarint():c===4?n.z=s.readVarint():c===5&&n.layers.push(function(u,g){return u.readFields(o$,{version:0,name:"",units:"",tileSize:0,buffer:0,pixelFormat:0,dataIndex:[]},g)}(s,s.readVarint()+s.pos))}function e$(c,n,s){c===1?(n.delta_filter=function(u,g){return u.readFields(t$,{blockSize:0},g)}(s,s.readVarint()+s.pos),n.filter="delta_filter"):c===2?(s.readVarint(),n.filter="zigzag_filter"):c===3?(s.readVarint(),n.filter="bitshuffle_filter"):c===4&&(s.readVarint(),n.filter="byteshuffle_filter")}function t$(c,n,s){c===1&&(n.blockSize=s.readVarint())}function n$(c,n,s){c===1?(s.readVarint(),n.codec="gzip_data"):c===2?(s.readVarint(),n.codec="jpeg_image"):c===3?(s.readVarint(),n.codec="webp_image"):c===4&&(s.readVarint(),n.codec="png_image")}function r$(c,n,s){let u=0,g=0;c===1?n.firstByte=s.readFixed64():c===2?n.lastByte=s.readFixed64():c===3?n.filters.push(function(h,v){return h.readFields(e$,{},v)}(s,s.readVarint()+s.pos)):c===4?n.codec=function(h,v){return h.readFields(n$,{},v)}(s,s.readVarint()+s.pos):c===5?g=s.readFloat():c===6?u=s.readFloat():c===7?n.bands.push(s.readString()):c===8?n.offset=s.readDouble():c===9&&(n.scale=s.readDouble()),n.offset===0&&(n.offset=g),n.scale===0&&(n.scale=u)}function o$(c,n,s){c===1?n.version=s.readVarint():c===2?n.name=s.readString():c===3?n.units=s.readString():c===4?n.tileSize=s.readVarint():c===5?n.buffer=s.readVarint():c===6?n.pixelFormat=s.readVarint():c===7&&n.dataIndex.push(function(u,g){return u.readFields(r$,{firstByte:0,lastByte:0,filters:[],codec:null,offset:0,scale:0,bands:[]},g)}(s,s.readVarint()+s.pos))}function i$(c,n,s){if(c===2)(function(u,g,h){u.readFields(s$,h,g)})(s,s.readVarint()+s.pos,n);else if(c===3)throw new Error("Not implemented")}function s$(c,n,s){if(c===1){let u=0;const g=s.readVarint()+s.pos;for(;s.pos<g;)n[u++]=s.readVarint()}}function a$(c,n){if(n.length!==4)throw new Error(`Expected data of dimension 4 but got ${n.length}.`);let s=n[3];for(let u=2;u>=1;u--){const g=u===1?1:0,h=u===2?1:0;for(let v=0;v<n[0];v++){const T=n[1]*v;for(let A=g;A<n[1];A++){const D=n[2]*(A+T);for(let x=h;x<n[2];x++){const P=n[3]*(x+D);for(let L=0;L<n[3];L++){const I=P+L;c[I]+=c[I-s]}}}}s*=n[u]}return c}function l$(c){for(let n=0,s=c.length;n<s;n++)c[n]=c[n]>>>1^-(1&c[n]);return c}function c$(c,n){switch(n){case"uint32":return c;case"uint16":for(let s=0;s<c.length;s+=2){const u=c[s],g=c[s+1];c[s]=(240&u)>>4|(61440&u)>>8|(240&g)<<4|61440&g,c[s+1]=15&u|(3840&u)>>4|(15&g)<<8|(3840&g)<<4}return c;case"uint8":for(let s=0;s<c.length;s+=4){const u=c[s],g=c[s+1],h=c[s+2],v=c[s+3];c[s+0]=(192&u)>>6|(192&g)>>4|(192&h)>>2|192&v,c[s+1]=(48&u)>>4|(48&g)>>2|48&h|(48&v)<<2,c[s+2]=(12&u)>>2|12&g|(12&h)<<2|(12&v)<<4,c[s+3]=3&u|(3&g)<<2|(3&h)<<4|(3&v)<<6}return c;default:throw new Error(`Invalid pixel format, "${n}"`)}}Hn(hb,"DEMData"),Hn(vk,"DemMinMaxQuadTree",{omit:["dem"]});var Va=Uint8Array,Yv=Uint16Array,u$=Int32Array,yk=new Va([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),bk=new Va([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),d$=new Va([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),xk=function(c,n){for(var s=new Yv(31),u=0;u<31;++u)s[u]=n+=1<<c[u-1];var g=new u$(s[30]);for(u=1;u<30;++u)for(var h=s[u];h<s[u+1];++h)g[h]=h-s[u]<<5|u;return{b:s,r:g}},wk=xk(yk,2),Sk=wk.b,h$=wk.r;Sk[28]=258,h$[258]=28;for(var f$=xk(bk,0).b,Tk=new Yv(32768),wi=0;wi<32768;++wi){var qp=(43690&wi)>>1|(21845&wi)<<1;Tk[wi]=((65280&(qp=(61680&(qp=(52428&qp)>>2|(13107&qp)<<2))>>4|(3855&qp)<<4))>>8|(255&qp)<<8)>>1}var Xv=function(c,n,s){for(var u=c.length,g=0,h=new Yv(n);g<u;++g)c[g]&&++h[c[g]-1];var v,T=new Yv(n);for(g=1;g<n;++g)T[g]=T[g-1]+h[g-1]<<1;v=new Yv(1<<n);var A=15-n;for(g=0;g<u;++g)if(c[g])for(var D=g<<4|c[g],x=n-c[g],P=T[c[g]-1]++<<x,L=P|(1<<x)-1;P<=L;++P)v[Tk[P]>>A]=D;return v},Jv=new Va(288);for(wi=0;wi<144;++wi)Jv[wi]=8;for(wi=144;wi<256;++wi)Jv[wi]=9;for(wi=256;wi<280;++wi)Jv[wi]=7;for(wi=280;wi<288;++wi)Jv[wi]=8;var Ck=new Va(32);for(wi=0;wi<32;++wi)Ck[wi]=5;var p$=Xv(Jv,9),m$=Xv(Ck,5),b2=function(c){for(var n=c[0],s=1;s<c.length;++s)c[s]>n&&(n=c[s]);return n},Hl=function(c,n,s){var u=n/8|0;return(c[u]|c[u+1]<<8)>>(7&n)&s},x2=function(c,n){var s=n/8|0;return(c[s]|c[s+1]<<8|c[s+2]<<16)>>(7&n)},g$=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],Gl=function(c,n,s){var u=new Error(n||g$[c]);if(u.code=c,Error.captureStackTrace&&Error.captureStackTrace(u,Gl),!s)throw u;return u},v$=new Va(0),_$=typeof TextDecoder<"u"&&new TextDecoder;try{_$.decode(v$,{stream:!0})}catch{}const y$={gzip_data:"gzip"};class fl extends Error{constructor(n){super(n),this.name="MRTError"}}const b$={0:"uint32",1:"uint32",2:"uint16",3:"uint8"},Ek={uint32:1,uint16:2,uint8:4},x$={uint32:Uint32Array,uint16:Uint16Array,uint8:Uint8Array};let w2;class S2{constructor(n=5){this.x=NaN,this.y=NaN,this.z=NaN,this.layers={},this._cacheSize=n}getLayer(n){const s=this.layers[n];if(!s)throw new fl(`Layer '${n}' not found`);return s}getHeaderLength(n){const s=new Uint8Array(n),u=new DataView(n);if(s[0]!==13)throw new fl("File is not a valid MRT.");return u.getUint32(1,!0)}parseHeader(n){const s=new Uint8Array(n),u=this.getHeaderLength(n);if(s.length<u)throw new fl(`Expected header with length >= ${u} but got buffer of length ${s.length}`);const g=function(h,v){return h.readFields(QV,{headerLength:0,x:0,y:0,z:0,layers:[]},void 0)}(new w2(s.subarray(0,u)));if(!isNaN(this.x)&&(this.x!==g.x||this.y!==g.y||this.z!==g.z))throw new fl(`Invalid attempt to parse header ${g.z}/${g.x}/${g.y} for tile ${this.z}/${this.x}/${this.y}`);this.x=g.x,this.y=g.y,this.z=g.z;for(const h of g.layers)this.layers[h.name]=new w$(h,{cacheSize:this._cacheSize});return this}createDecodingTask(n){const s=[],u=this.getLayer(n.layerName);for(let g of n.blockIndices){const h=u.dataIndex[g],v=h.firstByte-n.firstByte,T=h.lastByte-n.firstByte;if(u._blocksInProgress.has(g))continue;const A={layerName:u.name,firstByte:v,lastByte:T,pixelFormat:u.pixelFormat,blockIndex:g,blockShape:[h.bands.length].concat(u.bandShape),buffer:u.buffer,codec:h.codec.codec,filters:h.filters.map(D=>D.filter)};u._blocksInProgress.add(g),s.push(A)}return new Mk(s,()=>{s.forEach(g=>u._blocksInProgress.delete(g.blockIndex))},(g,h)=>{if(s.forEach(v=>u._blocksInProgress.delete(v.blockIndex)),g)throw g;h.forEach(v=>{this.getLayer(v.layerName).processDecodedData(v)})})}}class w${constructor({version:n,name:s,units:u,tileSize:g,pixelFormat:h,buffer:v,dataIndex:T},A){if(this.version=n,this.version!==1)throw new fl(`Cannot parse raster layer encoded with MRT version ${n}`);this.name=s,this.units=u,this.tileSize=g,this.buffer=v,this.pixelFormat=b$[h],this.dataIndex=T,this.bandShape=[g+2*v,g+2*v,Ek[this.pixelFormat]],this._decodedBlocks=new _2(A?A.cacheSize:5),this._blocksInProgress=new Set}get dimension(){return Ek[this.pixelFormat]}get cacheSize(){return this._decodedBlocks.capacity}getBandList(){return this.dataIndex.map(({bands:n})=>n).flat()}processDecodedData(n){const s=n.blockIndex.toString();this._decodedBlocks.get(s)||this._decodedBlocks.put(s,n.data)}getBlockForBand(n){let s=0;switch(typeof n){case"string":for(const[u,g]of this.dataIndex.entries()){for(const[h,v]of g.bands.entries())if(v===n)return{bandIndex:s+h,blockIndex:u,blockBandIndex:h};s+=g.bands.length}break;case"number":for(const[u,g]of this.dataIndex.entries()){if(n>=s&&n<s+g.bands.length)return{bandIndex:n,blockIndex:u,blockBandIndex:n-s};s+=g.bands.length}break;default:throw new fl(`Invalid band \`${JSON.stringify(n)}\`. Expected string or integer.`)}throw new fl(`Band not found: ${JSON.stringify(n)}`)}getDataRange(n){let s=1/0,u=-1/0;const g=[],h=new Set;for(const v of n){const{blockIndex:T}=this.getBlockForBand(v);if(T<0)throw new fl(`Invalid band: ${JSON.stringify(v)}`);const A=this.dataIndex[T];g.includes(T)||g.push(T),h.add(T),s=Math.min(s,A.firstByte),u=Math.max(u,A.lastByte)}if(h.size>this.cacheSize)throw new fl(`Number of blocks to decode (${h.size}) exceeds cache size (${this.cacheSize}).`);return{layerName:this.name,firstByte:s,lastByte:u,blockIndices:g}}hasBand(n){const{blockIndex:s}=this.getBlockForBand(n);return s>=0}hasDataForBand(n){const{blockIndex:s}=this.getBlockForBand(n);return s>=0&&!!this._decodedBlocks.get(s.toString())}getBandView(n){const{blockIndex:s,blockBandIndex:u}=this.getBlockForBand(n),g=this._decodedBlocks.get(s.toString());if(!g)throw new fl(`Data for band ${JSON.stringify(n)} of layer "${this.name}" not decoded.`);const h=this.dataIndex[s],v=this.bandShape.reduce((D,x)=>D*x,1),T=u*v,A=g.subarray(T,T+v);return{data:A,bytes:new Uint8Array(A.buffer).subarray(A.byteOffset,A.byteOffset+A.byteLength),tileSize:this.tileSize,buffer:this.buffer,pixelFormat:this.pixelFormat,dimension:this.dimension,offset:h.offset,scale:h.scale}}}S2.setPbf=function(c){w2=c};class Mk{constructor(n,s,u){this.tasks=n,this._onCancel=s,this._onComplete=u,this._finalized=!1}cancel(){this._finalized||(this._onCancel(),this._finalized=!0)}complete(n,s){this._finalized||(this._onComplete(n,s),this._finalized=!0)}}S2.performDecoding=function(c,n){const s=new Uint8Array(c);return Promise.all(n.tasks.map(u=>{const{layerName:g,firstByte:h,lastByte:v,pixelFormat:T,blockShape:A,blockIndex:D,filters:x,codec:P}=u,L=s.subarray(h,v+1),I=new Uint32Array(A[0]*A[1]*A[2]);let R;if(P!=="gzip_data")throw new fl(`Unhandled codec: ${P}`);return R=function(V,W){if(!globalThis.DecompressionStream&&W==="gzip_data")return Promise.resolve(((Q=function(Ee){Ee[0]==31&&Ee[1]==139&&Ee[2]==8||Gl(6,"invalid gzip data");var Ne=Ee[3],ze=10;4&Ne&&(ze+=2+(Ee[10]|Ee[11]<<8));for(var De=(Ne>>3&1)+(Ne>>4&1);De>0;De-=!Ee[ze++]);return ze+(2&Ne)}(ie=V))+8>ie.length&&Gl(6,"invalid gzip data"),function(Ee,Ne,ze,De){var ot=Ee.length;if(!ot||Ne.f&&!Ne.l)return ze||new Va(0);var $e=!ze,it=$e||Ne.i!=2,ft=Ne.i;$e&&(ze=new Va(3*ot));var ut,mt,xt=function(Ed){var sf=ze.length;if(Ed>sf){var n_=new Va(Math.max(2*sf,Ed));n_.set(ze),ze=n_}},At=Ne.f||0,_t=Ne.p||0,Zt=Ne.b||0,hn=Ne.l,Kt=Ne.d,kn=Ne.m,Mn=Ne.n,_n=8*ot;do{if(!hn){At=Hl(Ee,_t,1);var mn=Hl(Ee,_t+1,3);if(_t+=3,!mn){var Zn=Ee[(xr=4+((_t+7)/8|0))-4]|Ee[xr-3]<<8,Rn=xr+Zn;if(Rn>ot){ft&&Gl(0);break}it&&xt(Zt+Zn),ze.set(Ee.subarray(xr,Rn),Zt),Ne.b=Zt+=Zn,Ne.p=_t=8*Rn,Ne.f=At;continue}if(mn==1)hn=p$,Kt=m$,kn=9,Mn=5;else if(mn==2){var Fn=Hl(Ee,_t,31)+257,pr=Hl(Ee,_t+10,15)+4,Ir=Fn+Hl(Ee,_t+5,31)+1;_t+=14;for(var Ar=new Va(Ir),kr=new Va(19),Nr=0;Nr<pr;++Nr)kr[d$[Nr]]=Hl(Ee,_t+3*Nr,7);_t+=3*pr;var Vr=b2(kr),ko=(1<<Vr)-1,go=Xv(kr,Vr);for(Nr=0;Nr<Ir;){var xr,uo=go[Hl(Ee,_t,ko)];if(_t+=15&uo,(xr=uo>>4)<16)Ar[Nr++]=xr;else{var fo=0,$o=0;for(xr==16?($o=3+Hl(Ee,_t,3),_t+=2,fo=Ar[Nr-1]):xr==17?($o=3+Hl(Ee,_t,7),_t+=3):xr==18&&($o=11+Hl(Ee,_t,127),_t+=7);$o--;)Ar[Nr++]=fo}}var ai=Ar.subarray(0,Fn),Si=Ar.subarray(Fn);kn=b2(ai),Mn=b2(Si),hn=Xv(ai,kn),Kt=Xv(Si,Mn)}else Gl(1);if(_t>_n){ft&&Gl(0);break}}it&&xt(Zt+131072);for(var li=(1<<kn)-1,Xo=(1<<Mn)-1,mi=_t;;mi=_t){var Mi=(fo=hn[x2(Ee,_t)&li])>>4;if((_t+=15&fo)>_n){ft&&Gl(0);break}if(fo||Gl(2),Mi<256)ze[Zt++]=Mi;else{if(Mi==256){mi=_t,hn=null;break}var ns=Mi-254;Mi>264&&(ns=Hl(Ee,_t,(1<<(ql=yk[Nr=Mi-257]))-1)+Sk[Nr],_t+=ql);var Bo=Kt[x2(Ee,_t)&Xo],Js=Bo>>4;if(Bo||Gl(3),_t+=15&Bo,Si=f$[Js],Js>3){var ql=bk[Js];Si+=x2(Ee,_t)&(1<<ql)-1,_t+=ql}if(_t>_n){ft&&Gl(0);break}it&&xt(Zt+131072);var pl=Zt+ns;if(Zt<Si){var ml=0-Si,of=Math.min(Si,pl);for(ml+Zt<0&&Gl(3);Zt<of;++Zt)ze[Zt]=(void 0)[ml+Zt]}for(;Zt<pl;++Zt)ze[Zt]=ze[Zt-Si]}}Ne.l=hn,Ne.p=mi,Ne.b=Zt,Ne.f=At,hn&&(At=1,Ne.m=kn,Ne.d=Kt,Ne.n=Mn)}while(!At);return Zt!=ze.length&&$e?(ut=ze,((mt=Zt)==null||mt>ut.length)&&(mt=ut.length),new Va(ut.subarray(0,mt))):ze.subarray(0,Zt)}(ie.subarray(Q,-8),{i:2},new Va(((K=ie)[(re=K.length)-4]|K[re-3]<<8|K[re-2]<<16|K[re-1]<<24)>>>0))));var K,re,ie,Q;const ue=y$[W];if(!ue)throw new Error(`Unhandled codec: ${W}`);const _e=new globalThis.DecompressionStream(ue);return new Response(new Blob([V]).stream().pipeThrough(_e)).arrayBuffer().then(Ee=>new Uint8Array(Ee))}(L,P).then(V=>(function(W,K){W.readFields(i$,K)}(new w2(V),I),new x$[T](I.buffer))),R.then(V=>{for(let W=x.length-1;W>=0;W--)switch(x[W]){case"delta_filter":a$(V,A);break;case"zigzag_filter":l$(V);break;case"bitshuffle_filter":c$(V,T);break;default:throw new fl(`Unhandled filter "${x[W]}"`)}return{layerName:g,blockIndex:D,data:V}}).catch(V=>{throw V})}))},Hn(Mk,"MRTDecodingBatch",{omit:["_onCancel","_onComplete"]});let Qv,T2,Wl,Kp,C2,Zp=null;function Ik(){return Go()&&self.worker&&self.worker.dracoUrl?self.worker.dracoUrl:T2||Jo.DRACO_URL}function Ak(){if(Go()&&self.worker&&self.worker.meshoptUrl)return self.worker.meshoptUrl;if(Kp)return Kp;const c=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]);if(typeof WebAssembly!="object")throw new Error("WebAssembly not supported, cannot instantiate meshoptimizer");return Kp=WebAssembly.validate(c)?Jo.MESHOPT_SIMD_URL:Jo.MESHOPT_URL,Kp}const fb={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},S$={5120:"DT_INT8",5121:"DT_UINT8",5122:"DT_INT16",5123:"DT_UINT16",5125:"DT_UINT32",5126:"DT_FLOAT32"},e_={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16};function kk(c,n,s){const u=s.json.bufferViews.length,g=s.buffers.length;n.bufferView=u,s.json.bufferViews[u]={buffer:g,byteLength:c.byteLength},s.buffers[g]=c}const E2="KHR_draco_mesh_compression";function T$(c,n){const s=c.extensions&&c.extensions[E2];if(!s)return;const u=new Wl.Decoder,g=Lk(n,s.bufferView),h=new Wl.Mesh;if(!u.DecodeArrayToMesh(g,g.byteLength,h))throw new Error("Failed to decode Draco mesh");const v=n.json.accessors[c.indices],T=fb[v.componentType],A=v.count*T.BYTES_PER_ELEMENT,D=Wl._malloc(A);T===Uint16Array?u.GetTrianglesUInt16Array(h,A,D):u.GetTrianglesUInt32Array(h,A,D),kk(Wl.memory.buffer.slice(D,D+A),v,n),Wl._free(D);for(const x of Object.keys(s.attributes)){const P=u.GetAttributeByUniqueId(h,s.attributes[x]),L=n.json.accessors[c.attributes[x]],I=S$[L.componentType],R=L.count*e_[L.type]*fb[L.componentType].BYTES_PER_ELEMENT,V=Wl._malloc(R);u.GetAttributeDataArrayForAllPoints(h,P,Wl[I],R,V),kk(Wl.memory.buffer.slice(V,V+R),L,n),Wl._free(V)}u.destroy(),h.destroy(),delete c.extensions[E2]}const pb="EXT_meshopt_compression";function C$(c,n){if(!c.extensions||!c.extensions[pb])return;const s=c.extensions[pb],u=new Uint8Array(n.buffers[s.buffer],s.byteOffset||0,s.byteLength||0),g=new Uint8Array(s.count*s.byteStride);C2.decodeGltfBuffer(g,s.count,s.byteStride,u,s.mode,s.filter),c.buffer=n.buffers.length,c.byteOffset=0,n.buffers[c.buffer]=g.buffer,delete c.extensions[pb]}const Pk=1179937895,Rk=new TextDecoder("utf8");function Ok(c,n){return new URL(c,n).href}function E$(c,n,s,u){return fetch(Ok(c.uri,u)).then(g=>g.arrayBuffer()).then(g=>{n.buffers[s]=g})}function Lk(c,n){const s=c.json.bufferViews[n];return new Uint8Array(c.buffers[s.buffer],s.byteOffset||0,s.byteLength)}function M$(c,n,s,u){if(c.uri){const g=Ok(c.uri,u);return fetch(g).then(h=>h.blob()).then(h=>createImageBitmap(h)).then(h=>{n.images[s]=h})}if(c.bufferView!==void 0){const g=Lk(n,c.bufferView),h=new Blob([g],{type:c.mimeType});return createImageBitmap(h).then(v=>{n.images[s]=v})}}function Dk(c,n=0,s){const u={json:null,images:[],buffers:[]};if(new Uint32Array(c,n,1)[0]===Pk){const x=new Uint32Array(c,n);let P=2;const L=(x[P++]>>2)-3,I=x[P++]>>2;if(P++,u.json=JSON.parse(Rk.decode(x.subarray(P,P+I))),P+=I,P<L){const R=x[P++];P++;const V=n+(P<<2);u.buffers[0]=c.slice(V,V+R)}}else u.json=JSON.parse(Rk.decode(new Uint8Array(c,n)));const{buffers:g,images:h,meshes:v,extensionsUsed:T,bufferViews:A}=u.json;let D=Promise.resolve();if(g){const x=[];for(let P=0;P<g.length;P++){const L=g[P];L.uri?x.push(E$(L,u,P,s)):u.buffers[P]||(u.buffers[P]=null)}D=Promise.all(x)}return D.then(()=>{const x=[],P=T&&T.includes(E2),L=T&&T.includes(pb);if(P&&x.push(function(){if(!Wl)return Qv??(Qv=function(I){let R,V=null;function W(){R=new Uint8Array(V.buffer)}function K(){throw new Error("Unexpected Draco error.")}const re={a:{a:K,d:function(ie,Q,ue){return R.copyWithin(ie,Q,Q+ue)},c:function(ie){const Q=R.length,ue=Math.max(ie>>>0,Math.ceil(1.2*Q)),_e=Math.ceil((ue-Q)/65536);try{return V.grow(_e),W(),!0}catch{return!1}},b:K}};return(WebAssembly.instantiateStreaming?WebAssembly.instantiateStreaming(I,re):I.then(ie=>ie.arrayBuffer()).then(ie=>WebAssembly.instantiate(ie,re))).then(ie=>{const{Rb:Q,Qb:ue,P:_e,T:Ee,X:Ne,Ja:ze,La:De,Qa:ot,Va:$e,Wa:it,eb:ft,jb:ut,f:mt,e:xt,yb:At,zb:_t,Ab:Zt,Bb:hn,Db:Kt,Gb:kn}=ie.instance.exports;V=xt;const Mn=(()=>{let _n=0,mn=0,Zn=0,Rn=0;return Fn=>{Zn&&(Q(Rn),Q(_n),mn+=Zn,Zn=_n=0),_n||(mn+=128,_n=ue(mn));const pr=Fn.length+7&-8;let Ir=_n;pr>=mn&&(Zn=pr,Ir=Rn=ue(pr));for(let Ar=0;Ar<Fn.length;Ar++)R[Ir+Ar]=Fn[Ar];return Ir}})();return W(),mt(),{memory:xt,_free:Q,_malloc:ue,Mesh:class{constructor(){this.ptr=_e()}destroy(){Ee(this.ptr)}},Decoder:class{constructor(){this.ptr=ze()}destroy(){ut(this.ptr)}DecodeArrayToMesh(_n,mn,Zn){const Rn=Mn(_n),Fn=De(this.ptr,Rn,mn,Zn.ptr);return!!Ne(Fn)}GetAttributeByUniqueId(_n,mn){return{ptr:ot(this.ptr,_n.ptr,mn)}}GetTrianglesUInt16Array(_n,mn,Zn){$e(this.ptr,_n.ptr,mn,Zn)}GetTrianglesUInt32Array(_n,mn,Zn){it(this.ptr,_n.ptr,mn,Zn)}GetAttributeDataArrayForAllPoints(_n,mn,Zn,Rn,Fn){ft(this.ptr,_n.ptr,mn.ptr,Zn,Rn,Fn)}},DT_INT8:At(),DT_UINT8:_t(),DT_INT16:Zt(),DT_UINT16:hn(),DT_UINT32:Kt(),DT_FLOAT32:kn()}})}(fetch(Ik())),Qv.then(I=>{Wl=I,Qv=void 0}))}()),L&&x.push(function(){if(C2)return;const I=function(R){let V;const W=WebAssembly.instantiateStreaming(R,{}).then(ie=>{V=ie.instance,V.exports.__wasm_call_ctors()}),K={NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},re={ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"};return{ready:W,supported:!0,decodeGltfBuffer(ie,Q,ue,_e,Ee,Ne){(function(ze,De,ot,$e,it,ft,ut){const mt=ze.exports.sbrk,xt=$e+3&-4,At=mt(xt*it),_t=mt(ft.length),Zt=new Uint8Array(ze.exports.memory.buffer);Zt.set(ft,_t);const hn=De(At,$e,it,_t,ft.length);if(hn===0&&ut&&ut(At,xt,it),ot.set(Zt.subarray(At,At+$e*it)),mt(At-mt(0)),hn!==0)throw new Error(`Malformed buffer data: ${hn}`)})(V,V.exports[re[Ee]],ie,Q,ue,_e,V.exports[K[Ne]])}}}(fetch(Ak()));return I.ready.then(()=>{C2=I})}()),h)for(let I=0;I<h.length;I++)x.push(M$(h[I],u,I,s));return(x.length?Promise.all(x):Promise.resolve()).then(()=>{if(P&&v)for(const{primitives:I}of v)for(const R of I)T$(R,u);if(L&&v&&A)for(const I of A)C$(I,u);return u})})}function rf(c,n){const s=c.json.bufferViews[n.bufferView],u=fb[n.componentType];return new u(c.buffers[s.buffer],(n.byteOffset||0)+(s.byteOffset||0),n.count*(s.byteStride&&s.byteStride!==e_[n.type]*u.BYTES_PER_ELEMENT?s.byteStride/u.BYTES_PER_ELEMENT:e_[n.type]))}function M2(c,n,s,u){const g=fb[n.componentType],h=function(x){switch(x){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:return 1}}(g),v=c.json.bufferViews[n.bufferView],T=v.byteStride?v.byteStride/g.BYTES_PER_ELEMENT:e_[n.type],A=s.float32,D=A.length/s.capacity;for(let x=0,P=0;x<n.count*T;x+=T,P+=D)for(let L=0;L<D;L++)A[P+L]=u[x+L]*h;s._trim()}function I$(c,n,s){const u=c.indices,g=c.attributes,h={};h.indexArray=new $i;const v=n.json.accessors[u],T=v.count/3;h.indexArray.reserve(T);const A=rf(n,v);for(let L=0;L<T;L++)h.indexArray.emplaceBack(A[3*L],A[3*L+1],A[3*L+2]);h.indexArray._trim(),h.vertexArray=new al;const D=n.json.accessors[g.POSITION];h.vertexArray.reserve(D.count);const x=rf(n,D);for(let L=0;L<D.count;L++)h.vertexArray.emplaceBack(x[3*L],x[3*L+1],x[3*L+2]);if(h.vertexArray._trim(),h.aabb=new Jn(D.min,D.max),h.centroid=function(L,I){const R=[0,0,0],V=L.length;if(V>0){for(let W=0;W<V;W++){const K=3*L[W];R[0]+=I[K],R[1]+=I[K+1],R[2]+=I[K+2]}R[0]/=V,R[1]/=V,R[2]/=V}return R}(A,x),g.COLOR_0!==void 0){const L=n.json.accessors[g.COLOR_0],I=e_[L.type],R=rf(n,L);h.colorArray=I===3?new al:new mu,h.colorArray.resize(L.count),M2(n,L,h.colorArray,R)}if(g.NORMAL!==void 0){h.normalArray=new al;const L=n.json.accessors[g.NORMAL];h.normalArray.resize(L.count);const I=rf(n,L);M2(n,L,h.normalArray,I)}if(g.TEXCOORD_0!==void 0&&s.length>0){h.texcoordArray=new fd;const L=n.json.accessors[g.TEXCOORD_0];h.texcoordArray.resize(L.count);const I=rf(n,L);M2(n,L,h.texcoordArray,I)}if(g._FEATURE_ID_RGBA4444!==void 0){const L=n.json.accessors[g._FEATURE_ID_RGBA4444];n.json.extensionsUsed&&n.json.extensionsUsed.includes("EXT_meshopt_compression")&&(h.featureData=rf(n,L))}g._FEATURE_RGBA4444!==void 0&&(h.featureData=new Uint32Array(rf(n,n.json.accessors[g._FEATURE_RGBA4444]).buffer));const P=c.material;return h.material=function(L,I){const{emissiveFactor:R=[0,0,0],alphaMode:V="OPAQUE",alphaCutoff:W=.5,normalTexture:K,occlusionTexture:re,emissiveTexture:ie,doubleSided:Q}=L,{baseColorFactor:ue=[1,1,1,1],metallicFactor:_e=1,roughnessFactor:Ee=1,baseColorTexture:Ne,metallicRoughnessTexture:ze}=L.pbrMetallicRoughness||{},De=re?I[re.index]:void 0;if(re&&re.extensions&&re.extensions.KHR_texture_transform&&De){const ot=re.extensions.KHR_texture_transform;De.offsetScale=[ot.offset[0],ot.offset[1],ot.scale[0],ot.scale[1]]}return{pbrMetallicRoughness:{baseColorFactor:new io(...ue),metallicFactor:_e,roughnessFactor:Ee,baseColorTexture:Ne?I[Ne.index]:void 0,metallicRoughnessTexture:ze?I[ze.index]:void 0},doubleSided:Q,emissiveFactor:R,alphaMode:V,alphaCutoff:W,normalTexture:K?I[K.index]:void 0,occlusionTexture:De,emissionTexture:ie?I[ie.index]:void 0,defined:L.defined===void 0}}(P!==void 0?n.json.materials[P]:{defined:!1},s),h}function zk(c,n,s){const{matrix:u,rotation:g,translation:h,scale:v,mesh:T,extras:A,children:D}=c,x={};if(x.matrix=u||Fe.mat4.fromRotationTranslationScale([],g||[0,0,0,1],h||[0,0,0],v||[1,1,1]),T!==void 0){x.meshes=s[T];const P=x.anchor=[0,0];for(const L of x.meshes){const{min:I,max:R}=L.aabb;P[0]+=I[0]+R[0],P[1]+=I[1]+R[1]}P[0]=Math.floor(P[0]/x.meshes.length/2),P[1]=Math.floor(P[1]/x.meshes.length/2)}if(A&&(A.id&&(x.id=A.id),A.lights&&(x.lights=function(P){if(!P.length)return[];const L=function(K){const re=atob(K),ie=new Uint8Array(re.length);for(let Q=0;Q<re.length;Q++)ie[Q]=re.codePointAt(Q);return ie}(P),I=[],R=L.length/24,V=new Uint16Array(L.buffer),W=new Float32Array(L.buffer);for(let K=0;K<R;K++){const re=V[2*K*6]/30,ie=V[2*K*6+1]/30,Q=V[2*K*6+10]/100,ue=W[6*K+1],_e=W[6*K+2],Ee=W[6*K+3],Ne=W[6*K+4],ze=Ee-ue,De=Ne-_e,ot=Math.hypot(ze,De);I.push({pos:[ue+.5*ze,_e+.5*De,ie],normal:[De/ot,-ze/ot,0],width:ot,height:re,depth:Q,points:[ue,_e,Ee,Ne]})}return I}(A.lights))),D){const P=[];for(const L of D)P.push(zk(n.json.nodes[L],n,s));x.children=P}return x}function A$(c){if(c.vertices.length===0||c.indices.length===0)return null;const n=new Aw(c.vertices,c.indices,8,256),[s,u]=[n.min.clone(),n.max.clone()];return{vertices:c.vertices,indices:c.indices,grid:n,min:s,max:u}}function k$(c){if(!c.extras||!c.extras.ground)return null;const n=c.extras.ground;if(!n||!Array.isArray(n)||n.length===0)return null;const s=n[0];if(!s||!Array.isArray(s)||s.length===0)return null;const u=[];for(const v of s){if(!Array.isArray(v)||v.length!==2)continue;const T=v[0],A=v[1];typeof T=="number"&&typeof A=="number"&&u.push(new Qe(T,A))}if(u.length<3)return null;u.length>1&&u[u.length-1].equals(u[0])&&u.pop();let g=0;for(let v=0;v<u.length;v++){const T=u[v],A=u[(v+1)%u.length],D=u[(v+2)%u.length];g+=(T.x-A.x)*(D.y-A.y)-(D.x-A.x)*(T.y-A.y)}g>0&&u.reverse();const h=Cv(u.flatMap(v=>[v.x,v.y]),[]);return h.length===0?null:{vertices:u,indices:h}}function P$(c,n){const s=[],u=[];let g=0;const h=[];for(const v of c){g=s.length;const T=v.vertexArray.float32,A=v.indexArray.uint16;for(let D=0;D<v.vertexArray.length;D++)h[0]=T[3*D+0],h[1]=T[3*D+1],h[2]=T[3*D+2],Fe.vec3.transformMat4(h,h,n),s.push(new Qe(h[0],h[1]));for(let D=0;D<3*v.indexArray.length;D++)u.push(A[D]+g)}if(u.length%3!=0)return null;for(let v=0;v<u.length;v+=3){const T=s[u[v+0]],A=s[u[v+1]],D=s[u[v+2]];(T.x-A.x)*(D.y-A.y)-(D.x-A.x)*(T.y-A.y)>0&&([u[v+1],u[v+2]]=[u[v+2],u[v+1]])}return{vertices:s,indices:u}}function Fk(c){const n=function(A,D){const x=[],P=WebGL2RenderingContext;if(A.json.textures)for(const L of A.json.textures){const I={magFilter:P.LINEAR,minFilter:P.NEAREST,wrapS:P.REPEAT,wrapT:P.REPEAT};L.sampler!==void 0&&Object.assign(I,A.json.samplers[L.sampler]),x.push({image:D[L.source],sampler:I,uploaded:!1})}return x}(c,c.images),s=function(A,D){const x=[];for(const P of A.json.meshes){const L=[];for(const I of P.primitives)L.push(I$(I,A,D));x.push(L)}return x}(c,n),{scenes:u,scene:g,nodes:h}=c.json,v=u?u[g||0].nodes:h,T=[];for(const A of v)T.push(zk(h[A],c,s));return function(A,D,x){const P={},L=new Set;for(let I=0;I<A.length;I++){const R=x[D[I]];if(!R.extras)continue;const V=R.extras["mapbox:footprint:version"],W=R.extras["mapbox:footprint:id"];(V||W)&&L.add(I),V==="1.0.0"&&W&&(P[W]=I)}for(let I=0;I<A.length;I++){if(L.has(I))continue;const R=A[I],V=x[D[I]];if(!V.extras)continue;let W=null;R.id in P&&(W=P$(A[P[R.id]].meshes,R.matrix)),W||(W=k$(V)),W&&(R.footprint=A$(W))}if(L.size>0){const I=Array.from(L.values()).sort((R,V)=>R-V);for(let R=I.length-1;R>=0;R--)A.splice(I[R],1)}}(T,v,c.json.nodes),T}function R$(c){c.heightmap=new Float32Array(4096),c.heightmap.fill(-1);const n=c.vertexArray.float32,s=c.aabb.min[0]-1,u=c.aabb.min[1]-1,g=ef/(c.aabb.max[0]-s+2),h=ef/(c.aabb.max[1]-u+2);for(let v=0;v<n.length;v+=3){const T=n[v+2],A=(n[v+0]-s)*g|0,D=(n[v+1]-u)*h|0;T>c.heightmap[D*ef+A]&&(c.heightmap[D*ef+A]=T)}}function O$(c,n){const s={};s.indexArray=new $i,s.indexArray.reserve(4*c.length),s.vertexArray=new al,s.vertexArray.reserve(10*c.length),s.colorArray=new mu,s.vertexArray.reserve(10*c.length);let u=0;for(const v of c){const T=Math.min(10,Math.max(4,1.3*v.height))*n,A=[-v.normal[1],v.normal[0],0],D=Math.min(.29,.1*v.width/v.depth),x=v.width-2*v.depth*n*(D+.01),P=Fe.vec3.scaleAndAdd([],v.pos,A,x/2),L=Fe.vec3.scaleAndAdd([],v.pos,A,-x/2),I=[P[0],P[1],P[2]+v.height],R=[L[0],L[1],L[2]+v.height],V=Fe.vec3.scaleAndAdd([],v.normal,A,D);Fe.vec3.scale(V,V,T);const W=Fe.vec3.scaleAndAdd([],v.normal,A,-D);Fe.vec3.scale(W,W,T),Fe.vec3.add(V,P,V),Fe.vec3.add(W,L,W),P[2]+=.1,L[2]+=.1,s.vertexArray.emplaceBack(V[0],V[1],V[2]),s.vertexArray.emplaceBack(W[0],W[1],W[2]),s.vertexArray.emplaceBack(P[0],P[1],P[2]),s.vertexArray.emplaceBack(L[0],L[1],L[2]),s.vertexArray.emplaceBack(I[0],I[1],I[2]),s.vertexArray.emplaceBack(R[0],R[1],R[2]),s.vertexArray.emplaceBack(P[0],P[1],P[2]),s.vertexArray.emplaceBack(L[0],L[1],L[2]),s.vertexArray.emplaceBack(V[0],V[1],V[2]),s.vertexArray.emplaceBack(W[0],W[1],W[2]);const K=x/T/2;s.colorArray.emplaceBack(-K-D,-1,K,.8),s.colorArray.emplaceBack(K+D,-1,K,.8),s.colorArray.emplaceBack(-K,0,K,1.3),s.colorArray.emplaceBack(K,0,K,1.3),s.colorArray.emplaceBack(K+D,-.8,K,.7),s.colorArray.emplaceBack(K+D,-.8,K,.7),s.colorArray.emplaceBack(0,0,K,1.3),s.colorArray.emplaceBack(0,0,K,1.3),s.colorArray.emplaceBack(K+D,-1.2,K,.8),s.colorArray.emplaceBack(K+D,-1.2,K,.8),s.indexArray.emplaceBack(6+u,4+u,8+u),s.indexArray.emplaceBack(7+u,9+u,5+u),s.indexArray.emplaceBack(0+u,1+u,2+u),s.indexArray.emplaceBack(1+u,3+u,2+u),u+=10}const g={defined:!0,emissiveFactor:[0,0,0]},h={};return h.baseColorFactor=io.white,g.pbrMetallicRoughness=h,s.material=g,s.aabb=new Jn([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),s}class Nk{constructor(n){this._stringToNumber={},this._numberToString=[];for(let s=0;s<n.length;s++){const u=n[s];this._stringToNumber[u]=s,this._numberToString[s]=u}}encode(n){return this._stringToNumber[n]}decode(n){return this._numberToString[n]}}const L$=["id","tile","layer","source","sourceLayer","state"];class Yp{constructor(n,s,u,g,h){this.type="Feature",this._vectorTileFeature=n,this._z=s,this._x=u,this._y=g,this.properties=n.properties,this.id=h}clone(){const n=new Yp(this._vectorTileFeature,this._z,this._x,this._y,this.id);return this.state&&(n.state=Object.assign({},this.state)),this.layer&&(n.layer=Object.assign({},this.layer)),this.source&&(n.source=this.source),this.sourceLayer&&(n.sourceLayer=this.sourceLayer),n}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(n){this._geometry=n}toJSON(){const n={type:"Feature",state:void 0,geometry:this.geometry,properties:this.properties};for(const s of L$)this[s]!==void 0&&(n[s]=this[s]);return n}}class Bk{constructor(n,s){this.tileID=n,this.x=n.canonical.x,this.y=n.canonical.y,this.z=n.canonical.z,this.grid=new hu(In,16,0),this.featureIndexArray=new Hh,this.promoteId=s,this.is3DTile=!1,this.serializedLayersCache=new Map}insert(n,s,u,g,h,v=0,T=0){const A=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(u,g,h,v);const D=this.grid;for(let x=0;x<s.length;x++){const P=s[x],L=[1/0,1/0,-1/0,-1/0];for(let I=0;I<P.length;I++){const R=P[I];L[0]=Math.min(L[0],R.x),L[1]=Math.min(L[1],R.y),L[2]=Math.max(L[2],R.x),L[3]=Math.max(L[3],R.y)}T!==0&&(L[0]-=T,L[1]-=T,L[2]+=T,L[3]+=T),L[0]<In&&L[1]<In&&L[2]>=0&&L[3]>=0&&D.insert(A,L[0],L[1],L[2],L[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new zp.VectorTile(new F0(this.rawTileData)).layers,this.sourceLayerCoder=new Nk(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const n in this.vtLayers)this.vtFeatures[n]=[]}return this.vtLayers}query(n,s){const{tilespaceGeometry:u,transform:g,tileTransform:h,pixelPosMatrix:v,availableImages:T}=s;this.loadVTLayers(),this.serializedLayersCache.clear();const A=u.bufferedTilespaceBounds,D=this.grid.query(A.min.x,A.min.y,A.max.x,A.max.y,(I,R,V,W)=>at(u.bufferedTilespaceGeometry,I,R,V,W));D.sort(D$);let x=null;g.elevation&&D.length>0&&(x=jp.create(g.elevation,this.tileID));const P={};let L;for(let I=0;I<D.length;I++){const R=D[I];if(R===L)continue;L=R;const V=this.featureIndexArray.get(R);let W=null;this.is3DTile?this.loadMatchingModelFeature(P,V,n,u,g):this.loadMatchingFeature(P,V,n,T,(K,re,ie,Q=0)=>(W||(W=G(K,this.tileID.canonical,h)),re.queryIntersectsFeature(u,K,ie,W,this.z,g,v,x,Q)))}return P}loadMatchingFeature(n,s,u,g,h){const{featureIndex:v,bucketIndex:T,sourceLayerIndex:A,layoutVertexArrayOffset:D}=s,x=this.bucketLayerIDs[T],P=u.layers,L=Object.keys(P);if(L.length&&!function(K,re){for(let ie=0;ie<K.length;ie++)if(re.indexOf(K[ie])>=0)return!0;return!1}(L,x))return;const I=u.sourceCache,R=this.sourceLayerCoder.decode(A),V=this.vtLayers[R].feature(v),W=this.getId(V,R);for(let K=0;K<x.length;K++){const re=x[K];if(!P[re])continue;const{styleLayer:ie,targets:Q}=P[re];let ue={};W!==void 0&&(ue=I.getFeatureState(ie.sourceLayer,W));const _e=!h||h(V,ie,ue,D);if(!_e)continue;const Ee=new Yp(V,this.z,this.x,this.y,W);Ee.tile=this.tileID.canonical,Ee.state=ue;let Ne=this.serializedLayersCache.get(re);Ne||(Ne=ie.serialize(),Ne.id=re,this.serializedLayersCache.set(re,Ne)),Ee.source=Ne.source,Ee.sourceLayer=Ne["source-layer"],Ee.layer=tr({},Ne),Ee.layer.paint=Vk(Ne.paint,ie.paint,V,ue,g),Ee.layer.layout=Vk(Ne.layout,ie.layout,V,ue,g);let ze=!1;for(const De of Q){this.updateFeatureProperties(Ee,De);const{filter:ot}=De;if(ot){if(V.properties=Ee.properties,ot.needGeometry){const $e=Z(V,!0);if(!ot.filter(new zo(this.tileID.overscaledZ),$e,this.tileID.canonical))continue}else if(!ot.filter(new zo(this.tileID.overscaledZ),V))continue}ze=!0,De.targetId&&this.addFeatureVariant(Ee,De)}ze&&this.appendToResult(n,re,v,Ee,_e)}}loadMatchingModelFeature(n,s,u,g,h){const v=this.bucketLayerIDs[0][0],T=u.layers;if(!T[v])return;const{styleLayer:A,targets:D}=T[v];if(A.type!=="model")return;const x=g.tile,P=s.featureIndex,L=x.getBucket(A);if(!(L&&L instanceof ib))return;const I=function(Ne,ze,De,ot){const $e=Ne.getNodesInfo()[ze];if($e.hiddenByReplacement||!$e.node.meshes)return;let it=Number.MAX_VALUE;const ft=$e.node,ut=De.tile,mt=ot.calculatePosMatrix(ut.tileID.toUnwrapped(),ot.worldSize),xt=$e.evaluatedScale;let At=0;ot.elevation&&ft.elevation&&(At=ft.elevation*ot.elevation.exaggeration()),Fe.mat4.translate(mt,mt,[(ft.anchor?ft.anchor[0]:0)*(xt[0]-1),(ft.anchor?ft.anchor[1]:0)*(xt[1]-1),At]),Fe.mat4.scale(mt,mt,xt);const _t=De.queryGeometry,Zt=_t.isPointQuery()?_t.screenBounds:_t.screenGeometry,hn=function(kn){const Mn=Fe.mat4.multiply([],mt,kn.matrix);Fe.mat4.multiply(Mn,ot.expandedFarZProjMatrix,Mn);for(let _n=0;_n<kn.meshes.length;++_n){const mn=kn.meshes[_n];if(_n===kn.lightMeshIndex)continue;const Zn=NA(Zt,ot,Mn,mn.aabb);Zn!=null&&(it=Math.min(Zn,it))}if(kn.children)for(const _n of kn.children)hn(_n)};if(hn(ft),it===Number.MAX_VALUE)return;const Kt=new Qr(0,0);return YA(ut.tileID.canonical,Kt,$e.node.anchor[0],$e.node.anchor[1]),{intersectionZ:it,position:Kt,feature:$e.feature}}(L,P,g,h);if(!I)return;const{z:R,x:V,y:W}=x.tileID.canonical,{feature:K,intersectionZ:re,position:ie}=I;let Q={};K.id!==void 0&&(Q=u.sourceCache.getFeatureState(A.sourceLayer,K.id));const ue=new Yp({},R,V,W,K.id);ue.tile=this.tileID.canonical,ue.state=Q,ue.properties=K.properties,ue.geometry={type:"Point",coordinates:[ie.lng,ie.lat]};let _e=this.serializedLayersCache.get(v);_e||(_e=A.serialize(),_e.id=v,this.serializedLayersCache.set(v,_e)),ue.source=_e.source,ue.sourceLayer=_e["source-layer"],ue.layer=tr({},_e);let Ee=!1;for(const Ne of D){this.updateFeatureProperties(ue,Ne);const{filter:ze}=Ne;if(ze){if(K.properties=ue.properties,ze.needGeometry){if(!ze.filter(new zo(this.tileID.overscaledZ),K,this.tileID.canonical))continue}else if(!ze.filter(new zo(this.tileID.overscaledZ),K))continue}Ee=!0,Ne.targetId&&this.addFeatureVariant(ue,Ne)}Ee&&this.appendToResult(n,v,P,ue,re)}updateFeatureProperties(n,s,u){if(s.properties){const g={};for(const h in s.properties){const v=s.properties[h].evaluate({zoom:this.z},n._vectorTileFeature,n.state,n.tile,u);v!=null&&(g[h]=v)}n.properties=g}}addFeatureVariant(n,s,u){const g={target:s.target,namespace:s.namespace,uniqueFeatureID:s.uniqueFeatureID};s.properties&&(g.properties=n.properties),n.variants=n.variants||{},n.variants[s.targetId]=n.variants[s.targetId]||[],n.variants[s.targetId].push(g)}appendToResult(n,s,u,g,h){let v=n[s];v===void 0&&(v=n[s]=[]),v.push({featureIndex:u,feature:g,intersectionZ:h})}lookupSymbolFeatures(n,s,u,g,h){const v={};this.loadVTLayers();for(const T of n)this.loadMatchingFeature(v,{bucketIndex:s,sourceLayerIndex:u,featureIndex:T,layoutVertexArrayOffset:0},g,h);return v}loadFeature(n){const{featureIndex:s,sourceLayerIndex:u}=n;this.loadVTLayers();const g=this.sourceLayerCoder.decode(u),h=this.vtFeatures[g];if(h[s])return h[s];const v=this.vtLayers[g].feature(s);return h[s]=v,v}hasLayer(n){for(const s of this.bucketLayerIDs)for(const u of s)if(n===u)return!0;return!1}getId(n,s){let u=n.id;if(this.promoteId){const g=Array.isArray(this.promoteId)||typeof this.promoteId!="object"?this.promoteId:this.promoteId[s];if(g!=null)if(Array.isArray(g)){if(!this.promoteIdExpression){const h=id(g);if(h.result!=="success"){const v=h.value.map(T=>`${T.key}: ${T.message}`).join(", ");return void wn(`Failed to create expression for promoteId: ${v}`)}this.promoteIdExpression=h.value}this.promoteIdExpression._evaluator||(this.promoteIdExpression._evaluator=new mg),u=this.promoteIdExpression.evaluate({zoom:0},n)}else u=n.properties[g];typeof u=="boolean"&&(u=Number(u))}return u}}function Vk(c,n,s,u,g){return ct(c,(h,v)=>{const T=n instanceof cd?n.get(v):null;return T&&T.evaluate?T.evaluate(s,u,g):T})}function D$(c,n){return n-c}Hn(Bk,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});const $k=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class I2{static from(n){if(!(n instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[s,u]=new Uint8Array(n,0,2);if(s!==219)throw new Error("Data does not appear to be in a KDBush format.");const g=u>>4;if(g!==1)throw new Error(`Got v${g} data when expected v1.`);const h=$k[15&u];if(!h)throw new Error("Unrecognized array type.");const[v]=new Uint16Array(n,2,1),[T]=new Uint32Array(n,4,1);return new I2(T,v,h,n)}constructor(n,s=64,u=Float64Array,g){if(isNaN(n)||n<0)throw new Error(`Unpexpected numItems value: ${n}.`);this.numItems=+n,this.nodeSize=Math.min(Math.max(+s,2),65535),this.ArrayType=u,this.IndexArrayType=n<65536?Uint16Array:Uint32Array;const h=$k.indexOf(this.ArrayType),v=2*n*this.ArrayType.BYTES_PER_ELEMENT,T=n*this.IndexArrayType.BYTES_PER_ELEMENT,A=(8-T%8)%8;if(h<0)throw new Error(`Unexpected typed array class: ${u}.`);g&&g instanceof ArrayBuffer?(this.data=g,this.ids=new this.IndexArrayType(this.data,8,n),this.coords=new this.ArrayType(this.data,8+T+A,2*n),this._pos=2*n,this._finished=!0):(this.data=new ArrayBuffer(8+v+T+A),this.ids=new this.IndexArrayType(this.data,8,n),this.coords=new this.ArrayType(this.data,8+T+A,2*n),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+h]),new Uint16Array(this.data,2,1)[0]=s,new Uint32Array(this.data,4,1)[0]=n)}add(n,s){const u=this._pos>>1;return this.ids[u]=u,this.coords[this._pos++]=n,this.coords[this._pos++]=s,u}finish(){const n=this._pos>>1;if(n!==this.numItems)throw new Error(`Added ${n} items when expected ${this.numItems}.`);return A2(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(n,s,u,g){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:h,coords:v,nodeSize:T}=this,A=[0,h.length-1,0],D=[];for(;A.length;){const x=A.pop()||0,P=A.pop()||0,L=A.pop()||0;if(P-L<=T){for(let W=L;W<=P;W++){const K=v[2*W],re=v[2*W+1];K>=n&&K<=u&&re>=s&&re<=g&&D.push(h[W])}continue}const I=L+P>>1,R=v[2*I],V=v[2*I+1];R>=n&&R<=u&&V>=s&&V<=g&&D.push(h[I]),(x===0?n<=R:s<=V)&&(A.push(L),A.push(I-1),A.push(1-x)),(x===0?u>=R:g>=V)&&(A.push(I+1),A.push(P),A.push(1-x))}return D}within(n,s,u){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:g,coords:h,nodeSize:v}=this,T=[0,g.length-1,0],A=[],D=u*u;for(;T.length;){const x=T.pop()||0,P=T.pop()||0,L=T.pop()||0;if(P-L<=v){for(let W=L;W<=P;W++)jk(h[2*W],h[2*W+1],n,s)<=D&&A.push(g[W]);continue}const I=L+P>>1,R=h[2*I],V=h[2*I+1];jk(R,V,n,s)<=D&&A.push(g[I]),(x===0?n-u<=R:s-u<=V)&&(T.push(L),T.push(I-1),T.push(1-x)),(x===0?n+u>=R:s+u>=V)&&(T.push(I+1),T.push(P),T.push(1-x))}return A}}function A2(c,n,s,u,g,h){if(g-u<=s)return;const v=u+g>>1;Uk(c,n,v,u,g,h),A2(c,n,s,u,v-1,1-h),A2(c,n,s,v+1,g,1-h)}function Uk(c,n,s,u,g,h){for(;g>u;){if(g-u>600){const D=g-u+1,x=s-u+1,P=Math.log(D),L=.5*Math.exp(2*P/3),I=.5*Math.sqrt(P*L*(D-L)/D)*(x-D/2<0?-1:1);Uk(c,n,s,Math.max(u,Math.floor(s-x*L/D+I)),Math.min(g,Math.floor(s+(D-x)*L/D+I)),h)}const v=n[2*s+h];let T=u,A=g;for(t_(c,n,u,s),n[2*g+h]>v&&t_(c,n,u,g);T<A;){for(t_(c,n,T,A),T++,A--;n[2*T+h]<v;)T++;for(;n[2*A+h]>v;)A--}n[2*u+h]===v?t_(c,n,u,A):(A++,t_(c,n,A,g)),A<=s&&(u=A+1),s<=A&&(g=A-1)}}function t_(c,n,s,u){k2(c,s,u),k2(n,2*s,2*u),k2(n,2*s+1,2*u+1)}function k2(c,n,s){const u=c[n];c[n]=c[s],c[s]=u}function jk(c,n,s,u){const g=c-s,h=n-u;return g*g+h*h}r.$=nv,r.A=Gi,r.B=2,r.C=Fv,r.D=Hp,r.E=yc,r.F=tA,r.G=class extends rb{},r.H=za,r.I=y2,r.J=Wf,r.K=i0,r.L=Ih,r.M=Mh,r.N=dp,r.O=od,r.P=Qe,r.Q=bp,r.R=Jr,r.S=n0,r.T=i2,r.U=id,r.V=rb,r.W=xh,r.X=cu,r.Y=Xu,r.Z=bs,r._=_a,r.a=function(c){return Jo.API_CDN_URL_REGEX.test(c)},r.a$=Yp,r.a0=jg,r.a1=Qy,r.a2=function(c){const n=c.value;let s=[];if(!n)return s;const u=za(n);return u!=="string"?(s=s.concat([new rb(c.key,n,`string expected, "${u}" found`)]),s):(VA(n,!0)||(s=s.concat([new rb(c.key,n,`invalid url "${n}"`)])),s)},r.a3=Lt,r.a4=yp,r.a5=Wo,r.a6=xn,r.a7=class{constructor(c){this.specification=c}possiblyEvaluate(c,n){return jo(c.expression.evaluate(n))}interpolate(c,n,s){return{x:cr(c.x,n.x,s),y:cr(c.y,n.y,s),z:cr(c.z,n.z,s),azimuthal:cr(c.azimuthal,n.azimuthal,s),polar:cr(c.polar,n.polar,s)}}},r.a8=zo,r.a9=Ah,r.aA=Na,r.aB=class{constructor(c){this.entries={},this.scheduler=c}request(c,n,s,u){const g=this.entries[c]=this.entries[c]||{callbacks:[]};if(g.result){const[h,v]=g.result;return this.scheduler?this.scheduler.add(()=>{u(h,v)},n):u(h,v),()=>{}}return g.callbacks.push(u),g.cancel||(g.cancel=s((h,v)=>{g.result=[h,v];for(const T of g.callbacks)this.scheduler?this.scheduler.add(()=>{T(h,v)},n):T(h,v);setTimeout(()=>delete this.entries[c],3e3)})),()=>{g.result||(g.callbacks=g.callbacks.filter(h=>h!==u),g.callbacks.length||(g.cancel(),delete this.entries[c]))}}},r.aC=sl,r.aD=function(c,n,s){const u=JSON.stringify(c.request);return c.data&&(this.deduped.entries[u]={result:[null,c.data]}),this.deduped.request(u,{type:"parseTile",isSymbolTile:c.isSymbolTile,zoom:c.tileZoom},g=>{const h=ki(c.request,(v,T,A,D)=>{v?g(v):T&&g(null,{vectorTile:s?void 0:new zp.VectorTile(new F0(T)),rawData:T,cacheControl:A,expires:D})});return()=>{h.cancel(),g()}},n)},r.aE=function(c){Wn++,Wn>Dt&&(c.getActor().send("enforceCacheSizeLimit",ht),Wn=0)},r.aF=function(c){return c<=1?1:Math.pow(2,Math.floor(Math.log(c)/Math.LN2))},r.aG=vn,r.aH=MA,r.aI=OA,r.aJ=EA,r.aK=function(c,n){const s=document.createElement("video");s.muted=!0,s.onloadstart=function(){n(null,s)};for(let u=0;u<c.length;u++){const g=document.createElement("source");us(c[u])||(s.crossOrigin="Anonymous"),g.src=c[u],s.appendChild(g)}return{cancel:()=>{}}},r.aL=J0,r.aM=function(c){return fetch(c).then(n=>n.arrayBuffer()).then(n=>Dk(n,0,c))},r.aN=Fk,r.aO=class{constructor(c,n,s,u){this.id=c,this.position=n!=null?new Qr(n[0],n[1]):new Qr(0,0),this.orientation=s??[0,0,0],this.nodes=u,this.uploaded=!1,this.aabb=new Jn([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),this.matrix=[]}_applyTransformations(c,n){if(Fe.mat4.multiply(c.matrix,n,c.matrix),c.meshes)for(const s of c.meshes){const u=Jn.applyTransformFast(s.aabb,c.matrix);this.aabb.encapsulate(u)}if(c.children)for(const s of c.children)this._applyTransformations(s,c.matrix)}computeBoundsAndApplyParent(){const c=Fe.mat4.identity([]);for(const n of this.nodes)this._applyTransformations(n,c)}computeModelMatrix(c,n,s,u,g,h,v=!1){GA(this.matrix,this,c.transform,this.position,n,s,u,g,h,v)}upload(c){if(!this.uploaded){for(const n of this.nodes)u2(n,c);for(const n of this.nodes)ob(n);this.uploaded=!0}}destroy(){for(const c of this.nodes)d2(c)}},r.aP=jn,r.aQ=Bv,r.aR=Ds,r.aS=Ui,r.aT=Vl,r.aU=$i,r.aV=Cr,r.aW=gv,r.aX=Y0,r.aY=function(){qs.isLoading()||qs.isLoaded()||vp()!=="deferred"||Oh()},r.aZ=s0,r.a_=Z,r.aa=l,r.ab=Fe,r.ac=Sn,r.ad=cd,r.ae=Ss,r.af=cr,r.ag=In,r.ah=Fy,r.ai=Ot,r.aj=io,r.ak=class{constructor(c){this.specification=c}possiblyEvaluate(c,n){return function([s,u]){const g=jo([1,s,u]);return{x:g.x,y:g.y,z:g.z}}(c.expression.evaluate(n))}interpolate(c,n,s){return{x:cr(c.x,n.x,s),y:cr(c.y,n.y,s),z:cr(c.z,n.z,s)}}},r.al=function(c,n,s=0,u=!0){const g=new Qe(s,s),h=c.sub(g),v=n.add(g),T=[h,new Qe(v.x,h.y),v,new Qe(h.x,v.y)];return u&&T.push(h.clone()),T},r.am=function(c,n){const s=[];for(let u=0;u<c.length;u++){const g=Yn(u-1,-1,c.length-1),h=Yn(u+1,-1,c.length-1),v=c[u],T=c[h],A=c[g].sub(v).unit(),D=T.sub(v).unit(),x=D.angleWithSep(A.x,A.y),P=A.add(D).unit().mult(-1*n/Math.sin(x/2));s.push(v.add(P))}return s},r.an=hA,r.ao=at,r.ap=function(c,n,s=0){return Fe.vec3.fromValues(((n.x-s)*c.scale-c.x)*In,(n.y*c.scale-c.y)*In,C0(n.z,n.y))},r.aq=br,r.ar=PI,r.as=function(c){let n=1/0,s=1/0,u=-1/0,g=-1/0;for(const h of c)n=Math.min(n,h.x),s=Math.min(s,h.y),u=Math.max(u,h.x),g=Math.max(g,h.y);return{min:new Qe(n,s),max:new Qe(u,g)}},r.at=ul,r.au=Ye,r.av=y,r.aw=It,r.ax=hs,r.ay=function(c,n){const s={};for(let u=0;u<n.length;u++){const g=n[u];g in c&&(s[g]=c[g])}return s},r.az=Pc,r.b=function(c){return Jo.API_FONTS_REGEX.test(c)},r.b$=tb,r.b0=bo,r.b1=Nw,r.b2=Iw,r.b3=G,r.b4=Bl,r.b5=pv,r.b6=ir,r.b7=ei,r.b8=Cv,r.b9=n2,r.bA=cI,r.bB=Yw,r.bC=lA,r.bD=qw,r.bE=I2,r.bF=Yn,r.bG=mo,r.bH=fs,r.bI=function(c,n,s){c[4*n+0]=s[0],c[4*n+1]=s[1],c[4*n+2]=s[2],c[4*n+3]=s[3]},r.bJ=Yh,r.bK=xa,r.bL=pd,r.bM=ii,r.bN=Kh,r.bO=Qr,r.bP=vA,r.bQ=nn,r.bR=Xr,r.bS=DA,r.bT=dn,r.bU=Qi,r.bV=function(c,n,s,u,g,h,v,T,A){if(A.name==="globe")return Qi(c,n,new dn(s,u,g),!1);const D=Bv({z:s,x:u,y:g},A);return new Jn([(h+D.x/D.scale)*n,n*(D.y/D.scale),v],[(h+D.x2/D.scale)*n,n*(D.y2/D.scale),T])},r.bW=function(c,n,s){let u=0;for(let g=0;g<2;++g)c[g]>0&&(u+=(c[g]-0)*(c[g]-0)),n[g]<0&&(u+=(0-n[g])*(0-n[g]));return u},r.bX=ws,r.bY=S0,r.bZ=function(c){const n=Fe.mat4.identity(new Float64Array(16));Fe.mat4.multiply(n,c.pixelMatrix,c.globeMatrix);const s=[0,Ks,0],u=[0,Zs,0];return Fe.vec3.transformMat4(s,s,n),Fe.vec3.transformMat4(u,u,n),[s[0]>0&&s[0]<=c.width&&s[1]>0&&s[1]<=c.height&&!Sa(c,new Qr(c.center.lat,90)),u[0]>0&&u[0]<=c.width&&u[1]>0&&u[1]<=c.height&&!Sa(c,new Qr(c.center.lat,-90))]},r.b_=function(c,n){const{scale:s}=c.tileTransform,u=s*In/(c.tileSize*Math.pow(2,n.zoom-c.tileID.overscaledZ+c.tileID.canonical.z));return Fe.mat2.scale(new Float32Array(4),n.inverseAdjustmentMatrix,[u,u])},r.ba=function(c,n){const s=Ss(n.zoom);if(s===0)return bi(c);const u=Ko(c),g=Ao(u),h=ul(u.getWest())*n.worldSize,v=ul(u.getEast())*n.worldSize,T=Na(u.getNorth())*n.worldSize,A=Na(u.getSouth())*n.worldSize,D=[h,T,0],x=[v,T,0],P=[h,A,0],L=[v,A,0],I=Fe.mat4.invert([],n.globeMatrix);return Fe.vec3.transformMat4(D,D,I),Fe.vec3.transformMat4(x,x,I),Fe.vec3.transformMat4(P,P,I),Fe.vec3.transformMat4(L,L,I),g[0]=xi(g[0],P,s),g[1]=xi(g[1],L,s),g[2]=xi(g[2],x,s),g[3]=xi(g[3],D,s),Jn.fromPoints(g)},r.bb=Ri,r.bc=xo,r.bd=xi,r.be=hd,r.bf=nr,r.bg=S2,r.bh=F0,r.bi=ki,r.bj=function(c){const n=[];for(const s in c)n.push(c[s]);return n},r.bk=function(c,n){const s=[];for(const u in c)u in n||s.push(u);return s},r.bl=vr,r.bm=["type","source","source-layer","minzoom","maxzoom","filter","layout"],r.bn=Yt,r.bo=function(c,n){const{x:s,y:u}=c.point,g=zs(s,u,c.worldSize/c._pixelsPerMercatorPixel,0,0);return Fe.mat4.multiply(g,g,Co(bi(n)))},r.bp=Fp,r.bq=Ba,r.br=z0,r.bs=function(c,n,s,u,g){const h=5*n+2;c.float32[h+0]=s,c.float32[h+1]=u,c.float32[h+2]=g},r.bt=Z0,r.bu=eA,r.bv=ve,r.bw=ts,r.bx=rI,r.by=BA,r.bz=lI,r.c=vc,r.c$=(c,n,s,u,g,h,v,T)=>{const A=c.transform,D=A.pitch<15?RI(.07,.7,It((14-A.zoom)/5,0,1)):.07,x=s.paint.get("line-trim-color-use-theme").constantOr("default")==="none";return{u_matrix:LI(c,n,s,u),u_texsize:n.imageAtlasTexture?n.imageAtlasTexture.size:[0,0],u_pixels_to_tile_units:A.calculatePixelsToTileUnitsMatrix(n),u_device_pixel_ratio:g,u_width_scale:h,u_floor_width_scale:v,u_image:0,u_tile_units_to_pixels:OI(n,A),u_units_to_pixels:[1/A.pixelsToGLUnits[0],1/A.pixelsToGLUnits[1]],u_alpha_discard_threshold:0,u_trim_offset:T,u_trim_fade_range:s.paint.get("line-trim-fade-range"),u_trim_color:s.paint.get("line-trim-color").toRenderColor(x?null:s.lut).toArray01(),u_emissive_strength:s.paint.get("line-emissive-strength"),u_zbias_factor:D,u_tile_to_meter:o(n.tileID.canonical,0)}},r.c0=LA,r.c1=function(c){const n=LA(c,!0);return Fe.mat2.invert([],[n[0],n[1],n[4],n[5]])},r.c2=jr,r.c3=function(c){const{x:n,y:s}=c.point,{lng:u,lat:g}=c._center;return zs(n,s,c.worldSize,u,g)},r.c4=Ft,r.c5=Tn,r.c6=md,r.c7=function(c){const n=Math.round((c+45+360)%360/90)%4;return sn[n]},r.c8=45,r.c9=Op,r.cA=class extends cl{constructor(c){super(c),this.current=_v}set(c,n,s){if(this.fetchUniformLocation(c,n)){for(let u=0;u<9;u++)if(s[u]!==this.current[u]){this.current=s,this.gl.uniformMatrix3fv(this.location,!1,s);break}}}},r.cB=an,r.cC=function(c,n,s){const u=Ss(s.zoom),g=c.style.map._antialias,h=c.terrain&&c.terrain.exaggeration()>0;return u===0&&!g&&!h},r.cD=function(c){const n=c.pixelsPerMeter,s=n/fs(1,c.center.lat),u=Fe.mat4.identity(new Float64Array(16));return Fe.mat4.translate(u,u,[c.point.x,c.point.y,0]),Fe.mat4.scale(u,u,[s,s,n]),Float32Array.from(u)},r.cE=Ko,r.cF=function(c){const n=ws-5;c=It(c,-80.051129,n)/n*90;const s=Math.pow(Math.abs(Math.sin(Ot(c))),3);return Math.round(s*(Rp.length-1))},r.cG=function(c,n,s,u){const g=n.getNorth(),h=n.getSouth(),v=n.getWest(),T=n.getEast(),A=1<<c.z,D=T-v,x=g-h,P=D/gd,L=-x/Rp[s],I=[0,P,0,L,0,0,g,v,0];if(c.z>0){const R=180/u;Fe.mat3.multiply(I,I,[R/D+1,0,0,0,R/x+1,0,-.5*R/P,.5*R/L,1])}return I[2]=A,I[5]=c.x,I[8]=c.y,I},r.cH=bi,r.cI=function(c,n,s){const u=Fe.mat4.identity(new Float64Array(16)),g=(n/(1<<c)-.5)*Math.PI*2;return Fe.mat4.rotateY(u,s.globeMatrix,g),Float32Array.from(u)},r.cJ=class{isDataAvailableAtPoint(c){const n=this._source();if(this.isUsingMockSource()||!n||c.y<0||c.y>1)return!1;const s=n.getSource().maxzoom,u=1<<s,g=Math.floor(c.x),h=Math.floor((c.x-g)*u),v=Math.floor(c.y*u),T=this.findDEMTileFor(new vn(s,g,s,h,v));return!(!T||!T.dem)}getAtPointOrZero(c,n=0){return this.getAtPoint(c,n)||0}getAtPoint(c,n,s=!0){if(this.isUsingMockSource())return null;n==null&&(n=null);const u=this._source();if(!u||c.y<0||c.y>1)return n;const g=u.getSource().maxzoom,h=1<<g,v=Math.floor(c.x),T=c.x-v,A=new vn(g,v,g,Math.floor(T*h),Math.floor(c.y*h)),D=this.findDEMTileFor(A);if(!D||!D.dem)return n;const x=D.dem,P=1<<D.tileID.canonical.z,L=(T*P-D.tileID.canonical.x)*x.dim,I=(c.y*P-D.tileID.canonical.y)*x.dim,R=Math.floor(L),V=Math.floor(I);return(s?this.exaggeration():1)*cr(cr(x.get(R,V),x.get(R,V+1),I-V),cr(x.get(R+1,V),x.get(R+1,V+1),I-V),L-R)}getAtTileOffset(c,n,s){const u=1<<c.canonical.z;return this.getAtPointOrZero(new l(c.wrap+(c.canonical.x+n/In)/u,(c.canonical.y+s/In)/u))}getAtTileOffsetFunc(c,n,s,u){return g=>{const h=this.getAtTileOffset(c,g.x,g.y),v=u.upVector(c.canonical,g.x,g.y),T=u.upVectorScale(c.canonical,n,s).metersToTile;return Fe.vec3.scale(v,v,h*T),v}}getForTilePoints(c,n,s,u){if(this.isUsingMockSource())return!1;const g=jp.create(this,c,u);return!!g&&(n.forEach(h=>{h[2]=this.exaggeration()*g.getElevationAt(h[0],h[1],s)}),!0)}getMinMaxForTile(c){if(this.isUsingMockSource())return null;const n=this.findDEMTileFor(c);if(!n||!n.dem)return null;const s=n.dem.tree,u=n.tileID,g=1<<c.canonical.z-u.canonical.z;let h=c.canonical.x/g-u.canonical.x,v=c.canonical.y/g-u.canonical.y,T=0;for(let A=0;A<c.canonical.z-u.canonical.z&&!s.leaves[T];A++){h*=2,v*=2;const D=2*Math.floor(v)+Math.floor(h);T=s.childOffsets[T]+D,h%=1,v%=1}return{min:this.exaggeration()*s.minimums[T],max:this.exaggeration()*s.maximums[T]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(c,n,s){throw new Error("Pure virtual method called.")}pointCoordinate(c){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(c){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}getMinMaxForVisibleTiles(){const c=this.visibleDemTiles;if(c.length===0)return null;let n=!1,s=Number.MAX_VALUE,u=Number.MIN_VALUE;for(const g of c){const h=this.getMinMaxForTile(g.tileID);h&&(s=Math.min(s,h.min),u=Math.max(u,h.max),n=!0)}return n?{min:s,max:u}:null}},r.cK=zM,r.cL=Ur,r.cM=function(c,n){return[Math.pow(c[0],2.2)*n,Math.pow(c[1],2.2)*n,Math.pow(c[2],2.2)*n]},r.cN=wa,r.cO=ga,r.cP=kl,r.cQ=256,r.cR=function(c,n){const s=[0,0,0],u=Ri(bi(n.canonical));return Fe.vec3.transformMat4(s,s,u),Fe.vec3.transformMat4(s,s,c),s},r.cS=c=>({u_camera_to_center_distance:new ii(c),u_extrude_scale:new yv(c),u_device_pixel_ratio:new ii(c),u_matrix:new Yh(c),u_inv_rot_matrix:new Yh(c),u_merc_center:new xa(c),u_tile_id:new pd(c),u_zoom_transition:new ii(c),u_up_dir:new pd(c),u_emissive_strength:new ii(c)}),r.cT=c=>({u_matrix:new Yh(c),u_pixels_to_tile_units:new yv(c),u_device_pixel_ratio:new ii(c),u_width_scale:new ii(c),u_floor_width_scale:new ii(c),u_units_to_pixels:new xa(c),u_dash_image:new Kh(c),u_gradient_image:new Kh(c),u_image_height:new ii(c),u_texsize:new xa(c),u_tile_units_to_pixels:new ii(c),u_alpha_discard_threshold:new ii(c),u_trim_offset:new xa(c),u_trim_fade_range:new xa(c),u_trim_color:new Zh(c),u_emissive_strength:new ii(c),u_zbias_factor:new ii(c),u_tile_to_meter:new ii(c)}),r.cU=c=>({u_matrix:new Yh(c),u_texsize:new xa(c),u_pixels_to_tile_units:new yv(c),u_device_pixel_ratio:new ii(c),u_width_scale:new ii(c),u_floor_width_scale:new ii(c),u_image:new Kh(c),u_units_to_pixels:new xa(c),u_tile_units_to_pixels:new ii(c),u_alpha_discard_threshold:new ii(c),u_trim_offset:new xa(c),u_trim_fade_range:new xa(c),u_trim_color:new Zh(c),u_emissive_strength:new ii(c),u_zbias_factor:new ii(c),u_tile_to_meter:new ii(c)}),r.cV=cv,r.cW=N5,r.cX=B5,r.cY=yd,r.cZ=(c,n,s,u,g,h)=>{const v=c.transform,T=v.projection.name==="globe";let A;if(h.paint.get("circle-pitch-alignment")==="map")if(T){const x=wa(v.zoom,n.canonical)*v._pixelsPerMercatorPixel;A=Float32Array.from([x,0,0,x])}else A=v.calculatePixelsToTileUnitsMatrix(s);else A=new Float32Array([v.pixelsToGLUnits[0],0,0,v.pixelsToGLUnits[1]]);const D={u_camera_to_center_distance:c.transform.getCameraToCenterDistance(v.projection),u_matrix:c.translatePosMatrix(n.projMatrix,s,h.paint.get("circle-translate"),h.paint.get("circle-translate-anchor")),u_device_pixel_ratio:je.devicePixelRatio,u_extrude_scale:A,u_inv_rot_matrix:wu,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0],u_emissive_strength:h.paint.get("circle-emissive-strength")};if(T){D.u_inv_rot_matrix=u,D.u_merc_center=g,D.u_tile_id=[n.canonical.x,n.canonical.y,1<<n.canonical.z],D.u_zoom_transition=Ss(v.zoom);const x=g[0]*In,P=g[1]*In;D.u_up_dir=v.projection.upVector(new dn(0,0,0),x,P)}return D},r.c_=DI,r.ca=Zh,r.cb=function(c,n,s){const u=Math.sqrt(c*c+n*n+s*s),g=u>0?Math.acos(s/u)*$t:0;let h=c!==0||n!==0?Math.atan2(-n,-c)*$t+90:0;return h<0&&(h+=360),[u,h,g]},r.cc=o,r.cd=Jn,r.ce=jo,r.cf=function(c){return[Math.pow(c[0],1/2.2),Math.pow(c[1],1/2.2),Math.pow(c[2],1/2.2)]},r.cg=function(c,n){return c.readFields(PV,{icons:[]},n)},r.ch=function(c){return c({pluginStatus:Os,pluginURL:Cc}),sd.on("pluginStateChange",c),c},r.ci=sb,r.cj=Bp,r.ck=Kw,r.cl=el,r.cm=Qg,r.cn=lt,r.co=La,r.cp=tt,r.cq=function(c){const n=c.indexOf(wp);return n>=0?c.slice(0,n):c},r.cr=function(c){return c.indexOf(wp)>=0},r.cs=function(c){const n=c.indexOf(wp);return n>=0?c.slice(n+1):""},r.ct=function(c){const n=[],s=c.id;return s===void 0&&n.push({message:`layers.${s}: missing required property "id"`}),c.render===void 0&&n.push({message:`layers.${s}: missing required method "render"`}),c.renderingMode&&c.renderingMode!=="2d"&&c.renderingMode!=="3d"&&n.push({message:`layers.${s}: property "renderingMode" must be either "2d" or "3d"`}),n},r.cu=function(c,n,s,u){return c.type==="custom"?new vV(c,n):new IV[c.type](c,n,s,u)},r.cv=Ut,r.cw=class extends Yp{constructor(c,n){super(c._vectorTileFeature,c._z,c._x,c._y,c.id),c.state&&(this.state=Object.assign({},c.state)),this.target=n.target,this.namespace=n.namespace,n.properties&&(this.properties=n.properties),this.target&&("featuresetId"in this.target&&!this.target.importId||"layerId"in this.target)&&(this.source=c.source,this.sourceLayer=c.sourceLayer,this.layer=c.layer)}toJSON(){const c=super.toJSON();return c.target=this.target,c.namespace=this.namespace,c}},r.cx=sd,r.cy=Ei,r.cz=b0,r.d=function(c){return Jo.API_TILEJSON_REGEX.test(c)},r.d$=Bk,r.d0=(c,n,s,u,g,h,v,T,A)=>{const D=c.transform,x=D.calculatePixelsToTileUnitsMatrix(n),P=s.paint.get("line-trim-color-use-theme").constantOr("default")==="none",L=D.pitch<15?RI(.07,.7,It((14-D.zoom)/5,0,1)):.07;return{u_matrix:LI(c,n,s,u),u_pixels_to_tile_units:x,u_device_pixel_ratio:h,u_width_scale:v,u_floor_width_scale:T,u_units_to_pixels:[1/D.pixelsToGLUnits[0],1/D.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:g,u_texsize:zI(s)&&n.lineAtlasTexture?n.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:OI(n,c.transform),u_alpha_discard_threshold:0,u_trim_offset:A,u_trim_fade_range:s.paint.get("line-trim-fade-range"),u_trim_color:s.paint.get("line-trim-color").toRenderColor(P?null:s.lut).toArray01(),u_emissive_strength:s.paint.get("line-emissive-strength"),u_zbias_factor:L,u_tile_to_meter:o(n.tileID.canonical,0)}},r.d1=Io,r.d2=Tv,r.d3=wI,r.d4=Ln,r.d5=D0,r.d6=xd,r.d7=450,r.d8=7,r.d9=gV,r.dA=bn,r.dB=f,r.dC=yu,r.dD=function([c,n,s]){const u=Math.hypot(c,n,s),g=Math.atan2(c,s),h=.5*Math.PI-Math.acos(-n/u);return new Qr(Ft(g),Ft(h))},r.dE=a2,r.dF=function(c){const n=c.navigator?c.navigator.userAgent:null;return!!function(s){if(oi==null){const u=s.navigator?s.navigator.userAgent:null;oi=!!s.safari||!(!u||!(/\b(iPad|iPhone|iPod)\b/.test(u)||u.match("Safari")&&!u.match("Chrome")))}return oi}(c)&&n&&(n.match("Version/15.4")||n.match("Version/15.5")||n.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/))},r.dG=function(c,n){ht=c,Dt=n},r.dH=Sa,r.dI=dl,r.dJ=function(c){const n=[0,0,0],s=Fe.mat4.identity(new Float64Array(16));return Fe.mat4.multiply(s,c.pixelMatrix,c.globeMatrix),Fe.vec3.transformMat4(n,n,s),new Qe(n[0],n[1])},r.dK=function(c,n,s=!1){if(Os===Rh||Os===gp||Os===Jg)throw new Error("setRTLTextPlugin cannot be called multiple times.");Cc=je.resolveURL(c),Os=Rh,il=n,ev(),s||Oh()},r.dL=vp,r.dM=function(){sb().acquire(f2)},r.dN=function(){const c=qv;c&&(c.isPreloaded()&&c.numActive()===1?(c.release(f2),qv=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},r.dO=nf,r.dP=function(c){const n=Qt();if(!n)return;const s=n.delete(St);c&&s.catch(c).then(()=>c())},r.dQ=Wv,r.dR=Ik,r.dS=function(c){T2=je.resolveURL(c),Zp||(Zp=new Hp(sb(),new yc)),Zp.broadcast("setDracoUrl",T2)},r.dT=Ak,r.dU=function(c){Kp=je.resolveURL(c),Zp||(Zp=new Hp(sb(),new yc)),Zp.broadcast("setMeshoptUrl",Kp)},r.dV=Hn,r.dW=bd,r.dX=jl,r.dY=zp,r.dZ=class{constructor(c,n){this.pos=c,this.dir=n}intersectsPlane(c,n,s){const u=Fe.vec2.dot(n,this.dir);if(Math.abs(u)<1e-6)return!1;const g=((c[0]-this.pos[0])*n[0]+(c[1]-this.pos[1])*n[1])/u;return s[0]=this.pos[0]+this.dir[0]*g,s[1]=this.pos[1]+this.dir[1]*g,!0}},r.d_=Nk,r.da=so,r.db=mv,r.dc=256,r.dd=Co,r.de=al,r.df=Ic,r.dg=Ep,r.dh=function(c,n,s,u,g){return It((c-n)/(s-n)*(g-u)+u,u,g)},r.di=cp,r.dj=_d,r.dk=class{constructor(c,n,s,u){this.context=c,this.format=u,this.size=s,this.texture=c.gl.createTexture();const[g,h,v]=this.size,{gl:T}=c;T.bindTexture(T.TEXTURE_3D,this.texture),c.pixelStoreUnpackFlipY.set(!1),c.pixelStoreUnpack.set(1),c.pixelStoreUnpackPremultiplyAlpha.set(!1),T.texImage3D(T.TEXTURE_3D,0,this.format,g,h,v,0,r2(this.format),o2(this.format),n.data)}bind(c,n){const{context:s}=this,{gl:u}=s;u.bindTexture(u.TEXTURE_3D,this.texture),c!==this.minFilter&&(u.texParameteri(u.TEXTURE_3D,u.TEXTURE_MAG_FILTER,c),u.texParameteri(u.TEXTURE_3D,u.TEXTURE_MIN_FILTER,c),this.minFilter=c),n!==this.wrapS&&(u.texParameteri(u.TEXTURE_3D,u.TEXTURE_WRAP_S,n),u.texParameteri(u.TEXTURE_3D,u.TEXTURE_WRAP_T,n),this.wrapS=n)}destroy(){const{gl:c}=this.context;c.deleteTexture(this.texture),this.texture=null}},r.dl=l2,r.dm=[1,1,1],r.dn=jp,r.dp=Up,r.dq=Mc,r.dr=fd,r.ds=bu,r.dt=Mp,r.du=ll,r.dv=class{constructor(){this._updateTime=0,this._sourceIds=[],this._activeRegions=[],this._prevRegions=[],this._globalClipBounds={min:new Qe(1/0,1/0),max:new Qe(-1/0,-1/0)}}clear(){this._activeRegions.length>0&&++this._updateTime,this._activeRegions=[],this._prevRegions=[]}get updateTime(){return this._updateTime}getReplacementRegionsForTile(c,n=!1){const s=iI(new Qe(0,0),new Qe(In,In),c),u=[];if(n&&!Ow(s,this._globalClipBounds))return u;for(const g of this._activeRegions){if(g.hiddenByOverlap||!Ow(s,g))continue;const h=d5(g.min,g.max,c);u.push({min:h.min,max:h.max,sourceId:this._sourceIds[g.priority],footprint:g.footprint,footprintTileId:g.tileId,order:g.order,clipMask:g.clipMask,clipScope:g.clipScope})}return u}setSources(c){this._setSources(c.map(n=>({getSourceId:()=>n.cache.id,getFootprints:()=>{const s=[];for(const u of n.cache.getVisibleCoordinates()){const g=n.cache.getTile(u).buckets[n.layer];g&&g.updateFootprints(u.toUnwrapped(),s)}return s},getOrder:()=>n.order,getClipMask:()=>n.clipMask,getClipScope:()=>n.clipScope})))}_addSource(c){const n=c.getFootprints();if(n.length===0)return;const s=c.getOrder(),u=c.getClipMask(),g=c.getClipScope();for(const h of n){if(!h.footprint)continue;const v=iI(h.footprint.min,h.footprint.max,h.id);this._activeRegions.push({min:v.min,max:v.max,hiddenByOverlap:!1,priority:this._sourceIds.length,tileId:h.id,footprint:h.footprint,order:s,clipMask:u,clipScope:g})}this._sourceIds.push(c.getSourceId())}_computeReplacement(){this._activeRegions.sort((n,s)=>n.priority-s.priority||O0(n.min,s.min)||O0(n.max,s.max)||n.order-s.order||n.clipMask-s.clipMask||function(u,g){const h=(v,T)=>v+T;return u.length-g.length||u.reduce(h,"").localeCompare(g.reduce(h,""))}(n.clipScope,s.clipScope));let c=this._activeRegions.length!==this._prevRegions.length;if(!c){let n=0;for(;!c&&n!==this._activeRegions.length;){const s=this._activeRegions[n],u=this._prevRegions[n];c=s.priority!==u.priority||!oI(s,u)||s.order!==u.order||s.clipMask!==u.clipMask||!Yt(s.clipScope,u.clipScope),++n}}if(c){++this._updateTime;for(const s of this._activeRegions)s.order!==R0&&(this._globalClipBounds.min.x=Math.min(this._globalClipBounds.min.x,s.min.x),this._globalClipBounds.min.y=Math.min(this._globalClipBounds.min.y,s.min.y),this._globalClipBounds.max.x=Math.max(this._globalClipBounds.max.x,s.max.x),this._globalClipBounds.max.y=Math.max(this._globalClipBounds.max.y,s.max.y));const n=s=>{const u=this._activeRegions;if(s>=u.length)return s;const g=u[s].priority;for(;s<u.length&&u[s].priority===g;)++s;return s};if(this._sourceIds.length>1){let s=0,u=n(s);for(;s!==u;){let g=s;const h=s;for(;g!==u;){const v=this._activeRegions[g];v.hiddenByOverlap=!1;for(let T=0;T<h;T++){const A=this._activeRegions[T];if(!A.hiddenByOverlap&&v.order===R0&&Ow(v,A)&&(v.hiddenByOverlap=aI(v.footprint,v.tileId,A.footprint,A.tileId),v.hiddenByOverlap))break}++g}s=u,u=n(s)}}}}_setSources(c){[this._prevRegions,this._activeRegions]=[this._activeRegions,[]],this._sourceIds=[];for(let n=c.length-1;n>=0;n--)this._addSource(c[n]);this._computeReplacement()}},r.dw=class{constructor(c){this._createGrid(c),this._createPoles(c)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const c of this._poleSegments)c.destroy();for(const c of this._gridSegments)c.withSkirts.destroy(),c.withoutSkirts.destroy()}_fillGridMeshWithLods(c,n){const s=new Bl,u=new $i,g=[],h=c+1+2,v=n[0]+1,T=n[0]+1+(1+n.length),A=(D,x,P)=>{let L=D===h-1?D-2:D===0?D:D-1;return L+=P?24575:0,[L,x]};for(let D=0;D<h;++D)s.emplaceBack(...A(D,0,!0));for(let D=0;D<v;++D)for(let x=0;x<h;++x)s.emplaceBack(...A(x,D,(x===0||x===h-1)&&!0));for(let D=0;D<n.length;++D){const x=n[D];for(let P=0;P<h;++P)s.emplaceBack(...A(P,x,!0))}for(let D=0;D<n.length;++D){const x=u.length,P=n[D]+1+2,L=new $i;for(let V=0;V<P-1;V++){const W=V===P-2,K=W?h*(T-n.length+D-V):h;for(let re=0;re<h-1;re++){const ie=V*h+re;V===0||W||re===0||re===h-2?(L.emplaceBack(ie+1,ie,ie+K),L.emplaceBack(ie+K,ie+K+1,ie+1)):(u.emplaceBack(ie+1,ie,ie+K),u.emplaceBack(ie+K,ie+K+1,ie+1))}}const I=ei.simpleSegment(0,x,s.length,u.length-x);for(let V=0;V<L.uint16.length;V+=3)u.emplaceBack(L.uint16[V],L.uint16[V+1],L.uint16[V+2]);const R=ei.simpleSegment(0,x,s.length,u.length-x);g.push({withoutSkirts:I,withSkirts:R})}return{vertices:s,indices:u,segments:g}}_createGrid(c){const n=this._fillGridMeshWithLods(gd,Rp);this._gridSegments=n.segments,this._gridBuffer=c.createVertexBuffer(n.vertices,ir.members),this._gridIndexBuffer=c.createIndexBuffer(n.indices,!0)}_createPoles(c){const n=new $i;for(let v=0;v<=gd;v++)n.emplaceBack(0,v+1,v+2);this._poleIndexBuffer=c.createIndexBuffer(n,!0);const s=new Ic,u=new Ic,g=new Ic,h=new Ic;this._poleSegments=[];for(let v=0,T=0;v<md;v++){const A=360/(1<<v);s.emplaceBack(0,-hs,0,.5,0),u.emplaceBack(0,-hs,0,.5,1),g.emplaceBack(0,-hs,0,.5,.5),h.emplaceBack(0,-hs,0,.5,.5);for(let D=0;D<=gd;D++){let x=D/gd,P=0;const L=cr(0,A,x),[I,R,V]=vd(xu,hl,L,hs);s.emplaceBack(I,R,V,x,P),u.emplaceBack(I,R,V,x,1-P);const W=Ot(L);x=.5+.5*Math.sin(W),P=.5+.5*Math.cos(W),g.emplaceBack(I,R,V,x,P),h.emplaceBack(I,R,V,x,1-P)}this._poleSegments.push(ei.simpleSegment(T,0,66,64)),T+=66}this._poleNorthVertexBuffer=c.createVertexBuffer(s,dr,!1),this._poleSouthVertexBuffer=c.createVertexBuffer(u,dr,!1),this._texturedPoleNorthVertexBuffer=c.createVertexBuffer(g,dr,!1),this._texturedPoleSouthVertexBuffer=c.createVertexBuffer(h,dr,!1)}getGridBuffers(c,n){return[this._gridBuffer,this._gridIndexBuffer,n?this._gridSegments[c].withSkirts:this._gridSegments[c].withoutSkirts]}getPoleBuffers(c,n){return[n?this._texturedPoleNorthVertexBuffer:this._poleNorthVertexBuffer,n?this._texturedPoleSouthVertexBuffer:this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[c]]}},r.dx=R0,r.dy=Pn,r.dz=function(){return!!document.fullscreenElement||!!document.webkitFullscreenElement},r.e=Jo,r.e0=II,r.e1=ct,r.e2=ol,r.e3=nA,r.e4=function(c,n,s,u,g,h,v,T,A,D,x=1,P,L){c.createArrays(),c.tilePixelRatio=In/(512*c.overscaling),c.compareText={},c.iconsNeedLinear=!1;const I=c.layers[0].layout,R=c.layers[0]._unevaluatedLayout._values,V={};V.scaleFactor=x,V.textSizeScaleRange=I.get("text-size-scale-range"),V.iconSizeScaleRange=I.get("icon-size-scale-range");const[W,K]=V.textSizeScaleRange,[re,ie]=V.iconSizeScaleRange;if(V.textScaleFactor=It(V.scaleFactor,W,K),V.iconScaleFactor=It(V.scaleFactor,re,ie),c.textSizeData.kind==="composite"){const{minZoom:Ee,maxZoom:Ne}=c.textSizeData;V.compositeTextSizes=[R["text-size"].possiblyEvaluate(new zo(Ee),T),R["text-size"].possiblyEvaluate(new zo(Ne),T)]}if(c.iconSizeData.kind==="composite"){const{minZoom:Ee,maxZoom:Ne}=c.iconSizeData;V.compositeIconSizes=[R["icon-size"].possiblyEvaluate(new zo(Ee),T),R["icon-size"].possiblyEvaluate(new zo(Ne),T)]}V.layoutTextSize=R["text-size"].possiblyEvaluate(new zo(A+1),T),V.layoutIconSize=R["icon-size"].possiblyEvaluate(new zo(A+1),T),V.textMaxSize=R["text-size"].possiblyEvaluate(new zo(18),T);const Q=I.get("text-rotation-alignment")==="map"&&I.get("symbol-placement")!=="point",ue=I.get("text-size");let _e=!1;for(const Ee of c.features)if(Ee.icon&&Ee.icon.nameSecondary){_e=!0;break}for(const Ee of c.features){const Ne=I.get("text-font").evaluate(Ee,{},T).join(","),ze=ue.evaluate(Ee,{},T)*V.textScaleFactor,De=V.layoutTextSize.evaluate(Ee,{},T)*V.textScaleFactor,ot=(V.layoutIconSize.evaluate(Ee,{},T),{horizontal:{},vertical:void 0}),$e=Ee.text;let it,ft=[0,0];if($e){const xt=$e.toString(),At=I.get("text-letter-spacing").evaluate(Ee,{},T)*ts,_t=I.get("text-line-height").evaluate(Ee,{},T)*ts,Zt=cw(xt)?At:0,hn=I.get("text-anchor").evaluate(Ee,{},T),Kt=I.get("text-variable-anchor");if(!Kt){const Zn=I.get("text-radial-offset").evaluate(Ee,{},T);ft=Zn?lA(hn,[Zn*ts,Zw]):I.get("text-offset").evaluate(Ee,{},T).map(Rn=>Rn*ts)}let kn=Q?"center":I.get("text-justify").evaluate(Ee,{},T);const Mn=I.get("symbol-placement")==="point",_n=Mn?I.get("text-max-width").evaluate(Ee,{},T)*ts:1/0,mn=Zn=>{c.allowVerticalPlacement&&Kg(xt)&&(ot.vertical=Ww($e,n,s,g,Ne,_n,_t,hn,Zn,Zt,ft,Ba.vertical,!0,De,ze))};if(!Q&&Kt){const Zn=kn==="auto"?Kt.map(Fn=>Yw(Fn)):[kn];let Rn=!1;for(let Fn=0;Fn<Zn.length;Fn++){const pr=Zn[Fn];if(!ot.horizontal[pr])if(Rn)ot.horizontal[pr]=ot.horizontal[0];else{const Ir=Ww($e,n,s,g,Ne,_n,_t,"center",pr,Zt,ft,Ba.horizontal,!1,De,ze);Ir&&(ot.horizontal[pr]=Ir,Rn=Ir.positionedLines.length===1)}}mn("left")}else{if(kn==="auto"&&(kn=Yw(hn)),Mn||I.get("text-writing-mode").indexOf("horizontal")>=0||!Kg(xt)){const Zn=Ww($e,n,s,g,Ne,_n,_t,hn,kn,Zt,ft,Ba.horizontal,!1,De,ze);Zn&&(ot.horizontal[kn]=Zn)}mn(Mn?"left":kn)}}let ut=!1;if(Ee.icon&&Ee.icon.namePrimary){const xt=$w(c.iconSizeData,R["icon-size"],T,c.zoom,Ee)*V.iconScaleFactor*P,At=Ee.icon.getPrimary().scaleSelf(xt).serialize(),_t=u[At];_t&&(it=Y5(g[At],Ee.icon.nameSecondary?g[Ee.icon.getSecondary().scaleSelf(xt).serialize()]:void 0,I.get("icon-offset").evaluate(Ee,{},T),I.get("icon-anchor").evaluate(Ee,{},T)),ut=_t.sdf,c.sdfIcons===void 0?c.sdfIcons=_t.sdf:c.sdfIcons!==_t.sdf&&wn("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(_t.pixelRatio!==c.pixelRatio||I.get("icon-rotate").constantOr(1)!==0)&&(c.iconsNeedLinear=!0))}const mt=uA(ot.horizontal)||ot.vertical;c.iconsInText||(c.iconsInText=!!mt&&mt.iconsInText),(mt||it)&&rV(c,Ee,ot,it,u,V,De,0,ft,ut,v,T,D,L,_e)}h&&c.generateCollisionDebugBuffers(A,c.collisionBoxArray,V.textScaleFactor)},r.e5=hb,r.e6=nt,r.e7=QM,r.e8=UI,r.e9=S,r.ea=function(c){let n=0;if(new Uint32Array(c,0,1)[0]!==Pk){const s=new Uint32Array(c,0,7),[,,u,g,h,v]=s;n=s.byteLength+g+h+v+h,(u!==c.byteLength||n>=c.byteLength)&&wn("Invalid b3dm header information.")}return Dk(c,n)},r.eb=function(c,n){const s=Fk(c);for(const u of s){for(const g of u.meshes)R$(g);u.lights&&(u.lightMeshIndex=u.meshes.length,u.meshes.push(O$(u.lights,n)))}return s},r.ec=ib,r.ed=XA,r.ee=qs,r.ef=function(c){on(),Ke!=null&&Ke.then(n=>{n.keys().then(s=>{for(let u=0;u<s.length-c;u++)n.delete(s[u])})})},r.f=function(c){return c.indexOf("mapbox:")===0},r.g=function(c,n){return Ei(tr(c,{method:"GET"}),n)},r.h=va,r.i=function(c){return Jo.API_STYLE_REGEX.test(c)&&!vc(c)},r.j=function(c){return decodeURIComponent(atob(c).split("").map(n=>"%"+("00"+n.charCodeAt(0).toString(16)).slice(-2)).join(""))},r.k=function(c){return btoa(encodeURIComponent(c).replace(/%([0-9A-F]{2})/g,(n,s)=>String.fromCharCode(+("0x"+s))))},r.l=tr,r.m=er,r.n=function(c,n){return Ei(tr(c,{type:"json"}),n)},r.o=sg,r.p=function(c,n){return Ei(tr(c,{method:"POST"}),n)},r.q=je,r.r=qi,r.s=function(c){try{const n=self[c];return n.setItem("_mapbox_test_",1),n.removeItem("_mapbox_test_"),!0}catch{return!1}},r.t=Ie,r.u=function(){return function c(n){return n?(n^Math.random()*(16>>n/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,c)}()},r.v=function(c){return!!c&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(c)},r.w=wn,r.x=function(){return p2||(p2=new nf),p2},r.y=Hf,r.z=nl}),p(["./shared"],function(r){function S(zt){const ye=zt?zt.url.toString():void 0;return ye?performance.getEntriesByName(ye):[]}function C(zt){if(typeof zt=="number"||typeof zt=="boolean"||typeof zt=="string"||zt==null)return JSON.stringify(zt);if(Array.isArray(zt)){let he="[";for(const Ie of zt)he+=`${C(Ie)},`;return`${he}]`}let ye="{";for(const he of Object.keys(zt).sort())ye+=`${he}:${C(zt[he])},`;return`${ye}}`}function M(zt){let ye="";for(const he of r.bm)(zt.type!=="model"||he!=="minzoom"&&he!=="maxzoom")&&(ye+=`/${C(zt[he])}`);return ye}class k{constructor(ye){this.keyCache={},this._layers={},this._layerConfigs={},ye&&this.replace(ye)}replace(ye,he){this._layerConfigs={},this._layers={},this.update(ye,[],he)}update(ye,he,Ie){this._options=Ie;for(const Je of ye)this._layerConfigs[Je.id]=Je,(this._layers[Je.id]=r.cu(Je,this.scope,null,this._options)).compileFilter(Ie),this.keyCache[Je.id]&&delete this.keyCache[Je.id];for(const Je of he)delete this.keyCache[Je],delete this._layerConfigs[Je],delete this._layers[Je];this.familiesBySource={};const je=function(Je,lt){const St={};for(let Dt=0;Dt<Je.length;Dt++){const Pt=Je[Dt];let Ke=lt&&lt[Pt.id];!Ke&&(Ke=M(Pt),Pt.type==="line"&&Pt.paint)&&function Qt(on){return typeof on=="string"&&on==="line-progress"||(Array.isArray(on)?on.some(Qt):!(!on||typeof on!="object")&&Object.values(on).some(Qt))}(Pt.paint["line-width"])&&(Ke+=`/${C(Pt.paint["line-width"])}`),lt&&(lt[Pt.id]=Ke);let Ct=St[Ke];Ct||(Ct=St[Ke]=[]),Ct.push(Pt)}const ht=[];for(const Dt in St)ht.push(St[Dt]);return ht}(r.bj(this._layerConfigs),this.keyCache);for(const Je of je){const lt=Je.map(Ct=>this._layers[Ct.id]),St=lt[0];if(St.visibility==="none")continue;const ht=St.source||"";let Dt=this.familiesBySource[ht];Dt||(Dt=this.familiesBySource[ht]={});const Pt=St.sourceLayer||"_geojsonTileLayer";let Ke=Dt[Pt];Ke||(Ke=Dt[Pt]=[]),Ke.push(lt)}}}const z=1*r.dX;class F{constructor(ye){const he={},Ie=[];for(const St in ye){const ht=ye[St],Dt=he[St]={};for(const Pt in ht.glyphs){const Ke=ht.glyphs[+Pt];if(!Ke||Ke.bitmap.width===0||Ke.bitmap.height===0)continue;const Ct=Ke.metrics.localGlyph?z:1,Qt={x:0,y:0,w:Ke.bitmap.width+2*Ct,h:Ke.bitmap.height+2*Ct};Ie.push(Qt),Dt[Pt]=Qt}}const{w:je,h:Je}=r.F(Ie),lt=new r.dW({width:je||1,height:Je||1});for(const St in ye){const ht=ye[St];for(const Dt in ht.glyphs){const Pt=ht.glyphs[+Dt];if(!Pt||Pt.bitmap.width===0||Pt.bitmap.height===0)continue;const Ke=he[St][Dt],Ct=Pt.metrics.localGlyph?z:1;r.dW.copy(Pt.bitmap,lt,{x:0,y:0},{x:Ke.x+Ct,y:Ke.y+Ct},Pt.bitmap)}}this.image=lt,this.positions=he}}r.dV(F,"GlyphAtlas");const B="3d_elevation_id",N="hd_road_elevation";class j{constructor(){this._valid=!1}reset(ye){return this.feature=ye,this._valid=!0,this._geometry=ye.loadGeometry(),this._geometry.length!==0&&this._geometry[0].length!==0||(this._valid=!1),this}geometry(ye,he){return this._valid&&ye(he(this._geometry)),this}require(ye,he,Ie){return this.get(ye,!0,he,Ie)}optional(ye,he,Ie){return this.get(ye,!1,he,Ie)}success(){return this._valid}get(ye,he,Ie,je){const Je=this.feature.properties.hasOwnProperty(ye)?+this.feature.properties[ye]:void 0;return this._valid&&Je!==void 0?Ie(je?je(Je):Je):he&&(this._valid=!1),this}}class U{constructor(ye,he){this.featureFunc=ye,this.vertexFunc=he}parseFeature(ye,he,Ie){return this.featureFunc(ye,he,Ie)}parseVertex(ye,he,Ie){return this.vertexFunc(ye,he,Ie)}}const te=new U((zt,ye,he)=>zt.reset(ye).require(B,Ie=>{he.id=Ie}).optional("fixed_height_relative",Ie=>{he.constantHeight=Ie},q.decodeRelativeHeight).geometry(Ie=>{he.bounds=Ie},q.computeBounds).success(),(zt,ye,he)=>zt.reset(ye).require(B,Ie=>{he.id=Ie}).require("elevation_idx",Ie=>{he.idx=Ie}).require("extent",Ie=>{he.extent=Ie}).require("height_relative",Ie=>{he.height=Ie},q.decodeRelativeHeight).geometry(Ie=>{he.position=Ie},q.getPoint).success()),Y=new U((zt,ye,he)=>zt.reset(ye).require(B,Ie=>{he.id=Ie}).optional("fixed_height",Ie=>{he.constantHeight=Ie},q.decodeMetricHeight).geometry(Ie=>{he.bounds=Ie},q.computeBounds).success(),(zt,ye,he)=>zt.reset(ye).require(B,Ie=>{he.id=Ie}).require("elevation_idx",Ie=>{he.idx=Ie}).require("extent",Ie=>{he.extent=Ie}).require("height",Ie=>{he.height=Ie},q.decodeMetricHeight).geometry(Ie=>{he.position=Ie},q.getPoint).success());class q{static computeBounds(ye){const he=new r.P(Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY),Ie=new r.P(Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY);for(const je of ye[0])he.x>je.x&&(he.x=je.x),he.y>je.y&&(he.y=je.y),Ie.x<je.x&&(Ie.x=je.x),Ie.y<je.y&&(Ie.y=je.y);return{min:he,max:Ie}}static getPoint(ye){return r.ab.vec2.fromValues(ye[0][0].x,ye[0][0].y)}static decodeRelativeHeight(ye){return 1e-4*ye*5}static decodeMetricHeight(ye){return 1e-4*ye}static parse(ye){const he=[],Ie=[],je=ye.length,Je=new j;for(let St=0;St<je;St++){const ht=ye.feature(St),Dt=ht.properties.hasOwnProperty("version")?String(ht.properties.version):void 0,Pt=(lt=Dt)?lt==="1.0.1"?Y:void 0:te;if(Pt===void 0){r.w(`Unknown elevation feature version number ${Dt||"(unknown)"}`);continue}const Ke=ht.properties.hasOwnProperty("type")?ht.properties.type:void 0;if(Ke){if(r.dY.VectorTileFeature.types[ht.type]==="Point"&&Ke==="curve_point"){const Ct={};Pt.parseVertex(Je,ht,Ct)&&he.push(Ct)}else if(r.dY.VectorTileFeature.types[ht.type]==="Polygon"&&Ke==="curve_meta"){const Ct={};Pt.parseFeature(Je,ht,Ct)&&Ie.push(Ct)}}}var lt;return{vertices:he,features:Ie}}}class J{constructor(ye,he,Ie,je,Je,lt){if(this.vertices=new Array,this.vertexProps=new Array,this.edges=new Array,this.edgeProps=new Array,this.id=ye,this.heightRange={min:Ie,max:Ie},this.safeArea=he,this.constantHeight=Ie,this.constantHeight==null&&(this.constantHeight!=null||je.length!==0)){this.vertices=je,this.edges=Je,this.edges=this.edges.filter(St=>St.a<this.vertices.length&&St.b<this.vertices.length&&!r.ab.vec2.exactEquals(this.vertices[St.a].position,this.vertices[St.b].position)),this.heightRange={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY};for(const St of this.vertices)this.vertexProps.push({dir:r.ab.vec2.fromValues(0,0)}),this.heightRange.min=Math.min(this.heightRange.min,St.height),this.heightRange.max=Math.max(this.heightRange.max,St.height);for(const St of this.edges){const ht=this.vertices[St.a].position,Dt=this.vertices[St.b].position,Pt=r.ab.vec2.subtract(r.ab.vec2.create(),Dt,ht),Ke=r.ab.vec2.length(Pt),Ct=r.ab.vec2.scale(r.ab.vec2.create(),Pt,1/Ke);this.edgeProps.push({vec:Pt,dir:Ct,len:Ke});const Qt=this.vertexProps[St.a].dir,on=this.vertexProps[St.b].dir;r.ab.vec2.add(Qt,Qt,Ct),r.ab.vec2.add(on,on,Ct)}for(const St of this.vertexProps)St.dir[0]===0&&St.dir[1]===0||r.ab.vec2.normalize(St.dir,St.dir);this.tessellate(lt)}}pointElevation(ye){if(this.constantHeight!=null)return this.constantHeight;const he=this.getClosestEdge(ye);if(he==null)return 0;const[Ie,je]=he;return(1-(Je=je))*this.vertices[this.edges[Ie].a].height+Je*this.vertices[this.edges[Ie].b].height;var Je}getClosestEdge(ye){if(this.edges.length===0)return;let he=0,Ie=Number.POSITIVE_INFINITY,je=0;const Je=r.ab.vec2.fromValues(ye.x,ye.y);for(let lt=0;lt<this.edges.length;lt++){const St=this.edges[lt],ht=this.edgeProps[lt].dir,Dt=new r.dZ(Je,this.edgeProps[lt].dir),Pt=this.vertices[St.a].position,Ke=this.vertices[St.b].position,Ct=r.ab.vec2.create(),Qt=r.ab.vec2.create(),on=Dt.intersectsPlane(Pt,this.vertexProps[St.a].dir,Ct),Wn=Dt.intersectsPlane(Ke,this.vertexProps[St.b].dir,Qt);if(!on||!Wn)continue;const er=r.ab.vec2.subtract(r.ab.vec2.create(),Qt,Ct),ar=r.ab.vec2.subtract(r.ab.vec2.create(),Je,Ct),rr=r.ab.vec2.dot(er,er),$r=rr>0?r.ab.vec2.dot(ar,er)/rr:0,Kr=r.aw($r,0,1),Pr=Math.abs(($r-Kr)*this.edgeProps[lt].len),Zr=r.ab.vec2.subtract(r.ab.vec2.create(),Je,Pt),Jr=Pr+Math.abs(r.ab.vec2.dot(Zr,r.ab.vec2.fromValues(ht[1],-ht[0])));Jr<Ie&&(he=lt,Ie=Jr,je=Kr)}return[he,je]}tessellate(ye){for(let he=this.edges.length-1;he>=0;--he){const Ie=this.edges[he].a,je=this.edges[he].b,{position:Je,height:lt,extent:St}=this.vertices[Ie],{position:ht,height:Dt,extent:Pt}=this.vertices[je],Ke=this.vertexProps[Ie].dir,Ct=this.vertexProps[je].dir,Qt=r.ab.vec3.fromValues(Je[0]/ye,Je[1]/ye,lt),on=r.ab.vec3.fromValues(ht[0]/ye,ht[1]/ye,Dt),Wn=r.ab.vec3.fromValues(Ke[1],-Ke[0],0);r.ab.vec3.scale(Wn,Wn,St);const er=r.ab.vec3.fromValues(Ct[1],-Ct[0],0);if(r.ab.vec3.scale(er,er,Pt),this.distSqLines(r.ab.vec3.fromValues(Qt[0]+.5*Wn[0],Qt[1]+.5*Wn[1],Qt[2]+.5*Wn[2]),r.ab.vec3.fromValues(on[0]-.5*er[0],on[1]-.5*er[1],on[2]-.5*er[2]),r.ab.vec3.fromValues(Qt[0]-.5*Wn[0],Qt[1]-.5*Wn[1],Qt[2]-.5*Wn[2]),r.ab.vec3.fromValues(on[0]+.5*er[0],on[1]+.5*er[1],on[2]+.5*er[2]))<=.05*.05)continue;const ar=this.vertices.length,rr=r.ab.vec2.add(r.ab.vec2.create(),Je,ht);this.vertices.push({position:r.ab.vec2.scale(rr,rr,.5),height:.5*(lt+Dt),extent:.5*(St+Pt)});const $r=r.ab.vec2.add(r.ab.vec2.create(),Ke,Ct);this.vertexProps.push({dir:r.ab.vec2.normalize($r,$r)}),this.edges.splice(he,1),this.edgeProps.splice(he,1),this.edges.push({a:Ie,b:ar}),this.edges.push({a:ar,b:je});const Kr=r.ab.vec2.subtract(r.ab.vec2.create(),this.vertices[ar].position,Je),Pr=r.ab.vec2.length(Kr),Zr={vec:Kr,dir:r.ab.vec2.scale(r.ab.vec2.create(),Kr,1/Pr),len:Pr};this.edgeProps.push(Zr),this.edgeProps.push(Zr)}}distSqLines(ye,he,Ie,je){const Je=r.ab.vec3.subtract(r.ab.vec3.create(),he,ye),lt=r.ab.vec3.subtract(r.ab.vec3.create(),je,Ie),St=r.ab.vec3.subtract(r.ab.vec3.create(),ye,Ie),ht=r.ab.vec3.dot(Je,Je),Dt=r.ab.vec3.dot(Je,lt),Pt=r.ab.vec3.dot(Je,St),Ke=r.ab.vec3.dot(lt,lt),Ct=r.ab.vec3.dot(lt,St),Qt=ht*Ke-Dt*Dt;if(Qt===0){const rr=r.ab.vec3.dot(St,lt)/r.ab.vec3.dot(lt,lt),$r=r.ab.vec3.lerp(r.ab.vec3.create(),Ie,je,rr);return r.ab.vec3.squaredDistance($r,ye)}const on=(Dt*Ct-Pt*Ke)/Qt,Wn=(ht*Ct-Dt*Pt)/Qt,er=r.ab.vec3.lerp(r.ab.vec3.create(),ye,he,on),ar=r.ab.vec3.lerp(r.ab.vec3.create(),Ie,je,Wn);return r.ab.vec3.squaredDistance(er,ar)}}class ne{static parseFrom(ye,he){const Ie=q.parse(ye);if(!Ie)return[];let{vertices:je,features:Je}=Ie;const lt=1/r.cc(he);Je.sort((Pt,Ke)=>Pt.id-Ke.id),je.sort((Pt,Ke)=>Pt.id-Ke.id||Pt.idx-Ke.idx),je=je.filter((Pt,Ke,Ct)=>Ke===Ct.findIndex(Qt=>Qt.id===Pt.id&&Qt.idx===Pt.idx));const St=new Array;let ht=0;const Dt=je.length;for(const Pt of Je){if(Pt.constantHeight){St.push(new J(Pt.id,Pt.bounds,Pt.constantHeight));continue}for(;ht!==Dt&&je[ht].id<Pt.id;)ht++;if(ht===Dt||je[ht].id!==Pt.id)continue;const Ke=new Array,Ct=new Array,Qt=ht;for(;ht!==Dt&&je[ht].id===Pt.id;){const on=je[ht];if(Ke.push({position:on.position,height:on.height,extent:on.extent}),ht!==Qt&&je[ht-1].idx===on.idx-1){const Wn=ht-Qt;Ct.push({a:Wn-1,b:Wn})}ht++}St.push(new J(Pt.id,Pt.bounds,void 0,Ke,Ct,lt))}return St}}r.dV(J,"ElevationFeature");class se{constructor(ye){this.tileID=new r.aG(ye.tileID.overscaledZ,ye.tileID.wrap,ye.tileID.canonical.z,ye.tileID.canonical.x,ye.tileID.canonical.y),this.tileZoom=ye.tileZoom,this.uid=ye.uid,this.zoom=ye.zoom,this.lut=ye.lut,this.canonical=ye.tileID.canonical,this.pixelRatio=ye.pixelRatio,this.tileSize=ye.tileSize,this.source=ye.source,this.scope=ye.scope,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=ye.showCollisionBoxes,this.collectResourceTiming=!!ye.request&&ye.request.collectResourceTiming,this.promoteId=ye.promoteId,this.isSymbolTile=ye.isSymbolTile,this.tileTransform=r.aQ(ye.tileID.canonical,ye.projection),this.projection=ye.projection,this.worldview=ye.worldview,this.localizableLayerIds=ye.localizableLayerIds,this.brightness=ye.brightness,this.extraShadowCaster=!!ye.extraShadowCaster,this.tessellationStep=ye.tessellationStep,this.scaleFactor=ye.scaleFactor}parse(ye,he,Ie,je,Je){this.status="parsing",this.data=ye,this.collisionBoxArray=new r.aW;const lt=new r.d_(Object.keys(ye.layers).sort()),St=new r.d$(this.tileID,this.promoteId);St.bucketLayerIDs=[];const ht={},Dt=new r.e0(256,256),Pt={featureIndex:St,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:Dt,availableImages:Ie,brightness:this.brightness,scaleFactor:this.scaleFactor,elevationFeatures:void 0},Ke=he.familiesBySource[this.source];for(const rr in Ke){const $r=ye.layers[rr];if(!$r)continue;let Kr=!1,Pr=!1,Zr=!1;for(const Ei of Ke[rr])Ei[0].type==="symbol"?Kr=!0:Pr=!0,Ei[0].is3D()&&Ei[0].type!=="model"&&(Zr=!0);if(this.extraShadowCaster&&!Zr||this.isSymbolTile===!0&&!Kr||this.isSymbolTile===!1&&!Pr)continue;$r.version===1&&r.w(`Vector tile source "${this.source}" layer "${rr}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const Jr=lt.encode(rr),fi=[];let el=!1;for(let Ei=0,ki=0;Ei<$r.length;Ei++){const us=$r.feature(Ei),sh=St.getId(us,rr);if(this.localizableLayerIds&&this.localizableLayerIds.has(rr)){const Pl=us.properties?us.properties.worldview:null;if(this.worldview&&typeof Pl=="string")if(Pl==="all")us.properties.$localized=!0;else{if(!Pl.split(",").includes(this.worldview))continue;us.properties.$localized=!0,us.properties.worldview=this.worldview}}!el&&us.properties&&us.properties.hasOwnProperty(B)&&(el=!0),fi.push({feature:us,id:sh,index:ki,sourceLayerIndex:Jr}),ki++}el&&ye.layers.hasOwnProperty(N)&&(Pt.elevationFeatures=ne.parseFrom(ye.layers[N],this.canonical));for(const Ei of Ke[rr]){const ki=Ei[0];(!this.extraShadowCaster||ki.is3D()&&ki.type!=="model")&&(this.isSymbolTile!==void 0&&ki.type==="symbol"!==this.isSymbolTile||ki.minzoom&&this.zoom<Math.floor(ki.minzoom)||ki.maxzoom&&this.zoom>=ki.maxzoom||ki.visibility!=="none"&&(fe(Ei,this.zoom,Pt.brightness,Ie),(ht[ki.id]=ki.createBucket({index:St.bucketLayerIDs.length,layers:Ei,zoom:this.zoom,lut:this.lut,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Jr,sourceID:this.source,projection:this.projection.spec,tessellationStep:this.tessellationStep})).populate(fi,Pt,this.tileID.canonical,this.tileTransform),St.bucketLayerIDs.push(Ei.map(us=>r.aC(us.id,us.scope)))))}}let Ct,Qt,on,Wn;Dt.trim();const er={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},ar=()=>{if(Ct)return this.status="done",Je(Ct);if(this.extraShadowCaster)this.status="done",Je(null,{buckets:r.bj(ht).filter(rr=>!rr.isEmpty()),featureIndex:St,collisionBoxArray:null,glyphAtlasImage:null,lineAtlas:null,imageAtlas:null,brightness:Pt.brightness,glyphMap:null,iconMap:null,glyphPositions:null});else if(Qt&&on&&Wn){const rr=new F(Qt),$r=new r.e3(on,Wn,this.lut);for(const Kr in ht){const Pr=ht[Kr];Pr instanceof r.aX?(fe(Pr.layers,this.zoom,Pt.brightness,Ie),r.e4(Pr,Qt,rr.positions,on,$r.iconPositions,this.showCollisionBoxes,Ie,this.tileID.canonical,this.tileZoom,this.projection,this.scaleFactor,this.pixelRatio,this.brightness)):Pr.hasPattern&&(Pr instanceof r.b1||Pr instanceof r.b2||Pr instanceof r.d5)&&(fe(Pr.layers,this.zoom,Pt.brightness,Ie),Pr.addFeatures(Pt,this.tileID.canonical,$r.patternPositions,Ie,this.tileTransform,this.brightness))}this.status="done",Je(null,{buckets:r.bj(ht).filter(Kr=>!Kr.isEmpty()),featureIndex:St,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:rr.image,lineAtlas:Dt,imageAtlas:$r,brightness:Pt.brightness})}};if(!this.extraShadowCaster){const rr=r.e1(Pt.glyphDependencies,Pr=>Object.keys(Pr).map(Number));Object.keys(rr).length?je.send("getGlyphs",{uid:this.uid,stacks:rr,scope:this.scope},(Pr,Zr)=>{Ct||(Ct=Pr,Qt=Zr,ar())},void 0,!1,er):Qt={};const $r=Object.keys(Pt.iconDependencies);$r.length?je.send("getImages",{icons:$r,source:this.source,scope:this.scope,tileID:this.tileID,type:"icons"},(Pr,Zr)=>{if(Ct)return;Ct=Pr;const Jr={};Object.values(Zr).some(fi=>fi.usvg)?this.rasterize(je,Jr,Zr,Pt.iconDependencies,()=>{on=Jr,ar()}):(this.fillImageMap(Jr,Pt.iconDependencies,Zr),on=Jr,ar())},void 0,!1,er):on={};const Kr=Object.keys(Pt.patternDependencies);Kr.length?je.send("getImages",{icons:Kr,source:this.source,scope:this.scope,tileID:this.tileID,type:"patterns"},(Pr,Zr)=>{if(!Ct){Ct=Pr;const Jr={};Object.values(Zr).some(fi=>fi.usvg)?this.rasterize(je,Jr,Zr,Pt.patternDependencies,()=>{Wn=Jr,ar()}):(this.fillImageMap(Jr,Pt.patternDependencies,Zr),Wn=Jr,ar())}},void 0,!1,er):Wn={}}ar()}fillImageMap(ye,he,Ie){for(const je in Ie){const Je=he[je]||[];for(const lt of Je)Ie[lt.id].usvg||(ye[lt.serialize()]=Ie[lt.id])}}getImageTaskQueue(ye,he,Ie){const je={};for(const Je in he){const lt=Ie[Je]||[];for(const St of lt){const ht=St.serialize();he[St.id].usvg?je[ht]||(je[ht]=St):ye[ht]=he[St.id]}}return je}rasterize(ye,he,Ie,je,Je){const lt=this.getImageTaskQueue(he,Ie,je);this.rasterizeTask=ye.send("rasterizeImages",{scope:this.scope,imageTasks:lt},(St,ht)=>{if(!St)for(const Dt in ht){const{id:Pt}=r.e2.deserializeFromString(Dt);he[Dt]=Object.assign({},Ie[Pt],{data:ht[Dt]})}Je()})}cancelRasterize(){this.rasterizeTask&&this.rasterizeTask.cancel()}}function fe(zt,ye,he,Ie){const je=new r.a8(ye,{brightness:he});for(const Je of zt)Je.recalculate(je,Ie)}class ce extends r.E{constructor(ye,he,Ie,je,Je,lt){super(),this.actor=ye,this.layerIndex=he,this.availableImages=Ie,this.loadVectorData=Je||r.aD,this.loading={},this.loaded={},this.deduped=new r.aB(ye.scheduler),this.isSpriteLoaded=je,this.scheduler=ye.scheduler,this.brightness=lt}loadTile(ye,he){const Ie=ye.uid,je=ye&&ye.request,Je=je&&je.collectResourceTiming,lt=this.loading[Ie]=new se(ye);lt.abort=this.loadVectorData(ye,(St,ht)=>{const Dt=!this.loading[Ie];if(delete this.loading[Ie],lt.cancelRasterize(),Dt||St||!ht)return lt.status="done",Dt||(this.loaded[Ie]=lt),he(St);const Pt=ht.rawData,Ke={};ht.expires&&(Ke.expires=ht.expires),ht.cacheControl&&(Ke.cacheControl=ht.cacheControl),lt.vectorTile=ht.vectorTile||new r.dY.VectorTile(new r.bh(Pt));const Ct=()=>{lt.parse(lt.vectorTile,this.layerIndex,this.availableImages,this.actor,(Qt,on)=>{if(Qt||!on)return he(Qt);const Wn={};if(Je){const er=S(je);er.length>0&&(Wn.resourceTiming=JSON.parse(JSON.stringify(er)))}he(null,r.l({rawTileData:Pt.slice(0)},on,Ke,Wn))})};this.isSpriteLoaded?Ct():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(Ct,{type:"parseTile",isSymbolTile:ye.isSymbolTile,zoom:ye.tileZoom}):Ct()}),this.loaded=this.loaded||{},this.loaded[Ie]=lt})}reloadTile(ye,he){const Ie=this.loaded,je=ye.uid;if(Ie&&Ie[je]){const Je=Ie[je];Je.scaleFactor=ye.scaleFactor,Je.showCollisionBoxes=ye.showCollisionBoxes,Je.projection=ye.projection,Je.brightness=ye.brightness,Je.tileTransform=r.aQ(ye.tileID.canonical,ye.projection),Je.extraShadowCaster=ye.extraShadowCaster,Je.lut=ye.lut;const lt=(St,ht)=>{const Dt=Je.reloadCallback;Dt&&(delete Je.reloadCallback,Je.parse(Je.vectorTile,this.layerIndex,this.availableImages,this.actor,Dt)),he(St,ht)};Je.status==="parsing"?Je.reloadCallback=lt:Je.status==="done"&&(Je.vectorTile?Je.parse(Je.vectorTile,this.layerIndex,this.availableImages,this.actor,lt):lt())}else he(null,void 0)}abortTile(ye,he){const Ie=ye.uid,je=this.loading[Ie];je&&(je.abort&&je.abort(),delete this.loading[Ie]),he()}removeTile(ye,he){const Ie=this.loaded,je=ye.uid;Ie&&Ie[je]&&delete Ie[je],he()}}class le{loadTile(ye,he){const{uid:Ie,encoding:je,rawImageData:Je,padding:lt}=ye,St=ImageBitmap&&Je instanceof ImageBitmap?this.getImageData(Je,lt):Je;he(null,new r.e5(Ie,St,je,lt<1))}getImageData(ye,he){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(ye.width,ye.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=ye.width,this.offscreenCanvas.height=ye.height,this.offscreenCanvasContext.drawImage(ye,0,0,ye.width,ye.height);const Ie=this.offscreenCanvasContext.getImageData(-he,-he,ye.width+2*he,ye.height+2*he);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),Ie}}r.bg.setPbf(r.bh);class ge{decodeRasterArray({task:ye,buffer:he},Ie){r.bg.performDecoding(he,ye).then(je=>{Ie(null,je)},je=>{Ie(je)})}}const de=r.dY.VectorTileFeature.prototype.toGeoJSON;class ke{constructor(ye){this._feature=ye,this.extent=r.ag,this.type=ye.type,this.properties=ye.tags,"id"in ye&&!isNaN(ye.id)&&(this.id=parseInt(ye.id,10))}loadGeometry(){if(this._feature.type===1){const ye=[];for(const he of this._feature.geometry)ye.push([new r.P(he[0],he[1])]);return ye}{const ye=[];for(const he of this._feature.geometry){const Ie=[];for(const je of he)Ie.push(new r.P(je[0],je[1]));ye.push(Ie)}return ye}}toGeoJSON(ye,he,Ie){return de.call(this,ye,he,Ie)}}class We{constructor(ye){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=r.ag,this.length=ye.length,this._features=ye}feature(ye){return new ke(this._features[ye])}}const we=64/4096,be=128;class Me{constructor(){this.features=new Map}clear(){this.features.clear()}load(ye=[],he){for(const Ie of ye){const je=Ie.id;if(je==null)continue;let Je=this.features.get(je);Je&&this.updateCache(Je,he),Ie.geometry?(Je=me(Ie),this.updateCache(Je,he),this.features.set(je,Je)):this.features.delete(je),this.updateCache(Je,he)}}updateCache(ye,he){for(const{canonical:Ie,uid:je}of Object.values(he)){const{z:Je,x:lt,y:St}=Ie;Ae(ye,Math.pow(2,Je),lt,St)&&delete he[je]}}getTile(ye,he,Ie){const je=Math.pow(2,ye),Je=[];for(const lt of this.features.values())Ae(lt,je,he,Ie)&&Je.push(Pe(lt,je,he,Ie));return{features:Je}}getFeatures(){return[...this.features.values()]}}function Ae({minX:zt,minY:ye,maxX:he,maxY:Ie},je,Je,lt){return zt<(Je+1+we)/je&&ye<(lt+1+we)/je&&he>(Je-we)/je&&Ie>(lt-we)/je}function me(zt){const{id:ye,geometry:he,properties:Ie}=zt;if(!he)return;if(he.type==="GeometryCollection")throw new Error("GeometryCollection not supported in dynamic mode.");const{type:je,coordinates:Je}=he,lt={id:ye,type:1,geometry:[],tags:Ie,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0},St=lt.geometry;if(je==="Point")Be(Je,St,lt);else if(je==="MultiPoint")for(const ht of Je)Be(ht,St,lt);else if(je==="LineString")lt.type=2,Ve(Je,St,lt);else if(je==="MultiLineString")lt.type=2,bt(Je,St,lt);else if(je==="Polygon")lt.type=3,bt(Je,St,lt,!0);else{if(je!=="MultiPolygon")throw new Error("Input data is not a valid GeoJSON object.");lt.type=3;for(const ht of Je)bt(ht,St,lt,!0)}return lt}function Be([zt,ye],he,Ie){const je=r.at(zt);let Je=r.aA(ye);Je=Je<0?0:Je>1?1:Je,he.push(je,Je),Ie.minX=Math.min(Ie.minX,je),Ie.minY=Math.min(Ie.minY,Je),Ie.maxX=Math.max(Ie.maxX,je),Ie.maxY=Math.max(Ie.maxY,Je)}function Ve(zt,ye,he,Ie=!1,je=!1){const Je=[];for(const lt of zt)Be(lt,Je,he);ye.push(Je),Ie&&function(lt,St){let ht=0;for(let Dt=0,Pt=lt.length,Ke=Pt-2;Dt<Pt;Ke=Dt,Dt+=2)ht+=(lt[Dt]-lt[Ke])*(lt[Dt+1]+lt[Ke+1]);if(ht>0===St)for(let Dt=0,Pt=lt.length;Dt<Pt/2;Dt+=2){const Ke=lt[Dt],Ct=lt[Dt+1];lt[Dt]=lt[Pt-2-Dt],lt[Dt+1]=lt[Pt-1-Dt],lt[Pt-2-Dt]=Ke,lt[Pt-1-Dt]=Ct}}(Je,je)}function bt(zt,ye,he,Ie=!1){for(let je=0;je<zt.length;je++)Ve(zt[je],ye,he,Ie,je===0)}function Pe(zt,ye,he,Ie){const{id:je,type:Je,geometry:lt,tags:St}=zt,ht=[];if(Je===1)(function(Dt,Pt,Ke,Ct,Qt){for(let on=0;on<Dt.length;on+=2){const Wn=Math.round(r.ag*(Dt[on+0]*Pt-Ke)),er=Math.round(r.ag*(Dt[on+1]*Pt-Ct));Qt.push([Wn,er])}})(lt,ye,he,Ie,ht);else for(const Dt of lt)wt(Dt,ye,he,Ie,ht);return{id:je,type:Je,geometry:ht,tags:St}}function wt(zt,ye,he,Ie,je){const lt=r.ag+be;let St;for(let ht=0;ht<zt.length-2;ht+=2){let Dt=Math.round(r.ag*(zt[ht+0]*ye-he)),Pt=Math.round(r.ag*(zt[ht+1]*ye-Ie)),Ke=Math.round(r.ag*(zt[ht+2]*ye-he)),Ct=Math.round(r.ag*(zt[ht+3]*ye-Ie));const Qt=Ke-Dt,on=Ct-Pt;Dt<-128&&Ke<-128||(Dt<-128?(Pt+=Math.round(on*((-128-Dt)/Qt)),Dt=-128):Ke<-128&&(Ct=Pt+Math.round(on*((-128-Dt)/Qt)),Ke=-128),Pt<-128&&Ct<-128||(Pt<-128?(Dt+=Math.round(Qt*((-128-Pt)/on)),Pt=-128):Ct<-128&&(Ke=Dt+Math.round(Qt*((-128-Pt)/on)),Ct=-128),Dt>=lt&&Ke>=lt||(Dt>=lt?(Pt+=Math.round(on*((lt-Dt)/Qt)),Dt=lt):Ke>=lt&&(Ct=Pt+Math.round(on*((lt-Dt)/Qt)),Ke=lt),Pt>=lt&&Ct>=lt||(Pt>=lt?(Dt+=Math.round(Qt*((lt-Pt)/on)),Pt=lt):Ct>=lt&&(Ke=Dt+Math.round(Qt*((lt-Pt)/on)),Ct=lt),St&&Dt===St[St.length-1][0]&&Pt===St[St.length-1][1]||(St=[[Dt,Pt]],je.push(St)),St.push([Ke,Ct])))))}}var Mt,Nt,vt,Bt={exports:{}},Wt=function(){if(vt)return Bt.exports;vt=1;var zt=r.e8(),ye=function(){if(Nt)return Mt;Nt=1;var Pt=r.e6(),Ke=r.e7().VectorTileFeature;function Ct(on,Wn){this.options=Wn||{},this.features=on,this.length=on.length}function Qt(on,Wn){this.id=typeof on.id=="number"?on.id:void 0,this.type=on.type,this.rawGeometry=on.type===1?[on.geometry]:on.geometry,this.properties=on.tags,this.extent=Wn||4096}return Mt=Ct,Ct.prototype.feature=function(on){return new Qt(this.features[on],this.options.extent)},Qt.prototype.loadGeometry=function(){var on=this.rawGeometry;this.geometry=[];for(var Wn=0;Wn<on.length;Wn++){for(var er=on[Wn],ar=[],rr=0;rr<er.length;rr++)ar.push(new Pt(er[rr][0],er[rr][1]));this.geometry.push(ar)}return this.geometry},Qt.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var on=this.geometry,Wn=1/0,er=-1/0,ar=1/0,rr=-1/0,$r=0;$r<on.length;$r++)for(var Kr=on[$r],Pr=0;Pr<Kr.length;Pr++){var Zr=Kr[Pr];Wn=Math.min(Wn,Zr.x),er=Math.max(er,Zr.x),ar=Math.min(ar,Zr.y),rr=Math.max(rr,Zr.y)}return[Wn,ar,er,rr]},Qt.prototype.toGeoJSON=Ke.prototype.toGeoJSON,Mt}();function he(Pt){var Ke=new zt;return function(Ct,Qt){for(var on in Ct.layers)Qt.writeMessage(3,Ie,Ct.layers[on])}(Pt,Ke),Ke.finish()}function Ie(Pt,Ke){var Ct;Ke.writeVarintField(15,Pt.version||1),Ke.writeStringField(1,Pt.name||""),Ke.writeVarintField(5,Pt.extent||4096);var Qt={keys:[],values:[],keycache:{},valuecache:{}};for(Ct=0;Ct<Pt.length;Ct++)Qt.feature=Pt.feature(Ct),Ke.writeMessage(2,je,Qt);var on=Qt.keys;for(Ct=0;Ct<on.length;Ct++)Ke.writeStringField(3,on[Ct]);var Wn=Qt.values;for(Ct=0;Ct<Wn.length;Ct++)Ke.writeMessage(4,Dt,Wn[Ct])}function je(Pt,Ke){var Ct=Pt.feature;Ct.id!==void 0&&Ke.writeVarintField(1,Ct.id),Ke.writeMessage(2,Je,Pt),Ke.writeVarintField(3,Ct.type),Ke.writeMessage(4,ht,Ct)}function Je(Pt,Ke){var Ct=Pt.feature,Qt=Pt.keys,on=Pt.values,Wn=Pt.keycache,er=Pt.valuecache;for(var ar in Ct.properties){var rr=Ct.properties[ar],$r=Wn[ar];if(rr!==null){$r===void 0&&(Qt.push(ar),Wn[ar]=$r=Qt.length-1),Ke.writeVarint($r);var Kr=typeof rr;Kr!=="string"&&Kr!=="boolean"&&Kr!=="number"&&(rr=JSON.stringify(rr));var Pr=Kr+":"+rr,Zr=er[Pr];Zr===void 0&&(on.push(rr),er[Pr]=Zr=on.length-1),Ke.writeVarint(Zr)}}}function lt(Pt,Ke){return(Ke<<3)+(7&Pt)}function St(Pt){return Pt<<1^Pt>>31}function ht(Pt,Ke){for(var Ct=Pt.loadGeometry(),Qt=Pt.type,on=0,Wn=0,er=Ct.length,ar=0;ar<er;ar++){var rr=Ct[ar],$r=1;Qt===1&&($r=rr.length),Ke.writeVarint(lt(1,$r));for(var Kr=Qt===3?rr.length-1:rr.length,Pr=0;Pr<Kr;Pr++){Pr===1&&Qt!==1&&Ke.writeVarint(lt(2,Kr-1));var Zr=rr[Pr].x-on,Jr=rr[Pr].y-Wn;Ke.writeVarint(St(Zr)),Ke.writeVarint(St(Jr)),on+=Zr,Wn+=Jr}Qt===3&&Ke.writeVarint(lt(7,1))}}function Dt(Pt,Ke){var Ct=typeof Pt;Ct==="string"?Ke.writeStringField(1,Pt):Ct==="boolean"?Ke.writeBooleanField(7,Pt):Ct==="number"&&(Pt%1!=0?Ke.writeDoubleField(3,Pt):Pt<0?Ke.writeSVarintField(6,Pt):Ke.writeVarintField(5,Pt))}return Bt.exports=he,Bt.exports.fromVectorTileJs=he,Bt.exports.fromGeojsonVt=function(Pt,Ke){Ke=Ke||{};var Ct={};for(var Qt in Pt)Ct[Qt]=new ye(Pt[Qt].features,Ke),Ct[Qt].name=Qt,Ct[Qt].version=Ke.version,Ct[Qt].extent=Ke.extent;return he({layers:Ct})},Bt.exports.GeoJSONWrapper=ye,Bt.exports}(),Fe=r.e9(Wt);const cn={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:zt=>zt},Re=Math.fround||(nt=new Float32Array(1),zt=>(nt[0]=+zt,nt[0]));var nt;const Qe=3,Yt=5,Xt=6;class $t{constructor(ye){this.options=Object.assign(Object.create(cn),ye),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(ye){const{log:he,minZoom:Ie,maxZoom:je}=this.options;he&&console.time("total time");const Je=`prepare ${ye.length} points`;he&&console.time(Je),this.points=ye;const lt=[];for(let ht=0;ht<ye.length;ht++){const Dt=ye[ht];if(!Dt.geometry)continue;const[Pt,Ke]=Dt.geometry.coordinates,Ct=Re(sn(Pt)),Qt=Re(an(Ke));lt.push(Ct,Qt,1/0,ht,-1,1),this.options.reduce&&lt.push(0)}let St=this.trees[je+1]=this._createTree(lt);he&&console.timeEnd(Je);for(let ht=je;ht>=Ie;ht--){const Dt=+Date.now();St=this.trees[ht]=this._createTree(this._cluster(St,ht)),he&&console.log("z%d: %d clusters in %dms",ht,St.numItems,+Date.now()-Dt)}return he&&console.timeEnd("total time"),this}getClusters(ye,he){let Ie=((ye[0]+180)%360+360)%360-180;const je=Math.max(-90,Math.min(90,ye[1]));let Je=ye[2]===180?180:((ye[2]+180)%360+360)%360-180;const lt=Math.max(-90,Math.min(90,ye[3]));if(ye[2]-ye[0]>=360)Ie=-180,Je=180;else if(Ie>Je){const Ke=this.getClusters([Ie,je,180,lt],he),Ct=this.getClusters([-180,je,Je,lt],he);return Ke.concat(Ct)}const St=this.trees[this._limitZoom(he)],ht=St.range(sn(Ie),an(lt),sn(Je),an(je)),Dt=St.data,Pt=[];for(const Ke of ht){const Ct=this.stride*Ke;Pt.push(Dt[Ct+Yt]>1?Ot(Dt,Ct,this.clusterProps):this.points[Dt[Ct+Qe]])}return Pt}getChildren(ye){const he=this._getOriginId(ye),Ie=this._getOriginZoom(ye),je="No cluster with the specified id.",Je=this.trees[Ie];if(!Je)throw new Error(je);const lt=Je.data;if(he*this.stride>=lt.length)throw new Error(je);const St=this.options.radius/(this.options.extent*Math.pow(2,Ie-1)),ht=Je.within(lt[he*this.stride],lt[he*this.stride+1],St),Dt=[];for(const Pt of ht){const Ke=Pt*this.stride;lt[Ke+4]===ye&&Dt.push(lt[Ke+Yt]>1?Ot(lt,Ke,this.clusterProps):this.points[lt[Ke+Qe]])}if(Dt.length===0)throw new Error(je);return Dt}getLeaves(ye,he,Ie){const je=[];return this._appendLeaves(je,ye,he=he||10,Ie=Ie||0,0),je}getTile(ye,he,Ie){const je=this.trees[this._limitZoom(ye)],Je=Math.pow(2,ye),{extent:lt,radius:St}=this.options,ht=St/lt,Dt=(Ie-ht)/Je,Pt=(Ie+1+ht)/Je,Ke={features:[]};return this._addTileFeatures(je.range((he-ht)/Je,Dt,(he+1+ht)/Je,Pt),je.data,he,Ie,Je,Ke),he===0&&this._addTileFeatures(je.range(1-ht/Je,Dt,1,Pt),je.data,Je,Ie,Je,Ke),he===Je-1&&this._addTileFeatures(je.range(0,Dt,ht/Je,Pt),je.data,-1,Ie,Je,Ke),Ke.features.length?Ke:null}getClusterExpansionZoom(ye){let he=this._getOriginZoom(ye)-1;for(;he<=this.options.maxZoom;){const Ie=this.getChildren(ye);if(he++,Ie.length!==1)break;ye=Ie[0].properties.cluster_id}return he}_appendLeaves(ye,he,Ie,je,Je){const lt=this.getChildren(he);for(const St of lt){const ht=St.properties;if(ht&&ht.cluster?Je+ht.point_count<=je?Je+=ht.point_count:Je=this._appendLeaves(ye,ht.cluster_id,Ie,je,Je):Je<je?Je++:ye.push(St),ye.length===Ie)break}return Je}_createTree(ye){const he=new r.bE(ye.length/this.stride|0,this.options.nodeSize,Float32Array);for(let Ie=0;Ie<ye.length;Ie+=this.stride)he.add(ye[Ie],ye[Ie+1]);return he.finish(),he.data=ye,he}_addTileFeatures(ye,he,Ie,je,Je,lt){for(const St of ye){const ht=St*this.stride,Dt=he[ht+Yt]>1;let Pt,Ke,Ct;if(Dt)Pt=Ft(he,ht,this.clusterProps),Ke=he[ht],Ct=he[ht+1];else{const Wn=this.points[he[ht+Qe]];Pt=Wn.properties;const[er,ar]=Wn.geometry.coordinates;Ke=sn(er),Ct=an(ar)}const Qt={type:1,geometry:[[Math.round(this.options.extent*(Ke*Je-Ie)),Math.round(this.options.extent*(Ct*Je-je))]],tags:Pt};let on;on=Dt||this.options.generateId?he[ht+Qe]:this.points[he[ht+Qe]].id,on!==void 0&&(Qt.id=on),lt.features.push(Qt)}}_limitZoom(ye){return Math.max(this.options.minZoom,Math.min(Math.floor(+ye),this.options.maxZoom+1))}_cluster(ye,he){const{radius:Ie,extent:je,reduce:Je,minPoints:lt}=this.options,St=Ie/(je*Math.pow(2,he)),ht=ye.data,Dt=[],Pt=this.stride;for(let Ke=0;Ke<ht.length;Ke+=Pt){if(ht[Ke+2]<=he)continue;ht[Ke+2]=he;const Ct=ht[Ke],Qt=ht[Ke+1],on=ye.within(ht[Ke],ht[Ke+1],St),Wn=ht[Ke+Yt];let er=Wn;for(const ar of on){const rr=ar*Pt;ht[rr+2]>he&&(er+=ht[rr+Yt])}if(er>Wn&&er>=lt){let ar,rr=Ct*Wn,$r=Qt*Wn,Kr=-1;const Pr=(Ke/Pt<<5)+(he+1)+this.points.length;for(const Zr of on){const Jr=Zr*Pt;if(ht[Jr+2]<=he)continue;ht[Jr+2]=he;const fi=ht[Jr+Yt];rr+=ht[Jr]*fi,$r+=ht[Jr+1]*fi,ht[Jr+4]=Pr,Je&&(ar||(ar=this._map(ht,Ke,!0),Kr=this.clusterProps.length,this.clusterProps.push(ar)),Je(ar,this._map(ht,Jr)))}ht[Ke+4]=Pr,Dt.push(rr/er,$r/er,1/0,Pr,-1,er),Je&&Dt.push(Kr)}else{for(let ar=0;ar<Pt;ar++)Dt.push(ht[Ke+ar]);if(er>1)for(const ar of on){const rr=ar*Pt;if(!(ht[rr+2]<=he)){ht[rr+2]=he;for(let $r=0;$r<Pt;$r++)Dt.push(ht[rr+$r])}}}}return Dt}_getOriginId(ye){return ye-this.points.length>>5}_getOriginZoom(ye){return(ye-this.points.length)%32}_map(ye,he,Ie){if(ye[he+Yt]>1){const lt=this.clusterProps[ye[he+Xt]];return Ie?Object.assign({},lt):lt}const je=this.points[ye[he+Qe]].properties,Je=this.options.map(je);return Ie&&Je===je?Object.assign({},Je):Je}}function Ot(zt,ye,he){return{type:"Feature",id:zt[ye+Qe],properties:Ft(zt,ye,he),geometry:{type:"Point",coordinates:[(Ie=zt[ye],360*(Ie-.5)),Pn(zt[ye+1])]}};var Ie}function Ft(zt,ye,he){const Ie=zt[ye+Yt],je=Ie>=1e4?`${Math.round(Ie/1e3)}k`:Ie>=1e3?Math.round(Ie/100)/10+"k":Ie,Je=zt[ye+Xt],lt=Je===-1?{}:Object.assign({},he[Je]);return Object.assign(lt,{cluster:!0,cluster_id:zt[ye+Qe],point_count:Ie,point_count_abbreviated:je})}function sn(zt){return zt/360+.5}function an(zt){const ye=Math.sin(zt*Math.PI/180),he=.5-.25*Math.log((1+ye)/(1-ye))/Math.PI;return he<0?0:he>1?1:he}function Pn(zt){const ye=(180-360*zt)*Math.PI/180;return 360*Math.atan(Math.exp(ye))/Math.PI-90}function bn(zt,ye,he,Ie){let je=Ie;const Je=ye+(he-ye>>1);let lt,St=he-ye;const ht=zt[ye],Dt=zt[ye+1],Pt=zt[he],Ke=zt[he+1];for(let Ct=ye+3;Ct<he;Ct+=3){const Qt=It(zt[Ct],zt[Ct+1],ht,Dt,Pt,Ke);if(Qt>je)lt=Ct,je=Qt;else if(Qt===je){const on=Math.abs(Ct-Je);on<St&&(lt=Ct,St=on)}}je>Ie&&(lt-ye>3&&bn(zt,ye,lt,Ie),zt[lt+2]=je,he-lt>3&&bn(zt,lt,he,Ie))}function It(zt,ye,he,Ie,je,Je){let lt=je-he,St=Je-Ie;if(lt!==0||St!==0){const ht=((zt-he)*lt+(ye-Ie)*St)/(lt*lt+St*St);ht>1?(he=je,Ie=Je):ht>0&&(he+=lt*ht,Ie+=St*ht)}return lt=zt-he,St=ye-Ie,lt*lt+St*St}function Sn(zt,ye,he,Ie){const je={id:zt??null,type:ye,geometry:he,tags:Ie,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(ye==="Point"||ye==="MultiPoint"||ye==="LineString")Yn(je,he);else if(ye==="Polygon")Yn(je,he[0]);else if(ye==="MultiLineString")for(const Je of he)Yn(je,Je);else if(ye==="MultiPolygon")for(const Je of he)Yn(je,Je[0]);return je}function Yn(zt,ye){for(let he=0;he<ye.length;he+=3)zt.minX=Math.min(zt.minX,ye[he]),zt.minY=Math.min(zt.minY,ye[he+1]),zt.maxX=Math.max(zt.maxX,ye[he]),zt.maxY=Math.max(zt.maxY,ye[he+1])}function vr(zt,ye,he,Ie){if(!ye.geometry)return;const je=ye.geometry.coordinates;if(je&&je.length===0)return;const Je=ye.geometry.type,lt=Math.pow(he.tolerance/((1<<he.maxZoom)*he.extent),2);let St=[],ht=ye.id;if(he.promoteId?ht=ye.properties[he.promoteId]:he.generateId&&(ht=Ie||0),Je==="Point")tr(je,St);else if(Je==="MultiPoint")for(const Dt of je)tr(Dt,St);else if(Je==="LineString")zr(je,St,lt,!1);else if(Je==="MultiLineString"){if(he.lineMetrics){for(const Dt of je)St=[],zr(Dt,St,lt,!1),zt.push(Sn(ht,"LineString",St,ye.properties));return}Cr(je,St,lt,!1)}else if(Je==="Polygon")Cr(je,St,lt,!0);else{if(Je!=="MultiPolygon"){if(Je==="GeometryCollection"){for(const Dt of ye.geometry.geometries)vr(zt,{id:ht,geometry:Dt,properties:ye.properties},he,Ie);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const Dt of je){const Pt=[];Cr(Dt,Pt,lt,!0),St.push(Pt)}}zt.push(Sn(ht,Je,St,ye.properties))}function tr(zt,ye){ye.push(Io(zt[0]),jn(zt[1]),0)}function zr(zt,ye,he,Ie){let je,Je,lt=0;for(let ht=0;ht<zt.length;ht++){const Dt=Io(zt[ht][0]),Pt=jn(zt[ht][1]);ye.push(Dt,Pt,0),ht>0&&(lt+=Ie?(je*Pt-Dt*Je)/2:Math.sqrt(Math.pow(Dt-je,2)+Math.pow(Pt-Je,2))),je=Dt,Je=Pt}const St=ye.length-3;ye[2]=1,bn(ye,0,St,he),ye[St+2]=1,ye.size=Math.abs(lt),ye.start=0,ye.end=ye.size}function Cr(zt,ye,he,Ie){for(let je=0;je<zt.length;je++){const Je=[];zr(zt[je],Je,he,Ie),ye.push(Je)}}function Io(zt){return zt/360+.5}function jn(zt){const ye=Math.sin(zt*Math.PI/180),he=.5-.25*Math.log((1+ye)/(1-ye))/Math.PI;return he<0?0:he>1?1:he}function Gt(zt,ye,he,Ie,je,Je,lt,St){if(Ie/=ye,Je>=(he/=ye)&&lt<Ie)return zt;if(lt<he||Je>=Ie)return null;const ht=[];for(const Dt of zt){const Pt=Dt.geometry;let Ke=Dt.type;const Ct=je===0?Dt.minX:Dt.minY,Qt=je===0?Dt.maxX:Dt.maxY;if(Ct>=he&&Qt<Ie){ht.push(Dt);continue}if(Qt<he||Ct>=Ie)continue;let on=[];if(Ke==="Point"||Ke==="MultiPoint")ct(Pt,on,he,Ie,je);else if(Ke==="LineString")Ut(Pt,on,he,Ie,je,!1,St.lineMetrics);else if(Ke==="MultiLineString")yn(Pt,on,he,Ie,je,!1);else if(Ke==="Polygon")yn(Pt,on,he,Ie,je,!0);else if(Ke==="MultiPolygon")for(const Wn of Pt){const er=[];yn(Wn,er,he,Ie,je,!0),er.length&&on.push(er)}if(on.length){if(St.lineMetrics&&Ke==="LineString"){for(const Wn of on)ht.push(Sn(Dt.id,Ke,Wn,Dt.tags));continue}Ke!=="LineString"&&Ke!=="MultiLineString"||(on.length===1?(Ke="LineString",on=on[0]):Ke="MultiLineString"),Ke!=="Point"&&Ke!=="MultiPoint"||(Ke=on.length===3?"Point":"MultiPoint"),ht.push(Sn(Dt.id,Ke,on,Dt.tags))}}return ht.length?ht:null}function ct(zt,ye,he,Ie,je){for(let Je=0;Je<zt.length;Je+=3){const lt=zt[Je+je];lt>=he&&lt<=Ie&&wn(ye,zt[Je],zt[Je+1],zt[Je+2])}}function Ut(zt,ye,he,Ie,je,Je,lt){let St=tt(zt);const ht=je===0?sr:vo;let Dt,Pt,Ke=zt.start;for(let er=0;er<zt.length-3;er+=3){const ar=zt[er],rr=zt[er+1],$r=zt[er+2],Kr=zt[er+3],Pr=zt[er+4],Zr=je===0?ar:rr,Jr=je===0?Kr:Pr;let fi=!1;lt&&(Dt=Math.sqrt(Math.pow(ar-Kr,2)+Math.pow(rr-Pr,2))),Zr<he?Jr>he&&(Pt=ht(St,ar,rr,Kr,Pr,he),lt&&(St.start=Ke+Dt*Pt)):Zr>Ie?Jr<Ie&&(Pt=ht(St,ar,rr,Kr,Pr,Ie),lt&&(St.start=Ke+Dt*Pt)):wn(St,ar,rr,$r),Jr<he&&Zr>=he&&(Pt=ht(St,ar,rr,Kr,Pr,he),fi=!0),Jr>Ie&&Zr<=Ie&&(Pt=ht(St,ar,rr,Kr,Pr,Ie),fi=!0),!Je&&fi&&(lt&&(St.end=Ke+Dt*Pt),ye.push(St),St=tt(zt)),lt&&(Ke+=Dt)}let Ct=zt.length-3;const Qt=zt[Ct],on=zt[Ct+1],Wn=je===0?Qt:on;Wn>=he&&Wn<=Ie&&wn(St,Qt,on,zt[Ct+2]),Ct=St.length-3,Je&&Ct>=3&&(St[Ct]!==St[0]||St[Ct+1]!==St[1])&&wn(St,St[0],St[1],St[2]),St.length&&ye.push(St)}function tt(zt){const ye=[];return ye.size=zt.size,ye.start=zt.start,ye.end=zt.end,ye}function yn(zt,ye,he,Ie,je,Je){for(const lt of zt)Ut(lt,ye,he,Ie,je,Je,!1)}function wn(zt,ye,he,Ie){zt.push(ye,he,Ie)}function sr(zt,ye,he,Ie,je,Je){const lt=(Je-ye)/(Ie-ye);return wn(zt,Je,he+(je-he)*lt,1),lt}function vo(zt,ye,he,Ie,je,Je){const lt=(Je-he)/(je-he);return wn(zt,ye+(Ie-ye)*lt,Je,1),lt}function jo(zt,ye){const he=[];for(let Ie=0;Ie<zt.length;Ie++){const je=zt[Ie],Je=je.type;let lt;if(Je==="Point"||Je==="MultiPoint"||Je==="LineString")lt=Go(je.geometry,ye);else if(Je==="MultiLineString"||Je==="Polygon"){lt=[];for(const St of je.geometry)lt.push(Go(St,ye))}else if(Je==="MultiPolygon"){lt=[];for(const St of je.geometry){const ht=[];for(const Dt of St)ht.push(Go(Dt,ye));lt.push(ht)}}he.push(Sn(je.id,Je,lt,je.tags))}return he}function Go(zt,ye){const he=[];he.size=zt.size,zt.start!==void 0&&(he.start=zt.start,he.end=zt.end);for(let Ie=0;Ie<zt.length;Ie+=3)he.push(zt[Ie]+ye,zt[Ie+1],zt[Ie+2]);return he}function bo(zt,ye){if(zt.transformed)return zt;const he=1<<zt.z,Ie=zt.x,je=zt.y;for(const Je of zt.features){const lt=Je.geometry,St=Je.type;if(Je.geometry=[],St===1)for(let ht=0;ht<lt.length;ht+=2)Je.geometry.push(oi(lt[ht],lt[ht+1],ye,he,Ie,je));else for(let ht=0;ht<lt.length;ht++){const Dt=[];for(let Pt=0;Pt<lt[ht].length;Pt+=2)Dt.push(oi(lt[ht][Pt],lt[ht][Pt+1],ye,he,Ie,je));Je.geometry.push(Dt)}}return zt.transformed=!0,zt}function oi(zt,ye,he,Ie,je,Je){return[Math.round(he*(zt*Ie-je)),Math.round(he*(ye*Ie-Je))]}function mo(zt,ye,he,Ie,je){const Je=ye===je.maxZoom?0:je.tolerance/((1<<ye)*je.extent),lt={features:[],numPoints:0,numSimplified:0,numFeatures:zt.length,source:null,x:he,y:Ie,z:ye,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const St of zt)Fi(lt,St,Je,je);return lt}function Fi(zt,ye,he,Ie){const je=ye.geometry,Je=ye.type,lt=[];if(zt.minX=Math.min(zt.minX,ye.minX),zt.minY=Math.min(zt.minY,ye.minY),zt.maxX=Math.max(zt.maxX,ye.maxX),zt.maxY=Math.max(zt.maxY,ye.maxY),Je==="Point"||Je==="MultiPoint")for(let St=0;St<je.length;St+=3)lt.push(je[St],je[St+1]),zt.numPoints++,zt.numSimplified++;else if(Je==="LineString")Gs(lt,je,zt,he,!1,!1);else if(Je==="MultiLineString"||Je==="Polygon")for(let St=0;St<je.length;St++)Gs(lt,je[St],zt,he,Je==="Polygon",St===0);else if(Je==="MultiPolygon")for(let St=0;St<je.length;St++){const ht=je[St];for(let Dt=0;Dt<ht.length;Dt++)Gs(lt,ht[Dt],zt,he,!0,Dt===0)}if(lt.length){let St=ye.tags||null;if(Je==="LineString"&&Ie.lineMetrics){St={};for(const Dt in ye.tags)St[Dt]=ye.tags[Dt];St.mapbox_clip_start=je.start/je.size,St.mapbox_clip_end=je.end/je.size}const ht={geometry:lt,type:Je==="Polygon"||Je==="MultiPolygon"?3:Je==="LineString"||Je==="MultiLineString"?2:1,tags:St};ye.id!==null&&(ht.id=ye.id),zt.features.push(ht)}}function Gs(zt,ye,he,Ie,je,Je){const lt=Ie*Ie;if(Ie>0&&ye.size<(je?lt:Ie))return void(he.numPoints+=ye.length/3);const St=[];for(let ht=0;ht<ye.length;ht+=3)(Ie===0||ye[ht+2]>lt)&&(he.numSimplified++,St.push(ye[ht],ye[ht+1])),he.numPoints++;je&&function(ht,Dt){let Pt=0;for(let Ke=0,Ct=ht.length,Qt=Ct-2;Ke<Ct;Qt=Ke,Ke+=2)Pt+=(ht[Ke]-ht[Qt])*(ht[Ke+1]+ht[Qt+1]);if(Pt>0===Dt)for(let Ke=0,Ct=ht.length;Ke<Ct/2;Ke+=2){const Qt=ht[Ke],on=ht[Ke+1];ht[Ke]=ht[Ct-2-Ke],ht[Ke+1]=ht[Ct-1-Ke],ht[Ct-2-Ke]=Qt,ht[Ct-1-Ke]=on}}(St,Je),zt.push(St)}const kl={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class ga{constructor(ye,he){const Ie=(he=this.options=function(Je,lt){for(const St in lt)Je[St]=lt[St];return Je}(Object.create(kl),he)).debug;if(Ie&&console.time("preprocess data"),he.maxZoom<0||he.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(he.promoteId&&he.generateId)throw new Error("promoteId and generateId cannot be used together.");let je=function(Je,lt){const St=[];if(Je.type==="FeatureCollection")for(let ht=0;ht<Je.features.length;ht++)vr(St,Je.features[ht],lt,ht);else vr(St,Je.type==="Feature"?Je:{geometry:Je},lt);return St}(ye,he);this.tiles={},this.tileCoords=[],Ie&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",he.indexMaxZoom,he.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),je=function(Je,lt){const St=lt.buffer/lt.extent;let ht=Je;const Dt=Gt(Je,1,-1-St,St,0,-1,2,lt),Pt=Gt(Je,1,1-St,2+St,0,-1,2,lt);return(Dt||Pt)&&(ht=Gt(Je,1,-St,1+St,0,-1,2,lt)||[],Dt&&(ht=jo(Dt,1).concat(ht)),Pt&&(ht=ht.concat(jo(Pt,-1)))),ht}(je,he),je.length&&this.splitTile(je,0,0,0),Ie&&(je.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(ye,he,Ie,je,Je,lt,St){const ht=[ye,he,Ie,je],Dt=this.options,Pt=Dt.debug;for(;ht.length;){je=ht.pop(),Ie=ht.pop(),he=ht.pop(),ye=ht.pop();const Ke=1<<he,Ct=Jo(he,Ie,je);let Qt=this.tiles[Ct];if(!Qt&&(Pt>1&&console.time("creation"),Qt=this.tiles[Ct]=mo(ye,he,Ie,je,Dt),this.tileCoords.push({z:he,x:Ie,y:je}),Pt)){Pt>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",he,Ie,je,Qt.numFeatures,Qt.numPoints,Qt.numSimplified),console.timeEnd("creation"));const fi=`z${he}`;this.stats[fi]=(this.stats[fi]||0)+1,this.total++}if(Qt.source=ye,Je==null){if(he===Dt.indexMaxZoom||Qt.numPoints<=Dt.indexMaxPoints)continue}else{if(he===Dt.maxZoom||he===Je)continue;if(Je!=null){const fi=Je-he;if(Ie!==lt>>fi||je!==St>>fi)continue}}if(Qt.source=null,ye.length===0)continue;Pt>1&&console.time("clipping");const on=.5*Dt.buffer/Dt.extent,Wn=.5-on,er=.5+on,ar=1+on;let rr=null,$r=null,Kr=null,Pr=null,Zr=Gt(ye,Ke,Ie-on,Ie+er,0,Qt.minX,Qt.maxX,Dt),Jr=Gt(ye,Ke,Ie+Wn,Ie+ar,0,Qt.minX,Qt.maxX,Dt);ye=null,Zr&&(rr=Gt(Zr,Ke,je-on,je+er,1,Qt.minY,Qt.maxY,Dt),$r=Gt(Zr,Ke,je+Wn,je+ar,1,Qt.minY,Qt.maxY,Dt),Zr=null),Jr&&(Kr=Gt(Jr,Ke,je-on,je+er,1,Qt.minY,Qt.maxY,Dt),Pr=Gt(Jr,Ke,je+Wn,je+ar,1,Qt.minY,Qt.maxY,Dt),Jr=null),Pt>1&&console.timeEnd("clipping"),ht.push(rr||[],he+1,2*Ie,2*je),ht.push($r||[],he+1,2*Ie,2*je+1),ht.push(Kr||[],he+1,2*Ie+1,2*je),ht.push(Pr||[],he+1,2*Ie+1,2*je+1)}}getTile(ye,he,Ie){ye=+ye,he=+he,Ie=+Ie;const je=this.options,{extent:Je,debug:lt}=je;if(ye<0||ye>24)return null;const St=1<<ye,ht=Jo(ye,he=he+St&St-1,Ie);if(this.tiles[ht])return bo(this.tiles[ht],Je);lt>1&&console.log("drilling down to z%d-%d-%d",ye,he,Ie);let Dt,Pt=ye,Ke=he,Ct=Ie;for(;!Dt&&Pt>0;)Pt--,Ke>>=1,Ct>>=1,Dt=this.tiles[Jo(Pt,Ke,Ct)];return Dt&&Dt.source?(lt>1&&(console.log("found parent tile z%d-%d-%d",Pt,Ke,Ct),console.time("drilling down")),this.splitTile(Dt.source,Pt,Ke,Ct,ye,he,Ie),lt>1&&console.timeEnd("drilling down"),this.tiles[ht]?bo(this.tiles[ht],Je):null):null}}function Jo(zt,ye,he){return 32*((1<<zt)*he+ye)+zt}function va(zt,ye){const he=zt.tileID.canonical;if(!this._geoJSONIndex)return void ye(null,null);const Ie=this._geoJSONIndex.getTile(he.z,he.x,he.y);if(!Ie)return void ye(null,null);const je=new We(Ie.features);let Je=Fe(je);Je.byteOffset===0&&Je.byteLength===Je.buffer.byteLength||(Je=new Uint8Array(Je)),ye(null,{vectorTile:je,rawData:Je.buffer})}class vc extends ce{constructor(ye,he,Ie,je,Je,lt){super(ye,he,Ie,je,va,lt),Je&&(this.loadGeoJSON=Je),this._dynamicIndex=new Me}loadData(ye,he){const Ie=ye&&ye.request,je=Ie&&Ie.collectResourceTiming;this.loadGeoJSON(ye,(Je,lt)=>{if(Je||!lt)return he(Je);if(typeof lt!="object")return he(new Error(`Input data given to '${ye.source}' is not a valid GeoJSON object.`));{try{if(ye.filter){const ht=r.U(ye.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(ht.result==="error")throw new Error(ht.value.map(Dt=>`${Dt.key}: ${Dt.message}`).join(", "));lt.features=lt.features.filter(Dt=>ht.value.evaluate({zoom:0},Dt))}ye.dynamic?(lt.type==="Feature"&&(lt={type:"FeatureCollection",features:[lt]}),ye.append||(this._dynamicIndex.clear(),this.loaded={}),this._dynamicIndex.load(lt.features,this.loaded),ye.cluster&&(lt.features=this._dynamicIndex.getFeatures())):this.loaded={},this._geoJSONIndex=ye.cluster?new $t(function({superclusterOptions:ht,clusterProperties:Dt}){if(!Dt||!ht)return ht;const Pt={},Ke={},Ct={accumulated:null,zoom:0},Qt={properties:null},on=Object.keys(Dt);for(const Wn of on){const[er,ar]=Dt[Wn],rr=r.U(ar),$r=r.U(typeof er=="string"?[er,["accumulated"],["get",Wn]]:er);Pt[Wn]=rr.value,Ke[Wn]=$r.value}return ht.map=Wn=>{Qt.properties=Wn;const er={};for(const ar of on)er[ar]=Pt[ar].evaluate(Ct,Qt);return er},ht.reduce=(Wn,er)=>{Qt.properties=er;for(const ar of on)Ct.accumulated=Wn[ar],Wn[ar]=Ke[ar].evaluate(Ct,Qt)},ht}(ye)).load(lt.features):ye.dynamic?this._dynamicIndex:function(ht,Dt){return new ga(ht,Dt)}(lt,ye.geojsonVtOptions)}catch(ht){return he(ht)}const St={};if(je){const ht=S(Ie);ht&&(St.resourceTiming={},St.resourceTiming[ye.source]=JSON.parse(JSON.stringify(ht)))}he(null,St)}})}reloadTile(ye,he){const Ie=this.loaded;return Ie&&Ie[ye.uid]?ye.partial?he(null,void 0):super.reloadTile(ye,he):this.loadTile(ye,he)}loadGeoJSON(ye,he){if(ye.request)r.n(ye.request,he);else{if(typeof ye.data!="string")return he(new Error(`Input data given to '${ye.source}' is not a valid GeoJSON object.`));try{return he(null,JSON.parse(ye.data))}catch{return he(new Error(`Input data given to '${ye.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(ye,he){try{he(null,this._geoJSONIndex.getClusterExpansionZoom(ye.clusterId))}catch(Ie){he(Ie)}}getClusterChildren(ye,he){try{he(null,this._geoJSONIndex.getChildren(ye.clusterId))}catch(Ie){he(Ie)}}getClusterLeaves(ye,he){try{he(null,this._geoJSONIndex.getLeaves(ye.clusterId,ye.limit,ye.offset))}catch(Ie){he(Ie)}}}class Qa{constructor(ye,he){this.tileID=new r.aG(ye.tileID.overscaledZ,ye.tileID.wrap,ye.tileID.canonical.z,ye.tileID.canonical.x,ye.tileID.canonical.y),this.tileZoom=ye.tileZoom,this.uid=ye.uid,this.zoom=ye.zoom,this.canonical=ye.tileID.canonical,this.pixelRatio=ye.pixelRatio,this.tileSize=ye.tileSize,this.source=ye.source,this.overscaling=this.tileID.overscaleFactor(),this.projection=ye.projection,this.brightness=he}parse(ye,he,Ie,je){this.status="parsing";const Je=new r.aG(Ie.tileID.overscaledZ,Ie.tileID.wrap,Ie.tileID.canonical.z,Ie.tileID.canonical.x,Ie.tileID.canonical.y),lt=[],St=he.familiesBySource[Ie.source],ht=new r.d$(Je,Ie.promoteId);return ht.bucketLayerIDs=[],ht.is3DTile=!0,r.ea(ye).then(Dt=>{if(!Dt)return je(new Error("Could not parse tile"));const Pt=r.eb(Dt,1/r.cc(Ie.tileID.canonical)),Ke=Dt.json.extensionsUsed&&Dt.json.extensionsUsed.includes("MAPBOX_mesh_features")||Dt.json.asset.extras&&Dt.json.asset.extras.MAPBOX_mesh_features,Ct=Dt.json.extensionsUsed&&Dt.json.extensionsUsed.includes("EXT_meshopt_compression"),Qt=new r.a8(this.zoom,{brightness:this.brightness});for(const on in St)for(const Wn of St[on]){const er=Wn[0];ht.bucketLayerIDs.push(Wn.map(rr=>r.aC(rr.id,rr.scope))),er.recalculate(Qt,[]);const ar=new r.ec(Wn,Pt,Je,Ke,Ct,this.brightness,ht);Ke||(ar.needsUpload=!0),lt.push(ar),ar.evaluate(er)}this.status="done",je(null,{buckets:lt,featureIndex:ht,collisionBoxArray:null,glyphAtlasImage:null,lineAtlas:null,imageAtlas:null,brightness:null})}).catch(Dt=>je(new Error(Dt.message)))}}class Ci{constructor(ye,he,Ie,je,Je,lt){this.actor=ye,this.layerIndex=he,this.availableImages=Ie,this.brightness=lt,this.loading={},this.loaded={}}loadTile(ye,he){const Ie=ye.uid,je=this.loading[Ie]=new Qa(ye,this.brightness);r.bi(ye.request,(Je,lt)=>{const St=!this.loading[Ie];return delete this.loading[Ie],St||Je?(je.status="done",St||(this.loaded[Ie]=je),he(Je)):lt&&lt.byteLength!==0?void je.parse(lt,this.layerIndex,ye,(ht,Dt)=>{je.status="done",this.loaded=this.loaded||{},this.loaded[Ie]=je,ht||!Dt?he(ht):he(null,Dt)}):(je.status="done",this.loaded[Ie]=je,he())})}reloadTile(ye,he){const Ie=this.loaded,je=ye.uid;if(Ie&&Ie[je]){const Je=Ie[je];Je.projection=ye.projection,Je.brightness=ye.brightness;const lt=(St,ht)=>{Je.reloadCallback&&(delete Je.reloadCallback,this.loadTile(ye,he)),he(St,ht)};Je.status==="parsing"?Je.reloadCallback=lt:Je.status==="done"&&this.loadTile(ye,he)}}abortTile(ye,he){const Ie=ye.uid;this.loading[Ie]&&delete this.loading[Ie],he()}removeTile(ye,he){const Ie=this.loaded,je=ye.uid;Ie&&Ie[je]&&delete Ie[je],he()}}class Ps{constructor(ye){this.self=ye,this.actor=new r.ed(ye,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.imageRasterizer=new r.I,this.projections={},this.defaultProjection=r.bP({name:"mercator"}),this.workerSourceTypes={vector:ce,geojson:vc,"batched-model":Ci},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(he,Ie)=>{if(this.workerSourceTypes[he])throw new Error(`Worker source with name "${he}" already registered.`);this.workerSourceTypes[he]=Ie},this.self.registerRTLTextPlugin=he=>{if(r.ee.isParsed())throw new Error("RTL text plugin already registered.");r.ee.applyArabicShaping=he.applyArabicShaping,r.ee.processBidirectionalText=he.processBidirectionalText,r.ee.processStyledBidirectionalText=he.processStyledBidirectionalText}}clearCaches(ye,he,Ie){delete this.layerIndexes[ye],delete this.availableImages[ye],delete this.workerSources[ye],delete this.demWorkerSources[ye],delete this.rasterArrayWorkerSource,Ie()}checkIfReady(ye,he,Ie){Ie()}setReferrer(ye,he){this.referrer=he}spriteLoaded(ye,{scope:he,isLoaded:Ie}){if(this.isSpriteLoaded[ye]||(this.isSpriteLoaded[ye]={}),this.isSpriteLoaded[ye][he]=Ie,this.workerSources[ye]&&this.workerSources[ye][he])for(const je in this.workerSources[ye][he]){const Je=this.workerSources[ye][he][je];for(const lt in Je){const St=Je[lt];St instanceof ce&&(St.isSpriteLoaded=Ie,St.fire(new r.z("isSpriteLoaded")))}}}setImages(ye,{scope:he,images:Ie},je){if(this.availableImages[ye]||(this.availableImages[ye]={}),this.availableImages[ye][he]=Ie,this.workerSources[ye]&&this.workerSources[ye][he]){for(const Je in this.workerSources[ye][he]){const lt=this.workerSources[ye][he][Je];for(const St in lt)lt[St].availableImages=Ie}je()}else je()}setProjection(ye,he){this.projections[ye]=r.bP(he)}setBrightness(ye,he,Ie){this.brightness=he,Ie()}setLayers(ye,he,Ie){this.getLayerIndex(ye,he.scope).replace(he.layers,he.options),Ie()}updateLayers(ye,he,Ie){this.getLayerIndex(ye,he.scope).update(he.layers,he.removedIds,he.options),Ie()}loadTile(ye,he,Ie){he.projection=this.projections[ye]||this.defaultProjection,this.getWorkerSource(ye,he.type,he.source,he.scope).loadTile(he,Ie)}loadDEMTile(ye,he,Ie){this.getDEMWorkerSource(ye,he.source,he.scope).loadTile(he,Ie)}decodeRasterArray(ye,he,Ie){this.getRasterArrayWorkerSource().decodeRasterArray(he,Ie)}reloadTile(ye,he,Ie){he.projection=this.projections[ye]||this.defaultProjection,this.getWorkerSource(ye,he.type,he.source,he.scope).reloadTile(he,Ie)}abortTile(ye,he,Ie){this.getWorkerSource(ye,he.type,he.source,he.scope).abortTile(he,Ie)}removeTile(ye,he,Ie){this.getWorkerSource(ye,he.type,he.source,he.scope).removeTile(he,Ie)}removeSource(ye,he,Ie){if(!(this.workerSources[ye]&&this.workerSources[ye][he.scope]&&this.workerSources[ye][he.scope][he.type]&&this.workerSources[ye][he.scope][he.type][he.source]))return;const je=this.workerSources[ye][he.scope][he.type][he.source];delete this.workerSources[ye][he.scope][he.type][he.source],je.removeSource!==void 0?je.removeSource(he,Ie):Ie()}loadWorkerSource(ye,he,Ie){try{this.self.importScripts(he.url),Ie()}catch(je){Ie(je.toString())}}syncRTLPluginState(ye,he,Ie){try{r.ee.setState(he);const je=r.ee.getPluginURL();if(r.ee.isLoaded()&&!r.ee.isParsed()&&je!=null){this.self.importScripts(je);const Je=r.ee.isParsed();Ie(Je?void 0:new Error(`RTL Text Plugin failed to import scripts from ${je}`),Je)}}catch(je){Ie(je.toString())}}setDracoUrl(ye,he){this.dracoUrl=he}getAvailableImages(ye,he){this.availableImages[ye]||(this.availableImages[ye]={});let Ie=this.availableImages[ye][he];return Ie||(Ie=[]),Ie}getLayerIndex(ye,he){this.layerIndexes[ye]||(this.layerIndexes[ye]={});let Ie=this.layerIndexes[ye][he];return Ie||(Ie=this.layerIndexes[ye][he]=new k,Ie.scope=he),Ie}getWorkerSource(ye,he,Ie,je){return this.workerSources[ye]||(this.workerSources[ye]={}),this.workerSources[ye][je]||(this.workerSources[ye][je]={}),this.workerSources[ye][je][he]||(this.workerSources[ye][je][he]={}),this.isSpriteLoaded[ye]||(this.isSpriteLoaded[ye]={}),this.workerSources[ye][je][he][Ie]||(this.workerSources[ye][je][he][Ie]=new this.workerSourceTypes[he]({send:(Je,lt,St,ht,Dt,Pt)=>{this.actor.send(Je,lt,St,ye,Dt,Pt)},scheduler:this.actor.scheduler},this.getLayerIndex(ye,je),this.getAvailableImages(ye,je),this.isSpriteLoaded[ye][je],void 0,this.brightness)),this.workerSources[ye][je][he][Ie]}rasterizeImages(ye,he,Ie){const{imageTasks:je,scope:Je}=he,lt={};for(const St in je){const{image:ht,imageIdWithOptions:Dt}=je[St];lt[St]=this.imageRasterizer.rasterize(Dt,ht,Je,ye)}Ie(void 0,lt)}removeRasterizedImages(ye,he,Ie){const{imageIds:je,scope:Je}=he;this.imageRasterizer.removeImagesFromCacheByIds(je,Je,ye),Ie()}getDEMWorkerSource(ye,he,Ie){return this.demWorkerSources[ye]||(this.demWorkerSources[ye]={}),this.demWorkerSources[ye][Ie]||(this.demWorkerSources[ye][Ie]={}),this.demWorkerSources[ye][Ie][he]||(this.demWorkerSources[ye][Ie][he]=new le),this.demWorkerSources[ye][Ie][he]}getRasterArrayWorkerSource(){return this.rasterArrayWorkerSource||(this.rasterArrayWorkerSource=new ge),this.rasterArrayWorkerSource}enforceCacheSizeLimit(ye,he){r.ef(he)}getWorkerPerformanceMetrics(ye,he,Ie){Ie(void 0,void 0)}}return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new Ps(self)),Ps}),p(["./shared"],function(r){var S="3.10.0";const C={create:"create",load:"load",fullLoad:"fullLoad"},M={mark(f){performance.mark(f)},measure(f,o,l){performance.measure(f,o,l)}};function k(f){const o=f.name.split("?")[0];return r.a(o)&&o.includes("mapbox-gl.js")?"javascript":r.a(o)&&o.includes("mapbox-gl.css")?"css":r.b(o)?"fontRange":r.c(o)?"sprite":r.i(o)?"style":r.d(o)?"tilejson":"other"}var z,F={},B=function(){if(z)return F;function f(m){return!o(m)}function o(m){return typeof window>"u"||typeof document>"u"?"not a browser":function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var w,E,O=new Blob([""],{type:"text/javascript"}),$=URL.createObjectURL(O);try{E=new Worker($),w=!0}catch{w=!1}return E&&E.terminate(),URL.revokeObjectURL($),w}()?function(){var w=document.createElement("canvas");w.width=w.height=1;var E=w.getContext("2d");if(!E)return!1;var O=E.getImageData(0,0,1,1);return O&&O.width===w.width}()?(l[y=m&&m.failIfMajorPerformanceCaveat]===void 0&&(l[y]=function(w){var E,O=function($){var H=document.createElement("canvas"),G=Object.create(f.webGLContextAttributes);return G.failIfMajorPerformanceCaveat=$,H.getContext("webgl2",G)}(w);if(!O)return!1;try{E=O.createShader(O.VERTEX_SHADER)}catch{return!1}return!(!E||O.isContextLost())&&(O.shaderSource(E,"void main() {}"),O.compileShader(E),O.getShaderParameter(E,O.COMPILE_STATUS)===!0)}(y)),l[y]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL2 support"):"insufficient Canvas/getImageData support":"insufficient worker support";var y}z=1,F.supported=f,F.notSupportedReason=o;var l={};return f.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0},F}();function N(f,o,l){const m=document.createElement(f);return o!=null&&(m.className=o),l&&l.appendChild(m),m}function j(f,o,l){const m=document.createElementNS("http://www.w3.org/2000/svg",f);for(const y of Object.keys(o))m.setAttributeNS(null,y,String(o[y]));return l&&l.appendChild(m),m}const U=typeof document<"u"?document.documentElement&&document.documentElement.style:null,te=U&&U.userSelect!==void 0?"userSelect":"WebkitUserSelect";let Y;function q(){U&&te&&(Y=U[te],U[te]="none")}function J(){U&&te&&(U[te]=Y)}function ne(f){f.preventDefault(),f.stopPropagation(),window.removeEventListener("click",ne,!0)}function se(){window.addEventListener("click",ne,!0),window.setTimeout(()=>{window.removeEventListener("click",ne,!0)},0)}function fe(f,o){const l=f.getBoundingClientRect();return ge(f,l,o)}function ce(f,o){const l=f.getBoundingClientRect(),m=[];for(let y=0;y<o.length;y++)m.push(ge(f,l,o[y]));return m}function le(f){return/firefox/i.test(navigator.userAgent)&&/macintosh/i.test(navigator.userAgent)&&f.button===2&&f.ctrlKey?0:f.button}function ge(f,o,l){const m=f.offsetWidth===o.width?1:f.offsetWidth/o.width;return new r.P((l.clientX-o.left)*m,(l.clientY-o.top)*m)}const de="01",ke="NO_ACCESS_TOKEN";class We{constructor(o,l,m){this._transformRequestFn=o,this._customAccessToken=l,this._silenceAuthErrors=!!m,this._createSkuToken()}_createSkuToken(){const o=function(){let l="";for(let m=0;m<10;m++)l+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",de,l].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=o.token,this._skuTokenExpiresAt=o.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(o,l){return this._transformRequestFn&&this._transformRequestFn(o,l)||{url:o}}normalizeStyleURL(o,l){if(!r.f(o))return o;const m=be(o);return m.params.push(`sdk=js-${S}`),m.path=`/styles/v1${m.path}`,this._makeAPIURL(m,this._customAccessToken||l)}normalizeGlyphsURL(o,l){if(!r.f(o))return o;const m=be(o);return m.path=`/fonts/v1${m.path}`,this._makeAPIURL(m,this._customAccessToken||l)}normalizeModelURL(o,l){if(!r.f(o))return o;const m=be(o);return m.path=`/models/v1${m.path}`,this._makeAPIURL(m,this._customAccessToken||l)}normalizeSourceURL(o,l,m,y){if(!r.f(o))return o;const w=be(o);return w.path=`/v4/${w.authority}.json`,w.params.push("secure"),m&&w.params.push(`language=${m}`),y&&w.params.push(`worldview=${y}`),this._makeAPIURL(w,this._customAccessToken||l)}normalizeIconsetURL(o,l){const m=be(o);return r.f(o)?(m.path=`/styles/v1${m.path}/iconset.pbf`,this._makeAPIURL(m,this._customAccessToken||l)):Me(m)}normalizeSpriteURL(o,l,m,y){const w=be(o);return r.f(o)?(w.path=`/styles/v1${w.path}/sprite${l}${m}`,this._makeAPIURL(w,this._customAccessToken||y)):(w.path+=`${l}${m}`,Me(w))}normalizeTileURL(o,l,m){if(this._isSkuTokenExpired()&&this._createSkuToken(),o&&!r.f(o))return o;const y=be(o);y.path=y.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${l||m&&y.authority!=="raster"&&m===512?"@2x":""}${r.m.supported?".webp":"$1"}`),y.authority==="raster"?y.path=`/${r.e.RASTER_URL_PREFIX}${y.path}`:y.authority==="rasterarrays"?y.path=`/${r.e.RASTERARRAYS_URL_PREFIX}${y.path}`:y.authority==="3dtiles"?y.path=`/${r.e.TILES3D_URL_PREFIX}${y.path}`:(y.path=y.path.replace(/^.+\/v4\//,"/"),y.path=`/${r.e.TILE_URL_VERSION}${y.path}`);const w=this._customAccessToken||function(E){for(const O of E){const $=O.match(/^access_token=(.*)$/);if($)return $[1]}return null}(y.params)||r.e.ACCESS_TOKEN;return r.e.REQUIRE_ACCESS_TOKEN&&w&&this._skuToken&&y.params.push(`sku=${this._skuToken}`),this._makeAPIURL(y,w)}canonicalizeTileURL(o,l){const m=be(o);if(!m.path.match(/^(\/v4\/|\/(raster|rasterarrays)\/v1\/)/)||!m.path.match(/\.[\w]+$/))return o;let y="mapbox://";m.path.match(/^\/raster\/v1\//)?y+=`raster/${m.path.replace(`/${r.e.RASTER_URL_PREFIX}/`,"")}`:m.path.match(/^\/rasterarrays\/v1\//)?y+=`rasterarrays/${m.path.replace(`/${r.e.RASTERARRAYS_URL_PREFIX}/`,"")}`:y+=`tiles/${m.path.replace(`/${r.e.TILE_URL_VERSION}/`,"")}`;let w=m.params;return l&&(w=w.filter(E=>!E.match(/^access_token=/))),w.length&&(y+=`?${w.join("&")}`),y}canonicalizeTileset(o,l){const m=!!l&&r.f(l),y=[];for(const w of o.tiles||[])r.h(w)?y.push(this.canonicalizeTileURL(w,m)):y.push(w);return y}_makeAPIURL(o,l){const m="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",y=be(r.e.API_URL);if(o.protocol=y.protocol,o.authority=y.authority,o.protocol==="http"){const w=o.params.indexOf("secure");w>=0&&o.params.splice(w,1)}if(y.path!=="/"&&(o.path=`${y.path}${o.path}`),!r.e.REQUIRE_ACCESS_TOKEN)return Me(o);if(l=l||r.e.ACCESS_TOKEN,!this._silenceAuthErrors){if(!l)throw new Error(`An API access token is required to use Mapbox GL. ${m}`);if(l[0]==="s")throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${m}`)}return o.params=o.params.filter(w=>w.indexOf("access_token")===-1),o.params.push(`access_token=${l||""}`),Me(o)}}const we=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function be(f){const o=f.match(we);if(!o)throw new Error("Unable to parse URL object");return{protocol:o[1],authority:o[2],path:o[3]||"/",params:o[4]?o[4].split("&"):[]}}function Me(f){const o=f.params.length?`?${f.params.join("&")}`:"";return`${f.protocol}://${f.authority}${f.path}${o}`}const Ae="mapbox.eventData";function me(f){if(!f)return null;const o=f.split(".");if(!o||o.length!==3)return null;try{return JSON.parse(r.j(o[1]))}catch{return null}}class Be{constructor(o){this.type=o,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(o){const l=me(r.e.ACCESS_TOKEN);let m="";return m=l&&l.u?r.k(l.u):r.e.ACCESS_TOKEN||"",o?`${Ae}.${o}:${m}`:`${Ae}:${m}`}fetchEventData(){const o=r.s("localStorage"),l=this.getStorageKey(),m=this.getStorageKey("uuid");if(o)try{const y=localStorage.getItem(l);y&&(this.eventData=JSON.parse(y));const w=localStorage.getItem(m);w&&(this.anonId=w)}catch{r.w("Unable to read from LocalStorage")}}saveEventData(){const o=r.s("localStorage"),l=this.getStorageKey(),m=this.getStorageKey("uuid"),y=this.anonId;if(o&&y)try{localStorage.setItem(m,y),Object.keys(this.eventData).length>=1&&localStorage.setItem(l,JSON.stringify(this.eventData))}catch{r.w("Unable to write to LocalStorage")}}processRequests(o){}postEvent(o,l,m,y){if(!r.e.EVENTS_URL)return;const w=be(r.e.EVENTS_URL);w.params.push(`access_token=${y||r.e.ACCESS_TOKEN||""}`);const E={event:this.type,created:new Date(o).toISOString()},O=l?r.l(E,l):E,$={url:Me(w),headers:{"Content-Type":"text/plain"},body:JSON.stringify([O])};this.pendingRequest=r.p($,H=>{this.pendingRequest=null,m(H),this.saveEventData(),this.processRequests(y)})}queueRequest(o,l){this.queue.push(o),this.processRequests(l)}}const Ve=new class extends Be{constructor(f){super("appUserTurnstile"),this._customAccessToken=f}postTurnstileEvent(f,o){r.e.EVENTS_URL&&r.e.ACCESS_TOKEN&&Array.isArray(f)&&f.some(l=>r.f(l)||r.h(l))&&this.queueRequest(Date.now(),o)}processRequests(f){if(this.pendingRequest||this.queue.length===0)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const o=me(r.e.ACCESS_TOKEN),l=o?o.u:r.e.ACCESS_TOKEN;let m=l!==this.eventData.tokenU;r.v(this.anonId)||(this.anonId=r.u(),m=!0);const y=this.queue.shift();if(this.eventData.lastSuccess){const w=new Date(this.eventData.lastSuccess),E=new Date(y),O=(y-this.eventData.lastSuccess)/864e5;m=m||O>=1||O<-1||w.getDate()!==E.getDate()}else m=!0;m?this.postEvent(y,{sdkIdentifier:"mapbox-gl-js",sdkVersion:S,skuId:de,"enabled.telemetry":!1,userId:this.anonId},w=>{w||(this.eventData.lastSuccess=y,this.eventData.tokenU=l)},f):this.processRequests()}},bt=Ve.postTurnstileEvent.bind(Ve),Pe=new class extends Be{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(f,o,l,m){this.skuToken=o,this.errorCb=m,r.e.EVENTS_URL&&(l||r.e.ACCESS_TOKEN?this.queueRequest({id:f,timestamp:Date.now()},l):this.errorCb(new Error(ke)))}processRequests(f){if(this.pendingRequest||this.queue.length===0)return;const{id:o,timestamp:l}=this.queue.shift();o&&this.success[o]||(this.anonId||this.fetchEventData(),r.v(this.anonId)||(this.anonId=r.u()),this.postEvent(l,{sdkIdentifier:"mapbox-gl-js",sdkVersion:S,skuId:de,skuToken:this.skuToken,userId:this.anonId},m=>{m?this.errorCb(m):o&&(this.success[o]=!0)},f))}remove(){this.errorCb=null}},wt=Pe.postMapLoadEvent.bind(Pe),Mt=new class extends Be{constructor(){super("style.load"),this.eventIdPerMapInstanceMap=new Map,this.mapInstanceIdMap=new WeakMap}getMapInstanceId(f){let o=this.mapInstanceIdMap.get(f);return o||(o=r.u(),this.mapInstanceIdMap.set(f,o)),o}getEventId(f){const o=this.eventIdPerMapInstanceMap.get(f)||0;return this.eventIdPerMapInstanceMap.set(f,o+1),o}postStyleLoadEvent(f,o){const{map:l,style:m,importedStyles:y}=o;if(!r.e.EVENTS_URL||!f&&!r.e.ACCESS_TOKEN)return;const w=this.getMapInstanceId(l),E={mapInstanceId:w,eventId:this.getEventId(w),style:m};y.length&&(E.importedStyles=y),this.queueRequest({timestamp:Date.now(),payload:E},f)}processRequests(f){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:o,payload:l}=this.queue.shift();this.postEvent(o,l,()=>{},f)}},Nt=Mt.postStyleLoadEvent.bind(Mt),vt=new class extends Be{constructor(){super("gljs.performance")}postPerformanceEvent(f,o){r.e.EVENTS_URL&&(f||r.e.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:o},f)}processRequests(f){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:o,performanceData:l}=this.queue.shift(),m=function(y){const w=performance.getEntriesByType("resource"),E=performance.getEntriesByType("mark"),O=function(oe){const xe={};if(oe){for(const ve in oe)if(ve!=="other")for(const Ce of oe[ve]){const Te=`${ve}ResolveRangeMin`,Le=`${ve}ResolveRangeMax`,Ge=`${ve}RequestCount`,He=`${ve}RequestCachedCount`;xe[Te]=Math.min(xe[Te]||1/0,Ce.startTime),xe[Le]=Math.max(xe[Le]||-1/0,Ce.responseEnd);const rt=Xe=>{xe[Xe]===void 0&&(xe[Xe]=0),++xe[Xe]};Ce.transferSize!==void 0&&Ce.transferSize===0&&rt(He),rt(Ge)}}return xe}(function(oe,xe){const ve={};if(oe)for(const Ce of oe){const Te=xe(Ce);ve[Te]===void 0&&(ve[Te]=[]),ve[Te].push(Ce)}return ve}(w,k)),$=window.devicePixelRatio,H=navigator.connection||navigator.mozConnection||navigator.webkitConnection,G=H?H.effectiveType:void 0,Z={counters:[],metadata:[],attributes:[]},X=(oe,xe,ve)=>{ve!=null&&oe.push({name:xe,value:ve.toString()})};for(const oe in O)X(Z.counters,oe,O[oe]);if(y.interactionRange[0]!==1/0&&y.interactionRange[1]!==-1/0&&(X(Z.counters,"interactionRangeMin",y.interactionRange[0]),X(Z.counters,"interactionRangeMax",y.interactionRange[1])),E)for(const oe of Object.keys(C)){const xe=C[oe],ve=E.find(Ce=>Ce.name===xe);ve&&X(Z.counters,xe,ve.startTime)}return X(Z.counters,"visibilityHidden",y.visibilityHidden),X(Z.attributes,"style",function(oe){if(oe)for(const xe of oe){const ve=xe.name.split("?")[0];if(r.i(ve)){const Ce=ve.split("/").slice(-2);if(Ce.length===2)return`mapbox://styles/${Ce[0]}/${Ce[1]}`}}}(w)),X(Z.attributes,"terrainEnabled",y.terrainEnabled?"true":"false"),X(Z.attributes,"fogEnabled",y.fogEnabled?"true":"false"),X(Z.attributes,"projection",y.projection),X(Z.attributes,"zoom",y.zoom),X(Z.metadata,"devicePixelRatio",$),X(Z.metadata,"connectionEffectiveType",G),X(Z.metadata,"navigatorUserAgent",navigator.userAgent),X(Z.metadata,"screenWidth",window.screen.width),X(Z.metadata,"screenHeight",window.screen.height),X(Z.metadata,"windowWidth",window.innerWidth),X(Z.metadata,"windowHeight",window.innerHeight),X(Z.metadata,"mapWidth",y.width/$),X(Z.metadata,"mapHeight",y.height/$),X(Z.metadata,"webglRenderer",y.renderer),X(Z.metadata,"webglVendor",y.vendor),X(Z.metadata,"sdkVersion",S),X(Z.metadata,"sdkIdentifier","mapbox-gl-js"),Z}(l);for(const y of m.metadata);for(const y of m.counters);for(const y of m.attributes);this.postEvent(o,m,()=>{},f)}},Bt=vt.postPerformanceEvent.bind(vt),Wt=new class extends Be{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(f,o,l,m){if(!r.e.API_URL||!r.e.SESSION_PATH)return;const y=be(r.e.API_URL+r.e.SESSION_PATH);y.params.push(`sku=${o||""}`),y.params.push(`access_token=${m||r.e.ACCESS_TOKEN||""}`);const w={url:Me(y),headers:{"Content-Type":"text/plain"}};this.pendingRequest=r.g(w,E=>{this.pendingRequest=null,l(E),this.saveEventData(),this.processRequests(m)})}getSessionAPI(f,o,l,m){this.skuToken=o,this.errorCb=m,r.e.SESSION_PATH&&r.e.API_URL&&(l||r.e.ACCESS_TOKEN?this.queueRequest({id:f,timestamp:Date.now()},l):this.errorCb(new Error(ke)))}processRequests(f){if(this.pendingRequest||this.queue.length===0)return;const{id:o,timestamp:l}=this.queue.shift();o&&this.success[o]||this.getSession(l,this.skuToken,m=>{m?this.errorCb(m):o&&(this.success[o]=!0)},f)}remove(){this.errorCb=null}},Fe=Wt.getSessionAPI.bind(Wt),cn=new Set;function Re(f,o){o?cn.add(f):cn.delete(f)}class nt{constructor(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSourceCaches={},this._updatedPaintProps=new Set,this._updatedImages=new Set}isDirty(){return this._changed}setDirty(){this._changed=!0}getUpdatedSourceCaches(){return this._updatedSourceCaches}updateSourceCache(o,l){this._updatedSourceCaches[o]=l,this.setDirty()}discardSourceCacheUpdate(o){delete this._updatedSourceCaches[o]}updateLayer(o){const l=o.scope;this._updatedLayers[l]=this._updatedLayers[l]||new Set,this._updatedLayers[l].add(o.id),this.setDirty()}removeLayer(o){const l=o.scope;this._removedLayers[l]=this._removedLayers[l]||{},this._updatedLayers[l]=this._updatedLayers[l]||new Set,this._removedLayers[l][o.id]=o,this._updatedLayers[l].delete(o.id),this._updatedPaintProps.delete(o.fqid),this.setDirty()}getRemovedLayer(o){return this._removedLayers[o.scope]?this._removedLayers[o.scope][o.id]:null}discardLayerRemoval(o){this._removedLayers[o.scope]&&delete this._removedLayers[o.scope][o.id]}getLayerUpdatesByScope(){const o={};for(const l in this._updatedLayers)o[l]=o[l]||{},o[l].updatedIds=Array.from(this._updatedLayers[l].values());for(const l in this._removedLayers)o[l]=o[l]||{},o[l].removedIds=Object.keys(this._removedLayers[l]);return o}getUpdatedPaintProperties(){return this._updatedPaintProps}updatePaintProperties(o){this._updatedPaintProps.add(o.fqid),this.setDirty()}getUpdatedImages(){return Array.from(this._updatedImages.values())}updateImage(o){this._updatedImages.add(o),this.setDirty()}resetUpdatedImages(){this._updatedImages.clear()}reset(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSourceCaches={},this._updatedPaintProps.clear(),this._updatedImages.clear()}}function Qe(f){const{userImage:o}=f;return!!(o&&o.render&&o.render())&&(f.data.replace(new Uint8Array(o.data.buffer)),!0)}class Yt extends r.E{constructor(o){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded={},this.requestors=[],this.patterns={},this.atlasImage={},this.atlasTexture={},this.dirty=!0,this.spriteFormat=o,o!=="raster"&&r.t()&&(this.imageRasterizerDispatcher=new r.D(r.x(),this,"Image Rasterizer Worker",1))}get imageRasterizer(){return this._imageRasterizer||(this._imageRasterizer=new r.I),this._imageRasterizer}createScope(o){this.images[o]={},this.loaded[o]=!1,this.updatedImages[o]={},this.patterns[o]={},this.callbackDispatchedThisFrame[o]={},this.atlasImage[o]=new r.r({width:1,height:1})}isLoaded(){for(const o in this.loaded)if(!this.loaded[o])return!1;return!0}setLoaded(o,l){if(this.loaded[l]!==o&&(this.loaded[l]=o,o)){for(const{ids:m,callback:y}of this.requestors)this._notify(m,l,y);this.requestors=[]}}hasImage(o,l){return!!this.getImage(o,l)}getImage(o,l){return this.images[l][o]}addImage(o,l,m){this._validate(o,m)&&(this.images[l][o]=m)}_validate(o,l){let m=!0;return this._validateStretch(l.stretchX,l.data&&l.data.width)||(this.fire(new r.y(new Error(`Image "${o}" has invalid "stretchX" value`))),m=!1),this._validateStretch(l.stretchY,l.data&&l.data.height)||(this.fire(new r.y(new Error(`Image "${o}" has invalid "stretchY" value`))),m=!1),this._validateContent(l.content,l)||(this.fire(new r.y(new Error(`Image "${o}" has invalid "content" value`))),m=!1),m}_validateStretch(o,l){if(!o)return!0;let m=0;for(const y of o){if(y[0]<m||y[1]<y[0]||l<y[1])return!1;m=y[1]}return!0}_validateContent(o,l){return o?o.length!==4||!l.usvg&&(o[0]<0||l.data.width<o[0]||o[1]<0||l.data.height<o[1]||o[2]<0||l.data.width<o[2]||o[3]<0||l.data.height<o[3])?!1:!(o[2]<o[0]||o[3]<o[1]):!0}updateImage(o,l,m){m.version=this.images[l][o].version+1,this.images[l][o]=m,this.updatedImages[l][o]=!0,this.removeFromImageRasterizerCache(o,l)}removeFromImageRasterizerCache(o,l){this.spriteFormat!=="raster"&&(r.t()?this.imageRasterizerDispatcher.getActor().send("removeRasterizedImages",{imageIds:[o],scope:l}):this.imageRasterizer.removeImagesFromCacheByIds([o],l))}removeImage(o,l){const m=this.images[l][o];delete this.images[l][o],delete this.patterns[l][o],this.removeFromImageRasterizerCache(o,l),m.userImage&&m.userImage.onRemove&&m.userImage.onRemove()}listImages(o){return Object.keys(this.images[o])}getImages(o,l,m){let y=!0;const w=!!this.loaded[l];if(!w)for(const E of o)this.images[l][E]||(y=!1);w||y?this._notify(o,l,m):this.requestors.push({ids:o,scope:l,callback:m})}rasterizeImages({scope:o,imageTasks:l},m){const y={};for(const w in l){const E=l[w],O=this.getImage(E.id,o);O&&(y[w]={image:O,imageIdWithOptions:E})}r.t()?this.imageRasterizerDispatcher.getActor().send("rasterizeImages",{imageTasks:y,scope:o},m):this.rasterizeImagesInMainThread({imageTasks:y,scope:o},m)}rasterizeImagesInMainThread(o,l){const{imageTasks:m,scope:y}=o,w={};for(const E in m){const{image:O,imageIdWithOptions:$}=m[E];w[E]=this.imageRasterizer.rasterize($,O,y,"")}l(void 0,w)}getUpdatedImages(o){return this.updatedImages[o]}_notify(o,l,m){const y={};for(const w of o){this.images[l][w]||this.fire(new r.z("styleimagemissing",{id:w}));const E=this.images[l][w];E?y[w]={data:E.usvg?null:E.data.clone(),pixelRatio:E.pixelRatio,sdf:E.sdf,usvg:E.usvg,version:E.version,stretchX:E.stretchX,stretchY:E.stretchY,content:E.content,hasRenderCallback:!!(E.userImage&&E.userImage.render)}:r.w(`Image "${w}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}m(null,y)}getPixelSize(o){const{width:l,height:m}=this.atlasImage[o];return{width:l,height:m}}getPattern(o,l,m){const y=this.patterns[l][o],w=this.getImage(o,l);if(!w)return null;if(y&&y.position.version===w.version)return y.position;if(y)y.position.version=w.version;else{w.usvg&&!w.data&&(w.data=this.imageRasterizer.rasterize(r.A.from(o).getPrimary(),w,l,""));const E={w:w.data.width+2*r.B,h:w.data.height+2*r.B,x:0,y:0},O=new r.C(E,w,r.B);this.patterns[l][o]={bin:E,position:O}}return this._updatePatternAtlas(l,m),this.patterns[l][o].position}bind(o,l){const m=o.gl;let y=this.atlasTexture[l];y?this.dirty&&(y.update(this.atlasImage[l]),this.dirty=!1):(y=new r.T(o,this.atlasImage[l],m.RGBA8),this.atlasTexture[l]=y),y.bind(m.LINEAR,m.CLAMP_TO_EDGE)}_updatePatternAtlas(o,l){const m=[];for(const O in this.patterns[o])m.push(this.patterns[o][O].bin);const{w:y,h:w}=r.F(m),E=this.atlasImage[o];E.resize({width:y||1,height:w||1});for(const O in this.patterns[o]){const{bin:$,position:H}=this.patterns[o][O];let G=H.padding;const Z=$.x+G,X=$.y+G,oe=this.images[o][O].data,xe=oe.width,ve=oe.height;G=G>1?G-1:G,r.r.copy(oe,E,{x:0,y:0},{x:Z,y:X},{width:xe,height:ve},l),r.r.copy(oe,E,{x:0,y:ve-G},{x:Z,y:X-G},{width:xe,height:G},l),r.r.copy(oe,E,{x:0,y:0},{x:Z,y:X+ve},{width:xe,height:G},l),r.r.copy(oe,E,{x:xe-G,y:0},{x:Z-G,y:X},{width:G,height:ve},l),r.r.copy(oe,E,{x:0,y:0},{x:Z+xe,y:X},{width:G,height:ve},l),r.r.copy(oe,E,{x:xe-G,y:ve-G},{x:Z-G,y:X-G},{width:G,height:G},l),r.r.copy(oe,E,{x:0,y:ve-G},{x:Z+xe,y:X-G},{width:G,height:G},l),r.r.copy(oe,E,{x:0,y:0},{x:Z+xe,y:X+ve},{width:G,height:G},l),r.r.copy(oe,E,{x:xe-G,y:0},{x:Z-G,y:X+ve},{width:G,height:G},l)}this.dirty=!0}beginFrame(){for(const o in this.images)this.callbackDispatchedThisFrame[o]={}}dispatchRenderCallbacks(o,l){for(const m of o){if(this.callbackDispatchedThisFrame[l][m])continue;this.callbackDispatchedThisFrame[l][m]=!0;const y=this.images[l][m];Qe(y)&&this.updateImage(m,l,y)}}}function Xt(f){const o=f.key,l=f.value,m=f.valueSpec||{},y=f.objectElementValidators||{},w=f.style,E=f.styleSpec;let O=[];const $=r.H(l);if($!=="object")return[new r.V(o,l,`object expected, ${$} found`)];for(const H in l){const G=H.split(".")[0];let Z;y[G]?Z=y[G]:m[G]?Z=wn:y["*"]?Z=y["*"]:m["*"]&&(Z=wn),Z?O=O.concat(Z({key:(o&&`${o}.`)+H,value:l[H],valueSpec:m[G]||m["*"],style:w,styleSpec:E,object:l,objectKey:H},l)):O.push(new r.G(o,l[H],`unknown property "${H}"`))}for(const H in m)y[H]||m[H].required&&m[H].default===void 0&&l[H]===void 0&&O.push(new r.V(o,l,`missing required property "${H}"`));return O}function $t(f){const o=f.value,l=f.valueSpec,m=f.style,y=f.styleSpec,w=f.key,E=f.arrayElementValidator||wn;if(r.H(o)!=="array")return[new r.V(w,o,`array expected, ${r.H(o)} found`)];if(l.length&&o.length!==l.length)return[new r.V(w,o,`array length ${l.length} expected, length ${o.length} found`)];if(l["min-length"]&&o.length<l["min-length"])return[new r.V(w,o,`array length at least ${l["min-length"]} expected, length ${o.length} found`)];let O={type:l.value,values:l.values,minimum:l.minimum,maximum:l.maximum,function:void 0};y.$version<7&&(O.function=l.function),r.H(l.value)==="object"&&(O=l.value);let $=[];for(let H=0;H<o.length;H++)$=$.concat(E({array:o,arrayIndex:H,value:o[H],valueSpec:O,style:m,styleSpec:y,key:`${w}[${H}]`},!0));return $}function Ot(f){const o=f.key,l=f.value,m=f.valueSpec;let y=r.H(l);if(y==="number"&&l!=l&&(y="NaN"),y!=="number")return[new r.V(o,l,`number expected, ${y} found`)];if("minimum"in m){let w=m.minimum;if(r.H(m.minimum)==="array"&&(w=m.minimum[f.arrayIndex]),l<w)return[new r.V(o,l,`${l} is less than the minimum value ${w}`)]}if("maximum"in m){let w=m.maximum;if(r.H(m.maximum)==="array"&&(w=m.maximum[f.arrayIndex]),l>w)return[new r.V(o,l,`${l} is greater than the maximum value ${w}`)]}return[]}function Ft(f){const o=f.valueSpec,l=r.K(f.value.type);let m,y,w,E={};const O=l!=="categorical"&&f.value.property===void 0,$=!O,H=r.H(f.value.stops)==="array"&&r.H(f.value.stops[0])==="array"&&r.H(f.value.stops[0][0])==="object",G=Xt({key:f.key,value:f.value,valueSpec:f.styleSpec.function,style:f.style,styleSpec:f.styleSpec,objectElementValidators:{stops:function(oe){if(l==="identity")return[new r.V(oe.key,oe.value,'identity function may not have a "stops" property')];let xe=[];const ve=oe.value;return xe=xe.concat($t({key:oe.key,value:ve,valueSpec:oe.valueSpec,style:oe.style,styleSpec:oe.styleSpec,arrayElementValidator:Z})),r.H(ve)==="array"&&ve.length===0&&xe.push(new r.V(oe.key,ve,"array must have at least one stop")),xe},default:function(oe){return wn({key:oe.key,value:oe.value,valueSpec:o,style:oe.style,styleSpec:oe.styleSpec})}}});return l==="identity"&&O&&G.push(new r.V(f.key,f.value,'missing required property "property"')),l==="identity"||f.value.stops||G.push(new r.V(f.key,f.value,'missing required property "stops"')),l==="exponential"&&f.valueSpec.expression&&!r.L(f.valueSpec)&&G.push(new r.V(f.key,f.value,"exponential functions not supported")),f.styleSpec.$version>=8&&($&&!r.M(f.valueSpec)?G.push(new r.V(f.key,f.value,"property functions not supported")):O&&!r.N(f.valueSpec)&&G.push(new r.V(f.key,f.value,"zoom functions not supported"))),l!=="categorical"&&!H||f.value.property!==void 0||G.push(new r.V(f.key,f.value,'"property" property is required')),G;function Z(oe){let xe=[];const ve=oe.value,Ce=oe.key;if(r.H(ve)!=="array")return[new r.V(Ce,ve,`array expected, ${r.H(ve)} found`)];if(ve.length!==2)return[new r.V(Ce,ve,`array length 2 expected, length ${ve.length} found`)];if(H){if(r.H(ve[0])!=="object")return[new r.V(Ce,ve,`object expected, ${r.H(ve[0])} found`)];if(ve[0].zoom===void 0)return[new r.V(Ce,ve,"object stop key must have zoom")];if(ve[0].value===void 0)return[new r.V(Ce,ve,"object stop key must have value")];const Te=r.K(ve[0].zoom);if(typeof Te!="number")return[new r.V(Ce,ve[0].zoom,"stop zoom values must be numbers")];if(w&&w>Te)return[new r.V(Ce,ve[0].zoom,"stop zoom values must appear in ascending order")];Te!==w&&(w=Te,y=void 0,E={}),xe=xe.concat(Xt({key:`${Ce}[0]`,value:ve[0],valueSpec:{zoom:{}},style:oe.style,styleSpec:oe.styleSpec,objectElementValidators:{zoom:Ot,value:X}}))}else xe=xe.concat(X({key:`${Ce}[0]`,value:ve[0],style:oe.style,styleSpec:oe.styleSpec},ve));return r.O(r.Q(ve[1]))?xe.concat([new r.V(`${Ce}[1]`,ve[1],"expressions are not allowed in function stops.")]):xe.concat(wn({key:`${Ce}[1]`,value:ve[1],valueSpec:o,style:oe.style,styleSpec:oe.styleSpec}))}function X(oe,xe){const ve=r.H(oe.value),Ce=r.K(oe.value),Te=oe.value!==null?oe.value:xe;if(m){if(ve!==m)return[new r.V(oe.key,Te,`${ve} stop domain type must match previous stop domain type ${m}`)]}else m=ve;if(ve!=="number"&&ve!=="string"&&ve!=="boolean"&&typeof Ce!="number"&&typeof Ce!="string"&&typeof Ce!="boolean")return[new r.V(oe.key,Te,"stop domain value must be a number, string, or boolean")];if(ve!=="number"&&l!=="categorical"){let Le=`number expected, ${ve} found`;return r.M(o)&&l===void 0&&(Le+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new r.V(oe.key,Te,Le)]}return l!=="categorical"||ve!=="number"||typeof Ce=="number"&&isFinite(Ce)&&Math.floor(Ce)===Ce?l!=="categorical"&&ve==="number"&&typeof Ce=="number"&&typeof y=="number"&&y!==void 0&&Ce<y?[new r.V(oe.key,Te,"stop domain values must appear in ascending order")]:(y=Ce,l==="categorical"&&Ce in E?[new r.V(oe.key,Te,"stop domain values must be unique")]:(E[Ce]=!0,[])):[new r.V(oe.key,Te,`integer expected, found ${String(Ce)}`)]}}function sn(f){const o=(f.expressionContext==="property"?r.S:r.U)(r.Q(f.value),f.valueSpec);if(o.result==="error")return o.value.map(m=>new r.V(`${f.key}${m.key}`,f.value,m.message));const l=o.value.expression||o.value._styleExpression.expression;if(f.expressionContext==="property"&&f.propertyKey==="text-font"&&!l.outputDefined())return[new r.V(f.key,f.value,`Invalid data expression for "${f.propertyKey}". Output values must be contained as literals within the expression.`)];if(f.expressionContext==="property"&&f.propertyType==="layout"&&!r.W(l))return[new r.V(f.key,f.value,'"feature-state" data expressions are not supported with layout properties.')];if(f.expressionContext==="filter")return an(l,f);if(f.expressionContext&&f.expressionContext.indexOf("cluster")===0){if(!r.X(l,["zoom","feature-state"]))return[new r.V(f.key,f.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(f.expressionContext==="cluster-initial"&&!r.Y(l))return[new r.V(f.key,f.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function an(f,o){const l=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(o.valueSpec&&o.valueSpec.expression)for(const y of o.valueSpec.expression.parameters)l.delete(y);if(l.size===0)return[];const m=[];return f instanceof r.Z&&l.has(f.name)?[new r.V(o.key,o.value,`["${f.name}"] expression is not supported in a filter for a ${o.object.type} layer with id: ${o.object.id}`)]:(f.eachChild(y=>{m.push(...an(y,o))}),m)}function Pn(f){const o=f.key,l=f.value,m=f.valueSpec,y=[];return Array.isArray(m.values)?m.values.indexOf(r.K(l))===-1&&y.push(new r.V(o,l,`expected one of [${m.values.join(", ")}], ${JSON.stringify(l)} found`)):Object.keys(m.values).indexOf(r.K(l))===-1&&y.push(new r.V(o,l,`expected one of [${Object.keys(m.values).join(", ")}], ${JSON.stringify(l)} found`)),y}function bn(f){return r.$(r.Q(f.value))?sn(r.J({},f,{expressionContext:"filter",valueSpec:f.styleSpec[`filter_${f.layerType||"fill"}`]})):It(f)}function It(f){const o=f.value,l=f.key;if(r.H(o)!=="array")return[new r.V(l,o,`array expected, ${r.H(o)} found`)];const m=f.styleSpec;let y,w=[];if(o.length<1)return[new r.V(l,o,"filter array must have at least 1 element")];switch(w=w.concat(Pn({key:`${l}[0]`,value:o[0],valueSpec:m.filter_operator,style:f.style,styleSpec:f.styleSpec})),r.K(o[0])){case"<":case"<=":case">":case">=":o.length>=2&&r.K(o[1])==="$type"&&w.push(new r.V(l,o,`"$type" cannot be use with operator "${o[0]}"`));case"==":case"!=":o.length!==3&&w.push(new r.V(l,o,`filter array for operator "${o[0]}" must have 3 elements`));case"in":case"!in":o.length>=2&&(y=r.H(o[1]),y!=="string"&&w.push(new r.V(`${l}[1]`,o[1],`string expected, ${y} found`)));for(let E=2;E<o.length;E++)y=r.H(o[E]),r.K(o[1])==="$type"?w=w.concat(Pn({key:`${l}[${E}]`,value:o[E],valueSpec:m.geometry_type,style:f.style,styleSpec:f.styleSpec})):y!=="string"&&y!=="number"&&y!=="boolean"&&w.push(new r.V(`${l}[${E}]`,o[E],`string, number, or boolean expected, ${y} found`));break;case"any":case"all":case"none":for(let E=1;E<o.length;E++)w=w.concat(It({key:`${l}[${E}]`,value:o[E],style:f.style,styleSpec:f.styleSpec}));break;case"has":case"!has":y=r.H(o[1]),o.length!==2?w.push(new r.V(l,o,`filter array for "${o[0]}" operator must have 2 elements`)):y!=="string"&&w.push(new r.V(`${l}[1]`,o[1],`string expected, ${y} found`))}return w}function Sn(f,o){const l=f.key,m=f.style,y=f.layer,w=f.styleSpec,E=f.value,O=f.objectKey,$=w[`${o}_${f.layerType}`];if(!$)return[];const H=O.match(/^(.*)-use-theme$/);if(o==="paint"&&H&&$[H[1]])return r.O(E)?[].concat(wn({key:f.key,value:E,valueSpec:{type:"string",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},style:m,styleSpec:w,expressionContext:"property",propertyType:o,propertyKey:O})):wn({key:l,value:E,valueSpec:{type:"string"},style:m,styleSpec:w});const G=O.match(/^(.*)-transition$/);if(o==="paint"&&G&&$[G[1]]&&$[G[1]].transition)return wn({key:l,value:E,valueSpec:w.transition,style:m,styleSpec:w});const Z=f.valueSpec||$[O];if(!Z)return[new r.G(l,E,`unknown property "${O}"`)];let X;if(r.H(E)==="string"&&r.M(Z)&&!Z.tokens&&(X=/^{([^}]+)}$/.exec(E))){const xe=`\`{ "type": "identity", "property": ${X?JSON.stringify(X[1]):'"_"'} }\``;return[new r.V(l,E,`"${O}" does not support interpolation syntax
Use an identity property function instead: ${xe}.`)]}const oe=[];if(f.layerType==="symbol")O!=="text-field"||!m||m.glyphs||m.imports||oe.push(new r.V(l,E,'use of "text-field" requires a style "glyphs" property')),O==="text-font"&&r.a0(r.Q(E))&&r.K(E.type)==="identity"&&oe.push(new r.V(l,E,'"text-font" does not support identity functions'));else if(f.layerType==="model"&&o==="paint"&&y&&y.layout&&y.layout.hasOwnProperty("model-id")&&r.M(Z)&&(r.a1(Z)||r.N(Z))){const xe=r.S(r.Q(E),Z),ve=xe.value.expression||xe.value._styleExpression.expression;ve&&!r.X(ve,["measure-light"])&&(O==="model-emissive-strength"&&r.Y(ve)&&r.W(ve)||oe.push(new r.V(l,E,`${O} does not support measure-light expressions when the model layer source is vector tile or GeoJSON.`)))}return oe.concat(wn({key:f.key,value:E,valueSpec:Z,style:m,styleSpec:w,expressionContext:"property",propertyType:o,propertyKey:O}))}function Yn(f){return Sn(f,"paint")}function vr(f){return Sn(f,"layout")}function tr(f){let o=[];const l=f.value,m=f.key,y=f.style,w=f.styleSpec;l.type||l.ref||o.push(new r.V(m,l,'either "type" or "ref" is required'));let E=r.K(l.type);const O=r.K(l.ref);if(l.id){const $=r.K(l.id);for(let H=0;H<f.arrayIndex;H++){const G=y.layers[H];r.K(G.id)===$&&o.push(new r.V(m,l.id,`duplicate layer id "${l.id}", previously used at line ${G.id.__line__}`))}}if("ref"in l){let $;["type","source","source-layer","filter","layout"].forEach(H=>{H in l&&o.push(new r.V(m,l[H],`"${H}" is prohibited for ref layers`))}),y.layers.forEach(H=>{r.K(H.id)===O&&($=H)}),$?$.ref?o.push(new r.V(m,l.ref,"ref cannot reference another ref layer")):E=r.K($.type):typeof O=="string"&&o.push(new r.V(m,l.ref,`ref layer "${O}" not found`))}else if(E!=="background"&&E!=="sky"&&E!=="slot")if(l.source){const $=y.sources&&y.sources[l.source],H=$&&r.K($.type);$?H==="vector"&&E==="raster"?o.push(new r.V(m,l.source,`layer "${l.id}" requires a raster source`)):H==="raster"&&E!=="raster"?o.push(new r.V(m,l.source,`layer "${l.id}" requires a vector source`)):H!=="vector"||l["source-layer"]?H==="raster-dem"&&E!=="hillshade"?o.push(new r.V(m,l.source,"raster-dem source can only be used with layer type 'hillshade'.")):H!=="raster-array"||["raster","raster-particle"].includes(E)?E!=="line"||!l.paint||!l.paint["line-gradient"]&&!l.paint["line-trim-offset"]||H==="geojson"&&$.lineMetrics?E==="raster-particle"&&H!=="raster-array"&&o.push(new r.V(m,l.source,`layer "${l.id}" requires a 'raster-array' source.`)):o.push(new r.V(m,l,`layer "${l.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):o.push(new r.V(m,l.source,"raster-array source can only be used with layer type 'raster'.")):o.push(new r.V(m,l,`layer "${l.id}" must specify a "source-layer"`)):o.push(new r.V(m,l.source,`source "${l.source}" not found`))}else o.push(new r.V(m,l,'missing required property "source"'));return o=o.concat(Xt({key:m,value:l,valueSpec:w.layer,style:f.style,styleSpec:f.styleSpec,objectElementValidators:{"*":()=>[],type:()=>wn({key:`${m}.type`,value:l.type,valueSpec:w.layer.type,style:f.style,styleSpec:f.styleSpec,object:l,objectKey:"type"}),filter:$=>bn(r.J({layerType:E},$)),layout:$=>Xt({layer:l,key:$.key,value:$.value,valueSpec:{},style:$.style,styleSpec:$.styleSpec,objectElementValidators:{"*":H=>vr(r.J({layerType:E},H))}}),paint:$=>Xt({layer:l,key:$.key,value:$.value,valueSpec:{},style:$.style,styleSpec:$.styleSpec,objectElementValidators:{"*":H=>Yn(r.J({layerType:E,layer:l},H))}})}})),o}function zr(f){const o=f.value,l=f.key,m=r.H(o);return m!=="string"?[new r.V(l,o,`string expected, ${m} found`)]:[]}const Cr={promoteId:function f({key:o,value:l}){if(r.H(l)==="string")return zr({key:o,value:l});if(Array.isArray(l)){const m=[],y=r.Q(l),w=r.U(y);return w.result==="error"&&w.value.forEach(E=>{m.push(new r.V(`${o}${E.key}`,null,`${E.message}`))}),r.X(w.value.expression,["zoom","heatmap-density","line-progress","raster-value","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center","measure-light","raster-particle-speed"])||m.push(new r.V(`${o}`,null,"promoteId expression should be only feature dependent")),m}{const m=[];for(const y in l)m.push(...f({key:`${o}.${y}`,value:l[y]}));return m}}};function Io(f){const o=f.value,l=f.key,m=f.styleSpec,y=f.style;if(!o.type)return[new r.V(l,o,'"type" is required')];const w=r.K(o.type);let E=[];switch(["vector","raster","raster-dem","raster-array"].includes(w)&&(o.url||o.tiles||E.push(new r.G(l,o,'Either "url" or "tiles" is required.'))),w){case"vector":case"raster":case"raster-dem":case"raster-array":return E=E.concat(Xt({key:l,value:o,valueSpec:m[`source_${w.replace("-","_")}`],style:f.style,styleSpec:m,objectElementValidators:Cr})),E;case"geojson":if(E=Xt({key:l,value:o,valueSpec:m.source_geojson,style:y,styleSpec:m,objectElementValidators:Cr}),o.cluster)for(const O in o.clusterProperties){const[$,H]=o.clusterProperties[O],G=typeof $=="string"?[$,["accumulated"],["get",O]]:$;E.push(...sn({key:`${l}.${O}.map`,value:H,expressionContext:"cluster-map"})),E.push(...sn({key:`${l}.${O}.reduce`,value:G,expressionContext:"cluster-reduce"}))}return E;case"video":return Xt({key:l,value:o,valueSpec:m.source_video,style:y,styleSpec:m});case"image":return Xt({key:l,value:o,valueSpec:m.source_image,style:y,styleSpec:m});case"canvas":return[new r.V(l,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Pn({key:`${l}.type`,value:o.type,valueSpec:{values:jn(m)}})}}function jn(f){return f.source.reduce((o,l)=>{const m=f[l];return m.type.type==="enum"&&(o=o.concat(Object.keys(m.type.values))),o},[])}function Gt(f){const o=f.value,l=f.styleSpec,m=l.light,y=f.style;let w=[];const E=r.H(o);if(o===void 0)return w;if(E!=="object")return w=w.concat([new r.V("light",o,`object expected, ${E} found`)]),w;for(const O in o){const $=O.match(/^(.*)-transition$/),H=O.match(/^(.*)-use-theme$/);w=w.concat(H&&m[H[1]]?wn({key:O,value:o[O],valueSpec:{type:"string"},style:y,styleSpec:l}):$&&m[$[1]]&&m[$[1]].transition?wn({key:O,value:o[O],valueSpec:l.transition,style:y,styleSpec:l}):m[O]?wn({key:O,value:o[O],valueSpec:m[O],style:y,styleSpec:l}):[new r.V(O,o[O],`unknown property "${O}"`)])}return w}function ct(f){const o=f.value;let l=[];if(!o)return l;const m=r.H(o);if(m!=="object")return l=l.concat([new r.V("light-3d",o,`object expected, ${m} found`)]),l;const y=f.styleSpec,w=y["light-3d"],E=f.key,O=f.style,$=f.style.lights;for(const Z of["type","id"])if(!(Z in o))return l=l.concat([new r.V("light-3d",o,`missing property ${Z} on light`)]),l;if(o.type&&$)for(let Z=0;Z<f.arrayIndex;Z++){const X=r.K(o.type),oe=$[Z];r.K(oe.type)===X&&l.push(new r.V(E,o.id,`duplicate light type "${o.type}", previously defined at line ${oe.id.__line__}`))}const H=`properties_light_${o.type}`;if(!(H in y))return l=l.concat([new r.V("light-3d",o,`Invalid light type ${o.type}`)]),l;const G=y[H];for(const Z in o)if(Z==="properties"){const X=o[Z],oe=r.H(X);if(oe!=="object")return l=l.concat([new r.V("properties",X,`object expected, ${oe} found`)]),l;for(const xe in X)l=l.concat(G[xe]?wn({key:xe,value:X[xe],valueSpec:G[xe],style:O,styleSpec:y}):[new r.G(f.key,X[xe],`unknown property "${xe}"`)])}else{const X=Z.match(/^(.*)-transition$/),oe=Z.match(/^(.*)-use-theme$/);l=l.concat(oe&&w[oe[1]]?wn({key:Z,value:o[Z],valueSpec:{type:"string"},style:O,styleSpec:y}):X&&w[X[1]]&&w[X[1]].transition?wn({key:Z,value:o[Z],valueSpec:y.transition,style:O,styleSpec:y}):w[Z]?wn({key:Z,value:o[Z],valueSpec:w[Z],style:O,styleSpec:y}):[new r.G(Z,o[Z],`unknown property "${Z}"`)])}return l}function Ut(f){const o=f.value,l=f.key,m=f.style,y=f.styleSpec,w=y.terrain;let E=[];const O=r.H(o);if(o===void 0||O==="null")return E;if(O!=="object")return E=E.concat([new r.V("terrain",o,`object expected, ${O} found`)]),E;for(const $ in o){const H=$.match(/^(.*)-transition$/),G=$.match(/^(.*)-use-theme$/);E=E.concat(G&&w[G[1]]?wn({key:$,value:o[$],valueSpec:{type:"string"},style:m,styleSpec:y}):H&&w[H[1]]&&w[H[1]].transition?wn({key:$,value:o[$],valueSpec:y.transition,style:m,styleSpec:y}):w[$]?wn({key:$,value:o[$],valueSpec:w[$],style:m,styleSpec:y}):[new r.G($,o[$],`unknown property "${$}"`)])}if(o.source){const $=m.sources&&m.sources[o.source],H=$&&r.K($.type);$?H!=="raster-dem"&&E.push(new r.V(l,o.source,`terrain cannot be used with a source of type ${String(H)}, it only be used with a "raster-dem" source type`)):E.push(new r.V(l,o.source,`source "${o.source}" not found`))}else E.push(new r.V(l,o,'terrain is missing required property "source"'));return E}function tt(f){const o=f.value,l=f.style,m=f.styleSpec,y=m.fog;let w=[];const E=r.H(o);if(o===void 0)return w;if(E!=="object")return w=w.concat([new r.V("fog",o,`object expected, ${E} found`)]),w;for(const O in o){const $=O.match(/^(.*)-transition$/),H=O.match(/^(.*)-use-theme$/);w=w.concat(H&&y[H[1]]?wn({key:O,value:o[O],valueSpec:{type:"string"},style:l,styleSpec:m}):$&&y[$[1]]&&y[$[1]].transition?wn({key:O,value:o[O],valueSpec:m.transition,style:l,styleSpec:m}):y[O]?wn({key:O,value:o[O],valueSpec:y[O],style:l,styleSpec:m}):[new r.G(O,o[O],`unknown property "${O}"`)])}return w}const yn={"*":()=>[],array:$t,boolean:function(f){const o=f.value,l=f.key,m=r.H(o);return m!=="boolean"?[new r.V(l,o,`boolean expected, ${m} found`)]:[]},number:Ot,color:function(f){const o=f.key,l=f.value,m=r.H(l);return m!=="string"?[new r.V(o,l,`color expected, ${m} found`)]:r._.parseCSSColor(l)===null?[new r.V(o,l,`color expected, "${l}" found`)]:[]},enum:Pn,filter:bn,function:Ft,layer:tr,object:Xt,source:Io,model:r.a2,light:Gt,"light-3d":ct,terrain:Ut,fog:tt,string:zr,formatted:function(f){return zr(f).length===0?[]:sn(f)},resolvedImage:function(f){return zr(f).length===0?[]:sn(f)},projection:function(f){const o=f.value,l=f.styleSpec,m=l.projection,y=f.style;let w=[];const E=r.H(o);if(E==="object")for(const O in o)w=w.concat(wn({key:O,value:o[O],valueSpec:m[O],style:y,styleSpec:l}));else E!=="string"&&(w=w.concat([new r.V("projection",o,`object or string expected, ${E} found`)]));return w},import:function(f){const{value:o,styleSpec:l}=f,{data:m,...y}=o;Object.defineProperty(y,"__line__",{value:o.__line__,enumerable:!1});let w=Xt(r.J({},f,{value:y,valueSpec:l.import}));return r.K(y.id)===""&&w.push(new r.V(`${f.key}.id`,y,"import id can't be an empty string")),m&&(w=w.concat(vo(m,l,{key:`${f.key}.data`}))),w}};function wn(f,o=!1){const l=f.value,m=f.valueSpec,y=f.styleSpec;if(m.expression&&r.a0(r.K(l)))return Ft(f);if(m.expression&&r.O(r.Q(l)))return sn(f);if(m.type&&yn[m.type]){const w=yn[m.type](f);return o===!0&&w.length>0&&r.H(f.value)==="array"?sn(f):w}return Xt(r.J({},f,{valueSpec:m.type?y[m.type]:m}))}function sr(f){const o=f.value,l=f.key,m=zr(f);return m.length||(o.indexOf("{fontstack}")===-1&&m.push(new r.V(l,o,'"glyphs" url must include a "{fontstack}" token')),o.indexOf("{range}")===-1&&m.push(new r.V(l,o,'"glyphs" url must include a "{range}" token'))),m}function vo(f,o=r.a3,l={}){return wn({key:l.key||"",value:f,valueSpec:o.$root,styleSpec:o,style:f,objectElementValidators:{glyphs:sr,"*":()=>[]}})}function jo(f,o=r.a3){return Ci(vo(f,o))}const Go=f=>Ci(Io(f)),bo=f=>Ci(Gt(f)),oi=f=>Ci(ct(f)),mo=f=>Ci(Ut(f)),Fi=f=>Ci(tt(f)),Gs=f=>Ci(function(o){const l=o.value,m=o.style,y=o.styleSpec,w=y.snow;let E=[];const O=r.H(l);if(l===void 0)return E;if(O!=="object")return E=E.concat([new r.V("snow",l,`object expected, ${O} found`)]),E;for(const $ in l){const H=$.match(/^(.*)-transition$/);E=E.concat(H&&w[H[1]]&&w[H[1]].transition?wn({key:$,value:l[$],valueSpec:y.transition,style:m,styleSpec:y}):w[$]?wn({key:$,value:l[$],valueSpec:w[$],style:m,styleSpec:y}):[new r.G($,l[$],`unknown property "${$}"`)])}return E}(f)),kl=f=>Ci(function(o){const l=o.value,m=o.style,y=o.styleSpec,w=y.rain;let E=[];const O=r.H(l);if(l===void 0)return E;if(O!=="object")return E=E.concat([new r.V("rain",l,`object expected, ${O} found`)]),E;for(const $ in l){const H=$.match(/^(.*)-transition$/);E=E.concat(H&&w[H[1]]&&w[H[1]].transition?wn({key:$,value:l[$],valueSpec:y.transition,style:m,styleSpec:y}):w[$]?wn({key:$,value:l[$],valueSpec:w[$],style:m,styleSpec:y}):[new r.G($,l[$],`unknown property "${$}"`)])}return E}(f)),ga=f=>Ci(tr(f)),Jo=f=>Ci(bn(f)),va=f=>Ci(Yn(f)),vc=f=>Ci(vr(f)),Qa=f=>Ci(r.a2(f));function Ci(f){return f.slice().sort((o,l)=>o.line&&l.line?o.line-l.line:0)}function Ps(f,o){let l=!1;if(o&&o.length)for(const m of o)m instanceof r.G?r.w(m.message):(f.fire(new r.y(new Error(m.message))),l=!0);return l}let zt;class ye extends r.E{constructor(o,l="flat"){super(),this._transitionable=new r.a4(zt||(zt=new r.a5({anchor:new r.a6(r.a3.light.anchor),position:new r.a7(r.a3.light.position),color:new r.a6(r.a3.light.color),intensity:new r.a6(r.a3.light.intensity)}))),this.setLight(o,l),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(o,l,m={}){this._validate(bo,o,m)||(this._transitionable.setTransitionOrValue(o),this.id=l)}updateTransitions(o){this._transitioning=this._transitionable.transitioned(o,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(o){this.properties=this._transitioning.possiblyEvaluate(o)}_validate(o,l,m){return(!m||m.validate!==!1)&&Ps(this,o.call(jo,r.l({value:l,style:{glyphs:!0,sprite:!0},styleSpec:r.a3})))}}let he=class extends r.E{constructor(f,o,l,m){super(),this.scope=l,this._transitionable=new r.a4(new r.a5({source:new r.a6(r.a3.terrain.source),exaggeration:new r.a6(r.a3.terrain.exaggeration)}),l,m),this._transitionable.setTransitionOrValue(f,m),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=o}get(){return this._transitionable.serialize()}set(f,o){this._transitionable.setTransitionOrValue(f,o)}updateTransitions(f){this._transitioning=this._transitionable.transitioned(f,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(f){this.properties=this._transitioning.possiblyEvaluate(f)}getExaggeration(f){return this._transitioning.possiblyEvaluate(new r.a8(f)).get("exaggeration")}getAttenuationRange(){if(!this.isZoomDependent())return null;const f=this._transitionable._values.exaggeration;if(!f)return null;const o=f.value.expression;if(!o)return null;let l=-1,m=-1,y=1;for(const w of o.zoomStops)y=o.evaluate(new r.a8(w)),y>.01?(l=w,m=-1):m=w;return y<.01&&l>0&&m>l?[l,m]:null}isZoomDependent(){const f=this._transitionable._values.exaggeration;return f!=null&&f.value!=null&&f.value.expression!=null&&f.value.expression instanceof r.a9}};const Ie=45,je=65,Je=.05;function lt(f,o,l,m){const y=r.ac(Ie,je,l),[w,E]=St(f,m);let O=1-Math.min(1,Math.exp((o-w)/(E-w)*-6));return O*=O*O,O=Math.min(1,1.00747*O),O*y*f.alpha}function St(f,o){const l=.5/Math.tan(.5*o);return[f.range[0]+l,f.range[1]+l]}function ht(f,o,l,m,y){const w=r.ab.vec3.transformMat4([],[o,l,m],y.mercatorFogMatrix);return lt(f,r.ab.vec3.length(w),y.pitch,y._fov)}function Dt(f,o,l,m,y,w,E){const O=[[l,m,0],[y,m,0],[y,w,0],[l,w,0]];let $=Number.MAX_VALUE,H=-Number.MAX_VALUE;for(const G of O){const Z=r.ab.vec3.transformMat4([],G,o),X=r.ab.vec3.length(Z);$=Math.min($,X),H=Math.max(H,X)}return[lt(f,$,E.pitch,E._fov),lt(f,H,E.pitch,E._fov)]}class Pt extends r.E{constructor(o,l,m,y){super();const w=new r.a5({range:new r.a6(r.a3.fog.range),color:new r.a6(r.a3.fog.color),"color-use-theme":new r.a6({type:"string","property-type":"data-constant",default:"default"}),"high-color":new r.a6(r.a3.fog["high-color"]),"high-color-use-theme":new r.a6({type:"string","property-type":"data-constant",default:"default"}),"space-color":new r.a6(r.a3.fog["space-color"]),"space-color-use-theme":new r.a6({type:"string","property-type":"data-constant",default:"default"}),"horizon-blend":new r.a6(r.a3.fog["horizon-blend"]),"star-intensity":new r.a6(r.a3.fog["star-intensity"]),"vertical-range":new r.a6(r.a3.fog["vertical-range"])});this._transitionable=new r.a4(w,m,new Map(y)),this.set(o,y),this._transitioning=this._transitionable.untransitioned(),this._transform=l,this.properties=new r.ad(w),this.scope=m}get state(){const o=this._transform,l=o.projection.name==="globe",m=r.ae(o.zoom),y=this.properties.get("range"),w=[.5,3];return{range:l?[r.af(w[0],y[0],m),r.af(w[1],y[1],m)]:y,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(o,l,m={}){if(this._validate(Fi,o,m))return;const y=r.l({},o);for(const w of Object.keys(r.a3.fog))y[w]===void 0&&(y[w]=r.a3.fog[w].default);this._options=y,this._transitionable.setTransitionOrValue(this._options,l)}getOpacity(o){if(!this._transform.projection.supportsFog)return 0;const l=this.properties&&this.properties.get("color")||1;return(this._transform.projection.name==="globe"?1:r.ac(Ie,je,o))*l.a}getOpacityAtLatLng(o,l){return this._transform.projection.supportsFog?function(m,y,w){const E=r.aa.fromLngLat(y),O=w.elevation?w.elevation.getAtPointOrZero(E):0;return ht(m,E.x,E.y,O,w)}(this.state,o,l):0}getOpacityForTile(o){if(!this._transform.projection.supportsFog)return[1,1];const l=this._transform.calculateFogTileMatrix(o.toUnwrapped());return Dt(this.state,l,0,0,r.ag,r.ag,this._transform)}getOpacityForBounds(o,l,m,y,w){return this._transform.projection.supportsFog?Dt(this.state,o,l,m,y,w,this._transform):[1,1]}getFovAdjustedRange(o){return this._transform.projection.supportsFog?St(this.state,o):[0,1]}isVisibleOnFrustum(o){if(!this._transform.projection.supportsFog)return!1;const l=[4,5,6,7];for(const m of l){const y=o.points[m];let w;if(y[2]>=0)w=y;else{const E=o.points[m-4];w=r.ah(E,y,E[2]/(E[2]-y[2]))}if(ht(this.state,w[0],w[1],0,this._transform)>=Je)return!0}return!1}updateConfig(o){this._transitionable.setTransitionOrValue(this._options,new Map(o))}updateTransitions(o){this._transitioning=this._transitionable.transitioned(o,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(o){this.properties=this._transitioning.possiblyEvaluate(o)}_validate(o,l,m){return(!m||m.validate!==!1)&&Ps(this,o.call(jo,r.l({value:l,style:{glyphs:!0,sprite:!0},styleSpec:r.a3})))}}let Ke,Ct,Qt,on,Wn=class extends r.E{constructor(f,o,l,m){super();const y=Ke||(Ke=new r.a5({density:new r.a6(r.a3.snow.density),intensity:new r.a6(r.a3.snow.intensity),color:new r.a6(r.a3.snow.color),opacity:new r.a6(r.a3.snow.opacity),vignette:new r.a6(r.a3.snow.vignette),"vignette-color":new r.a6(r.a3.snow["vignette-color"]),"center-thinning":new r.a6(r.a3.snow["center-thinning"]),direction:new r.a6(r.a3.snow.direction),"flake-size":new r.a6(r.a3.snow["flake-size"])}));this._transitionable=new r.a4(y,l,new Map(m)),this.set(f,m),this._transitioning=this._transitionable.untransitioned(),this.properties=new r.ad(y),this.scope=l}get state(){const f=this.properties.get("opacity"),o=this.properties.get("color"),l=this.properties.get("direction"),m=r.ai(l[0]),y=-Math.max(r.ai(l[1]),.01),w=[Math.cos(m)*Math.cos(y),Math.sin(m)*Math.cos(y),Math.sin(y)],E=this.properties.get("vignette"),O=this.properties.get("vignette-color");return O.a=E,{density:this.properties.get("density"),intensity:this.properties.get("intensity"),color:new r.aj(o.r,o.g,o.b,o.a*f),direction:w,centerThinning:this.properties.get("center-thinning"),flakeSize:this.properties.get("flake-size"),vignetteColor:O}}get(){return this._transitionable.serialize()}set(f,o,l={}){if(this._validate(Gs,f,l))return;const m=r.l({},f);for(const y of Object.keys(r.a3.snow))m[y]===void 0&&(m[y]=r.a3.snow[y].default);this._options=m,this._transitionable.setTransitionOrValue(this._options,o)}updateConfig(f){this._transitionable.setTransitionOrValue(this._options,new Map(f))}updateTransitions(f){this._transitioning=this._transitionable.transitioned(f,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(f){this.properties=this._transitioning.possiblyEvaluate(f)}_validate(f,o,l){return(!l||l.validate!==!1)&&Ps(this,f.call(jo,r.l({value:o,style:{glyphs:!0,sprite:!0},styleSpec:r.a3})))}},er=class extends r.E{constructor(f,o,l,m){super();const y=Ct||(Ct=new r.a5({density:new r.a6(r.a3.rain.density),intensity:new r.a6(r.a3.rain.intensity),color:new r.a6(r.a3.rain.color),opacity:new r.a6(r.a3.rain.opacity),vignette:new r.a6(r.a3.rain.vignette),"vignette-color":new r.a6(r.a3.rain["vignette-color"]),"center-thinning":new r.a6(r.a3.rain["center-thinning"]),direction:new r.a6(r.a3.rain.direction),"droplet-size":new r.a6(r.a3.rain["droplet-size"]),"distortion-strength":new r.a6(r.a3.rain["distortion-strength"])}));this._transitionable=new r.a4(y,l,new Map(m)),this.set(f,m),this._transitioning=this._transitionable.untransitioned(),this.properties=new r.ad(y),this.scope=l}get state(){const f=this.properties.get("opacity"),o=this.properties.get("color"),l=this.properties.get("direction"),m=r.ai(l[0]),y=-Math.max(r.ai(l[1]),.01),w=[Math.cos(m)*Math.cos(y),Math.sin(m)*Math.cos(y),Math.sin(y)],E=this.properties.get("vignette-color");return E.a=this.properties.get("vignette"),{density:this.properties.get("density"),intensity:this.properties.get("intensity"),color:new r.aj(o.r,o.g,o.b,o.a*f),direction:w,centerThinning:this.properties.get("center-thinning"),dropletSize:this.properties.get("droplet-size"),distortionStrength:this.properties.get("distortion-strength"),vignetteColor:E}}get(){return this._transitionable.serialize()}set(f,o,l={}){if(this._validate(kl,f,l))return;const m=r.l({},f);for(const y of Object.keys(r.a3.rain))m[y]===void 0&&(m[y]=r.a3.rain[y].default);this._options=m,this._transitionable.setTransitionOrValue(this._options,o)}updateConfig(f){this._transitionable.setTransitionOrValue(this._options,new Map(f))}updateTransitions(f){this._transitioning=this._transitionable.transitioned(f,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(f){this.properties=this._transitioning.possiblyEvaluate(f)}_validate(f,o,l){return(!l||l.validate!==!1)&&Ps(this,f.call(jo,r.l({value:o,style:{glyphs:!0,sprite:!0},styleSpec:r.a3})))}};class ar extends r.E{constructor(o,l,m,y){super(),this.scope=m,this._options=o,this.properties=new r.ad(l),this._transitionable=new r.a4(l,m,new Map(y)),this._transitionable.setTransitionOrValue(o.properties),this._transitioning=this._transitionable.untransitioned()}updateConfig(o){this._transitionable.setTransitionOrValue(this._options.properties,new Map(o))}updateTransitions(o){this._transitioning=this._transitionable.transitioned(o,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(o){this.properties=this._transitioning.possiblyEvaluate(o)}get(){return this._options.properties=this._transitionable.serialize(),this._options}set(o,l){this._options=o,this._transitionable.setTransitionOrValue(o.properties,l)}shadowsEnabled(){return!!this.properties&&this.properties.get("cast-shadows")===!0}}class rr{constructor(o,l,m,y){this.screenBounds=o,this.cameraPoint=l,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=m,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,y)}static createFromScreenPoints(o,l){let m,y;if(o instanceof r.P||typeof o[0]=="number"){const w=r.P.convert(o);m=[w],y=l.isPointAboveHorizon(w)}else{const w=r.P.convert(o[0]),E=r.P.convert(o[1]);m=[w,E],y=r.al(w,E).every(O=>l.isPointAboveHorizon(O))}return new rr(m,l.getCameraPoint(),y,l)}isPointQuery(){return this.screenBounds.length===1}bufferedScreenGeometry(o){return r.al(this.screenBounds[0],this.screenBounds.length===1?this.screenBounds[0]:this.screenBounds[1],o)}bufferedCameraGeometry(o){const l=this.screenBounds[0],m=this.screenBounds.length===1?this.screenBounds[0].add(new r.P(1,1)):this.screenBounds[1],y=r.al(l,m,0,!1);return this.cameraPoint.y>m.y&&(this.cameraPoint.x>l.x&&this.cameraPoint.x<m.x?y.splice(3,0,this.cameraPoint):this.cameraPoint.x>=m.x?y[2]=this.cameraPoint:this.cameraPoint.x<=l.x&&(y[3]=this.cameraPoint)),r.am(y,o)}bufferedCameraGeometryGlobe(o){const l=this.screenBounds[0],m=this.screenBounds.length===1?this.screenBounds[0].add(new r.P(1,1)):this.screenBounds[1],y=r.al(l,m,o),w=this.cameraPoint.clone();switch(3*((w.y>l.y)+(w.y>m.y))+((w.x>l.x)+(w.x>m.x))){case 0:y[0]=w,y[4]=w.clone();break;case 1:y.splice(1,0,w);break;case 2:y[1]=w;break;case 3:y.splice(4,0,w);break;case 5:y.splice(2,0,w);break;case 6:y[3]=w;break;case 7:y.splice(3,0,w);break;case 8:y[2]=w}return y}containsTile(o,l,m,y=0){const w=o.queryPadding/l._pixelsPerMercatorPixel+1,E=m?this._bufferedCameraMercator(w,l):this._bufferedScreenMercator(w,l);let O=o.tileID.wrap+(E.unwrapped?y:0);const $=E.polygon.map(Ce=>r.an(o.tileTransform,Ce,O));if(!r.ao($,0,0,r.ag,r.ag))return;O=o.tileID.wrap+(this.screenGeometryMercator.unwrapped?y:0);const H=this.screenGeometryMercator.polygon.map(Ce=>r.ap(o.tileTransform,Ce,O)),G=H.map(Ce=>new r.P(Ce[0],Ce[1])),Z=l.getFreeCameraOptions().position||new r.aa(0,0,0),X=r.ap(o.tileTransform,Z,O),oe=H.map(Ce=>{const Te=r.ab.vec3.sub(Ce,Ce,X);return r.ab.vec3.normalize(Te,Te),new r.aq(X,Te)}),xe=r.ar(o,1,l.zoom)*l._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:G,tilespaceRays:oe,bufferedTilespaceGeometry:$,bufferedTilespaceBounds:(ve=r.as($),ve.min.x=r.aw(ve.min.x,0,r.ag),ve.min.y=r.aw(ve.min.y,0,r.ag),ve.max.x=r.aw(ve.max.x,0,r.ag),ve.max.y=r.aw(ve.max.y,0,r.ag),ve),tile:o,tileID:o.tileID,pixelToTileUnitsFactor:xe};var ve}_bufferedScreenMercator(o,l){const m=Pr(o);if(this._screenRaycastCache[m])return this._screenRaycastCache[m];{let y;return y=l.projection.name==="globe"?this._projectAndResample(this.bufferedScreenGeometry(o),l):{polygon:this.bufferedScreenGeometry(o).map(w=>l.pointCoordinate3D(w)),unwrapped:!0},this._screenRaycastCache[m]=y,y}}_bufferedCameraMercator(o,l){const m=Pr(o);if(this._cameraRaycastCache[m])return this._cameraRaycastCache[m];{let y;return y=l.projection.name==="globe"?this._projectAndResample(this.bufferedCameraGeometryGlobe(o),l):{polygon:this.bufferedCameraGeometry(o).map(w=>l.pointCoordinate3D(w)),unwrapped:!0},this._cameraRaycastCache[m]=y,y}}_projectAndResample(o,l){const m=function(w,E){const O=r.ab.mat4.multiply([],E.pixelMatrix,E.globeMatrix),$=[0,-r.ax,0,1],H=[0,r.ax,0,1],G=[0,0,0,1];r.ab.vec4.transformMat4($,$,O),r.ab.vec4.transformMat4(H,H,O),r.ab.vec4.transformMat4(G,G,O);const Z=new r.P($[0]/$[3],$[1]/$[3]),X=new r.P(H[0]/H[3],H[1]/H[3]),oe=r.au(w,Z)&&$[3]<G[3],xe=r.au(w,X)&&H[3]<G[3];if(!oe&&!xe)return null;const ve=function(et,Ye,at){for(let gt=1;gt<et.length;gt++){const Vt=Kr(Ye.pointCoordinate3D(et[gt-1]).x),Rt=Kr(Ye.pointCoordinate3D(et[gt]).x);if(at<0){if(Vt<Rt)return{idx:gt,t:-Vt/(Rt-1-Vt)}}else if(Rt<Vt)return{idx:gt,t:(1-Vt)/(Rt+1-Vt)}}return null}(w,E,oe?-1:1);if(!ve)return null;const{idx:Ce,t:Te}=ve;let Le=Ce>1?$r(w.slice(0,Ce),E):[],Ge=Ce<w.length?$r(w.slice(Ce),E):[];Le=Le.map(et=>new r.P(Kr(et.x),et.y)),Ge=Ge.map(et=>new r.P(Kr(et.x),et.y));const He=[...Le];He.length===0&&He.push(Ge[Ge.length-1]);const rt=r.af(He[He.length-1].y,(Ge.length===0?Le[0]:Ge[0]).y,Te);let Xe;return Xe=oe?[new r.P(0,rt),new r.P(0,0),new r.P(1,0),new r.P(1,rt)]:[new r.P(1,rt),new r.P(1,1),new r.P(0,1),new r.P(0,rt)],He.push(...Xe),Ge.length===0?He.push(Le[0]):He.push(...Ge),{polygon:He.map(et=>new r.aa(et.x,et.y)),unwrapped:!1}}(o,l);if(m)return m;const y=function(w,E){let O=!1,$=-1/0,H=0;for(let Z=0;Z<w.length-1;Z++)w[Z].x>$&&($=w[Z].x,H=Z);for(let Z=0;Z<w.length-1;Z++){const X=(H+Z)%(w.length-1),oe=w[X],xe=w[X+1];Math.abs(oe.x-xe.x)>.5&&(oe.x<xe.x?(oe.x+=1,X===0&&(w[w.length-1].x+=1)):(xe.x+=1,X+1===w.length-1&&(w[0].x+=1)),O=!0)}const G=r.at(E.center.lng);return O&&G<Math.abs(G-1)&&w.forEach(Z=>{Z.x-=1}),{polygon:w,unwrapped:O}}($r(o,l).map(w=>new r.P(Kr(w.x),w.y)),l);return{polygon:y.polygon.map(w=>new r.aa(w.x,w.y)),unwrapped:y.unwrapped}}}function $r(f,o){return r.av(f,l=>{const m=o.pointCoordinate3D(l);l.x=m.x,l.y=m.y},1/256)}function Kr(f){return f<0?1+f%1:f%1}function Pr(f){return 100*f|0}function Zr(f,o,l,m,y){const w=function(O,$){if(O)return y(O);if($){if(f.url&&$.tiles&&f.tiles&&delete f.tiles,$.variants){if(!Array.isArray($.variants))return y(new Error("variants must be an array"));for(const G of $.variants){if(G==null||typeof G!="object"||G.constructor!==Object)return y(new Error("variant must be an object"));if(!Array.isArray(G.capabilities))return y(new Error("capabilities must be an array"));if(G.capabilities.length===1&&G.capabilities[0]==="meshopt"){$=r.l($,G);break}}}const H=r.ay(r.l({},$,f),["tilejson","tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding","vector_layers","raster_layers","worldview_options","worldview_default","worldview"]);H.tiles=o.canonicalizeTileset(H,f.url),y(null,H)}},E=function(O,$,H){if(!O)return null;if(!$&&!H)return O;H=H||O.worldview_default;const G=Object.values(O.language||{});if(G.length===0)return null;const Z=Object.values(O.worldview||{});if(Z.length===0)return null;const X=G.every(xe=>xe===$),oe=Z.every(xe=>xe===H);return X&&oe?O:$ in(O.language_options||{})||H in(O.worldview_options||{})?null:O.language_options&&O.worldview_options?O:null}(f.data,l,m);return E?r.q.frame(()=>w(null,E)):f.url?r.n(o.transformRequest(o.normalizeSourceURL(f.url,null,l,m),r.R.Source),w):r.q.frame(()=>{const{data:O,...$}=f;w(null,$)})}class Jr{constructor(o,l,m){this.bounds=r.az.convert(this.validateBounds(o)),this.minzoom=l||0,this.maxzoom=m||24}validateBounds(o){return Array.isArray(o)&&o.length===4?[Math.max(-180,o[0]),Math.max(-90,o[1]),Math.min(180,o[2]),Math.min(90,o[3])]:[-180,-90,180,90]}contains(o){const l=Math.pow(2,o.z),m=Math.floor(r.at(this.bounds.getWest())*l),y=Math.floor(r.aA(this.bounds.getNorth())*l),w=Math.ceil(r.at(this.bounds.getEast())*l),E=Math.ceil(r.aA(this.bounds.getSouth())*l);return o.x>=m&&o.x<w&&o.y>=y&&o.y<E}}class fi extends r.E{constructor(o,l,m,y){if(super(),this.id=o,this.dispatcher=m,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,r.l(this,r.ay(l,["url","scheme","tileSize","promoteId"])),this._options=r.l({type:"vector"},l),this._collectResourceTiming=!!l.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(y),this._tileWorkers={},this._deduped=new r.aB}load(o){this._loaded=!1,this.fire(new r.z("dataloading",{dataType:"source"}));const l=Array.isArray(this.map._language)?this.map._language.join():this.map._language,m=this.map.getWorldview();this._tileJSONRequest=Zr(this._options,this.map._requestManager,l,m,(y,w)=>{if(this._tileJSONRequest=null,this._loaded=!0,y)l&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${l}`),m&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${m}`),this.fire(new r.y(y));else if(w){if(r.l(this,w),this.hasWorldviews=!!w.worldview_options,w.worldview_default&&(this.worldviewDefault=w.worldview_default),w.vector_layers){this.vectorLayers=w.vector_layers,this.vectorLayerIds=[],this.localizableLayerIds=new Set;for(const E of w.vector_layers)this.vectorLayerIds.push(E.id),w.worldview&&w.worldview[E.source]&&this.localizableLayerIds.add(E.id)}w.bounds&&(this.tileBounds=new Jr(w.bounds,this.minzoom,this.maxzoom)),bt(w.tiles,this.map._requestManager._customAccessToken),this.fire(new r.z("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new r.z("data",{dataType:"source",sourceDataType:"content"}))}o&&o(y)})}loaded(){return this._loaded}hasTile(o){return!this.tileBounds||this.tileBounds.contains(o.canonical)}onAdd(o){this.map=o,this.load()}reload(){this.cancelTileJSONRequest();const o=r.aC(this.id,this.scope);this.load(()=>this.map.style.clearSource(o))}setTiles(o){return this._options.tiles=o,this.reload(),this}setUrl(o){return this.url=o,this._options.url=o,this.reload(),this}onRemove(o){this.cancelTileJSONRequest()}serialize(){return r.l({},this._options)}loadTile(o,l){const m=o.tileID.canonical.url(this.tiles,this.scheme),y=this.map._requestManager.normalizeTileURL(m),w=this.map._requestManager.transformRequest(y,r.R.Tile),E=this.map.style?this.map.style.getLut(this.scope):null,O=E?{image:E.image.clone()}:null,$={request:w,data:void 0,uid:o.uid,tileID:o.tileID,tileZoom:o.tileZoom,zoom:o.tileID.overscaledZ,maxZoom:this.maxzoom,lut:O,tileSize:this.tileSize*o.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,pixelRatio:r.q.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:o.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0,extraShadowCaster:o.isExtraShadowCaster,tessellationStep:this.map._tessellationStep,scaleFactor:this.map.getScaleFactor()};if(this.hasWorldviews&&r.f(m)&&($.worldview=this.map.getWorldview()||this.worldviewDefault,$.localizableLayerIds=this.localizableLayerIds),$.request.collectResourceTiming=this._collectResourceTiming,o.actor&&o.state!=="expired")o.state==="loading"?o.reloadCallback=l:o.request=o.actor.send("reloadTile",$,H.bind(this));else if(o.actor=this._tileWorkers[y]=this._tileWorkers[y]||this.dispatcher.getActor(),this.dispatcher.ready)o.request=o.actor.send("loadTile",$,H.bind(this),void 0,!0);else{const G=r.aD.call({deduped:this._deduped},$,(Z,X)=>{Z||!X?H.call(this,Z):($.data={cacheControl:X.cacheControl,expires:X.expires,rawData:X.rawData.slice(0)},o.actor&&o.actor.send("loadTile",$,H.bind(this),void 0,!0))},!0);o.request={cancel:G}}function H(G,Z){return delete o.request,o.aborted?l(null):G&&G.status!==404?l(G):(Z&&Z.resourceTiming&&(o.resourceTiming=Z.resourceTiming),this.map._refreshExpiredTiles&&Z&&o.setExpiryData(Z),o.loadVectorData(Z,this.map.painter),r.aE(this.dispatcher),l(null),void(o.reloadCallback&&(this.loadTile(o,o.reloadCallback),o.reloadCallback=null)))}}abortTile(o){o.request&&(o.request.cancel(),delete o.request),o.actor&&o.actor.send("abortTile",{uid:o.uid,type:this.type,source:this.id,scope:this.scope})}unloadTile(o,l){o.actor&&o.actor.send("removeTile",{uid:o.uid,type:this.type,source:this.id,scope:this.scope}),o.destroy()}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class el extends r.E{constructor(o,l,m,y){super(),this.id=o,this.dispatcher=m,this.setEventedParent(y),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=r.l({type:"raster"},l),r.l(this,r.ay(l,["url","scheme","tileSize"]))}load(o){this._loaded=!1,this.fire(new r.z("dataloading",{dataType:"source"})),this._tileJSONRequest=Zr(this._options,this.map._requestManager,null,null,(l,m)=>{this._tileJSONRequest=null,this._loaded=!0,l?this.fire(new r.y(l)):m&&(r.l(this,m),m.raster_layers&&(this.rasterLayers=m.raster_layers,this.rasterLayerIds=this.rasterLayers.map(y=>y.id)),m.bounds&&(this.tileBounds=new Jr(m.bounds,this.minzoom,this.maxzoom)),bt(m.tiles),this.fire(new r.z("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new r.z("data",{dataType:"source",sourceDataType:"content"}))),o&&o(l)})}loaded(){return this._loaded}onAdd(o){this.map=o,this.load()}reload(){this.cancelTileJSONRequest();const o=r.aC(this.id,this.scope);this.load(()=>this.map.style.clearSource(o))}setTiles(o){return this._options.tiles=o,this.reload(),this}setUrl(o){return this.url=o,this._options.url=o,this.reload(),this}onRemove(o){this.cancelTileJSONRequest()}serialize(){return r.l({},this._options)}hasTile(o){return!this.tileBounds||this.tileBounds.contains(o.canonical)}loadTile(o,l){const m=r.q.devicePixelRatio>=2,y=this.map._requestManager.normalizeTileURL(o.tileID.canonical.url(this.tiles,this.scheme),m,this.tileSize);o.request=r.o(this.map._requestManager.transformRequest(y,r.R.Tile),(w,E,O,$)=>(delete o.request,o.aborted?(o.state="unloaded",l(null)):w?(o.state="errored",l(w)):E?(this.map._refreshExpiredTiles&&o.setExpiryData({cacheControl:O,expires:$}),o.setTexture(E,this.map.painter),o.state="loaded",r.aE(this.dispatcher),void l(null)):l(null)))}abortTile(o,l){o.request&&(o.request.cancel(),delete o.request),l&&l()}unloadTile(o,l){o.texture&&o.texture instanceof r.T?(o.destroy(!0),o.texture&&o.texture instanceof r.T&&this.map.painter.saveTileTexture(o.texture)):o.destroy(),l&&l()}hasTransition(){return!1}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class Ei extends el{constructor(o,l,m,y){super(o,l,m,y),this.type="raster-array",this.maxzoom=22,this._options=r.l({type:"raster-array"},l)}triggerRepaint(o){const l=this.map.painter._terrain,m=this.map.style.getSourceCache(this.id);l&&l.enabled&&m&&l._clearRenderCacheForTile(m.id,o.tileID),this.map.triggerRepaint()}loadTile(o,l){const m=this.map._requestManager.normalizeTileURL(o.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize),y=this.map._requestManager.transformRequest(m,r.R.Tile);o.requestParams=y,o.actor||(o.actor=this.dispatcher.getActor()),o.request=o.fetchHeader(void 0,(w,E,O,$)=>{if(delete o.request,o.aborted)return o.state="unloaded",l(null);if(w)return w.code===20?void 0:(o.state="errored",l(w));this.map._refreshExpiredTiles&&o.setExpiryData({cacheControl:O,expires:$}),o.state="empty",l(null)})}unloadTile(o,l){const m=o.texture;m&&m instanceof r.T?(o.destroy(!0),this.map.painter.saveTileTexture(m)):(o.destroy(),o.flushQueues(),o._isHeaderLoaded=!1,delete o._mrt,delete o.textureDescriptor),o.fbo&&(o.fbo.destroy(),delete o.fbo),delete o.request,delete o.requestParams,delete o.neighboringTiles,o.state="unloaded"}prepareTile(o,l,m){o._isHeaderLoaded&&(o.state!=="empty"&&(o.state="reloading"),o.fetchBand(l,m,(y,w)=>{if(y)return o.state="errored",this.fire(new r.y(y)),void this.triggerRepaint(o);w&&(o.setTexture(w,this.map.painter),o.state="loaded",this.triggerRepaint(o))}))}getInitialBand(o){if(!this.rasterLayers)return 0;const l=this.rasterLayers.find(({id:w})=>w===o),m=l&&l.fields,y=m&&m.bands&&m.bands;return y?y[0]:0}getTextureDescriptor(o,l,m){if(!o)return;const y=l.sourceLayer||this.rasterLayerIds&&this.rasterLayerIds[0];if(!y)return;let w=null;l instanceof r.aH?w=l.paint.get("raster-array-band"):l instanceof r.aI&&(w=l.paint.get("raster-particle-array-band"));const E=w||this.getInitialBand(y);if(E!=null)if(o.textureDescriptor){if(!o.updateNeeded(y,E)||m)return Object.assign({},o.textureDescriptor,{texture:o.texture})}else this.prepareTile(o,y,E)}}const ki={vector:fi,raster:el,"raster-dem":class extends el{constructor(f,o,l,m){super(f,o,l,m),this.type="raster-dem",this.maxzoom=22,this._options=r.l({type:"raster-dem"},o),this.encoding=o.encoding||"mapbox"}loadTile(f,o){const l=this.map._requestManager.normalizeTileURL(f.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function m(y,w){y&&(f.state="errored",o(y)),w&&(f.dem=w,f.dem.onDeserialize(),f.needsHillshadePrepare=!0,f.needsDEMTextureUpload=!0,f.state="loaded",o(null))}f.request=r.o(this.map._requestManager.transformRequest(l,r.R.Tile),(function(y,w,E,O){if(delete f.request,f.aborted)f.state="unloaded",o(null);else if(y)f.state="errored",o(y);else if(w){this.map._refreshExpiredTiles&&f.setExpiryData({cacheControl:E,expires:O});const $=ImageBitmap&&w instanceof ImageBitmap&&r.t(),H=1-(w.width-r.aF(w.width))/2;H<1||f.neighboringTiles||(f.neighboringTiles=this._getNeighboringTiles(f.tileID));const G=$?w:r.q.getImageData(w,H),Z={uid:f.uid,coord:f.tileID,source:this.id,scope:this.scope,rawImageData:G,encoding:this.encoding,padding:H};f.actor&&f.state!=="expired"||(f.actor=this.dispatcher.getActor(),f.actor.send("loadDEMTile",Z,m.bind(this),void 0,!0))}}).bind(this))}_getNeighboringTiles(f){const o=f.canonical,l=Math.pow(2,o.z),m=(o.x-1+l)%l,y=o.x===0?f.wrap-1:f.wrap,w=(o.x+1+l)%l,E=o.x+1===l?f.wrap+1:f.wrap,O={};return O[new r.aG(f.overscaledZ,y,o.z,m,o.y).key]={backfilled:!1},O[new r.aG(f.overscaledZ,E,o.z,w,o.y).key]={backfilled:!1},o.y>0&&(O[new r.aG(f.overscaledZ,y,o.z,m,o.y-1).key]={backfilled:!1},O[new r.aG(f.overscaledZ,f.wrap,o.z,o.x,o.y-1).key]={backfilled:!1},O[new r.aG(f.overscaledZ,E,o.z,w,o.y-1).key]={backfilled:!1}),o.y+1<l&&(O[new r.aG(f.overscaledZ,y,o.z,m,o.y+1).key]={backfilled:!1},O[new r.aG(f.overscaledZ,f.wrap,o.z,o.x,o.y+1).key]={backfilled:!1},O[new r.aG(f.overscaledZ,E,o.z,w,o.y+1).key]={backfilled:!1}),O}},"raster-array":Ei,geojson:class extends r.E{constructor(f,o,l,m){super(),this.id=f,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=l.getActor(),this.setEventedParent(m),this._data=o.data,this._options=r.l({},o),this._collectResourceTiming=o.collectResourceTiming,o.maxzoom!==void 0&&(this.maxzoom=o.maxzoom),o.minzoom!==void 0&&(this.minzoom=o.minzoom),o.type&&(this.type=o.type),o.attribution&&(this.attribution=o.attribution),this.promoteId=o.promoteId;const y=r.ag/this.tileSize;this.workerOptions=r.l({source:this.id,scope:this.scope,cluster:o.cluster||!1,geojsonVtOptions:{buffer:(o.buffer!==void 0?o.buffer:128)*y,tolerance:(o.tolerance!==void 0?o.tolerance:.375)*y,extent:r.ag,maxZoom:this.maxzoom,lineMetrics:o.lineMetrics||!1,generateId:o.generateId||!1},superclusterOptions:{maxZoom:o.clusterMaxZoom!==void 0?o.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,o.clusterMinPoints||2),extent:r.ag,radius:(o.clusterRadius!==void 0?o.clusterRadius:50)*y,log:!1,generateId:o.generateId||!1},clusterProperties:o.clusterProperties,filter:o.filter,dynamic:o.dynamic},o.workerOptions)}onAdd(f){this.map=f,this.setData(this._data)}setData(f){return this._data=f,this._updateWorkerData(),this}updateData(f){if(!this._options.dynamic)return this.fire(new r.y(new Error("Can't call updateData on a GeoJSON source with dynamic set to false.")));if(typeof f!="string"&&(f.type==="Feature"&&(f={type:"FeatureCollection",features:[f]}),f.type!=="FeatureCollection"))return this.fire(new r.y(new Error("Data to update should be a feature or a feature collection.")));if(this._coalesce&&typeof f!="string"&&typeof this._data!="string"&&this._data.type==="FeatureCollection"){const o=new Map;for(const l of this._data.features)o.set(l.id,l);for(const l of f.features)o.set(l.id,l);this._data.features=[...o.values()]}else this._data=f;return this._updateWorkerData(!0),this}getClusterExpansionZoom(f,o){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:f,source:this.id,scope:this.scope},o),this}getClusterChildren(f,o){return this.actor.send("geojson.getClusterChildren",{clusterId:f,source:this.id,scope:this.scope},o),this}getClusterLeaves(f,o,l,m){return this.actor.send("geojson.getClusterLeaves",{source:this.id,scope:this.scope,clusterId:f,limit:o,offset:l},m),this}_updateWorkerData(f=!1){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new r.z("dataloading",{dataType:"source"})),this._loaded=!1;const o=r.l({append:f},this.workerOptions);o.scope=this.scope;const l=this._data;typeof l=="string"?(o.request=this.map._requestManager.transformRequest(r.q.resolveURL(l),r.R.Source),o.request.collectResourceTiming=this._collectResourceTiming):o.data=JSON.stringify(l),this._pendingLoad=this.actor.send(`${this.type}.loadData`,o,(m,y)=>{if(this._loaded=!0,this._pendingLoad=null,m)this.fire(new r.y(m));else{const w={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&y&&y.resourceTiming&&y.resourceTiming[this.id]&&(w.resourceTiming=y.resourceTiming[this.id]),f&&(this._partialReload=!0),this.fire(new r.z("data",w)),this._partialReload=!1,this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(f),this._coalesce=!1)})}loaded(){return this._loaded}reload(){const f=r.aC(this.id,this.scope);this.map.style.clearSource(f),this._updateWorkerData()}loadTile(f,o){const l=f.actor?"reloadTile":"loadTile";f.actor=this.actor;const m=this.map.style?this.map.style.getLut(this.scope):null,y=m?{image:m.image.clone()}:null,w=this._partialReload,E={type:this.type,uid:f.uid,tileID:f.tileID,tileZoom:f.tileZoom,zoom:f.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,lut:y,scope:this.scope,pixelRatio:r.q.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,brightness:this.map.style&&this.map.style.getBrightness()||0,scaleFactor:this.map.getScaleFactor(),partial:w};f.request=this.actor.send(l,E,(O,$)=>w&&!$?(f.state="loaded",o(null)):(delete f.request,f.destroy(),f.aborted?o(null):O?o(O):(f.loadVectorData($,this.map.painter,l==="reloadTile"),o(null))),void 0,l==="loadTile")}abortTile(f){f.request&&(f.request.cancel(),delete f.request),f.aborted=!0}unloadTile(f,o){this.actor.send("removeTile",{uid:f.uid,type:this.type,source:this.id,scope:this.scope}),f.destroy()}onRemove(f){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return r.l({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends r.aJ{constructor(f,o,l,m){super(f,o,l,m),this.roundZoom=!0,this.type="video",this.options=o}load(){this._loaded=!1;const f=this.options;this.urls=[];for(const o of f.urls)this.urls.push(this.map._requestManager.transformRequest(o,r.R.Source).url);r.aK(this.urls,(o,l)=>{this._loaded=!0,o?this.fire(new r.y(o)):l&&(this.video=l,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(f){if(this.video){const o=this.video.seekable;f<o.start(0)||f>o.end(0)?this.fire(new r.y(new r.V(`sources.${this.id}`,null,`Playback for this video can be set only between the ${o.start(0)} and ${o.end(0)}-second mark.`))):this.video.currentTime=f}}getVideo(){return this.video}onAdd(f){this.map||(this.map=f,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const f=this.map.painter.context,o=f.gl;this.texture?this.video.paused||(this.texture.bind(o.LINEAR,o.CLAMP_TO_EDGE),o.texSubImage2D(o.TEXTURE_2D,0,0,0,o.RGBA,o.UNSIGNED_BYTE,this.video)):(this.texture=new r.T(f,this.video,o.RGBA8),this.texture.bind(o.LINEAR,o.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(f)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:r.aJ,model:class extends r.E{constructor(f,o,l,m){super(),this.id=f,this.type="model",this.models=[],this._loaded=!1,this._options=o}load(){const f=[];for(const o in this._options.models){const l=this._options.models[o],m=r.aM(this.map._requestManager.transformRequest(l.uri,r.R.Model).url).then(y=>{if(!y)return;const w=r.aN(y),E=new r.aO(o,l.position,l.orientation,w);E.computeBoundsAndApplyParent(),this.models.push(E)}).catch(y=>{this.fire(new r.y(new Error(`Could not load model ${o} from ${l.uri}: ${y.message}`)))});f.push(m)}return Promise.allSettled(f).then(()=>{this._loaded=!0,this.fire(new r.z("data",{dataType:"source",sourceDataType:"metadata"}))}).catch(o=>{this.fire(new r.y(new Error(`Could not load models: ${o.message}`)))})}onAdd(f){this.map=f,this.load()}hasTransition(){return!1}loaded(){return this._loaded}getModels(){return this.models}loadTile(f,o){}serialize(){return{type:"model"}}},"batched-model":class extends r.E{constructor(f,o,l,m){super(),this.type="batched-model",this.id=f,this.tileSize=512,this._options=o,this.tiles=this._options.tiles,this.maxzoom=o.maxzoom||19,this.minzoom=o.minzoom||0,this.roundZoom=!0,this.usedInConflation=!0,this.dispatcher=l,this.reparseOverscaled=!1,this.scheme="xyz",this._loaded=!1,this.setEventedParent(m)}onAdd(f){this.map=f,this.load()}reload(){this.cancelTileJSONRequest();const f=r.aC(this.id,this.scope);this.load(()=>this.map.style.clearSource(f))}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}load(f){this._loaded=!1,this.fire(new r.z("dataloading",{dataType:"source"}));const o=Array.isArray(this.map._language)?this.map._language.join():this.map._language,l=this.map.getWorldview();this._tileJSONRequest=Zr(this._options,this.map._requestManager,o,l,(m,y)=>{this._tileJSONRequest=null,this._loaded=!0,m?(o&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${o}`),l&&l.length!==2&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${l}`),this.fire(new r.y(m))):y&&(r.l(this,y),y.bounds&&(this.tileBounds=new Jr(y.bounds,this.minzoom,this.maxzoom)),bt(y.tiles,this.map._requestManager._customAccessToken),this.fire(new r.z("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new r.z("data",{dataType:"source",sourceDataType:"content"}))),f&&f(m)})}hasTransition(){return!1}hasTile(f){return!this.tileBounds||this.tileBounds.contains(f.canonical)}loaded(){return this._loaded}loadTile(f,o){const l=this.map._requestManager.normalizeTileURL(f.tileID.canonical.url(this.tiles,this.scheme)),m={request:this.map._requestManager.transformRequest(l,r.R.Tile),data:void 0,uid:f.uid,tileID:f.tileID,tileZoom:f.tileZoom,zoom:f.tileID.overscaledZ,tileSize:this.tileSize*f.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,showCollisionBoxes:this.map.showCollisionBoxes,isSymbolTile:f.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0,lut:null,maxZoom:null,promoteId:null,pixelRatio:null,scaleFactor:null};if(f.actor&&f.state!=="expired")if(f.state==="loading")f.reloadCallback=o;else{if(f.buckets){const w=Object.values(f.buckets);for(const E of w)E.dirty=!0;return void(f.state="loaded")}f.request=f.actor.send("reloadTile",m,y.bind(this))}else f.actor=this.dispatcher.getActor(),f.request=f.actor.send("loadTile",m,y.bind(this),void 0,!0);function y(w,E){return f.aborted?o(null):w&&w.status!==404?o(w):(this.map._refreshExpiredTiles&&E&&f.setExpiryData(E),f.loadModelData(E,this.map.painter),f.state="loaded",void o(null))}}serialize(){return r.l({},this._options)}},canvas:class extends r.aJ{constructor(f,o,l,m){super(f,o,l,m),o.coordinates?Array.isArray(o.coordinates)&&o.coordinates.length===4&&!o.coordinates.some(y=>!Array.isArray(y)||y.length!==2||y.some(w=>typeof w!="number"))||this.fire(new r.y(new r.V(`sources.${f}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new r.y(new r.V(`sources.${f}`,null,'missing required property "coordinates"'))),o.animate&&typeof o.animate!="boolean"&&this.fire(new r.y(new r.V(`sources.${f}`,null,'optional "animate" property must be a boolean value'))),o.canvas?typeof o.canvas=="string"||o.canvas instanceof HTMLCanvasElement||this.fire(new r.y(new r.V(`sources.${f}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new r.y(new r.V(`sources.${f}`,null,'missing required property "canvas"'))),this.options=o,this.animate=o.animate===void 0||o.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new r.y(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(f){this.map=f,this.load(),this.canvas&&this.animate&&this.play()}onRemove(f){this.pause()}prepare(){let f=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,f=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,f=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const o=this.map.painter.context;this.texture?!f&&!this._playing||this.texture instanceof r.aL||this.texture.update(this.canvas,{premultiply:!0}):this.texture=new r.T(o,this.canvas,o.gl.RGBA8,{premultiply:!0}),this._prepareData(o)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const f of[this.canvas.width,this.canvas.height])if(isNaN(f)||f<=0)return!0;return!1}},custom:class extends r.E{constructor(f,o,l,m){super(),this.id=f,this.type="custom",this._dataType="raster",this._dispatcher=l,this._implementation=o,this.setEventedParent(m),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new r.y(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new r.y(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new Jr(this._implementation.bounds,this.minzoom,this.maxzoom)),o.update=this._update.bind(this),o.clearTiles=this._clearTiles.bind(this),o.coveringTiles=this._coveringTiles.bind(this),r.l(this,r.ay(o,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return r.ay(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new r.z("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new r.z("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(f){this.map=f,this._loaded=!1,this.fire(new r.z("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(f),this.load()}onRemove(f){this._implementation.onRemove&&this._implementation.onRemove(f)}hasTile(f){if(this._implementation.hasTile){const{x:o,y:l,z:m}=f.canonical;return this._implementation.hasTile({x:o,y:l,z:m})}return!this.tileBounds||this.tileBounds.contains(f.canonical)}loadTile(f,o){const{x:l,y:m,z:y}=f.tileID.canonical,w=new AbortController;f.request=Promise.resolve(this._implementation.loadTile({x:l,y:m,z:y},{signal:w.signal})).then((function(E){return delete f.request,f.aborted?(f.state="unloaded",o(null)):E===void 0?(f.state="errored",o(null)):E===null?(this.loadTileData(f,{width:this.tileSize,height:this.tileSize,data:null}),f.state="loaded",o(null)):function(O){return O instanceof ImageData||O instanceof HTMLCanvasElement||O instanceof ImageBitmap||O instanceof HTMLImageElement}(E)?(this.loadTileData(f,E),f.state="loaded",void o(null)):(f.state="errored",o(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`)))}).bind(this)).catch(E=>{E.code!==20&&(f.state="errored",o(E))}),f.request.cancel=()=>w.abort()}loadTileData(f,o){f.setTexture(o,this.map.painter)}unloadTile(f,o){if(f.texture&&f.texture instanceof r.T?(f.destroy(!0),f.texture&&f.texture instanceof r.T&&this.map.painter.saveTileTexture(f.texture)):f.destroy(),this._implementation.unloadTile){const{x:l,y:m,z:y}=f.tileID.canonical;this._implementation.unloadTile({x:l,y:m,z:y})}o&&o()}abortTile(f,o){f.request&&f.request.cancel&&(f.request.cancel(),delete f.request),o&&o()}hasTransition(){return!1}_coveringTiles(){return this.map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map(f=>({x:f.canonical.x,y:f.canonical.y,z:f.canonical.z}))}_clearTiles(){const f=r.aC(this.id,this.scope);this.map.style.clearSource(f)}_update(){this.fire(new r.z("data",{dataType:"source",sourceDataType:"content"}))}}},us=function(f,o,l,m){const y=new ki[o.type](f,o,l,m);if(y.id!==f)throw new Error(`Expected Source id to be ${f} instead of ${y.id}`);return r.aP(["load","abort","unload","serialize","prepare"],y),y};function sh(f,o,l=""){return`${l}:${o.id||""}:${o.layer.id}:${function(m){if("layerId"in m)return`layer:${m.layerId}`;{const{featuresetId:y,importId:w}=m;return`featureset:${y}${w?`:import:${w}`:""}`}}(f.target)}`}function Pl(f,o,l,m=""){if(f.uniqueFeatureID){const y=sh(f,o,m);if(l.has(y))return!0;l.add(y)}return!1}function ah(f,o,l,m,y=!1){const w=o.sourceCache.transform,E=o.sourceCache.tilesIn(f,o.has3DLayers,y);E.sort(ag);const O=[];for(const $ of E){const H=$.tile.queryRenderedFeatures(o,$,l,m,w,y);Object.keys(H).length&&O.push({wrappedTileID:$.tile.tileID.wrapped().key,queryResults:H})}return O.length===0?{}:function($){const H={},G={};for(const Z of $){const X=Z.queryResults,oe=Z.wrappedTileID,xe=G[oe]=G[oe]||{};for(const ve in X){const Ce=X[ve],Te=xe[ve]=xe[ve]||{},Le=H[ve]=H[ve]||[];for(const Ge of Ce)Te[Ge.featureIndex]||(Te[Ge.featureIndex]=!0,Le.push(Ge))}}return H}(O)}function sg(f,o,l,m,y){const w={},E=m.queryRenderedSymbols(f),O=[];for(const $ of Object.keys(E).map(Number))O.push(y[$]);O.sort(ag);for(const $ of O){const H=$.featureIndex.lookupSymbolFeatures(E[$.bucketInstanceId],$.bucketIndex,$.sourceLayerIndex,o,l);for(const G in H){const Z=w[G]=w[G]||[],X=H[G];X.sort((oe,xe)=>{const ve=$.featureSortOrder;if(ve){const Ce=ve.indexOf(oe.featureIndex);return ve.indexOf(xe.featureIndex)-Ce}return xe.featureIndex-oe.featureIndex});for(const oe of X)Z.push(oe)}}return w}function Dy(f,o){const l=f.getRenderableIds().map(w=>f.getTileByID(w)),m=[],y={};for(let w=0;w<l.length;w++){const E=l[w],O=E.tileID.canonical.key;y[O]||(y[O]=!0,E.querySourceFeatures(m,o))}return m}function ag(f,o){const l=f.tileID,m=o.tileID;return l.overscaledZ-m.overscaledZ||l.canonical.y-m.canonical.y||l.wrap-m.wrap||l.canonical.x-m.canonical.x}function lg(f,o){const l={};if(!o)return l;for(const m of f){const y=m.layerIds.map(w=>o.getLayer(w)).filter(Boolean);if(y.length!==0){m.layers=y,m.stateDependentLayerIds&&(m.stateDependentLayers=m.stateDependentLayerIds.map(w=>y.filter(E=>E.id===w)[0]));for(const w of y)l[w.fqid]=m}}return l}const ds=32,Oa=33,Rl=new Uint16Array(8184);for(let f=0;f<2046;f++){let o=f+2,l=0,m=0,y=0,w=0,E=0,O=0;for(1&o?y=w=E=ds:l=m=O=ds;(o>>=1)>1;){const H=l+y>>1,G=m+w>>1;1&o?(y=l,w=m,l=E,m=O):(l=y,m=w,y=E,w=O),E=H,O=G}const $=4*f;Rl[$+0]=l,Rl[$+1]=m,Rl[$+2]=y,Rl[$+3]=w}const tl=new Uint16Array(2178),La=new Uint8Array(1089),nl=new Uint16Array(1089);function Hf(f){return f===0?-.03125:f===32?.03125:0}const cg={type:2,extent:r.ag,loadGeometry:()=>[[new r.P(0,0),new r.P(r.ag+1,0),new r.P(r.ag+1,r.ag+1),new r.P(0,r.ag+1),new r.P(0,0)]]};class _c{constructor(o,l,m,y,w){this.tileID=o,this.uid=r.aV(),this.uses=0,this.tileSize=l,this.tileZoom=m,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=w,y&&y.style&&(this._lastUpdatedBrightness=y.style.getBrightness()),this.expiredRequestCount=0,this.state="loading",y&&y.transform&&(this.projection=y.transform.projection)}registerFadeDuration(o){const l=o+this.timeAdded;l<r.q.now()||this.fadeEndTime&&l<this.fadeEndTime||(this.fadeEndTime=l)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}get tileTransform(){return this._tileTransform||(this._tileTransform=r.aQ(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(o,l,m){if(this.unloadVectorData(),this.state="loaded",o){o.featureIndex&&(this.latestFeatureIndex=o.featureIndex,o.rawTileData?(this.latestRawTileData=o.rawTileData,this.latestFeatureIndex.rawTileData=o.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=o.collisionBoxArray,this.buckets=lg(o.buckets,l.style),this.hasSymbolBuckets=!1;for(const y in this.buckets){const w=this.buckets[y];if(w instanceof r.aX){if(this.hasSymbolBuckets=!0,!m)break;w.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const y in this.buckets){const w=this.buckets[y];if(w instanceof r.aX&&w.hasRTLText){this.hasRTLText=!0,r.aY();break}}this.queryPadding=0;for(const y in this.buckets){const w=this.buckets[y],E=l.style.getOwnLayer(y);if(!E)continue;const O=E.queryRadius(w);this.queryPadding=Math.max(this.queryPadding,O)}o.imageAtlas&&(this.imageAtlas=o.imageAtlas),o.glyphAtlasImage&&(this.glyphAtlasImage=o.glyphAtlasImage),o.lineAtlas&&(this.lineAtlas=o.lineAtlas),this._lastUpdatedBrightness=o.brightness}else this.collisionBoxArray=new r.aW}unloadVectorData(){if(this.hasData()){for(const o in this.buckets)this.buckets[o].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}loadModelData(o,l,m){o&&(o.resourceTiming&&(this.resourceTiming=o.resourceTiming),this.buckets=Object.assign({},this.buckets,lg(o.buckets,l.style)),o.featureIndex&&(this.latestFeatureIndex=o.featureIndex))}getBucket(o){return this.buckets[o.fqid]}upload(o){for(const y in this.buckets){const w=this.buckets[y];w.uploadPending()&&w.upload(o)}const l=o.gl,m=this.imageAtlas;if(m&&!m.uploaded){const y=!!Object.keys(m.patternPositions).length;this.imageAtlasTexture=new r.T(o,m.image,l.RGBA8,{useMipmap:y}),this.imageAtlas.uploaded=!0}this.glyphAtlasImage&&(this.glyphAtlasTexture=new r.T(o,this.glyphAtlasImage,l.R8),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new r.T(o,this.lineAtlas.image,l.R8),this.lineAtlas.uploaded=!0)}prepare(o,l,m){if(this.imageAtlas&&this.imageAtlasTexture&&this.imageAtlas.patchUpdatedImages(o,this.imageAtlasTexture,m),!l||!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData)return;const y=l.style.getBrightness();(this._lastUpdatedBrightness||y)&&(this._lastUpdatedBrightness&&y&&Math.abs(this._lastUpdatedBrightness-y)<.001||(this.updateBuckets(l,this._lastUpdatedBrightness!==y),this._lastUpdatedBrightness=y))}queryRenderedFeatures(o,l,m,y,w,E){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData&&!this.latestFeatureIndex.is3DTile)return{};const O=function($,H){const G=r.ab.mat4.fromScaling([],[.5*$.width,.5*-$.height,1]);return r.ab.mat4.translate(G,G,[1,-1,0]),r.ab.mat4.multiply(G,G,$.calculateProjMatrix(H.toUnwrapped())),Float32Array.from(G)}(w,this.tileID);return this.latestFeatureIndex.query(o,{tilespaceGeometry:l,pixelPosMatrix:O,transform:y,availableImages:m,tileTransform:this.tileTransform})}querySourceFeatures(o,l){const m=this.latestFeatureIndex;if(!m||!m.rawTileData)return;const y=m.loadVTLayers(),w=l?l.sourceLayer:"",E=y._geojsonTileLayer||y[w];if(!E)return;const O=r.aZ(l&&l.filter),{z:$,x:H,y:G}=this.tileID.canonical,Z={z:$,x:H,y:G};for(let X=0;X<E.length;X++){const oe=E.feature(X);if(O.needGeometry){const Ce=r.a_(oe,!0);if(!O.filter(new r.a8(this.tileID.overscaledZ),Ce,this.tileID.canonical))continue}else if(!O.filter(new r.a8(this.tileID.overscaledZ),oe))continue;const xe=m.getId(oe,w),ve=new r.a$(oe,$,H,G,xe);ve.tile=Z,o.push(ve)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return!!this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(o){const l=this.expirationTime;if(o.cacheControl){const m=r.b0(o.cacheControl);m["max-age"]&&(this.expirationTime=Date.now()+1e3*m["max-age"])}else o.expires&&(this.expirationTime=new Date(o.expires).getTime());if(this.expirationTime){const m=Date.now();let y=!1;if(this.expirationTime>m)y=!1;else if(l)if(this.expirationTime<l)y=!0;else{const w=this.expirationTime-l;w?this.expirationTime=m+Math.max(w,3e4):y=!0}else y=!0;y?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}refreshFeatureState(o){this.latestFeatureIndex&&(this.latestFeatureIndex.rawTileData||this.latestFeatureIndex.is3DTile)&&o&&this.updateBuckets(o)}updateBuckets(o,l){if(!this.latestFeatureIndex||!o.style)return;const m=this.latestFeatureIndex.loadVTLayers(),y=o.style.listImages(),w=o.style.getBrightness();for(const E in this.buckets){if(!o.style.hasLayer(E))continue;const O=this.buckets[E],$=O.layers[0],H=$.sourceLayer||"_geojsonTileLayer",G=m[H],Z=o.style.getLayerSourceCache($);let X={};Z&&(X=Z._state.getState(H,void 0));const oe=this.imageAtlas&&this.imageAtlas.patternPositions||{},xe=Object.keys(X).length>0&&!l;xe&&!O.stateDependentLayers.length&&!l||O.update(X,G,y,oe,xe?O.stateDependentLayers:O.layers,l,w),(O instanceof r.b1||O instanceof r.b2)&&o._terrain&&o._terrain.enabled&&Z&&O.programConfigurations.needsUpload&&o._terrain._clearRenderCacheForTile(Z.id,this.tileID);const ve=o&&o.style&&o.style.getOwnLayer(E);ve&&(this.queryPadding=Math.max(this.queryPadding,ve.queryRadius(O)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<r.q.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(o){this.symbolFadeHoldUntil=r.q.now()+o}setTexture(o,l){const m=l.context,y=m.gl;this.texture=this.texture||l.getTileTexture(o.width),this.texture&&this.texture instanceof r.T?this.texture.update(o):(this.texture=new r.T(m,o,y.RGBA8,{useMipmap:!0}),this.texture.bind(y.LINEAR,y.CLAMP_TO_EDGE))}setDependencies(o,l){const m={};for(const y of l)m[y]=!0;this.dependencies[o]=m}hasDependency(o,l){for(const m of o){const y=this.dependencies[m];if(y){for(const w of l)if(y[w])return!0}}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(o,l){if(!l||l.name==="mercator"||this._tileDebugBuffer)return;const m=r.b3(cg,this.tileID.canonical,this.tileTransform)[0],y=new r.b4,w=new r.b5;for(let E=0;E<m.length;E++){const{x:O,y:$}=m[E];y.emplaceBack(O,$),w.emplaceBack(E)}w.emplaceBack(0),this._tileDebugIndexBuffer=o.createIndexBuffer(w),this._tileDebugBuffer=o.createVertexBuffer(y,r.b6.members),this._tileDebugSegments=r.b7.simpleSegment(0,0,y.length,w.length)}_makeTileBoundsBuffers(o,l){if(this._tileBoundsBuffer||!l||l.name==="mercator")return;const m=r.b3(cg,this.tileID.canonical,this.tileTransform)[0];let y,w;if(this.isRaster){const E=function(O,$){const H=r.aQ(O,$),G=Math.pow(2,O.z);for(let Ce=0;Ce<Oa;Ce++)for(let Te=0;Te<Oa;Te++){const Le=r.aR((O.x+(Te+Hf(Te))/ds)/G),Ge=r.aS((O.y+(Ce+Hf(Ce))/ds)/G),He=$.project(Le,Ge),rt=Ce*Oa+Te;tl[2*rt+0]=Math.round((He.x*H.scale-H.x)*r.ag),tl[2*rt+1]=Math.round((He.y*H.scale-H.y)*r.ag)}La.fill(0),nl.fill(0);for(let Ce=2045;Ce>=0;Ce--){const Te=4*Ce,Le=Rl[Te+0],Ge=Rl[Te+1],He=Rl[Te+2],rt=Rl[Te+3],Xe=Le+He>>1,et=Ge+rt>>1,Ye=Xe+et-Ge,at=et+Le-Xe,gt=Ge*Oa+Le,Vt=rt*Oa+He,Rt=et*Oa+Xe,tn=Math.hypot((tl[2*gt+0]+tl[2*Vt+0])/2-tl[2*Rt+0],(tl[2*gt+1]+tl[2*Vt+1])/2-tl[2*Rt+1])>=16;La[Rt]=La[Rt]||(tn?1:0),Ce<1022&&(La[Rt]=La[Rt]||La[(Ge+at>>1)*Oa+(Le+Ye>>1)]||La[(rt+at>>1)*Oa+(He+Ye>>1)])}const Z=new r.aT,X=new r.aU;let oe=0;function xe(Ce,Te){const Le=Te*Oa+Ce;return nl[Le]===0&&(Z.emplaceBack(tl[2*Le+0],tl[2*Le+1],Ce*r.ag/ds,Te*r.ag/ds),nl[Le]=++oe),nl[Le]-1}function ve(Ce,Te,Le,Ge,He,rt){const Xe=Ce+Le>>1,et=Te+Ge>>1;if(Math.abs(Ce-He)+Math.abs(Te-rt)>1&&La[et*Oa+Xe])ve(He,rt,Ce,Te,Xe,et),ve(Le,Ge,He,rt,Xe,et);else{const Ye=xe(Ce,Te),at=xe(Le,Ge),gt=xe(He,rt);X.emplaceBack(Ye,at,gt)}}return ve(0,0,ds,ds,ds,0),ve(ds,ds,0,0,0,ds),{vertices:Z,indices:X}}(this.tileID.canonical,l);y=E.vertices,w=E.indices}else{y=new r.aT,w=new r.aU;for(const{x:O,y:$}of m)y.emplaceBack(O,$,0,0);const E=r.b8(y.int16,void 0,4);for(let O=0;O<E.length;O+=3)w.emplaceBack(E[O],E[O+1],E[O+2])}this._tileBoundsBuffer=o.createVertexBuffer(y,r.b9.members),this._tileBoundsIndexBuffer=o.createIndexBuffer(w),this._tileBoundsSegments=r.b7.simpleSegment(0,0,y.length,w.length)}_makeGlobeTileDebugBuffers(o,l){const m=l.projection;if(!m||m.name!=="globe"||l.freezeTileCoverage)return;const y=this.tileID.canonical,w=r.ba(y,l),E=r.bb(w),O=r.ae(l.zoom);let $;O>0&&($=r.ab.mat4.invert(new Float64Array(16),l.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(o,y,l,E,$,O),this._makeGlobeTileDebugTextBuffer(o,y,l,E,$,O)}_globePoint(o,l,m,y,w,E,O){let $=r.bc(o,l,m);if(E){const H=1<<m.z,G=r.at(y.center.lng),Z=r.aA(y.center.lat),X=(m.x+.5)/H-G;let oe=0;X>.5?oe=-1:X<-.5&&(oe=1);let xe=(o/r.ag+m.x)/H+oe,ve=(l/r.ag+m.y)/H;xe=(xe-G)*y._pixelsPerMercatorPixel+G,ve=(ve-Z)*y._pixelsPerMercatorPixel+Z;const Ce=[xe*y.worldSize,ve*y.worldSize,0];r.ab.vec3.transformMat4(Ce,Ce,E),$=r.bd($,Ce,O)}return r.ab.vec3.transformMat4($,$,w)}_makeGlobeTileDebugBorderBuffer(o,l,m,y,w,E){const O=new r.b4,$=new r.b5,H=new r.be,G=(X,oe,xe,ve,Ce)=>{const Te=(xe-X)/(Ce-1),Le=(ve-oe)/(Ce-1),Ge=O.length;for(let He=0;He<Ce;He++){const rt=X+He*Te,Xe=oe+He*Le;O.emplaceBack(rt,Xe);const et=this._globePoint(rt,Xe,l,m,y,w,E);H.emplaceBack(et[0],et[1],et[2]),$.emplaceBack(Ge+He)}},Z=r.ag;G(0,0,Z,0,16),G(Z,0,Z,Z,16),G(Z,Z,0,Z,16),G(0,Z,0,0,16),this._tileDebugIndexBuffer=o.createIndexBuffer($),this._tileDebugBuffer=o.createVertexBuffer(O,r.b6.members),this._globeTileDebugBorderBuffer=o.createVertexBuffer(H,r.bf.members),this._tileDebugSegments=r.b7.simpleSegment(0,0,O.length,$.length)}_makeGlobeTileDebugTextBuffer(o,l,m,y,w,E){const O=r.ag/4,$=new r.b4,H=new r.aU,G=new r.be,Z=25;H.reserve(32),$.reserve(Z),G.reserve(Z);const X=(oe,xe)=>Z*oe+xe;for(let oe=0;oe<Z;oe++){const xe=oe*O;for(let ve=0;ve<Z;ve++){const Ce=ve*O;$.emplaceBack(Ce,xe);const Te=this._globePoint(Ce,xe,l,m,y,w,E);G.emplaceBack(Te[0],Te[1],Te[2])}}for(let oe=0;oe<4;oe++)for(let xe=0;xe<4;xe++){const ve=X(oe,xe),Ce=X(oe,xe+1),Te=X(oe+1,xe),Le=X(oe+1,xe+1);H.emplaceBack(ve,Ce,Te),H.emplaceBack(Te,Ce,Le)}this._tileDebugTextIndexBuffer=o.createIndexBuffer(H),this._tileDebugTextBuffer=o.createVertexBuffer($,r.b6.members),this._globeTileDebugTextBuffer=o.createVertexBuffer(G,r.bf.members),this._tileDebugTextSegments=r.b7.simpleSegment(0,0,Z,32)}destroy(o=!1){for(const l in this.buckets)this.buckets[l].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&(this.imageAtlasTexture.destroy(),delete this.imageAtlasTexture),this.glyphAtlasTexture&&(this.glyphAtlasTexture.destroy(),delete this.glyphAtlasTexture),this.lineAtlasTexture&&(this.lineAtlasTexture.destroy(),delete this.lineAtlasTexture),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),!o&&this.texture&&this.texture instanceof r.T&&(this.texture.destroy(),delete this.texture),this.hillshadeFBO&&(this.hillshadeFBO.destroy(),delete this.hillshadeFBO),this.dem&&delete this.dem,this.neighboringTiles&&delete this.neighboringTiles,this.demTexture&&(this.demTexture.destroy(),delete this.demTexture),this.rasterParticleState&&(this.rasterParticleState.destroy(),delete this.rasterParticleState),this.latestFeatureIndex=null,this.state="unloaded"}}r.bg.setPbf(r.bh);class yc extends _c{constructor(o,l,m,y,w){super(o,l,m,y,w),this._workQueue=[],this._fetchQueue=[],this._isHeaderLoaded=!1}setTexture(o,l){const m=l.context,y=m.gl;this.texture=this.texture||l.getTileTexture(o.width),this.texture&&this.texture instanceof r.T?this.texture.update(o,{premultiply:!1}):this.texture=new r.T(m,o,y.RGBA8,{premultiply:!1})}flushQueues(){for(;this._workQueue.length;)this._workQueue.pop()();for(;this._fetchQueue.length;)this._fetchQueue.pop()()}fetchHeader(o=16384,l){const m=this._mrt=new r.bg(30),y=Object.assign({},this.requestParams,{headers:{Range:"bytes=0-"+(o-1)}});return this.entireBuffer=null,this.request=r.bi(y,(w,E,O,$)=>{if(w)l(w);else try{const H=m.getHeaderLength(E);if(H>o)return void(this.request=this.fetchHeader(H,l));m.parseHeader(E),this._isHeaderLoaded=!0;let G=0;for(const Z of Object.values(m.layers))G=Math.max(G,Z.dataIndex[Z.dataIndex.length-1].last_byte);E.byteLength>=G&&(this.entireBuffer=E),l(null,this.entireBuffer||E,O,$)}catch(H){l(H)}}),this.request}fetchBand(o,l,m){const y=this._mrt;if(!this._isHeaderLoaded||!y)return void m(new Error("Tile header is not ready"));const w=this.actor;if(!w)return void m(new Error("Can't fetch tile band without an actor"));let E;const O=(Z,X)=>{E.complete(Z,X),Z?m(Z):(this.updateTextureDescriptor(o,l),m(null,this.textureDescriptor&&this.textureDescriptor.img))},$=(Z,X)=>{if(Z)return m(Z);const oe=w.send("decodeRasterArray",{buffer:X,task:E},O,void 0,!0);this._workQueue.push(()=>{oe&&oe.cancel(),E.cancel()})},H=y.getLayer(o);if(!H)return void m(new Error(`Unknown sourceLayer "${o}"`));if(H.hasDataForBand(l))return this.updateTextureDescriptor(o,l),void m(null,this.textureDescriptor?this.textureDescriptor.img:null);const G=H.getDataRange([l]);if(E=y.createDecodingTask(G),!E||E.tasks.length)if(this.flushQueues(),this.entireBuffer)$(null,this.entireBuffer.slice(G.firstByte,G.lastByte+1));else{const Z=Object.assign({},this.requestParams,{headers:{Range:`bytes=${G.firstByte}-${G.lastByte}`}}),X=r.bi(Z,$);this._fetchQueue.push(()=>{X.cancel(),E.cancel()})}else m(null)}updateNeeded(o,l){return(!this.textureDescriptor||this.textureDescriptor.band!==l||this.textureDescriptor.layer!==o)&&this.state!=="errored"}updateTextureDescriptor(o,l){if(!this._mrt)return;const m=this._mrt.getLayer(o);if(!m||!m.hasBand(l)||!m.hasDataForBand(l))return;const{bytes:y,tileSize:w,buffer:E,offset:O,scale:$}=m.getBandView(l),H=w+2*E,G={data:y,width:H,height:H},Z=this.texture;Z&&Z instanceof r.T&&Z.update(G,{premultiply:!1}),this.textureDescriptor={layer:o,band:l,img:G,buffer:E,offset:O,tileSize:w,format:m.pixelFormat,mix:[$,256*$,65536*$,16777216*$]}}}class zy{constructor(o,l){this.max=o,this.onRemove=l,this.reset()}reset(){for(const o in this.data)for(const l of this.data[o])l.timeout&&clearTimeout(l.timeout),this.onRemove(l.value);return this.data={},this.order=[],this}add(o,l,m){const y=o.wrapped().key;this.data[y]===void 0&&(this.data[y]=[]);const w={value:l,timeout:void 0};if(m!==void 0&&(w.timeout=setTimeout(()=>{this.remove(o,w)},m)),this.data[y].push(w),this.order.push(y),this.order.length>this.max){const E=this._getAndRemoveByKey(this.order[0]);E&&this.onRemove(E)}return this}has(o){return o.wrapped().key in this.data}getAndRemove(o){return this.has(o)?this._getAndRemoveByKey(o.wrapped().key):null}_getAndRemoveByKey(o){const l=this.data[o].shift();return l.timeout&&clearTimeout(l.timeout),this.data[o].length===0&&delete this.data[o],this.order.splice(this.order.indexOf(o),1),l.value}getByKey(o){const l=this.data[o];return l?l[0].value:null}get(o){return this.has(o)?this.data[o.wrapped().key][0].value:null}remove(o,l){if(!this.has(o))return this;const m=o.wrapped().key,y=l===void 0?0:this.data[m].indexOf(l),w=this.data[m][y];return this.data[m].splice(y,1),w.timeout&&clearTimeout(w.timeout),this.data[m].length===0&&delete this.data[m],this.onRemove(w.value),this.order.splice(this.order.indexOf(m),1),this}setMaxSize(o){for(this.max=o;this.order.length>this.max;){const l=this._getAndRemoveByKey(this.order[0]);l&&this.onRemove(l)}return this}filter(o){const l=[];for(const m in this.data)for(const y of this.data[m])o(y.value)||l.push(y);for(const m of l)this.remove(m.value.tileID,m)}}class ug{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(o,l,m){const y=String(l);if(this.stateChanges[o]=this.stateChanges[o]||{},this.stateChanges[o][y]=this.stateChanges[o][y]||{},r.l(this.stateChanges[o][y],m),this.deletedStates[o]===null){this.deletedStates[o]={};for(const w in this.state[o])w!==y&&(this.deletedStates[o][w]=null)}else if(this.deletedStates[o]&&this.deletedStates[o][y]===null){this.deletedStates[o][y]={};for(const w in this.state[o][y])m[w]||(this.deletedStates[o][y][w]=null)}else for(const w in m)this.deletedStates[o]&&this.deletedStates[o][y]&&this.deletedStates[o][y][w]===null&&delete this.deletedStates[o][y][w]}removeFeatureState(o,l,m){if(this.deletedStates[o]===null)return;const y=String(l);if(this.deletedStates[o]=this.deletedStates[o]||{},m&&l!==void 0)this.deletedStates[o][y]!==null&&(this.deletedStates[o][y]=this.deletedStates[o][y]||{},this.deletedStates[o][y][m]=null);else if(l!==void 0)if(this.stateChanges[o]&&this.stateChanges[o][y])for(m in this.deletedStates[o][y]={},this.stateChanges[o][y])this.deletedStates[o][y][m]=null;else this.deletedStates[o][y]=null;else this.deletedStates[o]=null}getState(o,l){const m=this.state[o]||{},y=this.stateChanges[o]||{},w=this.deletedStates[o];if(w===null)return{};if(l!==void 0){const O=String(l),$=r.l({},m[O],y[O]);if(w){const H=w[l];if(H===null)return{};for(const G in H)delete $[G]}return $}const E=r.l({},m,y);if(w)for(const O in w)delete E[O];return E}initializeTileState(o,l){o.refreshFeatureState(l)}coalesceChanges(o,l){const m={};for(const y in this.stateChanges){this.state[y]=this.state[y]||{};const w={};for(const E in this.stateChanges[y])this.state[y][E]||(this.state[y][E]={}),r.l(this.state[y][E],this.stateChanges[y][E]),w[E]=this.state[y][E];m[y]=w}for(const y in this.deletedStates){this.state[y]=this.state[y]||{};const w={};if(this.deletedStates[y]===null)for(const E in this.state[y])w[E]={},this.state[y][E]={};else for(const E in this.deletedStates[y]){if(this.deletedStates[y][E]===null)this.state[y][E]={};else if(this.state[y][E])for(const O of Object.keys(this.deletedStates[y][E]))delete this.state[y][E][O];w[E]=this.state[y][E]}m[y]=m[y]||{},r.l(m[y],w)}if(this.stateChanges={},this.deletedStates={},Object.keys(m).length!==0)for(const y in o)o[y].refreshFeatureState(l)}}class _a extends r.E{constructor(o,l,m){super(),this.id=o,this._onlySymbols=m,l.on("data",y=>{y.dataType==="source"&&y.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&y.dataType==="source"&&y.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform))}),l.on("error",()=>{this._sourceErrored=!0}),this._source=l,this._tiles={},this._cache=new zy(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=l.minTileCacheSize,this._maxTileCacheSize=l.maxTileCacheSize,this._loadedParentTiles={},this.castsShadows=!1,this.tileCoverLift=0,this._coveredTiles={},this._shadowCasterTiles={},this._state=new ug,this._isRaster=this._source.type==="raster"||this._source.type==="raster-dem"||this._source.type==="raster-array"||this._source.type==="custom"&&this._source._dataType==="raster"}onAdd(o){this.map=o,this._minTileCacheSize=this._minTileCacheSize===void 0&&o?o._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=this._maxTileCacheSize===void 0&&o?o._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const o in this._tiles){const l=this._tiles[o];if(l.state!=="loaded"&&l.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const o=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,o&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(o,l){return o.isSymbolTile=this._onlySymbols,o.isExtraShadowCaster=this._shadowCasterTiles[o.tileID.key],this._source.loadTile(o,l)}_unloadTile(o){if(this._source.unloadTile)return this._source.unloadTile(o)}_abortTile(o){if(this._source.abortTile)return this._source.abortTile(o)}serialize(){return this._source.serialize()}prepare(o){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const l in this._tiles){const m=this._tiles[l];m.upload(o),m.prepare(this.map.style.imageManager,this.map?this.map.painter:null,this._source.scope)}}getIds(){return r.bj(this._tiles).map(o=>o.tileID).sort(io).map(o=>o.key)}getRenderableIds(o,l){const m=[];for(const y in this._tiles)this._isIdRenderable(+y,o,l)&&m.push(this._tiles[y]);return o?m.sort((y,w)=>{const E=y.tileID,O=w.tileID,$=new r.P(E.canonical.x,E.canonical.y)._rotate(this.transform.angle),H=new r.P(O.canonical.x,O.canonical.y)._rotate(this.transform.angle);return E.overscaledZ-O.overscaledZ||H.y-$.y||H.x-$.x}).map(y=>y.tileID.key):m.map(y=>y.tileID).sort(io).map(y=>y.key)}hasRenderableParent(o){const l=this.findLoadedParent(o,0);return!!l&&this._isIdRenderable(l.tileID.key)}_isIdRenderable(o,l,m){return this._tiles[o]&&this._tiles[o].hasData()&&!this._coveredTiles[o]&&(l||!this._tiles[o].holdingForFade())&&(m||!this._shadowCasterTiles[o])}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const o in this._tiles)this._tiles[o].state!=="errored"&&this._reloadTile(+o,"reloading")}}_reloadTile(o,l){const m=this._tiles[o];m&&(m.state!=="loading"&&(m.state=l),this._loadTile(m,this._tileLoaded.bind(this,m,o,l)))}_tileLoaded(o,l,m,y){if(y)if(o.state="errored",y.status!==404)this._source.fire(new r.y(y,{tile:o}));else{if(this._source.fire(new r.z("data",{dataType:"source",sourceDataType:"error",sourceId:this._source.id,tile:o})),!(o.tileID.key in this._loadedParentTiles))return;if(this._source.type==="raster-dem"&&this.usedForTerrain&&this.map.painter.terrain){const w=this.map.painter.terrain;this.update(this.transform,w.getScaledDemTileSize(),!0),w.resetTileLookupCache(this.id)}else this.update(this.transform)}else o.timeAdded=r.q.now(),m==="expired"&&(o.refreshedUponExpiration=!0),this._setTileReloadTimer(l,o),this._source.type==="raster-dem"&&o.dem&&this._backfillDEM(o),this._state.initializeTileState(o,this.map?this.map.painter:null),this._source.fire(new r.z("data",{dataType:"source",tile:o,coord:o.tileID,sourceCacheId:this.id}))}_backfillDEM(o){const l=this.getRenderableIds();for(let y=0;y<l.length;y++){const w=l[y];if(o.neighboringTiles&&o.neighboringTiles[w]){const E=this.getTileByID(w);m(o,E),m(E,o)}}function m(y,w){if(!y.dem||y.dem.borderReady)return;y.needsHillshadePrepare=!0,y.needsDEMTextureUpload=!0;let E=w.tileID.canonical.x-y.tileID.canonical.x;const O=w.tileID.canonical.y-y.tileID.canonical.y,$=Math.pow(2,y.tileID.canonical.z),H=w.tileID.key;E===0&&O===0||Math.abs(O)>1||(Math.abs(E)>1&&(Math.abs(E+$)===1?E+=$:Math.abs(E-$)===1&&(E-=$)),w.dem&&y.dem&&(y.dem.backfillBorder(w.dem,E,O),y.neighboringTiles&&y.neighboringTiles[H]&&(y.neighboringTiles[H].backfilled=!0)))}}getTile(o){return this.getTileByID(o.key)}getTileByID(o){return this._tiles[o]}_retainLoadedChildren(o,l,m,y){for(const w in this._tiles){let E=this._tiles[w];if(y[w]||!E.hasData()||E.tileID.overscaledZ<=l||E.tileID.overscaledZ>m)continue;let O=E.tileID;for(;E&&E.tileID.overscaledZ>l+1;){const H=E.tileID.scaledTo(E.tileID.overscaledZ-1);E=this._tiles[H.key],E&&E.hasData()&&(O=H)}let $=O;for(;$.overscaledZ>l;)if($=$.scaledTo($.overscaledZ-1),o[$.key]){y[O.key]=O;break}}}findLoadedParent(o,l){if(o.key in this._loadedParentTiles){const m=this._loadedParentTiles[o.key];return m&&m.tileID.overscaledZ>=l?m:null}for(let m=o.overscaledZ-1;m>=l;m--){const y=o.scaledTo(m),w=this._getLoadedTile(y);if(w)return w}}_getLoadedTile(o){const l=this._tiles[o.key];return l&&l.hasData()?l:this._cache.getByKey(this._source.reparseOverscaled?o.wrapped().key:o.canonical.key)}updateCacheSize(o,l){l=l||this._source.tileSize;const m=Math.ceil(o.width/l)+1,y=Math.ceil(o.height/l)+1,w=Math.floor(m*y*5),E=typeof this._minTileCacheSize=="number"?Math.max(this._minTileCacheSize,w):w,O=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,E):E;this._cache.setMaxSize(O)}handleWrapJump(o){const l=Math.round((o-(this._prevLng===void 0?o:this._prevLng))/360);if(this._prevLng=o,l){const m={};for(const y in this._tiles){const w=this._tiles[y];w.tileID=w.tileID.unwrapTo(w.tileID.wrap+l),m[w.tileID.key]=w}this._tiles=m;for(const y in this._timers)clearTimeout(this._timers[y]),delete this._timers[y];for(const y in this._tiles)this._setTileReloadTimer(+y,this._tiles[y])}}update(o,l,m,y){if(this.transform=o,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!m)return;this.updateCacheSize(o,l),this.transform.projection.name!=="globe"&&this.handleWrapJump(this.transform.center.lng),this._shadowCasterTiles={},this._coveredTiles={};const w=this._source.type==="batched-model";let E,O=this._source.maxzoom;const $=this.map&&this.map.painter?this.map.painter._terrain:null;if($&&$.sourceCache===this&&$.attenuationRange()){const Z=$.attenuationRange()[0],X=Math.floor(Z)-Math.log2($.getDemUpscale());O>X&&(O=X)}if(this.used||this.usedForTerrain){if(this._source.tileID)E=o.getVisibleUnwrappedCoordinates(this._source.tileID).map(Z=>new r.aG(Z.canonical.z,Z.wrap,Z.canonical.z,Z.canonical.x,Z.canonical.y));else if(this.tileCoverLift!==0){const Z=o.clone();Z.tileCoverLift=this.tileCoverLift,E=Z.coveringTiles({tileSize:l||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:O,roundZoom:this._source.roundZoom&&!m,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain,calculateQuadrantVisibility:w}),this._source.minzoom<=1&&o.projection.name==="globe"&&(E.push(new r.aG(1,0,1,0,0)),E.push(new r.aG(1,0,1,1,0)),E.push(new r.aG(1,0,1,0,1)),E.push(new r.aG(1,0,1,1,1)))}else if(E=o.coveringTiles({tileSize:l||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:O,roundZoom:this._source.roundZoom&&!m,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain,calculateQuadrantVisibility:w}),this._source.hasTile){const Z=this._source.hasTile.bind(this._source);E=E.filter(X=>Z(X))}}else E=[];if(E.length>0&&this.castsShadows&&y&&this.transform.projection.name!=="globe"&&!this.usedForTerrain&&!dg(this._source.type)){const Z=o.coveringZoomLevel({tileSize:l||this._source.tileSize,roundZoom:this._source.roundZoom&&!m}),X=Math.min(Z,this._source.maxzoom);if(w){const oe=o.extendTileCover(E,X);for(const xe of oe)E.push(xe)}else{const oe=o.extendTileCover(E,X,y);for(const xe of oe)this._shadowCasterTiles[xe.key]=!0,E.push(xe)}}const H=this._updateRetainedTiles(E);if(dg(this._source.type)&&E.length!==0){const Z={},X={},oe=Object.keys(H);for(const ve of oe){const Ce=H[ve],Te=this._tiles[ve];if(!Te||Te.fadeEndTime&&Te.fadeEndTime<=r.q.now())continue;const Le=this.findLoadedParent(Ce,Math.max(Ce.overscaledZ-_a.maxOverzooming,this._source.minzoom));Le&&(this._addTile(Le.tileID),Z[Le.tileID.key]=Le.tileID),X[ve]=Ce}const xe=E[E.length-1].overscaledZ;for(const ve in this._tiles){const Ce=this._tiles[ve];if(H[ve]||!Ce.hasData())continue;let Te=Ce.tileID;for(;Te.overscaledZ>xe;){Te=Te.scaledTo(Te.overscaledZ-1);const Le=this._tiles[Te.key];if(Le&&Le.hasData()&&X[Te.key]){H[ve]=Ce.tileID;break}}}for(const ve in Z)H[ve]||(this._coveredTiles[ve]=!0,H[ve]=Z[ve])}for(const Z in H)this._tiles[Z].clearFadeHold();const G=r.bk(this._tiles,H);for(const Z of G){const X=this._tiles[Z];X.hasSymbolBuckets&&!X.holdingForFade()?X.setHoldDuration(this.map._fadeDuration):X.hasSymbolBuckets&&!X.symbolFadeFinished()||this._removeTile(+Z)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const o in this._tiles)this._tiles[o].holdingForFade()&&this._removeTile(+o)}_updateRetainedTiles(o){const l={};if(o.length===0)return l;const m={},y=o.reduce((H,G)=>Math.min(H,G.overscaledZ),1/0),w=o[0].overscaledZ,E=Math.max(w-_a.maxOverzooming,this._source.minzoom),O=Math.max(w+_a.maxUnderzooming,this._source.minzoom),$={};for(const H of o){const G=this._addTile(H);l[H.key]=H,G.hasData()||y<this._source.maxzoom&&($[H.key]=H)}this._retainLoadedChildren($,y,O,l);for(const H of o){let G=this._tiles[H.key];if(G.hasData())continue;if(H.canonical.z>=this._source.maxzoom){const X=H.children(this._source.maxzoom)[0],oe=this.getTile(X);if(oe&&oe.hasData()){l[X.key]=X;continue}}else{const X=H.children(this._source.maxzoom);if(l[X[0].key]&&l[X[1].key]&&l[X[2].key]&&l[X[3].key])continue}let Z=G.wasRequested();for(let X=H.overscaledZ-1;X>=E;--X){const oe=H.scaledTo(X);if(m[oe.key]||(m[oe.key]=!0,G=this.getTile(oe),!G&&Z&&(G=this._addTile(oe)),G&&(l[oe.key]=oe,Z=G.wasRequested(),G.hasData())))break}}return l}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const o in this._tiles){const l=[];let m,y=this._tiles[o].tileID;for(;y.overscaledZ>0;){if(y.key in this._loadedParentTiles){m=this._loadedParentTiles[y.key];break}l.push(y.key);const w=y.scaledTo(y.overscaledZ-1);if(m=this._getLoadedTile(w),m)break;y=w}for(const w of l)this._loadedParentTiles[w]=m}}_addTile(o){let l=this._tiles[o.key];if(l)return l.isExtraShadowCaster!==!0||this._shadowCasterTiles[o.key]||this._reloadTile(o.key,"reloading"),l;l=this._cache.getAndRemove(o),l&&(this._setTileReloadTimer(o.key,l),l.tileID=o,this._state.initializeTileState(l,this.map?this.map.painter:null),this._cacheTimers[o.key]&&(clearTimeout(this._cacheTimers[o.key]),delete this._cacheTimers[o.key],this._setTileReloadTimer(o.key,l)));const m=!!l;if(!m){const y=this.map?this.map.painter:null,w=this._source.tileSize*o.overscaleFactor();l=this._source.type==="raster-array"?new yc(o,w,this.transform.tileZoom,y,this._isRaster):new _c(o,w,this.transform.tileZoom,y,this._isRaster),this._loadTile(l,this._tileLoaded.bind(this,l,o.key,l.state))}return l?(l.uses++,this._tiles[o.key]=l,m||this._source.fire(new r.z("dataloading",{tile:l,coord:l.tileID,dataType:"source"})),l):null}_setTileReloadTimer(o,l){o in this._timers&&(clearTimeout(this._timers[o]),delete this._timers[o]);const m=l.getExpiryTimeout();m&&(this._timers[o]=setTimeout(()=>{this._reloadTile(o,"expired"),delete this._timers[o]},m))}_removeTile(o){const l=this._tiles[o];l&&(l.uses--,delete this._tiles[o],this._timers[o]&&(clearTimeout(this._timers[o]),delete this._timers[o]),l.uses>0||(l.hasData()&&l.state!=="reloading"||l.state==="empty"?this._cache.add(l.tileID,l,l.getExpiryTimeout()):(l.aborted=!0,this._abortTile(l),this._unloadTile(l))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const o in this._tiles)this._removeTile(+o);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(o,l,m){const y=[],w=this.transform;if(!w)return y;const E=w.projection.name==="globe",O=r.at(w.center.lng);for(const $ in this._tiles){const H=this._tiles[$];if(m&&H.clearQueryDebugViz(),H.holdingForFade())continue;let G;if(E){const Z=H.tileID.canonical;if(Z.z===0){const X=[Math.abs(r.aw(O,...cr(Z,-1))-O),Math.abs(r.aw(O,...cr(Z,1))-O)];G=[0,2*X.indexOf(Math.min(...X))-1]}else{const X=[Math.abs(r.aw(O,...cr(Z,-1))-O),Math.abs(r.aw(O,...cr(Z,0))-O),Math.abs(r.aw(O,...cr(Z,1))-O)];G=[X.indexOf(Math.min(...X))-1]}}else G=[0];for(const Z of G){const X=o.containsTile(H,w,l,Z);X&&y.push(X)}}return y}getShadowCasterCoordinates(){return this._getRenderableCoordinates(!1,!0)}getVisibleCoordinates(o){return this._getRenderableCoordinates(o)}_getRenderableCoordinates(o,l){const m=this.getRenderableIds(o,l).map(w=>this._tiles[w].tileID),y=this.transform.projection.name==="globe";for(const w of m)w.projMatrix=this.transform.calculateProjMatrix(w.toUnwrapped()),w.expandedProjMatrix=y?this.transform.calculateProjMatrix(w.toUnwrapped(),!1,!0):w.projMatrix;return m}sortCoordinatesByDistance(o){const l=o.slice(),m=this.transform._camera.position,y=this.transform._camera.forward(),w={};for(const E of l){const O=1/(1<<E.canonical.z);w[E.key]=((E.canonical.x+.5)*O+E.wrap-m[0])*y[0]+((E.canonical.y+.5)*O-m[1])*y[1]-m[2]*y[2]}return l.sort((E,O)=>w[E.key]-w[O.key]),l}hasTransition(){if(this._source.hasTransition())return!0;if(dg(this._source.type))for(const o in this._tiles){const l=this._tiles[o];if(l.fadeEndTime!==void 0&&l.fadeEndTime>=r.q.now())return!0}return!1}setFeatureState(o,l,m){this._state.updateState(o=o||"_geojsonTileLayer",l,m)}removeFeatureState(o,l,m){this._state.removeFeatureState(o=o||"_geojsonTileLayer",l,m)}getFeatureState(o,l){return this._state.getState(o=o||"_geojsonTileLayer",l)}setDependencies(o,l,m){const y=this._tiles[o];y&&y.setDependencies(l,m)}reloadTilesForDependencies(o,l){for(const m in this._tiles)this._tiles[m].hasDependency(o,l)&&this._reloadTile(+m,"reloading");this._cache.filter(m=>!m.hasDependency(o,l))}_preloadTiles(o,l){if(!this._sourceLoaded){const $=()=>{this._sourceLoaded&&(this._source.off("data",$),this._preloadTiles(o,l))};return void this._source.on("data",$)}const m=new Map,y=Array.isArray(o)?o:[o],w=this.map.painter.terrain,E=this.usedForTerrain&&w?w.getScaledDemTileSize():this._source.tileSize;for(const $ of y){const H=$.coveringTiles({tileSize:E,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const G of H)m.set(G.key,G);this.usedForTerrain&&$.updateElevation(!1)}const O=Array.from(m.values());r.bl(O,($,H)=>{const G=new _c($,this._source.tileSize*$.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile(G,Z=>{this._source.type==="raster-dem"&&G.dem&&this._backfillDEM(G),H(Z,G)})},l)}}function io(f,o){const l=Math.abs(2*f.wrap)-+(f.wrap<0),m=Math.abs(2*o.wrap)-+(o.wrap<0);return f.overscaledZ-o.overscaledZ||m-l||o.canonical.y-f.canonical.y||o.canonical.x-f.canonical.x}function dg(f){return f==="raster"||f==="image"||f==="video"||f==="custom"}function cr(f,o){const l=1<<f.z;return[f.x/l+o,(f.x+1)/l+o]}_a.maxOverzooming=10,_a.maxUnderzooming=3;class Fy{constructor(o){this.style=o,this.layersGotHidden=!1,this.layers=[]}processLayersChanged(){this.layers=[];const o=!1,l=!1;for(const m in this.style._mergedLayers){const y=this.style._mergedLayers[m];if(y.type==="fill-extrusion")this.layers.push({layer:y,visible:o,visibilityChanged:l});else if(y.type==="model"){const w=this.style.getLayerSource(y);w&&w.type==="batched-model"&&this.layers.push({layer:y,visible:o,visibilityChanged:l})}}}onNewFrame(o){this.layersGotHidden=!1;for(const l of this.layers){const m=l.layer;let y=!1;m.type==="fill-extrusion"?y=!m.isHidden(o)&&m.paint.get("fill-extrusion-opacity")>0:m.type==="model"&&(y=!m.isHidden(o)&&m.paint.get("model-opacity").constantOr(1)>0),this.layersGotHidden=this.layersGotHidden||!y&&l.visible,l.visible=y}}updateZOffset(o,l){this.currentBuildingBuckets=[];for(const y of this.layers){const w=y.layer,E=this.style.getLayerSourceCache(w);let O=1;w.type==="fill-extrusion"&&(O=y.visible?w.paint.get("fill-extrusion-vertical-scale"):0);let $=E?E.getTile(l):null;if(!$&&E&&l.canonical.z>E.getSource().minzoom){let H=l.scaledTo(Math.min(E.getSource().maxzoom,l.overscaledZ-1));for(;H.overscaledZ>=E.getSource().minzoom&&($=E.getTile(H),!$&&H.overscaledZ!==0);)H=H.scaledTo(H.overscaledZ-1)}this.currentBuildingBuckets.push({bucket:$?$.getBucket(w):null,tileID:$?$.tileID:l,verticalScale:O})}o.hasAnyZOffset=!1;let m=!1;for(let y=0;y<o.symbolInstances.length;y++){const w=o.symbolInstances.get(y),E=w.zOffset,O=this._getHeightAtTileOffset(l,w.tileAnchorX,w.tileAnchorY);w.zOffset=O!==Number.NEGATIVE_INFINITY?O:E,m||E===w.zOffset||(m=!0),o.hasAnyZOffset||w.zOffset===0||(o.hasAnyZOffset=!0)}m&&(o.zOffsetBuffersNeedUpload=!0,o.zOffsetSortDirty=!0)}_mapCoordToOverlappingTile(o,l,m,y){let w=l,E=m;if(o.canonical.z!==y.canonical.z){const O=y.canonical,$=1/(1<<o.canonical.z-O.z);w=(l+o.canonical.x*r.ag)*$-O.x*r.ag|0,E=(m+o.canonical.y*r.ag)*$-O.y*r.ag|0}return{tileX:w,tileY:E}}_getHeightAtTileOffset(o,l,m){let y,w;for(let E=0;E<this.layers.length;++E){if(this.layers[E].layer.type!=="fill-extrusion")continue;const{bucket:O,tileID:$,verticalScale:H}=this.currentBuildingBuckets[E];if(!O)continue;const{tileX:G,tileY:Z}=this._mapCoordToOverlappingTile(o,l,m,$),X=O.getHeightAtTileCoord(G,Z);X&&X.height!==void 0&&(X.hidden?y=X.height:w=Math.max(X.height*H,w||0))}if(w!==void 0)return w;for(let E=0;E<this.layers.length;++E){const O=this.layers[E];if(O.layer.type!=="model"||!O.visible)continue;const{bucket:$,tileID:H}=this.currentBuildingBuckets[E];if(!$)continue;const{tileX:G,tileY:Z}=this._mapCoordToOverlappingTile(o,l,m,H),X=$.getHeightAtTileCoord(G,Z);if(X&&!X.hidden)return X.height===void 0&&y!==void 0?Math.min(X.maxHeight,y)*X.verticalScale:X.height?X.height*X.verticalScale:Number.NEGATIVE_INFINITY}return this.layersGotHidden?0:Number.NEGATIVE_INFINITY}}function Gf(f,o){const l={};for(const m in f)m!=="ref"&&(l[m]=f[m]);return r.bm.forEach(m=>{m in o&&(l[m]=o[m])}),l}function Wf(f){f=f.slice();const o=Object.create(null);for(let l=0;l<f.length;l++)o[f[l].id]=f[l];for(let l=0;l<f.length;l++)"ref"in f[l]&&(f[l]=Gf(f[l],o[f[l].ref]));return f}const Fr={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setSlot:"setSlot",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setSnow:"setSnow",setRain:"setRain",setCamera:"setCamera",setLights:"setLights",setProjection:"setProjection",addImport:"addImport",removeImport:"removeImport",updateImport:"updateImport"};function qf(f,o,l){l.push({command:Fr.addSource,args:[f,o[f]]})}function eu(f,o,l){o.push({command:Fr.removeSource,args:[f]}),l[f]=!0}function qn(f,o,l,m){eu(f,l,m),qf(f,o,l)}function co(f,o,l){let m;for(m in f[l])if(f[l].hasOwnProperty(m)&&m!=="data"&&!r.bn(f[l][m],o[l][m]))return!1;for(m in o[l])if(o[l].hasOwnProperty(m)&&m!=="data"&&!r.bn(f[l][m],o[l][m]))return!1;return!0}function Yr(f,o,l,m,y,w){let E;for(E in o=o||{},f=f||{})f.hasOwnProperty(E)&&(r.bn(f[E],o[E])||l.push({command:w,args:[m,E,o[E],y]}));for(E in o)o.hasOwnProperty(E)&&!f.hasOwnProperty(E)&&(r.bn(f[E],o[E])||l.push({command:w,args:[m,E,o[E],y]}))}function Yi(f){return f.id}function Ol(f,o){return f[o.id]=o,f}class eo{constructor(o,l){this.reset(o,l)}reset(o,l){this.points=o||[],this._distances=[0];for(let m=1;m<this.points.length;m++)this._distances[m]=this._distances[m-1]+this.points[m].dist(this.points[m-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(l||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(o){if(this.points.length===1)return this.points[0];o=r.aw(o,0,1);let l=1,m=this._distances[l];const y=o*this.paddedLength+this.padding;for(;m<y&&l<this._distances.length;)m=this._distances[++l];const w=l-1,E=this._distances[w],O=m-E,$=O>0?(y-E)/O:0;return this.points[w].mult(1-$).add(this.points[l].mult($))}}class lh{constructor(o,l,m){const y=this.boxCells=[],w=this.circleCells=[];this.xCellCount=Math.ceil(o/m),this.yCellCount=Math.ceil(l/m);for(let E=0;E<this.xCellCount*this.yCellCount;E++)y.push([]),w.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=o,this.height=l,this.xScale=this.xCellCount/o,this.yScale=this.yCellCount/l,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(o,l,m,y,w){this._forEachCell(l,m,y,w,this._insertBoxCell,this.boxUid++),this.boxKeys.push(o),this.bboxes.push(l),this.bboxes.push(m),this.bboxes.push(y),this.bboxes.push(w)}insertCircle(o,l,m,y){this._forEachCell(l-y,m-y,l+y,m+y,this._insertCircleCell,this.circleUid++),this.circleKeys.push(o),this.circles.push(l),this.circles.push(m),this.circles.push(y)}_insertBoxCell(o,l,m,y,w,E){this.boxCells[w].push(E)}_insertCircleCell(o,l,m,y,w,E){this.circleCells[w].push(E)}_query(o,l,m,y,w,E){if(m<0||o>this.width||y<0||l>this.height)return!w&&[];const O=[];if(o<=0&&l<=0&&this.width<=m&&this.height<=y){if(w)return!0;for(let $=0;$<this.boxKeys.length;$++)O.push({key:this.boxKeys[$],x1:this.bboxes[4*$],y1:this.bboxes[4*$+1],x2:this.bboxes[4*$+2],y2:this.bboxes[4*$+3]});for(let $=0;$<this.circleKeys.length;$++){const H=this.circles[3*$],G=this.circles[3*$+1],Z=this.circles[3*$+2];O.push({key:this.circleKeys[$],x1:H-Z,y1:G-Z,x2:H+Z,y2:G+Z})}return E?O.filter(E):O}return this._forEachCell(o,l,m,y,this._queryCell,O,{hitTest:w,seenUids:{box:{},circle:{}}},E),w?O.length>0:O}_queryCircle(o,l,m,y,w){const E=o-m,O=o+m,$=l-m,H=l+m;if(O<0||E>this.width||H<0||$>this.height)return!y&&[];const G=[];return this._forEachCell(E,$,O,H,this._queryCellCircle,G,{hitTest:y,circle:{x:o,y:l,radius:m},seenUids:{box:{},circle:{}}},w),y?G.length>0:G}query(o,l,m,y,w){return this._query(o,l,m,y,!1,w)}hitTest(o,l,m,y,w){return this._query(o,l,m,y,!0,w)}hitTestCircle(o,l,m,y){return this._queryCircle(o,l,m,!0,y)}_queryCell(o,l,m,y,w,E,O,$){const H=O.seenUids,G=this.boxCells[w];if(G!==null){const X=this.bboxes;for(const oe of G)if(!H.box[oe]){H.box[oe]=!0;const xe=4*oe;if(o<=X[xe+2]&&l<=X[xe+3]&&m>=X[xe+0]&&y>=X[xe+1]&&(!$||$(this.boxKeys[oe]))){if(O.hitTest)return E.push(!0),!0;E.push({key:this.boxKeys[oe],x1:X[xe],y1:X[xe+1],x2:X[xe+2],y2:X[xe+3]})}}}const Z=this.circleCells[w];if(Z!==null){const X=this.circles;for(const oe of Z)if(!H.circle[oe]){H.circle[oe]=!0;const xe=3*oe;if(this._circleAndRectCollide(X[xe],X[xe+1],X[xe+2],o,l,m,y)&&(!$||$(this.circleKeys[oe]))){if(O.hitTest)return E.push(!0),!0;{const ve=X[xe],Ce=X[xe+1],Te=X[xe+2];E.push({key:this.circleKeys[oe],x1:ve-Te,y1:Ce-Te,x2:ve+Te,y2:Ce+Te})}}}}}_queryCellCircle(o,l,m,y,w,E,O,$){const H=O.circle,G=O.seenUids,Z=this.boxCells[w];if(Z!==null){const oe=this.bboxes;for(const xe of Z)if(!G.box[xe]){G.box[xe]=!0;const ve=4*xe;if(this._circleAndRectCollide(H.x,H.y,H.radius,oe[ve+0],oe[ve+1],oe[ve+2],oe[ve+3])&&(!$||$(this.boxKeys[xe])))return E.push(!0),!0}}const X=this.circleCells[w];if(X!==null){const oe=this.circles;for(const xe of X)if(!G.circle[xe]){G.circle[xe]=!0;const ve=3*xe;if(this._circlesCollide(oe[ve],oe[ve+1],oe[ve+2],H.x,H.y,H.radius)&&(!$||$(this.circleKeys[xe])))return E.push(!0),!0}}}_forEachCell(o,l,m,y,w,E,O,$){const H=this._convertToXCellCoord(o),G=this._convertToYCellCoord(l),Z=this._convertToXCellCoord(m),X=this._convertToYCellCoord(y);for(let oe=H;oe<=Z;oe++)for(let xe=G;xe<=X;xe++)if(w.call(this,o,l,m,y,this.xCellCount*xe+oe,E,O,$))return}_convertToXCellCoord(o){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(o*this.xScale)))}_convertToYCellCoord(o){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(o*this.yScale)))}_circlesCollide(o,l,m,y,w,E){const O=y-o,$=w-l,H=m+E;return H*H>O*O+$*$}_circleAndRectCollide(o,l,m,y,w,E,O){const $=(E-y)/2,H=Math.abs(o-(y+$));if(H>$+m)return!1;const G=(O-w)/2,Z=Math.abs(l-(w+G));if(Z>G+m)return!1;if(H<=$||Z<=G)return!0;const X=H-$,oe=Z-G;return X*X+oe*oe<=m*m}}const rl={unknown:0,flipRequired:1,flipNotRequired:2},ch=Math.tan(85*Math.PI/180);function Ni(f,o,l,m,y,w,E){const O=r.ab.mat4.create();if(l)if(w.name==="globe"){const $=r.bo(y,o);r.ab.mat4.multiply(O,O,$)}else{const $=r.ab.mat2.invert([],E);O[0]=$[0],O[1]=$[1],O[4]=$[2],O[5]=$[3],m||r.ab.mat4.rotateZ(O,O,y.angle)}else r.ab.mat4.multiply(O,y.labelPlaneMatrix,f);return O}function Qo(f,o,l,m,y,w,E){const O=Ni(f,o,l,m,y,w,E);return w.name==="globe"&&l||(O[2]=O[6]=O[10]=O[14]=0),O}function hg(f,o,l,m,y,w,E){if(l){if(w.name==="globe"){const O=Ni(f,o,l,m,y,w,E);return r.ab.mat4.invert(O,O),r.ab.mat4.multiply(O,f,O),O}{const O=r.ab.mat4.clone(f),$=r.ab.mat4.identity([]);return $[0]=E[0],$[1]=E[1],$[4]=E[2],$[5]=E[3],r.ab.mat4.multiply(O,O,$),m||r.ab.mat4.rotateZ(O,O,-y.angle),O}}return y.glCoordMatrix}function ys(f,o,l,m){const y=[f,o,l,1];l?r.ab.vec4.transformMat4(y,y,m):ya(y,y,m);const w=y[3];return y[0]/=w,y[1]/=w,y[2]/=w,y}function Kf(f,o){return Math.min(.5+f/o*.5,1.5)}function uh(f,o){const l=f[0]/f[3],m=f[1]/f[3];return l>=-o[0]&&l<=o[0]&&m>=-o[1]&&m<=o[1]}function Zf(f,o,l,m,y,w,E,O,$,H){const G=l.transform,Z=m?f.textSizeData:f.iconSizeData,X=r.bp(Z,l.transform.zoom),oe=G.projection.name==="globe",xe=[256/l.width*2+1,256/l.height*2+1],ve=m?f.text.dynamicLayoutVertexArray:f.icon.dynamicLayoutVertexArray;ve.clear();let Ce=null;oe&&(Ce=m?f.text.globeExtVertexArray:f.icon.globeExtVertexArray);const Te=f.lineVertexArray,Le=m?f.text.placedSymbolArray:f.icon.placedSymbolArray,Ge=l.transform.width/l.transform.height;let He,rt=!1;for(let Xe=0;Xe<Le.length;Xe++){const et=Le.get(Xe),{numGlyphs:Ye,writingMode:at}=et;if(at!==r.bq.vertical||rt||He===r.bq.horizontal||(rt=!0),He=at,(et.hidden||at===r.bq.vertical)&&!rt){Yo(Ye,ve);continue}rt=!1;const gt=new r.P(et.tileAnchorX,et.tileAnchorY);let{x:Vt,y:Rt,z:tn}=G.projection.projectTilePoint(gt.x,gt.y,H.canonical);if($){const[nn,vn,Tn]=$(gt);Vt+=nn,Rt+=vn,tn+=Tn}const Jt=[Vt,Rt,tn,1];if(r.ab.vec4.transformMat4(Jt,Jt,o),!uh(Jt,xe)){Yo(Ye,ve);continue}const Et=Jt[3],jt=Kf(l.transform.getCameraToCenterDistance(G.projection),Et),gn=r.br(Z,X,et),Tt=E?gn/jt:gn*jt,rn=ys(Vt,Rt,tn,y);if(rn[3]<=0){Yo(Ye,ve);continue}let Ht={};const Cn=E?null:$,dn=ol(et,Tt,!1,O,o,y,w,f.glyphOffsetArray,Te,ve,Ce,rn,gt,Ht,Ge,Cn,G.projection,H,E);rt=dn.useVertical,Cn&&dn.needsFlipping&&(Ht={}),(dn.notEnoughRoom||rt||dn.needsFlipping&&ol(et,Tt,!0,O,o,y,w,f.glyphOffsetArray,Te,ve,Ce,rn,gt,Ht,Ge,Cn,G.projection,H,E).notEnoughRoom)&&Yo(Ye,ve)}m?(f.text.dynamicLayoutVertexBuffer.updateData(ve),Ce&&f.text.globeExtVertexBuffer&&f.text.globeExtVertexBuffer.updateData(Ce)):(f.icon.dynamicLayoutVertexBuffer.updateData(ve),Ce&&f.icon.globeExtVertexBuffer&&f.icon.globeExtVertexBuffer.updateData(Ce))}function dh(f,o,l,m,y,w,E,O,$,H,G,Z,X,oe,xe,ve){const{lineStartIndex:Ce,glyphStartIndex:Te,segment:Le}=O,Ge=Te+O.numGlyphs,He=Ce+O.lineLength,rt=o.getoffsetX(Te),Xe=o.getoffsetX(Ge-1),et=Ll(f*rt,l,m,y,w,E,Le,Ce,He,$,H,G,Z,X,!0,oe,xe,ve);if(!et)return null;const Ye=Ll(f*Xe,l,m,y,w,E,Le,Ce,He,$,H,G,Z,X,!0,oe,xe,ve);return Ye?{first:et,last:Ye}:null}function Xi(f,o,l,m){return f===r.bq.horizontal&&Math.abs(m)>Math.abs(l)?{useVertical:!0}:f===r.bq.vertical?m>0?{needsFlipping:!0}:null:o!==rl.unknown&&function(y,w){return y===0||Math.abs(w/y)>ch}(l,m)?o===rl.flipRequired?{needsFlipping:!0}:null:l<0?{needsFlipping:!0}:null}function ol(f,o,l,m,y,w,E,O,$,H,G,Z,X,oe,xe,ve,Ce,Te,Le){const Ge=o/24,He=f.lineOffsetX*Ge,rt=f.lineOffsetY*Ge,{lineStartIndex:Xe,glyphStartIndex:et,numGlyphs:Ye,segment:at,writingMode:gt,flipState:Vt}=f,Rt=Xe+f.lineLength,tn=Jt=>{if(G){const[Tt,rn,Ht]=Jt.up,Cn=H.length;r.bs(G,Cn+0,Tt,rn,Ht),r.bs(G,Cn+1,Tt,rn,Ht),r.bs(G,Cn+2,Tt,rn,Ht),r.bs(G,Cn+3,Tt,rn,Ht)}const[Et,jt,gn]=Jt.point;r.bt(H,Et,jt,gn,Jt.angle)};if(Ye>1){const Jt=dh(Ge,O,He,rt,l,Z,X,f,$,w,oe,ve,!1,Ce,Te,Le);if(!Jt)return{notEnoughRoom:!0};if(m&&!l){let[Et,jt,gn]=Jt.first.point,[Tt,rn,Ht]=Jt.last.point;[Et,jt]=ys(Et,jt,gn,E),[Tt,rn]=ys(Tt,rn,Ht,E);const Cn=Xi(gt,Vt,(Tt-Et)*xe,rn-jt);if(f.flipState=Cn&&Cn.needsFlipping?rl.flipRequired:rl.flipNotRequired,Cn)return Cn}tn(Jt.first);for(let Et=et+1;Et<et+Ye-1;Et++){const jt=Ll(Ge*O.getoffsetX(Et),He,rt,l,Z,X,at,Xe,Rt,$,w,oe,ve,!1,!1,Ce,Te,Le);if(!jt)return H.length-=4*(Et-et),{notEnoughRoom:!0};tn(jt)}tn(Jt.last)}else{if(m&&!l){const Et=ys(X.x,X.y,0,y),jt=Xe+at+1,gn=new r.P($.getx(jt),$.gety(jt)),Tt=ys(gn.x,gn.y,0,y),rn=Tt[3]>0?Tt:fg(X,gn,Et,1,y,void 0,Ce,Te.canonical),Ht=Xi(gt,Vt,(rn[0]-Et[0])*xe,rn[1]-Et[1]);if(f.flipState=Ht&&Ht.needsFlipping?rl.flipRequired:rl.flipNotRequired,Ht)return Ht}const Jt=Ll(Ge*O.getoffsetX(et),He,rt,l,Z,X,at,Xe,Rt,$,w,oe,ve,!1,!1,Ce,Te,Le);if(!Jt)return{notEnoughRoom:!0};tn(Jt)}return{}}function Gi(f,o,l,m,y){const{x:w,y:E,z:O}=m.projectTilePoint(f.x,f.y,o);if(!y)return ys(w,E,O,l);const[$,H,G]=y(f);return ys(w+$,E+H,O+G,l)}function fg(f,o,l,m,y,w,E,O){const $=Gi(f.sub(o)._unit()._add(f),O,y,E,w);return r.ab.vec3.sub($,l,$),r.ab.vec3.normalize($,$),r.ab.vec3.scaleAndAdd($,l,$,m)}function Ll(f,o,l,m,y,w,E,O,$,H,G,Z,X,oe,xe,ve,Ce,Te){const Le=m?f-o:f+o;let Ge=Le>0?1:-1,He=0;m&&(Ge*=-1,He=Math.PI),Ge<0&&(He+=Math.PI);let rt=O+E+(Ge>0?0:1)|0,Xe=y,et=y,Ye=0,at=0;const gt=Math.abs(Le),Vt=[],Rt=[];let tn=w,Jt=tn;const Et=()=>fg(Jt,tn,et,gt-Ye+1,G,X,ve,Ce.canonical);for(;Ye+at<=gt;){if(rt+=Ge,rt<O||rt>=$)return null;if(et=Xe,Jt=tn,Vt.push(et),oe&&Rt.push(Jt),tn=new r.P(H.getx(rt),H.gety(rt)),Xe=Z[rt],!Xe){const vn=Gi(tn,Ce.canonical,G,ve,X);Xe=vn[3]>0?Z[rt]=vn:Et()}Ye+=at,at=r.ab.vec3.distance(et,Xe)}xe&&X&&(Z[rt]&&(Xe=Et(),at=r.ab.vec3.distance(et,Xe)),Z[rt]=Xe);const jt=(gt-Ye)/at,gn=tn.sub(Jt)._mult(jt)._add(Jt),Tt=r.ab.vec3.sub([],Xe,et),rn=r.ab.vec3.scaleAndAdd([],et,Tt,jt);let Ht=[0,0,1],Cn=Tt[0],dn=Tt[1];if(Te&&(Ht=ve.upVector(Ce.canonical,gn.x,gn.y),Ht[0]!==0||Ht[1]!==0||Ht[2]!==1)){const vn=[Ht[2],0,-Ht[0]],Tn=r.ab.vec3.cross([],Ht,vn);r.ab.vec3.normalize(vn,vn),r.ab.vec3.normalize(Tn,Tn),Cn=r.ab.vec3.dot(Tt,vn),dn=r.ab.vec3.dot(Tt,Tn)}if(l){const vn=r.ab.vec3.cross([],Ht,Tt);r.ab.vec3.normalize(vn,vn),r.ab.vec3.scaleAndAdd(rn,rn,vn,l*Ge)}const nn=He+Math.atan2(dn,Cn);return Vt.push(rn),oe&&Rt.push(gn),{point:rn,angle:nn,path:Vt,tilePath:Rt,up:Ht}}function Yo(f,o){const l=o.length,m=l+4*f;o.resize(m),o.float32.fill(-1/0,4*l,4*m)}function ya(f,o,l){const m=o[0],y=o[1];return f[0]=l[0]*m+l[4]*y+l[12],f[1]=l[1]*m+l[5]*y+l[13],f[3]=l[3]*m+l[7]*y+l[15],f}const Bi=100;class pi{constructor(o,l,m=new lh(o.width+200,o.height+200,25),y=new lh(o.width+200,o.height+200,25)){this.transform=o,this.grid=m,this.ignoredGrid=y,this.pitchfactor=Math.cos(o._pitch)*o.cameraToCenterDistance,this.screenRightBoundary=o.width+Bi,this.screenBottomBoundary=o.height+Bi,this.gridRightBoundary=o.width+200,this.gridBottomBoundary=o.height+200,this.fogState=l}placeCollisionBox(o,l,m,y,w,E,O,$){let H=m.projectedAnchorX,G=m.projectedAnchorY,Z=m.projectedAnchorZ;const X=m.elevation,oe=m.tileID,xe=o.getProjection();if(X&&oe){const[Xe,et,Ye]=xe.upVector(oe.canonical,m.tileAnchorX,m.tileAnchorY),at=xe.upVectorScale(oe.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;H+=Xe*X*at,G+=et*X*at,Z+=Ye*X*at}const ve=this.projectAndGetPerspectiveRatio(O,H,G,Z,m.tileID,xe.name==="globe"||!!X||this.transform.pitch>0,xe),Ce=E*ve.perspectiveRatio,Te=(m.x1*l+y.x-m.padding)*Ce+ve.point.x,Le=(m.y1*l+y.y-m.padding)*Ce+ve.point.y,Ge=(m.x2*l+y.x+m.padding)*Ce+ve.point.x,He=(m.y2*l+y.y+m.padding)*Ce+ve.point.y,rt=ve.perspectiveRatio<=.55||ve.occluded;return!this.isInsideGrid(Te,Le,Ge,He)||!w&&this.grid.hitTest(Te,Le,Ge,He,$)||rt?{box:[],offscreen:!1,occluded:ve.occluded}:{box:[Te,Le,Ge,He],offscreen:this.isOffscreen(Te,Le,Ge,He),occluded:!1}}placeCollisionCircles(o,l,m,y,w,E,O,$,H,G,Z,X,oe,xe,ve){const Ce=[],Te=this.transform.elevation,Le=o.getProjection(),Ge=Te?Te.getAtTileOffsetFunc(ve,this.transform.center.lat,this.transform.worldSize,Le):null,He=new r.P(m.tileAnchorX,m.tileAnchorY);let{x:rt,y:Xe,z:et}=Le.projectTilePoint(He.x,He.y,ve.canonical);if(Ge){const[gn,Tt,rn]=Ge(He);rt+=gn,Xe+=Tt,et+=rn}const Ye=Le.name==="globe",at=this.projectAndGetPerspectiveRatio(O,rt,Xe,et,ve,Ye||!!Te||this.transform.pitch>0,Le),{perspectiveRatio:gt}=at,Vt=(Z?E/gt:E*gt)/r.bw,Rt=ys(rt,Xe,et,$),tn=at.signedDistanceFromCamera>0?dh(Vt,w,m.lineOffsetX*Vt,m.lineOffsetY*Vt,!1,Rt,He,m,y,$,{},Te&&!Z?Ge:null,Z&&!!Te,Le,ve,Z):null;let Jt=!1,Et=!1,jt=!0;if(tn&&!at.occluded){const gn=.5*oe*gt+xe,Tt=new r.P(-100,-100),rn=new r.P(this.screenRightBoundary,this.screenBottomBoundary),Ht=new eo,{first:Cn,last:dn}=tn,nn=Cn.path.length;let vn=[];for(let Un=nn-1;Un>=1;Un--)vn.push(Cn.path[Un]);for(let Un=1;Un<dn.path.length;Un++)vn.push(dn.path[Un]);const Tn=2.5*gn;H&&(vn=vn.map(([Un,dr,nr],ir)=>(Ge&&!Ye&&(nr=Ge(ir<nn-1?Cn.tilePath[nn-1-ir]:dn.tilePath[ir-nn+2])[2]),ys(Un,dr,nr,H))),vn.some(Un=>Un[3]<=0)&&(vn=[]));let Ln=[];if(vn.length>0){let Un=1/0,dr=-1/0,nr=1/0,ir=-1/0;for(const br of vn)Un=Math.min(Un,br[0]),nr=Math.min(nr,br[1]),dr=Math.max(dr,br[0]),ir=Math.max(ir,br[1]);dr>=Tt.x&&Un<=rn.x&&ir>=Tt.y&&nr<=rn.y&&(Ln=[vn.map(br=>new r.P(br[0],br[1]))],(Un<Tt.x||dr>rn.x||nr<Tt.y||ir>rn.y)&&(Ln=r.bu(Ln,Tt.x,Tt.y,rn.x,rn.y)))}for(const Un of Ln){Ht.reset(Un,.25*gn);let dr=0;dr=Ht.length<=.5*gn?1:Math.ceil(Ht.paddedLength/Tn)+1;for(let nr=0;nr<dr;nr++){const ir=nr/Math.max(dr-1,1),br=Ht.lerp(ir),jr=br.x+Bi,ho=br.y+Bi;Ce.push(jr,ho,gn,0);const Zo=jr-gn,No=ho-gn,Sr=jr+gn,Xr=ho+gn;if(jt=jt&&this.isOffscreen(Zo,No,Sr,Xr),Et=Et||this.isInsideGrid(Zo,No,Sr,Xr),!l&&this.grid.hitTestCircle(jr,ho,gn,X)&&(Jt=!0,!G))return{circles:[],offscreen:!1,collisionDetected:Jt,occluded:!1}}}}return{circles:!G&&Jt||!Et?[]:Ce,offscreen:jt,collisionDetected:Jt,occluded:at.occluded}}queryRenderedSymbols(o){if(o.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const l=[];let m=1/0,y=1/0,w=-1/0,E=-1/0;for(const G of o){const Z=new r.P(G.x+Bi,G.y+Bi);m=Math.min(m,Z.x),y=Math.min(y,Z.y),w=Math.max(w,Z.x),E=Math.max(E,Z.y),l.push(Z)}const O=this.grid.query(m,y,w,E).concat(this.ignoredGrid.query(m,y,w,E)),$={},H={};for(const G of O){const Z=G.key;if($[Z.bucketInstanceId]===void 0&&($[Z.bucketInstanceId]={}),$[Z.bucketInstanceId][Z.featureIndex])continue;const X=[new r.P(G.x1,G.y1),new r.P(G.x2,G.y1),new r.P(G.x2,G.y2),new r.P(G.x1,G.y2)];r.bv(l,X)&&($[Z.bucketInstanceId][Z.featureIndex]=!0,H[Z.bucketInstanceId]===void 0&&(H[Z.bucketInstanceId]=[]),H[Z.bucketInstanceId].push(Z.featureIndex))}return H}insertCollisionBox(o,l,m,y,w){(l?this.ignoredGrid:this.grid).insert({bucketInstanceId:m,featureIndex:y,collisionGroupID:w},o[0],o[1],o[2],o[3])}insertCollisionCircles(o,l,m,y,w){const E=l?this.ignoredGrid:this.grid,O={bucketInstanceId:m,featureIndex:y,collisionGroupID:w};for(let $=0;$<o.length;$+=4)E.insertCircle(O,o[$],o[$+1],o[$+2])}projectAndGetPerspectiveRatio(o,l,m,y,w,E,O){const $=[l,m,y,1];let H=!1;y||this.transform.pitch>0?(r.ab.vec4.transformMat4($,$,o),this.fogState&&w&&O.name!=="globe"&&(H=function(X,oe,xe,ve,Ce,Te){const Le=Te.calculateFogTileMatrix(Ce),Ge=[oe,xe,ve];return r.ab.vec3.transformMat4(Ge,Ge,Le),lt(X,r.ab.vec3.length(Ge),Te.pitch,Te._fov)}(this.fogState,l,m,y,w.toUnwrapped(),this.transform)>.9)):ya($,$,o);const G=$[3];return{point:new r.P(($[0]/G+1)/2*this.transform.width+Bi,(-$[1]/G+1)/2*this.transform.height+Bi),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(O)/G*.5,1.5),signedDistanceFromCamera:G,occluded:E&&$[2]>G||H}}isOffscreen(o,l,m,y){return m<Bi||o>=this.screenRightBoundary||y<Bi||l>this.screenBottomBoundary}isInsideGrid(o,l,m,y){return m>=0&&o<this.gridRightBoundary&&y>=0&&l<this.gridBottomBoundary}getViewportMatrix(){const o=r.ab.mat4.identity([]);return r.ab.mat4.translate(o,o,[-100,-100,0]),o}}function hh(f,o,l){const m=o.createTileMatrix(f,f.worldSize,l.toUnwrapped());return r.ab.mat4.multiply(new Float32Array(16),f.projMatrix,m)}function Da(f,o,l){if(o.projection.name===l.projection.name)return f.projMatrix;const m=l.clone();return m.setProjection(o.projection),hh(m,o.getProjection(),f)}function tu(f,o,l){return o.name===l.projection.name?f.projMatrix:hh(l,o,f)}class fh{constructor(o,l,m,y){this.opacity=o?Math.max(0,Math.min(1,o.opacity+(o.placed?l:-l))):y&&m?1:0,this.placed=m}isHidden(){return this.opacity===0&&!this.placed}}class za{constructor(o,l,m,y,w,E=!1){this.text=new fh(o?o.text:null,l,m,w),this.icon=new fh(o?o.icon:null,l,y,w),this.clipped=E}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class pg{constructor(o,l,m,y=!1){this.text=o,this.icon=l,this.skipFade=m,this.clipped=y}}class Dl{constructor(){this.invProjMatrix=r.ab.mat4.create(),this.viewportMatrix=r.ab.mat4.create(),this.circles=[]}}class Vx{constructor(o,l,m,y,w){this.bucketInstanceId=o,this.featureIndex=l,this.sourceLayerIndex=m,this.bucketIndex=y,this.tileID=w}}class mg{constructor(o){this.crossSourceCollisions=o,this.maxGroupID=0,this.collisionGroups={}}get(o){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[o]){const l=++this.maxGroupID;this.collisionGroups[o]={ID:l,predicate:m=>m.collisionGroupID===l}}return this.collisionGroups[o]}}function bs(f,o,l,m,y){const{horizontalAlign:w,verticalAlign:E}=r.bD(f),O=-(w-.5)*o,$=-(E-.5)*l,H=r.bC(f,m);return new r.P(O+H[0]*y,$+H[1]*y)}function gg(f,o,l,m,y){const w=new r.P(f,o);return l&&w._rotate(m?y:-y),w}class Yf{constructor(o,l,m,y,w,E){this.transform=o.clone(),this.projection=o.projection.name,this.collisionIndex=new pi(this.transform,w),this.buildingIndex=E,this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=l,this.retainedQueryData={},this.collisionGroups=new mg(m),this.collisionCircleArrays={},this.prevPlacement=y,y&&(y.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(o,l,m,y,w=1){const E=m.getBucket(l),O=m.latestFeatureIndex;if(!E||!O||l.fqid!==E.layerIds[0])return;const $=E.layers[0].layout,H=E.layers[0].paint,G=m.collisionBoxArray,Z=Math.pow(2,this.transform.zoom-m.tileID.overscaledZ),X=m.tileSize/r.ag,oe=m.tileID.toUnwrapped();this.transform.setProjection(E.projection);const xe=(ve=m.tileID,Ce=E.getProjection(),Te=this.transform,Ce.name===this.projection?Te.calculateProjMatrix(ve.toUnwrapped()):hh(Te,Ce,ve));var ve,Ce,Te;const Le=$.get("text-pitch-alignment")==="map",Ge=$.get("text-rotation-alignment")==="map";l.compileFilter(l.options);const He=l.dynamicFilter(),rt=l.dynamicFilterNeedsFeature(),Xe=this.transform.calculatePixelsToTileUnitsMatrix(m),et=Qo(xe,m.tileID.canonical,Le,Ge,this.transform,E.getProjection(),Xe);let Ye=null;if(Le){const gn=hg(xe,m.tileID.canonical,Le,Ge,this.transform,E.getProjection(),Xe);Ye=r.ab.mat4.multiply([],this.transform.labelPlaneMatrix,gn)}let at=null;He&&m.latestFeatureIndex&&(at={unwrappedTileID:oe,dynamicFilter:He,dynamicFilterNeedsFeature:rt}),this.retainedQueryData[E.bucketInstanceId]=new Vx(E.bucketInstanceId,O,E.sourceLayerIndex,E.index,m.tileID);const[gt,Vt]=E.layers[0].layout.get("text-size-scale-range"),Rt=r.aw(w,gt,Vt),[tn,Jt]=$.get("icon-size-scale-range"),Et=r.aw(w,tn,Jt),jt={bucket:E,layout:$,paint:H,posMatrix:xe,textLabelPlaneMatrix:et,labelToScreenMatrix:Ye,clippingData:at,scale:Z,textPixelRatio:X,holdingForFade:m.holdingForFade(),collisionBoxArray:G,partiallyEvaluatedTextSize:r.bp(E.textSizeData,this.transform.zoom,Rt),partiallyEvaluatedIconSize:r.bp(E.iconSizeData,this.transform.zoom,Et),collisionGroup:this.collisionGroups.get(E.sourceID),latestFeatureIndex:m.latestFeatureIndex};if(y)for(const gn of E.sortKeyRanges){const{sortKey:Tt,symbolInstanceStart:rn,symbolInstanceEnd:Ht}=gn;o.push({sortKey:Tt,symbolInstanceStart:rn,symbolInstanceEnd:Ht,parameters:jt})}else o.push({symbolInstanceStart:0,symbolInstanceEnd:E.symbolInstances.length,parameters:jt})}attemptAnchorPlacement(o,l,m,y,w,E,O,$,H,G,Z,X,oe,xe,ve,Ce,Te,Le){const{textOffset0:Ge,textOffset1:He,crossTileID:rt}=X,Xe=[Ge,He],et=bs(o,m,y,Xe,w),Ye=this.collisionIndex.placeCollisionBox(xe,w,l,gg(et.x,et.y,E,O,this.transform.angle),Z,$,H,G.predicate);if(Ce){const at=xe.getSymbolInstanceIconSize(Le,this.transform.zoom,X.placedIconSymbolIndex);if(this.collisionIndex.placeCollisionBox(xe,at,Ce,gg(et.x,et.y,E,O,this.transform.angle),Z,$,H,G.predicate).box.length===0)return}if(Ye.box.length>0){let at;return this.prevPlacement&&this.prevPlacement.variableOffsets[rt]&&this.prevPlacement.placements[rt]&&this.prevPlacement.placements[rt].text&&(at=this.prevPlacement.variableOffsets[rt].anchor),this.variableOffsets[rt]={textOffset:Xe,width:m,height:y,anchor:o,textScale:w,prevAnchor:at},this.markUsedJustification(xe,o,X,ve),xe.allowVerticalPlacement&&(this.markUsedOrientation(xe,ve,X),this.placedOrientations[rt]=ve),{shift:et,placedGlyphBoxes:Ye}}}placeLayerBucketPart(o,l,m,y,w=1){const{bucket:E,layout:O,paint:$,posMatrix:H,textLabelPlaneMatrix:G,labelToScreenMatrix:Z,clippingData:X,textPixelRatio:oe,holdingForFade:xe,collisionBoxArray:ve,partiallyEvaluatedTextSize:Ce,partiallyEvaluatedIconSize:Te,collisionGroup:Le,latestFeatureIndex:Ge}=o.parameters,He=O.get("text-optional"),rt=O.get("icon-optional"),Xe=O.get("text-allow-overlap"),et=O.get("icon-allow-overlap"),Ye=O.get("text-rotation-alignment")==="map",at=O.get("text-pitch-alignment")==="map",gt=O.get("symbol-z-elevate"),Vt=$.get("symbol-z-offset"),Rt=O.get("symbol-elevation-reference")==="sea",[tn,Jt]=O.get("text-size-scale-range"),[Et,jt]=O.get("icon-size-scale-range"),gn=r.aw(w,tn,Jt),Tt=r.aw(w,Et,jt);this.transform.setProjection(E.projection);let rn=Xe&&(et||!E.hasIconData()||rt),Ht=et&&(Xe||!E.hasTextData()||He);const Cn=!Vt.isConstant();!E.collisionArrays&&ve&&E.deserializeCollisionBoxes(ve),m&&y&&E.updateCollisionDebugBuffers(this.transform.zoom,ve,gn,Tt);const dn=(nn,vn,Tn)=>{const{crossTileID:Ln,numVerticalGlyphVertices:Un}=nn;let dr=null;if(X&&X.dynamicFilterNeedsFeature||Cn){const Ao=this.retainedQueryData[E.bucketInstanceId];dr=Ge.loadFeature({featureIndex:nn.featureIndex,bucketIndex:Ao.bucketIndex,sourceLayerIndex:Ao.sourceLayerIndex,layoutVertexArrayOffset:0})}if(X&&!(0,X.dynamicFilter)({zoom:this.transform.zoom,pitch:this.transform.pitch},dr,this.retainedQueryData[E.bucketInstanceId].tileID.canonical,new r.P(nn.tileAnchorX,nn.tileAnchorY),this.transform.calculateDistanceTileData(X.unwrappedTileID)))return this.placements[Ln]=new pg(!1,!1,!1,!0),void l.add(Ln);const nr=Vt.evaluate(dr,{});if(l.has(Ln))return;if(xe)return void(this.placements[Ln]=new pg(!1,!1,!1));let ir=!1,br=!1,jr=!0,ho=!1,Zo=!1,No=null,Sr={box:null,offscreen:null,occluded:null},Xr={box:null},Jn=null,Ur=null,ro=null,ao=0,qo=0,Pi=0;Tn.textFeatureIndex?ao=Tn.textFeatureIndex:nn.useRuntimeCollisionCircles&&(ao=nn.featureIndex),Tn.verticalTextFeatureIndex&&(qo=Tn.verticalTextFeatureIndex);const bi=Ao=>{Ao.tileID=this.retainedQueryData[E.bucketInstanceId].tileID;const xo=this.transform.elevation;Ao.elevation=Rt?nr:nr+(xo?xo.getAtTileOffset(Ao.tileID,Ao.tileAnchorX,Ao.tileAnchorY):0),Ao.elevation+=nn.zOffset},xi=Tn.textBox;if(xi){bi(xi);const Ao=qr=>{let si=r.bq.horizontal;if(E.allowVerticalPlacement&&!qr&&this.prevPlacement){const Ri=this.prevPlacement.placedOrientations[Ln];Ri&&(this.placedOrientations[Ln]=Ri,si=Ri,this.markUsedOrientation(E,si,nn))}return si},xo=(qr,si)=>{if(E.allowVerticalPlacement&&Un>0&&Tn.verticalTextBox){for(const Ri of E.writingModes)if(Ri===r.bq.vertical?(Sr=si(),Xr=Sr):Sr=qr(),Sr&&Sr.box&&Sr.box.length)break}else Sr=qr()};if(O.get("text-variable-anchor")){let qr=O.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[Ln]){const Co=this.prevPlacement.variableOffsets[Ln];qr.indexOf(Co.anchor)>0&&(qr=qr.filter(es=>es!==Co.anchor),qr.unshift(Co.anchor))}const si=(Co,es,wa)=>{const zs=E.getSymbolInstanceTextSize(Ce,nn,this.transform.zoom,vn),Ss=(Co.x2-Co.x1)*zs+2*Co.padding,dl=(Co.y2-Co.y1)*zs+2*Co.padding,Sa=nn.hasIconTextFit&&!et?es:null;Sa&&bi(Sa);let Xs={box:[],offscreen:!1,occluded:!1};const xu=Xe?2*qr.length:qr.length;for(let hl=0;hl<xu;++hl){const wu=this.attemptAnchorPlacement(qr[hl%qr.length],Co,Ss,dl,zs,Ye,at,oe,H,Le,hl>=qr.length,nn,vn,E,wa,Sa,Ce,Te);if(wu&&(Xs=wu.placedGlyphBoxes,Xs&&Xs.box&&Xs.box.length)){ir=!0,No=wu.shift;break}}return Xs};xo(()=>si(xi,Tn.iconBox,r.bq.horizontal),()=>{const Co=Tn.verticalTextBox;return Co&&bi(Co),E.allowVerticalPlacement&&!(Sr&&Sr.box&&Sr.box.length)&&Un>0&&Co?si(Co,Tn.verticalIconBox,r.bq.vertical):{box:null,offscreen:null,occluded:null}}),Sr&&(ir=Sr.box,jr=Sr.offscreen,ho=Sr.occluded);const Ri=Ao(!(!Sr||!Sr.box));if(!ir&&this.prevPlacement){const Co=this.prevPlacement.variableOffsets[Ln];Co&&(this.variableOffsets[Ln]=Co,this.markUsedJustification(E,Co.anchor,nn,Ri))}}else{const qr=(si,Ri)=>{const Co=E.getSymbolInstanceTextSize(Ce,nn,this.transform.zoom,vn,w),es=this.collisionIndex.placeCollisionBox(E,Co,si,new r.P(0,0),Xe,oe,H,Le.predicate);return es&&es.box&&es.box.length&&(this.markUsedOrientation(E,Ri,nn),this.placedOrientations[Ln]=Ri),es};xo(()=>qr(xi,r.bq.horizontal),()=>{const si=Tn.verticalTextBox;return E.allowVerticalPlacement&&Un>0&&si?(bi(si),qr(si,r.bq.vertical)):{box:null,offscreen:null,occluded:null}}),Ao(!!(Sr&&Sr.box&&Sr.box.length))}}if(Jn=Sr,ir=Jn&&Jn.box&&Jn.box.length>0,jr=Jn&&Jn.offscreen,ho=Jn&&Jn.occluded,nn.useRuntimeCollisionCircles){const Ao=E.text.placedSymbolArray.get(nn.centerJustifiedTextSymbolIndex>=0?nn.centerJustifiedTextSymbolIndex:nn.verticalPlacedTextSymbolIndex),xo=r.br(E.textSizeData,Ce,Ao),qr=O.get("text-padding");Ur=this.collisionIndex.placeCollisionCircles(E,Xe,Ao,E.lineVertexArray,E.glyphOffsetArray,xo,H,G,Z,m,at,Le.predicate,nn.collisionCircleDiameter*xo/r.bw,qr,this.retainedQueryData[E.bucketInstanceId].tileID),ir=Xe||Ur.circles.length>0&&!Ur.collisionDetected,jr=jr&&Ur.offscreen,ho=Ur.occluded}if(Tn.iconFeatureIndex&&(Pi=Tn.iconFeatureIndex),Tn.iconBox){const Ao=xo=>{bi(xo);const qr=nn.hasIconTextFit&&No?gg(No.x,No.y,Ye,at,this.transform.angle):new r.P(0,0),si=E.getSymbolInstanceIconSize(Te,this.transform.zoom,nn.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(E,si,xo,qr,et,oe,H,Le.predicate)};Xr&&Xr.box&&Xr.box.length&&Tn.verticalIconBox?(ro=Ao(Tn.verticalIconBox),br=ro.box.length>0):(ro=Ao(Tn.iconBox),br=ro.box.length>0),jr=jr&&ro.offscreen,Zo=ro.occluded}const Ys=He||nn.numHorizontalGlyphVertices===0&&Un===0,Qi=rt||nn.numIconVertices===0;if(Ys||Qi?Qi?Ys||(br=br&&ir):ir=br&&ir:br=ir=br&&ir,ir&&Jn&&Jn.box&&this.collisionIndex.insertCollisionBox(Jn.box,O.get("text-ignore-placement"),E.bucketInstanceId,Xr&&Xr.box&&qo?qo:ao,Le.ID),br&&ro&&this.collisionIndex.insertCollisionBox(ro.box,O.get("icon-ignore-placement"),E.bucketInstanceId,Pi,Le.ID),Ur&&(ir&&this.collisionIndex.insertCollisionCircles(Ur.circles,O.get("text-ignore-placement"),E.bucketInstanceId,ao,Le.ID),m)){const Ao=E.bucketInstanceId;let xo=this.collisionCircleArrays[Ao];xo===void 0&&(xo=this.collisionCircleArrays[Ao]=new Dl);for(let qr=0;qr<Ur.circles.length;qr+=4)xo.circles.push(Ur.circles[qr+0]),xo.circles.push(Ur.circles[qr+1]),xo.circles.push(Ur.circles[qr+2]),xo.circles.push(Ur.collisionDetected?1:0)}const Ko=E.projection.name!=="globe";rn=rn&&(Ko||!ho),Ht=Ht&&(Ko||!Zo),this.placements[Ln]=new pg(ir||rn,br||Ht,jr||E.justReloaded),l.add(Ln)};if(gt&&this.buildingIndex&&(this.buildingIndex.updateZOffset(E,this.retainedQueryData[E.bucketInstanceId].tileID),E.updateZOffset()),E.sortFeaturesByY){const nn=E.getSortedSymbolIndexes(this.transform.angle);for(let vn=nn.length-1;vn>=0;--vn){const Tn=nn[vn];dn(E.symbolInstances.get(Tn),Tn,E.collisionArrays[Tn])}E.hasAnyZOffset&&r.w(`${E.layerIds[0]} layer symbol-z-elevate: symbols are not sorted by elevation if symbol-z-order is evaluated to viewport-y`)}else if(E.hasAnyZOffset){const nn=E.getSortedIndexesByZOffset();for(let vn=0;vn<nn.length;++vn){const Tn=nn[vn];dn(E.symbolInstances.get(Tn),Tn,E.collisionArrays[Tn])}}else for(let nn=o.symbolInstanceStart;nn<o.symbolInstanceEnd;nn++)dn(E.symbolInstances.get(nn),nn,E.collisionArrays[nn]);if(m&&E.bucketInstanceId in this.collisionCircleArrays){const nn=this.collisionCircleArrays[E.bucketInstanceId];r.ab.mat4.invert(nn.invProjMatrix,H),nn.viewportMatrix=this.collisionIndex.getViewportMatrix()}E.justReloaded=!1}markUsedJustification(o,l,m,y){const{leftJustifiedTextSymbolIndex:w,centerJustifiedTextSymbolIndex:E,rightJustifiedTextSymbolIndex:O,verticalPlacedTextSymbolIndex:$,crossTileID:H}=m,G=r.bB(l),Z=y===r.bq.vertical?$:G==="left"?w:G==="center"?E:G==="right"?O:-1;w>=0&&(o.text.placedSymbolArray.get(w).crossTileID=Z>=0&&w!==Z?0:H),E>=0&&(o.text.placedSymbolArray.get(E).crossTileID=Z>=0&&E!==Z?0:H),O>=0&&(o.text.placedSymbolArray.get(O).crossTileID=Z>=0&&O!==Z?0:H),$>=0&&(o.text.placedSymbolArray.get($).crossTileID=Z>=0&&$!==Z?0:H)}markUsedOrientation(o,l,m){const y=l===r.bq.horizontal||l===r.bq.horizontalOnly?l:0,w=l===r.bq.vertical?l:0,{leftJustifiedTextSymbolIndex:E,centerJustifiedTextSymbolIndex:O,rightJustifiedTextSymbolIndex:$,verticalPlacedTextSymbolIndex:H}=m,G=o.text.placedSymbolArray;E>=0&&(G.get(E).placedOrientation=y),O>=0&&(G.get(O).placedOrientation=y),$>=0&&(G.get($).placedOrientation=y),H>=0&&(G.get(H).placedOrientation=w)}commit(o){this.commitTime=o,this.zoomAtLastRecencyCheck=this.transform.zoom;const l=this.prevPlacement;let m=!1;this.prevZoomAdjustment=l?l.zoomAdjustment(this.transform.zoom):0;const y=l?l.symbolFadeChange(o):1,w=l?l.opacities:{},E=l?l.variableOffsets:{},O=l?l.placedOrientations:{};for(const $ in this.placements){const H=this.placements[$],G=w[$];G?(this.opacities[$]=new za(G,y,H.text,H.icon,null,H.clipped),m=m||H.text!==G.text.placed||H.icon!==G.icon.placed):(this.opacities[$]=new za(null,y,H.text,H.icon,H.skipFade,H.clipped),m=m||H.text||H.icon)}for(const $ in w){const H=w[$];if(!this.opacities[$]){const G=new za(H,y,!1,!1);G.isHidden()||(this.opacities[$]=G,m=m||H.text.placed||H.icon.placed)}}for(const $ in E)this.variableOffsets[$]||!this.opacities[$]||this.opacities[$].isHidden()||(this.variableOffsets[$]=E[$]);for(const $ in O)this.placedOrientations[$]||!this.opacities[$]||this.opacities[$].isHidden()||(this.placedOrientations[$]=O[$]);m?this.lastPlacementChangeTime=o:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=l?l.lastPlacementChangeTime:o)}updateLayerOpacities(o,l,m,y){const w=new Set;for(const E of l){const O=E.getBucket(o);O&&E.latestFeatureIndex&&o.fqid===O.layerIds[0]&&(this.updateBucketOpacities(O,w,E,E.collisionBoxArray,m,y,E.tileID,o.scope),O.layers[0].layout.get("symbol-z-elevate")&&this.buildingIndex&&(this.buildingIndex.updateZOffset(O,E.tileID),O.updateZOffset()))}}updateBucketOpacities(o,l,m,y,w,E,O,$){o.hasTextData()&&o.text.opacityVertexArray.clear(),o.hasIconData()&&o.icon.opacityVertexArray.clear(),o.hasIconCollisionBoxData()&&o.iconCollisionBox.collisionVertexArray.clear(),o.hasTextCollisionBoxData()&&o.textCollisionBox.collisionVertexArray.clear();const H=o.layers[0].layout,G=o.layers[0].paint,Z=!!o.layers[0].dynamicFilter(),X=new za(null,0,!1,!1,!0),oe=H.get("text-allow-overlap"),xe=H.get("icon-allow-overlap"),ve=H.get("text-variable-anchor"),Ce=H.get("text-rotation-alignment")==="map",Te=H.get("text-pitch-alignment")==="map",Le=G.get("symbol-z-offset"),Ge=H.get("symbol-elevation-reference")==="sea",He=!Le.isConstant(),rt=new za(null,0,oe&&(xe||!o.hasIconData()||H.get("icon-optional")),xe&&(oe||!o.hasTextData()||H.get("text-optional")),!0);!o.collisionArrays&&y&&(o.hasIconCollisionBoxData()||o.hasTextCollisionBoxData())&&o.deserializeCollisionBoxes(y);const Xe=(Ye,at,gt)=>{for(let Vt=0;Vt<at/4;Vt++)Ye.opacityVertexArray.emplaceBack(gt)};let et=0;E&&o.updateReplacement(O,E);for(let Ye=0;Ye<o.symbolInstances.length;Ye++){const at=o.symbolInstances.get(Ye),{numHorizontalGlyphVertices:gt,numVerticalGlyphVertices:Vt,crossTileID:Rt,numIconVertices:tn,tileAnchorX:Jt,tileAnchorY:Et}=at;let jt=null;const gn=this.retainedQueryData[o.bucketInstanceId];He&&at&&gn&&(jt=m.latestFeatureIndex.loadFeature({featureIndex:at.featureIndex,bucketIndex:gn.bucketIndex,sourceLayerIndex:gn.sourceLayerIndex,layoutVertexArrayOffset:0}));const Tt=Le.evaluate(jt,{}),rn=l.has(Rt);let Ht=this.opacities[Rt];rn?Ht=X:Ht||(Ht=rt,this.opacities[Rt]=Ht),l.add(Rt);const Cn=gt>0||Vt>0,dn=tn>0,nn=this.placedOrientations[Rt],vn=nn===r.bq.vertical,Tn=nn===r.bq.horizontal||nn===r.bq.horizontalOnly;!Cn&&!dn||Ht.isHidden()||et++;let Ln=!1;if((Cn||dn)&&E)for(const Un of o.activeReplacements){if(r.bx(Un,w,r.by.Symbol,$)||Un.min.x>Jt||Jt>Un.max.x||Un.min.y>Et||Et>Un.max.y)continue;const dr=r.bz(Jt,Et,O.canonical,Un.footprintTileId.canonical);if(Ln=r.bA(dr,Un.footprint),Ln)break}if(Cn){const Un=Ln?zl:vg(Ht.text);Xe(o.text,gt,vn?zl:Un),Xe(o.text,Vt,Tn?zl:Un);const dr=Ht.text.isHidden(),{leftJustifiedTextSymbolIndex:nr,centerJustifiedTextSymbolIndex:ir,rightJustifiedTextSymbolIndex:br,verticalPlacedTextSymbolIndex:jr}=at,ho=o.text.placedSymbolArray,Zo=dr||vn?1:0;nr>=0&&(ho.get(nr).hidden=Zo),ir>=0&&(ho.get(ir).hidden=Zo),br>=0&&(ho.get(br).hidden=Zo),jr>=0&&(ho.get(jr).hidden=dr||Tn?1:0);const No=this.variableOffsets[Rt];No&&this.markUsedJustification(o,No.anchor,at,nn);const Sr=this.placedOrientations[Rt];Sr&&(this.markUsedJustification(o,"left",at,Sr),this.markUsedOrientation(o,Sr,at))}if(dn){const Un=Ln?zl:vg(Ht.icon),{placedIconSymbolIndex:dr,verticalPlacedIconSymbolIndex:nr}=at,ir=o.icon.placedSymbolArray,br=Ht.icon.isHidden()?1:0;dr>=0&&(Xe(o.icon,tn,vn?zl:Un),ir.get(dr).hidden=br),nr>=0&&(Xe(o.icon,at.numVerticalIconVertices,Tn?zl:Un),ir.get(nr).hidden=br)}if(o.hasIconCollisionBoxData()||o.hasTextCollisionBoxData()){const Un=o.collisionArrays[Ye];if(Un){let dr=new r.P(0,0),nr=!0;if(Un.textBox||Un.verticalTextBox){if(ve){const br=this.variableOffsets[Rt];br?(dr=bs(br.anchor,br.width,br.height,br.textOffset,br.textScale),Ce&&dr._rotate(Te?this.transform.angle:-this.transform.angle)):nr=!1}Z&&(nr=!Ht.clipped),Un.textBox&&ph(o.textCollisionBox.collisionVertexArray,Ht.text.placed,!nr||vn,Tt,Ge,dr.x,dr.y),Un.verticalTextBox&&ph(o.textCollisionBox.collisionVertexArray,Ht.text.placed,!nr||Tn,Tt,Ge,dr.x,dr.y)}const ir=nr&&!!(!Tn&&Un.verticalIconBox);Un.iconBox&&ph(o.iconCollisionBox.collisionVertexArray,Ht.icon.placed,ir,Tt,Ge,at.hasIconTextFit?dr.x:0,at.hasIconTextFit?dr.y:0),Un.verticalIconBox&&ph(o.iconCollisionBox.collisionVertexArray,Ht.icon.placed,!ir,Tt,Ge,at.hasIconTextFit?dr.x:0,at.hasIconTextFit?dr.y:0)}}}if(o.fullyClipped=et===0,o.sortFeatures(this.transform.angle),this.retainedQueryData[o.bucketInstanceId]&&(this.retainedQueryData[o.bucketInstanceId].featureSortOrder=o.featureSortOrder),o.hasTextData()&&o.text.opacityVertexBuffer&&o.text.opacityVertexBuffer.updateData(o.text.opacityVertexArray),o.hasIconData()&&o.icon.opacityVertexBuffer&&o.icon.opacityVertexBuffer.updateData(o.icon.opacityVertexArray),o.hasIconCollisionBoxData()&&o.iconCollisionBox.collisionVertexBuffer&&o.iconCollisionBox.collisionVertexBuffer.updateData(o.iconCollisionBox.collisionVertexArray),o.hasTextCollisionBoxData()&&o.textCollisionBox.collisionVertexBuffer&&o.textCollisionBox.collisionVertexBuffer.updateData(o.textCollisionBox.collisionVertexArray),o.bucketInstanceId in this.collisionCircleArrays){const Ye=this.collisionCircleArrays[o.bucketInstanceId];o.placementInvProjMatrix=Ye.invProjMatrix,o.placementViewportMatrix=Ye.viewportMatrix,o.collisionCircleArray=Ye.circles,delete this.collisionCircleArrays[o.bucketInstanceId]}}symbolFadeChange(o){return this.fadeDuration===0?1:(o-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(o){return Math.max(0,(this.transform.zoom-o)/1.5)}hasTransitions(o){return this.stale||o-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(o,l){const m=this.zoomAtLastRecencyCheck===l?1-this.zoomAdjustment(l):1;return this.zoomAtLastRecencyCheck=l,this.commitTime+this.fadeDuration*m>o}setStale(){this.stale=!0}}function ph(f,o,l,m,y,w,E){f.emplaceBack(o?1:0,l?1:0,w||0,E||0,m,y?1:0),f.emplaceBack(o?1:0,l?1:0,w||0,E||0,m,y?1:0),f.emplaceBack(o?1:0,l?1:0,w||0,E||0,m,y?1:0),f.emplaceBack(o?1:0,l?1:0,w||0,E||0,m,y?1:0)}const mh=Math.pow(2,25),$x=Math.pow(2,24),Ux=Math.pow(2,17),gh=Math.pow(2,16),vh=Math.pow(2,9),jx=Math.pow(2,8),Ku=Math.pow(2,1);function vg(f){if(f.opacity===0&&!f.placed)return 0;if(f.opacity===1&&f.placed)return 4294967295;const o=f.placed?1:0,l=Math.floor(127*f.opacity);return l*mh+o*$x+l*Ux+o*gh+l*vh+o*jx+l*Ku+o}const zl=0;class bc{constructor(o){this._sortAcrossTiles=o.layout.get("symbol-z-order")!=="viewport-y"&&o.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs=new Set,this._bucketParts=[]}continuePlacement(o,l,m,y,w,E){const O=this._bucketParts;for(;this._currentTileIndex<o.length;)if(l.getBucketParts(O,y,o[this._currentTileIndex],this._sortAcrossTiles,E),this._currentTileIndex++,w())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,O.sort(($,H)=>$.sortKey-H.sortKey));this._currentPartIndex<O.length;){const $=O[this._currentPartIndex];if(l.placeLayerBucketPart($,this._seenCrossTileIDs,m,$.symbolInstanceStart===0,E),this._currentPartIndex++,w())return!0}return!1}}class Hx{constructor(o,l,m,y,w,E,O,$,H){this.placement=new Yf(o,w,E,O,$,H),this._currentPlacementIndex=l.length-1,this._forceFullPlacement=m,this._showCollisionBoxes=y,this._done=!1}isDone(){return this._done}continuePlacement(o,l,m,y,w){const E=r.q.now(),O=()=>{const $=r.q.now()-E;return!this._forceFullPlacement&&$>2};for(;this._currentPlacementIndex>=0;){const $=l[o[this._currentPlacementIndex]],H=this.placement.collisionIndex.transform.zoom;if($.type==="symbol"&&(!$.minzoom||$.minzoom<=H)&&(!$.maxzoom||$.maxzoom>H)){const G=$,Z=G.layout.get("symbol-z-elevate"),X=G.layout.get("symbol-sort-key").constantOr(1)!==void 0,oe=G.layout.get("symbol-z-order"),xe=oe==="viewport-y"||oe==="auto"&&!(oe!=="viewport-y"&&X),ve=G.layout.get("text-allow-overlap")||G.layout.get("icon-allow-overlap")||G.layout.get("text-ignore-placement")||G.layout.get("icon-ignore-placement"),Ce=xe&&ve,Te=this._inProgressLayer=this._inProgressLayer||new bc(G),Le=r.aC($.source,$.scope);if(Te.continuePlacement(Z||Ce?y[Le]:m[Le],this.placement,this._showCollisionBoxes,$,O,w))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(o){return this.placement.commit(o),this.placement}}const _g=512/r.ag/2;class Gx{constructor(o,l,m){this.tileID=o,this.bucketInstanceId=m,this.index=new r.bE(l.length,16,Int32Array),this.keys=[],this.crossTileIDs=[];const y=o.canonical.x*r.ag,w=o.canonical.y*r.ag;for(let E=0;E<l.length;E++){const{key:O,crossTileID:$,tileAnchorX:H,tileAnchorY:G}=l.get(E),Z=Math.floor((y+H)*_g),X=Math.floor((w+G)*_g);this.index.add(Z,X),this.keys.push(O),this.crossTileIDs.push($)}this.index.finish()}findMatches(o,l,m){const y=this.tileID.canonical.z<l.canonical.z?1:Math.pow(2,this.tileID.canonical.z-l.canonical.z),w=_g/Math.pow(2,l.canonical.z-this.tileID.canonical.z),E=l.canonical.x*r.ag,O=l.canonical.y*r.ag;for(let $=0;$<o.length;$++){const H=o.get($);if(H.crossTileID)continue;const{key:G,tileAnchorX:Z,tileAnchorY:X}=H,oe=Math.floor((E+Z)*w),xe=Math.floor((O+X)*w),ve=this.index.range(oe-y,xe-y,oe+y,xe+y);for(const Ce of ve){const Te=this.crossTileIDs[Ce];if(this.keys[Ce]===G&&!m.has(Te)){m.add(Te),H.crossTileID=Te;break}}}}}class Ny{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Wx{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(o){const l=Math.round((o-this.lng)/360);if(l!==0)for(const m in this.indexes){const y=this.indexes[m],w={};for(const E in y){const O=y[E];O.tileID=O.tileID.unwrapTo(O.tileID.wrap+l),w[O.tileID.key]=O}this.indexes[m]=w}this.lng=o}addBucket(o,l,m){if(this.indexes[o.overscaledZ]&&this.indexes[o.overscaledZ][o.key]){if(this.indexes[o.overscaledZ][o.key].bucketInstanceId===l.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(o.overscaledZ,this.indexes[o.overscaledZ][o.key])}for(let w=0;w<l.symbolInstances.length;w++)l.symbolInstances.get(w).crossTileID=0;this.usedCrossTileIDs[o.overscaledZ]||(this.usedCrossTileIDs[o.overscaledZ]=new Set);const y=this.usedCrossTileIDs[o.overscaledZ];for(const w in this.indexes){const E=this.indexes[w];if(Number(w)>o.overscaledZ)for(const O in E){const $=E[O];$.tileID.isChildOf(o)&&$.findMatches(l.symbolInstances,o,y)}else{const O=E[o.scaledTo(Number(w)).key];O&&O.findMatches(l.symbolInstances,o,y)}}for(let w=0;w<l.symbolInstances.length;w++){const E=l.symbolInstances.get(w);E.crossTileID||(E.crossTileID=m.generate(),y.add(E.crossTileID))}return this.indexes[o.overscaledZ]===void 0&&(this.indexes[o.overscaledZ]={}),this.indexes[o.overscaledZ][o.key]=new Gx(o,l.symbolInstances,l.bucketInstanceId),!0}removeBucketCrossTileIDs(o,l){for(const m of l.crossTileIDs)this.usedCrossTileIDs[o].delete(m)}removeStaleBuckets(o){let l=!1;for(const m in this.indexes){const y=this.indexes[m];for(const w in y)o[y[w].bucketInstanceId]||(this.removeBucketCrossTileIDs(m,y[w]),delete y[w],l=!0)}return l}}class yg{constructor(){this.layerIndexes={},this.crossTileIDs=new Ny,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(o,l,m,y){let w=this.layerIndexes[o.fqid];w===void 0&&(w=this.layerIndexes[o.fqid]=new Wx);let E=!1;const O={};y.name!=="globe"&&w.handleWrapJump(m);for(const $ of l){const H=$.getBucket(o);H&&o.fqid===H.layerIds[0]&&(H.bucketInstanceId||(H.bucketInstanceId=++this.maxBucketInstanceId),w.addBucket($.tileID,H,this.crossTileIDs)&&(E=!0),O[H.bucketInstanceId]=!0)}return w.removeStaleBuckets(O)&&(E=!0),E}pruneUnusedLayers(o){const l={};o.forEach(m=>{l[m]=!0});for(const m in this.layerIndexes)l[m]||delete this.layerIndexes[m]}}const nu=771;class Lr{constructor(o,l,m,y){this.blendFunction=o,this.blendColor=l,this.mask=m,this.blendEquation=y}}Lr.Replace=[1,0,1,0],Lr.disabled=new Lr(Lr.Replace,r.aj.transparent,[!1,!1,!1,!1]),Lr.unblended=new Lr(Lr.Replace,r.aj.transparent,[!0,!0,!0,!0]),Lr.alphaBlended=new Lr([1,nu,1,nu],r.aj.transparent,[!0,!0,!0,!0]),Lr.alphaBlendedNonPremultiplied=new Lr([770,nu,770,nu],r.aj.transparent,[!0,!0,!0,!0]),Lr.multiply=new Lr([774,0,774,0],r.aj.transparent,[!0,!0,!0,!0]);class or{constructor(o,l,m){this.func=o,this.mask=l,this.range=m}}or.ReadOnly=!1,or.ReadWrite=!0,or.disabled=new or(519,or.ReadOnly,[0,1]);const Xf=7680;class fr{constructor(o,l,m,y,w,E){this.test=o,this.ref=l,this.mask=m,this.fail=y,this.depthFail=w,this.pass=E}}fr.disabled=new fr({func:519,mask:0},0,0,Xf,Xf,Xf);const Zu=1029,Jf=2305;class _r{constructor(o,l,m){this.enable=o,this.mode=l,this.frontFace=m}}function Yu(f,o){const l=r.bG(f,3);r.ab.mat4.fromQuat(f,o),r.bI(f,3,l)}function ru(f,o){const l=r.ab.quat.identity([]);return r.ab.quat.rotateZ(l,l,-o),r.ab.quat.rotateX(l,l,-f),l}function bg(f,o){const l=[f[0],f[1],0],m=[o[0],o[1],0];if(r.ab.vec3.length(l)>=1e-15){const E=r.ab.vec3.normalize([],l);r.ab.vec3.scale(m,E,r.ab.vec3.dot(m,E)),o[0]=m[0],o[1]=m[1]}const y=r.ab.vec3.cross([],o,f);if(r.ab.vec3.len(y)<1e-15)return null;const w=Math.atan2(-y[1],y[0]);return ru(Math.atan2(Math.sqrt(f[0]*f[0]+f[1]*f[1]),-f[2]),w)}_r.disabled=new _r(!1,Zu,Jf),_r.backCCW=new _r(!0,Zu,Jf),_r.backCW=new _r(!0,Zu,2304),_r.frontCW=new _r(!0,1028,2304),_r.frontCCW=new _r(!0,1028,Jf);class Qf{constructor(o,l){this.position=o,this.orientation=l}get position(){return this._position}set position(o){if(o){const l=o instanceof r.aa?o:new r.aa(o[0],o[1],o[2]);this._renderWorldCopies&&(l.x=r.bF(l.x,0,1)),this._position=l}else this._position=null}lookAtPoint(o,l){if(this.orientation=null,!this.position)return;const m=this.position,y=this._elevation?this._elevation.getAtPointOrZero(r.aa.fromLngLat(o)):0,w=r.aa.fromLngLat(o,y),E=[w.x-m.x,w.y-m.y,w.z-m.z];l||(l=[0,0,1]),l[2]=Math.abs(l[2]),this.orientation=bg(E,l)}setPitchBearing(o,l){this.orientation=ru(r.ai(o),r.ai(-l))}}class xs{constructor(o,l){this._transform=r.ab.mat4.identity([]),this.orientation=l,this.position=o}get mercatorPosition(){const o=this.position;return new r.aa(o[0],o[1],o[2])}get position(){const o=r.bG(this._transform,3);return[o[0],o[1],o[2]]}set position(o){var l;o&&r.bI(this._transform,3,[(l=o)[0],l[1],l[2],1])}get orientation(){return this._orientation}set orientation(o){this._orientation=o||r.ab.quat.identity([]),o&&Yu(this._transform,this._orientation)}getPitchBearing(){const o=this.forward(),l=this.right();return{bearing:Math.atan2(-l[1],l[0]),pitch:Math.atan2(Math.sqrt(o[0]*o[0]+o[1]*o[1]),-o[2])}}setPitchBearing(o,l){this._orientation=ru(o,l),Yu(this._transform,this._orientation)}forward(){const o=r.bG(this._transform,2);return[-o[0],-o[1],-o[2]]}up(){const o=r.bG(this._transform,1);return[-o[0],-o[1],-o[2]]}right(){const o=r.bG(this._transform,0);return[o[0],o[1],o[2]]}getCameraToWorld(o,l){const m=new Float64Array(16);return r.ab.mat4.invert(m,this.getWorldToCamera(o,l)),m}getCameraToWorldMercator(){return this._transform}getWorldToCameraPosition(o,l,m){const y=this.position;r.ab.vec3.scale(y,y,-o);const w=new Float64Array(16);return r.ab.mat4.fromScaling(w,[m,m,m]),r.ab.mat4.translate(w,w,y),w[10]*=l,w}getWorldToCamera(o,l){const m=new Float64Array(16),y=new Float64Array(4),w=this.position;return r.ab.quat.conjugate(y,this._orientation),r.ab.vec3.scale(w,w,-o),r.ab.mat4.fromQuat(m,y),r.ab.mat4.translate(m,m,w),m[1]*=-1,m[5]*=-1,m[9]*=-1,m[13]*=-1,m[8]*=l,m[9]*=l,m[10]*=l,m[11]*=l,m}getCameraToClipPerspective(o,l,m,y){const w=new Float64Array(16);return r.ab.mat4.perspective(w,o,l,m,y),w}getCameraToClipOrthographic(o,l,m,y,w,E){const O=new Float64Array(16);return r.ab.mat4.ortho(O,o,l,m,y,w,E),O}getDistanceToElevation(o,l=!1){const m=o===0?0:r.bH(o,l?r.aS(this.position[1]):this.position[1]),y=this.forward();return(m-this.position[2])/y[2]}clone(){return new xs([...this.position],[...this.orientation])}}const Wi={BaseColor:5,MetallicRoughness:6,Normal:7,Occlusion:8,Emission:9,LUT:10,ShadowMap0:11};class In{constructor(o=0,l=0,m=0,y=0){if(isNaN(o)||o<0||isNaN(l)||l<0||isNaN(m)||m<0||isNaN(y)||y<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=o,this.bottom=l,this.left=m,this.right=y}interpolate(o,l,m){return l.top!=null&&o.top!=null&&(this.top=r.af(o.top,l.top,m)),l.bottom!=null&&o.bottom!=null&&(this.bottom=r.af(o.bottom,l.bottom,m)),l.left!=null&&o.left!=null&&(this.left=r.af(o.left,l.left,m)),l.right!=null&&o.right!=null&&(this.right=r.af(o.right,l.right,m)),this}getCenter(o,l){const m=r.aw((this.left+o-this.right)/2,0,o),y=r.aw((this.top+l-this.bottom)/2,0,l);return new r.P(m,y)}equals(o){return this.top===o.top&&this.bottom===o.bottom&&this.left===o.left&&this.right===o.right}clone(){return new In(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}const xg=(f,o,l)=>(1-l)*f+l*o,ep=f=>f*f*f*f*f;class _h{constructor(o,l,m,y,w,E,O){this.tileSize=512,this._renderWorldCopies=w===void 0||w,this._minZoom=o||0,this._maxZoom=l||22,this._minPitch=m??0,this._maxPitch=y??60,this.setProjection(E),this.setMaxBounds(O),this.width=0,this.height=0,this._center=new r.bO(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new In,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._expandedProjMatrixCache={},this._distanceTileDataCache={},this._camera=new xs,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._tileCoverLift=0,this.freezeTileCoverage=!1,this._horizonShift=.1,this._orthographicProjectionAtLowPitch=!1}clone(){const o=new _h(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection());return o._elevation=this._elevation,o._centerAltitude=this._centerAltitude,o._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,o.tileSize=this.tileSize,o.mercatorFromTransition=this.mercatorFromTransition,o.width=this.width,o.height=this.height,o.cameraElevationReference=this.cameraElevationReference,o._center=this._center,o._setZoom(this.zoom),o._seaLevelZoom=this._seaLevelZoom,o.angle=this.angle,o._fov=this._fov,o._pitch=this._pitch,o._nearZ=this._nearZ,o._farZ=this._farZ,o._averageElevation=this._averageElevation,o._orthographicProjectionAtLowPitch=this._orthographicProjectionAtLowPitch,o._unmodified=this._unmodified,o._edgeInsets=this._edgeInsets.clone(),o._camera=this._camera.clone(),o._calcMatrices(),o.freezeTileCoverage=this.freezeTileCoverage,o.frustumCorners=this.frustumCorners,o}get isOrthographic(){return this.projection.name!=="globe"&&this._orthographicProjectionAtLowPitch&&this.pitch<15}get elevation(){return this._elevation}set elevation(o){this._elevation!==o&&(this._elevation=o,this._updateCameraOnTerrain(),this._calcMatrices())}get depthOcclusionForSymbolsAndCircles(){return this.projection.name!=="globe"&&!this.isOrthographic}updateElevation(o,l=!1){const m=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(this._seaLevelZoom==null||m)&&this._updateCameraOnTerrain(),(o||m)&&this._constrainCamera(l),this._calcMatrices()}getProjection(){return r.ay(this.projection,["name","center","parallels"])}setProjection(o){this.projectionOptions=o||{name:"mercator"};const l=this.projection?this.getProjection():void 0;this.projection=r.bP(this.projectionOptions);const m=this.getProjection(),y=!r.bn(l,m);return y&&this._calcMatrices(),this.mercatorFromTransition=!1,y}setOrthographicProjectionAtLowPitch(o){return this._orthographicProjectionAtLowPitch!==o&&(this._orthographicProjectionAtLowPitch=o,this._calcMatrices(),!0)}setMercatorFromTransition(){const o=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=r.bP({name:"mercator"});const l=o!==this.projection.name;return l&&this._calcMatrices(),l}get minZoom(){return this._minZoom}set minZoom(o){this._minZoom!==o&&(this._minZoom=o,this.zoom=Math.max(this.zoom,o))}get maxZoom(){return this._maxZoom}set maxZoom(o){this._maxZoom!==o&&(this._maxZoom=o,this.zoom=Math.min(this.zoom,o))}get minPitch(){return this._minPitch}set minPitch(o){this._minPitch!==o&&(this._minPitch=o,this.pitch=Math.max(this.pitch,o))}get maxPitch(){return this._maxPitch}set maxPitch(o){this._maxPitch!==o&&(this._maxPitch=o,this.pitch=Math.min(this.pitch,o))}get renderWorldCopies(){return this._renderWorldCopies&&this.projection.supportsWorldCopies===!0}set renderWorldCopies(o){o===void 0?o=!0:o===null&&(o=!1),this._renderWorldCopies=o}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){const o=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(o))}get cameraWorldSize(){const o=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(o))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return r.bH(1,this.center.lat)*this.cameraWorldSizeForFog}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new r.P(this.width,this.height)}get bearing(){return r.bF(this.rotation,-180,180)}set bearing(o){this.rotation=o}get rotation(){return-this.angle/Math.PI*180}set rotation(o){const l=-o*Math.PI/180;this.angle!==l&&(this._unmodified=!1,this.angle=l,this._calcMatrices(),this.rotationMatrix=r.ab.mat2.create(),r.ab.mat2.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(o){const l=r.aw(o,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==l&&(this._unmodified=!1,this._pitch=l,this._calcMatrices())}get aspect(){return this.width/this.height}get fov(){return this._fov/Math.PI*180}get fovX(){return this._fov}get fovY(){const o=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/o)}set fov(o){o=Math.max(.01,Math.min(60,o)),this._fov!==o&&(this._unmodified=!1,this._fov=r.ai(o),this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(o){this._averageElevation=o,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(o){const l=Math.min(Math.max(o,this.minZoom),this.maxZoom);this._zoom!==l&&(this._unmodified=!1,this._setZoom(l),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(o){this._zoom=o,this.scale=this.zoomScale(o),this.tileZoom=Math.floor(o),this.zoomFraction=o-this.tileZoom}get tileCoverLift(){return this._tileCoverLift}set tileCoverLift(o){this._tileCoverLift!==o&&(this._tileCoverLift=o)}_updateCameraOnTerrain(){const o=this.elevation?this.elevation.getAtPoint(this.locationCoordinate(this.center),Number.NEGATIVE_INFINITY):Number.NEGATIVE_INFINITY,l=this.elevation&&o===Number.NEGATIVE_INFINITY&&this.elevation.visibleDemTiles.length>0&&this.elevation.exaggeration()>0&&this._centerAltitudeValidForExaggeration;if(!this._elevation||o===Number.NEGATIVE_INFINITY&&(!l||!this._centerAltitude))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const m=this._elevation;l||this._centerAltitude&&this._centerAltitudeValidForExaggeration&&m.exaggeration()&&this._centerAltitudeValidForExaggeration!==m.exaggeration()?(this._centerAltitude=this._centerAltitude/this._centerAltitudeValidForExaggeration*m.exaggeration(),this._centerAltitudeValidForExaggeration=m.exaggeration()):(this._centerAltitude=o||0,this._centerAltitudeValidForExaggeration=m.exaggeration()),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){this._centerAltitudeValidForExaggeration!==void 0&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;const o=this._elevation,l=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],m=this.horizonLineFromTop();let y=0,w=0;for(let E=0;E<l.length;E++){const O=new r.P(l[E][0]*this.width,m+l[E][1]*(this.height-m)),$=o.pointCoordinate(O);if(!$)continue;const H=1/Math.hypot($[0]-this._camera.position[0],$[1]-this._camera.position[1]);y+=$[3]*H,w+=H}return w===0?NaN:y/w}get center(){return this._center}set center(o){o.lat===this._center.lat&&o.lng===this._center.lng||(this._unmodified=!1,this._center=o,this._terrainEnabled()&&(this.cameraElevationReference==="ground"?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(this._seaLevelZoom==null||!this._elevation)return;const o=this._seaLevelZoom,l=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),m=this.pixelsPerMeter/this.worldSize*l,y=this._mercatorZfromZoom(o),w=this._mercatorZfromZoom(this._maxZoom),E=Math.max(y-m,w);this._setZoom(this._zoomFromMercatorZ(E))}get padding(){return this._edgeInsets.toJSON()}set padding(o){this._edgeInsets.equals(o)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,o,1),this._calcMatrices())}computeZoomRelativeTo(o){const l=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,o.toAltitude()));let m;m=o.z<this._camera.position[2]?[l.x,l.y,l.z]:[o.x,o.y,o.z];const y=r.ab.vec3.length(r.ab.vec3.sub([],this._camera.position,m));return r.aw(this._zoomFromMercatorZ(y),this._minZoom,this._maxZoom)}setFreeCameraOptions(o){if(!this.height||!o.position&&!o.orientation)return;this._updateCameraState();let l=!1;if(o.orientation&&!r.ab.quat.exactEquals(o.orientation,this._camera.orientation)&&(l=this._setCameraOrientation(o.orientation)),o.position){const m=[o.position.x,o.position.y,o.position.z];r.ab.vec3.exactEquals(m,this._camera.position)||(this._setCameraPosition(m),l=!0)}l&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const o=this._camera.position,l=new Qf;return l.position=new r.aa(o[0],o[1],o[2]),l.orientation=this._camera.orientation,l._elevation=this.elevation,l._renderWorldCopies=this.renderWorldCopies,l}_setCameraOrientation(o){if(!r.ab.quat.length(o))return!1;r.ab.quat.normalize(o,o);const l=r.ab.vec3.transformQuat([],[0,0,-1],o),m=r.ab.vec3.transformQuat([],[0,-1,0],o);if(m[2]<0)return!1;const y=bg(l,m);return!!y&&(this._camera.orientation=y,!0)}_setCameraPosition(o){const l=this.zoomScale(this.minZoom)*this.tileSize,m=this.zoomScale(this.maxZoom)*this.tileSize,y=this.cameraToCenterDistance;o[2]=r.aw(o[2],y/m,y/l),this._camera.position=o}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(o){return this._edgeInsets.equals(o)}interpolatePadding(o,l,m){this._unmodified=!1,this._edgeInsets.interpolate(o,l,m),this._constrain(),this._calcMatrices()}coveringZoomLevel(o){const l=(o.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/o.tileSize));return Math.max(0,l)}getVisibleUnwrappedCoordinates(o){const l=[new r.bQ(0,o)];if(this.renderWorldCopies){const m=this.pointCoordinate(new r.P(0,0)),y=this.pointCoordinate(new r.P(this.width,0)),w=this.pointCoordinate(new r.P(this.width,this.height)),E=this.pointCoordinate(new r.P(0,this.height)),O=Math.floor(Math.min(m.x,y.x,w.x,E.x)),$=Math.floor(Math.max(m.x,y.x,w.x,E.x)),H=1;for(let G=O-H;G<=$+H;G++)G!==0&&l.push(new r.bQ(G,o))}return l}isLODDisabled(o){return(!o||this.pitch<=60)&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace}extendTileCover(o,l,m){let y=[];const w=m!==void 0,E=!w;if(E&&this.zoom<l||w&&m[0]===0&&m[1]===0)return y;const O=new Set,$=(G,Z,X,oe,xe)=>{const ve=r.c5(Z,G,X,oe,xe);O.has(ve)||(y.push(new r.aG(G,Z,X,oe,xe)),O.add(ve))};for(let G=0;G<o.length;G++){const Z=o[G];if(E&&Z.canonical.z!==l)continue;const X=Z.canonical,oe=Z.overscaledZ,xe=Z.wrap,ve=1<<X.z,Ce=X.x+1<ve,Te=X.x>0,Le=X.y+1<ve,Ge=X.y>0,He=Z.wrap-(Te?0:1),rt=Z.wrap+(Ce?0:1),Xe=Te?X.x-1:ve-1,et=Ce?X.x+1:0;if(w)m[0]<0?($(oe,rt,X.z,et,X.y),m[1]<0&&Le&&($(oe,xe,X.z,X.x,X.y+1),$(oe,rt,X.z,et,X.y+1)),m[1]>0&&Ge&&($(oe,xe,X.z,X.x,X.y-1),$(oe,rt,X.z,et,X.y-1))):m[0]>0?($(oe,He,X.z,Xe,X.y),m[1]<0&&Le&&($(oe,xe,X.z,X.x,X.y+1),$(oe,He,X.z,Xe,X.y+1)),m[1]>0&&Ge&&($(oe,xe,X.z,X.x,X.y-1),$(oe,He,X.z,Xe,X.y-1))):m[1]<0&&Le?$(oe,xe,X.z,X.x,X.y+1):Ge&&$(oe,xe,X.z,X.x,X.y-1);else{const Ye=Z.visibleQuadrants;1&Ye&&($(oe,He,X.z,Xe,X.y),Ge&&($(oe,xe,X.z,X.x,X.y-1),$(oe,He,X.z,Xe,X.y-1))),2&Ye&&($(oe,rt,X.z,et,X.y),Ge&&($(oe,xe,X.z,X.x,X.y-1),$(oe,rt,X.z,et,X.y-1))),4&Ye&&($(oe,He,X.z,Xe,X.y),Le&&($(oe,xe,X.z,X.x,X.y+1),$(oe,He,X.z,Xe,X.y+1))),8&Ye&&($(oe,rt,X.z,et,X.y),Le&&($(oe,xe,X.z,X.x,X.y+1),$(oe,rt,X.z,et,X.y+1)))}}const H=[];for(const G of y)y.some(Z=>G.isChildOf(Z))||H.push(G);if(y=H.filter(G=>!o.some(Z=>!!(G.overscaledZ<l&&Z.isChildOf(G))||G.equals(Z)||G.isChildOf(Z))),E){const G=1<<l,Z=this.projection.name==="globe"?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),X=[G*Z.x,G*Z.y],oe=4,xe=oe*oe;y=y.filter(ve=>{const Ce=ve.canonical.x+.5-X[0],Te=ve.canonical.y+.5-X[1];return Ce*Ce+Te*Te<xe})}return y}coveringTiles(o){let l=this.coveringZoomLevel(o);const m=l,y=this.elevation&&this.elevation.exaggeration(),w=y&&!o.isTerrainDEM,E=this.projection.name==="mercator";if(o.minzoom!==void 0&&l<o.minzoom)return[];o.maxzoom!==void 0&&l>o.maxzoom&&(l=o.maxzoom);const O=this.locationCoordinate(this.center),$=this.center.lat,H=1<<l,G=[H*O.x,H*O.y,0],Z=this.projection.name==="globe",X=!Z,oe=r.bR.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,l,X),xe=Z?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),ve=H*r.bH(1,this.center.lat),Ce=this._camera.position[2]/r.bH(1,this.center.lat),Te=[H*xe.x,H*xe.y,Ce*(X?1:ve)],Le=Z||y,Ge=this.cameraToCenterDistance/o.tileSize*(o.roundZoom?1:.502),He=this.isLODDisabled(!0)?l:0;let rt;if(this._elevation&&o.isTerrainDEM)rt=1e4*this._elevation.exaggeration();else if(this._elevation){const Tt=this._elevation.getMinMaxForVisibleTiles();rt=Tt?Tt.max:this._centerAltitude}else rt=this._centerAltitude;const Xe=o.isTerrainDEM?-rt:this._elevation?this._elevation.getMinElevationBelowMSL():0,et=this.projection.isReprojectedInTileSpace?r.bS(this):1,Ye=Tt=>{const Ht=new r.aa(Tt.x+25e-6,Tt.y,Tt.z),Cn=new r.aa(Tt.x,Tt.y+25e-6,Tt.z),dn=Tt.toLngLat(),nn=Ht.toLngLat(),vn=Cn.toLngLat(),Tn=this.locationCoordinate(dn),Ln=this.locationCoordinate(nn),Un=this.locationCoordinate(vn),dr=Math.hypot(Ln.x-Tn.x,Ln.y-Tn.y),nr=Math.hypot(Un.x-Tn.x,Un.y-Tn.y);return Math.sqrt(dr*nr)*et/25e-6},at=Tt=>{const rn=rt,Ht=Xe;return{aabb:r.bV(this,H,0,0,0,Tt,Ht,rn,this.projection),zoom:0,x:0,y:0,minZ:Ht,maxZ:rn,wrap:Tt,fullyVisible:!1}},gt=[];let Vt=[];const Rt=l,tn=o.reparseOverscaled?m:l,Jt=(Ce-this._centerAltitude)*ve,Et=Tt=>{if(!this._elevation||!Tt.tileID||!E)return;const rn=this._elevation.getMinMaxForTile(Tt.tileID),Ht=Tt.aabb;rn?(Ht.min[2]=rn.min,Ht.max[2]=rn.max,Ht.center[2]=(Ht.min[2]+Ht.max[2])/2):(Tt.shouldSplit=gn(Tt),Tt.shouldSplit||(Ht.min[2]=Ht.max[2]=Ht.center[2]=this._centerAltitude))},jt=(Tt,rn)=>{if(.707*rn<Tt)return 1;const Ht=rn/Tt;return Ht/(1.4144271570014144+(Math.pow(1.1,Ht-1.4144271570014144+1)-1)/(1.1-1)-1)},gn=Tt=>{if(Tt.zoom<He)return!0;if(Tt.zoom===Rt)return!1;if(Tt.shouldSplit!=null)return Tt.shouldSplit;const rn=Tt.aabb.distanceX(Te),Ht=Tt.aabb.distanceY(Te);let Cn=Jt,dn=1;if(Z){Cn=Tt.aabb.distanceZ(Te);const nr=Math.pow(2,Tt.zoom),ir=r.aS((Tt.y+1)/nr),br=r.aS(Tt.y/nr),jr=Math.min(Math.max($,ir),br),ho=r.c9(jr)/r.c9($);if(dn=jr===$?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,ho/this._mercatorScaleRatio),this.zoom<=r.c6&&Tt.zoom===Rt-1&&ho>=.9)return!0}else if(w&&(Cn=Tt.aabb.distanceZ(Te)*ve),this.projection.isReprojectedInTileSpace&&m<=5){const nr=Math.pow(2,Tt.zoom),ir=Ye(new r.aa((Tt.x+.5)/nr,(Tt.y+.5)/nr));dn=ir>.85?1:ir}if(!E){const nr=Math.sqrt(rn*rn+Ht*Ht+Cn*Cn);let ir=(1<<Rt-Tt.zoom)*Ge*dn;return ir*=jt(Math.max(Cn,Jt),nr),nr<ir}let nn=Number.MAX_VALUE,vn=0;const Tn=Tt.aabb.getCorners(),Ln=[];for(const nr of Tn){r.ab.vec3.sub(Ln,nr,Te),Z||(w?Ln[2]*=ve:Ln[2]=Jt);const ir=r.ab.vec3.dot(Ln,this._camera.forward());ir<nn&&(nn=ir,vn=Math.abs(Ln[2]))}let Un=(1<<Rt-Tt.zoom)*Ge*dn;if(Un*=jt(Math.max(vn,Jt),nn),nn<Un)return!0;const dr=Tt.aabb.closestPoint(G);return dr[0]===G[0]&&dr[1]===G[1]};if(this.renderWorldCopies)for(let Tt=1;Tt<=3;Tt++)gt.push(at(-Tt)),gt.push(at(Tt));for(gt.push(at(0));gt.length>0;){const Tt=gt.pop(),rn=Tt.x,Ht=Tt.y;let Cn=Tt.fullyVisible;const dn=()=>this.projection.name==="globe"&&(Tt.y===0||Tt.y===(1<<Tt.zoom)-1);if(!Cn){let nn=Le?Tt.aabb.intersects(oe):Tt.aabb.intersectsFlat(oe);if(nn===0&&dn()){const vn=new r.bT(Tt.zoom,rn,Ht);nn=r.bU(this,H,vn,!0).intersects(oe)}if(nn===0)continue;Cn=nn===2}if(Tt.zoom!==Rt&&gn(Tt))for(let nn=0;nn<4;nn++){const vn=(rn<<1)+nn%2,Tn=(Ht<<1)+(nn>>1),Ln={aabb:E?Tt.aabb.quadrant(nn):r.bV(this,H,Tt.zoom+1,vn,Tn,Tt.wrap,Tt.minZ,Tt.maxZ,this.projection),zoom:Tt.zoom+1,x:vn,y:Tn,wrap:Tt.wrap,fullyVisible:Cn,tileID:void 0,shouldSplit:void 0,minZ:Tt.minZ,maxZ:Tt.maxZ};w&&!Z&&(Ln.tileID=new r.aG(Tt.zoom+1===Rt?tn:Tt.zoom+1,Tt.wrap,Tt.zoom+1,vn,Tn),Et(Ln)),gt.push(Ln)}else{const nn=Tt.zoom===Rt?tn:Tt.zoom;if(o.minzoom&&o.minzoom>nn)continue;let vn=0;if(!Cn){let dr=Le?Tt.aabb.intersectsPrecise(oe):Tt.aabb.intersectsPreciseFlat(oe);if(dr===0&&dn()){const nr=new r.bT(Tt.zoom,rn,Ht);dr=r.bU(this,H,nr,!0).intersectsPrecise(oe)}if(dr===0)continue;if(o.calculateQuadrantVisibility)if(oe.containsPoint(Tt.aabb.center))vn=15;else for(let nr=0;nr<4;nr++)Tt.aabb.quadrant(nr).intersects(oe)!==0&&(vn|=1<<nr)}const Tn=G[0]-(.5+rn+(Tt.wrap<<Tt.zoom))*(1<<l-Tt.zoom),Ln=G[1]-.5-Ht,Un=Tt.tileID?Tt.tileID:new r.aG(nn,Tt.wrap,Tt.zoom,rn,Ht);o.calculateQuadrantVisibility&&(Un.visibleQuadrants=vn),Vt.push({tileID:Un,distanceSq:Tn*Tn+Ln*Ln})}}if(this.fogCullDistSq){const Tt=this.fogCullDistSq,rn=this.horizonLineFromTop();Vt=Vt.filter(Ht=>{const Cn=[0,0,0,1],dn=[r.ag,r.ag,0,1],nn=this.calculateFogTileMatrix(Ht.tileID.toUnwrapped());r.ab.vec4.transformMat4(Cn,Cn,nn),r.ab.vec4.transformMat4(dn,dn,nn);const vn=r.ab.vec4.min([],Cn,dn),Tn=r.ab.vec4.max([],Cn,dn),Ln=r.bW(vn,Tn);if(Ln===0)return!0;let Un=!1;const dr=this._elevation;if(dr&&Ln>Tt&&rn!==0){const nr=this.calculateProjMatrix(Ht.tileID.toUnwrapped());let ir;o.isTerrainDEM||(ir=dr.getMinMaxForTile(Ht.tileID)),ir||(ir={min:Xe,max:rt});const br=r.c7(this.rotation),jr=[br[0]*r.ag,br[1]*r.ag,ir.max];r.ab.vec3.transformMat4(jr,jr,nr),Un=(1-jr[1])*this.height*.5<rn}return Ln<Tt||Un})}return Vt.sort((Tt,rn)=>Tt.distanceSq-rn.distanceSq).map(Tt=>Tt.tileID)}resize(o,l){this.width=o,this.height=l,this.pixelsToGLUnits=[2/o,-2/l],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(o){return Math.pow(2,o)}scaleZoom(o){return Math.log(o)/Math.LN2}project(o){const l=r.aw(o.lat,-r.bX,r.bX),m=this.projection.project(o.lng,l);return new r.P(m.x*this.worldSize,m.y*this.worldSize)}unproject(o){return this.projection.unproject(o.x/this.worldSize,o.y/this.worldSize)}get point(){return this.project(this.center)}get pointMerc(){return this.point._div(this.worldSize)}get pixelsPerMeterRatio(){return this.pixelsPerMeter/r.bH(1,this.center.lat)/this.worldSize}setLocationAtPoint(o,l){let m,y;const w=this.centerPoint;if(this.projection.name==="globe"){const O=this.worldSize;m=(l.x-w.x)/O,y=(l.y-w.y)/O}else{const O=this.pointCoordinate(l),$=this.pointCoordinate(w);m=O.x-$.x,y=O.y-$.y}const E=this.locationCoordinate(o);this.setLocation(new r.aa(E.x-m,E.y-y))}setLocation(o){this.center=this.coordinateLocation(o),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(o){return this.projection.locationPoint(this,o)}locationPoint3D(o){return this.projection.locationPoint(this,o,!0)}pointLocation(o){return this.coordinateLocation(this.pointCoordinate(o))}pointLocation3D(o){return this.coordinateLocation(this.pointCoordinate3D(o))}locationCoordinate(o,l){const m=l?r.bH(l,o.lat):void 0,y=this.projection.project(o.lng,o.lat);return new r.aa(y.x,y.y,m)}coordinateLocation(o){return this.projection.unproject(o.x,o.y)}pointRayIntersection(o,l){const m=l??this._centerAltitude,y=[o.x,o.y,0,1],w=[o.x,o.y,1,1];r.ab.vec4.transformMat4(y,y,this.pixelMatrixInverse),r.ab.vec4.transformMat4(w,w,this.pixelMatrixInverse);const E=w[3];r.ab.vec4.scale(y,y,1/y[3]),r.ab.vec4.scale(w,w,1/E);const O=y[2],$=w[2];return{p0:y,p1:w,t:O===$?0:(m-O)/($-O)}}screenPointToMercatorRay(o){const l=[o.x,o.y,0,1],m=[o.x,o.y,1,1];return r.ab.vec4.transformMat4(l,l,this.pixelMatrixInverse),r.ab.vec4.transformMat4(m,m,this.pixelMatrixInverse),r.ab.vec4.scale(l,l,1/l[3]),r.ab.vec4.scale(m,m,1/m[3]),l[2]=r.bH(l[2],this._center.lat)*this.worldSize,m[2]=r.bH(m[2],this._center.lat)*this.worldSize,r.ab.vec4.scale(l,l,1/this.worldSize),r.ab.vec4.scale(m,m,1/this.worldSize),new r.aq([l[0],l[1],l[2]],r.ab.vec3.normalize([],r.ab.vec3.sub([],m,l)))}rayIntersectionCoordinate(o){const{p0:l,p1:m,t:y}=o,w=r.bH(l[2],this._center.lat),E=r.bH(m[2],this._center.lat);return new r.aa(r.af(l[0],m[0],y)/this.worldSize,r.af(l[1],m[1],y)/this.worldSize,r.af(w,E,y))}pointCoordinate(o,l=this._centerAltitude){return this.projection.pointCoordinate(this,o.x,o.y,l)}pointCoordinate3D(o){if(!this.elevation)return this.pointCoordinate(o);let l=this.projection.pointCoordinate3D(this,o.x,o.y);if(l)return new r.aa(l[0],l[1],l[2]);let m=0,y=this.horizonLineFromTop();if(o.y>y)return this.pointCoordinate(o);const w=.02*y,E=o.clone();for(let O=0;O<10&&y-m>w;O++){E.y=r.af(m,y,.66);const $=this.projection.pointCoordinate3D(this,E.x,E.y);$?(y=E.y,l=$):m=E.y}return l?new r.aa(l[0],l[1],l[2]):this.pointCoordinate(o)}isPointAboveHorizon(o){return this.projection.isPointAboveHorizon(this,o)}isPointOnSurface(o){if(o.y<0||o.y>this.height||o.x<0||o.x>this.width)return!1;if(this.elevation||this.zoom>=r.bY)return!this.isPointAboveHorizon(o);const l=this.pointCoordinate(o);return l.y>=0&&l.y<=1}_coordinatePoint(o,l){const m=l&&this.elevation?this.elevation.getAtPointOrZero(o,this._centerAltitude):this._centerAltitude,y=[o.x*this.worldSize,o.y*this.worldSize,m+o.toAltitude(),1];return r.ab.vec4.transformMat4(y,y,this.pixelMatrix),y[3]>0?new r.P(y[0]/y[3],y[1]/y[3]):new r.P(Number.MAX_VALUE,Number.MAX_VALUE)}_getBoundsNonRectangular(){const{top:o,left:l}=this._edgeInsets,m=this.height-this._edgeInsets.bottom,y=this.width-this._edgeInsets.right,w=this.pointLocation3D(new r.P(l,o)),E=this.pointLocation3D(new r.P(y,o)),O=this.pointLocation3D(new r.P(y,m)),$=this.pointLocation3D(new r.P(l,m));let H=Math.min(w.lng,E.lng,O.lng,$.lng),G=Math.max(w.lng,E.lng,O.lng,$.lng),Z=Math.min(w.lat,E.lat,O.lat,$.lat),X=Math.max(w.lat,E.lat,O.lat,$.lat);const oe=Math.pow(2,-this.zoom)/16*270,xe=this.projection.name==="globe"?1:4,ve=(Ce,Te,Le,Ge,He)=>{const rt=(Ce+Le)/2,Xe=(Te+Ge)/2,et=new r.P(rt,Xe),{lng:Ye,lat:at}=this.pointLocation3D(et),gt=Math.max(0,H-Ye,Z-at,Ye-G,at-X);H=Math.min(H,Ye),G=Math.max(G,Ye),Z=Math.min(Z,at),X=Math.max(X,at),(He<xe||gt>oe)&&(ve(Ce,Te,rt,Xe,He+1),ve(rt,Xe,Le,Ge,He+1))};if(ve(l,o,y,o,1),ve(y,o,y,m,1),ve(y,m,l,m,1),ve(l,m,l,o,1),this.projection.name==="globe"){const[Ce,Te]=r.bZ(this);Ce?(X=90,G=180,H=-180):Te&&(Z=-90,G=180,H=-180)}return new r.az(new r.bO(H,Z),new r.bO(G,X))}_getBoundsRectangular(o,l){const{top:m,left:y}=this._edgeInsets,w=this.height-this._edgeInsets.bottom,E=this.width-this._edgeInsets.right,O=new r.P(y,m),$=new r.P(E,m),H=new r.P(E,w),G=new r.P(y,w);let Z=this.pointCoordinate(O,o),X=this.pointCoordinate($,o);const oe=this.pointCoordinate(H,l),xe=this.pointCoordinate(G,l),ve=(Ce,Te)=>(Te.y-Ce.y)/(Te.x-Ce.x);return Z.y>1&&X.y>=0?Z=new r.aa((1-xe.y)/ve(xe,Z)+xe.x,1):Z.y<0&&X.y<=1&&(Z=new r.aa(-xe.y/ve(xe,Z)+xe.x,0)),X.y>1&&Z.y>=0?X=new r.aa((1-oe.y)/ve(oe,X)+oe.x,1):X.y<0&&Z.y<=1&&(X=new r.aa(-oe.y/ve(oe,X)+oe.x,0)),new r.az().extend(this.coordinateLocation(Z)).extend(this.coordinateLocation(X)).extend(this.coordinateLocation(xe)).extend(this.coordinateLocation(oe))}_getBoundsRectangularTerrain(){const o=this.elevation;if(!o.visibleDemTiles.length||o.isUsingMockSource())return this._getBoundsRectangular(0,0);const l=o.visibleDemTiles.reduce((m,y)=>{if(y.dem){const w=y.dem.tree;m.min=Math.min(m.min,w.minimums[0]),m.max=Math.max(m.max,w.maximums[0])}return m},{min:Number.MAX_VALUE,max:0});return this._getBoundsRectangular(l.min*o.exaggeration(),l.max*o.exaggeration())}getBounds(){return this.projection.name==="mercator"||this.projection.name==="equirectangular"?this._terrainEnabled()?this._getBoundsRectangularTerrain():this._getBoundsRectangular(0,0):this._getBoundsNonRectangular()}horizonLineFromTop(o=!0){const l=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))-this.centerOffset.y,m=this.height/2-l*(1-this._horizonShift);return o?Math.max(0,m):m}getMaxBounds(){return this.maxBounds}setMaxBounds(o){this.maxBounds=o,this.minLat=-r.bX,this.maxLat=r.bX,this.minLng=-180,this.maxLng=180,o&&(this.minLat=o.getSouth(),this.maxLat=o.getNorth(),this.minLng=o.getWest(),this.maxLng=o.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=r.at(this.minLng)*this.tileSize,this.worldMaxX=r.at(this.maxLng)*this.tileSize,this.worldMinY=r.aA(this.maxLat)*this.tileSize,this.worldMaxY=r.aA(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(o,l){return this.projection.createTileMatrix(this,l,o)}calculateDistanceTileData(o){const l=o.key,m=this._distanceTileDataCache;if(m[l])return m[l];const y=o.canonical,w=1/this.height,E=this.cameraWorldSize,O=E/this.zoomScale(y.z),$=(y.x+Math.pow(2,y.z)*o.wrap)*O,H=y.y*O,G=this.point;G.x*=E/this.worldSize,G.y*=E/this.worldSize;const Z=this.angle,X=Math.sin(-Z),oe=-Math.cos(-Z);return m[l]={bearing:[X,oe],center:[(G.x-$)*w,(G.y-H)*w],scale:O/r.ag*w},m[l]}calculateFogTileMatrix(o){const l=o.key,m=this._fogTileMatrixCache;if(m[l])return m[l];const y=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,o);return r.ab.mat4.multiply(y,this.worldToFogMatrix,y),m[l]=new Float32Array(y),m[l]}calculateProjMatrix(o,l=!1,m=!1){const y=o.key;let w;if(w=m?this._expandedProjMatrixCache:l?this._alignedProjMatrixCache:this._projMatrixCache,w[y])return w[y];const E=this.calculatePosMatrix(o,this.worldSize);let O;return O=this.projection.isReprojectedInTileSpace?this.mercatorMatrix:m?this.expandedFarZProjMatrix:l?this.alignedProjMatrix:this.projMatrix,r.ab.mat4.multiply(E,O,E),w[y]=new Float32Array(E),w[y]}calculatePixelsToTileUnitsMatrix(o){const l=o.tileID.key,m=this._pixelsToTileUnitsCache;if(m[l])return m[l];const y=r.b_(o,this);return m[l]=y,m[l]}customLayerMatrix(){return this.mercatorMatrix.slice()}globeToMercatorMatrix(){if(this.projection.name==="globe"){const o=1/this.worldSize,l=r.ab.mat4.fromScaling([],[o,o,o]);return r.ab.mat4.multiply(l,l,this.globeMatrix),l}}recenterOnTerrain(){if(!this._elevation||this.projection.name==="globe")return;const o=this._elevation;this._updateCameraState();const l=r.bH(1,this._center.lat)*this.worldSize,m=this._computeCameraPosition(l),y=this._camera.forward(),w=r.bH(1,this._center.lat);m[2]/=w,y[2]/=w,r.ab.vec3.normalize(y,y);const E=o.raycast(m,y,o.exaggeration());if(E){const O=r.ab.vec3.scaleAndAdd([],m,y,E),$=new r.aa(O[0],O[1],r.bH(O[2],r.aS(O[1]))),H=($.z+r.ab.vec3.length([$.x-m[0],$.y-m[1],$.z-m[2]*w]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(H),this._centerAltitude=$.toAltitude(),this._center=this.coordinateLocation($),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(o=!1){if(!this._elevation)return;const l=this._elevation,m=r.bH(1,this._center.lat)*this.worldSize,y=this._computeCameraPosition(m),w=l.getAtPointOrZero(new r.aa(...y)),E=this.pixelsPerMeter/this.worldSize*w,O=this._minimumHeightOverTerrain(),$=y[2]-E;if($<=O)if($<0||o){const H=this.locationCoordinate(this._center,this._centerAltitude),G=[y[0],y[1],H.z-y[2]],Z=r.ab.vec3.length(G);G[2]-=(O-$)/this._pixelsPerMercatorPixel;const X=r.ab.vec3.length(G);if(X===0)return;r.ab.vec3.scale(G,G,Z/X*this._pixelsPerMercatorPixel),this._camera.position=[y[0],y[1],H.z*this._pixelsPerMercatorPixel-G[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const o=this.projection.name==="globe"||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||o){const X=this.center;return X.lat=r.aw(X.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!o)&&(X.lng=r.aw(X.lng,this.minLng,this.maxLng)),this.center=X,void(this._constraining=!1)}const l=this._unmodified,{x:m,y}=this.point;let w=0,E=m,O=y;const $=this.width/2,H=this.height/2,G=this.worldMinY*this.scale,Z=this.worldMaxY*this.scale;if(y-H<G&&(O=G+H),y+H>Z&&(O=Z-H),Z-G<this.height&&(w=Math.max(w,this.height/(Z-G)),O=(Z+G)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const X=this.worldMinX*this.scale,oe=this.worldMaxX*this.scale,xe=this.worldSize/2-(X+oe)/2;E=(m+xe+this.worldSize)%this.worldSize-xe,E-$<X&&(E=X+$),E+$>oe&&(E=oe-$),oe-X<this.width&&(w=Math.max(w,this.width/(oe-X)),E=(oe+X)/2)}E===m&&O===y||(this.center=this.unproject(new r.P(E,O))),w&&(this.zoom+=this.scaleZoom(w)),this._constrainCamera(),this._unmodified=l,this._constraining=!1}_minZoomForBounds(){let o=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(o=Math.max(o,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),o}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const o=this.centerOffset,l=this.projection.name==="globe",m=this.pixelsPerMeter;this.projection.name==="globe"&&(this._mercatorScaleRatio=r.bH(1,this.center.lat)/r.bH(1,r.c8));const y=r.b$(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,y),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const w=this.projection.zAxisUnit==="meters"?m:1,E=this._camera.getWorldToCamera(this.worldSize,w);let O;const $=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);if($[8]=2*-o.x/this.width,$[9]=2*o.y/this.height,this.isOrthographic){let at=.5*this.height/Math.tan(this._fov/2)*1*Math.tan(.5*this._fov),gt=at*this.aspect,Vt=-gt,Rt=-at;gt-=o.x,Vt-=o.x,at+=o.y,Rt+=o.y,O=this._camera.getCameraToClipOrthographic(Vt,gt,Rt,at,this._nearZ,this._farZ),((tn,Jt,Et,jt)=>{for(let gn=0;gn<16;gn++)tn[gn]=xg(Jt[gn],Et[gn],jt)})(O,O,$,ep(this.pitch>=15?1:this.pitch/15))}else O=$;const H=r.ab.mat4.mul([],$,E);let G=r.ab.mat4.mul([],O,E);if(this.projection.isReprojectedInTileSpace){const at=this.locationCoordinate(this.center),gt=r.ab.mat4.identity([]);r.ab.mat4.translate(gt,gt,[at.x*this.worldSize,at.y*this.worldSize,0]),r.ab.mat4.multiply(gt,gt,r.c0(this)),r.ab.mat4.translate(gt,gt,[-at.x*this.worldSize,-at.y*this.worldSize,0]),r.ab.mat4.multiply(G,G,gt),r.ab.mat4.multiply(H,H,gt),this.inverseAdjustmentMatrix=r.c1(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];if(this.mercatorMatrix=r.ab.mat4.scale([],G,[this.worldSize,this.worldSize,this.worldSize/w,1]),this.projMatrix=G,this.invProjMatrix=r.ab.mat4.invert(new Float64Array(16),this.projMatrix),l){const at=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,1/0);at[8]=2*-o.x/this.width,at[9]=2*o.y/this.height,this.expandedFarZProjMatrix=r.ab.mat4.mul([],at,E)}else this.expandedFarZProjMatrix=this.projMatrix;const Z=r.ab.mat4.invert([],O);this.frustumCorners=r.c2.fromInvProjectionMatrix(Z,this.horizonLineFromTop(),this.height),this.cameraFrustum=r.bR.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,0,!l);const X=new Float32Array(16);r.ab.mat4.identity(X),r.ab.mat4.scale(X,X,[1,-1,1]),r.ab.mat4.rotateX(X,X,this._pitch),r.ab.mat4.rotateZ(X,X,this.angle);const oe=r.ab.mat4.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ);this.starsProjMatrix=r.ab.mat4.clone(oe);const xe=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;oe[8]=2*-o.x/this.width,oe[9]=2*(o.y+xe)/this.height,this.skyboxMatrix=r.ab.mat4.multiply(X,oe,X);const ve=this.point,Ce=ve.x,Te=ve.y,Le=this.width%2/2,Ge=this.height%2/2,He=Math.cos(this.angle),rt=Math.sin(this.angle),Xe=Ce-Math.round(Ce)+He*Le+rt*Ge,et=Te-Math.round(Te)+He*Ge+rt*Le,Ye=new Float64Array(G);if(r.ab.mat4.translate(Ye,Ye,[Xe>.5?Xe-1:Xe,et>.5?et-1:et,0]),this.alignedProjMatrix=Ye,G=r.ab.mat4.create(),r.ab.mat4.scale(G,G,[this.width/2,-this.height/2,1]),r.ab.mat4.translate(G,G,[1,-1,0]),this.labelPlaneMatrix=G,G=r.ab.mat4.create(),r.ab.mat4.scale(G,G,[1,-1,1]),r.ab.mat4.translate(G,G,[-1,-1,0]),r.ab.mat4.scale(G,G,[2/this.width,2/this.height,1]),this.glCoordMatrix=G,this.pixelMatrix=r.ab.mat4.multiply(new Float64Array(16),this.labelPlaneMatrix,H),this._calcFogMatrices(),this._distanceTileDataCache={},G=r.ab.mat4.invert(new Float64Array(16),this.pixelMatrix),!G)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=G,this.projection.name==="globe"||this.mercatorFromTransition){this.globeMatrix=r.c3(this);const at=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=r.ab.vec3.transformMat4(at,at,E),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=G;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={},this._expandedProjMatrixCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const o=this.cameraWorldSizeForFog,l=this.cameraPixelsPerMeter,m=this._camera.position,y=1/this.height/this._pixelsPerMercatorPixel,w=[o,o,l];r.ab.vec3.scale(w,w,y),r.ab.vec3.scale(m,m,-1),r.ab.vec3.multiply(m,m,w);const E=r.ab.mat4.create();r.ab.mat4.translate(E,E,m),r.ab.mat4.scale(E,E,w),this.mercatorFogMatrix=E,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(o,l,y)}_computeCameraPosition(o){const l=(o=o||this.pixelsPerMeter)/this.pixelsPerMeter,m=this._camera.forward(),y=this.point,w=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*l-o/this.worldSize*this._centerAltitude;return[y.x/this.worldSize-m[0]*w,y.y/this.worldSize-m[1]*w,o/this.worldSize*this._centerAltitude-m[2]*w]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(o){const l=this._maxCameraBoundsDistance()*Math.cos(this._pitch),m=this._camera.position[2],y=o[2];let w=1;this.projection.wrap&&(this.center=this.center.wrap()),y>0&&(w=Math.min((l-m)/y,1)),this._camera.position=r.ab.vec3.scaleAndAdd([],this._camera.position,o,w),this._updateStateFromCamera()}_updateStateFromCamera(){const o=this._camera.position,l=this._camera.forward(),{pitch:m,bearing:y}=this._camera.getPitchBearing(),w=r.bH(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,E=this._mercatorZfromZoom(this._maxZoom)*Math.cos(r.ai(this._maxPitch)),O=Math.max((o[2]-w)/Math.cos(m),E),$=this._zoomFromMercatorZ(O);r.ab.vec3.scaleAndAdd(o,o,l,O),this._pitch=r.aw(m,r.ai(this.minPitch),r.ai(this.maxPitch)),this.angle=r.bF(y,-Math.PI,Math.PI),this._setZoom(r.aw($,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new r.aa(o[0],o[1],o[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(o){return Math.pow(2,o)*this.tileSize}_mercatorZfromZoom(o){return this.cameraToCenterDistance/this._worldSizeFromZoom(o)}_minimumHeightOverTerrain(){const o=Math.min(this._seaLevelZoom!=null?this._seaLevelZoom:this._zoom,this._maxZoom)+4;return this._mercatorZfromZoom(o)}_zoomFromMercatorZ(o){return this.scaleZoom(this.cameraToCenterDistance/(o*this.tileSize))}zoomFromMercatorZAdjusted(o){let l=0,m=r.bY,y=0,w=1/0;for(;m-l>1e-6&&m>l;){const E=l+.5*(m-l),O=this.tileSize*Math.pow(2,E),$=this.getCameraToCenterDistance(this.projection,E,O),H=this.scaleZoom($/(o*this.tileSize)),G=Math.abs(E-H);G<w&&(w=G,y=E),E<H?l=E:m=E}return y}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(r.w("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(o,l){const m=Math.min(o.x,l.x),y=Math.max(o.x,l.x),w=Math.min(o.y,l.y),E=Math.max(o.y,l.y);if(w<this.horizonLineFromTop(!1))return!0;if(this.projection.name!=="mercator")return!1;const O=[new r.P(m,w),new r.P(y,E),new r.P(m,E),new r.P(y,w)],$=this.renderWorldCopies?-3:0,H=this.renderWorldCopies?4:1;for(const G of O){const Z=this.pointRayIntersection(G);if(Z.t<0)return!0;const X=this.rayIntersectionCoordinate(Z);if(X.x<$||X.y<0||X.x>H||X.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+r.c4(this.fovAboveCenter)>88||this.anyCornerOffEdge(new r.P(0,0),new r.P(this.width,this.height))}zoomDeltaToMovement(o,l){const m=r.ab.vec3.length(r.ab.vec3.sub([],this._camera.position,o)),y=this._zoomFromMercatorZ(m)+l;return m-this._mercatorZfromZoom(y)}getCameraPoint(){if(this.projection.name==="globe"){const o=function([l,m,y],w){const E=[l,m,y,1];r.ab.vec4.transformMat4(E,E,w);const O=E[3]=Math.max(E[3],1e-6);return E[0]/=O,E[1]/=O,E[2]/=O,E}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new r.P(o[0],o[1])}{const o=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new r.P(0,o))}}getCameraToCenterDistance(o,l=this.zoom,m=this.worldSize){const y=r.b$(o,l,this.width,this.height,1024),w=o.pixelSpaceConversion(this.center.lat,m,y);let E=.5/Math.tan(.5*this._fov)*this.height*w;return this.isOrthographic&&(E=xg(1,E,ep(this.pitch>=15?1:this.pitch/15))),E}getWorldToCameraMatrix(){const o=this._camera.getWorldToCamera(this.worldSize,this.projection.zAxisUnit==="meters"?this.pixelsPerMeter:1);return this.projection.name==="globe"&&r.ab.mat4.multiply(o,o,this.globeMatrix),o}getFrustum(o){return r.bR.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,o,this.projection.zAxisUnit==="meters")}}const xc=(f,o)=>{if(o>0&&f.terrain&&r.w("Cutoff is currently disabled on terrain"),o<=0||f.terrain)return{shouldRenderCutoff:!1,uniformValues:{u_cutoff_params:[0,0,0,1]}};const l=f.transform,m=Math.max(Math.abs(l._zoom-(f.minCutoffZoom-1)),1),y=l.isLODDisabled(!1)?r.ac(60,45,l.pitch):r.ac(30,15,l.pitch),w=l._farZ-l._nearZ,E=o*l.height,O=((1-($=y))*l.cameraToCenterDistance+$*(l._farZ+E))*m;var $;return{shouldRenderCutoff:y<1,uniformValues:{u_cutoff_params:[l._nearZ,l._farZ,(O-l._nearZ)/w,(O-E-l._nearZ)/w]}}},Vi={cascadeCount:2,normalOffset:3,shadowMapResolution:2048};class Fl{constructor(o,l){this.aabb=o,this.lastCascade=l}}class wg{add(o,l){const m=this.receivers[o.key];m!==void 0?(m.aabb.min[0]=Math.min(m.aabb.min[0],l.min[0]),m.aabb.min[1]=Math.min(m.aabb.min[1],l.min[1]),m.aabb.min[2]=Math.min(m.aabb.min[2],l.min[2]),m.aabb.max[0]=Math.max(m.aabb.max[0],l.max[0]),m.aabb.max[1]=Math.max(m.aabb.max[1],l.max[1]),m.aabb.max[2]=Math.max(m.aabb.max[2],l.max[2])):this.receivers[o.key]=new Fl(l,null)}clear(){this.receivers={}}get(o){return this.receivers[o.key]}computeRequiredCascades(o,l,m){const y=r.cd.fromPoints(o.points);let w=0;for(const E in this.receivers){const O=this.receivers[E];if(!O||!y.intersectsAabb(O.aabb))continue;O.aabb.min=y.closestPoint(O.aabb.min),O.aabb.max=y.closestPoint(O.aabb.max);const $=O.aabb.getCorners();for(let H=0;H<m.length;H++){let G=!0;for(const Z of $){const X=[Z[0]*l,Z[1]*l,Z[2]];if(r.ab.vec3.transformMat4(X,X,m[H].matrix),X[0]<-1||X[0]>1||X[1]<-1||X[1]>1){G=!1;break}}if(O.lastCascade=H,w=Math.max(w,H),G)break}}return w+1}}class ou{constructor(o){this.painter=o,this._enabled=!1,this._shadowLayerCount=0,this._numCascadesToRender=0,this._cascades=[],this._groundShadowTiles=[],this._receivers=new wg,this._depthMode=new or(o.context.gl.LEQUAL,or.ReadWrite,[0,1]),this._uniformValues={u_light_matrix_0:new Float32Array(16),u_light_matrix_1:new Float32Array(16),u_shadow_intensity:0,u_fade_range:[0,0],u_shadow_normal_offset:[1,1,1],u_shadow_texel_size:1,u_shadow_map_resolution:1,u_shadow_direction:[0,0,1],u_shadow_bias:[36e-5,.0012,.012],u_shadowmap_0:0,u_shadowmap_1:0},this._forceDisable=!1,this.useNormalOffset=!1,o.tp.registerParameter(this,["Shadows"],"_forceDisable",{label:"forceDisable"},()=>{this.painter.style.map.triggerRepaint()}),o.tp.registerParameter(Vi,["Shadows"],"cascadeCount",{min:1,max:2,step:1}),o.tp.registerParameter(Vi,["Shadows"],"normalOffset",{min:0,max:10,step:.05}),o.tp.registerParameter(Vi,["Shadows"],"shadowMapResolution",{min:32,max:2048,step:32}),o.tp.registerBinding(this,["Shadows"],"_numCascadesToRender",{readonly:!0,label:"numCascadesToRender"})}destroy(){for(const o of this._cascades)o.texture.destroy(),o.framebuffer.destroy();this._cascades=[]}updateShadowParameters(o,l){const m=this.painter;if(this._enabled=!1,this._shadowLayerCount=0,this._receivers.clear(),!l||!l.properties)return;const y=l.properties.get("shadow-intensity");if(!l.shadowsEnabled()||y<=0||(this._shadowLayerCount=m.style.order.reduce((xe,ve)=>{const Ce=m.style._mergedLayers[ve];return xe+(Ce.hasShadowPass()&&!Ce.isHidden(o.zoom)?1:0)},0),this._enabled=this._shadowLayerCount>0,!this.enabled))return;const w=m.context,E=Vi.shadowMapResolution,O=Vi.shadowMapResolution;if(this._cascades.length===0||Vi.shadowMapResolution!==this._cascades[0].texture.size[0]){this._cascades=[];for(let xe=0;xe<Vi.cascadeCount;++xe){const ve=m._shadowMapDebug,Ce=w.gl,Te=w.createFramebuffer(E,O,ve,"texture"),Le=new r.T(w,{width:E,height:O,data:null},Ce.DEPTH_COMPONENT16);if(Te.depthAttachment.set(Le.texture),ve){const Ge=new r.T(w,{width:E,height:O,data:null},Ce.RGBA8);Te.colorAttachment.set(Ge.texture)}this._cascades.push({framebuffer:Te,texture:Le,matrix:[],far:0,boundingSphereRadius:0,frustum:new r.bR,scale:0})}}this.shadowDirection=su(l);let $=0;if(o.elevation){const xe=o.elevation,ve=[1e4,-1e4];xe.visibleDemTiles.filter(Ce=>Ce.dem).forEach(Ce=>{const Te=Ce.dem.tree;ve[0]=Math.min(ve[0],Te.minimums[0]),ve[1]=Math.max(ve[1],Te.maximums[0])}),ve[0]!==1e4&&($=(ve[1]-ve[0])*xe.exaggeration())}const H=1.5*o.cameraToCenterDistance,G=3*H,Z=new Float64Array(16);for(let xe=0;xe<this._cascades.length;++xe){const ve=this._cascades[xe];let Ce=o.height/50,Te=1;Vi.cascadeCount===1?Te=G:xe===0?Te=H:(Ce=H,Te=G);const[Le,Ge]=qx(o,this.shadowDirection,Ce,Te,Vi.shadowMapResolution,$);ve.scale=o.scale,ve.matrix=Le,ve.boundingSphereRadius=Ge,r.ab.mat4.invert(Z,ve.matrix),ve.frustum=r.bR.fromInvProjectionMatrix(Z,1,0,!0),ve.far=Te}const X=this._cascades.length-1;this._uniformValues.u_fade_range=[.75*this._cascades[X].far,this._cascades[X].far],this._uniformValues.u_shadow_intensity=y,this._uniformValues.u_shadow_direction=[this.shadowDirection[0],this.shadowDirection[1],this.shadowDirection[2]],this._uniformValues.u_shadow_texel_size=1/Vi.shadowMapResolution,this._uniformValues.u_shadow_map_resolution=Vi.shadowMapResolution,this._uniformValues.u_shadowmap_0=Wi.ShadowMap0,this._uniformValues.u_shadowmap_1=Wi.ShadowMap0+1,this._groundShadowTiles=m.transform.coveringTiles({tileSize:512,renderWorldCopies:!0});const oe=m.transform.elevation;for(const xe of this._groundShadowTiles){let ve={min:0,max:0};if(oe){const Ce=oe.getMinMaxForTile(xe);Ce&&(ve=Ce)}this.addShadowReceiver(xe.toUnwrapped(),ve.min,ve.max)}}get enabled(){return this._enabled&&!this._forceDisable}set enabled(o){this._enabled=o}drawShadowPass(o,l){if(!this.enabled)return;const m=this.painter,y=m.context;this._numCascadesToRender=this._receivers.computeRequiredCascades(m.transform.getFrustum(0),m.transform.worldSize,this._cascades),y.viewport.set([0,0,Vi.shadowMapResolution,Vi.shadowMapResolution]);for(let w=0;w<this._numCascadesToRender;++w){m.currentShadowCascade=w,y.bindFramebuffer.set(this._cascades[w].framebuffer.framebuffer),y.clear({color:r.aj.white,depth:1});for(const E of o.order){const O=o._mergedLayers[E];if(!O.hasShadowPass()||O.isHidden(m.transform.zoom))continue;const $=o.getLayerSourceCache(O),H=$?l[$.id]:void 0;(O.type==="model"||H&&H.length)&&m.renderLayer(m,$,O,H)}}m.currentShadowCascade=0}drawGroundShadows(){if(!this.enabled)return;const o=this.painter,l=o.style,m=o.context,y=l.directionalLight,w=l.ambientLight;if(!y||!w)return;const E=[],O=xc(o,o.longestCutoffRange);O.shouldRenderCutoff&&E.push("RENDER_CUTOFF"),E.push("RENDER_SHADOWS","DEPTH_TEXTURE"),this.useNormalOffset&&E.push("NORMAL_OFFSET");const $=Sg(l,y,w),H=new or(m.gl.LEQUAL,or.ReadOnly,o.depthRangeFor3D);for(const G of this._groundShadowTiles){const Z=G.toUnwrapped(),X=o.isTileAffectedByFog(G),oe=o.getOrCreateProgram("groundShadow",{defines:E,overrideFog:X});this.setupShadows(Z,oe),o.uploadCommonUniforms(m,oe,Z,null,O);const xe={u_matrix:o.transform.calculateProjMatrix(Z),u_ground_shadow_factor:$};oe.draw(o,m.gl.TRIANGLES,H,fr.disabled,Lr.multiply,_r.disabled,xe,"ground_shadow",o.tileExtentBuffer,o.quadTriangleIndexBuffer,o.tileExtentSegments,{},o.transform.zoom,null,null)}}getShadowPassColorMode(){return this.painter._shadowMapDebug?Lr.unblended:Lr.disabled}getShadowPassDepthMode(){return this._depthMode}getShadowCastingLayerCount(){return this._shadowLayerCount}calculateShadowPassMatrixFromTile(o){const l=this.painter.transform,m=l.calculatePosMatrix(o,l.worldSize);return r.ab.mat4.multiply(m,this._cascades[this.painter.currentShadowCascade].matrix,m),Float32Array.from(m)}calculateShadowPassMatrixFromMatrix(o){return r.ab.mat4.multiply(o,this._cascades[this.painter.currentShadowCascade].matrix,o),Float32Array.from(o)}setupShadows(o,l,m,y=0){if(!this.enabled)return;const w=this.painter.transform,E=this.painter.context,O=E.gl,$=this._uniformValues,H=new Float64Array(16),G=w.calculatePosMatrix(o,w.worldSize);for(let Z=0;Z<this._cascades.length;Z++)r.ab.mat4.multiply(H,this._cascades[Z].matrix,G),$[Z===0?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(H),E.activeTexture.set(O.TEXTURE0+Wi.ShadowMap0+Z),this._cascades[Z].texture.bind(O.NEAREST,O.CLAMP_TO_EDGE);if(this.useNormalOffset=!!m,this.useNormalOffset){const Z=r.cc(o.canonical),X=2/w.tileSize*r.ag/Vi.shadowMapResolution,oe=X*this._cascades[0].boundingSphereRadius,xe=X*this._cascades[this._cascades.length-1].boundingSphereRadius,ve=(m==="vector-tile"?1:3)/Math.pow(2,y-o.canonical.z-(1-w.zoom+Math.floor(w.zoom)));$.u_shadow_normal_offset=[Z,oe*ve,xe*ve],$.u_shadow_bias=[6e-5,.0012,.012]}else $.u_shadow_bias=[36e-5,.0012,.012];l.setShadowUniformValues(E,$)}setupShadowsFromMatrix(o,l,m=!1){if(!this.enabled)return;const y=this.painter.context,w=y.gl,E=this._uniformValues,O=new Float64Array(16);for(let $=0;$<Vi.cascadeCount;$++)r.ab.mat4.multiply(O,this._cascades[$].matrix,o),E[$===0?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(O),y.activeTexture.set(w.TEXTURE0+Wi.ShadowMap0+$),this._cascades[$].texture.bind(w.NEAREST,w.CLAMP_TO_EDGE);if(this.useNormalOffset=m,m){const $=Vi.normalOffset;E.u_shadow_normal_offset=[1,$,$],E.u_shadow_bias=[6e-5,.0012,.012]}else E.u_shadow_bias=[36e-5,.0012,.012];l.setShadowUniformValues(y,E)}getShadowUniformValues(){return this._uniformValues}getCurrentCascadeFrustum(){return this._cascades[this.painter.currentShadowCascade].frustum}computeSimplifiedTileShadowVolume(o,l,m,y){if(y[2]>=0)return{};const w=function($,H,G){const Z=G/(1<<$.canonical.z);return new r.cd([$.canonical.x*Z+$.wrap*G,$.canonical.y*Z+$.wrap*G,0],[($.canonical.x+1)*Z+$.wrap*G,($.canonical.y+1)*Z+$.wrap*G,H])}(o,l,m).getCorners(),E=l/-y[2];y[0]<0?(r.ab.vec3.add(w[0],w[0],[y[0]*E,0,0]),r.ab.vec3.add(w[3],w[3],[y[0]*E,0,0])):y[0]>0&&(r.ab.vec3.add(w[1],w[1],[y[0]*E,0,0]),r.ab.vec3.add(w[2],w[2],[y[0]*E,0,0])),y[1]<0?(r.ab.vec3.add(w[0],w[0],[0,y[1]*E,0]),r.ab.vec3.add(w[1],w[1],[0,y[1]*E,0])):y[1]>0&&(r.ab.vec3.add(w[2],w[2],[0,y[1]*E,0]),r.ab.vec3.add(w[3],w[3],[0,y[1]*E,0]));const O={};return O.vertices=w,O.planes=[iu(w[1],w[0],w[4]),iu(w[2],w[1],w[5]),iu(w[3],w[2],w[6]),iu(w[0],w[3],w[7])],O}addShadowReceiver(o,l,m){this._receivers.add(o,r.cd.fromTileIdAndHeight(o,l,m))}getMaxCascadeForTile(o){const l=this._receivers.get(o);return l&&l.lastCascade?l.lastCascade:0}}function iu(f,o,l){const m=r.ab.vec3.sub([],l,o),y=r.ab.vec3.sub([],f,o),w=r.ab.vec3.cross([],m,y),E=r.ab.vec3.length(w);return E===0?[0,0,1,0]:(r.ab.vec3.scale(w,w,1/E),[w[0],w[1],w[2],-r.ab.vec3.dot(w,o)])}function su(f){const o=f.properties.get("direction"),l=r.cb(o.x,o.y,o.z);l[2]=r.aw(l[2],0,75);const m=r.ce([l[0],l[1],l[2]]);return r.ab.vec3.fromValues(m.x,m.y,m.z)}function Sg(f,o,l){const m=o.properties.get("color-use-theme")==="none",y=o.properties.get("color"),w=o.properties.get("intensity"),E=o.properties.get("direction"),O=[E.x,E.y,E.z],$=l.properties.get("color-use-theme")==="none",H=l.properties.get("color"),G=l.properties.get("intensity"),Z=Math.max(r.ab.vec3.dot([0,0,1],O),0),X=[0,0,0];r.ab.vec3.scale(X,H.toRenderColor($?null:f.getLut(o.scope)).toArray01Linear().slice(0,3),G);const oe=[0,0,0];return r.ab.vec3.scale(oe,y.toRenderColor(m?null:f.getLut(l.scope)).toArray01Linear().slice(0,3),Z*w),r.cf([X[0]>0?X[0]/(X[0]+oe[0]):0,X[1]>0?X[1]/(X[1]+oe[1]):0,X[2]>0?X[2]/(X[2]+oe[2]):0])}function qx(f,o,l,m,y,w){const E=f.zoom,O=f.scale,$=f.worldSize,H=1/$,G=f.aspect,Z=Math.sqrt(1+G*G)*Math.tan(.5*f.fovX),X=Z*Z,oe=m-l,xe=m+l;let ve,Ce;X>oe/xe?(ve=m,Ce=m*Z):(ve=.5*xe*(1+X),Ce=.5*Math.sqrt(oe*oe+2*(m*m+l*l)*X+xe*xe*X*X));const Te=f.projection.pixelsPerMeter(f.center.lat,$),Le=f._camera.getCameraToWorldMercator(),Ge=[0,0,-ve*H];r.ab.vec3.transformMat4(Ge,Ge,Le);let He=Ce*H;const rt=f._edgeInsets;if(!(rt.left===0&&rt.top===0&&rt.right===0&&rt.bottom===0||rt.left===rt.right&&rt.top===rt.bottom)){const Cn=f._camera.getWorldToCamera(f.worldSize,f.projection.zAxisUnit==="meters"?Te:1),dn=f._camera.getCameraToClipPerspective(f._fov,f.width/f.height,l,m);dn[8]=2*-f.centerOffset.x/f.width,dn[9]=2*f.centerOffset.y/f.height;const nn=new Float64Array(16);r.ab.mat4.mul(nn,dn,Cn);const vn=new Float64Array(16);r.ab.mat4.invert(vn,nn);const Tn=r.bR.fromInvProjectionMatrix(vn,$,E,!0);for(const Ln of Tn.points){const Un=((Xe=Ln)[0]/=O,Xe[1]/=O,Xe[2]=r.bH(Xe[2],f._center.lat),Xe);He=Math.max(He,r.ab.vec3.len(r.ab.vec3.subtract([],Ge,Un)))}}var Xe;He*=y/(y-1);const et=Math.acos(o[2]),Ye=Math.atan2(-o[0],-o[1]),at=new xs;at.position=Ge,at.setPitchBearing(et,Ye);const gt=at.getWorldToCamera($,Te),Vt=He*$,Rt=Math.min(f._mercatorZfromZoom(17)*$*-2,-2*Vt),tn=at.getCameraToClipOrthographic(-Vt,Vt,-Vt,Vt,Rt,(Vt+w*Te)/o[2]),Jt=new Float64Array(16);r.ab.mat4.multiply(Jt,tn,gt);const Et=r.ab.vec3.fromValues(Math.floor(1e6*Ge[0])/1e6*$,Math.floor(1e6*Ge[1])/1e6*$,0),jt=.5*y,gn=[0,0,0];r.ab.vec3.transformMat4(gn,Et,Jt),r.ab.vec3.scale(gn,gn,jt);const Tt=[Math.floor(gn[0]),Math.floor(gn[1]),Math.floor(gn[2])],rn=[0,0,0];r.ab.vec3.sub(rn,gn,Tt),r.ab.vec3.scale(rn,rn,-1/jt);const Ht=new Float64Array(16);return r.ab.mat4.identity(Ht),r.ab.mat4.translate(Ht,Ht,rn),r.ab.mat4.multiply(Jt,Ht,Jt),[Jt,Vt]}class Tg extends r.E{constructor(o){super(),this.requestManager=o,this.models={"":{}},this.modelUris={"":{}},this.numModelsLoading={}}loadModel(o,l){return r.aM(this.requestManager.transformRequest(l,r.R.Model).url).then(m=>{if(!m)return;const y=r.aN(m),w=new r.aO(o,void 0,void 0,y);return w.computeBoundsAndApplyParent(),w}).catch(m=>{if(m&&m.status===404)return null;this.fire(new r.y(new Error(`Could not load model ${o} from ${l}: ${m.message}`)))})}load(o,l,m={keepNumReferences:!1}){this.models[l]||(this.models[l]={});const y=Object.keys(o);this.numModelsLoading[l]=(this.numModelsLoading[l]||0)+y.length;const w=[];for(const E of y)w.push(this.loadModel(E,o[E]));Promise.allSettled(w).then(E=>{for(let O=0;O<E.length;O++){const{status:$,value:H}=E[O];if($==="fulfilled"&&H){const G=this.models[l][y[O]];this.models[l][y[O]]={model:H,numReferences:m.keepNumReferences&&G?G.numReferences:1}}}this.numModelsLoading[l]-=y.length,this.fire(new r.z("data",{dataType:"style"}))}).catch(E=>{this.fire(new r.y(new Error(`Could not load models: ${E.message}`)))})}isLoaded(){for(const o in this.numModelsLoading)if(this.numModelsLoading[o]>0)return!1;return!0}hasModel(o,l){return!!this.getModel(o,l)}getModel(o,l){return this.models[l]||(this.models[l]={}),this.models[l][o]?this.models[l][o].model:void 0}addModel(o,l,m){this.models[m]||(this.models[m]={}),this.modelUris[m]||(this.modelUris[m]={}),this.hasModel(o,m)&&this.models[m][o].numReferences++,this.modelUris[m][o]=this.requestManager.normalizeModelURL(l),this.load({[o]:this.modelUris[m][o]},m)}addModels(o,l){this.models[l]||(this.models[l]={}),this.modelUris[l]||(this.modelUris[l]={});const m=this.modelUris[l];for(const y in o)this.models[l][y]={},m[y]=this.requestManager.normalizeModelURL(o[y]);this.load(m,l,{keepNumReferences:!0})}reloadModels(o){this.load(this.modelUris[o],o)}addModelsFromBucket(o,l){this.models[l]||(this.models[l]={}),this.modelUris[l]||(this.modelUris[l]={});const m={};for(const y of o)this.hasModel(y,l)?this.models[l][y].numReferences++:(this.modelUris[l][y]=this.requestManager.normalizeModelURL(y),m[y]=this.modelUris[l][y]);this.load(m,l)}removeModel(o,l){if(this.models[l]&&this.models[l][o]&&(this.models[l][o].numReferences--,this.models[l][o].numReferences===0)){const m=this.models[l][o].model;delete this.models[l][o],delete this.modelUris[l][o],m.destroy()}}listModels(o){return this.models[o]||(this.models[o]={}),Object.keys(this.models[o])}upload(o,l){this.models[l]||(this.models[l]={});for(const m in this.models[l])this.models[l][m].model&&this.models[l][m].model.upload(o.context)}}const Kx=new r.a5({data:new r.a6(r.a3.colorTheme.data)}),By={"mbx-indoor-active-floorplans":{default:["literal",[]]},"mbx-indoor-underground":{default:["literal",!1]},"mbx-indoor-loaded-levels":{default:["literal",[]]},"mbx-indoor-level-height":{default:["literal",{}]},"mbx-indoor-level-base":{default:["literal",{}]},"mbx-indoor-level-selected":{default:["literal",{}]},"mbx-indoor-level-overlapped":{default:["literal",{}]}};function Cg(f){return f=f||{},Object.assign(f,By)}class Eg extends r.E{constructor(o){super(),this.mergeFloors=!0,this._scope=void 0,this._queryFeatureSetId=void 0,this._buildingEntryFeatureSetId=void 0,this._selectedFloorplan=void 0,this._indoorData=void 0,this._selectedLevel=void 0,this._floorplanStates={},r.aP(["_onLoad","_onMove","_checkFloorplanVisible"],this),this._map=o,this._checkFloorplanVisible(!0),this._map.on("load",this._onLoad),this._map.on("move",this._onMove)}destroy(){this._map.indoor.off("load",this._onLoad),this._map.indoor.off("move",this._onMove),this._map=void 0}_onLoad(){this._map.style.forEachFragmentStyle(o=>{o.stylesheet.indoor&&(this._queryFeatureSetId?this.fire(new r.y(new Error("Multiple indoor map styles detected, simultaneous usage is not allowed currently."))):(this._queryFeatureSetId=o.stylesheet.indoor.floorplanFeaturesetId,this._buildingEntryFeatureSetId=o.stylesheet.indoor.buildingFeaturesetId,this._scope=o.scope))}),this._queryFeatureSetId&&this._buildingEntryFeatureSetId&&this._map.addInteraction("mbx-indoor-buildingclick",{type:"click",target:{featuresetId:this._buildingEntryFeatureSetId,importId:this._scope},handler:o=>(o.feature&&o.feature.properties.floorplan&&this.selectFloorplan(o.feature.properties.floorplan),!0)}),this._checkFloorplanVisible(!0)}_onMove(){this._checkFloorplanVisible(!1)}_checkFloorplanVisible(o){if(!this._queryFeatureSetId||!this._map.isStyleLoaded()||this._map.transform.zoom<13)return;this._indoorData&&!function(E,O){const[$,H]=E,{center:G,radius:Z}=O,[X,oe]=G,xe=Math.abs($-X);return Math.sqrt((xe>180?360-xe:xe)**2+(H-oe)**2)<=Z}([this._map.getCenter().lng,this._map.getCenter().lat],this._indoorData.circumCircle)&&(this._indoorData=void 0,this._selectedFloorplan=void 0,this._map.setConfigProperty(this._scope,"mbx-indoor-underground",!1),this._map.setConfigProperty(this._scope,"mbx-indoor-active-floorplans",["literal",[]]),this.fire(new r.z("floorplangone")));const l={target:{featuresetId:this._queryFeatureSetId,importId:this._scope}},m=new r.P(this._map.transform.width/2,this._map.transform.height/2),y=[new r.P(0,0),new r.P(this._map.transform.width,this._map.transform.height)],w=this._map.queryRenderedFeatures(o?y:m,l);w.length>0&&(this._selectedFloorplan&&w[0].properties.id===this._selectedFloorplan.properties.id||(this._selectedFloorplan=w[0],this._floorplanSelected(!1)))}_floorplanSelected(o){this._indoorData=JSON.parse(this._selectedFloorplan.properties["indoor-data"]),this._indoorData.id=this._selectedFloorplan.properties.id,this._indoorData.circumCircle=function(w){const[[E,O],[$,H]]=w,G=($-E+360)%360,Z=G>180?360-G:G;return{center:[(E+Z/2+360)%360,(O+H)/2],radius:Math.sqrt(Z**2+(H-O)**2)/2}}(this._indoorData.extent),this._floorplanStates[this._indoorData.id]||(this._floorplanStates[this._indoorData.id]={});const l=this._floorplanStates[this._indoorData.id].selectedBuilding,m=this._floorplanStates[this._indoorData.id].selectedLevel;let y;if(this._map.setConfigProperty(this._scope,"mbx-indoor-active-floorplans",this._indoorData.floorplanIDs),this._selectedLevel)for(const w of this._indoorData.levels)w.id===this._selectedLevel.id&&(y=w.id);if(this.fire(new r.z("floorplanselected",{buildings:this._indoorData.buildings,levels:this._indoorData.levels,selectedLevelId:y})),l){const w=this._indoorData.buildings.find(E=>E.id===l);this._buildingSelected(w,!1)}else this._indoorData.buildings.length>0&&this._buildingSelected(this._indoorData.buildings[0],!1);if(m){const w=this._indoorData.levels.find(E=>E.id===m);this._updateLevels(w,o)}else o&&this._indoorData["default-levels"].length>0&&this.selectLevel(this._indoorData["default-levels"][0])}_buildingSelected(o,l){l&&o&&o.extent&&this._map.fitBounds(o.extent,{pitch:this._map.getPitch(),bearing:this._map.getBearing()}),this._floorplanStates[this._indoorData.id].selectedBuilding=o?o.id:void 0;const m=this._indoorData.levels.filter(y=>o.levels.includes(y.id));this.fire(new r.z("buildingselected",{buildingId:o.id,levels:m}))}_levelSelected(o){if(o==="overview")this._updateLevels(void 0,!0);else{const l=this._indoorData.levels.find(m=>m.id===o);this._updateLevels(l,!0)}this.fire(new r.z("levelselected",{levelId:o==="overview"?void 0:o}))}_updateLevels(o,l){if(!o)return this._map.setConfigProperty(this._scope,"mbx-indoor-loaded-levels",["literal",[]]),this._map.setConfigProperty(this._scope,"mbx-indoor-underground",!1),this._floorplanStates[this._indoorData.id].selectedLevel=void 0,void(l&&this._indoorData.extent&&this._map.fitBounds(this._indoorData.extent,{pitch:this._map.getPitch(),bearing:this._map.getBearing()}));function m(H){const G=H.indexOf("/floor/");if(G===-1)return H;const Z=G+7,X=H.indexOf("/",Z);return X===-1?H.slice(Z):H.slice(Z,X)}this._selectedLevel=o,this._floorplanStates[this._indoorData.id].selectedLevel=o?o.id:void 0;const y=[],w={},E={},O={},$={};for(const H of this._indoorData.levels)if(y.push(H.id),w[H.id]=H.height,E[H.id]=H.base,o){if(this.mergeFloors){const G=m(o.id),Z=m(H.id);O[H.id]=Z===G?"true":"false"}else O[H.id]=H.id===o.id?"true":"false";$[H.id]=H.base<o.base?"true":"false"}else $[H.id]=!0;if(this._map.setConfigProperty(this._scope,"mbx-indoor-loaded-levels",["literal",y]),this._map.setConfigProperty(this._scope,"mbx-indoor-level-height",["literal",w]),this._map.setConfigProperty(this._scope,"mbx-indoor-level-base",["literal",E]),this._map.setConfigProperty(this._scope,"mbx-indoor-level-selected",["literal",O]),this._map.setConfigProperty(this._scope,"mbx-indoor-level-overlapped",["literal",$]),o&&(this._map.setConfigProperty(this._scope,"mbx-indoor-underground",!!o.isUnderground),l&&o.extent)){const H=this._map.cameraForBounds(o.extent,{pitch:this._map.getPitch(),bearing:this._map.getBearing()}),G=this._map.getZoom(),Z=H.zoom?Math.abs(G-H.zoom):0;this._map.fitBounds(o.extent,Z>=1?{pitch:this._map.getPitch(),bearing:this._map.getBearing()}:{pitch:this._map.getPitch(),bearing:this._map.getBearing(),zoom:G})}}selectFloorplan(o){const l={target:{featuresetId:this._queryFeatureSetId,importId:this._scope}},m=[new r.P(0,0),new r.P(this._map.transform.width,this._map.transform.height)],y=this._map.queryRenderedFeatures(m,l);if(y.length>0){for(const w of y)if(JSON.parse(w.properties["indoor-data"]).floorplanIDs.includes(o)){this._selectedFloorplan=w,this._floorplanSelected(!0);break}}}selectBuilding(o){const l=this._indoorData.buildings.find(m=>m.id===o);this._buildingSelected(l,!0)}selectLevel(o){this._levelSelected(o)}}function Zx(f){if(!f.metadata||!f.metadata.content_area)return;const o=r.q.devicePixelRatio,{left:l,top:m,width:y,height:w}=f.metadata.content_area,E=l*o,O=m*o;return[E,O,E+y*o,O+w*o]}function Vy(f){if(f)return f.map(([o,l])=>[o*r.q.devicePixelRatio,l*r.q.devicePixelRatio])}const au=(f,o)=>Ps(f,o&&o.filter(l=>l.identifier!=="source.canvas")),Yx=r.ay(Fr,["addLayer","removeLayer","setLights","setPaintProperty","setLayoutProperty","setSlot","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setSnow","setRain","setProjection","setCamera","addImport","removeImport","updateImport"]),$y=r.ay(Fr,["setCenter","setZoom","setBearing","setPitch"]),Mg=new Set(["background","sky","slot","custom"]),yh={version:8,layers:[],sources:{}},Uy={duration:300,delay:0};class ba extends r.E{constructor(o,l={}){super(),this.map=o,this.scope=l.scope||"",this.globalId=null,this.fragments=[],this.importDepth=l.importDepth||0,this.importsCache=l.importsCache||new Map,this.resolvedImports=l.resolvedImports||new Set,this.transition=r.l({},Uy),this._buildingIndex=new Fy(this),this.crossTileSymbolIndex=new yg,this._mergedOrder=[],this._drapedFirstOrder=[],this._mergedLayers={},this._mergedSourceCaches={},this._mergedOtherSourceCaches={},this._mergedSymbolSourceCaches={},this._clipLayerPresent=!1,this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this._changes=l.styleChanges||new nt,this.dispatcher=l.dispatcher?l.dispatcher:new r.D(r.ci(),this),l.imageManager?this.imageManager=l.imageManager:(this.imageManager=new Yt(this.map._spriteFormat),this.imageManager.setEventedParent(this)),this.imageManager.createScope(this.scope),this.glyphManager=l.glyphManager?l.glyphManager:new r.cj(o._requestManager,l.localFontFamily?r.ck.all:l.localIdeographFontFamily?r.ck.ideographs:r.ck.none,l.localFontFamily||l.localIdeographFontFamily),l.modelManager?this.modelManager=l.modelManager:(this.modelManager=new Tg(o._requestManager),this.modelManager.setEventedParent(this)),this._layers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._precompileDone=!1,this._shouldPrecompile=!1,this._availableImages=[],this._order=[],this._markersNeedUpdate=!1,this.options=l.configOptions?l.configOptions:new Map,this._configDependentLayers=l.configDependentLayers?l.configDependentLayers:new Set,this._config=l.config,this._styleColorTheme={lut:null,lutLoading:!1,lutLoadingCorrelationID:0,colorTheme:null,colorThemeOverride:l.colorThemeOverride},this._styleColorThemeForScope={},this._initialConfig=l.initialConfig,this.dispatcher.broadcast("setReferrer",r.cl());const m=this;this._rtlTextPluginCallback=ba.registerForPluginStateChange(y=>{m.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:y.pluginStatus,pluginURL:y.pluginURL},(w,E)=>{if(r.cm(w),E&&E.every(O=>O))for(const O in m._sourceCaches){const $=m._sourceCaches[O],H=$.getSource().type;H!=="vector"&&H!=="geojson"||$.reload()}})}),this.on("data",y=>{if(y.dataType!=="source"||y.sourceDataType!=="metadata")return;const w=this.getOwnSource(y.sourceId);if(w&&w.vectorLayerIds)for(const E in this._layers){const O=this._layers[E];O.source===w.id&&this._validateLayer(O)}})}load(o){return o?(typeof o=="string"?this.loadURL(o):this.loadJSON(o),this):this}_getGlobalId(o){if(!o)return null;if(typeof o=="string"){if(r.f(o))return o;const l=r.cn(o);if(!l.startsWith("http"))try{return new URL(l,location.href).toString()}catch{return l}return l}return`json://${r.co(JSON.stringify(o))}`}_diffStyle(o,l,m){this.globalId=this._getGlobalId(o);const y=(w,E)=>{try{E(null,this.setState(w,m))}catch(O){E(O,!1)}};if(typeof o=="string"){const w=this.map._requestManager.normalizeStyleURL(o),E=this.map._requestManager.transformRequest(w,r.R.Style);r.n(E,(O,$)=>{O?this.fire(new r.y(O)):$&&y($,l)})}else typeof o=="object"&&y(o,l)}loadURL(o,l={}){this.fire(new r.z("dataloading",{dataType:"style"}));const m=typeof l.validate=="boolean"?l.validate:!r.f(o);this.globalId=this._getGlobalId(o),o=this.map._requestManager.normalizeStyleURL(o,l.accessToken),this.resolvedImports.add(o);const y=this.importsCache.get(o);if(y)return this._load(y,m);const w=this.map._requestManager.transformRequest(o,r.R.Style);this._request=r.n(w,(E,O)=>{if(this._request=null,E)this.fire(new r.y(E));else if(O)return this.importsCache.set(o,O),this._load(O,m)})}loadJSON(o,l={}){this.fire(new r.z("dataloading",{dataType:"style"})),this.globalId=this._getGlobalId(o),this._request=r.q.frame(()=>{this._request=null,this._load(o,l.validate!==!1)})}loadEmpty(){this.fire(new r.z("dataloading",{dataType:"style"})),this._load(yh,!1)}_loadImports(o,l,m){if(this.importDepth>=4)return r.w("Style doesn't support nesting deeper than 5"),Promise.resolve();const y=[];for(const w of o){const E=this._createFragmentStyle(w),O=new Promise(G=>{E.once("style.import.load",G),E.once("error",G)}).then(()=>this.mergeAll());if(y.push(O),this.resolvedImports.has(w.url)){E.loadEmpty();continue}const $=w.data||this.importsCache.get(w.url);$?(E.loadJSON($,{validate:l}),this._isInternalStyle($)&&(E.globalId=null)):w.url?E.loadURL(w.url,{validate:l}):E.loadEmpty();const H={style:E,id:w.id,config:w.config};if(m){const G=this.fragments.findIndex(({id:Z})=>Z===m);this.fragments=this.fragments.slice(0,G).concat(H).concat(this.fragments.slice(G))}else this.fragments.push(H)}return Promise.allSettled(y)}getImportGlobalIds(o=this,l=new Set){for(const m of o.fragments)m.style.globalId&&l.add(m.style.globalId),this.getImportGlobalIds(m.style,l);return[...l.values()]}_createFragmentStyle(o){const l=this.scope?r.aC(o.id,this.scope):o.id;let m;const y=this._initialConfig&&this._initialConfig[l];(o.config||y)&&(m=r.l({},o.config,y));const w=new ba(this.map,{scope:l,styleChanges:this._changes,importDepth:this.importDepth+1,importsCache:this.importsCache,resolvedImports:new Set(this.resolvedImports),dispatcher:this.dispatcher,imageManager:this.imageManager,glyphManager:this.glyphManager,modelManager:this.modelManager,config:m,configOptions:this.options,colorThemeOverride:o["color-theme"],configDependentLayers:this._configDependentLayers});return w.setEventedParent(this.map,{style:w}),w}_reloadImports(){this.mergeAll(),this._updateMapProjection(),this.updateConfigDependencies(),this.map._triggerCameraUpdate(this.camera),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options}),this._shouldPrecompile=this.map._precompilePrograms&&this.isRootStyle()}_isInternalStyle(o){return this.isRootStyle()&&(o.fragment||!!o.schema&&o.fragment!==!1)}_load(o,l){const m=o.indoor?Cg(o.schema):o.schema;if(this._isInternalStyle(o)){const E=r.l({},yh,{imports:[{id:"basemap",data:o,url:""}]});return void this._load(E,l)}if(this.updateConfig(this._config,m),l&&au(this,jo(o)))return;this._loaded=!0,this.stylesheet=r.cp(o);const y=()=>{for(const H in o.sources)this.addSource(H,o.sources[H],{validate:!1,isInitialLoad:!0});o.sprite?this._loadIconset(o.sprite):(this.imageManager.setLoaded(!0,this.scope),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0})),this.glyphManager.setURL(o.glyphs,this.scope);const E=Wf(this.stylesheet.layers);if(this._order=E.map(H=>H.id),this.stylesheet.light&&r.w("The `light` root property is deprecated, prefer using `lights` with `flat` light type instead."),this.stylesheet.lights)if(this.stylesheet.lights.length===1&&this.stylesheet.lights[0].type==="flat"){const H=this.stylesheet.lights[0];this.light=new ye(H.properties,H.id)}else this.setLights(this.stylesheet.lights);this.light||(this.light=new ye(this.stylesheet.light)),this._layers={};for(const H of E){const G=r.cu(H,this.scope,this._styleColorTheme.lut,this.options);G.configDependencies.size!==0&&this._configDependentLayers.add(G.fqid),G.setEventedParent(this,{layer:{id:G.id}}),this._layers[G.id]=G;const Z=this.getOwnLayerSourceCache(G),X=!!this.directionalLight&&this.directionalLight.shadowsEnabled();Z&&G.canCastShadows()&&X&&(Z.castsShadows=!0)}this.stylesheet.featuresets&&this.setFeaturesetSelectors(this.stylesheet.featuresets),this.stylesheet.models&&this.modelManager.addModels(this.stylesheet.models,this.scope);const O=this.stylesheet.terrain;O&&(this.checkCanvasFingerprintNoise(),this.disableElevatedTerrain||this.terrainSetForDrapingOnly()||this._createTerrain(O,1)),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this.stylesheet.snow&&this._createSnow(this.stylesheet.snow),this.stylesheet.rain&&this._createRain(this.stylesheet.rain),this.stylesheet.transition&&this.setTransition(this.stylesheet.transition),this.fire(new r.z("data",{dataType:"style"}));const $=this.isRootStyle();o.imports?this._loadImports(o.imports,l).then(()=>{this._reloadImports(),this.fire(new r.z($?"style.load":"style.import.load"))}):(this._reloadImports(),this.fire(new r.z($?"style.load":"style.import.load")))};this._styleColorTheme.colorTheme=this.stylesheet["color-theme"];const w=this._styleColorTheme.colorThemeOverride?this._styleColorTheme.colorThemeOverride:this._styleColorTheme.colorTheme;if(w){const E=this._evaluateColorThemeData(w);this._loadColorTheme(E).then(()=>{y()}).catch(O=>{r.w(`Couldn't load color theme from the stylesheet: ${O}`),y()})}else this._styleColorTheme.lut=null,y()}isRootStyle(){return this.importDepth===0}mergeAll(){let o,l,m,y,w,E,O,$,H,G;const Z={};this.terrain&&this.terrain.scope!==this.scope&&delete this.terrain,this.forEachFragmentStyle(X=>{if(X.stylesheet){if(X.light!=null&&(o=X.light),X.stylesheet.lights)for(const oe of X.stylesheet.lights)oe.type==="ambient"&&X.ambientLight!=null&&(l=X.ambientLight),oe.type==="directional"&&X.directionalLight!=null&&(m=X.directionalLight);y=this._prioritizeTerrain(y,X.terrain,X.stylesheet.terrain),X.stylesheet.fog&&X.fog!=null&&(w=X.fog),X.stylesheet.snow&&X.snow!=null&&(E=X.snow),X.stylesheet.rain&&X.rain!=null&&(O=X.rain),X.stylesheet.camera!=null&&(G=X.stylesheet.camera),X.stylesheet.projection!=null&&($=X.stylesheet.projection),X.stylesheet.transition!=null&&(H=X.stylesheet.transition),Z[X.scope]=X._styleColorTheme}}),this.light=o,this.ambientLight=l,this.directionalLight=m,this.fog=w,this.snow=E,this.rain=O,this._styleColorThemeForScope=Z,y===null?delete this.terrain:this.terrain=y,this.camera=G||{"camera-projection":"perspective"},this.projection=$||{name:"mercator"},this.transition=r.l({},Uy,H),this.mergeSources(),this.mergeLayers()}forEachFragmentStyle(o){const l=m=>{for(const y of m.fragments)l(y.style);o(m)};l(this)}_prioritizeTerrain(o,l,m){const y=o&&o.drapeRenderMode===0;return m===null?l&&l.drapeRenderMode===0?l:y?o:null:l!=null&&(!o||y||l&&l.drapeRenderMode===1)?l:o}mergeTerrain(){let o;this.terrain&&this.terrain.scope!==this.scope&&delete this.terrain,this.forEachFragmentStyle(l=>{o=this._prioritizeTerrain(o,l.terrain,l.stylesheet.terrain)}),o===null?delete this.terrain:this.terrain=o}mergeProjection(){let o;this.forEachFragmentStyle(l=>{l.stylesheet.projection!=null&&(o=l.stylesheet.projection)}),this.projection=o||{name:"mercator"}}mergeSources(){const o={},l={},m={};this.forEachFragmentStyle(y=>{for(const w in y._sourceCaches){const E=r.aC(w,y.scope);o[E]=y._sourceCaches[w]}for(const w in y._otherSourceCaches){const E=r.aC(w,y.scope);l[E]=y._otherSourceCaches[w]}for(const w in y._symbolSourceCaches){const E=r.aC(w,y.scope);m[E]=y._symbolSourceCaches[w]}}),this._mergedSourceCaches=o,this._mergedOtherSourceCaches=l,this._mergedSymbolSourceCaches=m}mergeLayers(){const o={},l=[],m={};this._mergedSlots=[],this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this.forEachFragmentStyle(w=>{for(const E of w._order){const O=w._layers[E];if(O.type==="slot"){const $=r.cq(E);if(o[$])continue;o[$]=[]}O.slot&&o[O.slot]?o[O.slot].push(O):l.push(O)}}),this._mergedOrder=[];const y=(w=[])=>{for(const E of w)if(E.type==="slot"){const O=r.cq(E.id);o[O]&&y(o[O]),this._mergedSlots.push(O)}else{const O=r.aC(E.id,E.scope);this._mergedOrder.push(O),m[O]=E,E.is3D()&&(this._has3DLayers=!0),E.type==="circle"&&(this._hasCircleLayers=!0),E.type==="symbol"&&(this._hasSymbolLayers=!0),E.type==="clip"&&(this._clipLayerPresent=!0)}};y(l),this._mergedOrder.sort((w,E)=>{const O=m[w],$=m[E];return O.hasInitialOcclusionOpacityProperties?$.is3D()?1:0:O.is3D()&&$.hasInitialOcclusionOpacityProperties?-1:0}),this._mergedLayers=m,this.updateDrapeFirstLayers(),this._buildingIndex.processLayersChanged()}terrainSetForDrapingOnly(){return!!this.terrain&&this.terrain.drapeRenderMode===0}getCamera(){return this.stylesheet.camera}setCamera(o){return this.stylesheet.camera=r.l({},this.stylesheet.camera,o),this.camera=this.stylesheet.camera,this}_evaluateColorThemeData(o){return o.data?function(l,m,y){const w=r.l({},m);for(const O of Object.keys(r.a3.colorTheme))w[O]===void 0&&(w[O]=r.a3.colorTheme[O].default);const E=new r.a4(Kx,l,new Map(y));return E.setTransitionOrValue(w,y),E.untransitioned().possiblyEvaluate(new r.a8(0))}(this.scope,o,this.options).get("data"):null}_loadColorTheme(o){this._styleColorTheme.lutLoading=!0,this._styleColorTheme.lutLoadingCorrelationID+=1;const l=this._styleColorTheme.lutLoadingCorrelationID;return new Promise((m,y)=>{const w="data:image/png;base64,";if(!o||o.length===0)return this._styleColorTheme.lut=null,this._styleColorTheme.lutLoading=!1,void m();let E=o;E.startsWith(w)||(E=w+E);const O="mapbox-reserved-lut",$=new Image;$.src=E,$.onerror=()=>{this._styleColorTheme.lutLoading=!1,y(new Error("Failed to load image data"))},$.onload=()=>{if(this._styleColorTheme.lutLoadingCorrelationID!==l)return void m();this._styleColorTheme.lutLoading=!1;const{width:H,height:G,data:Z}=r.q.getImageData($);if(G>32)return void y(new Error("The height of the image must be less than or equal to 32 pixels."));if(H!==G*G)return void y(new Error("The width of the image must be equal to the height squared."));this.getImage(O)&&this.removeImage(O),this.addImage(O,{data:new r.r({width:H,height:G},Z),pixelRatio:1,sdf:!1,usvg:!1,version:0});const X=this.imageManager.getImage(O,this.scope);X?(this._styleColorTheme.lut={image:X.data,data:o},m()):y(new Error("Missing LUT image."))}})}getLut(o){const l=this._styleColorThemeForScope[o];return l?l.lut:null}setProjection(o){o?this.stylesheet.projection=o:delete this.stylesheet.projection,this.mergeProjection(),this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?(this.getTerrain()||this.stylesheet.terrain)&&!this.disableElevatedTerrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null,0))}_updateMapProjection(){this.isRootStyle()&&(this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.projection))}_loadSprite(o){this._spriteRequest=function(l,m,y){let w,E,O;const $=r.q.devicePixelRatio>1?"@2x":"";let H=r.n(m.transformRequest(m.normalizeSpriteURL(l,$,".json"),r.R.SpriteJSON),(X,oe)=>{H=null,O||(O=X,w=oe,Z())}),G=r.o(m.transformRequest(m.normalizeSpriteURL(l,$,".png"),r.R.SpriteImage),(X,oe)=>{G=null,O||(O=X,E=oe,Z())});function Z(){if(O)y(O);else if(w&&E){const X=r.q.getImageData(E),oe={};for(const xe in w){const{width:ve,height:Ce,x:Te,y:Le,sdf:Ge,pixelRatio:He,stretchX:rt,stretchY:Xe,content:et}=w[xe],Ye=new r.r({width:ve,height:Ce});r.r.copy(X,Ye,{x:Te,y:Le},{x:0,y:0},{width:ve,height:Ce},null),oe[xe]={data:Ye,pixelRatio:He,sdf:Ge,stretchX:rt,stretchY:Xe,content:et,usvg:!1}}y(null,oe)}}return{cancel(){H&&(H.cancel(),H=null),G&&(G.cancel(),G=null)}}}(o,this.map._requestManager,(l,m)=>{if(this._spriteRequest=null,l)this.fire(new r.y(l));else if(m)for(const y in m)this.imageManager.addImage(y,this.scope,m[y]);this.imageManager.setLoaded(!0,this.scope),this._availableImages=this.imageManager.listImages(this.scope),this.dispatcher.broadcast("setImages",{scope:this.scope,images:this._availableImages}),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0}),this.fire(new r.z("data",{dataType:"style"}))})}_loadIconset(o){if(!r.f(o)&&this.map._spriteFormat!=="icon_set"||this.map._spriteFormat==="raster")return void this._loadSprite(o);const l=this.map._spriteFormat==="auto";var m,y;this._spriteRequest=(y=(w,E)=>{if(this._spriteRequest=null,w)l?this._loadSprite(o):this.fire(new r.y(w));else if(E)for(const O in E)this.imageManager.addImage(O,this.scope,E[O]);this.imageManager.setLoaded(!0,this.scope),this._availableImages=this.imageManager.listImages(this.scope),this.dispatcher.broadcast("setImages",{scope:this.scope,images:this._availableImages}),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0}),this.fire(new r.z("data",{dataType:"style"}))},r.bi((m=this.map._requestManager).transformRequest(m.normalizeIconsetURL(o),r.R.Iconset),(w,E)=>{if(w)return void y(w);const O={},$=r.cg(new r.bh(E));for(const H of $.icons){const G={version:1,pixelRatio:r.q.devicePixelRatio,content:Zx(H),stretchX:H.metadata?Vy(H.metadata.stretch_x_areas):void 0,stretchY:H.metadata?Vy(H.metadata.stretch_y_areas):void 0,sdf:!1,usvg:!0,icon:H};O[H.name]=G}y(null,O)}))}_validateLayer(o){const l=this.getOwnSource(o.source);if(!l)return;const m=o.sourceLayer;m&&(l.type==="geojson"||l.vectorLayerIds&&l.vectorLayerIds.indexOf(m)===-1)&&this.fire(new r.y(new Error(`Source layer "${m}" does not exist on source "${l.id}" as specified by style layer "${o.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._changes.getUpdatedSourceCaches()).length)return!1;for(const o in this._sourceCaches)if(!this._sourceCaches[o].loaded())return!1;if(!this.imageManager.isLoaded()||!this.modelManager.isLoaded()||this._styleColorTheme.lutLoading)return!1;for(const{style:o}of this.fragments)if(!o.loaded())return!1;return!0}_serializeImports(){if(this.stylesheet.imports)return this.stylesheet.imports.map((o,l)=>{const m=this.fragments[l];return m&&m.style&&(o.data=m.style.serialize()),o})}_serializeSources(){const o={};for(const l in this._sourceCaches){const m=this._sourceCaches[l].getSource();o[m.id]||(o[m.id]=m.serialize())}return o}_serializeLayers(o){const l=[];for(const m of o){const y=this._layers[m];y&&y.type!=="custom"&&l.push(y.serialize())}return l}hasLightTransitions(){return!(!this.light||!this.light.hasTransition())||!(!this.ambientLight||!this.ambientLight.hasTransition())||!(!this.directionalLight||!this.directionalLight.hasTransition())}hasFogTransition(){return!!this.fog&&this.fog.hasTransition()}hasSnowTransition(){return!!this.snow&&this.snow.hasTransition()}hasRainTransition(){return!!this.rain&&this.rain.hasTransition()}hasTransitions(){if(this.hasLightTransitions()||this.hasFogTransition()||this.hasSnowTransition()||this.hasRainTransition())return!0;for(const o in this._sourceCaches)if(this._sourceCaches[o].hasTransition())return!0;for(const o in this._layers)if(this._layers[o].hasTransition())return!0;return!1}get order(){return this.terrain?this._drapedFirstOrder:this._mergedOrder}_getOrder(o){return o?this.order:this._mergedOrder}isLayerDraped(o){return!!this.terrain&&o.isDraped(this.getLayerSourceCache(o))}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}_checkLayer(o){const l=this.getOwnLayer(o);if(l)return l;this.fire(new r.y(new Error(`The layer '${o}' does not exist in the map's style.`)))}_checkSource(o){const l=this.getOwnSource(o);if(l)return l;this.fire(new r.y(new Error(`The source '${o}' does not exist in the map's style.`)))}precompilePrograms(o,l){const m=this.map.painter;if(m)for(let y=o.minzoom||0;y<(o.maxzoom||25.5);y++){const w=o.getProgramIds();if(w)for(const E of w){const O=o.getDefaultProgramParams(E,l.zoom,this._styleColorTheme.lut);O&&(m.style=this,this.fog&&(m._fogVisible=!0,O.overrideFog=!0,m.getOrCreateProgram(E,O)),m._fogVisible=!1,O.overrideFog=!1,m.getOrCreateProgram(E,O),(this.stylesheet.terrain||this.stylesheet.projection&&this.stylesheet.projection.name==="globe")&&(O.overrideRtt=!0,m.getOrCreateProgram(E,O)))}}}update(o){if(!this._loaded)return;this.ambientLight&&this.ambientLight.recalculate(o),this.directionalLight&&this.directionalLight.recalculate(o);const l=this.calculateLightsBrightness();o.brightness=l||0,l!==this._brightness&&(this._brightness=l,this.dispatcher.broadcast("setBrightness",l));const m=this._changes.isDirty();let y=!1;if(this._changes.isDirty()){const E=this._changes.getLayerUpdatesByScope();for(const O in E){const{updatedIds:$,removedIds:H}=E[O];($||H)&&(this._updateWorkerLayers(O,$,H),y=!0)}this.updateSourceCaches(),this._updateTilesForChangedImages(),this.updateLayers(o),this.light&&this.light.updateTransitions(o),this.ambientLight&&this.ambientLight.updateTransitions(o),this.directionalLight&&this.directionalLight.updateTransitions(o),this.fog&&this.fog.updateTransitions(o),this.snow&&this.snow.updateTransitions(o),this.rain&&this.rain.updateTransitions(o),this._changes.reset()}const w={};for(const E in this._mergedSourceCaches){const O=this._mergedSourceCaches[E];w[E]=O.used,O.used=!1,O.tileCoverLift=0}for(const E of this._mergedOrder){const O=this._mergedLayers[E];if(O.recalculate(o,this._availableImages),!O.isHidden(o.zoom)){const $=this.getLayerSourceCache(O);$&&($.used=!0,$.tileCoverLift=Math.max($.tileCoverLift,O.tileCoverLift()))}!this._precompileDone&&this._shouldPrecompile&&("requestIdleCallback"in window?requestIdleCallback(()=>{this.precompilePrograms(O,o)}):this.precompilePrograms(O,o))}this._shouldPrecompile&&(this._precompileDone=!0),this.terrain&&y&&this.mergeLayers();for(const E in w){const O=this._mergedSourceCaches[E];w[E]!==O.used&&O.getSource().fire(new r.z("data",{sourceDataType:"visibility",dataType:"source",sourceId:O.getSource().id}))}this.light&&this.light.recalculate(o),this.terrain&&this.terrain.recalculate(o),this.fog&&this.fog.recalculate(o),this.snow&&this.snow.recalculate(o),this.rain&&this.rain.recalculate(o),this.z=o.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),m&&this.fire(new r.z("data",{dataType:"style"}))}_updateTilesForChangedImages(){const o=this._changes.getUpdatedImages();if(o.length){for(const l in this._sourceCaches)this._sourceCaches[l].reloadTilesForDependencies(["icons","patterns"],o);this._changes.resetUpdatedImages()}}_updateWorkerLayers(o,l,m){const y=this.getFragmentStyle(o);y&&this.dispatcher.broadcast("updateLayers",{layers:l?y._serializeLayers(l):[],scope:o,removedIds:m||[],options:y.options})}setState(o,l){if(this._checkLoaded(),au(this,jo(o)))return!1;(o=r.cp(o)).layers=Wf(o.layers);const m=function(E,O){if(!E)return[{command:Fr.setStyle,args:[O]}];let $=[];try{if(!r.bn(E.version,O.version))return[{command:Fr.setStyle,args:[O]}];if(r.bn(E.center,O.center)||$.push({command:Fr.setCenter,args:[O.center]}),r.bn(E.zoom,O.zoom)||$.push({command:Fr.setZoom,args:[O.zoom]}),r.bn(E.bearing,O.bearing)||$.push({command:Fr.setBearing,args:[O.bearing]}),r.bn(E.pitch,O.pitch)||$.push({command:Fr.setPitch,args:[O.pitch]}),r.bn(E.sprite,O.sprite)||$.push({command:Fr.setSprite,args:[O.sprite]}),r.bn(E.glyphs,O.glyphs)||$.push({command:Fr.setGlyphs,args:[O.glyphs]}),r.bn(E.imports,O.imports)||function(oe=[],xe=[],ve){xe=xe||[];const Ce=(oe=oe||[]).map(Yi),Te=xe.map(Yi),Le=oe.reduce(Ol,{}),Ge=xe.reduce(Ol,{}),He=Ce.slice();let rt,Xe,et,Ye;for(rt=0,Xe=0;rt<Ce.length;rt++)et=Ce[rt],Ge.hasOwnProperty(et)?Xe++:(ve.push({command:Fr.removeImport,args:[et]}),He.splice(He.indexOf(et,Xe),1));for(rt=0,Xe=0;rt<Te.length;rt++)et=Te[Te.length-1-rt],He[He.length-1-rt]!==et&&(Le.hasOwnProperty(et)?(ve.push({command:Fr.removeImport,args:[et]}),He.splice(He.lastIndexOf(et,He.length-Xe),1)):Xe++,Ye=He[He.length-rt],ve.push({command:Fr.addImport,args:[Ge[et],Ye]}),He.splice(He.length-rt,0,et));for(const at of xe){const gt=Le[at.id];gt&&!r.bn(gt,at)&&ve.push({command:Fr.updateImport,args:[at.id,at]})}}(E.imports,O.imports,$),r.bn(E.transition,O.transition)||$.push({command:Fr.setTransition,args:[O.transition]}),r.bn(E.light,O.light)||$.push({command:Fr.setLight,args:[O.light]}),r.bn(E.fog,O.fog)||$.push({command:Fr.setFog,args:[O.fog]}),r.bn(E.snow,O.snow)||$.push({command:Fr.setSnow,args:[O.snow]}),r.bn(E.rain,O.rain)||$.push({command:Fr.setRain,args:[O.rain]}),r.bn(E.projection,O.projection)||$.push({command:Fr.setProjection,args:[O.projection]}),r.bn(E.lights,O.lights)||$.push({command:Fr.setLights,args:[O.lights]}),r.bn(E.camera,O.camera)||$.push({command:Fr.setCamera,args:[O.camera]}),!r.bn(E["color-theme"],O["color-theme"]))return[{command:Fr.setStyle,args:[O]}];const H={},G=[];(function(oe,xe,ve,Ce){let Te;for(Te in xe=xe||{},oe=oe||{})oe.hasOwnProperty(Te)&&(xe.hasOwnProperty(Te)||eu(Te,ve,Ce));for(Te in xe){if(!xe.hasOwnProperty(Te))continue;const Le=xe[Te];oe.hasOwnProperty(Te)?r.bn(oe[Te],Le)||(oe[Te].type==="geojson"&&Le.type==="geojson"&&co(oe,xe,Te)?ve.push({command:Fr.setGeoJSONSourceData,args:[Te,Le.data]}):qn(Te,xe,ve,Ce)):qf(Te,xe,ve)}})(E.sources,O.sources,G,H);const Z=[];E.layers&&E.layers.forEach(oe=>{oe.source&&H[oe.source]?$.push({command:Fr.removeLayer,args:[oe.id]}):Z.push(oe)});let X=E.terrain;X&&H[X.source]&&($.push({command:Fr.setTerrain,args:[void 0]}),X=void 0),$=$.concat(G),r.bn(X,O.terrain)||$.push({command:Fr.setTerrain,args:[O.terrain]}),function(oe,xe,ve){xe=xe||[];const Ce=(oe=oe||[]).map(Yi),Te=xe.map(Yi),Le=oe.reduce(Ol,{}),Ge=xe.reduce(Ol,{}),He=Ce.slice(),rt=Object.create(null);let Xe,et,Ye,at,gt,Vt,Rt;for(Xe=0,et=0;Xe<Ce.length;Xe++)Ye=Ce[Xe],Ge.hasOwnProperty(Ye)?et++:(ve.push({command:Fr.removeLayer,args:[Ye]}),He.splice(He.indexOf(Ye,et),1));for(Xe=0,et=0;Xe<Te.length;Xe++)Ye=Te[Te.length-1-Xe],He[He.length-1-Xe]!==Ye&&(Le.hasOwnProperty(Ye)?(ve.push({command:Fr.removeLayer,args:[Ye]}),He.splice(He.lastIndexOf(Ye,He.length-et),1)):et++,Vt=He[He.length-Xe],ve.push({command:Fr.addLayer,args:[Ge[Ye],Vt]}),He.splice(He.length-Xe,0,Ye),rt[Ye]=!0);for(Xe=0;Xe<Te.length;Xe++)if(Ye=Te[Xe],at=Le[Ye],gt=Ge[Ye],!rt[Ye]&&!r.bn(at,gt))if(r.bn(at.source,gt.source)&&r.bn(at["source-layer"],gt["source-layer"])&&r.bn(at.type,gt.type)){for(Rt in Yr(at.layout,gt.layout,ve,Ye,null,Fr.setLayoutProperty),Yr(at.paint,gt.paint,ve,Ye,null,Fr.setPaintProperty),r.bn(at.slot,gt.slot)||ve.push({command:Fr.setSlot,args:[Ye,gt.slot]}),r.bn(at.filter,gt.filter)||ve.push({command:Fr.setFilter,args:[Ye,gt.filter]}),r.bn(at.minzoom,gt.minzoom)&&r.bn(at.maxzoom,gt.maxzoom)||ve.push({command:Fr.setLayerZoomRange,args:[Ye,gt.minzoom,gt.maxzoom]}),at)at.hasOwnProperty(Rt)&&Rt!=="layout"&&Rt!=="paint"&&Rt!=="filter"&&Rt!=="metadata"&&Rt!=="minzoom"&&Rt!=="maxzoom"&&Rt!=="slot"&&(Rt.indexOf("paint.")===0?Yr(at[Rt],gt[Rt],ve,Ye,Rt.slice(6),Fr.setPaintProperty):r.bn(at[Rt],gt[Rt])||ve.push({command:Fr.setLayerProperty,args:[Ye,Rt,gt[Rt]]}));for(Rt in gt)gt.hasOwnProperty(Rt)&&!at.hasOwnProperty(Rt)&&Rt!=="layout"&&Rt!=="paint"&&Rt!=="filter"&&Rt!=="metadata"&&Rt!=="minzoom"&&Rt!=="maxzoom"&&Rt!=="slot"&&(Rt.indexOf("paint.")===0?Yr(at[Rt],gt[Rt],ve,Ye,Rt.slice(6),Fr.setPaintProperty):r.bn(at[Rt],gt[Rt])||ve.push({command:Fr.setLayerProperty,args:[Ye,Rt,gt[Rt]]}))}else ve.push({command:Fr.removeLayer,args:[Ye]}),Vt=He[He.lastIndexOf(Ye)+1],ve.push({command:Fr.addLayer,args:[gt,Vt]})}(Z,O.layers,$)}catch(H){console.warn("Unable to compute style diff:",H),$=[{command:Fr.setStyle,args:[O]}]}return $}(this.serialize(),o).filter(E=>!(E.command in $y));if(m.length===0)return!1;const y=m.filter(E=>!(E.command in Yx));if(y.length>0)throw new Error(`Unimplemented: ${y.map(E=>E.command).join(", ")}.`);const w=[];return m.forEach(E=>{w.push(this[E.command].apply(this,E.args))}),l&&Promise.all(w).then(l),this.stylesheet=o,this.mergeAll(),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options}),!0}addImage(o,l){return this.getImage(o)?this.fire(new r.y(new Error("An image with this name already exists."))):(this.imageManager.addImage(o,this.scope,l),this._afterImageUpdated(o),this)}updateImage(o,l,m=!1){this.imageManager.updateImage(o,this.scope,l),m&&this._afterImageUpdated(o)}getImage(o){return this.imageManager.getImage(o,this.scope)}removeImage(o){return this.getImage(o)?(this.imageManager.removeImage(o,this.scope),this._afterImageUpdated(o),this):this.fire(new r.y(new Error("No image with this name exists.")))}_afterImageUpdated(o){this._availableImages=this.imageManager.listImages(this.scope),this._changes.updateImage(o),this.dispatcher.broadcast("setImages",{scope:this.scope,images:this._availableImages}),this.fire(new r.z("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addModel(o,l,m={}){return this._checkLoaded(),this._validate(Qa,`models.${o}`,l,null,m)||(this.modelManager.addModel(o,l,this.scope),this._changes.setDirty()),this}hasModel(o){return this.modelManager.hasModel(o,this.scope)}removeModel(o){return this.hasModel(o)?(this.modelManager.removeModel(o,this.scope),this):this.fire(new r.y(new Error("No model with this ID exists.")))}listModels(){return this._checkLoaded(),this.modelManager.listModels(this.scope)}addSource(o,l,m={}){if(this._checkLoaded(),this.getOwnSource(o)!==void 0)throw new Error(`There is already a source with ID "${o}".`);if(!l.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(l).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(l.type)>=0&&this._validate(Go,`sources.${o}`,l,null,m))return;this.map&&this.map._collectResourceTiming&&(l.collectResourceTiming=!0);const y=us(o,l,this.dispatcher,this);y.scope=this.scope,y.setEventedParent(this,()=>({isSourceLoaded:this._isSourceCacheLoaded(y.id),source:y.serialize(),sourceId:y.id}));const w=E=>{const O=(E?"symbol:":"other:")+y.id,$=r.aC(O,this.scope),H=this._sourceCaches[O]=new _a($,y,E);(E?this._symbolSourceCaches:this._otherSourceCaches)[y.id]=H,H.onAdd(this.map)};w(!1),l.type!=="vector"&&l.type!=="geojson"||w(!0),y.onAdd&&y.onAdd(this.map),m.isInitialLoad||(this.mergeSources(),this._changes.setDirty())}removeSource(o){this._checkLoaded();const l=this.getOwnSource(o);if(!l)throw new Error("There is no source with this ID");for(const y in this._layers)if(this._layers[y].source===o)return this.fire(new r.y(new Error(`Source "${o}" cannot be removed while layer "${y}" is using it.`)));if(this.terrain&&this.terrain.scope===this.scope&&this.terrain.get().source===o)return this.fire(new r.y(new Error(`Source "${o}" cannot be removed while terrain is using it.`)));const m=this.getOwnSourceCaches(o);for(const y of m){const w=r.cq(y.id);delete this._sourceCaches[w],this._changes.discardSourceCacheUpdate(y.id),y.fire(new r.z("data",{sourceDataType:"metadata",dataType:"source",sourceId:y.getSource().id})),y.setEventedParent(null),y.clearTiles()}return delete this._otherSourceCaches[o],delete this._symbolSourceCaches[o],this.mergeSources(),l.setEventedParent(null),l.onRemove&&l.onRemove(this.map),this._changes.setDirty(),this}setGeoJSONSourceData(o,l){this._checkLoaded(),this.getOwnSource(o).setData(l),this._changes.setDirty()}getOwnSource(o){const l=this.getOwnSourceCache(o);return l&&l.getSource()}getOwnSources(){const o=[];for(const l in this._otherSourceCaches){const m=this.getOwnSourceCache(l);m&&o.push(m.getSource())}return o}areTilesLoaded(){const o=this._mergedSourceCaches;for(const l in o){const m=o[l]._tiles;for(const y in m){const w=m[y];if(w.state!=="loaded"&&w.state!=="errored")return!1}}return!0}setLights(o){if(this._checkLoaded(),!o)return delete this.ambientLight,void delete this.directionalLight;const l=this._getTransitionParameters();for(const y of o){if(this._validate(oi,"lights",y))return;switch(y.type){case"ambient":if(this.ambientLight){const w=this.ambientLight;w.set(y),w.updateTransitions(l)}else this.ambientLight=new ar(y,Qt||(Qt=new r.a5({color:new r.a6(r.a3.properties_light_ambient.color),"color-use-theme":new r.a6({type:"string",default:"default","property-type":"data-constant"}),intensity:new r.a6(r.a3.properties_light_ambient.intensity)})),this.scope,this.options);break;case"directional":if(this.directionalLight){const w=this.directionalLight;w.set(y),w.updateTransitions(l)}else this.directionalLight=new ar(y,on||(on=new r.a5({direction:new r.ak(r.a3.properties_light_directional.direction),color:new r.a6(r.a3.properties_light_directional.color),"color-use-theme":new r.a6({type:"string",default:"default","property-type":"data-constant"}),intensity:new r.a6(r.a3.properties_light_directional.intensity),"cast-shadows":new r.a6(r.a3.properties_light_directional["cast-shadows"]),"shadow-quality":new r.a6(r.a3.properties_light_directional["shadow-quality"]),"shadow-intensity":new r.a6(r.a3.properties_light_directional["shadow-intensity"])})),this.scope,this.options)}}const m=new r.a8(this.z||0,l);this.ambientLight&&this.ambientLight.recalculate(m),this.directionalLight&&this.directionalLight.recalculate(m),this._brightness=this.calculateLightsBrightness(),this.dispatcher.broadcast("setBrightness",this._brightness)}calculateLightsBrightness(){const o=this.directionalLight,l=this.ambientLight;if(!o||!l)return;const m=X=>.2126*(X[0]<=.03928?X[0]/12.92:Math.pow((X[0]+.055)/1.055,2.4))+.7152*(X[1]<=.03928?X[1]/12.92:Math.pow((X[1]+.055)/1.055,2.4))+.0722*(X[2]<=.03928?X[2]/12.92:Math.pow((X[2]+.055)/1.055,2.4)),y=o.properties.get("color").toRenderColor(null).toArray01(),w=o.properties.get("intensity"),E=o.properties.get("direction"),O=1-r.cb(E.x,E.y,E.z)[2]/90,$=m(y)*w*O,H=l.properties.get("color").toRenderColor(null).toArray01(),G=l.properties.get("intensity"),Z=m(H)*G;return Number((($+Z)/2).toFixed(6))}getBrightness(){return this._brightness}getLights(){if(!this.enable3dLights())return null;const o=[];return this.directionalLight&&o.push(this.directionalLight.get()),this.ambientLight&&o.push(this.ambientLight.get()),o}enable3dLights(){return!!this.ambientLight&&!!this.directionalLight}getFragmentStyle(o){if(!o)return this;if(r.cr(o)){const l=r.cs(o),m=this.fragments.find(({id:w})=>w===l);if(!m)throw new Error(`Style import '${o}' not found`);const y=r.cq(o);return m.style.getFragmentStyle(y)}{const l=this.fragments.find(({id:m})=>m===o);return l?l.style:void 0}}setFeaturesetSelectors(o){if(!o)return;const l={},m=(y,w="")=>`${y}::${w}`;this._featuresetSelectors={};for(const y in o){const w=this._featuresetSelectors[y]=[];for(const E of o[y].selectors){if(E.featureNamespace){const $=this.getOwnLayer(E.layer);if(!$){r.w(`Layer is undefined for selector: ${E.layer}`);continue}const H=m($.source,$.sourceLayer);if(H in l&&l[H]!==E.featureNamespace){r.w(`"featureNamespace ${E.featureNamespace} of featureset ${y}'s selector is not associated to the same source, skip this selector`);continue}l[H]=E.featureNamespace}let O;if(E.properties)for(const $ in E.properties){const H=r.U(E.properties[$]);H.result==="success"&&(O=O||{},O[$]=H.value)}w.push({layerId:E.layer,namespace:E.featureNamespace,properties:O,uniqueFeatureID:E._uniqueFeatureID})}}}getFeaturesetDescriptors(o){const l=this.getFragmentStyle(o);if(!l||!l.stylesheet.featuresets)return[];const m=[];for(const y in l.stylesheet.featuresets)m.push({featuresetId:y,importId:l.scope?l.scope:void 0});return m}getFeaturesetLayers(o,l){const m=this.getFragmentStyle(l),y=m.stylesheet.featuresets;if(!y||!y[o])return this.fire(new r.y(new Error(`The featureset '${o}' does not exist in the map's style and cannot be queried.`))),[];const w=[];for(const E of y[o].selectors){const O=m.getOwnLayer(E.layer);O&&w.push(O)}return w}getConfigProperty(o,l){const m=this.getFragmentStyle(o);if(!m)return null;const y=r.aC(l,m.scope),w=m.options.get(y),E=w?w.value||w.default:null;return E?E.serialize():null}setConfigProperty(o,l,m){const y=this.getFragmentStyle(o);if(!y)return;const w=y.stylesheet.indoor?Cg(y.stylesheet.schema):y.stylesheet.schema;if(!w||!w[l])return;const E=r.U(m);if(E.result!=="success")return void au(this,E.value);const O=E.value.expression,$=r.aC(l,y.scope),H=y.options.get($);if(!H)return;let G;const{minValue:Z,maxValue:X,stepValue:oe,type:xe,values:ve}=w[l],Ce=r.U(w[l].default);Ce.result==="success"&&(G=Ce.value.expression),G?(this.options.set($,Object.assign({},H,{value:O,default:G,minValue:Z,maxValue:X,stepValue:oe,type:xe,values:ve})),this.updateConfigDependencies(l)):this.fire(new r.y(new Error(`No schema defined for the config option "${l}" in the "${o}" fragment.`)))}getConfig(o){const l=this.getFragmentStyle(o);if(!l)return null;const m=l.stylesheet.schema;if(!m)return null;const y={};for(const w in m){const E=r.aC(w,l.scope),O=l.options.get(E),$=O?O.value||O.default:null;y[w]=$?$.serialize():null}return y}setConfig(o,l){const m=this.getFragmentStyle(o);m&&(m.updateConfig(l,m.stylesheet.schema),this.updateConfigDependencies())}getSchema(o){const l=this.getFragmentStyle(o);return l?l.stylesheet.schema:null}setSchema(o,l){const m=this.getFragmentStyle(o);m&&(m.stylesheet.schema=l,m.updateConfig(m._config,l),this.updateConfigDependencies())}updateConfig(o,l){if(this._config=o,o||l)if(l)for(const m in l){let y,w;const E=r.U(l[m].default);if(E.result==="success"&&(y=E.value.expression),o&&o[m]!==void 0){const X=r.U(o[m]);X.result==="success"&&(w=X.value.expression)}const{minValue:O,maxValue:$,stepValue:H,type:G,values:Z}=l[m];if(y){const X=r.aC(m,this.scope);this.options.set(X,{default:y,value:w,minValue:O,maxValue:$,stepValue:H,type:G,values:Z})}else this.fire(new r.y(new Error(`No schema defined for config option "${m}".`)))}else this.fire(new r.y(new Error("Attempting to set config for a style without schema.")))}updateConfigDependencies(o){for(const l of this._configDependentLayers){const m=this.getLayer(l);if(m){if(o&&!m.configDependencies.has(o))continue;m.possiblyEvaluateVisibility(),this._updateLayer(m)}}this.ambientLight&&this.ambientLight.updateConfig(this.options),this.directionalLight&&this.directionalLight.updateConfig(this.options),this.fog&&this.fog.updateConfig(this.options),this.snow&&this.snow.updateConfig(this.options),this.rain&&this.rain.updateConfig(this.options),this.forEachFragmentStyle(l=>{const m=l._styleColorTheme.colorThemeOverride?l._styleColorTheme.colorThemeOverride:l._styleColorTheme.colorTheme;if(m){const y=l._evaluateColorThemeData(m);(!l._styleColorTheme.lut&&y!==""||l._styleColorTheme.lut&&y!==l._styleColorTheme.lut.data)&&l.setColorTheme(m)}}),this._changes.setDirty()}addLayer(o,l,m={}){this._checkLoaded();const y=o.id;if(this._layers[y])return void this.fire(new r.y(new Error(`Layer with id "${y}" already exists on this map`)));let w;if(o.type==="custom"){if(au(this,r.ct(o)))return;w=r.cu(o,this.scope,this._styleColorTheme.lut,this.options)}else{if(typeof o.source=="object"&&(this.addSource(y,o.source),o=r.cp(o),o=r.l(o,{source:y})),this._validate(ga,`layers.${y}`,o,{arrayIndex:-1},m))return;w=r.cu(o,this.scope,this._styleColorTheme.lut,this.options),this._validateLayer(w),w.setEventedParent(this,{layer:{id:y}})}w.configDependencies.size!==0&&this._configDependentLayers.add(w.fqid);let E=this._order.length;if(l){const G=this._order.indexOf(l);if(G===-1)return void this.fire(new r.y(new Error(`Layer with id "${l}" does not exist on this map.`)));w.slot===this._layers[l].slot?E=G:r.w(`Layer with id "${l}" has a different slot. Layers can only be rearranged within the same slot.`)}this._order.splice(E,0,y),this._layerOrderChanged=!0,this._layers[y]=w;const O=this.getOwnLayerSourceCache(w),$=!!this.directionalLight&&this.directionalLight.shadowsEnabled();O&&w.canCastShadows()&&$&&(O.castsShadows=!0);const H=this._changes.getRemovedLayer(w);if(H&&w.source&&O&&w.type!=="custom"){this._changes.discardLayerRemoval(w);const G=r.aC(w.source,w.scope);H.type!==w.type?this._changes.updateSourceCache(G,"clear"):(this._changes.updateSourceCache(G,"reload"),O.pause())}this._updateLayer(w),w.onAdd&&w.onAdd(this.map),w.scope=this.scope,this.mergeLayers()}moveLayer(o,l){this._checkLoaded();const m=this._checkLayer(o);if(!m||o===l)return;const y=this._order.indexOf(o);this._order.splice(y,1);let w=this._order.length;if(l){const E=this._order.indexOf(l);if(E===-1)return void this.fire(new r.y(new Error(`Layer with id "${l}" does not exist on this map.`)));m.slot===this._layers[l].slot?w=E:r.w(`Layer with id "${l}" has a different slot. Layers can only be rearranged within the same slot.`)}this._order.splice(w,0,o),this._changes.setDirty(),this._layerOrderChanged=!0,this.mergeLayers()}removeLayer(o){this._checkLoaded();const l=this._checkLayer(o);if(!l)return;l.setEventedParent(null);const m=this._order.indexOf(o);this._order.splice(m,1),delete this._layers[o],this._changes.setDirty(),this._layerOrderChanged=!0,this._configDependentLayers.delete(l.fqid),this._changes.removeLayer(l);const y=this.getOwnLayerSourceCache(l);if(y&&y.castsShadows){let w=!1;for(const E in this._layers)if(this._layers[E].source===l.source&&this._layers[E].canCastShadows()){w=!0;break}y.castsShadows=w}l.onRemove&&l.onRemove(this.map),this.mergeLayers()}getOwnLayer(o){return this._layers[o]}hasLayer(o){return o in this._mergedLayers}hasLayerType(o){for(const l in this._layers)if(this._layers[l].type===o)return!0;return!1}setLayerZoomRange(o,l,m){this._checkLoaded();const y=this._checkLayer(o);y&&(y.minzoom===l&&y.maxzoom===m||(l!=null&&(y.minzoom=l),m!=null&&(y.maxzoom=m),this._updateLayer(y)))}getSlots(){return this._checkLoaded(),this._mergedSlots}setSlot(o,l){this._checkLoaded();const m=this._checkLayer(o);m&&m.slot!==l&&(m.slot=l,this._updateLayer(m))}setFilter(o,l,m={}){this._checkLoaded();const y=this._checkLayer(o);if(y&&!r.bn(y.filter,l))return l==null?(y.filter=void 0,void this._updateLayer(y)):void(this._validate(Jo,`layers.${y.id}.filter`,l,{layerType:y.type},m)||(y.filter=r.cp(l),this._updateLayer(y)))}getFilter(o){const l=this._checkLayer(o);if(l)return r.cp(l.filter)}setLayoutProperty(o,l,m,y={}){this._checkLoaded();const w=this._checkLayer(o);if(w&&!r.bn(w.getLayoutProperty(l),m)){if(m!=null&&(!y||y.validate!==!1)&&au(w,vc.call(jo,{key:`layers.${o}.layout.${l}`,layerType:w.type,objectKey:l,value:m,styleSpec:r.a3,style:{glyphs:!0,sprite:!0}})))return;w.setLayoutProperty(l,m),w.configDependencies.size!==0&&this._configDependentLayers.add(w.fqid),this._updateLayer(w)}}getLayoutProperty(o,l){const m=this._checkLayer(o);if(m)return m.getLayoutProperty(l)}setPaintProperty(o,l,m,y={}){this._checkLoaded();const w=this._checkLayer(o);if(!w||r.bn(w.getPaintProperty(l),m)||m!=null&&(!y||y.validate!==!1)&&au(w,va.call(jo,{key:`layers.${o}.paint.${l}`,layerType:w.type,objectKey:l,value:m,styleSpec:r.a3})))return;const E=w.setPaintProperty(l,m);w.configDependencies.size!==0&&this._configDependentLayers.add(w.fqid),E&&this._updateLayer(w),this._changes.updatePaintProperties(w)}getPaintProperty(o,l){const m=this._checkLayer(o);if(m)return m.getPaintProperty(l)}setFeatureState(o,l){if(this._checkLoaded(),"target"in o){if("featuresetId"in o.target){const{featuresetId:$,importId:H}=o.target,G=this.getFragmentStyle(H),Z=G.getFeaturesetLayers($);for(const{source:X,sourceLayer:oe}of Z)G.setFeatureState({id:o.id,source:X,sourceLayer:oe},l)}else if("layerId"in o.target){const{layerId:$}=o.target,H=this.getLayer($);this.setFeatureState({id:o.id,source:H.source,sourceLayer:H.sourceLayer},l)}return}const m=o.source,y=o.sourceLayer,w=this._checkSource(m);if(!w)return;const E=w.type;if(E==="geojson"&&y)return void this.fire(new r.y(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if(E==="vector"&&!y)return void this.fire(new r.y(new Error("The sourceLayer parameter must be provided for vector source types.")));o.id===void 0&&this.fire(new r.y(new Error("The feature id parameter must be provided.")));const O=this.getOwnSourceCaches(m);for(const $ of O)$.setFeatureState(y,o.id,l)}removeFeatureState(o,l){if(this._checkLoaded(),"target"in o){if("featuresetId"in o.target){const{featuresetId:$,importId:H}=o.target,G=this.getFragmentStyle(H),Z=G.getFeaturesetLayers($);for(const{source:X,sourceLayer:oe}of Z)G.removeFeatureState({id:o.id,source:X,sourceLayer:oe},l)}else if("layerId"in o.target){const{layerId:$}=o.target,H=this.getLayer($);this.removeFeatureState({id:o.id,source:H.source,sourceLayer:H.sourceLayer},l)}return}const m=o.source,y=this._checkSource(m);if(!y)return;const w=y.type,E=w==="vector"?o.sourceLayer:void 0;if(w==="vector"&&!E)return void this.fire(new r.y(new Error("The sourceLayer parameter must be provided for vector source types.")));if(l&&typeof o.id!="string"&&typeof o.id!="number")return void this.fire(new r.y(new Error("A feature id is required to remove its specific state property.")));const O=this.getOwnSourceCaches(m);for(const $ of O)$.removeFeatureState(E,o.id,l)}getFeatureState(o){if(this._checkLoaded(),"target"in o){let w;if("featuresetId"in o.target){const{featuresetId:E,importId:O}=o.target,$=this.getFragmentStyle(O),H=$.getFeaturesetLayers(E);for(const{source:G,sourceLayer:Z}of H){const X=$.getFeatureState({id:o.id,source:G,sourceLayer:Z});if(X&&!w)w=X;else if(!r.bn(w,X))return void this.fire(new r.y(new Error("The same feature id exists in multiple sources in the featureset, but their feature states are not consistent through the sources.")))}}else if("layerId"in o.target){const{layerId:E}=o.target,O=this.getLayer(E);w=this.getFeatureState({id:o.id,source:O.source,sourceLayer:O.sourceLayer})}return w}const l=o.source,m=o.sourceLayer,y=this._checkSource(l);if(y){if(y.type!=="vector"||m)return o.id===void 0&&this.fire(new r.y(new Error("The feature id parameter must be provided."))),this.getOwnSourceCaches(l)[0].getFeatureState(m,o.id);this.fire(new r.y(new Error("The sourceLayer parameter must be provided for vector source types.")))}}setTransition(o){return this.stylesheet.transition=r.l({},this.stylesheet.transition,o),this.transition=this.stylesheet.transition,this}getTransition(){return r.l({},this.stylesheet.transition)}serialize(){this._checkLoaded();const o=this.getTerrain(),l=o&&this.terrain&&this.terrain.scope===this.scope?o:this.stylesheet.terrain;return r.cv({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,fragment:this.stylesheet.fragment,imports:this._serializeImports(),schema:this.stylesheet.schema,camera:this.stylesheet.camera,light:this.stylesheet.light,lights:this.stylesheet.lights,terrain:l,fog:this.stylesheet.fog,snow:this.stylesheet.snow,rain:this.stylesheet.rain,center:this.stylesheet.center,"color-theme":this.stylesheet["color-theme"],zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:this._serializeSources(),layers:this._serializeLayers(this._order)},m=>m!==void 0)}_updateFilteredLayers(o){for(const l of Object.values(this._mergedLayers))o(l)&&this._updateLayer(l)}_updateLayer(o){this._changes.updateLayer(o);const l=this.getLayerSourceCache(o),m=r.aC(o.source,o.scope),y=this._changes.getUpdatedSourceCaches();o.source&&!y[m]&&l&&l.getSource().type!=="raster"&&(this._changes.updateSourceCache(m,"reload"),l.pause()),o.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(o){const l=O=>this._mergedLayers[O].is3D(),m=this.order,y={},w=[];for(let O=m.length-1;O>=0;O--){const $=m[O];if(l($)){y[$]=O;for(const H of o){const G=H[$];if(G)for(const Z of G)w.push(Z)}}}w.sort((O,$)=>$.intersectionZ-O.intersectionZ);const E=[];for(let O=m.length-1;O>=0;O--){const $=m[O];if(l($))for(let H=w.length-1;H>=0;H--){const G=w[H].feature;if(G.layer&&y[G.layer.id]<O)break;E.push(G),w.pop()}else for(const H of o){const G=H[$];if(G)for(const Z of G)E.push(Z.feature)}}return E}queryRenderedFeatures(o,l,m){let y;l&&!Array.isArray(l)&&l.filter&&(this._validate(Jo,"queryRenderedFeatures.filter",l.filter,null,l),y=r.aZ(l.filter));const w={},E=G=>{if(Mg.has(G.type))return;const Z=this.getOwnLayerSourceCache(G),X=w[Z.id]=w[Z.id]||{sourceCache:Z,layers:{},has3DLayers:!1};G.is3D()&&(X.has3DLayers=!0),X.layers[G.fqid]=X.layers[G.fqid]||{styleLayer:G,targets:[]},X.layers[G.fqid].targets.push({filter:y})};if(l&&l.layers){if(!Array.isArray(l.layers))return this.fire(new r.y(new Error("parameters.layers must be an Array."))),[];for(const G of l.layers){const Z=this._layers[G];if(!Z)return this.fire(new r.y(new Error(`The layer '${G}' does not exist in the map's style and cannot be queried for features.`))),[];E(Z)}}else for(const G in this._layers)E(this._layers[G]);const O=this._queryRenderedFeatures(o,w,m),$=this._flattenAndSortRenderedFeatures(O),H=[];for(const G of $)r.cs(G.layer.id)===this.scope&&H.push(G);return H}queryRenderedFeatureset(o,l,m){let y;l&&!Array.isArray(l)&&l.filter&&(this._validate(Jo,"queryRenderedFeatures.filter",l.filter,null,l),y=r.aZ(l.filter));const w="mock",E=[];if(l&&l.target)E.push(Object.assign({},l,{targetId:w,filter:y}));else{const G=this.getFeaturesetDescriptors();for(const Z of G)E.push({targetId:w,filter:y,target:Z});for(const{style:Z}of this.fragments){const X=Z.getFeaturesetDescriptors();for(const oe of X)E.push({targetId:w,filter:y,target:oe})}}const O=this.queryRenderedTargets(o,E,m),$=[],H=new Set;for(const G of O)for(const Z of G.variants[w])Pl(Z,G,H)||$.push(new r.cw(G,Z));return $}queryRenderedTargets(o,l,m){const y={},w=(O,$,H,G)=>{const Z=y[$.id]=y[$.id]||{sourceCache:$,layers:{},has3DLayers:!1};if(Z.layers[O.fqid]=Z.layers[O.fqid]||{styleLayer:O,targets:[]},O.is3D()&&(Z.has3DLayers=!0),!G)return H.uniqueFeatureID=!1,void Z.layers[O.fqid].targets.push(H);Z.layers[O.fqid].targets.push(Object.assign({},H,{namespace:G.namespace,properties:G.properties,uniqueFeatureID:G.uniqueFeatureID}))};for(const O of l)if("featuresetId"in O.target){const{featuresetId:$,importId:H}=O.target,G=this.getFragmentStyle(H);if(!G||!G._featuresetSelectors)continue;const Z=G._featuresetSelectors[$];if(!Z){this.fire(new r.y(new Error(`The featureset '${$}' does not exist in the map's style and cannot be queried for features.`)));continue}for(const X of Z){const oe=G.getOwnLayer(X.layerId);oe&&!Mg.has(oe.type)&&w(oe,G.getOwnLayerSourceCache(oe),O,X)}}else if("layerId"in O.target){const{layerId:$}=O.target,H=this.getLayer($);if(!H||Mg.has(H.type))continue;w(H,this.getLayerSourceCache(H),O)}const E=this._queryRenderedFeatures(o,y,m);return this._flattenAndSortRenderedFeatures(E)}_queryRenderedFeatures(o,l,m){const y=[],w=!!this.map._showQueryGeometry,E=rr.createFromScreenPoints(o,m);for(const O in l){const $=ah(E,l[O],this._availableImages,m,w);Object.keys($).length&&y.push($)}if(this.placement)for(const O in l){if(!l[O].sourceCache._onlySymbols)continue;const $=sg(E.screenGeometry,l[O],this._availableImages,this.placement.collisionIndex,this.placement.retainedQueryData);Object.keys($).length&&y.push($)}return y}querySourceFeatures(o,l){const m=l&&l.filter;m&&this._validate(Jo,"querySourceFeatures.filter",m,null,l);let y=[];const w=this.getOwnSourceCaches(o);for(const E of w)y=y.concat(Dy(E,l));return y}addSourceType(o,l,m){return ba.getSourceType(o)?m(new Error(`A source type called "${o}" already exists.`)):(ba.setSourceType(o,l),l.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:o,url:l.workerSourceURL},m):m(null,null))}getFlatLight(){return this.light.getLight()}setFlatLight(o,l,m={}){this._checkLoaded();const y=this.light.getLight();let w=!1;for(const O in o)if(!r.bn(o[O],y[O])){w=!0;break}if(!w)return;const E=this._getTransitionParameters();this.light.setLight(o,l,m),this.light.updateTransitions(E)}getTerrain(){return this.terrain&&this.terrain.drapeRenderMode===1?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}checkCanvasFingerprintNoise(){this.disableElevatedTerrain===void 0&&(this.disableElevatedTerrain=r.q.hasCanvasFingerprintNoise(),this.disableElevatedTerrain&&r.w("Terrain and hillshade are disabled because of Canvas2D limitations when fingerprinting protection is enabled (e.g. in private browsing mode)."))}setTerrain(o,l=1){if(this._checkLoaded(),!o)return this.terrainSetForDrapingOnly()||(delete this.terrain,this.map.transform.projection.requiresDraping&&this.setTerrainForDraping()),l===0&&delete this.terrain,o===null?this.stylesheet.terrain=null:delete this.stylesheet.terrain,this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);this.checkCanvasFingerprintNoise();let m=o;const y=o.source==null;if(l===1){if(this.disableElevatedTerrain)return;if(typeof m.source=="object"){const O="terrain-dem-src";this.addSource(O,m.source),m=r.cp(m),m=r.l(m,{source:O})}const w=r.l({},m),E={};if(this.terrain&&y){w.source=this.terrain.get().source;const O=this.terrain?this.getFragmentStyle(this.terrain.scope):null;O&&(E.style=O.serialize())}if(this._validate(mo,"terrain",w,E))return}if(!this.terrain||this.terrain.scope!==this.scope&&!y||this.terrain&&l!==this.terrain.drapeRenderMode){if(!m)return;this._createTerrain(m,l),this.fire(new r.z("data",{dataType:"style"}))}else{const w=this.terrain,E=w.get();for(const O of Object.keys(r.a3.terrain))!m.hasOwnProperty(O)&&r.a3.terrain[O].default&&(m[O]=r.a3.terrain[O].default);for(const O in o)if(!r.bn(o[O],E[O])){w.set(o,this.options),this.stylesheet.terrain=o;const $=this._getTransitionParameters({duration:0});w.updateTransitions($),this.fire(new r.z("data",{dataType:"style"}));break}}this.mergeTerrain(),this.updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(o){const l=this.fog=new Pt(o,this.map.transform,this.scope,this.options);this.stylesheet.fog=l.get();const m=this._getTransitionParameters({duration:0});l.updateTransitions(m)}_createSnow(o){const l=this.snow=new Wn(o,this.map.transform,this.scope,this.options);this.stylesheet.snow=l.get();const m=this._getTransitionParameters({duration:0});l.updateTransitions(m)}_createRain(o){const l=this.rain=new er(o,this.map.transform,this.scope,this.options);this.stylesheet.rain=l.get();const m=this._getTransitionParameters({duration:0});l.updateTransitions(m)}_updateMarkersOpacity(){this.map._markers.length!==0&&this.map._requestDomTask(()=>{for(const o of this.map._markers)o._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(o){if(this._checkLoaded(),!o)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const l=this.fog;if(!r.bn(l.get(),o)){l.set(o,this.options),this.stylesheet.fog=l.get();const m=this._getTransitionParameters({duration:0});l.updateTransitions(m)}}else this._createFog(o);this._markersNeedUpdate=!0}getSnow(){return this.snow?this.snow.get():null}setSnow(o){if(this._checkLoaded(),!o)return delete this.snow,void delete this.stylesheet.snow;if(this.snow){const l=this.snow;if(!r.bn(l.get(),o)){l.set(o,this.options),this.stylesheet.snow=l.get();const m=this._getTransitionParameters({duration:0});l.updateTransitions(m)}}else this._createSnow(o);this._markersNeedUpdate=!0}getRain(){return this.rain?this.rain.get():null}setRain(o){if(this._checkLoaded(),!o)return delete this.rain,void delete this.stylesheet.rain;if(this.rain){const l=this.rain;if(!r.bn(l.get(),o)){l.set(o,this.options),this.stylesheet.rain=l.get();const m=this._getTransitionParameters({duration:0});l.updateTransitions(m)}}else this._createRain(o);this._markersNeedUpdate=!0}_reloadColorTheme(){const o=()=>{for(const y in this._layers)this._layers[y].lut=this._styleColorTheme.lut;for(const y in this._sourceCaches)this._sourceCaches[y].clearTiles()},l=this._styleColorTheme.colorThemeOverride?this._styleColorTheme.colorThemeOverride:this._styleColorTheme.colorTheme;if(!l)return this._styleColorTheme.lut=null,void o();const m=this._evaluateColorThemeData(l);this._loadColorTheme(m).then(()=>{this.fire(new r.z("colorthemeset")),o()}).catch(y=>{r.w(`Couldn't set color theme: ${y}`)})}setColorTheme(o){this._checkLoaded(),this._styleColorTheme.colorThemeOverride&&r.w("Note: setColorTheme is called on a style with a color-theme override, the passed color-theme won't be visible."),this._styleColorTheme.colorTheme=o,this._reloadColorTheme()}setImportColorTheme(o,l){const m=this.getFragmentStyle(o);m&&(m._styleColorTheme.colorThemeOverride=l,m._reloadColorTheme())}_getTransitionParameters(o){return{now:r.q.now(),transition:r.l(this.transition,o)}}updateDrapeFirstLayers(){if(!this.terrain)return;const o=[],l=[];for(const m of this._mergedOrder)this.isLayerDraped(this._mergedLayers[m])?o.push(m):l.push(m);this._drapedFirstOrder=[],this._drapedFirstOrder.push(...o),this._drapedFirstOrder.push(...l)}_createTerrain(o,l){const m=this.terrain=new he(o,l,this.scope,this.options);l===1&&(this.stylesheet.terrain=o),this.mergeTerrain(),this.updateDrapeFirstLayers(),this._force3DLayerUpdate();const y=this._getTransitionParameters({duration:0});m.updateTransitions(y)}_force3DLayerUpdate(){for(const o in this._layers){const l=this._layers[o];l.type==="fill-extrusion"&&this._updateLayer(l)}}_forceSymbolLayerUpdate(){for(const o in this._layers){const l=this._layers[o];l.type==="symbol"&&this._updateLayer(l)}}_validate(o,l,m,y,w={}){if(w&&w.validate===!1)return!1;const E=r.l({},this.serialize());return au(this,o.call(jo,r.l({key:l,style:E,value:m,styleSpec:r.a3},y)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),r.cx.off("pluginStateChange",this._rtlTextPluginCallback);for(const o in this._mergedLayers)this._mergedLayers[o].setEventedParent(null);for(const o in this._mergedSourceCaches)this._mergedSourceCaches[o].clearTiles(),this._mergedSourceCaches[o].setEventedParent(null);this.setEventedParent(null),delete this.fog,delete this.snow,delete this.rain,delete this.terrain,delete this.ambientLight,delete this.directionalLight,this.isRootStyle()&&(this.imageManager.setEventedParent(null),this.modelManager.setEventedParent(null),this.dispatcher.remove())}clearSource(o){const l=this.getSourceCaches(o);for(const m of l)m.clearTiles()}clearSources(){for(const o in this._mergedSourceCaches)this._mergedSourceCaches[o].clearTiles()}reloadSource(o){const l=this.getSourceCaches(o);for(const m of l)m.resume(),m.reload()}reloadSources(){for(const o of this.getSources())o.reload&&o.reload()}reloadModels(){this.modelManager.reloadModels(""),this.forEachFragmentStyle(o=>{o.modelManager.reloadModels(o.scope)})}updateSources(o){let l;this.directionalLight&&(l=su(this.directionalLight));for(const m in this._mergedSourceCaches)this._mergedSourceCaches[m].update(o,void 0,void 0,l)}_generateCollisionBoxes(){for(const o in this._sourceCaches){const l=this._sourceCaches[o];l.resume(),l.reload()}}_updatePlacement(o,l,m,y,w,E,O=!1){let $=!1,H=!1;const G={},Z={};for(const X of this._mergedOrder){const oe=this._mergedLayers[X];if(oe.type!=="symbol")continue;const xe=r.aC(oe.source,oe.scope);let ve=G[xe];if(!ve){const Te=this.getLayerSourceCache(oe);if(!Te)continue;const Le=Te.getRenderableIds(!0).map(Ge=>Te.getTileByID(Ge));Z[xe]=Le.slice(),ve=G[xe]=Le.sort((Ge,He)=>He.tileID.overscaledZ-Ge.tileID.overscaledZ||(Ge.tileID.isLessThan(He.tileID)?-1:1))}const Ce=this.crossTileSymbolIndex.addLayer(oe,ve,l.center.lng,l.projection);$=$||Ce}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._mergedOrder),O=O||this._layerOrderChanged||y===0,this._layerOrderChanged&&this.fire(new r.z("neworder")),(O||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(r.q.now(),l.zoom))&&(this.pauseablePlacement=new Hx(l,this._mergedOrder,O,m,y,w,this.placement,this.fog&&l.projection.supportsFog?this.fog.state:null,this._buildingIndex),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._mergedOrder,this._mergedLayers,G,Z,this.map.painter.scaleFactor),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(r.q.now()),H=!0),$&&this.pauseablePlacement.placement.setStale()),H||$){this._buildingIndex.onNewFrame(l.zoom);for(let X=0;X<this._mergedOrder.length;X++){const oe=this._mergedLayers[this._mergedOrder[X]];if(oe.type!=="symbol")continue;const xe=this.isLayerClipped(oe);this.placement.updateLayerOpacities(oe,G[r.aC(oe.source,oe.scope)],X,xe?E:null)}}return{needsRerender:!this.pauseablePlacement.isDone()||this.placement.hasTransitions(r.q.now())}}_releaseSymbolFadeTiles(){for(const o in this._sourceCaches)this._sourceCaches[o].releaseSymbolFadeTiles()}addImport(o,l){this._checkLoaded();const m=this.stylesheet.imports=this.stylesheet.imports||[];if(m.findIndex(({id:w})=>w===o.id)!==-1)return void this.fire(new r.y(new Error(`Import with id '${o.id}' already exists in the map's style.`)));if(!l)return m.push(o),this._loadImports([o],!0);const y=m.findIndex(({id:w})=>w===l);return y===-1&&this.fire(new r.y(new Error(`Import with id "${l}" does not exist on this map.`))),this.stylesheet.imports=m.slice(0,y).concat(o).concat(m.slice(y)),this._loadImports([o],!0,l)}updateImport(o,l){this._checkLoaded();const m=this.stylesheet.imports||[],y=this.getImportIndex(o);return y===-1?this:typeof l=="string"?(this.setImportUrl(o,l),this):(l.url&&l.url!==m[y].url&&this.setImportUrl(o,l.url),r.bn(l.config,m[y].config)||this.setImportConfig(o,l.config,l.data.schema),r.bn(l.data,m[y].data)||this.setImportData(o,l.data),this)}moveImport(o,l){this._checkLoaded();let m=this.stylesheet.imports||[];const y=this.getImportIndex(o);if(y===-1)return this;const w=this.getImportIndex(l);if(w===-1)return this;const E=m[y],O=this.fragments[y];return m=m.filter(({id:$})=>$!==o),this.fragments=this.fragments.filter(({id:$})=>$!==o),this.stylesheet.imports=m.slice(0,w).concat(E).concat(m.slice(w)),this.fragments=this.fragments.slice(0,w).concat(O).concat(this.fragments.slice(w)),this.mergeLayers(),this}setImportUrl(o,l){this._checkLoaded();const m=this.stylesheet.imports||[],y=this.getImportIndex(o);if(y===-1)return this;m[y].url=l;const w=this.fragments[y];return w.style=this._createFragmentStyle(m[y]),w.style.on("style.import.load",()=>this.mergeAll()),w.style.loadURL(l),this}setImportData(o,l){this._checkLoaded();const m=this.getImportIndex(o),y=this.stylesheet.imports||[];return m===-1?this:l?(this.fragments[m].style.setState(l),this._reloadImports(),this):(delete y[m].data,this.setImportUrl(o,y[m].url))}setImportConfig(o,l,m){this._checkLoaded();const y=this.getImportIndex(o),w=this.stylesheet.imports||[];if(y===-1)return this;l?w[y].config=l:delete w[y].config;const E=this.fragments[y];m&&E.style.stylesheet&&(E.style.stylesheet.schema=m);const O=E.style.stylesheet&&E.style.stylesheet.schema;return E.config=l,E.style.updateConfig(l,O),this.updateConfigDependencies(),this}removeImport(o){this._checkLoaded();const l=this.stylesheet.imports||[],m=this.getImportIndex(o);m!==-1&&(l.splice(m,1),this.fragments[m].style._remove(),this.fragments.splice(m,1),this._reloadImports())}getImportIndex(o){const l=(this.stylesheet.imports||[]).findIndex(m=>m.id===o);return l===-1&&this.fire(new r.y(new Error(`Import '${o}' does not exist in the map's style and cannot be updated.`))),l}getLayer(o){return this._mergedLayers[o]}getSources(){const o=[];for(const l in this._mergedOtherSourceCaches){const m=this._mergedOtherSourceCaches[l];m&&o.push(m.getSource())}return o}getSource(o,l){const m=this.getSourceCache(o,l);return m&&m.getSource()}getLayerSource(o){const l=this.getLayerSourceCache(o);return l&&l.getSource()}getSourceCache(o,l){const m=r.aC(o,l);return this._mergedOtherSourceCaches[m]}getLayerSourceCache(o){const l=r.aC(o.source,o.scope);return o.type==="symbol"?this._mergedSymbolSourceCaches[l]:this._mergedOtherSourceCaches[l]}getSourceCaches(o){if(o==null)return Object.values(this._mergedSourceCaches);const l=[];return this._mergedOtherSourceCaches[o]&&l.push(this._mergedOtherSourceCaches[o]),this._mergedSymbolSourceCaches[o]&&l.push(this._mergedSymbolSourceCaches[o]),l}updateSourceCaches(){const o=this._changes.getUpdatedSourceCaches();for(const l in o){const m=o[l];m==="reload"?this.reloadSource(l):m==="clear"&&this.clearSource(l)}}updateLayers(o){const l=this._changes.getUpdatedPaintProperties();for(const m of l){const y=this.getLayer(m);y&&y.updateTransitions(o)}}getImages(o,l,m){this.imageManager.getImages(l.icons,l.scope,m),this._updateTilesForChangedImages();const y=w=>{w&&w.setDependencies(l.tileID.key,l.type,l.icons)};y(this._otherSourceCaches[l.source]),y(this._symbolSourceCaches[l.source])}rasterizeImages(o,l,m){this.imageManager.rasterizeImages(l,m)}getGlyphs(o,l,m){this.glyphManager.getGlyphs(l.stacks,l.scope,m)}getResource(o,l,m){return r.cy(l,m)}getOwnSourceCache(o){return this._otherSourceCaches[o]}getOwnLayerSourceCache(o){return o.type==="symbol"?this._symbolSourceCaches[o.source]:this._otherSourceCaches[o.source]}getOwnSourceCaches(o){const l=[];return this._otherSourceCaches[o]&&l.push(this._otherSourceCaches[o]),this._symbolSourceCaches[o]&&l.push(this._symbolSourceCaches[o]),l}_isSourceCacheLoaded(o){const l=this.getOwnSourceCaches(o);return l.length===0?(this.fire(new r.y(new Error(`There is no source with ID '${o}'`))),!1):l.every(m=>m.loaded())}has3DLayers(){return this._has3DLayers}hasSymbolLayers(){return this._hasSymbolLayers}hasCircleLayers(){return this._hasCircleLayers}isLayerClipped(o,l){if(!this._clipLayerPresent&&o.type!=="fill-extrusion")return!1;const m=o.type==="fill-extrusion"&&o.sourceLayer==="building";if(o.is3D()){if(m||l&&l.type==="batched-model"||o.type==="model")return!0}else if(o.type==="symbol")return!0;return!1}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.fragments.forEach(o=>{o.style._remove()}),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}ba.getSourceType=function(f){return ki[f]},ba.setSourceType=function(f,o){ki[f]=o},ba.registerForPluginStateChange=r.ch;var tp=`
#define EPSILON 0.0000001
#define PI 3.141592653589793
#ifdef RENDER_CUTOFF
float cutoff_opacity(vec4 cutoff_params,float depth) {float near=cutoff_params.x;float far=cutoff_params.y;float cutoffStart=cutoff_params.z;float cutoffEnd=cutoff_params.w;float linearDepth=(depth-near)/(far-near);return clamp((linearDepth-cutoffStart)/(cutoffEnd-cutoffStart),0.0,1.0);}
#endif`,bh=`
out vec4 glFragColor;highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}
#ifdef INDICATOR_CUTOUT
uniform vec3 u_indicator_cutout_centers;uniform vec4 u_indicator_cutout_params;
#endif
vec4 applyCutout(vec4 color,float height) {
#ifdef INDICATOR_CUTOUT
float verticalFadeRange=u_indicator_cutout_centers.z*0.25;float holeMinOpacity=mix(1.0,u_indicator_cutout_params.x,smoothstep(u_indicator_cutout_centers.z,u_indicator_cutout_centers.z+verticalFadeRange,height));float holeRadius=max(u_indicator_cutout_params.y,0.0);float holeAspectRatio=u_indicator_cutout_params.z;float fadeStart=u_indicator_cutout_params.w;float distA=distance(vec2(gl_FragCoord.x,gl_FragCoord.y*holeAspectRatio),vec2(u_indicator_cutout_centers[0],u_indicator_cutout_centers[1]*holeAspectRatio));return color*min(smoothstep(fadeStart,holeRadius,distA)+holeMinOpacity,1.0);
#else
return color;
#endif
}
#ifdef DEBUG_WIREFRAME
#define HANDLE_WIREFRAME_DEBUG \\
glFragColor=vec4(0.7,0.0,0.0,0.7); \\
gl_FragDepth=gl_FragCoord.z-0.0001;
#else
#define HANDLE_WIREFRAME_DEBUG
#endif
#ifdef RENDER_CUTOFF
uniform highp vec4 u_cutoff_params;in float v_cutoff_opacity;
#endif
vec4 textureLodCustom(sampler2D image,highp vec2 pos,highp vec2 lod_coord) {highp vec2 size=vec2(textureSize(image,0));highp vec2 dx=dFdx(lod_coord.xy*size);highp vec2 dy=dFdy(lod_coord.xy*size);highp float delta_max_sqr=max(dot(dx,dx),dot(dy,dy));highp float lod=0.5*log2(delta_max_sqr);return textureLod(image,pos,lod);}vec4 applyLUT(highp sampler3D lut,vec4 col) {vec3 size=vec3(textureSize(lut,0));vec3 uvw=(col.rbg*float(size-1.0)+0.5)/size;return vec4(texture(lut,uvw).rgb,col.a);}vec3 applyLUT(highp sampler3D lut,vec3 col) {return applyLUT(lut,vec4(col,1.0)).rgb;}`,np=`
#define EXTENT 8192.0
#define RAD_TO_DEG 180.0/PI
#define DEG_TO_RAD PI/180.0
#define GLOBE_RADIUS EXTENT/PI/2.0
float wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}
#ifdef PROJECTION_GLOBE_VIEW
vec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {
#ifndef PROJECTED_POS_ON_VIEWPORT
float tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;
#else
return vec3(0.0);
#endif
}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(
unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const vec2 units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (units_to_pixels*pos+offset)/pattern_size;}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {return get_pattern_pos(pixel_coord_upper,pixel_coord_lower,pattern_size,vec2(tile_units_to_pixels),pos);}float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(PI/4.0+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}
#ifdef RENDER_CUTOFF
uniform vec4 u_cutoff_params;out float v_cutoff_opacity;
#endif
const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);const float skirtOffset=24575.0;vec3 decomposeToPosAndSkirt(vec2 posWithComposedSkirt)
{float skirt=float(posWithComposedSkirt.x >=skirtOffset);vec2 pos=posWithComposedSkirt-vec2(skirt*skirtOffset,0.0);return vec3(pos,skirt);}`,wc="in highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;out highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",rp=`
#define ELEVATION_SCALE 7.0
#define ELEVATION_OFFSET 450.0
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(
mix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}
#else
vec3 elevationVector(vec2 pos) { return vec3(0,0,1); }
#endif
#ifdef TERRAIN
uniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float currentElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem,pos).r;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(dd,0)).r;float bl=texture(u_dem,pos+vec2(0,dd)).r;float br=texture(u_dem,pos+vec2(dd,dd)).r;return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}float prevElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem_prev,pos).r;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=texture(u_dem_prev,pos).r;float tr=texture(u_dem_prev,pos+vec2(dd,0)).r;float bl=texture(u_dem_prev,pos+vec2(0,dd)).r;float br=texture(u_dem_prev,pos+vec2(dd,dd)).r;return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}
#ifdef TERRAIN_VERTEX_MORPHING
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
float nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}
#else
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
return currentElevation(apos);}
#endif
vec4 fourSample(vec2 pos,vec2 off) {float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(off.x,0.0)).r;float bl=texture(u_dem,pos+vec2(0.0,off.y)).r;float br=texture(u_dem,pos+off).r;return vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}
#else
float elevation(vec2 pos) { return 0.0; }
#endif
#ifdef DEPTH_OCCLUSION
uniform highp sampler2D u_depth;uniform highp vec2 u_depth_size_inv;uniform highp vec2 u_depth_range_unpack;uniform highp float u_occluder_half_size;uniform highp float u_occlusion_depth_offset;
#ifdef DEPTH_D24
float unpack_depth(float depth) {return depth*u_depth_range_unpack.x+u_depth_range_unpack.y;}vec4 unpack_depth4(vec4 depth) {return depth*u_depth_range_unpack.x+vec4(u_depth_range_unpack.y);}
#else
highp float unpack_depth_rgba(vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}
#endif
bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;
#ifdef DEPTH_D24
float depth=unpack_depth(texture(u_depth,(coord.xy+1.0)*0.5).r);
#else
float depth=unpack_depth_rgba(texture(u_depth,(coord.xy+1.0)*0.5));
#endif
return coord.z+u_occlusion_depth_offset > depth;}highp vec4 getCornerDepths(vec2 coord) {highp vec3 df=vec3(u_occluder_half_size*u_depth_size_inv,0.0);highp vec2 uv=0.5*coord.xy+0.5;
#ifdef DEPTH_D24
highp vec4 depth=vec4(
texture(u_depth,uv-df.xz).r,texture(u_depth,uv+df.xz).r,texture(u_depth,uv-df.zy).r,texture(u_depth,uv+df.zy).r
);depth=unpack_depth4(depth);
#else
highp vec4 depth=vec4(
unpack_depth_rgba(texture(u_depth,uv-df.xz)),unpack_depth_rgba(texture(u_depth,uv+df.xz)),unpack_depth_rgba(texture(u_depth,uv-df.zy)),unpack_depth_rgba(texture(u_depth,uv+df.zy))
);
#endif
return depth;}highp float occlusionFadeMultiSample(vec4 frag) {highp vec3 coord=frag.xyz/frag.w;highp vec2 uv=0.5*coord.xy+0.5;int NX=3;int NY=4;highp vec2 df=u_occluder_half_size*u_depth_size_inv;highp vec2 oneStep=2.0*u_occluder_half_size*u_depth_size_inv/vec2(NX-1,NY-1);highp float res=0.0;for (int y=0; y < NY;++y) {for (int x=0; x < NX;++x) {
#ifdef DEPTH_D24
highp float depth=unpack_depth(texture(u_depth,uv-df+vec2(float(x)*oneStep.x,float(y)*oneStep.y)).r);
#else
highp float depth=unpack_depth_rgba(texture(u_depth,uv-df+vec2(float(x)*oneStep.x,float(y)*oneStep.y)));
#endif
res+=1.0-clamp(300.0*(coord.z+u_occlusion_depth_offset-depth),0.0,1.0);}}res=clamp(2.0*res/float(NX*NY)-0.5,0.0,1.0);return res;}highp float occlusionFade(vec4 frag) {highp vec3 coord=frag.xyz/frag.w;highp vec4 depth=getCornerDepths(coord.xy);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z+u_occlusion_depth_offset)-depth),0.0,1.0));}
#else
bool isOccluded(vec4 frag) { return false; }highp float occlusionFade(vec4 frag) { return 1.0; }highp float occlusionFadeMultiSample(vec4 frag) { return 1.0; }
#endif//DEPTH_OCCLUSION`,Ig=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;out vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}
#endif`,lu=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump vec2 u_fog_vertical_limit;uniform mediump float u_fog_temporal_offset;in vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos,float opacity_limit) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,min(opacity,opacity_limit));}vec3 fog_apply(vec3 color,vec3 pos) {return fog_apply(color,pos,1.0);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec4 fog_apply_premultiplied(vec4 color,vec3 pos,float heightMeters) {float verticalProgress=(u_fog_vertical_limit.x > 0.0 || u_fog_vertical_limit.y > 0.0) ? smoothstep(u_fog_vertical_limit.x,u_fog_vertical_limit.y,heightMeters) : 0.0;float opacityLimit=1.0-smoothstep(0.9,1.0,fog_opacity(pos));return mix(fog_apply_premultiplied(color,pos),color,min(verticalProgress,opacityLimit));}vec3 fog_dither(vec3 color) {return color;}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}
#endif`,Xu=`#ifdef RASTER_ARRAY
uniform highp sampler2D u_image0;uniform sampler2D u_image1;const vec4 NODATA=vec4(1);ivec4 _raTexLinearCoord(highp vec2 texCoord,highp vec2 texResolution,out highp vec2 fxy) {texCoord=texCoord*texResolution-0.5;fxy=fract(texCoord);texCoord-=fxy;return ivec4(texCoord.xxyy+vec2(1.5,0.5).xyxy);}vec2 _raTexLinearMix(highp vec2 fxy,highp vec4 colorMix,highp float colorOffset,highp vec4 t00,highp vec4 t10,highp vec4 t01,highp vec4 t11) {vec2 c00=t00==NODATA ? vec2(0) : vec2(colorOffset+dot(t00,colorMix),1);vec2 c10=t10==NODATA ? vec2(0) : vec2(colorOffset+dot(t10,colorMix),1);vec2 c01=t01==NODATA ? vec2(0) : vec2(colorOffset+dot(t01,colorMix),1);vec2 c11=t11==NODATA ? vec2(0) : vec2(colorOffset+dot(t11,colorMix),1);return mix(mix(c01,c11,fxy.x),mix(c00,c10,fxy.x),fxy.y);}vec2 raTexture2D_image0_linear(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec2 fxy;ivec4 c=_raTexLinearCoord(texCoord,texResolution,fxy);return _raTexLinearMix(fxy,colorMix,colorOffset,texelFetch(u_image0,c.yz,0),texelFetch(u_image0,c.xz,0),texelFetch(u_image0,c.yw,0),texelFetch(u_image0,c.xw,0)
);}vec2 raTexture2D_image1_linear(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec2 fxy;ivec4 c=_raTexLinearCoord(texCoord,texResolution,fxy);return _raTexLinearMix(fxy,colorMix,colorOffset,texelFetch(u_image1,c.yz,0),texelFetch(u_image1,c.xz,0),texelFetch(u_image1,c.yw,0),texelFetch(u_image1,c.xw,0)
);}vec2 raTexture2D_image0_nearest(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec4 t=texelFetch(u_image0,ivec2(texCoord*texResolution),0);return t==NODATA ? vec2(0) : vec2(colorOffset+dot(t,colorMix),1);}vec2 raTexture2D_image1_nearest(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec4 t=texelFetch(u_image1,ivec2(texCoord*texResolution),0);return t==NODATA ? vec2(0) : vec2(colorOffset+dot(t,colorMix),1);}
#endif`,xh=`#ifdef RASTER_ARRAY
uniform sampler2D u_velocity;uniform mediump vec2 u_velocity_res;uniform mediump float u_max_speed;const vec4 NO_DATA=vec4(1);const vec2 INVALID_VELOCITY=vec2(-1);uniform highp vec2 u_uv_offset;uniform highp float u_data_offset;uniform highp vec2 u_data_scale;ivec4 rasterArrayLinearCoord(highp vec2 texCoord,highp vec2 texResolution,out highp vec2 fxy) {texCoord=texCoord*texResolution-0.5;fxy=fract(texCoord);texCoord-=fxy;return ivec4(texCoord.xxyy+vec2(1.5,0.5).xyxy);}highp vec2 lookup_velocity(highp vec2 uv) {uv=u_uv_offset.x+u_uv_offset.y*uv;highp vec2 fxy;ivec4 c=rasterArrayLinearCoord(uv,u_velocity_res,fxy);highp vec4 tl=texelFetch(u_velocity,c.yz,0);highp vec4 tr=texelFetch(u_velocity,c.xz,0);highp vec4 bl=texelFetch(u_velocity,c.yw,0);highp vec4 br=texelFetch(u_velocity,c.xw,0);if (tl==NO_DATA) {return INVALID_VELOCITY;}if (tr==NO_DATA) {return INVALID_VELOCITY;}if (bl==NO_DATA) {return INVALID_VELOCITY;}if (br==NO_DATA) {return INVALID_VELOCITY;}highp vec4 t=mix(mix(bl,br,fxy.x),mix(tl,tr,fxy.x),fxy.y);highp vec2 velocity=u_data_offset+vec2(dot(t.rg,u_data_scale),dot(t.ba,u_data_scale));velocity.y=-velocity.y;velocity/=max(u_max_speed,length(velocity));return velocity;}
#endif
uniform highp float u_particle_pos_scale;uniform highp vec2 u_particle_pos_offset;highp vec4 pack_pos_to_rgba(highp vec2 p) {highp vec2 v=(p+u_particle_pos_offset)/u_particle_pos_scale;highp vec4 r=vec4(v.x,fract(v.x*255.0),v.y,fract(v.y*255.0));return vec4(r.x-r.y/255.0,r.y,r.z-r.w/255.0,r.w);}highp vec2 unpack_pos_from_rgba(highp vec4 v) {v=floor(v*255.0+0.5)/255.0;highp vec2 p=vec2(v.x+(v.y/255.0),v.z+(v.w/255.0));return u_particle_pos_scale*p-u_particle_pos_offset;}`,wh=`#ifdef RENDER_SHADOWS
uniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_normal_offset;vec3 shadow_normal_offset(vec3 normal) {float tileInMeters=u_shadow_normal_offset[0];vec3 n=vec3(-normal.xy,tileInMeters*normal.z);float dotScale=min(1.0-dot(normal,u_shadow_direction),1.0)*0.5+0.5;return n*dotScale;}vec3 shadow_normal_offset_model(vec3 normal) {vec3 transformed_normal=vec3(-normal.xy,normal.z);float NDotL=dot(normalize(transformed_normal),u_shadow_direction);float dotScale=min(1.0-NDotL,1.0)*0.5+0.5;return normal*dotScale;}float shadow_normal_offset_multiplier0() {return u_shadow_normal_offset[1];}float shadow_normal_offset_multiplier1() {return u_shadow_normal_offset[2];}
#endif//RENDER_SHADOWS`,cu=`#ifdef RENDER_SHADOWS
#ifdef DEPTH_TEXTURE
uniform highp sampler2D u_shadowmap_0;uniform highp sampler2D u_shadowmap_1;
#else
uniform sampler2D u_shadowmap_0;uniform sampler2D u_shadowmap_1;
#endif
uniform float u_shadow_intensity;uniform float u_shadow_map_resolution;uniform float u_shadow_texel_size;uniform highp vec3 u_shadow_normal_offset;uniform vec2 u_fade_range;uniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_bias;highp float shadow_sample_1(highp vec2 uv,highp float compare) {highp float shadow_depth;
#ifdef DEPTH_TEXTURE
shadow_depth=texture(u_shadowmap_1,uv).r;
#else
shadow_depth=unpack_depth(texture(u_shadowmap_1,uv))*0.5+0.5;
#endif
return step(shadow_depth,compare);}highp float shadow_sample_0(highp vec2 uv,highp float compare) {highp float shadow_depth;
#ifdef DEPTH_TEXTURE
shadow_depth=texture(u_shadowmap_0,uv).r;
#else
shadow_depth=unpack_depth(texture(u_shadowmap_0,uv))*0.5+0.5;
#endif
return step(shadow_depth,compare);}float shadow_occlusion_1(highp vec4 pos,highp float bias) {highp vec2 uv=pos.xy;return shadow_sample_1(uv,pos.z-bias);}float shadow_occlusion_0(highp vec4 pos,highp float bias) {highp float compare0=pos.z-bias;
#ifdef TEXTURE_GATHER
highp vec2 uv=pos.xy;highp vec4 samples=textureGather(u_shadowmap_0,uv,0);lowp vec4 stepSamples=step(samples,vec4(compare0));
#else
highp vec2 uv00=pos.xy-vec2(0.5*u_shadow_texel_size);highp vec2 uv10=uv00+vec2(u_shadow_texel_size,0.0);highp vec2 uv01=uv00+vec2(0.0,u_shadow_texel_size);highp vec2 uv11=uv01+vec2(u_shadow_texel_size,0.0);lowp vec4 stepSamples=vec4(
shadow_sample_0(uv01,compare0),shadow_sample_0(uv11,compare0),shadow_sample_0(uv10,compare0),shadow_sample_0(uv00,compare0)
);
#endif
vec2 f=fract(pos.xy*u_shadow_map_resolution-vec2(0.5));lowp vec2 lerpx=mix(stepSamples.wx,stepSamples.zy,f.xx);return mix(lerpx.x,lerpx.y,f.y);}float shadow_occlusion(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth,highp float bias) {
#ifdef SHADOWS_SINGLE_CASCADE
light_view_pos0.xyz/=light_view_pos0.w;vec2 abs_bounds=abs(light_view_pos0.xy);if (abs_bounds.x >=1.0 || abs_bounds.y >=1.0) {return 0.0;}light_view_pos0.xyz=light_view_pos0.xyz*0.5+0.5;return shadow_occlusion_0(light_view_pos0,bias);
#else
light_view_pos0.xyz/=light_view_pos0.w;light_view_pos1.xyz/=light_view_pos1.w;vec4 uv=vec4(light_view_pos0.xy,light_view_pos1.xy);vec4 abs_bounds=abs(uv);if (abs_bounds.x < 1.0 && abs_bounds.y < 1.0) {light_view_pos0.xyz=light_view_pos0.xyz*0.5+0.5;return shadow_occlusion_0(light_view_pos0,bias);}if (abs_bounds.z >=1.0 || abs_bounds.w >=1.0) {return 0.0;}light_view_pos1.xyz=light_view_pos1.xyz*0.5+0.5;float occlusion1=shadow_occlusion_1(light_view_pos1,bias);return mix(occlusion1,0.0,smoothstep(u_fade_range.x,u_fade_range.y,view_depth));
#endif
}highp float calculate_shadow_bias(float NDotL) {
#ifdef NORMAL_OFFSET
return 0.5*u_shadow_bias.x;
#else
return 0.5*(u_shadow_bias.x+clamp(u_shadow_bias.y*tan(acos(NDotL)),0.0,u_shadow_bias.z));
#endif
}float shadowed_light_factor_normal(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=calculate_shadow_bias(NDotL);float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor_normal_opacity(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth,float shadow_opacity) {float NDotL=dot(N,u_shadow_direction);float bias=calculate_shadow_bias(NDotL);float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias)*shadow_opacity;return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor_normal_unbiased(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}highp vec2 compute_receiver_plane_depth_bias(highp vec3 pos_dx,highp vec3 pos_dy)
{highp vec2 biasUV=vec2(
pos_dy.y*pos_dx.z-pos_dx.y*pos_dy.z,pos_dx.x*pos_dy.z-pos_dy.x*pos_dx.z);biasUV*=1.0/((pos_dx.x*pos_dy.y)-(pos_dx.y*pos_dy.x));return biasUV;}float shadowed_light_factor_plane_bias(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {highp vec3 light_view_pos0_xyz=light_view_pos0.xyz/light_view_pos0.w*0.5+0.5;highp vec3 light_view_pos0_ddx=dFdx(light_view_pos0_xyz);highp vec3 light_view_pos0_ddy=dFdy(light_view_pos0_xyz);highp vec2 plane_depth_bias=compute_receiver_plane_depth_bias(light_view_pos0_ddx,light_view_pos0_ddy);highp float bias=dot(vec2(u_shadow_texel_size,u_shadow_texel_size),plane_depth_bias)+0.0001;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return 1.0-(u_shadow_intensity*occlusion);}float shadowed_light_factor(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return 1.0-(u_shadow_intensity*occlusion);}float shadow_occlusion(float ndotl,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=calculate_shadow_bias(ndotl);return shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);}
#endif`;const uu=[];du(tp,uu),du(np,uu),du(bh,uu);const Ju={"_prelude_fog.vertex.glsl":Ig,"_prelude_terrain.vertex.glsl":rp,"_prelude_shadow.vertex.glsl":wh,"_prelude_fog.fragment.glsl":lu,"_prelude_shadow.fragment.glsl":cu,"_prelude_lighting.glsl":`
#ifdef LIGHTING_3D_MODE
uniform mediump vec3 u_lighting_ambient_color;uniform mediump vec3 u_lighting_directional_dir;uniform mediump vec3 u_lighting_directional_color;uniform mediump vec3 u_ground_radiance;float calculate_ambient_directional_factor(vec3 normal) {float NdotL=dot(normal,u_lighting_directional_dir);const float factor_reduction_max=0.3;float dir_luminance=dot(u_lighting_directional_color,vec3(0.2126,0.7152,0.0722));float directional_factor_min=1.0-factor_reduction_max*min(dir_luminance,1.0);float ambient_directional_factor=mix(directional_factor_min,1.0,min((NdotL+1.0),1.0));const float vertical_factor_min=0.92;float vertical_factor=mix(vertical_factor_min,1.0,normal.z*0.5+0.5);return vertical_factor*ambient_directional_factor;}vec3 linearProduct(vec3 srgbIn,vec3 k) {return srgbIn*pow(k,vec3(1./2.2));}vec3 apply_lighting(vec3 color,vec3 normal,float dir_factor) {float ambient_directional_factor=calculate_ambient_directional_factor(normal);vec3 ambient_contrib=ambient_directional_factor*u_lighting_ambient_color;vec3 directional_contrib=u_lighting_directional_color*dir_factor;return linearProduct(color,ambient_contrib+directional_contrib);}vec4 apply_lighting(vec4 color,vec3 normal,float dir_factor) {return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting(vec3 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return apply_lighting(color.rgb,normal,dir_factor);}vec4 apply_lighting(vec4 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting_ground(vec3 color) {return color*u_ground_radiance;}vec4 apply_lighting_ground(vec4 color) {return vec4(apply_lighting_ground(color.rgb),color.a);}float calculate_NdotL(vec3 normal) {const float ext=0.70710678118;return (clamp(dot(normal,u_lighting_directional_dir),-ext,1.0)+ext)/(1.0+ext);}vec4 apply_lighting_with_emission_ground(vec4 color,float emissive_strength) {return mix(apply_lighting_ground(color),color,emissive_strength);}vec3 compute_flood_lighting(vec3 flood_light_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=flood_light_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);float occlusion_ramp=smoothstep(0.0,0.2,1.0-occlusion);return mix(fully_occluded_color,flood_light_color,occlusion_ramp);}vec3 compute_emissive_draped(vec3 unlit_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=unlit_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);return mix(fully_occluded_color,unlit_color,1.0-occlusion);}
#endif//LIGHTING_3D_MODE`,"_prelude_raster_array.glsl":Xu,"_prelude_raster_particle.glsl":xh},Sh={};Wr("",rp),Wr(lu,Ig),Wr(cu,wh),Wr(Xu,""),Wr(xh,"");const op=Wr(bh,np),Th=tp;var Qu={background:Wr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec4 u_color;uniform float u_opacity;
#ifdef LIGHTING_3D_MODE
in vec4 v_color;
#endif
void main() {vec4 out_color;
#ifdef LIGHTING_3D_MODE
out_color=v_color;
#else
out_color=u_color;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_lighting.glsl"
in vec2 a_pos;uniform mat4 u_matrix;
#ifdef LIGHTING_3D_MODE
uniform mediump vec4 u_color;out vec4 v_color;uniform float u_emissive_strength;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef LIGHTING_3D_MODE
v_color=apply_lighting_with_emission_ground(u_color,u_emissive_strength);
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),backgroundPattern:Wr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform float u_emissive_strength;uniform sampler2D u_image;in highp vec2 v_pos;void main() {highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=textureLodCustom(u_image,pos,v_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec2 u_pattern_units_to_pixels;in vec2 a_pos;out highp vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_pattern_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),circle:Wr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
in vec3 v_data;in float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
uniform float u_emissive_strength;void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float blur_positive=blur < 0.0 ? 0.0 : 1.0;lowp float antialiasblur=v_data.z;float extrude_length=length(extrude)+antialiasblur*(1.0-blur_positive);float antialiased_blur=-max(abs(blur),antialiasblur);float antialiase_blur_opacity=smoothstep(0.0,antialiasblur,extrude_length-1.0);float opacity_t=blur_positive==1.0 ? 
smoothstep(0.0,-antialiased_blur,1.0-extrude_length) : 
smoothstep(antialiased_blur,0.0,extrude_length-1.0)-antialiase_blur_opacity;float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(
antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)
);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_apply_premultiplied(out_color,v_fog_pos);
#endif
glFragColor=out_color*(v_visibility*opacity_t);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define NUM_VISIBILITY_RINGS 2
#define INV_SQRT2 0.70710678
#define ELEVATION_BIAS 0.0001
#define NUM_SAMPLES_PER_RING 16
uniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
#ifdef ELEVATED_ROADS
in float a_circle_z_offset;
#endif
out vec3 v_data;out float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
vec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {
#if defined(TERRAIN)
return elevation(pos)+ELEVATION_BIAS;
#else
return 0.0;
#endif
}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);
#ifdef PITCH_WITH_MAP
#ifdef PROJECTION_GLOBE_VIEW
return u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );
#else
return u_matrix*( world_center+vec4(sample_offset,0,0) );
#endif
#else
return projected_center+vec4(sample_offset,0,0);
#endif
}float get_sample_step() {
#ifdef PITCH_WITH_MAP
return 2.0*PI/float(NUM_SAMPLES_PER_RING);
#else
return PI/float(NUM_SAMPLES_PER_RING);
#endif
}void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);
#else 
surface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);
#endif
#ifdef ELEVATED_ROADS
world_center.z+=a_circle_z_offset+ELEVATION_BIAS;
#endif
vec4 projected_center=u_matrix*world_center;float view_scale=0.0;
#ifdef PITCH_WITH_MAP
#ifdef SCALE_WITH_MAP
view_scale=1.0;
#else
view_scale=projected_center.w/u_camera_to_center_distance;
#endif
#else
#ifdef SCALE_WITH_MAP
view_scale=u_camera_to_center_distance;
#else
view_scale=projected_center.w;
#endif
#endif
gl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;
#ifdef TERRAIN
float step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;
#ifdef PITCH_WITH_MAP
float cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;
#else
occlusion_world_center=world_center;occlusion_projected_center=projected_center;
#endif
for(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);
#else
visibility=1.0;
#endif
#ifdef PROJECTION_GLOBE_VIEW
visibility=1.0;
#endif
v_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);
#ifdef FOG
v_fog_pos=fog_position(world_center.xyz);
#endif
}`),clippingMask:Wr("void main() {glFragColor=vec4(1.0);}","in vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:Wr(`#include "_prelude_fog.fragment.glsl"
uniform highp float u_intensity;in vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);glFragColor=vec4(val,1.0,1.0,1.0);
#ifdef FOG
if (u_is_globe==0) {glFragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
out vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#else
pos=vec3(tilePos+extrude,elevation(tilePos));
#endif
gl_Position=u_matrix*vec4(pos,1);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),heatmapTexture:Wr(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));glFragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(0.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,"in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:Wr("in float v_placed;in float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);glFragColor =mix(red,blue,step(0.5,v_placed))*0.5;glFragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}",`#include "_prelude_terrain.vertex.glsl"
in vec3 a_pos;in vec2 a_anchor_pos;in vec2 a_extrude;in vec2 a_placed;in vec2 a_shift;in vec2 a_elevation_from_sea;in float a_size_scale;in vec2 a_padding;in float a_auto_z_offset;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;out float v_placed;out float v_notUsed;void main() {float feature_elevation=a_elevation_from_sea.x+a_auto_z_offset;float terrain_elevation=(a_elevation_from_sea.y==1.0 ? 0.0 : elevation(a_anchor_pos));vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*(feature_elevation+terrain_elevation),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}`),collisionCircle:Wr("in float v_radius;in vec2 v_extrude;in float v_perspective_ratio;in float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);glFragColor=color*alpha*opacity_t;}",`in vec2 a_pos_2f;in float a_radius;in vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;out float v_radius;out vec2 v_extrude;out float v_perspective_ratio;out float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(
mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}`),debug:Wr("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);glFragColor=mix(u_color,overlay_color,overlay_color.a);}",`#include "_prelude_terrain.vertex.glsl"
in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;
#endif
out vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
gl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);
#else
gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);
#endif
}`),fill:Wr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
#ifdef INDICATOR_CUTOUT
in highp float v_z_offset;
#endif
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
vec4 out_color=color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
out_color*=opacity;
#ifdef INDICATOR_CUTOUT
if (v_z_offset >=0.0) {out_color=applyCutout(out_color,v_z_offset);}
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
#ifdef INDICATOR_CUTOUT
out highp float v_z_offset;
#endif
uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp float z_offset
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#ifdef INDICATOR_CUTOUT
v_z_offset=z_offset;
#endif
}`),fillOutline:Wr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
in highp vec2 v_pos;uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
uniform mat4 u_matrix;uniform vec2 u_world;out highp vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp float z_offset
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutlinePattern:Wr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
in highp vec2 v_pos;in highp vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
out highp vec2 v_pos;out highp vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize highp float z_offset
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillPattern:Wr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;in highp vec2 v_pos;uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
out highp vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize highp float z_offset
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillExtrusion:Wr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
in vec4 v_color;in vec4 v_flat;
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;
#endif
uniform lowp float u_opacity;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;in vec2 v_ao;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
in vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
in highp vec3 v_normal;
#endif
uniform vec3 u_flood_light_color;uniform highp float u_vertical_scale;uniform float u_flood_light_intensity;uniform vec3 u_ground_shadow_factor;
#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)
in float v_flood_radius;in float v_has_floodlight;
#endif
in float v_height;
#pragma mapbox: define highp float emissive_strength
void main() {
#pragma mapbox: initialize highp float emissive_strength
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
vec3 normal=normalize(v_normal);
#endif
float z;vec4 color=v_color;
#ifdef ZERO_ROOF_RADIUS
z=float(normal.z > 0.00001);
#ifdef LIGHTING_3D_MODE
normal=mix(normal,vec3(0.0,0.0,1.0),z);
#else
color=mix(v_color,v_roof_color,z);
#endif
#endif
float h=max(0.0,v_height);float ao_shade=1.0;
#ifdef FAUX_AO
float intensity=u_ao[0];float h_floors=h/(u_ao[1]*u_vertical_scale);float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);ao_shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;
#ifdef ZERO_ROOF_RADIUS
concave*=(1.0-z);
#endif
float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);ao_shade*=mix(1.0,x_shade*x_shade*x_shade,concave);
#ifdef LIGHTING_3D_MODE
#ifdef FLOOD_LIGHT
color.rgb*=mix(ao_shade,1.0,v_has_floodlight);
#else
color.rgb*=ao_shade;
#endif
#else
color.rgb*=ao_shade;
#endif
#endif
#ifdef LIGHTING_3D_MODE
float flood_radiance=0.0;
#ifdef FLOOD_LIGHT
flood_radiance=(1.0-min(h/v_flood_radius,1.0))*u_flood_light_intensity*v_has_floodlight;
#endif
#ifdef RENDER_SHADOWS
#ifdef FLOOD_LIGHT
float ndotl_unclamped=dot(normal,u_shadow_direction);float ndotl=max(0.0,ndotl_unclamped);float occlusion=ndotl_unclamped < 0.0 ? 1.0 : shadow_occlusion(ndotl,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);vec3 litColor=apply_lighting(color.rgb,normal,(1.0-u_shadow_intensity*occlusion)*ndotl);vec3 floodLitColor=compute_flood_lighting(u_flood_light_color*u_opacity,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=mix(litColor,floodLitColor,flood_radiance);
#else
float shadowed_lighting_factor;
#ifdef RENDER_CUTOFF
shadowed_lighting_factor=shadowed_light_factor_normal_opacity(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w,v_cutoff_opacity);if (v_cutoff_opacity==0.0) {discard;}
#else
shadowed_lighting_factor=shadowed_light_factor_normal(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);
#endif
color.rgb=apply_lighting(color.rgb,normal,shadowed_lighting_factor);
#endif
#else
color.rgb=apply_lighting(color.rgb,normal);
#ifdef FLOOD_LIGHT
color.rgb=mix(color.rgb,u_flood_light_color*u_opacity,flood_radiance);
#endif
#endif
color.rgb=mix(color.rgb,v_flat.rgb,emissive_strength);color*=u_opacity;
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos,h));
#endif
#ifdef INDICATOR_CUTOUT
color=applyCutout(color,h);
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#include "_prelude_lighting.glsl"
uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;uniform float u_width_scale;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef RENDER_WALL_MODE
in vec3 a_join_normal_inside;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
#ifdef TERRAIN
uniform int u_height_type;uniform int u_base_type;
#endif
uniform highp float u_vertical_scale;out vec4 v_color;out vec4 v_flat;
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
out vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
out highp vec3 v_normal;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;out vec2 v_ao;
#endif
#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)
out float v_flood_radius;out float v_has_floodlight;
#endif
out float v_height;vec3 linearTosRGB(vec3 color) {return pow(color,vec3(1./2.2));}vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
#pragma mapbox: define highp float flood_light_wall_radius
#pragma mapbox: define highp float line_width
#pragma mapbox: define highp float emissive_strength
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize highp float flood_light_wall_radius
#pragma mapbox: initialize highp float line_width
#pragma mapbox: initialize highp float emissive_strength
base*=u_vertical_scale;height*=u_vertical_scale;vec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
v_normal=normal;
#endif
base=max(0.0,base);float attr_height=height;height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=0.0;float c_ele=0.0;vec3 pos;
#ifdef TERRAIN
bool is_flat_height=centroid_pos.x !=0.0 && u_height_type==1;bool is_flat_base=centroid_pos.x !=0.0 && u_base_type==1;ele=elevation(pos_nx.xy);c_ele=is_flat_height || is_flat_base ? (centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos)) : ele;float h_height=is_flat_height ? max(c_ele+height,ele+base+2.0) : ele+height;float h_base=is_flat_base ? max(c_ele+base,ele+base) : ele+(base==0.0 ?-5.0 : base);h=t > 0.0 ? max(h_base,h_height) : h_base;pos=vec3(pos_nx.xy,h);
#else
h=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float cutoff=1.0;vec3 scaled_pos=pos;
#ifdef RENDER_CUTOFF
vec3 centroid_random=vec3(centroid_pos.xy,centroid_pos.x+centroid_pos.y+1.0);vec3 ground_pos=centroid_pos.x==0.0 ? pos.xyz : (centroid_random/8.0);vec4 ground=u_matrix*vec4(ground_pos.xy,ele,1.0);cutoff=cutoff_opacity(u_cutoff_params,ground.z);if (centroid_pos.y !=0.0 && centroid_pos.x !=0.0) {vec3 g=floor(ground_pos);vec3 mod_=centroid_random-g*8.0;float seed=min(1.0,0.1*(min(3.5,max(mod_.x+mod_.y,0.2*attr_height))*0.35+mod_.z));if (cutoff < 0.8-seed) {cutoff=0.0;}}float cutoff_scale=cutoff;v_cutoff_opacity=cutoff;scaled_pos.z=mix(c_ele,h,cutoff_scale);
#endif
float hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (cutoff==0.0 && centroid_pos.x !=0.0) || (color.a==0.0));
#ifdef RENDER_WALL_MODE
vec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);scaled_pos.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;scaled_pos.xy-=a_join_normal_inside.z*wall_offset*0.5;
#endif
gl_Position=mix(u_matrix*vec4(scaled_pos,1),AWAY,hidden);h=h-ele;v_height=h;
#ifdef RENDER_SHADOWS
vec3 shd_pos0=pos;vec3 shd_pos1=pos;
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(normal);shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);
#endif
float NdotL=0.0;float colorvalue=0.0;
#ifndef LIGHTING_3D_MODE
colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);if (normal.y !=0.0) {float r=0.84;r=mix(0.7,0.98,1.0-u_lightintensity);NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#endif
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec2(mix(concave,-concave,start),y_ground);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
#ifdef FLOOD_LIGHT
float is_wall=1.0-float(t > 0.0 && top_up_ny.y > 0.0);v_has_floodlight=float(flood_light_wall_radius > 0.0 && is_wall > 0.0);v_flood_radius=flood_light_wall_radius*u_vertical_scale;
#endif
v_color=vec4(color.rgb,1.0);float ndotl=calculate_NdotL(normal);v_flat.rgb=sRGBToLinear(color.rgb);v_flat.rgb=v_flat.rgb*(ndotl+(1.0-min(ndotl*57.29,1.0))*emissive_strength);v_flat=vec4(linearTosRGB(v_flat.rgb),1.0);
#else
v_color=vec4(0.0,0.0,0.0,1.0);v_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_color*=u_opacity;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
float roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color=vec4(0.0,0.0,0.0,1.0);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_roof_color*=u_opacity;
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),fillExtrusionDepth:Wr(`in highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
glFragColor=pack_depth(v_depth);
#endif
}`,`#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;uniform float u_edge_radius;uniform float u_width_scale;uniform float u_vertical_scale;
#ifdef TERRAIN
uniform int u_height_type;uniform int u_base_type;
#endif
in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef RENDER_WALL_MODE
in vec3 a_join_normal_inside;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp float line_width
#pragma mapbox: define highp vec4 color
out highp float v_depth;void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp float line_width
#pragma mapbox: initialize highp vec4 color
base*=u_vertical_scale;height*=u_vertical_scale;vec3 pos_nx=floor(a_pos_normal_ed.xyz*0.5);mediump vec3 top_up_ny=a_pos_normal_ed.xyz-2.0*pos_nx;base=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
vec3 pos;
#ifdef TERRAIN
bool is_flat_height=centroid_pos.x !=0.0 && u_height_type==1;bool is_flat_base=centroid_pos.x !=0.0 && u_base_type==1;float ele=elevation(pos_nx.xy);float c_ele=is_flat_height || is_flat_base ? (centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos)) : ele;float h_height=is_flat_height ? max(c_ele+height,ele+base+2.0) : ele+height;float h_base=is_flat_base ? max(c_ele+base,ele+base) : ele+(base==0.0 ?-5.0 : base);float h=t > 0.0 ? max(h_base,h_height) : h_base;pos=vec3(pos_nx.xy,h);
#else
pos=vec3(pos_nx.xy,t > 0.0 ? height : base);
#endif
#ifdef RENDER_WALL_MODE
vec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);pos.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;pos.xy-=a_join_normal_inside.z*wall_offset*0.5;
#endif
float hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (color.a==0.0));gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);v_depth=gl_Position.z/gl_Position.w;}`),fillExtrusionPattern:Wr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;in vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
in vec3 v_normal;
#endif
in highp vec2 v_pos;in vec4 v_lighting;uniform lowp float u_opacity;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define highp float pixel_ratio
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize highp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color,normalize(v_normal))*u_opacity;
#else
out_color=out_color*v_lighting;
#endif
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color,height);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#include "_prelude_lighting.glsl"
uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_width_scale;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef RENDER_WALL_MODE
in vec3 a_join_normal_inside;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
#ifdef TERRAIN
uniform int u_height_type;uniform int u_base_type;
#endif
out highp vec2 v_pos;out vec4 v_lighting;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;out vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
out vec3 v_normal;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define highp float pixel_ratio
#pragma mapbox: define highp float line_width
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize highp float pixel_ratio
#pragma mapbox: initialize highp float line_width
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=z;vec3 p;float c_ele;
#ifdef TERRAIN
bool is_flat_height=centroid_pos.x !=0.0 && u_height_type==1;bool is_flat_base=centroid_pos.x !=0.0 && u_base_type==1;ele=elevation(pos_nx.xy);c_ele=is_flat_height || is_flat_base ? (centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos)) : ele;float h_height=is_flat_height ? max(c_ele+height,ele+base+2.0) : ele+height;float h_base=is_flat_base ? max(c_ele+base,ele+base) : ele+(base==0.0 ?-5.0 : base);h=t > 0.0 ? max(h_base,h_height) : h_base;p=vec3(pos_nx.xy,h);
#else
p=vec3(pos_nx.xy,z);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
#ifdef RENDER_WALL_MODE
vec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);p.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;p.xy-=a_join_normal_inside.z*wall_offset*0.5;
#endif
float hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (color.a==0.0));gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0
? pos_nx.xy
: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;
#ifdef LIGHTING_3D_MODE
NdotL=calculate_NdotL(normal);
#else
NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);
#endif
if (normal.y !=0.0) {float r=0.84;
#ifndef LIGHTING_3D_MODE
r=mix(0.7,0.98,1.0-u_lightintensity);
#endif
NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
v_normal=normal;
#else
v_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;
#endif 
#ifdef FOG
v_fog_pos=fog_position(p);
#endif
}`),groundShadow:Wr(`#include "_prelude_shadow.fragment.glsl"
precision highp float;uniform vec3 u_ground_shadow_factor;in vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;
#ifdef FOG
in float v_fog_opacity;
#endif
void main() {float light=shadowed_light_factor_plane_bias(v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);vec3 shadow=mix(u_ground_shadow_factor,vec3(1.0),light);
#ifdef RENDER_CUTOFF
shadow=mix(vec3(1.0),shadow,cutoff_opacity(u_cutoff_params,1.0/gl_FragCoord.w));
#endif
#ifdef FOG
shadow=mix(shadow,vec3(1.0),v_fog_opacity);
#endif
#ifdef INDICATOR_CUTOUT
shadow=mix(shadow,vec3(1.0),1.0-applyCutout(vec4(1.0),0.0).r);
#endif
glFragColor=vec4(shadow,1.0);}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;in vec2 a_pos;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;
#ifdef FOG
out float v_fog_opacity;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0.0,1.0);v_pos_light_view_0=u_light_matrix_0*vec4(a_pos,0.0,1.0);v_pos_light_view_1=u_light_matrix_1*vec4(a_pos,0.0,1.0);
#ifdef FOG
v_fog_pos=fog_position(a_pos);v_fog_opacity=fog(v_fog_pos);
#endif
}`),fillExtrusionGroundEffect:Wr(`uniform highp float u_ao_pass;uniform highp float u_opacity;uniform highp float u_flood_light_intensity;uniform highp vec3 u_flood_light_color;uniform highp float u_attenuation;uniform sampler2D u_fb;uniform float u_fb_size;
#ifdef SDF_SUBPASS
in highp vec2 v_pos;in highp vec4 v_line_segment;in highp float v_flood_light_radius_tile;in highp vec2 v_ao;float line_df(highp vec2 a,highp vec2 b,highp vec2 p) {highp vec2 ba=b-a;highp vec2 pa=p-a;highp float r=clamp(dot(pa,ba)/dot(ba,ba),0.0,1.0);return length(pa-r*ba);}
#ifdef FOG
in highp float v_fog;
#endif
#endif
void main() {
#ifdef CLEAR_SUBPASS
vec4 color=vec4(1.0);
#ifdef CLEAR_FROM_TEXTURE
color=texture(u_fb,gl_FragCoord.xy/vec2(u_fb_size));
#endif
glFragColor=color;
#else
#ifdef SDF_SUBPASS
highp float d=line_df(v_line_segment.xy,v_line_segment.zw,v_pos);highp float effect_radius=mix(v_flood_light_radius_tile,v_ao.y,u_ao_pass);d/=effect_radius;d=min(d,1.0);d=1.0-pow(1.0-d,u_attenuation);highp float effect_intensity=mix(u_flood_light_intensity,v_ao.x,u_ao_pass);highp float fog=1.0;
#ifdef FOG
fog=v_fog;
#endif
#ifdef RENDER_CUTOFF
fog*=v_cutoff_opacity;
#endif
glFragColor=vec4(vec3(0.0),mix(1.0,d,effect_intensity*u_opacity*fog));
#else
vec4 color=mix(vec4(u_flood_light_color,1.0),vec4(vec3(0.0),1.0),u_ao_pass);
#ifdef OVERDRAW_INSPECTOR
color=vec4(1.0);
#endif
glFragColor=color;
#endif
HANDLE_WIREFRAME_DEBUG;
#endif
}`,`#include "_prelude_fog.vertex.glsl"
in highp vec4 a_pos_end;in highp float a_angular_offset_factor;in highp float a_hidden_by_landmark;
#ifdef SDF_SUBPASS
out highp vec2 v_pos;out highp vec4 v_line_segment;out highp float v_flood_light_radius_tile;out highp vec2 v_ao;
#ifdef FOG
out highp float v_fog;
#endif
#endif
uniform highp float u_flood_light_intensity;uniform highp mat4 u_matrix;uniform highp float u_ao_pass;uniform highp float u_meter_to_tile;uniform highp float u_edge_radius;uniform highp float u_dynamic_offset;uniform highp vec2 u_ao;
#pragma mapbox: define highp float flood_light_ground_radius
const float TANGENT_CUTOFF=4.0;const float NORM=32767.0;void main() {
#pragma mapbox: initialize highp float flood_light_ground_radius
vec2 p=a_pos_end.xy;vec2 q=floor(a_pos_end.zw*0.5);vec2 start_bottom=a_pos_end.zw-q*2.0;float fl_ground_radius=flood_light_ground_radius;fl_ground_radius=abs(flood_light_ground_radius);float direction=flood_light_ground_radius < 0.0 ?-1.0 : 1.0;float flood_radius_tile=fl_ground_radius*u_meter_to_tile;vec2 v=normalize(q-p);float ao_radius=u_ao.y/3.5;float effect_radius=mix(flood_radius_tile,ao_radius,u_ao_pass)+u_edge_radius;float angular_offset_factor=a_angular_offset_factor/NORM*TANGENT_CUTOFF;float angular_offset=direction*angular_offset_factor*effect_radius;float top=1.0-start_bottom.y;float side=(0.5-start_bottom.x)*2.0;vec2 extrusion_parallel=v*side*mix(u_dynamic_offset,angular_offset,top);vec2 perp=vec2(v.y,-v.x);vec2 extrusion_perp=direction*perp*effect_radius*top;vec3 pos=vec3(mix(q,p,start_bottom.x),0.0);pos.xy+=extrusion_parallel+extrusion_perp;
#ifdef SDF_SUBPASS
v_pos=pos.xy;v_line_segment=vec4(p,q)+perp.xyxy*u_edge_radius;v_flood_light_radius_tile=flood_radius_tile;v_ao=vec2(u_ao.x,ao_radius);
#ifdef FOG
v_fog_pos=fog_position(pos);v_fog=1.0-fog(v_fog_pos);
#endif
#endif
float hidden_by_landmark=0.0;
#ifdef HAS_CENTROID
hidden_by_landmark=a_hidden_by_landmark;
#endif
float isFloodlit=float(fl_ground_radius > 0.0 && u_flood_light_intensity > 0.0);float hidden=mix(1.0-isFloodlit,isFloodlit,u_ao_pass);hidden+=hidden_by_landmark;gl_Position=mix(u_matrix*vec4(pos,1.0),AWAY,float(hidden > 0.0));
#ifdef RENDER_CUTOFF
v_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);
#endif
}`),hillshadePrepare:Wr(`precision highp float;uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;float getElevation(vec2 coord) {return texture(u_image,coord).r/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(
(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)
)/pow(2.0,exaggeration+(19.2562-u_zoom));glFragColor=clamp(vec4(
deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Wr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;uniform float u_emissive_strength;void main() {vec4 pixel=texture(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);glFragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef LIGHTING_3D_MODE
glFragColor=apply_lighting_with_emission_ground(glFragColor,u_emissive_strength);
#endif
#ifdef FOG
glFragColor=fog_dither(fog_apply_premultiplied(glFragColor,v_fog_pos));
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),line:Wr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform lowp float u_device_pixel_ratio;uniform highp float u_width_scale;uniform highp float u_floor_width_scale;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;uniform highp vec2 u_trim_fade_range;uniform lowp vec4 u_trim_color;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec3 v_uv;
#ifdef ELEVATED_ROADS
in highp float v_road_z_offset;
#endif
#ifdef RENDER_LINE_DASH
uniform sampler2D u_dash_image;in vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform sampler2D u_gradient_image;
#endif
#ifdef INDICATOR_CUTOUT
in highp float v_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
float luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}uniform float u_emissive_strength;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float border_width
#pragma mapbox: define lowp vec4 border_color
float linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float border_width
#pragma mapbox: initialize lowp vec4 border_color
float dist=length(v_normal)*v_width2.s;float blur2=(u_width_scale*blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);
#ifdef RENDER_LINE_DASH
float sdfdist=texture(u_dash_image,v_tex).r;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;float scaled_floorwidth=(floorwidth*u_floor_width_scale);alpha*=linearstep(0.5-sdfgamma/scaled_floorwidth,0.5+sdfgamma/scaled_floorwidth,sdfdist);
#endif
highp vec4 out_color;
#ifdef RENDER_LINE_GRADIENT
out_color=texture(u_gradient_image,v_uv.xy);
#else
out_color=color;
#endif
float trim_alpha=1.0;
#ifdef RENDER_LINE_TRIM_OFFSET
highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=v_uv[2];if (trim_end > trim_start) {highp float start_transition=max(0.0,min(1.0,(line_progress-trim_start)/max(u_trim_fade_range[0],1.0e-9)));highp float end_transition=max(0.0,min(1.0,(trim_end-line_progress)/max(u_trim_fade_range[1],1.0e-9)));highp float transition_factor=min(start_transition,end_transition);out_color=mix(out_color,u_trim_color,transition_factor);trim_alpha=1.0-transition_factor;}
#endif
if (u_alpha_discard_threshold !=0.0) {if (alpha < u_alpha_discard_threshold) {discard;}}
#ifdef RENDER_LINE_BORDER
float edgeBlur=((border_width*u_width_scale)+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);if (border_color.a==0.0) {float Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}} else {out_color=mix(border_color*trim_alpha,out_color,smoothAlpha);}}
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);
#ifdef ELEVATED_ROADS
out_color.rgb*=mix(v_road_z_offset > 0.0 ? u_ground_shadow_factor : vec3(1.0),vec3(1.0),light);
#else
out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
out_color*=(alpha*opacity);
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color,v_z_offset);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define EXTRUDE_SCALE 0.015873016
in vec2 a_pos_normal;in vec4 a_data;
#if defined(ELEVATED) || defined(ELEVATED_ROADS) || defined(VARIABLE_LINE_WIDTH)
in vec3 a_z_offset_width;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
in highp vec3 a_packed;
#endif
#ifdef RENDER_LINE_DASH
in float a_linesofar;
#endif
uniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;uniform float u_width_scale;uniform highp float u_floor_width_scale;
#ifdef ELEVATED
uniform lowp float u_zbias_factor;uniform lowp float u_tile_to_meter;float sample_elevation(vec2 apos) {
#ifdef ELEVATION_REFERENCE_SEA
return 0.0;
#else
return elevation(apos);
#endif
}
#endif
out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec3 v_uv;
#ifdef ELEVATED_ROADS
out highp float v_road_z_offset;
#endif
#ifdef RENDER_LINE_DASH
uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;out vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform float u_image_height;
#endif
#ifdef INDICATOR_CUTOUT
out highp float v_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float border_width
#pragma mapbox: define lowp vec4 border_color
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float border_width
#pragma mapbox: initialize lowp vec4 border_color
float a_z_offset;
#if defined(ELEVATED) || defined(ELEVATED_ROADS)
a_z_offset=a_z_offset_width.x;
#endif
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth;
#ifdef VARIABLE_LINE_WIDTH
float left=a_pos_normal.y-2.0*floor(a_pos_normal.y*0.5);halfwidth=(u_width_scale*(left==1.0 ? a_z_offset_width.y : a_z_offset_width.z))/2.0;
#else
halfwidth=(u_width_scale*width)/2.0;
#endif
offset=-1.0*offset*u_width_scale;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);float hidden=float(opacity==0.0);vec2 extrude=dist*u_pixels_to_tile_units;vec4 projected_extrude=u_matrix*vec4(extrude,0.0,0.0);vec2 projected_extrude_xy=projected_extrude.xy;
#ifdef ELEVATED_ROADS
v_road_z_offset=a_z_offset;gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,a_z_offset,1.0)+projected_extrude;
#else
#ifdef ELEVATED
vec2 offsetTile=offset2*u_pixels_to_tile_units;vec2 offset_pos=pos+offsetTile;float ele=0.0;
#ifdef CROSS_SLOPE_VERTICAL
float top=a_pos_normal.y-2.0*floor(a_pos_normal.y*0.5);float line_height=2.0*u_tile_to_meter*outset*top*u_pixels_to_tile_units[1][1]+a_z_offset;ele=sample_elevation(offset_pos)+line_height;projected_extrude=vec4(0);
#else
#ifdef CROSS_SLOPE_HORIZONTAL
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,max(ele1,ele2));ele=ele_max+a_z_offset;
#else
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,0.5*(ele1+ele2));ele=ele_max-ele0+ele1+a_z_offset;
#endif
#endif
gl_Position=u_matrix*vec4(offset_pos,ele,1.0)+projected_extrude;float z=clamp(gl_Position.z/gl_Position.w,0.5,1.0);float zbias=max(0.00005,(pow(z,0.8)-z)*u_zbias_factor*u_exaggeration);gl_Position.z-=(gl_Position.w*zbias);gl_Position=mix(gl_Position,AWAY,hidden);
#else
gl_Position=mix(u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude,AWAY,hidden);
#endif
#endif
#ifdef ELEVATED_ROADS
#ifdef RENDER_SHADOWS
vec3 shd_pos=vec3(pos+(offset2+dist)*u_pixels_to_tile_units,a_z_offset);vec3 shd_pos0=shd_pos;vec3 shd_pos1=shd_pos;
#ifdef NORMAL_OFFSET
vec3 shd_pos_offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=shd_pos_offset*shadow_normal_offset_multiplier0();shd_pos1+=shd_pos_offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#endif
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude_xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=mix(extrude_length_without_perspective/extrude_length_with_perspective,1.0,step(0.01,blur));
#else
v_gamma_scale=1.0;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
highp float a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float line_progress=a_packed[2];
#ifdef RENDER_LINE_GRADIENT
highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec3(a_uv_x,a_split_index*texel_height-half_texel_height,line_progress);
#else
v_uv=vec3(a_uv_x,0.0,line_progress);
#endif
#endif
#ifdef RENDER_LINE_DASH
float scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/(floorwidth*u_floor_width_scale),(-normal.y*height+dash.x+0.5)/u_texsize.y);
#endif
v_width2=vec2(outset,inset);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
#ifdef INDICATOR_CUTOUT
v_z_offset=a_z_offset;
#endif
}`),linePattern:Wr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform highp float u_device_pixel_ratio;uniform highp float u_width_scale;uniform highp float u_alpha_discard_threshold;uniform highp vec2 u_texsize;uniform highp float u_tile_units_to_pixels;uniform highp vec2 u_trim_offset;uniform highp vec2 u_trim_fade_range;uniform lowp vec4 u_trim_color;uniform sampler2D u_image;in vec2 v_normal;in vec2 v_width2;in highp float v_linesofar;in float v_gamma_scale;in float v_width;
#ifdef RENDER_LINE_TRIM_OFFSET
in highp vec3 v_uv;
#endif
#ifdef ELEVATED_ROADS
in highp float v_road_z_offset;
#endif
#ifdef LINE_JOIN_NONE
in vec2 v_pattern_data;
#endif
#ifdef INDICATOR_CUTOUT
in highp float v_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
uniform float u_emissive_strength;
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define mediump float pixel_ratio
#pragma mapbox: define mediump float blur
#pragma mapbox: define mediump float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize mediump float pixel_ratio
#pragma mapbox: initialize mediump float blur
#pragma mapbox: initialize mediump float opacity
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;highp float pattern_size=display_size.x/u_tile_units_to_pixels;float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(u_width_scale*blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);highp float pattern_x=v_linesofar/pattern_size*aspect;highp float x=mod(pattern_x,1.0);highp float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;highp vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));highp vec2 lod_pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(pattern_x,y));vec4 color=textureLodCustom(u_image,pos,lod_pos);
#ifdef RENDER_LINE_TRIM_OFFSET
highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=v_uv[2];if (trim_end > trim_start) {highp float start_transition=max(0.0,min(1.0,(line_progress-trim_start)/max(u_trim_fade_range[0],1.0e-9)));highp float end_transition=max(0.0,min(1.0,(trim_end-line_progress)/max(u_trim_fade_range[1],1.0e-9)));highp float transition_factor=min(start_transition,end_transition);color=mix(color,color.a*u_trim_color,transition_factor);}
#endif
#ifdef LINE_JOIN_NONE
highp float pattern_len=pattern_size/aspect;highp float segment_phase=pattern_len-mod(v_linesofar-v_pattern_data.x+pattern_len,pattern_len);highp float visible_start=segment_phase-step(pattern_len*0.5,segment_phase)*pattern_len;highp float visible_end=floor((v_pattern_data.y-segment_phase)/pattern_len)*pattern_len+segment_phase;visible_end+=step(pattern_len*0.5,v_pattern_data.y-visible_end)*pattern_len;if (v_pattern_data.x < visible_start || v_pattern_data.x >=visible_end) {color=vec4(0.0);}
#endif
#ifdef LIGHTING_3D_MODE
color=apply_lighting_with_emission_ground(color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);
#ifdef ELEVATED_ROADS
color.rgb*=mix(v_road_z_offset > 0.0 ? u_ground_shadow_factor : vec3(1.0),vec3(1.0),light);
#else
color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
color*=(alpha*opacity);if (u_alpha_discard_threshold !=0.0) {if (color.a < u_alpha_discard_threshold) {discard;}}
#ifdef INDICATOR_CUTOUT
color=applyCutout(color,v_z_offset);
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;
#if defined(ELEVATED) || defined(ELEVATED_ROADS)
in vec3 a_z_offset_width;
#endif
#ifdef RENDER_LINE_TRIM_OFFSET
in highp vec3 a_packed;
#endif
in highp float a_linesofar;
#ifdef LINE_JOIN_NONE
in highp vec3 a_pattern_data;out vec2 v_pattern_data;
#endif
#ifdef INDICATOR_CUTOUT
out highp float v_z_offset;
#endif
uniform mat4 u_matrix;uniform float u_tile_units_to_pixels;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform float u_device_pixel_ratio;uniform float u_width_scale;uniform float u_floor_width_scale;
#ifdef ELEVATED
uniform lowp float u_zbias_factor;uniform lowp float u_tile_to_meter;float sample_elevation(vec2 apos) {
#ifdef ELEVATION_REFERENCE_SEA
return 0.0;
#else
return elevation(apos);
#endif
}
#endif
out vec2 v_normal;out vec2 v_width2;out highp float v_linesofar;out float v_gamma_scale;out float v_width;
#ifdef RENDER_LINE_TRIM_OFFSET
out highp vec3 v_uv;
#endif
#ifdef ELEVATED_ROADS
out highp float v_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
#pragma mapbox: define mediump float blur
#pragma mapbox: define mediump float opacity
#pragma mapbox: define mediump float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define mediump float floorwidth
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define mediump float pixel_ratio
void main() {
#pragma mapbox: initialize mediump float blur
#pragma mapbox: initialize mediump float opacity
#pragma mapbox: initialize mediump float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize mediump float floorwidth
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize mediump float pixel_ratio
float a_z_offset;
#if defined(ELEVATED) || defined(ELEVATED_ROADS)
a_z_offset=a_z_offset_width.x;
#endif
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=(u_width_scale*width)/2.0;offset=-1.0*offset*u_width_scale;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);vec2 dist=outset*a_extrude*scale;float u=0.5*a_direction;float t=1.0-abs(u);vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float hidden=float(opacity==0.0);vec2 extrude=dist*u_pixels_to_tile_units;vec4 projected_extrude=u_matrix*vec4(extrude,0.0,0.0);vec2 projected_extrude_xy=projected_extrude.xy;
#ifdef ELEVATED_ROADS
v_road_z_offset=a_z_offset;gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,a_z_offset,1.0)+projected_extrude;
#else
#ifdef ELEVATED
vec2 offsetTile=offset2*u_pixels_to_tile_units;vec2 offset_pos=pos+offsetTile;float ele=0.0;
#ifdef CROSS_SLOPE_VERTICAL
float top=a_pos_normal.y-2.0*floor(a_pos_normal.y*0.5);float line_height=2.0*u_tile_to_meter*outset*top*u_pixels_to_tile_units[1][1]+a_z_offset;ele=sample_elevation(offset_pos)+line_height;projected_extrude=vec4(0);
#else
#ifdef CROSS_SLOPE_HORIZONTAL
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,max(ele1,ele2));ele=ele_max+a_z_offset;
#else
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,0.5*(ele1+ele2));ele=ele_max-ele0+ele1+a_z_offset;
#endif
#endif
gl_Position=u_matrix*vec4(offset_pos,ele,1.0)+projected_extrude;float z=clamp(gl_Position.z/gl_Position.w,0.5,1.0);float zbias=max(0.00005,(pow(z,0.8)-z)*u_zbias_factor*u_exaggeration);gl_Position.z-=(gl_Position.w*zbias);gl_Position=mix(gl_Position,AWAY,hidden);
#else
gl_Position=mix(u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude,AWAY,hidden);
#endif
#endif
#ifdef ELEVATED_ROADS
#ifdef RENDER_SHADOWS
vec3 shd_pos=vec3(pos+(offset2+dist)*u_pixels_to_tile_units,a_z_offset);vec3 shd_pos0=shd_pos;vec3 shd_pos1=shd_pos;
#ifdef NORMAL_OFFSET
vec3 shd_pos_offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=shd_pos_offset*shadow_normal_offset_multiplier0();shd_pos1+=shd_pos_offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#endif
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude_xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=mix(extrude_length_without_perspective/extrude_length_with_perspective,1.0,step(0.01,blur));
#else
v_gamma_scale=1.0;
#endif
#ifdef RENDER_LINE_TRIM_OFFSET
highp float a_uv_x=a_packed[0];highp float line_progress=a_packed[2];v_uv=vec3(a_uv_x,0.0,line_progress);
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=(floorwidth*u_floor_width_scale);
#ifdef LINE_JOIN_NONE
v_width=(floorwidth*u_floor_width_scale)+ANTIALIASING;mediump float pixels_to_tile_units=1.0/u_tile_units_to_pixels;mediump float pixel_ratio_inverse=1.0/pixel_ratio;mediump float aspect=v_width/((pattern.w-pattern.y)*pixel_ratio_inverse);highp float subt_multiple=(pattern.z-pattern.x)*pixel_ratio_inverse*pixels_to_tile_units*aspect*32.0;highp float subt=floor(a_pattern_data.z/subt_multiple)*subt_multiple;float offset_sign=(fract(a_pattern_data.x)-0.5)*4.0;float line_progress_offset=offset_sign*v_width*0.5*pixels_to_tile_units;v_linesofar=(a_pattern_data.z-subt)+a_linesofar+line_progress_offset;v_pattern_data=vec2(a_pattern_data.x+line_progress_offset,a_pattern_data.y);
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
#ifdef INDICATOR_CUTOUT
v_z_offset=a_z_offset;
#endif
}`),raster:Wr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_raster_array.glsl"
uniform float u_fade_t;uniform float u_opacity;uniform highp float u_raster_elevation;uniform highp float u_zoom_transition;in vec2 v_pos0;in vec2 v_pos1;in float v_depth;
#ifdef PROJECTION_GLOBE_VIEW
in float v_split_fade;
#endif
uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;uniform float u_emissive_strength;
#ifndef RASTER_ARRAY
uniform highp sampler2D u_image0;uniform sampler2D u_image1;
#endif
#ifdef RASTER_COLOR
uniform sampler2D u_color_ramp;uniform highp vec4 u_colorization_mix;uniform highp float u_colorization_offset;uniform vec2 u_texture_res;
#endif
void main() {vec4 color0,color1,color;vec2 value;
#ifdef RASTER_COLOR
#ifdef RASTER_ARRAY
#ifdef RASTER_ARRAY_LINEAR
value=mix(
raTexture2D_image0_linear(v_pos0,u_texture_res,u_colorization_mix,u_colorization_offset),raTexture2D_image1_linear(v_pos1,u_texture_res,u_colorization_mix,u_colorization_offset),u_fade_t
);
#else
value=mix(
raTexture2D_image0_nearest(v_pos0,u_texture_res,u_colorization_mix,u_colorization_offset),raTexture2D_image1_nearest(v_pos1,u_texture_res,u_colorization_mix,u_colorization_offset),u_fade_t
);
#endif
if (value.y > 0.0) value.x/=value.y;
#else
color=mix(texture(u_image0,v_pos0),texture(u_image1,v_pos1),u_fade_t);value=vec2(u_colorization_offset+dot(color.rgb,u_colorization_mix.rgb),color.a);
#endif
color=texture(u_color_ramp,vec2(value.x,0.5));if (color.a > 0.0) color.rgb/=color.a;color.a*=value.y;
#else
color0=texture(u_image0,v_pos0);color1=texture(u_image1,v_pos1);if (color0.a > 0.0) color0.rgb/=color0.a;if (color1.a > 0.0) color1.rgb/=color1.a;color=mix(color0,color1,u_fade_t);
#endif
color.a*=u_opacity;
#ifdef GLOBE_POLES
color.a*=1.0-smoothstep(0.0,0.05,u_zoom_transition);
#endif
vec3 rgb=color.rgb;rgb=vec3(
dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(vec4(out_color,1.0),u_emissive_strength).rgb;
#endif
#ifdef FOG
highp float fog_limit_high_meters=1000000.0;highp float fog_limit_low_meters=600000.0;float fog_limit=1.0-smoothstep(fog_limit_low_meters,fog_limit_high_meters,u_raster_elevation);out_color=fog_dither(fog_apply(out_color,v_fog_pos,fog_limit));
#endif
glFragColor=vec4(out_color*color.a,color.a);
#ifdef PROJECTION_GLOBE_VIEW
glFragColor*=mix(1.0,1.0-smoothstep(0.0,0.05,u_zoom_transition),smoothstep(0.8,0.9,v_split_fade));
#endif
#ifdef RENDER_CUTOFF
glFragColor=glFragColor*cutoff_opacity(u_cutoff_params,v_depth);
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform mat3 u_grid_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;uniform vec2 u_texture_offset;uniform float u_raster_elevation;uniform float u_zoom_transition;uniform vec2 u_merc_center;
#define GLOBE_UPSCALE GLOBE_RADIUS/6371008.8
#ifdef GLOBE_POLES
in vec3 a_globe_pos;in vec2 a_uv;
#else
in vec2 a_pos;in vec2 a_texture_pos;
#endif
out vec2 v_pos0;out vec2 v_pos1;out float v_depth;
#ifdef PROJECTION_GLOBE_VIEW
out float v_split_fade;
#endif
void main() {vec2 uv;
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;gl_Position=u_matrix*u_globe_matrix*vec4(globe_pos   ,1.0);uv=a_uv;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(a_globe_pos,1.0)).xyz);
#endif
#else
float w=1.0+dot(a_texture_pos,u_perspective_transform);uv=a_texture_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);vec3 globe_pos=latLngToECEF(latLng.xy);globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);float mercatorY=mercatorYfromLat(latLng[0]);float mercatorX=mercatorXfromLng(latLng[1]);    
v_split_fade=0.0;if (u_zoom_transition > 0.0) {vec2 merc_pos=vec2(mercatorX,mercatorY);merc_world_pos=vec4(merc_pos,u_raster_elevation,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;float opposite_merc_center=mod(u_merc_center.x+0.5,1.0);float dist_from_poles=(abs(mercatorY-0.5)*2.0);float range=0.1;v_split_fade=abs(opposite_merc_center-mercatorX);v_split_fade=clamp(1.0-v_split_fade,0.0,1.0);v_split_fade=max(smoothstep(1.0-range,1.0,dist_from_poles),max(smoothstep(1.0-range,1.0,v_split_fade),smoothstep(1.0-range,1.0,1.0-v_split_fade)));}float tiles=u_grid_matrix[0][2];if (tiles > 0.0) {float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];float uvY=mercatorY*tiles-idy;float uvX=mercatorX*tiles-idx;uv=vec2(uvX,uvY);}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition)*w,w);gl_Position=u_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
#else
gl_Position=u_matrix*vec4(a_pos*w,u_raster_elevation*w,w);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#endif
#endif
v_pos0=uv;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;v_pos0=u_texture_offset.x+u_texture_offset.y*v_pos0;v_pos1=u_texture_offset.x+u_texture_offset.y*v_pos1;
#ifdef RENDER_CUTOFF
v_depth=gl_Position.z;
#endif
}`),rasterParticle:Wr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform float u_fade_t;uniform float u_opacity;uniform highp float u_raster_elevation;in vec2 v_pos0;in vec2 v_pos1;uniform sampler2D u_image0;uniform sampler2D u_image1;void main() {vec4 color0,color1,color;color0=texture(u_image0,v_pos0);color1=texture(u_image1,v_pos1);if (color0.a > 0.0) color0.rgb/=color0.a;if (color1.a > 0.0) color1.rgb/=color1.a;color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 out_color=color.rgb;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(vec4(out_color,1.0),0.0).rgb;
#endif
#ifdef FOG
highp float fog_limit_high_meters=1000000.0;highp float fog_limit_low_meters=600000.0;float fog_limit=1.0-smoothstep(fog_limit_low_meters,fog_limit_high_meters,u_raster_elevation);out_color=fog_dither(fog_apply(out_color,v_fog_pos,fog_limit));
#endif
glFragColor=vec4(out_color*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform mat3 u_grid_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_raster_elevation;uniform float u_zoom_transition;uniform vec2 u_merc_center;
#define GLOBE_UPSCALE GLOBE_RADIUS/6371008.8
in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {float w=1.0;vec2 uv;
#ifdef PROJECTION_GLOBE_VIEW
vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float mercatorX=mercatorXfromLng(latLng[1]);float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];float uvX=mercatorX*tiles-idx;float uvY=mercatorY*tiles-idy;uv=vec2(uvX,uvY);vec3 globe_pos=latLngToECEF(latLng.xy);globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {vec2 merc_pos=vec2(mercatorX,mercatorY);merc_world_pos=vec4(merc_pos,u_raster_elevation,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition)*w,w);gl_Position=u_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
#else
uv=a_texture_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*w,u_raster_elevation*w,w);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#endif
v_pos0=uv;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}`),rasterParticleDraw:Wr("uniform sampler2D u_color_ramp;in float v_particle_speed;void main() {glFragColor=texture(u_color_ramp,vec2(v_particle_speed,0.5));}",`#include "_prelude_raster_particle.glsl"
in float a_index;uniform sampler2D u_particle_texture;uniform float u_particle_texture_side_len;uniform vec2 u_tile_offset;out float v_particle_speed;void main() {ivec2 pixel_coord=ivec2(
mod(a_index,u_particle_texture_side_len),a_index/u_particle_texture_side_len);vec4 pixel=texelFetch(u_particle_texture,pixel_coord,0);vec2 pos=unpack_pos_from_rgba(pixel)+u_tile_offset;vec2 tex_coord=fract(pos);vec2 velocity=lookup_velocity(tex_coord);if (velocity==INVALID_VELOCITY) {gl_Position=AWAY;v_particle_speed=0.0;} else {gl_Position=vec4(2.0*pos-1.0,0,1);v_particle_speed=length(velocity);}gl_PointSize=1.0;}`),rasterParticleTexture:Wr("uniform sampler2D u_texture;uniform float u_opacity;in vec2 v_tex_pos;void main() {vec4 color=texture(u_texture,v_tex_pos);glFragColor=vec4(floor(255.0*color*u_opacity)/255.0);}","in vec2 a_pos;out vec2 v_tex_pos;void main() {vec2 uv=0.5*a_pos+vec2(0.5);v_tex_pos=uv;gl_Position=vec4(a_pos,0.0,1.0);}"),rasterParticleUpdate:Wr(`#include "_prelude_raster_particle.glsl"
uniform sampler2D u_particle_texture;uniform mediump float u_particle_texture_side_len;uniform mediump float u_speed_factor;uniform highp float u_reset_rate;uniform highp float u_rand_seed;in highp vec2 v_tex_coord;vec2 linearstep(vec2 edge0,vec2 edge1,vec2 x) {return  clamp((x-edge0)/(edge1-edge0),vec2(0),vec2(1));}const highp vec3 rand_constants=vec3(12.9898,78.233,4375.85453);highp float rand(const highp vec2 co) {highp float t=dot(rand_constants.xy,co);return fract(sin(t)*(rand_constants.z+t));}void main() {ivec2 pixel_coord=ivec2(v_tex_coord*u_particle_texture_side_len);highp vec4 pixel=texelFetch(u_particle_texture,pixel_coord,0);highp vec2 pos=unpack_pos_from_rgba(pixel);highp vec2 velocity=lookup_velocity(clamp(pos,0.0,1.0));highp vec2 dp=velocity==INVALID_VELOCITY ? vec2(0) : velocity*u_speed_factor;pos=pos+dp;highp vec2 seed=(pos+v_tex_coord)*u_rand_seed;highp vec2 random_pos=vec2(rand(seed+1.3),rand(seed+2.1));highp vec2 persist_rate=pow(
linearstep(vec2(-u_particle_pos_offset),vec2(0),pos)*linearstep(vec2(1.0+u_particle_pos_offset),vec2(1),pos),vec2(4)
);highp vec2 per_frame_persist=pow(persist_rate,abs(dp)/u_particle_pos_offset);highp float drop_rate=1.0-per_frame_persist.x*per_frame_persist.y;drop_rate=any(greaterThanEqual(abs(pos-0.5),vec2(0.5+u_particle_pos_offset))) ? 1.0 : drop_rate;highp float drop=step(1.0-drop_rate-u_reset_rate,rand(seed));highp vec2 next_pos=mix(pos,random_pos,drop);glFragColor=pack_pos_to_rgba(next_pos);}`,"in vec2 a_pos;out vec2 v_tex_coord;void main() {v_tex_coord=0.5*(a_pos+vec2(1.0));gl_Position=vec4(a_pos,0.0,1.0);}"),symbol:Wr(`#include "_prelude_lighting.glsl"
#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;uniform bool u_is_halo;uniform lowp float u_scale_factor;
#ifdef ICON_TRANSITION
uniform float u_icon_transition;
#endif
#ifdef COLOR_ADJUSTMENT
uniform mat4 u_color_adj_mat;
#endif
#ifdef INDICATOR_CUTOUT
in highp float v_z_offset;
#endif
in vec2 v_tex_a;
#ifdef ICON_TRANSITION
in vec2 v_tex_b;
#endif
in float v_draw_halo;in vec3 v_gamma_scale_size_fade_opacity;
#ifdef RENDER_TEXT_AND_SYMBOL
in float is_sdf;in vec2 v_tex_a_icon;
#endif
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
vec4 out_color;float fade_opacity=v_gamma_scale_size_fade_opacity[2];
#ifdef RENDER_TEXT_AND_SYMBOL
if (is_sdf==ICON) {vec2 tex_icon=v_tex_a_icon;lowp float alpha=opacity*fade_opacity;glFragColor=texture(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
return;}
#endif
#ifdef RENDER_SDF
float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_gamma_scale_size_fade_opacity.x;float size=v_gamma_scale_size_fade_opacity.y;float fontScale=u_is_text ? size/24.0 : size;out_color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;bool draw_halo=v_draw_halo > 0.0;if (draw_halo) {out_color=halo_color;gamma=(halo_blur*u_scale_factor*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width*u_scale_factor/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,v_tex_a).r;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);out_color*=alpha;
#else
#ifdef ICON_TRANSITION
vec4 a=texture(u_texture,v_tex_a)*(1.0-u_icon_transition);vec4 b=texture(u_texture,v_tex_b)*u_icon_transition;out_color=(a+b);
#else
out_color=texture(u_texture,v_tex_a);
#endif
#ifdef COLOR_ADJUSTMENT
out_color=u_color_adj_mat*out_color;
#endif
#endif
out_color*=opacity*fade_opacity;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,emissive_strength);
#endif
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color,v_z_offset);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
in vec4 a_pos_offset;in vec4 a_tex_size;in vec4 a_pixeloffset;in vec4 a_projected_pos;in float a_fade_opacity;
#ifdef Z_OFFSET
in float a_auto_z_offset;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_globe_anchor;in vec3 a_globe_normal;
#endif
#ifdef ICON_TRANSITION
in vec2 a_texb;
#endif
#ifdef OCCLUSION_QUERIES
in float a_occlusion_query_opacity;
#endif
#ifdef INDICATOR_CUTOUT
out highp float v_z_offset;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_elevation_from_sea;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;uniform bool u_is_halo;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
out vec2 v_tex_a;
#ifdef ICON_TRANSITION
out vec2 v_tex_b;
#endif
out float v_draw_halo;out vec3 v_gamma_scale_size_fade_opacity;
#ifdef RENDER_TEXT_AND_SYMBOL
out float is_sdf;out vec2 v_tex_a_icon;
#endif
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
#pragma mapbox: define lowp float occlusion_opacity
#pragma mapbox: define lowp float z_offset
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
#pragma mapbox: initialize lowp float occlusion_opacity
#pragma mapbox: initialize lowp float z_offset
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;float e=u_elevation_from_sea ? z_offset : z_offset+elevation(tile_anchor);
#ifdef Z_OFFSET
e+=a_auto_z_offset;
#endif
vec3 h=elevationVector(tile_anchor)*e;float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;vec3 world_pos_globe;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos_globe=a_globe_anchor+h;world_pos=mix_globe_mercator(world_pos_globe,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;vec2 a;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);vec4 projected_point_globe=u_matrix*vec4(world_pos_globe,1);a=projected_point_globe.xy/projected_point_globe.w;
#else
offsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);a=projected_point.xy/projected_point.w;
#endif
vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
#ifdef PROJECTED_POS_ON_VIEWPORT
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xyz+h,1.0);
#else
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz,mercator_pos,u_zoom_transition)+h;projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);    
#endif
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
#ifdef Z_OFFSET
z+=u_pitch_with_map ? a_auto_z_offset+(u_elevation_from_sea ? z_offset : z_offset) : 0.0;
#else
z+=u_pitch_with_map ? (u_elevation_from_sea ? z_offset : z_offset) : 0.0;
#endif
float occlusion_fade=globe_occlusion_fade;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float out_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));
#ifdef DEPTH_OCCLUSION
float depth_occlusion=occlusionFadeMultiSample(projected_point);float depth_occlusion_multplier=mix(occlusion_opacity,1.0,depth_occlusion);out_fade_opacity*=depth_occlusion_multplier;
#endif
#ifdef OCCLUSION_QUERIES
float occludedFadeMultiplier=mix(occlusion_opacity,1.0,a_occlusion_query_opacity);out_fade_opacity*=occludedFadeMultiplier;
#endif
float alpha=opacity*out_fade_opacity;float hidden=float(alpha==0.0 || projected_point.w <=0.0 || occlusion_fade==0.0);
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,hidden);
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,hidden);
#endif
float gamma_scale=gl_Position.w;v_draw_halo=(u_is_halo && float(gl_InstanceID)==0.0) ? 1.0 : 0.0;v_gamma_scale_size_fade_opacity=vec3(gamma_scale,size,out_fade_opacity);v_tex_a=a_tex/u_texsize;
#ifdef RENDER_TEXT_AND_SYMBOL
is_sdf=a_size[0]-2.0*a_size_min;v_tex_a_icon=a_tex/u_texsize_icon;
#endif
#ifdef ICON_TRANSITION
v_tex_b=a_texb/u_texsize;
#endif
#ifdef INDICATOR_CUTOUT
v_z_offset=e;
#endif
}`),terrainRaster:Wr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image0;in vec2 v_pos0;
#ifdef FOG
in float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
in vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;
#endif
uniform vec3 u_ground_shadow_factor;void main() {vec4 image_color=texture(u_image0,v_pos0);vec4 color;
#ifdef LIGHTING_3D_MODE
const vec3 normal=vec3(0.0,0.0,1.0);
#ifdef RENDER_SHADOWS
float cutoffOpacity=1.0;
#ifdef RENDER_CUTOFF
cutoffOpacity=cutoff_opacity(u_cutoff_params,1.0/gl_FragCoord.w);
#endif
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
vec3 unlit_base=image_color.rgb*(1.0-image_color.a);vec3 emissive_base=image_color.rgb*image_color.a;float ndotl=u_shadow_direction.z;float occlusion=ndotl < 0.0 ? 1.0 : shadow_occlusion(v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w,0.0);ndotl=max(0.0,ndotl);vec3 lit=apply_lighting(unlit_base,normal,mix(1.0,(1.0-(u_shadow_intensity*occlusion))*ndotl,cutoffOpacity));vec3 emissive=compute_emissive_draped(emissive_base,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=lit+emissive;color.a=1.0;
#else
float lighting_factor=shadowed_light_factor_normal_unbiased(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);color=apply_lighting(image_color,normal,mix(1.0,lighting_factor,cutoffOpacity));
#endif
#else
float lighting_factor=u_lighting_directional_dir.z;color=apply_lighting(image_color,normal,lighting_factor);
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
color.rgb=mix(color.rgb,image_color.rgb,image_color.a);color.a=1.0;
#endif
#endif
#else
color=image_color;
#endif
#ifdef FOG
#ifdef ZERO_EXAGGERATION
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#else
color=fog_dither(fog_apply_from_vert(color,v_fog_opacity));
#endif
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;uniform float u_skirt_height;in vec2 a_pos;out vec2 v_pos0;
#ifdef FOG
out float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;out float v_depth;
#endif
void main() {vec3 decomposedPosAndSkirt=decomposeToPosAndSkirt(a_pos);float skirt=decomposedPosAndSkirt.z;vec2 decodedPos=decomposedPosAndSkirt.xy;float elevation=elevation(decodedPos)-skirt*u_skirt_height;v_pos0=decodedPos/8192.0;gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);
#ifdef FOG
#ifdef ZERO_EXAGGERATION
v_fog_pos=fog_position(decodedPos);
#else
v_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));
#endif
#endif
#ifdef RENDER_SHADOWS
vec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);
#endif
}`),terrainDepth:Wr("precision highp float;in float v_depth;void main() {glFragColor=pack_depth(v_depth);}",`#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;in vec2 a_pos;out float v_depth;void main() {float elevation=elevation(a_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}`),skybox:Wr(`#include "_prelude_fog.fragment.glsl"
in lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(
cos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=texture(u_cubemap,uv).rgb;
#ifdef FOG
sky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);
#endif
sky_color+=0.1*sun_disk(v_uv,u_sun_direction);glFragColor=vec4(sky_color*u_opacity,u_opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,wc),skyboxGradient:Wr(`#include "_prelude_fog.fragment.glsl"
in highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture(u_color_ramp,vec2(progress,0.5));
#ifdef FOG
color.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;
#endif
color*=u_opacity;glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,wc),skyboxCapture:Wr(`
in highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;precision highp float;
#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)
#define BETA_M                  vec3(21e-6,21e-6,21e-6)
#define MIE_G                   0.76
#define DENSITY_HEIGHT_SCALE_R  8000.0
#define DENSITY_HEIGHT_SCALE_M  1200.0
#define PLANET_RADIUS           6360e3
#define ATMOSPHERE_RADIUS       6420e3
#define SAMPLE_STEPS            10
#define DENSITY_STEPS           4
float ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;glFragColor=vec4(color,1.0);}`,"in highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;out highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:Wr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image0;uniform float u_far_z_cutoff;in vec2 v_pos0;
#ifndef FOG
uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;
#endif
void main() {vec4 color;
#ifdef CUSTOM_ANTIALIASING
highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;highp float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);highp float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture(u_image0,v_pos0);
#ifdef LIGHTING_3D_MODE
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
raster=apply_lighting_with_emission_ground(raster,raster.a);color=vec4(clamp(raster.rgb,vec3(0),vec3(1))*antialias,antialias);
#else
raster=apply_lighting_ground(raster);color=vec4(raster.rgb*antialias,raster.a*antialias);
#endif
#else
color=vec4(raster.rgb*antialias,raster.a*antialias);
#endif
#else
color=texture(u_image0,v_pos0);
#ifdef LIGHTING_3D_MODE
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
color=apply_lighting_with_emission_ground(color,color.a);color.a=1.0;
#else
color=apply_lighting_ground(color);
#endif
#endif
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
color*=1.0-step(u_far_z_cutoff,1.0/gl_FragCoord.w);glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;uniform float u_skirt_height;
#ifdef GLOBE_POLES
in vec3 a_globe_pos;in vec2 a_uv;
#else
in vec2 a_pos;
#endif
out vec2 v_pos0;void main() {
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;vec2 uv=a_uv;
#else
float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);
#endif
v_pos0=uv;vec2 tile_pos=uv*EXTENT;vec3 globe_derived_up_vector=normalize(globe_pos)*u_tile_up_scale;
#ifdef GLOBE_POLES
vec3 up_vector=globe_derived_up_vector;
#else
vec3 up_vector=elevationVector(tile_pos);
#endif
float height=elevation(tile_pos);globe_pos+=up_vector*height;
#ifndef GLOBE_POLES
globe_pos-=globe_derived_up_vector*u_skirt_height*decomposed_pos_and_skirt.z;
#endif
#ifdef GLOBE_POLES
vec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);
#else
vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height-u_skirt_height*decomposed_pos_and_skirt.z,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);
#endif
gl_Position=u_proj_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
}`),globeAtmosphere:Wr(`#include "_prelude_fog.fragment.glsl"
uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec4 u_color;uniform vec4 u_high_color;uniform vec4 u_space_color;uniform float u_horizon_angle;in highp vec3 v_ray_dir;in highp vec3 v_horizon_dir;void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;
#ifdef PROJECTION_GLOBE_VIEW
globe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {
#ifdef ALPHA_PASS
glFragColor=vec4(0,0,0,0);return;
#else
#ifdef NATIVE
glFragColor=vec4(1,1,1,1);
#else
glFragColor=vec4(0,0,0,1);
#endif
return;
#endif
}
#endif
highp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?
0.0 : max(acos(clamp(dot(dir,horizon_dir),-1.0,1.0)),0.0);float horizon_angle;
#ifdef PROJECTION_GLOBE_VIEW
highp vec3 closest_point=globe_pos_dot_dir*dir;highp float closest_point_to_center=length(closest_point-u_globe_pos);highp float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?
PI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);
#else
horizon_angle=horizon_angle_mercator;
#endif
horizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;
#ifdef ALPHA_PASS
float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);glFragColor=vec4(1.0,1.0,1.0,a);
#else
vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c=c2;glFragColor=vec4(c*t,t);
#endif
}`,`in vec3 a_pos;in vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;out highp vec3 v_ray_dir;out highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(
mix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}`),model:Wr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform float u_opacity;uniform vec3 u_lightcolor;uniform vec3 u_lightpos;uniform float u_lightintensity;uniform vec4 u_baseColorFactor;uniform vec4 u_emissiveFactor;uniform float u_metallicFactor;uniform float u_roughnessFactor;uniform float u_emissive_strength;in highp vec4 v_position_height;in lowp vec4 v_color_mix;
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in float v_depth_shadows;
#endif
#ifdef OCCLUSION_TEXTURE_TRANSFORM
uniform vec4 u_occlusionTextureTransform;
#endif
#pragma mapbox: define-attribute highp vec3 normal_3f
#pragma mapbox: define-attribute highp vec3 color_3f
#pragma mapbox: define-attribute highp vec4 color_4f
#pragma mapbox: define-attribute highp vec2 uv_2f
#pragma mapbox: initialize-attribute highp vec3 normal_3f
#pragma mapbox: initialize-attribute highp vec3 color_3f
#pragma mapbox: initialize-attribute highp vec4 color_4f
#pragma mapbox: initialize-attribute highp vec2 uv_2f
#ifdef HAS_ATTRIBUTE_a_pbr
in lowp vec4 v_roughness_metallic_emissive_alpha;in mediump vec4 v_height_based_emission_params;
#endif
#ifdef HAS_TEXTURE_u_baseColorTexture
uniform sampler2D u_baseColorTexture;uniform bool u_baseTextureIsAlpha;uniform bool u_alphaMask;uniform float u_alphaCutoff;
#endif
#ifdef HAS_TEXTURE_u_metallicRoughnessTexture
uniform sampler2D u_metallicRoughnessTexture;
#endif
#ifdef HAS_TEXTURE_u_occlusionTexture
uniform sampler2D u_occlusionTexture;uniform float u_aoIntensity;
#endif
#ifdef HAS_TEXTURE_u_normalTexture
uniform sampler2D u_normalTexture;
#endif
#ifdef HAS_TEXTURE_u_emissionTexture
uniform sampler2D u_emissionTexture;
#endif
#ifdef APPLY_LUT_ON_GPU
uniform highp sampler3D u_lutTexture;
#endif
#ifdef TERRAIN_FRAGMENT_OCCLUSION
in highp float v_depth;uniform highp sampler2D u_depthTexture;uniform highp vec2 u_inv_depth_size;uniform highp vec2 u_depth_range_unpack;
#ifdef DEPTH_D24
highp float unpack_depth(highp float depth) {return  depth*u_depth_range_unpack.x+u_depth_range_unpack.y;}
#else
highp float unpack_depth_rgba(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}
#endif
bool isOccluded() {highp vec2 coord=gl_FragCoord.xy*u_inv_depth_size;
#ifdef DEPTH_D24
highp float depth=unpack_depth(texture(u_depthTexture,coord).r);
#else
highp float depth=unpack_depth_rgba(texture(u_depthTexture,coord));
#endif
return v_depth > depth+0.0005;}
#endif
#define saturate(_x) clamp(_x,0.,1.)
vec3 linearTosRGB(vec3 color) {return pow(color,vec3(1./2.2));}vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}float calculate_NdotL(vec3 normal,vec3 lightDir) {const float ext=0.70710678118;return (clamp(dot(normal,lightDir),-ext,1.0)+ext)/(1.0+ext);}vec3 getDiffuseShadedColor(vec3 albedo,vec3 normal,vec3 lightDir,vec3 lightColor)
{
#ifdef LIGHTING_3D_MODE
vec3 transformed_normal=vec3(-normal.xy,normal.z);float lighting_factor;
#ifdef RENDER_SHADOWS
lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
lighting_factor=saturate(dot(transformed_normal,u_lighting_directional_dir));
#endif
return apply_lighting(albedo,transformed_normal,lighting_factor);
#else
vec3 n=normal;float colorvalue=((albedo.x*0.2126)+(albedo.y*0.7152))+(albedo.z*0.0722);vec3 c=vec3(0.03,0.03,0.03);float directional=clamp(dot(n,vec3(lightDir)),0.0,1.0);directional=mix(1.0-u_lightintensity,max((1.0-colorvalue)+u_lightintensity,1.0),directional);vec3 c3=c+clamp((albedo*directional)*lightColor,mix(vec3(0.0),vec3(0.3),vec3(1.0)-lightColor),vec3(1.0));return c3;
#endif
}vec4 getBaseColor() {vec4 albedo=u_baseColorFactor;
#ifdef HAS_ATTRIBUTE_a_color_3f
albedo*=vec4(color_3f,1.0);
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
#else
#ifdef HAS_ATTRIBUTE_a_color_4f
albedo*=color_4f;
#endif
#endif
#if defined (HAS_TEXTURE_u_baseColorTexture) && defined (HAS_ATTRIBUTE_a_uv_2f)
vec4 texColor=texture(u_baseColorTexture,uv_2f);if(u_alphaMask) {if (texColor.w < u_alphaCutoff) {discard;}}
#ifdef UNPREMULT_TEXTURE_IN_SHADER
if(texColor.w > 0.0) {texColor.rgb/=texColor.w;}texColor.w=1.0;
#endif
if(u_baseTextureIsAlpha) {if (texColor.r < 0.5) {discard;}} else {texColor.rgb=sRGBToLinear(texColor.rgb);albedo*=texColor;}
#endif
vec4 color=vec4(mix(albedo.rgb,v_color_mix.rgb,v_color_mix.a),albedo.a);
#ifdef APPLY_LUT_ON_GPU
color=applyLUT(u_lutTexture,color);
#endif
return color;}highp mat3 cotangentFrame(highp vec3 N,highp vec3 p,highp vec2 uv ) {
#ifdef HAS_TEXTURE_u_normalTexture
highp vec3 dp1=vec3(dFdx(p.x),dFdx(p.y),dFdx(p.z));highp vec3 dp2=vec3(dFdy(p.x),dFdy(p.y),dFdy(p.z));highp vec2 duv1=vec2(dFdx(uv.x),dFdx(uv.y));highp vec2 duv2=vec2(dFdy(uv.x),dFdy(uv.y));highp vec3 dp2perp=cross( dp2,N );highp vec3 dp1perp=cross( N,dp1 );highp vec3 T=dp2perp*duv1.x+dp1perp*duv2.x;highp vec3 B=dp2perp*duv1.y+dp1perp*duv2.y;highp float lengthT=dot(T,T);highp float lengthB=dot(B,B);highp float maxLength=max(lengthT,lengthB);highp float invmax=inversesqrt( maxLength );highp mat3 res=mat3( T*invmax,B*invmax,N );return res;
#else
return mat3(1.0);
#endif
}highp vec3 getNormal(){highp vec3 n;
#ifdef HAS_ATTRIBUTE_a_normal_3f
n=normalize(normal_3f);
#else
highp vec3 fdx=vec3(dFdx(v_position_height.x),dFdx(v_position_height.y),dFdx(v_position_height.z));highp vec3 fdy=vec3(dFdy(v_position_height.x),dFdy(v_position_height.y),dFdy(v_position_height.z));n=normalize(cross(fdx,fdy))*-1.0;
#endif
#if defined(HAS_TEXTURE_u_normalTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
vec3 nMap=texture( u_normalTexture,uv_2f).xyz;nMap=normalize(2.0*nMap-vec3(1.0));highp vec3 v=normalize(-v_position_height.xyz);highp mat3 TBN=cotangentFrame(n,v,uv_2f);n=normalize(TBN*nMap);
#endif
return n;}struct Material {float perceptualRoughness;float alphaRoughness;float metallic;vec3 f90;vec4 baseColor;vec3 diffuseColor;vec3 specularColor;highp vec3 normal;};Material getPBRMaterial() {Material mat;mat.baseColor=getBaseColor();mat.perceptualRoughness=u_roughnessFactor;mat.metallic=u_metallicFactor;
#ifdef HAS_ATTRIBUTE_a_pbr
mat.perceptualRoughness=v_roughness_metallic_emissive_alpha.x;mat.metallic=v_roughness_metallic_emissive_alpha.y;mat.baseColor.w*=v_roughness_metallic_emissive_alpha.w;
#endif
#if defined(HAS_TEXTURE_u_metallicRoughnessTexture) && defined(HAS_ATTRIBUTE_a_uv_2f) 
vec4 mrSample=texture(u_metallicRoughnessTexture,uv_2f);mat.perceptualRoughness*=mrSample.g;mat.metallic*=mrSample.b;
#endif
const float c_minRoughness=0.04;mat.perceptualRoughness=clamp(mat.perceptualRoughness,c_minRoughness,1.0);mat.metallic=saturate(mat.metallic);mat.alphaRoughness=mat.perceptualRoughness*mat.perceptualRoughness;const vec3 f0=vec3(0.04);mat.diffuseColor=mat.baseColor.rgb*(vec3(1.0)-f0);mat.diffuseColor*=1.0-mat.metallic;mat.specularColor=mix(f0,mat.baseColor.rgb,mat.metallic);highp float reflectance=max(max(mat.specularColor.r,mat.specularColor.g),mat.specularColor.b);highp float reflectance90=saturate(reflectance*25.0);mat.f90=vec3(reflectance90);mat.normal=getNormal();return mat;}float V_GGX(float NdotL,float NdotV,float roughness)
{float a2=roughness*roughness;float GGXV=NdotL*sqrt(NdotV*NdotV*(1.0-a2)+a2);float GGXL=NdotV*sqrt(NdotL*NdotL*(1.0-a2)+a2);return 0.5/(GGXV+GGXL);}float V_GGXFast(float NdotL,float NdotV,float roughness) {float a=roughness;float GGXV=NdotL*(NdotV*(1.0-a)+a);float GGXL=NdotV*(NdotL*(1.0-a)+a);return 0.5/(GGXV+GGXL);}vec3 F_Schlick(vec3 specularColor,vec3 f90,float VdotH)
{return specularColor+(f90-specularColor)*pow(clamp(1.0-VdotH,0.0,1.0),5.0);}vec3 F_SchlickFast(vec3 specularColor,float VdotH)
{float x=1.0-VdotH;float x4=x*x*x*x;return specularColor+(1.0-specularColor)*x4*x;}float D_GGX(highp float NdotH,float alphaRoughness)
{highp float a4=alphaRoughness*alphaRoughness;highp float f=(NdotH*a4-NdotH)*NdotH+1.0;return a4/(PI*f*f);}vec3 diffuseBurley(Material mat,float LdotH,float NdotL,float NdotV)
{float f90=2.0*LdotH*LdotH*mat.alphaRoughness-0.5;return (mat.diffuseColor/PI)*(1.0+f90*pow((1.0-NdotL),5.0))*(1.0+f90*pow((1.0-NdotV),5.0));}vec3 diffuseLambertian(Material mat)
{
#ifdef LIGHTING_3D_MODE
return mat.diffuseColor;
#else
return mat.diffuseColor/PI;
#endif
}vec3 EnvBRDFApprox(vec3 specularColor,float roughness,highp float NdotV)
{vec4 c0=vec4(-1,-0.0275,-0.572,0.022);vec4 c1=vec4(1,0.0425,1.04,-0.04);highp vec4 r=roughness*c0+c1;highp float a004=min(r.x*r.x,exp2(-9.28*NdotV))*r.x+r.y;vec2 AB=vec2(-1.04,1.04)*a004+r.zw;return specularColor*AB.x+AB.y;}vec3 computeIndirectLightContribution(Material mat,float NdotV,vec3 normal)
{vec3 env_light=vec3(0.65,0.65,0.65);
#ifdef LIGHTING_3D_MODE
float ambient_factor=calculate_ambient_directional_factor(normal);env_light=u_lighting_ambient_color*ambient_factor;
#endif
vec3 envBRDF=EnvBRDFApprox(mat.specularColor,mat.perceptualRoughness,NdotV);vec3 indirectSpecular= envBRDF*env_light;vec3 indirectDiffuse=mat.diffuseColor*env_light;return indirectSpecular+indirectDiffuse;}vec3 computeLightContribution(Material mat,vec3 lightPosition,vec3 lightColor)
{highp vec3 n=mat.normal;highp vec3 v=normalize(-v_position_height.xyz);highp vec3 l=normalize(lightPosition);highp vec3 h=normalize(v+l);float NdotV=clamp(abs(dot(n,v)),0.001,1.0);float NdotL=saturate(dot(n,l));highp float NdotH=saturate(dot(n,h));float VdotH=saturate(dot(v,h));vec3 f=F_SchlickFast(mat.specularColor,VdotH);float g=V_GGXFast(NdotL,NdotV,mat.alphaRoughness);float d=D_GGX(NdotH,mat.alphaRoughness);vec3 diffuseTerm=(1.0-f)*diffuseLambertian(mat);vec3 specularTerm=f*g*d;vec3 transformed_normal=vec3(-n.xy,n.z);float lighting_factor;
#ifdef RENDER_SHADOWS
lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
lighting_factor=NdotL;
#endif
vec3 directLightColor=(specularTerm+diffuseTerm)*lighting_factor*lightColor;vec3 indirectLightColor=computeIndirectLightContribution(mat,NdotV,transformed_normal);vec3 color=(saturate(directLightColor)+indirectLightColor);float intensityFactor=1.0;
#if !defined(LIGHTING_3D_MODE)
const vec3 luminosityFactor=vec3(0.2126,0.7152,0.0722);float luminance=dot(diffuseTerm,luminosityFactor);intensityFactor=mix((1.0-u_lightintensity),max((1.0-luminance+u_lightintensity),1.0),NdotL);
#endif
color*=intensityFactor;return color;}void main() {
#ifdef TERRAIN_FRAGMENT_OCCLUSION
if (isOccluded()) {discard;}
#endif
vec3 lightDir=u_lightpos;vec3 lightColor=u_lightcolor;
#ifdef LIGHTING_3D_MODE
lightDir=u_lighting_directional_dir;lightDir.xy=-lightDir.xy;lightColor=u_lighting_directional_color;
#endif
vec4 finalColor;
#ifdef DIFFUSE_SHADED
vec3 N=getNormal();vec3 baseColor=getBaseColor().rgb;vec3 diffuse=getDiffuseShadedColor(baseColor,N,lightDir,lightColor);
#ifdef HAS_TEXTURE_u_occlusionTexture
float ao=(texture(u_occlusionTexture,uv_2f).r-1.0)*u_aoIntensity+1.0;diffuse*=ao;
#endif
finalColor=vec4(mix(diffuse,baseColor,u_emissive_strength),1.0)*u_opacity;
#else
Material mat=getPBRMaterial();vec3 color=computeLightContribution(mat,lightDir,lightColor);float ao=1.0;
#if defined (HAS_TEXTURE_u_occlusionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
#ifdef OCCLUSION_TEXTURE_TRANSFORM
vec2 uv=uv_2f.xy*u_occlusionTextureTransform.zw+u_occlusionTextureTransform.xy;
#else
vec2 uv=uv_2f;
#endif
ao=(texture(u_occlusionTexture,uv).x-1.0)*u_aoIntensity+1.0;color*=ao;
#endif
vec4 emissive=u_emissiveFactor;
#if defined(HAS_TEXTURE_u_emissionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
emissive.rgb*=sRGBToLinear(texture(u_emissionTexture,uv_2f).rgb);
#endif
#ifdef APPLY_LUT_ON_GPU
float emissiveFactorLength=max(length(u_emissiveFactor.rgb),0.001);emissive.rgb=sRGBToLinear(applyLUT(u_lutTexture,linearTosRGB(emissive.rgb/emissiveFactorLength).rbg))*emissiveFactorLength;
#endif
color+=emissive.rgb;float opacity=mat.baseColor.w*u_opacity;
#ifdef HAS_ATTRIBUTE_a_pbr
float resEmission=v_roughness_metallic_emissive_alpha.z;resEmission*=v_height_based_emission_params.z+v_height_based_emission_params.w*pow(clamp(v_height_based_emission_params.x,0.0,1.0),v_height_based_emission_params.y);vec3 color_mix=v_color_mix.rgb;
#ifdef APPLY_LUT_ON_GPU
color_mix=applyLUT(u_lutTexture,color_mix);
#endif
color=mix(color,color_mix,min(1.0,resEmission));
#ifdef HAS_ATTRIBUTE_a_color_4f
float distance=length(vec2(1.3*max(0.0,abs(color_4f.x)-color_4f.z),color_4f.y));distance+= mix(0.5,0.0,clamp(resEmission-1.0,0.0,1.0));opacity*=v_roughness_metallic_emissive_alpha.w*saturate(1.0-distance*distance);
#endif
#endif
vec3 unlitColor=mat.baseColor.rgb*ao+emissive.rgb;color=mix(color,unlitColor,u_emissive_strength);color=linearTosRGB(color);color*=opacity;finalColor=vec4(color,opacity);
#endif
#ifdef FOG
finalColor=fog_dither(fog_apply_premultiplied(finalColor,v_fog_pos,v_position_height.w));
#endif
#ifdef RENDER_CUTOFF
finalColor*=v_cutoff_opacity;
#endif
#ifdef INDICATOR_CUTOUT
finalColor=applyCutout(finalColor,v_position_height.w);
#endif
glFragColor=finalColor;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec3 a_pos_3f;
#pragma mapbox: define-attribute highp vec3 normal_3f
#pragma mapbox: define-attribute highp vec2 uv_2f
#pragma mapbox: define-attribute highp vec3 color_3f
#pragma mapbox: define-attribute highp vec4 color_4f
#pragma mapbox: define-attribute-vertex-shader-only highp vec4 pbr
#pragma mapbox: define-attribute-vertex-shader-only highp vec3 heightBasedEmissiveStrength
uniform mat4 u_matrix;uniform mat4 u_node_matrix;uniform mat4 u_lighting_matrix;uniform vec3 u_camera_pos;uniform vec4 u_color_mix;
#ifdef INSTANCED_ARRAYS
in vec4 a_normal_matrix0;in vec4 a_normal_matrix1;in vec4 a_normal_matrix2;in vec4 a_normal_matrix3;
#else
uniform highp mat4 u_normal_matrix;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out float v_depth_shadows;
#endif
out vec4 v_position_height;out lowp vec4 v_color_mix;
#ifdef TERRAIN_FRAGMENT_OCCLUSION
out highp float v_depth;
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
out lowp vec4 v_roughness_metallic_emissive_alpha;out mediump vec4 v_height_based_emission_params;
#endif
vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}void main() {
#pragma mapbox: initialize-attribute highp vec3 normal_3f
#pragma mapbox: initialize-attribute highp vec2 uv_2f
#pragma mapbox: initialize-attribute highp vec3 color_3f
#pragma mapbox: initialize-attribute highp vec4 color_4f
#pragma mapbox: initialize-attribute-custom highp vec4 pbr
#pragma mapbox: initialize-attribute-custom highp vec3 heightBasedEmissiveStrength
highp mat4 normal_matrix;
#ifdef INSTANCED_ARRAYS
normal_matrix=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);
#else
normal_matrix=u_normal_matrix;
#endif
vec3 local_pos;mat3 rs;
#ifdef MODEL_POSITION_ON_GPU
vec3 pos_color=normal_matrix[0].xyz;vec4 translate=normal_matrix[1];vec3 pos_a=floor(pos_color);vec3 rgb=1.05*(pos_color-pos_a);float hidden=float(pos_a.x > EXTENT);float color_mix=pos_a.z/100.0;v_color_mix=vec4(sRGBToLinear(rgb),color_mix);float meter_to_tile=normal_matrix[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);rs[0].x=normal_matrix[1].w;rs[0].yz=normal_matrix[2].xy;rs[1].xy=normal_matrix[2].zw;rs[1].z=normal_matrix[3].x;rs[2].xyz=normal_matrix[3].yzw;vec4 pos_node=u_lighting_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;local_pos=pos.xyz;gl_Position=mix(u_matrix*pos,AWAY,hidden);pos.z*=meter_to_tile;v_position_height.xyz=pos.xyz-u_camera_pos;
#else
local_pos=a_pos_3f;gl_Position=u_matrix*vec4(a_pos_3f,1);v_position_height.xyz=vec3(u_lighting_matrix*vec4(a_pos_3f,1));v_color_mix=vec4(sRGBToLinear(u_color_mix.rgb),u_color_mix.a);
#endif
v_position_height.w=a_pos_3f.z;
#ifdef HAS_ATTRIBUTE_a_pbr
vec4 albedo_c=decode_color(pbr.xy);vec2 e_r_m=unpack_float(pbr.z);vec2 r_m= unpack_float(e_r_m.y*16.0);r_m.r=r_m.r*16.0;v_color_mix=vec4(albedo_c.rgb,1.0);v_roughness_metallic_emissive_alpha=vec4(vec3(r_m,e_r_m.x)/255.0,albedo_c.a);v_roughness_metallic_emissive_alpha.z*=2.0;float heightBasedRelativeIntepolation=a_pos_3f.z*heightBasedEmissiveStrength.x+heightBasedEmissiveStrength.y;v_height_based_emission_params.x=heightBasedRelativeIntepolation;v_height_based_emission_params.y=heightBasedEmissiveStrength.z;vec2 emissionMultiplierValues=unpack_float(pbr.w)/256.0;v_height_based_emission_params.z=emissionMultiplierValues.x;v_height_based_emission_params.w=emissionMultiplierValues.y-emissionMultiplierValues.x;
#endif
#ifdef FOG
v_fog_pos=fog_position(local_pos);
#endif
#ifdef RENDER_CUTOFF
v_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);
#endif
#ifdef TERRAIN_FRAGMENT_OCCLUSION
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef HAS_ATTRIBUTE_a_normal_3f
#ifdef MODEL_POSITION_ON_GPU
float x_squared_scale=dot(rs[0],rs[0]);float y_squared_scale=dot(rs[1],rs[1]);float z_squared_scale=dot(rs[2],rs[2]);vec3 squared_scale=vec3(x_squared_scale,y_squared_scale,z_squared_scale);normal_3f=rs*((u_lighting_matrix*vec4(normal_3f,0.0)).xyz/squared_scale);normal_3f=normalize(normal_3f);
#else
normal_3f=vec3(normal_matrix*vec4(normal_3f,0));
#endif
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
#ifdef HAS_ATTRIBUTE_a_color_4f
v_roughness_metallic_emissive_alpha.w=clamp(color_4f.a*v_roughness_metallic_emissive_alpha.w*(v_roughness_metallic_emissive_alpha.z-1.0),0.0,1.0);
#endif
#endif
#ifdef RENDER_SHADOWS
vec4 shadow_pos=u_node_matrix*vec4(local_pos,1.0);
#ifdef NORMAL_OFFSET
#ifdef HAS_ATTRIBUTE_a_normal_3f
#ifdef MODEL_POSITION_ON_GPU
vec3 offset=shadow_normal_offset(vec3(-normal_3f.xy,normal_3f.z));shadow_pos.xyz+=offset*shadow_normal_offset_multiplier0();
#else
vec3 offset=shadow_normal_offset_model(normal_3f);shadow_pos.xyz+=offset*shadow_normal_offset_multiplier0();
#endif
#endif
#endif
v_pos_light_view_0=u_light_matrix_0*shadow_pos;v_pos_light_view_1=u_light_matrix_1*shadow_pos;v_depth_shadows=gl_Position.w;
#endif
}`),modelDepth:Wr(`in highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
glFragColor=pack_depth(v_depth);
#endif
}`,`in vec3 a_pos_3f;uniform mat4 u_matrix;out highp float v_depth;
#ifdef MODEL_POSITION_ON_GPU
#ifdef INSTANCED_ARRAYS
in vec4 a_normal_matrix0;in vec4 a_normal_matrix1;in vec4 a_normal_matrix2;in vec4 a_normal_matrix3;
#else
uniform highp mat4 u_instance;
#endif
uniform highp mat4 u_node_matrix;
#endif
void main() {
#ifdef MODEL_POSITION_ON_GPU
highp mat4 instance;
#ifdef INSTANCED_ARRAYS
instance=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);
#else
instance=u_instance;
#endif
vec3 pos_color=instance[0].xyz;vec4 translate=instance[1];vec3 pos_a=floor(pos_color);float hidden=float(pos_a.x > EXTENT);float meter_to_tile=instance[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);mat3 rs;rs[0].x=instance[1].w;rs[0].yz=instance[2].xy;rs[1].xy=instance[2].zw;rs[1].z=instance[3].x;rs[2].xyz=instance[3].yzw;vec4 pos_node=u_node_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;gl_Position=mix(u_matrix*pos,AWAY,hidden);
#else
gl_Position=u_matrix*vec4(a_pos_3f,1);
#endif
v_depth=gl_Position.z/gl_Position.w;}`),stars:Wr(`in highp vec2 v_uv;in mediump float v_intensity;float shapeCircle(in vec2 uv)
{float beginFade=0.6;float lengthFromCenter=length(v_uv);return 1.0-clamp((lengthFromCenter-beginFade)/(1.0-beginFade),0.0,1.0);}void main() {float alpha=shapeCircle(v_uv);vec3 color=vec3(1.0,1.0,1.0);alpha*=v_intensity;glFragColor=vec4(color*alpha,alpha);HANDLE_WIREFRAME_DEBUG;}`,`
in vec3 a_pos_3f;in vec2 a_uv;in float a_size_scale;in float a_fade_opacity;uniform mat4 u_matrix;uniform vec3 u_up;uniform vec3 u_right;uniform float u_intensity_multiplier;out highp vec2 v_uv;out mediump float v_intensity;void main() {v_uv=a_uv;v_intensity=a_fade_opacity*u_intensity_multiplier;vec3 pos=a_pos_3f;pos+=a_uv.x*u_right*a_size_scale;pos+=a_uv.y*u_up*a_size_scale;gl_Position=u_matrix*vec4(pos,1.0);}`),snowParticle:Wr("in highp vec2 uv;in highp float alphaMultiplier;uniform vec4 u_particleColor;uniform vec2 u_simpleShapeParameters;void main() {float t=clamp((length(uv)-u_simpleShapeParameters.x)/(1.0-u_simpleShapeParameters.x),0.0,1.0);float alpha=1.0-pow(t,pow(10.0,u_simpleShapeParameters.y));alpha*=alphaMultiplier;alpha*=u_particleColor.a;vec3 color=u_particleColor.rgb*alpha;glFragColor=vec4(color,alpha) ;HANDLE_WIREFRAME_DEBUG;}",`
in highp vec3 a_pos_3f;in highp vec2 a_uv;in highp vec4 a_snowParticleData;in highp vec4 a_snowParticleDataHorizontalOscillation;uniform mat4 u_modelview;uniform mat4 u_projection;uniform vec3 u_cam_pos;uniform vec2 u_screenSize;uniform float u_time;uniform float u_boxSize;uniform float u_velocityConeAperture; 
uniform float u_velocity;uniform vec3 u_direction;uniform float u_horizontalOscillationRadius; 
uniform float u_horizontalOscillationRate; 
uniform float u_billboardSize;uniform vec2 u_thinningCenterPos;uniform vec3 u_thinningShape;uniform float u_thinningAffectedRatio;uniform float u_thinningParticleOffset;out highp vec2 uv;out highp float alphaMultiplier;void main() {vec3 pos=a_pos_3f;float halfBoxSize=0.5*u_boxSize;pos.xyz*=halfBoxSize;pos+=u_cam_pos;float velocityConeApertureRad=radians(u_velocityConeAperture*0.5);float coneAnglePichRad=velocityConeApertureRad*a_snowParticleData.z;float coneAngleHeadingRad=a_snowParticleData.w*radians(360.0);vec3 localZ=normalize(u_direction);vec3 localX=normalize(cross(localZ,vec3(1,0,0)));vec3 localY=normalize(cross(localZ,localX));vec3 direction;direction.x=cos(coneAngleHeadingRad)*sin(coneAnglePichRad);direction.y=sin(coneAngleHeadingRad)*sin(coneAnglePichRad);direction.z=cos(coneAnglePichRad);direction=normalize(direction);vec3 simPosLocal=vec3(0,0,0);float velocityScale=(1.0+3.0*a_snowParticleData.y)*u_velocity;simPosLocal+=direction*velocityScale*u_time;float horizontalOscillationRadius=u_horizontalOscillationRadius*a_snowParticleDataHorizontalOscillation.x;float horizontalOscillationAngle=u_horizontalOscillationRate*u_time*(-1.0+2.0*a_snowParticleDataHorizontalOscillation.y);simPosLocal.xy+=horizontalOscillationRadius*vec2(cos(horizontalOscillationAngle),sin(horizontalOscillationAngle));vec3 simPos=localX*simPosLocal.x+
localY*simPosLocal.y+localZ*simPosLocal.z;pos+=simPos;pos=fract((pos+vec3(halfBoxSize))/vec3(u_boxSize))*u_boxSize-vec3(halfBoxSize);float clipZ=-u_cam_pos.z+pos.z;vec4 posView=u_modelview*vec4(pos,1.0);float size=u_billboardSize;alphaMultiplier=1.0;vec4 posScreen=u_projection*posView;posScreen/=posScreen.w;posScreen.xy=vec2(0.5)+posScreen.xy*0.5;posScreen.xy*=u_screenSize;vec2 thinningCenterPos=u_thinningCenterPos.xy;thinningCenterPos.y=u_screenSize.y-thinningCenterPos.y;float screenDist=length((thinningCenterPos-posScreen.xy)/(0.5*u_screenSize));screenDist+=a_snowParticleData.x*u_thinningParticleOffset;float scaleFactorMode=0.0;float thinningShapeDist=u_thinningShape.x+u_thinningShape.y;if (screenDist < thinningShapeDist) {float thinningFadeRatio=clamp((screenDist-u_thinningShape.x)/u_thinningShape.y,0.0,1.0);thinningFadeRatio=pow(thinningFadeRatio,u_thinningShape.z);if (a_snowParticleData.x < u_thinningAffectedRatio) {scaleFactorMode=1.0-thinningFadeRatio;alphaMultiplier=thinningFadeRatio;}}vec4 posScreen1=u_projection*vec4(posView.x-size,posView.yzw);posScreen1/=posScreen1.w;vec4 posScreen2=u_projection*vec4(posView.x+size,posView.yzw);posScreen2/=posScreen2.w;posScreen1.xy=vec2(0.5)+posScreen1.xy*0.5;posScreen1.xy*=u_screenSize;posScreen2.xy=vec2(0.5)+posScreen2.xy*0.5;posScreen2.xy*=u_screenSize;float screenLength=length(posScreen1.xy-posScreen2.xy);float screenEpsilon=3.0;float scaleFactor=1.0;if (screenLength < screenEpsilon) {scaleFactor=screenEpsilon/max(screenLength,0.01);scaleFactor=mix(scaleFactor,1.0,scaleFactorMode);}float screenEpsilon2=15.0;if (screenLength > screenEpsilon2) {scaleFactor=screenEpsilon2/max(screenLength,0.01);}size*=scaleFactor;vec2 right=size*vec2(1,0);vec2 up=size*vec2(0,1);posView.xy+=right*a_uv.x;posView.xy+=up*a_uv.y;uv=a_uv;gl_Position=u_projection*posView;}`),rainParticle:Wr("in highp vec2 uv;in highp float particleRandomValue;uniform sampler2D u_texScreen;uniform float u_distortionStrength;uniform vec4 u_color;uniform vec2 u_thinningCenterPos;uniform vec3 u_thinningShape;uniform float u_thinningAffectedRatio;uniform float u_thinningParticleOffset;uniform float u_shapeDirectionalPower;uniform float u_mode;void main() {vec2 st=uv*0.5+vec2(0.5);vec2 uvm=uv;uvm.y=-1.0+2.0*pow(st.y,u_shapeDirectionalPower);float shape=clamp(1.0-length(uvm),0.0,1.0);float alpha=abs(shape)*u_color.a;vec2 screenSize=vec2(textureSize(u_texScreen,0));vec2 thinningCenterPos=u_thinningCenterPos.xy;thinningCenterPos.y=screenSize.y-thinningCenterPos.y;float screenDist=length((thinningCenterPos-gl_FragCoord.xy)/(0.5*screenSize));screenDist+=(0.5+0.5*particleRandomValue)*u_thinningParticleOffset;float thinningShapeDist=u_thinningShape.x+u_thinningShape.y;float thinningAlpha=1.0;if (screenDist < thinningShapeDist) {float thinningFadeRatio=clamp((screenDist-u_thinningShape.x)/u_thinningShape.y,0.0,1.0);thinningFadeRatio=pow(thinningFadeRatio,u_thinningShape.z);thinningAlpha*=thinningFadeRatio;}vec2 offsetXY=normalize(uvm)*abs(shape);vec2 stScreen=(gl_FragCoord.xy+offsetXY*u_distortionStrength*thinningAlpha)/screenSize;vec3 colorScreen=texture(u_texScreen,stScreen).rgb;alpha*=thinningAlpha;glFragColor=mix(vec4(colorScreen,1.0),vec4(u_color.rgb*alpha,alpha),u_mode);HANDLE_WIREFRAME_DEBUG;}",`
in highp vec3 a_pos_3f;in highp vec2 a_uv;in highp vec4 a_rainParticleData;uniform mat4 u_modelview;uniform mat4 u_projection;uniform vec3 u_cam_pos;uniform float u_time;uniform float u_boxSize;uniform float u_velocityConeAperture; 
uniform float u_velocity; 
uniform vec2 u_rainDropletSize;uniform vec3 u_rainDirection;out highp vec2 uv;out highp float particleRandomValue;void main() {vec3 pos=a_pos_3f;float halfBoxSize=0.5*u_boxSize;pos*=halfBoxSize; 
pos+=u_cam_pos;float velocityConeApertureRad=radians(u_velocityConeAperture*0.5);float coneAnglePichRad=velocityConeApertureRad*a_rainParticleData.z;float coneAngleHeadingRad=a_rainParticleData.w*radians(360.0);vec3 localZ=normalize(u_rainDirection);vec3 localX=normalize(cross(localZ,vec3(1,0,0)));vec3 localY=normalize(cross(localZ,localX));vec3 directionLocal;directionLocal.x=cos(coneAngleHeadingRad)*sin(coneAnglePichRad);directionLocal.y=sin(coneAngleHeadingRad)*sin(coneAnglePichRad);directionLocal.z=cos(coneAnglePichRad);directionLocal=normalize(directionLocal);vec3 directionWorld=localX*directionLocal.x+localY*directionLocal.y+localZ*directionLocal.z;float velocityScale=(1.0+3.0*a_rainParticleData.y)*u_velocity;vec3 simPosLocal=vec3(0,0,0);simPosLocal+=directionLocal*velocityScale*u_time;vec3 simPos=localX*simPosLocal.x+
localY*simPosLocal.y+localZ*simPosLocal.z;pos+=simPos;pos=fract((pos+vec3(halfBoxSize))/vec3(u_boxSize))*u_boxSize-vec3(halfBoxSize);vec4 posView=u_modelview*vec4(pos,1.0);vec3 directionView=normalize((u_modelview*vec4(directionWorld,0.0)).xyz);vec3 side=cross(directionView,normalize(posView.xyz));posView.xyz+=side*a_uv.x*u_rainDropletSize.x;posView.xyz+=directionView*a_uv.y*u_rainDropletSize.y;uv=a_uv;particleRandomValue=a_rainParticleData.x;gl_Position=u_projection*posView;}`),vignette:Wr("uniform vec3 u_vignetteShape;uniform vec4 u_vignetteColor;in vec2 st;void main() {float screenDist=length(st);float alpha=clamp((screenDist-u_vignetteShape.x)/u_vignetteShape.y,0.0,1.0);alpha=pow(alpha,u_vignetteShape.z)*u_vignetteColor.a;vec3 color=u_vignetteColor.rgb;glFragColor=vec4(color*alpha,alpha) ;}","in vec2 a_pos_2f;out vec2 st;void main() {st=a_pos_2f;gl_Position=vec4(a_pos_2f,0,1);}"),occlusion:Wr("uniform vec4 u_color;void main() {glFragColor=u_color;}",`#include "_prelude_terrain.vertex.glsl"
in highp vec2 a_offset_xy;uniform highp vec3 u_anchorPos;uniform mat4 u_matrix;uniform vec2 u_screenSizePx;uniform vec2 u_occluderSizePx;void main() {vec3 world_pos=u_anchorPos;
#ifdef TERRAIN
float e=elevation(world_pos.xy);world_pos.z+=e;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1.0);projected_point.xy+=projected_point.w*a_offset_xy*0.5*u_occluderSizePx/u_screenSizePx;gl_Position=projected_point;}`)};function du(f,o){const l=f.replace(/\s*\/\/[^\n]*\n/g,`
`).split(`
`);for(let m of l)if(m=m.trim(),m[0]==="#"&&m.includes("if")&&!m.includes("endif")){m=m.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const y=m.split(" ");for(const w of y)o.includes(w)||o.push(w)}}function Wr(f,o){const l=/#include\s+"([^"]+)"/g,m=/#pragma mapbox: ([\w\-]+) ([\w]+) ([\w]+) ([\w]+)/g;let y=o.match(/(attribute(\S*)|(^\s*|;)in) (highp |mediump |lowp )?([\w]+) ([\w]+)/gm);y&&(y=y.map(H=>{const G=H.split(" ");return G[G.length-1]}),y=[...new Set(y)]);const w={},E=[],O=[];if(f=f.replace(l,(H,G)=>(O.push(G),"")),(o=o.replace(l,(H,G)=>(E.push(G),""))).includes("flat out"))return void console.error('The usage of "flat" qualifier is disallowed, see: https://bugs.webkit.org/show_bug.cgi?id=268071');let $=[...uu];du(f,$),du(o,$);for(const H of[...E,...O])Ju[H]||console.error(`Undefined include: ${H}`),Sh[H]||(Sh[H]=[],du(Ju[H],Sh[H])),$=[...$,...Sh[H]];return{fragmentSource:f=f.replace(m,(H,G,Z,X,oe)=>(w[oe]=!0,G==="define"?`
#ifndef HAS_UNIFORM_u_${oe}
in ${Z} ${X} ${oe};
#else
uniform ${Z} ${X} u_${oe};
#endif
`:G==="initialize"?`
#ifdef HAS_UNIFORM_u_${oe}
    ${Z} ${X} ${oe} = u_${oe};
#endif
`:G==="define-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${oe}
    in ${Z} ${X} ${oe};
#endif
`:G==="initialize-attribute"?"":void 0)),vertexSource:o=o.replace(m,(H,G,Z,X,oe)=>{const xe=X==="float"?"vec2":X,ve=oe.match(/color/)?"color":xe;return G==="define-attribute-vertex-shader-only"?`
#ifdef HAS_ATTRIBUTE_a_${oe}
in ${Z} ${X} a_${oe};
#endif
`:w[oe]?G==="define"?`
#ifndef HAS_UNIFORM_u_${oe}
uniform lowp float u_${oe}_t;
in ${Z} ${xe} a_${oe};
out ${Z} ${X} ${oe};
#else
uniform ${Z} ${X} u_${oe};
#endif
`:G==="initialize"?ve==="vec4"?`
#ifndef HAS_UNIFORM_u_${oe}
    ${oe} = a_${oe};
#else
    ${Z} ${X} ${oe} = u_${oe};
#endif
`:`
#ifndef HAS_UNIFORM_u_${oe}
    ${oe} = unpack_mix_${ve}(a_${oe}, u_${oe}_t);
#else
    ${Z} ${X} ${oe} = u_${oe};
#endif
`:G==="define-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${oe}
    in ${Z} ${X} a_${oe};
    out ${Z} ${X} ${oe};
#endif
`:G==="initialize-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${oe}
    ${oe} = a_${oe};
#endif
`:void 0:G==="define"?`
#ifndef HAS_UNIFORM_u_${oe}
uniform lowp float u_${oe}_t;
in ${Z} ${xe} a_${oe};
#else
uniform ${Z} ${X} u_${oe};
#endif
`:G==="define-instanced"?ve==="mat4"?`
#ifdef INSTANCED_ARRAYS
in vec4 a_${oe}0;
in vec4 a_${oe}1;
in vec4 a_${oe}2;
in vec4 a_${oe}3;
#else
uniform ${Z} ${X} u_${oe};
#endif
`:`
#ifdef INSTANCED_ARRAYS
in ${Z} ${xe} a_${oe};
#else
uniform ${Z} ${X} u_${oe};
#endif
`:G==="initialize-attribute-custom"?`
#ifdef HAS_ATTRIBUTE_a_${oe}
    ${Z} ${X} ${oe} = a_${oe};
#endif
`:ve==="vec4"?`
#ifndef HAS_UNIFORM_u_${oe}
    ${Z} ${X} ${oe} = a_${oe};
#else
    ${Z} ${X} ${oe} = u_${oe};
#endif
`:`
#ifndef HAS_UNIFORM_u_${oe}
    ${Z} ${X} ${oe} = unpack_mix_${ve}(a_${oe}, u_${oe}_t);
#else
    ${Z} ${X} ${oe} = u_${oe};
#endif
`}),staticAttributes:y,usedDefines:$,vertexIncludes:E,fragmentIncludes:O}}class jy{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(o,l,m,y,w,E,O,$){this.context=o;let H=this.boundPaintVertexBuffers.length!==y.length;for(let Z=0;!H&&Z<y.length;Z++)this.boundPaintVertexBuffers[Z]!==y[Z]&&(H=!0);let G=this.boundDynamicVertexBuffers.length!==O.length;for(let Z=0;!G&&Z<O.length;Z++)this.boundDynamicVertexBuffers[Z]!==O[Z]&&(G=!0);if(!this.vao||this.boundProgram!==l||this.boundLayoutVertexBuffer!==m||H||G||this.boundIndexBuffer!==w||this.boundVertexOffset!==E)this.freshBind(l,m,y,w,E,O,$);else{o.bindVertexArrayOES.set(this.vao);for(const Z of O)Z&&(Z.bind(),$&&Z.instanceCount&&Z.setVertexAttribDivisor(o.gl,l,$));w&&w.dynamicDraw&&w.bind()}}freshBind(o,l,m,y,w,E,O){const $=o.numAttributes,H=this.context,G=H.gl;this.vao&&this.destroy(),this.vao=H.gl.createVertexArray(),H.bindVertexArrayOES.set(this.vao),this.boundProgram=o,this.boundLayoutVertexBuffer=l,this.boundPaintVertexBuffers=m,this.boundIndexBuffer=y,this.boundVertexOffset=w,this.boundDynamicVertexBuffers=E,l.enableAttributes(G,o),l.bind(),l.setVertexAttribPointers(G,o,w);for(const Z of m)Z.enableAttributes(G,o),Z.bind(),Z.setVertexAttribPointers(G,o,w);for(const Z of E)Z&&(Z.enableAttributes(G,o),Z.bind(),Z.setVertexAttribPointers(G,o,w),O&&Z.instanceCount&&Z.setVertexAttribDivisor(G,o,O));y&&y.bind(),H.currentNumAttributes=$}destroy(){this.vao&&(this.context.gl.deleteVertexArray(this.vao),this.vao=null)}}function ed(f,o){const l=Math.pow(2,o.canonical.z),m=o.canonical.y;return[new r.aa(0,m/l).toLngLat().lat,new r.aa(0,(m+1)/l).toLngLat().lat]}function Hy(f,o,l,m,y,w,E){const O=f.context,$=O.gl,H=l.hillshadeFBO;if(!H)return;f.prepareDrawTile();const G=f.isTileAffectedByFog(o),Z=f.getOrCreateProgram("hillshade",{overrideFog:G});O.activeTexture.set($.TEXTURE0),$.bindTexture($.TEXTURE_2D,H.colorAttachment.get());const X=((Ce,Te,Le,Ge)=>{const He=Le.paint.get("hillshade-shadow-color"),rt=Le.paint.get("hillshade-shadow-color-use-theme").constantOr("default")==="none",Xe=Le.paint.get("hillshade-highlight-color"),et=Le.paint.get("hillshade-highlight-color-use-theme").constantOr("default")==="none",Ye=Le.paint.get("hillshade-accent-color"),at=Le.paint.get("hillshade-accent-color-use-theme").constantOr("default")==="none",gt=Le.paint.get("hillshade-emissive-strength");let Vt=r.ai(Le.paint.get("hillshade-illumination-direction"));if(Le.paint.get("hillshade-illumination-anchor")==="viewport")Vt-=Ce.transform.angle;else if(Ce.style&&Ce.style.enable3dLights()&&Ce.style.directionalLight){const tn=Ce.style.directionalLight.properties.get("direction"),Jt=r.cb(tn.x,tn.y,tn.z);Vt=r.ai(Jt[1])}const Rt=!Ce.options.moving;return{u_matrix:Ge||Ce.transform.calculateProjMatrix(Te.tileID.toUnwrapped(),Rt),u_image:0,u_latrange:ed(0,Te.tileID),u_light:[Le.paint.get("hillshade-exaggeration"),Vt],u_shadow:He.toRenderColor(rt?null:Le.lut),u_highlight:Xe.toRenderColor(et?null:Le.lut),u_emissive_strength:gt,u_accent:Ye.toRenderColor(at?null:Le.lut)}})(f,l,m,f.terrain?o.projMatrix:null);f.uploadCommonUniforms(O,Z,o.toUnwrapped());const{tileBoundsBuffer:oe,tileBoundsIndexBuffer:xe,tileBoundsSegments:ve}=f.getTileBoundsBuffers(l);Z.draw(f,$.TRIANGLES,y,w,E,_r.disabled,X,m.id,oe,xe,ve)}function Gy(f,o,l){if(!o.needsDEMTextureUpload)return;const m=f.context,y=m.gl;m.pixelStoreUnpackPremultiplyAlpha.set(!1),o.demTexture=o.demTexture||f.getTileTexture(l.stride);const w=l.getPixels();o.demTexture?o.demTexture.update(w,{premultiply:!1}):o.demTexture=new r.T(m,w,y.R32F,{premultiply:!1}),o.needsDEMTextureUpload=!1}function Xx(f,o,l){const m=f.context,y=m.gl;if(!o.dem)return;const w=o.dem;if(m.activeTexture.set(y.TEXTURE1),Gy(f,o,w),!o.demTexture)return;o.demTexture.bind(y.NEAREST,y.CLAMP_TO_EDGE);const E=w.dim;m.activeTexture.set(y.TEXTURE0);let O=o.hillshadeFBO;if(!O){const X=new r.T(m,{width:E,height:E,data:null},y.RGBA8);X.bind(y.LINEAR,y.CLAMP_TO_EDGE),O=o.hillshadeFBO=m.createFramebuffer(E,E,!0,"renderbuffer"),O.colorAttachment.set(X.texture)}m.bindFramebuffer.set(O.framebuffer),m.viewport.set([0,0,E,E]);const{tileBoundsBuffer:$,tileBoundsIndexBuffer:H,tileBoundsSegments:G}=f.getMercatorTileBoundsBuffers(),Z=[];f.linearFloatFilteringSupported()&&Z.push("TERRAIN_DEM_FLOAT_FORMAT"),f.getOrCreateProgram("hillshadePrepare",{defines:Z}).draw(f,y.TRIANGLES,or.disabled,fr.disabled,Lr.unblended,_r.disabled,((X,oe)=>{const xe=oe.stride,ve=r.ab.mat4.create();return r.ab.mat4.ortho(ve,0,r.ag,-r.ag,0,0,1),r.ab.mat4.translate(ve,ve,[0,-r.ag,0]),{u_matrix:ve,u_image:1,u_dimension:[xe,xe],u_zoom:X.overscaledZ}})(o.tileID,w),l.id,$,H,G),o.needsHillshadePrepare=!1}class Vo{constructor(o){this.gl=o.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(o){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Ag extends Vo{getDefault(){return r.aj.transparent}set(o){const l=this.current;(o.r!==l.r||o.g!==l.g||o.b!==l.b||o.a!==l.a||this.dirty)&&(this.gl.clearColor(o.r,o.g,o.b,o.a),this.current=o,this.dirty=!1)}}class kg extends Vo{getDefault(){return 1}set(o){(o!==this.current||this.dirty)&&(this.gl.clearDepth(o),this.current=o,this.dirty=!1)}}class Pg extends Vo{getDefault(){return 0}set(o){(o!==this.current||this.dirty)&&(this.gl.clearStencil(o),this.current=o,this.dirty=!1)}}class Rg extends Vo{getDefault(){return[!0,!0,!0,!0]}set(o){const l=this.current;(o[0]!==l[0]||o[1]!==l[1]||o[2]!==l[2]||o[3]!==l[3]||this.dirty)&&(this.gl.colorMask(o[0],o[1],o[2],o[3]),this.current=o,this.dirty=!1)}}class Wy extends Vo{getDefault(){return!0}set(o){(o!==this.current||this.dirty)&&(this.gl.depthMask(o),this.current=o,this.dirty=!1)}}class qy extends Vo{getDefault(){return 255}set(o){(o!==this.current||this.dirty)&&(this.gl.stencilMask(o),this.current=o,this.dirty=!1)}}class Jx extends Vo{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(o){const l=this.current;(o.func!==l.func||o.ref!==l.ref||o.mask!==l.mask||this.dirty)&&(this.gl.stencilFunc(o.func,o.ref,o.mask),this.current=o,this.dirty=!1)}}class Ch extends Vo{getDefault(){const o=this.gl;return[o.KEEP,o.KEEP,o.KEEP]}set(o){const l=this.current;(o[0]!==l[0]||o[1]!==l[1]||o[2]!==l[2]||this.dirty)&&(this.gl.stencilOp(o[0],o[1],o[2]),this.current=o,this.dirty=!1)}}class Eh extends Vo{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const l=this.gl;o?l.enable(l.STENCIL_TEST):l.disable(l.STENCIL_TEST),this.current=o,this.dirty=!1}}class Ky extends Vo{getDefault(){return[0,1]}set(o){const l=this.current;(o[0]!==l[0]||o[1]!==l[1]||this.dirty)&&(this.gl.depthRange(o[0],o[1]),this.current=o,this.dirty=!1)}}class Rs extends Vo{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const l=this.gl;o?l.enable(l.DEPTH_TEST):l.disable(l.DEPTH_TEST),this.current=o,this.dirty=!1}}class Og extends Vo{getDefault(){return this.gl.LESS}set(o){(o!==this.current||this.dirty)&&(this.gl.depthFunc(o),this.current=o,this.dirty=!1)}}class ip extends Vo{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const l=this.gl;o?l.enable(l.BLEND):l.disable(l.BLEND),this.current=o,this.dirty=!1}}class sp extends Vo{getDefault(){const o=this.gl;return[o.ONE,o.ZERO,o.ONE,o.ZERO]}set(o){const l=this.current;(o[0]!==l[0]||o[1]!==l[1]||o[2]!==l[2]||o[3]!==l[3]||this.dirty)&&(this.gl.blendFuncSeparate(o[0],o[1],o[2],o[3]),this.current=o,this.dirty=!1)}}class Lg extends Vo{getDefault(){return r.aj.transparent}set(o){const l=this.current;(o.r!==l.r||o.g!==l.g||o.b!==l.b||o.a!==l.a||this.dirty)&&(this.gl.blendColor(o.r,o.g,o.b,o.a),this.current=o,this.dirty=!1)}}class Dg extends Vo{getDefault(){return this.gl.FUNC_ADD}set(o){(o!==this.current||this.dirty)&&(this.gl.blendEquationSeparate(o,o),this.current=o,this.dirty=!1)}}class ap extends Vo{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const l=this.gl;o?l.enable(l.CULL_FACE):l.disable(l.CULL_FACE),this.current=o,this.dirty=!1}}class zg extends Vo{getDefault(){return this.gl.BACK}set(o){(o!==this.current||this.dirty)&&(this.gl.cullFace(o),this.current=o,this.dirty=!1)}}class Fg extends Vo{getDefault(){return this.gl.CCW}set(o){(o!==this.current||this.dirty)&&(this.gl.frontFace(o),this.current=o,this.dirty=!1)}}let lp=class extends Vo{getDefault(){return null}set(f){(f!==this.current||this.dirty)&&(this.gl.useProgram(f),this.current=f,this.dirty=!1)}};class Zy extends Vo{getDefault(){return this.gl.TEXTURE0}set(o){(o!==this.current||this.dirty)&&(this.gl.activeTexture(o),this.current=o,this.dirty=!1)}}class Yy extends Vo{getDefault(){const o=this.gl;return[0,0,o.drawingBufferWidth,o.drawingBufferHeight]}set(o){const l=this.current;(o[0]!==l[0]||o[1]!==l[1]||o[2]!==l[2]||o[3]!==l[3]||this.dirty)&&(this.gl.viewport(o[0],o[1],o[2],o[3]),this.current=o,this.dirty=!1)}}class td extends Vo{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const l=this.gl;l.bindFramebuffer(l.FRAMEBUFFER,o),this.current=o,this.dirty=!1}}class Qx extends Vo{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const l=this.gl;l.bindRenderbuffer(l.RENDERBUFFER,o),this.current=o,this.dirty=!1}}class ew extends Vo{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const l=this.gl;l.bindTexture(l.TEXTURE_2D,o),this.current=o,this.dirty=!1}}class tw extends Vo{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const l=this.gl;l.bindBuffer(l.ARRAY_BUFFER,o),this.current=o,this.dirty=!1}}class nw extends Vo{getDefault(){return null}set(o){const l=this.gl;l.bindBuffer(l.ELEMENT_ARRAY_BUFFER,o),this.current=o,this.dirty=!1}}class rw extends Vo{getDefault(){return null}set(o){this.gl&&(o!==this.current||this.dirty)&&(this.gl.bindVertexArray(o),this.current=o,this.dirty=!1)}}class ow extends Vo{getDefault(){return 4}set(o){if(o===this.current&&!this.dirty)return;const l=this.gl;l.pixelStorei(l.UNPACK_ALIGNMENT,o),this.current=o,this.dirty=!1}}class Ng extends Vo{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const l=this.gl;l.pixelStorei(l.UNPACK_PREMULTIPLY_ALPHA_WEBGL,o),this.current=o,this.dirty=!1}}class Bg extends Vo{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const l=this.gl;l.pixelStorei(l.UNPACK_FLIP_Y_WEBGL,o),this.current=o,this.dirty=!1}}class cp extends Vo{constructor(o,l){super(o),this.context=o,this.parent=l}getDefault(){return null}}class nd extends cp{setDirty(){this.dirty=!0}set(o){if(o===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const l=this.gl;l.framebufferTexture2D(l.FRAMEBUFFER,l.COLOR_ATTACHMENT0,l.TEXTURE_2D,o,0),this.current=o,this.dirty=!1}}class Vg extends cp{attachment(){return this.gl.DEPTH_ATTACHMENT}set(o){if(o===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const l=this.gl;l.framebufferRenderbuffer(l.FRAMEBUFFER,this.attachment(),l.RENDERBUFFER,o),this.current=o,this.dirty=!1}}class Xy extends cp{attachment(){return this.gl.DEPTH_ATTACHMENT}set(o){if(o===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const l=this.gl;l.framebufferTexture2D(l.FRAMEBUFFER,this.attachment(),l.TEXTURE_2D,o,0),this.current=o,this.dirty=!1}}class Jy extends Vg{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}const $g=(f,o,l)=>({u_matrix:f,u_image0:0,u_skirt_height:o,u_ground_shadow_factor:l}),Sc=(f,o,l,m,y,w,E,O,$,H,G,Z,X,oe,xe,ve)=>({u_proj_matrix:Float32Array.from(f),u_globe_matrix:o,u_normalize_matrix:Float32Array.from(m),u_merc_matrix:l,u_zoom_transition:y,u_merc_center:w,u_image0:0,u_frustum_tl:E,u_frustum_tr:O,u_frustum_br:$,u_frustum_bl:H,u_globe_pos:G,u_globe_radius:Z,u_viewport:X,u_grid_matrix:ve?Float32Array.from(ve):new Float32Array(9),u_skirt_height:oe,u_far_z_cutoff:xe});function Ug(f,o){return f!=null&&o!=null&&!(!f.hasData()||!o.hasData())&&f.demTexture!=null&&o.demTexture!=null&&f.tileID.key!==o.tileID.key}const Ws=new class{constructor(){this.operations={}}newMorphing(f,o,l,m,y){if(f in this.operations){const w=this.operations[f];w.to.tileID.key!==l.tileID.key&&(w.queued=l)}else this.operations[f]={startTime:m,phase:0,duration:y,from:o,to:l,queued:null}}getMorphValuesForProxy(f){if(!(f in this.operations))return null;const o=this.operations[f];return{from:o.from,to:o.to,phase:o.phase}}update(f){for(const o in this.operations){const l=this.operations[o];for(l.phase=(f-l.startTime)/l.duration;l.phase>=1||!this._validOp(l);)if(!this._nextOp(l,f)){delete this.operations[o];break}}}_nextOp(f,o){return!!f.queued&&(f.from=f.to,f.to=f.queued,f.queued=null,f.phase=0,f.startTime=o,!0)}_validOp(f){return f.from.hasData()&&f.to.hasData()}},up={0:null,1:"TERRAIN_VERTEX_MORPHING"};function Mh(f,o,l){if(o===0)return 0;const m=o<1&&l===514?.25/o:1;return 6*Math.pow(1.5,22-f)*Math.max(o,1)*m}function Qy(f,o){const l=1<<f.z;return!o&&(f.x===0||f.x===l-1)||f.y===0||f.y===l-1}const dp=f=>({u_matrix:f});function Ih(f,o,l,m,y){if(y>0){const w=r.q.now(),E=(w-f.timeAdded)/y,O=o?(w-o.timeAdded)/y:-1,$=l.getSource(),H=m.coveringZoomLevel({tileSize:$.tileSize,roundZoom:$.roundZoom}),G=!o||Math.abs(o.tileID.overscaledZ-H)>Math.abs(f.tileID.overscaledZ-H),Z=G&&f.refreshedUponExpiration?1:r.aw(G?E:1-O,0,1);return f.refreshedUponExpiration&&E>=1&&(f.refreshedUponExpiration=!1),o?{opacity:1,mix:1-Z}:{opacity:Z,mix:0}}return{opacity:1,mix:0}}class jg extends _a{constructor(o){const l={type:"raster-dem",maxzoom:o.transform.maxZoom},m=new r.D(r.ci(),null),y=us("mock-dem",l,m,o.style);super("mock-dem",y,!1),y.setEventedParent(this),this._sourceLoaded=!0}_loadTile(o,l){o.state="loaded",l(null)}}class iw extends _a{constructor(o){const l=us("proxy",{type:"geojson",maxzoom:o.transform.maxZoom},new r.D(r.ci(),null),o.style);super("proxy",l,!1),l.setEventedParent(this),this.map=this.getSource().map=o,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(o,l,m){if(o.freezeTileCoverage)return;this.transform=o;const y=o.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((w,E)=>{if(w[E.key]="",!this._tiles[E.key]){const O=new _c(E,this._source.tileSize*E.overscaleFactor(),o.tileZoom);O.state="loaded",this._tiles[E.key]=O}return w},{});for(const w in this._tiles)w in y||(this.freeFBO(w),this._tiles[w].unloadVectorData(),delete this._tiles[w])}freeFBO(o){const l=this.proxyCachedFBO[o];if(l!==void 0){const m=Object.values(l);this.renderCachePool.push(...m),delete this.proxyCachedFBO[o]}}deallocRenderCache(){this.renderCache.forEach(o=>o.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class Hg extends r.aG{constructor(o,l,m){super(o.overscaledZ,o.wrap,o.canonical.z,o.canonical.x,o.canonical.y),this.proxyTileKey=l,this.projMatrix=m}}class rd extends r.cJ{constructor(o,l){super(),this._debugParams={sortTilesHiZFirst:!0,disableRenderCache:!1},o.tp.registerParameter(this._debugParams,["Terrain"],"sortTilesHiZFirst",{},()=>{this._style.map.triggerRepaint()}),o.tp.registerParameter(this._debugParams,["Terrain"],"disableRenderCache",{},()=>{this._style.map.triggerRepaint()}),o.tp.registerButton(["Terrain"],"Invalidate Render Cache",()=>{this.invalidateRenderCache=!0,this._style.map.triggerRepaint()}),this.painter=o,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[m,y,w]=function($){const H=new r.b4,G=new r.aU,Z=131;H.reserve(17161),G.reserve(33800);const X=r.ag/128,oe=r.ag+X/2,xe=oe+X;for(let Ce=-X;Ce<xe;Ce+=X)for(let Te=-X;Te<xe;Te+=X){const Le=Te<0||Te>oe||Ce<0||Ce>oe?24575:0,Ge=r.aw(Math.round(Te),0,r.ag),He=r.aw(Math.round(Ce),0,r.ag);H.emplaceBack(Ge+Le,He)}const ve=(Ce,Te)=>{const Le=Te*Z+Ce;G.emplaceBack(Le+1,Le,Le+Z),G.emplaceBack(Le+Z,Le+Z+1,Le+1)};for(let Ce=1;Ce<129;Ce++)for(let Te=1;Te<129;Te++)ve(Te,Ce);return[0,129].forEach(Ce=>{for(let Te=0;Te<130;Te++)ve(Te,Ce),ve(Ce,Te)}),[H,G,32768]}(),E=o.context;this.gridBuffer=E.createVertexBuffer(m,r.b6.members),this.gridIndexBuffer=E.createIndexBuffer(y),this.gridSegments=r.b7.simpleSegment(0,0,m.length,y.length),this.gridNoSkirtSegments=r.b7.simpleSegment(0,0,m.length,w),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new iw(l.map),this.orthoMatrix=r.ab.mat4.create(),r.ab.mat4.ortho(this.orthoMatrix,this.painter.transform.projection.name==="globe"?.015:0,r.ag,0,r.ag,0,1);const O=E.gl;this._overlapStencilMode=new fr({func:O.GEQUAL,mask:255},0,255,O.KEEP,O.KEEP,O.REPLACE),this._previousZoom=o.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=l,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new jg(l.map),this._pendingGroundEffectLayers=[]}set style(o){o.on("data",this._onStyleDataEvent.bind(this)),this._style=o,this._style.map.on("moveend",()=>{this._clearLineLayersFromRenderCache()})}update(o,l,m){if(o&&o.terrain){this._style!==o&&(this.style=o,this._evaluationZoom=void 0);const y=o.terrain.properties,w=o.terrain.drapeRenderMode===0,E=o.terrain.isZoomDependent();this._previousUpdateTimestamp=this.enabled?this._updateTimestamp:void 0,this._updateTimestamp=r.q.now();const O=o.terrain&&o.terrain.scope,$=y.get("source"),H=w?this._mockSourceCache:o.getSourceCache($,O);if(!H)return void r.w(`Couldn't find terrain source "${$}".`);if(this.sourceCache=H,this._attenuationRange=o.terrain.getAttenuationRange(),this._exaggeration=E?this.calculateExaggeration(l):y.get("exaggeration"),!l.projection.requiresDraping&&E&&this._exaggeration===0)return void this._disable();this.enabled=!0;const G=()=>{this.sourceCache.used&&r.w(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.
This leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const Z=this.getScaledDemTileSize();this.sourceCache.update(l,Z,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,G(),this._initializing=!0),G(),l.updateElevation(!0,m),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(l),this._emptyDEMTextureDirty=!0,this._previousZoom=l.zoom}else this._disable()}calculateExaggeration(o){if(this._attenuationRange&&o.zoom>=Math.ceil(this._attenuationRange[1]))return this._style.terrain.getExaggeration(o.zoom);const l=this._previousCameraAltitude,m=o.getFreeCameraOptions().position.z/o.pixelsPerMeter*o.worldSize;this._previousCameraAltitude=m;const y=l!=null?m-l:Number.MAX_VALUE;if(Math.abs(y)<2)return this._exaggeration;const w=o.zoom,E=this._style.terrain;if(!this._previousUpdateTimestamp)return E.getExaggeration(w);let O=w-this._previousZoom;const $=this._previousUpdateTimestamp;let H=w;this._evaluationZoom!=null&&(H=this._evaluationZoom,Math.abs(w-H)>.5&&(O=.5*(w-H+O)),O*y<0&&(H+=O)),this._evaluationZoom=H;const G=E.getExaggeration(H),Z=G===E.getExaggeration(Math.max(0,H-.1));if(Z&&Math.abs(G-this._exaggeration)<.01)return G;let X=Math.min(.1,.00375*(this._updateTimestamp-$));return(Z||G<.1||Math.abs(O)<1e-4)&&(X=Math.min(.2,4*X)),r.af(this._exaggeration,G,X)}resetTileLookupCache(o){this._findCoveringTileCache[o]={}}attenuationRange(){return this._attenuationRange}getDemUpscale(){return this.proxySourceCache.getSource().tileSize/128}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_onStyleDataEvent(o){o.coord&&o.dataType==="source"?this._clearRenderCacheForTile(o.sourceCacheId,o.coord):o.dataType==="style"&&(this.invalidateRenderCache=!0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this._previousCameraAltitude=void 0)}_disable(){if(this.enabled&&(this.enabled=!1,this._emptyDEMTextureDirty=!0,this._sharedDepthStencil=void 0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const o in this._style._mergedSourceCaches)this._style._mergedSourceCaches[o].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this.pool.forEach(o=>o.fb.destroy()),this.pool=[],this.framebufferCopyTexture&&this.framebufferCopyTexture.destroy()}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this.enabled?this._exaggeration:0}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const o=2*this.proxySourceCache.getSource().tileSize;return[o,o]}set useVertexMorphing(o){this._useVertexMorphing=o}updateTileBinding(o){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const l=this.proxySourceCache,m=this.painter.transform;this._initializing&&(this._initializing=m._centerAltitude===0&&this.getAtPointOrZero(r.aa.fromLngLat(m.center),-1)===-1,this._emptyDEMTextureDirty=!this._initializing);const y=this.proxyCoords=l.getIds().map($=>{const H=l.getTileByID($).tileID;return H.projMatrix=m.calculateProjMatrix(H.toUnwrapped()),H});(function($,H){const G=H.transform.pointCoordinate(H.transform.getCameraPoint()),Z=new r.P(G.x,G.y);$.sort((X,oe)=>{if(oe.overscaledZ-X.overscaledZ)return oe.overscaledZ-X.overscaledZ;const xe=new r.P(X.canonical.x+(1<<X.canonical.z)*X.wrap,X.canonical.y),ve=new r.P(oe.canonical.x+(1<<oe.canonical.z)*oe.wrap,oe.canonical.y),Ce=Z.mult(1<<X.canonical.z);return Ce.x-=.5,Ce.y-=.5,Ce.distSqr(xe)-Ce.distSqr(ve)})})(y,this.painter);const w=this.proxyToSource||{};this.proxyToSource={},y.forEach($=>{this.proxyToSource[$.key]={}}),this.terrainTileForTile={};const E=this._style._mergedSourceCaches;for(const $ in E){const H=E[$];if(!H.used||(H!==this.sourceCache&&this.resetTileLookupCache(H.id),this._setupProxiedCoordsForOrtho(H,o[$],w),H.usedForTerrain))continue;const G=o[$];H.getSource().reparseOverscaled&&this._assignTerrainTiles(G)}this.proxiedCoords[l.id]=y.map($=>new Hg($,$.key,this.orthoMatrix)),this._assignTerrainTiles(y),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(w),this.renderingToTexture=!1;const O={};this._visibleDemTiles=[];for(const $ of this.proxyCoords){const H=this.terrainTileForTile[$.key];if(!H)continue;const G=H.tileID.key;G in O||(this._visibleDemTiles.push(H),O[G]=G)}}_assignTerrainTiles(o){this._initializing||o.forEach(l=>{if(this.terrainTileForTile[l.key])return;const m=this._findTileCoveringTileID(l,this.sourceCache);m&&(this.terrainTileForTile[l.key]=m)})}_prepareDEMTextures(){const o=this.painter.context,l=o.gl;for(const m in this.terrainTileForTile){const y=this.terrainTileForTile[m],w=y.dem;!w||y.demTexture&&!y.needsDEMTextureUpload||(o.activeTexture.set(l.TEXTURE1),Gy(this.painter,y,w))}}_prepareDemTileUniforms(o,l,m,y){if(!l||l.demTexture==null)return!1;const w=o.tileID.canonical,E=Math.pow(2,l.tileID.canonical.z-w.z),O=y||"";return m[`u_dem_tl${O}`]=[w.x*E%1,w.y*E%1],m[`u_dem_scale${O}`]=E,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}_getLoadedAreaMinimum(){if(!this.enabled)return 0;let o=0;const l=this._visibleDemTiles.reduce((m,y)=>{if(!y.dem)return m;const w=y.dem.tree.minimums[0];return w>0&&o++,m+w},0);return o?l/o:0}_updateEmptyDEMTexture(){const o=this.painter.context,l=o.gl;o.activeTexture.set(l.TEXTURE2);const m=this._getLoadedAreaMinimum(),y=new r.cK({width:1,height:1},new Float32Array([m]));this._emptyDEMTextureDirty=!1;let w=this._emptyDEMTexture;return w?w.update(y,{premultiply:!1}):w=this._emptyDEMTexture=new r.T(o,y,l.R32F,{premultiply:!1}),w}setupElevationDraw(o,l,m){const y=this.painter.context,w=y.gl,E={u_dem:2,u_dem_prev:4,u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_depth_range_unpack:[0,1],u_occluder_half_size:16,u_occlusion_depth_offset:-1e-4,u_exaggeration:0};E.u_exaggeration=this.exaggeration();let O=null,$=null,H=1;if(m&&m.morphing&&this._useVertexMorphing){const oe=m.morphing.srcDemTile,xe=m.morphing.dstDemTile;H=m.morphing.phase,oe&&xe&&(this._prepareDemTileUniforms(o,oe,E,"_prev")&&($=oe),this._prepareDemTileUniforms(o,xe,E)&&(O=xe))}const G=oe=>oe&&oe.demTexture&&this.painter.linearFloatFilteringSupported()?w.LINEAR:w.NEAREST;let Z=null;var X;if(this.enabled?$&&O?(Z=O.demTexture,y.activeTexture.set(w.TEXTURE4),$.demTexture.bind(G($),w.CLAMP_TO_EDGE),E.u_dem_lerp=H):(O=this.terrainTileForTile[o.tileID.key],Z=this._prepareDemTileUniforms(o,O,E)?O.demTexture:this.emptyDEMTexture):Z=this.emptyDEMTexture,y.activeTexture.set(w.TEXTURE2),Z&&(E.u_dem_size=(X=Z).size[0]===1?1:X.size[0]-2,Z.bind(G(O),w.CLAMP_TO_EDGE)),this.painter.setupDepthForOcclusion(m&&m.useDepthForOcclusion,l,E),m&&m.useMeterToDem&&O){const oe=(1<<O.tileID.canonical.z)*r.bH(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;E.u_meter_to_dem=oe}if(m&&m.labelPlaneMatrixInv&&(E.u_label_plane_matrix_inv=m.labelPlaneMatrixInv),l.setTerrainUniformValues(y,E),this.painter.transform.projection.name==="globe"){const oe=this.globeUniformValues(this.painter.transform,o.tileID.canonical,m&&m.useDenormalizedUpVectorScale);l.setGlobeUniformValues(y,oe)}}globeUniformValues(o,l,m){const y=o.projection;return{u_tile_tl_up:y.upVector(l,0,0),u_tile_tr_up:y.upVector(l,r.ag,0),u_tile_br_up:y.upVector(l,r.ag,r.ag),u_tile_bl_up:y.upVector(l,0,r.ag),u_tile_up_scale:m?r.cL(1):y.upVectorScale(l,o.center.lat,o.worldSize).metersToTile}}renderToBackBuffer(o){const l=this.painter,m=this.painter.context;o.length!==0&&(m.bindFramebuffer.set(null),m.viewport.set([0,0,l.width,l.height]),l.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(y,w,E,O,$){if(y.transform.projection.name==="globe")(function(H,G,Z,X,oe){const xe=H.context,ve=xe.gl;let Ce,Te;const Le=H.transform,Ge=r.cC(H,xe,Le),He=(tn,Jt)=>{if(Te===Jt)return;const Et=[up[Jt],"PROJECTION_GLOBE_VIEW"];Ge&&Et.push("CUSTOM_ANTIALIASING");const jt=H.isTileAffectedByFog(tn);Ce=H.getOrCreateProgram("globeRaster",{defines:Et,overrideFog:jt}),Te=Jt},rt=H.colorModeForRenderPass(),Xe=new or(ve.LEQUAL,or.ReadWrite,H.depthRangeFor3D);Ws.update(oe);const et=r.cD(Le),Ye=[r.at(Le.center.lng),r.aA(Le.center.lat)],at=H.globeSharedBuffers,gt=[Le.width*r.q.devicePixelRatio,Le.height*r.q.devicePixelRatio],Vt=Float32Array.from(Le.globeMatrix),Rt={useDenormalizedUpVectorScale:!0};{const tn=H.transform,Jt=Mh(tn.zoom,G.exaggeration(),G.sourceCache._source.tileSize);Te=-1;const Et=ve.TRIANGLES;for(const jt of X){const gn=Z.getTile(jt),Tt=fr.disabled,rn=G.prevTerrainTileForTile[jt.key],Ht=G.terrainTileForTile[jt.key];Ug(rn,Ht)&&Ws.newMorphing(jt.key,rn,Ht,oe,250),xe.activeTexture.set(ve.TEXTURE0),gn.texture&&gn.texture.bind(ve.LINEAR,ve.CLAMP_TO_EDGE);const Cn=Ws.getMorphValuesForProxy(jt.key),dn=Cn?1:0;Cn&&r.J(Rt,{morphing:{srcDemTile:Cn.from,dstDemTile:Cn.to,phase:r.cB(Cn.phase)}});const nn=r.cE(jt.canonical),vn=r.cF(nn.getCenter().lat),Tn=r.cG(jt.canonical,nn,vn,tn.worldSize/tn._pixelsPerMercatorPixel),Ln=r.bb(r.cH(jt.canonical)),Un=Sc(tn.expandedFarZProjMatrix,Vt,et,Ln,r.ae(tn.zoom),Ye,tn.frustumCorners.TL,tn.frustumCorners.TR,tn.frustumCorners.BR,tn.frustumCorners.BL,tn.globeCenterInViewSpace,tn.globeRadius,gt,Jt,tn._farZ,Tn);if(He(jt,dn),Ce&&(G.setupElevationDraw(gn,Ce,Rt),H.uploadCommonUniforms(xe,Ce,jt.toUnwrapped()),at)){const[dr,nr,ir]=at.getGridBuffers(vn,Jt!==0);Ce.draw(H,Et,Xe,Tt,rt,_r.backCCW,Un,"globe_raster",dr,nr,ir)}}}if(at&&(H.renderDefaultNorthPole||H.renderDefaultSouthPole)){const tn=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];Ge&&tn.push("CUSTOM_ANTIALIASING"),Ce=H.getOrCreateProgram("globeRaster",{defines:tn});for(const Jt of X){const{x:Et,y:jt,z:gn}=Jt.canonical,Tt=jt===0,rn=jt===(1<<gn)-1,[Ht,Cn,dn,nn]=at.getPoleBuffers(gn,!1);if(nn&&(Tt||rn)){const vn=Z.getTile(Jt);xe.activeTexture.set(ve.TEXTURE0),vn.texture&&vn.texture.bind(ve.LINEAR,ve.CLAMP_TO_EDGE);let Tn=r.cI(gn,Et,Le);const Ln=r.bb(r.cH(Jt.canonical)),Un=(dr,nr)=>dr.draw(H,ve.TRIANGLES,Xe,fr.disabled,rt,_r.disabled,Sc(Le.expandedFarZProjMatrix,Tn,Tn,Ln,0,Ye,Le.frustumCorners.TL,Le.frustumCorners.TR,Le.frustumCorners.BR,Le.frustumCorners.BL,Le.globeCenterInViewSpace,Le.globeRadius,gt,0,Le._farZ),"globe_pole_raster",nr,dn,nn);G.setupElevationDraw(vn,Ce,Rt),H.uploadCommonUniforms(xe,Ce,Jt.toUnwrapped()),Tt&&H.renderDefaultNorthPole&&Un(Ce,Ht),rn&&H.renderDefaultSouthPole&&(Tn=r.ab.mat4.scale(r.ab.mat4.create(),Tn,[1,-1,1]),Un(Ce,Cn))}}}})(y,w,E,O,$);else{const H=y.context,G=H.gl;let Z,X;const oe=y.shadowRenderer,xe=xc(y,y.longestCutoffRange),ve=rt=>{if(X===rt)return;const Xe=[];Xe.push(up[rt]),xe.shouldRenderCutoff&&Xe.push("RENDER_CUTOFF"),oe&&(Xe.push("RENDER_SHADOWS","DEPTH_TEXTURE"),oe.useNormalOffset&&Xe.push("NORMAL_OFFSET")),Z=y.getOrCreateProgram("terrainRaster",{defines:Xe}),X=rt},Ce=y.colorModeForRenderPass(),Te=new or(G.LEQUAL,or.ReadWrite,y.depthRangeFor3D);Ws.update($);const Le=y.transform,Ge=Mh(Le.zoom,w.exaggeration(),w.sourceCache._source.tileSize);let He=[0,0,0];if(oe){const rt=y.style.directionalLight,Xe=y.style.ambientLight;rt&&Xe&&(He=Sg(y.style,rt,Xe))}{X=-1;const rt=G.TRIANGLES,[Xe,et]=[w.gridIndexBuffer,w.gridSegments];for(const Ye of O){const at=E.getTile(Ye),gt=fr.disabled,Vt=w.prevTerrainTileForTile[Ye.key],Rt=w.terrainTileForTile[Ye.key];Ug(Vt,Rt)&&Ws.newMorphing(Ye.key,Vt,Rt,$,250),H.activeTexture.set(G.TEXTURE0),at.texture&&at.texture.bind(G.LINEAR,G.CLAMP_TO_EDGE);const tn=Ws.getMorphValuesForProxy(Ye.key),Jt=tn?1:0;let Et;tn&&(Et={morphing:{srcDemTile:tn.from,dstDemTile:tn.to,phase:r.cB(tn.phase)}});const jt=$g(Ye.projMatrix,Qy(Ye.canonical,Le.renderWorldCopies)?Ge/10:Ge,He);if(ve(Jt),!Z)continue;w.setupElevationDraw(at,Z,Et);const gn=Ye.toUnwrapped();oe&&oe.setupShadows(gn,Z),y.uploadCommonUniforms(H,Z,gn,null,xe),Z.draw(y,rt,Te,gt,Ce,_r.backCCW,jt,"terrain_raster",w.gridBuffer,Xe,et)}}}}(l,this,this.proxySourceCache,o,this._updateTimestamp),this.renderingToTexture=!0,l.gpuTimingDeferredRenderEnd(),o.splice(0,o.length))}renderBatch(o){if(this._drapedRenderBatches.length===0)return o+1;this.renderingToTexture=!0;const l=this.painter,m=this.painter.context,y=this.proxySourceCache,w=this.proxiedCoords[y.id],E=this._drapedRenderBatches.shift(),O=l.style.order,$=[];let H=0;for(const G of w){const Z=y.getTileByID(G.proxyTileKey),X=y.proxyCachedFBO[G.key]?y.proxyCachedFBO[G.key][o]:void 0,oe=X!==void 0?y.renderCache[X]:this.pool[H++],xe=X!==void 0;if(Z.texture=oe.tex,xe&&!oe.dirty){$.push(Z.tileID);continue}let ve;m.bindFramebuffer.set(oe.fb.framebuffer),this.renderedToTile=!1,oe.dirty&&(m.clear({color:r.aj.transparent,stencil:0}),oe.dirty=!1);for(let Ce=E.start;Ce<=E.end;++Ce){const Te=l.style._mergedLayers[O[Ce]];if(Te.isHidden(l.transform.zoom))continue;const Le=l.style.getLayerSourceCache(Te),Ge=Le?this.proxyToSource[G.key][Le.id]:[G];if(!Ge)continue;const He=Ge;m.viewport.set([0,0,oe.fb.width,oe.fb.height]),ve!==(Le?Le.id:null)&&(this._setupStencil(oe,Ge,Te,Le),ve=Le?Le.id:null),l.renderLayer(l,Le,Te,He)}if(this._drapedRenderBatches.length===0)for(const Ce of this._pendingGroundEffectLayers){const Te=l.style._mergedLayers[O[Ce]];if(Te.isHidden(l.transform.zoom))continue;const Le=l.style.getLayerSourceCache(Te),Ge=Le?this.proxyToSource[G.key][Le.id]:[G];if(!Ge)continue;const He=Ge;m.viewport.set([0,0,oe.fb.width,oe.fb.height]),ve!==(Le?Le.id:null)&&(this._setupStencil(oe,Ge,Te,Le),ve=Le?Le.id:null),l.renderLayer(l,Le,Te,He)}this.renderedToTile?(oe.dirty=!0,$.push(Z.tileID)):xe||--H,H===5&&(H=0,this.renderToBackBuffer($))}return this.renderToBackBuffer($),this.renderingToTexture=!1,m.bindFramebuffer.set(null),m.viewport.set([0,0,l.width,l.height]),E.end+1}postRender(){}isLayerOrderingCorrect(o){const l=o.order.length;let m=-1,y=l;for(let w=0;w<l;++w)this._style.isLayerDraped(o._mergedLayers[o.order[w]])?m=Math.max(m,w):y=Math.min(y,w);return y>m}getMinElevationBelowMSL(){let o=0;return this._visibleDemTiles.filter(l=>l.dem).forEach(l=>{o=Math.min(o,l.dem.tree.minimums[0])}),o===0?o:(o-30)*this._exaggeration}raycast(o,l,m){if(!this._visibleDemTiles)return null;const y=this._visibleDemTiles.filter(w=>w.dem).map(w=>{const E=w.tileID,O=1<<E.overscaledZ,{x:$,y:H}=E.canonical,G=$/O,Z=($+1)/O,X=H/O,oe=(H+1)/O;return{minx:G,miny:X,maxx:Z,maxy:oe,t:w.dem.tree.raycastRoot(G,X,Z,oe,o,l,m),tile:w}});y.sort((w,E)=>(w.t!==null?w.t:Number.MAX_VALUE)-(E.t!==null?E.t:Number.MAX_VALUE));for(const w of y){if(w.t==null)return null;const E=w.tile.dem.tree.raycast(w.minx,w.miny,w.maxx,w.maxy,o,l,m);if(E!=null)return E}return null}_createFBO(){const o=this.painter.context,l=o.gl,m=this.drapeBufferSize;o.activeTexture.set(l.TEXTURE0);const y=new r.T(o,{width:m[0],height:m[1],data:null},l.RGBA8);y.bind(l.LINEAR,l.CLAMP_TO_EDGE);const w=o.createFramebuffer(m[0],m[1],!0,null);return w.colorAttachment.set(y.texture),w.depthAttachment=new Jy(o,w.framebuffer),this._sharedDepthStencil===void 0?(this._sharedDepthStencil=o.createRenderbuffer(o.gl.DEPTH_STENCIL,m[0],m[1]),this._stencilRef=0,w.depthAttachment.set(this._sharedDepthStencil),o.clear({stencil:0})):w.depthAttachment.set(this._sharedDepthStencil),o.extTextureFilterAnisotropic&&l.texParameterf(l.TEXTURE_2D,o.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,o.extTextureFilterAnisotropicMax),{fb:w,tex:y,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._debugParams.disableRenderCache||this._style.hasLightTransitions())return!0;for(const o in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[o].hasTransition())return!0;return this._style.order.some(o=>{const l=this._style._mergedLayers[o],m=l.isHidden(this.painter.transform.zoom);return l.type==="hillshade"||l.type==="custom"?!m&&l.shouldRedrape():!m&&l.hasTransition()})}_clearLineLayersFromRenderCache(){let o=!1;for(const m of this._style.getSources())if(m instanceof fi){o=!0;break}if(!o)return;const l={};for(let m=0;m<this._style.order.length;++m){const y=this._style._mergedLayers[this._style.order[m]],w=this._style.getLayerSourceCache(y);if(w&&!l[w.id]&&!y.isHidden(this.painter.transform.zoom)&&y.type==="line"&&y.widthExpression()instanceof r.a9){l[w.id]=!0;for(const E of this.proxyCoords){const O=this.proxyToSource[E.key][w.id];if(O)for(const $ of O)this._clearRenderCacheForTile(w.id,$)}}}}_clearRasterLayersFromRenderCache(){let o=!1;for(const m in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[m]._source instanceof el){o=!0;break}if(!o)return;const l={};for(let m=0;m<this._style.order.length;++m){const y=this._style._mergedLayers[this._style.order[m]],w=this._style.getLayerSourceCache(y);if(!w||l[w.id]||y.isHidden(this.painter.transform.zoom)||y.type!=="raster")continue;const E=y.paint.get("raster-fade-duration");for(const O of this.proxyCoords){const $=this.proxyToSource[O.key][w.id];if($)for(const H of $){const G=Ih(w.getTile(H),w.findLoadedParent(H,0),w,this.painter.transform,E);(G.opacity!==1||G.mix!==0)&&this._clearRenderCacheForTile(w.id,H)}}}}_setupDrapedRenderBatches(){this._style.updateDrapeFirstLayers();const o=this._style.order,l=o.length;if(l===0)return;const m=[];this._pendingGroundEffectLayers=[];let y,w=0,E=this._style._mergedLayers[o[w]];for(;!this._style.isLayerDraped(E)&&E.isHidden(this.painter.transform.zoom)&&++w<l;)E=this._style._mergedLayers[o[w]];for(;w<l;++w){const O=this._style._mergedLayers[o[w]];O.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(O)?y===void 0&&(y=w):(O.type==="fill-extrusion"&&this._pendingGroundEffectLayers.push(w),y!==void 0&&(m.push({start:y,end:w-1}),y=void 0)))}if(y!==void 0&&m.push({start:y,end:w-1}),m.length!==0){const O=m[m.length-1];this._pendingGroundEffectLayers.every($=>$>O.end)||r.w("fill-extrusion with flood lighting and/or ground ambient occlusion should be moved to be on top of all draped layers.")}this._drapedRenderBatches=m}_setupRenderCache(o){const l=this.proxySourceCache;if(this._shouldDisableRenderCache()||this.invalidateRenderCache){if(this.invalidateRenderCache=!1,l.renderCache.length>l.renderCachePool.length){const E=Object.values(l.proxyCachedFBO);l.proxyCachedFBO={};for(let O=0;O<E.length;++O){const $=Object.values(E[O]);l.renderCachePool.push(...$)}}return}this._clearRasterLayersFromRenderCache();const m=this.proxyCoords,y=this._tilesDirty;for(let E=m.length-1;E>=0;E--){const O=m[E];if(l.getTileByID(O.key),l.proxyCachedFBO[O.key]!==void 0){const $=o[O.key],H=this.proxyToSource[O.key];let G=0;for(const Z in H){const X=H[Z],oe=$[Z];if(!oe||oe.length!==X.length||X.some((xe,ve)=>xe!==oe[ve]||y[Z]&&y[Z].hasOwnProperty(xe.key))){G=-1;break}++G}for(const Z in l.proxyCachedFBO[O.key])l.renderCache[l.proxyCachedFBO[O.key][Z]].dirty=G<0||G!==Object.values($).length}}const w=[...this._drapedRenderBatches];w.sort((E,O)=>O.end-O.start-(E.end-E.start));for(const E of w)for(const O of m){if(l.proxyCachedFBO[O.key])continue;let $=l.renderCachePool.pop();$===void 0&&l.renderCache.length<50&&($=l.renderCache.length,l.renderCache.push(this._createFBO())),$!==void 0&&(l.proxyCachedFBO[O.key]={},l.proxyCachedFBO[O.key][E.start]=$,l.renderCache[$].dirty=!0)}this._tilesDirty={}}_setupStencil(o,l,m,y){if(!y||!this._sourceTilesOverlap[y.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const w=this.painter.context,E=w.gl;if(l.length<=1)return void(this._overlapStencilType=!1);let O;if(m.isTileClipped())O=l.length,this._overlapStencilMode.test={func:E.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(l[0].overscaledZ>l[l.length-1].overscaledZ))return void(this._overlapStencilType=!1);O=1,this._overlapStencilMode.test={func:E.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+O>255&&(w.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=O,this._overlapStencilMode.ref=this._stencilRef,m.isTileClipped()&&this._renderTileClippingMasks(l,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return this._overlapStencilType==="Clip"||this._overlapStencilType==="Mask"}stencilModeForRTTOverlap(o){return this.renderingToTexture&&this._overlapStencilType?(this._overlapStencilType==="Clip"&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[o.key]),this._overlapStencilMode):fr.disabled}_renderTileClippingMasks(o,l){const m=this.painter,y=this.painter.context,w=y.gl;m._tileClippingMaskIDs={},y.setColorMode(Lr.disabled),y.setDepthMode(or.disabled);const E=m.getOrCreateProgram("clippingMask");for(const O of o){const $=m._tileClippingMaskIDs[O.key]=--l;E.draw(m,w.TRIANGLES,or.disabled,new fr({func:w.ALWAYS,mask:0},$,255,w.KEEP,w.KEEP,w.REPLACE),Lr.disabled,_r.disabled,dp(O.projMatrix),"$clipping",m.tileExtentBuffer,m.quadTriangleIndexBuffer,m.tileExtentSegments)}}pointCoordinate(o){const l=this.painter.transform;if(o.x<0||o.x>l.width||o.y<0||o.y>l.height)return null;const m=[o.x,o.y,1,1];r.ab.vec4.transformMat4(m,m,l.pixelMatrixInverse),r.ab.vec4.scale(m,m,1/m[3]),m[0]/=l.worldSize,m[1]/=l.worldSize;const y=l._camera.position,w=r.bH(1,l.center.lat),E=[y[0],y[1],y[2]/w,0],O=r.ab.vec3.subtract([],m.slice(0,3),E);r.ab.vec3.normalize(O,O);const $=this.raycast(E,O,this._exaggeration);return $!==null&&$?(r.ab.vec3.scaleAndAdd(E,E,O,$),E[3]=E[2],E[2]*=w,E):null}_setupProxiedCoordsForOrtho(o,l,m){if(o.getSource()instanceof r.aJ)return this._setupProxiedCoordsForImageSource(o,l,m);this._findCoveringTileCache[o.id]=this._findCoveringTileCache[o.id]||{};const y=this.proxiedCoords[o.id]=[],w=this.proxyCoords;for(let $=0;$<w.length;$++){const H=w[$],G=this._findTileCoveringTileID(H,o);if(G){const Z=this._createProxiedId(H,G,m[H.key]&&m[H.key][o.id]);y.push(Z),this.proxyToSource[H.key][o.id]=[Z]}}let E=!1;const O=new Set;for(let $=0;$<l.length;$++){const H=o.getTile(l[$]);if(!H||!H.hasData())continue;const G=this._findTileCoveringTileID(H.tileID,this.proxySourceCache);if(G&&G.tileID.canonical.z!==H.tileID.canonical.z){const Z=this.proxyToSource[G.tileID.key][o.id],X=this._createProxiedId(G.tileID,H,m[G.tileID.key]&&m[G.tileID.key][o.id]);Z?Z.splice(Z.length-1,0,X):this.proxyToSource[G.tileID.key][o.id]=[X];const oe=this.proxyToSource[G.tileID.key][o.id];O.has(oe)||O.add(oe),y.push(X),E=!0}}if(this._sourceTilesOverlap[o.id]=E,E&&this._debugParams.sortTilesHiZFirst)for(const $ of O)$.sort((H,G)=>G.overscaledZ-H.overscaledZ)}_setupProxiedCoordsForImageSource(o,l,m){if(!o.getSource().loaded())return;const y=this.proxiedCoords[o.id]=[],w=this.proxyCoords,E=o.getSource(),O=E.tileID;if(!O)return;const $=new r.P(O.x,O.y)._div(1<<O.z),H=E.coordinates.map(r.aa.fromLngLat).reduce((Z,X)=>(Z.min.x=Math.min(Z.min.x,X.x-$.x),Z.min.y=Math.min(Z.min.y,X.y-$.y),Z.max.x=Math.max(Z.max.x,X.x-$.x),Z.max.y=Math.max(Z.max.y,X.y-$.y),Z),{min:new r.P(Number.MAX_VALUE,Number.MAX_VALUE),max:new r.P(-Number.MAX_VALUE,-Number.MAX_VALUE)}),G=(Z,X)=>{const oe=Z.wrap+Z.canonical.x/(1<<Z.canonical.z),xe=Z.canonical.y/(1<<Z.canonical.z),ve=r.ag/(1<<Z.canonical.z),Ce=X.wrap+X.canonical.x/(1<<X.canonical.z),Te=X.canonical.y/(1<<X.canonical.z);return oe+ve<Ce+H.min.x||oe>Ce+H.max.x||xe+ve<Te+H.min.y||xe>Te+H.max.y};for(let Z=0;Z<w.length;Z++){const X=w[Z];for(let oe=0;oe<l.length;oe++){const xe=o.getTile(l[oe]);if(!xe||!xe.hasData()||G(X,xe.tileID))continue;const ve=this._createProxiedId(X,xe,m[X.key]&&m[X.key][o.id]),Ce=this.proxyToSource[X.key][o.id];Ce?Ce.push(ve):this.proxyToSource[X.key][o.id]=[ve],y.push(ve)}}}_createProxiedId(o,l,m){let y=this.orthoMatrix;if(m){const w=m.find(E=>E.key===l.tileID.key);if(w)return w}if(l.tileID.key!==o.key){const w=o.canonical.z-l.tileID.canonical.z;let E,O,$;y=r.ab.mat4.create();const H=l.tileID.wrap-o.wrap<<o.overscaledZ;w>0?(E=r.ag>>w,O=E*((l.tileID.canonical.x<<w)-o.canonical.x+H),$=E*((l.tileID.canonical.y<<w)-o.canonical.y)):(E=r.ag<<-w,O=r.ag*(l.tileID.canonical.x-(o.canonical.x+H<<-w)),$=r.ag*(l.tileID.canonical.y-(o.canonical.y<<-w))),r.ab.mat4.ortho(y,0,E,0,E,0,1),r.ab.mat4.translate(y,y,[O,$,0])}return new Hg(l.tileID,o.key,y)}_findTileCoveringTileID(o,l){let m=l.getTile(o);if(m&&m.hasData())return m;const y=this._findCoveringTileCache[l.id],w=y[o.key];if(m=w?l.getTileByID(w):null,m&&m.hasData()||w===null)return m;let E=m?m.tileID:o,O=E.overscaledZ;const $=l.getSource().minzoom,H=[];if(!w){const Z=l.getSource().maxzoom;if(o.canonical.z>=Z){const X=o.canonical.z-Z;l.getSource().reparseOverscaled?(O=Math.max(o.canonical.z+2,l.transform.tileZoom),E=new r.aG(O,o.wrap,Z,o.canonical.x>>X,o.canonical.y>>X)):X!==0&&(O=Z,E=new r.aG(O,o.wrap,Z,o.canonical.x>>X,o.canonical.y>>X))}E.key!==o.key&&(H.push(E.key),m=l.getTile(E))}const G=Z=>{H.forEach(X=>{y[X]=Z}),H.length=0};for(O-=1;O>=$&&(!m||!m.hasData());O--){m&&G(m.tileID.key);const Z=E.calculateScaledKey(O);if(m=l.getTileByID(Z),m&&m.hasData())break;const X=y[Z];if(X===null)break;X===void 0?H.push(Z):m=l.getTileByID(X)}return G(m?m.tileID.key:null),m&&m.hasData()?m:null}findDEMTileFor(o){return this.enabled?this._findTileCoveringTileID(o,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(o,l){let m=this._tilesDirty[o];m||(m=this._tilesDirty[o]={}),m[l.key]=!0}}function sw(f,o,l){const m=function(O,$,H){const G=r.ab.vec3.dot($,O),Z=r.ab.vec3.dot(H,[.2126,.7152,.0722]),X=(xe,ve,Ce)=>(1-Ce)*xe+Ce*ve,oe=X(1-.3*Math.min(Z,1),1,Math.min(G+1,1));return X(.92,1,Math.asin(r.aw($[2],-1,1))/Math.PI+.5)*oe}(f,[0,0,1],o),y=[0,0,0];r.ab.vec3.scale(y,l.slice(0,3),m);const w=[0,0,0];r.ab.vec3.scale(w,o.slice(0,3),f[2]);const E=[0,0,0];return r.ab.vec3.add(E,y,w),r.cf(E)}const aw=["fill","fillOutline","fillPattern","line","linePattern","background","backgroundPattern","hillshade","raster"],e0=["stars","rainParticle","snowParticle","fillExtrusion","fillExtrusionGroundEffect","model","symbol"];class t0{static cacheKey(o,l,m,y){let w=`${l}${y?y.cacheKey:""}`;for(const E of m)o.usedDefines.includes(E)&&(w+=`/${E}`);return w}constructor(o,l,m,y,w,E){const O=o.gl;this.program=O.createProgram(),this.configuration=y,this.name=l,this.fixedDefines=[...E];const $=y?y.getBinderAttributes():[],H=(m.staticAttributes||[]).concat($);let G=y?y.defines():[];G=G.concat(E.map(Ce=>`#define ${Ce}`));const Z=`#version 300 es
`;let X=Z+G.concat("precision mediump float;",Th,op.fragmentSource).join(`
`);for(const Ce of m.fragmentIncludes)X+=`
${Ju[Ce]}`;X+=`
${m.fragmentSource}`;let oe=Z+G.concat("precision highp float;",Th,op.vertexSource).join(`
`);for(const Ce of m.vertexIncludes)oe+=`
${Ju[Ce]}`;this.forceManualRenderingForInstanceIDShaders=o.forceManualRenderingForInstanceIDShaders&&m.vertexSource.indexOf("gl_InstanceID")!==-1,this.forceManualRenderingForInstanceIDShaders&&(oe+=`
uniform int u_instanceID;
`),oe+=`
${m.vertexSource}`,this.forceManualRenderingForInstanceIDShaders&&(oe=oe.replaceAll("gl_InstanceID","u_instanceID"));const xe=O.createShader(O.FRAGMENT_SHADER);if(O.isContextLost())return void(this.failedToCreate=!0);O.shaderSource(xe,X),O.compileShader(xe),O.attachShader(this.program,xe);const ve=O.createShader(O.VERTEX_SHADER);if(O.isContextLost())this.failedToCreate=!0;else{O.shaderSource(ve,oe),O.compileShader(ve),O.attachShader(this.program,ve),this.attributes={},this.numAttributes=H.length;for(let Ce=0;Ce<this.numAttributes;Ce++)if(H[Ce]){const Te=H[Ce].startsWith("a_")?H[Ce]:`a_${H[Ce]}`;O.bindAttribLocation(this.program,Ce,Te),this.attributes[Te]=Ce}O.linkProgram(this.program),O.deleteShader(ve),O.deleteShader(xe),this.fixedUniforms=w(o),this.binderUniforms=y?y.getUniforms(o):[],this.forceManualRenderingForInstanceIDShaders&&(this.instancingUniforms=(Ce=>({u_instanceID:new r.bN(Ce)}))(o)),(E.includes("TERRAIN")||l.indexOf("symbol")!==-1||l.indexOf("circle")!==-1)&&(this.terrainUniforms=(Ce=>({u_dem:new r.bN(Ce),u_dem_prev:new r.bN(Ce),u_dem_tl:new r.bK(Ce),u_dem_scale:new r.bM(Ce),u_dem_tl_prev:new r.bK(Ce),u_dem_scale_prev:new r.bM(Ce),u_dem_size:new r.bM(Ce),u_dem_lerp:new r.bM(Ce),u_exaggeration:new r.bM(Ce),u_depth:new r.bN(Ce),u_depth_size_inv:new r.bK(Ce),u_depth_range_unpack:new r.bK(Ce),u_occluder_half_size:new r.bM(Ce),u_occlusion_depth_offset:new r.bM(Ce),u_meter_to_dem:new r.bM(Ce),u_label_plane_matrix_inv:new r.bJ(Ce)}))(o)),E.includes("GLOBE")&&(this.globeUniforms=(Ce=>({u_tile_tl_up:new r.bL(Ce),u_tile_tr_up:new r.bL(Ce),u_tile_br_up:new r.bL(Ce),u_tile_bl_up:new r.bL(Ce),u_tile_up_scale:new r.bM(Ce)}))(o)),E.includes("FOG")&&(this.fogUniforms=(Ce=>({u_fog_matrix:new r.bJ(Ce),u_fog_range:new r.bK(Ce),u_fog_color:new r.ca(Ce),u_fog_horizon_blend:new r.bM(Ce),u_fog_vertical_limit:new r.bK(Ce),u_fog_temporal_offset:new r.bM(Ce),u_frustum_tl:new r.bL(Ce),u_frustum_tr:new r.bL(Ce),u_frustum_br:new r.bL(Ce),u_frustum_bl:new r.bL(Ce),u_globe_pos:new r.bL(Ce),u_globe_radius:new r.bM(Ce),u_globe_transition:new r.bM(Ce),u_is_globe:new r.bN(Ce),u_viewport:new r.bK(Ce)}))(o)),E.includes("RENDER_CUTOFF")&&(this.cutoffUniforms=(Ce=>({u_cutoff_params:new r.ca(Ce)}))(o)),E.includes("LIGHTING_3D_MODE")&&(this.lightsUniforms=(Ce=>({u_lighting_ambient_color:new r.bL(Ce),u_lighting_directional_dir:new r.bL(Ce),u_lighting_directional_color:new r.bL(Ce),u_ground_radiance:new r.bL(Ce)}))(o)),E.includes("RENDER_SHADOWS")&&(this.shadowUniforms=(Ce=>({u_light_matrix_0:new r.bJ(Ce),u_light_matrix_1:new r.bJ(Ce),u_fade_range:new r.bK(Ce),u_shadow_normal_offset:new r.bL(Ce),u_shadow_intensity:new r.bM(Ce),u_shadow_texel_size:new r.bM(Ce),u_shadow_map_resolution:new r.bM(Ce),u_shadow_direction:new r.bL(Ce),u_shadow_bias:new r.bL(Ce),u_shadowmap_0:new r.bN(Ce),u_shadowmap_1:new r.bN(Ce)}))(o))}}setTerrainUniformValues(o,l){if(!this.terrainUniforms)return;const m=this.terrainUniforms;if(!this.failedToCreate){o.program.set(this.program);for(const y in l)m[y]&&m[y].set(this.program,y,l[y])}}setGlobeUniformValues(o,l){if(!this.globeUniforms)return;const m=this.globeUniforms;if(!this.failedToCreate){o.program.set(this.program);for(const y in l)m[y]&&m[y].set(this.program,y,l[y])}}setFogUniformValues(o,l){if(!this.fogUniforms)return;const m=this.fogUniforms;if(!this.failedToCreate){o.program.set(this.program);for(const y in l)m[y].set(this.program,y,l[y])}}setCutoffUniformValues(o,l){if(!this.cutoffUniforms)return;const m=this.cutoffUniforms;if(!this.failedToCreate){o.program.set(this.program);for(const y in l)m[y].set(this.program,y,l[y])}}setLightsUniformValues(o,l){if(!this.lightsUniforms)return;const m=this.lightsUniforms;if(!this.failedToCreate){o.program.set(this.program);for(const y in l)m[y].set(this.program,y,l[y])}}setShadowUniformValues(o,l){if(this.failedToCreate||!this.shadowUniforms)return;const m=this.shadowUniforms;o.program.set(this.program);for(const y in l)m[y].set(this.program,y,l[y])}_drawDebugWireframe(o,l,m,y,w,E,O,$,H,G){const Z=o.options.wireframe;if(Z.terrain===!1&&Z.layers2D===!1&&Z.layers3D===!1)return;const X=o.context;if(!(!(!Z.terrain||this.name!=="terrainRaster"&&this.name!=="globeRaster")||!(!Z.layers2D||o._terrain&&o._terrain.renderingToTexture||!aw.includes(this.name))||!(!Z.layers3D||!e0.includes(this.name))))return;const oe=X.gl,xe=o.wireframeDebugCache.getLinesFromTrianglesBuffer(o.frameCounter,w,X);if(!xe)return;const ve=[...this.fixedDefines];ve.push("DEBUG_WIREFRAME");const Ce=o.getOrCreateProgram(this.name,{config:this.configuration,defines:ve});X.program.set(Ce.program);const Te=(He,rt,Xe)=>{if(rt[He]&&Xe[He])for(const et in rt[He])Xe[He][et]&&Xe[He][et].set(Xe.program,et,rt[He][et].current)};H&&H.setUniforms(Ce.program,X,Ce.binderUniforms,O,{zoom:$}),Te("fixedUniforms",this,Ce),Te("terrainUniforms",this,Ce),Te("globeUniforms",this,Ce),Te("fogUniforms",this,Ce),Te("lightsUniforms",this,Ce),Te("shadowUniforms",this,Ce),xe.bind(),X.setColorMode(new Lr([oe.ONE,oe.ONE_MINUS_SRC_ALPHA,oe.ZERO,oe.ONE],r.aj.transparent,[!0,!0,!0,!1])),X.setDepthMode(new or(l.func===oe.LESS?oe.LEQUAL:l.func,or.ReadOnly,l.range)),X.setStencilMode(fr.disabled);const Le=3*E.primitiveLength*2,Ge=3*E.primitiveOffset*2*2;if(this.forceManualRenderingForInstanceIDShaders){const He=G||1;for(let rt=0;rt<He;++rt)Ce.instancingUniforms.u_instanceID.set(this.program,"u_instanceID",rt),oe.drawElements(oe.LINES,Le,oe.UNSIGNED_SHORT,Ge)}else G&&G>1?oe.drawElementsInstanced(oe.LINES,Le,oe.UNSIGNED_SHORT,Ge,G):oe.drawElements(oe.LINES,Le,oe.UNSIGNED_SHORT,Ge);w.bind(),X.program.set(this.program),X.setDepthMode(l),X.setStencilMode(m),X.setColorMode(y)}checkUniforms(o,l,m){if(this.fixedDefines.includes(l)){for(const y of Object.keys(m))if(!m[y].initialized)throw new Error(`Program '${this.name}', from draw '${o}': uniform ${y} not set but required by ${l} being defined`)}}draw(o,l,m,y,w,E,O,$,H,G,Z,X,oe,xe,ve,Ce){const Te=o.context,Le=Te.gl;if(this.failedToCreate)return;Te.program.set(this.program),Te.setDepthMode(m),Te.setStencilMode(y),Te.setColorMode(w),Te.setCullFace(E);for(const rt of Object.keys(this.fixedUniforms))this.fixedUniforms[rt].set(this.program,rt,O[rt]);xe&&xe.setUniforms(this.program,Te,this.binderUniforms,X,{zoom:oe});const Ge={[Le.POINTS]:1,[Le.LINES]:2,[Le.TRIANGLES]:3,[Le.LINE_STRIP]:1}[l];this.checkUniforms($,"RENDER_SHADOWS",this.shadowUniforms);const He=Ce&&Ce>0?1:void 0;for(const rt of Z.get()){const Xe=rt.vaos||(rt.vaos={});if((Xe[$]||(Xe[$]=new jy)).bind(Te,this,H,xe?xe.getPaintVertexBuffers():[],G,rt.vertexOffset,ve||[],He),this.forceManualRenderingForInstanceIDShaders){const et=Ce||1;for(let Ye=0;Ye<et;++Ye)this.instancingUniforms.u_instanceID.set(this.program,"u_instanceID",Ye),G?Le.drawElements(l,rt.primitiveLength*Ge,Le.UNSIGNED_SHORT,rt.primitiveOffset*Ge*2):Le.drawArrays(l,rt.vertexOffset,rt.vertexLength)}else Ce&&Ce>1?Le.drawElementsInstanced(l,rt.primitiveLength*Ge,Le.UNSIGNED_SHORT,rt.primitiveOffset*Ge*2,Ce):G?Le.drawElements(l,rt.primitiveLength*Ge,Le.UNSIGNED_SHORT,rt.primitiveOffset*Ge*2):Le.drawArrays(l,rt.vertexOffset,rt.vertexLength);l===Le.TRIANGLES&&G&&this._drawDebugWireframe(o,m,y,w,G,rt,X,oe,xe,Ce)}}}function hp(f,o){const l=Math.pow(2,o.tileID.overscaledZ),m=o.tileSize*Math.pow(2,f.transform.tileZoom)/l,y=m*(o.tileID.canonical.x+o.tileID.wrap*l),w=m*o.tileID.canonical.y;return{u_image:0,u_texsize:o.imageAtlasTexture?o.imageAtlasTexture.size:[0,0],u_tile_units_to_pixels:1/r.ar(o,1,f.transform.tileZoom),u_pixel_coord_upper:[y>>16,w>>16],u_pixel_coord_lower:[65535&y,65535&w]}}const od={terrain:0,flat:1},id=r.ab.mat4.create(),fp=(f,o,l,m,y,w,E,O,$,H,G,Z,X,oe,xe,ve,Ce,Te)=>{const Le=o.style.light,Ge=Le.properties.get("position"),He=[Ge.x,Ge.y,Ge.z],rt=r.ab.mat3.create();Le.properties.get("anchor")==="viewport"&&(r.ab.mat3.fromRotation(rt,-o.transform.angle),r.ab.vec3.transformMat3(He,He,rt));const Xe=Le.properties.get("color"),et=o.transform,Ye={u_matrix:f,u_lightpos:He,u_lightintensity:Le.properties.get("intensity"),u_lightcolor:[Xe.r,Xe.g,Xe.b],u_vertical_gradient:+l,u_opacity:m,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:id,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_height_type:od[H],u_base_type:od[G],u_ao:y,u_edge_radius:w,u_width_scale:E,u_flood_light_color:xe,u_vertical_scale:ve,u_flood_light_intensity:Ce,u_ground_shadow_factor:Te};return et.projection.name==="globe"&&(Ye.u_tile_id=[O.canonical.x,O.canonical.y,1<<O.canonical.z],Ye.u_zoom_transition=Z,Ye.u_inv_rot_matrix=oe,Ye.u_merc_center=X,Ye.u_up_dir=et.projection.upVector(new r.bT(0,0,0),X[0]*r.ag,X[1]*r.ag),Ye.u_height_lift=$),Ye},Ah=(f,o,l,m,y,w)=>({u_matrix:f,u_edge_radius:o,u_width_scale:l,u_vertical_scale:m,u_height_type:od[y],u_base_type:od[w]}),n0=(f,o,l,m,y,w,E,O,$,H,G,Z,X,oe,xe,ve,Ce)=>{const Te=fp(f,o,l,m,y,w,E,O,H,G,Z,X,oe,xe,ve,Ce,1,[0,0,0]),Le={u_height_factor:-Math.pow(2,O.overscaledZ)/$.tileSize/8};return r.l(Te,hp(o,$),Le)},kh=(f,o)=>({u_matrix:f,u_emissive_strength:o}),Ph=(f,o,l,m)=>r.l(kh(f,o),hp(l,m)),Gg=(f,o,l)=>({u_matrix:f,u_world:l,u_emissive_strength:o}),r0=(f,o,l,m,y)=>r.l(Ph(f,o,l,m),{u_world:y}),lw=(f,o,l,m)=>{const y=r.ag/l.tileSize;return{u_matrix:f,u_camera_to_center_distance:o.getCameraToCenterDistance(m),u_extrude_scale:[o.pixelsToGLUnits[0]/y,o.pixelsToGLUnits[1]/y]}},hu=(f,o,l=1)=>({u_matrix:f,u_color:o.toRenderColor(null),u_overlay:0,u_overlay_scale:l}),pp=r.ab.mat4.create(),Hn=(f,o,l,m,y,w,E)=>{const O=f.transform,$=O.projection.name==="globe",H=$?r.cN(O.zoom,o.canonical)*O._pixelsPerMercatorPixel:r.ar(l,1,w),G={u_matrix:o.projMatrix,u_extrude_scale:H,u_intensity:E,u_inv_rot_matrix:pp,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if($){G.u_inv_rot_matrix=m,G.u_merc_center=y,G.u_tile_id=[o.canonical.x,o.canonical.y,1<<o.canonical.z],G.u_zoom_transition=r.ae(O.zoom);const Z=y[0]*r.ag,X=y[1]*r.ag;G.u_up_dir=O.projection.upVector(new r.bT(0,0,0),Z,X)}return G};function Wg(f,[o,l,m,y],[w,E]){if(w===E)return[0,0,0,0];const O=255*(f-1)/(f*(E-w));return[o*O,l*O,m*O,y*O]}function qg(f,o,[l,m]){return l===m?0:.5/f+(o-l)*(f-1)/(f*(m-l))}const Tc=(f,o,l,m,y,w,E,O,$,H,G,Z,X,oe,xe,ve,Ce,Te,Le,Ge,He)=>({u_matrix:f,u_normalize_matrix:o,u_globe_matrix:l,u_merc_matrix:m,u_grid_matrix:y,u_tl_parent:w,u_scale_parent:H,u_fade_t:G.mix,u_opacity:G.opacity*Z.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:Z.paint.get("raster-brightness-min"),u_brightness_high:Z.paint.get("raster-brightness-max"),u_saturation_factor:r.cO(Z.paint.get("raster-saturation")),u_contrast_factor:r.cP(Z.paint.get("raster-contrast")),u_spin_weights:fu(Z.paint.get("raster-hue-rotate")),u_perspective_transform:X,u_raster_elevation:oe,u_zoom_transition:E,u_merc_center:O,u_cutoff_params:$,u_colorization_mix:Wg(r.cQ,ve,Te),u_colorization_offset:qg(r.cQ,Ce,Te),u_color_ramp:xe,u_texture_offset:[Ge/(Le+2*Ge),Le/(Le+2*Ge)],u_texture_res:[Le+2*Ge,Le+2*Ge],u_emissive_strength:He});function fu(f){f*=Math.PI/180;const o=Math.sin(f),l=Math.cos(f);return[(2*l+1)/3,(-Math.sqrt(3)*o-l+1)/3,(Math.sqrt(3)*o-l+1)/3]}const Xn=.05,Kg=(f,o,l,m,y,w,E,O,$,H,G,Z)=>({u_matrix:f,u_normalize_matrix:o,u_globe_matrix:l,u_merc_matrix:m,u_grid_matrix:y,u_tl_parent:w,u_scale_parent:H,u_fade_t:G.mix,u_opacity:G.opacity,u_image0:0,u_image1:1,u_raster_elevation:Z,u_zoom_transition:E,u_merc_center:O,u_cutoff_params:$}),cw=(f,o,l,m,y,w,E,O,$,H)=>({u_particle_texture:f,u_particle_texture_side_len:o,u_tile_offset:l,u_velocity:m,u_color_ramp:w,u_velocity_res:y,u_max_speed:E,u_uv_offset:O,u_data_scale:[255*$[0],255*$[1]],u_data_offset:H,u_particle_pos_scale:1.1,u_particle_pos_offset:[Xn,Xn]}),uw=(f,o,l,m,y,w,E,O,$,H)=>({u_particle_texture:f,u_particle_texture_side_len:o,u_velocity:l,u_velocity_res:m,u_max_speed:y,u_speed_factor:w,u_reset_rate:E,u_rand_seed:Math.random(),u_uv_offset:O,u_data_scale:[255*$[0],255*$[1]],u_data_offset:H,u_particle_pos_scale:1.1,u_particle_pos_offset:[Xn,Xn]}),mp=r.ab.mat4.create(),Zg=(f,o,l,m,y,w,E,O,$,H,G,Z,X,oe,xe,ve,Ce,Te,Le,Ge,He,rt)=>{const Xe=y.transform,et={u_is_size_zoom_constant:+(f==="constant"||f==="source"),u_is_size_feature_constant:+(f==="constant"||f==="camera"),u_size_t:o?o.uSizeT:0,u_size:o?o.uSize:0,u_camera_to_center_distance:Xe.getCameraToCenterDistance(Le),u_rotate_symbol:+l,u_aspect_ratio:Xe.width/Xe.height,u_fade_change:y.options.fadeDuration?y.symbolFadeChange:1,u_matrix:w,u_label_plane_matrix:E,u_coord_matrix:O,u_is_text:+H,u_elevation_from_sea:$?1:0,u_pitch_with_map:+m,u_texsize:G,u_texsize_icon:Z,u_texture:0,u_texture_icon:1,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:mp,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:mp,u_up_vector:[0,-1,0],u_color_adj_mat:Ge,u_icon_transition:He||0,u_gamma_scale:m?y.transform.getCameraToCenterDistance(Le)*Math.cos(y.terrain?0:y.transform._pitch):1,u_device_pixel_ratio:r.q.devicePixelRatio,u_is_halo:1,u_scale_factor:rt||1};return Le.name==="globe"&&(et.u_tile_id=[oe.canonical.x,oe.canonical.y,1<<oe.canonical.z],et.u_zoom_transition=xe,et.u_inv_rot_matrix=Ce,et.u_merc_center=ve,et.u_camera_forward=Xe._camera.forward(),et.u_ecef_origin=r.cR(Xe.globeMatrix,oe.toUnwrapped()),et.u_tile_matrix=Float32Array.from(Xe.globeMatrix),et.u_up_vector=Te),et},Yg=(f,o,l,m)=>({u_matrix:f,u_emissive_strength:o,u_opacity:l,u_color:m}),o0=(f,o,l,m,y,w,E,O,$)=>r.l(function(H,G,Z,X,oe,xe){const{width:ve,height:Ce}=X.imageManager.getPixelSize(G),Te=Math.pow(2,xe.tileID.overscaledZ),Le=xe.tileSize*Math.pow(2,X.transform.tileZoom)/Te,Ge=Le*(xe.tileID.canonical.x+xe.tileID.wrap*Te),He=Le*xe.tileID.canonical.y;return{u_image:0,u_pattern_tl:Z.tl,u_pattern_br:Z.br,u_texsize:[ve,Ce],u_pattern_size:Z.displaySize,u_pattern_units_to_pixels:oe?[X.transform.width,-1*X.transform.height]:[1/r.ar(xe,1,X.transform.tileZoom),1/r.ar(xe,1,X.transform.tileZoom)],u_pixel_coord_upper:[Ge>>16,He>>16],u_pixel_coord_lower:[65535&Ge,65535&He]}}(0,w,E,m,O,$),{u_matrix:f,u_emissive_strength:o,u_opacity:l}),Xg=new Float32Array(r.ab.mat4.identity([])),Rh=(f,o,l,m,y,w,E,O,$,H,G,Z,X,oe=[0,0,0],xe)=>{const ve=y.style.light,Ce=ve.properties.get("position"),Te=[-Ce.x,-Ce.y,Ce.z],Le=r.ab.mat3.create();ve.properties.get("anchor")==="viewport"&&(r.ab.mat3.fromRotation(Le,-y.transform.angle),r.ab.vec3.transformMat3(Te,Te,Le));const Ge=G.alphaMode==="MASK",He=ve.properties.get("color").toRenderColor(null),rt=X.paint.get("model-ambient-occlusion-intensity"),Xe=X.paint.get("model-color").constantOr(r.aj.white).toRenderColor(null),et=X.paint.get("model-color-mix-intensity").constantOr(0);return{u_matrix:f,u_lighting_matrix:o,u_normal_matrix:l,u_node_matrix:m||Xg,u_lightpos:Te,u_lightintensity:ve.properties.get("intensity"),u_lightcolor:[He.r,He.g,He.b],u_camera_pos:oe,u_opacity:w,u_baseTextureIsAlpha:0,u_alphaMask:+Ge,u_alphaCutoff:G.alphaCutoff,u_baseColorFactor:[E.r,E.g,E.b,E.a],u_emissiveFactor:[O[0],O[1],O[2],1],u_metallicFactor:$,u_roughnessFactor:H,u_baseColorTexture:Wi.BaseColor,u_metallicRoughnessTexture:Wi.MetallicRoughness,u_normalTexture:Wi.Normal,u_occlusionTexture:Wi.Occlusion,u_emissionTexture:Wi.Emission,u_lutTexture:Wi.LUT,u_color_mix:[Xe.r,Xe.g,Xe.b,et],u_aoIntensity:rt,u_emissive_strength:Z,u_occlusionTextureTransform:xe||[0,0,0,0]}},gp=(f,o=Xg,l=Xg)=>({u_matrix:f,u_instance:o,u_node_matrix:l}),Jg={fillExtrusion:f=>({u_matrix:new r.bJ(f),u_lightpos:new r.bL(f),u_lightintensity:new r.bM(f),u_lightcolor:new r.bL(f),u_vertical_gradient:new r.bM(f),u_opacity:new r.bM(f),u_edge_radius:new r.bM(f),u_width_scale:new r.bM(f),u_ao:new r.bK(f),u_height_type:new r.bN(f),u_base_type:new r.bN(f),u_tile_id:new r.bL(f),u_zoom_transition:new r.bM(f),u_inv_rot_matrix:new r.bJ(f),u_merc_center:new r.bK(f),u_up_dir:new r.bL(f),u_height_lift:new r.bM(f),u_flood_light_color:new r.bL(f),u_vertical_scale:new r.bM(f),u_flood_light_intensity:new r.bM(f),u_ground_shadow_factor:new r.bL(f)}),fillExtrusionDepth:f=>({u_matrix:new r.bJ(f),u_edge_radius:new r.bM(f),u_width_scale:new r.bM(f),u_vertical_scale:new r.bM(f),u_height_type:new r.bN(f),u_base_type:new r.bN(f)}),fillExtrusionPattern:f=>({u_matrix:new r.bJ(f),u_lightpos:new r.bL(f),u_lightintensity:new r.bM(f),u_lightcolor:new r.bL(f),u_vertical_gradient:new r.bM(f),u_height_factor:new r.bM(f),u_edge_radius:new r.bM(f),u_width_scale:new r.bM(f),u_ao:new r.bK(f),u_height_type:new r.bN(f),u_base_type:new r.bN(f),u_tile_id:new r.bL(f),u_zoom_transition:new r.bM(f),u_inv_rot_matrix:new r.bJ(f),u_merc_center:new r.bK(f),u_up_dir:new r.bL(f),u_height_lift:new r.bM(f),u_image:new r.bN(f),u_texsize:new r.bK(f),u_pixel_coord_upper:new r.bK(f),u_pixel_coord_lower:new r.bK(f),u_tile_units_to_pixels:new r.bM(f),u_opacity:new r.bM(f)}),fillExtrusionGroundEffect:f=>({u_matrix:new r.bJ(f),u_opacity:new r.bM(f),u_ao_pass:new r.bM(f),u_meter_to_tile:new r.bM(f),u_ao:new r.bK(f),u_flood_light_intensity:new r.bM(f),u_flood_light_color:new r.bL(f),u_attenuation:new r.bM(f),u_edge_radius:new r.bM(f),u_fb:new r.bN(f),u_fb_size:new r.bM(f),u_dynamic_offset:new r.bM(f)}),fill:f=>({u_matrix:new r.bJ(f),u_emissive_strength:new r.bM(f)}),fillPattern:f=>({u_matrix:new r.bJ(f),u_emissive_strength:new r.bM(f),u_image:new r.bN(f),u_texsize:new r.bK(f),u_pixel_coord_upper:new r.bK(f),u_pixel_coord_lower:new r.bK(f),u_tile_units_to_pixels:new r.bM(f)}),fillOutline:f=>({u_matrix:new r.bJ(f),u_emissive_strength:new r.bM(f),u_world:new r.bK(f)}),fillOutlinePattern:f=>({u_matrix:new r.bJ(f),u_emissive_strength:new r.bM(f),u_world:new r.bK(f),u_image:new r.bN(f),u_texsize:new r.bK(f),u_pixel_coord_upper:new r.bK(f),u_pixel_coord_lower:new r.bK(f),u_tile_units_to_pixels:new r.bM(f)}),circle:r.cS,collisionBox:f=>({u_matrix:new r.bJ(f),u_camera_to_center_distance:new r.bM(f),u_extrude_scale:new r.bK(f)}),collisionCircle:f=>({u_matrix:new r.bJ(f),u_inv_matrix:new r.bJ(f),u_camera_to_center_distance:new r.bM(f),u_viewport_size:new r.bK(f)}),debug:f=>({u_color:new r.cz(f),u_matrix:new r.bJ(f),u_overlay:new r.bN(f),u_overlay_scale:new r.bM(f)}),clippingMask:f=>({u_matrix:new r.bJ(f)}),heatmap:f=>({u_extrude_scale:new r.bM(f),u_intensity:new r.bM(f),u_matrix:new r.bJ(f),u_inv_rot_matrix:new r.bJ(f),u_merc_center:new r.bK(f),u_tile_id:new r.bL(f),u_zoom_transition:new r.bM(f),u_up_dir:new r.bL(f)}),heatmapTexture:f=>({u_image:new r.bN(f),u_color_ramp:new r.bN(f),u_opacity:new r.bM(f)}),hillshade:f=>({u_matrix:new r.bJ(f),u_image:new r.bN(f),u_latrange:new r.bK(f),u_light:new r.bK(f),u_shadow:new r.cz(f),u_highlight:new r.cz(f),u_emissive_strength:new r.bM(f),u_accent:new r.cz(f)}),hillshadePrepare:f=>({u_matrix:new r.bJ(f),u_image:new r.bN(f),u_dimension:new r.bK(f),u_zoom:new r.bM(f)}),line:r.cT,linePattern:r.cU,raster:f=>({u_matrix:new r.bJ(f),u_normalize_matrix:new r.bJ(f),u_globe_matrix:new r.bJ(f),u_merc_matrix:new r.bJ(f),u_grid_matrix:new r.cA(f),u_tl_parent:new r.bK(f),u_scale_parent:new r.bM(f),u_fade_t:new r.bM(f),u_opacity:new r.bM(f),u_image0:new r.bN(f),u_image1:new r.bN(f),u_brightness_low:new r.bM(f),u_brightness_high:new r.bM(f),u_saturation_factor:new r.bM(f),u_contrast_factor:new r.bM(f),u_spin_weights:new r.bL(f),u_perspective_transform:new r.bK(f),u_raster_elevation:new r.bM(f),u_zoom_transition:new r.bM(f),u_merc_center:new r.bK(f),u_cutoff_params:new r.ca(f),u_colorization_mix:new r.ca(f),u_colorization_offset:new r.bM(f),u_color_ramp:new r.bN(f),u_texture_offset:new r.bK(f),u_texture_res:new r.bK(f),u_emissive_strength:new r.bM(f)}),rasterParticle:f=>({u_matrix:new r.bJ(f),u_normalize_matrix:new r.bJ(f),u_globe_matrix:new r.bJ(f),u_merc_matrix:new r.bJ(f),u_grid_matrix:new r.cA(f),u_tl_parent:new r.bK(f),u_scale_parent:new r.bM(f),u_fade_t:new r.bM(f),u_opacity:new r.bM(f),u_image0:new r.bN(f),u_image1:new r.bN(f),u_raster_elevation:new r.bM(f),u_zoom_transition:new r.bM(f),u_merc_center:new r.bK(f),u_cutoff_params:new r.ca(f)}),rasterParticleTexture:f=>({u_texture:new r.bN(f),u_opacity:new r.bM(f)}),rasterParticleDraw:f=>({u_particle_texture:new r.bN(f),u_particle_texture_side_len:new r.bM(f),u_tile_offset:new r.bK(f),u_velocity:new r.bN(f),u_color_ramp:new r.bN(f),u_velocity_res:new r.bK(f),u_max_speed:new r.bM(f),u_uv_offset:new r.bK(f),u_data_scale:new r.bK(f),u_data_offset:new r.bM(f),u_particle_pos_scale:new r.bM(f),u_particle_pos_offset:new r.bK(f)}),rasterParticleUpdate:f=>({u_particle_texture:new r.bN(f),u_particle_texture_side_len:new r.bM(f),u_velocity:new r.bN(f),u_velocity_res:new r.bK(f),u_max_speed:new r.bM(f),u_speed_factor:new r.bM(f),u_reset_rate:new r.bM(f),u_rand_seed:new r.bM(f),u_uv_offset:new r.bK(f),u_data_scale:new r.bK(f),u_data_offset:new r.bM(f),u_particle_pos_scale:new r.bM(f),u_particle_pos_offset:new r.bK(f)}),symbol:f=>({u_is_size_zoom_constant:new r.bN(f),u_is_size_feature_constant:new r.bN(f),u_size_t:new r.bM(f),u_size:new r.bM(f),u_camera_to_center_distance:new r.bM(f),u_rotate_symbol:new r.bN(f),u_aspect_ratio:new r.bM(f),u_fade_change:new r.bM(f),u_matrix:new r.bJ(f),u_label_plane_matrix:new r.bJ(f),u_coord_matrix:new r.bJ(f),u_is_text:new r.bN(f),u_elevation_from_sea:new r.bN(f),u_pitch_with_map:new r.bN(f),u_texsize:new r.bK(f),u_texsize_icon:new r.bK(f),u_texture:new r.bN(f),u_texture_icon:new r.bN(f),u_gamma_scale:new r.bM(f),u_device_pixel_ratio:new r.bM(f),u_tile_id:new r.bL(f),u_zoom_transition:new r.bM(f),u_inv_rot_matrix:new r.bJ(f),u_merc_center:new r.bK(f),u_camera_forward:new r.bL(f),u_tile_matrix:new r.bJ(f),u_up_vector:new r.bL(f),u_ecef_origin:new r.bL(f),u_is_halo:new r.bN(f),u_icon_transition:new r.bM(f),u_color_adj_mat:new r.bJ(f),u_scale_factor:new r.bM(f)}),background:f=>({u_matrix:new r.bJ(f),u_emissive_strength:new r.bM(f),u_opacity:new r.bM(f),u_color:new r.cz(f)}),backgroundPattern:f=>({u_matrix:new r.bJ(f),u_emissive_strength:new r.bM(f),u_opacity:new r.bM(f),u_image:new r.bN(f),u_pattern_tl:new r.bK(f),u_pattern_br:new r.bK(f),u_texsize:new r.bK(f),u_pattern_size:new r.bK(f),u_pixel_coord_upper:new r.bK(f),u_pixel_coord_lower:new r.bK(f),u_pattern_units_to_pixels:new r.bK(f)}),terrainRaster:f=>({u_matrix:new r.bJ(f),u_image0:new r.bN(f),u_skirt_height:new r.bM(f),u_ground_shadow_factor:new r.bL(f)}),skybox:f=>({u_matrix:new r.bJ(f),u_sun_direction:new r.bL(f),u_cubemap:new r.bN(f),u_opacity:new r.bM(f),u_temporal_offset:new r.bM(f)}),skyboxGradient:f=>({u_matrix:new r.bJ(f),u_color_ramp:new r.bN(f),u_center_direction:new r.bL(f),u_radius:new r.bM(f),u_opacity:new r.bM(f),u_temporal_offset:new r.bM(f)}),skyboxCapture:f=>({u_matrix_3f:new r.cA(f),u_sun_direction:new r.bL(f),u_sun_intensity:new r.bM(f),u_color_tint_r:new r.ca(f),u_color_tint_m:new r.ca(f),u_luminance:new r.bM(f)}),globeRaster:f=>({u_proj_matrix:new r.bJ(f),u_globe_matrix:new r.bJ(f),u_normalize_matrix:new r.bJ(f),u_merc_matrix:new r.bJ(f),u_zoom_transition:new r.bM(f),u_merc_center:new r.bK(f),u_image0:new r.bN(f),u_grid_matrix:new r.cA(f),u_skirt_height:new r.bM(f),u_far_z_cutoff:new r.bM(f),u_frustum_tl:new r.bL(f),u_frustum_tr:new r.bL(f),u_frustum_br:new r.bL(f),u_frustum_bl:new r.bL(f),u_globe_pos:new r.bL(f),u_globe_radius:new r.bM(f),u_viewport:new r.bK(f)}),globeAtmosphere:f=>({u_frustum_tl:new r.bL(f),u_frustum_tr:new r.bL(f),u_frustum_br:new r.bL(f),u_frustum_bl:new r.bL(f),u_horizon:new r.bM(f),u_transition:new r.bM(f),u_fadeout_range:new r.bM(f),u_color:new r.ca(f),u_high_color:new r.ca(f),u_space_color:new r.ca(f),u_temporal_offset:new r.bM(f),u_horizon_angle:new r.bM(f)}),model:f=>({u_matrix:new r.bJ(f),u_lighting_matrix:new r.bJ(f),u_normal_matrix:new r.bJ(f),u_node_matrix:new r.bJ(f),u_lightpos:new r.bL(f),u_lightintensity:new r.bM(f),u_lightcolor:new r.bL(f),u_camera_pos:new r.bL(f),u_opacity:new r.bM(f),u_baseColorFactor:new r.ca(f),u_emissiveFactor:new r.ca(f),u_metallicFactor:new r.bM(f),u_roughnessFactor:new r.bM(f),u_baseTextureIsAlpha:new r.bN(f),u_alphaMask:new r.bN(f),u_alphaCutoff:new r.bM(f),u_baseColorTexture:new r.bN(f),u_metallicRoughnessTexture:new r.bN(f),u_normalTexture:new r.bN(f),u_occlusionTexture:new r.bN(f),u_emissionTexture:new r.bN(f),u_lutTexture:new r.bN(f),u_color_mix:new r.ca(f),u_aoIntensity:new r.bM(f),u_emissive_strength:new r.bM(f),u_occlusionTextureTransform:new r.ca(f)}),modelDepth:f=>({u_matrix:new r.bJ(f),u_instance:new r.bJ(f),u_node_matrix:new r.bJ(f)}),groundShadow:f=>({u_matrix:new r.bJ(f),u_ground_shadow_factor:new r.bL(f)}),stars:f=>({u_matrix:new r.bJ(f),u_up:new r.bL(f),u_right:new r.bL(f),u_intensity_multiplier:new r.bM(f)}),snowParticle:f=>({u_modelview:new r.bJ(f),u_projection:new r.bJ(f),u_time:new r.bM(f),u_cam_pos:new r.bL(f),u_velocityConeAperture:new r.bM(f),u_velocity:new r.bM(f),u_horizontalOscillationRadius:new r.bM(f),u_horizontalOscillationRate:new r.bM(f),u_boxSize:new r.bM(f),u_billboardSize:new r.bM(f),u_simpleShapeParameters:new r.bK(f),u_screenSize:new r.bK(f),u_thinningCenterPos:new r.bK(f),u_thinningShape:new r.bL(f),u_thinningAffectedRatio:new r.bM(f),u_thinningParticleOffset:new r.bM(f),u_particleColor:new r.ca(f),u_direction:new r.bL(f)}),rainParticle:f=>({u_modelview:new r.bJ(f),u_projection:new r.bJ(f),u_time:new r.bM(f),u_cam_pos:new r.bL(f),u_texScreen:new r.bN(f),u_velocityConeAperture:new r.bM(f),u_velocity:new r.bM(f),u_boxSize:new r.bM(f),u_rainDropletSize:new r.bK(f),u_distortionStrength:new r.bM(f),u_rainDirection:new r.bL(f),u_color:new r.ca(f),u_screenSize:new r.bK(f),u_thinningCenterPos:new r.bK(f),u_thinningShape:new r.bL(f),u_thinningAffectedRatio:new r.bM(f),u_thinningParticleOffset:new r.bM(f),u_shapeDirectionalPower:new r.bM(f),u_shapeNormalPower:new r.bM(f),u_mode:new r.bM(f)}),vignette:f=>({u_vignetteShape:new r.bL(f),u_vignetteColor:new r.ca(f)}),occlusion:f=>({u_matrix:new r.bJ(f),u_anchorPos:new r.bL(f),u_screenSizePx:new r.bK(f),u_occluderSizePx:new r.bK(f),u_color:new r.ca(f)})};class il{constructor(o,l,m,y){this.id=il.uniqueIdxCounter,il.uniqueIdxCounter++,this.context=o;const w=o.gl;this.buffer=w.createBuffer(),this.dynamicDraw=!!m,this.context.unbindVAO(),o.bindElementBuffer.set(this.buffer),w.bufferData(w.ELEMENT_ARRAY_BUFFER,l.arrayBuffer,this.dynamicDraw?w.DYNAMIC_DRAW:w.STATIC_DRAW),this.dynamicDraw||y||l.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(o){this.id=il.uniqueIdxCounter,il.uniqueIdxCounter++;const l=this.context.gl;this.context.unbindVAO(),this.bind(),l.bufferSubData(l.ELEMENT_ARRAY_BUFFER,0,o.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}il.uniqueIdxCounter=0;const Os={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Cc{constructor(o,l,m,y,w,E){this.length=l.length,this.attributes=m,this.itemSize=l.bytesPerElement,this.dynamicDraw=y,this.instanceCount=E,this.context=o;const O=o.gl;this.buffer=O.createBuffer(),o.bindVertexBuffer.set(this.buffer),O.bufferData(O.ARRAY_BUFFER,l.arrayBuffer,this.dynamicDraw?O.DYNAMIC_DRAW:O.STATIC_DRAW),this.dynamicDraw||w||l.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(o){const l=this.context.gl;this.bind(),l.bufferSubData(l.ARRAY_BUFFER,0,o.arrayBuffer)}enableAttributes(o,l){for(let m=0;m<this.attributes.length;m++){const y=l.attributes[this.attributes[m].name];y!==void 0&&o.enableVertexAttribArray(y)}}setVertexAttribPointers(o,l,m){for(let y=0;y<this.attributes.length;y++){const w=this.attributes[y],E=l.attributes[w.name];E!==void 0&&o.vertexAttribPointer(E,w.components,o[Os[w.type]],!1,this.itemSize,w.offset+this.itemSize*(m||0))}}setVertexAttribDivisor(o,l,m){for(let y=0;y<this.attributes.length;y++){const w=l.attributes[this.attributes[y].name];w!==void 0&&this.instanceCount&&this.instanceCount>0&&o.vertexAttribDivisor(w,m)}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class Qg{constructor(o,l,m,y,w){this.context=o,this.width=l,this.height=m;const E=this.framebuffer=o.gl.createFramebuffer();y&&(this.colorAttachment=new nd(o,E)),w&&(this.depthAttachmentType=w,this.depthAttachment=w==="renderbuffer"?new Vg(o,E):new Xy(o,E))}destroy(){const o=this.context.gl;if(this.colorAttachment){const l=this.colorAttachment.get();l&&o.deleteTexture(l)}if(this.depthAttachment&&this.depthAttachmentType)if(this.depthAttachmentType==="renderbuffer"){const l=this.depthAttachment.get();l&&o.deleteRenderbuffer(l)}else{const l=this.depthAttachment.get();l&&o.deleteTexture(l)}o.deleteFramebuffer(this.framebuffer)}}class ev{constructor(o,l){this.gl=o,this.clearColor=new Ag(this),this.clearDepth=new kg(this),this.clearStencil=new Pg(this),this.colorMask=new Rg(this),this.depthMask=new Wy(this),this.stencilMask=new qy(this),this.stencilFunc=new Jx(this),this.stencilOp=new Ch(this),this.stencilTest=new Eh(this),this.depthRange=new Ky(this),this.depthTest=new Rs(this),this.depthFunc=new Og(this),this.blend=new ip(this),this.blendFunc=new sp(this),this.blendColor=new Lg(this),this.blendEquation=new Dg(this),this.cullFace=new ap(this),this.cullFaceSide=new zg(this),this.frontFace=new Fg(this),this.program=new lp(this),this.activeTexture=new Zy(this),this.viewport=new Yy(this),this.bindFramebuffer=new td(this),this.bindRenderbuffer=new Qx(this),this.bindTexture=new ew(this),this.bindVertexBuffer=new tw(this),this.bindElementBuffer=new nw(this),this.bindVertexArrayOES=new rw(this),this.pixelStoreUnpack=new ow(this),this.pixelStoreUnpackPremultiplyAlpha=new Ng(this),this.pixelStoreUnpackFlipY=new Bg(this),this.options=l?Object.assign({},l):{},this.options.extTextureFilterAnisotropicForceOff||(this.extTextureFilterAnisotropic=o.getExtension("EXT_texture_filter_anisotropic")||o.getExtension("MOZ_EXT_texture_filter_anisotropic")||o.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=o.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT))),this.extDebugRendererInfo=o.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=o.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=o.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),this.forceManualRenderingForInstanceIDShaders=l&&!!l.forceManualRenderingForInstanceIDShaders||this.renderer&&this.renderer.indexOf("PowerVR")!==-1,this.options.extTextureFloatLinearForceOff||(this.extTextureFloatLinear=o.getExtension("OES_texture_float_linear")),this.extRenderToTextureHalfFloat=o.getExtension("EXT_color_buffer_half_float"),this.extTimerQuery=o.getExtension("EXT_disjoint_timer_query_webgl2"),this.maxTextureSize=o.getParameter(o.MAX_TEXTURE_SIZE),this.maxPointSize=o.getParameter(o.ALIASED_POINT_SIZE_RANGE)[1]}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArrayOES.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(o,l,m){return new il(this,o,l,m)}createVertexBuffer(o,l,m,y,w){return new Cc(this,o,l,m,y,w)}createRenderbuffer(o,l,m){const y=this.gl,w=y.createRenderbuffer();return this.bindRenderbuffer.set(w),y.renderbufferStorage(y.RENDERBUFFER,o,l,m),this.bindRenderbuffer.set(null),w}createFramebuffer(o,l,m,y){return new Qg(this,o,l,m,y)}clear({color:o,depth:l,stencil:m,colorMask:y}){const w=this.gl;let E=0;o&&(E|=w.COLOR_BUFFER_BIT,this.clearColor.set(o),this.colorMask.set(y||[!0,!0,!0,!0])),l!==void 0&&(E|=w.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(l),this.depthMask.set(!0)),m!==void 0&&(E|=w.STENCIL_BUFFER_BIT,this.clearStencil.set(m),this.stencilMask.set(255)),w.clear(E)}setCullFace(o){o.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(o.mode),this.frontFace.set(o.frontFace))}setDepthMode(o){o.func!==this.gl.ALWAYS||o.mask?(this.depthTest.set(!0),this.depthFunc.set(o.func),this.depthMask.set(o.mask),this.depthRange.set(o.range)):this.depthTest.set(!1)}setStencilMode(o){o.test.func!==this.gl.ALWAYS||o.mask?(this.stencilTest.set(!0),this.stencilMask.set(o.mask),this.stencilOp.set([o.fail,o.depthFail,o.pass]),this.stencilFunc.set({func:o.test.func,ref:o.ref,mask:o.test.mask})):this.stencilTest.set(!1)}setColorMode(o){r.bn(o.blendFunction,Lr.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(o.blendFunction),this.blendColor.set(o.blendColor),o.blendEquation?this.blendEquation.set(o.blendEquation):this.blendEquation.setDefault()),this.colorMask.set(o.mask)}unbindVAO(){this.bindVertexArrayOES.set(null)}}let sd;function vp(f,o,l,m,y,w,E){const O=f.context,$=O.gl,H=f.transform,G=f.getOrCreateProgram("collisionBox"),Z=[];let X=0,oe=0;for(let He=0;He<m.length;He++){const rt=m[He],Xe=o.getTile(rt),et=Xe.getBucket(l);if(!et)continue;const Ye=Da(rt,et,H);let at=Ye;y[0]===0&&y[1]===0||(at=f.translatePosMatrix(Ye,Xe,y,w));const gt=E?et.textCollisionBox:et.iconCollisionBox,Vt=et.collisionCircleArray;if(Vt.length>0){const Rt=r.ab.mat4.create(),tn=at;r.ab.mat4.mul(Rt,et.placementInvProjMatrix,H.glCoordMatrix),r.ab.mat4.mul(Rt,Rt,et.placementViewportMatrix),Z.push({circleArray:Vt,circleOffset:oe,transform:tn,invTransform:Rt,projection:et.getProjection()}),X+=Vt.length/4,oe=X}gt&&(f.terrain&&f.terrain.setupElevationDraw(Xe,G),G.draw(f,$.LINES,or.disabled,fr.disabled,f.colorModeForRenderPass(),_r.disabled,lw(at,H,Xe,et.getProjection()),l.id,gt.layoutVertexBuffer,gt.indexBuffer,gt.segments,null,H.zoom,null,[gt.collisionVertexBuffer,gt.collisionVertexBufferExt]))}if(!E||!Z.length)return;const xe=f.getOrCreateProgram("collisionCircle"),ve=new r.cV;ve.resize(4*X),ve._trim();let Ce=0;for(const He of Z)for(let rt=0;rt<He.circleArray.length/4;rt++){const Xe=4*rt,et=He.circleArray[Xe+0],Ye=He.circleArray[Xe+1],at=He.circleArray[Xe+2],gt=He.circleArray[Xe+3];ve.emplace(Ce++,et,Ye,at,gt,0),ve.emplace(Ce++,et,Ye,at,gt,1),ve.emplace(Ce++,et,Ye,at,gt,2),ve.emplace(Ce++,et,Ye,at,gt,3)}(!sd||sd.length<2*X)&&(sd=function(He){const rt=2*He,Xe=new r.aU;Xe.resize(rt),Xe._trim();for(let et=0;et<rt;et++){const Ye=6*et;Xe.uint16[Ye+0]=4*et+0,Xe.uint16[Ye+1]=4*et+1,Xe.uint16[Ye+2]=4*et+2,Xe.uint16[Ye+3]=4*et+2,Xe.uint16[Ye+4]=4*et+3,Xe.uint16[Ye+5]=4*et+0}return Xe}(X));const Te=O.createIndexBuffer(sd,!0),Le=O.createVertexBuffer(ve,r.cW.members,!0);for(const He of Z){const rt={u_matrix:He.transform,u_inv_matrix:He.invTransform,u_camera_to_center_distance:(Ge=H).getCameraToCenterDistance(He.projection),u_viewport_size:[Ge.width,Ge.height]};xe.draw(f,$.TRIANGLES,or.disabled,fr.disabled,f.colorModeForRenderPass(),_r.disabled,rt,l.id,Le,Te,r.b7.simpleSegment(0,2*He.circleOffset,He.circleArray.length,He.circleArray.length/2),null,H.zoom)}var Ge;Le.destroy(),Te.destroy()}const Oh=r.ab.mat4.create();function qs(f){const o=f._camera.getWorldToCamera(f.worldSize,1),l=r.ab.mat4.multiply([],o,f.globeMatrix);r.ab.mat4.invert(l,l);const m=[0,0,0],y=[0,1,0,0];return r.ab.vec4.transformMat4(y,y,l),m[0]=y[0],m[1]=y[1],m[2]=y[2],r.ab.vec3.normalize(m,m),m}function zo({width:f,height:o,anchor:l,textOffset:m,textScale:y},w){const{horizontalAlign:E,verticalAlign:O}=r.bD(l),$=-(E-.5)*f,H=-(O-.5)*o,G=r.bC(l,m);return new r.P(($/y+G[0])*w,(H/y+G[1])*w)}function _p(f,o,l,m,y,w,E,O,$,H,G){const Z=f.text.placedSymbolArray,X=f.text.dynamicLayoutVertexArray,oe=f.icon.dynamicLayoutVertexArray,xe={},ve=f.getProjection(),Ce=tu(O,ve,w),Te=w.elevation,Le=ve.upVectorScale(O.canonical,w.center.lat,w.worldSize).metersToTile;X.clear();for(let Ge=0;Ge<Z.length;Ge++){const He=Z.get(Ge),{tileAnchorX:rt,tileAnchorY:Xe,numGlyphs:et}=He,Ye=He.hidden||!He.crossTileID||f.allowVerticalPlacement&&!He.placedOrientation?null:m[He.crossTileID];if(Ye){let at=0,gt=0,Vt=0;if(Te){const Ht=Te?Te.getAtTileOffset(O,rt,Xe):0,[Cn,dn,nn]=ve.upVector(O.canonical,rt,Xe);at=Ht*Cn*Le,gt=Ht*dn*Le,Vt=Ht*nn*Le}let[Rt,tn,Jt,Et]=ys(He.projectedAnchorX+at,He.projectedAnchorY+gt,He.projectedAnchorZ+Vt,l?Ce:E);const jt=Kf(w.getCameraToCenterDistance(ve),Et);let gn=y.evaluateSizeForFeature(f.textSizeData,H,He)*jt/r.bw;l&&(gn*=f.tilePixelRatio/$);const Tt=zo(Ye,gn);l?({x:Rt,y:tn,z:Jt}=ve.projectTilePoint(rt+Tt.x,Xe+Tt.y,O.canonical),[Rt,tn,Jt]=ys(Rt+at,tn+gt,Jt+Vt,E)):(o&&Tt._rotate(-w.angle),Rt+=Tt.x,tn+=Tt.y,Jt=0);const rn=f.allowVerticalPlacement&&He.placedOrientation===r.bq.vertical?Math.PI/2:0;for(let Ht=0;Ht<et;Ht++)r.bt(X,Rt,tn,Jt,rn);G&&He.associatedIconIndex>=0&&(xe[He.associatedIconIndex]={x:Rt,y:tn,z:Jt,angle:rn})}else Yo(et,X)}if(G){oe.clear();const Ge=f.icon.placedSymbolArray;for(let He=0;He<Ge.length;He++){const rt=Ge.get(He),{numGlyphs:Xe}=rt,et=xe[He];if(rt.hidden||!et)Yo(Xe,oe);else{const{x:Ye,y:at,z:gt,angle:Vt}=et;for(let Rt=0;Rt<Xe;Rt++)r.bt(oe,Ye,at,gt,Vt)}}f.icon.dynamicLayoutVertexBuffer.updateData(oe)}f.text.dynamicLayoutVertexBuffer.updateData(X)}function Lh(f,o,l,m,y,w,E={}){const O=l.paint.get("icon-translate"),$=l.paint.get("text-translate"),H=l.paint.get("icon-translate-anchor"),G=l.paint.get("text-translate-anchor"),Z=l.layout.get("icon-rotation-alignment"),X=l.layout.get("text-rotation-alignment"),oe=l.layout.get("icon-pitch-alignment"),xe=l.layout.get("text-pitch-alignment"),ve=l.layout.get("icon-keep-upright"),Ce=l.layout.get("text-keep-upright"),Te=l.paint.get("icon-color-saturation"),Le=l.paint.get("icon-color-contrast"),Ge=l.paint.get("icon-color-brightness-min"),He=l.paint.get("icon-color-brightness-max"),rt=l.layout.get("symbol-elevation-reference")==="sea",Xe=f.context,et=Xe.gl,Ye=f.transform,at=Z==="map",gt=X==="map",Vt=oe==="map",Rt=xe==="map",tn=l.layout.get("symbol-sort-key").constantOr(1)!==void 0;let Jt=!1;const Et=f.depthModeForSublayer(0,or.ReadOnly),jt=[r.at(Ye.center.lng),r.aA(Ye.center.lat)],gn=l.layout.get("text-variable-anchor"),Tt=Ye.projection.name==="globe",rn=[],Ht=[0,-1,0];for(const Cn of m){const dn=o.getTile(Cn),nn=dn.getBucket(l);if(!nn||nn.projection.name==="mercator"&&Tt||nn.fullyClipped)continue;const vn=nn.projection.name==="globe",Tn=vn?r.ae(Ye.zoom):0,Ln=tu(Cn,nn.getProjection(),Ye),Un=Ye.calculatePixelsToTileUnitsMatrix(dn),dr=gn&&nn.hasTextData(),nr=nn.hasIconTextFit()&&dr&&nn.hasIconData(),ir=nn.getProjection().createInversionMatrix(Ye,Cn.canonical),br=ro=>{Ye.depthOcclusionForSymbolsAndCircles&&(l.hasInitialOcclusionOpacityProperties||f.terrain)&&(ro.push("DEPTH_D24"),ro.push("DEPTH_OCCLUSION"))},jr=()=>{const ro=at&&l.layout.get("symbol-placement")!=="point",ao=[];br(ao);const qo=ro||nr,Pi=l.paint.get("icon-image-cross-fade").constantOr(0);f.terrainRenderModeElevated()&&Vt&&ao.push("PITCH_WITH_MAP_TERRAIN"),vn&&(ao.push("PROJECTION_GLOBE_VIEW"),qo&&ao.push("PROJECTED_POS_ON_VIEWPORT")),Pi>0&&ao.push("ICON_TRANSITION"),nn.icon.zOffsetVertexBuffer&&ao.push("Z_OFFSET"),Te===0&&Le===0&&Ge===0&&He===1||ao.push("COLOR_ADJUSTMENT"),nn.sdfIcons&&ao.push("RENDER_SDF");const bi=nn.icon.programConfigurations.get(l.id),xi=f.getOrCreateProgram("symbol",{config:bi,defines:ao}),Ys=dn.imageAtlasTexture?dn.imageAtlasTexture.size:[0,0],Qi=nn.iconSizeData,Ko=r.bp(Qi,Ye.zoom),Ao=Vt||Ye.pitch!==0,xo=Ni(Ln,dn.tileID.canonical,Vt,at,Ye,nn.getProjection(),Un),qr=hg(Ln,dn.tileID.canonical,Vt,at,Ye,nn.getProjection(),Un),si=f.translatePosMatrix(qr,dn,O,H,!0),Ri=f.translatePosMatrix(Ln,dn,O,H),Co=qo?Oh:xo,es=at&&!Vt&&!ro;let wa=Ht;!Tt&&!Ye.mercatorFromTransition||at||(wa=qs(Ye));const zs=vn?wa:Ht,Ss=l.getColorAdjustmentMatrix(Te,Le,Ge,He),dl=Zg(Qi.kind,Ko,es,Vt,f,Ri,Co,si,rt,!1,Ys,[0,0],!0,Cn,Tn,jt,ir,zs,nn.getProjection(),Ss,Pi),Sa=dn.imageAtlasTexture?dn.imageAtlasTexture:null,Xs=l.layout.get("icon-size").constantOr(0)!==1||nn.iconsNeedLinear,xu=nn.sdfIcons||f.options.rotating||f.options.zooming||Xs||Ao?et.LINEAR:et.NEAREST,hl=nn.sdfIcons&&l.paint.get("icon-halo-width").constantOr(1)!==0,wu=f.terrain&&Vt&&ro?r.ab.mat4.invert(r.ab.mat4.create(),xo):Oh;if(ro&&nn.icon){const yd=Ye.elevation,Lp=yd?yd.getAtTileOffsetFunc(Cn,Ye.center.lat,Ye.worldSize,nn.getProjection()):null,Sv=Qo(Ln,dn.tileID.canonical,Vt,at,Ye,nn.getProjection(),Un);Zf(nn,Ln,f,!1,Sv,qr,Vt,ve,Lp,Cn)}return{program:xi,buffers:nn.icon,uniformValues:dl,atlasTexture:Sa,atlasTextureIcon:null,atlasInterpolation:xu,atlasInterpolationIcon:null,isSDF:nn.sdfIcons,hasHalo:hl,tile:dn,labelPlaneMatrixInv:wu}},ho=()=>{const ro=gt&&l.layout.get("symbol-placement")!=="point",ao=[],qo=ro||gn||nr;f.terrainRenderModeElevated()&&Rt&&ao.push("PITCH_WITH_MAP_TERRAIN"),vn&&(ao.push("PROJECTION_GLOBE_VIEW"),qo&&ao.push("PROJECTED_POS_ON_VIEWPORT")),nn.text.zOffsetVertexBuffer&&ao.push("Z_OFFSET"),nn.iconsInText&&ao.push("RENDER_TEXT_AND_SYMBOL"),ao.push("RENDER_SDF"),br(ao);const Pi=nn.text.programConfigurations.get(l.id),bi=f.getOrCreateProgram("symbol",{config:Pi,defines:ao});let xi,Ys=[0,0],Qi=null;const Ko=nn.textSizeData;nn.iconsInText&&(Ys=dn.imageAtlasTexture?dn.imageAtlasTexture.size:[0,0],Qi=dn.imageAtlasTexture?dn.imageAtlasTexture:null,xi=Rt||Ye.pitch!==0||f.options.rotating||f.options.zooming||Ko.kind==="composite"||Ko.kind==="camera"?et.LINEAR:et.NEAREST);const Ao=dn.glyphAtlasTexture?dn.glyphAtlasTexture.size:[0,0],xo=l.layout.get("text-size-scale-range"),qr=r.aw(f.scaleFactor,xo[0],xo[1]),si=r.bp(Ko,Ye.zoom,qr),Ri=Ni(Ln,dn.tileID.canonical,Rt,gt,Ye,nn.getProjection(),Un),Co=hg(Ln,dn.tileID.canonical,Rt,gt,Ye,nn.getProjection(),Un),es=f.translatePosMatrix(Co,dn,$,G,!0),wa=f.translatePosMatrix(Ln,dn,$,G),zs=qo?Oh:Ri,Ss=gt&&!Rt&&!ro;let dl=Ht;!Tt&&!Ye.mercatorFromTransition||gt||(dl=qs(Ye));const Sa=Zg(Ko.kind,si,Ss,Rt,f,wa,zs,es,rt,!0,Ao,Ys,!0,Cn,Tn,jt,ir,vn?dl:Ht,nn.getProjection(),null,null,qr),Xs=dn.glyphAtlasTexture?dn.glyphAtlasTexture:null,xu=et.LINEAR,hl=l.paint.get("text-halo-width").constantOr(1)!==0,wu=f.terrain&&Rt&&ro?r.ab.mat4.invert(r.ab.mat4.create(),Ri):Oh;if(ro&&nn.text){const yd=Ye.elevation,Lp=yd?yd.getAtTileOffsetFunc(Cn,Ye.center.lat,Ye.worldSize,nn.getProjection()):null,Sv=Qo(Ln,dn.tileID.canonical,Rt,gt,Ye,nn.getProjection(),Un);Zf(nn,Ln,f,!0,Sv,Co,Rt,Ce,Lp,Cn)}return{program:bi,buffers:nn.text,uniformValues:Sa,atlasTexture:Xs,atlasTextureIcon:Qi,atlasInterpolation:xu,atlasInterpolationIcon:xi,isSDF:!0,hasHalo:hl,tile:dn,labelPlaneMatrixInv:wu}},Zo=nn.icon.segments.get().length,No=nn.text.segments.get().length,Sr=Zo&&!E.onlyText?jr():null,Xr=No&&!E.onlyIcons?ho():null,Jn=l.paint.get("icon-opacity").constantOr(1),Ur=l.paint.get("text-opacity").constantOr(1);if(tn&&nn.canOverlap){Jt=!0;const ro=Jn&&!E.onlyText?nn.icon.segments.get():[],ao=Ur&&!E.onlyIcons?nn.text.segments.get():[];for(const qo of ro)rn.push({segments:new r.b7([qo]),sortKey:qo.sortKey,state:Sr});for(const qo of ao)rn.push({segments:new r.b7([qo]),sortKey:qo.sortKey,state:Xr})}else E.onlyText||rn.push({segments:Jn?nn.icon.segments:new r.b7([]),sortKey:0,state:Sr}),E.onlyIcons||rn.push({segments:Ur?nn.text.segments:new r.b7([]),sortKey:0,state:Xr})}Jt&&rn.sort((Cn,dn)=>Cn.sortKey-dn.sortKey);for(const Cn of rn){const dn=Cn.state;if(dn)if(f.terrain?f.terrain.setupElevationDraw(dn.tile,dn.program,{useDepthForOcclusion:Ye.depthOcclusionForSymbolsAndCircles,labelPlaneMatrixInv:dn.labelPlaneMatrixInv}):f.setupDepthForOcclusion(Ye.depthOcclusionForSymbolsAndCircles,dn.program),Xe.activeTexture.set(et.TEXTURE0),dn.atlasTexture&&dn.atlasTexture.bind(dn.atlasInterpolation,et.CLAMP_TO_EDGE,!0),dn.atlasTextureIcon&&(Xe.activeTexture.set(et.TEXTURE1),dn.atlasTextureIcon&&dn.atlasTextureIcon.bind(dn.atlasInterpolationIcon,et.CLAMP_TO_EDGE,!0)),f.uploadCommonLightUniforms(f.context,dn.program),dn.hasHalo){const nn=dn.uniformValues;nn.u_is_halo=1,yp(dn.buffers,Cn.segments,l,f,dn.program,Et,y,w,nn,2),nn.u_is_halo=0}else{if(dn.isSDF){const nn=dn.uniformValues;dn.hasHalo&&(nn.u_is_halo=1,yp(dn.buffers,Cn.segments,l,f,dn.program,Et,y,w,nn,1)),nn.u_is_halo=0}yp(dn.buffers,Cn.segments,l,f,dn.program,Et,y,w,dn.uniformValues,1)}}}function yp(f,o,l,m,y,w,E,O,$,H){const G=[f.dynamicLayoutVertexBuffer,f.opacityVertexBuffer,f.iconTransitioningVertexBuffer,f.globeExtVertexBuffer,f.zOffsetVertexBuffer];y.draw(m,m.context.gl.TRIANGLES,w,E,O,_r.disabled,$,l.id,f.layoutVertexBuffer,f.indexBuffer,o,l.paint,m.transform.zoom,f.programConfigurations.get(l.id),G,H)}function tv(f,o,l,m,y,w,E){const O=f.context.gl,$=l.paint.get("fill-pattern"),H=l.is3D(),G=H?f.stencilModeFor3D():fr.disabled,Z=$&&$.constantOr(1);let X,oe,xe,ve,Ce;E?(oe=Z&&!l.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",X=O.LINES):(oe=Z?"fillPattern":"fill",X=O.TRIANGLES);for(const Te of m){const Le=o.getTile(Te);if(Z&&!Le.patternsLoaded())continue;const Ge=Le.getBucket(l);if(!Ge)continue;f.prepareDrawTile();const He=Ge.programConfigurations.get(l.id),rt=f.isTileAffectedByFog(Te),Xe=f.getOrCreateProgram(oe,{config:He,overrideFog:rt});Z&&(f.context.activeTexture.set(O.TEXTURE0),Le.imageAtlasTexture&&Le.imageAtlasTexture.bind(O.LINEAR,O.CLAMP_TO_EDGE),He.updatePaintBuffers());const et=$.constantOr(null);if(et&&Le.imageAtlas){const gt=Le.imageAtlas,Vt=r.A.from(et).getPrimary().scaleSelf(r.q.devicePixelRatio).serialize(),Rt=gt.patternPositions[Vt];Rt&&He.setConstantPatternPositions(Rt)}const Ye=f.translatePosMatrix(Te.projMatrix,Le,l.paint.get("fill-translate"),l.paint.get("fill-translate-anchor")),at=l.paint.get("fill-emissive-strength");if(E){ve=Ge.indexBuffer2,Ce=Ge.segments2;const gt=f.terrain&&f.terrain.renderingToTexture?f.terrain.drapeBufferSize:[O.drawingBufferWidth,O.drawingBufferHeight];xe=oe==="fillOutlinePattern"&&Z?r0(Ye,at,f,Le,gt):Gg(Ye,at,gt)}else ve=Ge.indexBuffer,Ce=Ge.segments,xe=Z?Ph(Ye,at,f,Le):kh(Ye,at);f.uploadCommonUniforms(f.context,Xe,Te.toUnwrapped()),Xe.draw(f,X,y,H?G:f.stencilModeForClipping(Te),w,_r.disabled,xe,l.id,Ge.layoutVertexBuffer,ve,Ce,l.paint,f.transform.zoom,He,void 0)}}function Dh(f,o,l,m,y,w,E,O){l.resetLayerRenderingStats(f);const $=f.context,H=$.gl,G=f.transform,Z=l.paint.get("fill-extrusion-pattern"),X=Z.constantOr(1),oe=l.paint.get("fill-extrusion-opacity"),xe=f.style.enable3dLights(),ve=l.paint.get(xe&&!X?"fill-extrusion-ambient-occlusion-wall-radius":"fill-extrusion-ambient-occlusion-radius"),Ce=[l.paint.get("fill-extrusion-ambient-occlusion-intensity"),ve],Te=l.layout.get("fill-extrusion-edge-radius"),Le=Te>0&&!l.paint.get("fill-extrusion-rounded-roof"),Ge=Le?0:Te,He=G.projection.name==="globe"?r.d3():0,rt=G.projection.name==="globe",Xe=rt?r.ae(G.zoom):0,et=[r.at(G.center.lng),r.aA(G.center.lat)],Ye=l.paint.get("fill-extrusion-flood-light-color-use-theme").constantOr("default")==="none",at=l.paint.get("fill-extrusion-flood-light-color").toRenderColor(Ye?null:l.lut).toArray01().slice(0,3),gt=l.paint.get("fill-extrusion-flood-light-intensity"),Vt=l.paint.get("fill-extrusion-vertical-scale"),Rt=l.paint.get("fill-extrusion-line-width").constantOr(1)!==0,tn=l.paint.get("fill-extrusion-height-alignment"),Jt=l.paint.get("fill-extrusion-base-alignment"),Et=xc(f,l.paint.get("fill-extrusion-cutoff-fade-range")),jt=[];let gn;rt&&jt.push("PROJECTION_GLOBE_VIEW"),Ce[0]>0&&jt.push("FAUX_AO"),Le&&jt.push("ZERO_ROOF_RADIUS"),O&&jt.push("HAS_CENTROID"),gt>0&&jt.push("FLOOD_LIGHT"),Et.shouldRenderCutoff&&jt.push("RENDER_CUTOFF"),Rt&&jt.push("RENDER_WALL_MODE");const Tt=f.renderPass==="shadow",rn=f.shadowRenderer,Ht=Tt&&!!rn;f.shadowRenderer&&(f.shadowRenderer.useNormalOffset=!0);let Cn=[0,0,0];if(rn){const vn=f.style.directionalLight,Tn=f.style.ambientLight;vn&&Tn&&(Cn=Sg(f.style,vn,Tn)),Tt||(jt.push("RENDER_SHADOWS","DEPTH_TEXTURE"),rn.useNormalOffset&&jt.push("NORMAL_OFFSET")),gn=jt.concat(["SHADOWS_SINGLE_CASCADE"])}const dn=Ht?"fillExtrusionDepth":X?"fillExtrusionPattern":"fillExtrusion",nn=l.getLayerRenderingStats();for(const vn of m){const Tn=o.getTile(vn),Ln=Tn.getBucket(l);if(!Ln||Ln.projection.name!==G.projection.name)continue;let Un=!1;rn&&(Un=rn.getMaxCascadeForTile(vn.toUnwrapped())===0);const dr=f.isTileAffectedByFog(vn),nr=Ln.programConfigurations.get(l.id),ir=f.getOrCreateProgram(dn,{config:nr,defines:Un?gn:jt,overrideFog:dr});if(f.terrain&&f.terrain.setupElevationDraw(Tn,ir,{useMeterToDem:!0}),!Ln.centroidVertexBuffer){const Xr=ir.attributes.a_centroid_pos;Xr!==void 0&&H.vertexAttrib2f(Xr,0,0)}!Tt&&rn&&rn.setupShadows(Tn.tileID.toUnwrapped(),ir,"vector-tile",Tn.tileID.overscaledZ),X&&(f.context.activeTexture.set(H.TEXTURE0),Tn.imageAtlasTexture&&Tn.imageAtlasTexture.bind(H.LINEAR,H.CLAMP_TO_EDGE),nr.updatePaintBuffers());const br=Z.constantOr(null);if(br&&Tn.imageAtlas){const Xr=Tn.imageAtlas,Jn=r.A.from(br).getPrimary().scaleSelf(r.q.devicePixelRatio),Ur=Xr.patternPositions[Jn.serialize()];Ur&&nr.setConstantPatternPositions(Ur)}const jr=l.paint.get("fill-extrusion-vertical-gradient"),ho=1/Ln.tileToMeter;let Zo;if(Tt&&rn){if(ud(Tn.tileID,Ln,f))continue;const Xr=rn.calculateShadowPassMatrixFromTile(Tn.tileID.toUnwrapped());Zo=Ah(Xr,Ge,ho,Vt,tn,Jt)}else{const Xr=f.translatePosMatrix(vn.expandedProjMatrix,Tn,l.paint.get("fill-extrusion-translate"),l.paint.get("fill-extrusion-translate-anchor")),Jn=G.projection.createInversionMatrix(G,vn.canonical);Zo=X?n0(Xr,f,jr,oe,Ce,Ge,ho,vn,Tn,He,tn,Jt,Xe,et,Jn,at,Vt):fp(Xr,f,jr,oe,Ce,Ge,ho,vn,He,tn,Jt,Xe,et,Jn,at,Vt,gt,Cn)}f.uploadCommonUniforms($,ir,vn.toUnwrapped(),null,Et);let No=Ln.segments;if(G.projection.name==="mercator"&&!Tt&&(No=Ln.getVisibleSegments(Tn.tileID,f.terrain,f.transform.getFrustum(0)),!No.get().length))continue;if(nn)if(Tt)for(const Xr of No.get())nn.numRenderedVerticesInShadowPass+=Xr.primitiveLength;else for(const Xr of No.get())nn.numRenderedVerticesInTransparentPass+=Xr.primitiveLength;const Sr=[];(f.terrain||O)&&Sr.push(Ln.centroidVertexBuffer),rt&&Sr.push(Ln.layoutVertexExtBuffer),Rt&&Sr.push(Ln.wallVertexBuffer),ir.draw(f,$.gl.TRIANGLES,y,w,E,_r.backCCW,Zo,l.id,Ln.layoutVertexBuffer,Ln.indexBuffer,No,l.paint,f.transform.zoom,nr,Sr)}f.shadowRenderer&&(f.shadowRenderer.useNormalOffset=!1)}function ad(f,o,l,m,y,w,E,O,$,H,G,Z,X,oe,xe,ve,Ce,Te,Le){const Ge=f.context,He=Ge.gl,rt=f.transform,Xe=f.transform.zoom,et=[],Ye=xc(f,l.paint.get("fill-extrusion-cutoff-fade-range"));H==="clear"?(et.push("CLEAR_SUBPASS"),Le&&(et.push("CLEAR_FROM_TEXTURE"),Ge.activeTexture.set(He.TEXTURE0),Le.bind(He.LINEAR,He.CLAMP_TO_EDGE))):H==="sdf"&&et.push("SDF_SUBPASS"),Ce&&et.push("HAS_CENTROID"),Ye.shouldRenderCutoff&&et.push("RENDER_CUTOFF");const at=l.layout.get("fill-extrusion-edge-radius"),gt=(Vt,Rt,tn,Jt,Et)=>{const jt=Rt.programConfigurations.get(l.id),gn=f.isTileAffectedByFog(Vt),Tt=f.getOrCreateProgram("fillExtrusionGroundEffect",{config:jt,defines:et,overrideFog:gn}),rn=((Cn,dn,nn,vn,Tn,Ln,Un,dr,nr,ir,br)=>({u_matrix:dn,u_opacity:nn,u_ao_pass:vn?1:0,u_meter_to_tile:Tn,u_ao:Ln,u_flood_light_intensity:Un,u_flood_light_color:dr,u_attenuation:nr,u_edge_radius:ir,u_fb:0,u_fb_size:br,u_dynamic_offset:1}))(0,Jt,G,$,Et,[Z,X*Et],oe,xe,ve,Xe>=17?0:at*Et,Le?Le.size[0]:0),Ht=[];Ce&&Ht.push(Rt.hiddenByLandmarkVertexBuffer),f.uploadCommonUniforms(Ge,Tt,Vt.toUnwrapped(),null,Ye),Tt.draw(f,Ge.gl.TRIANGLES,y,w,E,O,rn,l.id,Rt.vertexBuffer,Rt.indexBuffer,tn,l.paint,Xe,jt,Ht)};for(const Vt of m){const Rt=o.getTile(Vt),tn=Rt.getBucket(l);if(!tn||tn.projection.name!==rt.projection.name||!tn.groundEffect||tn.groundEffect&&!tn.groundEffect.hasData())continue;const Jt=tn.groundEffect,Et=1/tn.tileToMeter;{const jt=f.translatePosMatrix(Vt.projMatrix,Rt,l.paint.get("fill-extrusion-translate"),l.paint.get("fill-extrusion-translate-anchor")),gn=Jt.getDefaultSegment();gt(Vt,Jt,gn,jt,Et)}if(Te)for(let jt=0;jt<4;jt++){const gn=r.d4[jt](Vt),Tt=o.getTile(gn);if(!Tt)continue;const rn=Tt.getBucket(l);if(!rn||rn.projection.name!==rt.projection.name||!rn.groundEffect||rn.groundEffect&&!rn.groundEffect.hasData())continue;const Ht=rn.groundEffect;let Cn,dn;jt===0?(Cn=[-r.ag,0,0],dn=1):jt===1?(Cn=[r.ag,0,0],dn=0):jt===2?(Cn=[0,-r.ag,0],dn=3):(Cn=[0,r.ag,0],dn=2);const nn=Ht.regionSegments[dn];if(!nn)continue;const vn=new Float32Array(16);r.ab.mat4.translate(vn,Vt.projMatrix,Cn),gt(Vt,Ht,nn,f.translatePosMatrix(vn,Rt,l.paint.get("fill-extrusion-translate"),l.paint.get("fill-extrusion-translate-anchor")),Et)}}}function ld(f,o,l,m,y,w,E){m.centroidVertexArray.length===0&&m.createCentroidsBuffer();const O=w?w.findDEMTileFor(l):null;if(!(O&&O.dem||E))return;w&&O&&O.dem&&m.selfDEMTileTimestamp!==O.dem._timestamp&&(m.borderDoneWithNeighborZ=[-1,-1,-1,-1],m.selfDEMTileTimestamp=O.dem._timestamp);const $=Te=>new r.P(Math.ceil((Te+r.d7)*r.d8),0),H=Te=>{const Le=o.getSource().minzoom,Ge=rt=>{const Xe=o.getTileByID(rt);if(Xe&&Xe.hasData())return Xe.getBucket(y)},He=[0,-1,1];for(const rt of He){if(Te.overscaledZ+rt<Le)continue;const Xe=Ge(Te.calculateScaledKey(Te.overscaledZ+rt));if(Xe)return Xe}},G=[0,0,0],Z=(Te,Le)=>(G[0]=Math.min(Te.min.y,Le.min.y),G[1]=Math.max(Te.max.y,Le.max.y),G[2]=r.ag-Le.min.x>Te.max.x?Le.min.x-r.ag:Te.max.x,G),X=(Te,Le)=>(G[0]=Math.min(Te.min.x,Le.min.x),G[1]=Math.max(Te.max.x,Le.max.x),G[2]=r.ag-Le.min.y>Te.max.y?Le.min.y-r.ag:Te.max.y,G),oe=[(Te,Le)=>Z(Te,Le),(Te,Le)=>Z(Le,Te),(Te,Le)=>X(Te,Le),(Te,Le)=>X(Le,Te)],xe=(Te,Le,Ge,He,rt,Xe,et)=>{if(!w)return 0;const Ye=[[Xe?Ge:Te,Xe?Te:Ge,0],[Xe?Ge:Le,Xe?Le:Ge,0]],at=et<0?r.ag+et:et,gt=[Xe?at:(Te+Le)/2,Xe?(Te+Le)/2:at,0];return Ge===0&&et<0||Ge!==0&&et>0?w.getForTilePoints(rt,[gt],!0,He):Ye.push(gt),w.getForTilePoints(l,Ye,!0,O),Math.max(Ye[0][2],Ye[1][2],gt[2])/w.exaggeration()};for(let Te=0;Te<4;Te++){const Le=m.borderFeatureIndices[Te];if(Le.length===0)continue;const Ge=r.d4[Te](l),He=H(Ge);if(!(He&&He instanceof r.d5))continue;const rt=w?w.findDEMTileFor(Ge):null;if(!(rt&&rt.dem||E)||(w&&rt&&rt.dem&&m.borderDEMTileTimestamp[Te]!==rt.dem._timestamp&&(m.borderDoneWithNeighborZ[Te]=-1,m.borderDEMTileTimestamp[Te]=rt.dem._timestamp),m.borderDoneWithNeighborZ[Te]===He.canonical.z))continue;He.centroidVertexArray.length===0&&He.createCentroidsBuffer();const Xe=(Te<2?1:5)-Te,et=He.borderDoneWithNeighborZ[Xe]!==m.canonical.z,Ye=He.borderFeatureIndices[Xe];let at=0;if(m.canonical.z!==He.canonical.z){for(const gt of Le)m.showCentroid(m.featuresOnBorder[gt]);if(et)for(const gt of Ye)He.showCentroid(He.featuresOnBorder[gt]);m.borderDoneWithNeighborZ[Te]=He.canonical.z,He.borderDoneWithNeighborZ[Xe]=m.canonical.z}for(const gt of Le){const Vt=m.featuresOnBorder[gt],Rt=m.centroidData[Vt.centroidDataIndex],tn=Vt.borders[Te];let Jt;for(;at<Ye.length;){Jt=He.featuresOnBorder[Ye[at]];const Et=Jt.borders[Xe];if(Et[1]>tn[0]+3||Et[0]>tn[0]-3)break;He.showCentroid(Jt),at++}if(Jt&&at<Ye.length){const Et=at;let jt=0;for(;!(Jt.borders[Xe][0]>tn[1]-3)&&(jt++,++at!==Ye.length);)Jt=He.featuresOnBorder[Ye[at]];Jt=He.featuresOnBorder[Ye[Et]];let gn=!1;if(jt>=1){const Ht=Jt.borders[Xe];Math.abs(tn[0]-Ht[0])<3&&Math.abs(tn[1]-Ht[1])<3&&(jt=1,gn=!0,at=Et+1)}else if(jt===0){m.showCentroid(Vt);continue}const Tt=He.centroidData[Jt.centroidDataIndex];E&&gn&&(((ve=Rt).flags|(Ce=Tt).flags)&r.d6?(ve.flags|=r.d6,Ce.flags|=r.d6):(ve.flags&=~r.d6,Ce.flags&=~r.d6));const rn=Vt.intersectsCount()>1||Jt.intersectsCount()>1;if(jt>1)at=Et,Rt.centroidXY=Tt.centroidXY=new r.P(0,0);else if(rt&&rt.dem&&!rn){const Ht=oe[Te](Rt,Tt),Cn=Te%2?r.ag-1:0,dn=xe(Ht[0],Math.min(r.ag-1,Ht[1]),Cn,rt,Ge,Te<2,Ht[2]);Rt.centroidXY=Tt.centroidXY=$(dn)}else rn?Rt.centroidXY=Tt.centroidXY=new r.P(0,0):(Rt.centroidXY=m.encodeBorderCentroid(Vt),Tt.centroidXY=He.encodeBorderCentroid(Jt));m.writeCentroidToBuffer(Rt),He.writeCentroidToBuffer(Tt)}else m.showCentroid(Vt)}m.borderDoneWithNeighborZ[Te]=He.canonical.z,He.borderDoneWithNeighborZ[Xe]=m.canonical.z}var ve,Ce;(m.needsCentroidUpdate||!m.centroidVertexBuffer&&m.centroidVertexArray.length!==0)&&m.uploadCentroid(f)}const cd=[1,0,0],xn=[0,1,0],zn=[0,0,1];function ud(f,o,l){const m=l.transform,y=l.shadowRenderer;if(!y)return!0;const w=f.toUnwrapped(),E=m.tileSize*y._cascades[l.currentShadowCascade].scale;let O=o.maxHeight;if(m.elevation){const ve=m.elevation.getMinMaxForTile(f);ve&&(O+=ve.max)}const $=[...y.shadowDirection];$[2]=-$[2];const H=y.computeSimplifiedTileShadowVolume(w,O,E,$);if(!H)return!1;const G=[cd,xn,zn,$,[$[0],0,$[2]],[0,$[1],$[2]]],Z=m.projection.name==="globe",X=m.scaleZoom(E),oe=r.bR.fromInvProjectionMatrix(m.invProjMatrix,m.worldSize,X,!Z),xe=y.getCurrentCascadeFrustum();return oe.intersectsPrecise(H.vertices,H.planes,G)===0||xe.intersectsPrecise(H.vertices,H.planes,G)===0}function Wo(f){return[f[0]*r.d9,f[1]*r.d9,f[2]*r.d9,0]}function Lt(f,o,l,m,y,w,E,O,$){const H=m.getSource(),G=l.globeSharedBuffers;if(!G)return;let Z,X,oe;if(o&&(Z=m.getTile(o)),H instanceof r.aJ?(X=H.texture,oe=r.cI(0,0,l.transform)):Z&&o&&(X=Z.texture,oe=r.cI(o.canonical.z,o.canonical.x,l.transform)),!X||!oe)return;f||(oe=r.ab.mat4.scale(r.ab.mat4.create(),oe,[1,-1,1]));const xe=l.context,ve=xe.gl,Ce=y.paint.get("raster-resampling")==="nearest"?ve.NEAREST:ve.LINEAR,Te=l.colorModeForDrapableLayerRenderPass(w),Le=E.defines;Le.push("GLOBE_POLES");const Ge=new or(ve.LEQUAL,or.ReadWrite,l.depthRangeFor3D),He=Float32Array.from(l.transform.expandedFarZProjMatrix),rt=Float32Array.from(r.bb(r.cH(new r.bT(0,0,0))));l.terrain&&l.terrain.prepareDrawTile(),xe.activeTexture.set(ve.TEXTURE0),X.bind(Ce,ve.CLAMP_TO_EDGE),xe.activeTexture.set(ve.TEXTURE1),X.bind(Ce,ve.CLAMP_TO_EDGE),X.useMipmap&&xe.extTextureFilterAnisotropic&&l.transform.pitch>20&&ve.texParameterf(ve.TEXTURE_2D,xe.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,xe.extTextureFilterAnisotropicMax);const[Xe,et,Ye,at]=o?G.getPoleBuffers(o.canonical.z,!1):G.getPoleBuffers(0,!0),gt=y.paint.get("raster-elevation");let Vt;f?(Vt=Xe,l.renderDefaultNorthPole=gt!==0):(Vt=et,l.renderDefaultSouthPole=gt!==0);const Rt=Wo(E.mix),tn=((Et,jt,gn,Tt,rn,Ht,Cn,dn,nn,vn,Tn,Ln,Un)=>Tc(Et,jt,gn,new Float32Array(16),new Float32Array(9),[0,0],Tt,[0,0],[0,0,0,0],1,{opacity:1,mix:0},Ht,[0,0],dn,2,vn,Tn,Ln,1,0,Un))(He,rt,oe,r.ae(l.transform.zoom),0,y,0,gt,0,Rt,E.offset,E.range,w),Jt=l.getOrCreateProgram("raster",{defines:Le});l.uploadCommonUniforms(xe,Jt,null),Jt.draw(l,ve.TRIANGLES,Ge,$,Te,O,tn,y.id,Vt,Ye,at)}function i0(f){const o=f._nearZ,l=f.projection.farthestPixelDistance(f),m=l-o,y=.2*f.height,w=o+y;return[o,l,(w-y-o)/m,(w-o)/m]}function bp(f,o,l,m){if(f)return o instanceof Ei&&f instanceof yc?o.getTextureDescriptor(f,l,!0):{texture:f.texture,mix:Wo(m.mix),offset:m.offset,buffer:0,tileSize:1}}var nv=r.da([{name:"a_index",type:"Int16",components:1}]);class s0{constructor(o,l,m,y){const w={width:m[0],height:m[1],data:null},E=o.gl;this.targetColorTexture=new r.T(o,w,E.RGBA8,{useMipmap:!1}),this.backgroundColorTexture=new r.T(o,w,E.RGBA8,{useMipmap:!1}),this.context=o,this.updateParticleTexture(l,y),this.lastInvalidatedAt=0}updateParticleTexture(o,l){if(this.particleTextureDimension===l.width)return;(this.particleTexture0||this.particleTexture1||this.particleIndexBuffer||this.particleSegment)&&(this.particleTexture0.destroy(),this.particleTexture1.destroy(),this.particleIndexBuffer.destroy(),this.particleSegment.destroy());const m=this.context.gl,y=l.width*l.height;this.particleTexture0=new r.T(this.context,l,m.RGBA8,{premultiply:!1,useMipmap:!1}),this.particleTexture1=new r.T(this.context,l,m.RGBA8,{premultiply:!1,useMipmap:!1});const w=new r.db;w.reserve(y);for(let E=0;E<y;E++)w.emplaceBack(E);this.particleIndexBuffer=this.context.createVertexBuffer(w,nv.members,!0),this.particleSegment=r.b7.simpleSegment(0,0,this.particleIndexBuffer.length,0),this.particleTextureDimension=l.width}update(o){return!(this.lastInvalidatedAt<o&&(this.lastInvalidatedAt=r.q.now(),1))}destroy(){this.targetColorTexture.destroy(),this.backgroundColorTexture.destroy(),this.particleIndexBuffer.destroy(),this.particleTexture0.destroy(),this.particleTexture1.destroy(),this.particleSegment.destroy()}}function a0(f,o,l){if(!f)return null;const m=o.getTextureDescriptor(f,l,!0);if(!m)return null;let{texture:y,mix:w,offset:E,tileSize:O,buffer:$,format:H}=m;if(!y||!H)return null;let G=!1;return H==="uint32"&&(G=!0,w[3]=0,w=Wg(r.dc,w,[0,l.paint.get("raster-particle-max-speed")]),E=qg(r.dc,E,[0,l.paint.get("raster-particle-max-speed")])),{texture:y,textureOffset:[$/(O+2*$),O/(O+2*$)],tileSize:O,scalarData:G,scale:w,offset:E,defines:["RASTER_ARRAY",{uint8:"DATA_FORMAT_UINT8",uint16:"DATA_FORMAT_UINT16",uint32:"DATA_FORMAT_UINT32"}[H]]}}function l0(f){const o=f._nearZ,l=f.projection.farthestPixelDistance(f),m=l-o,y=.2*f.height,w=o+y;return[o,l,(w-y-o)/m,(w-o)/m]}const dd=new r.aj(1,0,0,1),dw=new r.aj(0,1,0,1),hw=new r.aj(0,0,1,1),c0=new r.aj(1,0,1,1),xp=new r.aj(0,1,1,1);function Ec(f,o,l,m,y,w,E){const O=f.context,$=f.transform,H=O.gl,G=$.projection.name==="globe",Z=G?["PROJECTION_GLOBE_VIEW"]:[];let X=r.ab.mat4.clone(l.projMatrix);if(G&&r.ae($.zoom)>0){const Rt=r.ba(l.canonical,$),tn=r.dd(Rt);X=r.ab.mat4.multiply(new Float32Array(16),$.globeMatrix,tn),r.ab.mat4.multiply(X,$.projMatrix,X)}const oe=r.ab.mat4.create();oe[12]+=2*y/(r.q.devicePixelRatio*$.width),oe[13]+=2*w/(r.q.devicePixelRatio*$.height),r.ab.mat4.multiply(X,oe,X);const xe=f.getOrCreateProgram("debug",{defines:Z}),ve=o.getTileByID(l.key);f.terrain&&f.terrain.setupElevationDraw(ve,xe);const Ce=or.disabled,Te=fr.disabled,Le=f.colorModeForRenderPass(),Ge="$debug";O.activeTexture.set(H.TEXTURE0),f.emptyTexture.bind(H.LINEAR,H.CLAMP_TO_EDGE),G?ve._makeGlobeTileDebugBuffers(f.context,$):ve._makeDebugTileBoundsBuffers(f.context,$.projection);const He=ve._tileDebugBuffer||f.debugBuffer,rt=ve._tileDebugIndexBuffer||f.debugIndexBuffer,Xe=ve._tileDebugSegments||f.debugSegments;if(xe.draw(f,H.LINE_STRIP,Ce,Te,Le,_r.disabled,hu(X,m),Ge,He,rt,Xe,null,null,null,[ve._globeTileDebugBorderBuffer]),E){const Rt=ve.latestRawTileData,tn=Math.floor((Rt&&Rt.byteLength||0)/1024);let Jt=l.canonical.toString();l.overscaledZ!==l.canonical.z&&(Jt+=` => ${l.overscaledZ}`),Jt+=` ${ve.state}`,Jt+=` ${tn}kb`,function(Et,jt){Et.initDebugOverlayCanvas();const gn=Et.debugOverlayCanvas,Tt=Et.context.gl,rn=Et.debugOverlayCanvas.getContext("2d");rn.clearRect(0,0,gn.width,gn.height),rn.shadowColor="white",rn.shadowBlur=2,rn.lineWidth=1.5,rn.strokeStyle="white",rn.textBaseline="top",rn.font="bold 36px Open Sans, sans-serif",rn.fillText(jt,5,5),rn.strokeText(jt,5,5),Et.debugOverlayTexture.update(gn),Et.debugOverlayTexture.bind(Tt.LINEAR,Tt.CLAMP_TO_EDGE)}(f,Jt)}const et=o.getTile(l).tileSize,Ye=512/Math.min(et,512)*(l.overscaledZ/$.zoom)*.5,at=ve._tileDebugTextBuffer||f.debugBuffer,gt=ve._tileDebugTextIndexBuffer||f.quadTriangleIndexBuffer,Vt=ve._tileDebugTextSegments||f.debugSegments;xe.draw(f,H.TRIANGLES,Ce,Te,Lr.alphaBlended,_r.disabled,hu(X,r.aj.transparent,Ye),Ge,at,gt,Vt,null,null,null,[ve._globeTileDebugTextBuffer])}function rv(f,o,l,m){pu(f,0,o+l/2,f.transform.width,l,m)}function ov(f,o,l,m){pu(f,o-l/2,0,l,f.transform.height,m)}function pu(f,o,l,m,y,w){const E=f.context,O=E.gl;O.enable(O.SCISSOR_TEST),O.scissor(o*r.q.devicePixelRatio,l*r.q.devicePixelRatio,m*r.q.devicePixelRatio,y*r.q.devicePixelRatio),E.clear({color:w}),O.disable(O.SCISSOR_TEST)}const wp=r.da([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:sl}=wp;function Nl(f,o,l,m){f.emplaceBack(o,l,m)}class u0{constructor(o){this.vertexArray=new r.de,this.indices=new r.aU,Nl(this.vertexArray,-1,-1,1),Nl(this.vertexArray,1,-1,1),Nl(this.vertexArray,-1,1,1),Nl(this.vertexArray,1,1,1),Nl(this.vertexArray,-1,-1,-1),Nl(this.vertexArray,1,-1,-1),Nl(this.vertexArray,-1,1,-1),Nl(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=o.createVertexBuffer(this.vertexArray,sl),this.indexBuffer=o.createIndexBuffer(this.indices),this.segment=r.b7.simpleSegment(0,0,36,12)}}function Di(f,o,l,m,y,w){const E=f.context.gl,O=o.paint.get("sky-atmosphere-color"),$=o.paint.get("sky-atmosphere-halo-color"),H=o.paint.get("sky-atmosphere-sun-intensity"),G=((Z,X,oe,xe,ve)=>({u_matrix_3f:Z,u_sun_direction:X,u_sun_intensity:oe,u_color_tint_r:[xe.r,xe.g,xe.b,xe.a],u_color_tint_m:[ve.r,ve.g,ve.b,ve.a],u_luminance:5e-5}))(r.ab.mat3.fromMat4(r.ab.mat3.create(),m),y,H,O,$);E.framebufferTexture2D(E.FRAMEBUFFER,E.COLOR_ATTACHMENT0,E.TEXTURE_CUBE_MAP_POSITIVE_X+w,o.skyboxTexture,0),l.draw(f,E.TRIANGLES,or.disabled,fr.disabled,Lr.unblended,_r.frontCW,G,"skyboxCapture",o.skyboxGeometry.vertexBuffer,o.skyboxGeometry.indexBuffer,o.skyboxGeometry.segment)}const fw=r.da([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class zh{constructor(o){const l=new r.df;l.emplaceBack(-1,1,1,0,0),l.emplaceBack(1,1,1,1,0),l.emplaceBack(1,-1,1,1,1),l.emplaceBack(-1,-1,1,0,1);const m=new r.aU;m.emplaceBack(0,1,2),m.emplaceBack(2,3,0),this.vertexBuffer=o.createVertexBuffer(l,fw.members),this.indexBuffer=o.createIndexBuffer(m),this.segments=r.b7.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const Fo=r.da([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_size_scale",components:1},{type:"Float32",name:"a_fade_opacity",components:1}]);class so{constructor(){this.starsCount=16e3,this.sizeMultiplier=.15,this.sizeRange=100,this.intensityRange=200}}class d0{constructor(o){this.colorModeAlphaBlendedWriteRGB=new Lr([1,nu,1,nu],r.aj.transparent,[!0,!0,!0,!1]),this.colorModeWriteAlpha=new Lr([1,0,1,0],r.aj.transparent,[!1,!1,!1,!0]),this.params=new so,this.updateNeeded=!0,o.tp.registerParameter(this.params,["Stars"],"starsCount",{min:100,max:16e3,step:1},()=>{this.updateNeeded=!0}),o.tp.registerParameter(this.params,["Stars"],"sizeMultiplier",{min:.01,max:2,step:.01}),o.tp.registerParameter(this.params,["Stars"],"sizeRange",{min:0,max:200,step:1},()=>{this.updateNeeded=!0}),o.tp.registerParameter(this.params,["Stars"],"intensityRange",{min:0,max:200,step:1},()=>{this.updateNeeded=!0})}update(o){const l=o.context;if(!this.atmosphereBuffer||this.updateNeeded){this.updateNeeded=!1,this.atmosphereBuffer=new zh(l);const m=this.params.sizeRange,y=this.params.intensityRange,w=function(G){const Z=r.di(30),X=[];for(let oe=0;oe<G;++oe){const xe=2*Math.PI*Z(),ve=Math.acos(1-2*Z())-.5*Math.PI;X.push(r.ab.vec3.fromValues(Math.cos(ve)*Math.cos(xe),Math.cos(ve)*Math.sin(xe),Math.sin(ve)))}return X}(this.params.starsCount),E=r.di(300),O=new r.dg,$=new r.aU;let H=0;for(let G=0;G<w.length;++G){const Z=r.ab.vec3.scale([],w[G],200),X=Math.max(0,1+.01*m*(1*E()-.5)),oe=Math.max(0,1+.01*y*(1*E()-.5));O.emplaceBack(Z[0],Z[1],Z[2],-1,-1,X,oe),O.emplaceBack(Z[0],Z[1],Z[2],1,-1,X,oe),O.emplaceBack(Z[0],Z[1],Z[2],1,1,X,oe),O.emplaceBack(Z[0],Z[1],Z[2],-1,1,X,oe),$.emplaceBack(H+0,H+1,H+2),$.emplaceBack(H+0,H+2,H+3),H+=4}this.starsVx=l.createVertexBuffer(O,Fo.members),this.starsIdx=l.createIndexBuffer($),this.starsSegments=r.b7.simpleSegment(0,0,O.length,$.length)}}destroy(){this.atmosphereBuffer&&this.atmosphereBuffer.destroy(),this.starsVx&&this.starsVx.destroy(),this.starsIdx&&this.starsIdx.destroy()}drawAtmosphereGlow(o,l){const m=o.context,y=m.gl,w=o.transform,E=new or(y.LEQUAL,or.ReadOnly,[0,1]),O=r.ae(w.zoom),$=o.style.getLut(l.scope),H=l.properties.get("color-use-theme")==="none",G=l.properties.get("color").toRenderColor(H?null:$).toArray01(),Z=l.properties.get("high-color-use-theme")==="none",X=l.properties.get("high-color").toRenderColor(Z?null:$).toArray01(),oe=l.properties.get("space-color-use-theme")==="none",xe=l.properties.get("space-color").toRenderColor(oe?null:$).toArray01PremultipliedAlpha(),ve=5e-4,Ce=r.dh(l.properties.get("horizon-blend"),0,1,ve,.25),Te=r.cC(o,m,w)&&Ce===ve?w.worldSize/(2*Math.PI*1.025)-1:w.globeRadius,Le=o.frameCounter/1e3%1,Ge=r.ab.vec3.length(w.globeCenterInViewSpace),He=Math.sqrt(Math.pow(Ge,2)-Math.pow(Te,2)),rt=Math.acos(He/Ge),Xe=et=>{const Ye=w.projection.name==="globe"?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"];et&&Ye.push("ALPHA_PASS");const at=o.getOrCreateProgram("globeAtmosphere",{defines:Ye}),gt=((Rt,tn,Jt,Et,jt,gn,Tt,rn,Ht,Cn,dn,nn)=>({u_frustum_tl:Rt,u_frustum_tr:tn,u_frustum_br:Jt,u_frustum_bl:Et,u_horizon:jt,u_transition:gn,u_fadeout_range:Tt,u_color:rn,u_high_color:Ht,u_space_color:Cn,u_temporal_offset:dn,u_horizon_angle:nn}))(w.frustumCorners.TL,w.frustumCorners.TR,w.frustumCorners.BR,w.frustumCorners.BL,w.frustumCorners.horizon,O,Ce,G,X,xe,Le,rt);o.uploadCommonUniforms(m,at);const Vt=this.atmosphereBuffer;Vt&&at.draw(o,y.TRIANGLES,E,fr.disabled,et?this.colorModeWriteAlpha:this.colorModeAlphaBlendedWriteRGB,_r.backCW,gt,et?"atmosphere_glow_alpha":"atmosphere_glow",Vt.vertexBuffer,Vt.indexBuffer,Vt.segments)};Xe(!1),Xe(!0)}drawStars(o,l){const m=r.aw(l.properties.get("star-intensity"),0,1);if(m===0)return;const y=o.context,w=y.gl,E=o.transform,O=o.getOrCreateProgram("stars"),$=r.ab.quat.identity([]);r.ab.quat.rotateX($,$,-E._pitch),r.ab.quat.rotateZ($,$,-E.angle),r.ab.quat.rotateX($,$,r.ai(E._center.lat)),r.ab.quat.rotateY($,$,-r.ai(E._center.lng));const H=r.ab.mat4.fromQuat(new Float32Array(16),$),G=r.ab.mat4.multiply([],E.starsProjMatrix,H),Z=r.ab.mat3.fromMat4([],H),X=r.ab.mat3.invert([],Z),oe=[0,1,0];r.ab.vec3.transformMat3(oe,oe,X),r.ab.vec3.scale(oe,oe,this.params.sizeMultiplier);const xe=[1,0,0];r.ab.vec3.transformMat3(xe,xe,X),r.ab.vec3.scale(xe,xe,this.params.sizeMultiplier);const ve=(Ce=oe,Te=xe,Le=m,{u_matrix:Float32Array.from(G),u_up:Ce,u_right:Te,u_intensity_multiplier:Le});var Ce,Te,Le;o.uploadCommonUniforms(y,O),this.starsVx&&this.starsIdx&&O.draw(o,w.TRIANGLES,or.disabled,fr.disabled,this.colorModeAlphaBlendedWriteRGB,_r.disabled,ve,"atmosphere_stars",this.starsVx,this.starsIdx,this.starsSegments)}}function Bl(f,o){const l=[...f],m=o.cameraWorldSizeForFog/o.worldSize,y=r.ab.mat4.identity([]);return r.ab.mat4.scale(y,y,[m,m,1]),r.ab.mat4.multiply(l,y,l),r.ab.mat4.multiply(l,o.worldToFogMatrix,l),l}function hd(f,o,l,m,y){const w=l.material,E=m.context,{baseColorTexture:O,metallicRoughnessTexture:$}=w.pbrMetallicRoughness,{normalTexture:H,occlusionTexture:G,emissionTexture:Z}=w;function X(xe,ve,Ce){if(xe&&(f.push(ve),E.activeTexture.set(E.gl.TEXTURE0+Ce),xe.gfxTexture)){const{minFilter:Te,magFilter:Le,wrapS:Ge,wrapT:He}=xe.sampler;xe.gfxTexture.bindExtraParam(Te,Le,Ge,He)}}X(O,"HAS_TEXTURE_u_baseColorTexture",Wi.BaseColor),X($,"HAS_TEXTURE_u_metallicRoughnessTexture",Wi.MetallicRoughness),X(H,"HAS_TEXTURE_u_normalTexture",Wi.Normal),X(G,"HAS_TEXTURE_u_occlusionTexture",Wi.Occlusion),X(Z,"HAS_TEXTURE_u_emissionTexture",Wi.Emission),y&&(y.texture||(y.texture=new r.dk(m.context,y.image,[y.image.height,y.image.height,y.image.height],E.gl.RGBA8)),E.activeTexture.set(E.gl.TEXTURE0+Wi.LUT),y.texture&&y.texture.bind(E.gl.LINEAR,E.gl.CLAMP_TO_EDGE),f.push("APPLY_LUT_ON_GPU")),l.texcoordBuffer&&(f.push("HAS_ATTRIBUTE_a_uv_2f"),o.push(l.texcoordBuffer)),l.colorBuffer&&(f.push(l.colorBuffer.itemSize===12?"HAS_ATTRIBUTE_a_color_3f":"HAS_ATTRIBUTE_a_color_4f"),o.push(l.colorBuffer)),l.normalBuffer&&(f.push("HAS_ATTRIBUTE_a_normal_3f"),o.push(l.normalBuffer)),l.pbrBuffer&&(f.push("HAS_ATTRIBUTE_a_pbr"),f.push("HAS_ATTRIBUTE_a_heightBasedEmissiveStrength"),o.push(l.pbrBuffer)),w.alphaMode!=="OPAQUE"&&w.alphaMode!=="MASK"||f.push("UNPREMULT_TEXTURE_IN_SHADER"),w.defined||f.push("DIFFUSE_SHADED");const oe=m.shadowRenderer;oe&&(f.push("RENDER_SHADOWS","DEPTH_TEXTURE"),oe.useNormalOffset&&f.push("NORMAL_OFFSET"))}function Vl(f,o,l,m,y,w){const E=l.paint.get("model-opacity").constantOr(1),O=o.context,$=new or(o.context.gl.LEQUAL,or.ReadWrite,o.depthRangeFor3D),H=o.transform,G=f.mesh,Z=G.material,X=Z.pbrMetallicRoughness,oe=o.style.fog;let xe;xe=o.transform.projection.zAxisUnit==="pixels"?[...f.nodeModelMatrix]:r.ab.mat4.multiply([],m.zScaleMatrix,f.nodeModelMatrix),r.ab.mat4.multiply(xe,m.negCameraPosMatrix,xe);const ve=r.ab.mat4.invert([],xe);r.ab.mat4.transpose(ve,ve);const Ce=l.paint.get("model-color-use-theme").constantOr("default")==="none",Te=l.paint.get("model-emissive-strength").constantOr(0),Le=Rh(new Float32Array(f.worldViewProjection),new Float32Array(xe),new Float32Array(ve),null,o,E,X.baseColorFactor.toRenderColor(null),Z.emissiveFactor,X.metallicFactor,X.roughnessFactor,Z,Te,l),Ge={defines:[]},He=[],rt=o.shadowRenderer;rt&&(rt.useNormalOffset=!1),hd(Ge.defines,He,G,o,Ce?null:l.lut);let Xe=null;if(oe){const at=Bl(f.nodeModelMatrix,o.transform);if(Xe=new Float32Array(at),H.projection.name!=="globe"){const gt=G.aabb.min,Vt=G.aabb.max,[Rt,tn]=oe.getOpacityForBounds(at,gt[0],gt[1],Vt[0],Vt[1]);Ge.overrideFog=Rt>=Je||tn>=Je}}const et=xc(o,l.paint.get("model-cutoff-fade-range"));et.shouldRenderCutoff&&Ge.defines.push("RENDER_CUTOFF");const Ye=o.getOrCreateProgram("model",Ge);o.uploadCommonUniforms(O,Ye,null,Xe,et),o.renderPass!=="shadow"&&rt&&rt.setupShadowsFromMatrix(f.nodeModelMatrix,Ye),Ye.draw(o,O.gl.TRIANGLES,$,y,w,G.material.doubleSided?_r.disabled:_r.backCCW,Le,l.id,G.vertexBuffer,G.indexBuffer,G.segments,l.paint,o.transform.zoom,void 0,He)}function Sp(f,o,l,m,y,w,E){let O;O=f.projection.name==="globe"?r.dl(l,f):[...l],r.ab.mat4.multiply(O,O,o.matrix);const $=r.ab.mat4.multiply([],m,O);if(o.meshes)for(const H of o.meshes){if(H.material.alphaMode!=="BLEND"){E.push({mesh:H,depth:0,modelIndex:y,worldViewProjection:$,nodeModelMatrix:O});continue}const G=r.ab.vec3.transformMat4([],H.centroid,$);!f.isOrthographic&&G[2]<=0||w.push({mesh:H,depth:G[2],modelIndex:y,worldViewProjection:$,nodeModelMatrix:O})}if(o.children)for(const H of o.children)Sp(f,H,l,m,y,w,E)}function Fh(f,o,l,m){const y=l.shadowRenderer;if(!y)return;const w=y.getShadowPassDepthMode(),E=y.getShadowPassColorMode(),O=y.calculateShadowPassMatrixFromMatrix(o),$=gp(O);l.getOrCreateProgram("modelDepth",{defines:l._shadowMapDebug?[]:["DEPTH_TEXTURE"]}).draw(l,l.context.gl.TRIANGLES,w,fr.disabled,E,_r.backCCW,$,m.id,f.vertexBuffer,f.indexBuffer,f.segments,m.paint,l.transform.zoom,void 0,void 0)}function al(f,o,l){const m=o.updateZoomBasedPaintProperties(),y=function(w,E,O){let $,H,G,Z=w.terrain?w.terrain.exaggeration():0;if(w.terrain&&Z>0){const X=w.terrain,oe=X.findDEMTileFor(O);oe&&oe.dem?$=r.dn.create(X,O,oe):Z=0}if(Z===0&&(E.terrainElevationMin=0,E.terrainElevationMax=0),Z===E.validForExaggeration&&(Z===0||$&&$._demTile&&$._demTile.tileID===E.validForDEMTile.id&&$._dem._timestamp===E.validForDEMTile.timestamp))return!1;for(const X in E.instancesPerModel){const oe=E.instancesPerModel[X];for(let xe=0;xe<oe.instancedDataArray.length;++xe){const ve=($?Z*$.getElevationAt(0|oe.instancedDataArray.float32[16*xe],0|oe.instancedDataArray.float32[16*xe+1],!0,!0):0)+oe.instancesEvaluatedElevation[xe];oe.instancedDataArray.float32[16*xe+6]=ve,H=H?Math.min(E.terrainElevationMin,ve):ve,G=G?Math.max(E.terrainElevationMax,ve):ve}}return E.terrainElevationMin=H||0,E.terrainElevationMax=G||0,E.validForExaggeration=Z,E.validForDEMTile=$&&$._demTile?{id:$._demTile.tileID,timestamp:$._dem._timestamp}:{id:void 0,timestamp:0},!0}(f,o,l);(m||y)&&(o.uploaded=!1,o.upload(f.context))}const Ji={shadowUniformsInitialized:!1,useSingleShadowCascade:!1,tileMatrix:new Float64Array(16),shadowTileMatrix:new Float32Array(16),aabb:new r.cd([0,0,0],[r.ag,r.ag,0])};function Tp(f,o){const l=1<<f.canonical.z,m=o.getFreeCameraOptions().position,y=o.elevation,w=f.canonical.x/l,E=(f.canonical.x+1)/l,O=f.canonical.y/l,$=(f.canonical.y+1)/l;let H=o._centerAltitude;if(y){const oe=y.getMinMaxForTile(f);oe&&oe.max>H&&(H=oe.max)}const G=r.aw(m.x,w,E)-m.x,Z=r.aw(m.y,O,$)-m.y,X=r.bH(H,o.center.lat)-m.z;return o._zoomFromMercatorZ(Math.sqrt(G*G+Z*Z+X*X))}function Nh(f,o,l,m,y,w,E){const O=f.context,$=f.renderPass==="shadow",H=f.shadowRenderer,G=$&&H?H.getShadowPassDepthMode():new or(O.gl.LEQUAL,or.ReadWrite,f.depthRangeFor3D),Z=f.isTileAffectedByFog(w);if(l.meshes)for(const X of l.meshes){const oe=["MODEL_POSITION_ON_GPU"],xe=[];let ve,Ce,Te;m.instancedDataArray.length>20&&oe.push("INSTANCED_ARRAYS");const Le=xc(f,o.paint.get("model-cutoff-fade-range"));if(Le.shouldRenderCutoff&&oe.push("RENDER_CUTOFF"),$&&H)ve=f.getOrCreateProgram("modelDepth",{defines:oe}),Ce=gp(E.shadowTileMatrix,E.shadowTileMatrix,Float32Array.from(l.matrix)),Te=H.getShadowPassColorMode();else{hd(oe,xe,X,f,o.paint.get("model-color-use-theme").constantOr("default")==="none"?null:o.lut),ve=f.getOrCreateProgram("model",{defines:oe,overrideFog:Z});const He=X.material,rt=He.pbrMetallicRoughness,Xe=o.paint.get("model-opacity").constantOr(1),et=o.paint.get("model-emissive-strength").constantOr(0);Ce=Rh(w.expandedProjMatrix,Float32Array.from(l.matrix),new Float32Array(16),null,f,Xe,rt.baseColorFactor.toRenderColor(null),He.emissiveFactor,rt.metallicFactor,rt.roughnessFactor,He,et,o,y),H&&(E.shadowUniformsInitialized?ve.setShadowUniformValues(O,H.getShadowUniformValues()):(H.setupShadows(w.toUnwrapped(),ve,"model-tile",w.overscaledZ),E.shadowUniformsInitialized=!0)),Te=Le.shouldRenderCutoff||Xe<1||He.alphaMode!=="OPAQUE"?Lr.alphaBlended:Lr.unblended}f.uploadCommonUniforms(O,ve,w.toUnwrapped(),null,Le);const Ge=X.material.doubleSided?_r.disabled:_r.backCCW;if(m.instancedDataArray.length>20)xe.push(m.instancedDataBuffer),ve.draw(f,O.gl.TRIANGLES,G,fr.disabled,Te,Ge,Ce,o.id,X.vertexBuffer,X.indexBuffer,X.segments,o.paint,f.transform.zoom,void 0,xe,m.instancedDataArray.length);else{const He=$?"u_instance":"u_normal_matrix";for(let rt=0;rt<m.instancedDataArray.length;++rt)Ce[He]=new Float32Array(m.instancedDataArray.arrayBuffer,64*rt,16),ve.draw(f,O.gl.TRIANGLES,G,fr.disabled,Te,Ge,Ce,o.id,X.vertexBuffer,X.indexBuffer,X.segments,o.paint,f.transform.zoom,void 0,xe)}}if(l.children)for(const X of l.children)Nh(f,o,X,m,y,w,E)}const iv=[1,-1,1];function sv(f,o,l,m){if(!l.modelManager)return!0;const y=l.modelManager;if(!l.shadowRenderer)return!0;const w=l.shadowRenderer,E=o.aabb;let O=!0,$=f.maxHeight;if($===0){let G=0;for(const Z in f.instancesPerModel){const X=y.getModel(Z,m);X?G=Math.max(G,Math.max(Math.max(X.aabb.max[0],X.aabb.max[1]),X.aabb.max[2])):O=!1}$=f.maxScale*G*1.41+f.maxVerticalOffset,O&&(f.maxHeight=$)}E.max[2]=$,E.min[2]+=f.terrainElevationMin,E.max[2]+=f.terrainElevationMax,r.ab.vec3.transformMat4(E.min,E.min,o.tileMatrix),r.ab.vec3.transformMat4(E.max,E.max,o.tileMatrix);const H=E.intersects(w.getCurrentCascadeFrustum());return l.currentShadowCascade===0&&(f.isInsideFirstShadowMapFrustum=H===2),H===0}function mu(f,o){const l=f.uniformValues.u_cutoff_params[0],m=f.uniformValues.u_cutoff_params[1],y=f.uniformValues.u_cutoff_params[2],w=f.uniformValues.u_cutoff_params[3];return m===l||w===y?1:r.aw(((o-l)/(m-l)-y)/(w-y),0,1)}function av(f,o,l,m){if(o.pitch<20)return 1;const y=o.getWorldToCameraMatrix();r.ab.mat4.multiply(y,y,f);const w=r.ab.vec4.fromValues(l.min[0],l.min[1],l.min[2],1);let E=r.ab.vec4.transformMat4(r.ab.vec4.create(),w,y),O=E,$=E;w[1]=l.max[1],E=r.ab.vec4.transformMat4(r.ab.vec4.create(),w,y),O=E[1]<O[1]?E:O,$=E[1]>$[1]?E:$,w[0]=l.max[0],E=r.ab.vec4.transformMat4(r.ab.vec4.create(),w,y),O=E[1]<O[1]?E:O,$=E[1]>$[1]?E:$,w[1]=l.min[1],E=r.ab.vec4.transformMat4(r.ab.vec4.create(),w,y),O=E[1]<O[1]?E:O,$=E[1]>$[1]?E:$;const H=r.aw(m[0],0,1),G=100*o.pixelsPerMeter*r.aw(m[1],0,1),Z=r.aw(m[2],0,1),X=r.ab.vec4.lerp(r.ab.vec4.create(),O,$,H),oe=Math.tan(.5*o.fovX),xe=-X[2]*oe;if(G===0)return X[1]<-Math.abs(xe)?Z:1;const ve=(-Math.abs(xe)-X[1])/G,Ce=(Le,Ge,He)=>(1-He)*Le+He*Ge,Te=r.aw(Ce(1,Z,ve),Z,1);return Ce(1,Te,r.aw((o.pitch-20)/20,0,1))}class Mc{}class lv{constructor(){this._storage=new Map}getLinesFromTrianglesBuffer(o,l,m){{const Z=this._storage.get(l.id);if(Z)return Z.lastUsedFrameIdx=o,Z.buf}const y=m.gl,w=y.getBufferParameter(y.ELEMENT_ARRAY_BUFFER,y.BUFFER_SIZE),E=new ArrayBuffer(w),O=new Int16Array(E);y.getBufferSubData(y.ELEMENT_ARRAY_BUFFER,0,new Int16Array(E));const $=new r.dq;for(let Z=0;Z<w/2;Z+=3){const X=O[Z],oe=O[Z+1],xe=O[Z+2];$.emplaceBack(X,oe),$.emplaceBack(oe,xe),$.emplaceBack(xe,X)}const H=m.bindVertexArrayOES.current,G=new Mc;return G.buf=new il(m,$),G.lastUsedFrameIdx=o,this._storage.set(l.id,G),m.bindVertexArrayOES.set(H),G.buf}update(o){for(const[l,m]of this._storage)o-m.lastUsedFrameIdx>30&&(m.buf.destroy(),this._storage.delete(l))}destroy(){for(const[o,l]of this._storage)l.buf.destroy(),this._storage.delete(o)}}class Cp{constructor(o){this.occluderSize=30,this.depthOffset=-1e-4,o.registerParameter(this,["Occlusion"],"occluderSize",{min:1,max:100,step:1}),o.registerParameter(this,["Occlusion"],"depthOffset",{min:-.05,max:0,step:1e-5})}}const cv=r.da([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_rainParticleData",components:4}]);class uv{registerParameter(){}registerButton(){}registerBinding(){}refreshUI(){}}class $i{constructor(o,l){this.revealStart=11,this.revealRange=2,o.registerParameter(this,[...l,"Reveal"],"revealStart",{min:0,max:17,step:.05}),o.registerParameter(this,[...l,"Reveal"],"revealRange",{min:.1,max:5.1,step:.05})}}const dv=r.da([{type:"Float32",name:"a_pos_2f",components:2}]);class hv{destroy(){this.vignetteVx&&this.vignetteVx.destroy(),this.vignetteIdx&&this.vignetteIdx.destroy()}draw(o,l){const m=o.getOrCreateProgram("vignette");if(!this.vignetteVx||!this.vignetteIdx){const E=new r.dr,O=new r.aU;E.emplaceBack(-1,-1),E.emplaceBack(1,-1),E.emplaceBack(1,1),E.emplaceBack(-1,1),O.emplaceBack(0,1,2),O.emplaceBack(0,2,3),this.vignetteVx=o.context.createVertexBuffer(E,dv.members),this.vignetteIdx=o.context.createIndexBuffer(O)}const y=r.b7.simpleSegment(0,0,4,6);if(this.vignetteVx&&this.vignetteIdx){o.uploadCommonUniforms(o.context,m);const E={u_vignetteShape:(w={vignetteShape:[l.start,l.range,Math.pow(10,l.fadePower)],vignetteColor:[l.color.r,l.color.g,l.color.b,l.color.a*l.strength]}).vignetteShape,u_vignetteColor:w.vignetteColor};m.draw(o,o.context.gl.TRIANGLES,or.disabled,fr.disabled,Lr.alphaBlended,_r.disabled,E,"vignette",this.vignetteVx,this.vignetteIdx,y,{})}var w}}class Bh{constructor(){this._accumulatedOffsetX=0,this._accumulatedOffsetY=0,this._accumulatedElevation=0}update(o,l){const m=o.getFreeCameraOptions().position,y=m.toAltitude(),w=m.toLngLat(),E=r.ai(w.lng),O=r.ai(w.lat),$=o.pixelsPerMeter/l,H=E*r.ds,G=r.ds*Math.log(Math.tan(Math.PI/4+O/2));if(this._offsetXPrev===void 0)this._offsetXPrev=0,this._offsetYPrev=0,this._elevationPrev=0,this._accumulatedOffsetX=0,this._accumulatedOffsetY=0,this._accumulatedElevation=0;else{const Z=-this._offsetYPrev+G,X=-this._elevationPrev+y;this._accumulatedOffsetX+=(-this._offsetXPrev+H)*$,this._accumulatedOffsetY+=Z*$,this._accumulatedElevation+=X*$,this._offsetXPrev=H,this._offsetYPrev=G,this._elevationPrev=y}}getPosition(){return[this._accumulatedOffsetX,this._accumulatedOffsetY,this._accumulatedElevation]}}function Ic(f,o){return[-(f[0]-Math.floor(f[0]/o)*o),-(f[1]-Math.floor(f[1]/o)*o),-(f[2]-Math.floor(f[2]/o)*o)]}function Ep(f){const o=r.di(1323123451230),l=[];for(let m=0;m<f;++m){const y=2*o()-1,w=2*o()-1,E=2*o()-1;l.push(r.ab.vec3.fromValues(y,w,E))}return l}function ll(f,o,l,m,y){const w=r.aw((y-l)/(m-l),0,1);return(1-w)*f+w*o}class Mp{constructor(o){this._movement=new Bh,this._accumulatedTimeFromStart=0,this._prevTime=Date.now()/1e3,this._vignette=new hv,this._ppmScaleFactor=o}destroy(){this.particlesVx&&this.particlesVx.destroy(),this.particlesIdx&&this.particlesIdx.destroy(),this._vignette&&this._vignette.destroy()}updateOnRender(o,l){const m=o.transform;this._movement.update(m,this._ppmScaleFactor);const y=m.starsProjMatrix,w=r.ab.quat.identity([]);r.ab.quat.rotateX(w,w,r.ai(90)-m._pitch),r.ab.quat.rotateZ(w,w,-m.angle);const E=r.ab.mat4.fromQuat(new Float32Array(16),w),O=r.ab.mat4.fromValues(1,0,0,0,0,0,1,0,0,-1,0,0,0,0,0,1),$=r.ab.mat4.transpose([],O),H=r.ab.mat4.multiply([],$,E),G=Date.now()/1e3;return this._accumulatedTimeFromStart+=(G-this._prevTime)*l,this._prevTime=G,{projectionMatrix:y,modelviewMatrix:H}}}class fd extends Mp{constructor(o){super(4.25),this._params={overrideStyleParameters:!1,intensity:.5,timeFactor:1,velocityConeAperture:0,velocity:300,boxSize:2500,dropletSizeX:1,dropletSizeYScale:10,distortionStrength:70,screenThinning:{intensity:.57,start:.46,range:1.17,fadePower:.17,affectedRatio:1,particleOffset:-.2},color:{r:.66,g:.68,b:.74,a:.7},direction:{x:-50,y:-35},shapeDirPower:2,shapeNormalPower:1},this._revealParams=new $i(o.tp,["Precipitation","Rain"]),this._vignetteParams={strength:1,start:.7,range:1,fadePower:.4,color:{r:.27,g:.27,b:.27,a:1}},this.particlesCount=16e3}update(o){const l=o.context;if(!this.particlesVx){const m=Ep(this.particlesCount),y=new r.dt,w=new r.aU;let E=0;const O=r.di(1323123451230);for(let $=0;$<m.length;++$){const H=m[$],G=[2*O()-1,O(),O(),O()];y.emplaceBack(H[0],H[1],H[2],-1,-1,...G),y.emplaceBack(H[0],H[1],H[2],1,-1,...G),y.emplaceBack(H[0],H[1],H[2],1,1,...G),y.emplaceBack(H[0],H[1],H[2],-1,1,...G),w.emplaceBack(E+0,E+1,E+2),w.emplaceBack(E+0,E+2,E+3),E+=4}this.particlesVx=l.createVertexBuffer(y,cv.members),this.particlesIdx=l.createIndexBuffer(w)}}draw(o){if(!this._params.overrideStyleParameters&&!o.style.rain)return;const l=this._params.overrideStyleParameters?this._revealParams:{revealStart:0,revealRange:.01},m=o.transform.zoom;if(l.revealStart>m)return;const y=ll(0,1,l.revealStart,l.revealStart+l.revealRange,m);if(!this.particlesVx||!this.particlesIdx)return;const w=structuredClone(this._params);let E=[-w.direction.x,w.direction.y,-100];r.ab.vec3.normalize(E,E);const O=structuredClone(this._vignetteParams);O.strength*=y,w.overrideStyleParameters||(w.intensity=o.style.rain.state.density,w.timeFactor=o.style.rain.state.intensity,w.color=structuredClone(o.style.rain.state.color),E=structuredClone(o.style.rain.state.direction),w.screenThinning.intensity=o.style.rain.state.centerThinning,w.dropletSizeX=o.style.rain.state.dropletSize[0],w.dropletSizeYScale=o.style.rain.state.dropletSize[1]/o.style.rain.state.dropletSize[0],w.distortionStrength=100*o.style.rain.state.distortionStrength,O.strength=1,O.color=structuredClone(o.style.rain.state.vignetteColor));const $=this.updateOnRender(o,w.timeFactor),H=o.context,G=H.gl,Z=o.transform;this.screenTexture&&this.screenTexture.size[0]===o.width&&this.screenTexture.size[1]===o.height||(this.screenTexture=new r.T(H,{width:o.width,height:o.height,data:null},G.RGBA8)),w.distortionStrength>0&&(H.activeTexture.set(G.TEXTURE0),this.screenTexture.bind(G.LINEAR,G.CLAMP_TO_EDGE),G.copyTexSubImage2D(G.TEXTURE_2D,0,0,0,0,0,o.width,o.height));const X=o.getOrCreateProgram("rainParticle");o.uploadCommonUniforms(H,X),H.activeTexture.set(G.TEXTURE0),this.screenTexture.bind(G.LINEAR,G.CLAMP_TO_EDGE);const oe=[w.color.r,w.color.g,w.color.b,w.color.a],xe=(ve,Ce)=>{const Te=Ic(this._movement.getPosition(),ve),Le=w.dropletSizeX,Ge=w.dropletSizeX*w.dropletSizeYScale,He=o.width/2,rt=o.height/2,Xe=ll(0,w.screenThinning.start,0,1,w.screenThinning.intensity),et=ll(.001,w.screenThinning.range,0,1,w.screenThinning.intensity),Ye=ll(0,w.screenThinning.particleOffset,0,1,w.screenThinning.intensity),at=(gt={modelview:$.modelviewMatrix,projection:$.projectionMatrix,time:this._accumulatedTimeFromStart,camPos:Te,velocityConeAperture:w.velocityConeAperture,velocity:w.velocity,boxSize:ve,rainDropletSize:[Le,Ge],distortionStrength:w.distortionStrength,rainDirection:E,color:oe,screenSize:[Z.width,Z.height],thinningCenterPos:[He,rt],thinningShape:[Xe,et,Math.pow(10,w.screenThinning.fadePower)],thinningAffectedRatio:w.screenThinning.affectedRatio,thinningParticleOffset:Ye,shapeDirectionalPower:w.shapeDirPower,shapeNormalPower:w.shapeNormalPower,mode:Ce?0:1},{u_modelview:Float32Array.from(gt.modelview),u_projection:Float32Array.from(gt.projection),u_time:gt.time,u_cam_pos:gt.camPos,u_texScreen:0,u_velocityConeAperture:gt.velocityConeAperture,u_velocity:gt.velocity,u_boxSize:gt.boxSize,u_rainDropletSize:gt.rainDropletSize,u_distortionStrength:gt.distortionStrength,u_rainDirection:gt.rainDirection,u_color:gt.color,u_screenSize:gt.screenSize,u_thinningCenterPos:gt.thinningCenterPos,u_thinningShape:gt.thinningShape,u_thinningAffectedRatio:gt.thinningAffectedRatio,u_thinningParticleOffset:gt.thinningParticleOffset,u_shapeDirectionalPower:gt.shapeDirectionalPower,u_shapeNormalPower:gt.shapeNormalPower,u_mode:gt.mode});var gt;const Vt=Math.round(w.intensity*this.particlesCount),Rt=r.b7.simpleSegment(0,0,4*Vt,2*Vt);X.draw(o,G.TRIANGLES,or.disabled,fr.disabled,Lr.alphaBlended,_r.disabled,at,"rain_particles",this.particlesVx,this.particlesIdx,Rt,{})};w.distortionStrength>0&&xe(w.boxSize,!0),xe(w.boxSize,!1),this._vignette.draw(o,O)}}const fv=r.da([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_snowParticleData",components:4},{type:"Float32",name:"a_snowParticleDataHorizontalOscillation",components:2}]);class pv extends Mp{constructor(o){super(2.25),this._params={overrideStyleParameters:!1,intensity:.85,timeFactor:.75,velocityConeAperture:70,velocity:40,horizontalOscillationRadius:4,horizontalOscillationRate:1.5,boxSize:2e3,billboardSize:2,shapeFadeStart:.27,shapeFadePower:.21,screenThinning:{intensity:.4,start:.15,range:1.4,fadePower:.24,affectedRatio:1,particleOffset:-.2},color:{r:1,g:1,b:1,a:1},direction:{x:-50,y:-35}},this._revealParams=new $i(o.tp,["Precipitation","Snow"]),this._vignetteParams={strength:.3,start:.78,range:.46,fadePower:.2,color:{r:1,g:1,b:1,a:1}},this.particlesCount=16e3}update(o){const l=o.context;if(!this.particlesVx){const m=Ep(this.particlesCount),y=new r.du,w=new r.aU;let E=0;const O=r.di(1323123451230);for(let $=0;$<m.length;++$){const H=m[$],G=O(),Z=O(),X=O(),oe=[$/m.length,G,Z,X],xe=[O(),O()];y.emplaceBack(H[0],H[1],H[2],-1,-1,...oe,...xe),y.emplaceBack(H[0],H[1],H[2],1,-1,...oe,...xe),y.emplaceBack(H[0],H[1],H[2],1,1,...oe,...xe),y.emplaceBack(H[0],H[1],H[2],-1,1,...oe,...xe),w.emplaceBack(E+0,E+1,E+2),w.emplaceBack(E+0,E+2,E+3),E+=4}this.particlesVx=l.createVertexBuffer(y,fv.members),this.particlesIdx=l.createIndexBuffer(w)}}draw(o){if(!this._params.overrideStyleParameters&&!o.style.snow)return;const l=structuredClone(this._params);let m=[-l.direction.x,l.direction.y,-100];r.ab.vec3.normalize(m,m);const y=structuredClone(this._vignetteParams),w=l.overrideStyleParameters?this._revealParams:{revealStart:0,revealRange:.01},E=o.transform.zoom;if(w.revealStart>E)return;const O=ll(0,1,w.revealStart,w.revealStart+w.revealRange,E);y.strength*=O,l.overrideStyleParameters||(l.intensity=o.style.snow.state.density,l.timeFactor=o.style.snow.state.intensity,l.color=structuredClone(o.style.snow.state.color),m=structuredClone(o.style.snow.state.direction),l.screenThinning.intensity=o.style.snow.state.centerThinning,l.billboardSize=2.79*o.style.snow.state.flakeSize,y.strength=1,y.color=structuredClone(o.style.snow.state.vignetteColor));const $=this.updateOnRender(o,l.timeFactor);if(!this.particlesVx||!this.particlesIdx)return;const H=o.context,G=H.gl,Z=o.transform,X=o.getOrCreateProgram("snowParticle");o.uploadCommonUniforms(H,X),((oe,xe,ve)=>{const Ce=Ic(this._movement.getPosition(),oe),Te=Z.width/2,Le=Z.height/2,Ge=ll(0,ve.screenThinning.start,0,1,ve.screenThinning.intensity),He=ll(.001,ve.screenThinning.range,0,1,ve.screenThinning.intensity),rt=ll(0,ve.screenThinning.particleOffset,0,1,ve.screenThinning.intensity),Xe=(et={modelview:$.modelviewMatrix,projection:$.projectionMatrix,time:this._accumulatedTimeFromStart,camPos:Ce,velocityConeAperture:ve.velocityConeAperture,velocity:ve.velocity,horizontalOscillationRadius:ve.horizontalOscillationRadius,horizontalOscillationRate:ve.horizontalOscillationRate,boxSize:oe,billboardSize:1*ve.billboardSize,simpleShapeParameters:[ve.shapeFadeStart,ve.shapeFadePower],screenSize:[Z.width,Z.height],thinningCenterPos:[Te,Le],thinningShape:[Ge,He,Math.pow(10,ve.screenThinning.fadePower)],thinningAffectedRatio:ve.screenThinning.affectedRatio,thinningParticleOffset:rt,color:[ve.color.r,ve.color.g,ve.color.b,ve.color.a],direction:m},{u_modelview:Float32Array.from(et.modelview),u_projection:Float32Array.from(et.projection),u_time:et.time,u_cam_pos:et.camPos,u_velocityConeAperture:et.velocityConeAperture,u_velocity:et.velocity,u_horizontalOscillationRadius:et.horizontalOscillationRadius,u_horizontalOscillationRate:et.horizontalOscillationRate,u_boxSize:et.boxSize,u_billboardSize:et.billboardSize,u_simpleShapeParameters:et.simpleShapeParameters,u_screenSize:et.screenSize,u_thinningCenterPos:et.thinningCenterPos,u_thinningShape:et.thinningShape,u_thinningAffectedRatio:et.thinningAffectedRatio,u_thinningParticleOffset:et.thinningParticleOffset,u_particleColor:et.color,u_direction:et.direction});var et;const Ye=Math.round(ve.intensity*this.particlesCount),at=r.b7.simpleSegment(0,0,4*Ye,2*Ye);this.particlesVx&&this.particlesIdx&&X.draw(o,G.TRIANGLES,or.disabled,fr.disabled,Lr.alphaBlended,_r.disabled,Xe,"snow_particles",this.particlesVx,this.particlesIdx,at,{})})(l.boxSize,0,l),this._vignette.draw(o,y)}}const Vh={symbol:function(f,o,l,m,y){if(f.renderPass!=="translucent")return;const w=fr.disabled,E=f.colorModeForRenderPass(),O=l.layout.get("text-variable-anchor"),$=l.layout.get("text-size-scale-range"),H=r.aw(f.scaleFactor,$[0],$[1]);O&&function(X,oe,xe,ve,Ce,Te,Le,Ge){const He=oe.transform,rt=Ce==="map",Xe=Te==="map";for(const et of X){const Ye=ve.getTile(et),at=Ye.getBucket(xe);if(!at||!at.text||!at.text.segments.get().length)continue;const gt=r.bp(at.textSizeData,He.zoom,Ge),Vt=tu(et,at.getProjection(),He),Rt=He.calculatePixelsToTileUnitsMatrix(Ye),tn=Ni(Vt,Ye.tileID.canonical,Xe,rt,He,at.getProjection(),Rt),Jt=at.hasIconTextFit()&&at.hasIconData();if(gt){const Et=Math.pow(2,He.zoom-Ye.tileID.overscaledZ);_p(at,rt,Xe,Le,r.cX,He,tn,et,Et,gt,Jt)}}}(m,f,l,o,l.layout.get("text-rotation-alignment"),l.layout.get("text-pitch-alignment"),y,H);const G=l.paint.get("icon-opacity").constantOr(1)!==0,Z=l.paint.get("text-opacity").constantOr(1)!==0;l.layout.get("symbol-sort-key").constantOr(1)!==void 0&&(G||Z)?Lh(f,o,l,m,w,E):(G&&Lh(f,o,l,m,w,E,{onlyIcons:!0}),Z&&Lh(f,o,l,m,w,E,{onlyText:!0})),o.map.showCollisionBoxes&&(vp(f,o,l,m,l.paint.get("text-translate"),l.paint.get("text-translate-anchor"),!0),vp(f,o,l,m,l.paint.get("icon-translate"),l.paint.get("icon-translate-anchor"),!1))},circle:function(f,o,l,m){if(f.renderPass!=="translucent")return;const y=l.paint.get("circle-opacity"),w=l.paint.get("circle-stroke-width"),E=l.paint.get("circle-stroke-opacity"),O=l.layout.get("circle-sort-key").constantOr(1)!==void 0,$=l.paint.get("circle-emissive-strength");if(y.constantOr(1)===0&&(w.constantOr(1)===0||E.constantOr(1)===0))return;const H=f.context,G=H.gl,Z=f.transform,X=f.depthModeForSublayer(0,or.ReadOnly),oe=fr.disabled,xe=f.colorModeForDrapableLayerRenderPass($),ve=Z.projection.name==="globe",Ce=[r.at(Z.center.lng),r.aA(Z.center.lat)],Te=[];for(let Ge=0;Ge<m.length;Ge++){const He=m[Ge],rt=o.getTile(He),Xe=rt.getBucket(l);if(!Xe||Xe.projection.name!==Z.projection.name)continue;const et=Xe.programConfigurations.get(l.id),Ye=r.cY(l),at=f.isTileAffectedByFog(He);ve&&Ye.push("PROJECTION_GLOBE_VIEW"),Ye.push("DEPTH_D24"),f.terrain&&Z.depthOcclusionForSymbolsAndCircles&&Ye.push("DEPTH_OCCLUSION");const gt=f.getOrCreateProgram("circle",{config:et,defines:Ye,overrideFog:at}),Vt=Xe.layoutVertexBuffer,Rt=Xe.globeExtVertexBuffer,tn=Xe.indexBuffer,Jt=Z.projection.createInversionMatrix(Z,He.canonical),Et={programConfiguration:et,program:gt,layoutVertexBuffer:Vt,globeExtVertexBuffer:Rt,indexBuffer:tn,uniformValues:r.cZ(f,He,rt,Jt,Ce,l),tile:rt};if(O){const jt=Xe.segments.get();for(const gn of jt)Te.push({segments:new r.b7([gn]),sortKey:gn.sortKey,state:Et})}else Te.push({segments:Xe.segments,sortKey:0,state:Et})}O&&Te.sort((Ge,He)=>Ge.sortKey-He.sortKey);const Le={useDepthForOcclusion:Z.depthOcclusionForSymbolsAndCircles};for(const Ge of Te){const{programConfiguration:He,program:rt,layoutVertexBuffer:Xe,globeExtVertexBuffer:et,indexBuffer:Ye,uniformValues:at,tile:gt}=Ge.state,Vt=Ge.segments;f.terrain&&f.terrain.setupElevationDraw(gt,rt,Le),f.uploadCommonUniforms(H,rt,gt.tileID.toUnwrapped()),rt.draw(f,G.TRIANGLES,X,oe,xe,_r.disabled,at,l.id,Xe,Ye,Vt,l.paint,Z.zoom,He,[et])}},heatmap:function(f,o,l,m){if(l.paint.get("heatmap-opacity")!==0)if(f.renderPass==="offscreen"){const y=f.context,w=y.gl,E=fr.disabled,O=new Lr([w.ONE,w.ONE,w.ONE,w.ONE],r.aj.transparent,[!0,!0,!0,!0]);(function(oe,xe,ve,Ce){const Te=oe.gl,Le=xe.width*Ce,Ge=xe.height*Ce;oe.activeTexture.set(Te.TEXTURE1),oe.viewport.set([0,0,Le,Ge]);let He=ve.heatmapFbo;if(!He||He&&(He.width!==Le||He.height!==Ge)){He&&He.destroy();const rt=Te.createTexture();Te.bindTexture(Te.TEXTURE_2D,rt),Te.texParameteri(Te.TEXTURE_2D,Te.TEXTURE_WRAP_S,Te.CLAMP_TO_EDGE),Te.texParameteri(Te.TEXTURE_2D,Te.TEXTURE_WRAP_T,Te.CLAMP_TO_EDGE),Te.texParameteri(Te.TEXTURE_2D,Te.TEXTURE_MIN_FILTER,Te.LINEAR),Te.texParameteri(Te.TEXTURE_2D,Te.TEXTURE_MAG_FILTER,Te.LINEAR),He=ve.heatmapFbo=oe.createFramebuffer(Le,Ge,!0,null),function(Xe,et,Ye,at,gt,Vt){const Rt=Xe.gl;Rt.texImage2D(Rt.TEXTURE_2D,0,Xe.extRenderToTextureHalfFloat?Rt.RGBA16F:Rt.RGBA,gt,Vt,0,Rt.RGBA,Xe.extRenderToTextureHalfFloat?Rt.HALF_FLOAT:Rt.UNSIGNED_BYTE,null),at.colorAttachment.set(Ye)}(oe,0,rt,He,Le,Ge)}else Te.bindTexture(Te.TEXTURE_2D,He.colorAttachment.get()),oe.bindFramebuffer.set(He.framebuffer)})(y,f,l,f.transform.projection.name==="globe"?.5:.25),y.clear({color:r.aj.transparent});const $=f.transform,H=$.projection.name==="globe",G=H?["PROJECTION_GLOBE_VIEW"]:[],Z=H?_r.frontCCW:_r.disabled,X=[r.at($.center.lng),r.aA($.center.lat)];for(let oe=0;oe<m.length;oe++){const xe=m[oe];if(o.hasRenderableParent(xe))continue;const ve=o.getTile(xe),Ce=ve.getBucket(l);if(!Ce||Ce.projection.name!==$.projection.name)continue;const Te=f.isTileAffectedByFog(xe),Le=Ce.programConfigurations.get(l.id),Ge=f.getOrCreateProgram("heatmap",{config:Le,defines:G,overrideFog:Te}),{zoom:He}=f.transform;f.terrain&&f.terrain.setupElevationDraw(ve,Ge),f.uploadCommonUniforms(y,Ge,xe.toUnwrapped());const rt=$.projection.createInversionMatrix($,xe.canonical);Ge.draw(f,w.TRIANGLES,or.disabled,E,O,Z,Hn(f,xe,ve,rt,X,He,l.paint.get("heatmap-intensity")),l.id,Ce.layoutVertexBuffer,Ce.indexBuffer,Ce.segments,l.paint,f.transform.zoom,Le,H?[Ce.globeExtVertexBuffer]:null)}y.viewport.set([0,0,f.width,f.height])}else f.renderPass==="translucent"&&(f.context.setColorMode(f.colorModeForRenderPass()),function(y,w){const E=y.context,O=E.gl,$=w.heatmapFbo;if(!$)return;E.activeTexture.set(O.TEXTURE0),O.bindTexture(O.TEXTURE_2D,$.colorAttachment.get()),E.activeTexture.set(O.TEXTURE1);let H=w.colorRampTexture;H||(H=w.colorRampTexture=new r.T(E,w.colorRamp,O.RGBA8)),H.bind(O.LINEAR,O.CLAMP_TO_EDGE),y.getOrCreateProgram("heatmapTexture").draw(y,O.TRIANGLES,or.disabled,fr.disabled,y.colorModeForRenderPass(),_r.disabled,((G,Z,X,oe)=>({u_image:0,u_color_ramp:1,u_opacity:Z.paint.get("heatmap-opacity")}))(0,w),w.id,y.viewportBuffer,y.quadTriangleIndexBuffer,y.viewportSegments,w.paint,y.transform.zoom)}(f,l))},line:function(f,o,l,m){if(f.renderPass!=="translucent")return;const y=l.paint.get("line-opacity"),w=l.paint.get("line-width");if(y.constantOr(1)===0||w.constantOr(1)===0)return;const E=l.paint.get("line-emissive-strength"),O=l.paint.get("line-occlusion-opacity"),$=l.layout.get("line-elevation-reference"),H=l.layout.get("line-width-unit")==="meters",G=$==="sea",Z=f.context,X=Z.gl;if(l.hasElevatedBuckets&&f.transform.projection.name==="globe")return;const oe=l.layout.get("line-cross-slope"),xe=oe!==void 0,ve=oe<1,Ce=f.colorModeForDrapableLayerRenderPass(E),Te=f.terrain&&f.terrain.renderingToTexture,Le=Te?1:r.q.devicePixelRatio,Ge=l.paint.get("line-dasharray"),He=Ge.constantOr(1),rt=l.layout.get("line-cap"),Xe=Ge.constantOr(null),et=rt.constantOr(null),Ye=l.paint.get("line-pattern"),at=Ye.constantOr(1),gt=Ye.constantOr(null),Vt=l.paint.get("line-opacity").constantOr(1);let Rt=!at&&Vt!==1||f.depthOcclusion&&O>0&&O<1;const tn=l.paint.get("line-gradient"),Jt=at?"linePattern":"line",Et=r.c_(l);let jt;if(Te&&f.terrain&&f.terrain.clipOrMaskOverlapStencilType()&&(Rt=!1),O!==0&&f.depthOcclusion){const Tt=l.paint._values["line-opacity"];Tt&&Tt.value&&Tt.value.kind==="constant"?jt=Tt.value:r.w(`Occlusion opacity for layer ${l.id} is supported only when line-opacity isn't data-driven.`)}w.value.kind!=="constant"&&w.value.isLineProgressConstant===!1&&Et.push("VARIABLE_LINE_WIDTH");const gn=(Tt,rn,Ht,Cn,dn)=>{for(const nn of Tt){const vn=o.getTile(nn);if(at&&!vn.patternsLoaded())continue;const Tn=vn.getBucket(l);if(!Tn||Tn.hasZOffset&&!dn||!Tn.hasZOffset&&dn)continue;f.prepareDrawTile();const Ln=Tn.programConfigurations.get(l.id),Un=f.isTileAffectedByFog(nn),dr=f.getOrCreateProgram(Jt,{config:Ln,defines:rn,overrideFog:Un,overrideRtt:!dn&&void 0});if(gt&&vn.imageAtlas){const Sr=r.A.from(gt).getPrimary().scaleSelf(Le).serialize(),Xr=vn.imageAtlas.patternPositions[Sr];Xr&&Ln.setConstantPatternPositions(Xr)}if(!at&&Xe&&et&&vn.lineAtlas){const Sr=vn.lineAtlas.getDash(Xe,et);Sr&&Ln.setConstantPatternPositions(Sr)}let[nr,ir]=l.paint.get("line-trim-offset");(et==="round"||et==="square")&&nr!==ir&&(nr===0&&(nr-=1),ir===1&&(ir+=1));const br=Te?nn.projMatrix:null,jr=H?1/Tn.tileToMeter/r.ar(vn,1,f.transform.zoom):1,ho=H?1/Tn.tileToMeter/r.ar(vn,1,Math.floor(f.transform.zoom)):1,Zo=at?r.c$(f,vn,l,br,Le,jr,ho,[nr,ir]):r.d0(f,vn,l,br,Tn.lineClipsArray.length,Le,jr,ho,[nr,ir]);if(tn){const Sr=Tn.gradients[l.id];let Xr=Sr.texture;if(l.gradientVersion!==Sr.version){let Jn=256;if(l.stepInterpolant){const Ur=o.getSource().maxzoom,ro=nn.canonical.z===Ur?Math.ceil(1<<f.transform.maxZoom-nn.canonical.z):1;Jn=r.aw(r.d1(Tn.maxLineLength/r.ag*1024*ro),256,Z.maxTextureSize)}Sr.gradient=r.d2({expression:l.gradientExpression(),evaluationKey:"lineProgress",resolution:Jn,image:Sr.gradient||void 0,clips:Tn.lineClipsArray}),Sr.texture?Sr.texture.update(Sr.gradient):Sr.texture=new r.T(Z,Sr.gradient,X.RGBA8),Sr.version=l.gradientVersion,Xr=Sr.texture}Z.activeTexture.set(X.TEXTURE1),Xr.bind(l.stepInterpolant?X.NEAREST:X.LINEAR,X.CLAMP_TO_EDGE)}He&&(Z.activeTexture.set(X.TEXTURE0),vn.lineAtlasTexture&&vn.lineAtlasTexture.bind(X.LINEAR,X.REPEAT),Ln.updatePaintBuffers()),at&&(Z.activeTexture.set(X.TEXTURE0),vn.imageAtlasTexture&&vn.imageAtlasTexture.bind(X.LINEAR,X.CLAMP_TO_EDGE),Ln.updatePaintBuffers()),dn&&!G&&f.terrain.setupElevationDraw(vn,dr),f.uploadCommonUniforms(Z,dr,nn.toUnwrapped());const No=Sr=>{jt!=null&&(jt.value=Vt*O),dr.draw(f,X.TRIANGLES,Ht,Sr,Ce,_r.disabled,Zo,l.id,Tn.layoutVertexBuffer,Tn.indexBuffer,Tn.segments,l.paint,f.transform.zoom,Ln,[Tn.layoutVertexBuffer2,Tn.patternVertexBuffer,Tn.zOffsetVertexBuffer]),jt!=null&&(jt.value=Vt)};if(Rt&&!dn){const Sr=f.stencilModeForClipping(nn).ref;Sr===0&&Te&&Z.clear({stencil:0});const Xr={func:X.EQUAL,mask:255};Zo.u_alpha_discard_threshold=.8,No(new fr(Xr,Sr,255,X.KEEP,X.KEEP,X.INVERT)),Zo.u_alpha_discard_threshold=0,No(new fr(Xr,Sr,255,X.KEEP,X.KEEP,X.KEEP))}else Rt&&dn&&(Zo.u_alpha_discard_threshold=.001),No(dn?Cn:f.stencilModeForClipping(nn))}};if(l.hasNonElevatedBuckets){const Tt=!Te&&f.terrain;O!==0&&Tt?r.w(`Occlusion opacity for layer ${l.id} is supported on terrain only if the layer has line-z-offset enabled.`):Tt?r.w(`Cannot render non-elevated lines in immediate mode when terrain is enabled. Layer: ${l.id}.`):gn(m,Et,f.depthModeForSublayer(0,or.ReadOnly),fr.disabled,!1)}if(l.hasElevatedBuckets){Et.push("ELEVATED"),xe&&Et.push(ve?"CROSS_SLOPE_HORIZONTAL":"CROSS_SLOPE_VERTICAL"),G&&Et.push("ELEVATION_REFERENCE_SEA");const Tt=Rt?f.stencilModeFor3D():fr.disabled,rn=new or(f.depthOcclusion?X.GREATER:X.LEQUAL,or.ReadOnly,f.depthRangeFor3D);f.forceTerrainMode=!0,gn(m,Et,rn,Tt,!0),f.forceTerrainMode=!1}Rt&&(f.resetStencilClippingMasks(),Te&&Z.clear({stencil:0})),O===0||f.depthOcclusion||Te||f.layersWithOcclusionOpacity.push(f.currentLayer)},fill:function(f,o,l,m){const y=l.paint.get("fill-color"),w=l.paint.get("fill-opacity"),E=l.is3D(),O=new or(f.context.gl.LEQUAL,or.ReadWrite,f.depthRangeFor3D);if(w.constantOr(1)===0)return;const $=l.paint.get("fill-emissive-strength"),H=f.colorModeForDrapableLayerRenderPass($),G=l.paint.get("fill-pattern"),Z=f.opaquePassEnabledForLayer()&&!G.constantOr(1)&&y.constantOr(r.aj.transparent).a===1&&w.constantOr(0)===1?"opaque":"translucent";if(f.renderPass===Z){const X=E?O:f.depthModeForSublayer(1,f.renderPass==="opaque"?or.ReadWrite:or.ReadOnly);tv(f,o,l,m,X,H,!1)}if(!E&&f.renderPass==="translucent"&&l.paint.get("fill-antialias")){const X=E?O:f.depthModeForSublayer(l.getPaintProperty("fill-outline-color")?2:0,or.ReadOnly);tv(f,o,l,m,X,H,!0)}},"fill-extrusion":function(f,o,l,m){const y=l.paint.get("fill-extrusion-opacity"),w=f.context,E=w.gl,O=f.terrain,$=O&&O.renderingToTexture;if(y===0)return;const H=f.conflationActive&&f.style.isLayerClipped(l,o.getSource()),G=f.style.order.indexOf(l.fqid);if(H&&function(Z,X,oe,xe,ve){for(const Ce of xe){const Te=X.getTile(Ce).getBucket(oe);Te&&(Te.updateReplacement(Ce,Z.replacementSource,ve),Te.uploadCentroid(Z.context))}}(f,o,l,m,G),O||H)for(const Z of m){const X=o.getTile(Z).getBucket(l);X&&ld(f.context,o,Z,X,l,O,H)}if(f.renderPass==="shadow"&&f.shadowRenderer){const Z=f.shadowRenderer;if(O&&y<.65&&l._transitionablePaint._values["fill-extrusion-opacity"].value.expression instanceof r.a9)return;const X=Z.getShadowPassDepthMode(),oe=Z.getShadowPassColorMode();Dh(f,o,l,m,X,fr.disabled,oe,H)}else if(f.renderPass==="translucent"){const Z=!l.paint.get("fill-extrusion-pattern").constantOr(1),X=l.paint.get("fill-extrusion-color").constantOr(r.aj.white);if(!$&&X.a!==0){const oe=new or(f.context.gl.LEQUAL,or.ReadWrite,f.depthRangeFor3D);y===1&&Z?Dh(f,o,l,m,oe,fr.disabled,Lr.unblended,H):(Dh(f,o,l,m,oe,fr.disabled,Lr.disabled,H),Dh(f,o,l,m,oe,f.stencilModeFor3D(),f.colorModeForRenderPass(),H),f.resetStencilClippingMasks())}if(f.style.enable3dLights()&&Z&&(!O&&f.transform.projection.name!=="globe"||$)){const oe=l.paint.get("fill-extrusion-opacity"),xe=l.paint.get("fill-extrusion-ambient-occlusion-intensity"),ve=l.paint.get("fill-extrusion-ambient-occlusion-ground-radius"),Ce=l.paint.get("fill-extrusion-flood-light-intensity"),Te=l.paint.get("fill-extrusion-flood-light-color-use-theme").constantOr("default")==="none",Le=l.paint.get("fill-extrusion-flood-light-color").toRenderColor(Te?null:l.lut).toArray01().slice(0,3),Ge=xe>0&&ve>0,He=Ce>0,rt=(et,Ye,at)=>(1-at)*et+at*Ye,Xe=et=>{const Ye=f.depthModeForSublayer(1,or.ReadOnly,E.LEQUAL,!0),at=l.paint.get(et?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),gt=rt(.1,3,at),Vt=f._showOverdrawInspector;if(!Vt){const Rt=new fr({func:E.ALWAYS,mask:255},255,255,E.KEEP,E.KEEP,E.REPLACE),tn=new Lr([E.ONE,E.ONE,E.ONE,E.ONE],r.aj.transparent,[!1,!1,!1,!0],E.MIN);ad(f,o,l,m,Ye,Rt,tn,_r.disabled,et,"sdf",oe,xe,ve,Ce,Le,gt,H,!1)}{const Rt=Vt?fr.disabled:new fr({func:E.EQUAL,mask:255},255,255,E.KEEP,E.DECR,E.DECR),tn=Vt?f.colorModeForRenderPass():new Lr([E.ONE_MINUS_DST_ALPHA,E.DST_ALPHA,E.ONE,E.ONE],r.aj.transparent,[!0,!0,!0,!0]);ad(f,o,l,m,Ye,Rt,tn,_r.disabled,et,"color",oe,xe,ve,Ce,Le,gt,H,!1)}};if($){const et=(Ye,at,gt)=>{const Vt=f.depthModeForSublayer(1,or.ReadOnly,E.LEQUAL,!1),Rt=l.paint.get(Ye?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),tn=rt(.1,3,Rt);{const Jt=new Lr([E.ONE,E.ONE,E.ONE,E.ONE],r.aj.transparent,[!1,!1,!1,!0]);ad(f,o,l,m,Vt,fr.disabled,Jt,_r.disabled,Ye,"clear",oe,xe,ve,Ce,Le,tn,H,at)}{const Jt=new fr({func:E.ALWAYS,mask:255},255,255,E.KEEP,E.KEEP,E.REPLACE),Et=new Lr([E.ONE,E.ONE,E.ONE,E.ONE],r.aj.transparent,[!1,!1,!1,!0],E.MIN);ad(f,o,l,m,Vt,Jt,Et,_r.disabled,Ye,"sdf",oe,xe,ve,Ce,Le,tn,H,at)}{const Jt=Ye?E.ZERO:E.ONE_MINUS_DST_ALPHA,Et=new fr({func:E.EQUAL,mask:255},255,255,E.KEEP,E.DECR,E.DECR),jt=new Lr([Jt,E.DST_ALPHA,E.ONE_MINUS_DST_ALPHA,E.ZERO],r.aj.transparent,[!0,!0,!0,!0]);ad(f,o,l,m,Vt,Et,jt,_r.disabled,Ye,"color",oe,xe,ve,Ce,Le,tn,H,at)}{const Jt=new Lr([E.ONE,E.ONE,E.ONE,Ye?E.ZERO:E.ONE],r.aj.transparent,[!1,!1,!1,!0],Ye?E.FUNC_ADD:E.MAX);ad(f,o,l,m,Vt,fr.disabled,Jt,_r.disabled,Ye,"clear",oe,xe,ve,Ce,Le,tn,H,at,gt)}};if(Ge||He){let Ye;if(f.prepareDrawTile(),O){const at=O.drapeBufferSize[0],gt=O.drapeBufferSize[1];Ye=O.framebufferCopyTexture,Ye&&(!Ye||Ye.size[0]===at&&Ye.size[1]===gt)||(Ye&&Ye.destroy(),Ye=O.framebufferCopyTexture=new r.T(w,new r.r({width:at,height:gt}),E.RGBA8)),Ye.bind(E.LINEAR,E.CLAMP_TO_EDGE),E.copyTexSubImage2D(E.TEXTURE_2D,0,0,0,0,0,at,gt)}Ge&&et(!0,!1,Ye),He&&et(!1,!0,Ye)}}else Ge&&Xe(!0),He&&Xe(!1),(Ge||He)&&f.resetStencilClippingMasks()}}},hillshade:function(f,o,l,m){if(f.renderPass!=="offscreen"&&f.renderPass!=="translucent"||f.style.disableElevatedTerrain)return;const y=f.context,w=f.terrain&&f.terrain.renderingToTexture,[E,O]=f.renderPass!=="translucent"||w?[{},m]:f.stencilConfigForOverlap(m);for(const $ of O){const H=o.getTile($);if(H.needsHillshadePrepare&&f.renderPass==="offscreen")Xx(f,H,l);else if(f.renderPass==="translucent"){const G=f.depthModeForSublayer(0,or.ReadOnly),Z=l.paint.get("hillshade-emissive-strength"),X=f.colorModeForDrapableLayerRenderPass(Z),oe=w&&f.terrain?f.terrain.stencilModeForRTTOverlap($):E[$.overscaledZ];Hy(f,$,H,l,G,oe,X)}}y.viewport.set([0,0,f.width,f.height]),f.resetStencilClippingMasks()},raster:function(f,o,l,m,y,w){if(f.renderPass!=="translucent"||l.paint.get("raster-opacity")===0)return;const E=f.transform.projection.name==="globe",O=l.paint.get("raster-elevation")!==0,$=O&&E;if(f.renderElevatedRasterBackface&&!$)return;const H=f.context,G=H.gl,Z=o.getSource(),X=function(Xe,et,Ye,at){const gt=et.paint.get("raster-color"),Vt=Xe.type==="raster-array",Rt=[],tn=et.paint.get("raster-resampling"),Jt=et.paint.get("raster-color-mix");let Et=et.paint.get("raster-color-range");const jt=[Jt[0],Jt[1],Jt[2],0],gn=Jt[3];let Tt=tn==="nearest"?at.NEAREST:at.LINEAR;if(Vt&&(Rt.push("RASTER_ARRAY"),gt||Rt.push("RASTER_COLOR"),tn==="linear"&&Rt.push("RASTER_ARRAY_LINEAR"),Tt=at.NEAREST,!Et&&Xe.rasterLayers)){const rn=Xe.rasterLayers.find(({id:Ht})=>Ht===et.sourceLayer);rn&&rn.fields&&rn.fields.range&&(Et=rn.fields.range)}if(Et=Et||[0,1],gt){Rt.push("RASTER_COLOR"),Ye.activeTexture.set(at.TEXTURE2),et.updateColorRamp(Et);let rn=et.colorRampTexture;rn||(rn=et.colorRampTexture=new r.T(Ye,et.colorRamp,at.RGBA8)),rn.bind(at.LINEAR,at.CLAMP_TO_EDGE)}return{mix:jt,range:Et,offset:gn,defines:Rt,resampling:Tt}}(Z,l,H,G);if(Z instanceof r.aJ&&!m.length&&!E)return;const oe=l.paint.get("raster-emissive-strength"),xe=f.colorModeForDrapableLayerRenderPass(oe),ve=f.terrain&&f.terrain.renderingToTexture,Ce=!f.options.moving,Te=l.paint.get("raster-resampling")==="nearest"?G.NEAREST:G.LINEAR;if(Z instanceof r.aJ&&!m.length&&(Z.onNorthPole||Z.onSouthPole)){const Xe=O?f.stencilModeFor3D():fr.disabled;return void Lt(!!Z.onNorthPole,null,f,o,l,oe,X,_r.disabled,Xe)}if(!m.length)return;const[Le,Ge]=Z instanceof r.aJ||ve?[{},m]:f.stencilConfigForOverlap(m),He=Ge[Ge.length-1].overscaledZ;$&&X.defines.push("PROJECTION_GLOBE_VIEW"),O&&X.defines.push("RENDER_CUTOFF");const rt=(Xe,et,Ye)=>{for(const at of Xe){const gt=at.toUnwrapped(),Vt=o.getTile(at);if(ve&&(!Vt||!Vt.hasData()))continue;H.activeTexture.set(G.TEXTURE0);const Rt=bp(Vt,Z,l,X);if(!Rt||!Rt.texture)continue;const{texture:tn,mix:Jt,offset:Et,tileSize:jt,buffer:gn}=Rt;let Tt,rn;ve?(Tt=or.disabled,rn=at.projMatrix):O?(Tt=new or(G.LEQUAL,or.ReadWrite,f.depthRangeFor3D),rn=E?Float32Array.from(f.transform.expandedFarZProjMatrix):f.transform.calculateProjMatrix(gt,Ce)):(Tt=f.depthModeForSublayer(at.overscaledZ-He,l.paint.get("raster-opacity")===1?or.ReadWrite:or.ReadOnly,G.LESS),rn=f.transform.calculateProjMatrix(gt,Ce));const Ht=f.terrain&&ve?f.terrain.stencilModeForRTTOverlap(at):Le[at.overscaledZ],Cn=w?0:l.paint.get("raster-fade-duration");Vt.registerFadeDuration(Cn);const dn=o.findLoadedParent(at,0),nn=Ih(Vt,dn,o,f.transform,Cn);let vn,Tn;f.terrain&&f.terrain.prepareDrawTile(),H.activeTexture.set(G.TEXTURE0),tn.bind(Te,G.CLAMP_TO_EDGE),H.activeTexture.set(G.TEXTURE1),dn?(dn.texture&&dn.texture.bind(Te,G.CLAMP_TO_EDGE),vn=Math.pow(2,dn.tileID.overscaledZ-Vt.tileID.overscaledZ),Tn=[Vt.tileID.canonical.x*vn%1,Vt.tileID.canonical.y*vn%1]):tn.bind(Te,G.CLAMP_TO_EDGE),tn.useMipmap&&H.extTextureFilterAnisotropic&&f.transform.pitch>20&&G.texParameterf(G.TEXTURE_2D,H.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,H.extTextureFilterAnisotropicMax);const Ln=f.transform;let Un;const dr=O?i0(Ln):[0,0,0,0];let nr,ir,br,jr,ho,Zo=0;if($&&Z instanceof r.aJ&&Z.coordinates.length>3)nr=Float32Array.from(r.bb(r.cH(new r.bT(0,0,0)))),ir=Float32Array.from(Ln.globeMatrix),br=Float32Array.from(r.cD(Ln)),jr=[r.at(Ln.center.lng),r.aA(Ln.center.lat)],Un=Z.elevatedGlobePerspectiveTransform,ho=Z.elevatedGlobeGridMatrix||new Float32Array(9);else if($){const Jn=r.cE(at.canonical);Zo=r.cF(Jn.getCenter().lat),nr=Float32Array.from(r.bb(r.cH(at.canonical))),ir=Float32Array.from(Ln.globeMatrix),br=Float32Array.from(r.cD(Ln)),jr=[r.at(Ln.center.lng),r.aA(Ln.center.lat)],Un=[0,0],ho=Float32Array.from(r.cG(at.canonical,Jn,Zo,Ln.worldSize/Ln._pixelsPerMercatorPixel))}else Un=Z instanceof r.aJ?Z.perspectiveTransform:[0,0],nr=new Float32Array(16),ir=new Float32Array(9),br=new Float32Array(16),jr=[0,0],ho=new Float32Array(9);const No=Tc(rn,nr,ir,br,ho,Tn||[0,0],r.ae(f.transform.zoom),jr,dr,vn||1,nn,l,Un,O?l.paint.get("raster-elevation"):0,2,Jt,Et,X.range,jt,gn,oe),Sr=f.isTileAffectedByFog(at),Xr=f.getOrCreateProgram("raster",{defines:X.defines,overrideFog:Sr});if(f.uploadCommonUniforms(H,Xr,gt),Z instanceof r.aJ){const Jn=Z.elevatedGlobeVertexBuffer,Ur=Z.elevatedGlobeIndexBuffer;if(ve||!E)Z.boundsBuffer&&Z.boundsSegments&&Xr.draw(f,G.TRIANGLES,Tt,fr.disabled,xe,_r.disabled,No,l.id,Z.boundsBuffer,f.quadTriangleIndexBuffer,Z.boundsSegments);else if(Jn&&Ur){const ro=Ln.zoom<=r.c6?Z.elevatedGlobeSegments:Z.getSegmentsForLongitude(Ln.center.lng);ro&&Xr.draw(f,G.TRIANGLES,Tt,fr.disabled,xe,et,No,l.id,Jn,Ur,ro)}}else if($){Tt=new or(G.LEQUAL,or.ReadOnly,f.depthRangeFor3D);const Jn=f.globeSharedBuffers;if(Jn){const[Ur,ro,ao]=Jn.getGridBuffers(Zo,!1);Xr.draw(f,G.TRIANGLES,Tt,Ye||Ht,f.colorModeForRenderPass(),et,No,l.id,Ur,ro,ao)}}else{const{tileBoundsBuffer:Jn,tileBoundsIndexBuffer:Ur,tileBoundsSegments:ro}=f.getTileBoundsBuffers(Vt);Xr.draw(f,G.TRIANGLES,Tt,Ht,xe,_r.disabled,No,l.id,Jn,Ur,ro)}}if(!(Z instanceof r.aJ)&&$)for(const at of Xe){const gt=at.canonical.y===(1<<at.canonical.z)-1;at.canonical.y===0&&Lt(!0,at,f,o,l,oe,X,et,Ye||fr.disabled),gt&&Lt(!1,at,f,o,l,oe,X,et===_r.frontCW?_r.backCW:_r.frontCW,Ye||fr.disabled)}};$?rt(Ge,f.renderElevatedRasterBackface?_r.backCW:_r.frontCW,f.stencilModeFor3D()):rt(Ge,_r.disabled,void 0),f.resetStencilClippingMasks()},"raster-particle":function(f,o,l,m,y,w){f.renderPass==="offscreen"&&function(E,O,$,H){if(!H.length)return;const G=E.context,Z=G.gl,X=O.getSource();if(!(X instanceof Ei))return;const oe=Math.ceil(Math.sqrt($.paint.get("raster-particle-count")));let xe=$.particlePositionRGBAImage;if(!xe||xe.width!==oe){const Ge=function(He){const rt=He*He,Xe=new Uint8Array(4*rt),et=function(at){return at|=0,at=Math.imul(2747636419^at,2654435769),at=Math.imul(at^at>>>16,2654435769),((at=Math.imul(at^at>>>16,2654435769))>>>0)/4294967296},Ye=1/1.1;for(let at=0;at<rt;at++){const gt=Ye*(et(2*at+0)+Xn),Vt=Ye*(et(2*at+1)+Xn),Rt=255*gt%1,tn=255*Vt%1,Jt=Rt,Et=Vt-tn/255,jt=tn;Xe[4*at+0]=255*(gt-Rt/255),Xe[4*at+1]=255*Jt,Xe[4*at+2]=255*Et,Xe[4*at+3]=255*jt}return Xe}(oe);xe=$.particlePositionRGBAImage=new r.r({width:oe,height:oe},Ge)}let ve=$.particleFramebuffer;ve?ve.width!==oe&&(ve.destroy(),ve=$.particleFramebuffer=G.createFramebuffer(oe,oe,!0,null)):ve=$.particleFramebuffer=G.createFramebuffer(oe,oe,!0,null);const Ce=[];for(const Ge of H){const He=O.getTile(Ge);if(!(He instanceof yc))continue;const rt=a0(He,X,$);if(!rt)continue;const Xe=[He.tileSize,He.tileSize];let et=$.tileFramebuffer;et||(et=$.tileFramebuffer=G.createFramebuffer(Xe[0],Xe[1],!0,null));let Ye=He.rasterParticleState;Ye||(Ye=He.rasterParticleState=new s0(G,Ge,Xe,xe));const at=Ye.update($.lastInvalidatedAt);Ye.particleTextureDimension!==oe&&Ye.updateParticleTexture(Ge,xe);const gt=Ye.targetColorTexture;Ye.targetColorTexture=Ye.backgroundColorTexture,Ye.backgroundColorTexture=gt;const Vt=Ye.particleTexture0;Ye.particleTexture0=Ye.particleTexture1,Ye.particleTexture1=Vt,Ce.push([Ge,rt,Ye,at])}if(Ce.length===0)return;const Te=r.q.now(),Le=$.previousDrawTimestamp?.001*(Te-$.previousDrawTimestamp):.0167;if($.previousDrawTimestamp=Te,$.hasColorMap()){G.activeTexture.set(Z.TEXTURE0+2);let Ge=$.colorRampTexture;Ge||(Ge=$.colorRampTexture=new r.T(G,$.colorRamp,Z.RGBA8)),Ge.bind(Z.LINEAR,Z.CLAMP_TO_EDGE)}G.bindFramebuffer.set($.tileFramebuffer.framebuffer),function(Ge,He,rt){const Xe=Ge.context,et=Xe.gl,Ye=He.tileFramebuffer;Xe.activeTexture.set(et.TEXTURE0);const at={u_texture:0,u_opacity:1.05*(Vt=He.paint.get("raster-particle-fade-opacity-factor"))/(Vt+.05)},gt=Ge.getOrCreateProgram("rasterParticleTexture",{defines:[],overrideFog:!1});var Vt;for(const Rt of rt){const[,,tn,Jt]=Rt;Ye.colorAttachment.set(tn.targetColorTexture.texture),Xe.viewport.set([0,0,Ye.width,Ye.height]),Xe.clear({color:r.aj.transparent}),Jt&&(tn.backgroundColorTexture.bind(et.NEAREST,et.CLAMP_TO_EDGE),gt.draw(Ge,et.TRIANGLES,or.disabled,fr.disabled,Lr.alphaBlended,_r.disabled,at,He.id,Ge.viewportBuffer,Ge.quadTriangleIndexBuffer,Ge.viewportSegments))}}(E,$,Ce),function(Ge,He,rt,Xe){const et=Ge.context,Ye=et.gl,at=rt.tileFramebuffer,gt=Ge.transform.projection.name==="globe",Vt=rt.paint.get("raster-particle-max-speed");for(const Rt of Xe){const[tn,Jt,Et]=Rt;et.activeTexture.set(Ye.TEXTURE0+0),Jt.texture.bind(Ye.LINEAR,Ye.CLAMP_TO_EDGE),at.colorAttachment.set(Et.targetColorTexture.texture);const jt=Ge.getOrCreateProgram("rasterParticleDraw",{defines:Jt.defines,overrideFog:!1});et.activeTexture.set(Ye.TEXTURE0+1);const gn=Jt.scalarData?[]:[0,1,2,3].map(Ht=>r.d4[Ht](tn));gn.push(tn);const Tt=tn.canonical.x,rn=tn.canonical.y;for(const Ht of gn){const Cn=He.getTile(gt?Ht.wrapped():Ht);if(!Cn)continue;const dn=Cn.rasterParticleState;if(!dn)continue;const nn=Ht.canonical.x+(1<<Ht.canonical.z)*(Ht.wrap-tn.wrap),vn=Ht.canonical.y;dn.particleTexture0.bind(Ye.NEAREST,Ye.CLAMP_TO_EDGE);const Tn=cw(1,dn.particleTexture0.size[0],[nn-Tt,vn-rn],0,Jt.texture.size,2,Vt,Jt.textureOffset,Jt.scale,Jt.offset);jt.draw(Ge,Ye.POINTS,or.disabled,fr.disabled,Lr.alphaBlended,_r.disabled,Tn,rt.id,dn.particleIndexBuffer,void 0,dn.particleSegment)}}}(E,O,$,Ce),G.bindFramebuffer.set($.particleFramebuffer.framebuffer),function(Ge,He,rt,Xe){const et=Ge.context,Ye=et.gl,at=He.paint.get("raster-particle-max-speed"),gt=Xe*He.paint.get("raster-particle-speed-factor")*.15,Vt=function(tn){return Math.pow(tn,6)}(.01+1*He.paint.get("raster-particle-reset-rate-factor")),Rt=He.particleFramebuffer;et.viewport.set([0,0,Rt.width,Rt.height]);for(const tn of rt){const[,Jt,Et]=tn;et.activeTexture.set(Ye.TEXTURE0+0),Jt.texture.bind(Ye.LINEAR,Ye.CLAMP_TO_EDGE),et.activeTexture.set(Ye.TEXTURE0+1);const jt=Et.particleTexture0;jt.bind(Ye.NEAREST,Ye.CLAMP_TO_EDGE);const gn=uw(1,jt.size[0],0,Jt.texture.size,at,gt,Vt,Jt.textureOffset,Jt.scale,Jt.offset);Rt.colorAttachment.set(Et.particleTexture1.texture),et.clear({color:r.aj.transparent}),Ge.getOrCreateProgram("rasterParticleUpdate",{defines:Jt.defines}).draw(Ge,Ye.TRIANGLES,or.disabled,fr.disabled,Lr.unblended,_r.disabled,gn,He.id,Ge.viewportBuffer,Ge.quadTriangleIndexBuffer,Ge.viewportSegments)}}(E,$,Ce,Le)}(f,o,l,m),f.renderPass==="translucent"&&(function(E,O,$,H,G){const Z=E.context,X=Z.gl,oe=O.getSource().tileSize,xe=5*(1-r.ac(r.bY,r.bY+1,E.transform.zoom))*oe+$.paint.get("raster-particle-elevation"),ve=!E.options.moving,Ce=E.transform.projection.name==="globe";if(!H.length)return;const[Te,Le]=E.stencilConfigForOverlap(H),Ge=[];Ce&&Ge.push("PROJECTION_GLOBE_VIEW");const He=E.stencilModeFor3D();for(const rt of Le){const Xe=rt.toUnwrapped(),et=O.getTile(rt);if(!et.rasterParticleState)continue;const Ye=et.rasterParticleState,at=100;et.registerFadeDuration(at);const gt=O.findLoadedParent(rt,0),Vt=Ih(et,gt,O,E.transform,at);let Rt,tn;E.terrain&&E.terrain.prepareDrawTile(),Z.activeTexture.set(X.TEXTURE0),Ye.targetColorTexture.bind(X.LINEAR,X.CLAMP_TO_EDGE),Z.activeTexture.set(X.TEXTURE1),gt&&gt.rasterParticleState?(gt.rasterParticleState.targetColorTexture.bind(X.LINEAR,X.CLAMP_TO_EDGE),Rt=Math.pow(2,gt.tileID.overscaledZ-et.tileID.overscaledZ),tn=[et.tileID.canonical.x*Rt%1,et.tileID.canonical.y*Rt%1]):Ye.targetColorTexture.bind(X.LINEAR,X.CLAMP_TO_EDGE);const Jt=Ce?Float32Array.from(E.transform.expandedFarZProjMatrix):E.transform.calculateProjMatrix(Xe,ve),Et=E.transform,jt=l0(Et),gn=r.cE(rt.canonical),Tt=r.cF(gn.getCenter().lat);let rn,Ht,Cn,dn,nn;Ce?(rn=Float32Array.from(r.bb(r.cH(rt.canonical))),Ht=Float32Array.from(Et.globeMatrix),Cn=Float32Array.from(r.cD(Et)),dn=[r.at(Et.center.lng),r.aA(Et.center.lat)],nn=Float32Array.from(r.cG(rt.canonical,gn,Tt,Et.worldSize/Et._pixelsPerMercatorPixel))):(rn=new Float32Array(16),Ht=new Float32Array(9),Cn=new Float32Array(16),dn=[0,0],nn=new Float32Array(9));const vn=Kg(Jt,rn,Ht,Cn,nn,tn||[0,0],r.ae(E.transform.zoom),dn,jt,Rt||1,Vt,xe),Tn=E.isTileAffectedByFog(rt),Ln=E.getOrCreateProgram("rasterParticle",{defines:Ge,overrideFog:Tn});if(E.uploadCommonUniforms(Z,Ln,Xe),Ce){const Un=new or(X.LEQUAL,or.ReadOnly,E.depthRangeFor3D),dr=0,nr=E.globeSharedBuffers;if(nr){const[ir,br,jr]=nr.getGridBuffers(Tt,dr!==0);Ln.draw(E,X.TRIANGLES,Un,He,Lr.alphaBlended,E.renderElevatedRasterBackface?_r.frontCCW:_r.backCCW,vn,$.id,ir,br,jr)}}else{const Un=E.depthModeForSublayer(0,or.ReadOnly),dr=Te[rt.overscaledZ],{tileBoundsBuffer:nr,tileBoundsIndexBuffer:ir,tileBoundsSegments:br}=E.getTileBoundsBuffers(et);Ln.draw(E,X.TRIANGLES,Un,dr,Lr.alphaBlended,_r.disabled,vn,$.id,nr,ir,br)}}E.resetStencilClippingMasks()}(f,o,l,m),f.style.map.triggerRepaint())},background:function(f,o,l,m){const y=l.paint.get("background-color"),w=l.paint.get("background-color-use-theme").constantOr("default")==="none",E=l.paint.get("background-opacity"),O=l.paint.get("background-emissive-strength"),$=l.paint.get("background-pitch-alignment")==="viewport";if(E===0)return;const H=f.context,G=H.gl,Z=f.transform,X=Z.tileSize,oe=l.paint.get("background-pattern");let xe;if(oe!==void 0&&(oe===null||(xe=f.imageManager.getPattern(oe.toString(),l.scope,f.style.getLut(l.scope)),!xe)))return;const ve=!oe&&y.a===1&&E===1&&f.opaquePassEnabledForLayer()?"opaque":"translucent";if(f.renderPass!==ve)return;const Ce=fr.disabled,Te=f.depthModeForSublayer(0,ve==="opaque"?or.ReadWrite:or.ReadOnly),Le=f.colorModeForDrapableLayerRenderPass(O),Ge=oe?"backgroundPattern":"background";let He,rt=m;if(rt||(He=f.getBackgroundTiles(),rt=Object.values(He).map(Xe=>Xe.tileID)),oe&&(H.activeTexture.set(G.TEXTURE0),f.imageManager.bind(f.context,l.scope)),$){const Xe=f.getOrCreateProgram(Ge,{overrideFog:!1,overrideRtt:!0}),et=new Float32Array(r.ab.mat4.identity([])),Ye=new r.aG(0,0,0,0,0),at=oe?o0(et,O,E,f,0,l.scope,xe,$,{tileID:Ye,tileSize:X}):Yg(et,O,E,y.toRenderColor(w?null:l.lut));Xe.draw(f,G.TRIANGLES,Te,Ce,Le,_r.disabled,at,l.id,f.viewportBuffer,f.quadTriangleIndexBuffer,f.viewportSegments)}else for(const Xe of rt){const et=f.isTileAffectedByFog(Xe),Ye=f.getOrCreateProgram(Ge,{overrideFog:et}),at=Xe.toUnwrapped(),gt=m?Xe.projMatrix:f.transform.calculateProjMatrix(at);f.prepareDrawTile();const Vt=o?o.getTile(Xe):He?He[Xe.key]:new _c(Xe,X,Z.zoom,f),Rt=oe?o0(gt,O,E,f,0,l.scope,xe,$,{tileID:Xe,tileSize:X}):Yg(gt,O,E,y.toRenderColor(w?null:l.lut));f.uploadCommonUniforms(H,Ye,at);const{tileBoundsBuffer:tn,tileBoundsIndexBuffer:Jt,tileBoundsSegments:Et}=f.getTileBoundsBuffers(Vt);Ye.draw(f,G.TRIANGLES,Te,Ce,Le,_r.disabled,Rt,l.id,tn,Jt,Et)}},sky:function(f,o,l){const m=f._atmosphere?r.ae(f.transform.zoom):1,y=l.paint.get("sky-opacity")*m;if(y===0)return;const w=f.context,E=l.paint.get("sky-type"),O=new or(w.gl.LEQUAL,or.ReadOnly,[0,1]),$=f.frameCounter/1e3%1;E==="atmosphere"?f.renderPass==="offscreen"?l.needsSkyboxCapture(f)&&(function(H,G,Z,X){const oe=H.context,xe=oe.gl;let ve=G.skyboxFbo;if(!ve){ve=G.skyboxFbo=oe.createFramebuffer(32,32,!0,null),G.skyboxGeometry=new u0(oe),G.skyboxTexture=oe.gl.createTexture(),xe.bindTexture(xe.TEXTURE_CUBE_MAP,G.skyboxTexture),xe.texParameteri(xe.TEXTURE_CUBE_MAP,xe.TEXTURE_WRAP_S,xe.CLAMP_TO_EDGE),xe.texParameteri(xe.TEXTURE_CUBE_MAP,xe.TEXTURE_WRAP_T,xe.CLAMP_TO_EDGE),xe.texParameteri(xe.TEXTURE_CUBE_MAP,xe.TEXTURE_MIN_FILTER,xe.LINEAR),xe.texParameteri(xe.TEXTURE_CUBE_MAP,xe.TEXTURE_MAG_FILTER,xe.LINEAR);for(let Ge=0;Ge<6;++Ge)xe.texImage2D(xe.TEXTURE_CUBE_MAP_POSITIVE_X+Ge,0,xe.RGBA,32,32,0,xe.RGBA,xe.UNSIGNED_BYTE,null)}oe.bindFramebuffer.set(ve.framebuffer),oe.viewport.set([0,0,32,32]);const Ce=G.getCenter(H,!0),Te=H.getOrCreateProgram("skyboxCapture"),Le=new Float64Array(16);r.ab.mat4.identity(Le),r.ab.mat4.rotateY(Le,Le,.5*-Math.PI),Di(H,G,Te,Le,Ce,0),r.ab.mat4.identity(Le),r.ab.mat4.rotateY(Le,Le,.5*Math.PI),Di(H,G,Te,Le,Ce,1),r.ab.mat4.identity(Le),r.ab.mat4.rotateX(Le,Le,.5*-Math.PI),Di(H,G,Te,Le,Ce,2),r.ab.mat4.identity(Le),r.ab.mat4.rotateX(Le,Le,.5*Math.PI),Di(H,G,Te,Le,Ce,3),r.ab.mat4.identity(Le),Di(H,G,Te,Le,Ce,4),r.ab.mat4.identity(Le),r.ab.mat4.rotateY(Le,Le,Math.PI),Di(H,G,Te,Le,Ce,5),oe.viewport.set([0,0,H.width,H.height])}(f,l),l.markSkyboxValid(f)):f.renderPass==="sky"&&function(H,G,Z,X,oe){const xe=H.context,ve=xe.gl,Ce=H.transform,Te=H.getOrCreateProgram("skybox");xe.activeTexture.set(ve.TEXTURE0),ve.bindTexture(ve.TEXTURE_CUBE_MAP,G.skyboxTexture);const Le=((Ge,He,rt,Xe,et)=>({u_matrix:Ge,u_sun_direction:He,u_cubemap:0,u_opacity:Xe,u_temporal_offset:et}))(Ce.skyboxMatrix,G.getCenter(H,!1),0,X,oe);H.uploadCommonUniforms(xe,Te),Te.draw(H,ve.TRIANGLES,Z,fr.disabled,H.colorModeForRenderPass(),_r.backCW,Le,"skybox",G.skyboxGeometry.vertexBuffer,G.skyboxGeometry.indexBuffer,G.skyboxGeometry.segment)}(f,l,O,y,$):E==="gradient"&&f.renderPass==="sky"&&function(H,G,Z,X,oe){const xe=H.context,ve=xe.gl,Ce=H.transform,Te=H.getOrCreateProgram("skyboxGradient");G.skyboxGeometry||(G.skyboxGeometry=new u0(xe)),xe.activeTexture.set(ve.TEXTURE0);let Le=G.colorRampTexture;Le||(Le=G.colorRampTexture=new r.T(xe,G.colorRamp,ve.RGBA8)),Le.bind(ve.LINEAR,ve.CLAMP_TO_EDGE);const Ge=((He,rt,Xe,et,Ye)=>({u_matrix:He,u_color_ramp:0,u_center_direction:rt,u_radius:r.ai(Xe),u_opacity:et,u_temporal_offset:Ye}))(Ce.skyboxMatrix,G.getCenter(H,!1),G.paint.get("sky-gradient-radius"),X,oe);H.uploadCommonUniforms(xe,Te),Te.draw(H,ve.TRIANGLES,Z,fr.disabled,H.colorModeForRenderPass(),_r.backCW,Ge,"skyboxGradient",G.skyboxGeometry.vertexBuffer,G.skyboxGeometry.indexBuffer,G.skyboxGeometry.segment)}(f,l,O,y,$)},debug:function(f,o,l,m,y,w){for(let E=0;E<l.length;E++)if(y){const H=new r.aj(m.r*.8,m.g*.8,m.b*.8,1);Ec(f,o,l[E],m,-1,-1,w),Ec(f,o,l[E],m,-1,1,w),Ec(f,o,l[E],m,1,1,w),Ec(f,o,l[E],m,1,-1,w),Ec(f,o,l[E],H,0,0,w)}else Ec(f,o,l[E],m,0,0,w)},custom:function(f,o,l,m){const y=f.context,w=l.implementation;if(!f.transform.projection.unsupportedLayers||!f.transform.projection.unsupportedLayers.includes("custom")||f.terrain&&(f.terrain.renderingToTexture||f.renderPass==="offscreen")&&l.isDraped(o)){if(f.renderPass==="offscreen"){const E=w.prerender;if(E){if(f.setCustomLayerDefaults(),y.setColorMode(f.colorModeForRenderPass()),f.transform.projection.name==="globe"){const O=f.transform.pointMerc;E.call(w,y.gl,f.transform.customLayerMatrix(),f.transform.getProjection(),f.transform.globeToMercatorMatrix(),r.ae(f.transform.zoom),[O.x,O.y],f.transform.pixelsPerMeterRatio)}else E.call(w,y.gl,f.transform.customLayerMatrix());y.setDirty(),f.setBaseState()}}else if(f.renderPass==="translucent"){if(f.terrain&&f.terrain.renderingToTexture){const O=w.renderToTile;if(O){const $=m[0].canonical,H=new r.aa($.x+m[0].wrap*(1<<$.z),$.y,$.z);y.setDepthMode(or.disabled),y.setStencilMode(fr.disabled),y.setColorMode(f.colorModeForRenderPass()),f.setCustomLayerDefaults(),O.call(w,y.gl,H),y.setDirty(),f.setBaseState()}return}f.setCustomLayerDefaults(),y.setColorMode(f.colorModeForRenderPass()),y.setStencilMode(fr.disabled);const E=w.renderingMode==="3d"?new or(f.context.gl.LEQUAL,or.ReadWrite,f.depthRangeFor3D):f.depthModeForSublayer(0,or.ReadOnly);if(y.setDepthMode(E),f.transform.projection.name==="globe"){const O=f.transform.pointMerc;w.render(y.gl,f.transform.customLayerMatrix(),f.transform.getProjection(),f.transform.globeToMercatorMatrix(),r.ae(f.transform.zoom),[O.x,O.y],f.transform.pixelsPerMeterRatio)}else w.render(y.gl,f.transform.customLayerMatrix());y.setDirty(),f.setBaseState(),y.bindFramebuffer.set(null)}}else r.w("Custom layers are not yet supported with this projection. Use mercator or globe to enable usage of custom layers.")},model:function(f,o,l,m){if(f.renderPass==="opaque")return;const y=l.paint.get("model-opacity").constantOr(1);if(y===0)return;const w=l.paint.get("model-cast-shadows");if(f.renderPass==="shadow"&&(!w||f.terrain&&y<.65&&l._transitionablePaint._values["model-opacity"].value.expression instanceof r.a9))return;const E=f.shadowRenderer,O=l.paint.get("model-receive-shadows");E&&(E.useNormalOffset=!0,O||(E.enabled=!1));const $=()=>{E&&(E.useNormalOffset=!0,O||(E.enabled=!0))},H=o.getSource();if(f.renderPass==="light-beam"&&H.type!=="batched-model")return;if(H.type==="vector"||H.type==="geojson")return function(Te,Le,Ge,He,rt){const Xe=Te.transform;if(Xe.projection.name!=="mercator")return void r.w(`Drawing 3D models for ${Xe.projection.name} projection is not yet implemented`);const et=Xe.getFreeCameraOptions().position;if(!Te.modelManager)return;const Ye=Te.modelManager;Ge.modelManager=Ye;const at=Te.shadowRenderer;if(!Ge._unevaluatedLayout._values.hasOwnProperty("model-id"))return;const gt=Ge._unevaluatedLayout._values["model-id"],Vt=Object.assign({},Ge.layout.get("model-id").parameters),Rt=Te.style.order.indexOf(Ge.fqid);for(const tn of He){const Jt=Le.getTile(tn).getBucket(Ge);if(!Jt||Jt.projection.name!==Xe.projection.name)continue;const Et=Jt.getModelUris();Et&&!Jt.modelsRequested&&(Ye.addModelsFromBucket(Et,rt),Jt.modelsRequested=!0);const jt=Tp(tn,Xe);Vt.zoom=jt;const gn=gt.possiblyEvaluate(Vt);if(al(Te,Jt,tn),Ji.shadowUniformsInitialized=!1,Ji.useSingleShadowCascade=!!at&&at.getMaxCascadeForTile(tn.toUnwrapped())===0,Te.renderPass==="shadow"&&at){if(Te.currentShadowCascade===1&&Jt.isInsideFirstShadowMapFrustum)continue;const Ht=Xe.calculatePosMatrix(tn.toUnwrapped(),Xe.worldSize);if(Ji.tileMatrix.set(Ht),Ji.shadowTileMatrix=Float32Array.from(at.calculateShadowPassMatrixFromMatrix(Ht)),Ji.aabb.min.fill(0),Ji.aabb.max[0]=Ji.aabb.max[1]=r.ag,Ji.aabb.max[2]=0,sv(Jt,Ji,Te,Ge.scope))continue}const Tt=1<<tn.canonical.z,rn=[((et.x-tn.wrap)*Tt-tn.canonical.x)*r.ag,(et.y*Tt-tn.canonical.y)*r.ag,et.z*Tt*r.ag];Te.conflationActive&&Object.keys(Jt.instancesPerModel).length>0&&Te.style.isLayerClipped(Ge,Le.getSource())&&Jt.updateReplacement(tn,Te.replacementSource,Rt,rt)&&(Jt.uploaded=!1,Jt.upload(Te.context));for(let Ht in Jt.instancesPerModel){const Cn=Jt.instancesPerModel[Ht];Cn.features.length>0&&(Ht=gn.evaluate(Cn.features[0].feature,{}));const dn=Ye.getModel(Ht,rt);if(dn&&dn.uploaded)for(const nn of dn.nodes)Nh(Te,Ge,nn,Cn,rn,tn,Ji)}}}(f,o,l,m,H.type==="vector"?l.scope:""),void $();if(!H.loaded())return;if(H.type==="batched-model")return function(Te,Le,Ge,He){Ge.resetLayerRenderingStats(Te);const rt=Te.context,Xe=Te.transform,et=Te.style.fog,Ye=Te.shadowRenderer;if(Xe.projection.name!=="mercator")return void r.w(`Drawing 3D landmark models for ${Xe.projection.name} projection is not yet implemented`);const at=Te.transform.getFreeCameraOptions().position,gt=r.ab.vec3.scale([],[at.x,at.y,at.z],Te.transform.worldSize),Vt=r.ab.vec3.negate([],gt),Rt=r.ab.mat4.identity([]),tn=r.dj(Xe.center.lat,Xe.zoom),Jt=r.ab.mat4.fromScaling([],[1,1,1/tn]);r.ab.mat4.translate(Rt,Rt,Vt);const Et=Ge.paint.get("model-opacity").constantOr(1),jt=new or(rt.gl.LEQUAL,or.ReadWrite,Te.depthRangeFor3D),gn=new or(rt.gl.LEQUAL,or.ReadOnly,Te.depthRangeFor3D),Tt=new r.cd([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),rn=Te.renderPass==="shadow",Ht=rn&&Ye?Ye.getCurrentCascadeFrustum():Xe.getFrustum(Xe.scaleZoom(Xe.worldSize)),Cn=Ge.paint.get("model-front-cutoff"),dn=Cn[2]<1,nn=xc(Te,Ge.paint.get("model-cutoff-fade-range")),vn=Ge.getLayerRenderingStats();(function(Tn,Ln,Un,dr){const nr=Tn.terrain?Tn.terrain.exaggeration():0,ir=Tn.transform.zoom;for(const br of dr){const jr=Ln.getTile(br).getBucket(Un);jr&&(Tn.conflationActive&&jr.updateReplacement(br,Tn.replacementSource),jr.evaluateScale(Tn,Un),Tn.terrain&&nr>0&&jr.elevationUpdate(Tn.terrain,nr,br,Un.source),jr.needsReEvaluation(Tn,ir,Un)&&jr.evaluate(Un))}})(Te,Le,Ge,He),function(){let Tn,Ln,Un;dn?(Tn=He.length-1,Ln=-1,Un=-1):(Tn=0,Ln=He.length,Un=1);const dr=new Float64Array(16),nr=r.ab.vec3.create(),ir=new r.P(0,0);for(let br=Tn;br!==Ln;br+=Un){const jr=He[br],ho=Le.getTile(jr).getBucket(Ge);if(!ho||!ho.uploaded)continue;let Zo=!1;Ye&&(Zo=Ye.getMaxCascadeForTile(jr.toUnwrapped())===0);const No=Xe.calculatePosMatrix(jr.toUnwrapped(),Xe.worldSize),Sr=ho.modelTraits;!rn&&dn&&(r.ab.mat4.invert(dr,No),r.ab.vec3.transformMat4(nr,gt,dr),ir.x=nr[0],ir.y=nr[1]);const Xr=[];for(const Jn of ho.getNodesInfo()){if(Jn.hiddenByReplacement||!Jn.node.meshes)continue;const Ur=Jn.node;let ro=0;Te.terrain&&Ur.elevation&&(ro=Ur.elevation*Te.terrain.exaggeration());const ao=(()=>{const qr=Jn.aabb;return Tt.min=[...qr.min],Tt.max=[...qr.max],Tt.min[2]+=ro,Tt.max[2]+=ro,r.ab.vec3.transformMat4(Tt.min,Tt.min,No),r.ab.vec3.transformMat4(Tt.max,Tt.max,No),Tt})(),qo=Jn.evaluatedScale;if(qo[0]<=1&&qo[1]<=1&&qo[2]<=1&&ao.intersects(Ht)===0)continue;if(!rn&&dn){const qr=.16666666666666666;Jn.cameraCollisionOpacity=gt[0]>ao.min[0]&&gt[0]<ao.max[0]&&gt[1]>ao.min[1]&&gt[1]<ao.max[1]&&gt[2]*tn<ao.max[2]&&Ur.footprint&&r.bA(ir,Ur.footprint)?Math.max(Jn.cameraCollisionOpacity-qr,0):Math.min(1,Jn.cameraCollisionOpacity+qr)}const Pi=[...No],bi=Ur.anchor?Ur.anchor[0]:0,xi=Ur.anchor?Ur.anchor[1]:0;r.ab.mat4.translate(Pi,Pi,[bi*(qo[0]-1),xi*(qo[1]-1),ro]),r.ab.vec3.exactEquals(qo,r.dm)||r.ab.mat4.scale(Pi,Pi,qo);const Ys=r.ab.mat4.multiply([],Pi,Ur.matrix),Qi=r.ab.mat4.multiply([],Xe.expandedFarZProjMatrix,Ys),Ko=r.ab.mat4.multiply([],Xe.expandedFarZProjMatrix,Pi),Ao=r.ab.vec4.transformMat4([],[bi,xi,ro,1],Qi)[2];Ur.hidden=!1;let xo=Et;rn||(dn&&(xo*=Jn.cameraCollisionOpacity,xo*=av(Pi,Xe,Jn.aabb,Cn)),xo*=mu(nn,Ao)),xo!==0?Xr.push({nodeInfo:Jn,depth:Ao,opacity:xo,wvpForNode:Qi,wvpForTile:Ko,nodeModelMatrix:Ys,tileModelMatrix:Pi}):Ur.hidden=!0}rn||Xr.sort((Jn,Ur)=>!dn||Jn.opacity===1&&Ur.opacity===1?Jn.depth<Ur.depth?-1:1:Jn.opacity===1?-1:Ur.opacity===1?1:Jn.depth>Ur.depth?-1:1);for(const Jn of Xr){const Ur=Jn.nodeInfo,ro=Ur.node;let ao=r.ab.mat4.multiply([],Jt,Jn.tileModelMatrix);r.ab.mat4.multiply(ao,Rt,ao);const qo=r.ab.mat4.invert([],ao);r.ab.mat4.transpose(qo,qo),r.ab.mat4.scale(qo,qo,iv),ao=r.ab.mat4.multiply(ao,ao,ro.matrix);const Pi=Te.renderPass==="light-beam",bi=Ge.paint.get("model-color-use-theme").constantOr("default")==="none",xi=Sr&r.dp.HasMapboxMeshFeatures,Ys=xi?0:Ur.evaluatedRMEA[0][2];for(let Qi=0;Qi<ro.meshes.length;++Qi){const Ko=ro.meshes[Qi],Ao=Qi===ro.lightMeshIndex;let xo=Jn.wvpForNode;if(Ao){if(!Pi&&!Te.terrain&&Te.shadowRenderer){Te.currentLayer<Te.firstLightBeamLayer&&(Te.firstLightBeamLayer=Te.currentLayer);continue}xo=Jn.wvpForTile}else if(Pi)continue;const qr={defines:[]},si=[];if(!rn&&Ye&&(Ye.useNormalOffset=!!Ko.normalBuffer),hd(qr.defines,si,Ko,Te,bi?null:Ge.lut),xi||qr.defines.push("DIFFUSE_SHADED"),Zo&&qr.defines.push("SHADOWS_SINGLE_CASCADE"),vn&&(rn?vn.numRenderedVerticesInShadowPass+=Ko.vertexArray.length:vn.numRenderedVerticesInTransparentPass+=Ko.vertexArray.length),rn){Fh(Ko,Jn.nodeModelMatrix,Te,Ge);continue}let Ri=null;if(et){const dl=Bl(Jn.nodeModelMatrix,Te.transform);if(Ri=new Float32Array(dl),Xe.projection.name!=="globe"){const Sa=Ko.aabb.min,Xs=Ko.aabb.max,[xu,hl]=et.getOpacityForBounds(dl,Sa[0],Sa[1],Xs[0],Xs[1]);qr.overrideFog=xu>=Je||hl>=Je}}const Co=Ko.material;let es;Co.occlusionTexture&&Co.occlusionTexture.offsetScale&&(es=Co.occlusionTexture.offsetScale,qr.defines.push("OCCLUSION_TEXTURE_TRANSFORM"));const wa=Te.getOrCreateProgram("model",qr);!rn&&Ye&&Ye.setupShadowsFromMatrix(Jn.tileModelMatrix,wa,Ye.useNormalOffset),Te.uploadCommonUniforms(rt,wa,null,Ri);const zs=Co.pbrMetallicRoughness;zs.metallicFactor=.9,zs.roughnessFactor=.5;const Ss=Rh(new Float32Array(xo),new Float32Array(ao),new Float32Array(qo),new Float32Array(ro.matrix),Te,Jn.opacity,zs.baseColorFactor.toRenderColor(null),Co.emissiveFactor,zs.metallicFactor,zs.roughnessFactor,Co,Ys,Ge,[0,0,0],es);!Ao&&(Ur.hasTranslucentParts||Jn.opacity<1)&&wa.draw(Te,rt.gl.TRIANGLES,jt,fr.disabled,Lr.disabled,_r.backCCW,Ss,Ge.id,Ko.vertexBuffer,Ko.indexBuffer,Ko.segments,Ge.paint,Te.transform.zoom,void 0,si),wa.draw(Te,rt.gl.TRIANGLES,Ao?gn:jt,fr.disabled,Ao||Jn.opacity<1||Ur.hasTranslucentParts?Lr.alphaBlended:Lr.unblended,_r.backCCW,Ss,Ge.id,Ko.vertexBuffer,Ko.indexBuffer,Ko.segments,Ge.paint,Te.transform.zoom,void 0,si)}}}}()}(f,o,l,m),void $();if(H.type!=="model")return;const G=H.getModels(),Z=[],X=f.transform.getFreeCameraOptions().position,oe=r.ab.vec3.scale([],[X.x,X.y,X.z],f.transform.worldSize);r.ab.vec3.negate(oe,oe);const xe=[],ve=[];let Ce=0;for(const Te of G){const Le=l.paint.get("model-rotation").constantOr(null),Ge=l.paint.get("model-scale").constantOr(null),He=l.paint.get("model-translation").constantOr(null);Te.computeModelMatrix(f,Le,Ge,He,!0,!0,!1);const rt=r.ab.mat4.identity([]),Xe=r.dj(Te.position.lat,f.transform.zoom),et=r.ab.mat4.fromScaling([],[1,1,1/Xe]);r.ab.mat4.translate(rt,rt,oe),Z.push({zScaleMatrix:et,negCameraPosMatrix:rt});for(const Ye of Te.nodes)Sp(f.transform,Ye,Te.matrix,f.transform.expandedFarZProjMatrix,Ce,xe,ve);Ce++}if(xe.sort((Te,Le)=>Le.depth-Te.depth),f.renderPass!=="shadow"){if(y===1)for(const Te of ve)Vl(Te,f,l,Z[Te.modelIndex],fr.disabled,f.colorModeForRenderPass());else{for(const Te of ve)Vl(Te,f,l,Z[Te.modelIndex],fr.disabled,Lr.disabled);for(const Te of ve)Vl(Te,f,l,Z[Te.modelIndex],f.stencilModeFor3D(),f.colorModeForRenderPass());f.resetStencilClippingMasks()}for(const Te of xe)Vl(Te,f,l,Z[Te.modelIndex],fr.disabled,f.colorModeForRenderPass());$()}else{for(const Te of ve)Fh(Te.mesh,Te.nodeModelMatrix,f,l);for(const Te of xe)Fh(Te.mesh,Te.nodeModelMatrix,f,l);$()}}},$h={line:function(f,o,l){if(f.hasElevatedBuckets=!1,f.hasNonElevatedBuckets=!1,f._unevaluatedLayout.getValue("line-elevation-reference")!==void 0||f._unevaluatedLayout.getValue("line-z-offset")!==void 0){if(o){const m=o.getVisibleCoordinates();for(const y of m){const w=o.getTile(y).getBucket(f);if(w&&(w.hasZOffset?f.hasElevatedBuckets=!0:f.hasNonElevatedBuckets=!0,f.hasElevatedBuckets&&f.hasNonElevatedBuckets))break}}}else f.hasNonElevatedBuckets=!0},model:function(f,o,l){const m=o.getSource();if(!m.loaded())return;if(m.type==="vector"||m.type==="geojson")return void(l.modelManager&&l.modelManager.upload(l,m.type==="vector"?f.scope:""));if(m.type==="batched-model"||m.type!=="model")return;const y=m.getModels();for(const w of y)w.upload(l.context)},raster:function(f,o,l){const m=o.getSource();if(!(m instanceof Ei&&m.loaded()))return;const y=f.sourceLayer||m.rasterLayerIds&&m.rasterLayerIds[0];if(!y)return;const w=f.paint.get("raster-array-band")||m.getInitialBand(y);if(w==null)return;const E=o.getIds().map(O=>o.getTileByID(O));for(const O of E)O.updateNeeded(y,w)&&m.prepareTile(O,y,w)},"raster-particle":function(f,o,l){const m=o.getSource();if(!(m instanceof Ei&&m.loaded()))return;const y=f.sourceLayer||m.rasterLayerIds&&m.rasterLayerIds[0];if(!y)return;const w=f.paint.get("raster-particle-array-band")||m.getInitialBand(y);if(w==null)return;const E=o.getIds().map(O=>o.getTileByID(O));for(const O of E)O.updateNeeded(y,w)&&m.prepareTile(O,y,w)}};class mv{constructor(o,l,m,y,w){this.context=new ev(o,l),this.transform=m,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.tp=w,this._timeStamp=r.q.now(),this._averageFPS=0,this._fpsHistory=[],this._dt=0,this._debugParams={forceEnablePrecipitation:!1,showTerrainProxyTiles:!1,fpsWindow:30,continousRedraw:!1,enabledLayers:{}};const E=["fill","line","symbol","circle","heatmap","fill-extrusion","raster","raster-particle","hillshade","model","background","sky"];for(const $ of E)this._debugParams.enabledLayers[$]=!0;w.registerParameter(this._debugParams,["Terrain"],"showTerrainProxyTiles",{},()=>{this.style.map.triggerRepaint()}),w.registerParameter(this._debugParams,["Precipitation"],"forceEnablePrecipitation"),w.registerParameter(this._debugParams,["FPS"],"fpsWindow",{min:1,max:100,step:1}),w.registerBinding(this._debugParams,["FPS"],"continousRedraw",{readonly:!0,label:"continuous redraw"}),w.registerBinding(this,["FPS"],"_averageFPS",{readonly:!0,label:"value"}),w.registerBinding(this,["FPS"],"_averageFPS",{readonly:!0,label:"graph",view:"graph",min:0,max:200});for(const $ of E)w.registerParameter(this._debugParams.enabledLayers,["Debug","Layers"],$);this.occlusionParams=new Cp(w),this.setup(),this.numSublayers=_a.maxUnderzooming+_a.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={},this.conflationActive=!1,this.replacementSource=new r.dv,this.longestCutoffRange=0,this.minCutoffZoom=0,this._fogVisible=!1,this._cachedTileFogOpacities={},this._shadowRenderer=new ou(this),this._wireframeDebugCache=new lv,this.renderDefaultNorthPole=!0,this.renderDefaultSouthPole=!0,this.layersWithOcclusionOpacity=[];const O=new r.r({width:1,height:1},Uint8Array.of(0,0,0,0));this.emptyDepthTexture=new r.T(this.context,O,o.RGBA8),this._clippingActiveLastFrame=!1,this.scaleFactor=y}updateTerrain(o,l){const m=!!o&&!!o.terrain&&this.transform.projection.supportsTerrain;if(!(m||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new rd(this,o));const y=this._terrain;this.transform.elevation=m?y:null,y.update(o,this.transform,l),this.transform.elevation&&!y.enabled&&(this.transform.elevation=null)}_updateFog(o){const l=o.fog;if(!l||this.transform.projection.name==="globe"||l.getOpacity(this.transform.pitch)<1||l.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[m,y]=l.getFovAdjustedRange(this.transform._fov);if(m>y)return void(this.transform.fogCullDistSq=null);const w=m+.78*(y-m);this.transform.fogCullDistSq=w*w}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled||this._forceTerrainMode?this._terrain:null}get forceTerrainMode(){return this._forceTerrainMode}set forceTerrainMode(o){o&&!this._terrain&&(this._terrain=new rd(this,this.style)),this._forceTerrainMode=o}get shadowRenderer(){return this._shadowRenderer&&this._shadowRenderer.enabled?this._shadowRenderer:null}get wireframeDebugCache(){return this._wireframeDebugCache}resize(o,l){if(this.width=o*r.q.devicePixelRatio,this.height=l*r.q.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const m of this.style.order)this.style._mergedLayers[m].resize()}setup(){const o=this.context,l=new r.b4;l.emplaceBack(0,0),l.emplaceBack(r.ag,0),l.emplaceBack(0,r.ag),l.emplaceBack(r.ag,r.ag),this.tileExtentBuffer=o.createVertexBuffer(l,r.b6.members),this.tileExtentSegments=r.b7.simpleSegment(0,0,4,2);const m=new r.b4;m.emplaceBack(0,0),m.emplaceBack(r.ag,0),m.emplaceBack(0,r.ag),m.emplaceBack(r.ag,r.ag),this.debugBuffer=o.createVertexBuffer(m,r.b6.members),this.debugSegments=r.b7.simpleSegment(0,0,4,5);const y=new r.b4;y.emplaceBack(-1,-1),y.emplaceBack(1,-1),y.emplaceBack(-1,1),y.emplaceBack(1,1),this.viewportBuffer=o.createVertexBuffer(y,r.b6.members),this.viewportSegments=r.b7.simpleSegment(0,0,4,2);const w=new r.aT;w.emplaceBack(0,0,0,0),w.emplaceBack(r.ag,0,r.ag,0),w.emplaceBack(0,r.ag,0,r.ag),w.emplaceBack(r.ag,r.ag,r.ag,r.ag),this.mercatorBoundsBuffer=o.createVertexBuffer(w,r.b9.members),this.mercatorBoundsSegments=r.b7.simpleSegment(0,0,4,2);const E=new r.aU;E.emplaceBack(0,1,2),E.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=o.createIndexBuffer(E);const O=new r.b5;for(const H of[0,1,3,2,0])O.emplaceBack(H);this.debugIndexBuffer=o.createIndexBuffer(O),this.emptyTexture=new r.T(o,new r.r({width:1,height:1},Uint8Array.of(0,0,0,0)),o.gl.RGBA8),this.identityMat=r.ab.mat4.create();const $=this.context.gl;this.stencilClearMode=new fr({func:$.ALWAYS,mask:0},0,255,$.ZERO,$.ZERO,$.ZERO),this.loadTimeStamps.push(performance.now())}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(o){return o._makeTileBoundsBuffers(this.context,this.transform.projection),o._tileBoundsBuffer?{tileBoundsBuffer:o._tileBoundsBuffer,tileBoundsIndexBuffer:o._tileBoundsIndexBuffer,tileBoundsSegments:o._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const o=this.context.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.getOrCreateProgram("clippingMask").draw(this,o.TRIANGLES,or.disabled,this.stencilClearMode,Lr.disabled,_r.disabled,dp(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(o,l,m){if(!l||this.currentStencilSource===l.id||!o.isTileClipped()||!m||m.length===0)return;if(this._tileClippingMaskIDs&&!this.terrain){let O=!1;for(const $ of m)if(this._tileClippingMaskIDs[$.key]===void 0){O=!0;break}if(!O)return}this.currentStencilSource=l.id;const y=this.context,w=y.gl;this.nextStencilID+m.length>256&&this.clearStencil(),y.setColorMode(Lr.disabled),y.setDepthMode(or.disabled);const E=this.getOrCreateProgram("clippingMask");this._tileClippingMaskIDs={};for(const O of m){const $=l.getTile(O),H=this._tileClippingMaskIDs[O.key]=this.nextStencilID++,{tileBoundsBuffer:G,tileBoundsIndexBuffer:Z,tileBoundsSegments:X}=this.getTileBoundsBuffers($);E.draw(this,w.TRIANGLES,or.disabled,new fr({func:w.ALWAYS,mask:0},H,255,w.KEEP,w.KEEP,w.REPLACE),Lr.disabled,_r.disabled,dp(O.projMatrix),"$clipping",G,Z,X)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const o=this.nextStencilID++,l=this.context.gl;return new fr({func:l.NOTEQUAL,mask:255},o,255,l.KEEP,l.KEEP,l.REPLACE)}stencilModeForClipping(o){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(o);const l=this.context.gl;return new fr({func:l.EQUAL,mask:255},this._tileClippingMaskIDs[o.key],0,l.KEEP,l.KEEP,l.REPLACE)}stencilConfigForOverlap(o){const l=this.context.gl,m=o.sort((E,O)=>O.overscaledZ-E.overscaledZ),y=m[m.length-1].overscaledZ,w=m[0].overscaledZ-y+1;if(w>1){this.currentStencilSource=void 0,this.nextStencilID+w>256&&this.clearStencil();const E={};for(let O=0;O<w;O++)E[O+y]=new fr({func:l.GEQUAL,mask:255},O+this.nextStencilID,255,l.KEEP,l.KEEP,l.REPLACE);return this.nextStencilID+=w,[E,m]}return[{[y]:fr.disabled},m]}colorModeForRenderPass(){const o=this.context.gl;return this._showOverdrawInspector?new Lr([o.CONSTANT_COLOR,o.ONE,o.CONSTANT_COLOR,o.ONE],new r.aj(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?Lr.unblended:Lr.alphaBlended}colorModeForDrapableLayerRenderPass(o){const l=this.context.gl;return this.style&&this.style.enable3dLights()&&this.terrain&&this.terrain.renderingToTexture&&this.renderPass==="translucent"?new Lr([l.ONE,l.ONE_MINUS_SRC_ALPHA,l.CONSTANT_ALPHA,l.ONE_MINUS_SRC_ALPHA],new r.aj(0,0,0,o===void 0?0:o),[!0,!0,!0,!0]):this.colorModeForRenderPass()}depthModeForSublayer(o,l,m,y=!1){if(this.depthOcclusion)return new or(this.context.gl.GREATER,or.ReadOnly,this.depthRangeFor3D);if(!this.opaquePassEnabledForLayer()&&!y)return or.disabled;const w=1-((1+this.currentLayer)*this.numSublayers+o)*this.depthEpsilon;return new or(m||this.context.gl.LEQUAL,l,[w,w])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}blitDepth(){const o=this.context.gl,l=Math.ceil(this.width),m=Math.ceil(this.height),y=this.context.bindFramebuffer.get(),w=o.getParameter(o.TEXTURE_BINDING_2D);this.depthFBO&&this.depthFBO.width===l&&this.depthFBO.height===m||(this.depthFBO&&(this.depthFBO.destroy(),this.depthFBO=void 0,this.depthTexture=void 0),l!==0&&m!==0&&(this.depthFBO=new Qg(this.context,l,m,!1,"texture"),this.depthTexture=new r.T(this.context,{width:l,height:m,data:null},o.DEPTH24_STENCIL8),this.depthFBO.depthAttachment.set(this.depthTexture.texture))),this.context.bindFramebuffer.set(y),o.bindTexture(o.TEXTURE_2D,w),this.depthFBO&&(o.bindFramebuffer(o.READ_FRAMEBUFFER,null),o.bindFramebuffer(o.DRAW_FRAMEBUFFER,this.depthFBO.framebuffer),o.blitFramebuffer(0,0,l,m,0,0,l,m,o.DEPTH_BUFFER_BIT,o.NEAREST),o.bindFramebuffer(o.FRAMEBUFFER,this.context.bindFramebuffer.current))}updateAverageFPS(){this._fpsHistory.push(this._dt===0?0:1e3/this._dt),this._fpsHistory.length>this._debugParams.fpsWindow&&this._fpsHistory.splice(0,this._fpsHistory.length-this._debugParams.fpsWindow),this._averageFPS=Math.round(this._fpsHistory.reduce((o,l)=>o+l/this._fpsHistory.length,0))}render(o,l){const m=r.q.now();this._dt=m-this._timeStamp,this._timeStamp=m,this._wireframeDebugCache.update(this.frameCounter),this._debugParams.continousRedraw=o.map.repaint,this.style=o,this.options=l;const y=this.style._mergedLayers,w=!(!this.terrain||!this.terrain.enabled),E=()=>this.style._getOrder(w).filter(Et=>{const jt=y[Et];return!(jt.type in this._debugParams.enabledLayers)||this._debugParams.enabledLayers[jt.type]});let O=E(),$=!1,H=!1;for(const Et of O){const jt=y[Et];jt.type==="circle"&&($=!0),jt.type==="symbol"&&(jt.hasInitialOcclusionOpacityProperties?H=!0:$=!0)}let G=O.map(Et=>y[Et]);const Z=this.style._mergedSourceCaches;this.imageManager=o.imageManager,this.modelManager=o.modelManager,this.symbolFadeChange=o.placement.symbolFadeChange(r.q.now()),this.imageManager.beginFrame();let X=0,oe=!1;for(const Et in Z){const jt=Z[Et];jt.used&&(jt.prepare(this.context),jt.getSource().usedInConflation&&++X)}let xe=!1;for(const Et of G)Et.isHidden(this.transform.zoom)||(Et.type==="clip"&&(xe=!0),this.prepareLayer(Et));const ve={},Ce={},Te={},Le={},Ge={};for(const Et in Z){const jt=Z[Et];ve[Et]=jt.getVisibleCoordinates(),Ce[Et]=ve[Et].slice().reverse(),Te[Et]=jt.getVisibleCoordinates(!0).reverse(),Le[Et]=jt.getShadowCasterCoordinates(),Ge[Et]=jt.sortCoordinatesByDistance(ve[Et])}const He=Et=>{const jt=this.style.getLayerSourceCache(Et);return jt&&jt.used?jt.getSource():null};if(X||xe||this._clippingActiveLastFrame){const Et=[],jt=[];let gn=0;for(const Tt of G)this.isSourceForClippingOrConflation(Tt,He(Tt))&&(Et.push(Tt),jt.push(gn)),gn++;if(Et&&(xe||Et.length>1)||this._clippingActiveLastFrame){xe=!1;const Tt=[];for(let rn=0;rn<Et.length;rn++){const Ht=Et[rn],Cn=jt[rn],dn=this.style.getLayerSourceCache(Ht);if(!dn||!dn.used||!dn.getSource().usedInConflation&&Ht.type!=="clip")continue;let nn=r.dx,vn=r.by.None;const Tn=[];let Ln=!0;if(Ht.type==="clip"){nn=Cn;for(const Un of Ht.layout.get("clip-layer-types"))vn|=Un==="model"?r.by.Model:Un==="symbol"?r.by.Symbol:r.by.FillExtrusion;for(const Un of Ht.layout.get("clip-layer-scope"))Tn.push(Un);Ht.isHidden(this.transform.zoom)?Ln=!1:xe=!0}Ln&&Tt.push({layer:Ht.fqid,cache:dn,order:nn,clipMask:vn,clipScope:Tn})}this.replacementSource.setSources(Tt),oe=!0}}this._clippingActiveLastFrame=xe,oe||this.replacementSource.clear(),this.conflationActive=oe,this.minCutoffZoom=0,this.longestCutoffRange=0,this.opaquePassCutoff=1/0,this._lastOcclusionLayer=-1,this.layersWithOcclusionOpacity=[];for(let Et=0;Et<G.length;Et++){const jt=G[Et],gn=jt.cutoffRange();if(this.longestCutoffRange=Math.max(gn,this.longestCutoffRange),gn>0){const Tt=He(jt);Tt&&(this.minCutoffZoom=Math.max(Tt.minzoom,this.minCutoffZoom)),jt.minzoom&&(this.minCutoffZoom=Math.max(jt.minzoom,this.minCutoffZoom))}jt.is3D()&&(this.opaquePassCutoff===1/0&&(this.opaquePassCutoff=Et),this._lastOcclusionLayer=Et)}const rt=this.style&&this.style.fog;rt?(this._fogVisible=rt.getOpacity(this.transform.pitch)!==0,this._fogVisible&&this.transform.projection.name!=="globe"&&(this._fogVisible=rt.isVisibleOnFrustum(this.transform.cameraFrustum))):this._fogVisible=!1,this._cachedTileFogOpacities={},this.terrain&&(this.terrain.updateTileBinding(Te),this.opaquePassCutoff=0,O=E(),G=O.map(Et=>y[Et]));const Xe=this._shadowRenderer;if(Xe){Xe.updateShadowParameters(this.transform,this.style.directionalLight);for(const Et in Z)for(const jt of ve[Et]){let gn={min:0,max:0};this.terrain&&(gn=this.terrain.getMinMaxForTile(jt)||gn),Xe.addShadowReceiver(jt.toUnwrapped(),gn.min,gn.max)}}this.transform.projection.name!=="globe"||this.globeSharedBuffers||(this.globeSharedBuffers=new r.dw(this.context)),this.style.fog&&this.transform.projection.supportsFog?(this._atmosphere||(this._atmosphere=new d0(this)),this._atmosphere.update(this)):this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0);const et=this._debugParams.forceEnablePrecipitation||!(!this.style||!this.style.snow),Ye=this._debugParams.forceEnablePrecipitation||!(!this.style||!this.style.rain);if(et&&!this._snow&&(this._snow=new pv(this)),!et&&this._snow&&(this._snow.destroy(),delete this._snow),Ye&&!this._rain&&(this._rain=new fd(this)),!Ye&&this._rain&&(this._rain.destroy(),delete this._rain),this._snow&&this._snow.update(this),this._rain&&this._rain.update(this),!cn.has(this.context.gl))return;this.renderPass="offscreen";for(const Et of G){const jt=o.getLayerSourceCache(Et);if(!Et.hasOffscreenPass()||Et.isHidden(this.transform.zoom))continue;const gn=jt?Ce[jt.id]:void 0;(Et.type==="custom"||Et.type==="raster"||Et.type==="raster-particle"||Et.isSky()||gn&&gn.length)&&this.renderLayer(this,jt,Et,gn)}this.depthRangeFor3D=[0,1-(G.length+2)*this.numSublayers*this.depthEpsilon],this._shadowRenderer&&(this.renderPass="shadow",this._shadowRenderer.drawShadowPass(this.style,Le)),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]);const at=this.transform.projection.name==="globe"||this.transform.isHorizonVisible(),gt=(()=>{if(l.showOverdrawInspector)return r.aj.black;const Et=this.style.fog;if(Et&&this.transform.projection.supportsFog){const jt=this.style.getLut(Et.scope);if(!at){const gn=Et.properties.get("color-use-theme")==="none",Tt=Et.properties.get("color").toRenderColor(gn?null:jt).toArray01();return new r.aj(...Tt)}if(at){const gn=Et.properties.get("space-color-use-theme")==="none",Tt=Et.properties.get("space-color").toRenderColor(gn?null:jt).toArray01();return new r.aj(...Tt)}}return r.aj.transparent})();if(this.context.clear({color:gt,depth:1}),this.clearStencil(),this._showOverdrawInspector=l.showOverdrawInspector,this.renderPass="opaque",this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&at&&this._atmosphere.drawStars(this,this.style.fog),!this.terrain)for(this.currentLayer=O.length-1;this.currentLayer>=0;this.currentLayer--){const Et=G[this.currentLayer],jt=o.getLayerSourceCache(Et);if(Et.isSky())continue;const gn=jt?(Et.is3D()?Ge:Ce)[jt.id]:void 0;this._renderTileClippingMasks(Et,jt,gn),this.renderLayer(this,jt,Et,gn)}if(this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&at&&this._atmosphere.drawAtmosphereGlow(this,this.style.fog),this.renderPass="sky",(!this._atmosphere||r.ae(this.transform.zoom)>0)&&(this.transform.projection.name==="globe"||this.transform.isHorizonVisible()))for(this.currentLayer=0;this.currentLayer<O.length;this.currentLayer++){const Et=G[this.currentLayer],jt=o.getLayerSourceCache(Et);Et.isSky()&&this.renderLayer(this,jt,Et,jt?Ce[jt.id]:void 0)}function Vt(Et,jt){let gn;return jt&&(gn=(Et.type==="symbol"?Te:Et.is3D()?Ge:Ce)[jt.id]),gn}if(this.renderPass="translucent",this.transform.projection.name==="globe"){for(this.renderElevatedRasterBackface=!0,this.currentLayer=0;this.currentLayer<O.length;){const Et=G[this.currentLayer];if(Et.type==="raster"||Et.type==="raster-particle"){const jt=o.getLayerSourceCache(Et);this.renderLayer(this,jt,Et,Vt(Et,jt))}++this.currentLayer}this.renderElevatedRasterBackface=!1}this.currentLayer=0,this.firstLightBeamLayer=Number.MAX_SAFE_INTEGER;let Rt=0;Xe&&(Rt=Xe.getShadowCastingLayerCount());let tn=!1,Jt=-1;for(let Et=0;Et<O.length;++Et){const jt=G[Et];jt.isHidden(this.transform.zoom)||jt.is3D()&&(Jt=Et)}for(H&&Jt===-1&&($=!0);this.currentLayer<O.length;){const Et=G[this.currentLayer],jt=o.getLayerSourceCache(Et);if(Et.isSky())++this.currentLayer;else if(this.terrain&&this.style.isLayerDraped(Et)){if(Et.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer),this._lastOcclusionLayer=Math.max(this.currentLayer,this._lastOcclusionLayer)}else{if($&&!tn&&this.terrain&&!this.transform.isOrthographic&&(tn=!0,this.blitDepth()),H&&Jt!==-1&&this.currentLayer===Jt+1&&!this.transform.isOrthographic&&this.blitDepth(),Et.is3D()||this.terrain||this._renderTileClippingMasks(Et,jt,jt?ve[jt.id]:void 0),this.renderLayer(this,jt,Et,Vt(Et,jt)),!this.terrain&&Xe&&Rt>0&&Et.hasShadowPass()&&--Rt==0&&(Xe.drawGroundShadows(),this.firstLightBeamLayer<=this.currentLayer)){const gn=this.currentLayer;for(this.renderPass="light-beam",this.currentLayer=this.firstLightBeamLayer;this.currentLayer<=gn;this.currentLayer++){const Tt=G[this.currentLayer];if(!Tt.hasLightBeamPass())continue;const rn=o.getLayerSourceCache(Tt);this.renderLayer(this,rn,Tt,rn?Ce[rn.id]:void 0)}this.currentLayer=gn,this.renderPass="translucent"}if(this.currentLayer>=this._lastOcclusionLayer&&this.layersWithOcclusionOpacity.length>0){const gn=this.currentLayer;this.depthOcclusion=!0;for(const Tt of this.layersWithOcclusionOpacity){this.currentLayer=Tt;const rn=G[this.currentLayer],Ht=o.getLayerSourceCache(rn),Cn=Ht?Ce[Ht.id]:void 0;rn.is3D()||this.terrain||this._renderTileClippingMasks(rn,Ht,Ht?ve[Ht.id]:void 0),this.renderLayer(this,Ht,rn,Cn)}this.depthOcclusion=!1,this.currentLayer=gn,this.renderPass="translucent",this.layersWithOcclusionOpacity=[]}++this.currentLayer}}if(this.terrain&&this.terrain.postRender(),this._snow&&this._snow.draw(this),this._rain&&this._rain.draw(this),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let Et=null;G.forEach(jt=>{const gn=o.getLayerSourceCache(jt);gn&&!jt.isHidden(this.transform.zoom)&&gn.getVisibleCoordinates().length&&(!Et||Et.getSource().maxzoom<gn.getSource().maxzoom)&&(Et=gn)}),Et&&this.options.showTileBoundaries&&Vh.debug(this,Et,Et.getVisibleCoordinates(),r.aj.red,!1,this.options.showParseStatus)}this.terrain&&this._debugParams.showTerrainProxyTiles&&Vh.debug(this,this.terrain.proxySourceCache,this.terrain.proxyCoords,new r.aj(1,.8,.1,1),!0,this.options.showParseStatus),this.options.showPadding&&function(Et){const jt=Et.transform.padding;rv(Et,Et.transform.height-(jt.top||0),3,dd),rv(Et,jt.bottom||0,3,dw),ov(Et,jt.left||0,3,hw),ov(Et,Et.transform.width-(jt.right||0),3,c0);const gn=Et.transform.centerPoint;(function(Tt,rn,Ht,Cn){pu(Tt,rn-1,Ht-10,2,20,Cn),pu(Tt,rn-10,Ht-1,20,2,Cn)})(Et,gn.x,Et.transform.height-gn.y,xp)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(performance.now()),this.saveCanvasCopy()),oe||(this.conflationActive=!1)}prepareLayer(o){this.gpuTimingStart(o);const{unsupportedLayers:l}=this.transform.projection,m=!l||!l.includes(o.type);if($h[o.type]&&(m||this.terrain&&o.type==="custom")){const y=this.style.getLayerSourceCache(o);$h[o.type](o,y,this)}this.gpuTimingEnd()}renderLayer(o,l,m,y){m.isHidden(this.transform.zoom)||(m.type==="background"||m.type==="sky"||m.type==="custom"||m.type==="model"||m.type==="raster"||m.type==="raster-particle"||y&&y.length)&&(this.id=m.id,this.gpuTimingStart(m),o.transform.projection.unsupportedLayers&&o.transform.projection.unsupportedLayers.includes(m.type)&&(!o.terrain||m.type!=="custom")||m.type==="clip"||Vh[m.type](o,l,m,y,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(o){if(!this.options.gpuTiming)return;const l=this.context.extTimerQuery,m=this.context.gl;let y=this.gpuTimers[o.id];y||(y=this.gpuTimers[o.id]={calls:0,cpuTime:0,query:m.createQuery()}),y.calls++,m.beginQuery(l.TIME_ELAPSED_EXT,y.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const o=this.context.extTimerQuery,l=this.context.gl,m=l.createQuery();this.deferredRenderGpuTimeQueries.push(m),l.beginQuery(o.TIME_ELAPSED_EXT,m)}}gpuTimingDeferredRenderEnd(){this.options.gpuTimingDeferredRender&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}gpuTimingEnd(){this.options.gpuTiming&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}collectGpuTimers(){const o=this.gpuTimers;return this.gpuTimers={},o}collectDeferredRenderGpuQueries(){const o=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],o}queryGpuTimers(o){const l={};for(const m in o){const y=o[m],w=this.context.extTimerQuery,E=w.getQueryParameter(y.query,this.context.gl.QUERY_RESULT)/1e6;w.deleteQueryEXT(y.query),l[m]=E}return l}queryGpuTimeDeferredRender(o){if(!this.options.gpuTimingDeferredRender)return 0;const l=this.context.gl;let m=0;for(const y of o)m+=l.getQueryParameter(y,l.QUERY_RESULT)/1e6,l.deleteQuery(y);return m}translatePosMatrix(o,l,m,y,w){if(!m[0]&&!m[1])return o;const E=w?y==="map"?this.transform.angle:0:y==="viewport"?-this.transform.angle:0;if(E){const H=Math.sin(E),G=Math.cos(E);m=[m[0]*G-m[1]*H,m[0]*H+m[1]*G]}const O=[w?m[0]:r.ar(l,m[0],this.transform.zoom),w?m[1]:r.ar(l,m[1],this.transform.zoom),0],$=new Float32Array(16);return r.ab.mat4.translate($,o,O),$}saveTileTexture(o){const l=o.size[0],m=this._tileTextures[l];m?m.push(o):this._tileTextures[l]=[o]}getTileTexture(o){const l=this._tileTextures[o];return l&&l.length>0?l.pop():null}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture||this.forceTerrainMode}linearFloatFilteringSupported(){return this.context.extTextureFloatLinear!=null}currentGlobalDefines(o,l,m){const y=m===void 0?this.terrain&&this.terrain.renderingToTexture:m,w=[];return this.style&&this.style.enable3dLights()&&(o==="globeRaster"||o==="terrainRaster"?(w.push("LIGHTING_3D_MODE"),w.push("LIGHTING_3D_ALPHA_EMISSIVENESS")):y||w.push("LIGHTING_3D_MODE")),this.renderPass==="shadow"&&(this._shadowMapDebug||w.push("DEPTH_TEXTURE")),this.terrainRenderModeElevated()&&(w.push("TERRAIN"),this.linearFloatFilteringSupported()&&w.push("TERRAIN_DEM_FLOAT_FORMAT")),this.transform.projection.name==="globe"&&w.push("GLOBE"),!this._fogVisible||y||l!==void 0&&!l||w.push("FOG","FOG_DITHERING"),y&&w.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&w.push("OVERDRAW_INSPECTOR"),w}getOrCreateProgram(o,l){this.cache=this.cache||{};const m=l&&l.defines||[],y=l&&l.config,w=this.currentGlobalDefines(o,l&&l.overrideFog,l&&l.overrideRtt).concat(m),E=t0.cacheKey(Qu[o],o,w,y);return this.cache[E]||(this.cache[E]=new t0(this.context,o,Qu[o],y,Jg[o],w)),this.cache[E]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const o=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(o.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new r.T(this.context,this.debugOverlayCanvas,this.context.gl.RGBA8))}destroy(){this._terrain&&this._terrain.destroy(),this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this._wireframeDebugCache.destroy(),this.depthFBO&&(this.depthFBO.destroy(),this.depthFBO=void 0,this.depthTexture=void 0),this.emptyDepthTexture&&this.emptyDepthTexture.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}uploadCommonLightUniforms(o,l){if(this.style.enable3dLights()){const m=this.style.directionalLight,y=this.style.ambientLight;if(m&&y){const w=((E,O,$)=>{const H=E.properties.get("direction"),G=E.properties.get("color-use-theme")==="none",Z=E.properties.get("color").toRenderColor(G?null:$.getLut(E.scope)).toArray01(),X=E.properties.get("intensity"),oe=O.properties.get("color-use-theme")==="none",xe=O.properties.get("color").toRenderColor(oe?null:$.getLut(O.scope)).toArray01(),ve=O.properties.get("intensity"),Ce=[H.x,H.y,H.z],Te=r.cM(xe,ve),Le=r.cM(Z,X);return{u_lighting_ambient_color:Te,u_lighting_directional_dir:Ce,u_lighting_directional_color:Le,u_ground_radiance:sw(Ce,Le,Te)}})(m,y,this.style);l.setLightsUniformValues(o,w)}}}uploadCommonUniforms(o,l,m,y,w){if(this.uploadCommonLightUniforms(o,l),this.terrain&&this.terrain.renderingToTexture)return;const E=this.style.fog;if(E){const O=E.getOpacity(this.transform.pitch),$=((H,G,Z,X,oe,xe,ve,Ce,Te,Le,Ge,He)=>{const rt=H.transform,Xe=G.properties.get("color-use-theme")==="none",et=G.properties.get("color").toRenderColor(Xe?null:H.style.getLut(G.scope)).toArray01();et[3]=X;const Ye=H.frameCounter/1e3%1,[at,gt]=G.properties.get("vertical-range");return{u_fog_matrix:Z?rt.calculateFogTileMatrix(Z):He||H.identityMat,u_fog_range:G.getFovAdjustedRange(rt._fov),u_fog_color:et,u_fog_horizon_blend:G.properties.get("horizon-blend"),u_fog_vertical_limit:[Math.min(at,gt),gt],u_fog_temporal_offset:Ye,u_frustum_tl:oe,u_frustum_tr:xe,u_frustum_br:ve,u_frustum_bl:Ce,u_globe_pos:Te,u_globe_radius:Le,u_viewport:Ge,u_globe_transition:r.ae(rt.zoom),u_is_globe:+(rt.projection.name==="globe")}})(this,E,m,O,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*r.q.devicePixelRatio,this.transform.height*r.q.devicePixelRatio],y);l.setFogUniformValues(o,$)}w&&l.setCutoffUniformValues(o,w.uniformValues)}setTileLoadedFlag(o){this.tileLoaded=o}saveCanvasCopy(){const o=this.canvasCopy();o&&(this.frameCopies.push(o),this.tileLoaded=!1)}canvasCopy(){const o=this.context.gl,l=o.createTexture();return o.bindTexture(o.TEXTURE_2D,l),o.copyTexImage2D(o.TEXTURE_2D,0,o.RGBA,0,0,o.drawingBufferWidth,o.drawingBufferHeight,0),l}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const o=this.style&&this.style.fog;return!!o&&o.getOpacity(this.transform.pitch)!==0}getBackgroundTiles(){const o=this._backgroundTiles,l=this._backgroundTiles={},m=this.transform.coveringTiles({tileSize:512});for(const y of m)l[y.key]=o[y.key]||new _c(y,512,this.transform.tileZoom,this);return l}clearBackgroundTiles(){this._backgroundTiles={}}isSourceForClippingOrConflation(o,l){return!(!o.is3D()||o.type!=="clip"&&(o.minzoom&&o.minzoom>this.transform.zoom||(this.style._clipLayerPresent||o.sourceLayer!=="building")&&(!l||l.type!=="batched-model")))}isTileAffectedByFog(o){if(!this.style||!this.style.fog)return!1;if(this.transform.projection.name==="globe")return!0;let l=this._cachedTileFogOpacities[o.key];return l||(this._cachedTileFogOpacities[o.key]=l=this.style.fog.getOpacityForTile(o)),l[0]>=Je||l[1]>=Je}setupDepthForOcclusion(o,l,m){const y=this.context,w=y.gl,E=!!m;var O;m||(m={u_dem:2,u_dem_prev:4,u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_depth_range_unpack:[0,1],u_occluder_half_size:16,u_occlusion_depth_offset:-1e-4,u_exaggeration:0}),y.activeTexture.set(w.TEXTURE3),o&&this.depthFBO&&this.depthTexture?(this.depthTexture.bind(w.NEAREST,w.CLAMP_TO_EDGE),m.u_depth_size_inv=[1/this.depthFBO.width,1/this.depthFBO.height],m.u_depth_range_unpack=[2/((O=this.depthRangeFor3D)[1]-O[0]),-1-2*O[0]/(O[1]-O[0])],m.u_occluder_half_size=.5*this.occlusionParams.occluderSize,m.u_occlusion_depth_offset=this.occlusionParams.depthOffset):this.emptyDepthTexture.bind(w.NEAREST,w.CLAMP_TO_EDGE),y.activeTexture.set(w.TEXTURE0),E||l.setTerrainUniformValues(y,m)}}function Ip(f,o){let l=!1,m=null;const y=()=>{m=null,l&&(f(),m=setTimeout(y,o),l=!1)};return()=>(l=!0,m||y(),m)}class h0{constructor(o){this._hashName=o&&encodeURIComponent(o),r.aP(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=Ip(this._updateHashUnthrottled.bind(this),300)}addTo(o){return this._map=o,window.addEventListener("hashchange",this._onHashChange,!1),o.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const o=this._map;if(!o)return"";const l=gv(o);if(this._hashName){const m=this._hashName;let y=!1;const w=location.hash.slice(1).split("&").map(E=>{const O=E.split("=")[0];return O===m?(y=!0,`${O}=${l}`):E}).filter(E=>E);return y||w.push(`${m}=${l}`),`#${w.join("&")}`}return`#${l}`}_getCurrentHash(){const o=location.hash.replace("#","");if(this._hashName){let l;return o.split("&").map(m=>m.split("=")).forEach(m=>{m[0]===this._hashName&&(l=m)}),(l&&l[1]||"").split("/")}return o.split("/")}_onHashChange(){const o=this._map;if(!o)return!1;const l=this._getCurrentHash();if(l.length>=3&&!l.some(m=>isNaN(m))){const m=o.dragRotate.isEnabled()&&o.touchZoomRotate.isEnabled()?+(l[3]||0):o.getBearing();return o.jumpTo({center:[+l[2],+l[1]],zoom:+l[0],bearing:m,pitch:+(l[4]||0)}),!0}return!1}_updateHashUnthrottled(){history.replaceState(history.state,"",location.href.replace(/(#.+)?$/,this.getHashString()))}}function gv(f,o){const l=f.getCenter(),m=Math.round(100*f.getZoom())/100,y=Math.ceil((m*Math.LN2+Math.log(512/360/.5))/Math.LN10),w=Math.pow(10,y),E=Math.round(l.lng*w)/w,O=Math.round(l.lat*w)/w,$=f.getBearing(),H=f.getPitch();let G=o?`/${E}/${O}/${m}`:`${m}/${O}/${E}`;return($||H)&&(G+="/"+Math.round(10*$)/10),H&&(G+=`/${Math.round(H)}`),G}const Uh={linearity:.3,easing:r.dy(0,0,.3,1)},f0=r.l({deceleration:2500,maxSpeed:1400},Uh),p0=r.l({deceleration:20,maxSpeed:1400},Uh),m0=r.l({deceleration:1e3,maxSpeed:360},Uh),g0=r.l({deceleration:1e3,maxSpeed:90},Uh);class v0{constructor(o){this._map=o,this.clear()}clear(){this._inertiaBuffer=[]}record(o){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:r.q.now(),settings:o})}_drainInertiaBuffer(){const o=this._inertiaBuffer,l=r.q.now();for(;o.length>0&&l-o[0].time>160;)o.shift()}_onMoveEnd(o){if(this._map._prefersReducedMotion()||(this._drainInertiaBuffer(),this._inertiaBuffer.length<2))return;const l={zoom:0,bearing:0,pitch:0,pan:new r.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:w}of this._inertiaBuffer)l.zoom+=w.zoomDelta||0,l.bearing+=w.bearingDelta||0,l.pitch+=w.pitchDelta||0,w.panDelta&&l.pan._add(w.panDelta),w.around&&(l.around=w.around),w.pinchAround&&(l.pinchAround=w.pinchAround);const m=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,y={};if(l.pan.mag()){const w=Hh(l.pan.mag(),m,r.l({},f0,o||{}));y.offset=l.pan.mult(w.amount/l.pan.mag()),y.center=this._map.transform.center,jh(y,w)}if(l.zoom){const w=Hh(l.zoom,m,p0);y.zoom=this._map.transform.zoom+w.amount,jh(y,w)}if(l.bearing){const w=Hh(l.bearing,m,m0);y.bearing=this._map.transform.bearing+r.aw(w.amount,-179,179),jh(y,w)}if(l.pitch){const w=Hh(l.pitch,m,g0);y.pitch=this._map.transform.pitch+w.amount,jh(y,w)}if(y.zoom||y.bearing){const w=l.pinchAround===void 0?l.around:l.pinchAround;y.around=w?this._map.unproject(w):this._map.getCenter()}return this.clear(),y.noMoveStart=!0,y}}function jh(f,o){(!f.duration||f.duration<o.duration)&&(f.duration=o.duration,f.easing=o.easing)}function Hh(f,o,l){const{maxSpeed:m,linearity:y,deceleration:w}=l,E=r.aw(f*y/(o/1e3),-m,m),O=Math.abs(E)/(w*y);return{easing:l.easing,duration:1e3*O,amount:E*(O/2)}}class Ls extends r.z{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(o,l,m,y={}){const w=fe(l.getCanvasContainer(),m),E=l.unproject(w);super(o,r.l({point:w,lngLat:E,originalEvent:m},y)),this._defaultPrevented=!1,this.target=l}}class Gh extends r.z{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(o,l,m){const y=o==="touchend"?m.changedTouches:m.touches,w=ce(l.getCanvasContainer(),y),E=w.map($=>l.unproject($)),O=w.reduce(($,H,G,Z)=>$.add(H.div(Z.length)),new r.P(0,0));super(o,{points:w,point:O,lngLats:E,lngLat:l.unproject(O),originalEvent:m}),this._defaultPrevented=!1}}class _0 extends r.z{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(o,l){super("wheel",{originalEvent:l}),this._defaultPrevented=!1}}class pw{constructor(o,l){this._map=o,this._clickTolerance=l.clickTolerance}reset(){this._mousedownPos=void 0}wheel(o){return this._firePreventable(new _0(this._map,o))}mousedown(o,l){return this._mousedownPos=l,this._firePreventable(new Ls(o.type,this._map,o))}mouseup(o){this._map.fire(new Ls(o.type,this._map,o))}preclick(o){const l=r.l({},o);l.type="preclick",this._map.fire(new Ls(l.type,this._map,l))}click(o,l){this._mousedownPos&&this._mousedownPos.dist(l)>=this._clickTolerance||(this.preclick(o),this._map.fire(new Ls(o.type,this._map,o)))}dblclick(o){return this._firePreventable(new Ls(o.type,this._map,o))}mouseover(o){this._map.fire(new Ls(o.type,this._map,o))}mouseout(o){this._map.fire(new Ls(o.type,this._map,o))}touchstart(o){return this._firePreventable(new Gh(o.type,this._map,o))}touchmove(o){this._map.fire(new Gh(o.type,this._map,o))}touchend(o){this._map.fire(new Gh(o.type,this._map,o))}touchcancel(o){this._map.fire(new Gh(o.type,this._map,o))}_firePreventable(o){if(this._map.fire(o),o.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class mw{constructor(o){this._map=o}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(o){this._map.fire(new Ls(o.type,this._map,o))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Ls("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(o){this._delayContextMenu?this._contextMenuEvent=o:this._map.fire(new Ls(o.type,this._map,o)),this._map.listens("contextmenu")&&o.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class ei{constructor(o,l){this._map=o,this._el=o.getCanvasContainer(),this._container=o.getContainer(),this._clickTolerance=l.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(o,l){this.isEnabled()&&o.shiftKey&&o.button===0&&(q(),this._startPos=this._lastPos=l,this._active=!0)}mousemoveWindow(o,l){if(!this._active)return;const m=l,y=this._startPos,w=this._lastPos;if(!y||!w||w.equals(m)||!this._box&&m.dist(y)<this._clickTolerance)return;this._lastPos=m,this._box||(this._box=N("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",o));const E=Math.min(y.x,m.x),O=Math.max(y.x,m.x),$=Math.min(y.y,m.y),H=Math.max(y.y,m.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${E}px,${$}px)`,this._box.style.width=O-E+"px",this._box.style.height=H-$+"px")})}mouseupWindow(o,l){if(!this._active)return;const m=this._startPos,y=l;if(m&&o.button===0){if(this.reset(),se(),m.x!==y.x||m.y!==y.y)return this._map.fire(new r.z("boxzoomend",{originalEvent:o})),{cameraAnimation:w=>w.fitScreenCoordinates(m,y,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",o)}}keydown(o){this._active&&o.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",o))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),J(),delete this._startPos,delete this._lastPos}_fireEvent(o,l){return this._map.fire(new r.z(o,{originalEvent:l}))}}function Ap(f,o){const l={};for(let m=0;m<f.length;m++)l[f[m].identifier]=o[m];return l}class gw{constructor(o){this.reset(),this.numTouches=o.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(o,l,m){(this.centroid||m.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===0&&(this.startTime=o.timeStamp),m.length===this.numTouches&&(this.centroid=function(y){const w=new r.P(0,0);for(const E of y)w._add(E);return w.div(y.length)}(l),this.touches=Ap(m,l)))}touchmove(o,l,m){if(this.aborted||!this.centroid)return;const y=Ap(m,l);for(const w in this.touches){const E=y[w];(!E||E.dist(this.touches[w])>30)&&(this.aborted=!0)}}touchend(o,l,m){if((!this.centroid||o.timeStamp-this.startTime>500)&&(this.aborted=!0),m.length===0){const y=!this.aborted&&this.centroid;if(this.reset(),y)return y}}}class vv{constructor(o){this.singleTap=new gw(o),this.numTaps=o.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(o,l,m){this.singleTap.touchstart(o,l,m)}touchmove(o,l,m){this.singleTap.touchmove(o,l,m)}touchend(o,l,m){const y=this.singleTap.touchend(o,l,m);if(y){const w=o.timeStamp-this.lastTime<500,E=!this.lastTap||this.lastTap.dist(y)<30;if(w&&E||this.reset(),this.count++,this.lastTime=o.timeStamp,this.lastTap=y,this.count===this.numTaps)return this.reset(),y}}}class Wh{constructor(){this._zoomIn=new vv({numTouches:1,numTaps:2}),this._zoomOut=new vv({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(o,l,m){this._zoomIn.touchstart(o,l,m),this._zoomOut.touchstart(o,l,m)}touchmove(o,l,m){this._zoomIn.touchmove(o,l,m),this._zoomOut.touchmove(o,l,m)}touchend(o,l,m){const y=this._zoomIn.touchend(o,l,m),w=this._zoomOut.touchend(o,l,m);return y?(this._active=!0,o.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:E=>E.easeTo({duration:300,zoom:E.getZoom()+1,around:E.unproject(y)},{originalEvent:o})}):w?(this._active=!0,o.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:E=>E.easeTo({duration:300,zoom:E.getZoom()-1,around:E.unproject(w)},{originalEvent:o})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const y0={0:1,2:2};class qh{constructor(o){this.reset(),this._clickTolerance=o.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(o,l){return!1}_move(o,l){return{}}mousedown(o,l){if(this._lastPoint)return;const m=le(o);this._correctButton(o,m)&&(this._lastPoint=l,this._eventButton=m)}mousemoveWindow(o,l){const m=this._lastPoint;if(m){if(o.preventDefault(),this._eventButton!=null&&function(y,w){const E=y0[w];return y.buttons===void 0||(y.buttons&E)!==E}(o,this._eventButton))this.reset();else if(this._moved||!(l.dist(m)<this._clickTolerance))return this._moved=!0,this._lastPoint=l,this._move(m,l)}}mouseupWindow(o){this._lastPoint&&le(o)===this._eventButton&&(this._moved&&se(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class kp extends qh{mousedown(o,l){super.mousedown(o,l),this._lastPoint&&(this._active=!0)}_correctButton(o,l){return l===0&&!o.ctrlKey}_move(o,l){return{around:l,panDelta:l.sub(o)}}}class cl extends qh{_correctButton(o,l){return l===0&&o.ctrlKey||l===2}_move(o,l){const m=.8*(l.x-o.x);if(m)return this._active=!0,{bearingDelta:m}}contextmenu(o){o.preventDefault()}}class Kh extends qh{_correctButton(o,l){return l===0&&o.ctrlKey||l===2}_move(o,l){const m=-.5*(l.y-o.y);if(m)return this._active=!0,{pitchDelta:m}}contextmenu(o){o.preventDefault()}}class ii{constructor(o,l){this._map=o,this._el=o.getCanvasContainer(),this._minTouches=1,this._clickTolerance=l.clickTolerance||1,this.reset(),r.aP(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new r.P(0,0)}touchstart(o,l,m){return this._calculateTransform(o,l,m)}touchmove(o,l,m){if(this._active&&!(m.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(m.length===1&&!r.dz())return void this._showTouchPanBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return o.cancelable&&o.preventDefault(),this._calculateTransform(o,l,m)}}touchend(o,l,m){this._calculateTransform(o,l,m),this._active&&m.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(o,l,m){m.length>0&&(this._active=!0);const y=Ap(m,l),w=new r.P(0,0),E=new r.P(0,0);let O=0;for(const H in y){const G=y[H],Z=this._touches[H];Z&&(w._add(G),E._add(G.sub(Z)),O++,y[H]=G)}if(this._touches=y,O<this._minTouches||!E.mag())return;const $=E.div(O);return this._sum._add($),this._sum.mag()<this._clickTolerance?void 0:{around:w.div(O),panDelta:$}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=N("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=window.setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.removeAttribute("role")},500)}}class xa{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(o){}_move(o,l,m){return{}}touchstart(o,l,m){this._firstTwoTouches||m.length<2||(this._firstTwoTouches=[m[0].identifier,m[1].identifier],this._start([l[0],l[1]]))}touchmove(o,l,m){const y=this._firstTwoTouches;if(!y)return;o.preventDefault();const[w,E]=y,O=pd(m,l,w),$=pd(m,l,E);if(!O||!$)return;const H=this._aroundCenter?null:O.add($).div(2);return this._move([O,$],H,o)}touchend(o,l,m){if(!this._firstTwoTouches)return;const[y,w]=this._firstTwoTouches,E=pd(m,l,y),O=pd(m,l,w);E&&O||(this._active&&se(),this.reset())}touchcancel(){this.reset()}enable(o){this._enabled=!0,this._aroundCenter=!!o&&o.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function pd(f,o,l){for(let m=0;m<f.length;m++)if(f[m].identifier===l)return o[m]}function Zh(f,o){return Math.log(f/o)/Math.LN2}class b0 extends xa{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(o){this._startDistance=this._distance=o[0].dist(o[1])}_move(o,l){const m=this._distance;if(this._distance=o[0].dist(o[1]),this._active||!(Math.abs(Zh(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Zh(this._distance,m),pinchAround:l}}}function x0(f,o){return 180*f.angleWith(o)/Math.PI}class Yh extends xa{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(o){this._startVector=this._vector=o[0].sub(o[1]),this._minDiameter=o[0].dist(o[1])}_move(o,l){const m=this._vector;if(this._vector=o[0].sub(o[1]),m&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:x0(this._vector,m),pinchAround:l}}_isBelowThreshold(o){this._minDiameter=Math.min(this._minDiameter,o.mag());const l=25/(Math.PI*this._minDiameter)*360,m=this._startVector;if(!m)return!1;const y=x0(o,m);return Math.abs(y)<l}}function _v(f){return Math.abs(f.y)>Math.abs(f.x)}class vw extends xa{constructor(o){super(),this._map=o}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(o){this._lastPoints=o,_v(o[0].sub(o[1]))&&(this._valid=!1)}_move(o,l,m){const y=this._lastPoints;if(!y)return;const w=o[0].sub(y[0]),E=o[1].sub(y[1]);return this._map._cooperativeGestures&&!r.dz()&&m.touches.length<3||(this._valid=this.gestureBeginsVertically(w,E,m.timeStamp),!this._valid)?void 0:(this._lastPoints=o,this._active=!0,{pitchDelta:(w.y+E.y)/2*-.5})}gestureBeginsVertically(o,l,m){if(this._valid!==void 0)return this._valid;const y=o.mag()>=2,w=l.mag()>=2;if(!y&&!w)return;if(!y||!w)return this._firstMove==null&&(this._firstMove=m),m-this._firstMove<100&&void 0;const E=o.y>0==l.y>0;return _v(o)&&_v(l)&&E}}const yv={panStep:100,bearingStep:15,pitchStep:10};class bv{constructor(){const o=yv;this._panStep=o.panStep,this._bearingStep=o.bearingStep,this._pitchStep=o.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(o){if(o.altKey||o.ctrlKey||o.metaKey)return;let l=0,m=0,y=0,w=0,E=0;switch(o.keyCode){case 61:case 107:case 171:case 187:l=1;break;case 189:case 109:case 173:l=-1;break;case 37:o.shiftKey?m=-1:(o.preventDefault(),w=-1);break;case 39:o.shiftKey?m=1:(o.preventDefault(),w=1);break;case 38:o.shiftKey?y=1:(o.preventDefault(),E=-1);break;case 40:o.shiftKey?y=-1:(o.preventDefault(),E=1);break;default:return}return this._rotationDisabled&&(m=0,y=0),{cameraAnimation:O=>{const $=O.getZoom();O.easeTo({duration:300,easeId:"keyboardHandler",easing:gu,zoom:l?Math.round($)+l*(o.shiftKey?2:1):$,bearing:O.getBearing()+m*this._bearingStep,pitch:O.getPitch()+y*this._pitchStep,offset:[-w*this._panStep,-E*this._panStep],center:O.getCenter()},{originalEvent:o})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function gu(f){return f*(2-f)}const vu=4.000244140625,$l=1/450;class Fa{constructor(o,l){this._map=o,this._el=o.getCanvasContainer(),this._handler=l,this._delta=0,this._lastDelta=0,this._defaultZoomRate=.01,this._wheelZoomRate=$l,r.aP(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(o){this._defaultZoomRate=o}setWheelZoomRate(o){this._wheelZoomRate=o}isEnabled(){return!!this._enabled}isActive(){return this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(o){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!o&&o.around==="center",this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(o){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(o.ctrlKey||o.metaKey||this.isZooming()||r.dz()))return void this._showBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let l=o.deltaMode===WheelEvent.DOM_DELTA_LINE?40*o.deltaY:o.deltaY;const m=r.q.now(),y=m-(this._lastWheelEventTime||0);this._lastWheelEventTime=m,l!==0&&l%vu==0?this._type="wheel":l!==0&&Math.abs(l)<4?this._type="trackpad":y>400?(this._type=null,this._lastValue=l,this._timeout=window.setTimeout(this._onTimeout,40,o)):this._type||(this._type=Math.abs(y*l)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,l+=this._lastValue)),o.shiftKey&&l&&(l/=4),this._type&&(this._lastWheelEvent=o,this._delta-=l,this._active||this._start(o)),o.preventDefault()}_onTimeout(o){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(o)}_start(o){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const l=fe(this._el,o);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:l,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const o=this._map.transform;this._type==="wheel"&&o.projection.wrap&&(o._center.lng>=180||o._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);const l=()=>o._terrainEnabled()&&this._aroundCoord?o.computeZoomRelativeTo(this._aroundCoord):o.zoom;if(this._delta!==0){const H=this._type==="wheel"&&Math.abs(this._delta)>vu?this._wheelZoomRate:this._defaultZoomRate;let G=2/(1+Math.exp(-Math.abs(this._delta*H)));this._delta<0&&G!==0&&(G=1/G);const Z=l(),X=Math.pow(2,Z),oe=typeof this._targetZoom=="number"?o.zoomScale(this._targetZoom):X;this._targetZoom=Math.min(o.maxZoom,Math.max(o.minZoom,o.scaleZoom(oe*G))),this._type==="wheel"&&(this._startZoom=Z,this._easing=this._smoothOutEasing(200)),this._lastDelta=this._delta,this._delta=0}const m=typeof this._targetZoom=="number"?this._targetZoom:l(),y=this._startZoom,w=this._easing;let E,O=!1;if(this._type==="wheel"&&y&&w){const H=Math.min((r.q.now()-this._lastWheelEventTime)/200,1),G=w(H);E=r.af(y,m,G),H<1?this._frameId||(this._frameId=!0):O=!0}else E=m,O=!0;this._active=!0,O&&(this._active=!1,this._finishTimeout=window.setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200));let $=E-l();return $*this._lastDelta<0&&($=0),{noInertia:!0,needsRenderFrame:!O,zoomDelta:$,around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(o){let l=r.dA;if(this._prevEase){const m=this._prevEase,y=(r.q.now()-m.start)/m.duration,w=m.easing(y+.01)-m.easing(y),E=.27/Math.sqrt(w*w+1e-4)*.01,O=Math.sqrt(.0729-E*E);l=r.dy(E,O,.25,1)}return this._prevEase={start:r.q.now(),duration:o,easing:l},l}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=N("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=window.setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.removeAttribute("role")},200)}}class Ac{constructor(o,l){this._clickZoom=o,this._tapZoom=l}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class _u{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(o,l){return o.preventDefault(),{cameraAnimation:m=>{m.easeTo({duration:300,zoom:m.getZoom()+(o.shiftKey?-1:1),around:m.unproject(l)},{originalEvent:o})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class kc{constructor(){this._tap=new vv({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(o,l,m){this._swipePoint||(this._tapTime&&o.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?m.length>0&&(this._swipePoint=l[0],this._swipeTouch=m[0].identifier):this._tap.touchstart(o,l,m))}touchmove(o,l,m){if(this._tapTime){if(this._swipePoint){if(m[0].identifier!==this._swipeTouch)return;const y=l[0],w=y.y-this._swipePoint.y;return this._swipePoint=y,o.preventDefault(),this._active=!0,{zoomDelta:w/128}}}else this._tap.touchmove(o,l,m)}touchend(o,l,m){this._tapTime?this._swipePoint&&m.length===0&&this.reset():this._tap.touchend(o,l,m)&&(this._tapTime=o.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class _w{constructor(o,l,m){this._el=o,this._mousePan=l,this._touchPan=m}enable(o){this._inertiaOptions=o||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class yw{constructor(o,l,m){this._pitchWithRotate=o.pitchWithRotate,this._mouseRotate=l,this._mousePitch=m}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class bw{constructor(o,l,m,y){this._el=o,this._touchZoom=l,this._touchRotate=m,this._tapDragZoom=y,this._rotationDisabled=!1,this._enabled=!0}enable(o){this._touchZoom.enable(o),this._rotationDisabled||this._touchRotate.enable(o),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const Pp=f=>f.zoom||f.drag||f.pitch||f.rotate;class w0 extends r.z{}class hs{constructor(){this.constants=[1,1,.01],this.radius=0}setup(o,l){const m=r.ab.vec3.sub([],l,o);this.radius=r.ab.vec3.length(m[2]<0?r.ab.vec3.div([],m,this.constants):[m[0],m[1],0])}projectRay(o){r.ab.vec3.div(o,o,this.constants),r.ab.vec3.normalize(o,o),r.ab.vec3.mul(o,o,this.constants);const l=r.ab.vec3.scale([],o,this.radius);if(l[2]>0){const m=r.ab.vec3.scale([],[0,0,1],r.ab.vec3.dot(l,[0,0,1])),y=r.ab.vec3.scale([],r.ab.vec3.normalize([],[l[0],l[1],0]),this.radius),w=r.ab.vec3.add([],l,r.ab.vec3.scale([],r.ab.vec3.sub([],r.ab.vec3.add([],y,m),l),2));l[0]=w[0],l[1]=w[1]}return l}}function md(f){return f.panDelta&&f.panDelta.mag()||f.zoomDelta||f.bearingDelta||f.pitchDelta}class S0{constructor(o,l){this._map=o,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new v0(o),this._bearingSnap=l.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new hs,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(l),r.aP(["handleEvent","handleWindowEvent"],this);const m=this._el;this._listeners=[[m,"touchstart",{passive:!0}],[m,"touchmove",{passive:!1}],[m,"touchend",void 0],[m,"touchcancel",void 0],[m,"mousedown",void 0],[m,"mousemove",void 0],[m,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[m,"mouseover",void 0],[m,"mouseout",void 0],[m,"dblclick",void 0],[m,"click",void 0],[m,"keydown",{capture:!1}],[m,"keyup",void 0],[m,"wheel",{passive:!1}],[m,"contextmenu",void 0],[window,"blur",void 0]];for(const[y,w,E]of this._listeners){const O=y===document?this.handleWindowEvent:this.handleEvent;y.addEventListener(w,O,E)}}destroy(){for(const[o,l,m]of this._listeners){const y=o===document?this.handleWindowEvent:this.handleEvent;o.removeEventListener(l,y,m)}}_addDefaultHandlers(o){const l=this._map,m=l.getCanvasContainer();this._add("mapEvent",new pw(l,o));const y=l.boxZoom=new ei(l,o);this._add("boxZoom",y);const w=new Wh,E=new _u;l.doubleClickZoom=new Ac(E,w),this._add("tapZoom",w),this._add("clickZoom",E);const O=new kc;this._add("tapDragZoom",O);const $=l.touchPitch=new vw(l);this._add("touchPitch",$);const H=new cl(o),G=new Kh(o);l.dragRotate=new yw(o,H,G),this._add("mouseRotate",H,["mousePitch"]),this._add("mousePitch",G,["mouseRotate"]);const Z=new kp(o),X=new ii(l,o);l.dragPan=new _w(m,Z,X),this._add("mousePan",Z),this._add("touchPan",X,["touchZoom","touchRotate"]);const oe=new Yh,xe=new b0;l.touchZoomRotate=new bw(m,xe,oe,O),this._add("touchRotate",oe,["touchPan","touchZoom"]),this._add("touchZoom",xe,["touchPan","touchRotate"]),this._add("blockableMapEvent",new mw(l));const ve=l.scrollZoom=new Fa(l,this);this._add("scrollZoom",ve,["mousePan"]);const Ce=l.keyboard=new bv;this._add("keyboard",Ce);for(const Te of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])o.interactive&&o[Te]&&l[Te].enable(o[Te])}_add(o,l,m){this._handlers.push({handlerName:o,handler:l,allowed:m}),this._handlersById[o]=l}stop(o){if(!this._updatingCamera){for(const{handler:l}of this._handlers)l.reset();this._inertia.clear(),this._fireEvents({},{},o),this._changes=[],this._originalZoom=void 0}}isActive(){for(const{handler:o}of this._handlers)if(o.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Pp(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(o,l,m){for(const y in o)if(y!==m&&(!l||l.indexOf(y)<0))return!0;return!1}handleWindowEvent(o){this.handleEvent(o,`${o.type}Window`)}_getMapTouches(o){const l=[];for(const m of o)this._el.contains(m.target)&&l.push(m);return l}handleEvent(o,l){this._updatingCamera=!0;const m=o.type==="renderFrame",y=m?void 0:o,w={needsRenderFrame:!1},E={},O={},$=o.touches?this._getMapTouches(o.touches):void 0,H=$?ce(this._el,$):m?void 0:fe(this._el,o);for(const{handlerName:X,handler:oe,allowed:xe}of this._handlers){if(!oe.isEnabled())continue;let ve;this._blockedByActive(O,xe,X)?oe.reset():oe[l||o.type]&&(ve=oe[l||o.type](o,H,$),this.mergeHandlerResult(w,E,ve,X,y),ve&&ve.needsRenderFrame&&this._triggerRenderFrame()),(ve||oe.isActive())&&(O[X]=oe)}const G={};for(const X in this._previousActiveHandlers)O[X]||(G[X]=y);this._previousActiveHandlers=O,(Object.keys(G).length||md(w))&&(this._changes.push([w,E,G]),this._triggerRenderFrame()),(Object.keys(O).length||md(w))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:Z}=w;Z&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],Z(this._map))}mergeHandlerResult(o,l,m,y,w){if(!m)return;r.l(o,m);const E={handlerName:y,originalEvent:m.originalEvent||w};m.zoomDelta!==void 0&&(l.zoom=E),m.panDelta!==void 0&&(l.drag=E),m.pitchDelta!==void 0&&(l.pitch=E),m.bearingDelta!==void 0&&(l.rotate=E)}_applyChanges(){const o={},l={},m={};for(const[y,w,E]of this._changes)y.panDelta&&(o.panDelta=(o.panDelta||new r.P(0,0))._add(y.panDelta)),y.zoomDelta&&(o.zoomDelta=(o.zoomDelta||0)+y.zoomDelta),y.bearingDelta&&(o.bearingDelta=(o.bearingDelta||0)+y.bearingDelta),y.pitchDelta&&(o.pitchDelta=(o.pitchDelta||0)+y.pitchDelta),y.around!==void 0&&(o.around=y.around),y.aroundCoord!==void 0&&(o.aroundCoord=y.aroundCoord),y.pinchAround!==void 0&&(o.pinchAround=y.pinchAround),y.noInertia&&(o.noInertia=y.noInertia),r.l(l,w),r.l(m,E);this._updateMapTransform(o,l,m),this._changes=[]}_updateMapTransform(o,l,m){const y=this._map,w=y.transform,E=Le=>[Le.x,Le.y,Le.z];if((Le=>{const Ge=this._eventsInProgress.drag;return Ge&&!this._handlersById[Ge.handlerName].isActive()})()&&!md(o)){const Le=w.zoom;w.cameraElevationReference="sea",this._originalZoom!=null&&w._orthographicProjectionAtLowPitch&&w.projection.name!=="globe"&&w.pitch===0?(w.cameraElevationReference="ground",w.zoom=this._originalZoom):(w.recenterOnTerrain(),w.cameraElevationReference="ground"),Le!==w.zoom&&this._map._update(!0)}if(w._isCameraConstrained&&y._stop(!0),!md(o))return void this._fireEvents(l,m,!0);let{panDelta:O,zoomDelta:$,bearingDelta:H,pitchDelta:G,around:Z,aroundCoord:X,pinchAround:oe}=o;w._isCameraConstrained&&($>0&&($=0),w._isCameraConstrained=!1),oe!==void 0&&(Z=oe),($||(Le=>l[Le]&&!this._eventsInProgress[Le])("drag"))&&Z&&(this._dragOrigin=E(w.pointCoordinate3D(Z)),this._originalZoom=w.zoom,this._trackingEllipsoid.setup(w._camera.position,this._dragOrigin)),w.cameraElevationReference="sea",y._stop(!0),Z=Z||y.transform.centerPoint,H&&(w.bearing+=H),G&&(w.pitch+=G),w._updateCameraState();const xe=[0,0,0];if(O)if(w.projection.name==="mercator"){const Le=this._trackingEllipsoid.projectRay(w.screenPointToMercatorRay(Z).dir),Ge=this._trackingEllipsoid.projectRay(w.screenPointToMercatorRay(Z.sub(O)).dir);xe[0]=Ge[0]-Le[0],xe[1]=Ge[1]-Le[1]}else{const Le=w.pointCoordinate(Z);if(w.projection.name==="globe"){O=O.rotate(-w.angle);const Ge=w._pixelsPerMercatorPixel/w.worldSize;xe[0]=-O.x*r.dB(r.aS(Le.y))*Ge,xe[1]=-O.y*r.dB(w.center.lat)*Ge}else{const Ge=w.pointCoordinate(Z.sub(O));Le&&Ge&&(xe[0]=Ge.x-Le.x,xe[1]=Ge.y-Le.y)}}const ve=w.zoom,Ce=[0,0,0];if($){const Le=E(X||w.pointCoordinate3D(Z)),Ge={dir:r.ab.vec3.normalize([],r.ab.vec3.sub([],Le,w._camera.position))};if(Ge.dir[2]<0){const He=w.zoomDeltaToMovement(Le,$);r.ab.vec3.scale(Ce,Ge.dir,He)}}const Te=r.ab.vec3.add(xe,xe,Ce);w._translateCameraConstrained(Te),$&&Math.abs(w.zoom-ve)>1e-4&&w.recenterOnTerrain(),w.cameraElevationReference="ground",this._map._update(),o.noInertia||this._inertia.record(o),this._fireEvents(l,m,!0)}_fireEvents(o,l,m){const y=Pp(this._eventsInProgress),w=Pp(o),E={};for(const G in o){const{originalEvent:Z}=o[G];this._eventsInProgress[G]||(E[`${G}start`]=Z),this._eventsInProgress[G]=o[G]}!y&&w&&this._fireEvent("movestart",w.originalEvent);for(const G in E)this._fireEvent(G,E[G]);w&&this._fireEvent("move",w.originalEvent);for(const G in o){const{originalEvent:Z}=o[G];this._fireEvent(G,Z)}const O={};let $;for(const G in this._eventsInProgress){const{handlerName:Z,originalEvent:X}=this._eventsInProgress[G];this._handlersById[Z].isActive()||(delete this._eventsInProgress[G],$=l[Z]||X,O[`${G}end`]=$)}for(const G in O)this._fireEvent(G,O[G]);const H=Pp(this._eventsInProgress);if(m&&(y||w)&&!H){this._updatingCamera=!0;const G=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),Z=X=>X!==0&&-this._bearingSnap<X&&X<this._bearingSnap;G?(Z(G.bearing||this._map.getBearing())&&(G.bearing=0),this._map.easeTo(G,{originalEvent:$})):(this._map.fire(new r.z("moveend",{originalEvent:$})),Z(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(o,l){this._map.fire(new r.z(o,l?{originalEvent:l}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(o=>{this._frameId=void 0,this.handleEvent(new w0("renderFrame",{timeStamp:o})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}const T0="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class gd extends r.E{constructor(o,l){super(),this._moving=!1,this._zooming=!1,this.transform=o,this._bearingSnap=l.bearingSnap,this._respectPrefersReducedMotion=l.respectPrefersReducedMotion!==!1,r.aP(["_renderFrameCallback"],this)}getCenter(){return new r.bO(this.transform.center.lng,this.transform.center.lat)}setCenter(o,l){return this.jumpTo({center:o},l)}panBy(o,l,m){return o=r.P.convert(o).mult(-1),this.panTo(this.transform.center,r.l({offset:o},l),m)}panTo(o,l,m){return this.easeTo(r.l({center:o},l),m)}getZoom(){return this.transform.zoom}setZoom(o,l){return this.jumpTo({zoom:o},l),this}zoomTo(o,l,m){return this.easeTo(r.l({zoom:o},l),m)}zoomIn(o,l){return this.zoomTo(this.getZoom()+1,o,l),this}zoomOut(o,l){return this.zoomTo(this.getZoom()-1,o,l),this}getBearing(){return this.transform.bearing}setBearing(o,l){return this.jumpTo({bearing:o},l),this}getPadding(){return this.transform.padding}setPadding(o,l){return this.jumpTo({padding:o},l),this}rotateTo(o,l,m){return this.easeTo(r.l({bearing:o},l),m)}resetNorth(o,l){return this.rotateTo(0,r.l({duration:1e3},o),l),this}resetNorthPitch(o,l){return this.easeTo(r.l({bearing:0,pitch:0,duration:1e3},o),l),this}snapToNorth(o,l){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(o,l):this}getPitch(){return this.transform.pitch}setPitch(o,l){return this.jumpTo({pitch:o},l),this}cameraForBounds(o,l){o=r.az.convert(o);const m=l&&l.bearing||0,y=l&&l.pitch||0,w=o.getNorthWest(),E=o.getSouthEast();return this._cameraForBounds(this.transform,w,E,m,y,l)}_extendPadding(o){const l={top:0,right:0,bottom:0,left:0};return o==null?r.l({},l,this.transform.padding):typeof o=="number"?{top:o,bottom:o,right:o,left:o}:r.l({},l,o)}_extendCameraOptions(o){return(o=r.l({offset:[0,0],maxZoom:this.transform.maxZoom},o)).padding=this._extendPadding(o.padding),o}_minimumAABBFrustumDistance(o,l){const m=l.max[0]-l.min[0],y=l.max[1]-l.min[1];return m/y>o.aspect?m/(2*Math.tan(.5*o.fovX)*o.aspect):y/(2*Math.tan(.5*o.fovY)*o.aspect)}_cameraForBoundsOnGlobe(o,l,m,y,w,E){const O=o.clone(),$=this._extendCameraOptions(E);O.bearing=y,O.pitch=w;const H=r.bO.convert(l),G=r.bO.convert(m),Z=.5*(H.lat+G.lat),X=.5*(H.lng+G.lng),oe=r.dC(Z,X),xe=r.ab.vec3.normalize([],oe),ve=r.ab.vec3.normalize([],r.ab.vec3.cross([],xe,[0,1,0])),Ce=r.ab.vec3.cross([],ve,xe),Te=[ve[0],ve[1],ve[2],0,Ce[0],Ce[1],Ce[2],0,xe[0],xe[1],xe[2],0,0,0,0,1],Le=[oe,r.dC(H.lat,H.lng),r.dC(G.lat,H.lng),r.dC(G.lat,G.lng),r.dC(H.lat,G.lng),r.dC(Z,H.lng),r.dC(Z,G.lng),r.dC(H.lat,X),r.dC(G.lat,X)];let Ge=r.cd.fromPoints(Le.map(Ht=>[r.ab.vec3.dot(ve,Ht),r.ab.vec3.dot(Ce,Ht),r.ab.vec3.dot(xe,Ht)]));const He=r.ab.vec3.transformMat4([],Ge.center,Te);r.ab.vec3.squaredLength(He)===0&&r.ab.vec3.set(He,0,0,1),r.ab.vec3.normalize(He,He),r.ab.vec3.scale(He,He,r.ax),O.center=r.dD(He);const rt=O.getWorldToCameraMatrix(),Xe=r.ab.mat4.invert(new Float64Array(16),rt);Ge=r.cd.applyTransform(Ge,r.ab.mat4.multiply([],rt,Te));const et=this._extendAABB(Ge,O,$,y);if(!et)return void r.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");Ge=et,r.ab.vec3.transformMat4(He,He,rt);const Ye=.5*(Ge.max[2]-Ge.min[2]),at=this._minimumAABBFrustumDistance(O,Ge),gt=r.ab.vec3.scale([],[0,0,1],Ye),Vt=r.ab.vec3.add(gt,He,gt),Rt=at+(O.pitch===0?0:r.ab.vec3.distance(He,Vt)),tn=O.globeCenterInViewSpace,Jt=r.ab.vec3.sub([],He,[tn[0],tn[1],tn[2]]);r.ab.vec3.normalize(Jt,Jt),r.ab.vec3.scale(Jt,Jt,Rt);const Et=r.ab.vec3.add([],He,Jt);r.ab.vec3.transformMat4(Et,Et,Xe);const jt=r.ds/r.ax,gn=r.ab.vec3.length(Et),Tt=r.bH(Math.max(gn*jt-r.ds,Number.EPSILON),0),rn=Math.min(O.zoomFromMercatorZAdjusted(Tt),$.maxZoom);return rn>.5*(r.c6+r.bY)?(O.setProjection({name:"mercator"}),O.zoom=rn,this._cameraForBounds(O,l,m,y,w,E)):{center:O.center,zoom:rn,bearing:y,pitch:w}}_extendAABB(o,l,m,y){const w=.5*((m.padding.left||0)+(m.padding.right||0)),E=.5*((m.padding.top||0)+(m.padding.bottom||0)),O=E,$=w,H=w,G=E,Z=l.width-($+H),X=l.height-(O+G),oe=r.ab.vec3.sub([],o.max,o.min),xe=Math.min(Z/oe[0],X/oe[1]),ve=Math.min(l.scaleZoom(l.scale*xe),m.maxZoom);if(isNaN(ve))return null;const Ce=l.scale/l.zoomScale(ve),Te=new r.cd([o.min[0]-$*Ce,o.min[1]-G*Ce,o.min[2]],[o.max[0]+H*Ce,o.max[1]+O*Ce,o.max[2]]),Le=(typeof m.offset.x=="number"&&typeof m.offset.y=="number"?new r.P(m.offset.x,m.offset.y):r.P.convert(m.offset)).rotate(-r.ai(y));return Te.center[0]-=Le.x*Ce,Te.center[1]+=Le.y*Ce,Te}queryTerrainElevation(o,l){const m=this.transform.elevation;return m?(l=r.l({},{exaggerated:!0},l),m.getAtPoint(r.aa.fromLngLat(o),null,l.exaggerated)):null}_cameraForBounds(o,l,m,y,w,E){if(o.projection.name==="globe")return this._cameraForBoundsOnGlobe(o,l,m,y,w,E);const O=o.clone(),$=this._extendCameraOptions(E);O.bearing=y,O.pitch=w;const H=r.bO.convert(l),G=r.bO.convert(m),Z=new r.bO(H.lng,G.lat),X=new r.bO(G.lng,H.lat),oe=O.project(H),xe=O.project(G),ve=this.queryTerrainElevation(H),Ce=this.queryTerrainElevation(G),Te=this.queryTerrainElevation(Z),Le=this.queryTerrainElevation(X),Ge=[[oe.x,oe.y,Math.min(ve||0,Ce||0,Te||0,Le||0)],[xe.x,xe.y,Math.max(ve||0,Ce||0,Te||0,Le||0)]];let He=r.cd.fromPoints(Ge);const rt=O.getWorldToCameraMatrix(),Xe=r.ab.mat4.invert(new Float64Array(16),rt);He=r.cd.applyTransform(He,rt);const et=this._extendAABB(He,O,$,y);if(!et)return void r.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");He=et;const Ye=.5*r.ab.vec3.sub([],He.max,He.min)[2],at=this._minimumAABBFrustumDistance(O,He),gt=[0,0,1,0];r.ab.vec4.transformMat4(gt,gt,rt),r.ab.vec4.normalize(gt,gt);const Vt=r.ab.vec3.scale([],gt,at+Ye),Rt=r.ab.vec3.add([],He.center,Vt);r.ab.vec3.transformMat4(He.center,He.center,Xe),r.ab.vec3.transformMat4(Rt,Rt,Xe);const tn=O.unproject(new r.P(He.center[0],He.center[1])),Jt=r.dE(O.projection,tn),Et=Math.pow(2,Jt),jt=Math.min(O._zoomFromMercatorZ(Rt[2]*O.pixelsPerMeter*Et/O.worldSize),$.maxZoom);return O.mercatorFromTransition&&jt<.5*(r.c6+r.bY)?(O.setProjection({name:"globe"}),O.zoom=jt,this._cameraForBounds(O,l,m,y,w,E)):{center:tn,zoom:jt,bearing:y,pitch:w}}fitBounds(o,l,m){const y=this.cameraForBounds(o,l);return this._fitInternal(y,l,m)}fitScreenCoordinates(o,l,m,y,w){const E=r.P.convert(o),O=r.P.convert(l),$=new r.P(Math.min(E.x,O.x),Math.min(E.y,O.y)),H=new r.P(Math.max(E.x,O.x),Math.max(E.y,O.y));if(this.transform.projection.name==="mercator"&&this.transform.anyCornerOffEdge(E,O))return this;const G=this.transform.pointLocation3D($),Z=this.transform.pointLocation3D(H),X=this.transform.pointLocation3D(new r.P($.x,H.y)),oe=this.transform.pointLocation3D(new r.P(H.x,$.y)),xe=[Math.min(G.lng,Z.lng,X.lng,oe.lng),Math.min(G.lat,Z.lat,X.lat,oe.lat)],ve=[Math.max(G.lng,Z.lng,X.lng,oe.lng),Math.max(G.lat,Z.lat,X.lat,oe.lat)],Ce=y&&y.pitch?y.pitch:this.getPitch(),Te=this._cameraForBounds(this.transform,xe,ve,m,Ce,y);return this._fitInternal(Te,y,w)}_fitInternal(o,l,m){return o?(l=r.l(o,l)).linear?this.easeTo(l,m):this.flyTo(l,m):this}jumpTo(o,l){this.stop();const m=o.preloadOnly?this.transform.clone():this.transform;let y=!1,w=!1,E=!1;"zoom"in o&&m.zoom!==+o.zoom&&(y=!0,m.zoom=+o.zoom),o.center!==void 0&&(m.center=r.bO.convert(o.center)),"bearing"in o&&m.bearing!==+o.bearing&&(w=!0,m.bearing=+o.bearing),"pitch"in o&&m.pitch!==+o.pitch&&(E=!0,m.pitch=+o.pitch);const O=typeof o.padding=="number"?this._extendPadding(o.padding):o.padding;if(o.padding!=null&&!m.isPaddingEqual(O))if(o.retainPadding===!1){const $=m.clone();$.padding=O,m.setLocationAtPoint(m.center,$.centerPoint)}else m.padding=O;return o.preloadOnly?(this._preloadTiles(m),this):(this.fire(new r.z("movestart",l)).fire(new r.z("move",l)),y&&this.fire(new r.z("zoomstart",l)).fire(new r.z("zoom",l)).fire(new r.z("zoomend",l)),w&&this.fire(new r.z("rotatestart",l)).fire(new r.z("rotate",l)).fire(new r.z("rotateend",l)),E&&this.fire(new r.z("pitchstart",l)).fire(new r.z("pitch",l)).fire(new r.z("pitchend",l)),this.fire(new r.z("moveend",l)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||r.w(T0),this.transform.getFreeCameraOptions()}setFreeCameraOptions(o,l){const m=this.transform;if(!m.projection.supportsFreeCamera)return r.w(T0),this;this.stop();const y=m.zoom,w=m.pitch,E=m.bearing;m.setFreeCameraOptions(o);const O=y!==m.zoom,$=w!==m.pitch,H=E!==m.bearing;return this.fire(new r.z("movestart",l)).fire(new r.z("move",l)),O&&this.fire(new r.z("zoomstart",l)).fire(new r.z("zoom",l)).fire(new r.z("zoomend",l)),H&&this.fire(new r.z("rotatestart",l)).fire(new r.z("rotate",l)).fire(new r.z("rotateend",l)),$&&this.fire(new r.z("pitchstart",l)).fire(new r.z("pitch",l)).fire(new r.z("pitchend",l)),this.fire(new r.z("moveend",l)),this}easeTo(o,l){this._stop(!1,o.easeId),((o=r.l({offset:[0,0],duration:500,easing:r.dA},o)).animate===!1||this._prefersReducedMotion(o))&&(o.duration=0);const m=this.transform,y=this.getZoom(),w=this.getBearing(),E=this.getPitch(),O=this.getPadding(),$="zoom"in o?+o.zoom:y,H="bearing"in o?this._normalizeBearing(o.bearing,w):w,G="pitch"in o?+o.pitch:E,Z=this._extendPadding(o.padding),X=r.P.convert(o.offset);let oe,xe,ve;if(m.projection.name==="globe"){const gt=r.aa.fromLngLat(m.center),Vt=X.rotate(-m.angle);gt.x+=Vt.x/m.worldSize,gt.y+=Vt.y/m.worldSize;const Rt=gt.toLngLat(),tn=r.bO.convert(o.center||Rt);this._normalizeCenter(tn),oe=m.centerPoint.add(Vt),xe=new r.P(gt.x,gt.y).mult(m.worldSize),ve=new r.P(r.at(tn.lng),r.aA(tn.lat)).mult(m.worldSize).sub(xe)}else{oe=m.centerPoint.add(X);const gt=m.pointLocation(oe),Vt=r.bO.convert(o.center||gt);this._normalizeCenter(Vt),xe=m.project(gt),ve=m.project(Vt).sub(xe)}const Ce=m.zoomScale($-y);let Te,Le;o.around&&(Te=r.bO.convert(o.around),Le=m.locationPoint(Te));const Ge=this._zooming||$!==y,He=this._rotating||w!==H,rt=this._pitching||G!==E,Xe=!m.isPaddingEqual(Z),et=o.retainPadding===!1?m.clone():m,Ye=gt=>Vt=>{if(Ge&&(gt.zoom=r.af(y,$,Vt)),He&&(gt.bearing=r.af(w,H,Vt)),rt&&(gt.pitch=r.af(E,G,Vt)),Xe&&(et.interpolatePadding(O,Z,Vt),oe=et.centerPoint.add(X)),Te)gt.setLocationAtPoint(Te,Le);else{const Rt=gt.zoomScale(gt.zoom-y),tn=$>y?Math.min(2,Ce):Math.max(.5,Ce),Jt=Math.pow(tn,1-Vt),Et=gt.unproject(xe.add(ve.mult(Vt*Jt)).mult(Rt));gt.setLocationAtPoint(gt.renderWorldCopies?Et.wrap():Et,oe)}return o.preloadOnly||this._fireMoveEvents(l),gt};if(o.preloadOnly){const gt=this._emulate(Ye,o.duration,m);return this._preloadTiles(gt),this}const at={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=Ge,this._rotating=He,this._pitching=rt,this._padding=Xe,this._easeId=o.easeId,this._prepareEase(l,o.noMoveStart,at),this._ease(Ye(m),gt=>{m.cameraElevationReference==="sea"&&m.recenterOnTerrain(),this._afterEase(l,gt)},o),this}_prepareEase(o,l,m={}){this._moving=!0,this.transform.cameraElevationReference="sea",this.transform._orthographicProjectionAtLowPitch&&this.transform.pitch===0&&this.transform.projection.name!=="globe"&&(this.transform.cameraElevationReference="ground"),l||m.moving||this.fire(new r.z("movestart",o)),this._zooming&&!m.zooming&&this.fire(new r.z("zoomstart",o)),this._rotating&&!m.rotating&&this.fire(new r.z("rotatestart",o)),this._pitching&&!m.pitching&&this.fire(new r.z("pitchstart",o))}_fireMoveEvents(o){this.fire(new r.z("move",o)),this._zooming&&this.fire(new r.z("zoom",o)),this._rotating&&this.fire(new r.z("rotate",o)),this._pitching&&this.fire(new r.z("pitch",o))}_afterEase(o,l){if(this._easeId&&l&&this._easeId===l)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const m=this._zooming,y=this._rotating,w=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,m&&this.fire(new r.z("zoomend",o)),y&&this.fire(new r.z("rotateend",o)),w&&this.fire(new r.z("pitchend",o)),this.fire(new r.z("moveend",o))}flyTo(o,l){if(this._prefersReducedMotion(o)){const Ht=r.ay(o,["center","zoom","bearing","pitch","around","padding","retainPadding"]);return this.jumpTo(Ht,l)}this.stop(),o=r.l({offset:[0,0],speed:1.2,curve:1.42,easing:r.dA},o);const m=this.transform,y=this.getZoom(),w=this.getBearing(),E=this.getPitch(),O=this.getPadding(),$="zoom"in o?r.aw(+o.zoom,m.minZoom,m.maxZoom):y,H="bearing"in o?this._normalizeBearing(o.bearing,w):w,G="pitch"in o?+o.pitch:E,Z=this._extendPadding(o.padding),X=m.zoomScale($-y),oe=r.P.convert(o.offset);let xe=m.centerPoint.add(oe);const ve=m.pointLocation(xe),Ce=r.bO.convert(o.center||ve);this._normalizeCenter(Ce);const Te=m.project(ve),Le=m.project(Ce).sub(Te);let Ge=o.curve;const He=Math.max(m.width,m.height),rt=He/X,Xe=Le.mag();if("minZoom"in o){const Ht=r.aw(Math.min(o.minZoom,y,$),m.minZoom,m.maxZoom),Cn=He/m.zoomScale(Ht-y);Ge=Math.sqrt(Cn/Xe*2)}const et=Ge*Ge;function Ye(Ht){const Cn=(rt*rt-He*He+(Ht?-1:1)*et*et*Xe*Xe)/(2*(Ht?rt:He)*et*Xe);return Math.log(Math.sqrt(Cn*Cn+1)-Cn)}function at(Ht){return(Math.exp(Ht)-Math.exp(-Ht))/2}function gt(Ht){return(Math.exp(Ht)+Math.exp(-Ht))/2}const Vt=Ye(0);let Rt=function(Ht){return gt(Vt)/gt(Vt+Ge*Ht)},tn=function(Ht){return He*((gt(Vt)*(at(Cn=Vt+Ge*Ht)/gt(Cn))-at(Vt))/et)/Xe;var Cn},Jt=(Ye(1)-Vt)/Ge;if(Math.abs(Xe)<1e-6||!isFinite(Jt)){if(Math.abs(He-rt)<1e-6)return this.easeTo(o,l);const Ht=rt<He?-1:1;Jt=Math.abs(Math.log(rt/He))/Ge,tn=function(){return 0},Rt=function(Cn){return Math.exp(Ht*Ge*Cn)}}o.duration="duration"in o?+o.duration:1e3*Jt/("screenSpeed"in o?+o.screenSpeed/Ge:+o.speed),o.maxDuration&&o.duration>o.maxDuration&&(o.duration=0);const Et=w!==H,jt=G!==E,gn=!m.isPaddingEqual(Z),Tt=o.retainPadding===!1?m.clone():m,rn=Ht=>Cn=>{const dn=Cn*Jt,nn=1/Rt(dn);Ht.zoom=Cn===1?$:y+Ht.scaleZoom(nn),Et&&(Ht.bearing=r.af(w,H,Cn)),jt&&(Ht.pitch=r.af(E,G,Cn)),gn&&(Tt.interpolatePadding(O,Z,Cn),xe=Tt.centerPoint.add(oe));const vn=Cn===1?Ce:Ht.unproject(Te.add(Le.mult(tn(dn))).mult(nn));return Ht.setLocationAtPoint(Ht.renderWorldCopies?vn.wrap():vn,xe),Ht._updateCameraOnTerrain(),o.preloadOnly||this._fireMoveEvents(l),Ht};if(o.preloadOnly){const Ht=this._emulate(rn,o.duration,m);return this._preloadTiles(Ht),this}return this._zooming=!0,this._rotating=Et,this._pitching=jt,this._padding=gn,this._prepareEase(l,!1),this._ease(rn(m),()=>this._afterEase(l),o),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_requestRenderFrame(o){}_cancelRenderFrame(o){}_stop(o,l){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const m=this._onEaseEnd;this._onEaseEnd=void 0,m.call(this,l)}if(!o){const m=this.handlers;m&&m.stop(!1)}return this}_ease(o,l,m){m.animate===!1||m.duration===0?(o(1),l()):(this._easeStart=r.q.now(),this._easeOptions=m,this._onEaseFrame=o,this._onEaseEnd=l,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const o=Math.min((r.q.now()-this._easeStart)/this._easeOptions.duration,1),l=this._onEaseFrame;l&&l(this._easeOptions.easing(o)),o<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(o,l){o=r.bF(o,-180,180);const m=Math.abs(o-l);return Math.abs(o-360-l)<m&&(o-=360),Math.abs(o+360-l)<m&&(o+=360),o}_normalizeCenter(o){const l=this.transform;if(l.maxBounds||l.projection.name!=="globe"&&!l.renderWorldCopies)return;const m=o.lng-l.center.lng;o.lng+=m>180?-360:m<-180?360:0}_prefersReducedMotion(o){return this._respectPrefersReducedMotion&&r.q.prefersReducedMotion&&!(o&&o.essential)}_emulate(o,l,m){const y=Math.ceil(15*l/1e3),w=[],E=o(m.clone());for(let O=0;O<=y;O++){const $=E(O/y);w.push($.clone())}return w}_preloadTiles(o,l){}}class Rp{constructor(o={}){this.options=o,r.aP(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(o){const l=this.options&&this.options.compact,m=o._getUIString("AttributionControl.ToggleAttribution");this._map=o,this._container=N("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=N("button","mapboxgl-ctrl-attrib-button",this._container),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._compactButton.setAttribute("aria-label",m);const y=N("span","mapboxgl-ctrl-icon",this._compactButton);return y.setAttribute("aria-hidden","true"),y.setAttribute("title",m),this._innerContainer=N("div","mapboxgl-ctrl-attrib-inner",this._container),l&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),l===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let o=this._editLink;o||(o=this._editLink=this._container.querySelector(".mapbox-improve-map"));const l=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||r.e.ACCESS_TOKEN}];if(o){const m=l.reduce((y,w,E)=>(w.value&&(y+=`${w.key}=${w.value}${E<l.length-1?"&":""}`),y),"?");o.href=`${r.e.FEEDBACK_URL}/${m}#${gv(this._map,!0)}`,o.rel="noopener nofollow"}}_updateData(o){!o||o.sourceDataType!=="metadata"&&o.sourceDataType!=="visibility"&&o.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let o=[];if(this._map.style.stylesheet){const y=this._map.style.stylesheet;this.styleOwner=y.owner,this.styleId=y.id}const l=this._map.style._mergedSourceCaches;for(const y in l){const w=l[y];if(w.used){const E=w.getSource();E.attribution&&o.indexOf(E.attribution)<0&&o.push(E.attribution)}}o.sort((y,w)=>y.length-w.length),o=o.filter((y,w)=>{for(let E=w+1;E<o.length;E++)if(o[E].indexOf(y)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?o=[...this.options.customAttribution,...o]:o.unshift(this.options.customAttribution));const m=o.join(" | ");m!==this._attribHTML&&(this._attribHTML=m,o.length?(this._innerContainer.innerHTML=m,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class Ks{constructor(){r.aP(["_updateLogo","_updateCompact"],this)}onAdd(o){this._map=o,this._container=N("div","mapboxgl-ctrl");const l=N("a","mapboxgl-ctrl-logo");return l.target="_blank",l.rel="noopener nofollow",l.href="https://www.mapbox.com/",l.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),l.setAttribute("rel","noopener nofollow"),this._container.appendChild(l),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(o){o&&o.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const o=this._map.style._sourceCaches;if(Object.entries(o).length===0)return!0;for(const l in o){const m=o[l].getSource();if(m.hasOwnProperty("mapbox_logo")&&!m.mapbox_logo)return!1}return!0}_updateCompact(){const o=this._container.children;if(o.length){const l=o[0];this._map.getCanvasContainer().offsetWidth<250?l.classList.add("mapboxgl-compact"):l.classList.remove("mapboxgl-compact")}}}class Zs{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(o){const l=++this._id;return this._queue.push({callback:o,id:l,cancelled:!1}),l}remove(o){const l=this._currentlyRunning,m=l?this._queue.concat(l):this._queue;for(const y of m)if(y.id===o)return void(y.cancelled=!0)}run(o=0){const l=this._currentlyRunning=this._queue;this._queue=[];for(const m of l)if(!m.cancelled&&(m.callback(o),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}class vd{constructor(o){this.jumpTo(o)}getValue(o){if(o<=this._startTime)return this._start;if(o>=this._endTime)return this._end;const l=r.cB((o-this._startTime)/(this._endTime-this._startTime));return this._start*(1-l)+this._end*l}isEasing(o){return o>=this._startTime&&o<=this._endTime}jumpTo(o){this._startTime=-1/0,this._endTime=-1/0,this._start=o,this._end=o}easeTo(o,l,m){this._start=this.getValue(l),this._end=o,this._startTime=l,this._endTime=l+m}}const yu={"AttributionControl.ToggleAttribution":"Toggle attribution","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox homepage","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use  + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"};class bu extends r.z{constructor(o,l,m,y){const{point:w,lngLat:E,originalEvent:O,target:$}=o;super(o.type,{point:w,lngLat:E,originalEvent:O,target:$}),this.preventDefault=()=>{o.preventDefault()},this.id=l,this.interaction=m,this.feature=y}}class xv{constructor(o){this.map=o,this.interactionsByType=new Map,this.delegatedInteractions=new Map,this.typeById=new Map,this.filters=new Map,this.handleType=this.handleType.bind(this),this.handleMove=this.handleMove.bind(this),this.handleOut=this.handleOut.bind(this),this.hoveredFeatures=new Map,this.prevHoveredFeatures=new Map}add(o,l){if(this.typeById.has(o))throw new Error(`Interaction id "${o}" already exists.`);const m=l.filter;let y=l.type;m&&this.filters.set(o,r.aZ(m)),y==="mouseover"&&(y="mouseenter"),y==="mouseout"&&(y="mouseleave");const w=this.interactionsByType.get(y)||new Map;y==="mouseenter"||y==="mouseleave"?(this.delegatedInteractions.size===0&&(this.map.on("mousemove",this.handleMove),this.map.on("mouseout",this.handleOut)),this.delegatedInteractions.set(o,l)):w.size===0&&this.map.on(y,this.handleType),w.size===0&&this.interactionsByType.set(y,w),w.set(o,l),this.typeById.set(o,y)}get(o){const l=this.typeById.get(o);if(!l)return;const m=this.interactionsByType.get(l);return m?m.get(o):void 0}remove(o){const l=this.typeById.get(o);if(!l)return;this.typeById.delete(o),this.filters.delete(o);const m=this.interactionsByType.get(l);m&&(m.delete(o),l==="mouseenter"||l==="mouseleave"?(this.delegatedInteractions.delete(o),this.delegatedInteractions.size===0&&(this.map.off("mousemove",this.handleMove),this.map.off("mouseout",this.handleOut))):m.size===0&&this.map.off(l,this.handleType))}queryTargets(o,l){const m=[];for(const[y,w]of l)w.target&&m.push({targetId:y,target:w.target,filter:this.filters.get(y)});return this.map.style.queryRenderedTargets(o,m,this.map.transform)}handleMove(o){this.prevHoveredFeatures=this.hoveredFeatures,this.hoveredFeatures=new Map;const l=this.queryTargets(o.point,Array.from(this.delegatedInteractions).reverse());l.length&&(o.type="mouseenter",this.handleType(o,l));const m=new Map;for(const[y,{feature:w}]of this.prevHoveredFeatures)this.hoveredFeatures.has(y)||m.set(w.id,w);m.size&&(o.type="mouseleave",this.handleType(o,Array.from(m.values())))}handleOut(o){const l=Array.from(this.hoveredFeatures.values()).map(({feature:m})=>m);l.length&&(o.type="mouseleave",this.handleType(o,l)),this.hoveredFeatures.clear()}handleType(o,l){const m=Array.from(this.interactionsByType.get(o.type)).reverse(),y=!!l;l=l||this.queryTargets(o.point,m);const w=o.type==="mouseenter";let E=!1;const O=new Set;for(const $ of l){for(const[H,G]of m){if(!G.target)continue;const Z=$.variants?$.variants[H]:null;if(Z){for(const X of Z){if(Pl(X,$,O,H))continue;const oe=new r.cw($,X),xe=sh(X,$,H);y&&(oe.state=this.map.getFeatureState(oe));const ve=w?this.prevHoveredFeatures.get(xe):null,Ce=new bu(o,H,G,oe),Te=ve?ve.stop:G.handler(Ce);if(w&&this.hoveredFeatures.set(xe,{feature:$,stop:Te}),Te!==!1){E=!0;break}}if(E)break}}if(E)break}if(!E)for(const[$,H]of m){const{handler:G,target:Z}=H;if(!Z&&G(new bu(o,$,H,null))!==!1)break}}}function Qr(f,o){if(Array.isArray(f)&&Array.isArray(o)){const l=new Set(f),m=new Set(o);return l.size===m.size&&f.every(y=>m.has(y))}return r.bn(f,o)}const Pc={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,antialias:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,respectPrefersReducedMotion:!0,crossSourceCollisions:!0,collectResourceTiming:!1,testMode:!1,precompilePrograms:!0,scaleFactor:1,spriteFormat:"auto"},xw={showCompass:!0,showZoom:!0,visualizePitch:!1};class ww{constructor(o,l,m=!1){this._clickTolerance=10,this.element=l,this.mouseRotate=new cl({clickTolerance:o.dragRotate._mouseRotate._clickTolerance}),this.map=o,m&&(this.mousePitch=new Kh({clickTolerance:o.dragRotate._mousePitch._clickTolerance})),r.aP(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),l.addEventListener("mousedown",this.mousedown),l.addEventListener("touchstart",this.touchstart,{passive:!1}),l.addEventListener("touchmove",this.touchmove),l.addEventListener("touchend",this.touchend),l.addEventListener("touchcancel",this.reset)}down(o,l){this.mouseRotate.mousedown(o,l),this.mousePitch&&this.mousePitch.mousedown(o,l),q()}move(o,l){const m=this.map,y=this.mouseRotate.mousemoveWindow(o,l),w=y&&y.bearingDelta;if(w&&m.setBearing(m.getBearing()+w),this.mousePitch){const E=this.mousePitch.mousemoveWindow(o,l),O=E&&E.pitchDelta;O&&m.setPitch(m.getPitch()+O)}}off(){const o=this.element;o.removeEventListener("mousedown",this.mousedown),o.removeEventListener("touchstart",this.touchstart,{passive:!1}),o.removeEventListener("touchmove",this.touchmove),o.removeEventListener("touchend",this.touchend),o.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){J(),window.removeEventListener("mousemove",this.mousemove),window.removeEventListener("mouseup",this.mouseup)}mousedown(o){this.down(r.l({},o,{ctrlKey:!0,preventDefault:()=>o.preventDefault()}),fe(this.element,o)),window.addEventListener("mousemove",this.mousemove),window.addEventListener("mouseup",this.mouseup)}mousemove(o){this.move(o,fe(this.element,o))}mouseup(o){this.mouseRotate.mouseupWindow(o),this.mousePitch&&this.mousePitch.mouseupWindow(o),this.offTemp()}touchstart(o){o.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=ce(this.element,o.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>o.preventDefault()},this._startPos))}touchmove(o){o.targetTouches.length!==1?this.reset():(this._lastPos=ce(this.element,o.targetTouches)[0],this.move({preventDefault:()=>o.preventDefault()},this._lastPos))}touchend(o){o.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}function Op(f,o,l){if(f=new r.bO(f.lng,f.lat),o){const m=new r.bO(f.lng-360,f.lat),y=new r.bO(f.lng+360,f.lat),w=360*Math.ceil(Math.abs(f.lng-l.center.lng)/360),E=l.locationPoint(f).distSqr(o),O=o.x<0||o.y<0||o.x>l.width||o.y>l.height;l.locationPoint(m).distSqr(o)<E&&(O||Math.abs(m.lng-l.center.lng)<w)?f=m:l.locationPoint(y).distSqr(o)<E&&(O||Math.abs(y.lng-l.center.lng)<w)&&(f=y)}for(;Math.abs(f.lng-l.center.lng)>180;){const m=l.locationPoint(f);if(m.x>=0&&m.y>=0&&m.x<=l.width&&m.y<=l.height)break;f.lng>l.center.lng?f.lng-=360:f.lng+=360}return f}const ul={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class Na extends r.E{constructor(o,l){if(super(),(o instanceof HTMLElement||l)&&(o=r.l({element:o},l)),r.aP(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=o&&o.anchor||"center",this._color=o&&o.color||"#3FB1CE",this._scale=o&&o.scale||1,this._draggable=o&&o.draggable||!1,this._clickTolerance=o&&o.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=o&&o.rotation||0,this._rotationAlignment=o&&o.rotationAlignment||"auto",this._pitchAlignment=o&&o.pitchAlignment&&o.pitchAlignment||"auto",this._updateMoving=()=>this._update(!0),this._occludedOpacity=o&&o.occludedOpacity||.2,o&&o.element)this._element=o.element,this._offset=r.P.convert(o&&o.offset||[0,0]);else{this._defaultMarker=!0,this._element=N("div");const w=41,E=27,O=j("svg",{display:"block",height:w*this._scale+"px",width:E*this._scale+"px",viewBox:`0 0 ${E} ${w}`},this._element),$=j("radialGradient",{id:"shadowGradient"},j("defs",{},O));j("stop",{offset:"10%","stop-opacity":.4},$),j("stop",{offset:"100%","stop-opacity":.05},$),j("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},O),j("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},O),j("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},O),j("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},O),this._offset=r.P.convert(o&&o.offset||[0,-14])}this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.hasAttribute("role")||this._element.setAttribute("role","img"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",w=>{w.preventDefault()}),this._element.addEventListener("mousedown",w=>{w.preventDefault()});const m=this._element.classList;for(const w in ul)m.remove(`mapboxgl-marker-anchor-${w}`);m.add(`mapboxgl-marker-anchor-${this._anchor}`);const y=o&&o.className?o.className.trim().split(/\s+/):[];m.add(...y),this._popup=null}addTo(o){return o===this._map||(this.remove(),this._map=o,o.getCanvasContainer().appendChild(this._element),o.on("move",this._updateMoving),o.on("moveend",this._update),o.on("remove",this._clearFadeTimer),o._addMarker(this),this.setDraggable(this._draggable),this._update(),o.on("click",this._onMapClick)),this}remove(){const o=this._map;return o&&(o.off("click",this._onMapClick),o.off("move",this._updateMoving),o.off("moveend",this._update),o.off("mousedown",this._addDragHandler),o.off("touchstart",this._addDragHandler),o.off("mouseup",this._onUp),o.off("touchend",this._onUp),o.off("mousemove",this._onMove),o.off("touchmove",this._onMove),o.off("remove",this._clearFadeTimer),o._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(o){return this._lngLat=r.bO.convert(o),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}getElement(){return this._element}setPopup(o){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),o){if(!("offset"in o.options)){const y=Math.sqrt(Math.pow(13.5,2)/2);o.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[y,-1*(38.1-13.5+y)],"bottom-right":[-y,-1*(38.1-13.5+y)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=o,o._marker=this,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(o){const l=o.code,m=o.charCode||o.keyCode;l!=="Space"&&l!=="Enter"&&m!==32&&m!==13||this.togglePopup()}_onMapClick(o){const l=o.originalEvent.target,m=this._element;this._popup&&(l===m||m.contains(l))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const o=this._popup;return o?(o.isOpen()?(o.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(o.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const o=this._map,l=this._pos;if(!o||!l)return!1;const m=o.unproject(l),y=o.getFreeCameraOptions();if(!y.position)return!1;const w=y.position.toLngLat();return w.distanceTo(m)<.9*w.distanceTo(this._lngLat)}_evaluateOpacity(){const o=this._map;if(!o)return;const l=this._pos;if(!l||l.x<0||l.x>o.transform.width||l.y<0||l.y>o.transform.height)return void this._clearFadeTimer();const m=o.unproject(l);let y;o._showingGlobe()&&r.dH(o.transform,this._lngLat)?y=0:(y=1-o._queryFogOpacity(m),o.transform._terrainEnabled()&&o.getTerrain()&&this._behindTerrain()&&(y*=this._occludedOpacity)),this._element.style.opacity=`${y}`,this._element.style.pointerEvents=y>0?"auto":"none",this._popup&&this._popup._setOpacity(y),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const o=this._pos;if(!o||!this._map)return;const l=this._offset.mult(this._scale);this._element.style.transform=`
            translate(${o.x}px,${o.y}px)
            ${ul[this._anchor]}
            ${this._calculateXYTransform()} ${this._calculateZTransform()}
            translate(${l.x}px,${l.y}px)
        `}_calculateXYTransform(){const o=this._pos,l=this._map,m=this.getPitchAlignment();if(!l||!o||m!=="map")return"";if(!l._showingGlobe()){const $=l.getPitch();return $?`rotateX(${$}deg)`:""}const y=r.c4(r.dI(l.transform,this._lngLat)),w=o.sub(r.dJ(l.transform)),E=Math.abs(w.x)+Math.abs(w.y);if(E===0)return"";const O=y/E;return`rotateX(${-w.y*O}deg) rotateY(${w.x*O}deg)`}_calculateZTransform(){const o=this._pos,l=this._map;if(!l||!o)return"";let m=0;const y=this.getRotationAlignment();if(y==="map")if(l._showingGlobe()){const w=l.project(new r.bO(this._lngLat.lng,this._lngLat.lat+.001)),E=l.project(new r.bO(this._lngLat.lng,this._lngLat.lat-.001)).sub(w);m=r.c4(Math.atan2(E.y,E.x))-90}else m=-l.getBearing();else if(y==="horizon"){const w=r.ac(4,6,l.getZoom()),E=r.dJ(l.transform);E.y+=w*l.transform.height;const O=o.sub(E),$=r.c4(Math.atan2(O.y,O.x));m=($>90?$-270:$+90)*(1-w)}return m+=this._rotation,m?`rotateZ(${m}deg)`:""}_update(o){cancelAnimationFrame(this._updateFrameId);const l=this._map;l&&(l.transform.renderWorldCopies&&(this._lngLat=Op(this._lngLat,this._pos,l.transform)),this._pos=l.project(this._lngLat),o===!0?this._updateFrameId=requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),l._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(l._showingGlobe()||l.getTerrain()||l.getFog())&&!this._fadeTimer&&(this._fadeTimer=window.setTimeout(this._evaluateOpacity.bind(this),60)))}))}getOffset(){return this._offset}setOffset(o){return this._offset=r.P.convert(o),this._update(),this}addClassName(o){return this._element.classList.add(o),this}removeClassName(o){return this._element.classList.remove(o),this}toggleClassName(o){return this._element.classList.toggle(o)}_onMove(o){const l=this._map;if(!l)return;const m=this._pointerdownPos,y=this._positionDelta;if(m&&y){if(!this._isDragging){const w=this._clickTolerance||l._clickTolerance;if(o.point.dist(m)<w)return;this._isDragging=!0}this._pos=o.point.sub(y),this._lngLat=l.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new r.z("dragstart"))),this.fire(new r.z("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const o=this._map;o&&(o.off("mousemove",this._onMove),o.off("touchmove",this._onMove)),this._state==="active"&&this.fire(new r.z("dragend")),this._state="inactive"}_addDragHandler(o){const l=this._map,m=this._pos;l&&m&&this._element.contains(o.originalEvent.target)&&(o.preventDefault(),this._positionDelta=o.point.sub(m),this._pointerdownPos=o.point,this._state="pending",l.on("mousemove",this._onMove),l.on("touchmove",this._onMove),l.once("mouseup",this._onUp),l.once("touchend",this._onUp))}setDraggable(o){this._draggable=!!o;const l=this._map;return l&&(o?(l.on("mousedown",this._addDragHandler),l.on("touchstart",this._addDragHandler)):(l.off("mousedown",this._addDragHandler),l.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(o){return this._rotation=o||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(o){return this._rotationAlignment=o||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment==="auto"||this._rotationAlignment==="horizon"&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(o){return this._pitchAlignment=o||"auto",this._update(),this}getPitchAlignment(){return this._pitchAlignment==="auto"?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(o){return this._occludedOpacity=o||.2,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}const fs={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},Ds={maxWidth:100,unit:"metric"},Ui={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"},C0={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},ws=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function wv(f=new r.P(0,0),o="bottom"){if(typeof f=="number"){const l=Math.round(Math.sqrt(.5*Math.pow(f,2)));switch(o){case"top":return new r.P(0,f);case"top-left":return new r.P(l,l);case"top-right":return new r.P(-l,l);case"bottom":return new r.P(0,-f);case"bottom-left":return new r.P(l,-l);case"bottom-right":return new r.P(-l,-l);case"left":return new r.P(f,0);case"right":return new r.P(-f,0)}return new r.P(0,0)}return f instanceof r.P||Array.isArray(f)?r.P.convert(f):r.P.convert(f[o]||[0,0])}return{version:S,supported:B.supported,setRTLTextPlugin:r.dK,getRTLTextPluginStatus:r.dL,Map:class extends gd{constructor(f){M.mark(C.create);const o=f;if((f=r.l({},Pc,f)).minZoom!=null&&f.maxZoom!=null&&f.minZoom>f.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(f.minPitch!=null&&f.maxPitch!=null&&f.minPitch>f.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(f.minPitch!=null&&f.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(f.maxPitch!=null&&f.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(f.antialias&&r.dF(window)&&(f.antialias=!1,r.w("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new _h(f.minZoom,f.maxZoom,f.minPitch,f.maxPitch,f.renderWorldCopies),f),this._repaint=!!f.repaint,this._interactive=f.interactive,this._minTileCacheSize=f.minTileCacheSize,this._maxTileCacheSize=f.maxTileCacheSize,this._failIfMajorPerformanceCaveat=f.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=f.preserveDrawingBuffer,this._antialias=f.antialias,this._trackResize=f.trackResize,this._bearingSnap=f.bearingSnap,this._refreshExpiredTiles=f.refreshExpiredTiles,this._fadeDuration=f.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=f.crossSourceCollisions,this._collectResourceTiming=f.collectResourceTiming,this._language=this._parseLanguage(f.language),this._worldview=f.worldview,this._renderTaskQueue=new Zs,this._domRenderTaskQueue=new Zs,this._controls=[],this._markers=[],this._popups=[],this._mapId=r.aV(),this._locale=r.l({},yu,f.locale),this._clickTolerance=f.clickTolerance,this._cooperativeGestures=f.cooperativeGestures,this._performanceMetricsCollection=f.performanceMetricsCollection,this._tessellationStep=f.tessellationStep,this._containerWidth=0,this._containerHeight=0,this._showParseStatus=!0,this._precompilePrograms=f.precompilePrograms,this._scaleFactorChanged=!1,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new vd(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._frameId=0,this._scaleFactor=f.scaleFactor,this._requestManager=new We(f.transformRequest,f.accessToken,f.testMode),this._silenceAuthErrors=!!f.testMode,this._contextCreateOptions=f.contextCreateOptions?Object.assign({},f.contextCreateOptions):{},typeof f.container=="string"){const l=document.getElementById(f.container);if(!l)throw new Error(`Container '${f.container.toString()}' not found.`);this._container=l}else{if(!(f.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=f.container}if(this._container.childNodes.length>0&&r.w("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),f.maxBounds&&this.setMaxBounds(f.maxBounds),this._spriteFormat=f.spriteFormat,r.aP(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._tp||(this._tp=new uv),this._tp.registerParameter(this,["Debug"],"showOverdrawInspector"),this._tp.registerParameter(this,["Debug"],"showTileBoundaries"),this._tp.registerParameter(this,["Debug"],"showParseStatus"),this._tp.registerParameter(this,["Debug"],"repaint"),this._tp.registerParameter(this,["Debug"],"showTileAABBs"),this._tp.registerParameter(this,["Debug"],"showPadding"),this._tp.registerParameter(this,["Debug"],"showCollisionBoxes",{noSave:!0}),this._tp.registerParameter(this.transform,["Debug"],"freezeTileCoverage",{noSave:!0},()=>{this._update()}),this._tp.registerParameter(this,["Debug","Wireframe"],"showTerrainWireframe"),this._tp.registerParameter(this,["Debug","Wireframe"],"showLayers2DWireframe"),this._tp.registerParameter(this,["Debug","Wireframe"],"showLayers3DWireframe"),this._tp.registerParameter(this,["Scaling"],"_scaleFactor",{min:.1,max:10,step:.1},()=>{this.setScaleFactor(this._scaleFactor)}),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");if(this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this._fullscreenchangeEvent="onfullscreenchange"in document?"fullscreenchange":"webkitfullscreenchange",window.addEventListener("online",this._onWindowOnline,!1),window.addEventListener("resize",this._onWindowResize,!1),window.addEventListener("orientationchange",this._onWindowResize,!1),window.addEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),window.addEventListener("visibilitychange",this._onVisibilityChange,!1),this.handlers=new S0(this,f),this._localFontFamily=f.localFontFamily,this._localIdeographFontFamily=f.localIdeographFontFamily,(f.style||!f.testMode)&&this.setStyle(f.style||r.e.DEFAULT_STYLE,{config:f.config,localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),f.projection&&this.setProjection(f.projection),this.indoor=new Eg(this),f.hash&&(this._hash=new h0(typeof f.hash=="string"&&f.hash||void 0).addTo(this)),!this._hash||!this._hash._onHashChange()){o.center==null&&o.zoom==null||(this.transform._unmodified=!1),this.jumpTo({center:f.center,zoom:f.zoom,bearing:f.bearing,pitch:f.pitch});const l=f.bounds;l&&(this.resize(),this.fitBounds(l,r.l({},f.fitBoundsOptions,{duration:0})))}this.resize(),f.attributionControl&&this.addControl(new Rp({customAttribution:f.customAttribution})),this._logoControl=new Ks,this.addControl(this._logoControl,f.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet),this._postStyleLoadEvent()}),this.on("data",l=>{this._update(l.dataType==="style"),this.fire(new r.z(`${l.dataType}data`,l))}),this.on("dataloading",l=>{this.fire(new r.z(`${l.dataType}dataloading`,l))}),this._interactions=new xv(this)}_getMapId(){return this._mapId}addControl(f,o){if(o===void 0&&(o=f.getDefaultPosition?f.getDefaultPosition():"top-right"),!f||!f.onAdd)return this.fire(new r.y(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const l=f.onAdd(this);this._controls.push(f);const m=this._controlPositions[o];return o.indexOf("bottom")!==-1?m.insertBefore(l,m.firstChild):m.appendChild(l),this}removeControl(f){if(!f||!f.onRemove)return this.fire(new r.y(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const o=this._controls.indexOf(f);return o>-1&&this._controls.splice(o,1),f.onRemove(this),this}hasControl(f){return this._controls.indexOf(f)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(f){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const o=!this._moving;return o&&this.fire(new r.z("movestart",f)).fire(new r.z("move",f)),this.fire(new r.z("resize",f)),o&&this.fire(new r.z("moveend",f)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(f){return this.transform.setMaxBounds(r.az.convert(f)),this._update()}setMinZoom(f){if((f=f??-2)>=-2&&f<=this.transform.maxZoom)return this.transform.minZoom=f,this._update(),this.getZoom()<f?this.setZoom(f):this.fire(new r.z("zoomstart")).fire(new r.z("zoom")).fire(new r.z("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(f){if((f=f??22)>=this.transform.minZoom)return this.transform.maxZoom=f,this._update(),this.getZoom()>f?this.setZoom(f):this.fire(new r.z("zoomstart")).fire(new r.z("zoom")).fire(new r.z("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(f){if((f=f??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(f>=0&&f<=this.transform.maxPitch)return this.transform.minPitch=f,this._update(),this.getPitch()<f?this.setPitch(f):this.fire(new r.z("pitchstart")).fire(new r.z("pitch")).fire(new r.z("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(f){if((f=f??85)>85)throw new Error("maxPitch must be less than or equal to 85");if(f>=this.transform.minPitch)return this.transform.maxPitch=f,this._update(),this.getPitch()>f?this.setPitch(f):this.fire(new r.z("pitchstart")).fire(new r.z("pitch")).fire(new r.z("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getScaleFactor(){return this._scaleFactor}setScaleFactor(f){return this._scaleFactor=f,this.painter.scaleFactor=f,this._tp.refreshUI(),this._scaleFactorChanged=!0,this.style._updateFilteredLayers(o=>o.type==="symbol"),this._update(!0),this}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(f){return this.transform.renderWorldCopies=f,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(f){return f==="auto"?navigator.language:Array.isArray(f)?f.length===0?void 0:f.map(o=>o==="auto"?navigator.language:o):f}setLanguage(f){const o=this._parseLanguage(f);if(!this.style||o===this._language)return this;this._language=o,this.style.reloadSources();for(const l of this._controls)l._setLanguage&&l._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(f){return this.style&&f!==this._worldview?(this._worldview=f,this.style.reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return this.transform.projection.name==="globe"}setProjection(f){return this._lazyInitEmptyStyle(),f?typeof f=="string"&&(f={name:f}):f=null,this._useExplicitProjection=!!f,this._prioritizeAndUpdateProjection(f,this.style.projection)}_updateProjectionTransition(){if(this.getProjection().name!=="globe")return;const f=this.transform,o=f.projection.name;let l;o==="globe"&&f.zoom>=r.bY?(f.setMercatorFromTransition(),l=!0):o==="mercator"&&f.zoom<r.bY&&(f.setProjection({name:"globe"}),l=!0),l&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate())}_prioritizeAndUpdateProjection(f,o){return this._updateProjection(f||o||{name:"mercator"})}_updateProjection(f){let o;return o=f.name==="globe"&&this.transform.zoom>=r.bY?this.transform.setMercatorFromTransition():this.transform.setProjection(f),this.style.applyProjectionUpdate(),o&&(this.painter.clearBackgroundTiles(),this.style.clearSources(),this._update(!0),this._forceMarkerAndPopupUpdate(!0)),this}project(f){return this.transform.locationPoint3D(r.bO.convert(f))}unproject(f){return this.transform.pointLocation3D(r.P.convert(f))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(f,o,l){const m=y=>{let w=[];if(Array.isArray(o)){const E=o.filter(O=>this.getLayer(O));w=E.length?this.queryRenderedFeatures(y,{layers:E}):[]}else w=this.queryRenderedFeatures(y,{target:o});return w};if(f==="mouseenter"||f==="mouseover"){let y=!1;return{listener:l,targets:o,delegates:{mousemove:E=>{const O=m(E.point);O.length?y||(y=!0,l.call(this,new Ls(f,this,E.originalEvent,{features:O}))):y=!1},mouseout:()=>{y=!1}}}}if(f==="mouseleave"||f==="mouseout"){let y=!1;return{listener:l,targets:o,delegates:{mousemove:O=>{m(O.point).length?y=!0:y&&(y=!1,l.call(this,new Ls(f,this,O.originalEvent)))},mouseout:O=>{y&&(y=!1,l.call(this,new Ls(f,this,O.originalEvent)))}}}}{const y=w=>{const E=m(w.point);E.length&&(w.features=E,l.call(this,w),delete w.features)};return{listener:l,targets:o,delegates:{[f]:y}}}}on(f,o,l){if(typeof o=="function"||l===void 0)return super.on(f,o);if(typeof o=="string"&&(o=[o]),!this._areTargetsValid(o))return this;const m=this._createDelegatedListener(f,o,l);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[f]=this._delegatedListeners[f]||[],this._delegatedListeners[f].push(m);for(const y in m.delegates)this.on(y,m.delegates[y]);return this}once(f,o,l){if(typeof o=="function"||l===void 0)return super.once(f,o);if(typeof o=="string"&&(o=[o]),!this._areTargetsValid(o))return this;const m=this._createDelegatedListener(f,o,l);for(const y in m.delegates)this.once(y,m.delegates[y]);return this}off(f,o,l){if(typeof o=="function"||l===void 0)return super.off(f,o);if(typeof o=="string"&&(o=[o]),!this._areTargetsValid(o))return this;const m=this._delegatedListeners?this._delegatedListeners[f]:void 0;return m&&(y=>{for(let w=0;w<y.length;w++){const E=y[w];if(E.listener===l&&Qr(E.targets,o)){for(const O in E.delegates)this.off(O,E.delegates[O]);return y.splice(w,1),this}}})(m),this}queryRenderedFeatures(f,o){if(!this.style)return[];if(f===void 0||f instanceof r.P||Array.isArray(f)||o!==void 0||(o=f,f=void 0),f=f||[[0,0],[this.transform.width,this.transform.height]],!o){const w=this.style.queryRenderedFeatures(f,void 0,this.transform),E=this.style.queryRenderedFeatureset(f,void 0,this.transform);return w.concat(E)}let l=!0;if(o.target&&(l=this._isTargetValid(o.target),l&&!o.layers))return this.style.queryRenderedFeatureset(f,o,this.transform);let m=!0;if(o.layers&&Array.isArray(o.layers)){for(const w of o.layers)if(!this._isValidId(w)){m=!1;break}if(m&&!o.target)return this.style.queryRenderedFeatures(f,o,this.transform)}let y=[];return m&&(y=y.concat(this.style.queryRenderedFeatures(f,o,this.transform))),l&&(y=y.concat(this.style.queryRenderedFeatureset(f,o,this.transform))),y}querySourceFeatures(f,o){return!f||typeof f=="string"&&!this._isValidId(f)?[]:this.style.querySourceFeatures(f,o)}isPointOnSurface(f){const{name:o}=this.transform.projection;return o!=="globe"&&o!=="mercator"&&r.w(`${o} projection does not support isPointOnSurface, this API may behave unexpectedly.`),this.transform.isPointOnSurface(r.P.convert(f))}addInteraction(f,o){return this._interactions.add(f,o),this}removeInteraction(f){return this._interactions.remove(f),this}setStyle(f,o){return o=r.l({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},o),this.style&&f&&o.diff!==!1&&o.localFontFamily===this._localFontFamily&&o.localIdeographFontFamily===this._localIdeographFontFamily&&!o.config?(this.style._diffStyle(f,(l,m)=>{l?(r.w(`Unable to perform style diff: ${String(l.message||l.error||l)}. Rebuilding the style from scratch.`),this._updateStyle(f,o)):m&&this._update(!0)},()=>{this._postStyleLoadEvent()}),this):(this._localIdeographFontFamily=o.localIdeographFontFamily,this._localFontFamily=o.localFontFamily,this._updateStyle(f,o))}_getUIString(f){const o=this._locale[f];if(o==null)throw new Error(`Missing UI string '${f}'`);return o}_updateStyle(f,o){if(this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),f){const l=r.l({},o);o&&o.config&&(l.initialConfig=o.config,delete l.config),this.style=new ba(this,l).load(f),this.style.setEventedParent(this,{style:this.style})}return this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new ba(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(r.w("There is no style added to the map."),!1)}_isValidId(f){return f==null?(this.fire(new r.y(new Error("IDs can't be empty."))),!1):!r.cr(f)||(this.fire(new r.y(new Error(`IDs can't contain special symbols: "${f}".`))),!1)}_isTargetValid(f){return"featuresetId"in f?this._isValidId("importId"in f?f.importId:f.featuresetId):"layerId"in f&&this._isValidId(f.layerId)}_areTargetsValid(f){if(Array.isArray(f)){for(const o of f)if(!this._isValidId(o))return!1;return!0}return this._isTargetValid(f)}addSource(f,o){return this._isValidId(f)?(this._lazyInitEmptyStyle(),this.style.addSource(f,o),this._update(!0)):this}isSourceLoaded(f){return!!this._isValidId(f)&&!!this.style&&this.style._isSourceCacheLoaded(f)}areTilesLoaded(){return this.style.areTilesLoaded()}addSourceType(f,o,l){this._lazyInitEmptyStyle(),this.style.addSourceType(f,o,l)}removeSource(f){return this._isValidId(f)?(this.style.removeSource(f),this._updateTerrain(),this._update(!0)):this}getSource(f){return this._isValidId(f)?this.style.getOwnSource(f):null}addImage(f,o,{pixelRatio:l=1,sdf:m=!1,stretchX:y,stretchY:w,content:E}={}){if(this._lazyInitEmptyStyle(),o instanceof HTMLImageElement||ImageBitmap&&o instanceof ImageBitmap){const{width:O,height:$,data:H}=r.q.getImageData(o);this.style.addImage(f,{data:new r.r({width:O,height:$},H),pixelRatio:l,stretchX:y,stretchY:w,content:E,sdf:m,version:0,usvg:!1})}else if(o.width===void 0||o.height===void 0)this.fire(new r.y(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:O,height:$}=o,H=o;this.style.addImage(f,{data:new r.r({width:O,height:$},new Uint8Array(H.data)),pixelRatio:l,stretchX:y,stretchY:w,content:E,sdf:m,usvg:!1,version:0,userImage:H}),H.onAdd&&H.onAdd(this,f)}}updateImage(f,o){this._lazyInitEmptyStyle();const l=this.style.getImage(f);if(!l)return void this.fire(new r.y(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const m=o instanceof HTMLImageElement||ImageBitmap&&o instanceof ImageBitmap?r.q.getImageData(o):o,{width:y,height:w,data:E}=m;if(y===void 0||w===void 0)return void this.fire(new r.y(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(y!==(l.usvg?l.icon.usvg_tree.width:l.data.width)||w!==(l.usvg?l.icon.usvg_tree.height:l.data.height))return void this.fire(new r.y(new Error(`The width and height of the updated image (${y}, ${w})
                must be that same as the previous version of the image
                (${l.data.width}, ${l.data.height})`)));const O=!(o instanceof HTMLImageElement||ImageBitmap&&o instanceof ImageBitmap);let $=!1;l.usvg?(l.data=new r.r({width:y,height:w},new Uint8Array(E)),l.usvg=!1,l.icon=void 0,$=!0):l.data.replace(E,O),this.style.updateImage(f,l,$)}hasImage(f){return f?!!this.style&&!!this.style.getImage(f):(this.fire(new r.y(new Error("Missing required image id"))),!1)}removeImage(f){this.style.removeImage(f)}loadImage(f,o){r.o(this._requestManager.transformRequest(f,r.R.Image),(l,m)=>{o(l,m instanceof HTMLImageElement?r.q.getImageData(m):m)})}listImages(){return this.style.listImages()}addModel(f,o){this._lazyInitEmptyStyle(),this.style.addModel(f,o)}hasModel(f){return f?this.style.hasModel(f):(this.fire(new r.y(new Error("Missing required model id"))),!1)}removeModel(f){this.style.removeModel(f)}listModels(){return this.style.listModels()}addLayer(f,o){return this._isValidId(f.id)?(this._lazyInitEmptyStyle(),this.style.addLayer(f,o),this._update(!0)):this}getSlot(f){const o=this.getLayer(f);return o&&o.slot||null}setSlot(f,o){return this.style.setSlot(f,o),this.style.mergeLayers(),this._update(!0)}addImport(f,o){return this.style.addImport(f,o),this}updateImport(f,o){return typeof o!="string"&&o.id!==f?(this.removeImport(f),this.addImport(o)):(this.style.updateImport(f,o),this._update(!0))}removeImport(f){return this.style.removeImport(f),this}moveImport(f,o){return this.style.moveImport(f,o),this._update(!0)}moveLayer(f,o){return this._isValidId(f)?(this.style.moveLayer(f,o),this._update(!0)):this}removeLayer(f){return this._isValidId(f)?(this.style.removeLayer(f),this._update(!0)):this}getLayer(f){if(!this._isValidId(f))return null;const o=this.style.getOwnLayer(f);return o?o.type==="custom"?o.implementation:o.serialize():void 0}getSlots(){return this.style.getSlots()}setLayerZoomRange(f,o,l){return this._isValidId(f)?(this.style.setLayerZoomRange(f,o,l),this._update(!0)):this}setFilter(f,o,l={}){return this._isValidId(f)?(this.style.setFilter(f,o,l),this._update(!0)):this}getFilter(f){return this._isValidId(f)?this.style.getFilter(f):null}setPaintProperty(f,o,l,m={}){return this._isValidId(f)?(this.style.setPaintProperty(f,o,l,m),this._update(!0)):this}getPaintProperty(f,o){return this._isValidId(f)?this.style.getPaintProperty(f,o):null}setLayoutProperty(f,o,l,m={}){return this._isValidId(f)?(this.style.setLayoutProperty(f,o,l,m),this._update(!0)):this}getLayoutProperty(f,o){return this._isValidId(f)?this.style.getLayoutProperty(f,o):null}getSchema(f){return this.style.getSchema(f)}setSchema(f,o){return this.style.setSchema(f,o),this._update(!0)}getConfig(f){return this.style.getConfig(f)}setConfig(f,o){return this.style.setConfig(f,o),this._update(!0)}getConfigProperty(f,o){return this.style.getConfigProperty(f,o)}setConfigProperty(f,o,l){return this.style.setConfigProperty(f,o,l),this._update(!0)}getFeaturesetDescriptors(f){return this.style.getFeaturesetDescriptors(f)}setLights(f){if(this._lazyInitEmptyStyle(),f&&f.length===1&&f[0].type==="flat"){const o=f[0];o.properties?this.style.setFlatLight(o.properties,o.id,{}):this.style.setFlatLight({},"flat")}else this.style.setLights(f),this.painter.terrain&&(this.painter.terrain.invalidateRenderCache=!0);return this._update(!0)}getLights(){const f=this.style.getLights()||[];return f.length===0&&f.push({id:this.style.light.id,type:"flat",properties:this.style.getFlatLight()}),f}setLight(f,o={}){return console.log("The `map.setLight` function is deprecated, prefer using `map.setLights` with `flat` light type instead."),this.setLights([{id:"flat",type:"flat",properties:f}])}getLight(){return console.log("The `map.getLight` function is deprecated, prefer using `map.getLights` instead."),this.style.getFlatLight()}setTerrain(f){return this._lazyInitEmptyStyle(),!f&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(f),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(f){return this._lazyInitEmptyStyle(),this.style.setFog(f),this._update(!0)}getFog(){return this.style?this.style.getFog():null}setSnow(f){return this._lazyInitEmptyStyle(),this.style.setSnow(f),this._update(!0)}getSnow(){return this.style?this.style.getSnow():null}setRain(f){return this._lazyInitEmptyStyle(),this.style.setRain(f),this._update(!0)}getRain(){return this.style?this.style.getRain():null}setColorTheme(f){return this._lazyInitEmptyStyle(),this.style.setColorTheme(f),this._update(!0)}setImportColorTheme(f,o){return this._lazyInitEmptyStyle(),this.style.setImportColorTheme(f,o),this._update(!0)}setCamera(f){return this.style.setCamera(f),this._triggerCameraUpdate(f)}_triggerCameraUpdate(f){return this._update(this.transform.setOrthographicProjectionAtLowPitch(f["camera-projection"]==="orthographic"))}getCamera(){return this.style.camera}_queryFogOpacity(f){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(r.bO.convert(f),this.transform):0}setFeatureState(f,o){return f.source&&!this._isValidId(f.source)?this:(this.style.setFeatureState(f,o),this._update())}removeFeatureState(f,o){return f.source&&!this._isValidId(f.source)?this:(this.style.removeFeatureState(f,o),this._update())}getFeatureState(f){return f.source&&!this._isValidId(f.source)?null:this.style.getFeatureState(f)}_updateContainerDimensions(){if(!this._container)return;const f=this._container.getBoundingClientRect().width||400,o=this._container.getBoundingClientRect().height||300;let l,m,y,w=this._container;for(;w&&(!m||!y);){const E=window.getComputedStyle(w).transform;E&&E!=="none"&&(l=E.match(/matrix.*\((.+)\)/)[1].split(", "),l[0]&&l[0]!=="0"&&l[0]!=="1"&&(m=l[0]),l[3]&&l[3]!=="0"&&l[3]!=="1"&&(y=l[3])),w=w.parentElement}this._containerWidth=m?Math.abs(f/m):f,this._containerHeight=y?Math.abs(o/y):o}_detectMissingCSS(){window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&r.w("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const f=this._container;f.classList.add("mapboxgl-map"),(this._missingCSSCanary=N("div","mapboxgl-canary",f)).style.visibility="hidden",this._detectMissingCSS();const o=this._canvasContainer=N("div","mapboxgl-canvas-container",f);this._canvas=N("canvas","mapboxgl-canvas",o),this._interactive&&(o.classList.add("mapboxgl-interactive"),this._canvas.setAttribute("tabindex","0")),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const l=this._controlContainer=N("div","mapboxgl-control-container",f),m=this._controlPositions={};["top-left","top","top-right","right","bottom-right","bottom","bottom-left","left"].forEach(y=>{m[y]=N("div",`mapboxgl-ctrl-${y}`,l)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(f,o){const l=r.q.devicePixelRatio||1;this._canvas.width=l*Math.ceil(f),this._canvas.height=l*Math.ceil(o),this._canvas.style.width=`${f}px`,this._canvas.style.height=`${o}px`}_addMarker(f){this._markers.push(f)}_removeMarker(f){const o=this._markers.indexOf(f);o!==-1&&this._markers.splice(o,1)}_addPopup(f){this._popups.push(f)}_removePopup(f){const o=this._popups.indexOf(f);o!==-1&&this._popups.splice(o,1)}_setupPainter(){const f=r.l({},B.supported.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),o=this._canvas.getContext("webgl2",f);o?(Re(o,!0),this.painter=new mv(o,this._contextCreateOptions,this.transform,this._scaleFactor,this._tp),this.on("data",l=>{l.dataType==="source"&&this.painter.setTileLoadedFlag(!0)}),r.m.testSupport(o)):this.fire(new r.y(new Error("Failed to initialize WebGL")))}_contextLost(f){f.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new r.z("webglcontextlost",{originalEvent:f}))}_contextRestored(f){this._setupPainter(),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight)),this._updateTerrain(),this.style.reloadModels(),this.style.clearSources(),this._update(),this.fire(new r.z("webglcontextrestored",{originalEvent:f}))}_onMapScroll(f){if(f.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}idle(){return!this.isMoving()&&this.loaded()}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}frameReady(){return this.loaded()&&!this._placementDirty}_update(f){return this.style?(this._styleDirty=this._styleDirty||f,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(f){return this._update(),this._renderTaskQueue.add(f)}_cancelRenderFrame(f){this._renderTaskQueue.remove(f)}_requestDomTask(f){!this.loaded()||this.loaded()&&!this.isMoving()?f():this._domRenderTaskQueue.add(f)}_render(f){let o;this.fire(new r.z("renderstart")),++this._frameId;const l=this.painter.context.extTimerQuery,m=r.q.now(),y=this.painter.context.gl;if(this.listens("gpu-timing-frame")&&(o=y.createQuery(),y.beginQuery(l.TIME_ELAPSED_EXT,o)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],performance.now())),this._renderTaskQueue.run(f),this._domRenderTaskQueue.run(f),this._removed)return;this._updateProjectionTransition();const w=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const H=this.transform.zoom,G=this.transform.pitch,Z=r.q.now(),X=new r.a8(H,{now:Z,fadeDuration:w,pitch:G,transition:this.style.transition});this.style.update(X)}this.style&&this.style.hasFogTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let E=!1;this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),E=this._updateAverageElevation(m),this.style.updateSources(this.transform),this._forceMarkerAndPopupUpdate()):E=this._updateAverageElevation(m);const O=this.style&&this.style._updatePlacement(this.painter,this.painter.transform,this.showCollisionBoxes,w,this._crossSourceCollisions,this.painter.replacementSource,this._scaleFactorChanged);if(this._scaleFactorChanged&&(this._scaleFactorChanged=!1),O&&(this._placementDirty=O.needsRerender),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showParseStatus:this.showParseStatus,wireframe:{terrain:this.showTerrainWireframe,layers2D:this.showLayers2DWireframe,layers3D:this.showLayers3DWireframe},showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:w,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new r.z("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,M.mark(C.load),this.fire(new r.z("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&(this.style.snow||this.style.rain)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),o){const H=r.q.now()-m;y.endQuery(l.TIME_ELAPSED_EXT),setTimeout(()=>{const G=y.getQueryParameter(o,y.QUERY_RESULT)/1e6;y.deleteQuery(o),this.fire(new r.z("gpu-timing-frame",{cpuTime:H,gpuTime:G}))},50)}if(this.listens("gpu-timing-layer")){const H=this.painter.collectGpuTimers();setTimeout(()=>{const G=this.painter.queryGpuTimers(H);this.fire(new r.z("gpu-timing-layer",{layerTimes:G}))},50)}if(this.listens("gpu-timing-deferred-render")){const H=this.painter.collectDeferredRenderGpuQueries();setTimeout(()=>{const G=this.painter.queryGpuTimeDeferredRender(H);this.fire(new r.z("gpu-timing-deferred-render",{gpuTime:G}))},50)}const $=this._sourcesDirty||this._styleDirty||this._placementDirty||E;if($||this._repaint)this.triggerRepaint();else{const H=this.idle();if(H&&(E=this._updateAverageElevation(m,!0)),E)this.triggerRepaint();else if(this._triggerFrame(!1),H&&(this.fire(new r.z("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const G=this._calculateSpeedIndex();this.fire(new r.z("speedindexcompleted",{speedIndex:G})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||$||(this._fullyLoaded=!0,M.mark(C.fullLoad),this._performanceMetricsCollection&&Bt(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(f){for(const o of this._markers)f&&!this.getRenderWorldCopies()&&(o._lngLat=o._lngLat.wrap()),o._update();for(const o of this._popups)!f||this.getRenderWorldCopies()||o._trackPointer||(o._lngLat=o._lngLat.wrap()),o._update()}_updateAverageElevation(f,o=!1){const l=y=>(this.transform.averageElevation=y,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return this.transform.averageElevation!==0&&l(0);const m=this.transform.elevation&&this.transform.elevation.exaggeration()!==this._averageElevationExaggeration;if(m||(o||f-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(f)){const y=this.transform.averageElevation;let w=this.transform.sampleAverageElevation();this.transform.elevation!=null&&(this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(w)?w=0:this._averageElevationLastSampledAt=f;const E=Math.abs(y-w);if(E>1){if(this._isInitialLoad||m)return this._averageElevation.jumpTo(w),l(w);this._averageElevation.easeTo(w,f,300)}else if(E>1e-4)return this._averageElevation.jumpTo(w),l(w)}return!!this._averageElevation.isEasing(f)&&l(this._averageElevation.getValue(f))}_authenticate(){Fe(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,f=>{if(f&&(f.message===ke||f.status===401)){const o=this.painter.context.gl;Re(o,!1),this._logoControl instanceof Ks&&this._logoControl._updateLogo(),o&&o.clear(o.DEPTH_BUFFER_BIT|o.COLOR_BUFFER_BIT|o.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new r.y(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),wt(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_postStyleLoadEvent(){this.style.globalId&&Nt(this._requestManager._customAccessToken,{map:this,skuToken:this._requestManager._skuToken,style:this.style.globalId,importedStyles:this.style.getImportGlobalIds()})}_updateTerrain(){const f=this._isDragging();this.painter.updateTerrain(this.style,f)}_calculateSpeedIndex(){const f=this.painter.canvasCopy(),o=this.painter.getCanvasCopiesAndTimestamps();o.timeStamps.push(performance.now());const l=this.painter.context.gl,m=l.createFramebuffer();function y(w){l.framebufferTexture2D(l.FRAMEBUFFER,l.COLOR_ATTACHMENT0,l.TEXTURE_2D,w,0);const E=new Uint8Array(l.drawingBufferWidth*l.drawingBufferHeight*4);return l.readPixels(0,0,l.drawingBufferWidth,l.drawingBufferHeight,l.RGBA,l.UNSIGNED_BYTE,E),E}return l.bindFramebuffer(l.FRAMEBUFFER,m),this._canvasPixelComparison(y(f),o.canvasCopies.map(y),o.timeStamps)}_canvasPixelComparison(f,o,l){let m=l[1]-l[0];const y=f.length/4;for(let w=0;w<o.length;w++){const E=o[w];let O=0;for(let $=0;$<E.length;$+=4)E[$]===f[$]&&E[$+1]===f[$+1]&&E[$+2]===f[$+2]&&E[$+3]===f[$+3]&&(O+=1);m+=(l[w+2]-l[w+1])*(1-O/y)}return m}remove(){this._hash&&this._hash.remove();for(const o of this._controls)o.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.indoor.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),window.removeEventListener("resize",this._onWindowResize,!1),window.removeEventListener("orientationchange",this._onWindowResize,!1),window.removeEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),window.removeEventListener("online",this._onWindowOnline,!1),window.removeEventListener("visibilitychange",this._onVisibilityChange,!1);const f=this.painter.context.gl.getExtension("WEBGL_lose_context");f&&f.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),cn.delete(this.painter.context.gl),Wt.remove(),Pe.remove(),this._removed=!0,this.fire(new r.z("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(f){this._renderNextFrame=this._renderNextFrame||f,this.style&&!this._frame&&(this._frame=r.q.frame(o=>{const l=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,l&&this._render(o)}))}_preloadTiles(f){const o=this.style?this.style.getSourceCaches():[];return r.bl(o,(l,m)=>l._preloadTiles(f,m),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(f){this._trackResize&&this.resize({originalEvent:f})._update()}_onVisibilityChange(){document.visibilityState==="hidden"&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(f){this._showTileBoundaries!==f&&(this._showTileBoundaries=f,this._tp.refreshUI(),this._update())}get showParseStatus(){return!!this._showParseStatus}set showParseStatus(f){this._showParseStatus!==f&&(this._showParseStatus=f,this._tp.refreshUI(),this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(f){this._showTerrainWireframe!==f&&(this._showTerrainWireframe=f,this._tp.refreshUI(),this._update())}get showLayers2DWireframe(){return!!this._showLayers2DWireframe}set showLayers2DWireframe(f){this._showLayers2DWireframe!==f&&(this._showLayers2DWireframe=f,this._tp.refreshUI(),this._update())}get showLayers3DWireframe(){return!!this._showLayers3DWireframe}set showLayers3DWireframe(f){this._showLayers3DWireframe!==f&&(this._showLayers3DWireframe=f,this._tp.refreshUI(),this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(f){this._speedIndexTiming!==f&&(this._speedIndexTiming=f,this._update())}get showPadding(){return!!this._showPadding}set showPadding(f){this._showPadding!==f&&(this._showPadding=f,this._tp.refreshUI(),this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(f){this._showCollisionBoxes!==f&&(this._showCollisionBoxes=f,this._tp.refreshUI(),f?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(f){this._showOverdrawInspector!==f&&(this._showOverdrawInspector=f,this._tp.refreshUI(),this._update())}get repaint(){return!!this._repaint}set repaint(f){this._repaint!==f&&(this._repaint=f,this._tp.refreshUI(),this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(f){this._vertices=f,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(f){this._showTileAABBs!==f&&(this._showTileAABBs=f,this._tp.refreshUI(),f&&this._update())}_setCacheLimits(f,o){r.dG(f,o)}get version(){return S}},NavigationControl:class{constructor(f={}){this.options=r.l({},xw,f),this._container=N("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",o=>o.preventDefault()),this.options.showZoom&&(r.aP(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",o=>{this._map&&this._map.zoomIn({},{originalEvent:o})}),N("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",o=>{this._map&&this._map.zoomOut({},{originalEvent:o})}),N("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(r.aP(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",o=>{const l=this._map;l&&(this.options.visualizePitch?l.resetNorthPitch({},{originalEvent:o}):l.resetNorth({},{originalEvent:o}))}),this._compassIcon=N("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const f=this._map;if(!f)return;const o=f.getZoom(),l=o===f.getMaxZoom(),m=o===f.getMinZoom();this._zoomInButton.disabled=l,this._zoomOutButton.disabled=m,this._zoomInButton.setAttribute("aria-disabled",l.toString()),this._zoomOutButton.setAttribute("aria-disabled",m.toString())}_rotateCompassArrow(){const f=this._map;if(!f)return;const o=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(f.transform.pitch*(Math.PI/180)),.5)}) rotateX(${f.transform.pitch}deg) rotateZ(${f.transform.angle*(180/Math.PI)}deg)`:`rotate(${f.transform.angle*(180/Math.PI)}deg)`;f._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=o)})}onAdd(f){return this._map=f,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),f.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&f.on("pitch",this._rotateCompassArrow),f.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new ww(f,this._compass,this.options.visualizePitch)),this._container}onRemove(){const f=this._map;f&&(this._container.remove(),this.options.showZoom&&f.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&f.off("pitch",this._rotateCompassArrow),f.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(f,o){const l=N("button",f,this._container);return l.type="button",l.addEventListener("click",o),l}_setButtonTitle(f,o){if(!this._map)return;const l=this._map._getUIString(`NavigationControl.${o}`);f.setAttribute("aria-label",l),f.firstElementChild&&f.firstElementChild.setAttribute("title",l)}},GeolocateControl:class extends r.E{constructor(f={}){super();const o=navigator.geolocation;this.options=r.l({geolocation:o},fs,f),r.aP(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=Ip(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(f){return this._map=f,this._container=N("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){this._geolocationWatchID!==void 0&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(f){const o=(l=!!this.options.geolocation)=>{this._supportsGeolocation=l,f(l)};this._supportsGeolocation!==void 0?f(this._supportsGeolocation):navigator.permissions!==void 0?navigator.permissions.query({name:"geolocation"}).then(l=>o(l.state!=="denied")).catch(()=>o()):o()}_isOutOfMapMaxBounds(f){const o=this._map.getMaxBounds(),l=f.coords;return!!o&&(l.longitude<o.getWest()||l.longitude>o.getEast()||l.latitude<o.getSouth()||l.latitude>o.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(f){if(this._map){if(this._isOutOfMapMaxBounds(f))return this._setErrorState(),this.fire(new r.z("outofmaxbounds",f)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=f,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(f),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(f),this.options.showUserLocation&&this._userLocationDotMarker.removeClassName("mapboxgl-user-location-dot-stale"),this.fire(new r.z("geolocate",f)),this._finish()}}_updateCamera(f){const o=new r.bO(f.coords.longitude,f.coords.latitude),l=f.coords.accuracy,m=this._map.getBearing(),y=r.l({bearing:m},this.options.fitBoundsOptions);this._map.fitBounds(o.toBounds(l),y,{geolocateSource:!0})}_updateMarker(f){if(f){const o=new r.bO(f.coords.longitude,f.coords.latitude);this._accuracyCircleMarker.setLngLat(o).addTo(this._map),this._userLocationDotMarker.setLngLat(o).addTo(this._map),this._accuracy=f.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const f=this._map.transform,o=r.bH(1,f._center.lat)*f.worldSize,l=Math.ceil(2*this._accuracy*o);this._circleElement.style.width=`${l}px`,this._circleElement.style.height=`${l}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&typeof this._heading=="number"?(this._userLocationDotMarker.setRotation(this._heading),this._userLocationDotMarker.addClassName("mapboxgl-user-location-show-heading")):(this._userLocationDotMarker.removeClassName("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(f){if(this._map){if(this.options.trackUserLocation)if(f.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const o=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",o),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",o),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(f.code===3&&this._noTimeout)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._userLocationDotMarker.addClassName("mapboxgl-user-location-dot-stale"),this.fire(new r.z("error",f)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(f){if(this._map!==void 0){if(this._container.addEventListener("contextmenu",o=>o.preventDefault()),this._geolocateButton=N("button","mapboxgl-ctrl-geolocate",this._container),N("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",f===!1){r.w("Geolocation support is not available so the GeolocateControl will be disabled.");const o=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",o),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",o)}else{const o=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",o),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",o)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=N("div","mapboxgl-user-location"),this._dotElement.appendChild(N("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(N("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new Na({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=N("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Na({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",o=>{o.geolocateSource||this._watchState!=="ACTIVE_LOCK"||o.originalEvent&&o.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new r.z("trackuserlocationend")))})}}_onDeviceOrientation(f){this._userLocationDotMarker&&(f.webkitCompassHeading?this._heading=f.webkitCompassHeading:f.absolute===!0&&(this._heading=-1*f.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return r.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new r.z("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new r.z("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new r.z("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let f;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(f={maximumAge:6e5,timeout:0},this._noTimeout=!0):(f=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,f),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=window.setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const f=()=>{"ondeviceorientationabsolute"in window?window.addEventListener("deviceorientationabsolute",this._onDeviceOrientation):window.addEventListener("deviceorientation",this._onDeviceOrientation)};typeof DeviceMotionEvent<"u"&&typeof DeviceMotionEvent.requestPermission=="function"?DeviceOrientationEvent.requestPermission().then(o=>{o==="granted"&&f()}).catch(console.error):f()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),window.removeEventListener("deviceorientation",this._onDeviceOrientation),window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:Rp,ScaleControl:class{constructor(f={}){this.options=r.l({},Ds,f),this._isNumberFormatSupported=function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"short",unit:"meter"}),!0}catch{return!1}}(),r.aP(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const f=this.options.maxWidth||100,o=this._map,l=o._containerHeight/2,m=o._containerWidth/2-f/2,y=o.unproject([m,l]),w=o.unproject([m+f,l]),E=y.distanceTo(w);if(this.options.unit==="imperial"){const O=3.2808*E;O>5280?this._setScale(f,O/5280,"mile"):this._setScale(f,O,"foot")}else this.options.unit==="nautical"?this._setScale(f,E/1852,"nautical-mile"):E>=1e3?this._setScale(f,E/1e3,"kilometer"):this._setScale(f,E,"meter")}_setScale(f,o,l){this._map._requestDomTask(()=>{const m=function(w){const E=Math.pow(10,`${Math.floor(w)}`.length-1);let O=w/E;return O=O>=10?10:O>=5?5:O>=3?3:O>=2?2:O>=1?1:function($){const H=Math.pow(10,Math.ceil(-Math.log($)/Math.LN10));return Math.round($*H)/H}(O),E*O}(o),y=m/o;this._container.innerHTML=this._isNumberFormatSupported&&l!=="nautical-mile"?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"short",unit:l}).format(m):`${m}&nbsp;${Ui[l]}`,this._container.style.width=f*y+"px"})}onAdd(f){return this._map=f,this._language=f.getLanguage(),this._container=N("div","mapboxgl-ctrl mapboxgl-ctrl-scale",f.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(f){this._language=f,this._update()}setUnit(f){this.options.unit=f,this._update()}},FullscreenControl:class{constructor(f={}){this._fullscreen=!1,f&&f.container&&(f.container instanceof HTMLElement?this._container=f.container:r.w("Full screen control 'container' must be a DOM element.")),r.aP(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(f){return this._map=f,this._container||(this._container=this._map.getContainer()),this._controlContainer=N("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",r.w("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!document.fullscreenEnabled&&!document.webkitFullscreenEnabled)}_setupUI(){const f=this._fullscreenButton=N("button","mapboxgl-ctrl-fullscreen",this._controlContainer);N("span","mapboxgl-ctrl-icon",f).setAttribute("aria-hidden","true"),f.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const f=this._getTitle();this._fullscreenButton.setAttribute("aria-label",f),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",f)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(document.fullscreenElement||document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?document.exitFullscreen?document.exitFullscreen():document.webkitCancelFullScreen&&document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends r.E{constructor(f){super(),this.options=r.l(Object.create(C0),f),r.aP(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(f&&f.className?f.className.trim().split(/\s+/):[])}addTo(f){return this._map&&this.remove(),this._map=f,this.options.closeOnClick&&f.on("preclick",this._onClose),this.options.closeOnMove&&f.on("move",this._onClose),f.on("remove",this.remove),this._update(),f._addPopup(this),this._focusFirstElement(),this._trackPointer?(f.on("mousemove",this._onMouseEvent),f.on("mouseup",this._onMouseEvent),f._canvasContainer.classList.add("mapboxgl-track-pointer")):f.on("move",this._update),this.fire(new r.z("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const f=this._map;return f&&(f.off("move",this._update),f.off("move",this._onClose),f.off("preclick",this._onClose),f.off("click",this._onClose),f.off("remove",this.remove),f.off("mousemove",this._onMouseEvent),f.off("mouseup",this._onMouseEvent),f.off("drag",this._onMouseEvent),f._canvasContainer&&f._canvasContainer.classList.remove("mapboxgl-track-pointer"),f._removePopup(this),this._map=void 0),this.fire(new r.z("close")),this}getLngLat(){return this._lngLat}setLngLat(f){this._lngLat=r.bO.convert(f),this._pos=null,this._trackPointer=!1,this._update();const o=this._map;return o&&(o.on("move",this._update),o.off("mousemove",this._onMouseEvent),o._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const f=this._map;return f&&(f.off("move",this._update),f.on("mousemove",this._onMouseEvent),f.on("drag",this._onMouseEvent),f._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(f){return this.setDOMContent(document.createTextNode(f))}setHTML(f){const o=document.createDocumentFragment(),l=document.createElement("body");let m;for(l.innerHTML=f;m=l.firstChild,m;)o.appendChild(m);return this.setDOMContent(o)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(f){return this.options.maxWidth=f,this._update(),this}setDOMContent(f){let o=this._content;if(o)for(;o.hasChildNodes();)o.firstChild&&o.removeChild(o.firstChild);else o=this._content=N("div","mapboxgl-popup-content",this._container||void 0);if(o.appendChild(f),this.options.closeButton){const l=this._closeButton=N("button","mapboxgl-popup-close-button",o);l.type="button",l.setAttribute("aria-label","Close popup"),l.innerHTML='<span aria-hidden="true">&#215;</span>',l.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(f){return this._classList.add(f),this._updateClassList(),this}removeClassName(f){return this._classList.delete(f),this._updateClassList(),this}setOffset(f){return this.options.offset=f,this._update(),this}toggleClassName(f){let o;return this._classList.delete(f)?o=!1:(this._classList.add(f),o=!0),this._updateClassList(),o}_onMouseEvent(f){this._update(f.point)}_getAnchor(f){if(this.options.anchor)return this.options.anchor;const o=this._map,l=this._container,m=this._pos;if(!o||!l||!m)return"bottom";const y=l.offsetWidth,w=l.offsetHeight,E=m.x<y/2,O=m.x>o.transform.width-y/2;if(m.y+f<w)return E?"top-left":O?"top-right":"top";if(m.y>o.transform.height-w){if(E)return"bottom-left";if(O)return"bottom-right"}return E?"left":O?"right":"bottom"}_updateClassList(){const f=this._container;if(!f)return;const o=[...this._classList];o.push("mapboxgl-popup"),this._anchor&&o.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&o.push("mapboxgl-popup-track-pointer"),f.className=o.join(" ")}_update(f){const o=this._map,l=this._content;if(!o||!this._lngLat&&!this._trackPointer||!l)return;let m=this._container;if(m||(m=this._container=N("div","mapboxgl-popup",o.getContainer()),this._tip=N("div","mapboxgl-popup-tip",m),m.appendChild(l)),this.options.maxWidth&&m.style.maxWidth!==this.options.maxWidth&&(m.style.maxWidth=this.options.maxWidth),o.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Op(this._lngLat,this._pos,o.transform)),!this._trackPointer||f){const y=this._pos=this._trackPointer&&f instanceof r.P?f:o.project(this._lngLat),w=wv(this.options.offset),E=this._anchor=this._getAnchor(w.y),O=wv(this.options.offset,E),$=y.add(O).round();o._requestDomTask(()=>{this._container&&E&&(this._container.style.transform=`${ul[E]} translate(${$.x}px,${$.y}px)`)})}if(!this._marker&&o._showingGlobe()){const y=r.dH(o.transform,this._lngLat)?0:1;this._setOpacity(y)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const f=this._container.querySelector(ws);f&&f.focus()}_onClose(){this.remove()}_setOpacity(f){this._container&&(this._container.style.opacity=`${f}`),this._content&&(this._content.style.pointerEvents=f?"auto":"none")}},Marker:Na,Style:ba,LngLat:r.bO,LngLatBounds:r.az,Point:r.P,MercatorCoordinate:r.aa,FreeCameraOptions:Qf,Evented:r.E,config:r.e,prewarm:r.dM,clearPrewarmedResources:r.dN,get accessToken(){return r.e.ACCESS_TOKEN},set accessToken(f){r.e.ACCESS_TOKEN=f},get baseApiUrl(){return r.e.API_URL},set baseApiUrl(f){r.e.API_URL=f},get workerCount(){return r.dO.workerCount},set workerCount(f){r.dO.workerCount=f},get maxParallelImageRequests(){return r.e.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(f){r.e.MAX_PARALLEL_IMAGE_REQUESTS=f},clearStorage(f){r.dP(f)},get workerUrl(){return r.dQ.workerUrl},set workerUrl(f){r.dQ.workerUrl=f},get workerClass(){return r.dQ.workerClass},set workerClass(f){r.dQ.workerClass=f},get workerParams(){return r.dQ.workerParams},set workerParams(f){r.dQ.workerParams=f},get dracoUrl(){return r.dR()},set dracoUrl(f){r.dS(f)},get meshoptUrl(){return r.dT()},set meshoptUrl(f){r.dU(f)},setNow:r.q.setNow,restoreNow:r.q.restoreNow}});var _=d;return _})})(SB);var zge=SB.exports;const Ts=Xa(zge);var CB={exports:{}};(function(e){function t(C){if(C=Object.assign({},C),!(this instanceof t))throw new Error("MapboxLanguage needs to be called with the new keyword");this.setLanguage=this.setLanguage.bind(this),this._initialStyleUpdate=this._initialStyleUpdate.bind(this),this._defaultLanguage=C.defaultLanguage,this._isLanguageField=C.languageField||/^name_/,this._getLanguageField=C.getLanguageField||function(k){return k==="mul"?"name":`name_${k}`},this._languageSource=C.languageSource||null,this._languageTransform=C.languageTransform,this._excludedLayerIds=C.excludedLayerIds||[],this.supportedLanguages=C.supportedLanguages||["ar","de","en","es","fr","it","ja","ko","mul","pt","ru","vi","zh-Hans","zh-Hant"]}const i=/^\{name/;function a(C,M){const k=Array.isArray(M)&&M[0]==="get";return k&&i.test(M[1])&&console.warn("This plugin no longer supports the use of token syntax (e.g. {name}). Please use a get expression. See https://docs.mapbox.com/mapbox-gl-js/style-spec/expressions/ for more details."),k&&C.test(M[1])}function d(C,M,k){if(Array.isArray(M))for(let z=1;z<M.length;z++)Array.isArray(M[z])&&(a(C,M[z])&&(M[z][1]=k),d(C,M[z],k))}function p(C,M,k){if(a(C,M)&&(M[1]=k),d(C,M,k),M[0]==="get"&&M[1]==="name"){const z=M.slice();M=["coalesce",["get",k],z]}return M}function _(C,M,k,z){return M.layout&&M.layout["text-field"]&&z.indexOf(M.id)===-1?Object.assign({},M,{layout:Object.assign({},M.layout,{"text-field":p(C,M.layout["text-field"],k)})}):M}function r(C){const M=Object.keys(C.sources).filter(k=>{const z=C.sources[k].url;return z&&z.indexOf("mapbox.mapbox-streets-v8")>-1||/mapbox-streets-v[1-9][1-9]/.test(z)});if(!M.length)throw new Error('If using MapboxLanguage with a Mapbox style, the style must be based on vector tile version 8, e.g. "streets-v11"');return M[0]}t.prototype.setLanguage=function(C,M){if(this.supportedLanguages.indexOf(M)<0)throw new Error(`Language ${M} is not supported`);const k=this._languageSource||r(C);if(!k)return C;const z=this._getLanguageField(M),F=this._isLanguageField,B=this._excludedLayerIds,N=C.layers.map(U=>U.source===k?_(F,U,z,B):U),j=Object.assign({},C,{layers:N});return this._languageTransform?this._languageTransform(j,M):j},t.prototype._initialStyleUpdate=function(){const C=this._map.getStyle(),M=this._defaultLanguage||S(this.supportedLanguages);this._map.setStyle(this.setLanguage(C,M))};function S(C){const M=navigator.languages?navigator.languages[0]:navigator.language||navigator.userLanguage,k=M&&M.split("-");let z=M;return k.length>1&&(z=k[0]),C.indexOf(z)>-1?z:null}t.prototype.onAdd=function(C){return this._map=C,this._map.on("style.load",this._initialStyleUpdate),this._container=document.createElement("div"),this._container},t.prototype.onRemove=function(){this._map.off("style.load",this._initialStyleUpdate),this._map=void 0},e.exports=t})(CB);var Fge=CB.exports;const Nge=Xa(Fge),vM=hU("map",{state:()=>({map:null}),actions:{setMapConfig(e){this.$state={...this.$state,...e}}}}),Bge={className:"brp"},Vge=qe({__name:"brp",setup(e){const t=vM(),{map:i}=yD(t),a=Se(""),d=p=>{p==null||p.on("mousemove",_=>{const{lat:r,lng:S}=_.lngLat;if(r&&S){let C=`:${S.toFixed(3)} :${r.toFixed(3)}`;a.value=C}})};return qt(()=>i.value,p=>{d(p)}),(p,_)=>(ae(),Oe("div",Bge,pn(a.value),1))}}),_M=(e,t)=>{const i=e.__vccOpts||e;for(const[a,d]of t)i[a]=d;return i},$ge=_M(Vge,[["__scopeId","data-v-481e9284"]]),nC=function(e,t){const i={drag:[],click:[],mousemove:[],mousedown:[],mouseup:[],mouseout:[],keydown:[],keyup:[],touchstart:[],touchmove:[],touchend:[],tap:[]},a={on(p,_,r){if(i[p]===void 0)throw new Error(`Invalid event type: ${p}`);i[p].push({selector:_,fn:r})},render(p){t.store.featureChanged(p)}},d=function(p,_){const r=i[p];let S=r.length;for(;S--;){const C=r[S];if(C.selector(_)){C.fn.call(a,_)||t.store.render(),t.ui.updateMapClasses();break}}};return e.start.call(a),{render:e.render,stop(){e.stop&&e.stop()},trash(){e.trash&&(e.trash(),t.store.render())},combineFeatures(){e.combineFeatures&&e.combineFeatures()},uncombineFeatures(){e.uncombineFeatures&&e.uncombineFeatures()},drag(p){d("drag",p)},click(p){d("click",p)},mousemove(p){d("mousemove",p)},mousedown(p){d("mousedown",p)},mouseup(p){d("mouseup",p)},mouseout(p){d("mouseout",p)},keydown(p){d("keydown",p)},keyup(p){d("keyup",p)},touchstart(p){d("touchstart",p)},touchmove(p){d("touchmove",p)},touchend(p){d("touchend",p)},tap(p){d("tap",p)}}};var yM={},Ox={};Ox.RADIUS=6378137;Ox.FLATTENING=1/298.257223563;Ox.POLAR_RADIUS=63567523142e-4;var CO=Ox;yM.geometry=EB;yM.ring=rC;function EB(e){var t=0,i;switch(e.type){case"Polygon":return EO(e.coordinates);case"MultiPolygon":for(i=0;i<e.coordinates.length;i++)t+=EO(e.coordinates[i]);return t;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0;case"GeometryCollection":for(i=0;i<e.geometries.length;i++)t+=EB(e.geometries[i]);return t}}function EO(e){var t=0;if(e&&e.length>0){t+=Math.abs(rC(e[0]));for(var i=1;i<e.length;i++)t-=Math.abs(rC(e[i]))}return t}function rC(e){var t,i,a,d,p,_,r,S=0,C=e.length;if(C>2){for(r=0;r<C;r++)r===C-2?(d=C-2,p=C-1,_=0):r===C-1?(d=C-1,p=0,_=1):(d=r,p=r+1,_=r+2),t=e[d],i=e[p],a=e[_],S+=(CS(a[0])-CS(t[0]))*Math.sin(CS(i[1]));S=S*CO.RADIUS*CO.RADIUS/2}return S}function CS(e){return e*Math.PI/180}const Ma={CANVAS:"mapboxgl-canvas",CONTROL_BASE:"mapboxgl-ctrl",CONTROL_PREFIX:"mapboxgl-ctrl-",CONTROL_BUTTON:"mapbox-gl-draw_ctrl-draw-btn",CONTROL_BUTTON_LINE:"mapbox-gl-draw_line",CONTROL_BUTTON_POLYGON:"mapbox-gl-draw_polygon",CONTROL_BUTTON_POINT:"mapbox-gl-draw_point",CONTROL_BUTTON_TRASH:"mapbox-gl-draw_trash",CONTROL_BUTTON_COMBINE_FEATURES:"mapbox-gl-draw_combine",CONTROL_BUTTON_UNCOMBINE_FEATURES:"mapbox-gl-draw_uncombine",CONTROL_GROUP:"mapboxgl-ctrl-group",ATTRIBUTION:"mapboxgl-ctrl-attrib",ACTIVE_BUTTON:"active",BOX_SELECT:"mapbox-gl-draw_boxselect"},yl={HOT:"mapbox-gl-draw-hot",COLD:"mapbox-gl-draw-cold"},Ai={ADD:"add",MOVE:"move",DRAG:"drag",POINTER:"pointer",NONE:"none"},Ia={POLYGON:"polygon",LINE:"line_string",POINT:"point"},Br={FEATURE:"Feature",POLYGON:"Polygon",LINE_STRING:"LineString",POINT:"Point",FEATURE_COLLECTION:"FeatureCollection",MULTI_PREFIX:"Multi",MULTI_POINT:"MultiPoint",MULTI_LINE_STRING:"MultiLineString",MULTI_POLYGON:"MultiPolygon"},Lo={DRAW_LINE_STRING:"draw_line_string",DRAW_POLYGON:"draw_polygon",DRAW_POINT:"draw_point",SIMPLE_SELECT:"simple_select",DIRECT_SELECT:"direct_select"},pa={CREATE:"draw.create",DELETE:"draw.delete",UPDATE:"draw.update",SELECTION_CHANGE:"draw.selectionchange",MODE_CHANGE:"draw.modechange",ACTIONABLE:"draw.actionable",RENDER:"draw.render",COMBINE_FEATURES:"draw.combine",UNCOMBINE_FEATURES:"draw.uncombine"},Ry={MOVE:"move",CHANGE_PROPERTIES:"change_properties",CHANGE_COORDINATES:"change_coordinates"},Hs={FEATURE:"feature",MIDPOINT:"midpoint",VERTEX:"vertex"},gs={ACTIVE:"true",INACTIVE:"false"},MB=["scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate"],Uge=-90,oC=-85,jge=90,iC=85,Hge=-270,Gge=270,IB=Object.freeze(Object.defineProperty({__proto__:null,LAT_MAX:jge,LAT_MIN:Uge,LAT_RENDERED_MAX:iC,LAT_RENDERED_MIN:oC,LNG_MAX:Gge,LNG_MIN:Hge,activeStates:gs,classes:Ma,cursors:Ai,events:pa,geojsonTypes:Br,interactions:MB,meta:Hs,modes:Lo,sources:yl,types:Ia,updateActions:Ry},Symbol.toStringTag,{value:"Module"})),MO={Point:0,LineString:1,MultiLineString:1,Polygon:2};function Wge(e,t){const i=MO[e.geometry.type]-MO[t.geometry.type];return i===0&&e.geometry.type===Br.POLYGON?e.area-t.area:i}function AB(e){return e.map(t=>(t.geometry.type===Br.POLYGON&&(t.area=yM.geometry({type:Br.FEATURE,property:{},geometry:t.geometry})),t)).sort(Wge).map(t=>(delete t.area,t))}function kB(e,t=0){return[[e.point.x-t,e.point.y-t],[e.point.x+t,e.point.y+t]]}function Tl(e){if(this._items={},this._nums={},this._length=e?e.length:0,!!e)for(let t=0,i=e.length;t<i;t++)this.add(e[t]),e[t]!==void 0&&(typeof e[t]=="string"?this._items[e[t]]=t:this._nums[e[t]]=t)}Tl.prototype.add=function(e){return this.has(e)?this:(this._length++,typeof e=="string"?this._items[e]=this._length:this._nums[e]=this._length,this)};Tl.prototype.delete=function(e){return this.has(e)===!1?this:(this._length--,delete this._items[e],delete this._nums[e],this)};Tl.prototype.has=function(e){return typeof e!="string"&&typeof e!="number"?!1:this._items[e]!==void 0||this._nums[e]!==void 0};Tl.prototype.values=function(){const e=[];return Object.keys(this._items).forEach(t=>{e.push({k:t,v:this._items[t]})}),Object.keys(this._nums).forEach(t=>{e.push({k:JSON.parse(t),v:this._nums[t]})}),e.sort((t,i)=>t.v-i.v).map(t=>t.k)};Tl.prototype.clear=function(){return this._length=0,this._items={},this._nums={},this};const qge=[Hs.FEATURE,Hs.MIDPOINT,Hs.VERTEX],Hm={click:Kge,touch:Zge};function Kge(e,t,i){return PB(e,t,i,i.options.clickBuffer)}function Zge(e,t,i){return PB(e,t,i,i.options.touchBuffer)}function PB(e,t,i,a){if(i.map===null)return[];const d=e?kB(e,a):t,p={};i.options.styles&&(p.layers=i.options.styles.map(C=>C.id).filter(C=>i.map.getLayer(C)!=null));const _=i.map.queryRenderedFeatures(d,p).filter(C=>qge.indexOf(C.properties.meta)!==-1),r=new Tl,S=[];return _.forEach(C=>{const M=C.properties.id;r.has(M)||(r.add(M),S.push(C))}),AB(S)}function a1(e,t){const i=Hm.click(e,null,t),a={mouse:Ai.NONE};return i[0]&&(a.mouse=i[0].properties.active===gs.ACTIVE?Ai.MOVE:Ai.POINTER,a.feature=i[0].properties.meta),t.events.currentModeName().indexOf("draw")!==-1&&(a.mouse=Ai.ADD),t.ui.queueMapClasses(a),t.ui.updateMapClasses(),i[0]}function bM(e,t){const i=e.x-t.x,a=e.y-t.y;return Math.sqrt(i*i+a*a)}const Yge=4,Xge=12,Jge=500;function sC(e,t,i={}){const a=i.fineTolerance!=null?i.fineTolerance:Yge,d=i.grossTolerance!=null?i.grossTolerance:Xge,p=i.interval!=null?i.interval:Jge;e.point=e.point||t.point,e.time=e.time||t.time;const _=bM(e.point,t.point);return _<a||_<d&&t.time-e.time<p}const Qge=25,eve=250;function aC(e,t,i={}){const a=i.tolerance!=null?i.tolerance:Qge,d=i.interval!=null?i.interval:eve;return e.point=e.point||t.point,e.time=e.time||t.time,bM(e.point,t.point)<a&&t.time-e.time<d}let tve=(e,t=21)=>(i=t)=>{let a="",d=i|0;for(;d--;)a+=e[Math.random()*e.length|0];return a};const nve=tve("0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",32);function xM(){return nve()}const ma=function(e,t){this.ctx=e,this.properties=t.properties||{},this.coordinates=t.geometry.coordinates,this.id=t.id||xM(),this.type=t.geometry.type};ma.prototype.changed=function(){this.ctx.store.featureChanged(this.id)};ma.prototype.incomingCoords=function(e){this.setCoordinates(e)};ma.prototype.setCoordinates=function(e){this.coordinates=e,this.changed()};ma.prototype.getCoordinates=function(){return JSON.parse(JSON.stringify(this.coordinates))};ma.prototype.setProperty=function(e,t){this.properties[e]=t};ma.prototype.toGeoJSON=function(){return JSON.parse(JSON.stringify({id:this.id,type:Br.FEATURE,properties:this.properties,geometry:{coordinates:this.getCoordinates(),type:this.type}}))};ma.prototype.internal=function(e){const t={id:this.id,meta:Hs.FEATURE,"meta:type":this.type,active:gs.INACTIVE,mode:e};if(this.ctx.options.userProperties)for(const i in this.properties)t[`user_${i}`]=this.properties[i];return{type:Br.FEATURE,properties:t,geometry:{coordinates:this.getCoordinates(),type:this.type}}};const ih=function(e,t){ma.call(this,e,t)};ih.prototype=Object.create(ma.prototype);ih.prototype.isValid=function(){return typeof this.coordinates[0]=="number"&&typeof this.coordinates[1]=="number"};ih.prototype.updateCoordinate=function(e,t,i){arguments.length===3?this.coordinates=[t,i]:this.coordinates=[e,t],this.changed()};ih.prototype.getCoordinate=function(){return this.getCoordinates()};const Qc=function(e,t){ma.call(this,e,t)};Qc.prototype=Object.create(ma.prototype);Qc.prototype.isValid=function(){return this.coordinates.length>1};Qc.prototype.addCoordinate=function(e,t,i){this.changed();const a=parseInt(e,10);this.coordinates.splice(a,0,[t,i])};Qc.prototype.getCoordinate=function(e){const t=parseInt(e,10);return JSON.parse(JSON.stringify(this.coordinates[t]))};Qc.prototype.removeCoordinate=function(e){this.changed(),this.coordinates.splice(parseInt(e,10),1)};Qc.prototype.updateCoordinate=function(e,t,i){const a=parseInt(e,10);this.coordinates[a]=[t,i],this.changed()};const Ja=function(e,t){ma.call(this,e,t),this.coordinates=this.coordinates.map(i=>i.slice(0,-1))};Ja.prototype=Object.create(ma.prototype);Ja.prototype.isValid=function(){return this.coordinates.length===0?!1:this.coordinates.every(e=>e.length>2)};Ja.prototype.incomingCoords=function(e){this.coordinates=e.map(t=>t.slice(0,-1)),this.changed()};Ja.prototype.setCoordinates=function(e){this.coordinates=e,this.changed()};Ja.prototype.addCoordinate=function(e,t,i){this.changed();const a=e.split(".").map(p=>parseInt(p,10));this.coordinates[a[0]].splice(a[1],0,[t,i])};Ja.prototype.removeCoordinate=function(e){this.changed();const t=e.split(".").map(a=>parseInt(a,10)),i=this.coordinates[t[0]];i&&(i.splice(t[1],1),i.length<3&&this.coordinates.splice(t[0],1))};Ja.prototype.getCoordinate=function(e){const t=e.split(".").map(a=>parseInt(a,10)),i=this.coordinates[t[0]];return JSON.parse(JSON.stringify(i[t[1]]))};Ja.prototype.getCoordinates=function(){return this.coordinates.map(e=>e.concat([e[0]]))};Ja.prototype.updateCoordinate=function(e,t,i){this.changed();const a=e.split("."),d=parseInt(a[0],10),p=parseInt(a[1],10);this.coordinates[d]===void 0&&(this.coordinates[d]=[]),this.coordinates[d][p]=[t,i]};const rve={MultiPoint:ih,MultiLineString:Qc,MultiPolygon:Ja},Lx=(e,t,i,a,d)=>{const p=i.split("."),_=parseInt(p[0],10),r=p[1]?p.slice(1).join("."):null;return e[_][t](r,a,d)},ua=function(e,t){if(ma.call(this,e,t),delete this.coordinates,this.model=rve[t.geometry.type],this.model===void 0)throw new TypeError(`${t.geometry.type} is not a valid type`);this.features=this._coordinatesToFeatures(t.geometry.coordinates)};ua.prototype=Object.create(ma.prototype);ua.prototype._coordinatesToFeatures=function(e){const t=this.model.bind(this);return e.map(i=>new t(this.ctx,{id:xM(),type:Br.FEATURE,properties:{},geometry:{coordinates:i,type:this.type.replace("Multi","")}}))};ua.prototype.isValid=function(){return this.features.every(e=>e.isValid())};ua.prototype.setCoordinates=function(e){this.features=this._coordinatesToFeatures(e),this.changed()};ua.prototype.getCoordinate=function(e){return Lx(this.features,"getCoordinate",e)};ua.prototype.getCoordinates=function(){return JSON.parse(JSON.stringify(this.features.map(e=>e.type===Br.POLYGON?e.getCoordinates():e.coordinates)))};ua.prototype.updateCoordinate=function(e,t,i){Lx(this.features,"updateCoordinate",e,t,i),this.changed()};ua.prototype.addCoordinate=function(e,t,i){Lx(this.features,"addCoordinate",e,t,i),this.changed()};ua.prototype.removeCoordinate=function(e){Lx(this.features,"removeCoordinate",e),this.changed()};ua.prototype.getFeatures=function(){return this.features};function yo(e){this.map=e.map,this.drawConfig=JSON.parse(JSON.stringify(e.options||{})),this._ctx=e}yo.prototype.setSelected=function(e){return this._ctx.store.setSelected(e)};yo.prototype.setSelectedCoordinates=function(e){this._ctx.store.setSelectedCoordinates(e),e.reduce((t,i)=>(t[i.feature_id]===void 0&&(t[i.feature_id]=!0,this._ctx.store.get(i.feature_id).changed()),t),{})};yo.prototype.getSelected=function(){return this._ctx.store.getSelected()};yo.prototype.getSelectedIds=function(){return this._ctx.store.getSelectedIds()};yo.prototype.isSelected=function(e){return this._ctx.store.isSelected(e)};yo.prototype.getFeature=function(e){return this._ctx.store.get(e)};yo.prototype.select=function(e){return this._ctx.store.select(e)};yo.prototype.deselect=function(e){return this._ctx.store.deselect(e)};yo.prototype.deleteFeature=function(e,t={}){return this._ctx.store.delete(e,t)};yo.prototype.addFeature=function(e,t={}){return this._ctx.store.add(e,t)};yo.prototype.clearSelectedFeatures=function(){return this._ctx.store.clearSelected()};yo.prototype.clearSelectedCoordinates=function(){return this._ctx.store.clearSelectedCoordinates()};yo.prototype.setActionableState=function(e={}){const t={trash:e.trash||!1,combineFeatures:e.combineFeatures||!1,uncombineFeatures:e.uncombineFeatures||!1};return this._ctx.events.actionable(t)};yo.prototype.changeMode=function(e,t={},i={}){return this._ctx.events.changeMode(e,t,i)};yo.prototype.fire=function(e,t){return this._ctx.events.fire(e,t)};yo.prototype.updateUIClasses=function(e){return this._ctx.ui.queueMapClasses(e)};yo.prototype.activateUIButton=function(e){return this._ctx.ui.setActiveButton(e)};yo.prototype.featuresAt=function(e,t,i="click"){if(i!=="click"&&i!=="touch")throw new Error("invalid buffer type");return Hm[i](e,t,this._ctx)};yo.prototype.newFeature=function(e){const t=e.geometry.type;return t===Br.POINT?new ih(this._ctx,e):t===Br.LINE_STRING?new Qc(this._ctx,e):t===Br.POLYGON?new Ja(this._ctx,e):new ua(this._ctx,e)};yo.prototype.isInstanceOf=function(e,t){if(e===Br.POINT)return t instanceof ih;if(e===Br.LINE_STRING)return t instanceof Qc;if(e===Br.POLYGON)return t instanceof Ja;if(e==="MultiFeature")return t instanceof ua;throw new Error(`Unknown feature class: ${e}`)};yo.prototype.doRender=function(e){return this._ctx.store.featureChanged(e)};yo.prototype.onSetup=function(){};yo.prototype.onDrag=function(){};yo.prototype.onClick=function(){};yo.prototype.onMouseMove=function(){};yo.prototype.onMouseDown=function(){};yo.prototype.onMouseUp=function(){};yo.prototype.onMouseOut=function(){};yo.prototype.onKeyUp=function(){};yo.prototype.onKeyDown=function(){};yo.prototype.onTouchStart=function(){};yo.prototype.onTouchMove=function(){};yo.prototype.onTouchEnd=function(){};yo.prototype.onTap=function(){};yo.prototype.onStop=function(){};yo.prototype.onTrash=function(){};yo.prototype.onCombineFeature=function(){};yo.prototype.onUncombineFeature=function(){};yo.prototype.toDisplayFeatures=function(){throw new Error("You must overwrite toDisplayFeatures")};const RB={drag:"onDrag",click:"onClick",mousemove:"onMouseMove",mousedown:"onMouseDown",mouseup:"onMouseUp",mouseout:"onMouseOut",keyup:"onKeyUp",keydown:"onKeyDown",touchstart:"onTouchStart",touchmove:"onTouchMove",touchend:"onTouchEnd",tap:"onTap"},ove=Object.keys(RB);function ive(e){const t=Object.keys(e);return function(i,a={}){let d={};const p=t.reduce((r,S)=>(r[S]=e[S],r),new yo(i));function _(r){return S=>p[r](d,S)}return{start(){d=p.onSetup(a),ove.forEach(r=>{const S=RB[r];let C=()=>!1;e[S]&&(C=()=>!0),this.on(r,C,_(S))})},stop(){p.onStop(d)},trash(){p.onTrash(d)},combineFeatures(){p.onCombineFeatures(d)},uncombineFeatures(){p.onUncombineFeatures(d)},render(r,S){p.toDisplayFeatures(d,r,S)}}}}function sve(e){const t=Object.keys(e.options.modes).reduce((z,F)=>(z[F]=ive(e.options.modes[F]),z),{});let i={},a={};const d={};let p=null,_=null;d.drag=function(z,F){F({point:z.point,time:new Date().getTime()})?(e.ui.queueMapClasses({mouse:Ai.DRAG}),_.drag(z)):z.originalEvent.stopPropagation()},d.mousedrag=function(z){d.drag(z,F=>!sC(i,F))},d.touchdrag=function(z){d.drag(z,F=>!aC(a,F))},d.mousemove=function(z){if((z.originalEvent.buttons!==void 0?z.originalEvent.buttons:z.originalEvent.which)===1)return d.mousedrag(z);const B=a1(z,e);z.featureTarget=B,_.mousemove(z)},d.mousedown=function(z){i={time:new Date().getTime(),point:z.point};const F=a1(z,e);z.featureTarget=F,_.mousedown(z)},d.mouseup=function(z){const F=a1(z,e);z.featureTarget=F,sC(i,{point:z.point,time:new Date().getTime()})?_.click(z):_.mouseup(z)},d.mouseout=function(z){_.mouseout(z)},d.touchstart=function(z){if(!e.options.touchEnabled)return;a={time:new Date().getTime(),point:z.point};const F=Hm.touch(z,null,e)[0];z.featureTarget=F,_.touchstart(z)},d.touchmove=function(z){if(e.options.touchEnabled)return _.touchmove(z),d.touchdrag(z)},d.touchend=function(z){if(z.originalEvent.preventDefault(),!e.options.touchEnabled)return;const F=Hm.touch(z,null,e)[0];z.featureTarget=F,aC(a,{time:new Date().getTime(),point:z.point})?_.tap(z):_.touchend(z)};const r=z=>!(z===8||z===46||z>=48&&z<=57);d.keydown=function(z){(z.srcElement||z.target).classList.contains(Ma.CANVAS)&&((z.keyCode===8||z.keyCode===46)&&e.options.controls.trash?(z.preventDefault(),_.trash()):r(z.keyCode)?_.keydown(z):z.keyCode===49&&e.options.controls.point?S(Lo.DRAW_POINT):z.keyCode===50&&e.options.controls.line_string?S(Lo.DRAW_LINE_STRING):z.keyCode===51&&e.options.controls.polygon&&S(Lo.DRAW_POLYGON))},d.keyup=function(z){r(z.keyCode)&&_.keyup(z)},d.zoomend=function(){e.store.changeZoom()},d.data=function(z){if(z.dataType==="style"){const{setup:F,map:B,options:N,store:j}=e;N.styles.some(te=>B.getLayer(te.id))||(F.addLayers(),j.setDirty(),j.render())}};function S(z,F,B={}){_.stop();const N=t[z];if(N===void 0)throw new Error(`${z} is not valid`);p=z;const j=N(e,F);_=nC(j,e),B.silent||e.map.fire(pa.MODE_CHANGE,{mode:z}),e.store.setDirty(),e.store.render()}const C={trash:!1,combineFeatures:!1,uncombineFeatures:!1};function M(z){let F=!1;Object.keys(z).forEach(B=>{if(C[B]===void 0)throw new Error("Invalid action type");C[B]!==z[B]&&(F=!0),C[B]=z[B]}),F&&e.map.fire(pa.ACTIONABLE,{actions:C})}return{start(){p=e.options.defaultMode,_=nC(t[p](e),e)},changeMode:S,actionable:M,currentModeName(){return p},currentModeRender(z,F){return _.render(z,F)},fire(z,F){e.map&&e.map.fire(z,F)},addEventListeners(){e.map.on("mousemove",d.mousemove),e.map.on("mousedown",d.mousedown),e.map.on("mouseup",d.mouseup),e.map.on("data",d.data),e.map.on("touchmove",d.touchmove),e.map.on("touchstart",d.touchstart),e.map.on("touchend",d.touchend),e.container.addEventListener("mouseout",d.mouseout),e.options.keybindings&&(e.container.addEventListener("keydown",d.keydown),e.container.addEventListener("keyup",d.keyup))},removeEventListeners(){e.map.off("mousemove",d.mousemove),e.map.off("mousedown",d.mousedown),e.map.off("mouseup",d.mouseup),e.map.off("data",d.data),e.map.off("touchmove",d.touchmove),e.map.off("touchstart",d.touchstart),e.map.off("touchend",d.touchend),e.container.removeEventListener("mouseout",d.mouseout),e.options.keybindings&&(e.container.removeEventListener("keydown",d.keydown),e.container.removeEventListener("keyup",d.keyup))},trash(z){_.trash(z)},combineFeatures(){_.combineFeatures()},uncombineFeatures(){_.uncombineFeatures()},getMode(){return p}}}function Oy(e){return[].concat(e).filter(t=>t!==void 0)}function ave(){const e=this;if(!(e.ctx.map&&e.ctx.map.getSource(yl.HOT)!==void 0))return S();const i=e.ctx.events.currentModeName();e.ctx.ui.queueMapClasses({mode:i});let a=[],d=[];e.isDirty?d=e.getAllIds():(a=e.getChangedIds().filter(C=>e.get(C)!==void 0),d=e.sources.hot.filter(C=>C.properties.id&&a.indexOf(C.properties.id)===-1&&e.get(C.properties.id)!==void 0).map(C=>C.properties.id)),e.sources.hot=[];const p=e.sources.cold.length;e.sources.cold=e.isDirty?[]:e.sources.cold.filter(C=>{const M=C.properties.id||C.properties.parent;return a.indexOf(M)===-1});const _=p!==e.sources.cold.length||d.length>0;a.forEach(C=>r(C,"hot")),d.forEach(C=>r(C,"cold"));function r(C,M){const z=e.get(C).internal(i);e.ctx.events.currentModeRender(z,F=>{F.properties.mode=i,e.sources[M].push(F)})}_&&e.ctx.map.getSource(yl.COLD).setData({type:Br.FEATURE_COLLECTION,features:e.sources.cold}),e.ctx.map.getSource(yl.HOT).setData({type:Br.FEATURE_COLLECTION,features:e.sources.hot}),S();function S(){e.isDirty=!1,e.clearChangedIds()}}function yi(e){this._features={},this._featureIds=new Tl,this._selectedFeatureIds=new Tl,this._selectedCoordinates=[],this._changedFeatureIds=new Tl,this._emitSelectionChange=!1,this._mapInitialConfig={},this.ctx=e,this.sources={hot:[],cold:[]};let t;this.render=()=>{t||(t=requestAnimationFrame(()=>{t=null,ave.call(this),this._emitSelectionChange&&(this.ctx.events.fire(pa.SELECTION_CHANGE,{features:this.getSelected().map(i=>i.toGeoJSON()),points:this.getSelectedCoordinates().map(i=>({type:Br.FEATURE,properties:{},geometry:{type:Br.POINT,coordinates:i.coordinates}}))}),this._emitSelectionChange=!1),this.ctx.events.fire(pa.RENDER,{})}))},this.isDirty=!1}yi.prototype.createRenderBatch=function(){const e=this.render;let t=0;return this.render=function(){t++},()=>{this.render=e,t>0&&this.render()}};yi.prototype.setDirty=function(){return this.isDirty=!0,this};yi.prototype.featureCreated=function(e,t={}){if(this._changedFeatureIds.add(e),(t.silent!=null?t.silent:this.ctx.options.suppressAPIEvents)!==!0){const a=this.get(e);this.ctx.events.fire(pa.CREATE,{features:[a.toGeoJSON()]})}return this};yi.prototype.featureChanged=function(e,t={}){return this._changedFeatureIds.add(e),(t.silent!=null?t.silent:this.ctx.options.suppressAPIEvents)!==!0&&this.ctx.events.fire(pa.UPDATE,{action:t.action?t.action:Ry.CHANGE_COORDINATES,features:[this.get(e).toGeoJSON()]}),this};yi.prototype.getChangedIds=function(){return this._changedFeatureIds.values()};yi.prototype.clearChangedIds=function(){return this._changedFeatureIds.clear(),this};yi.prototype.getAllIds=function(){return this._featureIds.values()};yi.prototype.add=function(e,t={}){return this._features[e.id]=e,this._featureIds.add(e.id),this.featureCreated(e.id,{silent:t.silent}),this};yi.prototype.delete=function(e,t={}){const i=[];return Oy(e).forEach(a=>{this._featureIds.has(a)&&(this._featureIds.delete(a),this._selectedFeatureIds.delete(a),t.silent||i.indexOf(this._features[a])===-1&&i.push(this._features[a].toGeoJSON()),delete this._features[a],this.isDirty=!0)}),i.length&&this.ctx.events.fire(pa.DELETE,{features:i}),OB(this,t),this};yi.prototype.get=function(e){return this._features[e]};yi.prototype.getAll=function(){return Object.keys(this._features).map(e=>this._features[e])};yi.prototype.select=function(e,t={}){return Oy(e).forEach(i=>{this._selectedFeatureIds.has(i)||(this._selectedFeatureIds.add(i),this._changedFeatureIds.add(i),t.silent||(this._emitSelectionChange=!0))}),this};yi.prototype.deselect=function(e,t={}){return Oy(e).forEach(i=>{this._selectedFeatureIds.has(i)&&(this._selectedFeatureIds.delete(i),this._changedFeatureIds.add(i),t.silent||(this._emitSelectionChange=!0))}),OB(this,t),this};yi.prototype.clearSelected=function(e={}){return this.deselect(this._selectedFeatureIds.values(),{silent:e.silent}),this};yi.prototype.setSelected=function(e,t={}){return e=Oy(e),this.deselect(this._selectedFeatureIds.values().filter(i=>e.indexOf(i)===-1),{silent:t.silent}),this.select(e.filter(i=>!this._selectedFeatureIds.has(i)),{silent:t.silent}),this};yi.prototype.setSelectedCoordinates=function(e){return this._selectedCoordinates=e,this._emitSelectionChange=!0,this};yi.prototype.clearSelectedCoordinates=function(){return this._selectedCoordinates=[],this._emitSelectionChange=!0,this};yi.prototype.getSelectedIds=function(){return this._selectedFeatureIds.values()};yi.prototype.getSelected=function(){return this.getSelectedIds().map(e=>this.get(e))};yi.prototype.getSelectedCoordinates=function(){return this._selectedCoordinates.map(t=>({coordinates:this.get(t.feature_id).getCoordinate(t.coord_path)}))};yi.prototype.isSelected=function(e){return this._selectedFeatureIds.has(e)};yi.prototype.setFeatureProperty=function(e,t,i,a={}){this.get(e).setProperty(t,i),this.featureChanged(e,{silent:a.silent,action:Ry.CHANGE_PROPERTIES})};function OB(e,t={}){const i=e._selectedCoordinates.filter(a=>e._selectedFeatureIds.has(a.feature_id));e._selectedCoordinates.length!==i.length&&!t.silent&&(e._emitSelectionChange=!0),e._selectedCoordinates=i}yi.prototype.storeMapConfig=function(){MB.forEach(e=>{this.ctx.map[e]&&(this._mapInitialConfig[e]=this.ctx.map[e].isEnabled())})};yi.prototype.restoreMapConfig=function(){Object.keys(this._mapInitialConfig).forEach(e=>{this._mapInitialConfig[e]?this.ctx.map[e].enable():this.ctx.map[e].disable()})};yi.prototype.getInitialConfigValue=function(e){return this._mapInitialConfig[e]!==void 0?this._mapInitialConfig[e]:!0};const lve=["mode","feature","mouse"];function cve(e){const t={};let i=null,a={mode:null,feature:null,mouse:null},d={mode:null,feature:null,mouse:null};function p(){_({mode:null,feature:null,mouse:null}),r()}function _(F){d=Object.assign(d,F)}function r(){if(!e.container)return;const F=[],B=[];lve.forEach(N=>{d[N]!==a[N]&&(F.push(`${N}-${a[N]}`),d[N]!==null&&B.push(`${N}-${d[N]}`))}),F.length>0&&e.container.classList.remove(...F),B.length>0&&e.container.classList.add(...B),a=Object.assign(a,d)}function S(F,B={}){const N=document.createElement("button");return N.className=`${Ma.CONTROL_BUTTON} ${B.className}`,N.setAttribute("title",B.title),B.container.appendChild(N),N.addEventListener("click",j=>{if(j.preventDefault(),j.stopPropagation(),j.target===i){C(),B.onDeactivate();return}M(F),B.onActivate()},!0),N}function C(){i&&(i.classList.remove(Ma.ACTIVE_BUTTON),i=null)}function M(F){C();const B=t[F];B&&B&&F!=="trash"&&(B.classList.add(Ma.ACTIVE_BUTTON),i=B)}function k(){const F=e.options.controls,B=document.createElement("div");return B.className=`${Ma.CONTROL_GROUP} ${Ma.CONTROL_BASE}`,F&&(F[Ia.LINE]&&(t[Ia.LINE]=S(Ia.LINE,{container:B,className:Ma.CONTROL_BUTTON_LINE,title:`LineString tool ${e.options.keybindings?"(l)":""}`,onActivate:()=>e.events.changeMode(Lo.DRAW_LINE_STRING),onDeactivate:()=>e.events.trash()})),F[Ia.POLYGON]&&(t[Ia.POLYGON]=S(Ia.POLYGON,{container:B,className:Ma.CONTROL_BUTTON_POLYGON,title:`Polygon tool ${e.options.keybindings?"(p)":""}`,onActivate:()=>e.events.changeMode(Lo.DRAW_POLYGON),onDeactivate:()=>e.events.trash()})),F[Ia.POINT]&&(t[Ia.POINT]=S(Ia.POINT,{container:B,className:Ma.CONTROL_BUTTON_POINT,title:`Marker tool ${e.options.keybindings?"(m)":""}`,onActivate:()=>e.events.changeMode(Lo.DRAW_POINT),onDeactivate:()=>e.events.trash()})),F.trash&&(t.trash=S("trash",{container:B,className:Ma.CONTROL_BUTTON_TRASH,title:"Delete",onActivate:()=>{e.events.trash()}})),F.combine_features&&(t.combine_features=S("combineFeatures",{container:B,className:Ma.CONTROL_BUTTON_COMBINE_FEATURES,title:"Combine",onActivate:()=>{e.events.combineFeatures()}})),F.uncombine_features&&(t.uncombine_features=S("uncombineFeatures",{container:B,className:Ma.CONTROL_BUTTON_UNCOMBINE_FEATURES,title:"Uncombine",onActivate:()=>{e.events.uncombineFeatures()}}))),B}function z(){Object.keys(t).forEach(F=>{const B=t[F];B.parentNode&&B.parentNode.removeChild(B),delete t[F]})}return{setActiveButton:M,queueMapClasses:_,updateMapClasses:r,clearMapClasses:p,addButtons:k,removeButtons:z}}function uve(e){let t=null,i=null;const a={onRemove(){return e.map.off("load",a.connect),clearInterval(i),a.removeLayers(),e.store.restoreMapConfig(),e.ui.removeButtons(),e.events.removeEventListeners(),e.ui.clearMapClasses(),e.boxZoomInitial&&e.map.boxZoom.enable(),e.map=null,e.container=null,e.store=null,t&&t.parentNode&&t.parentNode.removeChild(t),t=null,this},connect(){e.map.off("load",a.connect),clearInterval(i),a.addLayers(),e.store.storeMapConfig(),e.events.addEventListeners()},onAdd(d){if(e.map=d,e.events=sve(e),e.ui=cve(e),e.container=d.getContainer(),e.store=new yi(e),t=e.ui.addButtons(),e.options.boxSelect){e.boxZoomInitial=d.boxZoom.isEnabled(),d.boxZoom.disable();const p=d.dragPan.isEnabled();d.dragPan.disable(),d.dragPan.enable(),p||d.dragPan.disable()}return d.loaded()?a.connect():(d.on("load",a.connect),i=setInterval(()=>{d.loaded()&&a.connect()},16)),e.events.start(),t},addLayers(){e.map.addSource(yl.COLD,{data:{type:Br.FEATURE_COLLECTION,features:[]},type:"geojson"}),e.map.addSource(yl.HOT,{data:{type:Br.FEATURE_COLLECTION,features:[]},type:"geojson"}),e.options.styles.forEach(d=>{e.map.addLayer(d)}),e.store.setDirty(!0),e.store.render()},removeLayers(){e.options.styles.forEach(d=>{e.map.getLayer(d.id)&&e.map.removeLayer(d.id)}),e.map.getSource(yl.COLD)&&e.map.removeSource(yl.COLD),e.map.getSource(yl.HOT)&&e.map.removeSource(yl.HOT)}};return e.setup=a,a}const ES="#3bb2d0",h_="#fbb03b",IO="#fff",LB=[{id:"gl-draw-polygon-fill",type:"fill",filter:["all",["==","$type","Polygon"]],paint:{"fill-color":["case",["==",["get","active"],"true"],h_,ES],"fill-opacity":.1}},{id:"gl-draw-lines",type:"line",filter:["any",["==","$type","LineString"],["==","$type","Polygon"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":["case",["==",["get","active"],"true"],h_,ES],"line-dasharray":["case",["==",["get","active"],"true"],[.2,2],[2,0]],"line-width":2}},{id:"gl-draw-point-outer",type:"circle",filter:["all",["==","$type","Point"],["==","meta","feature"]],paint:{"circle-radius":["case",["==",["get","active"],"true"],7,5],"circle-color":IO}},{id:"gl-draw-point-inner",type:"circle",filter:["all",["==","$type","Point"],["==","meta","feature"]],paint:{"circle-radius":["case",["==",["get","active"],"true"],5,3],"circle-color":["case",["==",["get","active"],"true"],h_,ES]}},{id:"gl-draw-vertex-outer",type:"circle",filter:["all",["==","$type","Point"],["==","meta","vertex"],["!=","mode","simple_select"]],paint:{"circle-radius":["case",["==",["get","active"],"true"],7,5],"circle-color":IO}},{id:"gl-draw-vertex-inner",type:"circle",filter:["all",["==","$type","Point"],["==","meta","vertex"],["!=","mode","simple_select"]],paint:{"circle-radius":["case",["==",["get","active"],"true"],5,3],"circle-color":h_}},{id:"gl-draw-midpoint",type:"circle",filter:["all",["==","meta","midpoint"]],paint:{"circle-radius":3,"circle-color":h_}}];function Dx(e){return function(t){const i=t.featureTarget;return!i||!i.properties?!1:i.properties.meta===e}}function DB(e){return!e.originalEvent||!e.originalEvent.shiftKey?!1:e.originalEvent.button===0}function jf(e){return!e.featureTarget||!e.featureTarget.properties?!1:e.featureTarget.properties.active===gs.ACTIVE&&e.featureTarget.properties.meta===Hs.FEATURE}function wM(e){return!e.featureTarget||!e.featureTarget.properties?!1:e.featureTarget.properties.active===gs.INACTIVE&&e.featureTarget.properties.meta===Hs.FEATURE}function zx(e){return e.featureTarget===void 0}function SM(e){return!e.featureTarget||!e.featureTarget.properties?!1:e.featureTarget.properties.meta===Hs.FEATURE}function Ly(e){const t=e.featureTarget;return!t||!t.properties?!1:t.properties.meta===Hs.VERTEX}function $1(e){return e.originalEvent?e.originalEvent.shiftKey===!0:!1}function Fx(e){return e.keyCode===27}function Nx(e){return e.keyCode===13}function dve(){return!0}const hve=Object.freeze(Object.defineProperty({__proto__:null,isActiveFeature:jf,isEnterKey:Nx,isEscapeKey:Fx,isFeature:SM,isInactiveFeature:wM,isOfMetaType:Dx,isShiftDown:$1,isShiftMousedown:DB,isTrue:dve,isVertex:Ly,noTarget:zx},Symbol.toStringTag,{value:"Module"}));function Vd(e,t){this.x=e,this.y=t}Vd.prototype={clone(){return new Vd(this.x,this.y)},add(e){return this.clone()._add(e)},sub(e){return this.clone()._sub(e)},multByPoint(e){return this.clone()._multByPoint(e)},divByPoint(e){return this.clone()._divByPoint(e)},mult(e){return this.clone()._mult(e)},div(e){return this.clone()._div(e)},rotate(e){return this.clone()._rotate(e)},rotateAround(e,t){return this.clone()._rotateAround(e,t)},matMult(e){return this.clone()._matMult(e)},unit(){return this.clone()._unit()},perp(){return this.clone()._perp()},round(){return this.clone()._round()},mag(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals(e){return this.x===e.x&&this.y===e.y},dist(e){return Math.sqrt(this.distSqr(e))},distSqr(e){const t=e.x-this.x,i=e.y-this.y;return t*t+i*i},angle(){return Math.atan2(this.y,this.x)},angleTo(e){return Math.atan2(this.y-e.y,this.x-e.x)},angleWith(e){return this.angleWithSep(e.x,e.y)},angleWithSep(e,t){return Math.atan2(this.x*t-this.y*e,this.x*e+this.y*t)},_matMult(e){const t=e[0]*this.x+e[1]*this.y,i=e[2]*this.x+e[3]*this.y;return this.x=t,this.y=i,this},_add(e){return this.x+=e.x,this.y+=e.y,this},_sub(e){return this.x-=e.x,this.y-=e.y,this},_mult(e){return this.x*=e,this.y*=e,this},_div(e){return this.x/=e,this.y/=e,this},_multByPoint(e){return this.x*=e.x,this.y*=e.y,this},_divByPoint(e){return this.x/=e.x,this.y/=e.y,this},_unit(){return this._div(this.mag()),this},_perp(){const e=this.y;return this.y=this.x,this.x=-e,this},_rotate(e){const t=Math.cos(e),i=Math.sin(e),a=t*this.x-i*this.y,d=i*this.x+t*this.y;return this.x=a,this.y=d,this},_rotateAround(e,t){const i=Math.cos(e),a=Math.sin(e),d=t.x+i*(this.x-t.x)-a*(this.y-t.y),p=t.y+a*(this.x-t.x)+i*(this.y-t.y);return this.x=d,this.y=p,this},_round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},constructor:Vd};Vd.convert=function(e){if(e instanceof Vd)return e;if(Array.isArray(e))return new Vd(+e[0],+e[1]);if(e.x!==void 0&&e.y!==void 0)return new Vd(+e.x,+e.y);throw new Error("Expected [x, y] or {x, y} point format")};function TM(e,t){const i=t.getBoundingClientRect();return new Vd(e.clientX-i.left-(t.clientLeft||0),e.clientY-i.top-(t.clientTop||0))}function Gm(e,t,i,a){return{type:Br.FEATURE,properties:{meta:Hs.VERTEX,parent:e,coord_path:i,active:a?gs.ACTIVE:gs.INACTIVE},geometry:{type:Br.POINT,coordinates:t}}}function zB(e,t,i){const a=t.geometry.coordinates,d=i.geometry.coordinates;if(a[1]>iC||a[1]<oC||d[1]>iC||d[1]<oC)return null;const p={lng:(a[0]+d[0])/2,lat:(a[1]+d[1])/2};return{type:Br.FEATURE,properties:{meta:Hs.MIDPOINT,parent:e,lng:p.lng,lat:p.lat,coord_path:i.properties.coord_path},geometry:{type:Br.POINT,coordinates:[p.lng,p.lat]}}}function Bx(e,t={},i=null){const{type:a,coordinates:d}=e.geometry,p=e.properties&&e.properties.id;let _=[];a===Br.POINT?_.push(Gm(p,d,i,S(i))):a===Br.POLYGON?d.forEach((M,k)=>{r(M,i!==null?`${i}.${k}`:String(k))}):a===Br.LINE_STRING?r(d,i):a.indexOf(Br.MULTI_PREFIX)===0&&C();function r(M,k){let z="",F=null;M.forEach((B,N)=>{const j=k!=null?`${k}.${N}`:String(N),U=Gm(p,B,j,S(j));if(t.midpoints&&F){const Y=zB(p,F,U);Y&&_.push(Y)}F=U;const te=JSON.stringify(B);z!==te&&_.push(U),N===0&&(z=te)})}function S(M){return t.selectedPaths?t.selectedPaths.indexOf(M)!==-1:!1}function C(){const M=a.replace(Br.MULTI_PREFIX,"");d.forEach((k,z)=>{const F={type:Br.FEATURE,properties:e.properties,geometry:{type:M,coordinates:k}};_=_.concat(Bx(F,t,z))})}return _}const cc={enable(e){setTimeout(()=>{!e.map||!e.map.doubleClickZoom||!e._ctx||!e._ctx.store||!e._ctx.store.getInitialConfigValue||e._ctx.store.getInitialConfigValue("doubleClickZoom")&&e.map.doubleClickZoom.enable()},0)},disable(e){setTimeout(()=>{!e.map||!e.map.doubleClickZoom||e.map.doubleClickZoom.disable()},0)}},{LAT_MIN:Nb,LAT_MAX:Bb,LAT_RENDERED_MIN:AO,LAT_RENDERED_MAX:kO,LNG_MIN:PO,LNG_MAX:RO}=IB;function fve(e){const t={Point:0,LineString:1,Polygon:2,MultiPoint:1,MultiLineString:2,MultiPolygon:3}[e.geometry.type],i=[e.geometry.coordinates].flat(t),a=i.map(r=>r[0]),d=i.map(r=>r[1]),p=r=>Math.min.apply(null,r),_=r=>Math.max.apply(null,r);return[p(a),p(d),_(a),_(d)]}function CM(e,t){let i=Nb,a=Bb,d=Nb,p=Bb,_=RO,r=PO;e.forEach(C=>{const M=fve(C),k=M[1],z=M[3],F=M[0],B=M[2];k>i&&(i=k),z<a&&(a=z),z>d&&(d=z),k<p&&(p=k),F<_&&(_=F),B>r&&(r=B)});const S=t;return i+S.lat>kO&&(S.lat=kO-i),d+S.lat>Bb&&(S.lat=Bb-d),a+S.lat<AO&&(S.lat=AO-a),p+S.lat<Nb&&(S.lat=Nb-p),_+S.lng<=PO&&(S.lng+=Math.ceil(Math.abs(S.lng)/360)*360),r+S.lng>=RO&&(S.lng-=Math.ceil(Math.abs(S.lng)/360)*360),S}function EM(e,t){const i=CM(e.map(a=>a.toGeoJSON()),t);e.forEach(a=>{const d=a.getCoordinates(),p=C=>{const M={lng:C[0]+i.lng,lat:C[1]+i.lat};return[M.lng,M.lat]},_=C=>C.map(M=>p(M)),r=C=>C.map(M=>_(M));let S;a.type===Br.POINT?S=p(d):a.type===Br.LINE_STRING||a.type===Br.MULTI_POINT?S=d.map(p):a.type===Br.POLYGON||a.type===Br.MULTI_LINE_STRING?S=d.map(_):a.type===Br.MULTI_POLYGON&&(S=d.map(r)),a.incomingCoords(S)})}const di={};di.onSetup=function(e){const t={dragMoveLocation:null,boxSelectStartLocation:null,boxSelectElement:void 0,boxSelecting:!1,canBoxSelect:!1,dragMoving:!1,canDragMove:!1,initialDragPanState:this.map.dragPan.isEnabled(),initiallySelectedFeatureIds:e.featureIds||[]};return this.setSelected(t.initiallySelectedFeatureIds.filter(i=>this.getFeature(i)!==void 0)),this.fireActionable(),this.setActionableState({combineFeatures:!0,uncombineFeatures:!0,trash:!0}),t};di.fireUpdate=function(){this.fire(pa.UPDATE,{action:Ry.MOVE,features:this.getSelected().map(e=>e.toGeoJSON())})};di.fireActionable=function(){const e=this.getSelected(),t=e.filter(p=>this.isInstanceOf("MultiFeature",p));let i=!1;if(e.length>1){i=!0;const p=e[0].type.replace("Multi","");e.forEach(_=>{_.type.replace("Multi","")!==p&&(i=!1)})}const a=t.length>0,d=e.length>0;this.setActionableState({combineFeatures:i,uncombineFeatures:a,trash:d})};di.getUniqueIds=function(e){return e.length?e.map(i=>i.properties.id).filter(i=>i!==void 0).reduce((i,a)=>(i.add(a),i),new Tl).values():[]};di.stopExtendedInteractions=function(e){e.boxSelectElement&&(e.boxSelectElement.parentNode&&e.boxSelectElement.parentNode.removeChild(e.boxSelectElement),e.boxSelectElement=null),(e.canDragMove||e.canBoxSelect)&&e.initialDragPanState===!0&&this.map.dragPan.enable(),e.boxSelecting=!1,e.canBoxSelect=!1,e.dragMoving=!1,e.canDragMove=!1};di.onStop=function(){cc.enable(this)};di.onMouseMove=function(e,t){return SM(t)&&e.dragMoving&&this.fireUpdate(),this.stopExtendedInteractions(e),!0};di.onMouseOut=function(e){return e.dragMoving?this.fireUpdate():!0};di.onTap=di.onClick=function(e,t){if(zx(t))return this.clickAnywhere(e,t);if(Dx(Hs.VERTEX)(t))return this.clickOnVertex(e,t);if(SM(t))return this.clickOnFeature(e,t)};di.clickAnywhere=function(e){const t=this.getSelectedIds();t.length&&(this.clearSelectedFeatures(),t.forEach(i=>this.doRender(i))),cc.enable(this),this.stopExtendedInteractions(e)};di.clickOnVertex=function(e,t){this.changeMode(Lo.DIRECT_SELECT,{featureId:t.featureTarget.properties.parent,coordPath:t.featureTarget.properties.coord_path,startPos:t.lngLat}),this.updateUIClasses({mouse:Ai.MOVE})};di.startOnActiveFeature=function(e,t){this.stopExtendedInteractions(e),this.map.dragPan.disable(),this.doRender(t.featureTarget.properties.id),e.canDragMove=!0,e.dragMoveLocation=t.lngLat};di.clickOnFeature=function(e,t){cc.disable(this),this.stopExtendedInteractions(e);const i=$1(t),a=this.getSelectedIds(),d=t.featureTarget.properties.id,p=this.isSelected(d);if(!i&&p&&this.getFeature(d).type!==Br.POINT)return this.changeMode(Lo.DIRECT_SELECT,{featureId:d});p&&i?(this.deselect(d),this.updateUIClasses({mouse:Ai.POINTER}),a.length===1&&cc.enable(this)):!p&&i?(this.select(d),this.updateUIClasses({mouse:Ai.MOVE})):!p&&!i&&(a.forEach(_=>this.doRender(_)),this.setSelected(d),this.updateUIClasses({mouse:Ai.MOVE})),this.doRender(d)};di.onMouseDown=function(e,t){if(e.initialDragPanState=this.map.dragPan.isEnabled(),jf(t))return this.startOnActiveFeature(e,t);if(this.drawConfig.boxSelect&&DB(t))return this.startBoxSelect(e,t)};di.startBoxSelect=function(e,t){this.stopExtendedInteractions(e),this.map.dragPan.disable(),e.boxSelectStartLocation=TM(t.originalEvent,this.map.getContainer()),e.canBoxSelect=!0};di.onTouchStart=function(e,t){if(jf(t))return this.startOnActiveFeature(e,t)};di.onDrag=function(e,t){if(e.canDragMove)return this.dragMove(e,t);if(this.drawConfig.boxSelect&&e.canBoxSelect)return this.whileBoxSelect(e,t)};di.whileBoxSelect=function(e,t){e.boxSelecting=!0,this.updateUIClasses({mouse:Ai.ADD}),e.boxSelectElement||(e.boxSelectElement=document.createElement("div"),e.boxSelectElement.classList.add(Ma.BOX_SELECT),this.map.getContainer().appendChild(e.boxSelectElement));const i=TM(t.originalEvent,this.map.getContainer()),a=Math.min(e.boxSelectStartLocation.x,i.x),d=Math.max(e.boxSelectStartLocation.x,i.x),p=Math.min(e.boxSelectStartLocation.y,i.y),_=Math.max(e.boxSelectStartLocation.y,i.y),r=`translate(${a}px, ${p}px)`;e.boxSelectElement.style.transform=r,e.boxSelectElement.style.WebkitTransform=r,e.boxSelectElement.style.width=`${d-a}px`,e.boxSelectElement.style.height=`${_-p}px`};di.dragMove=function(e,t){e.dragMoving=!0,t.originalEvent.stopPropagation();const i={lng:t.lngLat.lng-e.dragMoveLocation.lng,lat:t.lngLat.lat-e.dragMoveLocation.lat};EM(this.getSelected(),i),e.dragMoveLocation=t.lngLat};di.onTouchEnd=di.onMouseUp=function(e,t){if(e.dragMoving)this.fireUpdate();else if(e.boxSelecting){const i=[e.boxSelectStartLocation,TM(t.originalEvent,this.map.getContainer())],a=this.featuresAt(null,i,"click"),d=this.getUniqueIds(a).filter(p=>!this.isSelected(p));d.length&&(this.select(d),d.forEach(p=>this.doRender(p)),this.updateUIClasses({mouse:Ai.MOVE}))}this.stopExtendedInteractions(e)};di.toDisplayFeatures=function(e,t,i){t.properties.active=this.isSelected(t.properties.id)?gs.ACTIVE:gs.INACTIVE,i(t),this.fireActionable(),!(t.properties.active!==gs.ACTIVE||t.geometry.type===Br.POINT)&&Bx(t).forEach(i)};di.onTrash=function(){this.deleteFeature(this.getSelectedIds()),this.fireActionable()};di.onCombineFeatures=function(){const e=this.getSelected();if(e.length===0||e.length<2)return;const t=[],i=[],a=e[0].type.replace("Multi","");for(let d=0;d<e.length;d++){const p=e[d];if(p.type.replace("Multi","")!==a)return;p.type.includes("Multi")?p.getCoordinates().forEach(_=>{t.push(_)}):t.push(p.getCoordinates()),i.push(p.toGeoJSON())}if(i.length>1){const d=this.newFeature({type:Br.FEATURE,properties:i[0].properties,geometry:{type:`Multi${a}`,coordinates:t}});this.addFeature(d),this.deleteFeature(this.getSelectedIds(),{silent:!0}),this.setSelected([d.id]),this.fire(pa.COMBINE_FEATURES,{createdFeatures:[d.toGeoJSON()],deletedFeatures:i})}this.fireActionable()};di.onUncombineFeatures=function(){const e=this.getSelected();if(e.length===0)return;const t=[],i=[];for(let a=0;a<e.length;a++){const d=e[a];this.isInstanceOf("MultiFeature",d)&&(d.getFeatures().forEach(p=>{this.addFeature(p),p.properties=d.properties,t.push(p.toGeoJSON()),this.select([p.id])}),this.deleteFeature(d.id,{silent:!0}),i.push(d.toGeoJSON()))}t.length>1&&this.fire(pa.UNCOMBINE_FEATURES,{createdFeatures:t,deletedFeatures:i}),this.fireActionable()};const FB=Dx(Hs.VERTEX),NB=Dx(Hs.MIDPOINT),hi={};hi.fireUpdate=function(){this.fire(pa.UPDATE,{action:Ry.CHANGE_COORDINATES,features:this.getSelected().map(e=>e.toGeoJSON())})};hi.fireActionable=function(e){this.setActionableState({combineFeatures:!1,uncombineFeatures:!1,trash:e.selectedCoordPaths.length>0})};hi.startDragging=function(e,t){e.initialDragPanState=this.map.dragPan.isEnabled(),this.map.dragPan.disable(),e.canDragMove=!0,e.dragMoveLocation=t.lngLat};hi.stopDragging=function(e){e.canDragMove&&e.initialDragPanState===!0&&this.map.dragPan.enable(),e.dragMoving=!1,e.canDragMove=!1,e.dragMoveLocation=null};hi.onVertex=function(e,t){this.startDragging(e,t);const i=t.featureTarget.properties,a=e.selectedCoordPaths.indexOf(i.coord_path);!$1(t)&&a===-1?e.selectedCoordPaths=[i.coord_path]:$1(t)&&a===-1&&e.selectedCoordPaths.push(i.coord_path);const d=this.pathsToCoordinates(e.featureId,e.selectedCoordPaths);this.setSelectedCoordinates(d)};hi.onMidpoint=function(e,t){this.startDragging(e,t);const i=t.featureTarget.properties;e.feature.addCoordinate(i.coord_path,i.lng,i.lat),this.fireUpdate(),e.selectedCoordPaths=[i.coord_path]};hi.pathsToCoordinates=function(e,t){return t.map(i=>({feature_id:e,coord_path:i}))};hi.onFeature=function(e,t){e.selectedCoordPaths.length===0?this.startDragging(e,t):this.stopDragging(e)};hi.dragFeature=function(e,t,i){EM(this.getSelected(),i),e.dragMoveLocation=t.lngLat};hi.dragVertex=function(e,t,i){const a=e.selectedCoordPaths.map(_=>e.feature.getCoordinate(_)),d=a.map(_=>({type:Br.FEATURE,properties:{},geometry:{type:Br.POINT,coordinates:_}})),p=CM(d,i);for(let _=0;_<a.length;_++){const r=a[_];e.feature.updateCoordinate(e.selectedCoordPaths[_],r[0]+p.lng,r[1]+p.lat)}};hi.clickNoTarget=function(){this.changeMode(Lo.SIMPLE_SELECT)};hi.clickInactive=function(){this.changeMode(Lo.SIMPLE_SELECT)};hi.clickActiveFeature=function(e){e.selectedCoordPaths=[],this.clearSelectedCoordinates(),e.feature.changed()};hi.onSetup=function(e){const t=e.featureId,i=this.getFeature(t);if(!i)throw new Error("You must provide a featureId to enter direct_select mode");if(i.type===Br.POINT)throw new TypeError("direct_select mode doesn't handle point features");const a={featureId:t,feature:i,dragMoveLocation:e.startPos||null,dragMoving:!1,canDragMove:!1,selectedCoordPaths:e.coordPath?[e.coordPath]:[]};return this.setSelectedCoordinates(this.pathsToCoordinates(t,a.selectedCoordPaths)),this.setSelected(t),cc.disable(this),this.setActionableState({trash:!0}),a};hi.onStop=function(){cc.enable(this),this.clearSelectedCoordinates()};hi.toDisplayFeatures=function(e,t,i){e.featureId===t.properties.id?(t.properties.active=gs.ACTIVE,i(t),Bx(t,{map:this.map,midpoints:!0,selectedPaths:e.selectedCoordPaths}).forEach(i)):(t.properties.active=gs.INACTIVE,i(t)),this.fireActionable(e)};hi.onTrash=function(e){e.selectedCoordPaths.sort((t,i)=>i.localeCompare(t,"en",{numeric:!0})).forEach(t=>e.feature.removeCoordinate(t)),this.fireUpdate(),e.selectedCoordPaths=[],this.clearSelectedCoordinates(),this.fireActionable(e),e.feature.isValid()===!1&&(this.deleteFeature([e.featureId]),this.changeMode(Lo.SIMPLE_SELECT,{}))};hi.onMouseMove=function(e,t){const i=jf(t),a=FB(t),d=NB(t),p=e.selectedCoordPaths.length===0;return i&&p?this.updateUIClasses({mouse:Ai.MOVE}):a&&!p?this.updateUIClasses({mouse:Ai.MOVE}):this.updateUIClasses({mouse:Ai.NONE}),(a||i||d)&&e.dragMoving&&this.fireUpdate(),this.stopDragging(e),!0};hi.onMouseOut=function(e){return e.dragMoving&&this.fireUpdate(),!0};hi.onTouchStart=hi.onMouseDown=function(e,t){if(FB(t))return this.onVertex(e,t);if(jf(t))return this.onFeature(e,t);if(NB(t))return this.onMidpoint(e,t)};hi.onDrag=function(e,t){if(e.canDragMove!==!0)return;e.dragMoving=!0,t.originalEvent.stopPropagation();const i={lng:t.lngLat.lng-e.dragMoveLocation.lng,lat:t.lngLat.lat-e.dragMoveLocation.lat};e.selectedCoordPaths.length>0?this.dragVertex(e,t,i):this.dragFeature(e,t,i),e.dragMoveLocation=t.lngLat};hi.onClick=function(e,t){if(zx(t))return this.clickNoTarget(e,t);if(jf(t))return this.clickActiveFeature(e,t);if(wM(t))return this.clickInactive(e,t);this.stopDragging(e)};hi.onTap=function(e,t){if(zx(t))return this.clickNoTarget(e,t);if(jf(t))return this.clickActiveFeature(e,t);if(wM(t))return this.clickInactive(e,t)};hi.onTouchEnd=hi.onMouseUp=function(e){e.dragMoving&&this.fireUpdate(),this.stopDragging(e)};const Kc={};Kc.onSetup=function(){const e=this.newFeature({type:Br.FEATURE,properties:{},geometry:{type:Br.POINT,coordinates:[]}});return this.addFeature(e),this.clearSelectedFeatures(),this.updateUIClasses({mouse:Ai.ADD}),this.activateUIButton(Ia.POINT),this.setActionableState({trash:!0}),{point:e}};Kc.stopDrawingAndRemove=function(e){this.deleteFeature([e.point.id],{silent:!0}),this.changeMode(Lo.SIMPLE_SELECT)};Kc.onTap=Kc.onClick=function(e,t){this.updateUIClasses({mouse:Ai.MOVE}),e.point.updateCoordinate("",t.lngLat.lng,t.lngLat.lat),this.fire(pa.CREATE,{features:[e.point.toGeoJSON()]}),this.changeMode(Lo.SIMPLE_SELECT,{featureIds:[e.point.id]})};Kc.onStop=function(e){this.activateUIButton(),e.point.getCoordinate().length||this.deleteFeature([e.point.id],{silent:!0})};Kc.toDisplayFeatures=function(e,t,i){const a=t.properties.id===e.point.id;if(t.properties.active=a?gs.ACTIVE:gs.INACTIVE,!a)return i(t)};Kc.onTrash=Kc.stopDrawingAndRemove;Kc.onKeyUp=function(e,t){if(Fx(t)||Nx(t))return this.stopDrawingAndRemove(e,t)};function U1(e,t){return e.lngLat?e.lngLat.lng===t[0]&&e.lngLat.lat===t[1]:!1}const uc={};uc.onSetup=function(){const e=this.newFeature({type:Br.FEATURE,properties:{},geometry:{type:Br.POLYGON,coordinates:[[]]}});return this.addFeature(e),this.clearSelectedFeatures(),cc.disable(this),this.updateUIClasses({mouse:Ai.ADD}),this.activateUIButton(Ia.POLYGON),this.setActionableState({trash:!0}),{polygon:e,currentVertexPosition:0}};uc.clickAnywhere=function(e,t){if(e.currentVertexPosition>0&&U1(t,e.polygon.coordinates[0][e.currentVertexPosition-1]))return this.changeMode(Lo.SIMPLE_SELECT,{featureIds:[e.polygon.id]});this.updateUIClasses({mouse:Ai.ADD}),e.polygon.updateCoordinate(`0.${e.currentVertexPosition}`,t.lngLat.lng,t.lngLat.lat),e.currentVertexPosition++,e.polygon.updateCoordinate(`0.${e.currentVertexPosition}`,t.lngLat.lng,t.lngLat.lat)};uc.clickOnVertex=function(e){return this.changeMode(Lo.SIMPLE_SELECT,{featureIds:[e.polygon.id]})};uc.onMouseMove=function(e,t){e.polygon.updateCoordinate(`0.${e.currentVertexPosition}`,t.lngLat.lng,t.lngLat.lat),Ly(t)&&this.updateUIClasses({mouse:Ai.POINTER})};uc.onTap=uc.onClick=function(e,t){return Ly(t)?this.clickOnVertex(e,t):this.clickAnywhere(e,t)};uc.onKeyUp=function(e,t){Fx(t)?(this.deleteFeature([e.polygon.id],{silent:!0}),this.changeMode(Lo.SIMPLE_SELECT)):Nx(t)&&this.changeMode(Lo.SIMPLE_SELECT,{featureIds:[e.polygon.id]})};uc.onStop=function(e){this.updateUIClasses({mouse:Ai.NONE}),cc.enable(this),this.activateUIButton(),this.getFeature(e.polygon.id)!==void 0&&(e.polygon.removeCoordinate(`0.${e.currentVertexPosition}`),e.polygon.isValid()?this.fire(pa.CREATE,{features:[e.polygon.toGeoJSON()]}):(this.deleteFeature([e.polygon.id],{silent:!0}),this.changeMode(Lo.SIMPLE_SELECT,{},{silent:!0})))};uc.toDisplayFeatures=function(e,t,i){const a=t.properties.id===e.polygon.id;if(t.properties.active=a?gs.ACTIVE:gs.INACTIVE,!a)return i(t);if(t.geometry.coordinates.length===0)return;const d=t.geometry.coordinates[0].length;if(!(d<3)){if(t.properties.meta=Hs.FEATURE,i(Gm(e.polygon.id,t.geometry.coordinates[0][0],"0.0",!1)),d>3){const p=t.geometry.coordinates[0].length-3;i(Gm(e.polygon.id,t.geometry.coordinates[0][p],`0.${p}`,!1))}if(d<=4){const p=[[t.geometry.coordinates[0][0][0],t.geometry.coordinates[0][0][1]],[t.geometry.coordinates[0][1][0],t.geometry.coordinates[0][1][1]]];if(i({type:Br.FEATURE,properties:t.properties,geometry:{coordinates:p,type:Br.LINE_STRING}}),d===3)return}return i(t)}};uc.onTrash=function(e){this.deleteFeature([e.polygon.id],{silent:!0}),this.changeMode(Lo.SIMPLE_SELECT)};const dc={};dc.onSetup=function(e){e=e||{};const t=e.featureId;let i,a,d="forward";if(t){if(i=this.getFeature(t),!i)throw new Error("Could not find a feature with the provided featureId");let p=e.from;if(p&&p.type==="Feature"&&p.geometry&&p.geometry.type==="Point"&&(p=p.geometry),p&&p.type==="Point"&&p.coordinates&&p.coordinates.length===2&&(p=p.coordinates),!p||!Array.isArray(p))throw new Error("Please use the `from` property to indicate which point to continue the line from");const _=i.coordinates.length-1;if(i.coordinates[_][0]===p[0]&&i.coordinates[_][1]===p[1])a=_+1,i.addCoordinate(a,...i.coordinates[_]);else if(i.coordinates[0][0]===p[0]&&i.coordinates[0][1]===p[1])d="backwards",a=0,i.addCoordinate(a,...i.coordinates[0]);else throw new Error("`from` should match the point at either the start or the end of the provided LineString")}else i=this.newFeature({type:Br.FEATURE,properties:{},geometry:{type:Br.LINE_STRING,coordinates:[]}}),a=0,this.addFeature(i);return this.clearSelectedFeatures(),cc.disable(this),this.updateUIClasses({mouse:Ai.ADD}),this.activateUIButton(Ia.LINE),this.setActionableState({trash:!0}),{line:i,currentVertexPosition:a,direction:d}};dc.clickAnywhere=function(e,t){if(e.currentVertexPosition>0&&U1(t,e.line.coordinates[e.currentVertexPosition-1])||e.direction==="backwards"&&U1(t,e.line.coordinates[e.currentVertexPosition+1]))return this.changeMode(Lo.SIMPLE_SELECT,{featureIds:[e.line.id]});this.updateUIClasses({mouse:Ai.ADD}),e.line.updateCoordinate(e.currentVertexPosition,t.lngLat.lng,t.lngLat.lat),e.direction==="forward"?(e.currentVertexPosition++,e.line.updateCoordinate(e.currentVertexPosition,t.lngLat.lng,t.lngLat.lat)):e.line.addCoordinate(0,t.lngLat.lng,t.lngLat.lat)};dc.clickOnVertex=function(e){return this.changeMode(Lo.SIMPLE_SELECT,{featureIds:[e.line.id]})};dc.onMouseMove=function(e,t){e.line.updateCoordinate(e.currentVertexPosition,t.lngLat.lng,t.lngLat.lat),Ly(t)&&this.updateUIClasses({mouse:Ai.POINTER})};dc.onTap=dc.onClick=function(e,t){if(Ly(t))return this.clickOnVertex(e,t);this.clickAnywhere(e,t)};dc.onKeyUp=function(e,t){Nx(t)?this.changeMode(Lo.SIMPLE_SELECT,{featureIds:[e.line.id]}):Fx(t)&&(this.deleteFeature([e.line.id],{silent:!0}),this.changeMode(Lo.SIMPLE_SELECT))};dc.onStop=function(e){cc.enable(this),this.activateUIButton(),this.getFeature(e.line.id)!==void 0&&(e.line.removeCoordinate(`${e.currentVertexPosition}`),e.line.isValid()?this.fire(pa.CREATE,{features:[e.line.toGeoJSON()]}):(this.deleteFeature([e.line.id],{silent:!0}),this.changeMode(Lo.SIMPLE_SELECT,{},{silent:!0})))};dc.onTrash=function(e){this.deleteFeature([e.line.id],{silent:!0}),this.changeMode(Lo.SIMPLE_SELECT)};dc.toDisplayFeatures=function(e,t,i){const a=t.properties.id===e.line.id;if(t.properties.active=a?gs.ACTIVE:gs.INACTIVE,!a)return i(t);t.geometry.coordinates.length<2||(t.properties.meta=Hs.FEATURE,i(Gm(e.line.id,t.geometry.coordinates[e.direction==="forward"?t.geometry.coordinates.length-2:1],`${e.direction==="forward"?t.geometry.coordinates.length-2:1}`,!1)),i(t))};const BB={simple_select:di,direct_select:hi,draw_point:Kc,draw_polygon:uc,draw_line_string:dc},pve={defaultMode:Lo.SIMPLE_SELECT,keybindings:!0,touchEnabled:!0,clickBuffer:2,touchBuffer:25,boxSelect:!0,displayControlsDefault:!0,styles:LB,modes:BB,controls:{},userProperties:!1,suppressAPIEvents:!0},mve={point:!0,line_string:!0,polygon:!0,trash:!0,combine_features:!0,uncombine_features:!0},gve={point:!1,line_string:!1,polygon:!1,trash:!1,combine_features:!1,uncombine_features:!1};function OO(e,t){return e.map(i=>i.source?i:Object.assign({},i,{id:`${i.id}.${t}`,source:t==="hot"?yl.HOT:yl.COLD}))}function vve(e={}){let t=Object.assign({},e);return e.controls||(t.controls={}),e.displayControlsDefault===!1?t.controls=Object.assign({},gve,e.controls):t.controls=Object.assign({},mve,e.controls),t=Object.assign({},pve,t),t.styles=OO(t.styles,"cold").concat(OO(t.styles,"hot")),t}var _ve=function e(t,i){if(t===i)return!0;if(t&&i&&typeof t=="object"&&typeof i=="object"){if(t.constructor!==i.constructor)return!1;var a,d,p;if(Array.isArray(t)){if(a=t.length,a!=i.length)return!1;for(d=a;d--!==0;)if(!e(t[d],i[d]))return!1;return!0}if(t.constructor===RegExp)return t.source===i.source&&t.flags===i.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===i.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===i.toString();if(p=Object.keys(t),a=p.length,a!==Object.keys(i).length)return!1;for(d=a;d--!==0;)if(!Object.prototype.hasOwnProperty.call(i,p[d]))return!1;for(d=a;d--!==0;){var _=p[d];if(!e(t[_],i[_]))return!1}return!0}return t!==t&&i!==i};const LO=Xa(_ve);var yve=xve,bve={Point:"geometry",MultiPoint:"geometry",LineString:"geometry",MultiLineString:"geometry",Polygon:"geometry",MultiPolygon:"geometry",GeometryCollection:"geometry",Feature:"feature",FeatureCollection:"featurecollection"};function xve(e){if(!e||!e.type)return null;var t=bve[e.type];if(!t)return null;if(t==="geometry")return{type:"FeatureCollection",features:[{type:"Feature",properties:{},geometry:e}]};if(t==="feature")return{type:"FeatureCollection",features:[e]};if(t==="featurecollection")return e}const wve=Xa(yve);function VB(e,t){return e.length!==t.length?!1:JSON.stringify(e.map(i=>i).sort())===JSON.stringify(t.map(i=>i).sort())}const Sve={Polygon:Ja,LineString:Qc,Point:ih,MultiPolygon:ua,MultiLineString:ua,MultiPoint:ua};function Tve(e,t){t.modes=Lo;const i=e.options.suppressAPIEvents!==void 0?!!e.options.suppressAPIEvents:!0;return t.getFeatureIdsAt=function(a){return Hm.click({point:a},null,e).map(p=>p.properties.id)},t.getSelectedIds=function(){return e.store.getSelectedIds()},t.getSelected=function(){return{type:Br.FEATURE_COLLECTION,features:e.store.getSelectedIds().map(a=>e.store.get(a)).map(a=>a.toGeoJSON())}},t.getSelectedPoints=function(){return{type:Br.FEATURE_COLLECTION,features:e.store.getSelectedCoordinates().map(a=>({type:Br.FEATURE,properties:{},geometry:{type:Br.POINT,coordinates:a.coordinates}}))}},t.set=function(a){if(a.type===void 0||a.type!==Br.FEATURE_COLLECTION||!Array.isArray(a.features))throw new Error("Invalid FeatureCollection");const d=e.store.createRenderBatch();let p=e.store.getAllIds().slice();const _=t.add(a),r=new Tl(_);return p=p.filter(S=>!r.has(S)),p.length&&t.delete(p),d(),_},t.add=function(a){const p=JSON.parse(JSON.stringify(wve(a))).features.map(_=>{if(_.id=_.id||xM(),_.geometry===null)throw new Error("Invalid geometry: null");if(e.store.get(_.id)===void 0||e.store.get(_.id).type!==_.geometry.type){const r=Sve[_.geometry.type];if(r===void 0)throw new Error(`Invalid geometry type: ${_.geometry.type}.`);const S=new r(e,_);e.store.add(S,{silent:i})}else{const r=e.store.get(_.id),S=r.properties;r.properties=_.properties,LO(S,_.properties)||e.store.featureChanged(r.id,{silent:i}),LO(r.getCoordinates(),_.geometry.coordinates)||r.incomingCoords(_.geometry.coordinates)}return _.id});return e.store.render(),p},t.get=function(a){const d=e.store.get(a);if(d)return d.toGeoJSON()},t.getAll=function(){return{type:Br.FEATURE_COLLECTION,features:e.store.getAll().map(a=>a.toGeoJSON())}},t.delete=function(a){return e.store.delete(a,{silent:i}),t.getMode()===Lo.DIRECT_SELECT&&!e.store.getSelectedIds().length?e.events.changeMode(Lo.SIMPLE_SELECT,void 0,{silent:i}):e.store.render(),t},t.deleteAll=function(){return e.store.delete(e.store.getAllIds(),{silent:i}),t.getMode()===Lo.DIRECT_SELECT?e.events.changeMode(Lo.SIMPLE_SELECT,void 0,{silent:i}):e.store.render(),t},t.changeMode=function(a,d={}){return a===Lo.SIMPLE_SELECT&&t.getMode()===Lo.SIMPLE_SELECT?(VB(d.featureIds||[],e.store.getSelectedIds())||(e.store.setSelected(d.featureIds,{silent:i}),e.store.render()),t):(a===Lo.DIRECT_SELECT&&t.getMode()===Lo.DIRECT_SELECT&&d.featureId===e.store.getSelectedIds()[0]||e.events.changeMode(a,d,{silent:i}),t)},t.getMode=function(){return e.events.getMode()},t.trash=function(){return e.events.trash({silent:i}),t},t.combineFeatures=function(){return e.events.combineFeatures({silent:i}),t},t.uncombineFeatures=function(){return e.events.uncombineFeatures({silent:i}),t},t.setFeatureProperty=function(a,d,p){return e.store.setFeatureProperty(a,d,p,{silent:i}),t},t}const Cve=Object.freeze(Object.defineProperty({__proto__:null,CommonSelectors:hve,ModeHandler:nC,StringSet:Tl,constrainFeatureMovement:CM,createMidPoint:zB,createSupplementaryPoints:Bx,createVertex:Gm,doubleClickZoom:cc,euclideanDistance:bM,featuresAt:Hm,getFeatureAtAndSetCursors:a1,isClick:sC,isEventAtCoordinates:U1,isTap:aC,mapEventToBoundingBox:kB,moveFeatures:EM,sortFeatures:AB,stringSetsAreEqual:VB,theme:LB,toDenseArray:Oy},Symbol.toStringTag,{value:"Module"})),Eve=function(e,t){e=vve(e);const i={options:e};t=Tve(i,t),i.api=t;const a=uve(i);return t.onAdd=a.onAdd,t.onRemove=a.onRemove,t.types=Ia,t.options=e,t};function cy(e){Eve(e,this)}cy.modes=BB;cy.constants=IB;cy.lib=Cve;var na=63710088e-1,Mve={centimeters:na*100,centimetres:na*100,degrees:360/(2*Math.PI),feet:na*3.28084,inches:na*39.37,kilometers:na/1e3,kilometres:na/1e3,meters:na,metres:na,miles:na/1609.344,millimeters:na*1e3,millimetres:na*1e3,nauticalmiles:na/1852,radians:1,yards:na*1.0936};function $B(e,t,i={}){const a={type:"Feature"};return(i.id===0||i.id)&&(a.id=i.id),i.bbox&&(a.bbox=i.bbox),a.properties=t||{},a.geometry=e,a}function lC(e,t,i={}){if(!e)throw new Error("coordinates is required");if(!Array.isArray(e))throw new Error("coordinates must be an Array");if(e.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!DO(e[0])||!DO(e[1]))throw new Error("coordinates must contain numbers");return $B({type:"Point",coordinates:e},t,i)}function Ive(e,t,i={}){for(const d of e){if(d.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");if(d[d.length-1].length!==d[0].length)throw new Error("First and last Position are not equivalent.");for(let p=0;p<d[d.length-1].length;p++)if(d[d.length-1][p]!==d[0][p])throw new Error("First and last Position are not equivalent.")}return $B({type:"Polygon",coordinates:e},t,i)}function Ave(e,t="kilometers"){const i=Mve[t];if(!i)throw new Error(t+" units is invalid");return e*i}function Vb(e){return e%360*Math.PI/180}function DO(e){return!isNaN(e)&&e!==null&&!Array.isArray(e)}function zO(e){if(!e)throw new Error("coord is required");if(!Array.isArray(e)){if(e.type==="Feature"&&e.geometry!==null&&e.geometry.type==="Point")return[...e.geometry.coordinates];if(e.type==="Point")return[...e.coordinates]}if(Array.isArray(e)&&e.length>=2&&!Array.isArray(e[0])&&!Array.isArray(e[1]))return[...e];throw new Error("coord must be GeoJSON Point or an Array of numbers")}function kve(e,t,i={}){var a=zO(e),d=zO(t),p=Vb(d[1]-a[1]),_=Vb(d[0]-a[0]),r=Vb(a[1]),S=Vb(d[1]),C=Math.pow(Math.sin(p/2),2)+Math.pow(Math.sin(_/2),2)*Math.cos(r)*Math.cos(S);return Ave(2*Math.atan2(Math.sqrt(C),Math.sqrt(1-C)),i.units)}function UB(e,t,i){if(e!==null)for(var a,d,p,_,r,S,C,M=0,k=0,z,F=e.type,B=F==="FeatureCollection",N=F==="Feature",j=B?e.features.length:1,U=0;U<j;U++){C=B?e.features[U].geometry:N?e.geometry:e,z=C?C.type==="GeometryCollection":!1,r=z?C.geometries.length:1;for(var te=0;te<r;te++){var Y=0,q=0;if(_=z?C.geometries[te]:C,_!==null){S=_.coordinates;var J=_.type;switch(M=0,J){case null:break;case"Point":if(t(S,k,U,Y,q)===!1)return!1;k++,Y++;break;case"LineString":case"MultiPoint":for(a=0;a<S.length;a++){if(t(S[a],k,U,Y,q)===!1)return!1;k++,J==="MultiPoint"&&Y++}J==="LineString"&&Y++;break;case"Polygon":case"MultiLineString":for(a=0;a<S.length;a++){for(d=0;d<S[a].length-M;d++){if(t(S[a][d],k,U,Y,q)===!1)return!1;k++}J==="MultiLineString"&&Y++,J==="Polygon"&&q++}J==="Polygon"&&Y++;break;case"MultiPolygon":for(a=0;a<S.length;a++){for(q=0,d=0;d<S[a].length;d++){for(p=0;p<S[a][d].length-M;p++){if(t(S[a][d][p],k,U,Y,q)===!1)return!1;k++}q++}Y++}break;case"GeometryCollection":for(a=0;a<_.geometries.length;a++)if(UB(_.geometries[a],t)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function Pve(e,t){var i,a,d,p,_,r,S,C,M,k,z=0,F=e.type==="FeatureCollection",B=e.type==="Feature",N=F?e.features.length:1;for(i=0;i<N;i++){for(r=F?e.features[i].geometry:B?e.geometry:e,C=F?e.features[i].properties:B?e.properties:{},M=F?e.features[i].bbox:B?e.bbox:void 0,k=F?e.features[i].id:B?e.id:void 0,S=r?r.type==="GeometryCollection":!1,_=S?r.geometries.length:1,d=0;d<_;d++){if(p=S?r.geometries[d]:r,p===null){if(t(null,z,C,M,k)===!1)return!1;continue}switch(p.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(t(p,z,C,M,k)===!1)return!1;break}case"GeometryCollection":{for(a=0;a<p.geometries.length;a++)if(t(p.geometries[a],z,C,M,k)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}z++}}function Rve(e,t,i){var a=i;return Pve(e,function(d,p,_,r,S){p===0&&i===void 0?a=d:a=t(a,d,p,_,r,S)}),a}function Ove(e){return Rve(e,(t,i)=>t+Lve(i),0)}function Lve(e){let t=0,i;switch(e.type){case"Polygon":return FO(e.coordinates);case"MultiPolygon":for(i=0;i<e.coordinates.length;i++)t+=FO(e.coordinates[i]);return t;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0}return 0}function FO(e){let t=0;if(e&&e.length>0){t+=Math.abs(NO(e[0]));for(let i=1;i<e.length;i++)t-=Math.abs(NO(e[i]))}return t}var Dve=na*na/2,MS=Math.PI/180;function NO(e){const t=e.length-1;if(t<=2)return 0;let i=0,a=0;for(;a<t;){const d=e[a],p=e[a+1===t?0:a+1],_=e[a+2>=t?(a+2)%t:a+2],r=d[0]*MS,S=p[1]*MS,C=_[0]*MS;i+=(C-r)*Math.sin(S),a++}return i*Dve}function zve(e,t={}){if(e.bbox!=null&&t.recompute!==!0)return e.bbox;const i=[1/0,1/0,-1/0,-1/0];return UB(e,a=>{i[0]>a[0]&&(i[0]=a[0]),i[1]>a[1]&&(i[1]=a[1]),i[2]<a[0]&&(i[2]=a[0]),i[3]<a[1]&&(i[3]=a[1])}),i}function Fve(e,t={}){const i=zve(e),a=(i[0]+i[2])/2,d=(i[1]+i[3])/2;return lC([a,d],t.properties,t)}const Nve="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAABExJREFUWEe1lm1sU1UYx//PbUfdi2NBFkOCcWM2ESMv2z6s3dx2b6OCmmlC+IDR+ILED6hZbzeGRhdrYqKuaW9H0MQY34jGLwajvAgRdzspvY3y4kCJRhj1FXVhMExh69oec+9are297e3A82VLz//5P7/znHPucwjzGM7PAiuYlVo5oFsNTwOjlGRHlDs8J8q1I7MBK/f7qqsqLENEdDeABoO4GGNs76XZ1MDxNVviZrxNAThk6REChgDUmzEFMMGAgaggvlNKXxLAMRLYk1l1Ka+CebUaUZfnnmKBRQGco8GHkGbvlp05N4Cjh5Vu9w4jD0MA56i/GWnu6BUlzwZz6Ralu++YnpcuQOsub9WC6oWfgtB1VQAYvkjEp+460uO9lO+nC+CQpQcIeM8o+fbV6/Hk1x9q0y11SwtkRy/8UngegAejgvi+KQCnHHwJYE/ni7PJfCvuw5YTH2vTzRkAG2dFpaUCkckYlHNndNjpZUVwP2MOICR9AoaefPFjDQ5UWSpw/w2t2PnrGM7PXsabseg/MnX+5F9/6AMQdim8eK85ADk4DrBGoy2I8G60h4LatKverv1NsjTsNfXGAKAziuBeZhJAmgZgyxere59Mp2AhDk01izEeP4ez0xe10mfHgT+/R2jilB77jCKI15gDGJFOgdCUL+5a3ITrbddCtPN47ts9GJn4Ac/efKdWcvV/dSzgrEikk4UADKcVl3iTOQBZkgHw+eLNy27TVj24fA2OZU66WoFcgOFV69A7tlOvAgcVQSy41rrX0ClLTwDYnu/y6ur12ko9dgGDmQr02wXcUrsEv01Poa6iEicv/o7XxsMFAMSoN+JybzNVgbYDwZWchY3li0e7nsKOn77CxgYHxOMf4cvJH7X9b1t0IzjMrSW7FbmxBPzMWW2rwp2bz5sCUEUOOfABgTZkAxqrr0OfXdA+QI83tmPD0hbEUzOIJxOIpxK4nEoAGYjsRyonmagI4ty1yRvFewHjwmCoysY4FzVAmYzp+Rj/ZnD/swFFu6Hjc7+XOO758jL+Rx3nwPhDguewkUdRAK0p1dSGAWqeDwQjbI3yovqQMRylHySydDsB+wBYyoTYrwji2lIxJQFUA6cc6AVI9xDpJiDMgjhe6e6NXBUA1aRdlt5gwKZShuo8gQYjgvtFc1ozKgBte7fVcpUpdSucRfeUSI7wbpdJ28zFNanukP2ONGgfQAv1Q9gUB7b2kND3b48u4W3qDOR6tIcCjzJGb+n5ErGNEd7ztsn1aLKyAbTzEJJeYQwDuYmIMBThxa3lJJ8XgCRJmxhjnnAjlp+tm+NfcoGhM0bfMMZe93g8BU3sir4DucE+n4+3WCxqq8aMFTiYeTF0ngZsmScAx3E9brd7t9lKlLUFuQBGCf5XADWp3+/3EpFufyAiryiKL5hd/bzOgBo0PDx8azKZ7CCiDgAJxliIMXa4v7//u3KSq9q/AacSfDB4RQOdAAAAAElFTkSuQmCC",Bve="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAABBJJREFUWEe1ln9MVWUYxz/PJbkKoVubrllrEBYjSyNX0zRj3oshBtP+ahnpvZBra4sfMtDNFk1nCmNEuprpvZeK5j85p4QlHEKMtdYo1g+XFYjIH23ZNG38EG73jXNPTuicwz0X6/3nnJ33eb7fz3ne5z3vEWYw1BbvQ7giy0CeNNJVJxHX19KofR+vnDhNUIVrk5kVqQGVB5JqnacugJxk3FUpH7QOOdF2BKD8a7aAqwaY70QUuASRSgl+1hgrPiaA8nlbEPJiCVnOK05KSFs/Xe60AMrvfQF4b0bmN5M2S1B7307DFkAVebNQfHOL5ka68IgEtB4rLUsAtTU/ifDwJyCr/xMA1BluS1on7zYP/1vPGsDv2QTSZGn++FpYeA98dNiY3roDOlvgp+9isKrnJdj+oUMA7xvAdkvFXYdgTymMDEHq/fDidrg+Cslz4fYUaD0Kxy2XfK8EtR3OAIpyTqBUvglguQfSH4DuM+DdCHfMh96zcORtyMyCihp4aT2Mj5nZRZol0FbgDMDvPT/R/WkmlZLdcOV3WPYEHNwD9y0G92xIzYCMJbCzCH69aLcU/RO74V6nAKOA26Tk2wajI/DwCqgqNKYLCuHp52BkGBrroOcLO4DrEtRmOwPweXsR0i2V9h+DvWWwaDHkPAP956DpAMxKhG37oO8sNO03pyr6JKQtcgrQgZBtUtmwGcJhSMuA7k4Y6IWMpXC6GVLmwbU/YFUudH1q0QN8LgHNtK1ttmHOy6AOmFQ8G2CwzzDW1/7aFSPkrlRYnQcLFkLDTuslUKpEQu1vOatAsWcJEfnWpKSXPT3TKP/gebjzbkh0Q/tx+LHH2BWXL1kBDOJ2L5V3Wv4hvhli/yn2e46APDtF7ZVdcOFnGPjFuF69DHOSYdVTxs642Atdp4zr1FEmQe1NK7JYZ0EXkGTX1qbnLhdEIlMf2+z/G0GxTsPqid+d1xwDmAOHQLIl2NZtpzE9QPRQGtGrkDUjCJEqCbTpPzK2I/YPid/jBdH3VUKcEKckqOXGyokJoAuoopwSlLJsIhuDcZQrW0Kttp9FRz0wWVz5PIcQKY71RtF54VUJaLudxDqqQLQKm9bNxT2uL8WKGMIdEtTWODE3WOMYqti7nAg6xDybtKu4yJXD2pdOZeMCiFbC5/UhBC0NFH4JaSGn5nFX4IawKsrZh1KVU4xEaiTQVhWP+YwA6uvri5VS5QUD3Znpf/4W9etLWUBz6qM/KKUOlpeXmw+xW/kOTM6tra3NTkhI6NCfzflrjI39X0Wnj6U9xkhCYvTe5XLll5aWfuy0EnH1wGQAO4P/FUA3raurqxYRy/NBRKrLysped/r2M+oBPamhoeHBcDi8UkRWAmNKqdNKqe6Kiopz8ZjrsX8DsGBJMCEPcb0AAAAASUVORK5CYII=",IS="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAYAAABWdVznAAAAAXNSR0IArs4c6QAAAQ1JREFUKFONkUErhFEUhp8zfoKy0qSUsmaj+bjKmrJgN8xs+AmDYkEx8xPYYGbHQrFWPj7ZsFZqosbKwj8wR/feueOmr7ir0znnPe859xGipwdmjQIJyrRLC3d0yWQzPQptEgKtm0dgIh4QxU+ykU76GYA2zBnKkmsorcLQqO/9aMP9qY+Fc6mly6L7pkyBpkvWbvINGrM+32VF+tOTCpQq+YLs2DtZF62bDjDMwjaMz+ULnq/hcs/W3q3gFRhhcRfGZvIFL7dwsWNrb3alJkrZHZtU/1qpJe7vhcN/Ha2s+2+NGVinwaJ3+uxAdhJcHYsfcDGL34v1GPTBhbpjMsA8ylQP1gNfXMlW2go93xgvWoFerZbMAAAAAElFTkSuQmCC",Vve="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAMCAYAAAB4MH11AAAAAXNSR0IArs4c6QAAAQxJREFUOE+tkl1Kw0AUhc+dDWX6mukKhN4NFAqKQqGgKAoFRVAUEUVRRBFFETfQTraQyWOTrOjWWqtR02aqnacZOOf75o8wxzD9tAlSS46Dpm+NfIP1KG+JyMsoL8Brwrrl0/UShFG2TIKnIpAIz3FDr1RJKgXG5quAPJSD6NFxsDZLMlNg+oM2SN1V7PLesW5Py0wV1HtpRxTdVF3B+E3kNuFapyxbKgijfJ1ErnzgkwwRXceNYONn55fA2GwTwMU88EL20rHe+vYZigtj821Azv4I/6jJuePazufJJhPTG3Sh1Mn/4OO2AKcJ6+5o/n5FoU13CXS0CPjXzuk45mCPjM3230QHi4QXWIdDKLNHSzG5InwAAAAASUVORK5CYII=",BO=({points:e,azimuth:t=!1})=>{const[i,a,d]=e,p={x:a[0]-i[0],y:a[1]-i[1]},_={x:d[0]-a[0],y:d[1]-a[1]},r=p.x*_.x+p.y*_.y,S=Math.sqrt(p.x**2+p.y**2),C=Math.sqrt(_.x**2+_.y**2),M=r/(S*C),k=Math.max(-1,Math.min(1,M)),F=Math.acos(k)*(180/Math.PI);let N=p.x*_.y-p.y*_.x<0?F-180:180-F;t&&(N=N<0?N+360:N);const{angleBA:j,angleBC:U}=$ve(e);let te=0;return j<0&&U<0&&(te=-Math.max(Math.abs(j),Math.abs(U))),j>0&&U>0&&(te=Math.min(Math.abs(j),Math.abs(U))),j>=135&&j<=180&&U<=-45&&U>=-90&&(te=j),U>=135&&U<=180&&j<=-45&&j>=-90&&(te=U),j>=135&&j<=180&&U<=0&&U>=-45&&(te=U),U>=135&&U<=180&&j<=0&&j>=-45&&(te=j),j>=90&&j<=135&&U<=0&&U>=-45&&(te=U),U>=90&&U<=135&&j<=0&&j>=-45&&(te=j),j>=90&&j<=135&&U>=-90&&U<=-45&&(te=j),U>=90&&U<=135&&j>=-90&&j<=-45&&(te=U),j>=0&&j<=90&&U<=0&&U>=-90&&(te=U),U>=0&&U<=90&&j<=0&&j>=-90&&(te=j),U>=-180&&U<=-90&&j<=180&&j>=90&&(te=j),j>=-180&&j<=-90&&U<=180&&U>=90&&(te=U),U>=-135&&U<=-90&&j>=0&&j<=45&&(te=U),U>=-135&&U<=-90&&j>=45&&j<=90&&(te=j),j>=-135&&j<=-90&&U>=0&&U<=45&&(te=j),j>=-135&&j<=-90&&U>=45&&U<=90&&(te=U),U>=-180&&U<=-135&&j>=0&&j<=45&&(te=U),U>=-180&&U<=-135&&j>=45&&j<=90&&(te=j),j>=-180&&j<=-135&&U>=0&&U<=45&&(te=j),j>=-180&&j<=-135&&U>=45&&U<=90&&(te=U),{Angle:Number(Math.abs(N.toFixed(0))),rotate:te,rotation:N*Math.PI/180}},$ve=e=>{const[t,i,a]=e,[d,p]=t,[_,r]=i,[S,C]=a,M={x:d-_,y:p-r},k={x:S-_,y:C-r};let z=Math.atan2(M.y,M.x)*(180/Math.PI),F=Math.atan2(k.y,k.x)*(180/Math.PI);return z>=0&&z<90||z>=90&&z<=180?z=180-z:(z<0&&z>=-90,z=Math.abs(z)-180),F>=0&&F<90||F>=90&&F<=180?F=180-F:(F<0&&F>=-90,F=Math.abs(F)-180),{angleBA:z,angleBC:F}},Uve=e=>{let t=(e+90)%360;return t<270&&(t+=360),t},VO=e=>{const t=Uve(e.Angle),i=40,a=100,d=100,p=d+i*Math.cos(t*Math.PI/180),_=a-i*Math.sin(t*Math.PI/180),r=a,S=d-i;let C;t>=450&&t<=629?C=0:t>=270&&t<450&&(C=1);const M=`M ${S} ${r} A ${i} ${i} 0 ${C} 1 ${_} ${p}`,k=`M ${_} ${p} L ${S} ${p}  L${S} ${r}`,z=Math.abs(t);let F=M;z==540&&(F=k);let B=e.Angle==90?"":`<text fill="black" font-size="16" text-anchor="middle">
              <textPath href="#arc" startOffset="50%" side="left">
                  <tspan dy="-5">${e.Angle}</tspan>
              </textPath>
          </text>`;const N=`<svg width="200" height="200" viewBox="0 0 200 200" style="transform:rotate(${e.rotate}deg);transform-origin: 100px 100px;"  transform="rotate(${e.rotate})" xmlns="http://www.w3.org/2000/svg">
          <path id="arc" fill="none" stroke="red" stroke-width="1" d="${F}" />${B}</svg>`;return"data:image/svg+xml;charset=utf-8,"+encodeURIComponent(N)},$O=e=>e>100?Math.round(e/1e3*100)/100+" km":Math.round(e*100)/100+" m",jve=e=>e>1e6?Math.round(e/1e6*100)/100+" km":Math.round(e*100)/100+" m",Kl={CLEAR:"CLEAR",MEASUREDISTANCE:"MEASUREDISTANCE",MEASUREANGLE:"MEASUREANGLE",AZIMUTH:"AZIMUTH",MEASUREPOLYGON:"MEASUREPOLYGON"},Hve={MEASUREDISTANCE:"draw_line_string",MEASUREANGLE:"draw_point",AZIMUTH:"draw_point",MEASUREPOLYGON:"draw_polygon"},Gve={CREATE:"draw.create",UPDATE:"draw.update"},Wve={class:"Draw_draw__UPVhb"},qve=["onClick"],Kve={role:"img",class:"anticon"},Zve={width:"1em",height:"1em","aria-hidden":"true",focusable:"false",class:""},Yve=["xlink:href"],Xve=qe({__name:"tools",setup(e){const{CREATE:t,UPDATE:i}=Gve,{map:a}=yD(vM()),d=Se(""),p=cy.modes,_=new cy({modes:p});let r={},S={};qt(()=>a.value,de=>{_&&_.onAdd(de),de.on(t,M),de.on(i,M)});let C=new Date().getTime();const M=de=>{var be;_.getAll();const{type:ke,features:We,action:we}=de;if(ke==i&&We.length){let Me=null;if([Kl.MEASUREDISTANCE,Kl.MEASUREPOLYGON].includes(d.value)){const{id:Ae}=We[0];Me=Ae}else{const{id:Ae}=We[0],Be=((be=Object.values(r))==null?void 0:be[0]).filter(Ve=>Ve.id==Ae);Be&&Be.length&&(Me=Be[0].properties.timeStamp,r[Me]=r[Me].filter(Ve=>Ve.id!=Ae))}Me&&(S[Me].forEach(Ae=>{Ae.remove()}),S[Me]=[])}d.value==Kl.MEASUREPOLYGON&&de.features&&de.features.length&&(j(de.features[0]),d.value=""),d.value==Kl.MEASUREDISTANCE&&de.features&&de.features.length&&(te(de.features[0]),d.value=""),d.value==Kl.MEASUREANGLE&&de.features&&de.features.length&&F(de.features[0]),d.value==Kl.AZIMUTH&&de.features&&de.features.length&&k(de.features[0])},k=de=>{const ke=_.getAll(),{id:We}=de;ke.features.forEach((we,be,Me)=>{we.id==We&&(Me[be].properties.timeStamp=C,r[C]&&r[C].length&&r[C].length<2?r[C].push(we):r[C]||(r[C]=[we]))}),r[C].length<2?setTimeout(function(){_.changeMode("draw_point")},0):(z(),d.value="")},z=()=>{S[C]=[];let de=[];for(let Me=0;Me<r[C].length;Me++)de.push(r[C][Me].geometry.coordinates);const ke=J(de[0],de[1]),We=[de[0][0],de[0][1]+ke/111139];de.unshift(We);for(let Me=0;Me<de.length;Me++)S[C].push(new Ts.Marker(Y(Me==0?Vve:IS,Me==0)).setLngLat(de[Me]).addTo(a.value));S[C].push(new Ts.Marker({element:ce("")}).setLngLat(de[0]).setOffset([0,-12]).addTo(a.value));const we=BO({points:de}),be=VO(we);S[C].push(new Ts.Marker(B(be)).setLngLat(de[1]).addTo(a.value)),_.get(C)&&_.delete([C]),_.add({id:C,type:"Feature",properties:{},geometry:{type:"LineString",coordinates:de}})},F=de=>{const ke=_.getAll(),{id:We}=de;ke.features.forEach((we,be,Me)=>{we.id==We&&(Me[be].properties.timeStamp=C,r[C]&&r[C].length&&r[C].length<3?r[C].push(we):r[C]||(r[C]=[we]))}),r[C].length<3?setTimeout(function(){_.changeMode("draw_point")},0):(N(),d.value="")},B=de=>{const ke=document.createElement("img");return ke.className="mapbox-tool-angle-img",ke.src=de,ke.style.width="200px",ke.style.height="200px",ke},N=()=>{S[C]=[];let de=[];for(let we=0;we<r[C].length;we++){let be=r[C][we].geometry.coordinates;de.push(be),S[C].push(new Ts.Marker(Y(IS)).setLngLat(be).addTo(a.value))}const ke=BO({points:de}),We=VO(ke);S[C].push(new Ts.Marker(B(We)).setLngLat(de[1]).addTo(a.value)),_.get(C)&&_.delete([C]),_.add({id:C,type:"Feature",properties:{},geometry:{type:"LineString",coordinates:de}})},j=de=>{const{geometry:{coordinates:ke},id:We}=de;S[We]=[],q(ke[0],!0,We);const we=Ive(ke),be=Fve(we),Me=Ove(de);S[We].push(new Ts.Marker({element:ce(jve(Me))}).setLngLat(be.geometry.coordinates).addTo(a.value))},U=(de="start")=>{const ke=document.createElement("div");return ke.className="mapbox-tool-marker",ke.style.background=`url(${de=="start"?Nve:Bve})`,ke.style.backgroundSize="100%",ke.style.width="32px",ke.style.height="32px",ke.style.display="block",ke},te=de=>{const{geometry:{coordinates:ke},id:We}=de,we=U("start");S[We]=[],S[We].push(new Ts.Marker(we).setLngLat(ke[0]).setOffset([0,-14]).addTo(a.value));const be=U("end");S[We].push(new Ts.Marker(be).setLngLat(ke[ke.length-1]).setOffset([0,-14]).addTo(a.value)),ke.length>2&&q(ke,!1,We),ne(ke,We)},Y=(de,ke)=>{const We=document.createElement("div");return We.className="mapbox-tool-marker",We.style.background=`url(${de})`,We.style.backgroundSize="100%",We.style.width=ke?"24px":"12px",We.style.height="12px",We.style.display="block",We};function q(de,ke,We){let we=0;for(ke||(we=1);we<de.length-1;we++)S[We].push(new Ts.Marker(Y(IS)).setLngLat(de[we]).addTo(a.value))}function J(de,ke){const We=[de[1],de[0]],we=[ke[1],ke[0]],be=lC(We),Me=lC(we);return kve(be,Me,{units:"meters"})}function ne(de,ke){let We=0;for(let we=0;we<de.length-1;we++){const be=de[we],Me=de[we+1],Ae=J(be,Me);We+=Ae,se(be,Me,Ae,ke)}de.length>2&&S[ke].push(new Ts.Marker({element:ce($O(We))}).setLngLat(de[de.length-1]).setOffset([0,15]).addTo(a.value))}function se(de,ke,We,we){const be=[(de[0]+ke[0])/2,(de[1]+ke[1])/2],Me=fe(de,ke),Ae=$O(We);S[we].push(new Ts.Marker({element:ce(Ae)}).setLngLat(be).setRotation(Me).setOffset([0,-10]).addTo(a.value))}function fe(de,ke){const We=ke[0]-de[0],we=ke[1]-de[1];let Me=Math.atan2(we,We)*(180/Math.PI);return Me<0&&(Me+=360),360-Me}function ce(de){const ke=document.createElement("div");return ke.style.fontSize="12px",ke.style.color="#333",ke.style.textAlign="center",ke.style.textShadow="2px 2px 5px white",ke.textContent=`${de}`,ke}const le=de=>{d.value=de,C=new Date().getTime();const ke=Hve[de];if(ke)_.changeMode(ke);else{_.deleteAll(),d.value="",r={},C=void 0;for(let We in S)S[We].forEach(we=>we.remove())}},ge=[{text:"",icon:"#icon-measure-distance",type:Kl.MEASUREDISTANCE},{text:"",icon:"#icon-measure-polygon",type:Kl.MEASUREPOLYGON},{text:"",icon:"#icon-protractor",type:Kl.MEASUREANGLE},{text:"",icon:"#icon-azimuth",type:Kl.AZIMUTH},{text:"",icon:"#icon-delete",type:Kl.CLEAR}];return(de,ke)=>{const We=Er("el-tooltip");return ae(),Oe("ul",Wve,[(ae(),Oe(Bn,null,Or(ge,we=>Ue("li",{class:pe({active:d.value==we.type}),onClick:()=>le(we.type)},[Ze(We,{class:"box-item",effect:"dark",content:we.text,placement:"left",offset:20},{default:st(()=>[Ue("span",Kve,[(ae(),Oe("svg",Zve,[Ue("use",{"xlink:href":we.icon},null,8,Yve)]))])]),_:2},1032,["content"])],10,qve)),64))])}}}),Jve=_M(Xve,[["__scopeId","data-v-fdc1615d"]]),Qve={id:"map"},e_e=qe({__name:"map",setup(e){Ts.accessToken="pk.eyJ1IjoibG9uZ2xvbmd3YXl0b2dvIiwiYSI6ImNqdnZ6OWV6cTFnY240NG9nbmxnc2k5dTkifQ.hsbNl4QUNyn46nfbztiFpw";const t=vM(),i=()=>{const a=new Ts.Map({container:"map",style:"mapbox://styles/mapbox/light-v10",center:[114.3055,30.5928],zoom:12,projection:"globe"});a.scrollZoom.enable(),a.touchZoomRotate.enable(),a.addControl(new Nge({defaultLanguage:"zh-Hans"})),a.addControl(new Ts.FullscreenControl),a.addControl(new Ts.NavigationControl,"top-left"),a.addControl(new Ts.ScaleControl),a.addControl(new Ts.GeolocateControl({positionOptions:{enableHighAccuracy:!0},trackUserLocation:!0,showUserHeading:!0})),t.setMapConfig({map:a})};return gr(()=>{i()}),(a,d)=>(ae(),Oe("div",Qve,[Ze($ge),Ze(Jve)]))}}),t_e=_M(e_e,[["__scopeId","data-v-fd9e3bb9"]]),n_e=qe({__name:"App",setup(e){const t=document.querySelector("#svgBase"),i=()=>{fetch("./icons.svg").then(a=>a.text()).then(a=>{t&&a&&(t.innerHTML=a)})};return fy(()=>{i()}),(a,d)=>(ae(),kt(t_e))}}),r_e=sU(),MM=pD(n_e);MM.use(r_e);MM.use(Oge);let Sf=null;function jB(e){const{container:t}=e,i=t?t.querySelector("#app"):document.getElementById("app");return console.log(" ~ render ~ node:",i),Sf=MM.mount(i),Sf}Dge({mount(e){Sf=jB(e)},bootstrap(){},unmount(e){console.log(e),Sf==null||Sf.unmount()},update(e){console.log(e)}});Lge.__POWERED_BY_QIANKUN__||(Sf=jB({}))});export default o_e();
