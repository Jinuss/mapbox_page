var V$=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var sye=V$((Ha,Ga)=>{(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const d of document.querySelectorAll('link[rel="modulepreload"]'))a(d);new MutationObserver(d=>{for(const p of d)if(p.type==="childList")for(const y of p.addedNodes)y.tagName==="LINK"&&y.rel==="modulepreload"&&a(y)}).observe(document,{childList:!0,subtree:!0});function o(d){const p={};return d.integrity&&(p.integrity=d.integrity),d.referrerPolicy&&(p.referrerPolicy=d.referrerPolicy),d.crossOrigin==="use-credentials"?p.credentials="include":d.crossOrigin==="anonymous"?p.credentials="omit":p.credentials="same-origin",p}function a(d){if(d.ep)return;d.ep=!0;const p=o(d);fetch(d.href,p)}})();/**
* @vue/shared v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**//*! #__NO_SIDE_EFFECTS__ */function uC(e){const t=Object.create(null);for(const o of e.split(","))t[o]=1;return o=>o in t}const ao={},xm=[],vi=()=>{},$$=()=>!1,G1=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&(e.charCodeAt(2)>122||e.charCodeAt(2)<97),cC=e=>e.startsWith("onUpdate:"),ns=Object.assign,dC=(e,t)=>{const o=e.indexOf(t);o>-1&&e.splice(o,1)},U$=Object.prototype.hasOwnProperty,ri=(e,t)=>U$.call(e,t),sn=Array.isArray,wm=e=>Xy(e)==="[object Map]",W1=e=>Xy(e)==="[object Set]",Gd=e=>Xy(e)==="[object Date]",$n=e=>typeof e=="function",Nn=e=>typeof e=="string",Xl=e=>typeof e=="symbol",xr=e=>e!==null&&typeof e=="object",xy=e=>(xr(e)||$n(e))&&$n(e.then)&&$n(e.catch),jO=Object.prototype.toString,Xy=e=>jO.call(e),j$=e=>Xy(e).slice(8,-1),wy=e=>Xy(e)==="[object Object]",fC=e=>Nn(e)&&e!=="NaN"&&e[0]!=="-"&&""+parseInt(e,10)===e,oy=uC(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),q1=e=>{const t=Object.create(null);return o=>t[o]||(t[o]=e(o))},H$=/-(\w)/g,ra=q1(e=>e.replace(H$,(t,o)=>o?o.toUpperCase():"")),G$=/\B([A-Z])/g,Rc=q1(e=>e.replace(G$,"-$1").toLowerCase()),Jy=q1(e=>e.charAt(0).toUpperCase()+e.slice(1)),sy=q1(e=>e?`on${Jy(e)}`:""),$d=(e,t)=>!Object.is(e,t),Ub=(e,...t)=>{for(let o=0;o<e.length;o++)e[o](...t)},HO=(e,t,o,a=!1)=>{Object.defineProperty(e,t,{configurable:!0,enumerable:!1,writable:a,value:o})},kS=e=>{const t=parseFloat(e);return isNaN(t)?e:t},W$=e=>{const t=Nn(e)?Number(e):NaN;return isNaN(t)?e:t};let Xk;const K1=()=>Xk||(Xk=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function Un(e){if(sn(e)){const t={};for(let o=0;o<e.length;o++){const a=e[o],d=Nn(a)?Y$(a):Un(a);if(d)for(const p in d)t[p]=d[p]}return t}else if(Nn(e)||xr(e))return e}const q$=/;(?![^(]*\))/g,K$=/:([^]+)/,Z$=/\/\*[^]*?\*\//g;function Y$(e){const t={};return e.replace(Z$,"").split(q$).forEach(o=>{if(o){const a=o.split(K$);a.length>1&&(t[a[0].trim()]=a[1].trim())}}),t}function fe(e){let t="";if(Nn(e))t=e;else if(sn(e))for(let o=0;o<e.length;o++){const a=fe(e[o]);a&&(t+=a+" ")}else if(xr(e))for(const o in e)e[o]&&(t+=o+" ");return t.trim()}function Gl(e){if(!e)return null;let{class:t,style:o}=e;return t&&!Nn(t)&&(e.class=fe(t)),o&&(e.style=Un(o)),e}const X$="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",J$=uC(X$);function GO(e){return!!e||e===""}function Q$(e,t){if(e.length!==t.length)return!1;let o=!0;for(let a=0;o&&a<e.length;a++)o=Pm(e[a],t[a]);return o}function Pm(e,t){if(e===t)return!0;let o=Gd(e),a=Gd(t);if(o||a)return o&&a?e.getTime()===t.getTime():!1;if(o=Xl(e),a=Xl(t),o||a)return e===t;if(o=sn(e),a=sn(t),o||a)return o&&a?Q$(e,t):!1;if(o=xr(e),a=xr(t),o||a){if(!o||!a)return!1;const d=Object.keys(e).length,p=Object.keys(t).length;if(d!==p)return!1;for(const y in e){const r=e.hasOwnProperty(y),S=t.hasOwnProperty(y);if(r&&!S||!r&&S||!Pm(e[y],t[y]))return!1}}return String(e)===String(t)}function WO(e,t){return e.findIndex(o=>Pm(o,t))}const qO=e=>!!(e&&e.__v_isRef===!0),fn=e=>Nn(e)?e:e==null?"":sn(e)||xr(e)&&(e.toString===jO||!$n(e.toString))?qO(e)?fn(e.value):JSON.stringify(e,KO,2):String(e),KO=(e,t)=>qO(t)?KO(e,t.value):wm(t)?{[`Map(${t.size})`]:[...t.entries()].reduce((o,[a,d],p)=>(o[N2(a,p)+" =>"]=d,o),{})}:W1(t)?{[`Set(${t.size})`]:[...t.values()].map(o=>N2(o))}:Xl(t)?N2(t):xr(t)&&!sn(t)&&!wy(t)?String(t):t,N2=(e,t="")=>{var o;return Xl(e)?`Symbol(${(o=e.description)!=null?o:t})`:e};/**
* @vue/reactivity v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let Ys;class ZO{constructor(t=!1){this.detached=t,this._active=!0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=Ys,!t&&Ys&&(this.index=(Ys.scopes||(Ys.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let t,o;if(this.scopes)for(t=0,o=this.scopes.length;t<o;t++)this.scopes[t].pause();for(t=0,o=this.effects.length;t<o;t++)this.effects[t].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let t,o;if(this.scopes)for(t=0,o=this.scopes.length;t<o;t++)this.scopes[t].resume();for(t=0,o=this.effects.length;t<o;t++)this.effects[t].resume()}}run(t){if(this._active){const o=Ys;try{return Ys=this,t()}finally{Ys=o}}}on(){Ys=this}off(){Ys=this.parent}stop(t){if(this._active){this._active=!1;let o,a;for(o=0,a=this.effects.length;o<a;o++)this.effects[o].stop();for(this.effects.length=0,o=0,a=this.cleanups.length;o<a;o++)this.cleanups[o]();if(this.cleanups.length=0,this.scopes){for(o=0,a=this.scopes.length;o<a;o++)this.scopes[o].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!t){const d=this.parent.scopes.pop();d&&d!==this&&(this.parent.scopes[this.index]=d,d.index=this.index)}this.parent=void 0}}}function hC(e){return new ZO(e)}function pC(){return Ys}function mC(e,t=!1){Ys&&Ys.cleanups.push(e)}let mo;const B2=new WeakSet;class YO{constructor(t){this.fn=t,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,Ys&&Ys.active&&Ys.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,B2.has(this)&&(B2.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||JO(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,Jk(this),QO(this);const t=mo,o=Kl;mo=this,Kl=!0;try{return this.fn()}finally{eL(this),mo=t,Kl=o,this.flags&=-3}}stop(){if(this.flags&1){for(let t=this.deps;t;t=t.nextDep)yC(t);this.deps=this.depsTail=void 0,Jk(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?B2.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){PS(this)&&this.run()}get dirty(){return PS(this)}}let XO=0,ay,ly;function JO(e,t=!1){if(e.flags|=8,t){e.next=ly,ly=e;return}e.next=ay,ay=e}function gC(){XO++}function _C(){if(--XO>0)return;if(ly){let t=ly;for(ly=void 0;t;){const o=t.next;t.next=void 0,t.flags&=-9,t=o}}let e;for(;ay;){let t=ay;for(ay=void 0;t;){const o=t.next;if(t.next=void 0,t.flags&=-9,t.flags&1)try{t.trigger()}catch(a){e||(e=a)}t=o}}if(e)throw e}function QO(e){for(let t=e.deps;t;t=t.nextDep)t.version=-1,t.prevActiveLink=t.dep.activeLink,t.dep.activeLink=t}function eL(e){let t,o=e.depsTail,a=o;for(;a;){const d=a.prevDep;a.version===-1?(a===o&&(o=d),yC(a),e6(a)):t=a,a.dep.activeLink=a.prevActiveLink,a.prevActiveLink=void 0,a=d}e.deps=t,e.depsTail=o}function PS(e){for(let t=e.deps;t;t=t.nextDep)if(t.dep.version!==t.version||t.dep.computed&&(tL(t.dep.computed)||t.dep.version!==t.version))return!0;return!!e._dirty}function tL(e){if(e.flags&4&&!(e.flags&16)||(e.flags&=-17,e.globalVersion===Sy))return;e.globalVersion=Sy;const t=e.dep;if(e.flags|=2,t.version>0&&!e.isSSR&&e.deps&&!PS(e)){e.flags&=-3;return}const o=mo,a=Kl;mo=e,Kl=!0;try{QO(e);const d=e.fn(e._value);(t.version===0||$d(d,e._value))&&(e._value=d,t.version++)}catch(d){throw t.version++,d}finally{mo=o,Kl=a,eL(e),e.flags&=-3}}function yC(e,t=!1){const{dep:o,prevSub:a,nextSub:d}=e;if(a&&(a.nextSub=d,e.prevSub=void 0),d&&(d.prevSub=a,e.nextSub=void 0),o.subs===e&&(o.subs=a,!a&&o.computed)){o.computed.flags&=-5;for(let p=o.computed.deps;p;p=p.nextDep)yC(p,!0)}!t&&!--o.sc&&o.map&&o.map.delete(o.key)}function e6(e){const{prevDep:t,nextDep:o}=e;t&&(t.nextDep=o,e.prevDep=void 0),o&&(o.prevDep=t,e.nextDep=void 0)}let Kl=!0;const nL=[];function tf(){nL.push(Kl),Kl=!1}function nf(){const e=nL.pop();Kl=e===void 0?!0:e}function Jk(e){const{cleanup:t}=e;if(e.cleanup=void 0,t){const o=mo;mo=void 0;try{t()}finally{mo=o}}}let Sy=0,t6=class{constructor(t,o){this.sub=t,this.dep=o,this.version=o.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}};class Z1{constructor(t){this.computed=t,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0}track(t){if(!mo||!Kl||mo===this.computed)return;let o=this.activeLink;if(o===void 0||o.sub!==mo)o=this.activeLink=new t6(mo,this),mo.deps?(o.prevDep=mo.depsTail,mo.depsTail.nextDep=o,mo.depsTail=o):mo.deps=mo.depsTail=o,rL(o);else if(o.version===-1&&(o.version=this.version,o.nextDep)){const a=o.nextDep;a.prevDep=o.prevDep,o.prevDep&&(o.prevDep.nextDep=a),o.prevDep=mo.depsTail,o.nextDep=void 0,mo.depsTail.nextDep=o,mo.depsTail=o,mo.deps===o&&(mo.deps=a)}return o}trigger(t){this.version++,Sy++,this.notify(t)}notify(t){gC();try{for(let o=this.subs;o;o=o.prevSub)o.sub.notify()&&o.sub.dep.notify()}finally{_C()}}}function rL(e){if(e.dep.sc++,e.sub.flags&4){const t=e.dep.computed;if(t&&!e.dep.subs){t.flags|=20;for(let a=t.deps;a;a=a.nextDep)rL(a)}const o=e.dep.subs;o!==e&&(e.prevSub=o,o&&(o.nextSub=e)),e.dep.subs=e}}const c1=new WeakMap,ph=Symbol(""),RS=Symbol(""),Ty=Symbol("");function Ds(e,t,o){if(Kl&&mo){let a=c1.get(e);a||c1.set(e,a=new Map);let d=a.get(o);d||(a.set(o,d=new Z1),d.map=a,d.key=o),d.track()}}function wc(e,t,o,a,d,p){const y=c1.get(e);if(!y){Sy++;return}const r=S=>{S&&S.trigger()};if(gC(),t==="clear")y.forEach(r);else{const S=sn(e),C=S&&fC(o);if(S&&o==="length"){const M=Number(a);y.forEach((P,z)=>{(z==="length"||z===Ty||!Xl(z)&&z>=M)&&r(P)})}else switch((o!==void 0||y.has(void 0))&&r(y.get(o)),C&&r(y.get(Ty)),t){case"add":S?C&&r(y.get("length")):(r(y.get(ph)),wm(e)&&r(y.get(RS)));break;case"delete":S||(r(y.get(ph)),wm(e)&&r(y.get(RS)));break;case"set":wm(e)&&r(y.get(ph));break}}_C()}function n6(e,t){const o=c1.get(e);return o&&o.get(t)}function im(e){const t=wi(e);return t===e?t:(Ds(t,"iterate",Ty),al(e)?t:t.map(zs))}function Y1(e){return Ds(e=wi(e),"iterate",Ty),e}const r6={__proto__:null,[Symbol.iterator](){return V2(this,Symbol.iterator,zs)},concat(...e){return im(this).concat(...e.map(t=>sn(t)?im(t):t))},entries(){return V2(this,"entries",e=>(e[1]=zs(e[1]),e))},every(e,t){return _c(this,"every",e,t,void 0,arguments)},filter(e,t){return _c(this,"filter",e,t,o=>o.map(zs),arguments)},find(e,t){return _c(this,"find",e,t,zs,arguments)},findIndex(e,t){return _c(this,"findIndex",e,t,void 0,arguments)},findLast(e,t){return _c(this,"findLast",e,t,zs,arguments)},findLastIndex(e,t){return _c(this,"findLastIndex",e,t,void 0,arguments)},forEach(e,t){return _c(this,"forEach",e,t,void 0,arguments)},includes(...e){return $2(this,"includes",e)},indexOf(...e){return $2(this,"indexOf",e)},join(e){return im(this).join(e)},lastIndexOf(...e){return $2(this,"lastIndexOf",e)},map(e,t){return _c(this,"map",e,t,void 0,arguments)},pop(){return W_(this,"pop")},push(...e){return W_(this,"push",e)},reduce(e,...t){return Qk(this,"reduce",e,t)},reduceRight(e,...t){return Qk(this,"reduceRight",e,t)},shift(){return W_(this,"shift")},some(e,t){return _c(this,"some",e,t,void 0,arguments)},splice(...e){return W_(this,"splice",e)},toReversed(){return im(this).toReversed()},toSorted(e){return im(this).toSorted(e)},toSpliced(...e){return im(this).toSpliced(...e)},unshift(...e){return W_(this,"unshift",e)},values(){return V2(this,"values",zs)}};function V2(e,t,o){const a=Y1(e),d=a[t]();return a!==e&&!al(e)&&(d._next=d.next,d.next=()=>{const p=d._next();return p.value&&(p.value=o(p.value)),p}),d}const i6=Array.prototype;function _c(e,t,o,a,d,p){const y=Y1(e),r=y!==e&&!al(e),S=y[t];if(S!==i6[t]){const P=S.apply(e,p);return r?zs(P):P}let C=o;y!==e&&(r?C=function(P,z){return o.call(this,zs(P),z,e)}:o.length>2&&(C=function(P,z){return o.call(this,P,z,e)}));const M=S.call(y,C,a);return r&&d?d(M):M}function Qk(e,t,o,a){const d=Y1(e);let p=o;return d!==e&&(al(e)?o.length>3&&(p=function(y,r,S){return o.call(this,y,r,S,e)}):p=function(y,r,S){return o.call(this,y,zs(r),S,e)}),d[t](p,...a)}function $2(e,t,o){const a=wi(e);Ds(a,"iterate",Ty);const d=a[t](...o);return(d===-1||d===!1)&&xC(o[0])?(o[0]=wi(o[0]),a[t](...o)):d}function W_(e,t,o=[]){tf(),gC();const a=wi(e)[t].apply(e,o);return _C(),nf(),a}const o6=uC("__proto__,__v_isRef,__isVue"),iL=new Set(Object.getOwnPropertyNames(Symbol).filter(e=>e!=="arguments"&&e!=="caller").map(e=>Symbol[e]).filter(Xl));function s6(e){Xl(e)||(e=String(e));const t=wi(this);return Ds(t,"has",e),t.hasOwnProperty(e)}class oL{constructor(t=!1,o=!1){this._isReadonly=t,this._isShallow=o}get(t,o,a){if(o==="__v_skip")return t.__v_skip;const d=this._isReadonly,p=this._isShallow;if(o==="__v_isReactive")return!d;if(o==="__v_isReadonly")return d;if(o==="__v_isShallow")return p;if(o==="__v_raw")return a===(d?p?g6:uL:p?lL:aL).get(t)||Object.getPrototypeOf(t)===Object.getPrototypeOf(a)?t:void 0;const y=sn(t);if(!d){let S;if(y&&(S=r6[o]))return S;if(o==="hasOwnProperty")return s6}const r=Reflect.get(t,o,Ti(t)?t:a);return(Xl(o)?iL.has(o):o6(o))||(d||Ds(t,"get",o),p)?r:Ti(r)?y&&fC(o)?r:r.value:xr(r)?d?Qm(r):si(r):r}}class sL extends oL{constructor(t=!1){super(!1,t)}set(t,o,a,d){let p=t[o];if(!this._isShallow){const S=bh(p);if(!al(a)&&!bh(a)&&(p=wi(p),a=wi(a)),!sn(t)&&Ti(p)&&!Ti(a))return S?!1:(p.value=a,!0)}const y=sn(t)&&fC(o)?Number(o)<t.length:ri(t,o),r=Reflect.set(t,o,a,Ti(t)?t:d);return t===wi(d)&&(y?$d(a,p)&&wc(t,"set",o,a):wc(t,"add",o,a)),r}deleteProperty(t,o){const a=ri(t,o);t[o];const d=Reflect.deleteProperty(t,o);return d&&a&&wc(t,"delete",o,void 0),d}has(t,o){const a=Reflect.has(t,o);return(!Xl(o)||!iL.has(o))&&Ds(t,"has",o),a}ownKeys(t){return Ds(t,"iterate",sn(t)?"length":ph),Reflect.ownKeys(t)}}class a6 extends oL{constructor(t=!1){super(!0,t)}set(t,o){return!0}deleteProperty(t,o){return!0}}const l6=new sL,u6=new a6,c6=new sL(!0),OS=e=>e,mb=e=>Reflect.getPrototypeOf(e);function d6(e,t,o){return function(...a){const d=this.__v_raw,p=wi(d),y=wm(p),r=e==="entries"||e===Symbol.iterator&&y,S=e==="keys"&&y,C=d[e](...a),M=o?OS:t?LS:zs;return!t&&Ds(p,"iterate",S?RS:ph),{next(){const{value:P,done:z}=C.next();return z?{value:P,done:z}:{value:r?[M(P[0]),M(P[1])]:M(P),done:z}},[Symbol.iterator](){return this}}}}function gb(e){return function(...t){return e==="delete"?!1:e==="clear"?void 0:this}}function f6(e,t){const o={get(d){const p=this.__v_raw,y=wi(p),r=wi(d);e||($d(d,r)&&Ds(y,"get",d),Ds(y,"get",r));const{has:S}=mb(y),C=t?OS:e?LS:zs;if(S.call(y,d))return C(p.get(d));if(S.call(y,r))return C(p.get(r));p!==y&&p.get(d)},get size(){const d=this.__v_raw;return!e&&Ds(wi(d),"iterate",ph),Reflect.get(d,"size",d)},has(d){const p=this.__v_raw,y=wi(p),r=wi(d);return e||($d(d,r)&&Ds(y,"has",d),Ds(y,"has",r)),d===r?p.has(d):p.has(d)||p.has(r)},forEach(d,p){const y=this,r=y.__v_raw,S=wi(r),C=t?OS:e?LS:zs;return!e&&Ds(S,"iterate",ph),r.forEach((M,P)=>d.call(p,C(M),C(P),y))}};return ns(o,e?{add:gb("add"),set:gb("set"),delete:gb("delete"),clear:gb("clear")}:{add(d){!t&&!al(d)&&!bh(d)&&(d=wi(d));const p=wi(this);return mb(p).has.call(p,d)||(p.add(d),wc(p,"add",d,d)),this},set(d,p){!t&&!al(p)&&!bh(p)&&(p=wi(p));const y=wi(this),{has:r,get:S}=mb(y);let C=r.call(y,d);C||(d=wi(d),C=r.call(y,d));const M=S.call(y,d);return y.set(d,p),C?$d(p,M)&&wc(y,"set",d,p):wc(y,"add",d,p),this},delete(d){const p=wi(this),{has:y,get:r}=mb(p);let S=y.call(p,d);S||(d=wi(d),S=y.call(p,d)),r&&r.call(p,d);const C=p.delete(d);return S&&wc(p,"delete",d,void 0),C},clear(){const d=wi(this),p=d.size!==0,y=d.clear();return p&&wc(d,"clear",void 0,void 0),y}}),["keys","values","entries",Symbol.iterator].forEach(d=>{o[d]=d6(d,e,t)}),o}function vC(e,t){const o=f6(e,t);return(a,d,p)=>d==="__v_isReactive"?!e:d==="__v_isReadonly"?e:d==="__v_raw"?a:Reflect.get(ri(o,d)&&d in a?o:a,d,p)}const h6={get:vC(!1,!1)},p6={get:vC(!1,!0)},m6={get:vC(!0,!1)},aL=new WeakMap,lL=new WeakMap,uL=new WeakMap,g6=new WeakMap;function _6(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function y6(e){return e.__v_skip||!Object.isExtensible(e)?0:_6(j$(e))}function si(e){return bh(e)?e:bC(e,!1,l6,h6,aL)}function cL(e){return bC(e,!1,c6,p6,lL)}function Qm(e){return bC(e,!0,u6,m6,uL)}function bC(e,t,o,a,d){if(!xr(e)||e.__v_raw&&!(t&&e.__v_isReactive))return e;const p=d.get(e);if(p)return p;const y=y6(e);if(y===0)return e;const r=new Proxy(e,y===2?a:o);return d.set(e,r),r}function Ec(e){return bh(e)?Ec(e.__v_raw):!!(e&&e.__v_isReactive)}function bh(e){return!!(e&&e.__v_isReadonly)}function al(e){return!!(e&&e.__v_isShallow)}function xC(e){return e?!!e.__v_raw:!1}function wi(e){const t=e&&e.__v_raw;return t?wi(t):e}function Ou(e){return!ri(e,"__v_skip")&&Object.isExtensible(e)&&HO(e,"__v_skip",!0),e}const zs=e=>xr(e)?si(e):e,LS=e=>xr(e)?Qm(e):e;function Ti(e){return e?e.__v_isRef===!0:!1}function xe(e){return dL(e,!1)}function Hi(e){return dL(e,!0)}function dL(e,t){return Ti(e)?e:new v6(e,t)}class v6{constructor(t,o){this.dep=new Z1,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=o?t:wi(t),this._value=o?t:zs(t),this.__v_isShallow=o}get value(){return this.dep.track(),this._value}set value(t){const o=this._rawValue,a=this.__v_isShallow||al(t)||bh(t);t=a?t:wi(t),$d(t,o)&&(this._rawValue=t,this._value=a?t:zs(t),this.dep.trigger())}}function b(e){return Ti(e)?e.value:e}const b6={get:(e,t,o)=>t==="__v_raw"?e:b(Reflect.get(e,t,o)),set:(e,t,o,a)=>{const d=e[t];return Ti(d)&&!Ti(o)?(d.value=o,!0):Reflect.set(e,t,o,a)}};function fL(e){return Ec(e)?e:new Proxy(e,b6)}class x6{constructor(t){this.__v_isRef=!0,this._value=void 0;const o=this.dep=new Z1,{get:a,set:d}=t(o.track.bind(o),o.trigger.bind(o));this._get=a,this._set=d}get value(){return this._value=this._get()}set value(t){this._set(t)}}function w6(e){return new x6(e)}function Go(e){const t=sn(e)?new Array(e.length):{};for(const o in e)t[o]=hL(e,o);return t}class S6{constructor(t,o,a){this._object=t,this._key=o,this._defaultValue=a,this.__v_isRef=!0,this._value=void 0}get value(){const t=this._object[this._key];return this._value=t===void 0?this._defaultValue:t}set value(t){this._object[this._key]=t}get dep(){return n6(wi(this._object),this._key)}}class T6{constructor(t){this._getter=t,this.__v_isRef=!0,this.__v_isReadonly=!0,this._value=void 0}get value(){return this._value=this._getter()}}function hi(e,t,o){return Ti(e)?e:$n(e)?new T6(e):xr(e)&&arguments.length>1?hL(e,t,o):xe(e)}function hL(e,t,o){const a=e[t];return Ti(a)?a:new S6(e,t,o)}class C6{constructor(t,o,a){this.fn=t,this.setter=o,this._value=void 0,this.dep=new Z1(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=Sy-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!o,this.isSSR=a}notify(){if(this.flags|=16,!(this.flags&8)&&mo!==this)return JO(this,!0),!0}get value(){const t=this.dep.track();return tL(this),t&&(t.version=this.dep.version),this._value}set value(t){this.setter&&this.setter(t)}}function E6(e,t,o=!1){let a,d;return $n(e)?a=e:(a=e.get,d=e.set),new C6(a,d,o)}const _b={},d1=new WeakMap;let ih;function M6(e,t=!1,o=ih){if(o){let a=d1.get(o);a||d1.set(o,a=[]),a.push(e)}}function I6(e,t,o=ao){const{immediate:a,deep:d,once:p,scheduler:y,augmentJob:r,call:S}=o,C=q=>d?q:al(q)||d===!1||d===0?Sc(q,1):Sc(q);let M,P,z,F,V=!1,N=!1;if(Ti(e)?(P=()=>e.value,V=al(e)):Ec(e)?(P=()=>C(e),V=!0):sn(e)?(N=!0,V=e.some(q=>Ec(q)||al(q)),P=()=>e.map(q=>{if(Ti(q))return q.value;if(Ec(q))return C(q);if($n(q))return S?S(q,2):q()})):$n(e)?t?P=S?()=>S(e,2):e:P=()=>{if(z){tf();try{z()}finally{nf()}}const q=ih;ih=M;try{return S?S(e,3,[F]):e(F)}finally{ih=q}}:P=vi,t&&d){const q=P,J=d===!0?1/0:d;P=()=>Sc(q(),J)}const H=pC(),U=()=>{M.stop(),H&&H.active&&dC(H.effects,M)};if(p&&t){const q=t;t=(...J)=>{q(...J),U()}}let te=N?new Array(e.length).fill(_b):_b;const Z=q=>{if(!(!(M.flags&1)||!M.dirty&&!q))if(t){const J=M.run();if(d||V||(N?J.some((re,se)=>$d(re,te[se])):$d(J,te))){z&&z();const re=ih;ih=M;try{const se=[J,te===_b?void 0:N&&te[0]===_b?[]:te,F];S?S(t,3,se):t(...se),te=J}finally{ih=re}}}else M.run()};return r&&r(Z),M=new YO(P),M.scheduler=y?()=>y(Z,!1):Z,F=q=>M6(q,!1,M),z=M.onStop=()=>{const q=d1.get(M);if(q){if(S)S(q,4);else for(const J of q)J();d1.delete(M)}},t?a?Z(!0):te=M.run():y?y(Z.bind(null,!0),!0):M.run(),U.pause=M.pause.bind(M),U.resume=M.resume.bind(M),U.stop=U,U}function Sc(e,t=1/0,o){if(t<=0||!xr(e)||e.__v_skip||(o=o||new Set,o.has(e)))return e;if(o.add(e),t--,Ti(e))Sc(e.value,t,o);else if(sn(e))for(let a=0;a<e.length;a++)Sc(e[a],t,o);else if(W1(e)||wm(e))e.forEach(a=>{Sc(a,t,o)});else if(wy(e)){for(const a in e)Sc(e[a],t,o);for(const a of Object.getOwnPropertySymbols(e))Object.prototype.propertyIsEnumerable.call(e,a)&&Sc(e[a],t,o)}return e}/**
* @vue/runtime-core v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function Qy(e,t,o,a){try{return a?e(...a):e()}catch(d){X1(d,t,o)}}function Jl(e,t,o,a){if($n(e)){const d=Qy(e,t,o,a);return d&&xy(d)&&d.catch(p=>{X1(p,t,o)}),d}if(sn(e)){const d=[];for(let p=0;p<e.length;p++)d.push(Jl(e[p],t,o,a));return d}}function X1(e,t,o,a=!0){const d=t?t.vnode:null,{errorHandler:p,throwUnhandledErrorInProduction:y}=t&&t.appContext.config||ao;if(t){let r=t.parent;const S=t.proxy,C=`https://vuejs.org/error-reference/#runtime-${o}`;for(;r;){const M=r.ec;if(M){for(let P=0;P<M.length;P++)if(M[P](e,S,C)===!1)return}r=r.parent}if(p){tf(),Qy(p,null,10,[e,S,C]),nf();return}}A6(e,o,d,a,y)}function A6(e,t,o,a=!0,d=!1){if(d)throw e;console.error(e)}const Xs=[];let Au=-1;const Sm=[];let Ld=null,fm=0;const pL=Promise.resolve();let f1=null;function jn(e){const t=f1||pL;return e?t.then(this?e.bind(this):e):t}function k6(e){let t=Au+1,o=Xs.length;for(;t<o;){const a=t+o>>>1,d=Xs[a],p=Cy(d);p<e||p===e&&d.flags&2?t=a+1:o=a}return t}function wC(e){if(!(e.flags&1)){const t=Cy(e),o=Xs[Xs.length-1];!o||!(e.flags&2)&&t>=Cy(o)?Xs.push(e):Xs.splice(k6(t),0,e),e.flags|=1,mL()}}function mL(){f1||(f1=pL.then(_L))}function P6(e){sn(e)?Sm.push(...e):Ld&&e.id===-1?Ld.splice(fm+1,0,e):e.flags&1||(Sm.push(e),e.flags|=1),mL()}function eP(e,t,o=Au+1){for(;o<Xs.length;o++){const a=Xs[o];if(a&&a.flags&2){if(e&&a.id!==e.uid)continue;Xs.splice(o,1),o--,a.flags&4&&(a.flags&=-2),a(),a.flags&4||(a.flags&=-2)}}}function gL(e){if(Sm.length){const t=[...new Set(Sm)].sort((o,a)=>Cy(o)-Cy(a));if(Sm.length=0,Ld){Ld.push(...t);return}for(Ld=t,fm=0;fm<Ld.length;fm++){const o=Ld[fm];o.flags&4&&(o.flags&=-2),o.flags&8||o(),o.flags&=-2}Ld=null,fm=0}}const Cy=e=>e.id==null?e.flags&2?-1:1/0:e.id;function _L(e){try{for(Au=0;Au<Xs.length;Au++){const t=Xs[Au];t&&!(t.flags&8)&&(t.flags&4&&(t.flags&=-2),Qy(t,t.i,t.i?15:14),t.flags&4||(t.flags&=-2))}}finally{for(;Au<Xs.length;Au++){const t=Xs[Au];t&&(t.flags&=-2)}Au=-1,Xs.length=0,gL(),f1=null,(Xs.length||Sm.length)&&_L()}}let es=null,yL=null;function h1(e){const t=es;return es=e,yL=e&&e.type.__scopeId||null,t}function ot(e,t=es,o){if(!t||e._n)return e;const a=(...d)=>{a._d&&pP(-1);const p=h1(t);let y;try{y=e(...d)}finally{h1(p),a._d&&pP(1)}return y};return a._n=!0,a._c=!0,a._d=!0,a}function hr(e,t){if(es===null)return e;const o=nx(es),a=e.dirs||(e.dirs=[]);for(let d=0;d<t.length;d++){let[p,y,r,S=ao]=t[d];p&&($n(p)&&(p={mounted:p,updated:p}),p.deep&&Sc(y),a.push({dir:p,instance:o,value:y,oldValue:void 0,arg:r,modifiers:S}))}return e}function Qf(e,t,o,a){const d=e.dirs,p=t&&t.dirs;for(let y=0;y<d.length;y++){const r=d[y];p&&(r.oldValue=p[y].value);let S=r.dir[a];S&&(tf(),Jl(S,o,8,[e.el,r,e,t]),nf())}}const vL=Symbol("_vte"),bL=e=>e.__isTeleport,uy=e=>e&&(e.disabled||e.disabled===""),tP=e=>e&&(e.defer||e.defer===""),nP=e=>typeof SVGElement<"u"&&e instanceof SVGElement,rP=e=>typeof MathMLElement=="function"&&e instanceof MathMLElement,DS=(e,t)=>{const o=e&&e.to;return Nn(o)?t?t(o):null:o},xL={name:"Teleport",__isTeleport:!0,process(e,t,o,a,d,p,y,r,S,C){const{mc:M,pc:P,pbc:z,o:{insert:F,querySelector:V,createText:N,createComment:H}}=C,U=uy(t.props);let{shapeFlag:te,children:Z,dynamicChildren:q}=t;if(e==null){const J=t.el=N(""),re=t.anchor=N("");F(J,o,a),F(re,o,a);const se=(le,ce)=>{te&16&&(d&&d.isCE&&(d.ce._teleportTarget=le),M(Z,le,ce,d,p,y,r,S))},he=()=>{const le=t.target=DS(t.props,V),ce=wL(le,t,N,F);le&&(y!=="svg"&&nP(le)?y="svg":y!=="mathml"&&rP(le)&&(y="mathml"),U||(se(le,ce),jb(t,!1)))};U&&(se(o,re),jb(t,!0)),tP(t.props)?Zs(()=>{he(),t.el.__isMounted=!0},p):he()}else{if(tP(t.props)&&!e.el.__isMounted){Zs(()=>{xL.process(e,t,o,a,d,p,y,r,S,C),delete e.el.__isMounted},p);return}t.el=e.el,t.targetStart=e.targetStart;const J=t.anchor=e.anchor,re=t.target=e.target,se=t.targetAnchor=e.targetAnchor,he=uy(e.props),le=he?o:re,ce=he?J:se;if(y==="svg"||nP(re)?y="svg":(y==="mathml"||rP(re))&&(y="mathml"),q?(z(e.dynamicChildren,q,le,d,p,y,r),IC(e,t,!0)):S||P(e,t,le,ce,d,p,y,r,!1),U)he?t.props&&e.props&&t.props.to!==e.props.to&&(t.props.to=e.props.to):yb(t,o,J,C,1);else if((t.props&&t.props.to)!==(e.props&&e.props.to)){const pe=t.target=DS(t.props,V);pe&&yb(t,pe,null,C,0)}else he&&yb(t,re,se,C,1);jb(t,U)}},remove(e,t,o,{um:a,o:{remove:d}},p){const{shapeFlag:y,children:r,anchor:S,targetStart:C,targetAnchor:M,target:P,props:z}=e;if(P&&(d(C),d(M)),p&&d(S),y&16){const F=p||!uy(z);for(let V=0;V<r.length;V++){const N=r[V];a(N,t,o,F,!!N.dynamicChildren)}}},move:yb,hydrate:R6};function yb(e,t,o,{o:{insert:a},m:d},p=2){p===0&&a(e.targetAnchor,t,o);const{el:y,anchor:r,shapeFlag:S,children:C,props:M}=e,P=p===2;if(P&&a(y,t,o),(!P||uy(M))&&S&16)for(let z=0;z<C.length;z++)d(C[z],t,o,2);P&&a(r,t,o)}function R6(e,t,o,a,d,p,{o:{nextSibling:y,parentNode:r,querySelector:S,insert:C,createText:M}},P){const z=t.target=DS(t.props,S);if(z){const F=uy(t.props),V=z._lpa||z.firstChild;if(t.shapeFlag&16)if(F)t.anchor=P(y(e),t,r(e),o,a,d,p),t.targetStart=V,t.targetAnchor=V&&y(V);else{t.anchor=y(e);let N=V;for(;N;){if(N&&N.nodeType===8){if(N.data==="teleport start anchor")t.targetStart=N;else if(N.data==="teleport anchor"){t.targetAnchor=N,z._lpa=t.targetAnchor&&y(t.targetAnchor);break}}N=y(N)}t.targetAnchor||wL(z,t,M,C),P(V&&y(V),t,z,o,a,d,p)}jb(t,F)}return t.anchor&&y(t.anchor)}const O6=xL;function jb(e,t){const o=e.ctx;if(o&&o.ut){let a,d;for(t?(a=e.el,d=e.anchor):(a=e.targetStart,d=e.targetAnchor);a&&a!==d;)a.nodeType===1&&a.setAttribute("data-v-owner",o.uid),a=a.nextSibling;o.ut()}}function wL(e,t,o,a){const d=t.targetStart=o(""),p=t.targetAnchor=o("");return d[vL]=p,e&&(a(d,e),a(p,e)),p}const Dd=Symbol("_leaveCb"),vb=Symbol("_enterCb");function SL(){const e={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return yr(()=>{e.isMounted=!0}),Li(()=>{e.isUnmounting=!0}),e}const tl=[Function,Array],TL={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:tl,onEnter:tl,onAfterEnter:tl,onEnterCancelled:tl,onBeforeLeave:tl,onLeave:tl,onAfterLeave:tl,onLeaveCancelled:tl,onBeforeAppear:tl,onAppear:tl,onAfterAppear:tl,onAppearCancelled:tl},CL=e=>{const t=e.subTree;return t.component?CL(t.component):t},L6={name:"BaseTransition",props:TL,setup(e,{slots:t}){const o=Cr(),a=SL();return()=>{const d=t.default&&SC(t.default(),!0);if(!d||!d.length)return;const p=EL(d),y=wi(e),{mode:r}=y;if(a.isLeaving)return U2(p);const S=iP(p);if(!S)return U2(p);let C=Ey(S,y,a,o,P=>C=P);S.type!==Qo&&xh(S,C);let M=o.subTree&&iP(o.subTree);if(M&&M.type!==Qo&&!oh(S,M)&&CL(o).type!==Qo){let P=Ey(M,y,a,o);if(xh(M,P),r==="out-in"&&S.type!==Qo)return a.isLeaving=!0,P.afterLeave=()=>{a.isLeaving=!1,o.job.flags&8||o.update(),delete P.afterLeave,M=void 0},U2(p);r==="in-out"&&S.type!==Qo?P.delayLeave=(z,F,V)=>{const N=ML(a,M);N[String(M.key)]=M,z[Dd]=()=>{F(),z[Dd]=void 0,delete C.delayedLeave,M=void 0},C.delayedLeave=()=>{V(),delete C.delayedLeave,M=void 0}}:M=void 0}else M&&(M=void 0);return p}}};function EL(e){let t=e[0];if(e.length>1){for(const o of e)if(o.type!==Qo){t=o;break}}return t}const D6=L6;function ML(e,t){const{leavingVNodes:o}=e;let a=o.get(t.type);return a||(a=Object.create(null),o.set(t.type,a)),a}function Ey(e,t,o,a,d){const{appear:p,mode:y,persisted:r=!1,onBeforeEnter:S,onEnter:C,onAfterEnter:M,onEnterCancelled:P,onBeforeLeave:z,onLeave:F,onAfterLeave:V,onLeaveCancelled:N,onBeforeAppear:H,onAppear:U,onAfterAppear:te,onAppearCancelled:Z}=t,q=String(e.key),J=ML(o,e),re=(le,ce)=>{le&&Jl(le,a,9,ce)},se=(le,ce)=>{const pe=ce[1];re(le,ce),sn(le)?le.every(de=>de.length<=1)&&pe():le.length<=1&&pe()},he={mode:y,persisted:r,beforeEnter(le){let ce=S;if(!o.isMounted)if(p)ce=H||S;else return;le[Dd]&&le[Dd](!0);const pe=J[q];pe&&oh(e,pe)&&pe.el[Dd]&&pe.el[Dd](),re(ce,[le])},enter(le){let ce=C,pe=M,de=P;if(!o.isMounted)if(p)ce=U||C,pe=te||M,de=Z||P;else return;let Ie=!1;const Ve=le[vb]=be=>{Ie||(Ie=!0,be?re(de,[le]):re(pe,[le]),he.delayedLeave&&he.delayedLeave(),le[vb]=void 0)};ce?se(ce,[le,Ve]):Ve()},leave(le,ce){const pe=String(e.key);if(le[vb]&&le[vb](!0),o.isUnmounting)return ce();re(z,[le]);let de=!1;const Ie=le[Dd]=Ve=>{de||(de=!0,ce(),Ve?re(N,[le]):re(V,[le]),le[Dd]=void 0,J[pe]===e&&delete J[pe])};J[pe]=e,F?se(F,[le,Ie]):Ie()},clone(le){const ce=Ey(le,t,o,a,d);return d&&d(ce),ce}};return he}function U2(e){if(J1(e))return e=Ic(e),e.children=null,e}function iP(e){if(!J1(e))return bL(e.type)&&e.children?EL(e.children):e;const{shapeFlag:t,children:o}=e;if(o){if(t&16)return o[0];if(t&32&&$n(o.default))return o.default()}}function xh(e,t){e.shapeFlag&6&&e.component?(e.transition=t,xh(e.component.subTree,t)):e.shapeFlag&128?(e.ssContent.transition=t.clone(e.ssContent),e.ssFallback.transition=t.clone(e.ssFallback)):e.transition=t}function SC(e,t=!1,o){let a=[],d=0;for(let p=0;p<e.length;p++){let y=e[p];const r=o==null?y.key:String(o)+String(y.key!=null?y.key:p);y.type===Vn?(y.patchFlag&128&&d++,a=a.concat(SC(y.children,t,r))):(t||y.type!==Qo)&&a.push(r!=null?Ic(y,{key:r}):y)}if(d>1)for(let p=0;p<a.length;p++)a[p].patchFlag=-2;return a}/*! #__NO_SIDE_EFFECTS__ */function We(e,t){return $n(e)?ns({name:e.name},t,{setup:e}):e}function IL(e){e.ids=[e.ids[0]+e.ids[2]+++"-",0,0]}function p1(e,t,o,a,d=!1){if(sn(e)){e.forEach((V,N)=>p1(V,t&&(sn(t)?t[N]:t),o,a,d));return}if(Tm(a)&&!d){a.shapeFlag&512&&a.type.__asyncResolved&&a.component.subTree.component&&p1(e,t,o,a.component.subTree);return}const p=a.shapeFlag&4?nx(a.component):a.el,y=d?null:p,{i:r,r:S}=e,C=t&&t.r,M=r.refs===ao?r.refs={}:r.refs,P=r.setupState,z=wi(P),F=P===ao?()=>!1:V=>ri(z,V);if(C!=null&&C!==S&&(Nn(C)?(M[C]=null,F(C)&&(P[C]=null)):Ti(C)&&(C.value=null)),$n(S))Qy(S,r,12,[y,M]);else{const V=Nn(S),N=Ti(S);if(V||N){const H=()=>{if(e.f){const U=V?F(S)?P[S]:M[S]:S.value;d?sn(U)&&dC(U,p):sn(U)?U.includes(p)||U.push(p):V?(M[S]=[p],F(S)&&(P[S]=M[S])):(S.value=[p],e.k&&(M[e.k]=S.value))}else V?(M[S]=y,F(S)&&(P[S]=y)):N&&(S.value=y,e.k&&(M[e.k]=y))};y?(H.id=-1,Zs(H,o)):H()}}}K1().requestIdleCallback;K1().cancelIdleCallback;const Tm=e=>!!e.type.__asyncLoader,J1=e=>e.type.__isKeepAlive;function TC(e,t){kL(e,"a",t)}function AL(e,t){kL(e,"da",t)}function kL(e,t,o=as){const a=e.__wdc||(e.__wdc=()=>{let d=o;for(;d;){if(d.isDeactivated)return;d=d.parent}return e()});if(Q1(t,a,o),o){let d=o.parent;for(;d&&d.parent;)J1(d.parent.vnode)&&z6(a,t,o,d),d=d.parent}}function z6(e,t,o,a){const d=Q1(t,e,a,!0);rf(()=>{dC(a[t],d)},o)}function Q1(e,t,o=as,a=!1){if(o){const d=o[e]||(o[e]=[]),p=t.__weh||(t.__weh=(...y)=>{tf();const r=tv(o),S=Jl(t,o,e,y);return r(),nf(),S});return a?d.unshift(p):d.push(p),p}}const Oc=e=>(t,o=as)=>{(!Iy||e==="sp")&&Q1(e,(...a)=>t(...a),o)},ev=Oc("bm"),yr=Oc("m"),PL=Oc("bu"),Uu=Oc("u"),Li=Oc("bum"),rf=Oc("um"),F6=Oc("sp"),N6=Oc("rtg"),B6=Oc("rtc");function V6(e,t=as){Q1("ec",e,t)}const CC="components",$6="directives";function Er(e,t){return EC(CC,e,!0,t)||e}const RL=Symbol.for("v-ndc");function Ir(e){return Nn(e)?EC(CC,e,!1)||e:e||RL}function ex(e){return EC($6,e)}function EC(e,t,o=!0,a=!1){const d=es||as;if(d){const p=d.type;if(e===CC){const r=E8(p,!1);if(r&&(r===t||r===ra(t)||r===Jy(ra(t))))return p}const y=oP(d[e]||p[e],t)||oP(d.appContext[e],t);return!y&&a?p:y}}function oP(e,t){return e&&(e[t]||e[ra(t)]||e[Jy(ra(t))])}function Fr(e,t,o,a){let d;const p=o,y=sn(e);if(y||Nn(e)){const r=y&&Ec(e);let S=!1;r&&(S=!al(e),e=Y1(e)),d=new Array(e.length);for(let C=0,M=e.length;C<M;C++)d[C]=t(S?zs(e[C]):e[C],C,void 0,p)}else if(typeof e=="number"){d=new Array(e);for(let r=0;r<e;r++)d[r]=t(r+1,r,void 0,p)}else if(xr(e))if(e[Symbol.iterator])d=Array.from(e,(r,S)=>t(r,S,void 0,p));else{const r=Object.keys(e);d=new Array(r.length);for(let S=0,C=r.length;S<C;S++){const M=r[S];d[S]=t(e[M],M,S,p)}}else d=[];return d}function cl(e,t){for(let o=0;o<t.length;o++){const a=t[o];if(sn(a))for(let d=0;d<a.length;d++)e[a[d].name]=a[d].fn;else a&&(e[a.name]=a.key?(...d)=>{const p=a.fn(...d);return p&&(p.key=a.key),p}:a.fn)}return e}function gt(e,t,o={},a,d){if(es.ce||es.parent&&Tm(es.parent)&&es.parent.ce)return t!=="default"&&(o.name=t),ae(),At(Vn,null,[qe("slot",o,a&&a())],64);let p=e[t];p&&p._c&&(p._d=!1),ae();const y=p&&OL(p(o)),r=o.key||y&&y.key,S=At(Vn,{key:(r&&!Xl(r)?r:`_${t}`)+(!y&&a?"_fb":"")},y||(a?a():[]),y&&e._===1?64:-2);return S.scopeId&&(S.slotScopeIds=[S.scopeId+"-s"]),p&&p._c&&(p._d=!0),S}function OL(e){return e.some(t=>Ji(t)?!(t.type===Qo||t.type===Vn&&!OL(t.children)):!0)?e:null}function U6(e,t){const o={};for(const a in e)o[sy(a)]=e[a];return o}const zS=e=>e?QL(e)?nx(e):zS(e.parent):null,cy=ns(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>e.props,$attrs:e=>e.attrs,$slots:e=>e.slots,$refs:e=>e.refs,$parent:e=>zS(e.parent),$root:e=>zS(e.root),$host:e=>e.ce,$emit:e=>e.emit,$options:e=>zL(e),$forceUpdate:e=>e.f||(e.f=()=>{wC(e.update)}),$nextTick:e=>e.n||(e.n=jn.bind(e.proxy)),$watch:e=>c8.bind(e)}),j2=(e,t)=>e!==ao&&!e.__isScriptSetup&&ri(e,t),j6={get({_:e},t){if(t==="__v_skip")return!0;const{ctx:o,setupState:a,data:d,props:p,accessCache:y,type:r,appContext:S}=e;let C;if(t[0]!=="$"){const F=y[t];if(F!==void 0)switch(F){case 1:return a[t];case 2:return d[t];case 4:return o[t];case 3:return p[t]}else{if(j2(a,t))return y[t]=1,a[t];if(d!==ao&&ri(d,t))return y[t]=2,d[t];if((C=e.propsOptions[0])&&ri(C,t))return y[t]=3,p[t];if(o!==ao&&ri(o,t))return y[t]=4,o[t];FS&&(y[t]=0)}}const M=cy[t];let P,z;if(M)return t==="$attrs"&&Ds(e.attrs,"get",""),M(e);if((P=r.__cssModules)&&(P=P[t]))return P;if(o!==ao&&ri(o,t))return y[t]=4,o[t];if(z=S.config.globalProperties,ri(z,t))return z[t]},set({_:e},t,o){const{data:a,setupState:d,ctx:p}=e;return j2(d,t)?(d[t]=o,!0):a!==ao&&ri(a,t)?(a[t]=o,!0):ri(e.props,t)||t[0]==="$"&&t.slice(1)in e?!1:(p[t]=o,!0)},has({_:{data:e,setupState:t,accessCache:o,ctx:a,appContext:d,propsOptions:p}},y){let r;return!!o[y]||e!==ao&&ri(e,y)||j2(t,y)||(r=p[0])&&ri(r,y)||ri(a,y)||ri(cy,y)||ri(d.config.globalProperties,y)},defineProperty(e,t,o){return o.get!=null?e._.accessCache[t]=0:ri(o,"value")&&this.set(e,t,o.value,null),Reflect.defineProperty(e,t,o)}};function Bo(){return LL().slots}function of(){return LL().attrs}function LL(){const e=Cr();return e.setupContext||(e.setupContext=tD(e))}function sP(e){return sn(e)?e.reduce((t,o)=>(t[o]=null,t),{}):e}let FS=!0;function H6(e){const t=zL(e),o=e.proxy,a=e.ctx;FS=!1,t.beforeCreate&&aP(t.beforeCreate,e,"bc");const{data:d,computed:p,methods:y,watch:r,provide:S,inject:C,created:M,beforeMount:P,mounted:z,beforeUpdate:F,updated:V,activated:N,deactivated:H,beforeDestroy:U,beforeUnmount:te,destroyed:Z,unmounted:q,render:J,renderTracked:re,renderTriggered:se,errorCaptured:he,serverPrefetch:le,expose:ce,inheritAttrs:pe,components:de,directives:Ie,filters:Ve}=t;if(C&&G6(C,a,null),y)for(const Me in y){const we=y[Me];$n(we)&&(a[Me]=we.bind(o))}if(d){const Me=d.call(o,o);xr(Me)&&(e.data=si(Me))}if(FS=!0,p)for(const Me in p){const we=p[Me],me=$n(we)?we.bind(o,o):$n(we.get)?we.get.bind(o,o):vi,De=!$n(we)&&$n(we.set)?we.set.bind(o):vi,Ge=ee({get:me,set:De});Object.defineProperty(a,Me,{enumerable:!0,configurable:!0,get:()=>Ge.value,set:rt=>Ge.value=rt})}if(r)for(const Me in r)DL(r[Me],a,o,Me);if(S){const Me=$n(S)?S.call(o):S;Reflect.ownKeys(Me).forEach(we=>{Vr(we,Me[we])})}M&&aP(M,e,"c");function ye(Me,we){sn(we)?we.forEach(me=>Me(me.bind(o))):we&&Me(we.bind(o))}if(ye(ev,P),ye(yr,z),ye(PL,F),ye(Uu,V),ye(TC,N),ye(AL,H),ye(V6,he),ye(B6,re),ye(N6,se),ye(Li,te),ye(rf,q),ye(F6,le),sn(ce))if(ce.length){const Me=e.exposed||(e.exposed={});ce.forEach(we=>{Object.defineProperty(Me,we,{get:()=>o[we],set:me=>o[we]=me})})}else e.exposed||(e.exposed={});J&&e.render===vi&&(e.render=J),pe!=null&&(e.inheritAttrs=pe),de&&(e.components=de),Ie&&(e.directives=Ie),le&&IL(e)}function G6(e,t,o=vi){sn(e)&&(e=NS(e));for(const a in e){const d=e[a];let p;xr(d)?"default"in d?p=Pn(d.from||a,d.default,!0):p=Pn(d.from||a):p=Pn(d),Ti(p)?Object.defineProperty(t,a,{enumerable:!0,configurable:!0,get:()=>p.value,set:y=>p.value=y}):t[a]=p}}function aP(e,t,o){Jl(sn(e)?e.map(a=>a.bind(t.proxy)):e.bind(t.proxy),t,o)}function DL(e,t,o,a){let d=a.includes(".")?KL(o,a):()=>o[a];if(Nn(e)){const p=t[e];$n(p)&&Wt(d,p)}else if($n(e))Wt(d,e.bind(o));else if(xr(e))if(sn(e))e.forEach(p=>DL(p,t,o,a));else{const p=$n(e.handler)?e.handler.bind(o):t[e.handler];$n(p)&&Wt(d,p,e)}}function zL(e){const t=e.type,{mixins:o,extends:a}=t,{mixins:d,optionsCache:p,config:{optionMergeStrategies:y}}=e.appContext,r=p.get(t);let S;return r?S=r:!d.length&&!o&&!a?S=t:(S={},d.length&&d.forEach(C=>m1(S,C,y,!0)),m1(S,t,y)),xr(t)&&p.set(t,S),S}function m1(e,t,o,a=!1){const{mixins:d,extends:p}=t;p&&m1(e,p,o,!0),d&&d.forEach(y=>m1(e,y,o,!0));for(const y in t)if(!(a&&y==="expose")){const r=W6[y]||o&&o[y];e[y]=r?r(e[y],t[y]):t[y]}return e}const W6={data:lP,props:uP,emits:uP,methods:ty,computed:ty,beforeCreate:qs,created:qs,beforeMount:qs,mounted:qs,beforeUpdate:qs,updated:qs,beforeDestroy:qs,beforeUnmount:qs,destroyed:qs,unmounted:qs,activated:qs,deactivated:qs,errorCaptured:qs,serverPrefetch:qs,components:ty,directives:ty,watch:K6,provide:lP,inject:q6};function lP(e,t){return t?e?function(){return ns($n(e)?e.call(this,this):e,$n(t)?t.call(this,this):t)}:t:e}function q6(e,t){return ty(NS(e),NS(t))}function NS(e){if(sn(e)){const t={};for(let o=0;o<e.length;o++)t[e[o]]=e[o];return t}return e}function qs(e,t){return e?[...new Set([].concat(e,t))]:t}function ty(e,t){return e?ns(Object.create(null),e,t):t}function uP(e,t){return e?sn(e)&&sn(t)?[...new Set([...e,...t])]:ns(Object.create(null),sP(e),sP(t??{})):t}function K6(e,t){if(!e)return t;if(!t)return e;const o=ns(Object.create(null),e);for(const a in t)o[a]=qs(e[a],t[a]);return o}function FL(){return{app:null,config:{isNativeTag:$$,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let Z6=0;function Y6(e,t){return function(a,d=null){$n(a)||(a=ns({},a)),d!=null&&!xr(d)&&(d=null);const p=FL(),y=new WeakSet,r=[];let S=!1;const C=p.app={_uid:Z6++,_component:a,_props:d,_container:null,_context:p,_instance:null,version:I8,get config(){return p.config},set config(M){},use(M,...P){return y.has(M)||(M&&$n(M.install)?(y.add(M),M.install(C,...P)):$n(M)&&(y.add(M),M(C,...P))),C},mixin(M){return p.mixins.includes(M)||p.mixins.push(M),C},component(M,P){return P?(p.components[M]=P,C):p.components[M]},directive(M,P){return P?(p.directives[M]=P,C):p.directives[M]},mount(M,P,z){if(!S){const F=C._ceVNode||qe(a,d);return F.appContext=p,z===!0?z="svg":z===!1&&(z=void 0),e(F,M,z),S=!0,C._container=M,M.__vue_app__=C,nx(F.component)}},onUnmount(M){r.push(M)},unmount(){S&&(Jl(r,C._instance,16),e(null,C._container),delete C._container.__vue_app__)},provide(M,P){return p.provides[M]=P,C},runWithContext(M){const P=mh;mh=C;try{return M()}finally{mh=P}}};return C}}let mh=null;function Vr(e,t){if(as){let o=as.provides;const a=as.parent&&as.parent.provides;a===o&&(o=as.provides=Object.create(a)),o[e]=t}}function Pn(e,t,o=!1){const a=as||es;if(a||mh){const d=mh?mh._context.provides:a?a.parent==null?a.vnode.appContext&&a.vnode.appContext.provides:a.parent.provides:void 0;if(d&&e in d)return d[e];if(arguments.length>1)return o&&$n(t)?t.call(a&&a.proxy):t}}function X6(){return!!(as||es||mh)}const NL={},BL=()=>Object.create(NL),VL=e=>Object.getPrototypeOf(e)===NL;function J6(e,t,o,a=!1){const d={},p=BL();e.propsDefaults=Object.create(null),$L(e,t,d,p);for(const y in e.propsOptions[0])y in d||(d[y]=void 0);o?e.props=a?d:cL(d):e.type.props?e.props=d:e.props=p,e.attrs=p}function Q6(e,t,o,a){const{props:d,attrs:p,vnode:{patchFlag:y}}=e,r=wi(d),[S]=e.propsOptions;let C=!1;if((a||y>0)&&!(y&16)){if(y&8){const M=e.vnode.dynamicProps;for(let P=0;P<M.length;P++){let z=M[P];if(tx(e.emitsOptions,z))continue;const F=t[z];if(S)if(ri(p,z))F!==p[z]&&(p[z]=F,C=!0);else{const V=ra(z);d[V]=BS(S,r,V,F,e,!1)}else F!==p[z]&&(p[z]=F,C=!0)}}}else{$L(e,t,d,p)&&(C=!0);let M;for(const P in r)(!t||!ri(t,P)&&((M=Rc(P))===P||!ri(t,M)))&&(S?o&&(o[P]!==void 0||o[M]!==void 0)&&(d[P]=BS(S,r,P,void 0,e,!0)):delete d[P]);if(p!==r)for(const P in p)(!t||!ri(t,P))&&(delete p[P],C=!0)}C&&wc(e.attrs,"set","")}function $L(e,t,o,a){const[d,p]=e.propsOptions;let y=!1,r;if(t)for(let S in t){if(oy(S))continue;const C=t[S];let M;d&&ri(d,M=ra(S))?!p||!p.includes(M)?o[M]=C:(r||(r={}))[M]=C:tx(e.emitsOptions,S)||(!(S in a)||C!==a[S])&&(a[S]=C,y=!0)}if(p){const S=wi(o),C=r||ao;for(let M=0;M<p.length;M++){const P=p[M];o[P]=BS(d,S,P,C[P],e,!ri(C,P))}}return y}function BS(e,t,o,a,d,p){const y=e[o];if(y!=null){const r=ri(y,"default");if(r&&a===void 0){const S=y.default;if(y.type!==Function&&!y.skipFactory&&$n(S)){const{propsDefaults:C}=d;if(o in C)a=C[o];else{const M=tv(d);a=C[o]=S.call(null,t),M()}}else a=S;d.ce&&d.ce._setProp(o,a)}y[0]&&(p&&!r?a=!1:y[1]&&(a===""||a===Rc(o))&&(a=!0))}return a}const e8=new WeakMap;function UL(e,t,o=!1){const a=o?e8:t.propsCache,d=a.get(e);if(d)return d;const p=e.props,y={},r=[];let S=!1;if(!$n(e)){const M=P=>{S=!0;const[z,F]=UL(P,t,!0);ns(y,z),F&&r.push(...F)};!o&&t.mixins.length&&t.mixins.forEach(M),e.extends&&M(e.extends),e.mixins&&e.mixins.forEach(M)}if(!p&&!S)return xr(e)&&a.set(e,xm),xm;if(sn(p))for(let M=0;M<p.length;M++){const P=ra(p[M]);cP(P)&&(y[P]=ao)}else if(p)for(const M in p){const P=ra(M);if(cP(P)){const z=p[M],F=y[P]=sn(z)||$n(z)?{type:z}:ns({},z),V=F.type;let N=!1,H=!0;if(sn(V))for(let U=0;U<V.length;++U){const te=V[U],Z=$n(te)&&te.name;if(Z==="Boolean"){N=!0;break}else Z==="String"&&(H=!1)}else N=$n(V)&&V.name==="Boolean";F[0]=N,F[1]=H,(N||ri(F,"default"))&&r.push(P)}}const C=[y,r];return xr(e)&&a.set(e,C),C}function cP(e){return e[0]!=="$"&&!oy(e)}const jL=e=>e[0]==="_"||e==="$stable",MC=e=>sn(e)?e.map(ku):[ku(e)],t8=(e,t,o)=>{if(t._n)return t;const a=ot((...d)=>MC(t(...d)),o);return a._c=!1,a},HL=(e,t,o)=>{const a=e._ctx;for(const d in e){if(jL(d))continue;const p=e[d];if($n(p))t[d]=t8(d,p,a);else if(p!=null){const y=MC(p);t[d]=()=>y}}},GL=(e,t)=>{const o=MC(t);e.slots.default=()=>o},WL=(e,t,o)=>{for(const a in t)(o||a!=="_")&&(e[a]=t[a])},n8=(e,t,o)=>{const a=e.slots=BL();if(e.vnode.shapeFlag&32){const d=t._;d?(WL(a,t,o),o&&HO(a,"_",d,!0)):HL(t,a)}else t&&GL(e,t)},r8=(e,t,o)=>{const{vnode:a,slots:d}=e;let p=!0,y=ao;if(a.shapeFlag&32){const r=t._;r?o&&r===1?p=!1:WL(d,t,o):(p=!t.$stable,HL(t,d)),y=t}else t&&(GL(e,t),y={default:1});if(p)for(const r in d)!jL(r)&&y[r]==null&&delete d[r]},Zs=_8;function i8(e){return o8(e)}function o8(e,t){const o=K1();o.__VUE__=!0;const{insert:a,remove:d,patchProp:p,createElement:y,createText:r,createComment:S,setText:C,setElementText:M,parentNode:P,nextSibling:z,setScopeId:F=vi,insertStaticContent:V}=e,N=(Ae,tt,Je,Jt=null,Kt=null,Nt=null,Pt=void 0,Dt=null,rn=!!tt.dynamicChildren)=>{if(Ae===tt)return;Ae&&!oh(Ae,tt)&&(Jt=_t(Ae),rt(Ae,Kt,Nt,!0),Ae=null),tt.patchFlag===-2&&(rn=!1,tt.dynamicChildren=null);const{type:on,ref:Ln,shapeFlag:yn}=tt;switch(on){case eg:H(Ae,tt,Je,Jt);break;case Qo:U(Ae,tt,Je,Jt);break;case G2:Ae==null&&te(tt,Je,Jt,Pt);break;case Vn:de(Ae,tt,Je,Jt,Kt,Nt,Pt,Dt,rn);break;default:yn&1?J(Ae,tt,Je,Jt,Kt,Nt,Pt,Dt,rn):yn&6?Ie(Ae,tt,Je,Jt,Kt,Nt,Pt,Dt,rn):(yn&64||yn&128)&&on.process(Ae,tt,Je,Jt,Kt,Nt,Pt,Dt,rn,Ne)}Ln!=null&&Kt&&p1(Ln,Ae&&Ae.ref,Nt,tt||Ae,!tt)},H=(Ae,tt,Je,Jt)=>{if(Ae==null)a(tt.el=r(tt.children),Je,Jt);else{const Kt=tt.el=Ae.el;tt.children!==Ae.children&&C(Kt,tt.children)}},U=(Ae,tt,Je,Jt)=>{Ae==null?a(tt.el=S(tt.children||""),Je,Jt):tt.el=Ae.el},te=(Ae,tt,Je,Jt)=>{[Ae.el,Ae.anchor]=V(Ae.children,tt,Je,Jt,Ae.el,Ae.anchor)},Z=({el:Ae,anchor:tt},Je,Jt)=>{let Kt;for(;Ae&&Ae!==tt;)Kt=z(Ae),a(Ae,Je,Jt),Ae=Kt;a(tt,Je,Jt)},q=({el:Ae,anchor:tt})=>{let Je;for(;Ae&&Ae!==tt;)Je=z(Ae),d(Ae),Ae=Je;d(tt)},J=(Ae,tt,Je,Jt,Kt,Nt,Pt,Dt,rn)=>{tt.type==="svg"?Pt="svg":tt.type==="math"&&(Pt="mathml"),Ae==null?re(tt,Je,Jt,Kt,Nt,Pt,Dt,rn):le(Ae,tt,Kt,Nt,Pt,Dt,rn)},re=(Ae,tt,Je,Jt,Kt,Nt,Pt,Dt)=>{let rn,on;const{props:Ln,shapeFlag:yn,transition:Et,dirs:En}=Ae;if(rn=Ae.el=y(Ae.type,Nt,Ln&&Ln.is,Ln),yn&8?M(rn,Ae.children):yn&16&&he(Ae.children,rn,null,Jt,Kt,H2(Ae,Nt),Pt,Dt),En&&Qf(Ae,null,Jt,"created"),se(rn,Ae,Ae.scopeId,Pt,Jt),Ln){for(const vr in Ln)vr!=="value"&&!oy(vr)&&p(rn,vr,null,Ln[vr],Nt,Jt);"value"in Ln&&p(rn,"value",null,Ln.value,Nt),(on=Ln.onVnodeBeforeMount)&&Mu(on,Jt,Ae)}En&&Qf(Ae,null,Jt,"beforeMount");const Xn=s8(Kt,Et);Xn&&Et.beforeEnter(rn),a(rn,tt,Je),((on=Ln&&Ln.onVnodeMounted)||Xn||En)&&Zs(()=>{on&&Mu(on,Jt,Ae),Xn&&Et.enter(rn),En&&Qf(Ae,null,Jt,"mounted")},Kt)},se=(Ae,tt,Je,Jt,Kt)=>{if(Je&&F(Ae,Je),Jt)for(let Nt=0;Nt<Jt.length;Nt++)F(Ae,Jt[Nt]);if(Kt){let Nt=Kt.subTree;if(tt===Nt||YL(Nt.type)&&(Nt.ssContent===tt||Nt.ssFallback===tt)){const Pt=Kt.vnode;se(Ae,Pt,Pt.scopeId,Pt.slotScopeIds,Kt.parent)}}},he=(Ae,tt,Je,Jt,Kt,Nt,Pt,Dt,rn=0)=>{for(let on=rn;on<Ae.length;on++){const Ln=Ae[on]=Dt?zd(Ae[on]):ku(Ae[on]);N(null,Ln,tt,Je,Jt,Kt,Nt,Pt,Dt)}},le=(Ae,tt,Je,Jt,Kt,Nt,Pt)=>{const Dt=tt.el=Ae.el;let{patchFlag:rn,dynamicChildren:on,dirs:Ln}=tt;rn|=Ae.patchFlag&16;const yn=Ae.props||ao,Et=tt.props||ao;let En;if(Je&&eh(Je,!1),(En=Et.onVnodeBeforeUpdate)&&Mu(En,Je,tt,Ae),Ln&&Qf(tt,Ae,Je,"beforeUpdate"),Je&&eh(Je,!0),(yn.innerHTML&&Et.innerHTML==null||yn.textContent&&Et.textContent==null)&&M(Dt,""),on?ce(Ae.dynamicChildren,on,Dt,Je,Jt,H2(tt,Kt),Nt):Pt||we(Ae,tt,Dt,null,Je,Jt,H2(tt,Kt),Nt,!1),rn>0){if(rn&16)pe(Dt,yn,Et,Je,Kt);else if(rn&2&&yn.class!==Et.class&&p(Dt,"class",null,Et.class,Kt),rn&4&&p(Dt,"style",yn.style,Et.style,Kt),rn&8){const Xn=tt.dynamicProps;for(let vr=0;vr<Xn.length;vr++){const er=Xn[vr],Dr=yn[er],Ar=Et[er];(Ar!==Dr||er==="value")&&p(Dt,er,Dr,Ar,Kt,Je)}}rn&1&&Ae.children!==tt.children&&M(Dt,tt.children)}else!Pt&&on==null&&pe(Dt,yn,Et,Je,Kt);((En=Et.onVnodeUpdated)||Ln)&&Zs(()=>{En&&Mu(En,Je,tt,Ae),Ln&&Qf(tt,Ae,Je,"updated")},Jt)},ce=(Ae,tt,Je,Jt,Kt,Nt,Pt)=>{for(let Dt=0;Dt<tt.length;Dt++){const rn=Ae[Dt],on=tt[Dt],Ln=rn.el&&(rn.type===Vn||!oh(rn,on)||rn.shapeFlag&70)?P(rn.el):Je;N(rn,on,Ln,null,Jt,Kt,Nt,Pt,!0)}},pe=(Ae,tt,Je,Jt,Kt)=>{if(tt!==Je){if(tt!==ao)for(const Nt in tt)!oy(Nt)&&!(Nt in Je)&&p(Ae,Nt,tt[Nt],null,Kt,Jt);for(const Nt in Je){if(oy(Nt))continue;const Pt=Je[Nt],Dt=tt[Nt];Pt!==Dt&&Nt!=="value"&&p(Ae,Nt,Dt,Pt,Kt,Jt)}"value"in Je&&p(Ae,"value",tt.value,Je.value,Kt)}},de=(Ae,tt,Je,Jt,Kt,Nt,Pt,Dt,rn)=>{const on=tt.el=Ae?Ae.el:r(""),Ln=tt.anchor=Ae?Ae.anchor:r("");let{patchFlag:yn,dynamicChildren:Et,slotScopeIds:En}=tt;En&&(Dt=Dt?Dt.concat(En):En),Ae==null?(a(on,Je,Jt),a(Ln,Je,Jt),he(tt.children||[],Je,Ln,Kt,Nt,Pt,Dt,rn)):yn>0&&yn&64&&Et&&Ae.dynamicChildren?(ce(Ae.dynamicChildren,Et,Je,Kt,Nt,Pt,Dt),(tt.key!=null||Kt&&tt===Kt.subTree)&&IC(Ae,tt,!0)):we(Ae,tt,Je,Ln,Kt,Nt,Pt,Dt,rn)},Ie=(Ae,tt,Je,Jt,Kt,Nt,Pt,Dt,rn)=>{tt.slotScopeIds=Dt,Ae==null?tt.shapeFlag&512?Kt.ctx.activate(tt,Je,Jt,Pt,rn):Ve(tt,Je,Jt,Kt,Nt,Pt,rn):be(Ae,tt,rn)},Ve=(Ae,tt,Je,Jt,Kt,Nt,Pt)=>{const Dt=Ae.component=w8(Ae,Jt,Kt);if(J1(Ae)&&(Dt.ctx.renderer=Ne),S8(Dt,!1,Pt),Dt.asyncDep){if(Kt&&Kt.registerDep(Dt,ye,Pt),!Ae.el){const rn=Dt.subTree=qe(Qo);U(null,rn,tt,Je)}}else ye(Dt,Ae,tt,Je,Kt,Nt,Pt)},be=(Ae,tt,Je)=>{const Jt=tt.component=Ae.component;if(m8(Ae,tt,Je))if(Jt.asyncDep&&!Jt.asyncResolved){Me(Jt,tt,Je);return}else Jt.next=tt,Jt.update();else tt.el=Ae.el,Jt.vnode=tt},ye=(Ae,tt,Je,Jt,Kt,Nt,Pt)=>{const Dt=()=>{if(Ae.isMounted){let{next:yn,bu:Et,u:En,parent:Xn,vnode:vr}=Ae;{const ui=qL(Ae);if(ui){yn&&(yn.el=vr.el,Me(Ae,yn,Pt)),ui.asyncDep.then(()=>{Ae.isUnmounted||Dt()});return}}let er=yn,Dr;eh(Ae,!1),yn?(yn.el=vr.el,Me(Ae,yn,Pt)):yn=vr,Et&&Ub(Et),(Dr=yn.props&&yn.props.onVnodeBeforeUpdate)&&Mu(Dr,Xn,yn,vr),eh(Ae,!0);const Ar=fP(Ae),Di=Ae.subTree;Ae.subTree=Ar,N(Di,Ar,P(Di.el),_t(Di),Ae,Kt,Nt),yn.el=Ar.el,er===null&&g8(Ae,Ar.el),En&&Zs(En,Kt),(Dr=yn.props&&yn.props.onVnodeUpdated)&&Zs(()=>Mu(Dr,Xn,yn,vr),Kt)}else{let yn;const{el:Et,props:En}=tt,{bm:Xn,m:vr,parent:er,root:Dr,type:Ar}=Ae,Di=Tm(tt);eh(Ae,!1),Xn&&Ub(Xn),!Di&&(yn=En&&En.onVnodeBeforeMount)&&Mu(yn,er,tt),eh(Ae,!0);{Dr.ce&&Dr.ce._injectChildStyle(Ar);const ui=Ae.subTree=fP(Ae);N(null,ui,Je,Jt,Ae,Kt,Nt),tt.el=ui.el}if(vr&&Zs(vr,Kt),!Di&&(yn=En&&En.onVnodeMounted)){const ui=tt;Zs(()=>Mu(yn,er,ui),Kt)}(tt.shapeFlag&256||er&&Tm(er.vnode)&&er.vnode.shapeFlag&256)&&Ae.a&&Zs(Ae.a,Kt),Ae.isMounted=!0,tt=Je=Jt=null}};Ae.scope.on();const rn=Ae.effect=new YO(Dt);Ae.scope.off();const on=Ae.update=rn.run.bind(rn),Ln=Ae.job=rn.runIfDirty.bind(rn);Ln.i=Ae,Ln.id=Ae.uid,rn.scheduler=()=>wC(Ln),eh(Ae,!0),on()},Me=(Ae,tt,Je)=>{tt.component=Ae;const Jt=Ae.vnode.props;Ae.vnode=tt,Ae.next=null,Q6(Ae,tt.props,Jt,Je),r8(Ae,tt.children,Je),tf(),eP(Ae),nf()},we=(Ae,tt,Je,Jt,Kt,Nt,Pt,Dt,rn=!1)=>{const on=Ae&&Ae.children,Ln=Ae?Ae.shapeFlag:0,yn=tt.children,{patchFlag:Et,shapeFlag:En}=tt;if(Et>0){if(Et&128){De(on,yn,Je,Jt,Kt,Nt,Pt,Dt,rn);return}else if(Et&256){me(on,yn,Je,Jt,Kt,Nt,Pt,Dt,rn);return}}En&8?(Ln&16&&Bt(on,Kt,Nt),yn!==on&&M(Je,yn)):Ln&16?En&16?De(on,yn,Je,Jt,Kt,Nt,Pt,Dt,rn):Bt(on,Kt,Nt,!0):(Ln&8&&M(Je,""),En&16&&he(yn,Je,Jt,Kt,Nt,Pt,Dt,rn))},me=(Ae,tt,Je,Jt,Kt,Nt,Pt,Dt,rn)=>{Ae=Ae||xm,tt=tt||xm;const on=Ae.length,Ln=tt.length,yn=Math.min(on,Ln);let Et;for(Et=0;Et<yn;Et++){const En=tt[Et]=rn?zd(tt[Et]):ku(tt[Et]);N(Ae[Et],En,Je,null,Kt,Nt,Pt,Dt,rn)}on>Ln?Bt(Ae,Kt,Nt,!0,!1,yn):he(tt,Je,Jt,Kt,Nt,Pt,Dt,rn,yn)},De=(Ae,tt,Je,Jt,Kt,Nt,Pt,Dt,rn)=>{let on=0;const Ln=tt.length;let yn=Ae.length-1,Et=Ln-1;for(;on<=yn&&on<=Et;){const En=Ae[on],Xn=tt[on]=rn?zd(tt[on]):ku(tt[on]);if(oh(En,Xn))N(En,Xn,Je,null,Kt,Nt,Pt,Dt,rn);else break;on++}for(;on<=yn&&on<=Et;){const En=Ae[yn],Xn=tt[Et]=rn?zd(tt[Et]):ku(tt[Et]);if(oh(En,Xn))N(En,Xn,Je,null,Kt,Nt,Pt,Dt,rn);else break;yn--,Et--}if(on>yn){if(on<=Et){const En=Et+1,Xn=En<Ln?tt[En].el:Jt;for(;on<=Et;)N(null,tt[on]=rn?zd(tt[on]):ku(tt[on]),Je,Xn,Kt,Nt,Pt,Dt,rn),on++}}else if(on>Et)for(;on<=yn;)rt(Ae[on],Kt,Nt,!0),on++;else{const En=on,Xn=on,vr=new Map;for(on=Xn;on<=Et;on++){const Ft=tt[on]=rn?zd(tt[on]):ku(tt[on]);Ft.key!=null&&vr.set(Ft.key,on)}let er,Dr=0;const Ar=Et-Xn+1;let Di=!1,ui=0;const zt=new Array(Ar);for(on=0;on<Ar;on++)zt[on]=0;for(on=En;on<=yn;on++){const Ft=Ae[on];if(Dr>=Ar){rt(Ft,Kt,Nt,!0);continue}let Ye;if(Ft.key!=null)Ye=vr.get(Ft.key);else for(er=Xn;er<=Et;er++)if(zt[er-Xn]===0&&oh(Ft,tt[er])){Ye=er;break}Ye===void 0?rt(Ft,Kt,Nt,!0):(zt[Ye-Xn]=on+1,Ye>=ui?ui=Ye:Di=!0,N(Ft,tt[Ye],Je,null,Kt,Nt,Pt,Dt,rn),Dr++)}const st=Di?a8(zt):xm;for(er=st.length-1,on=Ar-1;on>=0;on--){const Ft=Xn+on,Ye=tt[Ft],pn=Ft+1<Ln?tt[Ft+1].el:Jt;zt[on]===0?N(null,Ye,Je,pn,Kt,Nt,Pt,Dt,rn):Di&&(er<0||on!==st[er]?Ge(Ye,Je,pn,2):er--)}}},Ge=(Ae,tt,Je,Jt,Kt=null)=>{const{el:Nt,type:Pt,transition:Dt,children:rn,shapeFlag:on}=Ae;if(on&6){Ge(Ae.component.subTree,tt,Je,Jt);return}if(on&128){Ae.suspense.move(tt,Je,Jt);return}if(on&64){Pt.move(Ae,tt,Je,Ne);return}if(Pt===Vn){a(Nt,tt,Je);for(let yn=0;yn<rn.length;yn++)Ge(rn[yn],tt,Je,Jt);a(Ae.anchor,tt,Je);return}if(Pt===G2){Z(Ae,tt,Je);return}if(Jt!==2&&on&1&&Dt)if(Jt===0)Dt.beforeEnter(Nt),a(Nt,tt,Je),Zs(()=>Dt.enter(Nt),Kt);else{const{leave:yn,delayLeave:Et,afterLeave:En}=Dt,Xn=()=>a(Nt,tt,Je),vr=()=>{yn(Nt,()=>{Xn(),En&&En()})};Et?Et(Nt,Xn,vr):vr()}else a(Nt,tt,Je)},rt=(Ae,tt,Je,Jt=!1,Kt=!1)=>{const{type:Nt,props:Pt,ref:Dt,children:rn,dynamicChildren:on,shapeFlag:Ln,patchFlag:yn,dirs:Et,cacheIndex:En}=Ae;if(yn===-2&&(Kt=!1),Dt!=null&&p1(Dt,null,Je,Ae,!0),En!=null&&(tt.renderCache[En]=void 0),Ln&256){tt.ctx.deactivate(Ae);return}const Xn=Ln&1&&Et,vr=!Tm(Ae);let er;if(vr&&(er=Pt&&Pt.onVnodeBeforeUnmount)&&Mu(er,tt,Ae),Ln&6)kt(Ae.component,Je,Jt);else{if(Ln&128){Ae.suspense.unmount(Je,Jt);return}Xn&&Qf(Ae,null,tt,"beforeUnmount"),Ln&64?Ae.type.remove(Ae,tt,Je,Ne,Jt):on&&!on.hasOnce&&(Nt!==Vn||yn>0&&yn&64)?Bt(on,tt,Je,!1,!0):(Nt===Vn&&yn&384||!Kt&&Ln&16)&&Bt(rn,tt,Je),Jt&&Oe(Ae)}(vr&&(er=Pt&&Pt.onVnodeUnmounted)||Xn)&&Zs(()=>{er&&Mu(er,tt,Ae),Xn&&Qf(Ae,null,tt,"unmounted")},Je)},Oe=Ae=>{const{type:tt,el:Je,anchor:Jt,transition:Kt}=Ae;if(tt===Vn){Ct(Je,Jt);return}if(tt===G2){q(Ae);return}const Nt=()=>{d(Je),Kt&&!Kt.persisted&&Kt.afterLeave&&Kt.afterLeave()};if(Ae.shapeFlag&1&&Kt&&!Kt.persisted){const{leave:Pt,delayLeave:Dt}=Kt,rn=()=>Pt(Je,Nt);Dt?Dt(Ae.el,Nt,rn):rn()}else Nt()},Ct=(Ae,tt)=>{let Je;for(;Ae!==tt;)Je=z(Ae),d(Ae),Ae=Je;d(tt)},kt=(Ae,tt,Je)=>{const{bum:Jt,scope:Kt,job:Nt,subTree:Pt,um:Dt,m:rn,a:on}=Ae;dP(rn),dP(on),Jt&&Ub(Jt),Kt.stop(),Nt&&(Nt.flags|=8,rt(Pt,Ae,tt,Je)),Dt&&Zs(Dt,tt),Zs(()=>{Ae.isUnmounted=!0},tt),tt&&tt.pendingBranch&&!tt.isUnmounted&&Ae.asyncDep&&!Ae.asyncResolved&&Ae.suspenseId===tt.pendingId&&(tt.deps--,tt.deps===0&&tt.resolve())},Bt=(Ae,tt,Je,Jt=!1,Kt=!1,Nt=0)=>{for(let Pt=Nt;Pt<Ae.length;Pt++)rt(Ae[Pt],tt,Je,Jt,Kt)},_t=Ae=>{if(Ae.shapeFlag&6)return _t(Ae.component.subTree);if(Ae.shapeFlag&128)return Ae.suspense.next();const tt=z(Ae.anchor||Ae.el),Je=tt&&tt[vL];return Je?z(Je):tt};let jt=!1;const Gt=(Ae,tt,Je)=>{Ae==null?tt._vnode&&rt(tt._vnode,null,null,!0):N(tt._vnode||null,Ae,tt,null,null,null,Je),tt._vnode=Ae,jt||(jt=!0,eP(),gL(),jt=!1)},Ne={p:N,um:rt,m:Ge,r:Oe,mt:Ve,mc:he,pc:we,pbc:ce,n:_t,o:e};return{render:Gt,hydrate:void 0,createApp:Y6(Gt)}}function H2({type:e,props:t},o){return o==="svg"&&e==="foreignObject"||o==="mathml"&&e==="annotation-xml"&&t&&t.encoding&&t.encoding.includes("html")?void 0:o}function eh({effect:e,job:t},o){o?(e.flags|=32,t.flags|=4):(e.flags&=-33,t.flags&=-5)}function s8(e,t){return(!e||e&&!e.pendingBranch)&&t&&!t.persisted}function IC(e,t,o=!1){const a=e.children,d=t.children;if(sn(a)&&sn(d))for(let p=0;p<a.length;p++){const y=a[p];let r=d[p];r.shapeFlag&1&&!r.dynamicChildren&&((r.patchFlag<=0||r.patchFlag===32)&&(r=d[p]=zd(d[p]),r.el=y.el),!o&&r.patchFlag!==-2&&IC(y,r)),r.type===eg&&(r.el=y.el)}}function a8(e){const t=e.slice(),o=[0];let a,d,p,y,r;const S=e.length;for(a=0;a<S;a++){const C=e[a];if(C!==0){if(d=o[o.length-1],e[d]<C){t[a]=d,o.push(a);continue}for(p=0,y=o.length-1;p<y;)r=p+y>>1,e[o[r]]<C?p=r+1:y=r;C<e[o[p]]&&(p>0&&(t[a]=o[p-1]),o[p]=a)}}for(p=o.length,y=o[p-1];p-- >0;)o[p]=y,y=t[y];return o}function qL(e){const t=e.subTree.component;if(t)return t.asyncDep&&!t.asyncResolved?t:qL(t)}function dP(e){if(e)for(let t=0;t<e.length;t++)e[t].flags|=8}const l8=Symbol.for("v-scx"),u8=()=>Pn(l8);function gs(e,t){return AC(e,null,t)}function Wt(e,t,o){return AC(e,t,o)}function AC(e,t,o=ao){const{immediate:a,deep:d,flush:p,once:y}=o,r=ns({},o),S=t&&a||!t&&p!=="post";let C;if(Iy){if(p==="sync"){const F=u8();C=F.__watcherHandles||(F.__watcherHandles=[])}else if(!S){const F=()=>{};return F.stop=vi,F.resume=vi,F.pause=vi,F}}const M=as;r.call=(F,V,N)=>Jl(F,M,V,N);let P=!1;p==="post"?r.scheduler=F=>{Zs(F,M&&M.suspense)}:p!=="sync"&&(P=!0,r.scheduler=(F,V)=>{V?F():wC(F)}),r.augmentJob=F=>{t&&(F.flags|=4),P&&(F.flags|=2,M&&(F.id=M.uid,F.i=M))};const z=I6(e,t,r);return Iy&&(C?C.push(z):S&&z()),z}function c8(e,t,o){const a=this.proxy,d=Nn(e)?e.includes(".")?KL(a,e):()=>a[e]:e.bind(a,a);let p;$n(t)?p=t:(p=t.handler,o=t);const y=tv(this),r=AC(d,p.bind(a),o);return y(),r}function KL(e,t){const o=t.split(".");return()=>{let a=e;for(let d=0;d<o.length&&a;d++)a=a[o[d]];return a}}const d8=(e,t)=>t==="modelValue"||t==="model-value"?e.modelModifiers:e[`${t}Modifiers`]||e[`${ra(t)}Modifiers`]||e[`${Rc(t)}Modifiers`];function f8(e,t,...o){if(e.isUnmounted)return;const a=e.vnode.props||ao;let d=o;const p=t.startsWith("update:"),y=p&&d8(a,t.slice(7));y&&(y.trim&&(d=o.map(M=>Nn(M)?M.trim():M)),y.number&&(d=o.map(kS)));let r,S=a[r=sy(t)]||a[r=sy(ra(t))];!S&&p&&(S=a[r=sy(Rc(t))]),S&&Jl(S,e,6,d);const C=a[r+"Once"];if(C){if(!e.emitted)e.emitted={};else if(e.emitted[r])return;e.emitted[r]=!0,Jl(C,e,6,d)}}function ZL(e,t,o=!1){const a=t.emitsCache,d=a.get(e);if(d!==void 0)return d;const p=e.emits;let y={},r=!1;if(!$n(e)){const S=C=>{const M=ZL(C,t,!0);M&&(r=!0,ns(y,M))};!o&&t.mixins.length&&t.mixins.forEach(S),e.extends&&S(e.extends),e.mixins&&e.mixins.forEach(S)}return!p&&!r?(xr(e)&&a.set(e,null),null):(sn(p)?p.forEach(S=>y[S]=null):ns(y,p),xr(e)&&a.set(e,y),y)}function tx(e,t){return!e||!G1(t)?!1:(t=t.slice(2).replace(/Once$/,""),ri(e,t[0].toLowerCase()+t.slice(1))||ri(e,Rc(t))||ri(e,t))}function fP(e){const{type:t,vnode:o,proxy:a,withProxy:d,propsOptions:[p],slots:y,attrs:r,emit:S,render:C,renderCache:M,props:P,data:z,setupState:F,ctx:V,inheritAttrs:N}=e,H=h1(e);let U,te;try{if(o.shapeFlag&4){const q=d||a,J=q;U=ku(C.call(J,q,M,P,F,z,V)),te=r}else{const q=t;U=ku(q.length>1?q(P,{attrs:r,slots:y,emit:S}):q(P,null)),te=t.props?r:h8(r)}}catch(q){dy.length=0,X1(q,e,1),U=qe(Qo)}let Z=U;if(te&&N!==!1){const q=Object.keys(te),{shapeFlag:J}=Z;q.length&&J&7&&(p&&q.some(cC)&&(te=p8(te,p)),Z=Ic(Z,te,!1,!0))}return o.dirs&&(Z=Ic(Z,null,!1,!0),Z.dirs=Z.dirs?Z.dirs.concat(o.dirs):o.dirs),o.transition&&xh(Z,o.transition),U=Z,h1(H),U}const h8=e=>{let t;for(const o in e)(o==="class"||o==="style"||G1(o))&&((t||(t={}))[o]=e[o]);return t},p8=(e,t)=>{const o={};for(const a in e)(!cC(a)||!(a.slice(9)in t))&&(o[a]=e[a]);return o};function m8(e,t,o){const{props:a,children:d,component:p}=e,{props:y,children:r,patchFlag:S}=t,C=p.emitsOptions;if(t.dirs||t.transition)return!0;if(o&&S>=0){if(S&1024)return!0;if(S&16)return a?hP(a,y,C):!!y;if(S&8){const M=t.dynamicProps;for(let P=0;P<M.length;P++){const z=M[P];if(y[z]!==a[z]&&!tx(C,z))return!0}}}else return(d||r)&&(!r||!r.$stable)?!0:a===y?!1:a?y?hP(a,y,C):!0:!!y;return!1}function hP(e,t,o){const a=Object.keys(t);if(a.length!==Object.keys(e).length)return!0;for(let d=0;d<a.length;d++){const p=a[d];if(t[p]!==e[p]&&!tx(o,p))return!0}return!1}function g8({vnode:e,parent:t},o){for(;t;){const a=t.subTree;if(a.suspense&&a.suspense.activeBranch===e&&(a.el=e.el),a===e)(e=t.vnode).el=o,t=t.parent;else break}}const YL=e=>e.__isSuspense;function _8(e,t){t&&t.pendingBranch?sn(e)?t.effects.push(...e):t.effects.push(e):P6(e)}const Vn=Symbol.for("v-fgt"),eg=Symbol.for("v-txt"),Qo=Symbol.for("v-cmt"),G2=Symbol.for("v-stc"),dy=[];let Ua=null;function ae(e=!1){dy.push(Ua=e?null:[])}function y8(){dy.pop(),Ua=dy[dy.length-1]||null}let My=1;function pP(e,t=!1){My+=e,e<0&&Ua&&t&&(Ua.hasOnce=!0)}function XL(e){return e.dynamicChildren=My>0?Ua||xm:null,y8(),My>0&&Ua&&Ua.push(e),e}function Pe(e,t,o,a,d,p){return XL(Ue(e,t,o,a,d,p,!0))}function At(e,t,o,a,d){return XL(qe(e,t,o,a,d,!0))}function Ji(e){return e?e.__v_isVNode===!0:!1}function oh(e,t){return e.type===t.type&&e.key===t.key}const JL=({key:e})=>e??null,Hb=({ref:e,ref_key:t,ref_for:o})=>(typeof e=="number"&&(e=""+e),e!=null?Nn(e)||Ti(e)||$n(e)?{i:es,r:e,k:t,f:!!o}:e:null);function Ue(e,t=null,o=null,a=0,d=null,p=e===Vn?0:1,y=!1,r=!1){const S={__v_isVNode:!0,__v_skip:!0,type:e,props:t,key:t&&JL(t),ref:t&&Hb(t),scopeId:yL,slotScopeIds:null,children:o,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:p,patchFlag:a,dynamicProps:d,dynamicChildren:null,appContext:null,ctx:es};return r?(kC(S,o),p&128&&e.normalize(S)):o&&(S.shapeFlag|=Nn(o)?8:16),My>0&&!y&&Ua&&(S.patchFlag>0||p&6)&&S.patchFlag!==32&&Ua.push(S),S}const qe=v8;function v8(e,t=null,o=null,a=0,d=null,p=!1){if((!e||e===RL)&&(e=Qo),Ji(e)){const r=Ic(e,t,!0);return o&&kC(r,o),My>0&&!p&&Ua&&(r.shapeFlag&6?Ua[Ua.indexOf(e)]=r:Ua.push(r)),r.patchFlag=-2,r}if(M8(e)&&(e=e.__vccOpts),t){t=Wd(t);let{class:r,style:S}=t;r&&!Nn(r)&&(t.class=fe(r)),xr(S)&&(xC(S)&&!sn(S)&&(S=ns({},S)),t.style=Un(S))}const y=Nn(e)?1:YL(e)?128:bL(e)?64:xr(e)?4:$n(e)?2:0;return Ue(e,t,o,a,d,y,p,!0)}function Wd(e){return e?xC(e)||VL(e)?ns({},e):e:null}function Ic(e,t,o=!1,a=!1){const{props:d,ref:p,patchFlag:y,children:r,transition:S}=e,C=t?kr(d||{},t):d,M={__v_isVNode:!0,__v_skip:!0,type:e.type,props:C,key:C&&JL(C),ref:t&&t.ref?o&&p?sn(p)?p.concat(Hb(t)):[p,Hb(t)]:Hb(t):p,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:r,target:e.target,targetStart:e.targetStart,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:t&&e.type!==Vn?y===-1?16:y|16:y,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:S,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&Ic(e.ssContent),ssFallback:e.ssFallback&&Ic(e.ssFallback),el:e.el,anchor:e.anchor,ctx:e.ctx,ce:e.ce};return S&&a&&xh(M,S.clone(M)),M}function Nr(e=" ",t=0){return qe(eg,null,e,t)}function bt(e="",t=!1){return t?(ae(),At(Qo,null,e)):qe(Qo,null,e)}function ku(e){return e==null||typeof e=="boolean"?qe(Qo):sn(e)?qe(Vn,null,e.slice()):Ji(e)?zd(e):qe(eg,null,String(e))}function zd(e){return e.el===null&&e.patchFlag!==-1||e.memo?e:Ic(e)}function kC(e,t){let o=0;const{shapeFlag:a}=e;if(t==null)t=null;else if(sn(t))o=16;else if(typeof t=="object")if(a&65){const d=t.default;d&&(d._c&&(d._d=!1),kC(e,d()),d._c&&(d._d=!0));return}else{o=32;const d=t._;!d&&!VL(t)?t._ctx=es:d===3&&es&&(es.slots._===1?t._=1:(t._=2,e.patchFlag|=1024))}else $n(t)?(t={default:t,_ctx:es},o=32):(t=String(t),a&64?(o=16,t=[Nr(t)]):o=8);e.children=t,e.shapeFlag|=o}function kr(...e){const t={};for(let o=0;o<e.length;o++){const a=e[o];for(const d in a)if(d==="class")t.class!==a.class&&(t.class=fe([t.class,a.class]));else if(d==="style")t.style=Un([t.style,a.style]);else if(G1(d)){const p=t[d],y=a[d];y&&p!==y&&!(sn(p)&&p.includes(y))&&(t[d]=p?[].concat(p,y):y)}else d!==""&&(t[d]=a[d])}return t}function Mu(e,t,o,a=null){Jl(e,t,7,[o,a])}const b8=FL();let x8=0;function w8(e,t,o){const a=e.type,d=(t?t.appContext:e.appContext)||b8,p={uid:x8++,vnode:e,type:a,parent:t,appContext:d,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new ZO(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(d.provides),ids:t?t.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:UL(a,d),emitsOptions:ZL(a,d),emit:null,emitted:null,propsDefaults:ao,inheritAttrs:a.inheritAttrs,ctx:ao,data:ao,props:ao,attrs:ao,slots:ao,refs:ao,setupState:ao,setupContext:null,suspense:o,suspenseId:o?o.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return p.ctx={_:p},p.root=t?t.root:p,p.emit=f8.bind(null,p),e.ce&&e.ce(p),p}let as=null;const Cr=()=>as||es;let g1,VS;{const e=K1(),t=(o,a)=>{let d;return(d=e[o])||(d=e[o]=[]),d.push(a),p=>{d.length>1?d.forEach(y=>y(p)):d[0](p)}};g1=t("__VUE_INSTANCE_SETTERS__",o=>as=o),VS=t("__VUE_SSR_SETTERS__",o=>Iy=o)}const tv=e=>{const t=as;return g1(e),e.scope.on(),()=>{e.scope.off(),g1(t)}},mP=()=>{as&&as.scope.off(),g1(null)};function QL(e){return e.vnode.shapeFlag&4}let Iy=!1;function S8(e,t=!1,o=!1){t&&VS(t);const{props:a,children:d}=e.vnode,p=QL(e);J6(e,a,p,t),n8(e,d,o);const y=p?T8(e,t):void 0;return t&&VS(!1),y}function T8(e,t){const o=e.type;e.accessCache=Object.create(null),e.proxy=new Proxy(e.ctx,j6);const{setup:a}=o;if(a){tf();const d=e.setupContext=a.length>1?tD(e):null,p=tv(e),y=Qy(a,e,0,[e.props,d]),r=xy(y);if(nf(),p(),(r||e.sp)&&!Tm(e)&&IL(e),r){if(y.then(mP,mP),t)return y.then(S=>{gP(e,S)}).catch(S=>{X1(S,e,0)});e.asyncDep=y}else gP(e,y)}else eD(e)}function gP(e,t,o){$n(t)?e.type.__ssrInlineRender?e.ssrRender=t:e.render=t:xr(t)&&(e.setupState=fL(t)),eD(e)}function eD(e,t,o){const a=e.type;e.render||(e.render=a.render||vi);{const d=tv(e);tf();try{H6(e)}finally{nf(),d()}}}const C8={get(e,t){return Ds(e,"get",""),e[t]}};function tD(e){const t=o=>{e.exposed=o||{}};return{attrs:new Proxy(e.attrs,C8),slots:e.slots,emit:e.emit,expose:t}}function nx(e){return e.exposed?e.exposeProxy||(e.exposeProxy=new Proxy(fL(Ou(e.exposed)),{get(t,o){if(o in t)return t[o];if(o in cy)return cy[o](e)},has(t,o){return o in t||o in cy}})):e.proxy}function E8(e,t=!0){return $n(e)?e.displayName||e.name:e.name||t&&e.__name}function M8(e){return $n(e)&&"__vccOpts"in e}const ee=(e,t)=>E6(e,t,Iy);function Zn(e,t,o){const a=arguments.length;return a===2?xr(t)&&!sn(t)?Ji(t)?qe(e,null,[t]):qe(e,t):qe(e,null,t):(a>3?o=Array.prototype.slice.call(arguments,2):a===3&&Ji(o)&&(o=[o]),qe(e,t,o))}const I8="3.5.13",A8=vi;/**
* @vue/runtime-dom v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let $S;const _P=typeof window<"u"&&window.trustedTypes;if(_P)try{$S=_P.createPolicy("vue",{createHTML:e=>e})}catch{}const nD=$S?e=>$S.createHTML(e):e=>e,k8="http://www.w3.org/2000/svg",P8="http://www.w3.org/1998/Math/MathML",vc=typeof document<"u"?document:null,yP=vc&&vc.createElement("template"),R8={insert:(e,t,o)=>{t.insertBefore(e,o||null)},remove:e=>{const t=e.parentNode;t&&t.removeChild(e)},createElement:(e,t,o,a)=>{const d=t==="svg"?vc.createElementNS(k8,e):t==="mathml"?vc.createElementNS(P8,e):o?vc.createElement(e,{is:o}):vc.createElement(e);return e==="select"&&a&&a.multiple!=null&&d.setAttribute("multiple",a.multiple),d},createText:e=>vc.createTextNode(e),createComment:e=>vc.createComment(e),setText:(e,t)=>{e.nodeValue=t},setElementText:(e,t)=>{e.textContent=t},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>vc.querySelector(e),setScopeId(e,t){e.setAttribute(t,"")},insertStaticContent(e,t,o,a,d,p){const y=o?o.previousSibling:t.lastChild;if(d&&(d===p||d.nextSibling))for(;t.insertBefore(d.cloneNode(!0),o),!(d===p||!(d=d.nextSibling)););else{yP.innerHTML=nD(a==="svg"?`<svg>${e}</svg>`:a==="mathml"?`<math>${e}</math>`:e);const r=yP.content;if(a==="svg"||a==="mathml"){const S=r.firstChild;for(;S.firstChild;)r.appendChild(S.firstChild);r.removeChild(S)}t.insertBefore(r,o)}return[y?y.nextSibling:t.firstChild,o?o.previousSibling:t.lastChild]}},Id="transition",q_="animation",Rm=Symbol("_vtc"),rD={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},iD=ns({},TL,rD),O8=e=>(e.displayName="Transition",e.props=iD,e),rs=O8((e,{slots:t})=>Zn(D6,oD(e),t)),th=(e,t=[])=>{sn(e)?e.forEach(o=>o(...t)):e&&e(...t)},vP=e=>e?sn(e)?e.some(t=>t.length>1):e.length>1:!1;function oD(e){const t={};for(const de in e)de in rD||(t[de]=e[de]);if(e.css===!1)return t;const{name:o="v",type:a,duration:d,enterFromClass:p=`${o}-enter-from`,enterActiveClass:y=`${o}-enter-active`,enterToClass:r=`${o}-enter-to`,appearFromClass:S=p,appearActiveClass:C=y,appearToClass:M=r,leaveFromClass:P=`${o}-leave-from`,leaveActiveClass:z=`${o}-leave-active`,leaveToClass:F=`${o}-leave-to`}=e,V=L8(d),N=V&&V[0],H=V&&V[1],{onBeforeEnter:U,onEnter:te,onEnterCancelled:Z,onLeave:q,onLeaveCancelled:J,onBeforeAppear:re=U,onAppear:se=te,onAppearCancelled:he=Z}=t,le=(de,Ie,Ve,be)=>{de._enterCancelled=be,kd(de,Ie?M:r),kd(de,Ie?C:y),Ve&&Ve()},ce=(de,Ie)=>{de._isLeaving=!1,kd(de,P),kd(de,F),kd(de,z),Ie&&Ie()},pe=de=>(Ie,Ve)=>{const be=de?se:te,ye=()=>le(Ie,de,Ve);th(be,[Ie,ye]),bP(()=>{kd(Ie,de?S:p),Iu(Ie,de?M:r),vP(be)||xP(Ie,a,N,ye)})};return ns(t,{onBeforeEnter(de){th(U,[de]),Iu(de,p),Iu(de,y)},onBeforeAppear(de){th(re,[de]),Iu(de,S),Iu(de,C)},onEnter:pe(!1),onAppear:pe(!0),onLeave(de,Ie){de._isLeaving=!0;const Ve=()=>ce(de,Ie);Iu(de,P),de._enterCancelled?(Iu(de,z),US()):(US(),Iu(de,z)),bP(()=>{de._isLeaving&&(kd(de,P),Iu(de,F),vP(q)||xP(de,a,H,Ve))}),th(q,[de,Ve])},onEnterCancelled(de){le(de,!1,void 0,!0),th(Z,[de])},onAppearCancelled(de){le(de,!0,void 0,!0),th(he,[de])},onLeaveCancelled(de){ce(de),th(J,[de])}})}function L8(e){if(e==null)return null;if(xr(e))return[W2(e.enter),W2(e.leave)];{const t=W2(e);return[t,t]}}function W2(e){return W$(e)}function Iu(e,t){t.split(/\s+/).forEach(o=>o&&e.classList.add(o)),(e[Rm]||(e[Rm]=new Set)).add(t)}function kd(e,t){t.split(/\s+/).forEach(a=>a&&e.classList.remove(a));const o=e[Rm];o&&(o.delete(t),o.size||(e[Rm]=void 0))}function bP(e){requestAnimationFrame(()=>{requestAnimationFrame(e)})}let D8=0;function xP(e,t,o,a){const d=e._endId=++D8,p=()=>{d===e._endId&&a()};if(o!=null)return setTimeout(p,o);const{type:y,timeout:r,propCount:S}=sD(e,t);if(!y)return a();const C=y+"end";let M=0;const P=()=>{e.removeEventListener(C,z),p()},z=F=>{F.target===e&&++M>=S&&P()};setTimeout(()=>{M<S&&P()},r+1),e.addEventListener(C,z)}function sD(e,t){const o=window.getComputedStyle(e),a=V=>(o[V]||"").split(", "),d=a(`${Id}Delay`),p=a(`${Id}Duration`),y=wP(d,p),r=a(`${q_}Delay`),S=a(`${q_}Duration`),C=wP(r,S);let M=null,P=0,z=0;t===Id?y>0&&(M=Id,P=y,z=p.length):t===q_?C>0&&(M=q_,P=C,z=S.length):(P=Math.max(y,C),M=P>0?y>C?Id:q_:null,z=M?M===Id?p.length:S.length:0);const F=M===Id&&/\b(transform|all)(,|$)/.test(a(`${Id}Property`).toString());return{type:M,timeout:P,propCount:z,hasTransform:F}}function wP(e,t){for(;e.length<t.length;)e=e.concat(e);return Math.max(...t.map((o,a)=>SP(o)+SP(e[a])))}function SP(e){return e==="auto"?0:Number(e.slice(0,-1).replace(",","."))*1e3}function US(){return document.body.offsetHeight}function z8(e,t,o){const a=e[Rm];a&&(t=(t?[t,...a]:[...a]).join(" ")),t==null?e.removeAttribute("class"):o?e.setAttribute("class",t):e.className=t}const _1=Symbol("_vod"),aD=Symbol("_vsh"),ii={beforeMount(e,{value:t},{transition:o}){e[_1]=e.style.display==="none"?"":e.style.display,o&&t?o.beforeEnter(e):K_(e,t)},mounted(e,{value:t},{transition:o}){o&&t&&o.enter(e)},updated(e,{value:t,oldValue:o},{transition:a}){!t!=!o&&(a?t?(a.beforeEnter(e),K_(e,!0),a.enter(e)):a.leave(e,()=>{K_(e,!1)}):K_(e,t))},beforeUnmount(e,{value:t}){K_(e,t)}};function K_(e,t){e.style.display=t?e[_1]:"none",e[aD]=!t}const F8=Symbol(""),N8=/(^|;)\s*display\s*:/;function B8(e,t,o){const a=e.style,d=Nn(o);let p=!1;if(o&&!d){if(t)if(Nn(t))for(const y of t.split(";")){const r=y.slice(0,y.indexOf(":")).trim();o[r]==null&&Gb(a,r,"")}else for(const y in t)o[y]==null&&Gb(a,y,"");for(const y in o)y==="display"&&(p=!0),Gb(a,y,o[y])}else if(d){if(t!==o){const y=a[F8];y&&(o+=";"+y),a.cssText=o,p=N8.test(o)}}else t&&e.removeAttribute("style");_1 in e&&(e[_1]=p?a.display:"",e[aD]&&(a.display="none"))}const TP=/\s*!important$/;function Gb(e,t,o){if(sn(o))o.forEach(a=>Gb(e,t,a));else if(o==null&&(o=""),t.startsWith("--"))e.setProperty(t,o);else{const a=V8(e,t);TP.test(o)?e.setProperty(Rc(a),o.replace(TP,""),"important"):e[a]=o}}const CP=["Webkit","Moz","ms"],q2={};function V8(e,t){const o=q2[t];if(o)return o;let a=ra(t);if(a!=="filter"&&a in e)return q2[t]=a;a=Jy(a);for(let d=0;d<CP.length;d++){const p=CP[d]+a;if(p in e)return q2[t]=p}return t}const EP="http://www.w3.org/1999/xlink";function MP(e,t,o,a,d,p=J$(t)){a&&t.startsWith("xlink:")?o==null?e.removeAttributeNS(EP,t.slice(6,t.length)):e.setAttributeNS(EP,t,o):o==null||p&&!GO(o)?e.removeAttribute(t):e.setAttribute(t,p?"":Xl(o)?String(o):o)}function IP(e,t,o,a,d){if(t==="innerHTML"||t==="textContent"){o!=null&&(e[t]=t==="innerHTML"?nD(o):o);return}const p=e.tagName;if(t==="value"&&p!=="PROGRESS"&&!p.includes("-")){const r=p==="OPTION"?e.getAttribute("value")||"":e.value,S=o==null?e.type==="checkbox"?"on":"":String(o);(r!==S||!("_value"in e))&&(e.value=S),o==null&&e.removeAttribute(t),e._value=o;return}let y=!1;if(o===""||o==null){const r=typeof e[t];r==="boolean"?o=GO(o):o==null&&r==="string"?(o="",y=!0):r==="number"&&(o=0,y=!0)}try{e[t]=o}catch{}y&&e.removeAttribute(d||t)}function Fd(e,t,o,a){e.addEventListener(t,o,a)}function $8(e,t,o,a){e.removeEventListener(t,o,a)}const AP=Symbol("_vei");function U8(e,t,o,a,d=null){const p=e[AP]||(e[AP]={}),y=p[t];if(a&&y)y.value=a;else{const[r,S]=j8(t);if(a){const C=p[t]=W8(a,d);Fd(e,r,C,S)}else y&&($8(e,r,y,S),p[t]=void 0)}}const kP=/(?:Once|Passive|Capture)$/;function j8(e){let t;if(kP.test(e)){t={};let a;for(;a=e.match(kP);)e=e.slice(0,e.length-a[0].length),t[a[0].toLowerCase()]=!0}return[e[2]===":"?e.slice(3):Rc(e.slice(2)),t]}let K2=0;const H8=Promise.resolve(),G8=()=>K2||(H8.then(()=>K2=0),K2=Date.now());function W8(e,t){const o=a=>{if(!a._vts)a._vts=Date.now();else if(a._vts<=o.attached)return;Jl(q8(a,o.value),t,5,[a])};return o.value=e,o.attached=G8(),o}function q8(e,t){if(sn(t)){const o=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{o.call(e),e._stopped=!0},t.map(a=>d=>!d._stopped&&a&&a(d))}else return t}const PP=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&e.charCodeAt(2)>96&&e.charCodeAt(2)<123,K8=(e,t,o,a,d,p)=>{const y=d==="svg";t==="class"?z8(e,a,y):t==="style"?B8(e,o,a):G1(t)?cC(t)||U8(e,t,o,a,p):(t[0]==="."?(t=t.slice(1),!0):t[0]==="^"?(t=t.slice(1),!1):Z8(e,t,a,y))?(IP(e,t,a),!e.tagName.includes("-")&&(t==="value"||t==="checked"||t==="selected")&&MP(e,t,a,y,p,t!=="value")):e._isVueCE&&(/[A-Z]/.test(t)||!Nn(a))?IP(e,ra(t),a,p,t):(t==="true-value"?e._trueValue=a:t==="false-value"&&(e._falseValue=a),MP(e,t,a,y))};function Z8(e,t,o,a){if(a)return!!(t==="innerHTML"||t==="textContent"||t in e&&PP(t)&&$n(o));if(t==="spellcheck"||t==="draggable"||t==="translate"||t==="form"||t==="list"&&e.tagName==="INPUT"||t==="type"&&e.tagName==="TEXTAREA")return!1;if(t==="width"||t==="height"){const d=e.tagName;if(d==="IMG"||d==="VIDEO"||d==="CANVAS"||d==="SOURCE")return!1}return PP(t)&&Nn(o)?!1:t in e}const lD=new WeakMap,uD=new WeakMap,y1=Symbol("_moveCb"),RP=Symbol("_enterCb"),Y8=e=>(delete e.props.mode,e),X8=Y8({name:"TransitionGroup",props:ns({},iD,{tag:String,moveClass:String}),setup(e,{slots:t}){const o=Cr(),a=SL();let d,p;return Uu(()=>{if(!d.length)return;const y=e.moveClass||`${e.name||"v"}-move`;if(!tU(d[0].el,o.vnode.el,y))return;d.forEach(J8),d.forEach(Q8);const r=d.filter(eU);US(),r.forEach(S=>{const C=S.el,M=C.style;Iu(C,y),M.transform=M.webkitTransform=M.transitionDuration="";const P=C[y1]=z=>{z&&z.target!==C||(!z||/transform$/.test(z.propertyName))&&(C.removeEventListener("transitionend",P),C[y1]=null,kd(C,y))};C.addEventListener("transitionend",P)})}),()=>{const y=wi(e),r=oD(y);let S=y.tag||Vn;if(d=[],p)for(let C=0;C<p.length;C++){const M=p[C];M.el&&M.el instanceof Element&&(d.push(M),xh(M,Ey(M,r,a,o)),lD.set(M,M.el.getBoundingClientRect()))}p=t.default?SC(t.default()):[];for(let C=0;C<p.length;C++){const M=p[C];M.key!=null&&xh(M,Ey(M,r,a,o))}return qe(S,null,p)}}}),cD=X8;function J8(e){const t=e.el;t[y1]&&t[y1](),t[RP]&&t[RP]()}function Q8(e){uD.set(e,e.el.getBoundingClientRect())}function eU(e){const t=lD.get(e),o=uD.get(e),a=t.left-o.left,d=t.top-o.top;if(a||d){const p=e.el.style;return p.transform=p.webkitTransform=`translate(${a}px,${d}px)`,p.transitionDuration="0s",e}}function tU(e,t,o){const a=e.cloneNode(),d=e[Rm];d&&d.forEach(r=>{r.split(/\s+/).forEach(S=>S&&a.classList.remove(S))}),o.split(/\s+/).forEach(r=>r&&a.classList.add(r)),a.style.display="none";const p=t.nodeType===1?t:t.parentNode;p.appendChild(a);const{hasTransform:y}=sD(a);return p.removeChild(a),y}const Om=e=>{const t=e.props["onUpdate:modelValue"]||!1;return sn(t)?o=>Ub(t,o):t};function nU(e){e.target.composing=!0}function OP(e){const t=e.target;t.composing&&(t.composing=!1,t.dispatchEvent(new Event("input")))}const Mc=Symbol("_assign"),rx={created(e,{modifiers:{lazy:t,trim:o,number:a}},d){e[Mc]=Om(d);const p=a||d.props&&d.props.type==="number";Fd(e,t?"change":"input",y=>{if(y.target.composing)return;let r=e.value;o&&(r=r.trim()),p&&(r=kS(r)),e[Mc](r)}),o&&Fd(e,"change",()=>{e.value=e.value.trim()}),t||(Fd(e,"compositionstart",nU),Fd(e,"compositionend",OP),Fd(e,"change",OP))},mounted(e,{value:t}){e.value=t??""},beforeUpdate(e,{value:t,oldValue:o,modifiers:{lazy:a,trim:d,number:p}},y){if(e[Mc]=Om(y),e.composing)return;const r=(p||e.type==="number")&&!/^0\d/.test(e.value)?kS(e.value):e.value,S=t??"";r!==S&&(document.activeElement===e&&e.type!=="range"&&(a&&t===o||d&&e.value.trim()===S)||(e.value=S))}},v1={deep:!0,created(e,t,o){e[Mc]=Om(o),Fd(e,"change",()=>{const a=e._modelValue,d=fD(e),p=e.checked,y=e[Mc];if(sn(a)){const r=WO(a,d),S=r!==-1;if(p&&!S)y(a.concat(d));else if(!p&&S){const C=[...a];C.splice(r,1),y(C)}}else if(W1(a)){const r=new Set(a);p?r.add(d):r.delete(d),y(r)}else y(hD(e,p))})},mounted:LP,beforeUpdate(e,t,o){e[Mc]=Om(o),LP(e,t,o)}};function LP(e,{value:t,oldValue:o},a){e._modelValue=t;let d;if(sn(t))d=WO(t,a.props.value)>-1;else if(W1(t))d=t.has(a.props.value);else{if(t===o)return;d=Pm(t,hD(e,!0))}e.checked!==d&&(e.checked=d)}const dD={created(e,{value:t},o){e.checked=Pm(t,o.props.value),e[Mc]=Om(o),Fd(e,"change",()=>{e[Mc](fD(e))})},beforeUpdate(e,{value:t,oldValue:o},a){e[Mc]=Om(a),t!==o&&(e.checked=Pm(t,a.props.value))}};function fD(e){return"_value"in e?e._value:e.value}function hD(e,t){const o=t?"_trueValue":"_falseValue";return o in e?e[o]:t}const rU=["ctrl","shift","alt","meta"],iU={stop:e=>e.stopPropagation(),prevent:e=>e.preventDefault(),self:e=>e.target!==e.currentTarget,ctrl:e=>!e.ctrlKey,shift:e=>!e.shiftKey,alt:e=>!e.altKey,meta:e=>!e.metaKey,left:e=>"button"in e&&e.button!==0,middle:e=>"button"in e&&e.button!==1,right:e=>"button"in e&&e.button!==2,exact:(e,t)=>rU.some(o=>e[`${o}Key`]&&!t.includes(o))},Jn=(e,t)=>{const o=e._withMods||(e._withMods={}),a=t.join(".");return o[a]||(o[a]=(d,...p)=>{for(let y=0;y<t.length;y++){const r=iU[t[y]];if(r&&r(d,t))return}return e(d,...p)})},oU={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},Ri=(e,t)=>{const o=e._withKeys||(e._withKeys={}),a=t.join(".");return o[a]||(o[a]=d=>{if(!("key"in d))return;const p=Rc(d.key);if(t.some(y=>y===p||oU[y]===p))return e(d)})},sU=ns({patchProp:K8},R8);let DP;function pD(){return DP||(DP=i8(sU))}const qd=(...e)=>{pD().render(...e)},mD=(...e)=>{const t=pD().createApp(...e),{mount:o}=t;return t.mount=a=>{const d=lU(a);if(!d)return;const p=t._component;!$n(p)&&!p.render&&!p.template&&(p.template=d.innerHTML),d.nodeType===1&&(d.textContent="");const y=o(d,!1,aU(d));return d instanceof Element&&(d.removeAttribute("v-cloak"),d.setAttribute("data-v-app","")),y},t};function aU(e){if(e instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&e instanceof MathMLElement)return"mathml"}function lU(e){return Nn(e)?document.querySelector(e):e}/*!
 * pinia v2.3.0
 * (c) 2024 Eduardo San Martin Morote
 * @license MIT
 */let gD;const ix=e=>gD=e,_D=Symbol();function jS(e){return e&&typeof e=="object"&&Object.prototype.toString.call(e)==="[object Object]"&&typeof e.toJSON!="function"}var fy;(function(e){e.direct="direct",e.patchObject="patch object",e.patchFunction="patch function"})(fy||(fy={}));function uU(){const e=hC(!0),t=e.run(()=>xe({}));let o=[],a=[];const d=Ou({install(p){ix(d),d._a=p,p.provide(_D,d),p.config.globalProperties.$pinia=d,a.forEach(y=>o.push(y)),a=[]},use(p){return this._a?o.push(p):a.push(p),this},_p:o,_a:null,_e:e,_s:new Map,state:t});return d}const yD=()=>{};function zP(e,t,o,a=yD){e.push(t);const d=()=>{const p=e.indexOf(t);p>-1&&(e.splice(p,1),a())};return!o&&pC()&&mC(d),d}function om(e,...t){e.slice().forEach(o=>{o(...t)})}const cU=e=>e(),FP=Symbol(),Z2=Symbol();function HS(e,t){e instanceof Map&&t instanceof Map?t.forEach((o,a)=>e.set(a,o)):e instanceof Set&&t instanceof Set&&t.forEach(e.add,e);for(const o in t){if(!t.hasOwnProperty(o))continue;const a=t[o],d=e[o];jS(d)&&jS(a)&&e.hasOwnProperty(o)&&!Ti(a)&&!Ec(a)?e[o]=HS(d,a):e[o]=a}return e}const dU=Symbol();function fU(e){return!jS(e)||!e.hasOwnProperty(dU)}const{assign:Pd}=Object;function hU(e){return!!(Ti(e)&&e.effect)}function pU(e,t,o,a){const{state:d,actions:p,getters:y}=t,r=o.state.value[e];let S;function C(){r||(o.state.value[e]=d?d():{});const M=Go(o.state.value[e]);return Pd(M,p,Object.keys(y||{}).reduce((P,z)=>(P[z]=Ou(ee(()=>{ix(o);const F=o._s.get(e);return y[z].call(F,F)})),P),{}))}return S=vD(e,C,t,o,a,!0),S}function vD(e,t,o={},a,d,p){let y;const r=Pd({actions:{}},o),S={deep:!0};let C,M,P=[],z=[],F;const V=a.state.value[e];!p&&!V&&(a.state.value[e]={}),xe({});let N;function H(he){let le;C=M=!1,typeof he=="function"?(he(a.state.value[e]),le={type:fy.patchFunction,storeId:e,events:F}):(HS(a.state.value[e],he),le={type:fy.patchObject,payload:he,storeId:e,events:F});const ce=N=Symbol();jn().then(()=>{N===ce&&(C=!0)}),M=!0,om(P,le,a.state.value[e])}const U=p?function(){const{state:le}=o,ce=le?le():{};this.$patch(pe=>{Pd(pe,ce)})}:yD;function te(){y.stop(),P=[],z=[],a._s.delete(e)}const Z=(he,le="")=>{if(FP in he)return he[Z2]=le,he;const ce=function(){ix(a);const pe=Array.from(arguments),de=[],Ie=[];function Ve(Me){de.push(Me)}function be(Me){Ie.push(Me)}om(z,{args:pe,name:ce[Z2],store:J,after:Ve,onError:be});let ye;try{ye=he.apply(this&&this.$id===e?this:J,pe)}catch(Me){throw om(Ie,Me),Me}return ye instanceof Promise?ye.then(Me=>(om(de,Me),Me)).catch(Me=>(om(Ie,Me),Promise.reject(Me))):(om(de,ye),ye)};return ce[FP]=!0,ce[Z2]=le,ce},q={_p:a,$id:e,$onAction:zP.bind(null,z),$patch:H,$reset:U,$subscribe(he,le={}){const ce=zP(P,he,le.detached,()=>pe()),pe=y.run(()=>Wt(()=>a.state.value[e],de=>{(le.flush==="sync"?M:C)&&he({storeId:e,type:fy.direct,events:F},de)},Pd({},S,le)));return ce},$dispose:te},J=si(q);a._s.set(e,J);const se=(a._a&&a._a.runWithContext||cU)(()=>a._e.run(()=>(y=hC()).run(()=>t({action:Z}))));for(const he in se){const le=se[he];if(Ti(le)&&!hU(le)||Ec(le))p||(V&&fU(le)&&(Ti(le)?le.value=V[he]:HS(le,V[he])),a.state.value[e][he]=le);else if(typeof le=="function"){const ce=Z(le,he);se[he]=ce,r.actions[he]=le}}return Pd(J,se),Pd(wi(J),se),Object.defineProperty(J,"$state",{get:()=>a.state.value[e],set:he=>{H(le=>{Pd(le,he)})}}),a._p.forEach(he=>{Pd(J,y.run(()=>he({store:J,app:a._a,pinia:a,options:r})))}),V&&p&&o.hydrate&&o.hydrate(J.$state,V),C=!0,M=!0,J}/*! #__NO_SIDE_EFFECTS__ */function mU(e,t,o){let a,d;const p=typeof t=="function";a=e,d=p?o:t;function y(r,S){const C=X6();return r=r||(C?Pn(_D,null):null),r&&ix(r),r=gD,r._s.has(a)||(p?vD(a,t,d,r):pU(a,d,r)),r._s.get(a)}return y.$id=a,y}function bD(e){{const t=wi(e),o={};for(const a in t){const d=t[a];d.effect?o[a]=ee({get:()=>e[a],set(p){e[a]=p}}):(Ti(d)||Ec(d))&&(o[a]=hi(e,a))}return o}}const gU="2.9.2",NP=Symbol("INSTALLED_KEY"),xD=Symbol(),hy="el",_U="is-",nh=(e,t,o,a,d)=>{let p=`${e}-${t}`;return o&&(p+=`-${o}`),a&&(p+=`__${a}`),d&&(p+=`--${d}`),p},wD=Symbol("namespaceContextKey"),PC=e=>{const t=e||(Cr()?Pn(wD,xe(hy)):xe(hy));return ee(()=>b(t)||hy)},Xt=(e,t)=>{const o=PC(t);return{namespace:o,b:(N="")=>nh(o.value,e,N,"",""),e:N=>N?nh(o.value,e,"",N,""):"",m:N=>N?nh(o.value,e,"","",N):"",be:(N,H)=>N&&H?nh(o.value,e,N,H,""):"",em:(N,H)=>N&&H?nh(o.value,e,"",N,H):"",bm:(N,H)=>N&&H?nh(o.value,e,N,"",H):"",bem:(N,H,U)=>N&&H&&U?nh(o.value,e,N,H,U):"",is:(N,...H)=>{const U=H.length>=1?H[0]:!0;return N&&U?`${_U}${N}`:""},cssVar:N=>{const H={};for(const U in N)N[U]&&(H[`--${o.value}-${U}`]=N[U]);return H},cssVarName:N=>`--${o.value}-${N}`,cssVarBlock:N=>{const H={};for(const U in N)N[U]&&(H[`--${o.value}-${e}-${U}`]=N[U]);return H},cssVarBlockName:N=>`--${o.value}-${e}-${N}`}};var SD=typeof global=="object"&&global&&global.Object===Object&&global,yU=typeof self=="object"&&self&&self.Object===Object&&self,ou=SD||yU||Function("return this")(),dl=ou.Symbol,TD=Object.prototype,vU=TD.hasOwnProperty,bU=TD.toString,Z_=dl?dl.toStringTag:void 0;function xU(e){var t=vU.call(e,Z_),o=e[Z_];try{e[Z_]=void 0;var a=!0}catch{}var d=bU.call(e);return a&&(t?e[Z_]=o:delete e[Z_]),d}var wU=Object.prototype,SU=wU.toString;function TU(e){return SU.call(e)}var CU="[object Null]",EU="[object Undefined]",BP=dl?dl.toStringTag:void 0;function Ah(e){return e==null?e===void 0?EU:CU:BP&&BP in Object(e)?xU(e):TU(e)}function zu(e){return e!=null&&typeof e=="object"}var MU="[object Symbol]";function ox(e){return typeof e=="symbol"||zu(e)&&Ah(e)==MU}function RC(e,t){for(var o=-1,a=e==null?0:e.length,d=Array(a);++o<a;)d[o]=t(e[o],o,e);return d}var ia=Array.isArray,VP=dl?dl.prototype:void 0,$P=VP?VP.toString:void 0;function CD(e){if(typeof e=="string")return e;if(ia(e))return RC(e,CD)+"";if(ox(e))return $P?$P.call(e):"";var t=e+"";return t=="0"&&1/e==-1/0?"-0":t}var IU=/\s/;function AU(e){for(var t=e.length;t--&&IU.test(e.charAt(t)););return t}var kU=/^\s+/;function PU(e){return e&&e.slice(0,AU(e)+1).replace(kU,"")}function oa(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var UP=NaN,RU=/^[-+]0x[0-9a-f]+$/i,OU=/^0b[01]+$/i,LU=/^0o[0-7]+$/i,DU=parseInt;function jP(e){if(typeof e=="number")return e;if(ox(e))return UP;if(oa(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=oa(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=PU(e);var o=OU.test(e);return o||LU.test(e)?DU(e.slice(2),o?2:8):RU.test(e)?UP:+e}function OC(e){return e}var zU="[object AsyncFunction]",FU="[object Function]",NU="[object GeneratorFunction]",BU="[object Proxy]";function LC(e){if(!oa(e))return!1;var t=Ah(e);return t==FU||t==NU||t==zU||t==BU}var Y2=ou["__core-js_shared__"],HP=function(){var e=/[^.]+$/.exec(Y2&&Y2.keys&&Y2.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function VU(e){return!!HP&&HP in e}var $U=Function.prototype,UU=$U.toString;function kh(e){if(e!=null){try{return UU.call(e)}catch{}try{return e+""}catch{}}return""}var jU=/[\\^$.*+?()[\]{}|]/g,HU=/^\[object .+?Constructor\]$/,GU=Function.prototype,WU=Object.prototype,qU=GU.toString,KU=WU.hasOwnProperty,ZU=RegExp("^"+qU.call(KU).replace(jU,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function YU(e){if(!oa(e)||VU(e))return!1;var t=LC(e)?ZU:HU;return t.test(kh(e))}function XU(e,t){return e==null?void 0:e[t]}function Ph(e,t){var o=XU(e,t);return YU(o)?o:void 0}var GS=Ph(ou,"WeakMap"),GP=Object.create,JU=function(){function e(){}return function(t){if(!oa(t))return{};if(GP)return GP(t);e.prototype=t;var o=new e;return e.prototype=void 0,o}}();function QU(e,t,o){switch(o.length){case 0:return e.call(t);case 1:return e.call(t,o[0]);case 2:return e.call(t,o[0],o[1]);case 3:return e.call(t,o[0],o[1],o[2])}return e.apply(t,o)}function ej(){}function ED(e,t){var o=-1,a=e.length;for(t||(t=Array(a));++o<a;)t[o]=e[o];return t}var tj=800,nj=16,rj=Date.now;function ij(e){var t=0,o=0;return function(){var a=rj(),d=nj-(a-o);if(o=a,d>0){if(++t>=tj)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}function oj(e){return function(){return e}}var b1=function(){try{var e=Ph(Object,"defineProperty");return e({},"",{}),e}catch{}}(),sj=b1?function(e,t){return b1(e,"toString",{configurable:!0,enumerable:!1,value:oj(t),writable:!0})}:OC,MD=ij(sj);function aj(e,t){for(var o=-1,a=e==null?0:e.length;++o<a&&t(e[o],o,e)!==!1;);return e}function ID(e,t,o,a){for(var d=e.length,p=o+(a?1:-1);a?p--:++p<d;)if(t(e[p],p,e))return p;return-1}function lj(e){return e!==e}function uj(e,t,o){for(var a=o-1,d=e.length;++a<d;)if(e[a]===t)return a;return-1}function cj(e,t,o){return t===t?uj(e,t,o):ID(e,lj,o)}function dj(e,t){var o=e==null?0:e.length;return!!o&&cj(e,t,0)>-1}var fj=9007199254740991,hj=/^(?:0|[1-9]\d*)$/;function sx(e,t){var o=typeof e;return t=t??fj,!!t&&(o=="number"||o!="symbol"&&hj.test(e))&&e>-1&&e%1==0&&e<t}function DC(e,t,o){t=="__proto__"&&b1?b1(e,t,{configurable:!0,enumerable:!0,value:o,writable:!0}):e[t]=o}function nv(e,t){return e===t||e!==e&&t!==t}var pj=Object.prototype,mj=pj.hasOwnProperty;function zC(e,t,o){var a=e[t];(!(mj.call(e,t)&&nv(a,o))||o===void 0&&!(t in e))&&DC(e,t,o)}function tg(e,t,o,a){var d=!o;o||(o={});for(var p=-1,y=t.length;++p<y;){var r=t[p],S=void 0;S===void 0&&(S=e[r]),d?DC(o,r,S):zC(o,r,S)}return o}var WP=Math.max;function AD(e,t,o){return t=WP(t===void 0?e.length-1:t,0),function(){for(var a=arguments,d=-1,p=WP(a.length-t,0),y=Array(p);++d<p;)y[d]=a[t+d];d=-1;for(var r=Array(t+1);++d<t;)r[d]=a[d];return r[t]=o(y),QU(e,this,r)}}function kD(e,t){return MD(AD(e,t,OC),e+"")}var gj=9007199254740991;function FC(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=gj}function ng(e){return e!=null&&FC(e.length)&&!LC(e)}function _j(e,t,o){if(!oa(o))return!1;var a=typeof t;return(a=="number"?ng(o)&&sx(t,o.length):a=="string"&&t in o)?nv(o[t],e):!1}function yj(e){return kD(function(t,o){var a=-1,d=o.length,p=d>1?o[d-1]:void 0,y=d>2?o[2]:void 0;for(p=e.length>3&&typeof p=="function"?(d--,p):void 0,y&&_j(o[0],o[1],y)&&(p=d<3?void 0:p,d=1),t=Object(t);++a<d;){var r=o[a];r&&e(t,r,a,p)}return t})}var vj=Object.prototype;function NC(e){var t=e&&e.constructor,o=typeof t=="function"&&t.prototype||vj;return e===o}function bj(e,t){for(var o=-1,a=Array(e);++o<e;)a[o]=t(o);return a}var xj="[object Arguments]";function qP(e){return zu(e)&&Ah(e)==xj}var PD=Object.prototype,wj=PD.hasOwnProperty,Sj=PD.propertyIsEnumerable,Ay=qP(function(){return arguments}())?qP:function(e){return zu(e)&&wj.call(e,"callee")&&!Sj.call(e,"callee")};function Tj(){return!1}var RD=typeof Ha=="object"&&Ha&&!Ha.nodeType&&Ha,KP=RD&&typeof Ga=="object"&&Ga&&!Ga.nodeType&&Ga,Cj=KP&&KP.exports===RD,ZP=Cj?ou.Buffer:void 0,Ej=ZP?ZP.isBuffer:void 0,ky=Ej||Tj,Mj="[object Arguments]",Ij="[object Array]",Aj="[object Boolean]",kj="[object Date]",Pj="[object Error]",Rj="[object Function]",Oj="[object Map]",Lj="[object Number]",Dj="[object Object]",zj="[object RegExp]",Fj="[object Set]",Nj="[object String]",Bj="[object WeakMap]",Vj="[object ArrayBuffer]",$j="[object DataView]",Uj="[object Float32Array]",jj="[object Float64Array]",Hj="[object Int8Array]",Gj="[object Int16Array]",Wj="[object Int32Array]",qj="[object Uint8Array]",Kj="[object Uint8ClampedArray]",Zj="[object Uint16Array]",Yj="[object Uint32Array]",Co={};Co[Uj]=Co[jj]=Co[Hj]=Co[Gj]=Co[Wj]=Co[qj]=Co[Kj]=Co[Zj]=Co[Yj]=!0;Co[Mj]=Co[Ij]=Co[Vj]=Co[Aj]=Co[$j]=Co[kj]=Co[Pj]=Co[Rj]=Co[Oj]=Co[Lj]=Co[Dj]=Co[zj]=Co[Fj]=Co[Nj]=Co[Bj]=!1;function Xj(e){return zu(e)&&FC(e.length)&&!!Co[Ah(e)]}function BC(e){return function(t){return e(t)}}var OD=typeof Ha=="object"&&Ha&&!Ha.nodeType&&Ha,py=OD&&typeof Ga=="object"&&Ga&&!Ga.nodeType&&Ga,Jj=py&&py.exports===OD,X2=Jj&&SD.process,Lm=function(){try{var e=py&&py.require&&py.require("util").types;return e||X2&&X2.binding&&X2.binding("util")}catch{}}(),YP=Lm&&Lm.isTypedArray,VC=YP?BC(YP):Xj,Qj=Object.prototype,eH=Qj.hasOwnProperty;function LD(e,t){var o=ia(e),a=!o&&Ay(e),d=!o&&!a&&ky(e),p=!o&&!a&&!d&&VC(e),y=o||a||d||p,r=y?bj(e.length,String):[],S=r.length;for(var C in e)(t||eH.call(e,C))&&!(y&&(C=="length"||d&&(C=="offset"||C=="parent")||p&&(C=="buffer"||C=="byteLength"||C=="byteOffset")||sx(C,S)))&&r.push(C);return r}function DD(e,t){return function(o){return e(t(o))}}var tH=DD(Object.keys,Object),nH=Object.prototype,rH=nH.hasOwnProperty;function iH(e){if(!NC(e))return tH(e);var t=[];for(var o in Object(e))rH.call(e,o)&&o!="constructor"&&t.push(o);return t}function rv(e){return ng(e)?LD(e):iH(e)}function oH(e){var t=[];if(e!=null)for(var o in Object(e))t.push(o);return t}var sH=Object.prototype,aH=sH.hasOwnProperty;function lH(e){if(!oa(e))return oH(e);var t=NC(e),o=[];for(var a in e)a=="constructor"&&(t||!aH.call(e,a))||o.push(a);return o}function iv(e){return ng(e)?LD(e,!0):lH(e)}var uH=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,cH=/^\w*$/;function $C(e,t){if(ia(e))return!1;var o=typeof e;return o=="number"||o=="symbol"||o=="boolean"||e==null||ox(e)?!0:cH.test(e)||!uH.test(e)||t!=null&&e in Object(t)}var Py=Ph(Object,"create");function dH(){this.__data__=Py?Py(null):{},this.size=0}function fH(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var hH="__lodash_hash_undefined__",pH=Object.prototype,mH=pH.hasOwnProperty;function gH(e){var t=this.__data__;if(Py){var o=t[e];return o===hH?void 0:o}return mH.call(t,e)?t[e]:void 0}var _H=Object.prototype,yH=_H.hasOwnProperty;function vH(e){var t=this.__data__;return Py?t[e]!==void 0:yH.call(t,e)}var bH="__lodash_hash_undefined__";function xH(e,t){var o=this.__data__;return this.size+=this.has(e)?0:1,o[e]=Py&&t===void 0?bH:t,this}function wh(e){var t=-1,o=e==null?0:e.length;for(this.clear();++t<o;){var a=e[t];this.set(a[0],a[1])}}wh.prototype.clear=dH;wh.prototype.delete=fH;wh.prototype.get=gH;wh.prototype.has=vH;wh.prototype.set=xH;function wH(){this.__data__=[],this.size=0}function ax(e,t){for(var o=e.length;o--;)if(nv(e[o][0],t))return o;return-1}var SH=Array.prototype,TH=SH.splice;function CH(e){var t=this.__data__,o=ax(t,e);if(o<0)return!1;var a=t.length-1;return o==a?t.pop():TH.call(t,o,1),--this.size,!0}function EH(e){var t=this.__data__,o=ax(t,e);return o<0?void 0:t[o][1]}function MH(e){return ax(this.__data__,e)>-1}function IH(e,t){var o=this.__data__,a=ax(o,e);return a<0?(++this.size,o.push([e,t])):o[a][1]=t,this}function Lc(e){var t=-1,o=e==null?0:e.length;for(this.clear();++t<o;){var a=e[t];this.set(a[0],a[1])}}Lc.prototype.clear=wH;Lc.prototype.delete=CH;Lc.prototype.get=EH;Lc.prototype.has=MH;Lc.prototype.set=IH;var Ry=Ph(ou,"Map");function AH(){this.size=0,this.__data__={hash:new wh,map:new(Ry||Lc),string:new wh}}function kH(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}function lx(e,t){var o=e.__data__;return kH(t)?o[typeof t=="string"?"string":"hash"]:o.map}function PH(e){var t=lx(this,e).delete(e);return this.size-=t?1:0,t}function RH(e){return lx(this,e).get(e)}function OH(e){return lx(this,e).has(e)}function LH(e,t){var o=lx(this,e),a=o.size;return o.set(e,t),this.size+=o.size==a?0:1,this}function Dc(e){var t=-1,o=e==null?0:e.length;for(this.clear();++t<o;){var a=e[t];this.set(a[0],a[1])}}Dc.prototype.clear=AH;Dc.prototype.delete=PH;Dc.prototype.get=RH;Dc.prototype.has=OH;Dc.prototype.set=LH;var DH="Expected a function";function ux(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new TypeError(DH);var o=function(){var a=arguments,d=t?t.apply(this,a):a[0],p=o.cache;if(p.has(d))return p.get(d);var y=e.apply(this,a);return o.cache=p.set(d,y)||p,y};return o.cache=new(ux.Cache||Dc),o}ux.Cache=Dc;var zH=500;function FH(e){var t=ux(e,function(a){return o.size===zH&&o.clear(),a}),o=t.cache;return t}var NH=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,BH=/\\(\\)?/g,VH=FH(function(e){var t=[];return e.charCodeAt(0)===46&&t.push(""),e.replace(NH,function(o,a,d,p){t.push(d?p.replace(BH,"$1"):a||o)}),t});function $H(e){return e==null?"":CD(e)}function rg(e,t){return ia(e)?e:$C(e,t)?[e]:VH($H(e))}function ig(e){if(typeof e=="string"||ox(e))return e;var t=e+"";return t=="0"&&1/e==-1/0?"-0":t}function cx(e,t){t=rg(t,e);for(var o=0,a=t.length;e!=null&&o<a;)e=e[ig(t[o++])];return o&&o==a?e:void 0}function Eo(e,t,o){var a=e==null?void 0:cx(e,t);return a===void 0?o:a}function UC(e,t){for(var o=-1,a=t.length,d=e.length;++o<a;)e[d+o]=t[o];return e}var XP=dl?dl.isConcatSpreadable:void 0;function UH(e){return ia(e)||Ay(e)||!!(XP&&e&&e[XP])}function ov(e,t,o,a,d){var p=-1,y=e.length;for(o||(o=UH),d||(d=[]);++p<y;){var r=e[p];t>0&&o(r)?t>1?ov(r,t-1,o,a,d):UC(d,r):a||(d[d.length]=r)}return d}function zD(e){var t=e==null?0:e.length;return t?ov(e,1):[]}function FD(e){return MD(AD(e,void 0,zD),e+"")}var jC=DD(Object.getPrototypeOf,Object),jH="[object Object]",HH=Function.prototype,GH=Object.prototype,ND=HH.toString,WH=GH.hasOwnProperty,qH=ND.call(Object);function BD(e){if(!zu(e)||Ah(e)!=jH)return!1;var t=jC(e);if(t===null)return!0;var o=WH.call(t,"constructor")&&t.constructor;return typeof o=="function"&&o instanceof o&&ND.call(o)==qH}function KH(e,t,o){var a=-1,d=e.length;t<0&&(t=-t>d?0:d+t),o=o>d?d:o,o<0&&(o+=d),d=t>o?0:o-t>>>0,t>>>=0;for(var p=Array(d);++a<d;)p[a]=e[a+t];return p}function Fs(){if(!arguments.length)return[];var e=arguments[0];return ia(e)?e:[e]}function ZH(){this.__data__=new Lc,this.size=0}function YH(e){var t=this.__data__,o=t.delete(e);return this.size=t.size,o}function XH(e){return this.__data__.get(e)}function JH(e){return this.__data__.has(e)}var QH=200;function eG(e,t){var o=this.__data__;if(o instanceof Lc){var a=o.__data__;if(!Ry||a.length<QH-1)return a.push([e,t]),this.size=++o.size,this;o=this.__data__=new Dc(a)}return o.set(e,t),this.size=o.size,this}function Zl(e){var t=this.__data__=new Lc(e);this.size=t.size}Zl.prototype.clear=ZH;Zl.prototype.delete=YH;Zl.prototype.get=XH;Zl.prototype.has=JH;Zl.prototype.set=eG;function tG(e,t){return e&&tg(t,rv(t),e)}function nG(e,t){return e&&tg(t,iv(t),e)}var VD=typeof Ha=="object"&&Ha&&!Ha.nodeType&&Ha,JP=VD&&typeof Ga=="object"&&Ga&&!Ga.nodeType&&Ga,rG=JP&&JP.exports===VD,QP=rG?ou.Buffer:void 0,e3=QP?QP.allocUnsafe:void 0;function $D(e,t){if(t)return e.slice();var o=e.length,a=e3?e3(o):new e.constructor(o);return e.copy(a),a}function iG(e,t){for(var o=-1,a=e==null?0:e.length,d=0,p=[];++o<a;){var y=e[o];t(y,o,e)&&(p[d++]=y)}return p}function UD(){return[]}var oG=Object.prototype,sG=oG.propertyIsEnumerable,t3=Object.getOwnPropertySymbols,HC=t3?function(e){return e==null?[]:(e=Object(e),iG(t3(e),function(t){return sG.call(e,t)}))}:UD;function aG(e,t){return tg(e,HC(e),t)}var lG=Object.getOwnPropertySymbols,jD=lG?function(e){for(var t=[];e;)UC(t,HC(e)),e=jC(e);return t}:UD;function uG(e,t){return tg(e,jD(e),t)}function HD(e,t,o){var a=t(e);return ia(e)?a:UC(a,o(e))}function WS(e){return HD(e,rv,HC)}function GD(e){return HD(e,iv,jD)}var qS=Ph(ou,"DataView"),KS=Ph(ou,"Promise"),Cm=Ph(ou,"Set"),n3="[object Map]",cG="[object Object]",r3="[object Promise]",i3="[object Set]",o3="[object WeakMap]",s3="[object DataView]",dG=kh(qS),fG=kh(Ry),hG=kh(KS),pG=kh(Cm),mG=kh(GS),Hl=Ah;(qS&&Hl(new qS(new ArrayBuffer(1)))!=s3||Ry&&Hl(new Ry)!=n3||KS&&Hl(KS.resolve())!=r3||Cm&&Hl(new Cm)!=i3||GS&&Hl(new GS)!=o3)&&(Hl=function(e){var t=Ah(e),o=t==cG?e.constructor:void 0,a=o?kh(o):"";if(a)switch(a){case dG:return s3;case fG:return n3;case hG:return r3;case pG:return i3;case mG:return o3}return t});var gG=Object.prototype,_G=gG.hasOwnProperty;function yG(e){var t=e.length,o=new e.constructor(t);return t&&typeof e[0]=="string"&&_G.call(e,"index")&&(o.index=e.index,o.input=e.input),o}var x1=ou.Uint8Array;function GC(e){var t=new e.constructor(e.byteLength);return new x1(t).set(new x1(e)),t}function vG(e,t){var o=t?GC(e.buffer):e.buffer;return new e.constructor(o,e.byteOffset,e.byteLength)}var bG=/\w*$/;function xG(e){var t=new e.constructor(e.source,bG.exec(e));return t.lastIndex=e.lastIndex,t}var a3=dl?dl.prototype:void 0,l3=a3?a3.valueOf:void 0;function wG(e){return l3?Object(l3.call(e)):{}}function WD(e,t){var o=t?GC(e.buffer):e.buffer;return new e.constructor(o,e.byteOffset,e.length)}var SG="[object Boolean]",TG="[object Date]",CG="[object Map]",EG="[object Number]",MG="[object RegExp]",IG="[object Set]",AG="[object String]",kG="[object Symbol]",PG="[object ArrayBuffer]",RG="[object DataView]",OG="[object Float32Array]",LG="[object Float64Array]",DG="[object Int8Array]",zG="[object Int16Array]",FG="[object Int32Array]",NG="[object Uint8Array]",BG="[object Uint8ClampedArray]",VG="[object Uint16Array]",$G="[object Uint32Array]";function UG(e,t,o){var a=e.constructor;switch(t){case PG:return GC(e);case SG:case TG:return new a(+e);case RG:return vG(e,o);case OG:case LG:case DG:case zG:case FG:case NG:case BG:case VG:case $G:return WD(e,o);case CG:return new a;case EG:case AG:return new a(e);case MG:return xG(e);case IG:return new a;case kG:return wG(e)}}function qD(e){return typeof e.constructor=="function"&&!NC(e)?JU(jC(e)):{}}var jG="[object Map]";function HG(e){return zu(e)&&Hl(e)==jG}var u3=Lm&&Lm.isMap,GG=u3?BC(u3):HG,WG="[object Set]";function qG(e){return zu(e)&&Hl(e)==WG}var c3=Lm&&Lm.isSet,KG=c3?BC(c3):qG,ZG=1,YG=2,XG=4,KD="[object Arguments]",JG="[object Array]",QG="[object Boolean]",eW="[object Date]",tW="[object Error]",ZD="[object Function]",nW="[object GeneratorFunction]",rW="[object Map]",iW="[object Number]",YD="[object Object]",oW="[object RegExp]",sW="[object Set]",aW="[object String]",lW="[object Symbol]",uW="[object WeakMap]",cW="[object ArrayBuffer]",dW="[object DataView]",fW="[object Float32Array]",hW="[object Float64Array]",pW="[object Int8Array]",mW="[object Int16Array]",gW="[object Int32Array]",_W="[object Uint8Array]",yW="[object Uint8ClampedArray]",vW="[object Uint16Array]",bW="[object Uint32Array]",po={};po[KD]=po[JG]=po[cW]=po[dW]=po[QG]=po[eW]=po[fW]=po[hW]=po[pW]=po[mW]=po[gW]=po[rW]=po[iW]=po[YD]=po[oW]=po[sW]=po[aW]=po[lW]=po[_W]=po[yW]=po[vW]=po[bW]=!0;po[tW]=po[ZD]=po[uW]=!1;function Em(e,t,o,a,d,p){var y,r=t&ZG,S=t&YG,C=t&XG;if(o&&(y=d?o(e,a,d,p):o(e)),y!==void 0)return y;if(!oa(e))return e;var M=ia(e);if(M){if(y=yG(e),!r)return ED(e,y)}else{var P=Hl(e),z=P==ZD||P==nW;if(ky(e))return $D(e,r);if(P==YD||P==KD||z&&!d){if(y=S||z?{}:qD(e),!r)return S?uG(e,nG(y,e)):aG(e,tG(y,e))}else{if(!po[P])return d?e:{};y=UG(e,P,r)}}p||(p=new Zl);var F=p.get(e);if(F)return F;p.set(e,y),KG(e)?e.forEach(function(H){y.add(Em(H,t,o,H,e,p))}):GG(e)&&e.forEach(function(H,U){y.set(U,Em(H,t,o,U,e,p))});var V=C?S?GD:WS:S?iv:rv,N=M?void 0:V(e);return aj(N||e,function(H,U){N&&(U=H,H=e[U]),zC(y,U,Em(H,t,o,U,e,p))}),y}var xW=4;function d3(e){return Em(e,xW)}var wW=1,SW=4;function w1(e){return Em(e,wW|SW)}var TW="__lodash_hash_undefined__";function CW(e){return this.__data__.set(e,TW),this}function EW(e){return this.__data__.has(e)}function Oy(e){var t=-1,o=e==null?0:e.length;for(this.__data__=new Dc;++t<o;)this.add(e[t])}Oy.prototype.add=Oy.prototype.push=CW;Oy.prototype.has=EW;function MW(e,t){for(var o=-1,a=e==null?0:e.length;++o<a;)if(t(e[o],o,e))return!0;return!1}function XD(e,t){return e.has(t)}var IW=1,AW=2;function JD(e,t,o,a,d,p){var y=o&IW,r=e.length,S=t.length;if(r!=S&&!(y&&S>r))return!1;var C=p.get(e),M=p.get(t);if(C&&M)return C==t&&M==e;var P=-1,z=!0,F=o&AW?new Oy:void 0;for(p.set(e,t),p.set(t,e);++P<r;){var V=e[P],N=t[P];if(a)var H=y?a(N,V,P,t,e,p):a(V,N,P,e,t,p);if(H!==void 0){if(H)continue;z=!1;break}if(F){if(!MW(t,function(U,te){if(!XD(F,te)&&(V===U||d(V,U,o,a,p)))return F.push(te)})){z=!1;break}}else if(!(V===N||d(V,N,o,a,p))){z=!1;break}}return p.delete(e),p.delete(t),z}function kW(e){var t=-1,o=Array(e.size);return e.forEach(function(a,d){o[++t]=[d,a]}),o}function WC(e){var t=-1,o=Array(e.size);return e.forEach(function(a){o[++t]=a}),o}var PW=1,RW=2,OW="[object Boolean]",LW="[object Date]",DW="[object Error]",zW="[object Map]",FW="[object Number]",NW="[object RegExp]",BW="[object Set]",VW="[object String]",$W="[object Symbol]",UW="[object ArrayBuffer]",jW="[object DataView]",f3=dl?dl.prototype:void 0,J2=f3?f3.valueOf:void 0;function HW(e,t,o,a,d,p,y){switch(o){case jW:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case UW:return!(e.byteLength!=t.byteLength||!p(new x1(e),new x1(t)));case OW:case LW:case FW:return nv(+e,+t);case DW:return e.name==t.name&&e.message==t.message;case NW:case VW:return e==t+"";case zW:var r=kW;case BW:var S=a&PW;if(r||(r=WC),e.size!=t.size&&!S)return!1;var C=y.get(e);if(C)return C==t;a|=RW,y.set(e,t);var M=JD(r(e),r(t),a,d,p,y);return y.delete(e),M;case $W:if(J2)return J2.call(e)==J2.call(t)}return!1}var GW=1,WW=Object.prototype,qW=WW.hasOwnProperty;function KW(e,t,o,a,d,p){var y=o&GW,r=WS(e),S=r.length,C=WS(t),M=C.length;if(S!=M&&!y)return!1;for(var P=S;P--;){var z=r[P];if(!(y?z in t:qW.call(t,z)))return!1}var F=p.get(e),V=p.get(t);if(F&&V)return F==t&&V==e;var N=!0;p.set(e,t),p.set(t,e);for(var H=y;++P<S;){z=r[P];var U=e[z],te=t[z];if(a)var Z=y?a(te,U,z,t,e,p):a(U,te,z,e,t,p);if(!(Z===void 0?U===te||d(U,te,o,a,p):Z)){N=!1;break}H||(H=z=="constructor")}if(N&&!H){var q=e.constructor,J=t.constructor;q!=J&&"constructor"in e&&"constructor"in t&&!(typeof q=="function"&&q instanceof q&&typeof J=="function"&&J instanceof J)&&(N=!1)}return p.delete(e),p.delete(t),N}var ZW=1,h3="[object Arguments]",p3="[object Array]",bb="[object Object]",YW=Object.prototype,m3=YW.hasOwnProperty;function XW(e,t,o,a,d,p){var y=ia(e),r=ia(t),S=y?p3:Hl(e),C=r?p3:Hl(t);S=S==h3?bb:S,C=C==h3?bb:C;var M=S==bb,P=C==bb,z=S==C;if(z&&ky(e)){if(!ky(t))return!1;y=!0,M=!1}if(z&&!M)return p||(p=new Zl),y||VC(e)?JD(e,t,o,a,d,p):HW(e,t,S,o,a,d,p);if(!(o&ZW)){var F=M&&m3.call(e,"__wrapped__"),V=P&&m3.call(t,"__wrapped__");if(F||V){var N=F?e.value():e,H=V?t.value():t;return p||(p=new Zl),d(N,H,o,a,p)}}return z?(p||(p=new Zl),KW(e,t,o,a,d,p)):!1}function dx(e,t,o,a,d){return e===t?!0:e==null||t==null||!zu(e)&&!zu(t)?e!==e&&t!==t:XW(e,t,o,a,dx,d)}var JW=1,QW=2;function eq(e,t,o,a){var d=o.length,p=d;if(e==null)return!p;for(e=Object(e);d--;){var y=o[d];if(y[2]?y[1]!==e[y[0]]:!(y[0]in e))return!1}for(;++d<p;){y=o[d];var r=y[0],S=e[r],C=y[1];if(y[2]){if(S===void 0&&!(r in e))return!1}else{var M=new Zl,P;if(!(P===void 0?dx(C,S,JW|QW,a,M):P))return!1}}return!0}function QD(e){return e===e&&!oa(e)}function tq(e){for(var t=rv(e),o=t.length;o--;){var a=t[o],d=e[a];t[o]=[a,d,QD(d)]}return t}function ez(e,t){return function(o){return o==null?!1:o[e]===t&&(t!==void 0||e in Object(o))}}function nq(e){var t=tq(e);return t.length==1&&t[0][2]?ez(t[0][0],t[0][1]):function(o){return o===e||eq(o,e,t)}}function rq(e,t){return e!=null&&t in Object(e)}function iq(e,t,o){t=rg(t,e);for(var a=-1,d=t.length,p=!1;++a<d;){var y=ig(t[a]);if(!(p=e!=null&&o(e,y)))break;e=e[y]}return p||++a!=d?p:(d=e==null?0:e.length,!!d&&FC(d)&&sx(y,d)&&(ia(e)||Ay(e)))}function tz(e,t){return e!=null&&iq(e,t,rq)}var oq=1,sq=2;function aq(e,t){return $C(e)&&QD(t)?ez(ig(e),t):function(o){var a=Eo(o,e);return a===void 0&&a===t?tz(o,e):dx(t,a,oq|sq)}}function lq(e){return function(t){return t==null?void 0:t[e]}}function uq(e){return function(t){return cx(t,e)}}function cq(e){return $C(e)?lq(ig(e)):uq(e)}function nz(e){return typeof e=="function"?e:e==null?OC:typeof e=="object"?ia(e)?aq(e[0],e[1]):nq(e):cq(e)}function dq(e){return function(t,o,a){for(var d=-1,p=Object(t),y=a(t),r=y.length;r--;){var S=y[++d];if(o(p[S],S,p)===!1)break}return t}}var rz=dq();function fq(e,t){return e&&rz(e,t,rv)}function hq(e,t){return function(o,a){if(o==null)return o;if(!ng(o))return e(o,a);for(var d=o.length,p=-1,y=Object(o);++p<d&&a(y[p],p,y)!==!1;);return o}}var pq=hq(fq),Q2=function(){return ou.Date.now()},mq="Expected a function",gq=Math.max,_q=Math.min;function Ca(e,t,o){var a,d,p,y,r,S,C=0,M=!1,P=!1,z=!0;if(typeof e!="function")throw new TypeError(mq);t=jP(t)||0,oa(o)&&(M=!!o.leading,P="maxWait"in o,p=P?gq(jP(o.maxWait)||0,t):p,z="trailing"in o?!!o.trailing:z);function F(re){var se=a,he=d;return a=d=void 0,C=re,y=e.apply(he,se),y}function V(re){return C=re,r=setTimeout(U,t),M?F(re):y}function N(re){var se=re-S,he=re-C,le=t-se;return P?_q(le,p-he):le}function H(re){var se=re-S,he=re-C;return S===void 0||se>=t||se<0||P&&he>=p}function U(){var re=Q2();if(H(re))return te(re);r=setTimeout(U,N(re))}function te(re){return r=void 0,z&&a?F(re):(a=d=void 0,y)}function Z(){r!==void 0&&clearTimeout(r),C=0,a=S=d=r=void 0}function q(){return r===void 0?y:te(Q2())}function J(){var re=Q2(),se=H(re);if(a=arguments,d=this,S=re,se){if(r===void 0)return V(S);if(P)return clearTimeout(r),r=setTimeout(U,t),F(S)}return r===void 0&&(r=setTimeout(U,t)),y}return J.cancel=Z,J.flush=q,J}function ZS(e,t,o){(o!==void 0&&!nv(e[t],o)||o===void 0&&!(t in e))&&DC(e,t,o)}function iz(e){return zu(e)&&ng(e)}function YS(e,t){if(!(t==="constructor"&&typeof e[t]=="function")&&t!="__proto__")return e[t]}function yq(e){return tg(e,iv(e))}function vq(e,t,o,a,d,p,y){var r=YS(e,o),S=YS(t,o),C=y.get(S);if(C){ZS(e,o,C);return}var M=p?p(r,S,o+"",e,t,y):void 0,P=M===void 0;if(P){var z=ia(S),F=!z&&ky(S),V=!z&&!F&&VC(S);M=S,z||F||V?ia(r)?M=r:iz(r)?M=ED(r):F?(P=!1,M=$D(S,!0)):V?(P=!1,M=WD(S,!0)):M=[]:BD(S)||Ay(S)?(M=r,Ay(r)?M=yq(r):(!oa(r)||LC(r))&&(M=qD(S))):P=!1}P&&(y.set(S,M),d(M,S,a,p,y),y.delete(S)),ZS(e,o,M)}function oz(e,t,o,a,d){e!==t&&rz(t,function(p,y){if(d||(d=new Zl),oa(p))vq(e,t,y,o,oz,a,d);else{var r=a?a(YS(e,y),p,y+"",e,t,d):void 0;r===void 0&&(r=p),ZS(e,y,r)}},iv)}function bq(e){var t=e==null?0:e.length;return t?e[t-1]:void 0}function sz(e,t,o){var a=e==null?0:e.length;if(!a)return-1;var d=a-1;return ID(e,nz(t),d,!0)}function xq(e,t){var o=-1,a=ng(e)?Array(e.length):[];return pq(e,function(d,p,y){a[++o]=t(d,p,y)}),a}function wq(e,t){var o=ia(e)?RC:xq;return o(e,nz(t))}function Sq(e,t){return ov(wq(e,t),1)}var Tq=1/0;function Cq(e){var t=e==null?0:e.length;return t?ov(e,Tq):[]}function Ly(e){for(var t=-1,o=e==null?0:e.length,a={};++t<o;){var d=e[t];a[d[0]]=d[1]}return a}function Eq(e,t){return t.length<2?e:cx(e,KH(t,0,-1))}function _s(e,t){return dx(e,t)}function Ho(e){return e==null}function sv(e){return e===null}function az(e){return e===void 0}var lz=yj(function(e,t,o){oz(e,t,o)});function Mq(e,t){return t=rg(t,e),e=Eq(e,t),e==null||delete e[ig(bq(t))]}function Iq(e){return BD(e)?void 0:e}var Aq=1,kq=2,Pq=4,Rq=FD(function(e,t){var o={};if(e==null)return o;var a=!1;t=RC(t,function(p){return p=rg(p,e),a||(a=p.length>1),p}),tg(e,GD(e),o),a&&(o=Em(o,Aq|kq|Pq,Iq));for(var d=t.length;d--;)Mq(o,t[d]);return o});function uz(e,t,o,a){if(!oa(e))return e;t=rg(t,e);for(var d=-1,p=t.length,y=p-1,r=e;r!=null&&++d<p;){var S=ig(t[d]),C=o;if(S==="__proto__"||S==="constructor"||S==="prototype")return e;if(d!=y){var M=r[S];C=void 0,C===void 0&&(C=oa(M)?M:sx(t[d+1])?[]:{})}zC(r,S,C),r=r[S]}return e}function Oq(e,t,o){for(var a=-1,d=t.length,p={};++a<d;){var y=t[a],r=cx(e,y);o(r,y)&&uz(p,rg(y,e),r)}return p}function Lq(e,t){return Oq(e,t,function(o,a){return tz(e,a)})}var Wl=FD(function(e,t){return e==null?{}:Lq(e,t)});function Dq(e,t,o){return e==null?e:uz(e,t,o)}var zq="Expected a function";function gh(e,t,o){var a=!0,d=!0;if(typeof e!="function")throw new TypeError(zq);return oa(o)&&(a="leading"in o?!!o.leading:a,d="trailing"in o?!!o.trailing:d),Ca(e,t,{leading:a,maxWait:t,trailing:d})}var Fq=1/0,Nq=Cm&&1/WC(new Cm([,-0]))[1]==Fq?function(e){return new Cm(e)}:ej,Bq=200;function Vq(e,t,o){var a=-1,d=dj,p=e.length,y=!0,r=[],S=r;if(p>=Bq){var C=Nq(e);if(C)return WC(C);y=!1,d=XD,S=new Oy}else S=r;e:for(;++a<p;){var M=e[a],P=M;if(M=M!==0?M:0,y&&P===P){for(var z=S.length;z--;)if(S[z]===P)continue e;r.push(M)}else d(S,P,o)||(S!==r&&S.push(P),r.push(M))}return r}var eS=kD(function(e){return Vq(ov(e,1,iz,!0))});const ai=e=>e===void 0,Oi=e=>typeof e=="boolean",Wn=e=>typeof e=="number",$a=e=>!e&&e!==0||sn(e)&&e.length===0||xr(e)&&!Object.keys(e).length,ea=e=>typeof Element>"u"?!1:e instanceof Element,Yl=e=>Ho(e),$q=e=>Nn(e)?!Number.isNaN(Number(e)):!1,fx=e=>e===window;var Uq=Object.defineProperty,jq=Object.defineProperties,Hq=Object.getOwnPropertyDescriptors,g3=Object.getOwnPropertySymbols,Gq=Object.prototype.hasOwnProperty,Wq=Object.prototype.propertyIsEnumerable,_3=(e,t,o)=>t in e?Uq(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,qq=(e,t)=>{for(var o in t||(t={}))Gq.call(t,o)&&_3(e,o,t[o]);if(g3)for(var o of g3(t))Wq.call(t,o)&&_3(e,o,t[o]);return e},Kq=(e,t)=>jq(e,Hq(t));function XS(e,t){var o;const a=Hi();return gs(()=>{a.value=e()},Kq(qq({},t),{flush:(o=void 0)!=null?o:"sync"})),Qm(a)}var y3;const Wr=typeof window<"u",Zq=e=>typeof e<"u",JS=e=>typeof e=="function",Yq=e=>typeof e=="string",Dm=()=>{},QS=Wr&&((y3=window==null?void 0:window.navigator)==null?void 0:y3.userAgent)&&/iP(ad|hone|od)/.test(window.navigator.userAgent);function Kd(e){return typeof e=="function"?e():b(e)}function cz(e,t){function o(...a){return new Promise((d,p)=>{Promise.resolve(e(()=>t.apply(this,a),{fn:t,thisArg:this,args:a})).then(d).catch(p)})}return o}function Xq(e,t={}){let o,a,d=Dm;const p=r=>{clearTimeout(r),d(),d=Dm};return r=>{const S=Kd(e),C=Kd(t.maxWait);return o&&p(o),S<=0||C!==void 0&&C<=0?(a&&(p(a),a=null),Promise.resolve(r())):new Promise((M,P)=>{d=t.rejectOnCancel?P:M,C&&!a&&(a=setTimeout(()=>{o&&p(o),a=null,M(r())},C)),o=setTimeout(()=>{a&&p(a),a=null,M(r())},S)})}}function Jq(e,t=!0,o=!0,a=!1){let d=0,p,y=!0,r=Dm,S;const C=()=>{p&&(clearTimeout(p),p=void 0,r(),r=Dm)};return P=>{const z=Kd(e),F=Date.now()-d,V=()=>S=P();return C(),z<=0?(d=Date.now(),V()):(F>z&&(o||!y)?(d=Date.now(),V()):t&&(S=new Promise((N,H)=>{r=a?H:N,p=setTimeout(()=>{d=Date.now(),y=!0,N(V()),C()},Math.max(0,z-F))})),!o&&!p&&(p=setTimeout(()=>y=!0,z)),y=!1,S)}}function Qq(e){return e}function e9(e,t){let o,a,d;const p=xe(!0),y=()=>{p.value=!0,d()};Wt(e,y,{flush:"sync"});const r=JS(t)?t:t.get,S=JS(t)?void 0:t.set,C=w6((M,P)=>(a=M,d=P,{get(){return p.value&&(o=r(),p.value=!1),a(),o},set(z){S==null||S(z)}}));return Object.isExtensible(C)&&(C.trigger=y),C}function av(e){return pC()?(mC(e),!0):!1}function t9(e,t=200,o={}){return cz(Xq(t,o),e)}function n9(e,t=200,o={}){const a=xe(e.value),d=t9(()=>{a.value=e.value},t,o);return Wt(e,()=>d()),a}function dz(e,t=200,o=!1,a=!0,d=!1){return cz(Jq(t,o,a,d),e)}function qC(e,t=!0){Cr()?yr(e):t?e():jn(e)}function Sh(e,t,o={}){const{immediate:a=!0}=o,d=xe(!1);let p=null;function y(){p&&(clearTimeout(p),p=null)}function r(){d.value=!1,y()}function S(...C){y(),d.value=!0,p=setTimeout(()=>{d.value=!1,p=null,e(...C)},Kd(t))}return a&&(d.value=!0,Wr&&S()),av(r),{isPending:Qm(d),start:S,stop:r}}function Qs(e){var t;const o=Kd(e);return(t=o==null?void 0:o.$el)!=null?t:o}const sf=Wr?window:void 0,r9=Wr?window.document:void 0;function Si(...e){let t,o,a,d;if(Yq(e[0])||Array.isArray(e[0])?([o,a,d]=e,t=sf):[t,o,a,d]=e,!t)return Dm;Array.isArray(o)||(o=[o]),Array.isArray(a)||(a=[a]);const p=[],y=()=>{p.forEach(M=>M()),p.length=0},r=(M,P,z,F)=>(M.addEventListener(P,z,F),()=>M.removeEventListener(P,z,F)),S=Wt(()=>[Qs(t),Kd(d)],([M,P])=>{y(),M&&p.push(...o.flatMap(z=>a.map(F=>r(M,z,F,P))))},{immediate:!0,flush:"post"}),C=()=>{S(),y()};return av(C),C}let v3=!1;function KC(e,t,o={}){const{window:a=sf,ignore:d=[],capture:p=!0,detectIframe:y=!1}=o;if(!a)return;QS&&!v3&&(v3=!0,Array.from(a.document.body.children).forEach(z=>z.addEventListener("click",Dm)));let r=!0;const S=z=>d.some(F=>{if(typeof F=="string")return Array.from(a.document.querySelectorAll(F)).some(V=>V===z.target||z.composedPath().includes(V));{const V=Qs(F);return V&&(z.target===V||z.composedPath().includes(V))}}),M=[Si(a,"click",z=>{const F=Qs(e);if(!(!F||F===z.target||z.composedPath().includes(F))){if(z.detail===0&&(r=!S(z)),!r){r=!0;return}t(z)}},{passive:!0,capture:p}),Si(a,"pointerdown",z=>{const F=Qs(e);F&&(r=!z.composedPath().includes(F)&&!S(z))},{passive:!0}),y&&Si(a,"blur",z=>{var F;const V=Qs(e);((F=a.document.activeElement)==null?void 0:F.tagName)==="IFRAME"&&!(V!=null&&V.contains(a.document.activeElement))&&t(z)})].filter(Boolean);return()=>M.forEach(z=>z())}function i9(e={}){var t;const{window:o=sf}=e,a=(t=e.document)!=null?t:o==null?void 0:o.document,d=e9(()=>null,()=>a==null?void 0:a.activeElement);return o&&(Si(o,"blur",p=>{p.relatedTarget===null&&d.trigger()},!0),Si(o,"focus",d.trigger,!0)),d}function fz(e,t=!1){const o=xe(),a=()=>o.value=!!e();return a(),qC(a,t),o}function o9(e){return JSON.parse(JSON.stringify(e))}const b3=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},x3="__vueuse_ssr_handlers__";b3[x3]=b3[x3]||{};function s9(e,t,{window:o=sf,initialValue:a=""}={}){const d=xe(a),p=ee(()=>{var y;return Qs(t)||((y=o==null?void 0:o.document)==null?void 0:y.documentElement)});return Wt([p,()=>Kd(e)],([y,r])=>{var S;if(y&&o){const C=(S=o.getComputedStyle(y).getPropertyValue(r))==null?void 0:S.trim();d.value=C||a}},{immediate:!0}),Wt(d,y=>{var r;(r=p.value)!=null&&r.style&&p.value.style.setProperty(Kd(e),y)}),d}function a9({document:e=r9}={}){if(!e)return xe("visible");const t=xe(e.visibilityState);return Si(e,"visibilitychange",()=>{t.value=e.visibilityState}),t}var w3=Object.getOwnPropertySymbols,l9=Object.prototype.hasOwnProperty,u9=Object.prototype.propertyIsEnumerable,c9=(e,t)=>{var o={};for(var a in e)l9.call(e,a)&&t.indexOf(a)<0&&(o[a]=e[a]);if(e!=null&&w3)for(var a of w3(e))t.indexOf(a)<0&&u9.call(e,a)&&(o[a]=e[a]);return o};function ro(e,t,o={}){const a=o,{window:d=sf}=a,p=c9(a,["window"]);let y;const r=fz(()=>d&&"ResizeObserver"in d),S=()=>{y&&(y.disconnect(),y=void 0)},C=Wt(()=>Qs(e),P=>{S(),r.value&&d&&P&&(y=new ResizeObserver(t),y.observe(P,p))},{immediate:!0,flush:"post"}),M=()=>{S(),C()};return av(M),{isSupported:r,stop:M}}function S3(e,t={}){const{reset:o=!0,windowResize:a=!0,windowScroll:d=!0,immediate:p=!0}=t,y=xe(0),r=xe(0),S=xe(0),C=xe(0),M=xe(0),P=xe(0),z=xe(0),F=xe(0);function V(){const N=Qs(e);if(!N){o&&(y.value=0,r.value=0,S.value=0,C.value=0,M.value=0,P.value=0,z.value=0,F.value=0);return}const H=N.getBoundingClientRect();y.value=H.height,r.value=H.bottom,S.value=H.left,C.value=H.right,M.value=H.top,P.value=H.width,z.value=H.x,F.value=H.y}return ro(e,V),Wt(()=>Qs(e),N=>!N&&V()),d&&Si("scroll",V,{capture:!0,passive:!0}),a&&Si("resize",V,{passive:!0}),qC(()=>{p&&V()}),{height:y,bottom:r,left:S,right:C,top:M,width:P,x:z,y:F,update:V}}var T3=Object.getOwnPropertySymbols,d9=Object.prototype.hasOwnProperty,f9=Object.prototype.propertyIsEnumerable,h9=(e,t)=>{var o={};for(var a in e)d9.call(e,a)&&t.indexOf(a)<0&&(o[a]=e[a]);if(e!=null&&T3)for(var a of T3(e))t.indexOf(a)<0&&f9.call(e,a)&&(o[a]=e[a]);return o};function hz(e,t,o={}){const a=o,{window:d=sf}=a,p=h9(a,["window"]);let y;const r=fz(()=>d&&"MutationObserver"in d),S=()=>{y&&(y.disconnect(),y=void 0)},C=Wt(()=>Qs(e),P=>{S(),r.value&&d&&P&&(y=new MutationObserver(t),y.observe(P,p))},{immediate:!0}),M=()=>{S(),C()};return av(M),{isSupported:r,stop:M}}var C3;(function(e){e.UP="UP",e.RIGHT="RIGHT",e.DOWN="DOWN",e.LEFT="LEFT",e.NONE="NONE"})(C3||(C3={}));var p9=Object.defineProperty,E3=Object.getOwnPropertySymbols,m9=Object.prototype.hasOwnProperty,g9=Object.prototype.propertyIsEnumerable,M3=(e,t,o)=>t in e?p9(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,_9=(e,t)=>{for(var o in t)m9.call(t,o)&&M3(e,o,t[o]);if(E3)for(var o of E3(t))g9.call(t,o)&&M3(e,o,t[o]);return e};const y9={easeInSine:[.12,0,.39,0],easeOutSine:[.61,1,.88,1],easeInOutSine:[.37,0,.63,1],easeInQuad:[.11,0,.5,0],easeOutQuad:[.5,1,.89,1],easeInOutQuad:[.45,0,.55,1],easeInCubic:[.32,0,.67,0],easeOutCubic:[.33,1,.68,1],easeInOutCubic:[.65,0,.35,1],easeInQuart:[.5,0,.75,0],easeOutQuart:[.25,1,.5,1],easeInOutQuart:[.76,0,.24,1],easeInQuint:[.64,0,.78,0],easeOutQuint:[.22,1,.36,1],easeInOutQuint:[.83,0,.17,1],easeInExpo:[.7,0,.84,0],easeOutExpo:[.16,1,.3,1],easeInOutExpo:[.87,0,.13,1],easeInCirc:[.55,0,1,.45],easeOutCirc:[0,.55,.45,1],easeInOutCirc:[.85,0,.15,1],easeInBack:[.36,0,.66,-.56],easeOutBack:[.34,1.56,.64,1],easeInOutBack:[.68,-.6,.32,1.6]};_9({linear:Qq},y9);function pz(e,t,o,a={}){var d,p,y;const{clone:r=!1,passive:S=!1,eventName:C,deep:M=!1,defaultValue:P}=a,z=Cr(),F=o||(z==null?void 0:z.emit)||((d=z==null?void 0:z.$emit)==null?void 0:d.bind(z))||((y=(p=z==null?void 0:z.proxy)==null?void 0:p.$emit)==null?void 0:y.bind(z==null?void 0:z.proxy));let V=C;t||(t="modelValue"),V=C||V||`update:${t.toString()}`;const N=U=>r?JS(r)?r(U):o9(U):U,H=()=>Zq(e[t])?N(e[t]):P;if(S){const U=H(),te=xe(U);return Wt(()=>e[t],Z=>te.value=N(Z)),Wt(te,Z=>{(Z!==e[t]||M)&&F(V,Z)},{deep:M}),te}else return ee({get(){return H()},set(U){F(V,U)}})}function v9({window:e=sf}={}){if(!e)return xe(!1);const t=xe(e.document.hasFocus());return Si(e,"blur",()=>{t.value=!1}),Si(e,"focus",()=>{t.value=!0}),t}function b9(e={}){const{window:t=sf,initialWidth:o=1/0,initialHeight:a=1/0,listenOrientation:d=!0,includeScrollbar:p=!0}=e,y=xe(o),r=xe(a),S=()=>{t&&(p?(y.value=t.innerWidth,r.value=t.innerHeight):(y.value=t.document.documentElement.clientWidth,r.value=t.document.documentElement.clientHeight))};return S(),qC(S),Si("resize",S,{passive:!0}),d&&Si("orientationchange",S,{passive:!0}),{width:y,height:r}}class x9 extends Error{constructor(t){super(t),this.name="ElementPlusError"}}function No(e,t){throw new x9(`[${e}] ${t}`)}const I3={current:0},A3=xe(0),mz=2e3,k3=Symbol("elZIndexContextKey"),gz=Symbol("zIndexContextKey"),og=e=>{const t=Cr()?Pn(k3,I3):I3,o=e||(Cr()?Pn(gz,void 0):void 0),a=ee(()=>{const y=b(o);return Wn(y)?y:mz}),d=ee(()=>a.value+A3.value),p=()=>(t.current++,A3.value=t.current,d.value);return!Wr&&Pn(k3),{initialZIndex:a,currentZIndex:d,nextZIndex:p}};var w9={name:"en",el:{breadcrumb:{label:"Breadcrumb"},colorpicker:{confirm:"OK",clear:"Clear",defaultLabel:"color picker",description:"current color is {color}. press enter to select a new color.",alphaLabel:"pick alpha value"},datepicker:{now:"Now",today:"Today",cancel:"Cancel",clear:"Clear",confirm:"OK",dateTablePrompt:"Use the arrow keys and enter to select the day of the month",monthTablePrompt:"Use the arrow keys and enter to select the month",yearTablePrompt:"Use the arrow keys and enter to select the year",selectedDate:"Selected date",selectDate:"Select date",selectTime:"Select time",startDate:"Start Date",startTime:"Start Time",endDate:"End Date",endTime:"End Time",prevYear:"Previous Year",nextYear:"Next Year",prevMonth:"Previous Month",nextMonth:"Next Month",year:"",month1:"January",month2:"February",month3:"March",month4:"April",month5:"May",month6:"June",month7:"July",month8:"August",month9:"September",month10:"October",month11:"November",month12:"December",week:"week",weeks:{sun:"Sun",mon:"Mon",tue:"Tue",wed:"Wed",thu:"Thu",fri:"Fri",sat:"Sat"},weeksFull:{sun:"Sunday",mon:"Monday",tue:"Tuesday",wed:"Wednesday",thu:"Thursday",fri:"Friday",sat:"Saturday"},months:{jan:"Jan",feb:"Feb",mar:"Mar",apr:"Apr",may:"May",jun:"Jun",jul:"Jul",aug:"Aug",sep:"Sep",oct:"Oct",nov:"Nov",dec:"Dec"}},inputNumber:{decrease:"decrease number",increase:"increase number"},select:{loading:"Loading",noMatch:"No matching data",noData:"No data",placeholder:"Select"},mention:{loading:"Loading"},dropdown:{toggleDropdown:"Toggle Dropdown"},cascader:{noMatch:"No matching data",loading:"Loading",placeholder:"Select",noData:"No data"},pagination:{goto:"Go to",pagesize:"/page",total:"Total {total}",pageClassifier:"",page:"Page",prev:"Go to previous page",next:"Go to next page",currentPage:"page {pager}",prevPages:"Previous {pager} pages",nextPages:"Next {pager} pages",deprecationWarning:"Deprecated usages detected, please refer to the el-pagination documentation for more details"},dialog:{close:"Close this dialog"},drawer:{close:"Close this dialog"},messagebox:{title:"Message",confirm:"OK",cancel:"Cancel",error:"Illegal input",close:"Close this dialog"},upload:{deleteTip:"press delete to remove",delete:"Delete",preview:"Preview",continue:"Continue"},slider:{defaultLabel:"slider between {min} and {max}",defaultRangeStartLabel:"pick start value",defaultRangeEndLabel:"pick end value"},table:{emptyText:"No Data",confirmFilter:"Confirm",resetFilter:"Reset",clearFilter:"All",sumText:"Sum"},tour:{next:"Next",previous:"Previous",finish:"Finish"},tree:{emptyText:"No Data"},transfer:{noMatch:"No matching data",noData:"No data",titles:["List 1","List 2"],filterPlaceholder:"Enter keyword",noCheckedFormat:"{total} items",hasCheckedFormat:"{checked}/{total} checked"},image:{error:"FAILED"},pageHeader:{title:"Back"},popconfirm:{confirmButtonText:"Yes",cancelButtonText:"No"},carousel:{leftArrow:"Carousel arrow left",rightArrow:"Carousel arrow right",indicator:"Carousel switch to index {index}"}}};const S9=e=>(t,o)=>T9(t,o,b(e)),T9=(e,t,o)=>Eo(o,e,e).replace(/\{(\w+)\}/g,(a,d)=>{var p;return`${(p=t==null?void 0:t[d])!=null?p:`{${d}}`}`}),C9=e=>{const t=ee(()=>b(e).name),o=Ti(e)?e:xe(e);return{lang:t,locale:o,t:S9(e)}},_z=Symbol("localeContextKey"),qr=e=>{const t=e||Pn(_z,xe());return C9(ee(()=>t.value||w9))},yz="__epPropKey",lt=e=>e,E9=e=>xr(e)&&!!e[yz],su=(e,t)=>{if(!xr(e)||E9(e))return e;const{values:o,required:a,default:d,type:p,validator:y}=e,S={type:p,required:!!a,validator:o||y?C=>{let M=!1,P=[];if(o&&(P=Array.from(o),ri(e,"default")&&P.push(d),M||(M=P.includes(C))),y&&(M||(M=y(C))),!M&&P.length>0){const z=[...new Set(P)].map(F=>JSON.stringify(F)).join(", ");A8(`Invalid prop: validation failed${t?` for prop "${t}"`:""}. Expected one of [${z}], got value ${JSON.stringify(C)}.`)}return M}:void 0,[yz]:!0};return ri(e,"default")&&(S.default=d),S},un=e=>Ly(Object.entries(e).map(([t,o])=>[t,su(o,t)])),ju=["","default","small","large"],zo=su({type:String,values:ju,required:!1}),vz=Symbol("size"),bz=()=>{const e=Pn(vz,{});return ee(()=>b(e.size)||"")},xz=Symbol("emptyValuesContextKey"),M9=["",void 0,null],I9=void 0,sg=un({emptyValues:Array,valueOnClear:{type:[String,Number,Boolean,Function],default:void 0,validator:e=>$n(e)?!e():!e}}),hx=(e,t)=>{const o=Cr()?Pn(xz,xe({})):xe({}),a=ee(()=>e.emptyValues||o.value.emptyValues||M9),d=ee(()=>$n(e.valueOnClear)?e.valueOnClear():e.valueOnClear!==void 0?e.valueOnClear:$n(o.value.valueOnClear)?o.value.valueOnClear():o.value.valueOnClear!==void 0?o.value.valueOnClear:t!==void 0?t:I9),p=y=>a.value.includes(y);return a.value.includes(d.value),{emptyValues:a,valueOnClear:d,isEmptyValue:p}},zm=e=>Object.keys(e),wz=e=>Object.entries(e),Wb=(e,t,o)=>({get value(){return Eo(e,t,o)},set value(a){Dq(e,t,a)}}),S1=xe();function px(e,t=void 0){const o=Cr()?Pn(xD,S1):S1;return e?ee(()=>{var a,d;return(d=(a=o.value)==null?void 0:a[e])!=null?d:t}):o}function mx(e,t){const o=px(),a=Xt(e,ee(()=>{var r;return((r=o.value)==null?void 0:r.namespace)||hy})),d=qr(ee(()=>{var r;return(r=o.value)==null?void 0:r.locale})),p=og(ee(()=>{var r;return((r=o.value)==null?void 0:r.zIndex)||mz})),y=ee(()=>{var r;return b(t)||((r=o.value)==null?void 0:r.size)||""});return ZC(ee(()=>b(o)||{})),{ns:a,locale:d,zIndex:p,size:y}}const ZC=(e,t,o=!1)=>{var a;const d=!!Cr(),p=d?px():void 0,y=(a=t==null?void 0:t.provide)!=null?a:d?Vr:void 0;if(!y)return;const r=ee(()=>{const S=b(e);return p!=null&&p.value?A9(p.value,S):S});return y(xD,r),y(_z,ee(()=>r.value.locale)),y(wD,ee(()=>r.value.namespace)),y(gz,ee(()=>r.value.zIndex)),y(vz,{size:ee(()=>r.value.size||"")}),y(xz,ee(()=>({emptyValues:r.value.emptyValues,valueOnClear:r.value.valueOnClear}))),(o||!S1.value)&&(S1.value=r.value),r},A9=(e,t)=>{const o=[...new Set([...zm(e),...zm(t)])],a={};for(const d of o)a[d]=t[d]!==void 0?t[d]:e[d];return a},k9=(e=[])=>({version:gU,install:(o,a)=>{o[NP]||(o[NP]=!0,e.forEach(d=>o.use(d)),a&&ZC(a,o,!0))}}),gr="update:modelValue",Ii="change",ys="input",P9=un({zIndex:{type:lt([Number,String]),default:100},target:{type:String,default:""},offset:{type:Number,default:0},position:{type:String,values:["top","bottom"],default:"top"}}),R9={scroll:({scrollTop:e,fixed:t})=>Wn(e)&&Oi(t),[Ii]:e=>Oi(e)};var dn=(e,t)=>{const o=e.__vccOpts||e;for(const[a,d]of t)o[a]=d;return o};function O9(e,t,o,a){const d=o-t;return e/=a/2,e<1?d/2*e*e*e+t:d/2*((e-=2)*e*e+2)+t}const Zd=e=>Wr?window.requestAnimationFrame(e):setTimeout(e,16),Th=e=>Wr?window.cancelAnimationFrame(e):clearTimeout(e),Sz=(e="")=>e.split(" ").filter(t=>!!t.trim()),wa=(e,t)=>{if(!e||!t)return!1;if(t.includes(" "))throw new Error("className should not contain space.");return e.classList.contains(t)},ol=(e,t)=>{!e||!t.trim()||e.classList.add(...Sz(t))},Vs=(e,t)=>{!e||!t.trim()||e.classList.remove(...Sz(t))},Tc=(e,t)=>{var o;if(!Wr||!e||!t)return"";let a=ra(t);a==="float"&&(a="cssFloat");try{const d=e.style[a];if(d)return d;const p=(o=document.defaultView)==null?void 0:o.getComputedStyle(e,"");return p?p[a]:""}catch{return e.style[a]}},Tz=(e,t,o)=>{if(!(!e||!t))if(xr(t))wz(t).forEach(([a,d])=>Tz(e,a,d));else{const a=ra(t);e.style[a]=o}};function _o(e,t="px"){if(!e)return"";if(Wn(e)||$q(e))return`${e}${t}`;if(Nn(e))return e}const L9=(e,t)=>{if(!Wr)return!1;const o={undefined:"overflow",true:"overflow-y",false:"overflow-x"}[String(t)],a=Tc(e,o);return["scroll","auto","overlay"].some(d=>a.includes(d))},YC=(e,t)=>{if(!Wr)return;let o=e;for(;o;){if([window,document,document.documentElement].includes(o))return window;if(L9(o,t))return o;o=o.parentNode}return o};let xb;const Cz=e=>{var t;if(!Wr)return 0;if(xb!==void 0)return xb;const o=document.createElement("div");o.className=`${e}-scrollbar__wrap`,o.style.visibility="hidden",o.style.width="100px",o.style.position="absolute",o.style.top="-9999px",document.body.appendChild(o);const a=o.offsetWidth;o.style.overflow="scroll";const d=document.createElement("div");d.style.width="100%",o.appendChild(d);const p=d.offsetWidth;return(t=o.parentNode)==null||t.removeChild(o),xb=a-p,xb};function XC(e,t){if(!Wr)return;if(!t){e.scrollTop=0;return}const o=[];let a=t.offsetParent;for(;a!==null&&e!==a&&e.contains(a);)o.push(a),a=a.offsetParent;const d=t.offsetTop+o.reduce((S,C)=>S+C.offsetTop,0),p=d+t.offsetHeight,y=e.scrollTop,r=y+e.clientHeight;d<y?e.scrollTop=d:p>r&&(e.scrollTop=p-e.clientHeight)}function D9(e,t,o,a,d){const p=Date.now();let y;const r=()=>{const C=Date.now()-p,M=O9(C>a?a:C,t,o,a);fx(e)?e.scrollTo(window.pageXOffset,M):e.scrollTop=M,C<a?y=Zd(r):$n(d)&&d()};return r(),()=>{y&&Th(y)}}const P3=(e,t)=>fx(t)?e.ownerDocument.documentElement:t,R3=e=>fx(e)?window.scrollY:e.scrollTop,Ez="ElAffix",z9=We({name:Ez}),F9=We({...z9,props:P9,emits:R9,setup(e,{expose:t,emit:o}){const a=e,d=Xt("affix"),p=Hi(),y=Hi(),r=Hi(),{height:S}=b9(),{height:C,width:M,top:P,bottom:z,update:F}=S3(y,{windowScroll:!1}),V=S3(p),N=xe(!1),H=xe(0),U=xe(0),te=ee(()=>({height:N.value?`${C.value}px`:"",width:N.value?`${M.value}px`:""})),Z=ee(()=>{if(!N.value)return{};const re=a.offset?_o(a.offset):0;return{height:`${C.value}px`,width:`${M.value}px`,top:a.position==="top"?re:"",bottom:a.position==="bottom"?re:"",transform:U.value?`translateY(${U.value}px)`:"",zIndex:a.zIndex}}),q=()=>{if(!r.value)return;H.value=r.value instanceof Window?document.documentElement.scrollTop:r.value.scrollTop||0;const{position:re,target:se,offset:he}=a,le=he+C.value;if(re==="top")if(se){const ce=V.bottom.value-le;N.value=he>P.value&&V.bottom.value>0,U.value=ce<0?ce:0}else N.value=he>P.value;else if(se){const ce=S.value-V.top.value-le;N.value=S.value-he<z.value&&S.value>V.top.value,U.value=ce<0?-ce:0}else N.value=S.value-he<z.value},J=()=>{F(),o("scroll",{scrollTop:H.value,fixed:N.value})};return Wt(N,re=>o("change",re)),yr(()=>{var re;a.target?(p.value=(re=document.querySelector(a.target))!=null?re:void 0,p.value||No(Ez,`Target does not exist: ${a.target}`)):p.value=document.documentElement,r.value=YC(y.value,!0),F()}),Si(r,"scroll",J),gs(q),t({update:q,updateRoot:F}),(re,se)=>(ae(),Pe("div",{ref_key:"root",ref:y,class:fe(b(d).b()),style:Un(b(te))},[Ue("div",{class:fe({[b(d).m("fixed")]:N.value}),style:Un(b(Z))},[gt(re.$slots,"default")],6)],6))}});var N9=dn(F9,[["__file","affix.vue"]]);const lr=(e,t)=>{if(e.install=o=>{for(const a of[e,...Object.values(t??{})])o.component(a.name,a)},t)for(const[o,a]of Object.entries(t))e[o]=a;return e},Mz=(e,t)=>(e.install=o=>{e._context=o._context,o.config.globalProperties[t]=e},e),B9=(e,t)=>(e.install=o=>{o.directive(t,e)},e),oo=e=>(e.install=vi,e),V9=lr(N9),$9=un({size:{type:lt([Number,String])},color:{type:String}}),U9=We({name:"ElIcon",inheritAttrs:!1}),j9=We({...U9,props:$9,setup(e){const t=e,o=Xt("icon"),a=ee(()=>{const{size:d,color:p}=t;return!d&&!p?{}:{fontSize:ai(d)?void 0:_o(d),"--color":p}});return(d,p)=>(ae(),Pe("i",kr({class:b(o).b(),style:b(a)},d.$attrs),[gt(d.$slots,"default")],16))}});var H9=dn(j9,[["__file","icon.vue"]]);const zn=lr(H9);/*! Element Plus Icons Vue v2.3.1 */var G9=We({name:"ArrowDown",__name:"arrow-down",setup(e){return(t,o)=>(ae(),Pe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ue("path",{fill:"currentColor",d:"M831.872 340.864 512 652.672 192.128 340.864a30.592 30.592 0 0 0-42.752 0 29.12 29.12 0 0 0 0 41.6L489.664 714.24a32 32 0 0 0 44.672 0l340.288-331.712a29.12 29.12 0 0 0 0-41.728 30.592 30.592 0 0 0-42.752 0z"})]))}}),zc=G9,W9=We({name:"ArrowLeft",__name:"arrow-left",setup(e){return(t,o)=>(ae(),Pe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ue("path",{fill:"currentColor",d:"M609.408 149.376 277.76 489.6a32 32 0 0 0 0 44.672l331.648 340.352a29.12 29.12 0 0 0 41.728 0 30.592 30.592 0 0 0 0-42.752L339.264 511.936l311.872-319.872a30.592 30.592 0 0 0 0-42.688 29.12 29.12 0 0 0-41.728 0z"})]))}}),Yd=W9,q9=We({name:"ArrowRight",__name:"arrow-right",setup(e){return(t,o)=>(ae(),Pe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ue("path",{fill:"currentColor",d:"M340.864 149.312a30.592 30.592 0 0 0 0 42.752L652.736 512 340.864 831.872a30.592 30.592 0 0 0 0 42.752 29.12 29.12 0 0 0 41.728 0L714.24 534.336a32 32 0 0 0 0-44.672L382.592 149.376a29.12 29.12 0 0 0-41.728 0z"})]))}}),ta=q9,K9=We({name:"ArrowUp",__name:"arrow-up",setup(e){return(t,o)=>(ae(),Pe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ue("path",{fill:"currentColor",d:"m488.832 344.32-339.84 356.672a32 32 0 0 0 0 44.16l.384.384a29.44 29.44 0 0 0 42.688 0l320-335.872 319.872 335.872a29.44 29.44 0 0 0 42.688 0l.384-.384a32 32 0 0 0 0-44.16L535.168 344.32a32 32 0 0 0-46.336 0"})]))}}),JC=K9,Z9=We({name:"Back",__name:"back",setup(e){return(t,o)=>(ae(),Pe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ue("path",{fill:"currentColor",d:"M224 480h640a32 32 0 1 1 0 64H224a32 32 0 0 1 0-64"}),Ue("path",{fill:"currentColor",d:"m237.248 512 265.408 265.344a32 32 0 0 1-45.312 45.312l-288-288a32 32 0 0 1 0-45.312l288-288a32 32 0 1 1 45.312 45.312z"})]))}}),Y9=Z9,X9=We({name:"Calendar",__name:"calendar",setup(e){return(t,o)=>(ae(),Pe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ue("path",{fill:"currentColor",d:"M128 384v512h768V192H768v32a32 32 0 1 1-64 0v-32H320v32a32 32 0 0 1-64 0v-32H128v128h768v64zm192-256h384V96a32 32 0 1 1 64 0v32h160a32 32 0 0 1 32 32v768a32 32 0 0 1-32 32H96a32 32 0 0 1-32-32V160a32 32 0 0 1 32-32h160V96a32 32 0 0 1 64 0zm-32 384h64a32 32 0 0 1 0 64h-64a32 32 0 0 1 0-64m0 192h64a32 32 0 1 1 0 64h-64a32 32 0 1 1 0-64m192-192h64a32 32 0 0 1 0 64h-64a32 32 0 0 1 0-64m0 192h64a32 32 0 1 1 0 64h-64a32 32 0 1 1 0-64m192-192h64a32 32 0 1 1 0 64h-64a32 32 0 1 1 0-64m0 192h64a32 32 0 1 1 0 64h-64a32 32 0 1 1 0-64"})]))}}),J9=X9,Q9=We({name:"CaretRight",__name:"caret-right",setup(e){return(t,o)=>(ae(),Pe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ue("path",{fill:"currentColor",d:"M384 192v640l384-320.064z"})]))}}),Iz=Q9,e7=We({name:"CaretTop",__name:"caret-top",setup(e){return(t,o)=>(ae(),Pe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ue("path",{fill:"currentColor",d:"M512 320 192 704h639.936z"})]))}}),t7=e7,n7=We({name:"Check",__name:"check",setup(e){return(t,o)=>(ae(),Pe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ue("path",{fill:"currentColor",d:"M406.656 706.944 195.84 496.256a32 32 0 1 0-45.248 45.248l256 256 512-512a32 32 0 0 0-45.248-45.248L406.592 706.944z"})]))}}),lv=n7,r7=We({name:"CircleCheckFilled",__name:"circle-check-filled",setup(e){return(t,o)=>(ae(),Pe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ue("path",{fill:"currentColor",d:"M512 64a448 448 0 1 1 0 896 448 448 0 0 1 0-896m-55.808 536.384-99.52-99.584a38.4 38.4 0 1 0-54.336 54.336l126.72 126.72a38.272 38.272 0 0 0 54.336 0l262.4-262.464a38.4 38.4 0 1 0-54.272-54.336z"})]))}}),i7=r7,o7=We({name:"CircleCheck",__name:"circle-check",setup(e){return(t,o)=>(ae(),Pe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ue("path",{fill:"currentColor",d:"M512 896a384 384 0 1 0 0-768 384 384 0 0 0 0 768m0 64a448 448 0 1 1 0-896 448 448 0 0 1 0 896"}),Ue("path",{fill:"currentColor",d:"M745.344 361.344a32 32 0 0 1 45.312 45.312l-288 288a32 32 0 0 1-45.312 0l-160-160a32 32 0 1 1 45.312-45.312L480 626.752l265.344-265.408z"})]))}}),QC=o7,s7=We({name:"CircleCloseFilled",__name:"circle-close-filled",setup(e){return(t,o)=>(ae(),Pe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ue("path",{fill:"currentColor",d:"M512 64a448 448 0 1 1 0 896 448 448 0 0 1 0-896m0 393.664L407.936 353.6a38.4 38.4 0 1 0-54.336 54.336L457.664 512 353.6 616.064a38.4 38.4 0 1 0 54.336 54.336L512 566.336 616.064 670.4a38.4 38.4 0 1 0 54.336-54.336L566.336 512 670.4 407.936a38.4 38.4 0 1 0-54.336-54.336z"})]))}}),eE=s7,a7=We({name:"CircleClose",__name:"circle-close",setup(e){return(t,o)=>(ae(),Pe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ue("path",{fill:"currentColor",d:"m466.752 512-90.496-90.496a32 32 0 0 1 45.248-45.248L512 466.752l90.496-90.496a32 32 0 1 1 45.248 45.248L557.248 512l90.496 90.496a32 32 0 1 1-45.248 45.248L512 557.248l-90.496 90.496a32 32 0 0 1-45.248-45.248z"}),Ue("path",{fill:"currentColor",d:"M512 896a384 384 0 1 0 0-768 384 384 0 0 0 0 768m0 64a448 448 0 1 1 0-896 448 448 0 0 1 0 896"})]))}}),Fc=a7,l7=We({name:"Clock",__name:"clock",setup(e){return(t,o)=>(ae(),Pe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ue("path",{fill:"currentColor",d:"M512 896a384 384 0 1 0 0-768 384 384 0 0 0 0 768m0 64a448 448 0 1 1 0-896 448 448 0 0 1 0 896"}),Ue("path",{fill:"currentColor",d:"M480 256a32 32 0 0 1 32 32v256a32 32 0 0 1-64 0V288a32 32 0 0 1 32-32"}),Ue("path",{fill:"currentColor",d:"M480 512h256q32 0 32 32t-32 32H480q-32 0-32-32t32-32"})]))}}),Az=l7,u7=We({name:"Close",__name:"close",setup(e){return(t,o)=>(ae(),Pe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ue("path",{fill:"currentColor",d:"M764.288 214.592 512 466.88 259.712 214.592a31.936 31.936 0 0 0-45.12 45.12L466.752 512 214.528 764.224a31.936 31.936 0 1 0 45.12 45.184L512 557.184l252.288 252.288a31.936 31.936 0 0 0 45.12-45.12L557.12 512.064l252.288-252.352a31.936 31.936 0 1 0-45.12-45.184z"})]))}}),Ql=u7,c7=We({name:"DArrowLeft",__name:"d-arrow-left",setup(e){return(t,o)=>(ae(),Pe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ue("path",{fill:"currentColor",d:"M529.408 149.376a29.12 29.12 0 0 1 41.728 0 30.592 30.592 0 0 1 0 42.688L259.264 511.936l311.872 319.936a30.592 30.592 0 0 1-.512 43.264 29.12 29.12 0 0 1-41.216-.512L197.76 534.272a32 32 0 0 1 0-44.672l331.648-340.224zm256 0a29.12 29.12 0 0 1 41.728 0 30.592 30.592 0 0 1 0 42.688L515.264 511.936l311.872 319.936a30.592 30.592 0 0 1-.512 43.264 29.12 29.12 0 0 1-41.216-.512L453.76 534.272a32 32 0 0 1 0-44.672l331.648-340.224z"})]))}}),Xd=c7,d7=We({name:"DArrowRight",__name:"d-arrow-right",setup(e){return(t,o)=>(ae(),Pe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ue("path",{fill:"currentColor",d:"M452.864 149.312a29.12 29.12 0 0 1 41.728.064L826.24 489.664a32 32 0 0 1 0 44.672L494.592 874.624a29.12 29.12 0 0 1-41.728 0 30.592 30.592 0 0 1 0-42.752L764.736 512 452.864 192a30.592 30.592 0 0 1 0-42.688m-256 0a29.12 29.12 0 0 1 41.728.064L570.24 489.664a32 32 0 0 1 0 44.672L238.592 874.624a29.12 29.12 0 0 1-41.728 0 30.592 30.592 0 0 1 0-42.752L508.736 512 196.864 192a30.592 30.592 0 0 1 0-42.688z"})]))}}),Jd=d7,f7=We({name:"Delete",__name:"delete",setup(e){return(t,o)=>(ae(),Pe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ue("path",{fill:"currentColor",d:"M160 256H96a32 32 0 0 1 0-64h256V95.936a32 32 0 0 1 32-32h256a32 32 0 0 1 32 32V192h256a32 32 0 1 1 0 64h-64v672a32 32 0 0 1-32 32H192a32 32 0 0 1-32-32zm448-64v-64H416v64zM224 896h576V256H224zm192-128a32 32 0 0 1-32-32V416a32 32 0 0 1 64 0v320a32 32 0 0 1-32 32m192 0a32 32 0 0 1-32-32V416a32 32 0 0 1 64 0v320a32 32 0 0 1-32 32"})]))}}),h7=f7,p7=We({name:"Document",__name:"document",setup(e){return(t,o)=>(ae(),Pe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ue("path",{fill:"currentColor",d:"M832 384H576V128H192v768h640zm-26.496-64L640 154.496V320zM160 64h480l256 256v608a32 32 0 0 1-32 32H160a32 32 0 0 1-32-32V96a32 32 0 0 1 32-32m160 448h384v64H320zm0-192h160v64H320zm0 384h384v64H320z"})]))}}),m7=p7,g7=We({name:"FullScreen",__name:"full-screen",setup(e){return(t,o)=>(ae(),Pe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ue("path",{fill:"currentColor",d:"m160 96.064 192 .192a32 32 0 0 1 0 64l-192-.192V352a32 32 0 0 1-64 0V96h64zm0 831.872V928H96V672a32 32 0 1 1 64 0v191.936l192-.192a32 32 0 1 1 0 64zM864 96.064V96h64v256a32 32 0 1 1-64 0V160.064l-192 .192a32 32 0 1 1 0-64l192-.192zm0 831.872-192-.192a32 32 0 0 1 0-64l192 .192V672a32 32 0 1 1 64 0v256h-64z"})]))}}),_7=g7,y7=We({name:"Hide",__name:"hide",setup(e){return(t,o)=>(ae(),Pe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ue("path",{fill:"currentColor",d:"M876.8 156.8c0-9.6-3.2-16-9.6-22.4-6.4-6.4-12.8-9.6-22.4-9.6-9.6 0-16 3.2-22.4 9.6L736 220.8c-64-32-137.6-51.2-224-60.8-160 16-288 73.6-377.6 176C44.8 438.4 0 496 0 512s48 73.6 134.4 176c22.4 25.6 44.8 48 73.6 67.2l-86.4 89.6c-6.4 6.4-9.6 12.8-9.6 22.4 0 9.6 3.2 16 9.6 22.4 6.4 6.4 12.8 9.6 22.4 9.6 9.6 0 16-3.2 22.4-9.6l704-710.4c3.2-6.4 6.4-12.8 6.4-22.4Zm-646.4 528c-76.8-70.4-128-128-153.6-172.8 28.8-48 80-105.6 153.6-172.8C304 272 400 230.4 512 224c64 3.2 124.8 19.2 176 44.8l-54.4 54.4C598.4 300.8 560 288 512 288c-64 0-115.2 22.4-160 64s-64 96-64 160c0 48 12.8 89.6 35.2 124.8L256 707.2c-9.6-6.4-19.2-16-25.6-22.4Zm140.8-96c-12.8-22.4-19.2-48-19.2-76.8 0-44.8 16-83.2 48-112 32-28.8 67.2-48 112-48 28.8 0 54.4 6.4 73.6 19.2zM889.599 336c-12.8-16-28.8-28.8-41.6-41.6l-48 48c73.6 67.2 124.8 124.8 150.4 169.6-28.8 48-80 105.6-153.6 172.8-73.6 67.2-172.8 108.8-284.8 115.2-51.2-3.2-99.2-12.8-140.8-28.8l-48 48c57.6 22.4 118.4 38.4 188.8 44.8 160-16 288-73.6 377.6-176C979.199 585.6 1024 528 1024 512s-48.001-73.6-134.401-176Z"}),Ue("path",{fill:"currentColor",d:"M511.998 672c-12.8 0-25.6-3.2-38.4-6.4l-51.2 51.2c28.8 12.8 57.6 19.2 89.6 19.2 64 0 115.2-22.4 160-64 41.6-41.6 64-96 64-160 0-32-6.4-64-19.2-89.6l-51.2 51.2c3.2 12.8 6.4 25.6 6.4 38.4 0 44.8-16 83.2-48 112-32 28.8-67.2 48-112 48Z"})]))}}),v7=y7,b7=We({name:"InfoFilled",__name:"info-filled",setup(e){return(t,o)=>(ae(),Pe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ue("path",{fill:"currentColor",d:"M512 64a448 448 0 1 1 0 896.064A448 448 0 0 1 512 64m67.2 275.072c33.28 0 60.288-23.104 60.288-57.344s-27.072-57.344-60.288-57.344c-33.28 0-60.16 23.104-60.16 57.344s26.88 57.344 60.16 57.344M590.912 699.2c0-6.848 2.368-24.64 1.024-34.752l-52.608 60.544c-10.88 11.456-24.512 19.392-30.912 17.28a12.992 12.992 0 0 1-8.256-14.72l87.68-276.992c7.168-35.136-12.544-67.2-54.336-71.296-44.096 0-108.992 44.736-148.48 101.504 0 6.784-1.28 23.68.064 33.792l52.544-60.608c10.88-11.328 23.552-19.328 29.952-17.152a12.8 12.8 0 0 1 7.808 16.128L388.48 728.576c-10.048 32.256 8.96 63.872 55.04 71.04 67.84 0 107.904-43.648 147.456-100.416z"})]))}}),tE=b7,x7=We({name:"Loading",__name:"loading",setup(e){return(t,o)=>(ae(),Pe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ue("path",{fill:"currentColor",d:"M512 64a32 32 0 0 1 32 32v192a32 32 0 0 1-64 0V96a32 32 0 0 1 32-32m0 640a32 32 0 0 1 32 32v192a32 32 0 1 1-64 0V736a32 32 0 0 1 32-32m448-192a32 32 0 0 1-32 32H736a32 32 0 1 1 0-64h192a32 32 0 0 1 32 32m-640 0a32 32 0 0 1-32 32H96a32 32 0 0 1 0-64h192a32 32 0 0 1 32 32M195.2 195.2a32 32 0 0 1 45.248 0L376.32 331.008a32 32 0 0 1-45.248 45.248L195.2 240.448a32 32 0 0 1 0-45.248zm452.544 452.544a32 32 0 0 1 45.248 0L828.8 783.552a32 32 0 0 1-45.248 45.248L647.744 692.992a32 32 0 0 1 0-45.248zM828.8 195.264a32 32 0 0 1 0 45.184L692.992 376.32a32 32 0 0 1-45.248-45.248l135.808-135.808a32 32 0 0 1 45.248 0m-452.544 452.48a32 32 0 0 1 0 45.248L240.448 828.8a32 32 0 0 1-45.248-45.248l135.808-135.808a32 32 0 0 1 45.248 0z"})]))}}),Fu=x7,w7=We({name:"Minus",__name:"minus",setup(e){return(t,o)=>(ae(),Pe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ue("path",{fill:"currentColor",d:"M128 544h768a32 32 0 1 0 0-64H128a32 32 0 0 0 0 64"})]))}}),S7=w7,T7=We({name:"MoreFilled",__name:"more-filled",setup(e){return(t,o)=>(ae(),Pe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ue("path",{fill:"currentColor",d:"M176 416a112 112 0 1 1 0 224 112 112 0 0 1 0-224m336 0a112 112 0 1 1 0 224 112 112 0 0 1 0-224m336 0a112 112 0 1 1 0 224 112 112 0 0 1 0-224"})]))}}),O3=T7,C7=We({name:"More",__name:"more",setup(e){return(t,o)=>(ae(),Pe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ue("path",{fill:"currentColor",d:"M176 416a112 112 0 1 0 0 224 112 112 0 0 0 0-224m0 64a48 48 0 1 1 0 96 48 48 0 0 1 0-96m336-64a112 112 0 1 1 0 224 112 112 0 0 1 0-224m0 64a48 48 0 1 0 0 96 48 48 0 0 0 0-96m336-64a112 112 0 1 1 0 224 112 112 0 0 1 0-224m0 64a48 48 0 1 0 0 96 48 48 0 0 0 0-96"})]))}}),E7=C7,M7=We({name:"PictureFilled",__name:"picture-filled",setup(e){return(t,o)=>(ae(),Pe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ue("path",{fill:"currentColor",d:"M96 896a32 32 0 0 1-32-32V160a32 32 0 0 1 32-32h832a32 32 0 0 1 32 32v704a32 32 0 0 1-32 32zm315.52-228.48-68.928-68.928a32 32 0 0 0-45.248 0L128 768.064h778.688l-242.112-290.56a32 32 0 0 0-49.216 0L458.752 665.408a32 32 0 0 1-47.232 2.112M256 384a96 96 0 1 0 192.064-.064A96 96 0 0 0 256 384"})]))}}),I7=M7,A7=We({name:"Plus",__name:"plus",setup(e){return(t,o)=>(ae(),Pe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ue("path",{fill:"currentColor",d:"M480 480V128a32 32 0 0 1 64 0v352h352a32 32 0 1 1 0 64H544v352a32 32 0 1 1-64 0V544H128a32 32 0 0 1 0-64z"})]))}}),kz=A7,k7=We({name:"QuestionFilled",__name:"question-filled",setup(e){return(t,o)=>(ae(),Pe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ue("path",{fill:"currentColor",d:"M512 64a448 448 0 1 1 0 896 448 448 0 0 1 0-896m23.744 191.488c-52.096 0-92.928 14.784-123.2 44.352-30.976 29.568-45.76 70.4-45.76 122.496h80.256c0-29.568 5.632-52.8 17.6-68.992 13.376-19.712 35.2-28.864 66.176-28.864 23.936 0 42.944 6.336 56.32 19.712 12.672 13.376 19.712 31.68 19.712 54.912 0 17.6-6.336 34.496-19.008 49.984l-8.448 9.856c-45.76 40.832-73.216 70.4-82.368 89.408-9.856 19.008-14.08 42.24-14.08 68.992v9.856h80.96v-9.856c0-16.896 3.52-31.68 10.56-45.76 6.336-12.672 15.488-24.64 28.16-35.2 33.792-29.568 54.208-48.576 60.544-55.616 16.896-22.528 26.048-51.392 26.048-86.592 0-42.944-14.08-76.736-42.24-101.376-28.16-25.344-65.472-37.312-111.232-37.312zm-12.672 406.208a54.272 54.272 0 0 0-38.72 14.784 49.408 49.408 0 0 0-15.488 38.016c0 15.488 4.928 28.16 15.488 38.016A54.848 54.848 0 0 0 523.072 768c15.488 0 28.16-4.928 38.72-14.784a51.52 51.52 0 0 0 16.192-38.72 51.968 51.968 0 0 0-15.488-38.016 55.936 55.936 0 0 0-39.424-14.784z"})]))}}),P7=k7,R7=We({name:"RefreshLeft",__name:"refresh-left",setup(e){return(t,o)=>(ae(),Pe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ue("path",{fill:"currentColor",d:"M289.088 296.704h92.992a32 32 0 0 1 0 64H232.96a32 32 0 0 1-32-32V179.712a32 32 0 0 1 64 0v50.56a384 384 0 0 1 643.84 282.88 384 384 0 0 1-383.936 384 384 384 0 0 1-384-384h64a320 320 0 1 0 640 0 320 320 0 0 0-555.712-216.448z"})]))}}),O7=R7,L7=We({name:"RefreshRight",__name:"refresh-right",setup(e){return(t,o)=>(ae(),Pe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ue("path",{fill:"currentColor",d:"M784.512 230.272v-50.56a32 32 0 1 1 64 0v149.056a32 32 0 0 1-32 32H667.52a32 32 0 1 1 0-64h92.992A320 320 0 1 0 524.8 833.152a320 320 0 0 0 320-320h64a384 384 0 0 1-384 384 384 384 0 0 1-384-384 384 384 0 0 1 643.712-282.88z"})]))}}),D7=L7,z7=We({name:"ScaleToOriginal",__name:"scale-to-original",setup(e){return(t,o)=>(ae(),Pe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ue("path",{fill:"currentColor",d:"M813.176 180.706a60.235 60.235 0 0 1 60.236 60.235v481.883a60.235 60.235 0 0 1-60.236 60.235H210.824a60.235 60.235 0 0 1-60.236-60.235V240.94a60.235 60.235 0 0 1 60.236-60.235h602.352zm0-60.235H210.824A120.47 120.47 0 0 0 90.353 240.94v481.883a120.47 120.47 0 0 0 120.47 120.47h602.353a120.47 120.47 0 0 0 120.471-120.47V240.94a120.47 120.47 0 0 0-120.47-120.47zm-120.47 180.705a30.118 30.118 0 0 0-30.118 30.118v301.177a30.118 30.118 0 0 0 60.236 0V331.294a30.118 30.118 0 0 0-30.118-30.118zm-361.412 0a30.118 30.118 0 0 0-30.118 30.118v301.177a30.118 30.118 0 1 0 60.236 0V331.294a30.118 30.118 0 0 0-30.118-30.118M512 361.412a30.118 30.118 0 0 0-30.118 30.117v30.118a30.118 30.118 0 0 0 60.236 0V391.53A30.118 30.118 0 0 0 512 361.412M512 512a30.118 30.118 0 0 0-30.118 30.118v30.117a30.118 30.118 0 0 0 60.236 0v-30.117A30.118 30.118 0 0 0 512 512"})]))}}),F7=z7,N7=We({name:"Search",__name:"search",setup(e){return(t,o)=>(ae(),Pe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ue("path",{fill:"currentColor",d:"m795.904 750.72 124.992 124.928a32 32 0 0 1-45.248 45.248L750.656 795.904a416 416 0 1 1 45.248-45.248zM480 832a352 352 0 1 0 0-704 352 352 0 0 0 0 704"})]))}}),B7=N7,V7=We({name:"SortDown",__name:"sort-down",setup(e){return(t,o)=>(ae(),Pe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ue("path",{fill:"currentColor",d:"M576 96v709.568L333.312 562.816A32 32 0 1 0 288 608l297.408 297.344A32 32 0 0 0 640 882.688V96a32 32 0 0 0-64 0"})]))}}),$7=V7,U7=We({name:"SortUp",__name:"sort-up",setup(e){return(t,o)=>(ae(),Pe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ue("path",{fill:"currentColor",d:"M384 141.248V928a32 32 0 1 0 64 0V218.56l242.688 242.688A32 32 0 1 0 736 416L438.592 118.656A32 32 0 0 0 384 141.248"})]))}}),j7=U7,H7=We({name:"StarFilled",__name:"star-filled",setup(e){return(t,o)=>(ae(),Pe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ue("path",{fill:"currentColor",d:"M283.84 867.84 512 747.776l228.16 119.936a6.4 6.4 0 0 0 9.28-6.72l-43.52-254.08 184.512-179.904a6.4 6.4 0 0 0-3.52-10.88l-255.104-37.12L517.76 147.904a6.4 6.4 0 0 0-11.52 0L392.192 379.072l-255.104 37.12a6.4 6.4 0 0 0-3.52 10.88L318.08 606.976l-43.584 254.08a6.4 6.4 0 0 0 9.28 6.72z"})]))}}),wb=H7,G7=We({name:"Star",__name:"star",setup(e){return(t,o)=>(ae(),Pe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ue("path",{fill:"currentColor",d:"m512 747.84 228.16 119.936a6.4 6.4 0 0 0 9.28-6.72l-43.52-254.08 184.512-179.904a6.4 6.4 0 0 0-3.52-10.88l-255.104-37.12L517.76 147.904a6.4 6.4 0 0 0-11.52 0L392.192 379.072l-255.104 37.12a6.4 6.4 0 0 0-3.52 10.88L318.08 606.976l-43.584 254.08a6.4 6.4 0 0 0 9.28 6.72zM313.6 924.48a70.4 70.4 0 0 1-102.144-74.24l37.888-220.928L88.96 472.96A70.4 70.4 0 0 1 128 352.896l221.76-32.256 99.2-200.96a70.4 70.4 0 0 1 126.208 0l99.2 200.96 221.824 32.256a70.4 70.4 0 0 1 39.04 120.064L774.72 629.376l37.888 220.928a70.4 70.4 0 0 1-102.144 74.24L512 820.096l-198.4 104.32z"})]))}}),W7=G7,q7=We({name:"SuccessFilled",__name:"success-filled",setup(e){return(t,o)=>(ae(),Pe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ue("path",{fill:"currentColor",d:"M512 64a448 448 0 1 1 0 896 448 448 0 0 1 0-896m-55.808 536.384-99.52-99.584a38.4 38.4 0 1 0-54.336 54.336l126.72 126.72a38.272 38.272 0 0 0 54.336 0l262.4-262.464a38.4 38.4 0 1 0-54.272-54.336z"})]))}}),Pz=q7,K7=We({name:"View",__name:"view",setup(e){return(t,o)=>(ae(),Pe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ue("path",{fill:"currentColor",d:"M512 160c320 0 512 352 512 352S832 864 512 864 0 512 0 512s192-352 512-352m0 64c-225.28 0-384.128 208.064-436.8 288 52.608 79.872 211.456 288 436.8 288 225.28 0 384.128-208.064 436.8-288-52.608-79.872-211.456-288-436.8-288zm0 64a224 224 0 1 1 0 448 224 224 0 0 1 0-448m0 64a160.192 160.192 0 0 0-160 160c0 88.192 71.744 160 160 160s160-71.808 160-160-71.744-160-160-160"})]))}}),Z7=K7,Y7=We({name:"WarningFilled",__name:"warning-filled",setup(e){return(t,o)=>(ae(),Pe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ue("path",{fill:"currentColor",d:"M512 64a448 448 0 1 1 0 896 448 448 0 0 1 0-896m0 192a58.432 58.432 0 0 0-58.24 63.744l23.36 256.384a35.072 35.072 0 0 0 69.76 0l23.296-256.384A58.432 58.432 0 0 0 512 256m0 512a51.2 51.2 0 1 0 0-102.4 51.2 51.2 0 0 0 0 102.4"})]))}}),gx=Y7,X7=We({name:"ZoomIn",__name:"zoom-in",setup(e){return(t,o)=>(ae(),Pe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ue("path",{fill:"currentColor",d:"m795.904 750.72 124.992 124.928a32 32 0 0 1-45.248 45.248L750.656 795.904a416 416 0 1 1 45.248-45.248zM480 832a352 352 0 1 0 0-704 352 352 0 0 0 0 704m-32-384v-96a32 32 0 0 1 64 0v96h96a32 32 0 0 1 0 64h-96v96a32 32 0 0 1-64 0v-96h-96a32 32 0 0 1 0-64z"})]))}}),Rz=X7,J7=We({name:"ZoomOut",__name:"zoom-out",setup(e){return(t,o)=>(ae(),Pe("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[Ue("path",{fill:"currentColor",d:"m795.904 750.72 124.992 124.928a32 32 0 0 1-45.248 45.248L750.656 795.904a416 416 0 1 1 45.248-45.248zM480 832a352 352 0 1 0 0-704 352 352 0 0 0 0 704M352 448h256a32 32 0 0 1 0 64H352a32 32 0 0 1 0-64"})]))}}),Q7=J7;const Ai=lt([String,Object,Function]),nE={Close:Ql},rE={Close:Ql,SuccessFilled:Pz,InfoFilled:tE,WarningFilled:gx,CircleCloseFilled:eE},Qd={success:Pz,warning:gx,error:eE,info:tE},_x={validating:Fu,success:QC,error:Fc},eK=["light","dark"],tK=un({title:{type:String,default:""},description:{type:String,default:""},type:{type:String,values:zm(Qd),default:"info"},closable:{type:Boolean,default:!0},closeText:{type:String,default:""},showIcon:Boolean,center:Boolean,effect:{type:String,values:eK,default:"light"}}),nK={close:e=>e instanceof MouseEvent},rK=We({name:"ElAlert"}),iK=We({...rK,props:tK,emits:nK,setup(e,{emit:t}){const o=e,{Close:a}=rE,d=Bo(),p=Xt("alert"),y=xe(!0),r=ee(()=>Qd[o.type]),S=ee(()=>!!(o.description||d.default)),C=M=>{y.value=!1,t("close",M)};return(M,P)=>(ae(),At(rs,{name:b(p).b("fade"),persisted:""},{default:ot(()=>[hr(Ue("div",{class:fe([b(p).b(),b(p).m(M.type),b(p).is("center",M.center),b(p).is(M.effect)]),role:"alert"},[M.showIcon&&b(r)?(ae(),At(b(zn),{key:0,class:fe([b(p).e("icon"),{[b(p).is("big")]:b(S)}])},{default:ot(()=>[(ae(),At(Ir(b(r))))]),_:1},8,["class"])):bt("v-if",!0),Ue("div",{class:fe(b(p).e("content"))},[M.title||M.$slots.title?(ae(),Pe("span",{key:0,class:fe([b(p).e("title"),{"with-description":b(S)}])},[gt(M.$slots,"title",{},()=>[Nr(fn(M.title),1)])],2)):bt("v-if",!0),b(S)?(ae(),Pe("p",{key:1,class:fe(b(p).e("description"))},[gt(M.$slots,"default",{},()=>[Nr(fn(M.description),1)])],2)):bt("v-if",!0),M.closable?(ae(),Pe(Vn,{key:2},[M.closeText?(ae(),Pe("div",{key:0,class:fe([b(p).e("close-btn"),b(p).is("customed")]),onClick:C},fn(M.closeText),3)):(ae(),At(b(zn),{key:1,class:fe(b(p).e("close-btn")),onClick:C},{default:ot(()=>[qe(b(a))]),_:1},8,["class"]))],64)):bt("v-if",!0)],2)],2),[[ii,y.value]])]),_:3},8,["name"]))}});var oK=dn(iK,[["__file","alert.vue"]]);const sK=lr(oK),yx=()=>Wr&&/firefox/i.test(window.navigator.userAgent);let Vl;const aK=`
  height:0 !important;
  visibility:hidden !important;
  ${yx()?"":"overflow:hidden !important;"}
  position:absolute !important;
  z-index:-1000 !important;
  top:0 !important;
  right:0 !important;
`,lK=["letter-spacing","line-height","padding-top","padding-bottom","font-family","font-weight","font-size","text-rendering","text-transform","width","text-indent","padding-left","padding-right","border-width","box-sizing"];function uK(e){const t=window.getComputedStyle(e),o=t.getPropertyValue("box-sizing"),a=Number.parseFloat(t.getPropertyValue("padding-bottom"))+Number.parseFloat(t.getPropertyValue("padding-top")),d=Number.parseFloat(t.getPropertyValue("border-bottom-width"))+Number.parseFloat(t.getPropertyValue("border-top-width"));return{contextStyle:lK.map(y=>`${y}:${t.getPropertyValue(y)}`).join(";"),paddingSize:a,borderSize:d,boxSizing:o}}function L3(e,t=1,o){var a;Vl||(Vl=document.createElement("textarea"),document.body.appendChild(Vl));const{paddingSize:d,borderSize:p,boxSizing:y,contextStyle:r}=uK(e);Vl.setAttribute("style",`${r};${aK}`),Vl.value=e.value||e.placeholder||"";let S=Vl.scrollHeight;const C={};y==="border-box"?S=S+p:y==="content-box"&&(S=S-d),Vl.value="";const M=Vl.scrollHeight-d;if(Wn(t)){let P=M*t;y==="border-box"&&(P=P+d+p),S=Math.max(P,S),C.minHeight=`${P}px`}if(Wn(o)){let P=M*o;y==="border-box"&&(P=P+d+p),S=Math.min(P,S)}return C.height=`${S}px`,(a=Vl.parentNode)==null||a.removeChild(Vl),Vl=void 0,C}const io=e=>e,cK=un({ariaLabel:String,ariaOrientation:{type:String,values:["horizontal","vertical","undefined"]},ariaControls:String}),cs=e=>Wl(cK,e),iE=un({id:{type:String,default:void 0},size:zo,disabled:Boolean,modelValue:{type:lt([String,Number,Object]),default:""},maxlength:{type:[String,Number]},minlength:{type:[String,Number]},type:{type:String,default:"text"},resize:{type:String,values:["none","both","horizontal","vertical"]},autosize:{type:lt([Boolean,Object]),default:!1},autocomplete:{type:String,default:"off"},formatter:{type:Function},parser:{type:Function},placeholder:{type:String},form:{type:String},readonly:Boolean,clearable:Boolean,showPassword:Boolean,showWordLimit:Boolean,suffixIcon:{type:Ai},prefixIcon:{type:Ai},containerRole:{type:String,default:void 0},tabindex:{type:[String,Number],default:0},validateEvent:{type:Boolean,default:!0},inputStyle:{type:lt([Object,Array,String]),default:()=>io({})},autofocus:Boolean,rows:{type:Number,default:2},...cs(["ariaLabel"])}),dK={[gr]:e=>Nn(e),input:e=>Nn(e),change:e=>Nn(e),focus:e=>e instanceof FocusEvent,blur:e=>e instanceof FocusEvent,clear:()=>!0,mouseleave:e=>e instanceof MouseEvent,mouseenter:e=>e instanceof MouseEvent,keydown:e=>e instanceof Event,compositionstart:e=>e instanceof CompositionEvent,compositionupdate:e=>e instanceof CompositionEvent,compositionend:e=>e instanceof CompositionEvent},fK=["class","style"],hK=/^on[A-Z]/,uv=(e={})=>{const{excludeListeners:t=!1,excludeKeys:o}=e,a=ee(()=>((o==null?void 0:o.value)||[]).concat(fK)),d=Cr();return ee(d?()=>{var p;return Ly(Object.entries((p=d.proxy)==null?void 0:p.$attrs).filter(([y])=>!a.value.includes(y)&&!(t&&hK.test(y))))}:()=>({}))},Rh=Symbol("formContextKey"),Nu=Symbol("formItemContextKey"),D3={prefix:Math.floor(Math.random()*1e4),current:0},pK=Symbol("elIdInjection"),oE=()=>Cr()?Pn(pK,D3):D3,us=e=>{const t=oE(),o=PC();return XS(()=>b(e)||`${o.value}-id-${t.prefix}-${t.current++}`)},xs=()=>{const e=Pn(Rh,void 0),t=Pn(Nu,void 0);return{form:e,formItem:t}},ml=(e,{formItemContext:t,disableIdGeneration:o,disableIdManagement:a})=>{o||(o=xe(!1)),a||(a=xe(!1));const d=xe();let p;const y=ee(()=>{var r;return!!(!(e.label||e.ariaLabel)&&t&&t.inputIds&&((r=t.inputIds)==null?void 0:r.length)<=1)});return yr(()=>{p=Wt([hi(e,"id"),o],([r,S])=>{const C=r??(S?void 0:us().value);C!==d.value&&(t!=null&&t.removeInputId&&(d.value&&t.removeInputId(d.value),!(a!=null&&a.value)&&!S&&C&&t.addInputId(C)),d.value=C)},{immediate:!0})}),rf(()=>{p&&p(),t!=null&&t.removeInputId&&d.value&&t.removeInputId(d.value)}),{isLabeledByFormItem:y,inputId:d}},Oz=e=>{const t=Cr();return ee(()=>{var o,a;return(a=(o=t==null?void 0:t.proxy)==null?void 0:o.$props)==null?void 0:a[e]})},Ro=(e,t={})=>{const o=xe(void 0),a=t.prop?o:Oz("size"),d=t.global?o:bz(),p=t.form?{size:void 0}:Pn(Rh,void 0),y=t.formItem?{size:void 0}:Pn(Nu,void 0);return ee(()=>a.value||b(e)||(y==null?void 0:y.size)||(p==null?void 0:p.size)||d.value||"")},ws=e=>{const t=Oz("disabled"),o=Pn(Rh,void 0);return ee(()=>t.value||b(e)||(o==null?void 0:o.disabled)||!1)};function af(e,{beforeFocus:t,afterFocus:o,beforeBlur:a,afterBlur:d}={}){const p=Cr(),{emit:y}=p,r=Hi(),S=xe(!1),C=z=>{$n(t)&&t(z)||S.value||(S.value=!0,y("focus",z),o==null||o())},M=z=>{var F;$n(a)&&a(z)||z.relatedTarget&&((F=r.value)!=null&&F.contains(z.relatedTarget))||(S.value=!1,y("blur",z),d==null||d())},P=()=>{var z,F;(z=r.value)!=null&&z.contains(document.activeElement)&&r.value!==document.activeElement||(F=e.value)==null||F.focus()};return Wt(r,z=>{z&&z.setAttribute("tabindex","-1")}),Si(r,"focus",C,!0),Si(r,"blur",M,!0),Si(r,"click",P,!0),{isFocused:S,wrapperRef:r,handleFocus:C,handleBlur:M}}const mK=e=>/([\uAC00-\uD7AF\u3130-\u318F])+/gi.test(e);function cv({afterComposition:e,emit:t}){const o=xe(!1),a=r=>{t==null||t("compositionstart",r),o.value=!0},d=r=>{var S;t==null||t("compositionupdate",r);const C=(S=r.target)==null?void 0:S.value,M=C[C.length-1]||"";o.value=!mK(M)},p=r=>{t==null||t("compositionend",r),o.value&&(o.value=!1,jn(()=>e(r)))};return{isComposing:o,handleComposition:r=>{r.type==="compositionend"?p(r):d(r)},handleCompositionStart:a,handleCompositionUpdate:d,handleCompositionEnd:p}}function gK(e){let t;function o(){if(e.value==null)return;const{selectionStart:d,selectionEnd:p,value:y}=e.value;if(d==null||p==null)return;const r=y.slice(0,Math.max(0,d)),S=y.slice(Math.max(0,p));t={selectionStart:d,selectionEnd:p,value:y,beforeTxt:r,afterTxt:S}}function a(){if(e.value==null||t==null)return;const{value:d}=e.value,{beforeTxt:p,afterTxt:y,selectionStart:r}=t;if(p==null||y==null||r==null)return;let S=d.length;if(d.endsWith(y))S=d.length-y.length;else if(d.startsWith(p))S=p.length;else{const C=p[r-1],M=d.indexOf(C,r-1);M!==-1&&(S=M+1)}e.value.setSelectionRange(S,S)}return[o,a]}const _K=We({name:"ElInput",inheritAttrs:!1}),yK=We({..._K,props:iE,emits:dK,setup(e,{expose:t,emit:o}){const a=e,d=of(),p=uv(),y=Bo(),r=ee(()=>[a.type==="textarea"?N.b():V.b(),V.m(z.value),V.is("disabled",F.value),V.is("exceed",rt.value),{[V.b("group")]:y.prepend||y.append,[V.m("prefix")]:y.prefix||a.prefixIcon,[V.m("suffix")]:y.suffix||a.suffixIcon||a.clearable||a.showPassword,[V.bm("suffix","password-clear")]:we.value&&me.value,[V.b("hidden")]:a.type==="hidden"},d.class]),S=ee(()=>[V.e("wrapper"),V.is("focus",he.value)]),{form:C,formItem:M}=xs(),{inputId:P}=ml(a,{formItemContext:M}),z=Ro(),F=ws(),V=Xt("input"),N=Xt("textarea"),H=Hi(),U=Hi(),te=xe(!1),Z=xe(!1),q=xe(),J=Hi(a.inputStyle),re=ee(()=>H.value||U.value),{wrapperRef:se,isFocused:he,handleFocus:le,handleBlur:ce}=af(re,{beforeFocus(){return F.value},afterBlur(){var Et;a.validateEvent&&((Et=M==null?void 0:M.validate)==null||Et.call(M,"blur").catch(En=>void 0))}}),pe=ee(()=>{var Et;return(Et=C==null?void 0:C.statusIcon)!=null?Et:!1}),de=ee(()=>(M==null?void 0:M.validateState)||""),Ie=ee(()=>de.value&&_x[de.value]),Ve=ee(()=>Z.value?Z7:v7),be=ee(()=>[d.style]),ye=ee(()=>[a.inputStyle,J.value,{resize:a.resize}]),Me=ee(()=>Ho(a.modelValue)?"":String(a.modelValue)),we=ee(()=>a.clearable&&!F.value&&!a.readonly&&!!Me.value&&(he.value||te.value)),me=ee(()=>a.showPassword&&!F.value&&!!Me.value&&(!!Me.value||he.value)),De=ee(()=>a.showWordLimit&&!!a.maxlength&&(a.type==="text"||a.type==="textarea")&&!F.value&&!a.readonly&&!a.showPassword),Ge=ee(()=>Me.value.length),rt=ee(()=>!!De.value&&Ge.value>Number(a.maxlength)),Oe=ee(()=>!!y.suffix||!!a.suffixIcon||we.value||a.showPassword||De.value||!!de.value&&pe.value),[Ct,kt]=gK(H);ro(U,Et=>{if(jt(),!De.value||a.resize!=="both")return;const En=Et[0],{width:Xn}=En.contentRect;q.value={right:`calc(100% - ${Xn+15+6}px)`}});const Bt=()=>{const{type:Et,autosize:En}=a;if(!(!Wr||Et!=="textarea"||!U.value))if(En){const Xn=xr(En)?En.minRows:void 0,vr=xr(En)?En.maxRows:void 0,er=L3(U.value,Xn,vr);J.value={overflowY:"hidden",...er},jn(()=>{U.value.offsetHeight,J.value=er})}else J.value={minHeight:L3(U.value).minHeight}},jt=(Et=>{let En=!1;return()=>{var Xn;if(En||!a.autosize)return;((Xn=U.value)==null?void 0:Xn.offsetParent)===null||(Et(),En=!0)}})(Bt),Gt=()=>{const Et=re.value,En=a.formatter?a.formatter(Me.value):Me.value;!Et||Et.value===En||(Et.value=En)},Ne=async Et=>{Ct();let{value:En}=Et.target;if(a.formatter&&(En=a.parser?a.parser(En):En),!Ae.value){if(En===Me.value){Gt();return}o(gr,En),o("input",En),await jn(),Gt(),kt()}},an=Et=>{o("change",Et.target.value)},{isComposing:Ae,handleCompositionStart:tt,handleCompositionUpdate:Je,handleCompositionEnd:Jt}=cv({emit:o,afterComposition:Ne}),Kt=()=>{Ct(),Z.value=!Z.value,setTimeout(kt)},Nt=()=>{var Et;return(Et=re.value)==null?void 0:Et.focus()},Pt=()=>{var Et;return(Et=re.value)==null?void 0:Et.blur()},Dt=Et=>{te.value=!1,o("mouseleave",Et)},rn=Et=>{te.value=!0,o("mouseenter",Et)},on=Et=>{o("keydown",Et)},Ln=()=>{var Et;(Et=re.value)==null||Et.select()},yn=()=>{o(gr,""),o("change",""),o("clear"),o("input","")};return Wt(()=>a.modelValue,()=>{var Et;jn(()=>Bt()),a.validateEvent&&((Et=M==null?void 0:M.validate)==null||Et.call(M,"change").catch(En=>void 0))}),Wt(Me,()=>Gt()),Wt(()=>a.type,async()=>{await jn(),Gt(),Bt()}),yr(()=>{!a.formatter&&a.parser,Gt(),jn(Bt)}),t({input:H,textarea:U,ref:re,textareaStyle:ye,autosize:hi(a,"autosize"),isComposing:Ae,focus:Nt,blur:Pt,select:Ln,clear:yn,resizeTextarea:Bt}),(Et,En)=>(ae(),Pe("div",{class:fe([b(r),{[b(V).bm("group","append")]:Et.$slots.append,[b(V).bm("group","prepend")]:Et.$slots.prepend}]),style:Un(b(be)),onMouseenter:rn,onMouseleave:Dt},[bt(" input "),Et.type!=="textarea"?(ae(),Pe(Vn,{key:0},[bt(" prepend slot "),Et.$slots.prepend?(ae(),Pe("div",{key:0,class:fe(b(V).be("group","prepend"))},[gt(Et.$slots,"prepend")],2)):bt("v-if",!0),Ue("div",{ref_key:"wrapperRef",ref:se,class:fe(b(S))},[bt(" prefix slot "),Et.$slots.prefix||Et.prefixIcon?(ae(),Pe("span",{key:0,class:fe(b(V).e("prefix"))},[Ue("span",{class:fe(b(V).e("prefix-inner"))},[gt(Et.$slots,"prefix"),Et.prefixIcon?(ae(),At(b(zn),{key:0,class:fe(b(V).e("icon"))},{default:ot(()=>[(ae(),At(Ir(Et.prefixIcon)))]),_:1},8,["class"])):bt("v-if",!0)],2)],2)):bt("v-if",!0),Ue("input",kr({id:b(P),ref_key:"input",ref:H,class:b(V).e("inner")},b(p),{minlength:Et.minlength,maxlength:Et.maxlength,type:Et.showPassword?Z.value?"text":"password":Et.type,disabled:b(F),readonly:Et.readonly,autocomplete:Et.autocomplete,tabindex:Et.tabindex,"aria-label":Et.ariaLabel,placeholder:Et.placeholder,style:Et.inputStyle,form:Et.form,autofocus:Et.autofocus,role:Et.containerRole,onCompositionstart:b(tt),onCompositionupdate:b(Je),onCompositionend:b(Jt),onInput:Ne,onChange:an,onKeydown:on}),null,16,["id","minlength","maxlength","type","disabled","readonly","autocomplete","tabindex","aria-label","placeholder","form","autofocus","role","onCompositionstart","onCompositionupdate","onCompositionend"]),bt(" suffix slot "),b(Oe)?(ae(),Pe("span",{key:1,class:fe(b(V).e("suffix"))},[Ue("span",{class:fe(b(V).e("suffix-inner"))},[!b(we)||!b(me)||!b(De)?(ae(),Pe(Vn,{key:0},[gt(Et.$slots,"suffix"),Et.suffixIcon?(ae(),At(b(zn),{key:0,class:fe(b(V).e("icon"))},{default:ot(()=>[(ae(),At(Ir(Et.suffixIcon)))]),_:1},8,["class"])):bt("v-if",!0)],64)):bt("v-if",!0),b(we)?(ae(),At(b(zn),{key:1,class:fe([b(V).e("icon"),b(V).e("clear")]),onMousedown:Jn(b(vi),["prevent"]),onClick:yn},{default:ot(()=>[qe(b(Fc))]),_:1},8,["class","onMousedown"])):bt("v-if",!0),b(me)?(ae(),At(b(zn),{key:2,class:fe([b(V).e("icon"),b(V).e("password")]),onClick:Kt},{default:ot(()=>[(ae(),At(Ir(b(Ve))))]),_:1},8,["class"])):bt("v-if",!0),b(De)?(ae(),Pe("span",{key:3,class:fe(b(V).e("count"))},[Ue("span",{class:fe(b(V).e("count-inner"))},fn(b(Ge))+" / "+fn(Et.maxlength),3)],2)):bt("v-if",!0),b(de)&&b(Ie)&&b(pe)?(ae(),At(b(zn),{key:4,class:fe([b(V).e("icon"),b(V).e("validateIcon"),b(V).is("loading",b(de)==="validating")])},{default:ot(()=>[(ae(),At(Ir(b(Ie))))]),_:1},8,["class"])):bt("v-if",!0)],2)],2)):bt("v-if",!0)],2),bt(" append slot "),Et.$slots.append?(ae(),Pe("div",{key:1,class:fe(b(V).be("group","append"))},[gt(Et.$slots,"append")],2)):bt("v-if",!0)],64)):(ae(),Pe(Vn,{key:1},[bt(" textarea "),Ue("textarea",kr({id:b(P),ref_key:"textarea",ref:U,class:[b(N).e("inner"),b(V).is("focus",b(he))]},b(p),{minlength:Et.minlength,maxlength:Et.maxlength,tabindex:Et.tabindex,disabled:b(F),readonly:Et.readonly,autocomplete:Et.autocomplete,style:b(ye),"aria-label":Et.ariaLabel,placeholder:Et.placeholder,form:Et.form,autofocus:Et.autofocus,rows:Et.rows,role:Et.containerRole,onCompositionstart:b(tt),onCompositionupdate:b(Je),onCompositionend:b(Jt),onInput:Ne,onFocus:b(le),onBlur:b(ce),onChange:an,onKeydown:on}),null,16,["id","minlength","maxlength","tabindex","disabled","readonly","autocomplete","aria-label","placeholder","form","autofocus","rows","role","onCompositionstart","onCompositionupdate","onCompositionend","onFocus","onBlur"]),b(De)?(ae(),Pe("span",{key:0,style:Un(q.value),class:fe(b(V).e("count"))},fn(b(Ge))+" / "+fn(Et.maxlength),7)):bt("v-if",!0)],64))],38))}});var vK=dn(yK,[["__file","input.vue"]]);const Bs=lr(vK),sm=4,Lz={vertical:{offset:"offsetHeight",scroll:"scrollTop",scrollSize:"scrollHeight",size:"height",key:"vertical",axis:"Y",client:"clientY",direction:"top"},horizontal:{offset:"offsetWidth",scroll:"scrollLeft",scrollSize:"scrollWidth",size:"width",key:"horizontal",axis:"X",client:"clientX",direction:"left"}},bK=({move:e,size:t,bar:o})=>({[o.size]:t,transform:`translate${o.axis}(${e}%)`}),sE=Symbol("scrollbarContextKey"),xK=un({vertical:Boolean,size:String,move:Number,ratio:{type:Number,required:!0},always:Boolean}),wK="Thumb",SK=We({__name:"thumb",props:xK,setup(e){const t=e,o=Pn(sE),a=Xt("scrollbar");o||No(wK,"can not inject scrollbar context");const d=xe(),p=xe(),y=xe({}),r=xe(!1);let S=!1,C=!1,M=Wr?document.onselectstart:null;const P=ee(()=>Lz[t.vertical?"vertical":"horizontal"]),z=ee(()=>bK({size:t.size,move:t.move,bar:P.value})),F=ee(()=>d.value[P.value.offset]**2/o.wrapElement[P.value.scrollSize]/t.ratio/p.value[P.value.offset]),V=re=>{var se;if(re.stopPropagation(),re.ctrlKey||[1,2].includes(re.button))return;(se=window.getSelection())==null||se.removeAllRanges(),H(re);const he=re.currentTarget;he&&(y.value[P.value.axis]=he[P.value.offset]-(re[P.value.client]-he.getBoundingClientRect()[P.value.direction]))},N=re=>{if(!p.value||!d.value||!o.wrapElement)return;const se=Math.abs(re.target.getBoundingClientRect()[P.value.direction]-re[P.value.client]),he=p.value[P.value.offset]/2,le=(se-he)*100*F.value/d.value[P.value.offset];o.wrapElement[P.value.scroll]=le*o.wrapElement[P.value.scrollSize]/100},H=re=>{re.stopImmediatePropagation(),S=!0,document.addEventListener("mousemove",U),document.addEventListener("mouseup",te),M=document.onselectstart,document.onselectstart=()=>!1},U=re=>{if(!d.value||!p.value||S===!1)return;const se=y.value[P.value.axis];if(!se)return;const he=(d.value.getBoundingClientRect()[P.value.direction]-re[P.value.client])*-1,le=p.value[P.value.offset]-se,ce=(he-le)*100*F.value/d.value[P.value.offset];o.wrapElement[P.value.scroll]=ce*o.wrapElement[P.value.scrollSize]/100},te=()=>{S=!1,y.value[P.value.axis]=0,document.removeEventListener("mousemove",U),document.removeEventListener("mouseup",te),J(),C&&(r.value=!1)},Z=()=>{C=!1,r.value=!!t.size},q=()=>{C=!0,r.value=S};Li(()=>{J(),document.removeEventListener("mouseup",te)});const J=()=>{document.onselectstart!==M&&(document.onselectstart=M)};return Si(hi(o,"scrollbarElement"),"mousemove",Z),Si(hi(o,"scrollbarElement"),"mouseleave",q),(re,se)=>(ae(),At(rs,{name:b(a).b("fade"),persisted:""},{default:ot(()=>[hr(Ue("div",{ref_key:"instance",ref:d,class:fe([b(a).e("bar"),b(a).is(b(P).key)]),onMousedown:N},[Ue("div",{ref_key:"thumb",ref:p,class:fe(b(a).e("thumb")),style:Un(b(z)),onMousedown:V},null,38)],34),[[ii,re.always||r.value]])]),_:1},8,["name"]))}});var z3=dn(SK,[["__file","thumb.vue"]]);const TK=un({always:{type:Boolean,default:!0},minSize:{type:Number,required:!0}}),CK=We({__name:"bar",props:TK,setup(e,{expose:t}){const o=e,a=Pn(sE),d=xe(0),p=xe(0),y=xe(""),r=xe(""),S=xe(1),C=xe(1);return t({handleScroll:z=>{if(z){const F=z.offsetHeight-sm,V=z.offsetWidth-sm;p.value=z.scrollTop*100/F*S.value,d.value=z.scrollLeft*100/V*C.value}},update:()=>{const z=a==null?void 0:a.wrapElement;if(!z)return;const F=z.offsetHeight-sm,V=z.offsetWidth-sm,N=F**2/z.scrollHeight,H=V**2/z.scrollWidth,U=Math.max(N,o.minSize),te=Math.max(H,o.minSize);S.value=N/(F-N)/(U/(F-U)),C.value=H/(V-H)/(te/(V-te)),r.value=U+sm<F?`${U}px`:"",y.value=te+sm<V?`${te}px`:""}}),(z,F)=>(ae(),Pe(Vn,null,[qe(z3,{move:d.value,ratio:C.value,size:y.value,always:z.always},null,8,["move","ratio","size","always"]),qe(z3,{move:p.value,ratio:S.value,size:r.value,vertical:"",always:z.always},null,8,["move","ratio","size","always"])],64))}});var EK=dn(CK,[["__file","bar.vue"]]);const MK=un({height:{type:[String,Number],default:""},maxHeight:{type:[String,Number],default:""},native:{type:Boolean,default:!1},wrapStyle:{type:lt([String,Object,Array]),default:""},wrapClass:{type:[String,Array],default:""},viewClass:{type:[String,Array],default:""},viewStyle:{type:[String,Array,Object],default:""},noresize:Boolean,tag:{type:String,default:"div"},always:Boolean,minSize:{type:Number,default:20},tabindex:{type:[String,Number],default:void 0},id:String,role:String,...cs(["ariaLabel","ariaOrientation"])}),IK={scroll:({scrollTop:e,scrollLeft:t})=>[e,t].every(Wn)},AK="ElScrollbar",kK=We({name:AK}),PK=We({...kK,props:MK,emits:IK,setup(e,{expose:t,emit:o}){const a=e,d=Xt("scrollbar");let p,y,r=0,S=0;const C=xe(),M=xe(),P=xe(),z=xe(),F=ee(()=>{const J={};return a.height&&(J.height=_o(a.height)),a.maxHeight&&(J.maxHeight=_o(a.maxHeight)),[a.wrapStyle,J]}),V=ee(()=>[a.wrapClass,d.e("wrap"),{[d.em("wrap","hidden-default")]:!a.native}]),N=ee(()=>[d.e("view"),a.viewClass]),H=()=>{var J;M.value&&((J=z.value)==null||J.handleScroll(M.value),r=M.value.scrollTop,S=M.value.scrollLeft,o("scroll",{scrollTop:M.value.scrollTop,scrollLeft:M.value.scrollLeft}))};function U(J,re){xr(J)?M.value.scrollTo(J):Wn(J)&&Wn(re)&&M.value.scrollTo(J,re)}const te=J=>{Wn(J)&&(M.value.scrollTop=J)},Z=J=>{Wn(J)&&(M.value.scrollLeft=J)},q=()=>{var J;(J=z.value)==null||J.update()};return Wt(()=>a.noresize,J=>{J?(p==null||p(),y==null||y()):({stop:p}=ro(P,q),y=Si("resize",q))},{immediate:!0}),Wt(()=>[a.maxHeight,a.height],()=>{a.native||jn(()=>{var J;q(),M.value&&((J=z.value)==null||J.handleScroll(M.value))})}),Vr(sE,si({scrollbarElement:C,wrapElement:M})),TC(()=>{M.value&&(M.value.scrollTop=r,M.value.scrollLeft=S)}),yr(()=>{a.native||jn(()=>{q()})}),Uu(()=>q()),t({wrapRef:M,update:q,scrollTo:U,setScrollTop:te,setScrollLeft:Z,handleScroll:H}),(J,re)=>(ae(),Pe("div",{ref_key:"scrollbarRef",ref:C,class:fe(b(d).b())},[Ue("div",{ref_key:"wrapRef",ref:M,class:fe(b(V)),style:Un(b(F)),tabindex:J.tabindex,onScroll:H},[(ae(),At(Ir(J.tag),{id:J.id,ref_key:"resizeRef",ref:P,class:fe(b(N)),style:Un(J.viewStyle),role:J.role,"aria-label":J.ariaLabel,"aria-orientation":J.ariaOrientation},{default:ot(()=>[gt(J.$slots,"default")]),_:3},8,["id","class","style","role","aria-label","aria-orientation"]))],46,["tabindex"]),J.native?bt("v-if",!0):(ae(),At(EK,{key:0,ref_key:"barRef",ref:z,always:J.always,"min-size":J.minSize},null,8,["always","min-size"]))],2))}});var RK=dn(PK,[["__file","scrollbar.vue"]]);const Hu=lr(RK),aE=Symbol("popper"),Dz=Symbol("popperContent"),OK=["dialog","grid","group","listbox","menu","navigation","tooltip","tree"],zz=un({role:{type:String,values:OK,default:"tooltip"}}),LK=We({name:"ElPopper",inheritAttrs:!1}),DK=We({...LK,props:zz,setup(e,{expose:t}){const o=e,a=xe(),d=xe(),p=xe(),y=xe(),r=ee(()=>o.role),S={triggerRef:a,popperInstanceRef:d,contentRef:p,referenceRef:y,role:r};return t(S),Vr(aE,S),(C,M)=>gt(C.$slots,"default")}});var zK=dn(DK,[["__file","popper.vue"]]);const Fz=un({arrowOffset:{type:Number,default:5}}),FK=We({name:"ElPopperArrow",inheritAttrs:!1}),NK=We({...FK,props:Fz,setup(e,{expose:t}){const o=e,a=Xt("popper"),{arrowOffset:d,arrowRef:p,arrowStyle:y}=Pn(Dz,void 0);return Wt(()=>o.arrowOffset,r=>{d.value=r}),Li(()=>{p.value=void 0}),t({arrowRef:p}),(r,S)=>(ae(),Pe("span",{ref_key:"arrowRef",ref:p,class:fe(b(a).e("arrow")),style:Un(b(y)),"data-popper-arrow":""},null,6))}});var BK=dn(NK,[["__file","arrow.vue"]]);const Nz=un({virtualRef:{type:lt(Object)},virtualTriggering:Boolean,onMouseenter:{type:lt(Function)},onMouseleave:{type:lt(Function)},onClick:{type:lt(Function)},onKeydown:{type:lt(Function)},onFocus:{type:lt(Function)},onBlur:{type:lt(Function)},onContextmenu:{type:lt(Function)},id:String,open:Boolean}),Bz=Symbol("elForwardRef"),VK=e=>{Vr(Bz,{setForwardRef:o=>{e.value=o}})},$K=e=>({mounted(t){e(t)},updated(t){e(t)},unmounted(){e(null)}}),UK='a[href],button:not([disabled]),button:not([hidden]),:not([tabindex="-1"]),input:not([disabled]),input:not([type="hidden"]),select:not([disabled]),textarea:not([disabled])',jK=e=>getComputedStyle(e).position==="fixed"?!1:e.offsetParent!==null,F3=e=>Array.from(e.querySelectorAll(UK)).filter(t=>T1(t)&&jK(t)),T1=e=>{if(e.tabIndex>0||e.tabIndex===0&&e.getAttribute("tabIndex")!==null)return!0;if(e.tabIndex<0||e.hasAttribute("disabled")||e.getAttribute("aria-disabled")==="true")return!1;switch(e.nodeName){case"A":return!!e.href&&e.rel!=="ignore";case"INPUT":return!(e.type==="hidden"||e.type==="file");case"BUTTON":case"SELECT":case"TEXTAREA":return!0;default:return!1}},qb=function(e,t,...o){let a;t.includes("mouse")||t.includes("click")?a="MouseEvents":t.includes("key")?a="KeyboardEvent":a="HTMLEvents";const d=document.createEvent(a);return d.initEvent(t,...o),e.dispatchEvent(d),e},Vz=e=>!e.getAttribute("aria-owns"),$z=(e,t,o)=>{const{parentNode:a}=e;if(!a)return null;const d=a.querySelectorAll(o),p=Array.prototype.indexOf.call(d,e);return d[p+t]||null},Kb=e=>{e&&(e.focus(),!Vz(e)&&e.click())},HK="ElOnlyChild",Uz=We({name:HK,setup(e,{slots:t,attrs:o}){var a;const d=Pn(Bz),p=$K((a=d==null?void 0:d.setForwardRef)!=null?a:vi);return()=>{var y;const r=(y=t.default)==null?void 0:y.call(t,o);if(!r||r.length>1)return null;const S=jz(r);return S?hr(Ic(S,o),[[p]]):null}}});function jz(e){if(!e)return null;const t=e;for(const o of t){if(xr(o))switch(o.type){case Qo:continue;case eg:case"svg":return N3(o);case Vn:return jz(o.children);default:return o}return N3(o)}return null}function N3(e){const t=Xt("only-child");return qe("span",{class:t.e("content")},[e])}const GK=We({name:"ElPopperTrigger",inheritAttrs:!1}),WK=We({...GK,props:Nz,setup(e,{expose:t}){const o=e,{role:a,triggerRef:d}=Pn(aE,void 0);VK(d);const p=ee(()=>r.value?o.id:void 0),y=ee(()=>{if(a&&a.value==="tooltip")return o.open&&o.id?o.id:void 0}),r=ee(()=>{if(a&&a.value!=="tooltip")return a.value}),S=ee(()=>r.value?`${o.open}`:void 0);let C;const M=["onMouseenter","onMouseleave","onClick","onKeydown","onFocus","onBlur","onContextmenu"];return yr(()=>{Wt(()=>o.virtualRef,P=>{P&&(d.value=Qs(P))},{immediate:!0}),Wt(d,(P,z)=>{C==null||C(),C=void 0,ea(P)&&(M.forEach(F=>{var V;const N=o[F];N&&(P.addEventListener(F.slice(2).toLowerCase(),N),(V=z==null?void 0:z.removeEventListener)==null||V.call(z,F.slice(2).toLowerCase(),N))}),T1(P)&&(C=Wt([p,y,r,S],F=>{["aria-controls","aria-describedby","aria-haspopup","aria-expanded"].forEach((V,N)=>{Ho(F[N])?P.removeAttribute(V):P.setAttribute(V,F[N])})},{immediate:!0}))),ea(z)&&T1(z)&&["aria-controls","aria-describedby","aria-haspopup","aria-expanded"].forEach(F=>z.removeAttribute(F))},{immediate:!0})}),Li(()=>{if(C==null||C(),C=void 0,d.value&&ea(d.value)){const P=d.value;M.forEach(z=>{const F=o[z];F&&P.removeEventListener(z.slice(2).toLowerCase(),F)}),d.value=void 0}}),t({triggerRef:d}),(P,z)=>P.virtualTriggering?bt("v-if",!0):(ae(),At(b(Uz),kr({key:0},P.$attrs,{"aria-controls":b(p),"aria-describedby":b(y),"aria-expanded":b(S),"aria-haspopup":b(r)}),{default:ot(()=>[gt(P.$slots,"default")]),_:3},16,["aria-controls","aria-describedby","aria-expanded","aria-haspopup"]))}});var qK=dn(WK,[["__file","trigger.vue"]]);const tS="focus-trap.focus-after-trapped",nS="focus-trap.focus-after-released",KK="focus-trap.focusout-prevented",B3={cancelable:!0,bubbles:!1},ZK={cancelable:!0,bubbles:!1},V3="focusAfterTrapped",$3="focusAfterReleased",lE=Symbol("elFocusTrap"),uE=xe(),vx=xe(0),cE=xe(0);let Sb=0;const Hz=e=>{const t=[],o=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:a=>{const d=a.tagName==="INPUT"&&a.type==="hidden";return a.disabled||a.hidden||d?NodeFilter.FILTER_SKIP:a.tabIndex>=0||a===document.activeElement?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;o.nextNode();)t.push(o.currentNode);return t},U3=(e,t)=>{for(const o of e)if(!YK(o,t))return o},YK=(e,t)=>{if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(t&&e===t)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1},XK=e=>{const t=Hz(e),o=U3(t,e),a=U3(t.reverse(),e);return[o,a]},JK=e=>e instanceof HTMLInputElement&&"select"in e,bc=(e,t)=>{if(e&&e.focus){const o=document.activeElement;let a=!1;ea(e)&&!T1(e)&&!e.getAttribute("tabindex")&&(e.setAttribute("tabindex","-1"),a=!0),e.focus({preventScroll:!0}),cE.value=window.performance.now(),e!==o&&JK(e)&&t&&e.select(),ea(e)&&a&&e.removeAttribute("tabindex")}};function j3(e,t){const o=[...e],a=e.indexOf(t);return a!==-1&&o.splice(a,1),o}const QK=()=>{let e=[];return{push:a=>{const d=e[0];d&&a!==d&&d.pause(),e=j3(e,a),e.unshift(a)},remove:a=>{var d,p;e=j3(e,a),(p=(d=e[0])==null?void 0:d.resume)==null||p.call(d)}}},eZ=(e,t=!1)=>{const o=document.activeElement;for(const a of e)if(bc(a,t),document.activeElement!==o)return},H3=QK(),tZ=()=>vx.value>cE.value,Tb=()=>{uE.value="pointer",vx.value=window.performance.now()},G3=()=>{uE.value="keyboard",vx.value=window.performance.now()},nZ=()=>(yr(()=>{Sb===0&&(document.addEventListener("mousedown",Tb),document.addEventListener("touchstart",Tb),document.addEventListener("keydown",G3)),Sb++}),Li(()=>{Sb--,Sb<=0&&(document.removeEventListener("mousedown",Tb),document.removeEventListener("touchstart",Tb),document.removeEventListener("keydown",G3))}),{focusReason:uE,lastUserFocusTimestamp:vx,lastAutomatedFocusTimestamp:cE}),Cb=e=>new CustomEvent(KK,{...ZK,detail:e}),Cn={tab:"Tab",enter:"Enter",space:"Space",left:"ArrowLeft",up:"ArrowUp",right:"ArrowRight",down:"ArrowDown",esc:"Escape",delete:"Delete",backspace:"Backspace",numpadEnter:"NumpadEnter",pageUp:"PageUp",pageDown:"PageDown",home:"Home",end:"End"};let hm=[];const W3=e=>{e.code===Cn.esc&&hm.forEach(t=>t(e))},rZ=e=>{yr(()=>{hm.length===0&&document.addEventListener("keydown",W3),Wr&&hm.push(e)}),Li(()=>{hm=hm.filter(t=>t!==e),hm.length===0&&Wr&&document.removeEventListener("keydown",W3)})},iZ=We({name:"ElFocusTrap",inheritAttrs:!1,props:{loop:Boolean,trapped:Boolean,focusTrapEl:Object,focusStartEl:{type:[Object,String],default:"first"}},emits:[V3,$3,"focusin","focusout","focusout-prevented","release-requested"],setup(e,{emit:t}){const o=xe();let a,d;const{focusReason:p}=nZ();rZ(V=>{e.trapped&&!y.paused&&t("release-requested",V)});const y={paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}},r=V=>{if(!e.loop&&!e.trapped||y.paused)return;const{code:N,altKey:H,ctrlKey:U,metaKey:te,currentTarget:Z,shiftKey:q}=V,{loop:J}=e,re=N===Cn.tab&&!H&&!U&&!te,se=document.activeElement;if(re&&se){const he=Z,[le,ce]=XK(he);if(le&&ce){if(!q&&se===ce){const de=Cb({focusReason:p.value});t("focusout-prevented",de),de.defaultPrevented||(V.preventDefault(),J&&bc(le,!0))}else if(q&&[le,he].includes(se)){const de=Cb({focusReason:p.value});t("focusout-prevented",de),de.defaultPrevented||(V.preventDefault(),J&&bc(ce,!0))}}else if(se===he){const de=Cb({focusReason:p.value});t("focusout-prevented",de),de.defaultPrevented||V.preventDefault()}}};Vr(lE,{focusTrapRef:o,onKeydown:r}),Wt(()=>e.focusTrapEl,V=>{V&&(o.value=V)},{immediate:!0}),Wt([o],([V],[N])=>{V&&(V.addEventListener("keydown",r),V.addEventListener("focusin",M),V.addEventListener("focusout",P)),N&&(N.removeEventListener("keydown",r),N.removeEventListener("focusin",M),N.removeEventListener("focusout",P))});const S=V=>{t(V3,V)},C=V=>t($3,V),M=V=>{const N=b(o);if(!N)return;const H=V.target,U=V.relatedTarget,te=H&&N.contains(H);e.trapped||U&&N.contains(U)||(a=U),te&&t("focusin",V),!y.paused&&e.trapped&&(te?d=H:bc(d,!0))},P=V=>{const N=b(o);if(!(y.paused||!N))if(e.trapped){const H=V.relatedTarget;!Ho(H)&&!N.contains(H)&&setTimeout(()=>{if(!y.paused&&e.trapped){const U=Cb({focusReason:p.value});t("focusout-prevented",U),U.defaultPrevented||bc(d,!0)}},0)}else{const H=V.target;H&&N.contains(H)||t("focusout",V)}};async function z(){await jn();const V=b(o);if(V){H3.push(y);const N=V.contains(document.activeElement)?a:document.activeElement;if(a=N,!V.contains(N)){const U=new Event(tS,B3);V.addEventListener(tS,S),V.dispatchEvent(U),U.defaultPrevented||jn(()=>{let te=e.focusStartEl;Nn(te)||(bc(te),document.activeElement!==te&&(te="first")),te==="first"&&eZ(Hz(V),!0),(document.activeElement===N||te==="container")&&bc(V)})}}}function F(){const V=b(o);if(V){V.removeEventListener(tS,S);const N=new CustomEvent(nS,{...B3,detail:{focusReason:p.value}});V.addEventListener(nS,C),V.dispatchEvent(N),!N.defaultPrevented&&(p.value=="keyboard"||!tZ()||V.contains(document.activeElement))&&bc(a??document.body),V.removeEventListener(nS,C),H3.remove(y)}}return yr(()=>{e.trapped&&z(),Wt(()=>e.trapped,V=>{V?z():F()})}),Li(()=>{e.trapped&&F(),o.value&&(o.value.removeEventListener("keydown",r),o.value.removeEventListener("focusin",M),o.value.removeEventListener("focusout",P),o.value=void 0)}),{onKeydown:r}}});function oZ(e,t,o,a,d,p){return gt(e.$slots,"default",{handleKeydown:e.onKeydown})}var ag=dn(iZ,[["render",oZ],["__file","focus-trap.vue"]]),Sa="top",fl="bottom",hl="right",Ta="left",dE="auto",dv=[Sa,fl,hl,Ta],Fm="start",Dy="end",sZ="clippingParents",Gz="viewport",Y_="popper",aZ="reference",q3=dv.reduce(function(e,t){return e.concat([t+"-"+Fm,t+"-"+Dy])},[]),Nc=[].concat(dv,[dE]).reduce(function(e,t){return e.concat([t,t+"-"+Fm,t+"-"+Dy])},[]),lZ="beforeRead",uZ="read",cZ="afterRead",dZ="beforeMain",fZ="main",hZ="afterMain",pZ="beforeWrite",mZ="write",gZ="afterWrite",_Z=[lZ,uZ,cZ,dZ,fZ,hZ,pZ,mZ,gZ];function Bu(e){return e?(e.nodeName||"").toLowerCase():null}function au(e){if(e==null)return window;if(e.toString()!=="[object Window]"){var t=e.ownerDocument;return t&&t.defaultView||window}return e}function Nm(e){var t=au(e).Element;return e instanceof t||e instanceof Element}function ll(e){var t=au(e).HTMLElement;return e instanceof t||e instanceof HTMLElement}function fE(e){if(typeof ShadowRoot>"u")return!1;var t=au(e).ShadowRoot;return e instanceof t||e instanceof ShadowRoot}function yZ(e){var t=e.state;Object.keys(t.elements).forEach(function(o){var a=t.styles[o]||{},d=t.attributes[o]||{},p=t.elements[o];!ll(p)||!Bu(p)||(Object.assign(p.style,a),Object.keys(d).forEach(function(y){var r=d[y];r===!1?p.removeAttribute(y):p.setAttribute(y,r===!0?"":r)}))})}function vZ(e){var t=e.state,o={popper:{position:t.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(t.elements.popper.style,o.popper),t.styles=o,t.elements.arrow&&Object.assign(t.elements.arrow.style,o.arrow),function(){Object.keys(t.elements).forEach(function(a){var d=t.elements[a],p=t.attributes[a]||{},y=Object.keys(t.styles.hasOwnProperty(a)?t.styles[a]:o[a]),r=y.reduce(function(S,C){return S[C]="",S},{});!ll(d)||!Bu(d)||(Object.assign(d.style,r),Object.keys(p).forEach(function(S){d.removeAttribute(S)}))})}}var Wz={name:"applyStyles",enabled:!0,phase:"write",fn:yZ,effect:vZ,requires:["computeStyles"]};function Lu(e){return e.split("-")[0]}var _h=Math.max,C1=Math.min,Bm=Math.round;function Vm(e,t){t===void 0&&(t=!1);var o=e.getBoundingClientRect(),a=1,d=1;if(ll(e)&&t){var p=e.offsetHeight,y=e.offsetWidth;y>0&&(a=Bm(o.width)/y||1),p>0&&(d=Bm(o.height)/p||1)}return{width:o.width/a,height:o.height/d,top:o.top/d,right:o.right/a,bottom:o.bottom/d,left:o.left/a,x:o.left/a,y:o.top/d}}function hE(e){var t=Vm(e),o=e.offsetWidth,a=e.offsetHeight;return Math.abs(t.width-o)<=1&&(o=t.width),Math.abs(t.height-a)<=1&&(a=t.height),{x:e.offsetLeft,y:e.offsetTop,width:o,height:a}}function qz(e,t){var o=t.getRootNode&&t.getRootNode();if(e.contains(t))return!0;if(o&&fE(o)){var a=t;do{if(a&&e.isSameNode(a))return!0;a=a.parentNode||a.host}while(a)}return!1}function Ac(e){return au(e).getComputedStyle(e)}function bZ(e){return["table","td","th"].indexOf(Bu(e))>=0}function lf(e){return((Nm(e)?e.ownerDocument:e.document)||window.document).documentElement}function bx(e){return Bu(e)==="html"?e:e.assignedSlot||e.parentNode||(fE(e)?e.host:null)||lf(e)}function K3(e){return!ll(e)||Ac(e).position==="fixed"?null:e.offsetParent}function xZ(e){var t=navigator.userAgent.toLowerCase().indexOf("firefox")!==-1,o=navigator.userAgent.indexOf("Trident")!==-1;if(o&&ll(e)){var a=Ac(e);if(a.position==="fixed")return null}var d=bx(e);for(fE(d)&&(d=d.host);ll(d)&&["html","body"].indexOf(Bu(d))<0;){var p=Ac(d);if(p.transform!=="none"||p.perspective!=="none"||p.contain==="paint"||["transform","perspective"].indexOf(p.willChange)!==-1||t&&p.willChange==="filter"||t&&p.filter&&p.filter!=="none")return d;d=d.parentNode}return null}function fv(e){for(var t=au(e),o=K3(e);o&&bZ(o)&&Ac(o).position==="static";)o=K3(o);return o&&(Bu(o)==="html"||Bu(o)==="body"&&Ac(o).position==="static")?t:o||xZ(e)||t}function pE(e){return["top","bottom"].indexOf(e)>=0?"x":"y"}function my(e,t,o){return _h(e,C1(t,o))}function wZ(e,t,o){var a=my(e,t,o);return a>o?o:a}function Kz(){return{top:0,right:0,bottom:0,left:0}}function Zz(e){return Object.assign({},Kz(),e)}function Yz(e,t){return t.reduce(function(o,a){return o[a]=e,o},{})}var SZ=function(e,t){return e=typeof e=="function"?e(Object.assign({},t.rects,{placement:t.placement})):e,Zz(typeof e!="number"?e:Yz(e,dv))};function TZ(e){var t,o=e.state,a=e.name,d=e.options,p=o.elements.arrow,y=o.modifiersData.popperOffsets,r=Lu(o.placement),S=pE(r),C=[Ta,hl].indexOf(r)>=0,M=C?"height":"width";if(!(!p||!y)){var P=SZ(d.padding,o),z=hE(p),F=S==="y"?Sa:Ta,V=S==="y"?fl:hl,N=o.rects.reference[M]+o.rects.reference[S]-y[S]-o.rects.popper[M],H=y[S]-o.rects.reference[S],U=fv(p),te=U?S==="y"?U.clientHeight||0:U.clientWidth||0:0,Z=N/2-H/2,q=P[F],J=te-z[M]-P[V],re=te/2-z[M]/2+Z,se=my(q,re,J),he=S;o.modifiersData[a]=(t={},t[he]=se,t.centerOffset=se-re,t)}}function CZ(e){var t=e.state,o=e.options,a=o.element,d=a===void 0?"[data-popper-arrow]":a;d!=null&&(typeof d=="string"&&(d=t.elements.popper.querySelector(d),!d)||!qz(t.elements.popper,d)||(t.elements.arrow=d))}var EZ={name:"arrow",enabled:!0,phase:"main",fn:TZ,effect:CZ,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function $m(e){return e.split("-")[1]}var MZ={top:"auto",right:"auto",bottom:"auto",left:"auto"};function IZ(e){var t=e.x,o=e.y,a=window,d=a.devicePixelRatio||1;return{x:Bm(t*d)/d||0,y:Bm(o*d)/d||0}}function Z3(e){var t,o=e.popper,a=e.popperRect,d=e.placement,p=e.variation,y=e.offsets,r=e.position,S=e.gpuAcceleration,C=e.adaptive,M=e.roundOffsets,P=e.isFixed,z=y.x,F=z===void 0?0:z,V=y.y,N=V===void 0?0:V,H=typeof M=="function"?M({x:F,y:N}):{x:F,y:N};F=H.x,N=H.y;var U=y.hasOwnProperty("x"),te=y.hasOwnProperty("y"),Z=Ta,q=Sa,J=window;if(C){var re=fv(o),se="clientHeight",he="clientWidth";if(re===au(o)&&(re=lf(o),Ac(re).position!=="static"&&r==="absolute"&&(se="scrollHeight",he="scrollWidth")),re=re,d===Sa||(d===Ta||d===hl)&&p===Dy){q=fl;var le=P&&re===J&&J.visualViewport?J.visualViewport.height:re[se];N-=le-a.height,N*=S?1:-1}if(d===Ta||(d===Sa||d===fl)&&p===Dy){Z=hl;var ce=P&&re===J&&J.visualViewport?J.visualViewport.width:re[he];F-=ce-a.width,F*=S?1:-1}}var pe=Object.assign({position:r},C&&MZ),de=M===!0?IZ({x:F,y:N}):{x:F,y:N};if(F=de.x,N=de.y,S){var Ie;return Object.assign({},pe,(Ie={},Ie[q]=te?"0":"",Ie[Z]=U?"0":"",Ie.transform=(J.devicePixelRatio||1)<=1?"translate("+F+"px, "+N+"px)":"translate3d("+F+"px, "+N+"px, 0)",Ie))}return Object.assign({},pe,(t={},t[q]=te?N+"px":"",t[Z]=U?F+"px":"",t.transform="",t))}function AZ(e){var t=e.state,o=e.options,a=o.gpuAcceleration,d=a===void 0?!0:a,p=o.adaptive,y=p===void 0?!0:p,r=o.roundOffsets,S=r===void 0?!0:r,C={placement:Lu(t.placement),variation:$m(t.placement),popper:t.elements.popper,popperRect:t.rects.popper,gpuAcceleration:d,isFixed:t.options.strategy==="fixed"};t.modifiersData.popperOffsets!=null&&(t.styles.popper=Object.assign({},t.styles.popper,Z3(Object.assign({},C,{offsets:t.modifiersData.popperOffsets,position:t.options.strategy,adaptive:y,roundOffsets:S})))),t.modifiersData.arrow!=null&&(t.styles.arrow=Object.assign({},t.styles.arrow,Z3(Object.assign({},C,{offsets:t.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:S})))),t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-placement":t.placement})}var Xz={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:AZ,data:{}},Eb={passive:!0};function kZ(e){var t=e.state,o=e.instance,a=e.options,d=a.scroll,p=d===void 0?!0:d,y=a.resize,r=y===void 0?!0:y,S=au(t.elements.popper),C=[].concat(t.scrollParents.reference,t.scrollParents.popper);return p&&C.forEach(function(M){M.addEventListener("scroll",o.update,Eb)}),r&&S.addEventListener("resize",o.update,Eb),function(){p&&C.forEach(function(M){M.removeEventListener("scroll",o.update,Eb)}),r&&S.removeEventListener("resize",o.update,Eb)}}var Jz={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:kZ,data:{}},PZ={left:"right",right:"left",bottom:"top",top:"bottom"};function Zb(e){return e.replace(/left|right|bottom|top/g,function(t){return PZ[t]})}var RZ={start:"end",end:"start"};function Y3(e){return e.replace(/start|end/g,function(t){return RZ[t]})}function mE(e){var t=au(e),o=t.pageXOffset,a=t.pageYOffset;return{scrollLeft:o,scrollTop:a}}function gE(e){return Vm(lf(e)).left+mE(e).scrollLeft}function OZ(e){var t=au(e),o=lf(e),a=t.visualViewport,d=o.clientWidth,p=o.clientHeight,y=0,r=0;return a&&(d=a.width,p=a.height,/^((?!chrome|android).)*safari/i.test(navigator.userAgent)||(y=a.offsetLeft,r=a.offsetTop)),{width:d,height:p,x:y+gE(e),y:r}}function LZ(e){var t,o=lf(e),a=mE(e),d=(t=e.ownerDocument)==null?void 0:t.body,p=_h(o.scrollWidth,o.clientWidth,d?d.scrollWidth:0,d?d.clientWidth:0),y=_h(o.scrollHeight,o.clientHeight,d?d.scrollHeight:0,d?d.clientHeight:0),r=-a.scrollLeft+gE(e),S=-a.scrollTop;return Ac(d||o).direction==="rtl"&&(r+=_h(o.clientWidth,d?d.clientWidth:0)-p),{width:p,height:y,x:r,y:S}}function _E(e){var t=Ac(e),o=t.overflow,a=t.overflowX,d=t.overflowY;return/auto|scroll|overlay|hidden/.test(o+d+a)}function Qz(e){return["html","body","#document"].indexOf(Bu(e))>=0?e.ownerDocument.body:ll(e)&&_E(e)?e:Qz(bx(e))}function gy(e,t){var o;t===void 0&&(t=[]);var a=Qz(e),d=a===((o=e.ownerDocument)==null?void 0:o.body),p=au(a),y=d?[p].concat(p.visualViewport||[],_E(a)?a:[]):a,r=t.concat(y);return d?r:r.concat(gy(bx(y)))}function eT(e){return Object.assign({},e,{left:e.x,top:e.y,right:e.x+e.width,bottom:e.y+e.height})}function DZ(e){var t=Vm(e);return t.top=t.top+e.clientTop,t.left=t.left+e.clientLeft,t.bottom=t.top+e.clientHeight,t.right=t.left+e.clientWidth,t.width=e.clientWidth,t.height=e.clientHeight,t.x=t.left,t.y=t.top,t}function X3(e,t){return t===Gz?eT(OZ(e)):Nm(t)?DZ(t):eT(LZ(lf(e)))}function zZ(e){var t=gy(bx(e)),o=["absolute","fixed"].indexOf(Ac(e).position)>=0,a=o&&ll(e)?fv(e):e;return Nm(a)?t.filter(function(d){return Nm(d)&&qz(d,a)&&Bu(d)!=="body"}):[]}function FZ(e,t,o){var a=t==="clippingParents"?zZ(e):[].concat(t),d=[].concat(a,[o]),p=d[0],y=d.reduce(function(r,S){var C=X3(e,S);return r.top=_h(C.top,r.top),r.right=C1(C.right,r.right),r.bottom=C1(C.bottom,r.bottom),r.left=_h(C.left,r.left),r},X3(e,p));return y.width=y.right-y.left,y.height=y.bottom-y.top,y.x=y.left,y.y=y.top,y}function e4(e){var t=e.reference,o=e.element,a=e.placement,d=a?Lu(a):null,p=a?$m(a):null,y=t.x+t.width/2-o.width/2,r=t.y+t.height/2-o.height/2,S;switch(d){case Sa:S={x:y,y:t.y-o.height};break;case fl:S={x:y,y:t.y+t.height};break;case hl:S={x:t.x+t.width,y:r};break;case Ta:S={x:t.x-o.width,y:r};break;default:S={x:t.x,y:t.y}}var C=d?pE(d):null;if(C!=null){var M=C==="y"?"height":"width";switch(p){case Fm:S[C]=S[C]-(t[M]/2-o[M]/2);break;case Dy:S[C]=S[C]+(t[M]/2-o[M]/2);break}}return S}function zy(e,t){t===void 0&&(t={});var o=t,a=o.placement,d=a===void 0?e.placement:a,p=o.boundary,y=p===void 0?sZ:p,r=o.rootBoundary,S=r===void 0?Gz:r,C=o.elementContext,M=C===void 0?Y_:C,P=o.altBoundary,z=P===void 0?!1:P,F=o.padding,V=F===void 0?0:F,N=Zz(typeof V!="number"?V:Yz(V,dv)),H=M===Y_?aZ:Y_,U=e.rects.popper,te=e.elements[z?H:M],Z=FZ(Nm(te)?te:te.contextElement||lf(e.elements.popper),y,S),q=Vm(e.elements.reference),J=e4({reference:q,element:U,strategy:"absolute",placement:d}),re=eT(Object.assign({},U,J)),se=M===Y_?re:q,he={top:Z.top-se.top+N.top,bottom:se.bottom-Z.bottom+N.bottom,left:Z.left-se.left+N.left,right:se.right-Z.right+N.right},le=e.modifiersData.offset;if(M===Y_&&le){var ce=le[d];Object.keys(he).forEach(function(pe){var de=[hl,fl].indexOf(pe)>=0?1:-1,Ie=[Sa,fl].indexOf(pe)>=0?"y":"x";he[pe]+=ce[Ie]*de})}return he}function NZ(e,t){t===void 0&&(t={});var o=t,a=o.placement,d=o.boundary,p=o.rootBoundary,y=o.padding,r=o.flipVariations,S=o.allowedAutoPlacements,C=S===void 0?Nc:S,M=$m(a),P=M?r?q3:q3.filter(function(V){return $m(V)===M}):dv,z=P.filter(function(V){return C.indexOf(V)>=0});z.length===0&&(z=P);var F=z.reduce(function(V,N){return V[N]=zy(e,{placement:N,boundary:d,rootBoundary:p,padding:y})[Lu(N)],V},{});return Object.keys(F).sort(function(V,N){return F[V]-F[N]})}function BZ(e){if(Lu(e)===dE)return[];var t=Zb(e);return[Y3(e),t,Y3(t)]}function VZ(e){var t=e.state,o=e.options,a=e.name;if(!t.modifiersData[a]._skip){for(var d=o.mainAxis,p=d===void 0?!0:d,y=o.altAxis,r=y===void 0?!0:y,S=o.fallbackPlacements,C=o.padding,M=o.boundary,P=o.rootBoundary,z=o.altBoundary,F=o.flipVariations,V=F===void 0?!0:F,N=o.allowedAutoPlacements,H=t.options.placement,U=Lu(H),te=U===H,Z=S||(te||!V?[Zb(H)]:BZ(H)),q=[H].concat(Z).reduce(function(Ct,kt){return Ct.concat(Lu(kt)===dE?NZ(t,{placement:kt,boundary:M,rootBoundary:P,padding:C,flipVariations:V,allowedAutoPlacements:N}):kt)},[]),J=t.rects.reference,re=t.rects.popper,se=new Map,he=!0,le=q[0],ce=0;ce<q.length;ce++){var pe=q[ce],de=Lu(pe),Ie=$m(pe)===Fm,Ve=[Sa,fl].indexOf(de)>=0,be=Ve?"width":"height",ye=zy(t,{placement:pe,boundary:M,rootBoundary:P,altBoundary:z,padding:C}),Me=Ve?Ie?hl:Ta:Ie?fl:Sa;J[be]>re[be]&&(Me=Zb(Me));var we=Zb(Me),me=[];if(p&&me.push(ye[de]<=0),r&&me.push(ye[Me]<=0,ye[we]<=0),me.every(function(Ct){return Ct})){le=pe,he=!1;break}se.set(pe,me)}if(he)for(var De=V?3:1,Ge=function(Ct){var kt=q.find(function(Bt){var _t=se.get(Bt);if(_t)return _t.slice(0,Ct).every(function(jt){return jt})});if(kt)return le=kt,"break"},rt=De;rt>0;rt--){var Oe=Ge(rt);if(Oe==="break")break}t.placement!==le&&(t.modifiersData[a]._skip=!0,t.placement=le,t.reset=!0)}}var $Z={name:"flip",enabled:!0,phase:"main",fn:VZ,requiresIfExists:["offset"],data:{_skip:!1}};function J3(e,t,o){return o===void 0&&(o={x:0,y:0}),{top:e.top-t.height-o.y,right:e.right-t.width+o.x,bottom:e.bottom-t.height+o.y,left:e.left-t.width-o.x}}function Q3(e){return[Sa,hl,fl,Ta].some(function(t){return e[t]>=0})}function UZ(e){var t=e.state,o=e.name,a=t.rects.reference,d=t.rects.popper,p=t.modifiersData.preventOverflow,y=zy(t,{elementContext:"reference"}),r=zy(t,{altBoundary:!0}),S=J3(y,a),C=J3(r,d,p),M=Q3(S),P=Q3(C);t.modifiersData[o]={referenceClippingOffsets:S,popperEscapeOffsets:C,isReferenceHidden:M,hasPopperEscaped:P},t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-reference-hidden":M,"data-popper-escaped":P})}var jZ={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:UZ};function HZ(e,t,o){var a=Lu(e),d=[Ta,Sa].indexOf(a)>=0?-1:1,p=typeof o=="function"?o(Object.assign({},t,{placement:e})):o,y=p[0],r=p[1];return y=y||0,r=(r||0)*d,[Ta,hl].indexOf(a)>=0?{x:r,y}:{x:y,y:r}}function GZ(e){var t=e.state,o=e.options,a=e.name,d=o.offset,p=d===void 0?[0,0]:d,y=Nc.reduce(function(M,P){return M[P]=HZ(P,t.rects,p),M},{}),r=y[t.placement],S=r.x,C=r.y;t.modifiersData.popperOffsets!=null&&(t.modifiersData.popperOffsets.x+=S,t.modifiersData.popperOffsets.y+=C),t.modifiersData[a]=y}var WZ={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:GZ};function qZ(e){var t=e.state,o=e.name;t.modifiersData[o]=e4({reference:t.rects.reference,element:t.rects.popper,strategy:"absolute",placement:t.placement})}var t4={name:"popperOffsets",enabled:!0,phase:"read",fn:qZ,data:{}};function KZ(e){return e==="x"?"y":"x"}function ZZ(e){var t=e.state,o=e.options,a=e.name,d=o.mainAxis,p=d===void 0?!0:d,y=o.altAxis,r=y===void 0?!1:y,S=o.boundary,C=o.rootBoundary,M=o.altBoundary,P=o.padding,z=o.tether,F=z===void 0?!0:z,V=o.tetherOffset,N=V===void 0?0:V,H=zy(t,{boundary:S,rootBoundary:C,padding:P,altBoundary:M}),U=Lu(t.placement),te=$m(t.placement),Z=!te,q=pE(U),J=KZ(q),re=t.modifiersData.popperOffsets,se=t.rects.reference,he=t.rects.popper,le=typeof N=="function"?N(Object.assign({},t.rects,{placement:t.placement})):N,ce=typeof le=="number"?{mainAxis:le,altAxis:le}:Object.assign({mainAxis:0,altAxis:0},le),pe=t.modifiersData.offset?t.modifiersData.offset[t.placement]:null,de={x:0,y:0};if(re){if(p){var Ie,Ve=q==="y"?Sa:Ta,be=q==="y"?fl:hl,ye=q==="y"?"height":"width",Me=re[q],we=Me+H[Ve],me=Me-H[be],De=F?-he[ye]/2:0,Ge=te===Fm?se[ye]:he[ye],rt=te===Fm?-he[ye]:-se[ye],Oe=t.elements.arrow,Ct=F&&Oe?hE(Oe):{width:0,height:0},kt=t.modifiersData["arrow#persistent"]?t.modifiersData["arrow#persistent"].padding:Kz(),Bt=kt[Ve],_t=kt[be],jt=my(0,se[ye],Ct[ye]),Gt=Z?se[ye]/2-De-jt-Bt-ce.mainAxis:Ge-jt-Bt-ce.mainAxis,Ne=Z?-se[ye]/2+De+jt+_t+ce.mainAxis:rt+jt+_t+ce.mainAxis,an=t.elements.arrow&&fv(t.elements.arrow),Ae=an?q==="y"?an.clientTop||0:an.clientLeft||0:0,tt=(Ie=pe==null?void 0:pe[q])!=null?Ie:0,Je=Me+Gt-tt-Ae,Jt=Me+Ne-tt,Kt=my(F?C1(we,Je):we,Me,F?_h(me,Jt):me);re[q]=Kt,de[q]=Kt-Me}if(r){var Nt,Pt=q==="x"?Sa:Ta,Dt=q==="x"?fl:hl,rn=re[J],on=J==="y"?"height":"width",Ln=rn+H[Pt],yn=rn-H[Dt],Et=[Sa,Ta].indexOf(U)!==-1,En=(Nt=pe==null?void 0:pe[J])!=null?Nt:0,Xn=Et?Ln:rn-se[on]-he[on]-En+ce.altAxis,vr=Et?rn+se[on]+he[on]-En-ce.altAxis:yn,er=F&&Et?wZ(Xn,rn,vr):my(F?Xn:Ln,rn,F?vr:yn);re[J]=er,de[J]=er-rn}t.modifiersData[a]=de}}var YZ={name:"preventOverflow",enabled:!0,phase:"main",fn:ZZ,requiresIfExists:["offset"]};function XZ(e){return{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}}function JZ(e){return e===au(e)||!ll(e)?mE(e):XZ(e)}function QZ(e){var t=e.getBoundingClientRect(),o=Bm(t.width)/e.offsetWidth||1,a=Bm(t.height)/e.offsetHeight||1;return o!==1||a!==1}function eY(e,t,o){o===void 0&&(o=!1);var a=ll(t),d=ll(t)&&QZ(t),p=lf(t),y=Vm(e,d),r={scrollLeft:0,scrollTop:0},S={x:0,y:0};return(a||!a&&!o)&&((Bu(t)!=="body"||_E(p))&&(r=JZ(t)),ll(t)?(S=Vm(t,!0),S.x+=t.clientLeft,S.y+=t.clientTop):p&&(S.x=gE(p))),{x:y.left+r.scrollLeft-S.x,y:y.top+r.scrollTop-S.y,width:y.width,height:y.height}}function tY(e){var t=new Map,o=new Set,a=[];e.forEach(function(p){t.set(p.name,p)});function d(p){o.add(p.name);var y=[].concat(p.requires||[],p.requiresIfExists||[]);y.forEach(function(r){if(!o.has(r)){var S=t.get(r);S&&d(S)}}),a.push(p)}return e.forEach(function(p){o.has(p.name)||d(p)}),a}function nY(e){var t=tY(e);return _Z.reduce(function(o,a){return o.concat(t.filter(function(d){return d.phase===a}))},[])}function rY(e){var t;return function(){return t||(t=new Promise(function(o){Promise.resolve().then(function(){t=void 0,o(e())})})),t}}function iY(e){var t=e.reduce(function(o,a){var d=o[a.name];return o[a.name]=d?Object.assign({},d,a,{options:Object.assign({},d.options,a.options),data:Object.assign({},d.data,a.data)}):a,o},{});return Object.keys(t).map(function(o){return t[o]})}var eR={placement:"bottom",modifiers:[],strategy:"absolute"};function tR(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];return!t.some(function(a){return!(a&&typeof a.getBoundingClientRect=="function")})}function yE(e){e===void 0&&(e={});var t=e,o=t.defaultModifiers,a=o===void 0?[]:o,d=t.defaultOptions,p=d===void 0?eR:d;return function(y,r,S){S===void 0&&(S=p);var C={placement:"bottom",orderedModifiers:[],options:Object.assign({},eR,p),modifiersData:{},elements:{reference:y,popper:r},attributes:{},styles:{}},M=[],P=!1,z={state:C,setOptions:function(N){var H=typeof N=="function"?N(C.options):N;V(),C.options=Object.assign({},p,C.options,H),C.scrollParents={reference:Nm(y)?gy(y):y.contextElement?gy(y.contextElement):[],popper:gy(r)};var U=nY(iY([].concat(a,C.options.modifiers)));return C.orderedModifiers=U.filter(function(te){return te.enabled}),F(),z.update()},forceUpdate:function(){if(!P){var N=C.elements,H=N.reference,U=N.popper;if(tR(H,U)){C.rects={reference:eY(H,fv(U),C.options.strategy==="fixed"),popper:hE(U)},C.reset=!1,C.placement=C.options.placement,C.orderedModifiers.forEach(function(he){return C.modifiersData[he.name]=Object.assign({},he.data)});for(var te=0;te<C.orderedModifiers.length;te++){if(C.reset===!0){C.reset=!1,te=-1;continue}var Z=C.orderedModifiers[te],q=Z.fn,J=Z.options,re=J===void 0?{}:J,se=Z.name;typeof q=="function"&&(C=q({state:C,options:re,name:se,instance:z})||C)}}}},update:rY(function(){return new Promise(function(N){z.forceUpdate(),N(C)})}),destroy:function(){V(),P=!0}};if(!tR(y,r))return z;z.setOptions(S).then(function(N){!P&&S.onFirstUpdate&&S.onFirstUpdate(N)});function F(){C.orderedModifiers.forEach(function(N){var H=N.name,U=N.options,te=U===void 0?{}:U,Z=N.effect;if(typeof Z=="function"){var q=Z({state:C,name:H,instance:z,options:te}),J=function(){};M.push(q||J)}})}function V(){M.forEach(function(N){return N()}),M=[]}return z}}yE();var oY=[Jz,t4,Xz,Wz];yE({defaultModifiers:oY});var sY=[Jz,t4,Xz,Wz,WZ,$Z,YZ,EZ,jZ],aY=yE({defaultModifiers:sY});const lY=["fixed","absolute"],uY=un({boundariesPadding:{type:Number,default:0},fallbackPlacements:{type:lt(Array),default:void 0},gpuAcceleration:{type:Boolean,default:!0},offset:{type:Number,default:12},placement:{type:String,values:Nc,default:"bottom"},popperOptions:{type:lt(Object),default:()=>({})},strategy:{type:String,values:lY,default:"absolute"}}),n4=un({...uY,id:String,style:{type:lt([String,Array,Object])},className:{type:lt([String,Array,Object])},effect:{type:lt(String),default:"dark"},visible:Boolean,enterable:{type:Boolean,default:!0},pure:Boolean,focusOnShow:{type:Boolean,default:!1},trapping:{type:Boolean,default:!1},popperClass:{type:lt([String,Array,Object])},popperStyle:{type:lt([String,Array,Object])},referenceEl:{type:lt(Object)},triggerTargetEl:{type:lt(Object)},stopPopperMouseEvent:{type:Boolean,default:!0},virtualTriggering:Boolean,zIndex:Number,...cs(["ariaLabel"])}),cY={mouseenter:e=>e instanceof MouseEvent,mouseleave:e=>e instanceof MouseEvent,focus:()=>!0,blur:()=>!0,close:()=>!0},dY=(e,t)=>{const o=xe(!1),a=xe();return{focusStartRef:a,trapped:o,onFocusAfterReleased:C=>{var M;((M=C.detail)==null?void 0:M.focusReason)!=="pointer"&&(a.value="first",t("blur"))},onFocusAfterTrapped:()=>{t("focus")},onFocusInTrap:C=>{e.visible&&!o.value&&(C.target&&(a.value=C.target),o.value=!0)},onFocusoutPrevented:C=>{e.trapping||(C.detail.focusReason==="pointer"&&C.preventDefault(),o.value=!1)},onReleaseRequested:()=>{o.value=!1,t("close")}}},fY=(e,t=[])=>{const{placement:o,strategy:a,popperOptions:d}=e,p={placement:o,strategy:a,...d,modifiers:[...pY(e),...t]};return mY(p,d==null?void 0:d.modifiers),p},hY=e=>{if(Wr)return Qs(e)};function pY(e){const{offset:t,gpuAcceleration:o,fallbackPlacements:a}=e;return[{name:"offset",options:{offset:[0,t??12]}},{name:"preventOverflow",options:{padding:{top:2,bottom:2,left:5,right:5}}},{name:"flip",options:{padding:5,fallbackPlacements:a}},{name:"computeStyles",options:{gpuAcceleration:o}}]}function mY(e,t){t&&(e.modifiers=[...e.modifiers,...t??[]])}const gY=(e,t,o={})=>{const a={name:"updateState",enabled:!0,phase:"write",fn:({state:S})=>{const C=_Y(S);Object.assign(y.value,C)},requires:["computeStyles"]},d=ee(()=>{const{onFirstUpdate:S,placement:C,strategy:M,modifiers:P}=b(o);return{onFirstUpdate:S,placement:C||"bottom",strategy:M||"absolute",modifiers:[...P||[],a,{name:"applyStyles",enabled:!1}]}}),p=Hi(),y=xe({styles:{popper:{position:b(d).strategy,left:"0",top:"0"},arrow:{position:"absolute"}},attributes:{}}),r=()=>{p.value&&(p.value.destroy(),p.value=void 0)};return Wt(d,S=>{const C=b(p);C&&C.setOptions(S)},{deep:!0}),Wt([e,t],([S,C])=>{r(),!(!S||!C)&&(p.value=aY(S,C,b(d)))}),Li(()=>{r()}),{state:ee(()=>{var S;return{...((S=b(p))==null?void 0:S.state)||{}}}),styles:ee(()=>b(y).styles),attributes:ee(()=>b(y).attributes),update:()=>{var S;return(S=b(p))==null?void 0:S.update()},forceUpdate:()=>{var S;return(S=b(p))==null?void 0:S.forceUpdate()},instanceRef:ee(()=>b(p))}};function _Y(e){const t=Object.keys(e.elements),o=Ly(t.map(d=>[d,e.styles[d]||{}])),a=Ly(t.map(d=>[d,e.attributes[d]]));return{styles:o,attributes:a}}const yY=0,vY=e=>{const{popperInstanceRef:t,contentRef:o,triggerRef:a,role:d}=Pn(aE,void 0),p=xe(),y=xe(),r=ee(()=>({name:"eventListeners",enabled:!!e.visible})),S=ee(()=>{var U;const te=b(p),Z=(U=b(y))!=null?U:yY;return{name:"arrow",enabled:!az(te),options:{element:te,padding:Z}}}),C=ee(()=>({onFirstUpdate:()=>{V()},...fY(e,[b(S),b(r)])})),M=ee(()=>hY(e.referenceEl)||b(a)),{attributes:P,state:z,styles:F,update:V,forceUpdate:N,instanceRef:H}=gY(M,o,C);return Wt(H,U=>t.value=U),yr(()=>{Wt(()=>{var U;return(U=b(M))==null?void 0:U.getBoundingClientRect()},()=>{V()})}),{attributes:P,arrowRef:p,contentRef:o,instanceRef:H,state:z,styles:F,role:d,forceUpdate:N,update:V}},bY=(e,{attributes:t,styles:o,role:a})=>{const{nextZIndex:d}=og(),p=Xt("popper"),y=ee(()=>b(t).popper),r=xe(Wn(e.zIndex)?e.zIndex:d()),S=ee(()=>[p.b(),p.is("pure",e.pure),p.is(e.effect),e.popperClass]),C=ee(()=>[{zIndex:b(r)},b(o).popper,e.popperStyle||{}]),M=ee(()=>a.value==="dialog"?"false":void 0),P=ee(()=>b(o).arrow||{});return{ariaModal:M,arrowStyle:P,contentAttrs:y,contentClass:S,contentStyle:C,contentZIndex:r,updateZIndex:()=>{r.value=Wn(e.zIndex)?e.zIndex:d()}}},xY=We({name:"ElPopperContent"}),wY=We({...xY,props:n4,emits:cY,setup(e,{expose:t,emit:o}){const a=e,{focusStartRef:d,trapped:p,onFocusAfterReleased:y,onFocusAfterTrapped:r,onFocusInTrap:S,onFocusoutPrevented:C,onReleaseRequested:M}=dY(a,o),{attributes:P,arrowRef:z,contentRef:F,styles:V,instanceRef:N,role:H,update:U}=vY(a),{ariaModal:te,arrowStyle:Z,contentAttrs:q,contentClass:J,contentStyle:re,updateZIndex:se}=bY(a,{styles:V,attributes:P,role:H}),he=Pn(Nu,void 0),le=xe();Vr(Dz,{arrowStyle:Z,arrowRef:z,arrowOffset:le}),he&&Vr(Nu,{...he,addInputId:vi,removeInputId:vi});let ce;const pe=(Ie=!0)=>{U(),Ie&&se()},de=()=>{pe(!1),a.visible&&a.focusOnShow?p.value=!0:a.visible===!1&&(p.value=!1)};return yr(()=>{Wt(()=>a.triggerTargetEl,(Ie,Ve)=>{ce==null||ce(),ce=void 0;const be=b(Ie||F.value),ye=b(Ve||F.value);ea(be)&&(ce=Wt([H,()=>a.ariaLabel,te,()=>a.id],Me=>{["role","aria-label","aria-modal","id"].forEach((we,me)=>{Ho(Me[me])?be.removeAttribute(we):be.setAttribute(we,Me[me])})},{immediate:!0})),ye!==be&&ea(ye)&&["role","aria-label","aria-modal","id"].forEach(Me=>{ye.removeAttribute(Me)})},{immediate:!0}),Wt(()=>a.visible,de,{immediate:!0})}),Li(()=>{ce==null||ce(),ce=void 0}),t({popperContentRef:F,popperInstanceRef:N,updatePopper:pe,contentStyle:re}),(Ie,Ve)=>(ae(),Pe("div",kr({ref_key:"contentRef",ref:F},b(q),{style:b(re),class:b(J),tabindex:"-1",onMouseenter:be=>Ie.$emit("mouseenter",be),onMouseleave:be=>Ie.$emit("mouseleave",be)}),[qe(b(ag),{trapped:b(p),"trap-on-focus-in":!0,"focus-trap-el":b(F),"focus-start-el":b(d),onFocusAfterTrapped:b(r),onFocusAfterReleased:b(y),onFocusin:b(S),onFocusoutPrevented:b(C),onReleaseRequested:b(M)},{default:ot(()=>[gt(Ie.$slots,"default")]),_:3},8,["trapped","focus-trap-el","focus-start-el","onFocusAfterTrapped","onFocusAfterReleased","onFocusin","onFocusoutPrevented","onReleaseRequested"])],16,["onMouseenter","onMouseleave"]))}});var SY=dn(wY,[["__file","content.vue"]]);const r4=lr(zK),xx=Symbol("elTooltip");function nR(){let e;const t=(a,d)=>{o(),e=window.setTimeout(a,d)},o=()=>window.clearTimeout(e);return av(()=>o()),{registerTimeout:t,cancelTimeout:o}}const TY=un({showAfter:{type:Number,default:0},hideAfter:{type:Number,default:200},autoClose:{type:Number,default:0}}),CY=({showAfter:e,hideAfter:t,autoClose:o,open:a,close:d})=>{const{registerTimeout:p}=nR(),{registerTimeout:y,cancelTimeout:r}=nR();return{onOpen:M=>{p(()=>{a(M);const P=b(o);Wn(P)&&P>0&&y(()=>{d(M)},P)},b(e))},onClose:M=>{r(),p(()=>{d(M)},b(t))}}},Jo=un({...TY,...n4,appendTo:{type:lt([String,Object])},content:{type:String,default:""},rawContent:Boolean,persistent:Boolean,visible:{type:lt(Boolean),default:null},transition:String,teleported:{type:Boolean,default:!0},disabled:Boolean,...cs(["ariaLabel"])}),Fy=un({...Nz,disabled:Boolean,trigger:{type:lt([String,Array]),default:"hover"},triggerKeys:{type:lt(Array),default:()=>[Cn.enter,Cn.numpadEnter,Cn.space]}}),EY=su({type:lt(Boolean),default:null}),MY=su({type:lt(Function)}),IY=e=>{const t=`update:${e}`,o=`onUpdate:${e}`,a=[t],d={[e]:EY,[o]:MY};return{useModelToggle:({indicator:y,toggleReason:r,shouldHideWhenRouteChanges:S,shouldProceed:C,onShow:M,onHide:P})=>{const z=Cr(),{emit:F}=z,V=z.props,N=ee(()=>$n(V[o])),H=ee(()=>V[e]===null),U=se=>{y.value!==!0&&(y.value=!0,r&&(r.value=se),$n(M)&&M(se))},te=se=>{y.value!==!1&&(y.value=!1,r&&(r.value=se),$n(P)&&P(se))},Z=se=>{if(V.disabled===!0||$n(C)&&!C())return;const he=N.value&&Wr;he&&F(t,!0),(H.value||!he)&&U(se)},q=se=>{if(V.disabled===!0||!Wr)return;const he=N.value&&Wr;he&&F(t,!1),(H.value||!he)&&te(se)},J=se=>{Oi(se)&&(V.disabled&&se?N.value&&F(t,!1):y.value!==se&&(se?U():te()))},re=()=>{y.value?q():Z()};return Wt(()=>V[e],J),S&&z.appContext.config.globalProperties.$route!==void 0&&Wt(()=>({...z.proxy.$route}),()=>{S.value&&y.value&&q()}),yr(()=>{J(V[e])}),{hide:q,show:Z,toggle:re,hasUpdateHandler:N}},useModelToggleProps:d,useModelToggleEmits:a}},{useModelToggleProps:AY,useModelToggleEmits:kY,useModelToggle:PY}=IY("visible"),RY=un({...zz,...AY,...Jo,...Fy,...Fz,showArrow:{type:Boolean,default:!0}}),OY=[...kY,"before-show","before-hide","show","hide","open","close"],LY=(e,t)=>sn(e)?e.includes(t):e===t,am=(e,t,o)=>a=>{LY(b(e),t)&&o(a)},go=(e,t,{checkForDefaultPrevented:o=!0}={})=>d=>{const p=e==null?void 0:e(d);if(o===!1||!p)return t==null?void 0:t(d)},rR=e=>t=>t.pointerType==="mouse"?e(t):void 0,DY=We({name:"ElTooltipTrigger"}),zY=We({...DY,props:Fy,setup(e,{expose:t}){const o=e,a=Xt("tooltip"),{controlled:d,id:p,open:y,onOpen:r,onClose:S,onToggle:C}=Pn(xx,void 0),M=xe(null),P=()=>{if(b(d)||o.disabled)return!0},z=hi(o,"trigger"),F=go(P,am(z,"hover",r)),V=go(P,am(z,"hover",S)),N=go(P,am(z,"click",q=>{q.button===0&&C(q)})),H=go(P,am(z,"focus",r)),U=go(P,am(z,"focus",S)),te=go(P,am(z,"contextmenu",q=>{q.preventDefault(),C(q)})),Z=go(P,q=>{const{code:J}=q;o.triggerKeys.includes(J)&&(q.preventDefault(),C(q))});return t({triggerRef:M}),(q,J)=>(ae(),At(b(qK),{id:b(p),"virtual-ref":q.virtualRef,open:b(y),"virtual-triggering":q.virtualTriggering,class:fe(b(a).e("trigger")),onBlur:b(U),onClick:b(N),onContextmenu:b(te),onFocus:b(H),onMouseenter:b(F),onMouseleave:b(V),onKeydown:b(Z)},{default:ot(()=>[gt(q.$slots,"default")]),_:3},8,["id","virtual-ref","open","virtual-triggering","class","onBlur","onClick","onContextmenu","onFocus","onMouseenter","onMouseleave","onKeydown"]))}});var FY=dn(zY,[["__file","trigger.vue"]]);const NY=un({to:{type:lt([String,Object]),required:!0},disabled:Boolean}),BY=We({__name:"teleport",props:NY,setup(e){return(t,o)=>t.disabled?gt(t.$slots,"default",{key:0}):(ae(),At(O6,{key:1,to:t.to},[gt(t.$slots,"default")],8,["to"]))}});var VY=dn(BY,[["__file","teleport.vue"]]);const lg=lr(VY),i4=()=>{const e=PC(),t=oE(),o=ee(()=>`${e.value}-popper-container-${t.prefix}`),a=ee(()=>`#${o.value}`);return{id:o,selector:a}},$Y=e=>{const t=document.createElement("div");return t.id=e,document.body.appendChild(t),t},UY=()=>{const{id:e,selector:t}=i4();return ev(()=>{Wr&&(document.body.querySelector(t.value)||$Y(e.value))}),{id:e,selector:t}},jY=We({name:"ElTooltipContent",inheritAttrs:!1}),HY=We({...jY,props:Jo,setup(e,{expose:t}){const o=e,{selector:a}=i4(),d=Xt("tooltip"),p=xe();let y;const{controlled:r,id:S,open:C,trigger:M,onClose:P,onOpen:z,onShow:F,onHide:V,onBeforeShow:N,onBeforeHide:H}=Pn(xx,void 0),U=ee(()=>o.transition||`${d.namespace.value}-fade-in-linear`),te=ee(()=>o.persistent);Li(()=>{y==null||y()});const Z=ee(()=>b(te)?!0:b(C)),q=ee(()=>o.disabled?!1:b(C)),J=ee(()=>o.appendTo||a.value),re=ee(()=>{var Me;return(Me=o.style)!=null?Me:{}}),se=xe(!0),he=()=>{V(),ye()&&bc(document.body),se.value=!0},le=()=>{if(b(r))return!0},ce=go(le,()=>{o.enterable&&b(M)==="hover"&&z()}),pe=go(le,()=>{b(M)==="hover"&&P()}),de=()=>{var Me,we;(we=(Me=p.value)==null?void 0:Me.updatePopper)==null||we.call(Me),N==null||N()},Ie=()=>{H==null||H()},Ve=()=>{F(),y=KC(ee(()=>{var Me;return(Me=p.value)==null?void 0:Me.popperContentRef}),()=>{if(b(r))return;b(M)!=="hover"&&P()})},be=()=>{o.virtualTriggering||P()},ye=Me=>{var we;const me=(we=p.value)==null?void 0:we.popperContentRef,De=(Me==null?void 0:Me.relatedTarget)||document.activeElement;return me==null?void 0:me.contains(De)};return Wt(()=>b(C),Me=>{Me?se.value=!1:y==null||y()},{flush:"post"}),Wt(()=>o.content,()=>{var Me,we;(we=(Me=p.value)==null?void 0:Me.updatePopper)==null||we.call(Me)}),t({contentRef:p,isFocusInsideContent:ye}),(Me,we)=>(ae(),At(b(lg),{disabled:!Me.teleported,to:b(J)},{default:ot(()=>[qe(rs,{name:b(U),onAfterLeave:he,onBeforeEnter:de,onAfterEnter:Ve,onBeforeLeave:Ie},{default:ot(()=>[b(Z)?hr((ae(),At(b(SY),kr({key:0,id:b(S),ref_key:"contentRef",ref:p},Me.$attrs,{"aria-label":Me.ariaLabel,"aria-hidden":se.value,"boundaries-padding":Me.boundariesPadding,"fallback-placements":Me.fallbackPlacements,"gpu-acceleration":Me.gpuAcceleration,offset:Me.offset,placement:Me.placement,"popper-options":Me.popperOptions,strategy:Me.strategy,effect:Me.effect,enterable:Me.enterable,pure:Me.pure,"popper-class":Me.popperClass,"popper-style":[Me.popperStyle,b(re)],"reference-el":Me.referenceEl,"trigger-target-el":Me.triggerTargetEl,visible:b(q),"z-index":Me.zIndex,onMouseenter:b(ce),onMouseleave:b(pe),onBlur:be,onClose:b(P)}),{default:ot(()=>[gt(Me.$slots,"default")]),_:3},16,["id","aria-label","aria-hidden","boundaries-padding","fallback-placements","gpu-acceleration","offset","placement","popper-options","strategy","effect","enterable","pure","popper-class","popper-style","reference-el","trigger-target-el","visible","z-index","onMouseenter","onMouseleave","onClose"])),[[ii,b(q)]]):bt("v-if",!0)]),_:3},8,["name"])]),_:3},8,["disabled","to"]))}});var GY=dn(HY,[["__file","content.vue"]]);const WY=We({name:"ElTooltip"}),qY=We({...WY,props:RY,emits:OY,setup(e,{expose:t,emit:o}){const a=e;UY();const d=us(),p=xe(),y=xe(),r=()=>{var U;const te=b(p);te&&((U=te.popperInstanceRef)==null||U.update())},S=xe(!1),C=xe(),{show:M,hide:P,hasUpdateHandler:z}=PY({indicator:S,toggleReason:C}),{onOpen:F,onClose:V}=CY({showAfter:hi(a,"showAfter"),hideAfter:hi(a,"hideAfter"),autoClose:hi(a,"autoClose"),open:M,close:P}),N=ee(()=>Oi(a.visible)&&!z.value);Vr(xx,{controlled:N,id:d,open:Qm(S),trigger:hi(a,"trigger"),onOpen:U=>{F(U)},onClose:U=>{V(U)},onToggle:U=>{b(S)?V(U):F(U)},onShow:()=>{o("show",C.value)},onHide:()=>{o("hide",C.value)},onBeforeShow:()=>{o("before-show",C.value)},onBeforeHide:()=>{o("before-hide",C.value)},updatePopper:r}),Wt(()=>a.disabled,U=>{U&&S.value&&(S.value=!1)});const H=U=>{var te;return(te=y.value)==null?void 0:te.isFocusInsideContent(U)};return AL(()=>S.value&&P()),t({popperRef:p,contentRef:y,isFocusInsideContent:H,updatePopper:r,onOpen:F,onClose:V,hide:P}),(U,te)=>(ae(),At(b(r4),{ref_key:"popperRef",ref:p,role:U.role},{default:ot(()=>[qe(FY,{disabled:U.disabled,trigger:U.trigger,"trigger-keys":U.triggerKeys,"virtual-ref":U.virtualRef,"virtual-triggering":U.virtualTriggering},{default:ot(()=>[U.$slots.default?gt(U.$slots,"default",{key:0}):bt("v-if",!0)]),_:3},8,["disabled","trigger","trigger-keys","virtual-ref","virtual-triggering"]),qe(GY,{ref_key:"contentRef",ref:y,"aria-label":U.ariaLabel,"boundaries-padding":U.boundariesPadding,content:U.content,disabled:U.disabled,effect:U.effect,enterable:U.enterable,"fallback-placements":U.fallbackPlacements,"hide-after":U.hideAfter,"gpu-acceleration":U.gpuAcceleration,offset:U.offset,persistent:U.persistent,"popper-class":U.popperClass,"popper-style":U.popperStyle,placement:U.placement,"popper-options":U.popperOptions,pure:U.pure,"raw-content":U.rawContent,"reference-el":U.referenceEl,"trigger-target-el":U.triggerTargetEl,"show-after":U.showAfter,strategy:U.strategy,teleported:U.teleported,transition:U.transition,"virtual-triggering":U.virtualTriggering,"z-index":U.zIndex,"append-to":U.appendTo},{default:ot(()=>[gt(U.$slots,"content",{},()=>[U.rawContent?(ae(),Pe("span",{key:0,innerHTML:U.content},null,8,["innerHTML"])):(ae(),Pe("span",{key:1},fn(U.content),1))]),U.showArrow?(ae(),At(b(BK),{key:0,"arrow-offset":U.arrowOffset},null,8,["arrow-offset"])):bt("v-if",!0)]),_:3},8,["aria-label","boundaries-padding","content","disabled","effect","enterable","fallback-placements","hide-after","gpu-acceleration","offset","persistent","popper-class","popper-style","placement","popper-options","pure","raw-content","reference-el","trigger-target-el","show-after","strategy","teleported","transition","virtual-triggering","z-index","append-to"])]),_:3},8,["role"]))}});var KY=dn(qY,[["__file","tooltip.vue"]]);const bs=lr(KY),ZY=un({valueKey:{type:String,default:"value"},modelValue:{type:[String,Number],default:""},debounce:{type:Number,default:300},placement:{type:lt(String),values:["top","top-start","top-end","bottom","bottom-start","bottom-end"],default:"bottom-start"},fetchSuggestions:{type:lt([Function,Array]),default:vi},popperClass:{type:String,default:""},triggerOnFocus:{type:Boolean,default:!0},selectWhenUnmatched:{type:Boolean,default:!1},hideLoading:{type:Boolean,default:!1},teleported:Jo.teleported,highlightFirstItem:{type:Boolean,default:!1},fitInputWidth:{type:Boolean,default:!1},clearable:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},name:String,...cs(["ariaLabel"])}),YY={[gr]:e=>Nn(e),[ys]:e=>Nn(e),[Ii]:e=>Nn(e),focus:e=>e instanceof FocusEvent,blur:e=>e instanceof FocusEvent,clear:()=>!0,select:e=>xr(e)},o4="ElAutocomplete",XY=We({name:o4,inheritAttrs:!1}),JY=We({...XY,props:ZY,emits:YY,setup(e,{expose:t,emit:o}){const a=e,d=uv(),p=of(),y=ws(),r=Xt("autocomplete"),S=xe(),C=xe(),M=xe(),P=xe();let z=!1,F=!1;const V=xe([]),N=xe(-1),H=xe(""),U=xe(!1),te=xe(!1),Z=xe(!1),q=us(),J=ee(()=>p.style),re=ee(()=>(V.value.length>0||Z.value)&&U.value),se=ee(()=>!a.hideLoading&&Z.value),he=ee(()=>S.value?Array.from(S.value.$el.querySelectorAll("input")):[]),le=()=>{re.value&&(H.value=`${S.value.$el.offsetWidth}px`)},ce=()=>{N.value=-1},pe=async _t=>{if(te.value)return;const jt=Gt=>{Z.value=!1,!te.value&&(sn(Gt)?(V.value=Gt,N.value=a.highlightFirstItem?0:-1):No(o4,"autocomplete suggestions must be an array"))};if(Z.value=!0,sn(a.fetchSuggestions))jt(a.fetchSuggestions);else{const Gt=await a.fetchSuggestions(_t,jt);sn(Gt)&&jt(Gt)}},de=Ca(pe,a.debounce),Ie=_t=>{const jt=!!_t;if(o(ys,_t),o(gr,_t),te.value=!1,U.value||(U.value=jt),!a.triggerOnFocus&&!_t){te.value=!0,V.value=[];return}de(_t)},Ve=_t=>{var jt;y.value||(((jt=_t.target)==null?void 0:jt.tagName)!=="INPUT"||he.value.includes(document.activeElement))&&(U.value=!0)},be=_t=>{o(Ii,_t)},ye=_t=>{F?F=!1:(U.value=!0,o("focus",_t),a.triggerOnFocus&&!z&&de(String(a.modelValue)))},Me=_t=>{setTimeout(()=>{var jt;if((jt=M.value)!=null&&jt.isFocusInsideContent()){F=!0;return}U.value&&Ge(),o("blur",_t)})},we=()=>{U.value=!1,o(gr,""),o("clear")},me=async()=>{re.value&&N.value>=0&&N.value<V.value.length?Ct(V.value[N.value]):a.selectWhenUnmatched&&(o("select",{value:a.modelValue}),V.value=[],N.value=-1)},De=_t=>{re.value&&(_t.preventDefault(),_t.stopPropagation(),Ge())},Ge=()=>{U.value=!1},rt=()=>{var _t;(_t=S.value)==null||_t.focus()},Oe=()=>{var _t;(_t=S.value)==null||_t.blur()},Ct=async _t=>{o(ys,_t[a.valueKey]),o(gr,_t[a.valueKey]),o("select",_t),V.value=[],N.value=-1},kt=_t=>{if(!re.value||Z.value)return;if(_t<0){N.value=-1;return}_t>=V.value.length&&(_t=V.value.length-1);const jt=C.value.querySelector(`.${r.be("suggestion","wrap")}`),Ne=jt.querySelectorAll(`.${r.be("suggestion","list")} li`)[_t],an=jt.scrollTop,{offsetTop:Ae,scrollHeight:tt}=Ne;Ae+tt>an+jt.clientHeight&&(jt.scrollTop+=tt),Ae<an&&(jt.scrollTop-=tt),N.value=_t,S.value.ref.setAttribute("aria-activedescendant",`${q.value}-item-${N.value}`)},Bt=KC(P,()=>{re.value&&Ge()});return Li(()=>{Bt==null||Bt()}),yr(()=>{S.value.ref.setAttribute("role","textbox"),S.value.ref.setAttribute("aria-autocomplete","list"),S.value.ref.setAttribute("aria-controls","id"),S.value.ref.setAttribute("aria-activedescendant",`${q.value}-item-${N.value}`),z=S.value.ref.hasAttribute("readonly")}),t({highlightedIndex:N,activated:U,loading:Z,inputRef:S,popperRef:M,suggestions:V,handleSelect:Ct,handleKeyEnter:me,focus:rt,blur:Oe,close:Ge,highlight:kt,getData:pe}),(_t,jt)=>(ae(),At(b(bs),{ref_key:"popperRef",ref:M,visible:b(re),placement:_t.placement,"fallback-placements":["bottom-start","top-start"],"popper-class":[b(r).e("popper"),_t.popperClass],teleported:_t.teleported,"gpu-acceleration":!1,pure:"","manual-mode":"",effect:"light",trigger:"click",transition:`${b(r).namespace.value}-zoom-in-top`,persistent:"",role:"listbox",onBeforeShow:le,onHide:ce},{content:ot(()=>[Ue("div",{ref_key:"regionRef",ref:C,class:fe([b(r).b("suggestion"),b(r).is("loading",b(se))]),style:Un({[_t.fitInputWidth?"width":"minWidth"]:H.value,outline:"none"}),role:"region"},[qe(b(Hu),{id:b(q),tag:"ul","wrap-class":b(r).be("suggestion","wrap"),"view-class":b(r).be("suggestion","list"),role:"listbox"},{default:ot(()=>[b(se)?(ae(),Pe("li",{key:0},[gt(_t.$slots,"loading",{},()=>[qe(b(zn),{class:fe(b(r).is("loading"))},{default:ot(()=>[qe(b(Fu))]),_:1},8,["class"])])])):(ae(!0),Pe(Vn,{key:1},Fr(V.value,(Gt,Ne)=>(ae(),Pe("li",{id:`${b(q)}-item-${Ne}`,key:Ne,class:fe({highlighted:N.value===Ne}),role:"option","aria-selected":N.value===Ne,onClick:an=>Ct(Gt)},[gt(_t.$slots,"default",{item:Gt},()=>[Nr(fn(Gt[_t.valueKey]),1)])],10,["id","aria-selected","onClick"]))),128))]),_:3},8,["id","wrap-class","view-class"])],6)]),default:ot(()=>[Ue("div",{ref_key:"listboxRef",ref:P,class:fe([b(r).b(),_t.$attrs.class]),style:Un(b(J)),role:"combobox","aria-haspopup":"listbox","aria-expanded":b(re),"aria-owns":b(q)},[qe(b(Bs),kr({ref_key:"inputRef",ref:S},b(d),{clearable:_t.clearable,disabled:b(y),name:_t.name,"model-value":_t.modelValue,"aria-label":_t.ariaLabel,onInput:Ie,onChange:be,onFocus:ye,onBlur:Me,onClear:we,onKeydown:[Ri(Jn(Gt=>kt(N.value-1),["prevent"]),["up"]),Ri(Jn(Gt=>kt(N.value+1),["prevent"]),["down"]),Ri(me,["enter"]),Ri(Ge,["tab"]),Ri(De,["esc"])],onMousedown:Ve}),cl({_:2},[_t.$slots.prepend?{name:"prepend",fn:ot(()=>[gt(_t.$slots,"prepend")])}:void 0,_t.$slots.append?{name:"append",fn:ot(()=>[gt(_t.$slots,"append")])}:void 0,_t.$slots.prefix?{name:"prefix",fn:ot(()=>[gt(_t.$slots,"prefix")])}:void 0,_t.$slots.suffix?{name:"suffix",fn:ot(()=>[gt(_t.$slots,"suffix")])}:void 0]),1040,["clearable","disabled","name","model-value","aria-label","onKeydown"])],14,["aria-expanded","aria-owns"])]),_:3},8,["visible","placement","popper-class","teleported","transition"]))}});var QY=dn(JY,[["__file","autocomplete.vue"]]);const eX=lr(QY),tX=un({size:{type:[Number,String],values:ju,default:"",validator:e=>Wn(e)},shape:{type:String,values:["circle","square"],default:"circle"},icon:{type:Ai},src:{type:String,default:""},alt:String,srcSet:String,fit:{type:lt(String),default:"cover"}}),nX={error:e=>e instanceof Event},rX=We({name:"ElAvatar"}),iX=We({...rX,props:tX,emits:nX,setup(e,{emit:t}){const o=e,a=Xt("avatar"),d=xe(!1),p=ee(()=>{const{size:C,icon:M,shape:P}=o,z=[a.b()];return Nn(C)&&z.push(a.m(C)),M&&z.push(a.m("icon")),P&&z.push(a.m(P)),z}),y=ee(()=>{const{size:C}=o;return Wn(C)?a.cssVarBlock({size:_o(C)||""}):void 0}),r=ee(()=>({objectFit:o.fit}));Wt(()=>o.src,()=>d.value=!1);function S(C){d.value=!0,t("error",C)}return(C,M)=>(ae(),Pe("span",{class:fe(b(p)),style:Un(b(y))},[(C.src||C.srcSet)&&!d.value?(ae(),Pe("img",{key:0,src:C.src,alt:C.alt,srcset:C.srcSet,style:Un(b(r)),onError:S},null,44,["src","alt","srcset"])):C.icon?(ae(),At(b(zn),{key:1},{default:ot(()=>[(ae(),At(Ir(C.icon)))]),_:1})):gt(C.$slots,"default",{key:2})],6))}});var oX=dn(iX,[["__file","avatar.vue"]]);const sX=lr(oX),aX={visibilityHeight:{type:Number,default:200},target:{type:String,default:""},right:{type:Number,default:40},bottom:{type:Number,default:40}},lX={click:e=>e instanceof MouseEvent},uX=(e,t,o)=>{const a=Hi(),d=Hi(),p=xe(!1),y=()=>{a.value&&(p.value=a.value.scrollTop>=e.visibilityHeight)},r=C=>{var M;(M=a.value)==null||M.scrollTo({top:0,behavior:"smooth"}),t("click",C)},S=dz(y,300,!0);return Si(d,"scroll",S),yr(()=>{var C;d.value=document,a.value=document.documentElement,e.target&&(a.value=(C=document.querySelector(e.target))!=null?C:void 0,a.value||No(o,`target does not exist: ${e.target}`),d.value=a.value),y()}),{visible:p,handleClick:r}},s4="ElBacktop",cX=We({name:s4}),dX=We({...cX,props:aX,emits:lX,setup(e,{emit:t}){const o=e,a=Xt("backtop"),{handleClick:d,visible:p}=uX(o,t,s4),y=ee(()=>({right:`${o.right}px`,bottom:`${o.bottom}px`}));return(r,S)=>(ae(),At(rs,{name:`${b(a).namespace.value}-fade-in`},{default:ot(()=>[b(p)?(ae(),Pe("div",{key:0,style:Un(b(y)),class:fe(b(a).b()),onClick:Jn(b(d),["stop"])},[gt(r.$slots,"default",{},()=>[qe(b(zn),{class:fe(b(a).e("icon"))},{default:ot(()=>[qe(b(t7))]),_:1},8,["class"])])],14,["onClick"])):bt("v-if",!0)]),_:3},8,["name"]))}});var fX=dn(dX,[["__file","backtop.vue"]]);const hX=lr(fX),pX=un({value:{type:[String,Number],default:""},max:{type:Number,default:99},isDot:Boolean,hidden:Boolean,type:{type:String,values:["primary","success","warning","info","danger"],default:"danger"},showZero:{type:Boolean,default:!0},color:String,badgeStyle:{type:lt([String,Object,Array])},offset:{type:lt(Array),default:[0,0]},badgeClass:{type:String}}),mX=We({name:"ElBadge"}),gX=We({...mX,props:pX,setup(e,{expose:t}){const o=e,a=Xt("badge"),d=ee(()=>o.isDot?"":Wn(o.value)&&Wn(o.max)?o.max<o.value?`${o.max}+`:`${o.value}`:`${o.value}`),p=ee(()=>{var y,r,S,C,M;return[{backgroundColor:o.color,marginRight:_o(-((r=(y=o.offset)==null?void 0:y[0])!=null?r:0)),marginTop:_o((C=(S=o.offset)==null?void 0:S[1])!=null?C:0)},(M=o.badgeStyle)!=null?M:{}]});return t({content:d}),(y,r)=>(ae(),Pe("div",{class:fe(b(a).b())},[gt(y.$slots,"default"),qe(rs,{name:`${b(a).namespace.value}-zoom-in-center`,persisted:""},{default:ot(()=>[hr(Ue("sup",{class:fe([b(a).e("content"),b(a).em("content",y.type),b(a).is("fixed",!!y.$slots.default),b(a).is("dot",y.isDot),b(a).is("hide-zero",!y.showZero&&o.value===0),y.badgeClass]),style:Un(b(p))},[gt(y.$slots,"content",{value:b(d)},()=>[Nr(fn(b(d)),1)])],6),[[ii,!y.hidden&&(b(d)||y.isDot||y.$slots.content)]])]),_:3},8,["name"])],2))}});var _X=dn(gX,[["__file","badge.vue"]]);const a4=lr(_X),l4=Symbol("breadcrumbKey"),yX=un({separator:{type:String,default:"/"},separatorIcon:{type:Ai}}),vX=We({name:"ElBreadcrumb"}),bX=We({...vX,props:yX,setup(e){const t=e,{t:o}=qr(),a=Xt("breadcrumb"),d=xe();return Vr(l4,t),yr(()=>{const p=d.value.querySelectorAll(`.${a.e("item")}`);p.length&&p[p.length-1].setAttribute("aria-current","page")}),(p,y)=>(ae(),Pe("div",{ref_key:"breadcrumb",ref:d,class:fe(b(a).b()),"aria-label":b(o)("el.breadcrumb.label"),role:"navigation"},[gt(p.$slots,"default")],10,["aria-label"]))}});var xX=dn(bX,[["__file","breadcrumb.vue"]]);const wX=un({to:{type:lt([String,Object]),default:""},replace:Boolean}),SX=We({name:"ElBreadcrumbItem"}),TX=We({...SX,props:wX,setup(e){const t=e,o=Cr(),a=Pn(l4,void 0),d=Xt("breadcrumb"),p=o.appContext.config.globalProperties.$router,y=xe(),r=()=>{!t.to||!p||(t.replace?p.replace(t.to):p.push(t.to))};return(S,C)=>{var M,P;return ae(),Pe("span",{class:fe(b(d).e("item"))},[Ue("span",{ref_key:"link",ref:y,class:fe([b(d).e("inner"),b(d).is("link",!!S.to)]),role:"link",onClick:r},[gt(S.$slots,"default")],2),(M=b(a))!=null&&M.separatorIcon?(ae(),At(b(zn),{key:0,class:fe(b(d).e("separator"))},{default:ot(()=>[(ae(),At(Ir(b(a).separatorIcon)))]),_:1},8,["class"])):(ae(),Pe("span",{key:1,class:fe(b(d).e("separator")),role:"presentation"},fn((P=b(a))==null?void 0:P.separator),3))],2)}}});var u4=dn(TX,[["__file","breadcrumb-item.vue"]]);const CX=lr(xX,{BreadcrumbItem:u4}),EX=oo(u4),c4=Symbol("buttonGroupContextKey"),Ud=({from:e,replacement:t,scope:o,version:a,ref:d,type:p="API"},y)=>{Wt(()=>b(y),r=>{},{immediate:!0})},MX=(e,t)=>{Ud({from:"type.text",replacement:"link",version:"3.0.0",scope:"props",ref:"https://element-plus.org/en-US/component/button.html#button-attributes"},ee(()=>e.type==="text"));const o=Pn(c4,void 0),a=px("button"),{form:d}=xs(),p=Ro(ee(()=>o==null?void 0:o.size)),y=ws(),r=xe(),S=Bo(),C=ee(()=>e.type||(o==null?void 0:o.type)||""),M=ee(()=>{var V,N,H;return(H=(N=e.autoInsertSpace)!=null?N:(V=a.value)==null?void 0:V.autoInsertSpace)!=null?H:!1}),P=ee(()=>e.tag==="button"?{ariaDisabled:y.value||e.loading,disabled:y.value||e.loading,autofocus:e.autofocus,type:e.nativeType}:{}),z=ee(()=>{var V;const N=(V=S.default)==null?void 0:V.call(S);if(M.value&&(N==null?void 0:N.length)===1){const H=N[0];if((H==null?void 0:H.type)===eg){const U=H.children;return new RegExp("^\\p{Unified_Ideograph}{2}$","u").test(U.trim())}}return!1});return{_disabled:y,_size:p,_type:C,_ref:r,_props:P,shouldAddSpace:z,handleClick:V=>{if(y.value||e.loading){V.stopPropagation();return}e.nativeType==="reset"&&(d==null||d.resetFields()),t("click",V)}}},tT=["default","primary","success","warning","info","danger","text",""],IX=["button","submit","reset"],nT=un({size:zo,disabled:Boolean,type:{type:String,values:tT,default:""},icon:{type:Ai},nativeType:{type:String,values:IX,default:"button"},loading:Boolean,loadingIcon:{type:Ai,default:()=>Fu},plain:Boolean,text:Boolean,link:Boolean,bg:Boolean,autofocus:Boolean,round:Boolean,circle:Boolean,color:String,dark:Boolean,autoInsertSpace:{type:Boolean,default:void 0},tag:{type:lt([String,Object]),default:"button"}}),AX={click:e=>e instanceof MouseEvent};function vs(e,t){kX(e)&&(e="100%");var o=PX(e);return e=t===360?e:Math.min(t,Math.max(0,parseFloat(e))),o&&(e=parseInt(String(e*t),10)/100),Math.abs(e-t)<1e-6?1:(t===360?e=(e<0?e%t+t:e%t)/parseFloat(String(t)):e=e%t/parseFloat(String(t)),e)}function Mb(e){return Math.min(1,Math.max(0,e))}function kX(e){return typeof e=="string"&&e.indexOf(".")!==-1&&parseFloat(e)===1}function PX(e){return typeof e=="string"&&e.indexOf("%")!==-1}function d4(e){return e=parseFloat(e),(isNaN(e)||e<0||e>1)&&(e=1),e}function Ib(e){return e<=1?"".concat(Number(e)*100,"%"):e}function lh(e){return e.length===1?"0"+e:String(e)}function RX(e,t,o){return{r:vs(e,255)*255,g:vs(t,255)*255,b:vs(o,255)*255}}function iR(e,t,o){e=vs(e,255),t=vs(t,255),o=vs(o,255);var a=Math.max(e,t,o),d=Math.min(e,t,o),p=0,y=0,r=(a+d)/2;if(a===d)y=0,p=0;else{var S=a-d;switch(y=r>.5?S/(2-a-d):S/(a+d),a){case e:p=(t-o)/S+(t<o?6:0);break;case t:p=(o-e)/S+2;break;case o:p=(e-t)/S+4;break}p/=6}return{h:p,s:y,l:r}}function rS(e,t,o){return o<0&&(o+=1),o>1&&(o-=1),o<1/6?e+(t-e)*(6*o):o<1/2?t:o<2/3?e+(t-e)*(2/3-o)*6:e}function OX(e,t,o){var a,d,p;if(e=vs(e,360),t=vs(t,100),o=vs(o,100),t===0)d=o,p=o,a=o;else{var y=o<.5?o*(1+t):o+t-o*t,r=2*o-y;a=rS(r,y,e+1/3),d=rS(r,y,e),p=rS(r,y,e-1/3)}return{r:a*255,g:d*255,b:p*255}}function oR(e,t,o){e=vs(e,255),t=vs(t,255),o=vs(o,255);var a=Math.max(e,t,o),d=Math.min(e,t,o),p=0,y=a,r=a-d,S=a===0?0:r/a;if(a===d)p=0;else{switch(a){case e:p=(t-o)/r+(t<o?6:0);break;case t:p=(o-e)/r+2;break;case o:p=(e-t)/r+4;break}p/=6}return{h:p,s:S,v:y}}function LX(e,t,o){e=vs(e,360)*6,t=vs(t,100),o=vs(o,100);var a=Math.floor(e),d=e-a,p=o*(1-t),y=o*(1-d*t),r=o*(1-(1-d)*t),S=a%6,C=[o,y,p,p,r,o][S],M=[r,o,o,y,p,p][S],P=[p,p,r,o,o,y][S];return{r:C*255,g:M*255,b:P*255}}function sR(e,t,o,a){var d=[lh(Math.round(e).toString(16)),lh(Math.round(t).toString(16)),lh(Math.round(o).toString(16))];return a&&d[0].startsWith(d[0].charAt(1))&&d[1].startsWith(d[1].charAt(1))&&d[2].startsWith(d[2].charAt(1))?d[0].charAt(0)+d[1].charAt(0)+d[2].charAt(0):d.join("")}function DX(e,t,o,a,d){var p=[lh(Math.round(e).toString(16)),lh(Math.round(t).toString(16)),lh(Math.round(o).toString(16)),lh(zX(a))];return d&&p[0].startsWith(p[0].charAt(1))&&p[1].startsWith(p[1].charAt(1))&&p[2].startsWith(p[2].charAt(1))&&p[3].startsWith(p[3].charAt(1))?p[0].charAt(0)+p[1].charAt(0)+p[2].charAt(0)+p[3].charAt(0):p.join("")}function zX(e){return Math.round(parseFloat(e)*255).toString(16)}function aR(e){return Va(e)/255}function Va(e){return parseInt(e,16)}function FX(e){return{r:e>>16,g:(e&65280)>>8,b:e&255}}var rT={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",goldenrod:"#daa520",gold:"#ffd700",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavenderblush:"#fff0f5",lavender:"#e6e6fa",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};function NX(e){var t={r:0,g:0,b:0},o=1,a=null,d=null,p=null,y=!1,r=!1;return typeof e=="string"&&(e=$X(e)),typeof e=="object"&&(yc(e.r)&&yc(e.g)&&yc(e.b)?(t=RX(e.r,e.g,e.b),y=!0,r=String(e.r).substr(-1)==="%"?"prgb":"rgb"):yc(e.h)&&yc(e.s)&&yc(e.v)?(a=Ib(e.s),d=Ib(e.v),t=LX(e.h,a,d),y=!0,r="hsv"):yc(e.h)&&yc(e.s)&&yc(e.l)&&(a=Ib(e.s),p=Ib(e.l),t=OX(e.h,a,p),y=!0,r="hsl"),Object.prototype.hasOwnProperty.call(e,"a")&&(o=e.a)),o=d4(o),{ok:y,format:e.format||r,r:Math.min(255,Math.max(t.r,0)),g:Math.min(255,Math.max(t.g,0)),b:Math.min(255,Math.max(t.b,0)),a:o}}var BX="[-\\+]?\\d+%?",VX="[-\\+]?\\d*\\.\\d+%?",Nd="(?:".concat(VX,")|(?:").concat(BX,")"),iS="[\\s|\\(]+(".concat(Nd,")[,|\\s]+(").concat(Nd,")[,|\\s]+(").concat(Nd,")\\s*\\)?"),oS="[\\s|\\(]+(".concat(Nd,")[,|\\s]+(").concat(Nd,")[,|\\s]+(").concat(Nd,")[,|\\s]+(").concat(Nd,")\\s*\\)?"),Ul={CSS_UNIT:new RegExp(Nd),rgb:new RegExp("rgb"+iS),rgba:new RegExp("rgba"+oS),hsl:new RegExp("hsl"+iS),hsla:new RegExp("hsla"+oS),hsv:new RegExp("hsv"+iS),hsva:new RegExp("hsva"+oS),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/};function $X(e){if(e=e.trim().toLowerCase(),e.length===0)return!1;var t=!1;if(rT[e])e=rT[e],t=!0;else if(e==="transparent")return{r:0,g:0,b:0,a:0,format:"name"};var o=Ul.rgb.exec(e);return o?{r:o[1],g:o[2],b:o[3]}:(o=Ul.rgba.exec(e),o?{r:o[1],g:o[2],b:o[3],a:o[4]}:(o=Ul.hsl.exec(e),o?{h:o[1],s:o[2],l:o[3]}:(o=Ul.hsla.exec(e),o?{h:o[1],s:o[2],l:o[3],a:o[4]}:(o=Ul.hsv.exec(e),o?{h:o[1],s:o[2],v:o[3]}:(o=Ul.hsva.exec(e),o?{h:o[1],s:o[2],v:o[3],a:o[4]}:(o=Ul.hex8.exec(e),o?{r:Va(o[1]),g:Va(o[2]),b:Va(o[3]),a:aR(o[4]),format:t?"name":"hex8"}:(o=Ul.hex6.exec(e),o?{r:Va(o[1]),g:Va(o[2]),b:Va(o[3]),format:t?"name":"hex"}:(o=Ul.hex4.exec(e),o?{r:Va(o[1]+o[1]),g:Va(o[2]+o[2]),b:Va(o[3]+o[3]),a:aR(o[4]+o[4]),format:t?"name":"hex8"}:(o=Ul.hex3.exec(e),o?{r:Va(o[1]+o[1]),g:Va(o[2]+o[2]),b:Va(o[3]+o[3]),format:t?"name":"hex"}:!1)))))))))}function yc(e){return!!Ul.CSS_UNIT.exec(String(e))}var f4=function(){function e(t,o){t===void 0&&(t=""),o===void 0&&(o={});var a;if(t instanceof e)return t;typeof t=="number"&&(t=FX(t)),this.originalInput=t;var d=NX(t);this.originalInput=t,this.r=d.r,this.g=d.g,this.b=d.b,this.a=d.a,this.roundA=Math.round(100*this.a)/100,this.format=(a=o.format)!==null&&a!==void 0?a:d.format,this.gradientType=o.gradientType,this.r<1&&(this.r=Math.round(this.r)),this.g<1&&(this.g=Math.round(this.g)),this.b<1&&(this.b=Math.round(this.b)),this.isValid=d.ok}return e.prototype.isDark=function(){return this.getBrightness()<128},e.prototype.isLight=function(){return!this.isDark()},e.prototype.getBrightness=function(){var t=this.toRgb();return(t.r*299+t.g*587+t.b*114)/1e3},e.prototype.getLuminance=function(){var t=this.toRgb(),o,a,d,p=t.r/255,y=t.g/255,r=t.b/255;return p<=.03928?o=p/12.92:o=Math.pow((p+.055)/1.055,2.4),y<=.03928?a=y/12.92:a=Math.pow((y+.055)/1.055,2.4),r<=.03928?d=r/12.92:d=Math.pow((r+.055)/1.055,2.4),.2126*o+.7152*a+.0722*d},e.prototype.getAlpha=function(){return this.a},e.prototype.setAlpha=function(t){return this.a=d4(t),this.roundA=Math.round(100*this.a)/100,this},e.prototype.isMonochrome=function(){var t=this.toHsl().s;return t===0},e.prototype.toHsv=function(){var t=oR(this.r,this.g,this.b);return{h:t.h*360,s:t.s,v:t.v,a:this.a}},e.prototype.toHsvString=function(){var t=oR(this.r,this.g,this.b),o=Math.round(t.h*360),a=Math.round(t.s*100),d=Math.round(t.v*100);return this.a===1?"hsv(".concat(o,", ").concat(a,"%, ").concat(d,"%)"):"hsva(".concat(o,", ").concat(a,"%, ").concat(d,"%, ").concat(this.roundA,")")},e.prototype.toHsl=function(){var t=iR(this.r,this.g,this.b);return{h:t.h*360,s:t.s,l:t.l,a:this.a}},e.prototype.toHslString=function(){var t=iR(this.r,this.g,this.b),o=Math.round(t.h*360),a=Math.round(t.s*100),d=Math.round(t.l*100);return this.a===1?"hsl(".concat(o,", ").concat(a,"%, ").concat(d,"%)"):"hsla(".concat(o,", ").concat(a,"%, ").concat(d,"%, ").concat(this.roundA,")")},e.prototype.toHex=function(t){return t===void 0&&(t=!1),sR(this.r,this.g,this.b,t)},e.prototype.toHexString=function(t){return t===void 0&&(t=!1),"#"+this.toHex(t)},e.prototype.toHex8=function(t){return t===void 0&&(t=!1),DX(this.r,this.g,this.b,this.a,t)},e.prototype.toHex8String=function(t){return t===void 0&&(t=!1),"#"+this.toHex8(t)},e.prototype.toHexShortString=function(t){return t===void 0&&(t=!1),this.a===1?this.toHexString(t):this.toHex8String(t)},e.prototype.toRgb=function(){return{r:Math.round(this.r),g:Math.round(this.g),b:Math.round(this.b),a:this.a}},e.prototype.toRgbString=function(){var t=Math.round(this.r),o=Math.round(this.g),a=Math.round(this.b);return this.a===1?"rgb(".concat(t,", ").concat(o,", ").concat(a,")"):"rgba(".concat(t,", ").concat(o,", ").concat(a,", ").concat(this.roundA,")")},e.prototype.toPercentageRgb=function(){var t=function(o){return"".concat(Math.round(vs(o,255)*100),"%")};return{r:t(this.r),g:t(this.g),b:t(this.b),a:this.a}},e.prototype.toPercentageRgbString=function(){var t=function(o){return Math.round(vs(o,255)*100)};return this.a===1?"rgb(".concat(t(this.r),"%, ").concat(t(this.g),"%, ").concat(t(this.b),"%)"):"rgba(".concat(t(this.r),"%, ").concat(t(this.g),"%, ").concat(t(this.b),"%, ").concat(this.roundA,")")},e.prototype.toName=function(){if(this.a===0)return"transparent";if(this.a<1)return!1;for(var t="#"+sR(this.r,this.g,this.b,!1),o=0,a=Object.entries(rT);o<a.length;o++){var d=a[o],p=d[0],y=d[1];if(t===y)return p}return!1},e.prototype.toString=function(t){var o=!!t;t=t??this.format;var a=!1,d=this.a<1&&this.a>=0,p=!o&&d&&(t.startsWith("hex")||t==="name");return p?t==="name"&&this.a===0?this.toName():this.toRgbString():(t==="rgb"&&(a=this.toRgbString()),t==="prgb"&&(a=this.toPercentageRgbString()),(t==="hex"||t==="hex6")&&(a=this.toHexString()),t==="hex3"&&(a=this.toHexString(!0)),t==="hex4"&&(a=this.toHex8String(!0)),t==="hex8"&&(a=this.toHex8String()),t==="name"&&(a=this.toName()),t==="hsl"&&(a=this.toHslString()),t==="hsv"&&(a=this.toHsvString()),a||this.toHexString())},e.prototype.toNumber=function(){return(Math.round(this.r)<<16)+(Math.round(this.g)<<8)+Math.round(this.b)},e.prototype.clone=function(){return new e(this.toString())},e.prototype.lighten=function(t){t===void 0&&(t=10);var o=this.toHsl();return o.l+=t/100,o.l=Mb(o.l),new e(o)},e.prototype.brighten=function(t){t===void 0&&(t=10);var o=this.toRgb();return o.r=Math.max(0,Math.min(255,o.r-Math.round(255*-(t/100)))),o.g=Math.max(0,Math.min(255,o.g-Math.round(255*-(t/100)))),o.b=Math.max(0,Math.min(255,o.b-Math.round(255*-(t/100)))),new e(o)},e.prototype.darken=function(t){t===void 0&&(t=10);var o=this.toHsl();return o.l-=t/100,o.l=Mb(o.l),new e(o)},e.prototype.tint=function(t){return t===void 0&&(t=10),this.mix("white",t)},e.prototype.shade=function(t){return t===void 0&&(t=10),this.mix("black",t)},e.prototype.desaturate=function(t){t===void 0&&(t=10);var o=this.toHsl();return o.s-=t/100,o.s=Mb(o.s),new e(o)},e.prototype.saturate=function(t){t===void 0&&(t=10);var o=this.toHsl();return o.s+=t/100,o.s=Mb(o.s),new e(o)},e.prototype.greyscale=function(){return this.desaturate(100)},e.prototype.spin=function(t){var o=this.toHsl(),a=(o.h+t)%360;return o.h=a<0?360+a:a,new e(o)},e.prototype.mix=function(t,o){o===void 0&&(o=50);var a=this.toRgb(),d=new e(t).toRgb(),p=o/100,y={r:(d.r-a.r)*p+a.r,g:(d.g-a.g)*p+a.g,b:(d.b-a.b)*p+a.b,a:(d.a-a.a)*p+a.a};return new e(y)},e.prototype.analogous=function(t,o){t===void 0&&(t=6),o===void 0&&(o=30);var a=this.toHsl(),d=360/o,p=[this];for(a.h=(a.h-(d*t>>1)+720)%360;--t;)a.h=(a.h+d)%360,p.push(new e(a));return p},e.prototype.complement=function(){var t=this.toHsl();return t.h=(t.h+180)%360,new e(t)},e.prototype.monochromatic=function(t){t===void 0&&(t=6);for(var o=this.toHsv(),a=o.h,d=o.s,p=o.v,y=[],r=1/t;t--;)y.push(new e({h:a,s:d,v:p})),p=(p+r)%1;return y},e.prototype.splitcomplement=function(){var t=this.toHsl(),o=t.h;return[this,new e({h:(o+72)%360,s:t.s,l:t.l}),new e({h:(o+216)%360,s:t.s,l:t.l})]},e.prototype.onBackground=function(t){var o=this.toRgb(),a=new e(t).toRgb(),d=o.a+a.a*(1-o.a);return new e({r:(o.r*o.a+a.r*a.a*(1-o.a))/d,g:(o.g*o.a+a.g*a.a*(1-o.a))/d,b:(o.b*o.a+a.b*a.a*(1-o.a))/d,a:d})},e.prototype.triad=function(){return this.polyad(3)},e.prototype.tetrad=function(){return this.polyad(4)},e.prototype.polyad=function(t){for(var o=this.toHsl(),a=o.h,d=[this],p=360/t,y=1;y<t;y++)d.push(new e({h:(a+y*p)%360,s:o.s,l:o.l}));return d},e.prototype.equals=function(t){return this.toRgbString()===new e(t).toRgbString()},e}();function Ad(e,t=20){return e.mix("#141414",t).toString()}function UX(e){const t=ws(),o=Xt("button");return ee(()=>{let a={},d=e.color;if(d){const p=d.match(/var\((.*?)\)/);p&&(d=window.getComputedStyle(window.document.documentElement).getPropertyValue(p[1]));const y=new f4(d),r=e.dark?y.tint(20).toString():Ad(y,20);if(e.plain)a=o.cssVarBlock({"bg-color":e.dark?Ad(y,90):y.tint(90).toString(),"text-color":d,"border-color":e.dark?Ad(y,50):y.tint(50).toString(),"hover-text-color":`var(${o.cssVarName("color-white")})`,"hover-bg-color":d,"hover-border-color":d,"active-bg-color":r,"active-text-color":`var(${o.cssVarName("color-white")})`,"active-border-color":r}),t.value&&(a[o.cssVarBlockName("disabled-bg-color")]=e.dark?Ad(y,90):y.tint(90).toString(),a[o.cssVarBlockName("disabled-text-color")]=e.dark?Ad(y,50):y.tint(50).toString(),a[o.cssVarBlockName("disabled-border-color")]=e.dark?Ad(y,80):y.tint(80).toString());else{const S=e.dark?Ad(y,30):y.tint(30).toString(),C=y.isDark()?`var(${o.cssVarName("color-white")})`:`var(${o.cssVarName("color-black")})`;if(a=o.cssVarBlock({"bg-color":d,"text-color":C,"border-color":d,"hover-bg-color":S,"hover-text-color":C,"hover-border-color":S,"active-bg-color":r,"active-border-color":r}),t.value){const M=e.dark?Ad(y,50):y.tint(50).toString();a[o.cssVarBlockName("disabled-bg-color")]=M,a[o.cssVarBlockName("disabled-text-color")]=e.dark?"rgba(255, 255, 255, 0.5)":`var(${o.cssVarName("color-white")})`,a[o.cssVarBlockName("disabled-border-color")]=M}}}return a})}const jX=We({name:"ElButton"}),HX=We({...jX,props:nT,emits:AX,setup(e,{expose:t,emit:o}){const a=e,d=UX(a),p=Xt("button"),{_ref:y,_size:r,_type:S,_disabled:C,_props:M,shouldAddSpace:P,handleClick:z}=MX(a,o),F=ee(()=>[p.b(),p.m(S.value),p.m(r.value),p.is("disabled",C.value),p.is("loading",a.loading),p.is("plain",a.plain),p.is("round",a.round),p.is("circle",a.circle),p.is("text",a.text),p.is("link",a.link),p.is("has-bg",a.bg)]);return t({ref:y,size:r,type:S,disabled:C,shouldAddSpace:P}),(V,N)=>(ae(),At(Ir(V.tag),kr({ref_key:"_ref",ref:y},b(M),{class:b(F),style:b(d),onClick:b(z)}),{default:ot(()=>[V.loading?(ae(),Pe(Vn,{key:0},[V.$slots.loading?gt(V.$slots,"loading",{key:0}):(ae(),At(b(zn),{key:1,class:fe(b(p).is("loading"))},{default:ot(()=>[(ae(),At(Ir(V.loadingIcon)))]),_:1},8,["class"]))],64)):V.icon||V.$slots.icon?(ae(),At(b(zn),{key:1},{default:ot(()=>[V.icon?(ae(),At(Ir(V.icon),{key:0})):gt(V.$slots,"icon",{key:1})]),_:3})):bt("v-if",!0),V.$slots.default?(ae(),Pe("span",{key:2,class:fe({[b(p).em("text","expand")]:b(P)})},[gt(V.$slots,"default")],2)):bt("v-if",!0)]),_:3},16,["class","style","onClick"]))}});var GX=dn(HX,[["__file","button.vue"]]);const WX={size:nT.size,type:nT.type},qX=We({name:"ElButtonGroup"}),KX=We({...qX,props:WX,setup(e){const t=e;Vr(c4,si({size:hi(t,"size"),type:hi(t,"type")}));const o=Xt("button");return(a,d)=>(ae(),Pe("div",{class:fe(b(o).b("group"))},[gt(a.$slots,"default")],2))}});var h4=dn(KX,[["__file","button-group.vue"]]);const ts=lr(GX,{ButtonGroup:h4}),p4=oo(h4);var Gu=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function qa(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var m4={exports:{}};(function(e,t){(function(o,a){e.exports=a()})(Gu,function(){var o=1e3,a=6e4,d=36e5,p="millisecond",y="second",r="minute",S="hour",C="day",M="week",P="month",z="quarter",F="year",V="date",N="Invalid Date",H=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,U=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,te={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(Ve){var be=["th","st","nd","rd"],ye=Ve%100;return"["+Ve+(be[(ye-20)%10]||be[ye]||be[0])+"]"}},Z=function(Ve,be,ye){var Me=String(Ve);return!Me||Me.length>=be?Ve:""+Array(be+1-Me.length).join(ye)+Ve},q={s:Z,z:function(Ve){var be=-Ve.utcOffset(),ye=Math.abs(be),Me=Math.floor(ye/60),we=ye%60;return(be<=0?"+":"-")+Z(Me,2,"0")+":"+Z(we,2,"0")},m:function Ve(be,ye){if(be.date()<ye.date())return-Ve(ye,be);var Me=12*(ye.year()-be.year())+(ye.month()-be.month()),we=be.clone().add(Me,P),me=ye-we<0,De=be.clone().add(Me+(me?-1:1),P);return+(-(Me+(ye-we)/(me?we-De:De-we))||0)},a:function(Ve){return Ve<0?Math.ceil(Ve)||0:Math.floor(Ve)},p:function(Ve){return{M:P,y:F,w:M,d:C,D:V,h:S,m:r,s:y,ms:p,Q:z}[Ve]||String(Ve||"").toLowerCase().replace(/s$/,"")},u:function(Ve){return Ve===void 0}},J="en",re={};re[J]=te;var se="$isDayjsObject",he=function(Ve){return Ve instanceof de||!(!Ve||!Ve[se])},le=function Ve(be,ye,Me){var we;if(!be)return J;if(typeof be=="string"){var me=be.toLowerCase();re[me]&&(we=me),ye&&(re[me]=ye,we=me);var De=be.split("-");if(!we&&De.length>1)return Ve(De[0])}else{var Ge=be.name;re[Ge]=be,we=Ge}return!Me&&we&&(J=we),we||!Me&&J},ce=function(Ve,be){if(he(Ve))return Ve.clone();var ye=typeof be=="object"?be:{};return ye.date=Ve,ye.args=arguments,new de(ye)},pe=q;pe.l=le,pe.i=he,pe.w=function(Ve,be){return ce(Ve,{locale:be.$L,utc:be.$u,x:be.$x,$offset:be.$offset})};var de=function(){function Ve(ye){this.$L=le(ye.locale,null,!0),this.parse(ye),this.$x=this.$x||ye.x||{},this[se]=!0}var be=Ve.prototype;return be.parse=function(ye){this.$d=function(Me){var we=Me.date,me=Me.utc;if(we===null)return new Date(NaN);if(pe.u(we))return new Date;if(we instanceof Date)return new Date(we);if(typeof we=="string"&&!/Z$/i.test(we)){var De=we.match(H);if(De){var Ge=De[2]-1||0,rt=(De[7]||"0").substring(0,3);return me?new Date(Date.UTC(De[1],Ge,De[3]||1,De[4]||0,De[5]||0,De[6]||0,rt)):new Date(De[1],Ge,De[3]||1,De[4]||0,De[5]||0,De[6]||0,rt)}}return new Date(we)}(ye),this.init()},be.init=function(){var ye=this.$d;this.$y=ye.getFullYear(),this.$M=ye.getMonth(),this.$D=ye.getDate(),this.$W=ye.getDay(),this.$H=ye.getHours(),this.$m=ye.getMinutes(),this.$s=ye.getSeconds(),this.$ms=ye.getMilliseconds()},be.$utils=function(){return pe},be.isValid=function(){return this.$d.toString()!==N},be.isSame=function(ye,Me){var we=ce(ye);return this.startOf(Me)<=we&&we<=this.endOf(Me)},be.isAfter=function(ye,Me){return ce(ye)<this.startOf(Me)},be.isBefore=function(ye,Me){return this.endOf(Me)<ce(ye)},be.$g=function(ye,Me,we){return pe.u(ye)?this[Me]:this.set(we,ye)},be.unix=function(){return Math.floor(this.valueOf()/1e3)},be.valueOf=function(){return this.$d.getTime()},be.startOf=function(ye,Me){var we=this,me=!!pe.u(Me)||Me,De=pe.p(ye),Ge=function(Gt,Ne){var an=pe.w(we.$u?Date.UTC(we.$y,Ne,Gt):new Date(we.$y,Ne,Gt),we);return me?an:an.endOf(C)},rt=function(Gt,Ne){return pe.w(we.toDate()[Gt].apply(we.toDate("s"),(me?[0,0,0,0]:[23,59,59,999]).slice(Ne)),we)},Oe=this.$W,Ct=this.$M,kt=this.$D,Bt="set"+(this.$u?"UTC":"");switch(De){case F:return me?Ge(1,0):Ge(31,11);case P:return me?Ge(1,Ct):Ge(0,Ct+1);case M:var _t=this.$locale().weekStart||0,jt=(Oe<_t?Oe+7:Oe)-_t;return Ge(me?kt-jt:kt+(6-jt),Ct);case C:case V:return rt(Bt+"Hours",0);case S:return rt(Bt+"Minutes",1);case r:return rt(Bt+"Seconds",2);case y:return rt(Bt+"Milliseconds",3);default:return this.clone()}},be.endOf=function(ye){return this.startOf(ye,!1)},be.$set=function(ye,Me){var we,me=pe.p(ye),De="set"+(this.$u?"UTC":""),Ge=(we={},we[C]=De+"Date",we[V]=De+"Date",we[P]=De+"Month",we[F]=De+"FullYear",we[S]=De+"Hours",we[r]=De+"Minutes",we[y]=De+"Seconds",we[p]=De+"Milliseconds",we)[me],rt=me===C?this.$D+(Me-this.$W):Me;if(me===P||me===F){var Oe=this.clone().set(V,1);Oe.$d[Ge](rt),Oe.init(),this.$d=Oe.set(V,Math.min(this.$D,Oe.daysInMonth())).$d}else Ge&&this.$d[Ge](rt);return this.init(),this},be.set=function(ye,Me){return this.clone().$set(ye,Me)},be.get=function(ye){return this[pe.p(ye)]()},be.add=function(ye,Me){var we,me=this;ye=Number(ye);var De=pe.p(Me),Ge=function(Ct){var kt=ce(me);return pe.w(kt.date(kt.date()+Math.round(Ct*ye)),me)};if(De===P)return this.set(P,this.$M+ye);if(De===F)return this.set(F,this.$y+ye);if(De===C)return Ge(1);if(De===M)return Ge(7);var rt=(we={},we[r]=a,we[S]=d,we[y]=o,we)[De]||1,Oe=this.$d.getTime()+ye*rt;return pe.w(Oe,this)},be.subtract=function(ye,Me){return this.add(-1*ye,Me)},be.format=function(ye){var Me=this,we=this.$locale();if(!this.isValid())return we.invalidDate||N;var me=ye||"YYYY-MM-DDTHH:mm:ssZ",De=pe.z(this),Ge=this.$H,rt=this.$m,Oe=this.$M,Ct=we.weekdays,kt=we.months,Bt=we.meridiem,_t=function(Ne,an,Ae,tt){return Ne&&(Ne[an]||Ne(Me,me))||Ae[an].slice(0,tt)},jt=function(Ne){return pe.s(Ge%12||12,Ne,"0")},Gt=Bt||function(Ne,an,Ae){var tt=Ne<12?"AM":"PM";return Ae?tt.toLowerCase():tt};return me.replace(U,function(Ne,an){return an||function(Ae){switch(Ae){case"YY":return String(Me.$y).slice(-2);case"YYYY":return pe.s(Me.$y,4,"0");case"M":return Oe+1;case"MM":return pe.s(Oe+1,2,"0");case"MMM":return _t(we.monthsShort,Oe,kt,3);case"MMMM":return _t(kt,Oe);case"D":return Me.$D;case"DD":return pe.s(Me.$D,2,"0");case"d":return String(Me.$W);case"dd":return _t(we.weekdaysMin,Me.$W,Ct,2);case"ddd":return _t(we.weekdaysShort,Me.$W,Ct,3);case"dddd":return Ct[Me.$W];case"H":return String(Ge);case"HH":return pe.s(Ge,2,"0");case"h":return jt(1);case"hh":return jt(2);case"a":return Gt(Ge,rt,!0);case"A":return Gt(Ge,rt,!1);case"m":return String(rt);case"mm":return pe.s(rt,2,"0");case"s":return String(Me.$s);case"ss":return pe.s(Me.$s,2,"0");case"SSS":return pe.s(Me.$ms,3,"0");case"Z":return De}return null}(Ne)||De.replace(":","")})},be.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},be.diff=function(ye,Me,we){var me,De=this,Ge=pe.p(Me),rt=ce(ye),Oe=(rt.utcOffset()-this.utcOffset())*a,Ct=this-rt,kt=function(){return pe.m(De,rt)};switch(Ge){case F:me=kt()/12;break;case P:me=kt();break;case z:me=kt()/3;break;case M:me=(Ct-Oe)/6048e5;break;case C:me=(Ct-Oe)/864e5;break;case S:me=Ct/d;break;case r:me=Ct/a;break;case y:me=Ct/o;break;default:me=Ct}return we?me:pe.a(me)},be.daysInMonth=function(){return this.endOf(P).$D},be.$locale=function(){return re[this.$L]},be.locale=function(ye,Me){if(!ye)return this.$L;var we=this.clone(),me=le(ye,Me,!0);return me&&(we.$L=me),we},be.clone=function(){return pe.w(this.$d,this)},be.toDate=function(){return new Date(this.valueOf())},be.toJSON=function(){return this.isValid()?this.toISOString():null},be.toISOString=function(){return this.$d.toISOString()},be.toString=function(){return this.$d.toUTCString()},Ve}(),Ie=de.prototype;return ce.prototype=Ie,[["$ms",p],["$s",y],["$m",r],["$H",S],["$W",C],["$M",P],["$y",F],["$D",V]].forEach(function(Ve){Ie[Ve[1]]=function(be){return this.$g(be,Ve[0],Ve[1])}}),ce.extend=function(Ve,be){return Ve.$i||(Ve(be,de,ce),Ve.$i=!0),ce},ce.locale=le,ce.isDayjs=he,ce.unix=function(Ve){return ce(1e3*Ve)},ce.en=re[J],ce.Ls=re,ce.p={},ce})})(m4);var ZX=m4.exports;const sr=qa(ZX),sS=(e,t)=>[e>0?e-1:void 0,e,e<t?e+1:void 0],jd=e=>Array.from(Array.from({length:e}).keys()),g4=e=>e.replace(/\W?m{1,2}|\W?ZZ/g,"").replace(/\W?h{1,2}|\W?s{1,3}|\W?a/gi,"").trim(),_4=e=>e.replace(/\W?D{1,2}|\W?Do|\W?d{1,4}|\W?M{1,4}|\W?Y{2,4}/g,"").trim(),lR=function(e,t){const o=Gd(e),a=Gd(t);return o&&a?e.getTime()===t.getTime():!o&&!a?e===t:!1},uR=function(e,t){const o=sn(e),a=sn(t);return o&&a?e.length!==t.length?!1:e.every((d,p)=>lR(d,t[p])):!o&&!a?lR(e,t):!1},cR=function(e,t,o){const a=$a(t)||t==="x"?sr(e).locale(o):sr(e,t).locale(o);return a.isValid()?a:void 0},dR=function(e,t,o){return $a(t)?e:t==="x"?+e:sr(e).locale(o).format(t)},aS=(e,t)=>{var o;const a=[],d=t==null?void 0:t();for(let p=0;p<e;p++)a.push((o=d==null?void 0:d.includes(p))!=null?o:!1);return a},Ab=e=>sn(e)?e.map(t=>t.toDate()):e.toDate(),YX=(e,t)=>{const o=e.subtract(1,"month").endOf("month").date();return jd(t).map((a,d)=>o-(t-d-1))},XX=e=>{const t=e.daysInMonth();return jd(t).map((o,a)=>a+1)},JX=e=>jd(e.length/7).map(t=>{const o=t*7;return e.slice(o,o+7)}),QX=un({selectedDay:{type:lt(Object)},range:{type:lt(Array)},date:{type:lt(Object),required:!0},hideHeader:{type:Boolean}}),eJ={pick:e=>xr(e)};var y4={exports:{}};(function(e,t){(function(o,a){e.exports=a()})(Gu,function(){return function(o,a,d){var p=a.prototype,y=function(P){return P&&(P.indexOf?P:P.s)},r=function(P,z,F,V,N){var H=P.name?P:P.$locale(),U=y(H[z]),te=y(H[F]),Z=U||te.map(function(J){return J.slice(0,V)});if(!N)return Z;var q=H.weekStart;return Z.map(function(J,re){return Z[(re+(q||0))%7]})},S=function(){return d.Ls[d.locale()]},C=function(P,z){return P.formats[z]||function(F){return F.replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,function(V,N,H){return N||H.slice(1)})}(P.formats[z.toUpperCase()])},M=function(){var P=this;return{months:function(z){return z?z.format("MMMM"):r(P,"months")},monthsShort:function(z){return z?z.format("MMM"):r(P,"monthsShort","months",3)},firstDayOfWeek:function(){return P.$locale().weekStart||0},weekdays:function(z){return z?z.format("dddd"):r(P,"weekdays")},weekdaysMin:function(z){return z?z.format("dd"):r(P,"weekdaysMin","weekdays",2)},weekdaysShort:function(z){return z?z.format("ddd"):r(P,"weekdaysShort","weekdays",3)},longDateFormat:function(z){return C(P.$locale(),z)},meridiem:this.$locale().meridiem,ordinal:this.$locale().ordinal}};p.localeData=function(){return M.bind(this)()},d.localeData=function(){var P=S();return{firstDayOfWeek:function(){return P.weekStart||0},weekdays:function(){return d.weekdays()},weekdaysShort:function(){return d.weekdaysShort()},weekdaysMin:function(){return d.weekdaysMin()},months:function(){return d.months()},monthsShort:function(){return d.monthsShort()},longDateFormat:function(z){return C(P,z)},meridiem:P.meridiem,ordinal:P.ordinal}},d.months=function(){return r(S(),"months")},d.monthsShort=function(){return r(S(),"monthsShort","months",3)},d.weekdays=function(P){return r(S(),"weekdays",null,null,P)},d.weekdaysShort=function(P){return r(S(),"weekdaysShort","weekdays",3,P)},d.weekdaysMin=function(P){return r(S(),"weekdaysMin","weekdays",2,P)}}})})(y4);var tJ=y4.exports;const v4=qa(tJ),nJ=["year","years","month","months","date","dates","week","datetime","datetimerange","daterange","monthrange","yearrange"],lS=["sun","mon","tue","wed","thu","fri","sat"],rJ=(e,t)=>{sr.extend(v4);const o=sr.localeData().firstDayOfWeek(),{t:a,lang:d}=qr(),p=sr().locale(d.value),y=ee(()=>!!e.range&&!!e.range.length),r=ee(()=>{let z=[];if(y.value){const[F,V]=e.range,N=jd(V.date()-F.date()+1).map(te=>({text:F.date()+te,type:"current"}));let H=N.length%7;H=H===0?0:7-H;const U=jd(H).map((te,Z)=>({text:Z+1,type:"next"}));z=N.concat(U)}else{const F=e.date.startOf("month").day(),V=YX(e.date,(F-o+7)%7).map(te=>({text:te,type:"prev"})),N=XX(e.date).map(te=>({text:te,type:"current"}));z=[...V,...N];const H=7-(z.length%7||7),U=jd(H).map((te,Z)=>({text:Z+1,type:"next"}));z=z.concat(U)}return JX(z)}),S=ee(()=>{const z=o;return z===0?lS.map(F=>a(`el.datepicker.weeks.${F}`)):lS.slice(z).concat(lS.slice(0,z)).map(F=>a(`el.datepicker.weeks.${F}`))}),C=(z,F)=>{switch(F){case"prev":return e.date.startOf("month").subtract(1,"month").date(z);case"next":return e.date.startOf("month").add(1,"month").date(z);case"current":return e.date.date(z)}};return{now:p,isInRange:y,rows:r,weekDays:S,getFormattedDate:C,handlePickDay:({text:z,type:F})=>{const V=C(z,F);t("pick",V)},getSlotData:({text:z,type:F})=>{const V=C(z,F);return{isSelected:V.isSame(e.selectedDay),type:`${F}-month`,day:V.format("YYYY-MM-DD"),date:V.toDate()}}}},iJ=We({name:"DateTable"}),oJ=We({...iJ,props:QX,emits:eJ,setup(e,{expose:t,emit:o}){const a=e,{isInRange:d,now:p,rows:y,weekDays:r,getFormattedDate:S,handlePickDay:C,getSlotData:M}=rJ(a,o),P=Xt("calendar-table"),z=Xt("calendar-day"),F=({text:V,type:N})=>{const H=[N];if(N==="current"){const U=S(V,N);U.isSame(a.selectedDay,"day")&&H.push(z.is("selected")),U.isSame(p,"day")&&H.push(z.is("today"))}return H};return t({getFormattedDate:S}),(V,N)=>(ae(),Pe("table",{class:fe([b(P).b(),b(P).is("range",b(d))]),cellspacing:"0",cellpadding:"0"},[V.hideHeader?bt("v-if",!0):(ae(),Pe("thead",{key:0},[Ue("tr",null,[(ae(!0),Pe(Vn,null,Fr(b(r),H=>(ae(),Pe("th",{key:H,scope:"col"},fn(H),1))),128))])])),Ue("tbody",null,[(ae(!0),Pe(Vn,null,Fr(b(y),(H,U)=>(ae(),Pe("tr",{key:U,class:fe({[b(P).e("row")]:!0,[b(P).em("row","hide-border")]:U===0&&V.hideHeader})},[(ae(!0),Pe(Vn,null,Fr(H,(te,Z)=>(ae(),Pe("td",{key:Z,class:fe(F(te)),onClick:q=>b(C)(te)},[Ue("div",{class:fe(b(z).b())},[gt(V.$slots,"date-cell",{data:b(M)(te)},()=>[Ue("span",null,fn(te.text),1)])],2)],10,["onClick"]))),128))],2))),128))])],2))}});var fR=dn(oJ,[["__file","date-table.vue"]]);const sJ=(e,t)=>{const o=e.endOf("month"),a=t.startOf("month"),p=o.isSame(a,"week")?a.add(1,"week"):a;return[[e,o],[p.startOf("week"),t]]},aJ=(e,t)=>{const o=e.endOf("month"),a=e.add(1,"month").startOf("month"),d=o.isSame(a,"week")?a.add(1,"week"):a,p=d.endOf("month"),y=t.startOf("month"),r=p.isSame(y,"week")?y.add(1,"week"):y;return[[e,o],[d.startOf("week"),p],[r.startOf("week"),t]]},lJ=(e,t,o)=>{const{lang:a}=qr(),d=xe(),p=sr().locale(a.value),y=ee({get(){return e.modelValue?S.value:d.value},set(H){if(!H)return;d.value=H;const U=H.toDate();t(ys,U),t(gr,U)}}),r=ee(()=>{if(!e.range||!sn(e.range)||e.range.length!==2||e.range.some(Z=>!Gd(Z)))return[];const H=e.range.map(Z=>sr(Z).locale(a.value)),[U,te]=H;return U.isAfter(te)?[]:U.isSame(te,"month")?F(U,te):U.add(1,"month").month()!==te.month()?[]:F(U,te)}),S=ee(()=>e.modelValue?sr(e.modelValue).locale(a.value):y.value||(r.value.length?r.value[0][0]:p)),C=ee(()=>S.value.subtract(1,"month").date(1)),M=ee(()=>S.value.add(1,"month").date(1)),P=ee(()=>S.value.subtract(1,"year").date(1)),z=ee(()=>S.value.add(1,"year").date(1)),F=(H,U)=>{const te=H.startOf("week"),Z=U.endOf("week"),q=te.get("month"),J=Z.get("month");return q===J?[[te,Z]]:(q+1)%12===J?sJ(te,Z):q+2===J||(q+1)%11===J?aJ(te,Z):[]},V=H=>{y.value=H};return{calculateValidatedDateRange:F,date:S,realSelectedDay:y,pickDay:V,selectDate:H=>{const te={"prev-month":C.value,"next-month":M.value,"prev-year":P.value,"next-year":z.value,today:p}[H];te.isSame(S.value,"day")||V(te)},validatedRange:r}},uJ=e=>sn(e)&&e.length===2&&e.every(t=>Gd(t)),cJ=un({modelValue:{type:Date},range:{type:lt(Array),validator:uJ}}),dJ={[gr]:e=>Gd(e),[ys]:e=>Gd(e)},fJ="ElCalendar",hJ=We({name:fJ}),pJ=We({...hJ,props:cJ,emits:dJ,setup(e,{expose:t,emit:o}){const a=e,d=Xt("calendar"),{calculateValidatedDateRange:p,date:y,pickDay:r,realSelectedDay:S,selectDate:C,validatedRange:M}=lJ(a,o),{t:P}=qr(),z=ee(()=>{const F=`el.datepicker.month${y.value.format("M")}`;return`${y.value.year()} ${P("el.datepicker.year")} ${P(F)}`});return t({selectedDay:S,pickDay:r,selectDate:C,calculateValidatedDateRange:p}),(F,V)=>(ae(),Pe("div",{class:fe(b(d).b())},[Ue("div",{class:fe(b(d).e("header"))},[gt(F.$slots,"header",{date:b(z)},()=>[Ue("div",{class:fe(b(d).e("title"))},fn(b(z)),3),b(M).length===0?(ae(),Pe("div",{key:0,class:fe(b(d).e("button-group"))},[qe(b(p4),null,{default:ot(()=>[qe(b(ts),{size:"small",onClick:N=>b(C)("prev-month")},{default:ot(()=>[Nr(fn(b(P)("el.datepicker.prevMonth")),1)]),_:1},8,["onClick"]),qe(b(ts),{size:"small",onClick:N=>b(C)("today")},{default:ot(()=>[Nr(fn(b(P)("el.datepicker.today")),1)]),_:1},8,["onClick"]),qe(b(ts),{size:"small",onClick:N=>b(C)("next-month")},{default:ot(()=>[Nr(fn(b(P)("el.datepicker.nextMonth")),1)]),_:1},8,["onClick"])]),_:1})],2)):bt("v-if",!0)])],2),b(M).length===0?(ae(),Pe("div",{key:0,class:fe(b(d).e("body"))},[qe(fR,{date:b(y),"selected-day":b(S),onPick:b(r)},cl({_:2},[F.$slots["date-cell"]?{name:"date-cell",fn:ot(N=>[gt(F.$slots,"date-cell",Gl(Wd(N)))])}:void 0]),1032,["date","selected-day","onPick"])],2)):(ae(),Pe("div",{key:1,class:fe(b(d).e("body"))},[(ae(!0),Pe(Vn,null,Fr(b(M),(N,H)=>(ae(),At(fR,{key:H,date:N[0],"selected-day":b(S),range:N,"hide-header":H!==0,onPick:b(r)},cl({_:2},[F.$slots["date-cell"]?{name:"date-cell",fn:ot(U=>[gt(F.$slots,"date-cell",Gl(Wd(U)))])}:void 0]),1032,["date","selected-day","range","hide-header","onPick"]))),128))],2))],2))}});var mJ=dn(pJ,[["__file","calendar.vue"]]);const gJ=lr(mJ),_J=un({header:{type:String,default:""},footer:{type:String,default:""},bodyStyle:{type:lt([String,Object,Array]),default:""},bodyClass:String,shadow:{type:String,values:["always","hover","never"],default:"always"}}),yJ=We({name:"ElCard"}),vJ=We({...yJ,props:_J,setup(e){const t=Xt("card");return(o,a)=>(ae(),Pe("div",{class:fe([b(t).b(),b(t).is(`${o.shadow}-shadow`)])},[o.$slots.header||o.header?(ae(),Pe("div",{key:0,class:fe(b(t).e("header"))},[gt(o.$slots,"header",{},()=>[Nr(fn(o.header),1)])],2)):bt("v-if",!0),Ue("div",{class:fe([b(t).e("body"),o.bodyClass]),style:Un(o.bodyStyle)},[gt(o.$slots,"default")],6),o.$slots.footer||o.footer?(ae(),Pe("div",{key:1,class:fe(b(t).e("footer"))},[gt(o.$slots,"footer",{},()=>[Nr(fn(o.footer),1)])],2)):bt("v-if",!0)],2))}});var bJ=dn(vJ,[["__file","card.vue"]]);const xJ=lr(bJ),wJ=un({initialIndex:{type:Number,default:0},height:{type:String,default:""},trigger:{type:String,values:["hover","click"],default:"hover"},autoplay:{type:Boolean,default:!0},interval:{type:Number,default:3e3},indicatorPosition:{type:String,values:["","none","outside"],default:""},arrow:{type:String,values:["always","hover","never"],default:"hover"},type:{type:String,values:["","card"],default:""},cardScale:{type:Number,default:.83},loop:{type:Boolean,default:!0},direction:{type:String,values:["horizontal","vertical"],default:"horizontal"},pauseOnHover:{type:Boolean,default:!0},motionBlur:Boolean}),SJ={change:(e,t)=>[e,t].every(Wn)},b4=Symbol("carouselContextKey"),iT="ElCarouselItem";var nl=(e=>(e[e.TEXT=1]="TEXT",e[e.CLASS=2]="CLASS",e[e.STYLE=4]="STYLE",e[e.PROPS=8]="PROPS",e[e.FULL_PROPS=16]="FULL_PROPS",e[e.HYDRATE_EVENTS=32]="HYDRATE_EVENTS",e[e.STABLE_FRAGMENT=64]="STABLE_FRAGMENT",e[e.KEYED_FRAGMENT=128]="KEYED_FRAGMENT",e[e.UNKEYED_FRAGMENT=256]="UNKEYED_FRAGMENT",e[e.NEED_PATCH=512]="NEED_PATCH",e[e.DYNAMIC_SLOTS=1024]="DYNAMIC_SLOTS",e[e.HOISTED=-1]="HOISTED",e[e.BAIL=-2]="BAIL",e))(nl||{});function oT(e){return Ji(e)&&e.type===Vn}function TJ(e){return Ji(e)&&e.type===Qo}function CJ(e){return Ji(e)&&!oT(e)&&!TJ(e)}const EJ=e=>{if(!Ji(e))return{};const t=e.props||{},o=(Ji(e.type)?e.type.props:void 0)||{},a={};return Object.keys(o).forEach(d=>{ri(o[d],"default")&&(a[d]=o[d].default)}),Object.keys(t).forEach(d=>{a[ra(d)]=t[d]}),a},MJ=e=>{if(!sn(e)||e.length>1)throw new Error("expect to receive a single Vue element child");return e[0]},Hd=e=>{const t=sn(e)?e:[e],o=[];return t.forEach(a=>{var d;sn(a)?o.push(...Hd(a)):Ji(a)&&((d=a.component)!=null&&d.subTree)?o.push(a,...Hd(a.component.subTree)):Ji(a)&&sn(a.children)?o.push(...Hd(a.children)):o.push(a)}),o},IJ=(e,t,o)=>Hd(e.subTree).filter(p=>{var y;return Ji(p)&&((y=p.type)==null?void 0:y.name)===t&&!!p.component}).map(p=>p.component.uid).map(p=>o[p]).filter(p=>!!p),vE=(e,t)=>{const o={},a=Hi([]);return{children:a,addChild:y=>{o[y.uid]=y,a.value=IJ(e,t,o)},removeChild:y=>{delete o[y],a.value=a.value.filter(r=>r.uid!==y)}}},hR=300,AJ=(e,t,o)=>{const{children:a,addChild:d,removeChild:p}=vE(Cr(),iT),y=Bo(),r=xe(-1),S=xe(null),C=xe(!1),M=xe(),P=xe(0),z=xe(!0),F=xe(!0),V=xe(!1),N=ee(()=>e.arrow!=="never"&&!b(te)),H=ee(()=>a.value.some(Bt=>Bt.props.label.toString().length>0)),U=ee(()=>e.type==="card"),te=ee(()=>e.direction==="vertical"),Z=ee(()=>e.height!=="auto"?{height:e.height}:{height:`${P.value}px`,overflow:"hidden"}),q=gh(Bt=>{ce(Bt)},hR,{trailing:!0}),J=gh(Bt=>{me(Bt)},hR),re=Bt=>z.value?r.value<=1?Bt<=1:Bt>1:!0;function se(){S.value&&(clearInterval(S.value),S.value=null)}function he(){e.interval<=0||!e.autoplay||S.value||(S.value=setInterval(()=>le(),e.interval))}const le=()=>{F.value||(V.value=!0),F.value=!1,r.value<a.value.length-1?r.value=r.value+1:e.loop?r.value=0:V.value=!1};function ce(Bt){if(F.value||(V.value=!0),F.value=!1,Nn(Bt)){const Gt=a.value.filter(Ne=>Ne.props.name===Bt);Gt.length>0&&(Bt=a.value.indexOf(Gt[0]))}if(Bt=Number(Bt),Number.isNaN(Bt)||Bt!==Math.floor(Bt))return;const _t=a.value.length,jt=r.value;Bt<0?r.value=e.loop?_t-1:0:Bt>=_t?r.value=e.loop?0:_t-1:r.value=Bt,jt===r.value&&pe(jt),rt()}function pe(Bt){a.value.forEach((_t,jt)=>{_t.translateItem(jt,r.value,Bt)})}function de(Bt,_t){var jt,Gt,Ne,an;const Ae=b(a),tt=Ae.length;if(tt===0||!Bt.states.inStage)return!1;const Je=_t+1,Jt=_t-1,Kt=tt-1,Nt=Ae[Kt].states.active,Pt=Ae[0].states.active,Dt=(Gt=(jt=Ae[Je])==null?void 0:jt.states)==null?void 0:Gt.active,rn=(an=(Ne=Ae[Jt])==null?void 0:Ne.states)==null?void 0:an.active;return _t===Kt&&Pt||Dt?"left":_t===0&&Nt||rn?"right":!1}function Ie(){C.value=!0,e.pauseOnHover&&se()}function Ve(){C.value=!1,he()}function be(){V.value=!1}function ye(Bt){b(te)||a.value.forEach((_t,jt)=>{Bt===de(_t,jt)&&(_t.states.hover=!0)})}function Me(){b(te)||a.value.forEach(Bt=>{Bt.states.hover=!1})}function we(Bt){Bt!==r.value&&(F.value||(V.value=!0)),r.value=Bt}function me(Bt){e.trigger==="hover"&&Bt!==r.value&&(r.value=Bt,F.value||(V.value=!0))}function De(){ce(r.value-1)}function Ge(){ce(r.value+1)}function rt(){se(),e.pauseOnHover||he()}function Oe(Bt){e.height==="auto"&&(P.value=Bt)}function Ct(){var Bt;const _t=(Bt=y.default)==null?void 0:Bt.call(y);if(!_t)return null;const Gt=Hd(_t).filter(Ne=>Ji(Ne)&&Ne.type.name===iT);return(Gt==null?void 0:Gt.length)===2&&e.loop&&!U.value?(z.value=!0,Gt):(z.value=!1,null)}Wt(()=>r.value,(Bt,_t)=>{pe(_t),z.value&&(Bt=Bt%2,_t=_t%2),_t>-1&&t("change",Bt,_t)}),Wt(()=>e.autoplay,Bt=>{Bt?he():se()}),Wt(()=>e.loop,()=>{ce(r.value)}),Wt(()=>e.interval,()=>{rt()});const kt=Hi();return yr(()=>{Wt(()=>a.value,()=>{a.value.length>0&&ce(e.initialIndex)},{immediate:!0}),kt.value=ro(M.value,()=>{pe()}),he()}),Li(()=>{se(),M.value&&kt.value&&kt.value.stop()}),Vr(b4,{root:M,isCardType:U,isVertical:te,items:a,loop:e.loop,cardScale:e.cardScale,addItem:d,removeItem:p,setActiveItem:ce,setContainerHeight:Oe}),{root:M,activeIndex:r,arrowDisplay:N,hasLabel:H,hover:C,isCardType:U,isTransitioning:V,items:a,isVertical:te,containerStyle:Z,isItemsTwoLength:z,handleButtonEnter:ye,handleTransitionEnd:be,handleButtonLeave:Me,handleIndicatorClick:we,handleMouseEnter:Ie,handleMouseLeave:Ve,setActiveItem:ce,prev:De,next:Ge,PlaceholderItem:Ct,isTwoLengthShow:re,throttledArrowClick:q,throttledIndicatorHover:J}},kJ="ElCarousel",PJ=We({name:kJ}),RJ=We({...PJ,props:wJ,emits:SJ,setup(e,{expose:t,emit:o}){const a=e,{root:d,activeIndex:p,arrowDisplay:y,hasLabel:r,hover:S,isCardType:C,items:M,isVertical:P,containerStyle:z,handleButtonEnter:F,handleButtonLeave:V,isTransitioning:N,handleIndicatorClick:H,handleMouseEnter:U,handleMouseLeave:te,handleTransitionEnd:Z,setActiveItem:q,prev:J,next:re,PlaceholderItem:se,isTwoLengthShow:he,throttledArrowClick:le,throttledIndicatorHover:ce}=AJ(a,o),pe=Xt("carousel"),{t:de}=qr(),Ie=ee(()=>{const ye=[pe.b(),pe.m(a.direction)];return b(C)&&ye.push(pe.m("card")),ye}),Ve=ee(()=>{const ye=[pe.e("container")];return a.motionBlur&&b(N)&&M.value.length>1&&ye.push(b(P)?`${pe.namespace.value}-transitioning-vertical`:`${pe.namespace.value}-transitioning`),ye}),be=ee(()=>{const ye=[pe.e("indicators"),pe.em("indicators",a.direction)];return b(r)&&ye.push(pe.em("indicators","labels")),a.indicatorPosition==="outside"&&ye.push(pe.em("indicators","outside")),b(P)&&ye.push(pe.em("indicators","right")),ye});return t({activeIndex:p,setActiveItem:q,prev:J,next:re}),(ye,Me)=>(ae(),Pe("div",{ref_key:"root",ref:d,class:fe(b(Ie)),onMouseenter:Jn(b(U),["stop"]),onMouseleave:Jn(b(te),["stop"])},[b(y)?(ae(),At(rs,{key:0,name:"carousel-arrow-left",persisted:""},{default:ot(()=>[hr(Ue("button",{type:"button",class:fe([b(pe).e("arrow"),b(pe).em("arrow","left")]),"aria-label":b(de)("el.carousel.leftArrow"),onMouseenter:we=>b(F)("left"),onMouseleave:b(V),onClick:Jn(we=>b(le)(b(p)-1),["stop"])},[qe(b(zn),null,{default:ot(()=>[qe(b(Yd))]),_:1})],42,["aria-label","onMouseenter","onMouseleave","onClick"]),[[ii,(ye.arrow==="always"||b(S))&&(a.loop||b(p)>0)]])]),_:1})):bt("v-if",!0),b(y)?(ae(),At(rs,{key:1,name:"carousel-arrow-right",persisted:""},{default:ot(()=>[hr(Ue("button",{type:"button",class:fe([b(pe).e("arrow"),b(pe).em("arrow","right")]),"aria-label":b(de)("el.carousel.rightArrow"),onMouseenter:we=>b(F)("right"),onMouseleave:b(V),onClick:Jn(we=>b(le)(b(p)+1),["stop"])},[qe(b(zn),null,{default:ot(()=>[qe(b(ta))]),_:1})],42,["aria-label","onMouseenter","onMouseleave","onClick"]),[[ii,(ye.arrow==="always"||b(S))&&(a.loop||b(p)<b(M).length-1)]])]),_:1})):bt("v-if",!0),Ue("div",{class:fe(b(Ve)),style:Un(b(z)),onTransitionend:b(Z)},[qe(b(se)),gt(ye.$slots,"default")],46,["onTransitionend"]),ye.indicatorPosition!=="none"?(ae(),Pe("ul",{key:2,class:fe(b(be))},[(ae(!0),Pe(Vn,null,Fr(b(M),(we,me)=>hr((ae(),Pe("li",{key:me,class:fe([b(pe).e("indicator"),b(pe).em("indicator",ye.direction),b(pe).is("active",me===b(p))]),onMouseenter:De=>b(ce)(me),onClick:Jn(De=>b(H)(me),["stop"])},[Ue("button",{class:fe(b(pe).e("button")),"aria-label":b(de)("el.carousel.indicator",{index:me+1})},[b(r)?(ae(),Pe("span",{key:0},fn(we.props.label),1)):bt("v-if",!0)],10,["aria-label"])],42,["onMouseenter","onClick"])),[[ii,b(he)(me)]])),128))],2)):bt("v-if",!0),a.motionBlur?(ae(),Pe("svg",{key:3,xmlns:"http://www.w3.org/2000/svg",version:"1.1",style:{display:"none"}},[Ue("defs",null,[Ue("filter",{id:"elCarouselHorizontal"},[Ue("feGaussianBlur",{in:"SourceGraphic",stdDeviation:"12,0"})]),Ue("filter",{id:"elCarouselVertical"},[Ue("feGaussianBlur",{in:"SourceGraphic",stdDeviation:"0,10"})])])])):bt("v-if",!0)],42,["onMouseenter","onMouseleave"]))}});var OJ=dn(RJ,[["__file","carousel.vue"]]);const LJ=un({name:{type:String,default:""},label:{type:[String,Number],default:""}}),DJ=e=>{const t=Pn(b4),o=Cr(),a=xe(),d=xe(!1),p=xe(0),y=xe(1),r=xe(!1),S=xe(!1),C=xe(!1),M=xe(!1),{isCardType:P,isVertical:z,cardScale:F}=t;function V(Z,q,J){const re=J-1,se=q-1,he=q+1,le=J/2;return q===0&&Z===re?-1:q===re&&Z===0?J:Z<se&&q-Z>=le?J+1:Z>he&&Z-q>=le?-2:Z}function N(Z,q){var J,re;const se=b(z)?((J=t.root.value)==null?void 0:J.offsetHeight)||0:((re=t.root.value)==null?void 0:re.offsetWidth)||0;return C.value?se*((2-F)*(Z-q)+1)/4:Z<q?-(1+F)*se/4:(3+F)*se/4}function H(Z,q,J){const re=t.root.value;return re?((J?re.offsetHeight:re.offsetWidth)||0)*(Z-q):0}const U=(Z,q,J)=>{var re;const se=b(P),he=(re=t.items.value.length)!=null?re:Number.NaN,le=Z===q;!se&&!ai(J)&&(M.value=le||Z===J),!le&&he>2&&t.loop&&(Z=V(Z,q,he));const ce=b(z);r.value=le,se?(C.value=Math.round(Math.abs(Z-q))<=1,p.value=N(Z,q),y.value=b(r)?1:F):p.value=H(Z,q,ce),S.value=!0,le&&a.value&&t.setContainerHeight(a.value.offsetHeight)};function te(){if(t&&b(P)){const Z=t.items.value.findIndex(({uid:q})=>q===o.uid);t.setActiveItem(Z)}}return yr(()=>{t.addItem({props:e,states:si({hover:d,translate:p,scale:y,active:r,ready:S,inStage:C,animating:M}),uid:o.uid,translateItem:U})}),rf(()=>{t.removeItem(o.uid)}),{carouselItemRef:a,active:r,animating:M,hover:d,inStage:C,isVertical:z,translate:p,isCardType:P,scale:y,ready:S,handleItemClick:te}},zJ=We({name:iT}),FJ=We({...zJ,props:LJ,setup(e){const t=e,o=Xt("carousel"),{carouselItemRef:a,active:d,animating:p,hover:y,inStage:r,isVertical:S,translate:C,isCardType:M,scale:P,ready:z,handleItemClick:F}=DJ(t),V=ee(()=>[o.e("item"),o.is("active",d.value),o.is("in-stage",r.value),o.is("hover",y.value),o.is("animating",p.value),{[o.em("item","card")]:M.value,[o.em("item","card-vertical")]:M.value&&S.value}]),N=ee(()=>{const U=`${`translate${b(S)?"Y":"X"}`}(${b(C)}px)`,te=`scale(${b(P)})`;return{transform:[U,te].join(" ")}});return(H,U)=>hr((ae(),Pe("div",{ref_key:"carouselItemRef",ref:a,class:fe(b(V)),style:Un(b(N)),onClick:b(F)},[b(M)?hr((ae(),Pe("div",{key:0,class:fe(b(o).e("mask"))},null,2)),[[ii,!b(d)]]):bt("v-if",!0),gt(H.$slots,"default")],14,["onClick"])),[[ii,b(z)]])}});var x4=dn(FJ,[["__file","carousel-item.vue"]]);const NJ=lr(OJ,{CarouselItem:x4}),BJ=oo(x4),w4={modelValue:{type:[Number,String,Boolean],default:void 0},label:{type:[String,Boolean,Number,Object],default:void 0},value:{type:[String,Boolean,Number,Object],default:void 0},indeterminate:Boolean,disabled:Boolean,checked:Boolean,name:{type:String,default:void 0},trueValue:{type:[String,Number],default:void 0},falseValue:{type:[String,Number],default:void 0},trueLabel:{type:[String,Number],default:void 0},falseLabel:{type:[String,Number],default:void 0},id:{type:String,default:void 0},border:Boolean,size:zo,tabindex:[String,Number],validateEvent:{type:Boolean,default:!0},...cs(["ariaControls"])},S4={[gr]:e=>Nn(e)||Wn(e)||Oi(e),change:e=>Nn(e)||Wn(e)||Oi(e)},ug=Symbol("checkboxGroupContextKey"),VJ=({model:e,isChecked:t})=>{const o=Pn(ug,void 0),a=ee(()=>{var p,y;const r=(p=o==null?void 0:o.max)==null?void 0:p.value,S=(y=o==null?void 0:o.min)==null?void 0:y.value;return!ai(r)&&e.value.length>=r&&!t.value||!ai(S)&&e.value.length<=S&&t.value});return{isDisabled:ws(ee(()=>(o==null?void 0:o.disabled.value)||a.value)),isLimitDisabled:a}},$J=(e,{model:t,isLimitExceeded:o,hasOwnLabel:a,isDisabled:d,isLabeledByFormItem:p})=>{const y=Pn(ug,void 0),{formItem:r}=xs(),{emit:S}=Cr();function C(V){var N,H,U,te;return[!0,e.trueValue,e.trueLabel].includes(V)?(H=(N=e.trueValue)!=null?N:e.trueLabel)!=null?H:!0:(te=(U=e.falseValue)!=null?U:e.falseLabel)!=null?te:!1}function M(V,N){S("change",C(V),N)}function P(V){if(o.value)return;const N=V.target;S("change",C(N.checked),V)}async function z(V){o.value||!a.value&&!d.value&&p.value&&(V.composedPath().some(U=>U.tagName==="LABEL")||(t.value=C([!1,e.falseValue,e.falseLabel].includes(t.value)),await jn(),M(t.value,V)))}const F=ee(()=>(y==null?void 0:y.validateEvent)||e.validateEvent);return Wt(()=>e.modelValue,()=>{F.value&&(r==null||r.validate("change").catch(V=>void 0))}),{handleChange:P,onClickRoot:z}},UJ=e=>{const t=xe(!1),{emit:o}=Cr(),a=Pn(ug,void 0),d=ee(()=>ai(a)===!1),p=xe(!1),y=ee({get(){var r,S;return d.value?(r=a==null?void 0:a.modelValue)==null?void 0:r.value:(S=e.modelValue)!=null?S:t.value},set(r){var S,C;d.value&&sn(r)?(p.value=((S=a==null?void 0:a.max)==null?void 0:S.value)!==void 0&&r.length>(a==null?void 0:a.max.value)&&r.length>y.value.length,p.value===!1&&((C=a==null?void 0:a.changeEvent)==null||C.call(a,r))):(o(gr,r),t.value=r)}});return{model:y,isGroup:d,isLimitExceeded:p}},jJ=(e,t,{model:o})=>{const a=Pn(ug,void 0),d=xe(!1),p=ee(()=>Yl(e.value)?e.label:e.value),y=ee(()=>{const M=o.value;return Oi(M)?M:sn(M)?xr(p.value)?M.map(wi).some(P=>_s(P,p.value)):M.map(wi).includes(p.value):M!=null?M===e.trueValue||M===e.trueLabel:!!M}),r=Ro(ee(()=>{var M;return(M=a==null?void 0:a.size)==null?void 0:M.value}),{prop:!0}),S=Ro(ee(()=>{var M;return(M=a==null?void 0:a.size)==null?void 0:M.value})),C=ee(()=>!!t.default||!Yl(p.value));return{checkboxButtonSize:r,isChecked:y,isFocused:d,checkboxSize:S,hasOwnLabel:C,actualValue:p}},T4=(e,t)=>{const{formItem:o}=xs(),{model:a,isGroup:d,isLimitExceeded:p}=UJ(e),{isFocused:y,isChecked:r,checkboxButtonSize:S,checkboxSize:C,hasOwnLabel:M,actualValue:P}=jJ(e,t,{model:a}),{isDisabled:z}=VJ({model:a,isChecked:r}),{inputId:F,isLabeledByFormItem:V}=ml(e,{formItemContext:o,disableIdGeneration:M,disableIdManagement:d}),{handleChange:N,onClickRoot:H}=$J(e,{model:a,isLimitExceeded:p,hasOwnLabel:M,isDisabled:z,isLabeledByFormItem:V});return(()=>{function te(){var Z,q;sn(a.value)&&!a.value.includes(P.value)?a.value.push(P.value):a.value=(q=(Z=e.trueValue)!=null?Z:e.trueLabel)!=null?q:!0}e.checked&&te()})(),Ud({from:"label act as value",replacement:"value",version:"3.0.0",scope:"el-checkbox",ref:"https://element-plus.org/en-US/component/checkbox.html"},ee(()=>d.value&&Yl(e.value))),Ud({from:"true-label",replacement:"true-value",version:"3.0.0",scope:"el-checkbox",ref:"https://element-plus.org/en-US/component/checkbox.html"},ee(()=>!!e.trueLabel)),Ud({from:"false-label",replacement:"false-value",version:"3.0.0",scope:"el-checkbox",ref:"https://element-plus.org/en-US/component/checkbox.html"},ee(()=>!!e.falseLabel)),{inputId:F,isLabeledByFormItem:V,isChecked:r,isDisabled:z,isFocused:y,checkboxButtonSize:S,checkboxSize:C,hasOwnLabel:M,model:a,actualValue:P,handleChange:N,onClickRoot:H}},HJ=We({name:"ElCheckbox"}),GJ=We({...HJ,props:w4,emits:S4,setup(e){const t=e,o=Bo(),{inputId:a,isLabeledByFormItem:d,isChecked:p,isDisabled:y,isFocused:r,checkboxSize:S,hasOwnLabel:C,model:M,actualValue:P,handleChange:z,onClickRoot:F}=T4(t,o),V=Xt("checkbox"),N=ee(()=>[V.b(),V.m(S.value),V.is("disabled",y.value),V.is("bordered",t.border),V.is("checked",p.value)]),H=ee(()=>[V.e("input"),V.is("disabled",y.value),V.is("checked",p.value),V.is("indeterminate",t.indeterminate),V.is("focus",r.value)]);return(U,te)=>(ae(),At(Ir(!b(C)&&b(d)?"span":"label"),{class:fe(b(N)),"aria-controls":U.indeterminate?U.ariaControls:null,onClick:b(F)},{default:ot(()=>{var Z,q,J,re;return[Ue("span",{class:fe(b(H))},[U.trueValue||U.falseValue||U.trueLabel||U.falseLabel?hr((ae(),Pe("input",{key:0,id:b(a),"onUpdate:modelValue":se=>Ti(M)?M.value=se:null,class:fe(b(V).e("original")),type:"checkbox",indeterminate:U.indeterminate,name:U.name,tabindex:U.tabindex,disabled:b(y),"true-value":(q=(Z=U.trueValue)!=null?Z:U.trueLabel)!=null?q:!0,"false-value":(re=(J=U.falseValue)!=null?J:U.falseLabel)!=null?re:!1,onChange:b(z),onFocus:se=>r.value=!0,onBlur:se=>r.value=!1,onClick:Jn(()=>{},["stop"])},null,42,["id","onUpdate:modelValue","indeterminate","name","tabindex","disabled","true-value","false-value","onChange","onFocus","onBlur","onClick"])),[[v1,b(M)]]):hr((ae(),Pe("input",{key:1,id:b(a),"onUpdate:modelValue":se=>Ti(M)?M.value=se:null,class:fe(b(V).e("original")),type:"checkbox",indeterminate:U.indeterminate,disabled:b(y),value:b(P),name:U.name,tabindex:U.tabindex,onChange:b(z),onFocus:se=>r.value=!0,onBlur:se=>r.value=!1,onClick:Jn(()=>{},["stop"])},null,42,["id","onUpdate:modelValue","indeterminate","disabled","value","name","tabindex","onChange","onFocus","onBlur","onClick"])),[[v1,b(M)]]),Ue("span",{class:fe(b(V).e("inner"))},null,2)],2),b(C)?(ae(),Pe("span",{key:0,class:fe(b(V).e("label"))},[gt(U.$slots,"default"),U.$slots.default?bt("v-if",!0):(ae(),Pe(Vn,{key:0},[Nr(fn(U.label),1)],64))],2)):bt("v-if",!0)]}),_:3},8,["class","aria-controls","onClick"]))}});var WJ=dn(GJ,[["__file","checkbox.vue"]]);const qJ=We({name:"ElCheckboxButton"}),KJ=We({...qJ,props:w4,emits:S4,setup(e){const t=e,o=Bo(),{isFocused:a,isChecked:d,isDisabled:p,checkboxButtonSize:y,model:r,actualValue:S,handleChange:C}=T4(t,o),M=Pn(ug,void 0),P=Xt("checkbox"),z=ee(()=>{var V,N,H,U;const te=(N=(V=M==null?void 0:M.fill)==null?void 0:V.value)!=null?N:"";return{backgroundColor:te,borderColor:te,color:(U=(H=M==null?void 0:M.textColor)==null?void 0:H.value)!=null?U:"",boxShadow:te?`-1px 0 0 0 ${te}`:void 0}}),F=ee(()=>[P.b("button"),P.bm("button",y.value),P.is("disabled",p.value),P.is("checked",d.value),P.is("focus",a.value)]);return(V,N)=>{var H,U,te,Z;return ae(),Pe("label",{class:fe(b(F))},[V.trueValue||V.falseValue||V.trueLabel||V.falseLabel?hr((ae(),Pe("input",{key:0,"onUpdate:modelValue":q=>Ti(r)?r.value=q:null,class:fe(b(P).be("button","original")),type:"checkbox",name:V.name,tabindex:V.tabindex,disabled:b(p),"true-value":(U=(H=V.trueValue)!=null?H:V.trueLabel)!=null?U:!0,"false-value":(Z=(te=V.falseValue)!=null?te:V.falseLabel)!=null?Z:!1,onChange:b(C),onFocus:q=>a.value=!0,onBlur:q=>a.value=!1,onClick:Jn(()=>{},["stop"])},null,42,["onUpdate:modelValue","name","tabindex","disabled","true-value","false-value","onChange","onFocus","onBlur","onClick"])),[[v1,b(r)]]):hr((ae(),Pe("input",{key:1,"onUpdate:modelValue":q=>Ti(r)?r.value=q:null,class:fe(b(P).be("button","original")),type:"checkbox",name:V.name,tabindex:V.tabindex,disabled:b(p),value:b(S),onChange:b(C),onFocus:q=>a.value=!0,onBlur:q=>a.value=!1,onClick:Jn(()=>{},["stop"])},null,42,["onUpdate:modelValue","name","tabindex","disabled","value","onChange","onFocus","onBlur","onClick"])),[[v1,b(r)]]),V.$slots.default||V.label?(ae(),Pe("span",{key:2,class:fe(b(P).be("button","inner")),style:Un(b(d)?b(z):void 0)},[gt(V.$slots,"default",{},()=>[Nr(fn(V.label),1)])],6)):bt("v-if",!0)],2)}}});var C4=dn(KJ,[["__file","checkbox-button.vue"]]);const ZJ=un({modelValue:{type:lt(Array),default:()=>[]},disabled:Boolean,min:Number,max:Number,size:zo,fill:String,textColor:String,tag:{type:String,default:"div"},validateEvent:{type:Boolean,default:!0},...cs(["ariaLabel"])}),YJ={[gr]:e=>sn(e),change:e=>sn(e)},XJ=We({name:"ElCheckboxGroup"}),JJ=We({...XJ,props:ZJ,emits:YJ,setup(e,{emit:t}){const o=e,a=Xt("checkbox"),{formItem:d}=xs(),{inputId:p,isLabeledByFormItem:y}=ml(o,{formItemContext:d}),r=async C=>{t(gr,C),await jn(),t("change",C)},S=ee({get(){return o.modelValue},set(C){r(C)}});return Vr(ug,{...Wl(Go(o),["size","min","max","disabled","validateEvent","fill","textColor"]),modelValue:S,changeEvent:r}),Wt(()=>o.modelValue,()=>{o.validateEvent&&(d==null||d.validate("change").catch(C=>void 0))}),(C,M)=>{var P;return ae(),At(Ir(C.tag),{id:b(p),class:fe(b(a).b("group")),role:"group","aria-label":b(y)?void 0:C.ariaLabel||"checkbox-group","aria-labelledby":b(y)?(P=b(d))==null?void 0:P.labelId:void 0},{default:ot(()=>[gt(C.$slots,"default")]),_:3},8,["id","class","aria-label","aria-labelledby"])}}});var E4=dn(JJ,[["__file","checkbox-group.vue"]]);const pl=lr(WJ,{CheckboxButton:C4,CheckboxGroup:E4}),QJ=oo(C4),M4=oo(E4),I4=un({modelValue:{type:[String,Number,Boolean],default:void 0},size:zo,disabled:Boolean,label:{type:[String,Number,Boolean],default:void 0},value:{type:[String,Number,Boolean],default:void 0},name:{type:String,default:void 0}}),eQ=un({...I4,border:Boolean}),A4={[gr]:e=>Nn(e)||Wn(e)||Oi(e),[Ii]:e=>Nn(e)||Wn(e)||Oi(e)},k4=Symbol("radioGroupKey"),P4=(e,t)=>{const o=xe(),a=Pn(k4,void 0),d=ee(()=>!!a),p=ee(()=>Yl(e.value)?e.label:e.value),y=ee({get(){return d.value?a.modelValue:e.modelValue},set(P){d.value?a.changeEvent(P):t&&t(gr,P),o.value.checked=e.modelValue===p.value}}),r=Ro(ee(()=>a==null?void 0:a.size)),S=ws(ee(()=>a==null?void 0:a.disabled)),C=xe(!1),M=ee(()=>S.value||d.value&&y.value!==p.value?-1:0);return Ud({from:"label act as value",replacement:"value",version:"3.0.0",scope:"el-radio",ref:"https://element-plus.org/en-US/component/radio.html"},ee(()=>d.value&&Yl(e.value))),{radioRef:o,isGroup:d,radioGroup:a,focus:C,size:r,disabled:S,tabIndex:M,modelValue:y,actualValue:p}},tQ=We({name:"ElRadio"}),nQ=We({...tQ,props:eQ,emits:A4,setup(e,{emit:t}){const o=e,a=Xt("radio"),{radioRef:d,radioGroup:p,focus:y,size:r,disabled:S,modelValue:C,actualValue:M}=P4(o,t);function P(){jn(()=>t("change",C.value))}return(z,F)=>{var V;return ae(),Pe("label",{class:fe([b(a).b(),b(a).is("disabled",b(S)),b(a).is("focus",b(y)),b(a).is("bordered",z.border),b(a).is("checked",b(C)===b(M)),b(a).m(b(r))])},[Ue("span",{class:fe([b(a).e("input"),b(a).is("disabled",b(S)),b(a).is("checked",b(C)===b(M))])},[hr(Ue("input",{ref_key:"radioRef",ref:d,"onUpdate:modelValue":N=>Ti(C)?C.value=N:null,class:fe(b(a).e("original")),value:b(M),name:z.name||((V=b(p))==null?void 0:V.name),disabled:b(S),checked:b(C)===b(M),type:"radio",onFocus:N=>y.value=!0,onBlur:N=>y.value=!1,onChange:P,onClick:Jn(()=>{},["stop"])},null,42,["onUpdate:modelValue","value","name","disabled","checked","onFocus","onBlur","onClick"]),[[dD,b(C)]]),Ue("span",{class:fe(b(a).e("inner"))},null,2)],2),Ue("span",{class:fe(b(a).e("label")),onKeydown:Jn(()=>{},["stop"])},[gt(z.$slots,"default",{},()=>[Nr(fn(z.label),1)])],42,["onKeydown"])],2)}}});var rQ=dn(nQ,[["__file","radio.vue"]]);const iQ=un({...I4}),oQ=We({name:"ElRadioButton"}),sQ=We({...oQ,props:iQ,setup(e){const t=e,o=Xt("radio"),{radioRef:a,focus:d,size:p,disabled:y,modelValue:r,radioGroup:S,actualValue:C}=P4(t),M=ee(()=>({backgroundColor:(S==null?void 0:S.fill)||"",borderColor:(S==null?void 0:S.fill)||"",boxShadow:S!=null&&S.fill?`-1px 0 0 0 ${S.fill}`:"",color:(S==null?void 0:S.textColor)||""}));return(P,z)=>{var F;return ae(),Pe("label",{class:fe([b(o).b("button"),b(o).is("active",b(r)===b(C)),b(o).is("disabled",b(y)),b(o).is("focus",b(d)),b(o).bm("button",b(p))])},[hr(Ue("input",{ref_key:"radioRef",ref:a,"onUpdate:modelValue":V=>Ti(r)?r.value=V:null,class:fe(b(o).be("button","original-radio")),value:b(C),type:"radio",name:P.name||((F=b(S))==null?void 0:F.name),disabled:b(y),onFocus:V=>d.value=!0,onBlur:V=>d.value=!1,onClick:Jn(()=>{},["stop"])},null,42,["onUpdate:modelValue","value","name","disabled","onFocus","onBlur","onClick"]),[[dD,b(r)]]),Ue("span",{class:fe(b(o).be("button","inner")),style:Un(b(r)===b(C)?b(M):{}),onKeydown:Jn(()=>{},["stop"])},[gt(P.$slots,"default",{},()=>[Nr(fn(P.label),1)])],46,["onKeydown"])],2)}}});var R4=dn(sQ,[["__file","radio-button.vue"]]);const aQ=un({id:{type:String,default:void 0},size:zo,disabled:Boolean,modelValue:{type:[String,Number,Boolean],default:void 0},fill:{type:String,default:""},textColor:{type:String,default:""},name:{type:String,default:void 0},validateEvent:{type:Boolean,default:!0},...cs(["ariaLabel"])}),lQ=A4,uQ=We({name:"ElRadioGroup"}),cQ=We({...uQ,props:aQ,emits:lQ,setup(e,{emit:t}){const o=e,a=Xt("radio"),d=us(),p=xe(),{formItem:y}=xs(),{inputId:r,isLabeledByFormItem:S}=ml(o,{formItemContext:y}),C=P=>{t(gr,P),jn(()=>t("change",P))};yr(()=>{const P=p.value.querySelectorAll("[type=radio]"),z=P[0];!Array.from(P).some(F=>F.checked)&&z&&(z.tabIndex=0)});const M=ee(()=>o.name||d.value);return Vr(k4,si({...Go(o),changeEvent:C,name:M})),Wt(()=>o.modelValue,()=>{o.validateEvent&&(y==null||y.validate("change").catch(P=>void 0))}),(P,z)=>(ae(),Pe("div",{id:b(r),ref_key:"radioGroupRef",ref:p,class:fe(b(a).b("group")),role:"radiogroup","aria-label":b(S)?void 0:P.ariaLabel||"radio-group","aria-labelledby":b(S)?b(y).labelId:void 0},[gt(P.$slots,"default")],10,["id","aria-label","aria-labelledby"]))}});var O4=dn(cQ,[["__file","radio-group.vue"]]);const L4=lr(rQ,{RadioButton:R4,RadioGroup:O4}),dQ=oo(O4),fQ=oo(R4);var hQ=We({name:"NodeContent",setup(){return{ns:Xt("cascader-node")}},render(){const{ns:e}=this,{node:t,panel:o}=this.$parent,{data:a,label:d}=t,{renderLabelFn:p}=o;return Zn("span",{class:e.e("label")},p?p({node:t,data:a}):d)}});const bE=Symbol(),pQ=We({name:"ElCascaderNode",components:{ElCheckbox:pl,ElRadio:L4,NodeContent:hQ,ElIcon:zn,Check:lv,Loading:Fu,ArrowRight:ta},props:{node:{type:Object,required:!0},menuId:String},emits:["expand"],setup(e,{emit:t}){const o=Pn(bE),a=Xt("cascader-node"),d=ee(()=>o.isHoverMenu),p=ee(()=>o.config.multiple),y=ee(()=>o.config.checkStrictly),r=ee(()=>{var re;return(re=o.checkedNodes[0])==null?void 0:re.uid}),S=ee(()=>e.node.isDisabled),C=ee(()=>e.node.isLeaf),M=ee(()=>y.value&&!C.value||!S.value),P=ee(()=>F(o.expandingNode)),z=ee(()=>y.value&&o.checkedNodes.some(F)),F=re=>{var se;const{level:he,uid:le}=e.node;return((se=re==null?void 0:re.pathNodes[he-1])==null?void 0:se.uid)===le},V=()=>{P.value||o.expandNode(e.node)},N=re=>{const{node:se}=e;re!==se.checked&&o.handleCheckChange(se,re)},H=()=>{o.lazyLoad(e.node,()=>{C.value||V()})},U=re=>{d.value&&(te(),!C.value&&t("expand",re))},te=()=>{const{node:re}=e;!M.value||re.loading||(re.loaded?V():H())},Z=()=>{d.value&&!C.value||(C.value&&!S.value&&!y.value&&!p.value?J(!0):te())},q=re=>{y.value?(N(re),e.node.loaded&&V()):J(re)},J=re=>{e.node.loaded?(N(re),!y.value&&V()):H()};return{panel:o,isHoverMenu:d,multiple:p,checkStrictly:y,checkedNodeId:r,isDisabled:S,isLeaf:C,expandable:M,inExpandingPath:P,inCheckedPath:z,ns:a,handleHoverExpand:U,handleExpand:te,handleClick:Z,handleCheck:J,handleSelectCheck:q}}});function mQ(e,t,o,a,d,p){const y=Er("el-checkbox"),r=Er("el-radio"),S=Er("check"),C=Er("el-icon"),M=Er("node-content"),P=Er("loading"),z=Er("arrow-right");return ae(),Pe("li",{id:`${e.menuId}-${e.node.uid}`,role:"menuitem","aria-haspopup":!e.isLeaf,"aria-owns":e.isLeaf?null:e.menuId,"aria-expanded":e.inExpandingPath,tabindex:e.expandable?-1:void 0,class:fe([e.ns.b(),e.ns.is("selectable",e.checkStrictly),e.ns.is("active",e.node.checked),e.ns.is("disabled",!e.expandable),e.inExpandingPath&&"in-active-path",e.inCheckedPath&&"in-checked-path"]),onMouseenter:e.handleHoverExpand,onFocus:e.handleHoverExpand,onClick:e.handleClick},[bt(" prefix "),e.multiple?(ae(),At(y,{key:0,"model-value":e.node.checked,indeterminate:e.node.indeterminate,disabled:e.isDisabled,onClick:Jn(()=>{},["stop"]),"onUpdate:modelValue":e.handleSelectCheck},null,8,["model-value","indeterminate","disabled","onClick","onUpdate:modelValue"])):e.checkStrictly?(ae(),At(r,{key:1,"model-value":e.checkedNodeId,label:e.node.uid,disabled:e.isDisabled,"onUpdate:modelValue":e.handleSelectCheck,onClick:Jn(()=>{},["stop"])},{default:ot(()=>[bt(`
        Add an empty element to avoid render label,
        do not use empty fragment here for https://github.com/vuejs/vue-next/pull/2485
      `),Ue("span")]),_:1},8,["model-value","label","disabled","onUpdate:modelValue","onClick"])):e.isLeaf&&e.node.checked?(ae(),At(C,{key:2,class:fe(e.ns.e("prefix"))},{default:ot(()=>[qe(S)]),_:1},8,["class"])):bt("v-if",!0),bt(" content "),qe(M),bt(" postfix "),e.isLeaf?bt("v-if",!0):(ae(),Pe(Vn,{key:3},[e.node.loading?(ae(),At(C,{key:0,class:fe([e.ns.is("loading"),e.ns.e("postfix")])},{default:ot(()=>[qe(P)]),_:1},8,["class"])):(ae(),At(C,{key:1,class:fe(["arrow-right",e.ns.e("postfix")])},{default:ot(()=>[qe(z)]),_:1},8,["class"]))],64))],42,["id","aria-haspopup","aria-owns","aria-expanded","tabindex","onMouseenter","onFocus","onClick"])}var gQ=dn(pQ,[["render",mQ],["__file","node.vue"]]);const _Q=We({name:"ElCascaderMenu",components:{Loading:Fu,ElIcon:zn,ElScrollbar:Hu,ElCascaderNode:gQ},props:{nodes:{type:Array,required:!0},index:{type:Number,required:!0}},setup(e){const t=Cr(),o=Xt("cascader-menu"),{t:a}=qr(),d=us();let p=null,y=null;const r=Pn(bE),S=xe(null),C=ee(()=>!e.nodes.length),M=ee(()=>!r.initialLoaded),P=ee(()=>`${d.value}-${e.index}`),z=H=>{p=H.target},F=H=>{if(!(!r.isHoverMenu||!p||!S.value))if(p.contains(H.target)){V();const U=t.vnode.el,{left:te}=U.getBoundingClientRect(),{offsetWidth:Z,offsetHeight:q}=U,J=H.clientX-te,re=p.offsetTop,se=re+p.offsetHeight;S.value.innerHTML=`
          <path style="pointer-events: auto;" fill="transparent" d="M${J} ${re} L${Z} 0 V${re} Z" />
          <path style="pointer-events: auto;" fill="transparent" d="M${J} ${se} L${Z} ${q} V${se} Z" />
        `}else y||(y=window.setTimeout(N,r.config.hoverThreshold))},V=()=>{y&&(clearTimeout(y),y=null)},N=()=>{S.value&&(S.value.innerHTML="",V())};return{ns:o,panel:r,hoverZone:S,isEmpty:C,isLoading:M,menuId:P,t:a,handleExpand:z,handleMouseMove:F,clearHoverZone:N}}});function yQ(e,t,o,a,d,p){const y=Er("el-cascader-node"),r=Er("loading"),S=Er("el-icon"),C=Er("el-scrollbar");return ae(),At(C,{key:e.menuId,tag:"ul",role:"menu",class:fe(e.ns.b()),"wrap-class":e.ns.e("wrap"),"view-class":[e.ns.e("list"),e.ns.is("empty",e.isEmpty)],onMousemove:e.handleMouseMove,onMouseleave:e.clearHoverZone},{default:ot(()=>{var M;return[(ae(!0),Pe(Vn,null,Fr(e.nodes,P=>(ae(),At(y,{key:P.uid,node:P,"menu-id":e.menuId,onExpand:e.handleExpand},null,8,["node","menu-id","onExpand"]))),128)),e.isLoading?(ae(),Pe("div",{key:0,class:fe(e.ns.e("empty-text"))},[qe(S,{size:"14",class:fe(e.ns.is("loading"))},{default:ot(()=>[qe(r)]),_:1},8,["class"]),Nr(" "+fn(e.t("el.cascader.loading")),1)],2)):e.isEmpty?(ae(),Pe("div",{key:1,class:fe(e.ns.e("empty-text"))},[gt(e.$slots,"empty",{},()=>[Nr(fn(e.t("el.cascader.noData")),1)])],2)):(M=e.panel)!=null&&M.isHoverMenu?(ae(),Pe("svg",{key:2,ref:"hoverZone",class:fe(e.ns.e("hover-zone"))},null,2)):bt("v-if",!0)]}),_:3},8,["class","wrap-class","view-class","onMousemove","onMouseleave"])}var vQ=dn(_Q,[["render",yQ],["__file","menu.vue"]]);const xE=(e="")=>e.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d"),Pu=e=>Jy(e);let bQ=0;const xQ=e=>{const t=[e];let{parent:o}=e;for(;o;)t.unshift(o),o=o.parent;return t};let sT=class aT{constructor(t,o,a,d=!1){this.data=t,this.config=o,this.parent=a,this.root=d,this.uid=bQ++,this.checked=!1,this.indeterminate=!1,this.loading=!1;const{value:p,label:y,children:r}=o,S=t[r],C=xQ(this);this.level=d?0:a?a.level+1:1,this.value=t[p],this.label=t[y],this.pathNodes=C,this.pathValues=C.map(M=>M.value),this.pathLabels=C.map(M=>M.label),this.childrenData=S,this.children=(S||[]).map(M=>new aT(M,o,this)),this.loaded=!o.lazy||this.isLeaf||!$a(S)}get isDisabled(){const{data:t,parent:o,config:a}=this,{disabled:d,checkStrictly:p}=a;return($n(d)?d(t,this):!!t[d])||!p&&(o==null?void 0:o.isDisabled)}get isLeaf(){const{data:t,config:o,childrenData:a,loaded:d}=this,{lazy:p,leaf:y}=o,r=$n(y)?y(t,this):t[y];return ai(r)?p&&!d?!1:!(sn(a)&&a.length):!!r}get valueByOption(){return this.config.emitPath?this.pathValues:this.value}appendChild(t){const{childrenData:o,children:a}=this,d=new aT(t,this.config,this);return sn(o)?o.push(t):this.childrenData=[t],a.push(d),d}calcText(t,o){const a=t?this.pathLabels.join(o):this.label;return this.text=a,a}broadcast(t,...o){const a=`onParent${Pu(t)}`;this.children.forEach(d=>{d&&(d.broadcast(t,...o),d[a]&&d[a](...o))})}emit(t,...o){const{parent:a}=this,d=`onChild${Pu(t)}`;a&&(a[d]&&a[d](...o),a.emit(t,...o))}onParentCheck(t){this.isDisabled||this.setCheckState(t)}onChildCheck(){const{children:t}=this,o=t.filter(d=>!d.isDisabled),a=o.length?o.every(d=>d.checked):!1;this.setCheckState(a)}setCheckState(t){const o=this.children.length,a=this.children.reduce((d,p)=>{const y=p.checked?1:p.indeterminate?.5:0;return d+y},0);this.checked=this.loaded&&this.children.filter(d=>!d.isDisabled).every(d=>d.loaded&&d.checked)&&t,this.indeterminate=this.loaded&&a!==o&&a>0}doCheck(t){if(this.checked===t)return;const{checkStrictly:o,multiple:a}=this.config;o||!a?this.checked=t:(this.broadcast("check",t),this.setCheckState(t),this.emit("check"))}};const lT=(e,t)=>e.reduce((o,a)=>(a.isLeaf?o.push(a):(!t&&o.push(a),o=o.concat(lT(a.children,t))),o),[]);let pR=class{constructor(t,o){this.config=o;const a=(t||[]).map(d=>new sT(d,this.config));this.nodes=a,this.allNodes=lT(a,!1),this.leafNodes=lT(a,!0)}getNodes(){return this.nodes}getFlattedNodes(t){return t?this.leafNodes:this.allNodes}appendNode(t,o){const a=o?o.appendChild(t):new sT(t,this.config);o||this.nodes.push(a),this.allNodes.push(a),a.isLeaf&&this.leafNodes.push(a)}appendNodes(t,o){t.forEach(a=>this.appendNode(a,o))}getNodeByValue(t,o=!1){return!t&&t!==0?null:this.getFlattedNodes(o).find(d=>_s(d.value,t)||_s(d.pathValues,t))||null}getSameNode(t){return t&&this.getFlattedNodes(!1).find(({value:a,level:d})=>_s(t.value,a)&&t.level===d)||null}};const D4=un({modelValue:{type:lt([Number,String,Array])},options:{type:lt(Array),default:()=>[]},props:{type:lt(Object),default:()=>({})}}),wQ={expandTrigger:"click",multiple:!1,checkStrictly:!1,emitPath:!0,lazy:!1,lazyLoad:vi,value:"value",label:"label",children:"children",leaf:"leaf",disabled:"disabled",hoverThreshold:500},SQ=e=>ee(()=>({...wQ,...e.props})),mR=e=>{if(!e)return 0;const t=e.id.split("-");return Number(t[t.length-2])},TQ=e=>{if(!e)return;const t=e.querySelector("input");t?t.click():Vz(e)&&e.click()},CQ=(e,t)=>{const o=t.slice(0),a=o.map(p=>p.uid),d=e.reduce((p,y)=>{const r=a.indexOf(y.uid);return r>-1&&(p.push(y),o.splice(r,1),a.splice(r,1)),p},[]);return d.push(...o),d},gR=e=>[...new Set(e)],Js=e=>!e&&e!==0?[]:sn(e)?e:[e],EQ=We({name:"ElCascaderPanel",components:{ElCascaderMenu:vQ},props:{...D4,border:{type:Boolean,default:!0},renderLabel:Function},emits:[gr,Ii,"close","expand-change"],setup(e,{emit:t,slots:o}){let a=!1;const d=Xt("cascader"),p=SQ(e);let y=null;const r=xe(!0),S=xe([]),C=xe(null),M=xe([]),P=xe(null),z=xe([]),F=ee(()=>p.value.expandTrigger==="hover"),V=ee(()=>e.renderLabel||o.default),N=()=>{const{options:de}=e,Ie=p.value;a=!1,y=new pR(de,Ie),M.value=[y.getNodes()],Ie.lazy&&$a(e.options)?(r.value=!1,H(void 0,Ve=>{Ve&&(y=new pR(Ve,Ie),M.value=[y.getNodes()]),r.value=!0,he(!1,!0)})):he(!1,!0)},H=(de,Ie)=>{const Ve=p.value;de=de||new sT({},Ve,void 0,!0),de.loading=!0;const be=ye=>{const Me=de,we=Me.root?null:Me;ye&&(y==null||y.appendNodes(ye,we)),Me.loading=!1,Me.loaded=!0,Me.childrenData=Me.childrenData||[],Ie&&Ie(ye)};Ve.lazyLoad(de,be)},U=(de,Ie)=>{var Ve;const{level:be}=de,ye=M.value.slice(0,be);let Me;de.isLeaf?Me=de.pathNodes[be-2]:(Me=de,ye.push(de.children)),((Ve=P.value)==null?void 0:Ve.uid)!==(Me==null?void 0:Me.uid)&&(P.value=de,M.value=ye,!Ie&&t("expand-change",(de==null?void 0:de.pathValues)||[]))},te=(de,Ie,Ve=!0)=>{const{checkStrictly:be,multiple:ye}=p.value,Me=z.value[0];a=!0,!ye&&(Me==null||Me.doCheck(!1)),de.doCheck(Ie),se(),Ve&&!ye&&!be&&t("close"),!Ve&&!ye&&!be&&Z(de)},Z=de=>{de&&(de=de.parent,Z(de),de&&U(de))},q=de=>y==null?void 0:y.getFlattedNodes(de),J=de=>{var Ie;return(Ie=q(de))==null?void 0:Ie.filter(Ve=>Ve.checked!==!1)},re=()=>{z.value.forEach(de=>de.doCheck(!1)),se(),M.value=M.value.slice(0,1),P.value=null,t("expand-change",[])},se=()=>{var de;const{checkStrictly:Ie,multiple:Ve}=p.value,be=z.value,ye=J(!Ie),Me=CQ(be,ye),we=Me.map(me=>me.valueByOption);z.value=Me,C.value=Ve?we:(de=we[0])!=null?de:null},he=(de=!1,Ie=!1)=>{const{modelValue:Ve}=e,{lazy:be,multiple:ye,checkStrictly:Me}=p.value,we=!Me;if(!(!r.value||a||!Ie&&_s(Ve,C.value)))if(be&&!de){const De=gR(Cq(Js(Ve))).map(Ge=>y==null?void 0:y.getNodeByValue(Ge)).filter(Ge=>!!Ge&&!Ge.loaded&&!Ge.loading);De.length?De.forEach(Ge=>{H(Ge,()=>he(!1,Ie))}):he(!0,Ie)}else{const me=ye?Js(Ve):[Ve],De=gR(me.map(Ge=>y==null?void 0:y.getNodeByValue(Ge,we)));le(De,Ie),C.value=w1(Ve)}},le=(de,Ie=!0)=>{const{checkStrictly:Ve}=p.value,be=z.value,ye=de.filter(me=>!!me&&(Ve||me.isLeaf)),Me=y==null?void 0:y.getSameNode(P.value),we=Ie&&Me||ye[0];we?we.pathNodes.forEach(me=>U(me,!0)):P.value=null,be.forEach(me=>me.doCheck(!1)),si(ye).forEach(me=>me.doCheck(!0)),z.value=ye,jn(ce)},ce=()=>{Wr&&S.value.forEach(de=>{const Ie=de==null?void 0:de.$el;if(Ie){const Ve=Ie.querySelector(`.${d.namespace.value}-scrollbar__wrap`),be=Ie.querySelector(`.${d.b("node")}.${d.is("active")}`)||Ie.querySelector(`.${d.b("node")}.in-active-path`);XC(Ve,be)}})},pe=de=>{const Ie=de.target,{code:Ve}=de;switch(Ve){case Cn.up:case Cn.down:{de.preventDefault();const be=Ve===Cn.up?-1:1;Kb($z(Ie,be,`.${d.b("node")}[tabindex="-1"]`));break}case Cn.left:{de.preventDefault();const be=S.value[mR(Ie)-1],ye=be==null?void 0:be.$el.querySelector(`.${d.b("node")}[aria-expanded="true"]`);Kb(ye);break}case Cn.right:{de.preventDefault();const be=S.value[mR(Ie)+1],ye=be==null?void 0:be.$el.querySelector(`.${d.b("node")}[tabindex="-1"]`);Kb(ye);break}case Cn.enter:case Cn.numpadEnter:TQ(Ie);break}};return Vr(bE,si({config:p,expandingNode:P,checkedNodes:z,isHoverMenu:F,initialLoaded:r,renderLabelFn:V,lazyLoad:H,expandNode:U,handleCheckChange:te})),Wt([p,()=>e.options],N,{deep:!0,immediate:!0}),Wt(()=>e.modelValue,()=>{a=!1,he()},{deep:!0}),Wt(()=>C.value,de=>{_s(de,e.modelValue)||(t(gr,de),t(Ii,de))}),PL(()=>S.value=[]),yr(()=>!$a(e.modelValue)&&he()),{ns:d,menuList:S,menus:M,checkedNodes:z,handleKeyDown:pe,handleCheckChange:te,getFlattedNodes:q,getCheckedNodes:J,clearCheckedNodes:re,calculateCheckedValue:se,scrollToExpandingNode:ce}}});function MQ(e,t,o,a,d,p){const y=Er("el-cascader-menu");return ae(),Pe("div",{class:fe([e.ns.b("panel"),e.ns.is("bordered",e.border)]),onKeydown:e.handleKeyDown},[(ae(!0),Pe(Vn,null,Fr(e.menus,(r,S)=>(ae(),At(y,{key:S,ref_for:!0,ref:C=>e.menuList[S]=C,index:S,nodes:[...r]},{empty:ot(()=>[gt(e.$slots,"empty")]),_:2},1032,["index","nodes"]))),128))],42,["onKeydown"])}var IQ=dn(EQ,[["render",MQ],["__file","index.vue"]]);const z4=lr(IQ),kc=un({type:{type:String,values:["primary","success","info","warning","danger"],default:"primary"},closable:Boolean,disableTransitions:Boolean,hit:Boolean,color:String,size:{type:String,values:ju},effect:{type:String,values:["dark","light","plain"],default:"light"},round:Boolean}),AQ={close:e=>e instanceof MouseEvent,click:e=>e instanceof MouseEvent},kQ=We({name:"ElTag"}),PQ=We({...kQ,props:kc,emits:AQ,setup(e,{emit:t}){const o=e,a=Ro(),d=Xt("tag"),p=ee(()=>{const{type:C,hit:M,effect:P,closable:z,round:F}=o;return[d.b(),d.is("closable",z),d.m(C||"primary"),d.m(a.value),d.m(P),d.is("hit",M),d.is("round",F)]}),y=C=>{t("close",C)},r=C=>{t("click",C)},S=C=>{var M,P,z;(z=(P=(M=C==null?void 0:C.component)==null?void 0:M.subTree)==null?void 0:P.component)!=null&&z.bum&&(C.component.subTree.component.bum=null)};return(C,M)=>C.disableTransitions?(ae(),Pe("span",{key:0,class:fe(b(p)),style:Un({backgroundColor:C.color}),onClick:r},[Ue("span",{class:fe(b(d).e("content"))},[gt(C.$slots,"default")],2),C.closable?(ae(),At(b(zn),{key:0,class:fe(b(d).e("close")),onClick:Jn(y,["stop"])},{default:ot(()=>[qe(b(Ql))]),_:1},8,["class","onClick"])):bt("v-if",!0)],6)):(ae(),At(rs,{key:1,name:`${b(d).namespace.value}-zoom-in-center`,appear:"",onVnodeMounted:S},{default:ot(()=>[Ue("span",{class:fe(b(p)),style:Un({backgroundColor:C.color}),onClick:r},[Ue("span",{class:fe(b(d).e("content"))},[gt(C.$slots,"default")],2),C.closable?(ae(),At(b(zn),{key:0,class:fe(b(d).e("close")),onClick:Jn(y,["stop"])},{default:ot(()=>[qe(b(Ql))]),_:1},8,["class","onClick"])):bt("v-if",!0)],6)]),_:3},8,["name"]))}});var RQ=dn(PQ,[["__file","tag.vue"]]);const Um=lr(RQ),OQ=un({...D4,size:zo,placeholder:String,disabled:Boolean,clearable:Boolean,filterable:Boolean,filterMethod:{type:lt(Function),default:(e,t)=>e.text.includes(t)},separator:{type:String,default:" / "},showAllLevels:{type:Boolean,default:!0},collapseTags:Boolean,maxCollapseTags:{type:Number,default:1},collapseTagsTooltip:{type:Boolean,default:!1},debounce:{type:Number,default:300},beforeFilter:{type:lt(Function),default:()=>!0},placement:{type:lt(String),values:Nc,default:"bottom-start"},fallbackPlacements:{type:lt(Array),default:["bottom-start","bottom","top-start","top","right","left"]},popperClass:{type:String,default:""},teleported:Jo.teleported,tagType:{...kc.type,default:"info"},tagEffect:{...kc.effect,default:"light"},validateEvent:{type:Boolean,default:!0},persistent:{type:Boolean,default:!0},...sg}),LQ={[gr]:e=>!0,[Ii]:e=>!0,focus:e=>e instanceof FocusEvent,blur:e=>e instanceof FocusEvent,clear:()=>!0,visibleChange:e=>Oi(e),expandChange:e=>!!e,removeTag:e=>!!e},Rd=new Map;if(Wr){let e;document.addEventListener("mousedown",t=>e=t),document.addEventListener("mouseup",t=>{if(e){for(const o of Rd.values())for(const{documentHandler:a}of o)a(t,e);e=void 0}})}function _R(e,t){let o=[];return sn(t.arg)?o=t.arg:ea(t.arg)&&o.push(t.arg),function(a,d){const p=t.instance.popperRef,y=a.target,r=d==null?void 0:d.target,S=!t||!t.instance,C=!y||!r,M=e.contains(y)||e.contains(r),P=e===y,z=o.length&&o.some(V=>V==null?void 0:V.contains(y))||o.length&&o.includes(r),F=p&&(p.contains(y)||p.contains(r));S||C||M||P||z||F||t.value(a,d)}}const Pc={beforeMount(e,t){Rd.has(e)||Rd.set(e,[]),Rd.get(e).push({documentHandler:_R(e,t),bindingFn:t.value})},updated(e,t){Rd.has(e)||Rd.set(e,[]);const o=Rd.get(e),a=o.findIndex(p=>p.bindingFn===t.oldValue),d={documentHandler:_R(e,t),bindingFn:t.value};a>=0?o.splice(a,1,d):o.push(d)},unmounted(e){Rd.delete(e)}},DQ="ElCascader",zQ=We({name:DQ}),FQ=We({...zQ,props:OQ,emits:LQ,setup(e,{expose:t,emit:o}){const a=e,d={modifiers:[{name:"arrowPosition",enabled:!0,phase:"main",fn:({state:st})=>{const{modifiersData:Ft,placement:Ye}=st;["right","left","bottom","top"].includes(Ye)||(Ft.arrow.x=35)},requires:["arrow"]}]},p=of();let y=0,r=0;const S=Xt("cascader"),C=Xt("input"),{t:M}=qr(),{form:P,formItem:z}=xs(),{valueOnClear:F}=hx(a),{isComposing:V,handleComposition:N}=cv({afterComposition(st){var Ft;const Ye=(Ft=st.target)==null?void 0:Ft.value;ui(Ye)}}),H=xe(null),U=xe(null),te=xe(null),Z=xe(null),q=xe(null),J=xe(!1),re=xe(!1),se=xe(!1),he=xe(!1),le=xe(""),ce=xe(""),pe=xe([]),de=xe([]),Ie=xe([]),Ve=ee(()=>p.style),be=ee(()=>a.disabled||(P==null?void 0:P.disabled)),ye=ee(()=>a.placeholder||M("el.cascader.placeholder")),Me=ee(()=>ce.value||pe.value.length>0||V.value?"":ye.value),we=Ro(),me=ee(()=>we.value==="small"?"small":"default"),De=ee(()=>!!a.props.multiple),Ge=ee(()=>!a.filterable||De.value),rt=ee(()=>De.value?ce.value:le.value),Oe=ee(()=>{var st;return((st=Z.value)==null?void 0:st.checkedNodes)||[]}),Ct=ee(()=>!a.clearable||be.value||se.value||!re.value?!1:!!Oe.value.length),kt=ee(()=>{const{showAllLevels:st,separator:Ft}=a,Ye=Oe.value;return Ye.length?De.value?"":Ye[0].calcText(st,Ft):""}),Bt=ee(()=>(z==null?void 0:z.validateState)||""),_t=ee({get(){return w1(a.modelValue)},set(st){const Ft=st??F.value;o(gr,Ft),o(Ii,Ft),a.validateEvent&&(z==null||z.validate("change").catch(Ye=>void 0))}}),jt=ee(()=>[S.b(),S.m(we.value),S.is("disabled",be.value),p.class]),Gt=ee(()=>[C.e("icon"),"icon-arrow-down",S.is("reverse",J.value)]),Ne=ee(()=>S.is("focus",J.value||he.value)),an=ee(()=>{var st,Ft;return(Ft=(st=H.value)==null?void 0:st.popperRef)==null?void 0:Ft.contentRef}),Ae=st=>{var Ft,Ye,pn;be.value||(st=st??!J.value,st!==J.value&&(J.value=st,(Ye=(Ft=U.value)==null?void 0:Ft.input)==null||Ye.setAttribute("aria-expanded",`${st}`),st?(tt(),jn((pn=Z.value)==null?void 0:pn.scrollToExpandingNode)):a.filterable&&En(),o("visibleChange",st)))},tt=()=>{jn(()=>{var st;(st=H.value)==null||st.updatePopper()})},Je=()=>{se.value=!1},Jt=st=>{const{showAllLevels:Ft,separator:Ye}=a;return{node:st,key:st.uid,text:st.calcText(Ft,Ye),hitState:!1,closable:!be.value&&!st.isDisabled,isCollapseTag:!1}},Kt=st=>{var Ft;const Ye=st.node;Ye.doCheck(!1),(Ft=Z.value)==null||Ft.calculateCheckedValue(),o("removeTag",Ye.valueByOption)},Nt=()=>{if(!De.value)return;const st=Oe.value,Ft=[],Ye=[];if(st.forEach(pn=>Ye.push(Jt(pn))),de.value=Ye,st.length){st.slice(0,a.maxCollapseTags).forEach(_r=>Ft.push(Jt(_r)));const pn=st.slice(a.maxCollapseTags),xn=pn.length;xn&&(a.collapseTags?Ft.push({key:-1,text:`+ ${xn}`,closable:!1,isCollapseTag:!0}):pn.forEach(_r=>Ft.push(Jt(_r))))}pe.value=Ft},Pt=()=>{var st,Ft;const{filterMethod:Ye,showAllLevels:pn,separator:xn}=a,_r=(Ft=(st=Z.value)==null?void 0:st.getFlattedNodes(!a.props.checkStrictly))==null?void 0:Ft.filter(yi=>yi.isDisabled?!1:(yi.calcText(pn,xn),Ye(yi,rt.value)));De.value&&(pe.value.forEach(yi=>{yi.hitState=!1}),de.value.forEach(yi=>{yi.hitState=!1})),se.value=!0,Ie.value=_r,tt()},Dt=()=>{var st;let Ft;se.value&&q.value?Ft=q.value.$el.querySelector(`.${S.e("suggestion-item")}`):Ft=(st=Z.value)==null?void 0:st.$el.querySelector(`.${S.b("node")}[tabindex="-1"]`),Ft&&(Ft.focus(),!se.value&&Ft.click())},rn=()=>{var st,Ft;const Ye=(st=U.value)==null?void 0:st.input,pn=te.value,xn=(Ft=q.value)==null?void 0:Ft.$el;if(!(!Wr||!Ye)){if(xn){const _r=xn.querySelector(`.${S.e("suggestion-list")}`);_r.style.minWidth=`${Ye.offsetWidth}px`}if(pn){const{offsetHeight:_r}=pn,yi=pe.value.length>0?`${Math.max(_r,y)-2}px`:`${y}px`;Ye.style.height=yi,tt()}}},on=st=>{var Ft;return(Ft=Z.value)==null?void 0:Ft.getCheckedNodes(st)},Ln=st=>{tt(),o("expandChange",st)},yn=st=>{if(!V.value)switch(st.code){case Cn.enter:case Cn.numpadEnter:Ae();break;case Cn.down:Ae(!0),jn(Dt),st.preventDefault();break;case Cn.esc:J.value===!0&&(st.preventDefault(),st.stopPropagation(),Ae(!1));break;case Cn.tab:Ae(!1);break}},Et=()=>{var st;(st=Z.value)==null||st.clearCheckedNodes(),!J.value&&a.filterable&&En(),Ae(!1),o("clear")},En=()=>{const{value:st}=kt;le.value=st,ce.value=st},Xn=st=>{var Ft,Ye;const{checked:pn}=st;De.value?(Ft=Z.value)==null||Ft.handleCheckChange(st,!pn,!1):(!pn&&((Ye=Z.value)==null||Ye.handleCheckChange(st,!0,!1)),Ae(!1))},vr=st=>{const Ft=st.target,{code:Ye}=st;switch(Ye){case Cn.up:case Cn.down:{const pn=Ye===Cn.up?-1:1;Kb($z(Ft,pn,`.${S.e("suggestion-item")}[tabindex="-1"]`));break}case Cn.enter:case Cn.numpadEnter:Ft.click();break}},er=()=>{const st=pe.value,Ft=st[st.length-1];r=ce.value?0:r+1,!(!Ft||!r||a.collapseTags&&st.length>1)&&(Ft.hitState?Kt(Ft):Ft.hitState=!0)},Dr=st=>{const Ft=st.target,Ye=S.e("search-input");Ft.className===Ye&&(he.value=!0),o("focus",st)},Ar=st=>{he.value=!1,o("blur",st)},Di=Ca(()=>{const{value:st}=rt;if(!st)return;const Ft=a.beforeFilter(st);xy(Ft)?Ft.then(Pt).catch(()=>{}):Ft!==!1?Pt():Je()},a.debounce),ui=(st,Ft)=>{!J.value&&Ae(!0),!(Ft!=null&&Ft.isComposing)&&(st?Di():Je())},zt=st=>Number.parseFloat(s9(C.cssVarName("input-height"),st).value)-2;return Wt(se,tt),Wt([Oe,be,()=>a.collapseTags],Nt),Wt(pe,()=>{jn(()=>rn())}),Wt(we,async()=>{await jn();const st=U.value.input;y=zt(st)||y,rn()}),Wt(kt,En,{immediate:!0}),yr(()=>{const st=U.value.input,Ft=zt(st);y=st.offsetHeight||Ft,ro(st,rn)}),t({getCheckedNodes:on,cascaderPanelRef:Z,togglePopperVisible:Ae,contentRef:an,presentText:kt}),(st,Ft)=>(ae(),At(b(bs),{ref_key:"tooltipRef",ref:H,visible:J.value,teleported:st.teleported,"popper-class":[b(S).e("dropdown"),st.popperClass],"popper-options":d,"fallback-placements":st.fallbackPlacements,"stop-popper-mouse-event":!1,"gpu-acceleration":!1,placement:st.placement,transition:`${b(S).namespace.value}-zoom-in-top`,effect:"light",pure:"",persistent:st.persistent,onHide:Je},{default:ot(()=>[hr((ae(),Pe("div",{class:fe(b(jt)),style:Un(b(Ve)),onClick:()=>Ae(b(Ge)?void 0:!0),onKeydown:yn,onMouseenter:Ye=>re.value=!0,onMouseleave:Ye=>re.value=!1},[qe(b(Bs),{ref_key:"input",ref:U,modelValue:le.value,"onUpdate:modelValue":Ye=>le.value=Ye,placeholder:b(Me),readonly:b(Ge),disabled:b(be),"validate-event":!1,size:b(we),class:fe(b(Ne)),tabindex:b(De)&&st.filterable&&!b(be)?-1:void 0,onCompositionstart:b(N),onCompositionupdate:b(N),onCompositionend:b(N),onFocus:Dr,onBlur:Ar,onInput:ui},{suffix:ot(()=>[b(Ct)?(ae(),At(b(zn),{key:"clear",class:fe([b(C).e("icon"),"icon-circle-close"]),onClick:Jn(Et,["stop"])},{default:ot(()=>[qe(b(Fc))]),_:1},8,["class","onClick"])):(ae(),At(b(zn),{key:"arrow-down",class:fe(b(Gt)),onClick:Jn(Ye=>Ae(),["stop"])},{default:ot(()=>[qe(b(zc))]),_:1},8,["class","onClick"]))]),_:1},8,["modelValue","onUpdate:modelValue","placeholder","readonly","disabled","size","class","tabindex","onCompositionstart","onCompositionupdate","onCompositionend"]),b(De)?(ae(),Pe("div",{key:0,ref_key:"tagWrapper",ref:te,class:fe([b(S).e("tags"),b(S).is("validate",!!b(Bt))])},[(ae(!0),Pe(Vn,null,Fr(pe.value,Ye=>(ae(),At(b(Um),{key:Ye.key,type:st.tagType,size:b(me),effect:st.tagEffect,hit:Ye.hitState,closable:Ye.closable,"disable-transitions":"",onClose:pn=>Kt(Ye)},{default:ot(()=>[Ye.isCollapseTag===!1?(ae(),Pe("span",{key:0},fn(Ye.text),1)):(ae(),At(b(bs),{key:1,disabled:J.value||!st.collapseTagsTooltip,"fallback-placements":["bottom","top","right","left"],placement:"bottom",effect:"light"},{default:ot(()=>[Ue("span",null,fn(Ye.text),1)]),content:ot(()=>[Ue("div",{class:fe(b(S).e("collapse-tags"))},[(ae(!0),Pe(Vn,null,Fr(de.value.slice(st.maxCollapseTags),(pn,xn)=>(ae(),Pe("div",{key:xn,class:fe(b(S).e("collapse-tag"))},[(ae(),At(b(Um),{key:pn.key,class:"in-tooltip",type:st.tagType,size:b(me),effect:st.tagEffect,hit:pn.hitState,closable:pn.closable,"disable-transitions":"",onClose:_r=>Kt(pn)},{default:ot(()=>[Ue("span",null,fn(pn.text),1)]),_:2},1032,["type","size","effect","hit","closable","onClose"]))],2))),128))],2)]),_:2},1032,["disabled"]))]),_:2},1032,["type","size","effect","hit","closable","onClose"]))),128)),st.filterable&&!b(be)?hr((ae(),Pe("input",{key:0,"onUpdate:modelValue":Ye=>ce.value=Ye,type:"text",class:fe(b(S).e("search-input")),placeholder:b(kt)?"":b(ye),onInput:Ye=>ui(ce.value,Ye),onClick:Jn(Ye=>Ae(!0),["stop"]),onKeydown:Ri(er,["delete"]),onCompositionstart:b(N),onCompositionupdate:b(N),onCompositionend:b(N),onFocus:Dr,onBlur:Ar},null,42,["onUpdate:modelValue","placeholder","onInput","onClick","onKeydown","onCompositionstart","onCompositionupdate","onCompositionend"])),[[rx,ce.value]]):bt("v-if",!0)],2)):bt("v-if",!0)],46,["onClick","onMouseenter","onMouseleave"])),[[b(Pc),()=>Ae(!1),b(an)]])]),content:ot(()=>[hr(qe(b(z4),{ref_key:"cascaderPanelRef",ref:Z,modelValue:b(_t),"onUpdate:modelValue":Ye=>Ti(_t)?_t.value=Ye:null,options:st.options,props:a.props,border:!1,"render-label":st.$slots.default,onExpandChange:Ln,onClose:Ye=>st.$nextTick(()=>Ae(!1))},{empty:ot(()=>[gt(st.$slots,"empty")]),_:3},8,["modelValue","onUpdate:modelValue","options","props","render-label","onClose"]),[[ii,!se.value]]),st.filterable?hr((ae(),At(b(Hu),{key:0,ref_key:"suggestionPanel",ref:q,tag:"ul",class:fe(b(S).e("suggestion-panel")),"view-class":b(S).e("suggestion-list"),onKeydown:vr},{default:ot(()=>[Ie.value.length?(ae(!0),Pe(Vn,{key:0},Fr(Ie.value,Ye=>(ae(),Pe("li",{key:Ye.uid,class:fe([b(S).e("suggestion-item"),b(S).is("checked",Ye.checked)]),tabindex:-1,onClick:pn=>Xn(Ye)},[Ue("span",null,fn(Ye.text),1),Ye.checked?(ae(),At(b(zn),{key:0},{default:ot(()=>[qe(b(lv))]),_:1})):bt("v-if",!0)],10,["onClick"]))),128)):gt(st.$slots,"empty",{key:1},()=>[Ue("li",{class:fe(b(S).e("empty-text"))},fn(b(M)("el.cascader.noMatch")),3)])]),_:3},8,["class","view-class"])),[[ii,se.value]]):bt("v-if",!0)]),_:3},8,["visible","teleported","popper-class","fallback-placements","placement","transition","persistent"]))}});var NQ=dn(FQ,[["__file","cascader.vue"]]);const BQ=lr(NQ),VQ=un({checked:Boolean,disabled:Boolean,type:{type:String,values:["primary","success","info","warning","danger"],default:"primary"}}),$Q={"update:checked":e=>Oi(e),[Ii]:e=>Oi(e)},UQ=We({name:"ElCheckTag"}),jQ=We({...UQ,props:VQ,emits:$Q,setup(e,{emit:t}){const o=e,a=Xt("check-tag"),d=ee(()=>o.disabled),p=ee(()=>[a.b(),a.is("checked",o.checked),a.is("disabled",d.value),a.m(o.type||"primary")]),y=()=>{if(d.value)return;const r=!o.checked;t(Ii,r),t("update:checked",r)};return(r,S)=>(ae(),Pe("span",{class:fe(b(p)),onClick:y},[gt(r.$slots,"default")],2))}});var HQ=dn(jQ,[["__file","check-tag.vue"]]);const GQ=lr(HQ),WQ=un({tag:{type:String,default:"div"},span:{type:Number,default:24},offset:{type:Number,default:0},pull:{type:Number,default:0},push:{type:Number,default:0},xs:{type:lt([Number,Object]),default:()=>io({})},sm:{type:lt([Number,Object]),default:()=>io({})},md:{type:lt([Number,Object]),default:()=>io({})},lg:{type:lt([Number,Object]),default:()=>io({})},xl:{type:lt([Number,Object]),default:()=>io({})}}),F4=Symbol("rowContextKey"),qQ=We({name:"ElCol"}),KQ=We({...qQ,props:WQ,setup(e){const t=e,{gutter:o}=Pn(F4,{gutter:ee(()=>0)}),a=Xt("col"),d=ee(()=>{const y={};return o.value&&(y.paddingLeft=y.paddingRight=`${o.value/2}px`),y}),p=ee(()=>{const y=[];return["span","offset","pull","push"].forEach(C=>{const M=t[C];Wn(M)&&(C==="span"?y.push(a.b(`${t[C]}`)):M>0&&y.push(a.b(`${C}-${t[C]}`)))}),["xs","sm","md","lg","xl"].forEach(C=>{Wn(t[C])?y.push(a.b(`${C}-${t[C]}`)):xr(t[C])&&Object.entries(t[C]).forEach(([M,P])=>{y.push(M!=="span"?a.b(`${C}-${M}-${P}`):a.b(`${C}-${P}`))})}),o.value&&y.push(a.is("guttered")),[a.b(),y]});return(y,r)=>(ae(),At(Ir(y.tag),{class:fe(b(p)),style:Un(b(d))},{default:ot(()=>[gt(y.$slots,"default")]),_:3},8,["class","style"]))}});var ZQ=dn(KQ,[["__file","col.vue"]]);const YQ=lr(ZQ),yR=e=>Wn(e)||Nn(e)||sn(e),XQ=un({accordion:Boolean,modelValue:{type:lt([Array,String,Number]),default:()=>io([])}}),JQ={[gr]:yR,[Ii]:yR},N4=Symbol("collapseContextKey"),QQ=(e,t)=>{const o=xe(Fs(e.modelValue)),a=p=>{o.value=p;const y=e.accordion?o.value[0]:o.value;t(gr,y),t(Ii,y)},d=p=>{if(e.accordion)a([o.value[0]===p?"":p]);else{const y=[...o.value],r=y.indexOf(p);r>-1?y.splice(r,1):y.push(p),a(y)}};return Wt(()=>e.modelValue,()=>o.value=Fs(e.modelValue),{deep:!0}),Vr(N4,{activeNames:o,handleItemClick:d}),{activeNames:o,setActiveNames:a}},eee=()=>{const e=Xt("collapse");return{rootKls:ee(()=>e.b())}},tee=We({name:"ElCollapse"}),nee=We({...tee,props:XQ,emits:JQ,setup(e,{expose:t,emit:o}){const a=e,{activeNames:d,setActiveNames:p}=QQ(a,o),{rootKls:y}=eee();return t({activeNames:d,setActiveNames:p}),(r,S)=>(ae(),Pe("div",{class:fe(b(y))},[gt(r.$slots,"default")],2))}});var ree=dn(nee,[["__file","collapse.vue"]]);const iee=We({name:"ElCollapseTransition"}),oee=We({...iee,setup(e){const t=Xt("collapse-transition"),o=d=>{d.style.maxHeight="",d.style.overflow=d.dataset.oldOverflow,d.style.paddingTop=d.dataset.oldPaddingTop,d.style.paddingBottom=d.dataset.oldPaddingBottom},a={beforeEnter(d){d.dataset||(d.dataset={}),d.dataset.oldPaddingTop=d.style.paddingTop,d.dataset.oldPaddingBottom=d.style.paddingBottom,d.style.height&&(d.dataset.elExistsHeight=d.style.height),d.style.maxHeight=0,d.style.paddingTop=0,d.style.paddingBottom=0},enter(d){requestAnimationFrame(()=>{d.dataset.oldOverflow=d.style.overflow,d.dataset.elExistsHeight?d.style.maxHeight=d.dataset.elExistsHeight:d.scrollHeight!==0?d.style.maxHeight=`${d.scrollHeight}px`:d.style.maxHeight=0,d.style.paddingTop=d.dataset.oldPaddingTop,d.style.paddingBottom=d.dataset.oldPaddingBottom,d.style.overflow="hidden"})},afterEnter(d){d.style.maxHeight="",d.style.overflow=d.dataset.oldOverflow},enterCancelled(d){o(d)},beforeLeave(d){d.dataset||(d.dataset={}),d.dataset.oldPaddingTop=d.style.paddingTop,d.dataset.oldPaddingBottom=d.style.paddingBottom,d.dataset.oldOverflow=d.style.overflow,d.style.maxHeight=`${d.scrollHeight}px`,d.style.overflow="hidden"},leave(d){d.scrollHeight!==0&&(d.style.maxHeight=0,d.style.paddingTop=0,d.style.paddingBottom=0)},afterLeave(d){o(d)},leaveCancelled(d){o(d)}};return(d,p)=>(ae(),At(rs,kr({name:b(t).b()},U6(a)),{default:ot(()=>[gt(d.$slots,"default")]),_:3},16,["name"]))}});var see=dn(oee,[["__file","collapse-transition.vue"]]);const wx=lr(see),aee=un({title:{type:String,default:""},name:{type:lt([String,Number]),default:void 0},icon:{type:Ai,default:ta},disabled:Boolean}),lee=e=>{const t=Pn(N4),{namespace:o}=Xt("collapse"),a=xe(!1),d=xe(!1),p=oE(),y=ee(()=>p.current++),r=ee(()=>{var z;return(z=e.name)!=null?z:`${o.value}-id-${p.prefix}-${b(y)}`}),S=ee(()=>t==null?void 0:t.activeNames.value.includes(b(r)));return{focusing:a,id:y,isActive:S,handleFocus:()=>{setTimeout(()=>{d.value?d.value=!1:a.value=!0},50)},handleHeaderClick:()=>{e.disabled||(t==null||t.handleItemClick(b(r)),a.value=!1,d.value=!0)},handleEnterClick:()=>{t==null||t.handleItemClick(b(r))}}},uee=(e,{focusing:t,isActive:o,id:a})=>{const d=Xt("collapse"),p=ee(()=>[d.b("item"),d.is("active",b(o)),d.is("disabled",e.disabled)]),y=ee(()=>[d.be("item","header"),d.is("active",b(o)),{focusing:b(t)&&!e.disabled}]),r=ee(()=>[d.be("item","arrow"),d.is("active",b(o))]),S=ee(()=>d.be("item","wrap")),C=ee(()=>d.be("item","content")),M=ee(()=>d.b(`content-${b(a)}`)),P=ee(()=>d.b(`head-${b(a)}`));return{arrowKls:r,headKls:y,rootKls:p,itemWrapperKls:S,itemContentKls:C,scopedContentId:M,scopedHeadId:P}},cee=We({name:"ElCollapseItem"}),dee=We({...cee,props:aee,setup(e,{expose:t}){const o=e,{focusing:a,id:d,isActive:p,handleFocus:y,handleHeaderClick:r,handleEnterClick:S}=lee(o),{arrowKls:C,headKls:M,rootKls:P,itemWrapperKls:z,itemContentKls:F,scopedContentId:V,scopedHeadId:N}=uee(o,{focusing:a,isActive:p,id:d});return t({isActive:p}),(H,U)=>(ae(),Pe("div",{class:fe(b(P))},[Ue("button",{id:b(N),class:fe(b(M)),"aria-expanded":b(p),"aria-controls":b(V),"aria-describedby":b(V),tabindex:H.disabled?-1:0,type:"button",onClick:b(r),onKeydown:Ri(Jn(b(S),["stop","prevent"]),["space","enter"]),onFocus:b(y),onBlur:te=>a.value=!1},[gt(H.$slots,"title",{},()=>[Nr(fn(H.title),1)]),gt(H.$slots,"icon",{isActive:b(p)},()=>[qe(b(zn),{class:fe(b(C))},{default:ot(()=>[(ae(),At(Ir(H.icon)))]),_:1},8,["class"])])],42,["id","aria-expanded","aria-controls","aria-describedby","tabindex","onClick","onKeydown","onFocus","onBlur"]),qe(b(wx),null,{default:ot(()=>[hr(Ue("div",{id:b(V),role:"region",class:fe(b(z)),"aria-hidden":!b(p),"aria-labelledby":b(N)},[Ue("div",{class:fe(b(F))},[gt(H.$slots,"default")],2)],10,["id","aria-hidden","aria-labelledby"]),[[ii,b(p)]])]),_:3})],2))}});var B4=dn(dee,[["__file","collapse-item.vue"]]);const fee=lr(ree,{CollapseItem:B4}),hee=oo(B4),pee=un({color:{type:lt(Object),required:!0},vertical:{type:Boolean,default:!1}});let uS=!1;function Ny(e,t){if(!Wr)return;const o=function(p){var y;(y=t.drag)==null||y.call(t,p)},a=function(p){var y;document.removeEventListener("mousemove",o),document.removeEventListener("mouseup",a),document.removeEventListener("touchmove",o),document.removeEventListener("touchend",a),document.onselectstart=null,document.ondragstart=null,uS=!1,(y=t.end)==null||y.call(t,p)},d=function(p){var y;uS||(p.preventDefault(),document.onselectstart=()=>!1,document.ondragstart=()=>!1,document.addEventListener("mousemove",o),document.addEventListener("mouseup",a),document.addEventListener("touchmove",o),document.addEventListener("touchend",a),uS=!0,(y=t.start)==null||y.call(t,p))};e.addEventListener("mousedown",d),e.addEventListener("touchstart",d,{passive:!1})}const mee=(e,t)=>{if(!Wr||!e||!t)return!1;const o=e.getBoundingClientRect();let a;return t instanceof Element?a=t.getBoundingClientRect():a={top:0,right:window.innerWidth,bottom:window.innerHeight,left:0},o.top<a.bottom&&o.bottom>a.top&&o.right>a.left&&o.left<a.right},vR=e=>{let t=0,o=e;for(;o;)t+=o.offsetTop,o=o.offsetParent;return t},uT=(e,t)=>Math.abs(vR(e)-vR(t)),wE=e=>{let t,o;return e.type==="touchend"?(o=e.changedTouches[0].clientY,t=e.changedTouches[0].clientX):e.type.startsWith("touch")?(o=e.touches[0].clientY,t=e.touches[0].clientX):(o=e.clientY,t=e.clientX),{clientX:t,clientY:o}},gee=e=>{const t=Cr(),{t:o}=qr(),a=Hi(),d=Hi(),p=ee(()=>e.color.get("alpha")),y=ee(()=>o("el.colorpicker.alphaLabel"));function r(P){var z;P.target!==a.value&&S(P),(z=a.value)==null||z.focus()}function S(P){if(!d.value||!a.value)return;const F=t.vnode.el.getBoundingClientRect(),{clientX:V,clientY:N}=wE(P);if(e.vertical){let H=N-F.top;H=Math.max(a.value.offsetHeight/2,H),H=Math.min(H,F.height-a.value.offsetHeight/2),e.color.set("alpha",Math.round((H-a.value.offsetHeight/2)/(F.height-a.value.offsetHeight)*100))}else{let H=V-F.left;H=Math.max(a.value.offsetWidth/2,H),H=Math.min(H,F.width-a.value.offsetWidth/2),e.color.set("alpha",Math.round((H-a.value.offsetWidth/2)/(F.width-a.value.offsetWidth)*100))}}function C(P){const{code:z,shiftKey:F}=P,V=F?10:1;switch(z){case Cn.left:case Cn.down:P.preventDefault(),P.stopPropagation(),M(-V);break;case Cn.right:case Cn.up:P.preventDefault(),P.stopPropagation(),M(V);break}}function M(P){let z=p.value+P;z=z<0?0:z>100?100:z,e.color.set("alpha",z)}return{thumb:a,bar:d,alpha:p,alphaLabel:y,handleDrag:S,handleClick:r,handleKeydown:C}},_ee=(e,{bar:t,thumb:o,handleDrag:a})=>{const d=Cr(),p=Xt("color-alpha-slider"),y=xe(0),r=xe(0),S=xe();function C(){if(!o.value||e.vertical)return 0;const te=d.vnode.el,Z=e.color.get("alpha");return te?Math.round(Z*(te.offsetWidth-o.value.offsetWidth/2)/100):0}function M(){if(!o.value)return 0;const te=d.vnode.el;if(!e.vertical)return 0;const Z=e.color.get("alpha");return te?Math.round(Z*(te.offsetHeight-o.value.offsetHeight/2)/100):0}function P(){if(e.color&&e.color.value){const{r:te,g:Z,b:q}=e.color.toRgb();return`linear-gradient(to right, rgba(${te}, ${Z}, ${q}, 0) 0%, rgba(${te}, ${Z}, ${q}, 1) 100%)`}return""}function z(){y.value=C(),r.value=M(),S.value=P()}yr(()=>{if(!t.value||!o.value)return;const te={drag:Z=>{a(Z)},end:Z=>{a(Z)}};Ny(t.value,te),Ny(o.value,te),z()}),Wt(()=>e.color.get("alpha"),()=>z()),Wt(()=>e.color.value,()=>z());const F=ee(()=>[p.b(),p.is("vertical",e.vertical)]),V=ee(()=>p.e("bar")),N=ee(()=>p.e("thumb")),H=ee(()=>({background:S.value})),U=ee(()=>({left:_o(y.value),top:_o(r.value)}));return{rootKls:F,barKls:V,barStyle:H,thumbKls:N,thumbStyle:U,update:z}},yee="ElColorAlphaSlider",vee=We({name:yee}),bee=We({...vee,props:pee,setup(e,{expose:t}){const o=e,{alpha:a,alphaLabel:d,bar:p,thumb:y,handleDrag:r,handleClick:S,handleKeydown:C}=gee(o),{rootKls:M,barKls:P,barStyle:z,thumbKls:F,thumbStyle:V,update:N}=_ee(o,{bar:p,thumb:y,handleDrag:r});return t({update:N,bar:p,thumb:y}),(H,U)=>(ae(),Pe("div",{class:fe(b(M))},[Ue("div",{ref_key:"bar",ref:p,class:fe(b(P)),style:Un(b(z)),onClick:b(S)},null,14,["onClick"]),Ue("div",{ref_key:"thumb",ref:y,class:fe(b(F)),style:Un(b(V)),"aria-label":b(d),"aria-valuenow":b(a),"aria-orientation":H.vertical?"vertical":"horizontal","aria-valuemin":"0","aria-valuemax":"100",role:"slider",tabindex:"0",onKeydown:b(C)},null,46,["aria-label","aria-valuenow","aria-orientation","onKeydown"])],2))}});var xee=dn(bee,[["__file","alpha-slider.vue"]]);const wee=We({name:"ElColorHueSlider",props:{color:{type:Object,required:!0},vertical:Boolean},setup(e){const t=Xt("color-hue-slider"),o=Cr(),a=xe(),d=xe(),p=xe(0),y=xe(0),r=ee(()=>e.color.get("hue"));Wt(()=>r.value,()=>{z()});function S(F){F.target!==a.value&&C(F)}function C(F){if(!d.value||!a.value)return;const N=o.vnode.el.getBoundingClientRect(),{clientX:H,clientY:U}=wE(F);let te;if(e.vertical){let Z=U-N.top;Z=Math.min(Z,N.height-a.value.offsetHeight/2),Z=Math.max(a.value.offsetHeight/2,Z),te=Math.round((Z-a.value.offsetHeight/2)/(N.height-a.value.offsetHeight)*360)}else{let Z=H-N.left;Z=Math.min(Z,N.width-a.value.offsetWidth/2),Z=Math.max(a.value.offsetWidth/2,Z),te=Math.round((Z-a.value.offsetWidth/2)/(N.width-a.value.offsetWidth)*360)}e.color.set("hue",te)}function M(){if(!a.value)return 0;const F=o.vnode.el;if(e.vertical)return 0;const V=e.color.get("hue");return F?Math.round(V*(F.offsetWidth-a.value.offsetWidth/2)/360):0}function P(){if(!a.value)return 0;const F=o.vnode.el;if(!e.vertical)return 0;const V=e.color.get("hue");return F?Math.round(V*(F.offsetHeight-a.value.offsetHeight/2)/360):0}function z(){p.value=M(),y.value=P()}return yr(()=>{if(!d.value||!a.value)return;const F={drag:V=>{C(V)},end:V=>{C(V)}};Ny(d.value,F),Ny(a.value,F),z()}),{bar:d,thumb:a,thumbLeft:p,thumbTop:y,hueValue:r,handleClick:S,update:z,ns:t}}});function See(e,t,o,a,d,p){return ae(),Pe("div",{class:fe([e.ns.b(),e.ns.is("vertical",e.vertical)])},[Ue("div",{ref:"bar",class:fe(e.ns.e("bar")),onClick:e.handleClick},null,10,["onClick"]),Ue("div",{ref:"thumb",class:fe(e.ns.e("thumb")),style:Un({left:e.thumbLeft+"px",top:e.thumbTop+"px"})},null,6)],2)}var Tee=dn(wee,[["render",See],["__file","hue-slider.vue"]]);const Cee=un({modelValue:String,id:String,showAlpha:Boolean,colorFormat:String,disabled:Boolean,size:zo,popperClass:{type:String,default:""},tabindex:{type:[String,Number],default:0},teleported:Jo.teleported,predefine:{type:lt(Array)},validateEvent:{type:Boolean,default:!0},...cs(["ariaLabel"])}),Eee={[gr]:e=>Nn(e)||Ho(e),[Ii]:e=>Nn(e)||Ho(e),activeChange:e=>Nn(e)||Ho(e),focus:e=>e instanceof FocusEvent,blur:e=>e instanceof FocusEvent},V4=Symbol("colorPickerContextKey"),bR=function(e,t,o){return[e,t*o/((e=(2-t)*o)<1?e:2-e)||0,e/2]},Mee=function(e){return Nn(e)&&e.includes(".")&&Number.parseFloat(e)===1},Iee=function(e){return Nn(e)&&e.includes("%")},Mm=function(e,t){Mee(e)&&(e="100%");const o=Iee(e);return e=Math.min(t,Math.max(0,Number.parseFloat(`${e}`))),o&&(e=Number.parseInt(`${e*t}`,10)/100),Math.abs(e-t)<1e-6?1:e%t/Number.parseFloat(t)},xR={10:"A",11:"B",12:"C",13:"D",14:"E",15:"F"},Yb=e=>{e=Math.min(Math.round(e),255);const t=Math.floor(e/16),o=e%16;return`${xR[t]||t}${xR[o]||o}`},wR=function({r:e,g:t,b:o}){return Number.isNaN(+e)||Number.isNaN(+t)||Number.isNaN(+o)?"":`#${Yb(e)}${Yb(t)}${Yb(o)}`},cS={A:10,B:11,C:12,D:13,E:14,F:15},rh=function(e){return e.length===2?(cS[e[0].toUpperCase()]||+e[0])*16+(cS[e[1].toUpperCase()]||+e[1]):cS[e[1].toUpperCase()]||+e[1]},Aee=function(e,t,o){t=t/100,o=o/100;let a=t;const d=Math.max(o,.01);o*=2,t*=o<=1?o:2-o,a*=d<=1?d:2-d;const p=(o+t)/2,y=o===0?2*a/(d+a):2*t/(o+t);return{h:e,s:y*100,v:p*100}},SR=(e,t,o)=>{e=Mm(e,255),t=Mm(t,255),o=Mm(o,255);const a=Math.max(e,t,o),d=Math.min(e,t,o);let p;const y=a,r=a-d,S=a===0?0:r/a;if(a===d)p=0;else{switch(a){case e:{p=(t-o)/r+(t<o?6:0);break}case t:{p=(o-e)/r+2;break}case o:{p=(e-t)/r+4;break}}p/=6}return{h:p*360,s:S*100,v:y*100}},X_=function(e,t,o){e=Mm(e,360)*6,t=Mm(t,100),o=Mm(o,100);const a=Math.floor(e),d=e-a,p=o*(1-t),y=o*(1-d*t),r=o*(1-(1-d)*t),S=a%6,C=[o,y,p,p,r,o][S],M=[r,o,o,y,p,p][S],P=[p,p,r,o,o,y][S];return{r:Math.round(C*255),g:Math.round(M*255),b:Math.round(P*255)}};class _y{constructor(t={}){this._hue=0,this._saturation=100,this._value=100,this._alpha=100,this.enableAlpha=!1,this.format="hex",this.value="";for(const o in t)ri(t,o)&&(this[o]=t[o]);t.value?this.fromString(t.value):this.doOnChange()}set(t,o){if(arguments.length===1&&typeof t=="object"){for(const a in t)ri(t,a)&&this.set(a,t[a]);return}this[`_${t}`]=o,this.doOnChange()}get(t){return t==="alpha"?Math.floor(this[`_${t}`]):this[`_${t}`]}toRgb(){return X_(this._hue,this._saturation,this._value)}fromString(t){if(!t){this._hue=0,this._saturation=100,this._value=100,this.doOnChange();return}const o=(a,d,p)=>{this._hue=Math.max(0,Math.min(360,a)),this._saturation=Math.max(0,Math.min(100,d)),this._value=Math.max(0,Math.min(100,p)),this.doOnChange()};if(t.includes("hsl")){const a=t.replace(/hsla|hsl|\(|\)/gm,"").split(/\s|,/g).filter(d=>d!=="").map((d,p)=>p>2?Number.parseFloat(d):Number.parseInt(d,10));if(a.length===4?this._alpha=Number.parseFloat(a[3])*100:a.length===3&&(this._alpha=100),a.length>=3){const{h:d,s:p,v:y}=Aee(a[0],a[1],a[2]);o(d,p,y)}}else if(t.includes("hsv")){const a=t.replace(/hsva|hsv|\(|\)/gm,"").split(/\s|,/g).filter(d=>d!=="").map((d,p)=>p>2?Number.parseFloat(d):Number.parseInt(d,10));a.length===4?this._alpha=Number.parseFloat(a[3])*100:a.length===3&&(this._alpha=100),a.length>=3&&o(a[0],a[1],a[2])}else if(t.includes("rgb")){const a=t.replace(/rgba|rgb|\(|\)/gm,"").split(/\s|,/g).filter(d=>d!=="").map((d,p)=>p>2?Number.parseFloat(d):Number.parseInt(d,10));if(a.length===4?this._alpha=Number.parseFloat(a[3])*100:a.length===3&&(this._alpha=100),a.length>=3){const{h:d,s:p,v:y}=SR(a[0],a[1],a[2]);o(d,p,y)}}else if(t.includes("#")){const a=t.replace("#","").trim();if(!/^[0-9a-fA-F]{3}$|^[0-9a-fA-F]{6}$|^[0-9a-fA-F]{8}$/.test(a))return;let d,p,y;a.length===3?(d=rh(a[0]+a[0]),p=rh(a[1]+a[1]),y=rh(a[2]+a[2])):(a.length===6||a.length===8)&&(d=rh(a.slice(0,2)),p=rh(a.slice(2,4)),y=rh(a.slice(4,6))),a.length===8?this._alpha=rh(a.slice(6))/255*100:(a.length===3||a.length===6)&&(this._alpha=100);const{h:r,s:S,v:C}=SR(d,p,y);o(r,S,C)}}compare(t){return Math.abs(t._hue-this._hue)<2&&Math.abs(t._saturation-this._saturation)<1&&Math.abs(t._value-this._value)<1&&Math.abs(t._alpha-this._alpha)<1}doOnChange(){const{_hue:t,_saturation:o,_value:a,_alpha:d,format:p}=this;if(this.enableAlpha)switch(p){case"hsl":{const y=bR(t,o/100,a/100);this.value=`hsla(${t}, ${Math.round(y[1]*100)}%, ${Math.round(y[2]*100)}%, ${this.get("alpha")/100})`;break}case"hsv":{this.value=`hsva(${t}, ${Math.round(o)}%, ${Math.round(a)}%, ${this.get("alpha")/100})`;break}case"hex":{this.value=`${wR(X_(t,o,a))}${Yb(d*255/100)}`;break}default:{const{r:y,g:r,b:S}=X_(t,o,a);this.value=`rgba(${y}, ${r}, ${S}, ${this.get("alpha")/100})`}}else switch(p){case"hsl":{const y=bR(t,o/100,a/100);this.value=`hsl(${t}, ${Math.round(y[1]*100)}%, ${Math.round(y[2]*100)}%)`;break}case"hsv":{this.value=`hsv(${t}, ${Math.round(o)}%, ${Math.round(a)}%)`;break}case"rgb":{const{r:y,g:r,b:S}=X_(t,o,a);this.value=`rgb(${y}, ${r}, ${S})`;break}default:this.value=wR(X_(t,o,a))}}}const kee=We({props:{colors:{type:Array,required:!0},color:{type:Object,required:!0},enableAlpha:{type:Boolean,required:!0}},setup(e){const t=Xt("color-predefine"),{currentColor:o}=Pn(V4),a=xe(p(e.colors,e.color));Wt(()=>o.value,y=>{const r=new _y;r.fromString(y),a.value.forEach(S=>{S.selected=r.compare(S)})}),gs(()=>{a.value=p(e.colors,e.color)});function d(y){e.color.fromString(e.colors[y])}function p(y,r){return y.map(S=>{const C=new _y;return C.enableAlpha=e.enableAlpha,C.format="rgba",C.fromString(S),C.selected=C.value===r.value,C})}return{rgbaColors:a,handleSelect:d,ns:t}}});function Pee(e,t,o,a,d,p){return ae(),Pe("div",{class:fe(e.ns.b())},[Ue("div",{class:fe(e.ns.e("colors"))},[(ae(!0),Pe(Vn,null,Fr(e.rgbaColors,(y,r)=>(ae(),Pe("div",{key:e.colors[r],class:fe([e.ns.e("color-selector"),e.ns.is("alpha",y._alpha<100),{selected:y.selected}]),onClick:S=>e.handleSelect(r)},[Ue("div",{style:Un({backgroundColor:y.value})},null,4)],10,["onClick"]))),128))],2)],2)}var Ree=dn(kee,[["render",Pee],["__file","predefine.vue"]]);const Oee=We({name:"ElSlPanel",props:{color:{type:Object,required:!0}},setup(e){const t=Xt("color-svpanel"),o=Cr(),a=xe(0),d=xe(0),p=xe("hsl(0, 100%, 50%)"),y=ee(()=>{const C=e.color.get("hue"),M=e.color.get("value");return{hue:C,value:M}});function r(){const C=e.color.get("saturation"),M=e.color.get("value"),P=o.vnode.el,{clientWidth:z,clientHeight:F}=P;d.value=C*z/100,a.value=(100-M)*F/100,p.value=`hsl(${e.color.get("hue")}, 100%, 50%)`}function S(C){const P=o.vnode.el.getBoundingClientRect(),{clientX:z,clientY:F}=wE(C);let V=z-P.left,N=F-P.top;V=Math.max(0,V),V=Math.min(V,P.width),N=Math.max(0,N),N=Math.min(N,P.height),d.value=V,a.value=N,e.color.set({saturation:V/P.width*100,value:100-N/P.height*100})}return Wt(()=>y.value,()=>{r()}),yr(()=>{Ny(o.vnode.el,{drag:C=>{S(C)},end:C=>{S(C)}}),r()}),{cursorTop:a,cursorLeft:d,background:p,colorValue:y,handleDrag:S,update:r,ns:t}}});function Lee(e,t,o,a,d,p){return ae(),Pe("div",{class:fe(e.ns.b()),style:Un({backgroundColor:e.background})},[Ue("div",{class:fe(e.ns.e("white"))},null,2),Ue("div",{class:fe(e.ns.e("black"))},null,2),Ue("div",{class:fe(e.ns.e("cursor")),style:Un({top:e.cursorTop+"px",left:e.cursorLeft+"px"})},[Ue("div")],6)],6)}var Dee=dn(Oee,[["render",Lee],["__file","sv-panel.vue"]]);const zee=We({name:"ElColorPicker"}),Fee=We({...zee,props:Cee,emits:Eee,setup(e,{expose:t,emit:o}){const a=e,{t:d}=qr(),p=Xt("color"),{formItem:y}=xs(),r=Ro(),S=ws(),{inputId:C,isLabeledByFormItem:M}=ml(a,{formItemContext:y}),P=xe(),z=xe(),F=xe(),V=xe(),N=xe(),H=xe(),{isFocused:U,handleFocus:te,handleBlur:Z}=af(N,{beforeFocus(){return S.value},beforeBlur(Gt){var Ne;return(Ne=V.value)==null?void 0:Ne.isFocusInsideContent(Gt)},afterBlur(){be(!1),me()}});let q=!0;const J=si(new _y({enableAlpha:a.showAlpha,format:a.colorFormat||"",value:a.modelValue})),re=xe(!1),se=xe(!1),he=xe(""),le=ee(()=>!a.modelValue&&!se.value?"transparent":Ve(J,a.showAlpha)),ce=ee(()=>!a.modelValue&&!se.value?"":J.value),pe=ee(()=>M.value?void 0:a.ariaLabel||d("el.colorpicker.defaultLabel")),de=ee(()=>M.value?y==null?void 0:y.labelId:void 0),Ie=ee(()=>[p.b("picker"),p.is("disabled",S.value),p.bm("picker",r.value),p.is("focused",U.value)]);function Ve(Gt,Ne){if(!(Gt instanceof _y))throw new TypeError("color should be instance of _color Class");const{r:an,g:Ae,b:tt}=Gt.toRgb();return Ne?`rgba(${an}, ${Ae}, ${tt}, ${Gt.get("alpha")/100})`:`rgb(${an}, ${Ae}, ${tt})`}function be(Gt){re.value=Gt}const ye=Ca(be,100,{leading:!0});function Me(){S.value||be(!0)}function we(){ye(!1),me()}function me(){jn(()=>{a.modelValue?J.fromString(a.modelValue):(J.value="",jn(()=>{se.value=!1}))})}function De(){S.value||(re.value&&me(),ye(!re.value))}function Ge(){J.fromString(he.value)}function rt(){const Gt=J.value;o(gr,Gt),o("change",Gt),a.validateEvent&&(y==null||y.validate("change").catch(Ne=>void 0)),ye(!1),jn(()=>{const Ne=new _y({enableAlpha:a.showAlpha,format:a.colorFormat||"",value:a.modelValue});J.compare(Ne)||me()})}function Oe(){ye(!1),o(gr,null),o("change",null),a.modelValue!==null&&a.validateEvent&&(y==null||y.validate("change").catch(Gt=>void 0)),me()}function Ct(){re.value&&(we(),U.value&&_t())}function kt(Gt){Gt.preventDefault(),Gt.stopPropagation(),be(!1),me()}function Bt(Gt){switch(Gt.code){case Cn.enter:case Cn.numpadEnter:case Cn.space:Gt.preventDefault(),Gt.stopPropagation(),Me(),H.value.focus();break;case Cn.esc:kt(Gt);break}}function _t(){N.value.focus()}function jt(){N.value.blur()}return yr(()=>{a.modelValue&&(he.value=ce.value)}),Wt(()=>a.modelValue,Gt=>{Gt?Gt&&Gt!==J.value&&(q=!1,J.fromString(Gt)):se.value=!1}),Wt(()=>[a.colorFormat,a.showAlpha],()=>{J.enableAlpha=a.showAlpha,J.format=a.colorFormat||J.format,J.doOnChange(),o(gr,J.value)}),Wt(()=>ce.value,Gt=>{he.value=Gt,q&&o("activeChange",Gt),q=!0}),Wt(()=>J.value,()=>{!a.modelValue&&!se.value&&(se.value=!0)}),Wt(()=>re.value,()=>{jn(()=>{var Gt,Ne,an;(Gt=P.value)==null||Gt.update(),(Ne=z.value)==null||Ne.update(),(an=F.value)==null||an.update()})}),Vr(V4,{currentColor:ce}),t({color:J,show:Me,hide:we,focus:_t,blur:jt}),(Gt,Ne)=>(ae(),At(b(bs),{ref_key:"popper",ref:V,visible:re.value,"show-arrow":!1,"fallback-placements":["bottom","top","right","left"],offset:0,"gpu-acceleration":!1,"popper-class":[b(p).be("picker","panel"),b(p).b("dropdown"),Gt.popperClass],"stop-popper-mouse-event":!1,effect:"light",trigger:"click",teleported:Gt.teleported,transition:`${b(p).namespace.value}-zoom-in-top`,persistent:"",onHide:an=>be(!1)},{content:ot(()=>[hr((ae(),Pe("div",{onKeydown:Ri(kt,["esc"])},[Ue("div",{class:fe(b(p).be("dropdown","main-wrapper"))},[qe(Tee,{ref_key:"hue",ref:P,class:"hue-slider",color:b(J),vertical:""},null,8,["color"]),qe(Dee,{ref_key:"sv",ref:z,color:b(J)},null,8,["color"])],2),Gt.showAlpha?(ae(),At(xee,{key:0,ref_key:"alpha",ref:F,color:b(J)},null,8,["color"])):bt("v-if",!0),Gt.predefine?(ae(),At(Ree,{key:1,ref:"predefine","enable-alpha":Gt.showAlpha,color:b(J),colors:Gt.predefine},null,8,["enable-alpha","color","colors"])):bt("v-if",!0),Ue("div",{class:fe(b(p).be("dropdown","btns"))},[Ue("span",{class:fe(b(p).be("dropdown","value"))},[qe(b(Bs),{ref_key:"inputRef",ref:H,modelValue:he.value,"onUpdate:modelValue":an=>he.value=an,"validate-event":!1,size:"small",onKeyup:Ri(Ge,["enter"]),onBlur:Ge},null,8,["modelValue","onUpdate:modelValue","onKeyup"])],2),qe(b(ts),{class:fe(b(p).be("dropdown","link-btn")),text:"",size:"small",onClick:Oe},{default:ot(()=>[Nr(fn(b(d)("el.colorpicker.clear")),1)]),_:1},8,["class"]),qe(b(ts),{plain:"",size:"small",class:fe(b(p).be("dropdown","btn")),onClick:rt},{default:ot(()=>[Nr(fn(b(d)("el.colorpicker.confirm")),1)]),_:1},8,["class"])],2)],40,["onKeydown"])),[[b(Pc),Ct,N.value]])]),default:ot(()=>[Ue("div",kr({id:b(C),ref_key:"triggerRef",ref:N},Gt.$attrs,{class:b(Ie),role:"button","aria-label":b(pe),"aria-labelledby":b(de),"aria-description":b(d)("el.colorpicker.description",{color:Gt.modelValue||""}),"aria-disabled":b(S),tabindex:b(S)?-1:Gt.tabindex,onKeydown:Bt,onFocus:b(te),onBlur:b(Z)}),[b(S)?(ae(),Pe("div",{key:0,class:fe(b(p).be("picker","mask"))},null,2)):bt("v-if",!0),Ue("div",{class:fe(b(p).be("picker","trigger")),onClick:De},[Ue("span",{class:fe([b(p).be("picker","color"),b(p).is("alpha",Gt.showAlpha)])},[Ue("span",{class:fe(b(p).be("picker","color-inner")),style:Un({backgroundColor:b(le)})},[hr(qe(b(zn),{class:fe([b(p).be("picker","icon"),b(p).is("icon-arrow-down")])},{default:ot(()=>[qe(b(zc))]),_:1},8,["class"]),[[ii,Gt.modelValue||se.value]]),hr(qe(b(zn),{class:fe([b(p).be("picker","empty"),b(p).is("icon-close")])},{default:ot(()=>[qe(b(Ql))]),_:1},8,["class"]),[[ii,!Gt.modelValue&&!se.value]])],6)],2)],2)],16,["id","aria-label","aria-labelledby","aria-description","aria-disabled","tabindex","onFocus","onBlur"])]),_:1},8,["visible","popper-class","teleported","transition","onHide"]))}});var Nee=dn(Fee,[["__file","color-picker.vue"]]);const Bee=lr(Nee),Vee=un({a11y:{type:Boolean,default:!0},locale:{type:lt(Object)},size:zo,button:{type:lt(Object)},experimentalFeatures:{type:lt(Object)},keyboardNavigation:{type:Boolean,default:!0},message:{type:lt(Object)},zIndex:Number,namespace:{type:String,default:"el"},...sg}),jl={},$ee=We({name:"ElConfigProvider",props:Vee,setup(e,{slots:t}){Wt(()=>e.message,a=>{Object.assign(jl,a??{})},{immediate:!0,deep:!0});const o=ZC(e);return()=>gt(t,"default",{config:o==null?void 0:o.value})}}),Uee=lr($ee),jee=We({name:"ElContainer"}),Hee=We({...jee,props:{direction:{type:String}},setup(e){const t=e,o=Bo(),a=Xt("container"),d=ee(()=>t.direction==="vertical"?!0:t.direction==="horizontal"?!1:o&&o.default?o.default().some(y=>{const r=y.type.name;return r==="ElHeader"||r==="ElFooter"}):!1);return(p,y)=>(ae(),Pe("section",{class:fe([b(a).b(),b(a).is("vertical",b(d))])},[gt(p.$slots,"default")],2))}});var Gee=dn(Hee,[["__file","container.vue"]]);const Wee=We({name:"ElAside"}),qee=We({...Wee,props:{width:{type:String,default:null}},setup(e){const t=e,o=Xt("aside"),a=ee(()=>t.width?o.cssVarBlock({width:t.width}):{});return(d,p)=>(ae(),Pe("aside",{class:fe(b(o).b()),style:Un(b(a))},[gt(d.$slots,"default")],6))}});var $4=dn(qee,[["__file","aside.vue"]]);const Kee=We({name:"ElFooter"}),Zee=We({...Kee,props:{height:{type:String,default:null}},setup(e){const t=e,o=Xt("footer"),a=ee(()=>t.height?o.cssVarBlock({height:t.height}):{});return(d,p)=>(ae(),Pe("footer",{class:fe(b(o).b()),style:Un(b(a))},[gt(d.$slots,"default")],6))}});var U4=dn(Zee,[["__file","footer.vue"]]);const Yee=We({name:"ElHeader"}),Xee=We({...Yee,props:{height:{type:String,default:null}},setup(e){const t=e,o=Xt("header"),a=ee(()=>t.height?o.cssVarBlock({height:t.height}):{});return(d,p)=>(ae(),Pe("header",{class:fe(b(o).b()),style:Un(b(a))},[gt(d.$slots,"default")],6))}});var j4=dn(Xee,[["__file","header.vue"]]);const Jee=We({name:"ElMain"}),Qee=We({...Jee,setup(e){const t=Xt("main");return(o,a)=>(ae(),Pe("main",{class:fe(b(t).b())},[gt(o.$slots,"default")],2))}});var H4=dn(Qee,[["__file","main.vue"]]);const ete=lr(Gee,{Aside:$4,Footer:U4,Header:j4,Main:H4}),tte=oo($4),nte=oo(U4),rte=oo(j4),ite=oo(H4);var G4={exports:{}};(function(e,t){(function(o,a){e.exports=a()})(Gu,function(){var o={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},a=/(\[[^[]*\])|([-_:/.,()\s]+)|(A|a|Q|YYYY|YY?|ww?|MM?M?M?|Do|DD?|hh?|HH?|mm?|ss?|S{1,3}|z|ZZ?)/g,d=/\d/,p=/\d\d/,y=/\d\d?/,r=/\d*[^-_:/,()\s\d]+/,S={},C=function(H){return(H=+H)+(H>68?1900:2e3)},M=function(H){return function(U){this[H]=+U}},P=[/[+-]\d\d:?(\d\d)?|Z/,function(H){(this.zone||(this.zone={})).offset=function(U){if(!U||U==="Z")return 0;var te=U.match(/([+-]|\d\d)/g),Z=60*te[1]+(+te[2]||0);return Z===0?0:te[0]==="+"?-Z:Z}(H)}],z=function(H){var U=S[H];return U&&(U.indexOf?U:U.s.concat(U.f))},F=function(H,U){var te,Z=S.meridiem;if(Z){for(var q=1;q<=24;q+=1)if(H.indexOf(Z(q,0,U))>-1){te=q>12;break}}else te=H===(U?"pm":"PM");return te},V={A:[r,function(H){this.afternoon=F(H,!1)}],a:[r,function(H){this.afternoon=F(H,!0)}],Q:[d,function(H){this.month=3*(H-1)+1}],S:[d,function(H){this.milliseconds=100*+H}],SS:[p,function(H){this.milliseconds=10*+H}],SSS:[/\d{3}/,function(H){this.milliseconds=+H}],s:[y,M("seconds")],ss:[y,M("seconds")],m:[y,M("minutes")],mm:[y,M("minutes")],H:[y,M("hours")],h:[y,M("hours")],HH:[y,M("hours")],hh:[y,M("hours")],D:[y,M("day")],DD:[p,M("day")],Do:[r,function(H){var U=S.ordinal,te=H.match(/\d+/);if(this.day=te[0],U)for(var Z=1;Z<=31;Z+=1)U(Z).replace(/\[|\]/g,"")===H&&(this.day=Z)}],w:[y,M("week")],ww:[p,M("week")],M:[y,M("month")],MM:[p,M("month")],MMM:[r,function(H){var U=z("months"),te=(z("monthsShort")||U.map(function(Z){return Z.slice(0,3)})).indexOf(H)+1;if(te<1)throw new Error;this.month=te%12||te}],MMMM:[r,function(H){var U=z("months").indexOf(H)+1;if(U<1)throw new Error;this.month=U%12||U}],Y:[/[+-]?\d+/,M("year")],YY:[p,function(H){this.year=C(H)}],YYYY:[/\d{4}/,M("year")],Z:P,ZZ:P};function N(H){var U,te;U=H,te=S&&S.formats;for(var Z=(H=U.replace(/(\[[^\]]+])|(LTS?|l{1,4}|L{1,4})/g,function(ce,pe,de){var Ie=de&&de.toUpperCase();return pe||te[de]||o[de]||te[Ie].replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,function(Ve,be,ye){return be||ye.slice(1)})})).match(a),q=Z.length,J=0;J<q;J+=1){var re=Z[J],se=V[re],he=se&&se[0],le=se&&se[1];Z[J]=le?{regex:he,parser:le}:re.replace(/^\[|\]$/g,"")}return function(ce){for(var pe={},de=0,Ie=0;de<q;de+=1){var Ve=Z[de];if(typeof Ve=="string")Ie+=Ve.length;else{var be=Ve.regex,ye=Ve.parser,Me=ce.slice(Ie),we=be.exec(Me)[0];ye.call(pe,we),ce=ce.replace(we,"")}}return function(me){var De=me.afternoon;if(De!==void 0){var Ge=me.hours;De?Ge<12&&(me.hours+=12):Ge===12&&(me.hours=0),delete me.afternoon}}(pe),pe}}return function(H,U,te){te.p.customParseFormat=!0,H&&H.parseTwoDigitYear&&(C=H.parseTwoDigitYear);var Z=U.prototype,q=Z.parse;Z.parse=function(J){var re=J.date,se=J.utc,he=J.args;this.$u=se;var le=he[1];if(typeof le=="string"){var ce=he[2]===!0,pe=he[3]===!0,de=ce||pe,Ie=he[2];pe&&(Ie=he[2]),S=this.$locale(),!ce&&Ie&&(S=te.Ls[Ie]),this.$d=function(Me,we,me,De){try{if(["x","X"].indexOf(we)>-1)return new Date((we==="X"?1e3:1)*Me);var Ge=N(we)(Me),rt=Ge.year,Oe=Ge.month,Ct=Ge.day,kt=Ge.hours,Bt=Ge.minutes,_t=Ge.seconds,jt=Ge.milliseconds,Gt=Ge.zone,Ne=Ge.week,an=new Date,Ae=Ct||(rt||Oe?1:an.getDate()),tt=rt||an.getFullYear(),Je=0;rt&&!Oe||(Je=Oe>0?Oe-1:an.getMonth());var Jt,Kt=kt||0,Nt=Bt||0,Pt=_t||0,Dt=jt||0;return Gt?new Date(Date.UTC(tt,Je,Ae,Kt,Nt,Pt,Dt+60*Gt.offset*1e3)):me?new Date(Date.UTC(tt,Je,Ae,Kt,Nt,Pt,Dt)):(Jt=new Date(tt,Je,Ae,Kt,Nt,Pt,Dt),Ne&&(Jt=De(Jt).week(Ne).toDate()),Jt)}catch{return new Date("")}}(re,le,se,te),this.init(),Ie&&Ie!==!0&&(this.$L=this.locale(Ie).$L),de&&re!=this.format(le)&&(this.$d=new Date("")),S={}}else if(le instanceof Array)for(var Ve=le.length,be=1;be<=Ve;be+=1){he[1]=le[be-1];var ye=te.apply(this,he);if(ye.isValid()){this.$d=ye.$d,this.$L=ye.$L,this.init();break}be===Ve&&(this.$d=new Date(""))}else q.call(this,J)}}})})(G4);var ote=G4.exports;const SE=qa(ote);var W4={exports:{}};(function(e,t){(function(o,a){e.exports=a()})(Gu,function(){return function(o,a){var d=a.prototype,p=d.format;d.format=function(y){var r=this,S=this.$locale();if(!this.isValid())return p.bind(this)(y);var C=this.$utils(),M=(y||"YYYY-MM-DDTHH:mm:ssZ").replace(/\[([^\]]+)]|Q|wo|ww|w|WW|W|zzz|z|gggg|GGGG|Do|X|x|k{1,2}|S/g,function(P){switch(P){case"Q":return Math.ceil((r.$M+1)/3);case"Do":return S.ordinal(r.$D);case"gggg":return r.weekYear();case"GGGG":return r.isoWeekYear();case"wo":return S.ordinal(r.week(),"W");case"w":case"ww":return C.s(r.week(),P==="w"?1:2,"0");case"W":case"WW":return C.s(r.isoWeek(),P==="W"?1:2,"0");case"k":case"kk":return C.s(String(r.$H===0?24:r.$H),P==="k"?1:2,"0");case"X":return Math.floor(r.$d.getTime()/1e3);case"x":return r.$d.getTime();case"z":return"["+r.offsetName()+"]";case"zzz":return"["+r.offsetName("long")+"]";default:return P}});return p.bind(this)(M)}}})})(W4);var ste=W4.exports;const ate=qa(ste);var q4={exports:{}};(function(e,t){(function(o,a){e.exports=a()})(Gu,function(){var o="week",a="year";return function(d,p,y){var r=p.prototype;r.week=function(S){if(S===void 0&&(S=null),S!==null)return this.add(7*(S-this.week()),"day");var C=this.$locale().yearStart||1;if(this.month()===11&&this.date()>25){var M=y(this).startOf(a).add(1,a).date(C),P=y(this).endOf(o);if(M.isBefore(P))return 1}var z=y(this).startOf(a).date(C).startOf(o).subtract(1,"millisecond"),F=this.diff(z,o,!0);return F<0?y(this).startOf("week").week():Math.ceil(F)},r.weeks=function(S){return S===void 0&&(S=null),this.week(S)}}})})(q4);var lte=q4.exports;const ute=qa(lte);var K4={exports:{}};(function(e,t){(function(o,a){e.exports=a()})(Gu,function(){return function(o,a){a.prototype.weekYear=function(){var d=this.month(),p=this.week(),y=this.year();return p===1&&d===11?y+1:d===0&&p>=52?y-1:y}}})})(K4);var cte=K4.exports;const dte=qa(cte);var Z4={exports:{}};(function(e,t){(function(o,a){e.exports=a()})(Gu,function(){return function(o,a,d){a.prototype.dayOfYear=function(p){var y=Math.round((d(this).startOf("day")-d(this).startOf("year"))/864e5)+1;return p==null?y:this.add(p-y,"day")}}})})(Z4);var fte=Z4.exports;const hte=qa(fte);var Y4={exports:{}};(function(e,t){(function(o,a){e.exports=a()})(Gu,function(){return function(o,a){a.prototype.isSameOrAfter=function(d,p){return this.isSame(d,p)||this.isAfter(d,p)}}})})(Y4);var pte=Y4.exports;const mte=qa(pte);var X4={exports:{}};(function(e,t){(function(o,a){e.exports=a()})(Gu,function(){return function(o,a){a.prototype.isSameOrBefore=function(d,p){return this.isSame(d,p)||this.isBefore(d,p)}}})})(X4);var gte=X4.exports;const _te=qa(gte),TR=["hours","minutes","seconds"],cT="HH:mm:ss",pm="YYYY-MM-DD",yte={date:pm,dates:pm,week:"gggg[w]ww",year:"YYYY",years:"YYYY",month:"YYYY-MM",months:"YYYY-MM",datetime:`${pm} ${cT}`,monthrange:"YYYY-MM",yearrange:"YYYY",daterange:pm,datetimerange:`${pm} ${cT}`},J4=un({disabledHours:{type:lt(Function)},disabledMinutes:{type:lt(Function)},disabledSeconds:{type:lt(Function)}}),Q4=un({visible:Boolean,actualVisible:{type:Boolean,default:void 0},format:{type:String,default:""}}),TE=un({id:{type:lt([Array,String])},name:{type:lt([Array,String])},popperClass:{type:String,default:""},format:String,valueFormat:String,dateFormat:String,timeFormat:String,type:{type:String,default:""},clearable:{type:Boolean,default:!0},clearIcon:{type:lt([String,Object]),default:Fc},editable:{type:Boolean,default:!0},prefixIcon:{type:lt([String,Object]),default:""},size:zo,readonly:Boolean,disabled:Boolean,placeholder:{type:String,default:""},popperOptions:{type:lt(Object),default:()=>({})},modelValue:{type:lt([Date,Array,String,Number]),default:""},rangeSeparator:{type:String,default:"-"},startPlaceholder:String,endPlaceholder:String,defaultValue:{type:lt([Date,Array])},defaultTime:{type:lt([Date,Array])},isRange:Boolean,...J4,disabledDate:{type:Function},cellClassName:{type:Function},shortcuts:{type:Array,default:()=>[]},arrowControl:Boolean,tabindex:{type:lt([String,Number]),default:0},validateEvent:{type:Boolean,default:!0},unlinkPanels:Boolean,placement:{type:lt(String),values:Nc,default:"bottom"},fallbackPlacements:{type:lt(Array),default:["bottom","top","right","left"]},...sg,...cs(["ariaLabel"]),showNow:{type:Boolean,default:!0}}),vte=un({id:{type:lt(Array)},name:{type:lt(Array)},modelValue:{type:lt([Array,String])},startPlaceholder:String,endPlaceholder:String}),bte=We({name:"PickerRangeTrigger",inheritAttrs:!1}),xte=We({...bte,props:vte,emits:["mouseenter","mouseleave","click","touchstart","focus","blur","startInput","endInput","startChange","endChange"],setup(e,{expose:t,emit:o}){const a=uv(),d=Xt("date"),p=Xt("range"),y=xe(),r=xe(),{wrapperRef:S,isFocused:C}=af(y),M=q=>{o("click",q)},P=q=>{o("mouseenter",q)},z=q=>{o("mouseleave",q)},F=q=>{o("mouseenter",q)},V=q=>{o("startInput",q)},N=q=>{o("endInput",q)},H=q=>{o("startChange",q)},U=q=>{o("endChange",q)};return t({focus:()=>{var q;(q=y.value)==null||q.focus()},blur:()=>{var q,J;(q=y.value)==null||q.blur(),(J=r.value)==null||J.blur()}}),(q,J)=>(ae(),Pe("div",{ref_key:"wrapperRef",ref:S,class:fe([b(d).is("active",b(C)),q.$attrs.class]),style:Un(q.$attrs.style),onClick:M,onMouseenter:P,onMouseleave:z,onTouchstartPassive:F},[gt(q.$slots,"prefix"),Ue("input",kr(b(a),{id:q.id&&q.id[0],ref_key:"inputRef",ref:y,name:q.name&&q.name[0],placeholder:q.startPlaceholder,value:q.modelValue&&q.modelValue[0],class:b(p).b("input"),onInput:V,onChange:H}),null,16,["id","name","placeholder","value"]),gt(q.$slots,"range-separator"),Ue("input",kr(b(a),{id:q.id&&q.id[1],ref_key:"endInputRef",ref:r,name:q.name&&q.name[1],placeholder:q.endPlaceholder,value:q.modelValue&&q.modelValue[1],class:b(p).b("input"),onInput:N,onChange:U}),null,16,["id","name","placeholder","value"]),gt(q.$slots,"suffix")],38))}});var wte=dn(xte,[["__file","picker-range-trigger.vue"]]);const Ste=We({name:"Picker"}),Tte=We({...Ste,props:TE,emits:["update:modelValue","change","focus","blur","clear","calendar-change","panel-change","visible-change","keydown"],setup(e,{expose:t,emit:o}){const a=e,d=of(),{lang:p}=qr(),y=Xt("date"),r=Xt("input"),S=Xt("range"),{form:C,formItem:M}=xs(),P=Pn("ElPopperOptions",{}),{valueOnClear:z}=hx(a,null),F=xe(),V=xe(),N=xe(!1),H=xe(!1),U=xe(null);let te=!1;const{isFocused:Z,handleFocus:q,handleBlur:J}=af(V,{beforeFocus(){return a.readonly||me.value},afterFocus(){N.value=!0},beforeBlur(Ye){var pn;return!te&&((pn=F.value)==null?void 0:pn.isFocusInsideContent(Ye))},afterBlur(){rn(),N.value=!1,te=!1,a.validateEvent&&(M==null||M.validate("blur").catch(Ye=>void 0))}}),re=ee(()=>[y.b("editor"),y.bm("editor",a.type),r.e("wrapper"),y.is("disabled",me.value),y.is("active",N.value),S.b("editor"),Kt?S.bm("editor",Kt.value):"",d.class]),se=ee(()=>[r.e("icon"),S.e("close-icon"),jt.value?"":S.e("close-icon--hidden")]);Wt(N,Ye=>{Ye?jn(()=>{Ye&&(U.value=a.modelValue)}):(Dt.value=null,jn(()=>{he(a.modelValue)}))});const he=(Ye,pn)=>{(pn||!uR(Ye,U.value))&&(o("change",Ye),a.validateEvent&&(M==null||M.validate("change").catch(xn=>void 0)))},le=Ye=>{if(!uR(a.modelValue,Ye)){let pn;sn(Ye)?pn=Ye.map(xn=>dR(xn,a.valueFormat,p.value)):Ye&&(pn=dR(Ye,a.valueFormat,p.value)),o("update:modelValue",Ye&&pn,p.value)}},ce=Ye=>{o("keydown",Ye)},pe=ee(()=>V.value?Array.from(V.value.$el.querySelectorAll("input")):[]),de=(Ye,pn,xn)=>{const _r=pe.value;_r.length&&(!xn||xn==="min"?(_r[0].setSelectionRange(Ye,pn),_r[0].focus()):xn==="max"&&(_r[1].setSelectionRange(Ye,pn),_r[1].focus()))},Ie=(Ye="",pn=!1)=>{N.value=pn;let xn;sn(Ye)?xn=Ye.map(_r=>_r.toDate()):xn=Ye&&Ye.toDate(),Dt.value=null,le(xn)},Ve=()=>{H.value=!0},be=()=>{o("visible-change",!0)},ye=()=>{H.value=!1,N.value=!1,o("visible-change",!1)},Me=()=>{N.value=!0},we=()=>{N.value=!1},me=ee(()=>a.disabled||(C==null?void 0:C.disabled)),De=ee(()=>{let Ye;if(Ne.value?Ar.value.getDefaultValue&&(Ye=Ar.value.getDefaultValue()):sn(a.modelValue)?Ye=a.modelValue.map(pn=>cR(pn,a.valueFormat,p.value)):Ye=cR(a.modelValue,a.valueFormat,p.value),Ar.value.getRangeAvailableTime){const pn=Ar.value.getRangeAvailableTime(Ye);_s(pn,Ye)||(Ye=pn,Ne.value||le(Ab(Ye)))}return sn(Ye)&&Ye.some(pn=>!pn)&&(Ye=[]),Ye}),Ge=ee(()=>{if(!Ar.value.panelReady)return"";const Ye=Ln(De.value);return sn(Dt.value)?[Dt.value[0]||Ye&&Ye[0]||"",Dt.value[1]||Ye&&Ye[1]||""]:Dt.value!==null?Dt.value:!Oe.value&&Ne.value||!N.value&&Ne.value?"":Ye?Ct.value||kt.value||Bt.value?Ye.join(", "):Ye:""}),rt=ee(()=>a.type.includes("time")),Oe=ee(()=>a.type.startsWith("time")),Ct=ee(()=>a.type==="dates"),kt=ee(()=>a.type==="months"),Bt=ee(()=>a.type==="years"),_t=ee(()=>a.prefixIcon||(rt.value?Az:J9)),jt=xe(!1),Gt=Ye=>{a.readonly||me.value||(jt.value&&(Ye.stopPropagation(),Ar.value.handleClear?Ar.value.handleClear():le(z.value),he(z.value,!0),jt.value=!1,ye()),o("clear"))},Ne=ee(()=>{const{modelValue:Ye}=a;return!Ye||sn(Ye)&&!Ye.filter(Boolean).length}),an=async Ye=>{var pn;a.readonly||me.value||(((pn=Ye.target)==null?void 0:pn.tagName)!=="INPUT"||Z.value)&&(N.value=!0)},Ae=()=>{a.readonly||me.value||!Ne.value&&a.clearable&&(jt.value=!0)},tt=()=>{jt.value=!1},Je=Ye=>{var pn;a.readonly||me.value||(((pn=Ye.touches[0].target)==null?void 0:pn.tagName)!=="INPUT"||Z.value)&&(N.value=!0)},Jt=ee(()=>a.type.includes("range")),Kt=Ro(),Nt=ee(()=>{var Ye,pn;return(pn=(Ye=b(F))==null?void 0:Ye.popperRef)==null?void 0:pn.contentRef}),Pt=KC(V,Ye=>{const pn=b(Nt),xn=Qs(V);pn&&(Ye.target===pn||Ye.composedPath().includes(pn))||Ye.target===xn||xn&&Ye.composedPath().includes(xn)||(N.value=!1)});Li(()=>{Pt==null||Pt()});const Dt=xe(null),rn=()=>{if(Dt.value){const Ye=on(Ge.value);Ye&&yn(Ye)&&(le(Ab(Ye)),Dt.value=null)}Dt.value===""&&(le(z.value),he(z.value),Dt.value=null)},on=Ye=>Ye?Ar.value.parseUserInput(Ye):null,Ln=Ye=>Ye?Ar.value.formatToString(Ye):null,yn=Ye=>Ar.value.isValidValue(Ye),Et=async Ye=>{if(a.readonly||me.value)return;const{code:pn}=Ye;if(ce(Ye),pn===Cn.esc){N.value===!0&&(N.value=!1,Ye.preventDefault(),Ye.stopPropagation());return}if(pn===Cn.down&&(Ar.value.handleFocusPicker&&(Ye.preventDefault(),Ye.stopPropagation()),N.value===!1&&(N.value=!0,await jn()),Ar.value.handleFocusPicker)){Ar.value.handleFocusPicker();return}if(pn===Cn.tab){te=!0;return}if(pn===Cn.enter||pn===Cn.numpadEnter){(Dt.value===null||Dt.value===""||yn(on(Ge.value)))&&(rn(),N.value=!1),Ye.stopPropagation();return}if(Dt.value){Ye.stopPropagation();return}Ar.value.handleKeydownInput&&Ar.value.handleKeydownInput(Ye)},En=Ye=>{Dt.value=Ye,N.value||(N.value=!0)},Xn=Ye=>{const pn=Ye.target;Dt.value?Dt.value=[pn.value,Dt.value[1]]:Dt.value=[pn.value,null]},vr=Ye=>{const pn=Ye.target;Dt.value?Dt.value=[Dt.value[0],pn.value]:Dt.value=[null,pn.value]},er=()=>{var Ye;const pn=Dt.value,xn=on(pn&&pn[0]),_r=b(De);if(xn&&xn.isValid()){Dt.value=[Ln(xn),((Ye=Ge.value)==null?void 0:Ye[1])||null];const yi=[xn,_r&&(_r[1]||null)];yn(yi)&&(le(Ab(yi)),Dt.value=null)}},Dr=()=>{var Ye;const pn=b(Dt),xn=on(pn&&pn[1]),_r=b(De);if(xn&&xn.isValid()){Dt.value=[((Ye=b(Ge))==null?void 0:Ye[0])||null,Ln(xn)];const yi=[_r&&_r[0],xn];yn(yi)&&(le(Ab(yi)),Dt.value=null)}},Ar=xe({}),Di=Ye=>{Ar.value[Ye[0]]=Ye[1],Ar.value.panelReady=!0},ui=Ye=>{o("calendar-change",Ye)},zt=(Ye,pn,xn)=>{o("panel-change",Ye,pn,xn)},st=()=>{var Ye;(Ye=V.value)==null||Ye.focus()},Ft=()=>{var Ye;(Ye=V.value)==null||Ye.blur()};return Vr("EP_PICKER_BASE",{props:a}),t({focus:st,blur:Ft,handleOpen:Me,handleClose:we,onPick:Ie}),(Ye,pn)=>(ae(),At(b(bs),kr({ref_key:"refPopper",ref:F,visible:N.value,effect:"light",pure:"",trigger:"click"},Ye.$attrs,{role:"dialog",teleported:"",transition:`${b(y).namespace.value}-zoom-in-top`,"popper-class":[`${b(y).namespace.value}-picker__popper`,Ye.popperClass],"popper-options":b(P),"fallback-placements":Ye.fallbackPlacements,"gpu-acceleration":!1,placement:Ye.placement,"stop-popper-mouse-event":!1,"hide-after":0,persistent:"",onBeforeShow:Ve,onShow:be,onHide:ye}),{default:ot(()=>[b(Jt)?(ae(),At(wte,{key:1,id:Ye.id,ref_key:"inputRef",ref:V,"model-value":b(Ge),name:Ye.name,disabled:b(me),readonly:!Ye.editable||Ye.readonly,"start-placeholder":Ye.startPlaceholder,"end-placeholder":Ye.endPlaceholder,class:fe(b(re)),style:Un(Ye.$attrs.style),"aria-label":Ye.ariaLabel,tabindex:Ye.tabindex,autocomplete:"off",role:"combobox",onClick:an,onFocus:b(q),onBlur:b(J),onStartInput:Xn,onStartChange:er,onEndInput:vr,onEndChange:Dr,onMousedown:an,onMouseenter:Ae,onMouseleave:tt,onTouchstartPassive:Je,onKeydown:Et},{prefix:ot(()=>[b(_t)?(ae(),At(b(zn),{key:0,class:fe([b(r).e("icon"),b(S).e("icon")])},{default:ot(()=>[(ae(),At(Ir(b(_t))))]),_:1},8,["class"])):bt("v-if",!0)]),"range-separator":ot(()=>[gt(Ye.$slots,"range-separator",{},()=>[Ue("span",{class:fe(b(S).b("separator"))},fn(Ye.rangeSeparator),3)])]),suffix:ot(()=>[Ye.clearIcon?(ae(),At(b(zn),{key:0,class:fe(b(se)),onMousedown:Jn(b(vi),["prevent"]),onClick:Gt},{default:ot(()=>[(ae(),At(Ir(Ye.clearIcon)))]),_:1},8,["class","onMousedown"])):bt("v-if",!0)]),_:3},8,["id","model-value","name","disabled","readonly","start-placeholder","end-placeholder","class","style","aria-label","tabindex","onFocus","onBlur"])):(ae(),At(b(Bs),{key:0,id:Ye.id,ref_key:"inputRef",ref:V,"container-role":"combobox","model-value":b(Ge),name:Ye.name,size:b(Kt),disabled:b(me),placeholder:Ye.placeholder,class:fe([b(y).b("editor"),b(y).bm("editor",Ye.type),Ye.$attrs.class]),style:Un(Ye.$attrs.style),readonly:!Ye.editable||Ye.readonly||b(Ct)||b(kt)||b(Bt)||Ye.type==="week","aria-label":Ye.ariaLabel,tabindex:Ye.tabindex,"validate-event":!1,onInput:En,onFocus:b(q),onBlur:b(J),onKeydown:Et,onChange:rn,onMousedown:an,onMouseenter:Ae,onMouseleave:tt,onTouchstartPassive:Je,onClick:Jn(()=>{},["stop"])},{prefix:ot(()=>[b(_t)?(ae(),At(b(zn),{key:0,class:fe(b(r).e("icon")),onMousedown:Jn(an,["prevent"]),onTouchstartPassive:Je},{default:ot(()=>[(ae(),At(Ir(b(_t))))]),_:1},8,["class","onMousedown"])):bt("v-if",!0)]),suffix:ot(()=>[jt.value&&Ye.clearIcon?(ae(),At(b(zn),{key:0,class:fe(`${b(r).e("icon")} clear-icon`),onMousedown:Jn(b(vi),["prevent"]),onClick:Gt},{default:ot(()=>[(ae(),At(Ir(Ye.clearIcon)))]),_:1},8,["class","onMousedown"])):bt("v-if",!0)]),_:1},8,["id","model-value","name","size","disabled","placeholder","class","style","readonly","aria-label","tabindex","onFocus","onBlur","onClick"]))]),content:ot(()=>[gt(Ye.$slots,"default",{visible:N.value,actualVisible:H.value,parsedValue:b(De),format:Ye.format,dateFormat:Ye.dateFormat,timeFormat:Ye.timeFormat,unlinkPanels:Ye.unlinkPanels,type:Ye.type,defaultValue:Ye.defaultValue,showNow:Ye.showNow,onPick:Ie,onSelectRange:de,onSetPickerOption:Di,onCalendarChange:ui,onPanelChange:zt,onMousedown:Jn(()=>{},["stop"])})]),_:3},16,["visible","transition","popper-class","popper-options","fallback-placements","placement"]))}});var eF=dn(Tte,[["__file","picker.vue"]]);const Cte=un({...Q4,datetimeRole:String,parsedValue:{type:lt(Object)}}),tF=({getAvailableHours:e,getAvailableMinutes:t,getAvailableSeconds:o})=>{const a=(y,r,S,C)=>{const M={hour:e,minute:t,second:o};let P=y;return["hour","minute","second"].forEach(z=>{if(M[z]){let F;const V=M[z];switch(z){case"minute":{F=V(P.hour(),r,C);break}case"second":{F=V(P.hour(),P.minute(),r,C);break}default:{F=V(r,C);break}}if(F!=null&&F.length&&!F.includes(P[z]())){const N=S?0:F.length-1;P=P[z](F[N])}}}),P},d={};return{timePickerOptions:d,getAvailableTime:a,onSetOption:([y,r])=>{d[y]=r}}},dS=e=>{const t=(a,d)=>a||d,o=a=>a!==!0;return e.map(t).filter(o)},nF=(e,t,o)=>({getHoursList:(y,r)=>aS(24,e&&(()=>e==null?void 0:e(y,r))),getMinutesList:(y,r,S)=>aS(60,t&&(()=>t==null?void 0:t(y,r,S))),getSecondsList:(y,r,S,C)=>aS(60,o&&(()=>o==null?void 0:o(y,r,S,C)))}),rF=(e,t,o)=>{const{getHoursList:a,getMinutesList:d,getSecondsList:p}=nF(e,t,o);return{getAvailableHours:(C,M)=>dS(a(C,M)),getAvailableMinutes:(C,M,P)=>dS(d(C,M,P)),getAvailableSeconds:(C,M,P,z)=>dS(p(C,M,P,z))}},iF=e=>{const t=xe(e.parsedValue);return Wt(()=>e.visible,o=>{o||(t.value=e.parsedValue)}),t},Ete=un({role:{type:String,required:!0},spinnerDate:{type:lt(Object),required:!0},showSeconds:{type:Boolean,default:!0},arrowControl:Boolean,amPmMode:{type:lt(String),default:""},...J4}),Mte=100,Ite=600,E1={beforeMount(e,t){const o=t.value,{interval:a=Mte,delay:d=Ite}=$n(o)?{}:o;let p,y;const r=()=>$n(o)?o():o.handler(),S=()=>{y&&(clearTimeout(y),y=void 0),p&&(clearInterval(p),p=void 0)};e.addEventListener("mousedown",C=>{C.button===0&&(S(),r(),document.addEventListener("mouseup",()=>S(),{once:!0}),y=setTimeout(()=>{p=setInterval(()=>{r()},a)},d))})}},Ate=We({__name:"basic-time-spinner",props:Ete,emits:["change","select-range","set-option"],setup(e,{emit:t}){const o=e,a=Pn("EP_PICKER_BASE"),{isRange:d}=a.props,p=Xt("time"),{getHoursList:y,getMinutesList:r,getSecondsList:S}=nF(o.disabledHours,o.disabledMinutes,o.disabledSeconds);let C=!1;const M=xe(),P=xe(),z=xe(),F=xe(),V={hours:P,minutes:z,seconds:F},N=ee(()=>o.showSeconds?TR:TR.slice(0,2)),H=ee(()=>{const{spinnerDate:Ge}=o,rt=Ge.hour(),Oe=Ge.minute(),Ct=Ge.second();return{hours:rt,minutes:Oe,seconds:Ct}}),U=ee(()=>{const{hours:Ge,minutes:rt}=b(H),{role:Oe,spinnerDate:Ct}=o,kt=d?void 0:Ct;return{hours:y(Oe,kt),minutes:r(Ge,Oe,kt),seconds:S(Ge,rt,Oe,kt)}}),te=ee(()=>{const{hours:Ge,minutes:rt,seconds:Oe}=b(H);return{hours:sS(Ge,23),minutes:sS(rt,59),seconds:sS(Oe,59)}}),Z=Ca(Ge=>{C=!1,re(Ge)},200),q=Ge=>{if(!!!o.amPmMode)return"";const Oe=o.amPmMode==="A";let Ct=Ge<12?" am":" pm";return Oe&&(Ct=Ct.toUpperCase()),Ct},J=Ge=>{let rt;switch(Ge){case"hours":rt=[0,2];break;case"minutes":rt=[3,5];break;case"seconds":rt=[6,8];break}const[Oe,Ct]=rt;t("select-range",Oe,Ct),M.value=Ge},re=Ge=>{le(Ge,b(H)[Ge])},se=()=>{re("hours"),re("minutes"),re("seconds")},he=Ge=>Ge.querySelector(`.${p.namespace.value}-scrollbar__wrap`),le=(Ge,rt)=>{if(o.arrowControl)return;const Oe=b(V[Ge]);Oe&&Oe.$el&&(he(Oe.$el).scrollTop=Math.max(0,rt*ce(Ge)))},ce=Ge=>{const rt=b(V[Ge]),Oe=rt==null?void 0:rt.$el.querySelector("li");return Oe&&Number.parseFloat(Tc(Oe,"height"))||0},pe=()=>{Ie(1)},de=()=>{Ie(-1)},Ie=Ge=>{M.value||J("hours");const rt=M.value,Oe=b(H)[rt],Ct=M.value==="hours"?24:60,kt=Ve(rt,Oe,Ge,Ct);be(rt,kt),le(rt,kt),jn(()=>J(rt))},Ve=(Ge,rt,Oe,Ct)=>{let kt=(rt+Oe+Ct)%Ct;const Bt=b(U)[Ge];for(;Bt[kt]&&kt!==rt;)kt=(kt+Oe+Ct)%Ct;return kt},be=(Ge,rt)=>{if(b(U)[Ge][rt])return;const{hours:kt,minutes:Bt,seconds:_t}=b(H);let jt;switch(Ge){case"hours":jt=o.spinnerDate.hour(rt).minute(Bt).second(_t);break;case"minutes":jt=o.spinnerDate.hour(kt).minute(rt).second(_t);break;case"seconds":jt=o.spinnerDate.hour(kt).minute(Bt).second(rt);break}t("change",jt)},ye=(Ge,{value:rt,disabled:Oe})=>{Oe||(be(Ge,rt),J(Ge),le(Ge,rt))},Me=Ge=>{const rt=b(V[Ge]);if(!rt)return;C=!0,Z(Ge);const Oe=Math.min(Math.round((he(rt.$el).scrollTop-(we(Ge)*.5-10)/ce(Ge)+3)/ce(Ge)),Ge==="hours"?23:59);be(Ge,Oe)},we=Ge=>b(V[Ge]).$el.offsetHeight,me=()=>{const Ge=rt=>{const Oe=b(V[rt]);Oe&&Oe.$el&&(he(Oe.$el).onscroll=()=>{Me(rt)})};Ge("hours"),Ge("minutes"),Ge("seconds")};yr(()=>{jn(()=>{!o.arrowControl&&me(),se(),o.role==="start"&&J("hours")})});const De=(Ge,rt)=>{V[rt].value=Ge??void 0};return t("set-option",[`${o.role}_scrollDown`,Ie]),t("set-option",[`${o.role}_emitSelectRange`,J]),Wt(()=>o.spinnerDate,()=>{C||se()}),(Ge,rt)=>(ae(),Pe("div",{class:fe([b(p).b("spinner"),{"has-seconds":Ge.showSeconds}])},[Ge.arrowControl?bt("v-if",!0):(ae(!0),Pe(Vn,{key:0},Fr(b(N),Oe=>(ae(),At(b(Hu),{key:Oe,ref_for:!0,ref:Ct=>De(Ct,Oe),class:fe(b(p).be("spinner","wrapper")),"wrap-style":"max-height: inherit;","view-class":b(p).be("spinner","list"),noresize:"",tag:"ul",onMouseenter:Ct=>J(Oe),onMousemove:Ct=>re(Oe)},{default:ot(()=>[(ae(!0),Pe(Vn,null,Fr(b(U)[Oe],(Ct,kt)=>(ae(),Pe("li",{key:kt,class:fe([b(p).be("spinner","item"),b(p).is("active",kt===b(H)[Oe]),b(p).is("disabled",Ct)]),onClick:Bt=>ye(Oe,{value:kt,disabled:Ct})},[Oe==="hours"?(ae(),Pe(Vn,{key:0},[Nr(fn(("0"+(Ge.amPmMode?kt%12||12:kt)).slice(-2))+fn(q(kt)),1)],64)):(ae(),Pe(Vn,{key:1},[Nr(fn(("0"+kt).slice(-2)),1)],64))],10,["onClick"]))),128))]),_:2},1032,["class","view-class","onMouseenter","onMousemove"]))),128)),Ge.arrowControl?(ae(!0),Pe(Vn,{key:1},Fr(b(N),Oe=>(ae(),Pe("div",{key:Oe,class:fe([b(p).be("spinner","wrapper"),b(p).is("arrow")]),onMouseenter:Ct=>J(Oe)},[hr((ae(),At(b(zn),{class:fe(["arrow-up",b(p).be("spinner","arrow")])},{default:ot(()=>[qe(b(JC))]),_:1},8,["class"])),[[b(E1),de]]),hr((ae(),At(b(zn),{class:fe(["arrow-down",b(p).be("spinner","arrow")])},{default:ot(()=>[qe(b(zc))]),_:1},8,["class"])),[[b(E1),pe]]),Ue("ul",{class:fe(b(p).be("spinner","list"))},[(ae(!0),Pe(Vn,null,Fr(b(te)[Oe],(Ct,kt)=>(ae(),Pe("li",{key:kt,class:fe([b(p).be("spinner","item"),b(p).is("active",Ct===b(H)[Oe]),b(p).is("disabled",b(U)[Oe][Ct])])},[b(Wn)(Ct)?(ae(),Pe(Vn,{key:0},[Oe==="hours"?(ae(),Pe(Vn,{key:0},[Nr(fn(("0"+(Ge.amPmMode?Ct%12||12:Ct)).slice(-2))+fn(q(Ct)),1)],64)):(ae(),Pe(Vn,{key:1},[Nr(fn(("0"+Ct).slice(-2)),1)],64))],64)):bt("v-if",!0)],2))),128))],2)],42,["onMouseenter"]))),128)):bt("v-if",!0)],2))}});var dT=dn(Ate,[["__file","basic-time-spinner.vue"]]);const kte=We({__name:"panel-time-pick",props:Cte,emits:["pick","select-range","set-picker-option"],setup(e,{emit:t}){const o=e,a=Pn("EP_PICKER_BASE"),{arrowControl:d,disabledHours:p,disabledMinutes:y,disabledSeconds:r,defaultValue:S}=a.props,{getAvailableHours:C,getAvailableMinutes:M,getAvailableSeconds:P}=rF(p,y,r),z=Xt("time"),{t:F,lang:V}=qr(),N=xe([0,2]),H=iF(o),U=ee(()=>ai(o.actualVisible)?`${z.namespace.value}-zoom-in-top`:""),te=ee(()=>o.format.includes("ss")),Z=ee(()=>o.format.includes("A")?"A":o.format.includes("a")?"a":""),q=we=>{const me=sr(we).locale(V.value),De=Ve(me);return me.isSame(De)},J=()=>{t("pick",H.value,!1)},re=(we=!1,me=!1)=>{me||t("pick",o.parsedValue,we)},se=we=>{if(!o.visible)return;const me=Ve(we).millisecond(0);t("pick",me,!0)},he=(we,me)=>{t("select-range",we,me),N.value=[we,me]},le=we=>{const me=[0,3].concat(te.value?[6]:[]),De=["hours","minutes"].concat(te.value?["seconds"]:[]),rt=(me.indexOf(N.value[0])+we+me.length)%me.length;pe.start_emitSelectRange(De[rt])},ce=we=>{const me=we.code,{left:De,right:Ge,up:rt,down:Oe}=Cn;if([De,Ge].includes(me)){le(me===De?-1:1),we.preventDefault();return}if([rt,Oe].includes(me)){const Ct=me===rt?-1:1;pe.start_scrollDown(Ct),we.preventDefault();return}},{timePickerOptions:pe,onSetOption:de,getAvailableTime:Ie}=tF({getAvailableHours:C,getAvailableMinutes:M,getAvailableSeconds:P}),Ve=we=>Ie(we,o.datetimeRole||"",!0),be=we=>we?sr(we,o.format).locale(V.value):null,ye=we=>we?we.format(o.format):null,Me=()=>sr(S).locale(V.value);return t("set-picker-option",["isValidValue",q]),t("set-picker-option",["formatToString",ye]),t("set-picker-option",["parseUserInput",be]),t("set-picker-option",["handleKeydownInput",ce]),t("set-picker-option",["getRangeAvailableTime",Ve]),t("set-picker-option",["getDefaultValue",Me]),(we,me)=>(ae(),At(rs,{name:b(U)},{default:ot(()=>[we.actualVisible||we.visible?(ae(),Pe("div",{key:0,class:fe(b(z).b("panel"))},[Ue("div",{class:fe([b(z).be("panel","content"),{"has-seconds":b(te)}])},[qe(dT,{ref:"spinner",role:we.datetimeRole||"start","arrow-control":b(d),"show-seconds":b(te),"am-pm-mode":b(Z),"spinner-date":we.parsedValue,"disabled-hours":b(p),"disabled-minutes":b(y),"disabled-seconds":b(r),onChange:se,onSetOption:b(de),onSelectRange:he},null,8,["role","arrow-control","show-seconds","am-pm-mode","spinner-date","disabled-hours","disabled-minutes","disabled-seconds","onSetOption"])],2),Ue("div",{class:fe(b(z).be("panel","footer"))},[Ue("button",{type:"button",class:fe([b(z).be("panel","btn"),"cancel"]),onClick:J},fn(b(F)("el.datepicker.cancel")),3),Ue("button",{type:"button",class:fe([b(z).be("panel","btn"),"confirm"]),onClick:De=>re()},fn(b(F)("el.datepicker.confirm")),11,["onClick"])],2)],2)):bt("v-if",!0)]),_:1},8,["name"]))}});var M1=dn(kte,[["__file","panel-time-pick.vue"]]);const Pte=un({...Q4,parsedValue:{type:lt(Array)}}),Rte=We({__name:"panel-time-range",props:Pte,emits:["pick","select-range","set-picker-option"],setup(e,{emit:t}){const o=e,a=(an,Ae)=>{const tt=[];for(let Je=an;Je<=Ae;Je++)tt.push(Je);return tt},{t:d,lang:p}=qr(),y=Xt("time"),r=Xt("picker"),S=Pn("EP_PICKER_BASE"),{arrowControl:C,disabledHours:M,disabledMinutes:P,disabledSeconds:z,defaultValue:F}=S.props,V=ee(()=>[y.be("range-picker","body"),y.be("panel","content"),y.is("arrow",C),q.value?"has-seconds":""]),N=ee(()=>[y.be("range-picker","body"),y.be("panel","content"),y.is("arrow",C),q.value?"has-seconds":""]),H=ee(()=>o.parsedValue[0]),U=ee(()=>o.parsedValue[1]),te=iF(o),Z=()=>{t("pick",te.value,!1)},q=ee(()=>o.format.includes("ss")),J=ee(()=>o.format.includes("A")?"A":o.format.includes("a")?"a":""),re=(an=!1)=>{t("pick",[H.value,U.value],an)},se=an=>{ce(an.millisecond(0),U.value)},he=an=>{ce(H.value,an.millisecond(0))},le=an=>{const Ae=an.map(Je=>sr(Je).locale(p.value)),tt=Ge(Ae);return Ae[0].isSame(tt[0])&&Ae[1].isSame(tt[1])},ce=(an,Ae)=>{o.visible&&t("pick",[an,Ae],!0)},pe=ee(()=>H.value>U.value),de=xe([0,2]),Ie=(an,Ae)=>{t("select-range",an,Ae,"min"),de.value=[an,Ae]},Ve=ee(()=>q.value?11:8),be=(an,Ae)=>{t("select-range",an,Ae,"max");const tt=b(Ve);de.value=[an+tt,Ae+tt]},ye=an=>{const Ae=q.value?[0,3,6,11,14,17]:[0,3,8,11],tt=["hours","minutes"].concat(q.value?["seconds"]:[]),Jt=(Ae.indexOf(de.value[0])+an+Ae.length)%Ae.length,Kt=Ae.length/2;Jt<Kt?kt.start_emitSelectRange(tt[Jt]):kt.end_emitSelectRange(tt[Jt-Kt])},Me=an=>{const Ae=an.code,{left:tt,right:Je,up:Jt,down:Kt}=Cn;if([tt,Je].includes(Ae)){ye(Ae===tt?-1:1),an.preventDefault();return}if([Jt,Kt].includes(Ae)){const Nt=Ae===Jt?-1:1,Pt=de.value[0]<Ve.value?"start":"end";kt[`${Pt}_scrollDown`](Nt),an.preventDefault();return}},we=(an,Ae)=>{const tt=M?M(an):[],Je=an==="start",Kt=(Ae||(Je?U.value:H.value)).hour(),Nt=Je?a(Kt+1,23):a(0,Kt-1);return eS(tt,Nt)},me=(an,Ae,tt)=>{const Je=P?P(an,Ae):[],Jt=Ae==="start",Kt=tt||(Jt?U.value:H.value),Nt=Kt.hour();if(an!==Nt)return Je;const Pt=Kt.minute(),Dt=Jt?a(Pt+1,59):a(0,Pt-1);return eS(Je,Dt)},De=(an,Ae,tt,Je)=>{const Jt=z?z(an,Ae,tt):[],Kt=tt==="start",Nt=Je||(Kt?U.value:H.value),Pt=Nt.hour(),Dt=Nt.minute();if(an!==Pt||Ae!==Dt)return Jt;const rn=Nt.second(),on=Kt?a(rn+1,59):a(0,rn-1);return eS(Jt,on)},Ge=([an,Ae])=>[Bt(an,"start",!0,Ae),Bt(Ae,"end",!1,an)],{getAvailableHours:rt,getAvailableMinutes:Oe,getAvailableSeconds:Ct}=rF(we,me,De),{timePickerOptions:kt,getAvailableTime:Bt,onSetOption:_t}=tF({getAvailableHours:rt,getAvailableMinutes:Oe,getAvailableSeconds:Ct}),jt=an=>an?sn(an)?an.map(Ae=>sr(Ae,o.format).locale(p.value)):sr(an,o.format).locale(p.value):null,Gt=an=>an?sn(an)?an.map(Ae=>Ae.format(o.format)):an.format(o.format):null,Ne=()=>{if(sn(F))return F.map(Ae=>sr(Ae).locale(p.value));const an=sr(F).locale(p.value);return[an,an.add(60,"m")]};return t("set-picker-option",["formatToString",Gt]),t("set-picker-option",["parseUserInput",jt]),t("set-picker-option",["isValidValue",le]),t("set-picker-option",["handleKeydownInput",Me]),t("set-picker-option",["getDefaultValue",Ne]),t("set-picker-option",["getRangeAvailableTime",Ge]),(an,Ae)=>an.actualVisible?(ae(),Pe("div",{key:0,class:fe([b(y).b("range-picker"),b(r).b("panel")])},[Ue("div",{class:fe(b(y).be("range-picker","content"))},[Ue("div",{class:fe(b(y).be("range-picker","cell"))},[Ue("div",{class:fe(b(y).be("range-picker","header"))},fn(b(d)("el.datepicker.startTime")),3),Ue("div",{class:fe(b(V))},[qe(dT,{ref:"minSpinner",role:"start","show-seconds":b(q),"am-pm-mode":b(J),"arrow-control":b(C),"spinner-date":b(H),"disabled-hours":we,"disabled-minutes":me,"disabled-seconds":De,onChange:se,onSetOption:b(_t),onSelectRange:Ie},null,8,["show-seconds","am-pm-mode","arrow-control","spinner-date","onSetOption"])],2)],2),Ue("div",{class:fe(b(y).be("range-picker","cell"))},[Ue("div",{class:fe(b(y).be("range-picker","header"))},fn(b(d)("el.datepicker.endTime")),3),Ue("div",{class:fe(b(N))},[qe(dT,{ref:"maxSpinner",role:"end","show-seconds":b(q),"am-pm-mode":b(J),"arrow-control":b(C),"spinner-date":b(U),"disabled-hours":we,"disabled-minutes":me,"disabled-seconds":De,onChange:he,onSetOption:b(_t),onSelectRange:be},null,8,["show-seconds","am-pm-mode","arrow-control","spinner-date","onSetOption"])],2)],2)],2),Ue("div",{class:fe(b(y).be("panel","footer"))},[Ue("button",{type:"button",class:fe([b(y).be("panel","btn"),"cancel"]),onClick:tt=>Z()},fn(b(d)("el.datepicker.cancel")),11,["onClick"]),Ue("button",{type:"button",class:fe([b(y).be("panel","btn"),"confirm"]),disabled:b(pe),onClick:tt=>re()},fn(b(d)("el.datepicker.confirm")),11,["disabled","onClick"])],2)],2)):bt("v-if",!0)}});var Ote=dn(Rte,[["__file","panel-time-range.vue"]]);sr.extend(SE);var Lte=We({name:"ElTimePicker",install:null,props:{...TE,isRange:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(e,t){const o=xe(),[a,d]=e.isRange?["timerange",Ote]:["time",M1],p=y=>t.emit("update:modelValue",y);return Vr("ElPopperOptions",e.popperOptions),t.expose({focus:()=>{var y;(y=o.value)==null||y.focus()},blur:()=>{var y;(y=o.value)==null||y.blur()},handleOpen:()=>{var y;(y=o.value)==null||y.handleOpen()},handleClose:()=>{var y;(y=o.value)==null||y.handleClose()}}),()=>{var y;const r=(y=e.format)!=null?y:cT;return qe(eF,kr(e,{ref:o,type:a,format:r,"onUpdate:modelValue":p}),{default:S=>qe(d,S,null)})}}});const Dte=lr(Lte),Sx=Symbol(),zte=un({...TE,type:{type:lt(String),default:"date"}}),Fte=["date","dates","year","years","month","months","week","range"],CE=un({disabledDate:{type:lt(Function)},date:{type:lt(Object),required:!0},minDate:{type:lt(Object)},maxDate:{type:lt(Object)},parsedValue:{type:lt([Object,Array])},rangeState:{type:lt(Object),default:()=>({endDate:null,selecting:!1})}}),oF=un({type:{type:lt(String),required:!0,values:nJ},dateFormat:String,timeFormat:String,showNow:{type:Boolean,default:!0}}),EE=un({unlinkPanels:Boolean,parsedValue:{type:lt(Array)}}),ME=e=>({type:String,values:Fte,default:e}),Nte=un({...oF,parsedValue:{type:lt([Object,Array])},visible:{type:Boolean},format:{type:String,default:""}}),jm=e=>{if(!sn(e))return!1;const[t,o]=e;return sr.isDayjs(t)&&sr.isDayjs(o)&&t.isSameOrBefore(o)},IE=(e,{lang:t,unit:o,unlinkPanels:a})=>{let d;if(sn(e)){let[p,y]=e.map(r=>sr(r).locale(t));return a||(y=p.add(1,o)),[p,y]}else e?d=sr(e):d=sr();return d=d.locale(t),[d,d.add(1,o)]},Bte=(e,t,{columnIndexOffset:o,startDate:a,nextEndDate:d,now:p,unit:y,relativeDateGetter:r,setCellMetadata:S,setRowMetadata:C})=>{for(let M=0;M<e.row;M++){const P=t[M];for(let z=0;z<e.column;z++){let F=P[z+o];F||(F={row:M,column:z,type:"normal",inRange:!1,start:!1,end:!1});const V=M*e.column+z,N=r(V);F.dayjs=N,F.date=N.toDate(),F.timestamp=N.valueOf(),F.type="normal",F.inRange=!!(a&&N.isSameOrAfter(a,y)&&d&&N.isSameOrBefore(d,y))||!!(a&&N.isSameOrBefore(a,y)&&d&&N.isSameOrAfter(d,y)),a!=null&&a.isSameOrAfter(d)?(F.start=!!d&&N.isSame(d,y),F.end=a&&N.isSame(a,y)):(F.start=!!a&&N.isSame(a,y),F.end=!!d&&N.isSame(d,y)),N.isSame(p,y)&&(F.type="today"),S==null||S(F,{rowIndex:M,columnIndex:z}),P[z+o]=F}C==null||C(P)}},I1=(e,t,o)=>{const a=sr().locale(o).startOf("month").month(t).year(e),d=a.daysInMonth();return jd(d).map(p=>a.add(p,"day").toDate())},By=(e,t,o,a)=>{const d=sr().year(e).month(t).startOf("month"),p=I1(e,t,o).find(y=>!(a!=null&&a(y)));return p?sr(p).locale(o):d.locale(o)},fT=(e,t,o)=>{const a=e.year();if(!(o!=null&&o(e.toDate())))return e.locale(t);const d=e.month();if(!I1(a,d,t).every(o))return By(a,d,t,o);for(let p=0;p<12;p++)if(!I1(a,p,t).every(o))return By(a,p,t,o);return e},Vte=un({...CE,cellClassName:{type:lt(Function)},showWeekNumber:Boolean,selectionMode:ME("date")}),$te=["changerange","pick","select"],hT=(e="")=>["normal","today"].includes(e),Ute=(e,t)=>{const{lang:o}=qr(),a=xe(),d=xe(),p=xe(),y=xe(),r=xe([[],[],[],[],[],[]]);let S=!1;const C=e.date.$locale().weekStart||7,M=e.date.locale("en").localeData().weekdaysShort().map(me=>me.toLowerCase()),P=ee(()=>C>3?7-C:-C),z=ee(()=>{const me=e.date.startOf("month");return me.subtract(me.day()||7,"day")}),F=ee(()=>M.concat(M).slice(C,C+7)),V=ee(()=>zD(b(q)).some(me=>me.isCurrent)),N=ee(()=>{const me=e.date.startOf("month"),De=me.day()||7,Ge=me.daysInMonth(),rt=me.subtract(1,"month").daysInMonth();return{startOfMonthDay:De,dateCountOfMonth:Ge,dateCountOfLastMonth:rt}}),H=ee(()=>e.selectionMode==="dates"?Js(e.parsedValue):[]),U=(me,{count:De,rowIndex:Ge,columnIndex:rt})=>{const{startOfMonthDay:Oe,dateCountOfMonth:Ct,dateCountOfLastMonth:kt}=b(N),Bt=b(P);if(Ge>=0&&Ge<=1){const _t=Oe+Bt<0?7+Oe+Bt:Oe+Bt;if(rt+Ge*7>=_t)return me.text=De,!0;me.text=kt-(_t-rt%7)+1+Ge*7,me.type="prev-month"}else return De<=Ct?me.text=De:(me.text=De-Ct,me.type="next-month"),!0;return!1},te=(me,{columnIndex:De,rowIndex:Ge},rt)=>{const{disabledDate:Oe,cellClassName:Ct}=e,kt=b(H),Bt=U(me,{count:rt,rowIndex:Ge,columnIndex:De}),_t=me.dayjs.toDate();return me.selected=kt.find(jt=>jt.isSame(me.dayjs,"day")),me.isSelected=!!me.selected,me.isCurrent=re(me),me.disabled=Oe==null?void 0:Oe(_t),me.customClass=Ct==null?void 0:Ct(_t),Bt},Z=me=>{if(e.selectionMode==="week"){const[De,Ge]=e.showWeekNumber?[1,7]:[0,6],rt=we(me[De+1]);me[De].inRange=rt,me[De].start=rt,me[Ge].inRange=rt,me[Ge].end=rt}},q=ee(()=>{const{minDate:me,maxDate:De,rangeState:Ge,showWeekNumber:rt}=e,Oe=b(P),Ct=b(r),kt="day";let Bt=1;if(rt)for(let _t=0;_t<6;_t++)Ct[_t][0]||(Ct[_t][0]={type:"week",text:b(z).add(_t*7+1,kt).week()});return Bte({row:6,column:7},Ct,{startDate:me,columnIndexOffset:rt?1:0,nextEndDate:Ge.endDate||De||Ge.selecting&&me||null,now:sr().locale(b(o)).startOf(kt),unit:kt,relativeDateGetter:_t=>b(z).add(_t-Oe,kt),setCellMetadata:(..._t)=>{te(..._t,Bt)&&(Bt+=1)},setRowMetadata:Z}),Ct});Wt(()=>e.date,async()=>{var me;(me=b(a))!=null&&me.contains(document.activeElement)&&(await jn(),await J())});const J=async()=>{var me;return(me=b(d))==null?void 0:me.focus()},re=me=>e.selectionMode==="date"&&hT(me.type)&&se(me,e.parsedValue),se=(me,De)=>De?sr(De).locale(b(o)).isSame(e.date.date(Number(me.text)),"day"):!1,he=(me,De)=>{const Ge=me*7+(De-(e.showWeekNumber?1:0))-b(P);return b(z).add(Ge,"day")},le=me=>{var De;if(!e.rangeState.selecting)return;let Ge=me.target;if(Ge.tagName==="SPAN"&&(Ge=(De=Ge.parentNode)==null?void 0:De.parentNode),Ge.tagName==="DIV"&&(Ge=Ge.parentNode),Ge.tagName!=="TD")return;const rt=Ge.parentNode.rowIndex-1,Oe=Ge.cellIndex;b(q)[rt][Oe].disabled||(rt!==b(p)||Oe!==b(y))&&(p.value=rt,y.value=Oe,t("changerange",{selecting:!0,endDate:he(rt,Oe)}))},ce=me=>!b(V)&&(me==null?void 0:me.text)===1&&me.type==="normal"||me.isCurrent,pe=me=>{S||b(V)||e.selectionMode!=="date"||Me(me,!0)},de=me=>{me.target.closest("td")&&(S=!0)},Ie=me=>{me.target.closest("td")&&(S=!1)},Ve=me=>{!e.rangeState.selecting||!e.minDate?(t("pick",{minDate:me,maxDate:null}),t("select",!0)):(me>=e.minDate?t("pick",{minDate:e.minDate,maxDate:me}):t("pick",{minDate:me,maxDate:e.minDate}),t("select",!1))},be=me=>{const De=me.week(),Ge=`${me.year()}w${De}`;t("pick",{year:me.year(),week:De,value:Ge,date:me.startOf("week")})},ye=(me,De)=>{const Ge=De?Js(e.parsedValue).filter(rt=>(rt==null?void 0:rt.valueOf())!==me.valueOf()):Js(e.parsedValue).concat([me]);t("pick",Ge)},Me=(me,De=!1)=>{const Ge=me.target.closest("td");if(!Ge)return;const rt=Ge.parentNode.rowIndex-1,Oe=Ge.cellIndex,Ct=b(q)[rt][Oe];if(Ct.disabled||Ct.type==="week")return;const kt=he(rt,Oe);switch(e.selectionMode){case"range":{Ve(kt);break}case"date":{t("pick",kt,De);break}case"week":{be(kt);break}case"dates":{ye(kt,!!Ct.selected);break}}},we=me=>{if(e.selectionMode!=="week")return!1;let De=e.date.startOf("day");if(me.type==="prev-month"&&(De=De.subtract(1,"month")),me.type==="next-month"&&(De=De.add(1,"month")),De=De.date(Number.parseInt(me.text,10)),e.parsedValue&&!sn(e.parsedValue)){const Ge=(e.parsedValue.day()-C+7)%7-1;return e.parsedValue.subtract(Ge,"day").isSame(De,"day")}return!1};return{WEEKS:F,rows:q,tbodyRef:a,currentCellRef:d,focus:J,isCurrent:re,isWeekActive:we,isSelectedCell:ce,handlePickDate:Me,handleMouseUp:Ie,handleMouseDown:de,handleMouseMove:le,handleFocus:pe}},jte=(e,{isCurrent:t,isWeekActive:o})=>{const a=Xt("date-table"),{t:d}=qr(),p=ee(()=>[a.b(),{"is-week-mode":e.selectionMode==="week"}]),y=ee(()=>d("el.datepicker.dateTablePrompt")),r=ee(()=>d("el.datepicker.week"));return{tableKls:p,tableLabel:y,weekLabel:r,getCellClasses:M=>{const P=[];return hT(M.type)&&!M.disabled?(P.push("available"),M.type==="today"&&P.push("today")):P.push(M.type),t(M)&&P.push("current"),M.inRange&&(hT(M.type)||e.selectionMode==="week")&&(P.push("in-range"),M.start&&P.push("start-date"),M.end&&P.push("end-date")),M.disabled&&P.push("disabled"),M.selected&&P.push("selected"),M.customClass&&P.push(M.customClass),P.join(" ")},getRowKls:M=>[a.e("row"),{current:o(M)}],t:d}},Hte=un({cell:{type:lt(Object)}});var AE=We({name:"ElDatePickerCell",props:Hte,setup(e){const t=Xt("date-table-cell"),{slots:o}=Pn(Sx);return()=>{const{cell:a}=e;return gt(o,"default",{...a},()=>{var d;return[qe("div",{class:t.b()},[qe("span",{class:t.e("text")},[(d=a==null?void 0:a.renderText)!=null?d:a==null?void 0:a.text])])]})}}});const Gte=We({__name:"basic-date-table",props:Vte,emits:$te,setup(e,{expose:t,emit:o}){const a=e,{WEEKS:d,rows:p,tbodyRef:y,currentCellRef:r,focus:S,isCurrent:C,isWeekActive:M,isSelectedCell:P,handlePickDate:z,handleMouseUp:F,handleMouseDown:V,handleMouseMove:N,handleFocus:H}=Ute(a,o),{tableLabel:U,tableKls:te,weekLabel:Z,getCellClasses:q,getRowKls:J,t:re}=jte(a,{isCurrent:C,isWeekActive:M});return t({focus:S}),(se,he)=>(ae(),Pe("table",{"aria-label":b(U),class:fe(b(te)),cellspacing:"0",cellpadding:"0",role:"grid",onClick:b(z),onMousemove:b(N),onMousedown:Jn(b(V),["prevent"]),onMouseup:b(F)},[Ue("tbody",{ref_key:"tbodyRef",ref:y},[Ue("tr",null,[se.showWeekNumber?(ae(),Pe("th",{key:0,scope:"col"},fn(b(Z)),1)):bt("v-if",!0),(ae(!0),Pe(Vn,null,Fr(b(d),(le,ce)=>(ae(),Pe("th",{key:ce,"aria-label":b(re)("el.datepicker.weeksFull."+le),scope:"col"},fn(b(re)("el.datepicker.weeks."+le)),9,["aria-label"]))),128))]),(ae(!0),Pe(Vn,null,Fr(b(p),(le,ce)=>(ae(),Pe("tr",{key:ce,class:fe(b(J)(le[1]))},[(ae(!0),Pe(Vn,null,Fr(le,(pe,de)=>(ae(),Pe("td",{key:`${ce}.${de}`,ref_for:!0,ref:Ie=>b(P)(pe)&&(r.value=Ie),class:fe(b(q)(pe)),"aria-current":pe.isCurrent?"date":void 0,"aria-selected":pe.isCurrent,tabindex:b(P)(pe)?0:-1,onFocus:b(H)},[qe(b(AE),{cell:pe},null,8,["cell"])],42,["aria-current","aria-selected","tabindex","onFocus"]))),128))],2))),128))],512)],42,["aria-label","onClick","onMousemove","onMousedown","onMouseup"]))}});var pT=dn(Gte,[["__file","basic-date-table.vue"]]);const Wte=un({...CE,selectionMode:ME("month")}),qte=We({__name:"basic-month-table",props:Wte,emits:["changerange","pick","select"],setup(e,{expose:t,emit:o}){const a=e,d=Xt("month-table"),{t:p,lang:y}=qr(),r=xe(),S=xe(),C=xe(a.date.locale("en").localeData().monthsShort().map(Z=>Z.toLowerCase())),M=xe([[],[],[]]),P=xe(),z=xe(),F=ee(()=>{var Z,q;const J=M.value,re=sr().locale(y.value).startOf("month");for(let se=0;se<3;se++){const he=J[se];for(let le=0;le<4;le++){const ce=he[le]||(he[le]={row:se,column:le,type:"normal",inRange:!1,start:!1,end:!1,text:-1,disabled:!1});ce.type="normal";const pe=se*4+le,de=a.date.startOf("year").month(pe),Ie=a.rangeState.endDate||a.maxDate||a.rangeState.selecting&&a.minDate||null;ce.inRange=!!(a.minDate&&de.isSameOrAfter(a.minDate,"month")&&Ie&&de.isSameOrBefore(Ie,"month"))||!!(a.minDate&&de.isSameOrBefore(a.minDate,"month")&&Ie&&de.isSameOrAfter(Ie,"month")),(Z=a.minDate)!=null&&Z.isSameOrAfter(Ie)?(ce.start=!!(Ie&&de.isSame(Ie,"month")),ce.end=a.minDate&&de.isSame(a.minDate,"month")):(ce.start=!!(a.minDate&&de.isSame(a.minDate,"month")),ce.end=!!(Ie&&de.isSame(Ie,"month"))),re.isSame(de)&&(ce.type="today"),ce.text=pe,ce.disabled=((q=a.disabledDate)==null?void 0:q.call(a,de.toDate()))||!1}}return J}),V=()=>{var Z;(Z=S.value)==null||Z.focus()},N=Z=>{const q={},J=a.date.year(),re=new Date,se=Z.text;return q.disabled=a.disabledDate?I1(J,se,y.value).every(a.disabledDate):!1,q.current=Js(a.parsedValue).findIndex(he=>sr.isDayjs(he)&&he.year()===J&&he.month()===se)>=0,q.today=re.getFullYear()===J&&re.getMonth()===se,Z.inRange&&(q["in-range"]=!0,Z.start&&(q["start-date"]=!0),Z.end&&(q["end-date"]=!0)),q},H=Z=>{const q=a.date.year(),J=Z.text;return Js(a.date).findIndex(re=>re.year()===q&&re.month()===J)>=0},U=Z=>{var q;if(!a.rangeState.selecting)return;let J=Z.target;if(J.tagName==="SPAN"&&(J=(q=J.parentNode)==null?void 0:q.parentNode),J.tagName==="DIV"&&(J=J.parentNode),J.tagName!=="TD")return;const re=J.parentNode.rowIndex,se=J.cellIndex;F.value[re][se].disabled||(re!==P.value||se!==z.value)&&(P.value=re,z.value=se,o("changerange",{selecting:!0,endDate:a.date.startOf("year").month(re*4+se)}))},te=Z=>{var q;const J=(q=Z.target)==null?void 0:q.closest("td");if((J==null?void 0:J.tagName)!=="TD"||wa(J,"disabled"))return;const re=J.cellIndex,he=J.parentNode.rowIndex*4+re,le=a.date.startOf("year").month(he);if(a.selectionMode==="months"){if(Z.type==="keydown"){o("pick",Js(a.parsedValue),!1);return}const ce=By(a.date.year(),he,y.value,a.disabledDate),pe=wa(J,"current")?Js(a.parsedValue).filter(de=>(de==null?void 0:de.month())!==ce.month()):Js(a.parsedValue).concat([sr(ce)]);o("pick",pe)}else a.selectionMode==="range"?a.rangeState.selecting?(a.minDate&&le>=a.minDate?o("pick",{minDate:a.minDate,maxDate:le}):o("pick",{minDate:le,maxDate:a.minDate}),o("select",!1)):(o("pick",{minDate:le,maxDate:null}),o("select",!0)):o("pick",he)};return Wt(()=>a.date,async()=>{var Z,q;(Z=r.value)!=null&&Z.contains(document.activeElement)&&(await jn(),(q=S.value)==null||q.focus())}),t({focus:V}),(Z,q)=>(ae(),Pe("table",{role:"grid","aria-label":b(p)("el.datepicker.monthTablePrompt"),class:fe(b(d).b()),onClick:te,onMousemove:U},[Ue("tbody",{ref_key:"tbodyRef",ref:r},[(ae(!0),Pe(Vn,null,Fr(b(F),(J,re)=>(ae(),Pe("tr",{key:re},[(ae(!0),Pe(Vn,null,Fr(J,(se,he)=>(ae(),Pe("td",{key:he,ref_for:!0,ref:le=>H(se)&&(S.value=le),class:fe(N(se)),"aria-selected":`${H(se)}`,"aria-label":b(p)(`el.datepicker.month${+se.text+1}`),tabindex:H(se)?0:-1,onKeydown:[Ri(Jn(te,["prevent","stop"]),["space"]),Ri(Jn(te,["prevent","stop"]),["enter"])]},[qe(b(AE),{cell:{...se,renderText:b(p)("el.datepicker.months."+C.value[se.text])}},null,8,["cell"])],42,["aria-selected","aria-label","tabindex","onKeydown"]))),128))]))),128))],512)],42,["aria-label"]))}});var mT=dn(qte,[["__file","basic-month-table.vue"]]);const Kte=un({...CE,selectionMode:ME("year")}),Zte=We({__name:"basic-year-table",props:Kte,emits:["changerange","pick","select"],setup(e,{expose:t,emit:o}){const a=e,d=(q,J)=>{const re=sr(String(q)).locale(J).startOf("year"),he=re.endOf("year").dayOfYear();return jd(he).map(le=>re.add(le,"day").toDate())},p=Xt("year-table"),{t:y,lang:r}=qr(),S=xe(),C=xe(),M=ee(()=>Math.floor(a.date.year()/10)*10),P=xe([[],[],[]]),z=xe(),F=xe(),V=ee(()=>{var q;const J=P.value,re=sr().locale(r.value).startOf("year");for(let se=0;se<3;se++){const he=J[se];for(let le=0;le<4&&!(se*4+le>=10);le++){let ce=he[le];ce||(ce={row:se,column:le,type:"normal",inRange:!1,start:!1,end:!1,text:-1,disabled:!1}),ce.type="normal";const pe=se*4+le+M.value,de=sr().year(pe),Ie=a.rangeState.endDate||a.maxDate||a.rangeState.selecting&&a.minDate||null;ce.inRange=!!(a.minDate&&de.isSameOrAfter(a.minDate,"year")&&Ie&&de.isSameOrBefore(Ie,"year"))||!!(a.minDate&&de.isSameOrBefore(a.minDate,"year")&&Ie&&de.isSameOrAfter(Ie,"year")),(q=a.minDate)!=null&&q.isSameOrAfter(Ie)?(ce.start=!!(Ie&&de.isSame(Ie,"year")),ce.end=!!(a.minDate&&de.isSame(a.minDate,"year"))):(ce.start=!!(a.minDate&&de.isSame(a.minDate,"year")),ce.end=!!(Ie&&de.isSame(Ie,"year"))),re.isSame(de)&&(ce.type="today"),ce.text=pe;const be=de.toDate();ce.disabled=a.disabledDate&&a.disabledDate(be)||!1,he[le]=ce}}return J}),N=()=>{var q;(q=C.value)==null||q.focus()},H=q=>{const J={},re=sr().locale(r.value),se=q.text;return J.disabled=a.disabledDate?d(se,r.value).every(a.disabledDate):!1,J.today=re.year()===se,J.current=Js(a.parsedValue).findIndex(he=>he.year()===se)>=0,q.inRange&&(J["in-range"]=!0,q.start&&(J["start-date"]=!0),q.end&&(J["end-date"]=!0)),J},U=q=>{const J=q.text;return Js(a.date).findIndex(re=>re.year()===J)>=0},te=q=>{var J;const re=(J=q.target)==null?void 0:J.closest("td");if(!re||!re.textContent||wa(re,"disabled"))return;const se=re.cellIndex,le=re.parentNode.rowIndex*4+se+M.value,ce=sr().year(le);if(a.selectionMode==="range")a.rangeState.selecting?(a.minDate&&ce>=a.minDate?o("pick",{minDate:a.minDate,maxDate:ce}):o("pick",{minDate:ce,maxDate:a.minDate}),o("select",!1)):(o("pick",{minDate:ce,maxDate:null}),o("select",!0));else if(a.selectionMode==="years"){if(q.type==="keydown"){o("pick",Js(a.parsedValue),!1);return}const pe=fT(ce.startOf("year"),r.value,a.disabledDate),de=wa(re,"current")?Js(a.parsedValue).filter(Ie=>(Ie==null?void 0:Ie.year())!==le):Js(a.parsedValue).concat([pe]);o("pick",de)}else o("pick",le)},Z=q=>{var J;if(!a.rangeState.selecting)return;const re=(J=q.target)==null?void 0:J.closest("td");if(!re)return;const se=re.parentNode.rowIndex,he=re.cellIndex;V.value[se][he].disabled||(se!==z.value||he!==F.value)&&(z.value=se,F.value=he,o("changerange",{selecting:!0,endDate:sr().year(M.value).add(se*4+he,"year")}))};return Wt(()=>a.date,async()=>{var q,J;(q=S.value)!=null&&q.contains(document.activeElement)&&(await jn(),(J=C.value)==null||J.focus())}),t({focus:N}),(q,J)=>(ae(),Pe("table",{role:"grid","aria-label":b(y)("el.datepicker.yearTablePrompt"),class:fe(b(p).b()),onClick:te,onMousemove:Z},[Ue("tbody",{ref_key:"tbodyRef",ref:S},[(ae(!0),Pe(Vn,null,Fr(b(V),(re,se)=>(ae(),Pe("tr",{key:se},[(ae(!0),Pe(Vn,null,Fr(re,(he,le)=>(ae(),Pe("td",{key:`${se}_${le}`,ref_for:!0,ref:ce=>U(he)&&(C.value=ce),class:fe(["available",H(he)]),"aria-selected":U(he),"aria-label":String(he.text),tabindex:U(he)?0:-1,onKeydown:[Ri(Jn(te,["prevent","stop"]),["space"]),Ri(Jn(te,["prevent","stop"]),["enter"])]},[qe(b(AE),{cell:he},null,8,["cell"])],42,["aria-selected","aria-label","tabindex","onKeydown"]))),128))]))),128))],512)],42,["aria-label"]))}});var gT=dn(Zte,[["__file","basic-year-table.vue"]]);const Yte=We({__name:"panel-date-pick",props:Nte,emits:["pick","set-picker-option","panel-change"],setup(e,{emit:t}){const o=e,a=(zt,st,Ft)=>!0,d=Xt("picker-panel"),p=Xt("date-picker"),y=of(),r=Bo(),{t:S,lang:C}=qr(),M=Pn("EP_PICKER_BASE"),P=Pn(xx),{shortcuts:z,disabledDate:F,cellClassName:V,defaultTime:N}=M.props,H=hi(M.props,"defaultValue"),U=xe(),te=xe(sr().locale(C.value)),Z=xe(!1);let q=!1;const J=ee(()=>sr(N).locale(C.value)),re=ee(()=>te.value.month()),se=ee(()=>te.value.year()),he=xe([]),le=xe(null),ce=xe(null),pe=zt=>he.value.length>0?a(zt,he.value,o.format||"HH:mm:ss"):!0,de=zt=>N&&!Jt.value&&!Z.value&&!q?J.value.year(zt.year()).month(zt.month()).date(zt.date()):_t.value?zt.millisecond(0):zt.startOf("day"),Ie=(zt,...st)=>{if(!zt)t("pick",zt,...st);else if(sn(zt)){const Ft=zt.map(de);t("pick",Ft,...st)}else t("pick",de(zt),...st);le.value=null,ce.value=null,Z.value=!1,q=!1},Ve=async(zt,st)=>{if(De.value==="date"){zt=zt;let Ft=o.parsedValue?o.parsedValue.year(zt.year()).month(zt.month()).date(zt.date()):zt;pe(Ft)||(Ft=he.value[0][0].year(zt.year()).month(zt.month()).date(zt.date())),te.value=Ft,Ie(Ft,_t.value||st),o.type==="datetime"&&(await jn(),er())}else De.value==="week"?Ie(zt.date):De.value==="dates"&&Ie(zt,!0)},be=zt=>{const st=zt?"add":"subtract";te.value=te.value[st](1,"month"),ui("month")},ye=zt=>{const st=te.value,Ft=zt?"add":"subtract";te.value=Me.value==="year"?st[Ft](10,"year"):st[Ft](1,"year"),ui("year")},Me=xe("date"),we=ee(()=>{const zt=S("el.datepicker.year");if(Me.value==="year"){const st=Math.floor(se.value/10)*10;return zt?`${st} ${zt} - ${st+9} ${zt}`:`${st} - ${st+9}`}return`${se.value} ${zt}`}),me=zt=>{const st=$n(zt.value)?zt.value():zt.value;if(st){q=!0,Ie(sr(st).locale(C.value));return}zt.onClick&&zt.onClick({attrs:y,slots:r,emit:t})},De=ee(()=>{const{type:zt}=o;return["week","month","months","year","years","dates"].includes(zt)?zt:"date"}),Ge=ee(()=>De.value==="dates"||De.value==="months"||De.value==="years"),rt=ee(()=>De.value==="date"?Me.value:De.value),Oe=ee(()=>!!z.length),Ct=async(zt,st)=>{De.value==="month"?(te.value=By(te.value.year(),zt,C.value,F),Ie(te.value,!1)):De.value==="months"?Ie(zt,st??!0):(te.value=By(te.value.year(),zt,C.value,F),Me.value="date",["month","year","date","week"].includes(De.value)&&(Ie(te.value,!0),await jn(),er())),ui("month")},kt=async(zt,st)=>{if(De.value==="year"){const Ft=te.value.startOf("year").year(zt);te.value=fT(Ft,C.value,F),Ie(te.value,!1)}else if(De.value==="years")Ie(zt,st??!0);else{const Ft=te.value.year(zt);te.value=fT(Ft,C.value,F),Me.value="month",["month","year","date","week"].includes(De.value)&&(Ie(te.value,!0),await jn(),er())}ui("year")},Bt=async zt=>{Me.value=zt,await jn(),er()},_t=ee(()=>o.type==="datetime"||o.type==="datetimerange"),jt=ee(()=>{const zt=_t.value||De.value==="dates",st=De.value==="years",Ft=De.value==="months",Ye=Me.value==="date",pn=Me.value==="year",xn=Me.value==="month";return zt&&Ye||st&&pn||Ft&&xn}),Gt=ee(()=>F?o.parsedValue?sn(o.parsedValue)?F(o.parsedValue[0].toDate()):F(o.parsedValue.toDate()):!0:!1),Ne=()=>{if(Ge.value)Ie(o.parsedValue);else{let zt=o.parsedValue;if(!zt){const st=sr(N).locale(C.value),Ft=vr();zt=st.year(Ft.year()).month(Ft.month()).date(Ft.date())}te.value=zt,Ie(zt)}},an=ee(()=>F?F(sr().locale(C.value).toDate()):!1),Ae=()=>{const st=sr().locale(C.value).toDate();Z.value=!0,(!F||!F(st))&&pe(st)&&(te.value=sr().locale(C.value),Ie(te.value))},tt=ee(()=>o.timeFormat||_4(o.format)),Je=ee(()=>o.dateFormat||g4(o.format)),Jt=ee(()=>{if(ce.value)return ce.value;if(!(!o.parsedValue&&!H.value))return(o.parsedValue||te.value).format(tt.value)}),Kt=ee(()=>{if(le.value)return le.value;if(!(!o.parsedValue&&!H.value))return(o.parsedValue||te.value).format(Je.value)}),Nt=xe(!1),Pt=()=>{Nt.value=!0},Dt=()=>{Nt.value=!1},rn=zt=>({hour:zt.hour(),minute:zt.minute(),second:zt.second(),year:zt.year(),month:zt.month(),date:zt.date()}),on=(zt,st,Ft)=>{const{hour:Ye,minute:pn,second:xn}=rn(zt),_r=o.parsedValue?o.parsedValue.hour(Ye).minute(pn).second(xn):zt;te.value=_r,Ie(te.value,!0),Ft||(Nt.value=st)},Ln=zt=>{const st=sr(zt,tt.value).locale(C.value);if(st.isValid()&&pe(st)){const{year:Ft,month:Ye,date:pn}=rn(te.value);te.value=st.year(Ft).month(Ye).date(pn),ce.value=null,Nt.value=!1,Ie(te.value,!0)}},yn=zt=>{const st=sr(zt,Je.value).locale(C.value);if(st.isValid()){if(F&&F(st.toDate()))return;const{hour:Ft,minute:Ye,second:pn}=rn(te.value);te.value=st.hour(Ft).minute(Ye).second(pn),le.value=null,Ie(te.value,!0)}},Et=zt=>sr.isDayjs(zt)&&zt.isValid()&&(F?!F(zt.toDate()):!0),En=zt=>sn(zt)?zt.map(st=>st.format(o.format)):zt.format(o.format),Xn=zt=>sr(zt,o.format).locale(C.value),vr=()=>{const zt=sr(H.value).locale(C.value);if(!H.value){const st=J.value;return sr().hour(st.hour()).minute(st.minute()).second(st.second()).locale(C.value)}return zt},er=()=>{var zt;["week","month","year","date"].includes(De.value)&&((zt=U.value)==null||zt.focus())},Dr=()=>{er(),De.value==="week"&&Di(Cn.down)},Ar=zt=>{const{code:st}=zt;[Cn.up,Cn.down,Cn.left,Cn.right,Cn.home,Cn.end,Cn.pageUp,Cn.pageDown].includes(st)&&(Di(st),zt.stopPropagation(),zt.preventDefault()),[Cn.enter,Cn.space,Cn.numpadEnter].includes(st)&&le.value===null&&ce.value===null&&(zt.preventDefault(),Ie(te.value,!1))},Di=zt=>{var st;const{up:Ft,down:Ye,left:pn,right:xn,home:_r,end:yi,pageUp:xi,pageDown:Qi}=Cn,ci={year:{[Ft]:-4,[Ye]:4,[pn]:-1,[xn]:1,offset:(pi,Oo)=>pi.setFullYear(pi.getFullYear()+Oo)},month:{[Ft]:-4,[Ye]:4,[pn]:-1,[xn]:1,offset:(pi,Oo)=>pi.setMonth(pi.getMonth()+Oo)},week:{[Ft]:-1,[Ye]:1,[pn]:-1,[xn]:1,offset:(pi,Oo)=>pi.setDate(pi.getDate()+Oo*7)},date:{[Ft]:-7,[Ye]:7,[pn]:-1,[xn]:1,[_r]:pi=>-pi.getDay(),[yi]:pi=>-pi.getDay()+6,[xi]:pi=>-new Date(pi.getFullYear(),pi.getMonth(),0).getDate(),[Qi]:pi=>new Date(pi.getFullYear(),pi.getMonth()+1,0).getDate(),offset:(pi,Oo)=>pi.setDate(pi.getDate()+Oo)}},co=te.value.toDate();for(;Math.abs(te.value.diff(co,"year",!0))<1;){const pi=ci[rt.value];if(!pi)return;if(pi.offset(co,$n(pi[zt])?pi[zt](co):(st=pi[zt])!=null?st:0),F&&F(co))break;const Oo=sr(co).locale(C.value);te.value=Oo,t("pick",Oo,!0);break}},ui=zt=>{t("panel-change",te.value.toDate(),zt,Me.value)};return Wt(()=>De.value,zt=>{if(["month","year"].includes(zt)){Me.value=zt;return}else if(zt==="years"){Me.value="year";return}else if(zt==="months"){Me.value="month";return}Me.value="date"},{immediate:!0}),Wt(()=>Me.value,()=>{P==null||P.updatePopper()}),Wt(()=>H.value,zt=>{zt&&(te.value=vr())},{immediate:!0}),Wt(()=>o.parsedValue,zt=>{if(zt){if(Ge.value||sn(zt))return;te.value=zt}else te.value=vr()},{immediate:!0}),t("set-picker-option",["isValidValue",Et]),t("set-picker-option",["formatToString",En]),t("set-picker-option",["parseUserInput",Xn]),t("set-picker-option",["handleFocusPicker",Dr]),(zt,st)=>(ae(),Pe("div",{class:fe([b(d).b(),b(p).b(),{"has-sidebar":zt.$slots.sidebar||b(Oe),"has-time":b(_t)}])},[Ue("div",{class:fe(b(d).e("body-wrapper"))},[gt(zt.$slots,"sidebar",{class:fe(b(d).e("sidebar"))}),b(Oe)?(ae(),Pe("div",{key:0,class:fe(b(d).e("sidebar"))},[(ae(!0),Pe(Vn,null,Fr(b(z),(Ft,Ye)=>(ae(),Pe("button",{key:Ye,type:"button",class:fe(b(d).e("shortcut")),onClick:pn=>me(Ft)},fn(Ft.text),11,["onClick"]))),128))],2)):bt("v-if",!0),Ue("div",{class:fe(b(d).e("body"))},[b(_t)?(ae(),Pe("div",{key:0,class:fe(b(p).e("time-header"))},[Ue("span",{class:fe(b(p).e("editor-wrap"))},[qe(b(Bs),{placeholder:b(S)("el.datepicker.selectDate"),"model-value":b(Kt),size:"small","validate-event":!1,onInput:Ft=>le.value=Ft,onChange:yn},null,8,["placeholder","model-value","onInput"])],2),hr((ae(),Pe("span",{class:fe(b(p).e("editor-wrap"))},[qe(b(Bs),{placeholder:b(S)("el.datepicker.selectTime"),"model-value":b(Jt),size:"small","validate-event":!1,onFocus:Pt,onInput:Ft=>ce.value=Ft,onChange:Ln},null,8,["placeholder","model-value","onInput"]),qe(b(M1),{visible:Nt.value,format:b(tt),"parsed-value":te.value,onPick:on},null,8,["visible","format","parsed-value"])],2)),[[b(Pc),Dt]])],2)):bt("v-if",!0),hr(Ue("div",{class:fe([b(p).e("header"),(Me.value==="year"||Me.value==="month")&&b(p).e("header--bordered")])},[Ue("span",{class:fe(b(p).e("prev-btn"))},[Ue("button",{type:"button","aria-label":b(S)("el.datepicker.prevYear"),class:fe(["d-arrow-left",b(d).e("icon-btn")]),onClick:Ft=>ye(!1)},[gt(zt.$slots,"prev-year",{},()=>[qe(b(zn),null,{default:ot(()=>[qe(b(Xd))]),_:1})])],10,["aria-label","onClick"]),hr(Ue("button",{type:"button","aria-label":b(S)("el.datepicker.prevMonth"),class:fe([b(d).e("icon-btn"),"arrow-left"]),onClick:Ft=>be(!1)},[gt(zt.$slots,"prev-month",{},()=>[qe(b(zn),null,{default:ot(()=>[qe(b(Yd))]),_:1})])],10,["aria-label","onClick"]),[[ii,Me.value==="date"]])],2),Ue("span",{role:"button",class:fe(b(p).e("header-label")),"aria-live":"polite",tabindex:"0",onKeydown:Ri(Ft=>Bt("year"),["enter"]),onClick:Ft=>Bt("year")},fn(b(we)),43,["onKeydown","onClick"]),hr(Ue("span",{role:"button","aria-live":"polite",tabindex:"0",class:fe([b(p).e("header-label"),{active:Me.value==="month"}]),onKeydown:Ri(Ft=>Bt("month"),["enter"]),onClick:Ft=>Bt("month")},fn(b(S)(`el.datepicker.month${b(re)+1}`)),43,["onKeydown","onClick"]),[[ii,Me.value==="date"]]),Ue("span",{class:fe(b(p).e("next-btn"))},[hr(Ue("button",{type:"button","aria-label":b(S)("el.datepicker.nextMonth"),class:fe([b(d).e("icon-btn"),"arrow-right"]),onClick:Ft=>be(!0)},[gt(zt.$slots,"next-month",{},()=>[qe(b(zn),null,{default:ot(()=>[qe(b(ta))]),_:1})])],10,["aria-label","onClick"]),[[ii,Me.value==="date"]]),Ue("button",{type:"button","aria-label":b(S)("el.datepicker.nextYear"),class:fe([b(d).e("icon-btn"),"d-arrow-right"]),onClick:Ft=>ye(!0)},[gt(zt.$slots,"next-year",{},()=>[qe(b(zn),null,{default:ot(()=>[qe(b(Jd))]),_:1})])],10,["aria-label","onClick"])],2)],2),[[ii,Me.value!=="time"]]),Ue("div",{class:fe(b(d).e("content")),onKeydown:Ar},[Me.value==="date"?(ae(),At(pT,{key:0,ref_key:"currentViewRef",ref:U,"selection-mode":b(De),date:te.value,"parsed-value":zt.parsedValue,"disabled-date":b(F),"cell-class-name":b(V),onPick:Ve},null,8,["selection-mode","date","parsed-value","disabled-date","cell-class-name"])):bt("v-if",!0),Me.value==="year"?(ae(),At(gT,{key:1,ref_key:"currentViewRef",ref:U,"selection-mode":b(De),date:te.value,"disabled-date":b(F),"parsed-value":zt.parsedValue,onPick:kt},null,8,["selection-mode","date","disabled-date","parsed-value"])):bt("v-if",!0),Me.value==="month"?(ae(),At(mT,{key:2,ref_key:"currentViewRef",ref:U,"selection-mode":b(De),date:te.value,"parsed-value":zt.parsedValue,"disabled-date":b(F),onPick:Ct},null,8,["selection-mode","date","parsed-value","disabled-date"])):bt("v-if",!0)],34)],2)],2),hr(Ue("div",{class:fe(b(d).e("footer"))},[hr(qe(b(ts),{text:"",size:"small",class:fe(b(d).e("link-btn")),disabled:b(an),onClick:Ae},{default:ot(()=>[Nr(fn(b(S)("el.datepicker.now")),1)]),_:1},8,["class","disabled"]),[[ii,!b(Ge)&&zt.showNow]]),qe(b(ts),{plain:"",size:"small",class:fe(b(d).e("link-btn")),disabled:b(Gt),onClick:Ne},{default:ot(()=>[Nr(fn(b(S)("el.datepicker.confirm")),1)]),_:1},8,["class","disabled"])],2),[[ii,b(jt)]])],2))}});var Xte=dn(Yte,[["__file","panel-date-pick.vue"]]);const Jte=un({...oF,...EE,visible:Boolean}),sF=e=>{const{emit:t}=Cr(),o=of(),a=Bo();return p=>{const y=$n(p.value)?p.value():p.value;if(y){t("pick",[sr(y[0]).locale(e.value),sr(y[1]).locale(e.value)]);return}p.onClick&&p.onClick({attrs:o,slots:a,emit:t})}},aF=(e,{defaultValue:t,leftDate:o,rightDate:a,unit:d,onParsedValueChanged:p})=>{const{emit:y}=Cr(),{pickerNs:r}=Pn(Sx),S=Xt("date-range-picker"),{t:C,lang:M}=qr(),P=sF(M),z=xe(),F=xe(),V=xe({endDate:null,selecting:!1}),N=q=>{V.value=q},H=(q=!1)=>{const J=b(z),re=b(F);jm([J,re])&&y("pick",[J,re],q)},U=q=>{V.value.selecting=q,q||(V.value.endDate=null)},te=q=>{if(sn(q)&&q.length===2){const[J,re]=q;z.value=J,o.value=J,F.value=re,p(b(z),b(F))}else Z()},Z=()=>{const[q,J]=IE(b(t),{lang:b(M),unit:d,unlinkPanels:e.unlinkPanels});z.value=void 0,F.value=void 0,o.value=q,a.value=J};return Wt(t,q=>{q&&Z()},{immediate:!0}),Wt(()=>e.parsedValue,te,{immediate:!0}),{minDate:z,maxDate:F,rangeState:V,lang:M,ppNs:r,drpNs:S,handleChangeRange:N,handleRangeConfirm:H,handleShortcutClick:P,onSelect:U,onReset:te,t:C}},kb="month",Qte=We({__name:"panel-date-range",props:Jte,emits:["pick","set-picker-option","calendar-change","panel-change"],setup(e,{emit:t}){const o=e,a=Pn("EP_PICKER_BASE"),{disabledDate:d,cellClassName:p,defaultTime:y,clearable:r}=a.props,S=hi(a.props,"format"),C=hi(a.props,"shortcuts"),M=hi(a.props,"defaultValue"),{lang:P}=qr(),z=xe(sr().locale(P.value)),F=xe(sr().locale(P.value).add(1,kb)),{minDate:V,maxDate:N,rangeState:H,ppNs:U,drpNs:te,handleChangeRange:Z,handleRangeConfirm:q,handleShortcutClick:J,onSelect:re,onReset:se,t:he}=aF(o,{defaultValue:M,leftDate:z,rightDate:F,unit:kb,onParsedValueChanged:zt});Wt(()=>o.visible,st=>{!st&&H.value.selecting&&(se(o.parsedValue),re(!1))});const le=xe({min:null,max:null}),ce=xe({min:null,max:null}),pe=ee(()=>`${z.value.year()} ${he("el.datepicker.year")} ${he(`el.datepicker.month${z.value.month()+1}`)}`),de=ee(()=>`${F.value.year()} ${he("el.datepicker.year")} ${he(`el.datepicker.month${F.value.month()+1}`)}`),Ie=ee(()=>z.value.year()),Ve=ee(()=>z.value.month()),be=ee(()=>F.value.year()),ye=ee(()=>F.value.month()),Me=ee(()=>!!C.value.length),we=ee(()=>le.value.min!==null?le.value.min:V.value?V.value.format(Oe.value):""),me=ee(()=>le.value.max!==null?le.value.max:N.value||V.value?(N.value||V.value).format(Oe.value):""),De=ee(()=>ce.value.min!==null?ce.value.min:V.value?V.value.format(rt.value):""),Ge=ee(()=>ce.value.max!==null?ce.value.max:N.value||V.value?(N.value||V.value).format(rt.value):""),rt=ee(()=>o.timeFormat||_4(S.value)),Oe=ee(()=>o.dateFormat||g4(S.value)),Ct=st=>jm(st)&&(d?!d(st[0].toDate())&&!d(st[1].toDate()):!0),kt=()=>{z.value=z.value.subtract(1,"year"),o.unlinkPanels||(F.value=z.value.add(1,"month")),tt("year")},Bt=()=>{z.value=z.value.subtract(1,"month"),o.unlinkPanels||(F.value=z.value.add(1,"month")),tt("month")},_t=()=>{o.unlinkPanels?F.value=F.value.add(1,"year"):(z.value=z.value.add(1,"year"),F.value=z.value.add(1,"month")),tt("year")},jt=()=>{o.unlinkPanels?F.value=F.value.add(1,"month"):(z.value=z.value.add(1,"month"),F.value=z.value.add(1,"month")),tt("month")},Gt=()=>{z.value=z.value.add(1,"year"),tt("year")},Ne=()=>{z.value=z.value.add(1,"month"),tt("month")},an=()=>{F.value=F.value.subtract(1,"year"),tt("year")},Ae=()=>{F.value=F.value.subtract(1,"month"),tt("month")},tt=st=>{t("panel-change",[z.value.toDate(),F.value.toDate()],st)},Je=ee(()=>{const st=(Ve.value+1)%12,Ft=Ve.value+1>=12?1:0;return o.unlinkPanels&&new Date(Ie.value+Ft,st)<new Date(be.value,ye.value)}),Jt=ee(()=>o.unlinkPanels&&be.value*12+ye.value-(Ie.value*12+Ve.value+1)>=12),Kt=ee(()=>!(V.value&&N.value&&!H.value.selecting&&jm([V.value,N.value]))),Nt=ee(()=>o.type==="datetime"||o.type==="datetimerange"),Pt=(st,Ft)=>{if(st)return y?sr(y[Ft]||y).locale(P.value).year(st.year()).month(st.month()).date(st.date()):st},Dt=(st,Ft=!0)=>{const Ye=st.minDate,pn=st.maxDate,xn=Pt(Ye,0),_r=Pt(pn,1);N.value===_r&&V.value===xn||(t("calendar-change",[Ye.toDate(),pn&&pn.toDate()]),N.value=_r,V.value=xn,!(!Ft||Nt.value)&&q())},rn=xe(!1),on=xe(!1),Ln=()=>{rn.value=!1},yn=()=>{on.value=!1},Et=(st,Ft)=>{le.value[Ft]=st;const Ye=sr(st,Oe.value).locale(P.value);if(Ye.isValid()){if(d&&d(Ye.toDate()))return;Ft==="min"?(z.value=Ye,V.value=(V.value||z.value).year(Ye.year()).month(Ye.month()).date(Ye.date()),!o.unlinkPanels&&(!N.value||N.value.isBefore(V.value))&&(F.value=Ye.add(1,"month"),N.value=V.value.add(1,"month"))):(F.value=Ye,N.value=(N.value||F.value).year(Ye.year()).month(Ye.month()).date(Ye.date()),!o.unlinkPanels&&(!V.value||V.value.isAfter(N.value))&&(z.value=Ye.subtract(1,"month"),V.value=N.value.subtract(1,"month")))}},En=(st,Ft)=>{le.value[Ft]=null},Xn=(st,Ft)=>{ce.value[Ft]=st;const Ye=sr(st,rt.value).locale(P.value);Ye.isValid()&&(Ft==="min"?(rn.value=!0,V.value=(V.value||z.value).hour(Ye.hour()).minute(Ye.minute()).second(Ye.second())):(on.value=!0,N.value=(N.value||F.value).hour(Ye.hour()).minute(Ye.minute()).second(Ye.second()),F.value=N.value))},vr=(st,Ft)=>{ce.value[Ft]=null,Ft==="min"?(z.value=V.value,rn.value=!1,(!N.value||N.value.isBefore(V.value))&&(N.value=V.value)):(F.value=N.value,on.value=!1,N.value&&N.value.isBefore(V.value)&&(V.value=N.value))},er=(st,Ft,Ye)=>{ce.value.min||(st&&(z.value=st,V.value=(V.value||z.value).hour(st.hour()).minute(st.minute()).second(st.second())),Ye||(rn.value=Ft),(!N.value||N.value.isBefore(V.value))&&(N.value=V.value,F.value=st))},Dr=(st,Ft,Ye)=>{ce.value.max||(st&&(F.value=st,N.value=(N.value||F.value).hour(st.hour()).minute(st.minute()).second(st.second())),Ye||(on.value=Ft),N.value&&N.value.isBefore(V.value)&&(V.value=N.value))},Ar=()=>{z.value=IE(b(M),{lang:b(P),unit:"month",unlinkPanels:o.unlinkPanels})[0],F.value=z.value.add(1,"month"),N.value=void 0,V.value=void 0,t("pick",null)},Di=st=>sn(st)?st.map(Ft=>Ft.format(S.value)):st.format(S.value),ui=st=>sn(st)?st.map(Ft=>sr(Ft,S.value).locale(P.value)):sr(st,S.value).locale(P.value);function zt(st,Ft){if(o.unlinkPanels&&Ft){const Ye=(st==null?void 0:st.year())||0,pn=(st==null?void 0:st.month())||0,xn=Ft.year(),_r=Ft.month();F.value=Ye===xn&&pn===_r?Ft.add(1,kb):Ft}else F.value=z.value.add(1,kb),Ft&&(F.value=F.value.hour(Ft.hour()).minute(Ft.minute()).second(Ft.second()))}return t("set-picker-option",["isValidValue",Ct]),t("set-picker-option",["parseUserInput",ui]),t("set-picker-option",["formatToString",Di]),t("set-picker-option",["handleClear",Ar]),(st,Ft)=>(ae(),Pe("div",{class:fe([b(U).b(),b(te).b(),{"has-sidebar":st.$slots.sidebar||b(Me),"has-time":b(Nt)}])},[Ue("div",{class:fe(b(U).e("body-wrapper"))},[gt(st.$slots,"sidebar",{class:fe(b(U).e("sidebar"))}),b(Me)?(ae(),Pe("div",{key:0,class:fe(b(U).e("sidebar"))},[(ae(!0),Pe(Vn,null,Fr(b(C),(Ye,pn)=>(ae(),Pe("button",{key:pn,type:"button",class:fe(b(U).e("shortcut")),onClick:xn=>b(J)(Ye)},fn(Ye.text),11,["onClick"]))),128))],2)):bt("v-if",!0),Ue("div",{class:fe(b(U).e("body"))},[b(Nt)?(ae(),Pe("div",{key:0,class:fe(b(te).e("time-header"))},[Ue("span",{class:fe(b(te).e("editors-wrap"))},[Ue("span",{class:fe(b(te).e("time-picker-wrap"))},[qe(b(Bs),{size:"small",disabled:b(H).selecting,placeholder:b(he)("el.datepicker.startDate"),class:fe(b(te).e("editor")),"model-value":b(we),"validate-event":!1,onInput:Ye=>Et(Ye,"min"),onChange:Ye=>En(Ye,"min")},null,8,["disabled","placeholder","class","model-value","onInput","onChange"])],2),hr((ae(),Pe("span",{class:fe(b(te).e("time-picker-wrap"))},[qe(b(Bs),{size:"small",class:fe(b(te).e("editor")),disabled:b(H).selecting,placeholder:b(he)("el.datepicker.startTime"),"model-value":b(De),"validate-event":!1,onFocus:Ye=>rn.value=!0,onInput:Ye=>Xn(Ye,"min"),onChange:Ye=>vr(Ye,"min")},null,8,["class","disabled","placeholder","model-value","onFocus","onInput","onChange"]),qe(b(M1),{visible:rn.value,format:b(rt),"datetime-role":"start","parsed-value":z.value,onPick:er},null,8,["visible","format","parsed-value"])],2)),[[b(Pc),Ln]])],2),Ue("span",null,[qe(b(zn),null,{default:ot(()=>[qe(b(ta))]),_:1})]),Ue("span",{class:fe([b(te).e("editors-wrap"),"is-right"])},[Ue("span",{class:fe(b(te).e("time-picker-wrap"))},[qe(b(Bs),{size:"small",class:fe(b(te).e("editor")),disabled:b(H).selecting,placeholder:b(he)("el.datepicker.endDate"),"model-value":b(me),readonly:!b(V),"validate-event":!1,onInput:Ye=>Et(Ye,"max"),onChange:Ye=>En(Ye,"max")},null,8,["class","disabled","placeholder","model-value","readonly","onInput","onChange"])],2),hr((ae(),Pe("span",{class:fe(b(te).e("time-picker-wrap"))},[qe(b(Bs),{size:"small",class:fe(b(te).e("editor")),disabled:b(H).selecting,placeholder:b(he)("el.datepicker.endTime"),"model-value":b(Ge),readonly:!b(V),"validate-event":!1,onFocus:Ye=>b(V)&&(on.value=!0),onInput:Ye=>Xn(Ye,"max"),onChange:Ye=>vr(Ye,"max")},null,8,["class","disabled","placeholder","model-value","readonly","onFocus","onInput","onChange"]),qe(b(M1),{"datetime-role":"end",visible:on.value,format:b(rt),"parsed-value":F.value,onPick:Dr},null,8,["visible","format","parsed-value"])],2)),[[b(Pc),yn]])],2)],2)):bt("v-if",!0),Ue("div",{class:fe([[b(U).e("content"),b(te).e("content")],"is-left"])},[Ue("div",{class:fe(b(te).e("header"))},[Ue("button",{type:"button",class:fe([b(U).e("icon-btn"),"d-arrow-left"]),"aria-label":b(he)("el.datepicker.prevYear"),onClick:kt},[gt(st.$slots,"prev-year",{},()=>[qe(b(zn),null,{default:ot(()=>[qe(b(Xd))]),_:1})])],10,["aria-label"]),Ue("button",{type:"button",class:fe([b(U).e("icon-btn"),"arrow-left"]),"aria-label":b(he)("el.datepicker.prevMonth"),onClick:Bt},[gt(st.$slots,"prev-month",{},()=>[qe(b(zn),null,{default:ot(()=>[qe(b(Yd))]),_:1})])],10,["aria-label"]),st.unlinkPanels?(ae(),Pe("button",{key:0,type:"button",disabled:!b(Jt),class:fe([[b(U).e("icon-btn"),{"is-disabled":!b(Jt)}],"d-arrow-right"]),"aria-label":b(he)("el.datepicker.nextYear"),onClick:Gt},[gt(st.$slots,"next-year",{},()=>[qe(b(zn),null,{default:ot(()=>[qe(b(Jd))]),_:1})])],10,["disabled","aria-label"])):bt("v-if",!0),st.unlinkPanels?(ae(),Pe("button",{key:1,type:"button",disabled:!b(Je),class:fe([[b(U).e("icon-btn"),{"is-disabled":!b(Je)}],"arrow-right"]),"aria-label":b(he)("el.datepicker.nextMonth"),onClick:Ne},[gt(st.$slots,"next-month",{},()=>[qe(b(zn),null,{default:ot(()=>[qe(b(ta))]),_:1})])],10,["disabled","aria-label"])):bt("v-if",!0),Ue("div",null,fn(b(pe)),1)],2),qe(pT,{"selection-mode":"range",date:z.value,"min-date":b(V),"max-date":b(N),"range-state":b(H),"disabled-date":b(d),"cell-class-name":b(p),onChangerange:b(Z),onPick:Dt,onSelect:b(re)},null,8,["date","min-date","max-date","range-state","disabled-date","cell-class-name","onChangerange","onSelect"])],2),Ue("div",{class:fe([[b(U).e("content"),b(te).e("content")],"is-right"])},[Ue("div",{class:fe(b(te).e("header"))},[st.unlinkPanels?(ae(),Pe("button",{key:0,type:"button",disabled:!b(Jt),class:fe([[b(U).e("icon-btn"),{"is-disabled":!b(Jt)}],"d-arrow-left"]),"aria-label":b(he)("el.datepicker.prevYear"),onClick:an},[gt(st.$slots,"prev-year",{},()=>[qe(b(zn),null,{default:ot(()=>[qe(b(Xd))]),_:1})])],10,["disabled","aria-label"])):bt("v-if",!0),st.unlinkPanels?(ae(),Pe("button",{key:1,type:"button",disabled:!b(Je),class:fe([[b(U).e("icon-btn"),{"is-disabled":!b(Je)}],"arrow-left"]),"aria-label":b(he)("el.datepicker.prevMonth"),onClick:Ae},[gt(st.$slots,"prev-month",{},()=>[qe(b(zn),null,{default:ot(()=>[qe(b(Yd))]),_:1})])],10,["disabled","aria-label"])):bt("v-if",!0),Ue("button",{type:"button","aria-label":b(he)("el.datepicker.nextYear"),class:fe([b(U).e("icon-btn"),"d-arrow-right"]),onClick:_t},[gt(st.$slots,"next-year",{},()=>[qe(b(zn),null,{default:ot(()=>[qe(b(Jd))]),_:1})])],10,["aria-label"]),Ue("button",{type:"button",class:fe([b(U).e("icon-btn"),"arrow-right"]),"aria-label":b(he)("el.datepicker.nextMonth"),onClick:jt},[gt(st.$slots,"next-month",{},()=>[qe(b(zn),null,{default:ot(()=>[qe(b(ta))]),_:1})])],10,["aria-label"]),Ue("div",null,fn(b(de)),1)],2),qe(pT,{"selection-mode":"range",date:F.value,"min-date":b(V),"max-date":b(N),"range-state":b(H),"disabled-date":b(d),"cell-class-name":b(p),onChangerange:b(Z),onPick:Dt,onSelect:b(re)},null,8,["date","min-date","max-date","range-state","disabled-date","cell-class-name","onChangerange","onSelect"])],2)],2)],2),b(Nt)?(ae(),Pe("div",{key:0,class:fe(b(U).e("footer"))},[b(r)?(ae(),At(b(ts),{key:0,text:"",size:"small",class:fe(b(U).e("link-btn")),onClick:Ar},{default:ot(()=>[Nr(fn(b(he)("el.datepicker.clear")),1)]),_:1},8,["class"])):bt("v-if",!0),qe(b(ts),{plain:"",size:"small",class:fe(b(U).e("link-btn")),disabled:b(Kt),onClick:Ye=>b(q)(!1)},{default:ot(()=>[Nr(fn(b(he)("el.datepicker.confirm")),1)]),_:1},8,["class","disabled","onClick"])],2)):bt("v-if",!0)],2))}});var ene=dn(Qte,[["__file","panel-date-range.vue"]]);const tne=un({...EE}),nne=["pick","set-picker-option","calendar-change"],rne=({unlinkPanels:e,leftDate:t,rightDate:o})=>{const{t:a}=qr(),d=()=>{t.value=t.value.subtract(1,"year"),e.value||(o.value=o.value.subtract(1,"year"))},p=()=>{e.value||(t.value=t.value.add(1,"year")),o.value=o.value.add(1,"year")},y=()=>{t.value=t.value.add(1,"year")},r=()=>{o.value=o.value.subtract(1,"year")},S=ee(()=>`${t.value.year()} ${a("el.datepicker.year")}`),C=ee(()=>`${o.value.year()} ${a("el.datepicker.year")}`),M=ee(()=>t.value.year()),P=ee(()=>o.value.year()===t.value.year()?t.value.year()+1:o.value.year());return{leftPrevYear:d,rightNextYear:p,leftNextYear:y,rightPrevYear:r,leftLabel:S,rightLabel:C,leftYear:M,rightYear:P}},Pb="year",ine=We({name:"DatePickerMonthRange"}),one=We({...ine,props:tne,emits:nne,setup(e,{emit:t}){const o=e,{lang:a}=qr(),d=Pn("EP_PICKER_BASE"),{shortcuts:p,disabledDate:y}=d.props,r=hi(d.props,"format"),S=hi(d.props,"defaultValue"),C=xe(sr().locale(a.value)),M=xe(sr().locale(a.value).add(1,Pb)),{minDate:P,maxDate:z,rangeState:F,ppNs:V,drpNs:N,handleChangeRange:H,handleRangeConfirm:U,handleShortcutClick:te,onSelect:Z}=aF(o,{defaultValue:S,leftDate:C,rightDate:M,unit:Pb,onParsedValueChanged:we}),q=ee(()=>!!p.length),{leftPrevYear:J,rightNextYear:re,leftNextYear:se,rightPrevYear:he,leftLabel:le,rightLabel:ce,leftYear:pe,rightYear:de}=rne({unlinkPanels:hi(o,"unlinkPanels"),leftDate:C,rightDate:M}),Ie=ee(()=>o.unlinkPanels&&de.value>pe.value+1),Ve=(me,De=!0)=>{const Ge=me.minDate,rt=me.maxDate;z.value===rt&&P.value===Ge||(t("calendar-change",[Ge.toDate(),rt&&rt.toDate()]),z.value=rt,P.value=Ge,De&&U())},be=()=>{C.value=IE(b(S),{lang:b(a),unit:"year",unlinkPanels:o.unlinkPanels})[0],M.value=C.value.add(1,"year"),t("pick",null)},ye=me=>sn(me)?me.map(De=>De.format(r.value)):me.format(r.value),Me=me=>sn(me)?me.map(De=>sr(De,r.value).locale(a.value)):sr(me,r.value).locale(a.value);function we(me,De){if(o.unlinkPanels&&De){const Ge=(me==null?void 0:me.year())||0,rt=De.year();M.value=Ge===rt?De.add(1,Pb):De}else M.value=C.value.add(1,Pb)}return t("set-picker-option",["isValidValue",jm]),t("set-picker-option",["formatToString",ye]),t("set-picker-option",["parseUserInput",Me]),t("set-picker-option",["handleClear",be]),(me,De)=>(ae(),Pe("div",{class:fe([b(V).b(),b(N).b(),{"has-sidebar":!!me.$slots.sidebar||b(q)}])},[Ue("div",{class:fe(b(V).e("body-wrapper"))},[gt(me.$slots,"sidebar",{class:fe(b(V).e("sidebar"))}),b(q)?(ae(),Pe("div",{key:0,class:fe(b(V).e("sidebar"))},[(ae(!0),Pe(Vn,null,Fr(b(p),(Ge,rt)=>(ae(),Pe("button",{key:rt,type:"button",class:fe(b(V).e("shortcut")),onClick:Oe=>b(te)(Ge)},fn(Ge.text),11,["onClick"]))),128))],2)):bt("v-if",!0),Ue("div",{class:fe(b(V).e("body"))},[Ue("div",{class:fe([[b(V).e("content"),b(N).e("content")],"is-left"])},[Ue("div",{class:fe(b(N).e("header"))},[Ue("button",{type:"button",class:fe([b(V).e("icon-btn"),"d-arrow-left"]),onClick:b(J)},[gt(me.$slots,"prev-year",{},()=>[qe(b(zn),null,{default:ot(()=>[qe(b(Xd))]),_:1})])],10,["onClick"]),me.unlinkPanels?(ae(),Pe("button",{key:0,type:"button",disabled:!b(Ie),class:fe([[b(V).e("icon-btn"),{[b(V).is("disabled")]:!b(Ie)}],"d-arrow-right"]),onClick:b(se)},[gt(me.$slots,"next-year",{},()=>[qe(b(zn),null,{default:ot(()=>[qe(b(Jd))]),_:1})])],10,["disabled","onClick"])):bt("v-if",!0),Ue("div",null,fn(b(le)),1)],2),qe(mT,{"selection-mode":"range",date:C.value,"min-date":b(P),"max-date":b(z),"range-state":b(F),"disabled-date":b(y),onChangerange:b(H),onPick:Ve,onSelect:b(Z)},null,8,["date","min-date","max-date","range-state","disabled-date","onChangerange","onSelect"])],2),Ue("div",{class:fe([[b(V).e("content"),b(N).e("content")],"is-right"])},[Ue("div",{class:fe(b(N).e("header"))},[me.unlinkPanels?(ae(),Pe("button",{key:0,type:"button",disabled:!b(Ie),class:fe([[b(V).e("icon-btn"),{"is-disabled":!b(Ie)}],"d-arrow-left"]),onClick:b(he)},[gt(me.$slots,"prev-year",{},()=>[qe(b(zn),null,{default:ot(()=>[qe(b(Xd))]),_:1})])],10,["disabled","onClick"])):bt("v-if",!0),Ue("button",{type:"button",class:fe([b(V).e("icon-btn"),"d-arrow-right"]),onClick:b(re)},[gt(me.$slots,"next-year",{},()=>[qe(b(zn),null,{default:ot(()=>[qe(b(Jd))]),_:1})])],10,["onClick"]),Ue("div",null,fn(b(ce)),1)],2),qe(mT,{"selection-mode":"range",date:M.value,"min-date":b(P),"max-date":b(z),"range-state":b(F),"disabled-date":b(y),onChangerange:b(H),onPick:Ve,onSelect:b(Z)},null,8,["date","min-date","max-date","range-state","disabled-date","onChangerange","onSelect"])],2)],2)],2)],2))}});var sne=dn(one,[["__file","panel-month-range.vue"]]);const ane=un({...EE}),lne=["pick","set-picker-option","calendar-change"],une=({unlinkPanels:e,leftDate:t,rightDate:o})=>{const a=()=>{t.value=t.value.subtract(10,"year"),e.value||(o.value=o.value.subtract(10,"year"))},d=()=>{e.value||(t.value=t.value.add(10,"year")),o.value=o.value.add(10,"year")},p=()=>{t.value=t.value.add(10,"year")},y=()=>{o.value=o.value.subtract(10,"year")},r=ee(()=>{const P=Math.floor(t.value.year()/10)*10;return`${P}-${P+9}`}),S=ee(()=>{const P=Math.floor(o.value.year()/10)*10;return`${P}-${P+9}`}),C=ee(()=>Math.floor(t.value.year()/10)*10+9),M=ee(()=>Math.floor(o.value.year()/10)*10);return{leftPrevYear:a,rightNextYear:d,leftNextYear:p,rightPrevYear:y,leftLabel:r,rightLabel:S,leftYear:C,rightYear:M}},CR="year",cne=We({name:"DatePickerYearRange"}),dne=We({...cne,props:ane,emits:lne,setup(e,{emit:t}){const o=e,{lang:a}=qr(),d=xe(sr().locale(a.value)),p=xe(d.value.add(10,"year")),{pickerNs:y}=Pn(Sx),r=Xt("date-range-picker"),S=ee(()=>!!Ve.length),C=ee(()=>[y.b(),r.b(),{"has-sidebar":!!Bo().sidebar||S.value}]),M=ee(()=>({content:[y.e("content"),r.e("content"),"is-left"],arrowLeftBtn:[y.e("icon-btn"),"d-arrow-left"],arrowRightBtn:[y.e("icon-btn"),{[y.is("disabled")]:!J.value},"d-arrow-right"]})),P=ee(()=>({content:[y.e("content"),r.e("content"),"is-right"],arrowLeftBtn:[y.e("icon-btn"),{"is-disabled":!J.value},"d-arrow-left"],arrowRightBtn:[y.e("icon-btn"),"d-arrow-right"]})),z=sF(a),{leftPrevYear:F,rightNextYear:V,leftNextYear:N,rightPrevYear:H,leftLabel:U,rightLabel:te,leftYear:Z,rightYear:q}=une({unlinkPanels:hi(o,"unlinkPanels"),leftDate:d,rightDate:p}),J=ee(()=>o.unlinkPanels&&q.value>Z.value+1),re=xe(),se=xe(),he=xe({endDate:null,selecting:!1}),le=Oe=>{he.value=Oe},ce=(Oe,Ct=!0)=>{const kt=Oe.minDate,Bt=Oe.maxDate;se.value===Bt&&re.value===kt||(t("calendar-change",[kt.toDate(),Bt&&Bt.toDate()]),se.value=Bt,re.value=kt,Ct&&pe())},pe=(Oe=!1)=>{jm([re.value,se.value])&&t("pick",[re.value,se.value],Oe)},de=Oe=>{he.value.selecting=Oe,Oe||(he.value.endDate=null)},Ie=Pn("EP_PICKER_BASE"),{shortcuts:Ve,disabledDate:be}=Ie.props,ye=hi(Ie.props,"format"),Me=hi(Ie.props,"defaultValue"),we=()=>{let Oe;if(sn(Me.value)){const Ct=sr(Me.value[0]);let kt=sr(Me.value[1]);return o.unlinkPanels||(kt=Ct.add(10,CR)),[Ct,kt]}else Me.value?Oe=sr(Me.value):Oe=sr();return Oe=Oe.locale(a.value),[Oe,Oe.add(10,CR)]};Wt(()=>Me.value,Oe=>{if(Oe){const Ct=we();d.value=Ct[0],p.value=Ct[1]}},{immediate:!0}),Wt(()=>o.parsedValue,Oe=>{if(Oe&&Oe.length===2)if(re.value=Oe[0],se.value=Oe[1],d.value=re.value,o.unlinkPanels&&se.value){const Ct=re.value.year(),kt=se.value.year();p.value=Ct===kt?se.value.add(10,"year"):se.value}else p.value=d.value.add(10,"year");else{const Ct=we();re.value=void 0,se.value=void 0,d.value=Ct[0],p.value=Ct[1]}},{immediate:!0});const me=Oe=>sn(Oe)?Oe.map(Ct=>sr(Ct,ye.value).locale(a.value)):sr(Oe,ye.value).locale(a.value),De=Oe=>sn(Oe)?Oe.map(Ct=>Ct.format(ye.value)):Oe.format(ye.value),Ge=Oe=>jm(Oe)&&(be?!be(Oe[0].toDate())&&!be(Oe[1].toDate()):!0),rt=()=>{const Oe=we();d.value=Oe[0],p.value=Oe[1],se.value=void 0,re.value=void 0,t("pick",null)};return t("set-picker-option",["isValidValue",Ge]),t("set-picker-option",["parseUserInput",me]),t("set-picker-option",["formatToString",De]),t("set-picker-option",["handleClear",rt]),(Oe,Ct)=>(ae(),Pe("div",{class:fe(b(C))},[Ue("div",{class:fe(b(y).e("body-wrapper"))},[gt(Oe.$slots,"sidebar",{class:fe(b(y).e("sidebar"))}),b(S)?(ae(),Pe("div",{key:0,class:fe(b(y).e("sidebar"))},[(ae(!0),Pe(Vn,null,Fr(b(Ve),(kt,Bt)=>(ae(),Pe("button",{key:Bt,type:"button",class:fe(b(y).e("shortcut")),onClick:_t=>b(z)(kt)},fn(kt.text),11,["onClick"]))),128))],2)):bt("v-if",!0),Ue("div",{class:fe(b(y).e("body"))},[Ue("div",{class:fe(b(M).content)},[Ue("div",{class:fe(b(r).e("header"))},[Ue("button",{type:"button",class:fe(b(M).arrowLeftBtn),onClick:b(F)},[gt(Oe.$slots,"prev-year",{},()=>[qe(b(zn),null,{default:ot(()=>[qe(b(Xd))]),_:1})])],10,["onClick"]),Oe.unlinkPanels?(ae(),Pe("button",{key:0,type:"button",disabled:!b(J),class:fe(b(M).arrowRightBtn),onClick:b(N)},[gt(Oe.$slots,"next-year",{},()=>[qe(b(zn),null,{default:ot(()=>[qe(b(Jd))]),_:1})])],10,["disabled","onClick"])):bt("v-if",!0),Ue("div",null,fn(b(U)),1)],2),qe(gT,{"selection-mode":"range",date:d.value,"min-date":re.value,"max-date":se.value,"range-state":he.value,"disabled-date":b(be),onChangerange:le,onPick:ce,onSelect:de},null,8,["date","min-date","max-date","range-state","disabled-date"])],2),Ue("div",{class:fe(b(P).content)},[Ue("div",{class:fe(b(r).e("header"))},[Oe.unlinkPanels?(ae(),Pe("button",{key:0,type:"button",disabled:!b(J),class:fe(b(P).arrowLeftBtn),onClick:b(H)},[gt(Oe.$slots,"prev-year",{},()=>[qe(b(zn),null,{default:ot(()=>[qe(b(Xd))]),_:1})])],10,["disabled","onClick"])):bt("v-if",!0),Ue("button",{type:"button",class:fe(b(P).arrowRightBtn),onClick:b(V)},[gt(Oe.$slots,"next-year",{},()=>[qe(b(zn),null,{default:ot(()=>[qe(b(Jd))]),_:1})])],10,["onClick"]),Ue("div",null,fn(b(te)),1)],2),qe(gT,{"selection-mode":"range",date:p.value,"min-date":re.value,"max-date":se.value,"range-state":he.value,"disabled-date":b(be),onChangerange:le,onPick:ce,onSelect:de},null,8,["date","min-date","max-date","range-state","disabled-date"])],2)],2)],2)],2))}});var fne=dn(dne,[["__file","panel-year-range.vue"]]);const hne=function(e){switch(e){case"daterange":case"datetimerange":return ene;case"monthrange":return sne;case"yearrange":return fne;default:return Xte}};sr.extend(v4);sr.extend(ate);sr.extend(SE);sr.extend(ute);sr.extend(dte);sr.extend(hte);sr.extend(mte);sr.extend(_te);var pne=We({name:"ElDatePicker",install:null,props:zte,emits:["update:modelValue"],setup(e,{expose:t,emit:o,slots:a}){const d=Xt("picker-panel");Vr("ElPopperOptions",si(hi(e,"popperOptions"))),Vr(Sx,{slots:a,pickerNs:d});const p=xe();t({focus:()=>{var S;(S=p.value)==null||S.focus()},blur:()=>{var S;(S=p.value)==null||S.blur()},handleOpen:()=>{var S;(S=p.value)==null||S.handleOpen()},handleClose:()=>{var S;(S=p.value)==null||S.handleClose()}});const r=S=>{o("update:modelValue",S)};return()=>{var S;const C=(S=e.format)!=null?S:yte[e.type]||pm,M=hne(e.type);return qe(eF,kr(e,{format:C,type:e.type,ref:p,"onUpdate:modelValue":r}),{default:P=>qe(M,P,{"prev-month":a["prev-month"],"next-month":a["next-month"],"prev-year":a["prev-year"],"next-year":a["next-year"]}),"range-separator":a["range-separator"]})}}});const mne=lr(pne),kE=Symbol("elDescriptions");var J_=We({name:"ElDescriptionsCell",props:{cell:{type:Object},tag:{type:String,default:"td"},type:{type:String}},setup(){return{descriptions:Pn(kE,{})}},render(){var e;const t=EJ(this.cell),o=(((e=this.cell)==null?void 0:e.dirs)||[]).map(U=>{const{dir:te,arg:Z,modifiers:q,value:J}=U;return[te,J,Z,q]}),{border:a,direction:d}=this.descriptions,p=d==="vertical",y=()=>{var U,te,Z;return((Z=(te=(U=this.cell)==null?void 0:U.children)==null?void 0:te.label)==null?void 0:Z.call(te))||t.label},r=()=>{var U,te,Z;return(Z=(te=(U=this.cell)==null?void 0:U.children)==null?void 0:te.default)==null?void 0:Z.call(te)},S=t.span,C=t.rowspan,M=t.align?`is-${t.align}`:"",P=t.labelAlign?`is-${t.labelAlign}`:M,z=t.className,F=t.labelClassName,V=this.type==="label"&&(t.labelWidth||this.descriptions.labelWidth)||t.width,N={width:_o(V),minWidth:_o(t.minWidth)},H=Xt("descriptions");switch(this.type){case"label":return hr(Zn(this.tag,{style:N,class:[H.e("cell"),H.e("label"),H.is("bordered-label",a),H.is("vertical-label",p),P,F],colSpan:p?S:1,rowspan:p?1:C},y()),o);case"content":return hr(Zn(this.tag,{style:N,class:[H.e("cell"),H.e("content"),H.is("bordered-content",a),H.is("vertical-content",p),M,z],colSpan:p?S:S*2-1,rowspan:p?C*2-1:C},r()),o);default:{const U=y();return hr(Zn("td",{style:N,class:[H.e("cell"),M],colSpan:S,rowspan:C},[Ho(U)?void 0:Zn("span",{class:[H.e("label"),F]},U),Zn("span",{class:[H.e("content"),z]},r())]),o)}}}});const gne=un({row:{type:lt(Array),default:()=>[]}}),_ne=We({name:"ElDescriptionsRow"}),yne=We({..._ne,props:gne,setup(e){const t=Pn(kE,{});return(o,a)=>b(t).direction==="vertical"?(ae(),Pe(Vn,{key:0},[Ue("tr",null,[(ae(!0),Pe(Vn,null,Fr(o.row,(d,p)=>(ae(),At(b(J_),{key:`tr1-${p}`,cell:d,tag:"th",type:"label"},null,8,["cell"]))),128))]),Ue("tr",null,[(ae(!0),Pe(Vn,null,Fr(o.row,(d,p)=>(ae(),At(b(J_),{key:`tr2-${p}`,cell:d,tag:"td",type:"content"},null,8,["cell"]))),128))])],64)):(ae(),Pe("tr",{key:1},[(ae(!0),Pe(Vn,null,Fr(o.row,(d,p)=>(ae(),Pe(Vn,{key:`tr3-${p}`},[b(t).border?(ae(),Pe(Vn,{key:0},[qe(b(J_),{cell:d,tag:"td",type:"label"},null,8,["cell"]),qe(b(J_),{cell:d,tag:"td",type:"content"},null,8,["cell"])],64)):(ae(),At(b(J_),{key:1,cell:d,tag:"td",type:"both"},null,8,["cell"]))],64))),128))]))}});var vne=dn(yne,[["__file","descriptions-row.vue"]]);const bne=un({border:Boolean,column:{type:Number,default:3},direction:{type:String,values:["horizontal","vertical"],default:"horizontal"},size:zo,title:{type:String,default:""},extra:{type:String,default:""},labelWidth:{type:[String,Number],default:""}}),xne=We({name:"ElDescriptions"}),wne=We({...xne,props:bne,setup(e){const t=e,o=Xt("descriptions"),a=Ro(),d=Bo();Vr(kE,t);const p=ee(()=>[o.b(),o.m(a.value)]),y=(S,C,M,P=!1)=>(S.props||(S.props={}),C>M&&(S.props.span=M),P&&(S.props.span=C),S),r=()=>{if(!d.default)return[];const S=Hd(d.default()).filter(V=>{var N;return((N=V==null?void 0:V.type)==null?void 0:N.name)==="ElDescriptionsItem"}),C=[];let M=[],P=t.column,z=0;const F=[];return S.forEach((V,N)=>{var H,U,te;const Z=((H=V.props)==null?void 0:H.span)||1,q=((U=V.props)==null?void 0:U.rowspan)||1,J=C.length;if(F[J]||(F[J]=0),q>1)for(let re=1;re<q;re++)F[te=J+re]||(F[te]=0),F[J+re]++,z++;if(F[J]>0&&(P-=F[J],F[J]=0),N<S.length-1&&(z+=Z>P?P:Z),N===S.length-1){const re=t.column-z%t.column;M.push(y(V,re,P,!0)),C.push(M);return}Z<P?(P-=Z,M.push(V)):(M.push(y(V,Z,P)),C.push(M),P=t.column,M=[])}),C};return(S,C)=>(ae(),Pe("div",{class:fe(b(p))},[S.title||S.extra||S.$slots.title||S.$slots.extra?(ae(),Pe("div",{key:0,class:fe(b(o).e("header"))},[Ue("div",{class:fe(b(o).e("title"))},[gt(S.$slots,"title",{},()=>[Nr(fn(S.title),1)])],2),Ue("div",{class:fe(b(o).e("extra"))},[gt(S.$slots,"extra",{},()=>[Nr(fn(S.extra),1)])],2)],2)):bt("v-if",!0),Ue("div",{class:fe(b(o).e("body"))},[Ue("table",{class:fe([b(o).e("table"),b(o).is("bordered",S.border)])},[Ue("tbody",null,[(ae(!0),Pe(Vn,null,Fr(r(),(M,P)=>(ae(),At(vne,{key:P,row:M},null,8,["row"]))),128))])],2)],2)],2))}});var Sne=dn(wne,[["__file","description.vue"]]);const Tne=un({label:{type:String,default:""},span:{type:Number,default:1},rowspan:{type:Number,default:1},width:{type:[String,Number],default:""},minWidth:{type:[String,Number],default:""},labelWidth:{type:[String,Number],default:""},align:{type:String,default:"left"},labelAlign:{type:String,default:""},className:{type:String,default:""},labelClassName:{type:String,default:""}}),lF=We({name:"ElDescriptionsItem",props:Tne}),Cne=lr(Sne,{DescriptionsItem:lF}),Ene=oo(lF),PE=e=>{if(!e)return{onClick:vi,onMousedown:vi,onMouseup:vi};let t=!1,o=!1;return{onClick:y=>{t&&o&&e(y),t=o=!1},onMousedown:y=>{t=y.target===y.currentTarget},onMouseup:y=>{o=y.target===y.currentTarget}}},Mne=un({mask:{type:Boolean,default:!0},customMaskEvent:Boolean,overlayClass:{type:lt([String,Array,Object])},zIndex:{type:lt([String,Number])}}),Ine={click:e=>e instanceof MouseEvent},Ane="overlay";var kne=We({name:"ElOverlay",props:Mne,emits:Ine,setup(e,{slots:t,emit:o}){const a=Xt(Ane),d=S=>{o("click",S)},{onClick:p,onMousedown:y,onMouseup:r}=PE(e.customMaskEvent?void 0:d);return()=>e.mask?qe("div",{class:[a.b(),e.overlayClass],style:{zIndex:e.zIndex},onClick:p,onMousedown:y,onMouseup:r},[gt(t,"default")],nl.STYLE|nl.CLASS|nl.PROPS,["onClick","onMouseup","onMousedown"]):Zn("div",{class:e.overlayClass,style:{zIndex:e.zIndex,position:"fixed",top:"0px",right:"0px",bottom:"0px",left:"0px"}},[gt(t,"default")])}});const RE=kne,uF=Symbol("dialogInjectionKey"),cF=un({center:Boolean,alignCenter:Boolean,closeIcon:{type:Ai},draggable:Boolean,overflow:Boolean,fullscreen:Boolean,showClose:{type:Boolean,default:!0},title:{type:String,default:""},ariaLevel:{type:String,default:"2"}}),Pne={close:()=>!0},dF=(e,t,o,a)=>{let d={offsetX:0,offsetY:0};const p=C=>{const M=C.clientX,P=C.clientY,{offsetX:z,offsetY:F}=d,V=e.value.getBoundingClientRect(),N=V.left,H=V.top,U=V.width,te=V.height,Z=document.documentElement.clientWidth,q=document.documentElement.clientHeight,J=-N+z,re=-H+F,se=Z-N-U+z,he=q-H-te+F,le=pe=>{let de=z+pe.clientX-M,Ie=F+pe.clientY-P;a!=null&&a.value||(de=Math.min(Math.max(de,J),se),Ie=Math.min(Math.max(Ie,re),he)),d={offsetX:de,offsetY:Ie},e.value&&(e.value.style.transform=`translate(${_o(de)}, ${_o(Ie)})`)},ce=()=>{document.removeEventListener("mousemove",le),document.removeEventListener("mouseup",ce)};document.addEventListener("mousemove",le),document.addEventListener("mouseup",ce)},y=()=>{t.value&&e.value&&t.value.addEventListener("mousedown",p)},r=()=>{t.value&&e.value&&t.value.removeEventListener("mousedown",p)},S=()=>{d={offsetX:0,offsetY:0},e.value&&(e.value.style.transform="none")};return yr(()=>{gs(()=>{o.value?y():r()})}),Li(()=>{r()}),{resetPosition:S}},Tx=(...e)=>t=>{e.forEach(o=>{$n(o)?o(t):o.value=t})},Rne=We({name:"ElDialogContent"}),One=We({...Rne,props:cF,emits:Pne,setup(e,{expose:t}){const o=e,{t:a}=qr(),{Close:d}=nE,{dialogRef:p,headerRef:y,bodyId:r,ns:S,style:C}=Pn(uF),{focusTrapRef:M}=Pn(lE),P=ee(()=>[S.b(),S.is("fullscreen",o.fullscreen),S.is("draggable",o.draggable),S.is("align-center",o.alignCenter),{[S.m("center")]:o.center}]),z=Tx(M,p),F=ee(()=>o.draggable),V=ee(()=>o.overflow),{resetPosition:N}=dF(p,y,F,V);return t({resetPosition:N}),(H,U)=>(ae(),Pe("div",{ref:b(z),class:fe(b(P)),style:Un(b(C)),tabindex:"-1"},[Ue("header",{ref_key:"headerRef",ref:y,class:fe([b(S).e("header"),{"show-close":H.showClose}])},[gt(H.$slots,"header",{},()=>[Ue("span",{role:"heading","aria-level":H.ariaLevel,class:fe(b(S).e("title"))},fn(H.title),11,["aria-level"])]),H.showClose?(ae(),Pe("button",{key:0,"aria-label":b(a)("el.dialog.close"),class:fe(b(S).e("headerbtn")),type:"button",onClick:te=>H.$emit("close")},[qe(b(zn),{class:fe(b(S).e("close"))},{default:ot(()=>[(ae(),At(Ir(H.closeIcon||b(d))))]),_:1},8,["class"])],10,["aria-label","onClick"])):bt("v-if",!0)],2),Ue("div",{id:b(r),class:fe(b(S).e("body"))},[gt(H.$slots,"default")],10,["id"]),H.$slots.footer?(ae(),Pe("footer",{key:0,class:fe(b(S).e("footer"))},[gt(H.$slots,"footer")],2)):bt("v-if",!0)],6))}});var Lne=dn(One,[["__file","dialog-content.vue"]]);const fF=un({...cF,appendToBody:Boolean,appendTo:{type:lt([String,Object]),default:"body"},beforeClose:{type:lt(Function)},destroyOnClose:Boolean,closeOnClickModal:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0},lockScroll:{type:Boolean,default:!0},modal:{type:Boolean,default:!0},openDelay:{type:Number,default:0},closeDelay:{type:Number,default:0},top:{type:String},modelValue:Boolean,modalClass:String,width:{type:[String,Number]},zIndex:{type:Number},trapFocus:Boolean,headerAriaLevel:{type:String,default:"2"}}),hF={open:()=>!0,opened:()=>!0,close:()=>!0,closed:()=>!0,[gr]:e=>Oi(e),openAutoFocus:()=>!0,closeAutoFocus:()=>!0},OE=(e,t={})=>{Ti(e)||No("[useLockscreen]","You need to pass a ref param to this function");const o=t.ns||Xt("popup"),a=ee(()=>o.bm("parent","hidden"));if(!Wr||wa(document.body,a.value))return;let d=0,p=!1,y="0";const r=()=>{setTimeout(()=>{typeof document>"u"||(Vs(document==null?void 0:document.body,a.value),p&&document&&(document.body.style.width=y))},200)};Wt(e,S=>{if(!S){r();return}p=!wa(document.body,a.value),p&&(y=document.body.style.width),d=Cz(o.namespace.value);const C=document.documentElement.clientHeight<document.body.scrollHeight,M=Tc(document.body,"overflowY");d>0&&(C||M==="scroll")&&p&&(document.body.style.width=`calc(100% - ${d}px)`),ol(document.body,a.value)}),mC(()=>r())},pF=(e,t)=>{var o;const d=Cr().emit,{nextZIndex:p}=og();let y="";const r=us(),S=us(),C=xe(!1),M=xe(!1),P=xe(!1),z=xe((o=e.zIndex)!=null?o:p());let F,V;const N=px("namespace",hy),H=ee(()=>{const be={},ye=`--${N.value}-dialog`;return e.fullscreen||(e.top&&(be[`${ye}-margin-top`]=e.top),e.width&&(be[`${ye}-width`]=_o(e.width))),be}),U=ee(()=>e.alignCenter?{display:"flex"}:{});function te(){d("opened")}function Z(){d("closed"),d(gr,!1),e.destroyOnClose&&(P.value=!1)}function q(){d("close")}function J(){V==null||V(),F==null||F(),e.openDelay&&e.openDelay>0?{stop:F}=Sh(()=>le(),e.openDelay):le()}function re(){F==null||F(),V==null||V(),e.closeDelay&&e.closeDelay>0?{stop:V}=Sh(()=>ce(),e.closeDelay):ce()}function se(){function be(ye){ye||(M.value=!0,C.value=!1)}e.beforeClose?e.beforeClose(be):re()}function he(){e.closeOnClickModal&&se()}function le(){Wr&&(C.value=!0)}function ce(){C.value=!1}function pe(){d("openAutoFocus")}function de(){d("closeAutoFocus")}function Ie(be){var ye;((ye=be.detail)==null?void 0:ye.focusReason)==="pointer"&&be.preventDefault()}e.lockScroll&&OE(C);function Ve(){e.closeOnPressEscape&&se()}return Wt(()=>e.modelValue,be=>{be?(M.value=!1,J(),P.value=!0,z.value=az(e.zIndex)?p():z.value++,jn(()=>{d("open"),t.value&&(t.value.scrollTop=0)})):C.value&&re()}),Wt(()=>e.fullscreen,be=>{t.value&&(be?(y=t.value.style.transform,t.value.style.transform=""):t.value.style.transform=y)}),yr(()=>{e.modelValue&&(C.value=!0,P.value=!0,J())}),{afterEnter:te,afterLeave:Z,beforeLeave:q,handleClose:se,onModalClick:he,close:re,doClose:ce,onOpenAutoFocus:pe,onCloseAutoFocus:de,onCloseRequested:Ve,onFocusoutPrevented:Ie,titleId:r,bodyId:S,closed:M,style:H,overlayDialogStyle:U,rendered:P,visible:C,zIndex:z}},Dne=We({name:"ElDialog",inheritAttrs:!1}),zne=We({...Dne,props:fF,emits:hF,setup(e,{expose:t}){const o=e,a=Bo();Ud({scope:"el-dialog",from:"the title slot",replacement:"the header slot",version:"3.0.0",ref:"https://element-plus.org/en-US/component/dialog.html#slots"},ee(()=>!!a.title));const d=Xt("dialog"),p=xe(),y=xe(),r=xe(),{visible:S,titleId:C,bodyId:M,style:P,overlayDialogStyle:z,rendered:F,zIndex:V,afterEnter:N,afterLeave:H,beforeLeave:U,handleClose:te,onModalClick:Z,onOpenAutoFocus:q,onCloseAutoFocus:J,onCloseRequested:re,onFocusoutPrevented:se}=pF(o,p);Vr(uF,{dialogRef:p,headerRef:y,bodyId:M,ns:d,rendered:F,style:P});const he=PE(Z),le=ee(()=>o.draggable&&!o.fullscreen);return t({visible:S,dialogContentRef:r,resetPosition:()=>{var pe;(pe=r.value)==null||pe.resetPosition()}}),(pe,de)=>(ae(),At(b(lg),{to:pe.appendTo,disabled:pe.appendTo!=="body"?!1:!pe.appendToBody},{default:ot(()=>[qe(rs,{name:"dialog-fade",onAfterEnter:b(N),onAfterLeave:b(H),onBeforeLeave:b(U),persisted:""},{default:ot(()=>[hr(qe(b(RE),{"custom-mask-event":"",mask:pe.modal,"overlay-class":pe.modalClass,"z-index":b(V)},{default:ot(()=>[Ue("div",{role:"dialog","aria-modal":"true","aria-label":pe.title||void 0,"aria-labelledby":pe.title?void 0:b(C),"aria-describedby":b(M),class:fe(`${b(d).namespace.value}-overlay-dialog`),style:Un(b(z)),onClick:b(he).onClick,onMousedown:b(he).onMousedown,onMouseup:b(he).onMouseup},[qe(b(ag),{loop:"",trapped:b(S),"focus-start-el":"container",onFocusAfterTrapped:b(q),onFocusAfterReleased:b(J),onFocusoutPrevented:b(se),onReleaseRequested:b(re)},{default:ot(()=>[b(F)?(ae(),At(Lne,kr({key:0,ref_key:"dialogContentRef",ref:r},pe.$attrs,{center:pe.center,"align-center":pe.alignCenter,"close-icon":pe.closeIcon,draggable:b(le),overflow:pe.overflow,fullscreen:pe.fullscreen,"show-close":pe.showClose,title:pe.title,"aria-level":pe.headerAriaLevel,onClose:b(te)}),cl({header:ot(()=>[pe.$slots.title?gt(pe.$slots,"title",{key:1}):gt(pe.$slots,"header",{key:0,close:b(te),titleId:b(C),titleClass:b(d).e("title")})]),default:ot(()=>[gt(pe.$slots,"default")]),_:2},[pe.$slots.footer?{name:"footer",fn:ot(()=>[gt(pe.$slots,"footer")])}:void 0]),1040,["center","align-center","close-icon","draggable","overflow","fullscreen","show-close","title","aria-level","onClose"])):bt("v-if",!0)]),_:3},8,["trapped","onFocusAfterTrapped","onFocusAfterReleased","onFocusoutPrevented","onReleaseRequested"])],46,["aria-label","aria-labelledby","aria-describedby","onClick","onMousedown","onMouseup"])]),_:3},8,["mask","overlay-class","z-index"]),[[ii,b(S)]])]),_:3},8,["onAfterEnter","onAfterLeave","onBeforeLeave"])]),_:3},8,["to","disabled"]))}});var Fne=dn(zne,[["__file","dialog.vue"]]);const Nne=lr(Fne),Bne=un({direction:{type:String,values:["horizontal","vertical"],default:"horizontal"},contentPosition:{type:String,values:["left","center","right"],default:"center"},borderStyle:{type:lt(String),default:"solid"}}),Vne=We({name:"ElDivider"}),$ne=We({...Vne,props:Bne,setup(e){const t=e,o=Xt("divider"),a=ee(()=>o.cssVar({"border-style":t.borderStyle}));return(d,p)=>(ae(),Pe("div",{class:fe([b(o).b(),b(o).m(d.direction)]),style:Un(b(a)),role:"separator"},[d.$slots.default&&d.direction!=="vertical"?(ae(),Pe("div",{key:0,class:fe([b(o).e("text"),b(o).is(d.contentPosition)])},[gt(d.$slots,"default")],2)):bt("v-if",!0)],6))}});var Une=dn($ne,[["__file","divider.vue"]]);const mF=lr(Une),jne=un({...fF,direction:{type:String,default:"rtl",values:["ltr","rtl","ttb","btt"]},size:{type:[String,Number],default:"30%"},withHeader:{type:Boolean,default:!0},modalFade:{type:Boolean,default:!0},headerAriaLevel:{type:String,default:"2"}}),Hne=hF,Gne=We({name:"ElDrawer",inheritAttrs:!1}),Wne=We({...Gne,props:jne,emits:Hne,setup(e,{expose:t}){const o=e,a=Bo();Ud({scope:"el-drawer",from:"the title slot",replacement:"the header slot",version:"3.0.0",ref:"https://element-plus.org/en-US/component/drawer.html#slots"},ee(()=>!!a.title));const d=xe(),p=xe(),y=Xt("drawer"),{t:r}=qr(),{afterEnter:S,afterLeave:C,beforeLeave:M,visible:P,rendered:z,titleId:F,bodyId:V,zIndex:N,onModalClick:H,onOpenAutoFocus:U,onCloseAutoFocus:te,onFocusoutPrevented:Z,onCloseRequested:q,handleClose:J}=pF(o,d),re=ee(()=>o.direction==="rtl"||o.direction==="ltr"),se=ee(()=>_o(o.size));return t({handleClose:J,afterEnter:S,afterLeave:C}),(he,le)=>(ae(),At(b(lg),{to:he.appendTo,disabled:he.appendTo!=="body"?!1:!he.appendToBody},{default:ot(()=>[qe(rs,{name:b(y).b("fade"),onAfterEnter:b(S),onAfterLeave:b(C),onBeforeLeave:b(M),persisted:""},{default:ot(()=>[hr(qe(b(RE),{mask:he.modal,"overlay-class":he.modalClass,"z-index":b(N),onClick:b(H)},{default:ot(()=>[qe(b(ag),{loop:"",trapped:b(P),"focus-trap-el":d.value,"focus-start-el":p.value,onFocusAfterTrapped:b(U),onFocusAfterReleased:b(te),onFocusoutPrevented:b(Z),onReleaseRequested:b(q)},{default:ot(()=>[Ue("div",kr({ref_key:"drawerRef",ref:d,"aria-modal":"true","aria-label":he.title||void 0,"aria-labelledby":he.title?void 0:b(F),"aria-describedby":b(V)},he.$attrs,{class:[b(y).b(),he.direction,b(P)&&"open"],style:b(re)?"width: "+b(se):"height: "+b(se),role:"dialog",onClick:Jn(()=>{},["stop"])}),[Ue("span",{ref_key:"focusStartRef",ref:p,class:fe(b(y).e("sr-focus")),tabindex:"-1"},null,2),he.withHeader?(ae(),Pe("header",{key:0,class:fe(b(y).e("header"))},[he.$slots.title?gt(he.$slots,"title",{key:1},()=>[bt(" DEPRECATED SLOT ")]):gt(he.$slots,"header",{key:0,close:b(J),titleId:b(F),titleClass:b(y).e("title")},()=>[he.$slots.title?bt("v-if",!0):(ae(),Pe("span",{key:0,id:b(F),role:"heading","aria-level":he.headerAriaLevel,class:fe(b(y).e("title"))},fn(he.title),11,["id","aria-level"]))]),he.showClose?(ae(),Pe("button",{key:2,"aria-label":b(r)("el.drawer.close"),class:fe(b(y).e("close-btn")),type:"button",onClick:b(J)},[qe(b(zn),{class:fe(b(y).e("close"))},{default:ot(()=>[qe(b(Ql))]),_:1},8,["class"])],10,["aria-label","onClick"])):bt("v-if",!0)],2)):bt("v-if",!0),b(z)?(ae(),Pe("div",{key:1,id:b(V),class:fe(b(y).e("body"))},[gt(he.$slots,"default")],10,["id"])):bt("v-if",!0),he.$slots.footer?(ae(),Pe("div",{key:2,class:fe(b(y).e("footer"))},[gt(he.$slots,"footer")],2)):bt("v-if",!0)],16,["aria-label","aria-labelledby","aria-describedby","onClick"])]),_:3},8,["trapped","focus-trap-el","focus-start-el","onFocusAfterTrapped","onFocusAfterReleased","onFocusoutPrevented","onReleaseRequested"])]),_:3},8,["mask","overlay-class","z-index","onClick"]),[[ii,b(P)]])]),_:3},8,["name","onAfterEnter","onAfterLeave","onBeforeLeave"])]),_:3},8,["to","disabled"]))}});var qne=dn(Wne,[["__file","drawer.vue"]]);const Kne=lr(qne),Zne=We({inheritAttrs:!1});function Yne(e,t,o,a,d,p){return gt(e.$slots,"default")}var Xne=dn(Zne,[["render",Yne],["__file","collection.vue"]]);const Jne=We({name:"ElCollectionItem",inheritAttrs:!1});function Qne(e,t,o,a,d,p){return gt(e.$slots,"default")}var ere=dn(Jne,[["render",Qne],["__file","collection-item.vue"]]);const gF="data-el-collection-item",_F=e=>{const t=`El${e}Collection`,o=`${t}Item`,a=Symbol(t),d=Symbol(o),p={...Xne,name:t,setup(){const r=xe(null),S=new Map;Vr(a,{itemMap:S,getItems:()=>{const M=b(r);if(!M)return[];const P=Array.from(M.querySelectorAll(`[${gF}]`));return[...S.values()].sort((F,V)=>P.indexOf(F.ref)-P.indexOf(V.ref))},collectionRef:r})}},y={...ere,name:o,setup(r,{attrs:S}){const C=xe(null),M=Pn(a,void 0);Vr(d,{collectionItemRef:C}),yr(()=>{const P=b(C);P&&M.itemMap.set(P,{ref:P,...S})}),Li(()=>{const P=b(C);M.itemMap.delete(P)})}};return{COLLECTION_INJECTION_KEY:a,COLLECTION_ITEM_INJECTION_KEY:d,ElCollection:p,ElCollectionItem:y}},tre=un({style:{type:lt([String,Array,Object])},currentTabId:{type:lt(String)},defaultCurrentTabId:String,loop:Boolean,dir:{type:String,values:["ltr","rtl"],default:"ltr"},orientation:{type:lt(String)},onBlur:Function,onFocus:Function,onMousedown:Function}),{ElCollection:nre,ElCollectionItem:rre,COLLECTION_INJECTION_KEY:LE,COLLECTION_ITEM_INJECTION_KEY:ire}=_F("RovingFocusGroup"),DE=Symbol("elRovingFocusGroup"),yF=Symbol("elRovingFocusGroupItem"),ore={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"},sre=(e,t)=>e,are=(e,t,o)=>{const a=sre(e.code);return ore[a]},lre=(e,t)=>e.map((o,a)=>e[(a+t)%e.length]),zE=e=>{const{activeElement:t}=document;for(const o of e)if(o===t||(o.focus(),t!==document.activeElement))return},ER="currentTabIdChange",MR="rovingFocusGroup.entryFocus",ure={bubbles:!1,cancelable:!0},cre=We({name:"ElRovingFocusGroupImpl",inheritAttrs:!1,props:tre,emits:[ER,"entryFocus"],setup(e,{emit:t}){var o;const a=xe((o=e.currentTabId||e.defaultCurrentTabId)!=null?o:null),d=xe(!1),p=xe(!1),y=xe(null),{getItems:r}=Pn(LE,void 0),S=ee(()=>[{outline:"none"},e.style]),C=N=>{t(ER,N)},M=()=>{d.value=!0},P=go(N=>{var H;(H=e.onMousedown)==null||H.call(e,N)},()=>{p.value=!0}),z=go(N=>{var H;(H=e.onFocus)==null||H.call(e,N)},N=>{const H=!b(p),{target:U,currentTarget:te}=N;if(U===te&&H&&!b(d)){const Z=new Event(MR,ure);if(te==null||te.dispatchEvent(Z),!Z.defaultPrevented){const q=r().filter(le=>le.focusable),J=q.find(le=>le.active),re=q.find(le=>le.id===b(a)),he=[J,re,...q].filter(Boolean).map(le=>le.ref);zE(he)}}p.value=!1}),F=go(N=>{var H;(H=e.onBlur)==null||H.call(e,N)},()=>{d.value=!1}),V=(...N)=>{t("entryFocus",...N)};Vr(DE,{currentTabbedId:Qm(a),loop:hi(e,"loop"),tabIndex:ee(()=>b(d)?-1:0),rovingFocusGroupRef:y,rovingFocusGroupRootStyle:S,orientation:hi(e,"orientation"),dir:hi(e,"dir"),onItemFocus:C,onItemShiftTab:M,onBlur:F,onFocus:z,onMousedown:P}),Wt(()=>e.currentTabId,N=>{a.value=N??null}),Si(y,MR,V)}});function dre(e,t,o,a,d,p){return gt(e.$slots,"default")}var fre=dn(cre,[["render",dre],["__file","roving-focus-group-impl.vue"]]);const hre=We({name:"ElRovingFocusGroup",components:{ElFocusGroupCollection:nre,ElRovingFocusGroupImpl:fre}});function pre(e,t,o,a,d,p){const y=Er("el-roving-focus-group-impl"),r=Er("el-focus-group-collection");return ae(),At(r,null,{default:ot(()=>[qe(y,Gl(Wd(e.$attrs)),{default:ot(()=>[gt(e.$slots,"default")]),_:3},16)]),_:3})}var mre=dn(hre,[["render",pre],["__file","roving-focus-group.vue"]]);const Xb=un({trigger:Fy.trigger,triggerKeys:{type:lt(Array),default:()=>[Cn.enter,Cn.numpadEnter,Cn.space,Cn.down]},effect:{...Jo.effect,default:"light"},type:{type:lt(String)},placement:{type:lt(String),default:"bottom"},popperOptions:{type:lt(Object),default:()=>({})},id:String,size:{type:String,default:""},splitButton:Boolean,hideOnClick:{type:Boolean,default:!0},loop:{type:Boolean,default:!0},showTimeout:{type:Number,default:150},hideTimeout:{type:Number,default:150},tabindex:{type:lt([Number,String]),default:0},maxHeight:{type:lt([Number,String]),default:""},popperClass:{type:String,default:""},disabled:Boolean,role:{type:String,default:"menu"},buttonProps:{type:lt(Object)},teleported:Jo.teleported}),vF=un({command:{type:[Object,String,Number],default:()=>({})},disabled:Boolean,divided:Boolean,textValue:String,icon:{type:Ai}}),gre=un({onKeydown:{type:lt(Function)}}),_re=[Cn.down,Cn.pageDown,Cn.home],bF=[Cn.up,Cn.pageUp,Cn.end],yre=[..._re,...bF],{ElCollection:vre,ElCollectionItem:bre,COLLECTION_INJECTION_KEY:xre,COLLECTION_ITEM_INJECTION_KEY:wre}=_F("Dropdown"),Cx=Symbol("elDropdown"),{ButtonGroup:Sre}=ts,Tre=We({name:"ElDropdown",components:{ElButton:ts,ElButtonGroup:Sre,ElScrollbar:Hu,ElDropdownCollection:vre,ElTooltip:bs,ElRovingFocusGroup:mre,ElOnlyChild:Uz,ElIcon:zn,ArrowDown:zc},props:Xb,emits:["visible-change","click","command"],setup(e,{emit:t}){const o=Cr(),a=Xt("dropdown"),{t:d}=qr(),p=xe(),y=xe(),r=xe(null),S=xe(null),C=xe(null),M=xe(null),P=xe(!1),z=ee(()=>({maxHeight:_o(e.maxHeight)})),F=ee(()=>[a.m(q.value)]),V=ee(()=>Fs(e.trigger)),N=us().value,H=ee(()=>e.id||N);Wt([p,V],([ye,Me],[we])=>{var me,De,Ge;(me=we==null?void 0:we.$el)!=null&&me.removeEventListener&&we.$el.removeEventListener("pointerenter",re),(De=ye==null?void 0:ye.$el)!=null&&De.removeEventListener&&ye.$el.removeEventListener("pointerenter",re),(Ge=ye==null?void 0:ye.$el)!=null&&Ge.addEventListener&&Me.includes("hover")&&ye.$el.addEventListener("pointerenter",re)},{immediate:!0}),Li(()=>{var ye,Me;(Me=(ye=p.value)==null?void 0:ye.$el)!=null&&Me.removeEventListener&&p.value.$el.removeEventListener("pointerenter",re)});function U(){te()}function te(){var ye;(ye=r.value)==null||ye.onClose()}function Z(){var ye;(ye=r.value)==null||ye.onOpen()}const q=Ro();function J(...ye){t("command",...ye)}function re(){var ye,Me;(Me=(ye=p.value)==null?void 0:ye.$el)==null||Me.focus()}function se(){}function he(){const ye=b(S);V.value.includes("hover")&&(ye==null||ye.focus()),M.value=null}function le(ye){M.value=ye}function ce(ye){P.value||(ye.preventDefault(),ye.stopImmediatePropagation())}function pe(){t("visible-change",!0)}function de(ye){(ye==null?void 0:ye.type)==="keydown"&&S.value.focus()}function Ie(){t("visible-change",!1)}return Vr(Cx,{contentRef:S,role:ee(()=>e.role),triggerId:H,isUsingKeyboard:P,onItemEnter:se,onItemLeave:he}),Vr("elDropdown",{instance:o,dropdownSize:q,handleClick:U,commandHandler:J,trigger:hi(e,"trigger"),hideOnClick:hi(e,"hideOnClick")}),{t:d,ns:a,scrollbar:C,wrapStyle:z,dropdownTriggerKls:F,dropdownSize:q,triggerId:H,currentTabId:M,handleCurrentTabIdChange:le,handlerMainButtonClick:ye=>{t("click",ye)},handleEntryFocus:ce,handleClose:te,handleOpen:Z,handleBeforeShowTooltip:pe,handleShowTooltip:de,handleBeforeHideTooltip:Ie,onFocusAfterTrapped:ye=>{var Me,we;ye.preventDefault(),(we=(Me=S.value)==null?void 0:Me.focus)==null||we.call(Me,{preventScroll:!0})},popperRef:r,contentRef:S,triggeringElementRef:p,referenceElementRef:y}}});function Cre(e,t,o,a,d,p){var y;const r=Er("el-dropdown-collection"),S=Er("el-roving-focus-group"),C=Er("el-scrollbar"),M=Er("el-only-child"),P=Er("el-tooltip"),z=Er("el-button"),F=Er("arrow-down"),V=Er("el-icon"),N=Er("el-button-group");return ae(),Pe("div",{class:fe([e.ns.b(),e.ns.is("disabled",e.disabled)])},[qe(P,{ref:"popperRef",role:e.role,effect:e.effect,"fallback-placements":["bottom","top"],"popper-options":e.popperOptions,"gpu-acceleration":!1,"hide-after":e.trigger==="hover"?e.hideTimeout:0,"manual-mode":!0,placement:e.placement,"popper-class":[e.ns.e("popper"),e.popperClass],"reference-element":(y=e.referenceElementRef)==null?void 0:y.$el,trigger:e.trigger,"trigger-keys":e.triggerKeys,"trigger-target-el":e.contentRef,"show-after":e.trigger==="hover"?e.showTimeout:0,"stop-popper-mouse-event":!1,"virtual-ref":e.triggeringElementRef,"virtual-triggering":e.splitButton,disabled:e.disabled,transition:`${e.ns.namespace.value}-zoom-in-top`,teleported:e.teleported,pure:"",persistent:"",onBeforeShow:e.handleBeforeShowTooltip,onShow:e.handleShowTooltip,onBeforeHide:e.handleBeforeHideTooltip},cl({content:ot(()=>[qe(C,{ref:"scrollbar","wrap-style":e.wrapStyle,tag:"div","view-class":e.ns.e("list")},{default:ot(()=>[qe(S,{loop:e.loop,"current-tab-id":e.currentTabId,orientation:"horizontal",onCurrentTabIdChange:e.handleCurrentTabIdChange,onEntryFocus:e.handleEntryFocus},{default:ot(()=>[qe(r,null,{default:ot(()=>[gt(e.$slots,"dropdown")]),_:3})]),_:3},8,["loop","current-tab-id","onCurrentTabIdChange","onEntryFocus"])]),_:3},8,["wrap-style","view-class"])]),_:2},[e.splitButton?void 0:{name:"default",fn:ot(()=>[qe(M,{id:e.triggerId,ref:"triggeringElementRef",role:"button",tabindex:e.tabindex},{default:ot(()=>[gt(e.$slots,"default")]),_:3},8,["id","tabindex"])])}]),1032,["role","effect","popper-options","hide-after","placement","popper-class","reference-element","trigger","trigger-keys","trigger-target-el","show-after","virtual-ref","virtual-triggering","disabled","transition","teleported","onBeforeShow","onShow","onBeforeHide"]),e.splitButton?(ae(),At(N,{key:0},{default:ot(()=>[qe(z,kr({ref:"referenceElementRef"},e.buttonProps,{size:e.dropdownSize,type:e.type,disabled:e.disabled,tabindex:e.tabindex,onClick:e.handlerMainButtonClick}),{default:ot(()=>[gt(e.$slots,"default")]),_:3},16,["size","type","disabled","tabindex","onClick"]),qe(z,kr({id:e.triggerId,ref:"triggeringElementRef"},e.buttonProps,{role:"button",size:e.dropdownSize,type:e.type,class:e.ns.e("caret-button"),disabled:e.disabled,tabindex:e.tabindex,"aria-label":e.t("el.dropdown.toggleDropdown")}),{default:ot(()=>[qe(V,{class:fe(e.ns.e("icon"))},{default:ot(()=>[qe(F)]),_:1},8,["class"])]),_:1},16,["id","size","type","class","disabled","tabindex","aria-label"])]),_:3})):bt("v-if",!0)],2)}var Ere=dn(Tre,[["render",Cre],["__file","dropdown.vue"]]);const Mre=We({components:{ElRovingFocusCollectionItem:rre},props:{focusable:{type:Boolean,default:!0},active:{type:Boolean,default:!1}},emits:["mousedown","focus","keydown"],setup(e,{emit:t}){const{currentTabbedId:o,loop:a,onItemFocus:d,onItemShiftTab:p}=Pn(DE,void 0),{getItems:y}=Pn(LE,void 0),r=us(),S=xe(null),C=go(F=>{t("mousedown",F)},F=>{e.focusable?d(b(r)):F.preventDefault()}),M=go(F=>{t("focus",F)},()=>{d(b(r))}),P=go(F=>{t("keydown",F)},F=>{const{code:V,shiftKey:N,target:H,currentTarget:U}=F;if(V===Cn.tab&&N){p();return}if(H!==U)return;const te=are(F);if(te){F.preventDefault();let q=y().filter(J=>J.focusable).map(J=>J.ref);switch(te){case"last":{q.reverse();break}case"prev":case"next":{te==="prev"&&q.reverse();const J=q.indexOf(U);q=a.value?lre(q,J+1):q.slice(J+1);break}}jn(()=>{zE(q)})}}),z=ee(()=>o.value===b(r));return Vr(yF,{rovingFocusGroupItemRef:S,tabIndex:ee(()=>b(z)?0:-1),handleMousedown:C,handleFocus:M,handleKeydown:P}),{id:r,handleKeydown:P,handleFocus:M,handleMousedown:C}}});function Ire(e,t,o,a,d,p){const y=Er("el-roving-focus-collection-item");return ae(),At(y,{id:e.id,focusable:e.focusable,active:e.active},{default:ot(()=>[gt(e.$slots,"default")]),_:3},8,["id","focusable","active"])}var Are=dn(Mre,[["render",Ire],["__file","roving-focus-item.vue"]]);const kre=We({name:"DropdownItemImpl",components:{ElIcon:zn},props:vF,emits:["pointermove","pointerleave","click","clickimpl"],setup(e,{emit:t}){const o=Xt("dropdown"),{role:a}=Pn(Cx,void 0),{collectionItemRef:d}=Pn(wre,void 0),{collectionItemRef:p}=Pn(ire,void 0),{rovingFocusGroupItemRef:y,tabIndex:r,handleFocus:S,handleKeydown:C,handleMousedown:M}=Pn(yF,void 0),P=Tx(d,p,y),z=ee(()=>a.value==="menu"?"menuitem":a.value==="navigation"?"link":"button"),F=go(V=>{if([Cn.enter,Cn.numpadEnter,Cn.space].includes(V.code))return V.preventDefault(),V.stopImmediatePropagation(),t("clickimpl",V),!0},C);return{ns:o,itemRef:P,dataset:{[gF]:""},role:z,tabIndex:r,handleFocus:S,handleKeydown:F,handleMousedown:M}}});function Pre(e,t,o,a,d,p){const y=Er("el-icon");return ae(),Pe(Vn,null,[e.divided?(ae(),Pe("li",{key:0,role:"separator",class:fe(e.ns.bem("menu","item","divided"))},null,2)):bt("v-if",!0),Ue("li",kr({ref:e.itemRef},{...e.dataset,...e.$attrs},{"aria-disabled":e.disabled,class:[e.ns.be("menu","item"),e.ns.is("disabled",e.disabled)],tabindex:e.tabIndex,role:e.role,onClick:r=>e.$emit("clickimpl",r),onFocus:e.handleFocus,onKeydown:Jn(e.handleKeydown,["self"]),onMousedown:e.handleMousedown,onPointermove:r=>e.$emit("pointermove",r),onPointerleave:r=>e.$emit("pointerleave",r)}),[e.icon?(ae(),At(y,{key:0},{default:ot(()=>[(ae(),At(Ir(e.icon)))]),_:1})):bt("v-if",!0),gt(e.$slots,"default")],16,["aria-disabled","tabindex","role","onClick","onFocus","onKeydown","onMousedown","onPointermove","onPointerleave"])],64)}var Rre=dn(kre,[["render",Pre],["__file","dropdown-item-impl.vue"]]);const xF=()=>{const e=Pn("elDropdown",{}),t=ee(()=>e==null?void 0:e.dropdownSize);return{elDropdown:e,_elDropdownSize:t}},Ore=We({name:"ElDropdownItem",components:{ElDropdownCollectionItem:bre,ElRovingFocusItem:Are,ElDropdownItemImpl:Rre},inheritAttrs:!1,props:vF,emits:["pointermove","pointerleave","click"],setup(e,{emit:t,attrs:o}){const{elDropdown:a}=xF(),d=Cr(),p=xe(null),y=ee(()=>{var F,V;return(V=(F=b(p))==null?void 0:F.textContent)!=null?V:""}),{onItemEnter:r,onItemLeave:S}=Pn(Cx,void 0),C=go(F=>(t("pointermove",F),F.defaultPrevented),rR(F=>{if(e.disabled){S(F);return}const V=F.currentTarget;V===document.activeElement||V.contains(document.activeElement)||(r(F),F.defaultPrevented||V==null||V.focus())})),M=go(F=>(t("pointerleave",F),F.defaultPrevented),rR(S)),P=go(F=>{if(!e.disabled)return t("click",F),F.type!=="keydown"&&F.defaultPrevented},F=>{var V,N,H;if(e.disabled){F.stopImmediatePropagation();return}(V=a==null?void 0:a.hideOnClick)!=null&&V.value&&((N=a.handleClick)==null||N.call(a)),(H=a.commandHandler)==null||H.call(a,e.command,d,F)}),z=ee(()=>({...e,...o}));return{handleClick:P,handlePointerMove:C,handlePointerLeave:M,textContent:y,propsAndAttrs:z}}});function Lre(e,t,o,a,d,p){var y;const r=Er("el-dropdown-item-impl"),S=Er("el-roving-focus-item"),C=Er("el-dropdown-collection-item");return ae(),At(C,{disabled:e.disabled,"text-value":(y=e.textValue)!=null?y:e.textContent},{default:ot(()=>[qe(S,{focusable:!e.disabled},{default:ot(()=>[qe(r,kr(e.propsAndAttrs,{onPointerleave:e.handlePointerLeave,onPointermove:e.handlePointerMove,onClickimpl:e.handleClick}),{default:ot(()=>[gt(e.$slots,"default")]),_:3},16,["onPointerleave","onPointermove","onClickimpl"])]),_:3},8,["focusable"])]),_:3},8,["disabled","text-value"])}var wF=dn(Ore,[["render",Lre],["__file","dropdown-item.vue"]]);const Dre=We({name:"ElDropdownMenu",props:gre,setup(e){const t=Xt("dropdown"),{_elDropdownSize:o}=xF(),a=o.value,{focusTrapRef:d,onKeydown:p}=Pn(lE,void 0),{contentRef:y,role:r,triggerId:S}=Pn(Cx,void 0),{collectionRef:C,getItems:M}=Pn(xre,void 0),{rovingFocusGroupRef:P,rovingFocusGroupRootStyle:z,tabIndex:F,onBlur:V,onFocus:N,onMousedown:H}=Pn(DE,void 0),{collectionRef:U}=Pn(LE,void 0),te=ee(()=>[t.b("menu"),t.bm("menu",a==null?void 0:a.value)]),Z=Tx(y,C,d,P,U),q=go(re=>{var se;(se=e.onKeydown)==null||se.call(e,re)},re=>{const{currentTarget:se,code:he,target:le}=re;if(se.contains(le),Cn.tab===he&&re.stopImmediatePropagation(),re.preventDefault(),le!==b(y)||!yre.includes(he))return;const pe=M().filter(de=>!de.disabled).map(de=>de.ref);bF.includes(he)&&pe.reverse(),zE(pe)});return{size:a,rovingFocusGroupRootStyle:z,tabIndex:F,dropdownKls:te,role:r,triggerId:S,dropdownListWrapperRef:Z,handleKeydown:re=>{q(re),p(re)},onBlur:V,onFocus:N,onMousedown:H}}});function zre(e,t,o,a,d,p){return ae(),Pe("ul",{ref:e.dropdownListWrapperRef,class:fe(e.dropdownKls),style:Un(e.rovingFocusGroupRootStyle),tabindex:-1,role:e.role,"aria-labelledby":e.triggerId,onBlur:e.onBlur,onFocus:e.onFocus,onKeydown:Jn(e.handleKeydown,["self"]),onMousedown:Jn(e.onMousedown,["self"])},[gt(e.$slots,"default")],46,["role","aria-labelledby","onBlur","onFocus","onKeydown","onMousedown"])}var SF=dn(Dre,[["render",zre],["__file","dropdown-menu.vue"]]);const Fre=lr(Ere,{DropdownItem:wF,DropdownMenu:SF}),Nre=oo(wF),Bre=oo(SF),Vre=We({name:"ImgEmpty"}),$re=We({...Vre,setup(e){const t=Xt("empty"),o=us();return(a,d)=>(ae(),Pe("svg",{viewBox:"0 0 79 86",version:"1.1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink"},[Ue("defs",null,[Ue("linearGradient",{id:`linearGradient-1-${b(o)}`,x1:"38.8503086%",y1:"0%",x2:"61.1496914%",y2:"100%"},[Ue("stop",{"stop-color":`var(${b(t).cssVarBlockName("fill-color-1")})`,offset:"0%"},null,8,["stop-color"]),Ue("stop",{"stop-color":`var(${b(t).cssVarBlockName("fill-color-4")})`,offset:"100%"},null,8,["stop-color"])],8,["id"]),Ue("linearGradient",{id:`linearGradient-2-${b(o)}`,x1:"0%",y1:"9.5%",x2:"100%",y2:"90.5%"},[Ue("stop",{"stop-color":`var(${b(t).cssVarBlockName("fill-color-1")})`,offset:"0%"},null,8,["stop-color"]),Ue("stop",{"stop-color":`var(${b(t).cssVarBlockName("fill-color-6")})`,offset:"100%"},null,8,["stop-color"])],8,["id"]),Ue("rect",{id:`path-3-${b(o)}`,x:"0",y:"0",width:"17",height:"36"},null,8,["id"])]),Ue("g",{id:"Illustrations",stroke:"none","stroke-width":"1",fill:"none","fill-rule":"evenodd"},[Ue("g",{id:"B-type",transform:"translate(-1268.000000, -535.000000)"},[Ue("g",{id:"Group-2",transform:"translate(1268.000000, 535.000000)"},[Ue("path",{id:"Oval-Copy-2",d:"M39.5,86 C61.3152476,86 79,83.9106622 79,81.3333333 C79,78.7560045 57.3152476,78 35.5,78 C13.6847524,78 0,78.7560045 0,81.3333333 C0,83.9106622 17.6847524,86 39.5,86 Z",fill:`var(${b(t).cssVarBlockName("fill-color-3")})`},null,8,["fill"]),Ue("polygon",{id:"Rectangle-Copy-14",fill:`var(${b(t).cssVarBlockName("fill-color-7")})`,transform:"translate(27.500000, 51.500000) scale(1, -1) translate(-27.500000, -51.500000) ",points:"13 58 53 58 42 45 2 45"},null,8,["fill"]),Ue("g",{id:"Group-Copy",transform:"translate(34.500000, 31.500000) scale(-1, 1) rotate(-25.000000) translate(-34.500000, -31.500000) translate(7.000000, 10.000000)"},[Ue("polygon",{id:"Rectangle-Copy-10",fill:`var(${b(t).cssVarBlockName("fill-color-7")})`,transform:"translate(11.500000, 5.000000) scale(1, -1) translate(-11.500000, -5.000000) ",points:"2.84078316e-14 3 18 3 23 7 5 7"},null,8,["fill"]),Ue("polygon",{id:"Rectangle-Copy-11",fill:`var(${b(t).cssVarBlockName("fill-color-5")})`,points:"-3.69149156e-15 7 38 7 38 43 -3.69149156e-15 43"},null,8,["fill"]),Ue("rect",{id:"Rectangle-Copy-12",fill:`url(#linearGradient-1-${b(o)})`,transform:"translate(46.500000, 25.000000) scale(-1, 1) translate(-46.500000, -25.000000) ",x:"38",y:"7",width:"17",height:"36"},null,8,["fill"]),Ue("polygon",{id:"Rectangle-Copy-13",fill:`var(${b(t).cssVarBlockName("fill-color-2")})`,transform:"translate(39.500000, 3.500000) scale(-1, 1) translate(-39.500000, -3.500000) ",points:"24 7 41 7 55 -3.63806207e-12 38 -3.63806207e-12"},null,8,["fill"])]),Ue("rect",{id:"Rectangle-Copy-15",fill:`url(#linearGradient-2-${b(o)})`,x:"13",y:"45",width:"40",height:"36"},null,8,["fill"]),Ue("g",{id:"Rectangle-Copy-17",transform:"translate(53.000000, 45.000000)"},[Ue("use",{id:"Mask",fill:`var(${b(t).cssVarBlockName("fill-color-8")})`,transform:"translate(8.500000, 18.000000) scale(-1, 1) translate(-8.500000, -18.000000) ","xlink:href":`#path-3-${b(o)}`},null,8,["fill","xlink:href"]),Ue("polygon",{id:"Rectangle-Copy",fill:`var(${b(t).cssVarBlockName("fill-color-9")})`,mask:`url(#mask-4-${b(o)})`,transform:"translate(12.000000, 9.000000) scale(-1, 1) translate(-12.000000, -9.000000) ",points:"7 0 24 0 20 18 7 16.5"},null,8,["fill","mask"])]),Ue("polygon",{id:"Rectangle-Copy-18",fill:`var(${b(t).cssVarBlockName("fill-color-2")})`,transform:"translate(66.000000, 51.500000) scale(-1, 1) translate(-66.000000, -51.500000) ",points:"62 45 79 45 70 58 53 58"},null,8,["fill"])])])])]))}});var Ure=dn($re,[["__file","img-empty.vue"]]);const jre=un({image:{type:String,default:""},imageSize:Number,description:{type:String,default:""}}),Hre=We({name:"ElEmpty"}),Gre=We({...Hre,props:jre,setup(e){const t=e,{t:o}=qr(),a=Xt("empty"),d=ee(()=>t.description||o("el.table.emptyText")),p=ee(()=>({width:_o(t.imageSize)}));return(y,r)=>(ae(),Pe("div",{class:fe(b(a).b())},[Ue("div",{class:fe(b(a).e("image")),style:Un(b(p))},[y.image?(ae(),Pe("img",{key:0,src:y.image,ondragstart:"return false"},null,8,["src"])):gt(y.$slots,"image",{key:1},()=>[qe(Ure)])],6),Ue("div",{class:fe(b(a).e("description"))},[y.$slots.description?gt(y.$slots,"description",{key:0}):(ae(),Pe("p",{key:1},fn(b(d)),1))],2),y.$slots.default?(ae(),Pe("div",{key:0,class:fe(b(a).e("bottom"))},[gt(y.$slots,"default")],2)):bt("v-if",!0)],2))}});var Wre=dn(Gre,[["__file","empty.vue"]]);const TF=lr(Wre),qre=un({size:{type:String,values:ju},disabled:Boolean}),Kre=un({...qre,model:Object,rules:{type:lt(Object)},labelPosition:{type:String,values:["left","right","top"],default:"right"},requireAsteriskPosition:{type:String,values:["left","right"],default:"left"},labelWidth:{type:[String,Number],default:""},labelSuffix:{type:String,default:""},inline:Boolean,inlineMessage:Boolean,statusIcon:Boolean,showMessage:{type:Boolean,default:!0},validateOnRuleChange:{type:Boolean,default:!0},hideRequiredAsterisk:Boolean,scrollToError:Boolean,scrollIntoViewOptions:{type:[Object,Boolean]}}),Zre={validate:(e,t,o)=>(sn(e)||Nn(e))&&Oi(t)&&Nn(o)};function Yre(){const e=xe([]),t=ee(()=>{if(!e.value.length)return"0";const p=Math.max(...e.value);return p?`${p}px`:""});function o(p){const y=e.value.indexOf(p);return y===-1&&t.value,y}function a(p,y){if(p&&y){const r=o(y);e.value.splice(r,1,p)}else p&&e.value.push(p)}function d(p){const y=o(p);y>-1&&e.value.splice(y,1)}return{autoLabelWidth:t,registerLabelWidth:a,deregisterLabelWidth:d}}const Rb=(e,t)=>{const o=Fs(t);return o.length>0?e.filter(a=>a.prop&&o.includes(a.prop)):e},Xre="ElForm",Jre=We({name:Xre}),Qre=We({...Jre,props:Kre,emits:Zre,setup(e,{expose:t,emit:o}){const a=e,d=[],p=Ro(),y=Xt("form"),r=ee(()=>{const{labelPosition:Z,inline:q}=a;return[y.b(),y.m(p.value||"default"),{[y.m(`label-${Z}`)]:Z,[y.m("inline")]:q}]}),S=Z=>d.find(q=>q.prop===Z),C=Z=>{d.push(Z)},M=Z=>{Z.prop&&d.splice(d.indexOf(Z),1)},P=(Z=[])=>{a.model&&Rb(d,Z).forEach(q=>q.resetField())},z=(Z=[])=>{Rb(d,Z).forEach(q=>q.clearValidate())},F=ee(()=>!!a.model),V=Z=>{if(d.length===0)return[];const q=Rb(d,Z);return q.length?q:[]},N=async Z=>U(void 0,Z),H=async(Z=[])=>{if(!F.value)return!1;const q=V(Z);if(q.length===0)return!0;let J={};for(const re of q)try{await re.validate("")}catch(se){J={...J,...se}}return Object.keys(J).length===0?!0:Promise.reject(J)},U=async(Z=[],q)=>{const J=!$n(q);try{const re=await H(Z);return re===!0&&await(q==null?void 0:q(re)),re}catch(re){if(re instanceof Error)throw re;const se=re;return a.scrollToError&&te(Object.keys(se)[0]),await(q==null?void 0:q(!1,se)),J&&Promise.reject(se)}},te=Z=>{var q;const J=Rb(d,Z)[0];J&&((q=J.$el)==null||q.scrollIntoView(a.scrollIntoViewOptions))};return Wt(()=>a.rules,()=>{a.validateOnRuleChange&&N().catch(Z=>void 0)},{deep:!0}),Vr(Rh,si({...Go(a),emit:o,resetFields:P,clearValidate:z,validateField:U,getField:S,addField:C,removeField:M,...Yre()})),t({validate:N,validateField:U,resetFields:P,clearValidate:z,scrollToField:te,fields:d}),(Z,q)=>(ae(),Pe("form",{class:fe(b(r))},[gt(Z.$slots,"default")],2))}});var eie=dn(Qre,[["__file","form.vue"]]);function uh(){return uh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var a in o)Object.prototype.hasOwnProperty.call(o,a)&&(e[a]=o[a])}return e},uh.apply(this,arguments)}function tie(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,Vy(e,t)}function _T(e){return _T=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(o){return o.__proto__||Object.getPrototypeOf(o)},_T(e)}function Vy(e,t){return Vy=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,d){return a.__proto__=d,a},Vy(e,t)}function nie(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Jb(e,t,o){return nie()?Jb=Reflect.construct.bind():Jb=function(d,p,y){var r=[null];r.push.apply(r,p);var S=Function.bind.apply(d,r),C=new S;return y&&Vy(C,y.prototype),C},Jb.apply(null,arguments)}function rie(e){return Function.toString.call(e).indexOf("[native code]")!==-1}function yT(e){var t=typeof Map=="function"?new Map:void 0;return yT=function(a){if(a===null||!rie(a))return a;if(typeof a!="function")throw new TypeError("Super expression must either be null or a function");if(typeof t<"u"){if(t.has(a))return t.get(a);t.set(a,d)}function d(){return Jb(a,arguments,_T(this).constructor)}return d.prototype=Object.create(a.prototype,{constructor:{value:d,enumerable:!1,writable:!0,configurable:!0}}),Vy(d,a)},yT(e)}var iie=/%[sdj%]/g,oie=function(){};function vT(e){if(!e||!e.length)return null;var t={};return e.forEach(function(o){var a=o.field;t[a]=t[a]||[],t[a].push(o)}),t}function ja(e){for(var t=arguments.length,o=new Array(t>1?t-1:0),a=1;a<t;a++)o[a-1]=arguments[a];var d=0,p=o.length;if(typeof e=="function")return e.apply(null,o);if(typeof e=="string"){var y=e.replace(iie,function(r){if(r==="%%")return"%";if(d>=p)return r;switch(r){case"%s":return String(o[d++]);case"%d":return Number(o[d++]);case"%j":try{return JSON.stringify(o[d++])}catch{return"[Circular]"}break;default:return r}});return y}return e}function sie(e){return e==="string"||e==="url"||e==="hex"||e==="email"||e==="date"||e==="pattern"}function is(e,t){return!!(e==null||t==="array"&&Array.isArray(e)&&!e.length||sie(t)&&typeof e=="string"&&!e)}function aie(e,t,o){var a=[],d=0,p=e.length;function y(r){a.push.apply(a,r||[]),d++,d===p&&o(a)}e.forEach(function(r){t(r,y)})}function IR(e,t,o){var a=0,d=e.length;function p(y){if(y&&y.length){o(y);return}var r=a;a=a+1,r<d?t(e[r],p):o([])}p([])}function lie(e){var t=[];return Object.keys(e).forEach(function(o){t.push.apply(t,e[o]||[])}),t}var AR=function(e){tie(t,e);function t(o,a){var d;return d=e.call(this,"Async Validation Error")||this,d.errors=o,d.fields=a,d}return t}(yT(Error));function uie(e,t,o,a,d){if(t.first){var p=new Promise(function(z,F){var V=function(U){return a(U),U.length?F(new AR(U,vT(U))):z(d)},N=lie(e);IR(N,o,V)});return p.catch(function(z){return z}),p}var y=t.firstFields===!0?Object.keys(e):t.firstFields||[],r=Object.keys(e),S=r.length,C=0,M=[],P=new Promise(function(z,F){var V=function(H){if(M.push.apply(M,H),C++,C===S)return a(M),M.length?F(new AR(M,vT(M))):z(d)};r.length||(a(M),z(d)),r.forEach(function(N){var H=e[N];y.indexOf(N)!==-1?IR(H,o,V):aie(H,o,V)})});return P.catch(function(z){return z}),P}function cie(e){return!!(e&&e.message!==void 0)}function die(e,t){for(var o=e,a=0;a<t.length;a++){if(o==null)return o;o=o[t[a]]}return o}function kR(e,t){return function(o){var a;return e.fullFields?a=die(t,e.fullFields):a=t[o.field||e.fullField],cie(o)?(o.field=o.field||e.fullField,o.fieldValue=a,o):{message:typeof o=="function"?o():o,fieldValue:a,field:o.field||e.fullField}}}function PR(e,t){if(t){for(var o in t)if(t.hasOwnProperty(o)){var a=t[o];typeof a=="object"&&typeof e[o]=="object"?e[o]=uh({},e[o],a):e[o]=a}}return e}var CF=function(t,o,a,d,p,y){t.required&&(!a.hasOwnProperty(t.field)||is(o,y||t.type))&&d.push(ja(p.messages.required,t.fullField))},fie=function(t,o,a,d,p){(/^\s+$/.test(o)||o==="")&&d.push(ja(p.messages.whitespace,t.fullField))},Ob,hie=function(){if(Ob)return Ob;var e="[a-fA-F\\d:]",t=function(q){return q&&q.includeBoundaries?"(?:(?<=\\s|^)(?="+e+")|(?<="+e+")(?=\\s|$))":""},o="(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}",a="[a-fA-F\\d]{1,4}",d=(`
(?:
(?:`+a+":){7}(?:"+a+`|:)|                                    // 1:2:3:4:5:6:7::  1:2:3:4:5:6:7:8
(?:`+a+":){6}(?:"+o+"|:"+a+`|:)|                             // 1:2:3:4:5:6::    1:2:3:4:5:6::8   1:2:3:4:5:6::8  1:2:3:4:5:6::1.2.3.4
(?:`+a+":){5}(?::"+o+"|(?::"+a+`){1,2}|:)|                   // 1:2:3:4:5::      1:2:3:4:5::7:8   1:2:3:4:5::8    1:2:3:4:5::7:1.2.3.4
(?:`+a+":){4}(?:(?::"+a+"){0,1}:"+o+"|(?::"+a+`){1,3}|:)| // 1:2:3:4::        1:2:3:4::6:7:8   1:2:3:4::8      1:2:3:4::6:7:1.2.3.4
(?:`+a+":){3}(?:(?::"+a+"){0,2}:"+o+"|(?::"+a+`){1,4}|:)| // 1:2:3::          1:2:3::5:6:7:8   1:2:3::8        1:2:3::5:6:7:1.2.3.4
(?:`+a+":){2}(?:(?::"+a+"){0,3}:"+o+"|(?::"+a+`){1,5}|:)| // 1:2::            1:2::4:5:6:7:8   1:2::8          1:2::4:5:6:7:1.2.3.4
(?:`+a+":){1}(?:(?::"+a+"){0,4}:"+o+"|(?::"+a+`){1,6}|:)| // 1::              1::3:4:5:6:7:8   1::8            1::3:4:5:6:7:1.2.3.4
(?::(?:(?::`+a+"){0,5}:"+o+"|(?::"+a+`){1,7}|:))             // ::2:3:4:5:6:7:8  ::2:3:4:5:6:7:8  ::8             ::1.2.3.4
)(?:%[0-9a-zA-Z]{1,})?                                             // %eth0            %1
`).replace(/\s*\/\/.*$/gm,"").replace(/\n/g,"").trim(),p=new RegExp("(?:^"+o+"$)|(?:^"+d+"$)"),y=new RegExp("^"+o+"$"),r=new RegExp("^"+d+"$"),S=function(q){return q&&q.exact?p:new RegExp("(?:"+t(q)+o+t(q)+")|(?:"+t(q)+d+t(q)+")","g")};S.v4=function(Z){return Z&&Z.exact?y:new RegExp(""+t(Z)+o+t(Z),"g")},S.v6=function(Z){return Z&&Z.exact?r:new RegExp(""+t(Z)+d+t(Z),"g")};var C="(?:(?:[a-z]+:)?//)",M="(?:\\S+(?::\\S*)?@)?",P=S.v4().source,z=S.v6().source,F="(?:(?:[a-z\\u00a1-\\uffff0-9][-_]*)*[a-z\\u00a1-\\uffff0-9]+)",V="(?:\\.(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)*",N="(?:\\.(?:[a-z\\u00a1-\\uffff]{2,}))",H="(?::\\d{2,5})?",U='(?:[/?#][^\\s"]*)?',te="(?:"+C+"|www\\.)"+M+"(?:localhost|"+P+"|"+z+"|"+F+V+N+")"+H+U;return Ob=new RegExp("(?:^"+te+"$)","i"),Ob},RR={email:/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+\.)+[a-zA-Z\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]{2,}))$/,hex:/^#?([a-f0-9]{6}|[a-f0-9]{3})$/i},ny={integer:function(t){return ny.number(t)&&parseInt(t,10)===t},float:function(t){return ny.number(t)&&!ny.integer(t)},array:function(t){return Array.isArray(t)},regexp:function(t){if(t instanceof RegExp)return!0;try{return!!new RegExp(t)}catch{return!1}},date:function(t){return typeof t.getTime=="function"&&typeof t.getMonth=="function"&&typeof t.getYear=="function"&&!isNaN(t.getTime())},number:function(t){return isNaN(t)?!1:typeof t=="number"},object:function(t){return typeof t=="object"&&!ny.array(t)},method:function(t){return typeof t=="function"},email:function(t){return typeof t=="string"&&t.length<=320&&!!t.match(RR.email)},url:function(t){return typeof t=="string"&&t.length<=2048&&!!t.match(hie())},hex:function(t){return typeof t=="string"&&!!t.match(RR.hex)}},pie=function(t,o,a,d,p){if(t.required&&o===void 0){CF(t,o,a,d,p);return}var y=["integer","float","array","regexp","object","method","email","number","date","url","hex"],r=t.type;y.indexOf(r)>-1?ny[r](o)||d.push(ja(p.messages.types[r],t.fullField,t.type)):r&&typeof o!==t.type&&d.push(ja(p.messages.types[r],t.fullField,t.type))},mie=function(t,o,a,d,p){var y=typeof t.len=="number",r=typeof t.min=="number",S=typeof t.max=="number",C=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,M=o,P=null,z=typeof o=="number",F=typeof o=="string",V=Array.isArray(o);if(z?P="number":F?P="string":V&&(P="array"),!P)return!1;V&&(M=o.length),F&&(M=o.replace(C,"_").length),y?M!==t.len&&d.push(ja(p.messages[P].len,t.fullField,t.len)):r&&!S&&M<t.min?d.push(ja(p.messages[P].min,t.fullField,t.min)):S&&!r&&M>t.max?d.push(ja(p.messages[P].max,t.fullField,t.max)):r&&S&&(M<t.min||M>t.max)&&d.push(ja(p.messages[P].range,t.fullField,t.min,t.max))},lm="enum",gie=function(t,o,a,d,p){t[lm]=Array.isArray(t[lm])?t[lm]:[],t[lm].indexOf(o)===-1&&d.push(ja(p.messages[lm],t.fullField,t[lm].join(", ")))},_ie=function(t,o,a,d,p){if(t.pattern){if(t.pattern instanceof RegExp)t.pattern.lastIndex=0,t.pattern.test(o)||d.push(ja(p.messages.pattern.mismatch,t.fullField,o,t.pattern));else if(typeof t.pattern=="string"){var y=new RegExp(t.pattern);y.test(o)||d.push(ja(p.messages.pattern.mismatch,t.fullField,o,t.pattern))}}},Vi={required:CF,whitespace:fie,type:pie,range:mie,enum:gie,pattern:_ie},yie=function(t,o,a,d,p){var y=[],r=t.required||!t.required&&d.hasOwnProperty(t.field);if(r){if(is(o,"string")&&!t.required)return a();Vi.required(t,o,d,y,p,"string"),is(o,"string")||(Vi.type(t,o,d,y,p),Vi.range(t,o,d,y,p),Vi.pattern(t,o,d,y,p),t.whitespace===!0&&Vi.whitespace(t,o,d,y,p))}a(y)},vie=function(t,o,a,d,p){var y=[],r=t.required||!t.required&&d.hasOwnProperty(t.field);if(r){if(is(o)&&!t.required)return a();Vi.required(t,o,d,y,p),o!==void 0&&Vi.type(t,o,d,y,p)}a(y)},bie=function(t,o,a,d,p){var y=[],r=t.required||!t.required&&d.hasOwnProperty(t.field);if(r){if(o===""&&(o=void 0),is(o)&&!t.required)return a();Vi.required(t,o,d,y,p),o!==void 0&&(Vi.type(t,o,d,y,p),Vi.range(t,o,d,y,p))}a(y)},xie=function(t,o,a,d,p){var y=[],r=t.required||!t.required&&d.hasOwnProperty(t.field);if(r){if(is(o)&&!t.required)return a();Vi.required(t,o,d,y,p),o!==void 0&&Vi.type(t,o,d,y,p)}a(y)},wie=function(t,o,a,d,p){var y=[],r=t.required||!t.required&&d.hasOwnProperty(t.field);if(r){if(is(o)&&!t.required)return a();Vi.required(t,o,d,y,p),is(o)||Vi.type(t,o,d,y,p)}a(y)},Sie=function(t,o,a,d,p){var y=[],r=t.required||!t.required&&d.hasOwnProperty(t.field);if(r){if(is(o)&&!t.required)return a();Vi.required(t,o,d,y,p),o!==void 0&&(Vi.type(t,o,d,y,p),Vi.range(t,o,d,y,p))}a(y)},Tie=function(t,o,a,d,p){var y=[],r=t.required||!t.required&&d.hasOwnProperty(t.field);if(r){if(is(o)&&!t.required)return a();Vi.required(t,o,d,y,p),o!==void 0&&(Vi.type(t,o,d,y,p),Vi.range(t,o,d,y,p))}a(y)},Cie=function(t,o,a,d,p){var y=[],r=t.required||!t.required&&d.hasOwnProperty(t.field);if(r){if(o==null&&!t.required)return a();Vi.required(t,o,d,y,p,"array"),o!=null&&(Vi.type(t,o,d,y,p),Vi.range(t,o,d,y,p))}a(y)},Eie=function(t,o,a,d,p){var y=[],r=t.required||!t.required&&d.hasOwnProperty(t.field);if(r){if(is(o)&&!t.required)return a();Vi.required(t,o,d,y,p),o!==void 0&&Vi.type(t,o,d,y,p)}a(y)},Mie="enum",Iie=function(t,o,a,d,p){var y=[],r=t.required||!t.required&&d.hasOwnProperty(t.field);if(r){if(is(o)&&!t.required)return a();Vi.required(t,o,d,y,p),o!==void 0&&Vi[Mie](t,o,d,y,p)}a(y)},Aie=function(t,o,a,d,p){var y=[],r=t.required||!t.required&&d.hasOwnProperty(t.field);if(r){if(is(o,"string")&&!t.required)return a();Vi.required(t,o,d,y,p),is(o,"string")||Vi.pattern(t,o,d,y,p)}a(y)},kie=function(t,o,a,d,p){var y=[],r=t.required||!t.required&&d.hasOwnProperty(t.field);if(r){if(is(o,"date")&&!t.required)return a();if(Vi.required(t,o,d,y,p),!is(o,"date")){var S;o instanceof Date?S=o:S=new Date(o),Vi.type(t,S,d,y,p),S&&Vi.range(t,S.getTime(),d,y,p)}}a(y)},Pie=function(t,o,a,d,p){var y=[],r=Array.isArray(o)?"array":typeof o;Vi.required(t,o,d,y,p,r),a(y)},fS=function(t,o,a,d,p){var y=t.type,r=[],S=t.required||!t.required&&d.hasOwnProperty(t.field);if(S){if(is(o,y)&&!t.required)return a();Vi.required(t,o,d,r,p,y),is(o,y)||Vi.type(t,o,d,r,p)}a(r)},Rie=function(t,o,a,d,p){var y=[],r=t.required||!t.required&&d.hasOwnProperty(t.field);if(r){if(is(o)&&!t.required)return a();Vi.required(t,o,d,y,p)}a(y)},yy={string:yie,method:vie,number:bie,boolean:xie,regexp:wie,integer:Sie,float:Tie,array:Cie,object:Eie,enum:Iie,pattern:Aie,date:kie,url:fS,hex:fS,email:fS,required:Pie,any:Rie};function bT(){return{default:"Validation error on field %s",required:"%s is required",enum:"%s must be one of %s",whitespace:"%s cannot be empty",date:{format:"%s date %s is invalid for format %s",parse:"%s date could not be parsed, %s is invalid ",invalid:"%s date %s is invalid"},types:{string:"%s is not a %s",method:"%s is not a %s (function)",array:"%s is not an %s",object:"%s is not an %s",number:"%s is not a %s",date:"%s is not a %s",boolean:"%s is not a %s",integer:"%s is not an %s",float:"%s is not a %s",regexp:"%s is not a valid %s",email:"%s is not a valid %s",url:"%s is not a valid %s",hex:"%s is not a valid %s"},string:{len:"%s must be exactly %s characters",min:"%s must be at least %s characters",max:"%s cannot be longer than %s characters",range:"%s must be between %s and %s characters"},number:{len:"%s must equal %s",min:"%s cannot be less than %s",max:"%s cannot be greater than %s",range:"%s must be between %s and %s"},array:{len:"%s must be exactly %s in length",min:"%s cannot be less than %s in length",max:"%s cannot be greater than %s in length",range:"%s must be between %s and %s in length"},pattern:{mismatch:"%s value %s does not match pattern %s"},clone:function(){var t=JSON.parse(JSON.stringify(this));return t.clone=this.clone,t}}}var xT=bT(),hv=function(){function e(o){this.rules=null,this._messages=xT,this.define(o)}var t=e.prototype;return t.define=function(a){var d=this;if(!a)throw new Error("Cannot configure a schema with no rules");if(typeof a!="object"||Array.isArray(a))throw new Error("Rules must be an object");this.rules={},Object.keys(a).forEach(function(p){var y=a[p];d.rules[p]=Array.isArray(y)?y:[y]})},t.messages=function(a){return a&&(this._messages=PR(bT(),a)),this._messages},t.validate=function(a,d,p){var y=this;d===void 0&&(d={}),p===void 0&&(p=function(){});var r=a,S=d,C=p;if(typeof S=="function"&&(C=S,S={}),!this.rules||Object.keys(this.rules).length===0)return C&&C(null,r),Promise.resolve(r);function M(N){var H=[],U={};function te(q){if(Array.isArray(q)){var J;H=(J=H).concat.apply(J,q)}else H.push(q)}for(var Z=0;Z<N.length;Z++)te(N[Z]);H.length?(U=vT(H),C(H,U)):C(null,r)}if(S.messages){var P=this.messages();P===xT&&(P=bT()),PR(P,S.messages),S.messages=P}else S.messages=this.messages();var z={},F=S.keys||Object.keys(this.rules);F.forEach(function(N){var H=y.rules[N],U=r[N];H.forEach(function(te){var Z=te;typeof Z.transform=="function"&&(r===a&&(r=uh({},r)),U=r[N]=Z.transform(U)),typeof Z=="function"?Z={validator:Z}:Z=uh({},Z),Z.validator=y.getValidationMethod(Z),Z.validator&&(Z.field=N,Z.fullField=Z.fullField||N,Z.type=y.getType(Z),z[N]=z[N]||[],z[N].push({rule:Z,value:U,source:r,field:N}))})});var V={};return uie(z,S,function(N,H){var U=N.rule,te=(U.type==="object"||U.type==="array")&&(typeof U.fields=="object"||typeof U.defaultField=="object");te=te&&(U.required||!U.required&&N.value),U.field=N.field;function Z(re,se){return uh({},se,{fullField:U.fullField+"."+re,fullFields:U.fullFields?[].concat(U.fullFields,[re]):[re]})}function q(re){re===void 0&&(re=[]);var se=Array.isArray(re)?re:[re];!S.suppressWarning&&se.length&&e.warning("async-validator:",se),se.length&&U.message!==void 0&&(se=[].concat(U.message));var he=se.map(kR(U,r));if(S.first&&he.length)return V[U.field]=1,H(he);if(!te)H(he);else{if(U.required&&!N.value)return U.message!==void 0?he=[].concat(U.message).map(kR(U,r)):S.error&&(he=[S.error(U,ja(S.messages.required,U.field))]),H(he);var le={};U.defaultField&&Object.keys(N.value).map(function(de){le[de]=U.defaultField}),le=uh({},le,N.rule.fields);var ce={};Object.keys(le).forEach(function(de){var Ie=le[de],Ve=Array.isArray(Ie)?Ie:[Ie];ce[de]=Ve.map(Z.bind(null,de))});var pe=new e(ce);pe.messages(S.messages),N.rule.options&&(N.rule.options.messages=S.messages,N.rule.options.error=S.error),pe.validate(N.value,N.rule.options||S,function(de){var Ie=[];he&&he.length&&Ie.push.apply(Ie,he),de&&de.length&&Ie.push.apply(Ie,de),H(Ie.length?Ie:null)})}}var J;if(U.asyncValidator)J=U.asyncValidator(U,N.value,q,N.source,S);else if(U.validator){try{J=U.validator(U,N.value,q,N.source,S)}catch(re){console.error==null||console.error(re),S.suppressValidatorError||setTimeout(function(){throw re},0),q(re.message)}J===!0?q():J===!1?q(typeof U.message=="function"?U.message(U.fullField||U.field):U.message||(U.fullField||U.field)+" fails"):J instanceof Array?q(J):J instanceof Error&&q(J.message)}J&&J.then&&J.then(function(){return q()},function(re){return q(re)})},function(N){M(N)},r)},t.getType=function(a){if(a.type===void 0&&a.pattern instanceof RegExp&&(a.type="pattern"),typeof a.validator!="function"&&a.type&&!yy.hasOwnProperty(a.type))throw new Error(ja("Unknown rule type %s",a.type));return a.type||"string"},t.getValidationMethod=function(a){if(typeof a.validator=="function")return a.validator;var d=Object.keys(a),p=d.indexOf("message");return p!==-1&&d.splice(p,1),d.length===1&&d[0]==="required"?yy.required:yy[this.getType(a)]||void 0},e}();hv.register=function(t,o){if(typeof o!="function")throw new Error("Cannot register a validator by type, validator is not a function");yy[t]=o};hv.warning=oie;hv.messages=xT;hv.validators=yy;const Oie=["","error","validating","success"],Lie=un({label:String,labelWidth:{type:[String,Number],default:""},labelPosition:{type:String,values:["left","right","top",""],default:""},prop:{type:lt([String,Array])},required:{type:Boolean,default:void 0},rules:{type:lt([Object,Array])},error:String,validateStatus:{type:String,values:Oie},for:String,inlineMessage:{type:[String,Boolean],default:""},showMessage:{type:Boolean,default:!0},size:{type:String,values:ju}}),OR="ElLabelWrap";var Die=We({name:OR,props:{isAutoWidth:Boolean,updateAll:Boolean},setup(e,{slots:t}){const o=Pn(Rh,void 0),a=Pn(Nu);a||No(OR,"usage: <el-form-item><label-wrap /></el-form-item>");const d=Xt("form"),p=xe(),y=xe(0),r=()=>{var M;if((M=p.value)!=null&&M.firstElementChild){const P=window.getComputedStyle(p.value.firstElementChild).width;return Math.ceil(Number.parseFloat(P))}else return 0},S=(M="update")=>{jn(()=>{t.default&&e.isAutoWidth&&(M==="update"?y.value=r():M==="remove"&&(o==null||o.deregisterLabelWidth(y.value)))})},C=()=>S("update");return yr(()=>{C()}),Li(()=>{S("remove")}),Uu(()=>C()),Wt(y,(M,P)=>{e.updateAll&&(o==null||o.registerLabelWidth(M,P))}),ro(ee(()=>{var M,P;return(P=(M=p.value)==null?void 0:M.firstElementChild)!=null?P:null}),C),()=>{var M,P;if(!t)return null;const{isAutoWidth:z}=e;if(z){const F=o==null?void 0:o.autoLabelWidth,V=a==null?void 0:a.hasLabel,N={};if(V&&F&&F!=="auto"){const H=Math.max(0,Number.parseInt(F,10)-y.value),te=(a.labelPosition||o.labelPosition)==="left"?"marginRight":"marginLeft";H&&(N[te]=`${H}px`)}return qe("div",{ref:p,class:[d.be("item","label-wrap")],style:N},[(M=t.default)==null?void 0:M.call(t)])}else return qe(Vn,{ref:p},[(P=t.default)==null?void 0:P.call(t)])}}});const zie=We({name:"ElFormItem"}),Fie=We({...zie,props:Lie,setup(e,{expose:t}){const o=e,a=Bo(),d=Pn(Rh,void 0),p=Pn(Nu,void 0),y=Ro(void 0,{formItem:!1}),r=Xt("form-item"),S=us().value,C=xe([]),M=xe(""),P=n9(M,100),z=xe(""),F=xe();let V,N=!1;const H=ee(()=>o.labelPosition||(d==null?void 0:d.labelPosition)),U=ee(()=>{if(H.value==="top")return{};const jt=_o(o.labelWidth||(d==null?void 0:d.labelWidth)||"");return jt?{width:jt}:{}}),te=ee(()=>{if(H.value==="top"||d!=null&&d.inline)return{};if(!o.label&&!o.labelWidth&&ce)return{};const jt=_o(o.labelWidth||(d==null?void 0:d.labelWidth)||"");return!o.label&&!a.label?{marginLeft:jt}:{}}),Z=ee(()=>[r.b(),r.m(y.value),r.is("error",M.value==="error"),r.is("validating",M.value==="validating"),r.is("success",M.value==="success"),r.is("required",be.value||o.required),r.is("no-asterisk",d==null?void 0:d.hideRequiredAsterisk),(d==null?void 0:d.requireAsteriskPosition)==="right"?"asterisk-right":"asterisk-left",{[r.m("feedback")]:d==null?void 0:d.statusIcon,[r.m(`label-${H.value}`)]:H.value}]),q=ee(()=>Oi(o.inlineMessage)?o.inlineMessage:(d==null?void 0:d.inlineMessage)||!1),J=ee(()=>[r.e("error"),{[r.em("error","inline")]:q.value}]),re=ee(()=>o.prop?Nn(o.prop)?o.prop:o.prop.join("."):""),se=ee(()=>!!(o.label||a.label)),he=ee(()=>o.for||(C.value.length===1?C.value[0]:void 0)),le=ee(()=>!he.value&&se.value),ce=!!p,pe=ee(()=>{const jt=d==null?void 0:d.model;if(!(!jt||!o.prop))return Wb(jt,o.prop).value}),de=ee(()=>{const{required:jt}=o,Gt=[];o.rules&&Gt.push(...Fs(o.rules));const Ne=d==null?void 0:d.rules;if(Ne&&o.prop){const an=Wb(Ne,o.prop).value;an&&Gt.push(...Fs(an))}if(jt!==void 0){const an=Gt.map((Ae,tt)=>[Ae,tt]).filter(([Ae])=>Object.keys(Ae).includes("required"));if(an.length>0)for(const[Ae,tt]of an)Ae.required!==jt&&(Gt[tt]={...Ae,required:jt});else Gt.push({required:jt})}return Gt}),Ie=ee(()=>de.value.length>0),Ve=jt=>de.value.filter(Ne=>!Ne.trigger||!jt?!0:sn(Ne.trigger)?Ne.trigger.includes(jt):Ne.trigger===jt).map(({trigger:Ne,...an})=>an),be=ee(()=>de.value.some(jt=>jt.required)),ye=ee(()=>{var jt;return P.value==="error"&&o.showMessage&&((jt=d==null?void 0:d.showMessage)!=null?jt:!0)}),Me=ee(()=>`${o.label||""}${(d==null?void 0:d.labelSuffix)||""}`),we=jt=>{M.value=jt},me=jt=>{var Gt,Ne;const{errors:an,fields:Ae}=jt;(!an||!Ae)&&console.error(jt),we("error"),z.value=an?(Ne=(Gt=an==null?void 0:an[0])==null?void 0:Gt.message)!=null?Ne:`${o.prop} is required`:"",d==null||d.emit("validate",o.prop,!1,z.value)},De=()=>{we("success"),d==null||d.emit("validate",o.prop,!0,"")},Ge=async jt=>{const Gt=re.value;return new hv({[Gt]:jt}).validate({[Gt]:pe.value},{firstFields:!0}).then(()=>(De(),!0)).catch(an=>(me(an),Promise.reject(an)))},rt=async(jt,Gt)=>{if(N||!o.prop)return!1;const Ne=$n(Gt);if(!Ie.value)return Gt==null||Gt(!1),!1;const an=Ve(jt);return an.length===0?(Gt==null||Gt(!0),!0):(we("validating"),Ge(an).then(()=>(Gt==null||Gt(!0),!0)).catch(Ae=>{const{fields:tt}=Ae;return Gt==null||Gt(!1,tt),Ne?!1:Promise.reject(tt)}))},Oe=()=>{we(""),z.value="",N=!1},Ct=async()=>{const jt=d==null?void 0:d.model;if(!jt||!o.prop)return;const Gt=Wb(jt,o.prop);N=!0,Gt.value=d3(V),await jn(),Oe(),N=!1},kt=jt=>{C.value.includes(jt)||C.value.push(jt)},Bt=jt=>{C.value=C.value.filter(Gt=>Gt!==jt)};Wt(()=>o.error,jt=>{z.value=jt||"",we(jt?"error":"")},{immediate:!0}),Wt(()=>o.validateStatus,jt=>we(jt||""));const _t=si({...Go(o),$el:F,size:y,validateState:M,labelId:S,inputIds:C,isGroup:le,hasLabel:se,fieldValue:pe,addInputId:kt,removeInputId:Bt,resetField:Ct,clearValidate:Oe,validate:rt});return Vr(Nu,_t),yr(()=>{o.prop&&(d==null||d.addField(_t),V=d3(pe.value))}),Li(()=>{d==null||d.removeField(_t)}),t({size:y,validateMessage:z,validateState:M,validate:rt,clearValidate:Oe,resetField:Ct}),(jt,Gt)=>{var Ne;return ae(),Pe("div",{ref_key:"formItemRef",ref:F,class:fe(b(Z)),role:b(le)?"group":void 0,"aria-labelledby":b(le)?b(S):void 0},[qe(b(Die),{"is-auto-width":b(U).width==="auto","update-all":((Ne=b(d))==null?void 0:Ne.labelWidth)==="auto"},{default:ot(()=>[b(se)?(ae(),At(Ir(b(he)?"label":"div"),{key:0,id:b(S),for:b(he),class:fe(b(r).e("label")),style:Un(b(U))},{default:ot(()=>[gt(jt.$slots,"label",{label:b(Me)},()=>[Nr(fn(b(Me)),1)])]),_:3},8,["id","for","class","style"])):bt("v-if",!0)]),_:3},8,["is-auto-width","update-all"]),Ue("div",{class:fe(b(r).e("content")),style:Un(b(te))},[gt(jt.$slots,"default"),qe(cD,{name:`${b(r).namespace.value}-zoom-in-top`},{default:ot(()=>[b(ye)?gt(jt.$slots,"error",{key:0,error:z.value},()=>[Ue("div",{class:fe(b(J))},fn(z.value),3)]):bt("v-if",!0)]),_:3},8,["name"])],6)],10,["role","aria-labelledby"])}}});var EF=dn(Fie,[["__file","form-item.vue"]]);const Nie=lr(eie,{FormItem:EF}),Bie=oo(EF),Vie=un({urlList:{type:lt(Array),default:()=>io([])},zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},hideOnClickModal:Boolean,teleported:Boolean,closeOnPressEscape:{type:Boolean,default:!0},zoomRate:{type:Number,default:1.2},minScale:{type:Number,default:.2},maxScale:{type:Number,default:7},crossorigin:{type:lt(String)}}),$ie={close:()=>!0,switch:e=>Wn(e),rotate:e=>Wn(e)},Uie=We({name:"ElImageViewer"}),jie=We({...Uie,props:Vie,emits:$ie,setup(e,{expose:t,emit:o}){var a;const d=e,p={CONTAIN:{name:"contain",icon:Ou(_7)},ORIGINAL:{name:"original",icon:Ou(F7)}},{t:y}=qr(),r=Xt("image-viewer"),{nextZIndex:S}=og(),C=xe(),M=xe([]),P=hC(),z=xe(!0),F=xe(d.initialIndex),V=Hi(p.CONTAIN),N=xe({scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}),H=xe((a=d.zIndex)!=null?a:S()),U=ee(()=>{const{urlList:rt}=d;return rt.length<=1}),te=ee(()=>F.value===0),Z=ee(()=>F.value===d.urlList.length-1),q=ee(()=>d.urlList[F.value]),J=ee(()=>[r.e("btn"),r.e("prev"),r.is("disabled",!d.infinite&&te.value)]),re=ee(()=>[r.e("btn"),r.e("next"),r.is("disabled",!d.infinite&&Z.value)]),se=ee(()=>{const{scale:rt,deg:Oe,offsetX:Ct,offsetY:kt,enableTransition:Bt}=N.value;let _t=Ct/rt,jt=kt/rt;const Gt=Oe*Math.PI/180,Ne=Math.cos(Gt),an=Math.sin(Gt);_t=_t*Ne+jt*an,jt=jt*Ne-Ct/rt*an;const Ae={transform:`scale(${rt}) rotate(${Oe}deg) translate(${_t}px, ${jt}px)`,transition:Bt?"transform .3s":""};return V.value.name===p.CONTAIN.name&&(Ae.maxWidth=Ae.maxHeight="100%"),Ae});function he(){ce(),o("close")}function le(){const rt=gh(Ct=>{switch(Ct.code){case Cn.esc:d.closeOnPressEscape&&he();break;case Cn.space:be();break;case Cn.left:Me();break;case Cn.up:me("zoomIn");break;case Cn.right:we();break;case Cn.down:me("zoomOut");break}}),Oe=gh(Ct=>{const kt=Ct.deltaY||Ct.deltaX;me(kt<0?"zoomIn":"zoomOut",{zoomRate:d.zoomRate,enableTransition:!1})});P.run(()=>{Si(document,"keydown",rt),Si(document,"wheel",Oe)})}function ce(){P.stop()}function pe(){z.value=!1}function de(rt){z.value=!1,rt.target.alt=y("el.image.error")}function Ie(rt){if(z.value||rt.button!==0||!C.value)return;N.value.enableTransition=!1;const{offsetX:Oe,offsetY:Ct}=N.value,kt=rt.pageX,Bt=rt.pageY,_t=gh(Gt=>{N.value={...N.value,offsetX:Oe+Gt.pageX-kt,offsetY:Ct+Gt.pageY-Bt}}),jt=Si(document,"mousemove",_t);Si(document,"mouseup",()=>{jt()}),rt.preventDefault()}function Ve(){N.value={scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}}function be(){if(z.value)return;const rt=zm(p),Oe=Object.values(p),Ct=V.value.name,Bt=(Oe.findIndex(_t=>_t.name===Ct)+1)%rt.length;V.value=p[rt[Bt]],Ve()}function ye(rt){const Oe=d.urlList.length;F.value=(rt+Oe)%Oe}function Me(){te.value&&!d.infinite||ye(F.value-1)}function we(){Z.value&&!d.infinite||ye(F.value+1)}function me(rt,Oe={}){if(z.value)return;const{minScale:Ct,maxScale:kt}=d,{zoomRate:Bt,rotateDeg:_t,enableTransition:jt}={zoomRate:d.zoomRate,rotateDeg:90,enableTransition:!0,...Oe};switch(rt){case"zoomOut":N.value.scale>Ct&&(N.value.scale=Number.parseFloat((N.value.scale/Bt).toFixed(3)));break;case"zoomIn":N.value.scale<kt&&(N.value.scale=Number.parseFloat((N.value.scale*Bt).toFixed(3)));break;case"clockwise":N.value.deg+=_t,o("rotate",N.value.deg);break;case"anticlockwise":N.value.deg-=_t,o("rotate",N.value.deg);break}N.value.enableTransition=jt}function De(rt){var Oe;((Oe=rt.detail)==null?void 0:Oe.focusReason)==="pointer"&&rt.preventDefault()}function Ge(){d.closeOnPressEscape&&he()}return Wt(q,()=>{jn(()=>{const rt=M.value[0];rt!=null&&rt.complete||(z.value=!0)})}),Wt(F,rt=>{Ve(),o("switch",rt)}),yr(()=>{le()}),t({setActiveItem:ye}),(rt,Oe)=>(ae(),At(b(lg),{to:"body",disabled:!rt.teleported},{default:ot(()=>[qe(rs,{name:"viewer-fade",appear:""},{default:ot(()=>[Ue("div",{ref_key:"wrapper",ref:C,tabindex:-1,class:fe(b(r).e("wrapper")),style:Un({zIndex:H.value})},[qe(b(ag),{loop:"",trapped:"","focus-trap-el":C.value,"focus-start-el":"container",onFocusoutPrevented:De,onReleaseRequested:Ge},{default:ot(()=>[Ue("div",{class:fe(b(r).e("mask")),onClick:Jn(Ct=>rt.hideOnClickModal&&he(),["self"])},null,10,["onClick"]),bt(" CLOSE "),Ue("span",{class:fe([b(r).e("btn"),b(r).e("close")]),onClick:he},[qe(b(zn),null,{default:ot(()=>[qe(b(Ql))]),_:1})],2),bt(" ARROW "),b(U)?bt("v-if",!0):(ae(),Pe(Vn,{key:0},[Ue("span",{class:fe(b(J)),onClick:Me},[qe(b(zn),null,{default:ot(()=>[qe(b(Yd))]),_:1})],2),Ue("span",{class:fe(b(re)),onClick:we},[qe(b(zn),null,{default:ot(()=>[qe(b(ta))]),_:1})],2)],64)),bt(" ACTIONS "),Ue("div",{class:fe([b(r).e("btn"),b(r).e("actions")])},[Ue("div",{class:fe(b(r).e("actions__inner"))},[qe(b(zn),{onClick:Ct=>me("zoomOut")},{default:ot(()=>[qe(b(Q7))]),_:1},8,["onClick"]),qe(b(zn),{onClick:Ct=>me("zoomIn")},{default:ot(()=>[qe(b(Rz))]),_:1},8,["onClick"]),Ue("i",{class:fe(b(r).e("actions__divider"))},null,2),qe(b(zn),{onClick:be},{default:ot(()=>[(ae(),At(Ir(b(V).icon)))]),_:1}),Ue("i",{class:fe(b(r).e("actions__divider"))},null,2),qe(b(zn),{onClick:Ct=>me("anticlockwise")},{default:ot(()=>[qe(b(O7))]),_:1},8,["onClick"]),qe(b(zn),{onClick:Ct=>me("clockwise")},{default:ot(()=>[qe(b(D7))]),_:1},8,["onClick"])],2)],2),bt(" CANVAS "),Ue("div",{class:fe(b(r).e("canvas"))},[(ae(!0),Pe(Vn,null,Fr(rt.urlList,(Ct,kt)=>hr((ae(),Pe("img",{ref_for:!0,ref:Bt=>M.value[kt]=Bt,key:Ct,src:Ct,style:Un(b(se)),class:fe(b(r).e("img")),crossorigin:rt.crossorigin,onLoad:pe,onError:de,onMousedown:Ie},null,46,["src","crossorigin"])),[[ii,kt===F.value]])),128))],2),gt(rt.$slots,"default")]),_:3},8,["focus-trap-el"])],6)]),_:3})]),_:3},8,["disabled"]))}});var Hie=dn(jie,[["__file","image-viewer.vue"]]);const MF=lr(Hie),Gie=un({hideOnClickModal:Boolean,src:{type:String,default:""},fit:{type:String,values:["","contain","cover","fill","none","scale-down"],default:""},loading:{type:String,values:["eager","lazy"]},lazy:Boolean,scrollContainer:{type:lt([String,Object])},previewSrcList:{type:lt(Array),default:()=>io([])},previewTeleported:Boolean,zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0},zoomRate:{type:Number,default:1.2},minScale:{type:Number,default:.2},maxScale:{type:Number,default:7},crossorigin:{type:lt(String)}}),Wie={load:e=>e instanceof Event,error:e=>e instanceof Event,switch:e=>Wn(e),close:()=>!0,show:()=>!0},qie=We({name:"ElImage",inheritAttrs:!1}),Kie=We({...qie,props:Gie,emits:Wie,setup(e,{emit:t}){const o=e;let a="";const{t:d}=qr(),p=Xt("image"),y=of(),r=ee(()=>Ly(Object.entries(y).filter(([we])=>/^(data-|on[A-Z])/i.test(we)||["id","style"].includes(we)))),S=uv({excludeListeners:!0,excludeKeys:ee(()=>Object.keys(r.value))}),C=xe(),M=xe(!1),P=xe(!0),z=xe(!1),F=xe(),V=xe(),N=Wr&&"loading"in HTMLImageElement.prototype;let H,U;const te=ee(()=>[p.e("inner"),q.value&&p.e("preview"),P.value&&p.is("loading")]),Z=ee(()=>{const{fit:we}=o;return Wr&&we?{objectFit:we}:{}}),q=ee(()=>{const{previewSrcList:we}=o;return sn(we)&&we.length>0}),J=ee(()=>{const{previewSrcList:we,initialIndex:me}=o;let De=me;return me>we.length-1&&(De=0),De}),re=ee(()=>o.loading==="eager"?!1:!N&&o.loading==="lazy"||o.lazy),se=()=>{Wr&&(P.value=!0,M.value=!1,C.value=o.src)};function he(we){P.value=!1,M.value=!1,t("load",we)}function le(we){P.value=!1,M.value=!0,t("error",we)}function ce(){mee(F.value,V.value)&&(se(),Ie())}const pe=dz(ce,200,!0);async function de(){var we;if(!Wr)return;await jn();const{scrollContainer:me}=o;ea(me)?V.value=me:Nn(me)&&me!==""?V.value=(we=document.querySelector(me))!=null?we:void 0:F.value&&(V.value=YC(F.value)),V.value&&(H=Si(V,"scroll",pe),setTimeout(()=>ce(),100))}function Ie(){!Wr||!V.value||!pe||(H==null||H(),V.value=void 0)}function Ve(we){if(we.ctrlKey){if(we.deltaY<0)return we.preventDefault(),!1;if(we.deltaY>0)return we.preventDefault(),!1}}function be(){q.value&&(U=Si("wheel",Ve,{passive:!1}),a=document.body.style.overflow,document.body.style.overflow="hidden",z.value=!0,t("show"))}function ye(){U==null||U(),document.body.style.overflow=a,z.value=!1,t("close")}function Me(we){t("switch",we)}return Wt(()=>o.src,()=>{re.value?(P.value=!0,M.value=!1,Ie(),de()):se()}),yr(()=>{re.value?de():se()}),(we,me)=>(ae(),Pe("div",kr({ref_key:"container",ref:F},b(r),{class:[b(p).b(),we.$attrs.class]}),[M.value?gt(we.$slots,"error",{key:0},()=>[Ue("div",{class:fe(b(p).e("error"))},fn(b(d)("el.image.error")),3)]):(ae(),Pe(Vn,{key:1},[C.value!==void 0?(ae(),Pe("img",kr({key:0},b(S),{src:C.value,loading:we.loading,style:b(Z),class:b(te),crossorigin:we.crossorigin,onClick:be,onLoad:he,onError:le}),null,16,["src","loading","crossorigin"])):bt("v-if",!0),P.value?(ae(),Pe("div",{key:1,class:fe(b(p).e("wrapper"))},[gt(we.$slots,"placeholder",{},()=>[Ue("div",{class:fe(b(p).e("placeholder"))},null,2)])],2)):bt("v-if",!0)],64)),b(q)?(ae(),Pe(Vn,{key:2},[z.value?(ae(),At(b(MF),{key:0,"z-index":we.zIndex,"initial-index":b(J),infinite:we.infinite,"zoom-rate":we.zoomRate,"min-scale":we.minScale,"max-scale":we.maxScale,"url-list":we.previewSrcList,crossorigin:we.crossorigin,"hide-on-click-modal":we.hideOnClickModal,teleported:we.previewTeleported,"close-on-press-escape":we.closeOnPressEscape,onClose:ye,onSwitch:Me},{default:ot(()=>[we.$slots.viewer?(ae(),Pe("div",{key:0},[gt(we.$slots,"viewer")])):bt("v-if",!0)]),_:3},8,["z-index","initial-index","infinite","zoom-rate","min-scale","max-scale","url-list","crossorigin","hide-on-click-modal","teleported","close-on-press-escape"])):bt("v-if",!0)],64)):bt("v-if",!0)],16))}});var Zie=dn(Kie,[["__file","image.vue"]]);const Yie=lr(Zie),Xie=un({id:{type:String,default:void 0},step:{type:Number,default:1},stepStrictly:Boolean,max:{type:Number,default:Number.POSITIVE_INFINITY},min:{type:Number,default:Number.NEGATIVE_INFINITY},modelValue:Number,readonly:Boolean,disabled:Boolean,size:zo,controls:{type:Boolean,default:!0},controlsPosition:{type:String,default:"",values:["","right"]},valueOnClear:{type:[String,Number,null],validator:e=>e===null||Wn(e)||["min","max"].includes(e),default:null},name:String,placeholder:String,precision:{type:Number,validator:e=>e>=0&&e===Number.parseInt(`${e}`,10)},validateEvent:{type:Boolean,default:!0},...cs(["ariaLabel"])}),Jie={[Ii]:(e,t)=>t!==e,blur:e=>e instanceof FocusEvent,focus:e=>e instanceof FocusEvent,[ys]:e=>Wn(e)||Ho(e),[gr]:e=>Wn(e)||Ho(e)},Qie=We({name:"ElInputNumber"}),eoe=We({...Qie,props:Xie,emits:Jie,setup(e,{expose:t,emit:o}){const a=e,{t:d}=qr(),p=Xt("input-number"),y=xe(),r=si({currentValue:a.modelValue,userInput:null}),{formItem:S}=xs(),C=ee(()=>Wn(a.modelValue)&&a.modelValue<=a.min),M=ee(()=>Wn(a.modelValue)&&a.modelValue>=a.max),P=ee(()=>{const be=U(a.step);return ai(a.precision)?Math.max(U(a.modelValue),be):(be>a.precision,a.precision)}),z=ee(()=>a.controls&&a.controlsPosition==="right"),F=Ro(),V=ws(),N=ee(()=>{if(r.userInput!==null)return r.userInput;let be=r.currentValue;if(Ho(be))return"";if(Wn(be)){if(Number.isNaN(be))return"";ai(a.precision)||(be=be.toFixed(a.precision))}return be}),H=(be,ye)=>{if(ai(ye)&&(ye=P.value),ye===0)return Math.round(be);let Me=String(be);const we=Me.indexOf(".");if(we===-1||!Me.replace(".","").split("")[we+ye])return be;const Ge=Me.length;return Me.charAt(Ge-1)==="5"&&(Me=`${Me.slice(0,Math.max(0,Ge-1))}6`),Number.parseFloat(Number(Me).toFixed(ye))},U=be=>{if(Ho(be))return 0;const ye=be.toString(),Me=ye.indexOf(".");let we=0;return Me!==-1&&(we=ye.length-Me-1),we},te=(be,ye=1)=>Wn(be)?H(be+a.step*ye):r.currentValue,Z=()=>{if(a.readonly||V.value||M.value)return;const be=Number(N.value)||0,ye=te(be);re(ye),o(ys,r.currentValue),Ie()},q=()=>{if(a.readonly||V.value||C.value)return;const be=Number(N.value)||0,ye=te(be,-1);re(ye),o(ys,r.currentValue),Ie()},J=(be,ye)=>{const{max:Me,min:we,step:me,precision:De,stepStrictly:Ge,valueOnClear:rt}=a;Me<we&&No("InputNumber","min should not be greater than max.");let Oe=Number(be);if(Ho(be)||Number.isNaN(Oe))return null;if(be===""){if(rt===null)return null;Oe=Nn(rt)?{min:we,max:Me}[rt]:rt}return Ge&&(Oe=H(Math.round(Oe/me)*me,De),Oe!==be&&ye&&o(gr,Oe)),ai(De)||(Oe=H(Oe,De)),(Oe>Me||Oe<we)&&(Oe=Oe>Me?Me:we,ye&&o(gr,Oe)),Oe},re=(be,ye=!0)=>{var Me;const we=r.currentValue,me=J(be);if(!ye){o(gr,me);return}we===me&&be||(r.userInput=null,o(gr,me),we!==me&&o(Ii,me,we),a.validateEvent&&((Me=S==null?void 0:S.validate)==null||Me.call(S,"change").catch(De=>void 0)),r.currentValue=me)},se=be=>{r.userInput=be;const ye=be===""?null:Number(be);o(ys,ye),re(ye,!1)},he=be=>{const ye=be!==""?Number(be):"";(Wn(ye)&&!Number.isNaN(ye)||be==="")&&re(ye),Ie(),r.userInput=null},le=()=>{var be,ye;(ye=(be=y.value)==null?void 0:be.focus)==null||ye.call(be)},ce=()=>{var be,ye;(ye=(be=y.value)==null?void 0:be.blur)==null||ye.call(be)},pe=be=>{o("focus",be)},de=be=>{var ye,Me;r.userInput=null,yx()&&r.currentValue===null&&((ye=y.value)!=null&&ye.input)&&(y.value.input.value=""),o("blur",be),a.validateEvent&&((Me=S==null?void 0:S.validate)==null||Me.call(S,"blur").catch(we=>void 0))},Ie=()=>{r.currentValue!==a.modelValue&&(r.currentValue=a.modelValue)},Ve=be=>{document.activeElement===be.target&&be.preventDefault()};return Wt(()=>a.modelValue,(be,ye)=>{const Me=J(be,!0);r.userInput===null&&Me!==ye&&(r.currentValue=Me)},{immediate:!0}),yr(()=>{var be;const{min:ye,max:Me,modelValue:we}=a,me=(be=y.value)==null?void 0:be.input;if(me.setAttribute("role","spinbutton"),Number.isFinite(Me)?me.setAttribute("aria-valuemax",String(Me)):me.removeAttribute("aria-valuemax"),Number.isFinite(ye)?me.setAttribute("aria-valuemin",String(ye)):me.removeAttribute("aria-valuemin"),me.setAttribute("aria-valuenow",r.currentValue||r.currentValue===0?String(r.currentValue):""),me.setAttribute("aria-disabled",String(V.value)),!Wn(we)&&we!=null){let De=Number(we);Number.isNaN(De)&&(De=null),o(gr,De)}me.addEventListener("wheel",Ve,{passive:!1})}),Uu(()=>{var be,ye;const Me=(be=y.value)==null?void 0:be.input;Me==null||Me.setAttribute("aria-valuenow",`${(ye=r.currentValue)!=null?ye:""}`)}),t({focus:le,blur:ce}),(be,ye)=>(ae(),Pe("div",{class:fe([b(p).b(),b(p).m(b(F)),b(p).is("disabled",b(V)),b(p).is("without-controls",!be.controls),b(p).is("controls-right",b(z))]),onDragstart:Jn(()=>{},["prevent"])},[be.controls?hr((ae(),Pe("span",{key:0,role:"button","aria-label":b(d)("el.inputNumber.decrease"),class:fe([b(p).e("decrease"),b(p).is("disabled",b(C))]),onKeydown:Ri(q,["enter"])},[gt(be.$slots,"decrease-icon",{},()=>[qe(b(zn),null,{default:ot(()=>[b(z)?(ae(),At(b(zc),{key:0})):(ae(),At(b(S7),{key:1}))]),_:1})])],42,["aria-label","onKeydown"])),[[b(E1),q]]):bt("v-if",!0),be.controls?hr((ae(),Pe("span",{key:1,role:"button","aria-label":b(d)("el.inputNumber.increase"),class:fe([b(p).e("increase"),b(p).is("disabled",b(M))]),onKeydown:Ri(Z,["enter"])},[gt(be.$slots,"increase-icon",{},()=>[qe(b(zn),null,{default:ot(()=>[b(z)?(ae(),At(b(JC),{key:0})):(ae(),At(b(kz),{key:1}))]),_:1})])],42,["aria-label","onKeydown"])),[[b(E1),Z]]):bt("v-if",!0),qe(b(Bs),{id:be.id,ref_key:"input",ref:y,type:"number",step:be.step,"model-value":b(N),placeholder:be.placeholder,readonly:be.readonly,disabled:b(V),size:b(F),max:be.max,min:be.min,name:be.name,"aria-label":be.ariaLabel,"validate-event":!1,onKeydown:[Ri(Jn(Z,["prevent"]),["up"]),Ri(Jn(q,["prevent"]),["down"])],onBlur:de,onFocus:pe,onInput:se,onChange:he},cl({_:2},[be.$slots.prefix?{name:"prefix",fn:ot(()=>[gt(be.$slots,"prefix")])}:void 0,be.$slots.suffix?{name:"suffix",fn:ot(()=>[gt(be.$slots,"suffix")])}:void 0]),1032,["id","step","model-value","placeholder","readonly","disabled","size","max","min","name","aria-label","onKeydown"])],42,["onDragstart"]))}});var toe=dn(eoe,[["__file","input-number.vue"]]);const IF=lr(toe),noe=un({modelValue:{type:lt(Array)},max:Number,tagType:{...kc.type,default:"info"},tagEffect:kc.effect,trigger:{type:lt(String),default:Cn.enter},draggable:{type:Boolean,default:!1},size:zo,clearable:Boolean,disabled:{type:Boolean,default:void 0},validateEvent:{type:Boolean,default:!0},readonly:Boolean,autofocus:Boolean,id:{type:String,default:void 0},tabindex:{type:[String,Number],default:0},maxlength:{type:[String,Number]},minlength:{type:[String,Number]},placeholder:String,autocomplete:{type:String,default:"off"},ariaLabel:String}),roe={[gr]:e=>sn(e)||ai(e),[Ii]:e=>sn(e)||ai(e),[ys]:e=>Nn(e),"add-tag":e=>Nn(e),"remove-tag":e=>Nn(e),focus:e=>e instanceof FocusEvent,blur:e=>e instanceof FocusEvent,clear:()=>!0};function ioe({props:e,emit:t,formItem:o}){const a=ws(),d=Ro(),p=Hi(),y=xe(),r=ee(()=>["small"].includes(d.value)?"small":"default"),S=ee(()=>{var le;return(le=e.modelValue)!=null&&le.length?void 0:e.placeholder}),C=ee(()=>!(e.readonly||a.value)),M=ee(()=>{var le,ce;return ai(e.max)?!1:((ce=(le=e.modelValue)==null?void 0:le.length)!=null?ce:0)>=e.max}),P=le=>{if(M.value){y.value=void 0;return}J.value||t(ys,le.target.value)},z=le=>{var ce;if(!J.value)switch(le.code){case e.trigger:le.preventDefault(),le.stopPropagation(),F();break;case Cn.numpadEnter:e.trigger===Cn.enter&&(le.preventDefault(),le.stopPropagation(),F());break;case Cn.backspace:!y.value&&((ce=e.modelValue)!=null&&ce.length)&&(le.preventDefault(),le.stopPropagation(),V(e.modelValue.length-1));break}},F=()=>{var le,ce;const pe=(le=y.value)==null?void 0:le.trim();if(!pe||M.value)return;const de=[...(ce=e.modelValue)!=null?ce:[],pe];t(gr,de),t(Ii,de),t("add-tag",pe),y.value=void 0},V=le=>{var ce;const pe=((ce=e.modelValue)!=null?ce:[]).slice(),[de]=pe.splice(le,1);t(gr,pe),t(Ii,pe),t("remove-tag",de)},N=()=>{y.value=void 0,t(gr,void 0),t(Ii,void 0),t("clear")},H=(le,ce,pe)=>{var de;const Ie=((de=e.modelValue)!=null?de:[]).slice(),[Ve]=Ie.splice(le,1),be=ce>le&&pe==="before"?-1:ce<le&&pe==="after"?1:0;Ie.splice(ce+be,0,Ve),t(gr,Ie),t(Ii,Ie)},U=()=>{var le;(le=p.value)==null||le.focus()},te=()=>{var le;(le=p.value)==null||le.blur()},{wrapperRef:Z,isFocused:q}=af(p,{beforeFocus(){return a.value},afterBlur(){var le;F(),e.validateEvent&&((le=o==null?void 0:o.validate)==null||le.call(o,"blur").catch(ce=>void 0))}}),{isComposing:J,handleCompositionStart:re,handleCompositionUpdate:se,handleCompositionEnd:he}=cv({afterComposition:P});return Wt(()=>e.modelValue,()=>{var le;e.validateEvent&&((le=o==null?void 0:o.validate)==null||le.call(o,Ii).catch(ce=>void 0))}),{inputRef:p,wrapperRef:Z,isFocused:q,isComposing:J,inputValue:y,size:d,tagSize:r,placeholder:S,closable:C,disabled:a,inputLimit:M,handleDragged:H,handleInput:P,handleKeydown:z,handleAddTag:F,handleRemoveTag:V,handleClear:N,handleCompositionStart:re,handleCompositionUpdate:se,handleCompositionEnd:he,focus:U,blur:te}}function ooe(){const e=xe(!1);return{hovering:e,handleMouseEnter:()=>{e.value=!0},handleMouseLeave:()=>{e.value=!1}}}function FE(){const e=Hi(),t=xe(0),o=11,a=ee(()=>({minWidth:`${Math.max(t.value,o)}px`}));return ro(e,()=>{var p,y;t.value=(y=(p=e.value)==null?void 0:p.getBoundingClientRect().width)!=null?y:0}),{calculatorRef:e,calculatorWidth:t,inputStyle:a}}function soe({wrapperRef:e,handleDragged:t,afterDragged:o}){const a=Xt("input-tag"),d=Hi(),p=xe(!1);let y,r,S,C;function M(V){return`.${a.e("inner")} .${a.namespace.value}-tag:nth-child(${V+1})`}function P(V,N){y=N,r=e.value.querySelector(M(N)),r&&(r.style.opacity="0.5"),V.dataTransfer.effectAllowed="move"}function z(V,N){if(S=N,V.preventDefault(),V.dataTransfer.dropEffect="move",ai(y)||y===N){p.value=!1;return}const H=e.value.querySelector(M(N)).getBoundingClientRect(),U=y+1!==N,te=y-1!==N,Z=V.clientX-H.left,q=U?te?.5:1:-1,J=te?U?.5:0:1;Z<=H.width*q?C="before":Z>H.width*J?C="after":C=void 0;const re=e.value.querySelector(`.${a.e("inner")}`),se=re.getBoundingClientRect(),he=Number.parseFloat(Tc(re,"gap"))/2,le=H.top-se.top;let ce=-9999;if(C==="before")ce=Math.max(H.left-se.left-he,Math.floor(-he/2));else if(C==="after"){const pe=H.right-se.left;ce=pe+(se.width===pe?Math.floor(he/2):he)}Tz(d.value,{top:`${le}px`,left:`${ce}px`}),p.value=!!C}function F(V){V.preventDefault(),r&&(r.style.opacity=""),C&&!ai(y)&&!ai(S)&&y!==S&&t(y,S,C),p.value=!1,y=void 0,r=null,S=void 0,C=void 0,o==null||o()}return{dropIndicatorRef:d,showDropIndicator:p,handleDragStart:P,handleDragOver:z,handleDragEnd:F}}function aoe({props:e,isFocused:t,hovering:o,disabled:a,inputValue:d,size:p,validateState:y,validateIcon:r,needStatusIcon:S}){const C=of(),M=Bo(),P=Xt("input-tag"),z=Xt("input"),F=ee(()=>[P.b(),P.is("focused",t.value),P.is("hovering",o.value),P.is("disabled",a.value),P.m(p.value),P.e("wrapper"),C.class]),V=ee(()=>[C.style]),N=ee(()=>{var te,Z;return[P.e("inner"),P.is("draggable",e.draggable),P.is("left-space",!((te=e.modelValue)!=null&&te.length)&&!M.prefix),P.is("right-space",!((Z=e.modelValue)!=null&&Z.length)&&!U.value)]}),H=ee(()=>{var te;return e.clearable&&!a.value&&!e.readonly&&(((te=e.modelValue)==null?void 0:te.length)||d.value)&&(t.value||o.value)}),U=ee(()=>M.suffix||H.value||y.value&&r.value&&S.value);return{ns:P,nsInput:z,containerKls:F,containerStyle:V,innerKls:N,showClear:H,showSuffix:U}}const loe=We({name:"ElInputTag",inheritAttrs:!1}),uoe=We({...loe,props:noe,emits:roe,setup(e,{expose:t,emit:o}){const a=e,d=uv(),p=Bo(),{form:y,formItem:r}=xs(),{inputId:S}=ml(a,{formItemContext:r}),C=ee(()=>{var Ae;return(Ae=y==null?void 0:y.statusIcon)!=null?Ae:!1}),M=ee(()=>(r==null?void 0:r.validateState)||""),P=ee(()=>M.value&&_x[M.value]),{inputRef:z,wrapperRef:F,isFocused:V,inputValue:N,size:H,tagSize:U,placeholder:te,closable:Z,disabled:q,handleDragged:J,handleInput:re,handleKeydown:se,handleRemoveTag:he,handleClear:le,handleCompositionStart:ce,handleCompositionUpdate:pe,handleCompositionEnd:de,focus:Ie,blur:Ve}=ioe({props:a,emit:o,formItem:r}),{hovering:be,handleMouseEnter:ye,handleMouseLeave:Me}=ooe(),{calculatorRef:we,inputStyle:me}=FE(),{dropIndicatorRef:De,showDropIndicator:Ge,handleDragStart:rt,handleDragOver:Oe,handleDragEnd:Ct}=soe({wrapperRef:F,handleDragged:J,afterDragged:Ie}),{ns:kt,nsInput:Bt,containerKls:_t,containerStyle:jt,innerKls:Gt,showClear:Ne,showSuffix:an}=aoe({props:a,hovering:be,isFocused:V,inputValue:N,disabled:q,size:H,validateState:M,validateIcon:P,needStatusIcon:C});return t({focus:Ie,blur:Ve}),(Ae,tt)=>(ae(),Pe("div",{ref_key:"wrapperRef",ref:F,class:fe(b(_t)),style:Un(b(jt)),onMouseenter:b(ye),onMouseleave:b(Me)},[b(p).prefix?(ae(),Pe("div",{key:0,class:fe(b(kt).e("prefix"))},[gt(Ae.$slots,"prefix")],2)):bt("v-if",!0),Ue("div",{class:fe(b(Gt))},[(ae(!0),Pe(Vn,null,Fr(Ae.modelValue,(Je,Jt)=>(ae(),At(b(Um),{key:Jt,size:b(U),closable:b(Z),type:Ae.tagType,effect:Ae.tagEffect,draggable:b(Z)&&Ae.draggable,"disable-transitions":"",onClose:Kt=>b(he)(Jt),onDragstart:Kt=>b(rt)(Kt,Jt),onDragover:Kt=>b(Oe)(Kt,Jt),onDragend:b(Ct),onDrop:Jn(()=>{},["stop"])},{default:ot(()=>[gt(Ae.$slots,"tag",{value:Je,index:Jt},()=>[Nr(fn(Je),1)])]),_:2},1032,["size","closable","type","effect","draggable","onClose","onDragstart","onDragover","onDragend","onDrop"]))),128)),Ue("div",{class:fe(b(kt).e("input-wrapper"))},[hr(Ue("input",kr({id:b(S),ref_key:"inputRef",ref:z,"onUpdate:modelValue":Je=>Ti(N)?N.value=Je:null},b(d),{type:"text",minlength:Ae.minlength,maxlength:Ae.maxlength,disabled:b(q),readonly:Ae.readonly,autocomplete:Ae.autocomplete,tabindex:Ae.tabindex,placeholder:b(te),autofocus:Ae.autofocus,ariaLabel:Ae.ariaLabel,class:b(kt).e("input"),style:b(me),onCompositionstart:b(ce),onCompositionupdate:b(pe),onCompositionend:b(de),onInput:b(re),onKeydown:b(se)}),null,16,["id","onUpdate:modelValue","minlength","maxlength","disabled","readonly","autocomplete","tabindex","placeholder","autofocus","ariaLabel","onCompositionstart","onCompositionupdate","onCompositionend","onInput","onKeydown"]),[[rx,b(N)]]),Ue("span",{ref_key:"calculatorRef",ref:we,"aria-hidden":"true",class:fe(b(kt).e("input-calculator")),textContent:fn(b(N))},null,10,["textContent"])],2),hr(Ue("div",{ref_key:"dropIndicatorRef",ref:De,class:fe(b(kt).e("drop-indicator"))},null,2),[[ii,b(Ge)]])],2),b(an)?(ae(),Pe("div",{key:1,class:fe(b(kt).e("suffix"))},[gt(Ae.$slots,"suffix"),b(Ne)?(ae(),At(b(zn),{key:0,class:fe([b(kt).e("icon"),b(kt).e("clear")]),onMousedown:Jn(b(vi),["prevent"]),onClick:b(le)},{default:ot(()=>[qe(b(Fc))]),_:1},8,["class","onMousedown","onClick"])):bt("v-if",!0),b(M)&&b(P)&&b(C)?(ae(),At(b(zn),{key:1,class:fe([b(Bt).e("icon"),b(Bt).e("validateIcon"),b(Bt).is("loading",b(M)==="validating")])},{default:ot(()=>[(ae(),At(Ir(b(P))))]),_:1},8,["class"])):bt("v-if",!0)],2)):bt("v-if",!0)],46,["onMouseenter","onMouseleave"]))}});var coe=dn(uoe,[["__file","input-tag.vue"]]);const doe=lr(coe),foe=un({type:{type:String,values:["primary","success","warning","info","danger","default"],default:"default"},underline:{type:Boolean,default:!0},disabled:Boolean,href:{type:String,default:""},target:{type:String,default:"_self"},icon:{type:Ai}}),hoe={click:e=>e instanceof MouseEvent},poe=We({name:"ElLink"}),moe=We({...poe,props:foe,emits:hoe,setup(e,{emit:t}){const o=e,a=Xt("link"),d=ee(()=>[a.b(),a.m(o.type),a.is("disabled",o.disabled),a.is("underline",o.underline&&!o.disabled)]);function p(y){o.disabled||t("click",y)}return(y,r)=>(ae(),Pe("a",{class:fe(b(d)),href:y.disabled||!y.href?void 0:y.href,target:y.disabled||!y.href?void 0:y.target,onClick:p},[y.icon?(ae(),At(b(zn),{key:0},{default:ot(()=>[(ae(),At(Ir(y.icon)))]),_:1})):bt("v-if",!0),y.$slots.default?(ae(),Pe("span",{key:1,class:fe(b(a).e("inner"))},[gt(y.$slots,"default")],2)):bt("v-if",!0),y.$slots.icon?gt(y.$slots,"icon",{key:2}):bt("v-if",!0)],10,["href","target"]))}});var goe=dn(moe,[["__file","link.vue"]]);const _oe=lr(goe);let yoe=class{constructor(t,o){this.parent=t,this.domNode=o,this.subIndex=0,this.subIndex=0,this.init()}init(){this.subMenuItems=this.domNode.querySelectorAll("li"),this.addListeners()}gotoSubIndex(t){t===this.subMenuItems.length?t=0:t<0&&(t=this.subMenuItems.length-1),this.subMenuItems[t].focus(),this.subIndex=t}addListeners(){const t=this.parent.domNode;Array.prototype.forEach.call(this.subMenuItems,o=>{o.addEventListener("keydown",a=>{let d=!1;switch(a.code){case Cn.down:{this.gotoSubIndex(this.subIndex+1),d=!0;break}case Cn.up:{this.gotoSubIndex(this.subIndex-1),d=!0;break}case Cn.tab:{qb(t,"mouseleave");break}case Cn.enter:case Cn.numpadEnter:case Cn.space:{d=!0,a.currentTarget.click();break}}return d&&(a.preventDefault(),a.stopPropagation()),!1})})}},voe=class{constructor(t,o){this.domNode=t,this.submenu=null,this.submenu=null,this.init(o)}init(t){this.domNode.setAttribute("tabindex","0");const o=this.domNode.querySelector(`.${t}-menu`);o&&(this.submenu=new yoe(this,o)),this.addListeners()}addListeners(){this.domNode.addEventListener("keydown",t=>{let o=!1;switch(t.code){case Cn.down:{qb(t.currentTarget,"mouseenter"),this.submenu&&this.submenu.gotoSubIndex(0),o=!0;break}case Cn.up:{qb(t.currentTarget,"mouseenter"),this.submenu&&this.submenu.gotoSubIndex(this.submenu.subMenuItems.length-1),o=!0;break}case Cn.tab:{qb(t.currentTarget,"mouseleave");break}case Cn.enter:case Cn.numpadEnter:case Cn.space:{o=!0,t.currentTarget.click();break}}o&&t.preventDefault()})}},boe=class{constructor(t,o){this.domNode=t,this.init(o)}init(t){const o=this.domNode.childNodes;Array.from(o).forEach(a=>{a.nodeType===1&&new voe(a,t)})}};const xoe=We({name:"ElMenuCollapseTransition",setup(){const e=Xt("menu");return{listeners:{onBeforeEnter:o=>o.style.opacity="0.2",onEnter(o,a){ol(o,`${e.namespace.value}-opacity-transition`),o.style.opacity="1",a()},onAfterEnter(o){Vs(o,`${e.namespace.value}-opacity-transition`),o.style.opacity=""},onBeforeLeave(o){o.dataset||(o.dataset={}),wa(o,e.m("collapse"))?(Vs(o,e.m("collapse")),o.dataset.oldOverflow=o.style.overflow,o.dataset.scrollWidth=o.clientWidth.toString(),ol(o,e.m("collapse"))):(ol(o,e.m("collapse")),o.dataset.oldOverflow=o.style.overflow,o.dataset.scrollWidth=o.clientWidth.toString(),Vs(o,e.m("collapse"))),o.style.width=`${o.scrollWidth}px`,o.style.overflow="hidden"},onLeave(o){ol(o,"horizontal-collapse-transition"),o.style.width=`${o.dataset.scrollWidth}px`}}}}});function woe(e,t,o,a,d,p){return ae(),At(rs,kr({mode:"out-in"},e.listeners),{default:ot(()=>[gt(e.$slots,"default")]),_:3},16)}var Soe=dn(xoe,[["render",woe],["__file","menu-collapse-transition.vue"]]);function AF(e,t){const o=ee(()=>{let d=e.parent;const p=[t.value];for(;d.type.name!=="ElMenu";)d.props.index&&p.unshift(d.props.index),d=d.parent;return p});return{parentMenu:ee(()=>{let d=e.parent;for(;d&&!["ElMenu","ElSubMenu"].includes(d.type.name);)d=d.parent;return d}),indexPath:o}}function Toe(e){return ee(()=>{const o=e.backgroundColor;return o?new f4(o).shade(20).toString():""})}const kF=(e,t)=>{const o=Xt("menu");return ee(()=>o.cssVarBlock({"text-color":e.textColor||"","hover-text-color":e.textColor||"","bg-color":e.backgroundColor||"","hover-bg-color":Toe(e).value||"","active-color":e.activeTextColor||"",level:`${t}`}))},Coe=un({index:{type:String,required:!0},showTimeout:Number,hideTimeout:Number,popperClass:String,disabled:Boolean,teleported:{type:Boolean,default:void 0},popperOffset:Number,expandCloseIcon:{type:Ai},expandOpenIcon:{type:Ai},collapseCloseIcon:{type:Ai},collapseOpenIcon:{type:Ai}}),hS="ElSubMenu";var NE=We({name:hS,props:Coe,setup(e,{slots:t,expose:o}){const a=Cr(),{indexPath:d,parentMenu:p}=AF(a,ee(()=>e.index)),y=Xt("menu"),r=Xt("sub-menu"),S=Pn("rootMenu");S||No(hS,"can not inject root menu");const C=Pn(`subMenu:${p.value.uid}`);C||No(hS,"can not inject sub menu");const M=xe({}),P=xe({});let z;const F=xe(!1),V=xe(),N=xe(null),H=ee(()=>he.value==="horizontal"&&te.value?"bottom-start":"right-start"),U=ee(()=>he.value==="horizontal"&&te.value||he.value==="vertical"&&!S.props.collapse?e.expandCloseIcon&&e.expandOpenIcon?re.value?e.expandOpenIcon:e.expandCloseIcon:zc:e.collapseCloseIcon&&e.collapseOpenIcon?re.value?e.collapseOpenIcon:e.collapseCloseIcon:ta),te=ee(()=>C.level===0),Z=ee(()=>{const De=e.teleported;return De===void 0?te.value:De}),q=ee(()=>S.props.collapse?`${y.namespace.value}-zoom-in-left`:`${y.namespace.value}-zoom-in-top`),J=ee(()=>he.value==="horizontal"&&te.value?["bottom-start","bottom-end","top-start","top-end","right-start","left-start"]:["right-start","right","right-end","left-start","bottom-start","bottom-end","top-start","top-end"]),re=ee(()=>S.openedMenus.includes(e.index)),se=ee(()=>{let De=!1;return Object.values(M.value).forEach(Ge=>{Ge.active&&(De=!0)}),Object.values(P.value).forEach(Ge=>{Ge.active&&(De=!0)}),De}),he=ee(()=>S.props.mode),le=si({index:e.index,indexPath:d,active:se}),ce=kF(S.props,C.level+1),pe=ee(()=>{var De;return(De=e.popperOffset)!=null?De:S.props.popperOffset}),de=ee(()=>{var De;return(De=e.popperClass)!=null?De:S.props.popperClass}),Ie=ee(()=>{var De;return(De=e.showTimeout)!=null?De:S.props.showTimeout}),Ve=ee(()=>{var De;return(De=e.hideTimeout)!=null?De:S.props.hideTimeout}),be=()=>{var De,Ge,rt;return(rt=(Ge=(De=N.value)==null?void 0:De.popperRef)==null?void 0:Ge.popperInstanceRef)==null?void 0:rt.destroy()},ye=De=>{De||be()},Me=()=>{S.props.menuTrigger==="hover"&&S.props.mode==="horizontal"||S.props.collapse&&S.props.mode==="vertical"||e.disabled||S.handleSubMenuClick({index:e.index,indexPath:d.value,active:se.value})},we=(De,Ge=Ie.value)=>{var rt;if(De.type!=="focus"){if(S.props.menuTrigger==="click"&&S.props.mode==="horizontal"||!S.props.collapse&&S.props.mode==="vertical"||e.disabled){C.mouseInChild.value=!0;return}C.mouseInChild.value=!0,z==null||z(),{stop:z}=Sh(()=>{S.openMenu(e.index,d.value)},Ge),Z.value&&((rt=p.value.vnode.el)==null||rt.dispatchEvent(new MouseEvent("mouseenter")))}},me=(De=!1)=>{var Ge;if(S.props.menuTrigger==="click"&&S.props.mode==="horizontal"||!S.props.collapse&&S.props.mode==="vertical"){C.mouseInChild.value=!1;return}z==null||z(),C.mouseInChild.value=!1,{stop:z}=Sh(()=>!F.value&&S.closeMenu(e.index,d.value),Ve.value),Z.value&&De&&((Ge=C.handleMouseleave)==null||Ge.call(C,!0))};Wt(()=>S.props.collapse,De=>ye(!!De));{const De=rt=>{P.value[rt.index]=rt},Ge=rt=>{delete P.value[rt.index]};Vr(`subMenu:${a.uid}`,{addSubMenu:De,removeSubMenu:Ge,handleMouseleave:me,mouseInChild:F,level:C.level+1})}return o({opened:re}),yr(()=>{S.addSubMenu(le),C.addSubMenu(le)}),Li(()=>{C.removeSubMenu(le),S.removeSubMenu(le)}),()=>{var De;const Ge=[(De=t.title)==null?void 0:De.call(t),Zn(zn,{class:r.e("icon-arrow"),style:{transform:re.value?e.expandCloseIcon&&e.expandOpenIcon||e.collapseCloseIcon&&e.collapseOpenIcon&&S.props.collapse?"none":"rotateZ(180deg)":"none"}},{default:()=>Nn(U.value)?Zn(a.appContext.components[U.value]):Zn(U.value)})],rt=S.isMenuPopup?Zn(bs,{ref:N,visible:re.value,effect:"light",pure:!0,offset:pe.value,showArrow:!1,persistent:!0,popperClass:de.value,placement:H.value,teleported:Z.value,fallbackPlacements:J.value,transition:q.value,gpuAcceleration:!1},{content:()=>{var Oe;return Zn("div",{class:[y.m(he.value),y.m("popup-container"),de.value],onMouseenter:Ct=>we(Ct,100),onMouseleave:()=>me(!0),onFocus:Ct=>we(Ct,100)},[Zn("ul",{class:[y.b(),y.m("popup"),y.m(`popup-${H.value}`)],style:ce.value},[(Oe=t.default)==null?void 0:Oe.call(t)])])},default:()=>Zn("div",{class:r.e("title"),onClick:Me},Ge)}):Zn(Vn,{},[Zn("div",{class:r.e("title"),ref:V,onClick:Me},Ge),Zn(wx,{},{default:()=>{var Oe;return hr(Zn("ul",{role:"menu",class:[y.b(),y.m("inline")],style:ce.value},[(Oe=t.default)==null?void 0:Oe.call(t)]),[[ii,re.value]])}})]);return Zn("li",{class:[r.b(),r.is("active",se.value),r.is("opened",re.value),r.is("disabled",e.disabled)],role:"menuitem",ariaHaspopup:!0,ariaExpanded:re.value,onMouseenter:we,onMouseleave:()=>me(),onFocus:we},[rt])}}});const Eoe=un({mode:{type:String,values:["horizontal","vertical"],default:"vertical"},defaultActive:{type:String,default:""},defaultOpeneds:{type:lt(Array),default:()=>io([])},uniqueOpened:Boolean,router:Boolean,menuTrigger:{type:String,values:["hover","click"],default:"hover"},collapse:Boolean,backgroundColor:String,textColor:String,activeTextColor:String,closeOnClickOutside:Boolean,collapseTransition:{type:Boolean,default:!0},ellipsis:{type:Boolean,default:!0},popperOffset:{type:Number,default:6},ellipsisIcon:{type:Ai,default:()=>E7},popperEffect:{type:lt(String),default:"dark"},popperClass:String,showTimeout:{type:Number,default:300},hideTimeout:{type:Number,default:300}}),pS=e=>sn(e)&&e.every(t=>Nn(t)),Moe={close:(e,t)=>Nn(e)&&pS(t),open:(e,t)=>Nn(e)&&pS(t),select:(e,t,o,a)=>Nn(e)&&pS(t)&&xr(o)&&(a===void 0||a instanceof Promise)};var Ioe=We({name:"ElMenu",props:Eoe,emits:Moe,setup(e,{emit:t,slots:o,expose:a}){const d=Cr(),p=d.appContext.config.globalProperties.$router,y=xe(),r=Xt("menu"),S=Xt("sub-menu"),C=xe(-1),M=xe(e.defaultOpeneds&&!e.collapse?e.defaultOpeneds.slice(0):[]),P=xe(e.defaultActive),z=xe({}),F=xe({}),V=ee(()=>e.mode==="horizontal"||e.mode==="vertical"&&e.collapse),N=()=>{const be=P.value&&z.value[P.value];if(!be||e.mode==="horizontal"||e.collapse)return;be.indexPath.forEach(Me=>{const we=F.value[Me];we&&H(Me,we.indexPath)})},H=(be,ye)=>{M.value.includes(be)||(e.uniqueOpened&&(M.value=M.value.filter(Me=>ye.includes(Me))),M.value.push(be),t("open",be,ye))},U=be=>{const ye=M.value.indexOf(be);ye!==-1&&M.value.splice(ye,1)},te=(be,ye)=>{U(be),t("close",be,ye)},Z=({index:be,indexPath:ye})=>{M.value.includes(be)?te(be,ye):H(be,ye)},q=be=>{(e.mode==="horizontal"||e.collapse)&&(M.value=[]);const{index:ye,indexPath:Me}=be;if(!(Ho(ye)||Ho(Me)))if(e.router&&p){const we=be.route||ye,me=p.push(we).then(De=>(De||(P.value=ye),De));t("select",ye,Me,{index:ye,indexPath:Me,route:we},me)}else P.value=ye,t("select",ye,Me,{index:ye,indexPath:Me})},J=be=>{const ye=z.value,Me=ye[be]||P.value&&ye[P.value]||ye[e.defaultActive];Me?P.value=Me.index:P.value=be},re=be=>{const ye=getComputedStyle(be),Me=Number.parseInt(ye.marginLeft,10),we=Number.parseInt(ye.marginRight,10);return be.offsetWidth+Me+we||0},se=()=>{var be,ye;if(!y.value)return-1;const Me=Array.from((ye=(be=y.value)==null?void 0:be.childNodes)!=null?ye:[]).filter(kt=>kt.nodeName!=="#text"||kt.nodeValue),we=64,me=getComputedStyle(y.value),De=Number.parseInt(me.paddingLeft,10),Ge=Number.parseInt(me.paddingRight,10),rt=y.value.clientWidth-De-Ge;let Oe=0,Ct=0;return Me.forEach((kt,Bt)=>{kt.nodeName!=="#comment"&&(Oe+=re(kt),Oe<=rt-we&&(Ct=Bt+1))}),Ct===Me.length?-1:Ct},he=be=>F.value[be].indexPath,le=(be,ye=33.34)=>{let Me;return()=>{Me&&clearTimeout(Me),Me=setTimeout(()=>{be()},ye)}};let ce=!0;const pe=()=>{if(C.value===se())return;const be=()=>{C.value=-1,jn(()=>{C.value=se()})};ce?be():le(be)(),ce=!1};Wt(()=>e.defaultActive,be=>{z.value[be]||(P.value=""),J(be)}),Wt(()=>e.collapse,be=>{be&&(M.value=[])}),Wt(z.value,N);let de;gs(()=>{e.mode==="horizontal"&&e.ellipsis?de=ro(y,pe).stop:de==null||de()});const Ie=xe(!1);{const be=me=>{F.value[me.index]=me},ye=me=>{delete F.value[me.index]};Vr("rootMenu",si({props:e,openedMenus:M,items:z,subMenus:F,activeIndex:P,isMenuPopup:V,addMenuItem:me=>{z.value[me.index]=me},removeMenuItem:me=>{delete z.value[me.index]},addSubMenu:be,removeSubMenu:ye,openMenu:H,closeMenu:te,handleMenuItemClick:q,handleSubMenuClick:Z})),Vr(`subMenu:${d.uid}`,{addSubMenu:be,removeSubMenu:ye,mouseInChild:Ie,level:0})}yr(()=>{e.mode==="horizontal"&&new boe(d.vnode.el,r.namespace.value)}),a({open:ye=>{const{indexPath:Me}=F.value[ye];Me.forEach(we=>H(we,Me))},close:U,handleResize:pe});const Ve=kF(e,0);return()=>{var be,ye;let Me=(ye=(be=o.default)==null?void 0:be.call(o))!=null?ye:[];const we=[];if(e.mode==="horizontal"&&y.value){const Ge=Hd(Me),rt=C.value===-1?Ge:Ge.slice(0,C.value),Oe=C.value===-1?[]:Ge.slice(C.value);Oe!=null&&Oe.length&&e.ellipsis&&(Me=rt,we.push(Zn(NE,{index:"sub-menu-more",class:S.e("hide-arrow"),popperOffset:e.popperOffset},{title:()=>Zn(zn,{class:S.e("icon-more")},{default:()=>Zn(e.ellipsisIcon)}),default:()=>Oe})))}const me=e.closeOnClickOutside?[[Pc,()=>{M.value.length&&(Ie.value||(M.value.forEach(Ge=>t("close",Ge,he(Ge))),M.value=[]))}]]:[],De=hr(Zn("ul",{key:String(e.collapse),role:"menubar",ref:y,style:Ve.value,class:{[r.b()]:!0,[r.m(e.mode)]:!0,[r.m("collapse")]:e.collapse}},[...Me,...we]),me);return e.collapseTransition&&e.mode==="vertical"?Zn(Soe,()=>De):De}}});const Aoe=un({index:{type:lt([String,null]),default:null},route:{type:lt([String,Object])},disabled:Boolean}),koe={click:e=>Nn(e.index)&&sn(e.indexPath)},mS="ElMenuItem",Poe=We({name:mS,components:{ElTooltip:bs},props:Aoe,emits:koe,setup(e,{emit:t}){const o=Cr(),a=Pn("rootMenu"),d=Xt("menu"),p=Xt("menu-item");a||No(mS,"can not inject root menu");const{parentMenu:y,indexPath:r}=AF(o,hi(e,"index")),S=Pn(`subMenu:${y.value.uid}`);S||No(mS,"can not inject sub menu");const C=ee(()=>e.index===a.activeIndex),M=si({index:e.index,indexPath:r,active:C}),P=()=>{e.disabled||(a.handleMenuItemClick({index:e.index,indexPath:r.value,route:e.route}),t("click",M))};return yr(()=>{S.addSubMenu(M),a.addMenuItem(M)}),Li(()=>{S.removeSubMenu(M),a.removeMenuItem(M)}),{parentMenu:y,rootMenu:a,active:C,nsMenu:d,nsMenuItem:p,handleClick:P}}});function Roe(e,t,o,a,d,p){const y=Er("el-tooltip");return ae(),Pe("li",{class:fe([e.nsMenuItem.b(),e.nsMenuItem.is("active",e.active),e.nsMenuItem.is("disabled",e.disabled)]),role:"menuitem",tabindex:"-1",onClick:e.handleClick},[e.parentMenu.type.name==="ElMenu"&&e.rootMenu.props.collapse&&e.$slots.title?(ae(),At(y,{key:0,effect:e.rootMenu.props.popperEffect,placement:"right","fallback-placements":["left"],persistent:""},{content:ot(()=>[gt(e.$slots,"title")]),default:ot(()=>[Ue("div",{class:fe(e.nsMenu.be("tooltip","trigger"))},[gt(e.$slots,"default")],2)]),_:3},8,["effect"])):(ae(),Pe(Vn,{key:1},[gt(e.$slots,"default"),gt(e.$slots,"title")],64))],10,["onClick"])}var PF=dn(Poe,[["render",Roe],["__file","menu-item.vue"]]);const Ooe={title:String},Loe="ElMenuItemGroup",Doe=We({name:Loe,props:Ooe,setup(){return{ns:Xt("menu-item-group")}}});function zoe(e,t,o,a,d,p){return ae(),Pe("li",{class:fe(e.ns.b())},[Ue("div",{class:fe(e.ns.e("title"))},[e.$slots.title?gt(e.$slots,"title",{key:1}):(ae(),Pe(Vn,{key:0},[Nr(fn(e.title),1)],64))],2),Ue("ul",null,[gt(e.$slots,"default")])],2)}var RF=dn(Doe,[["render",zoe],["__file","menu-item-group.vue"]]);const Foe=lr(Ioe,{MenuItem:PF,MenuItemGroup:RF,SubMenu:NE}),Noe=oo(PF),Boe=oo(RF),Voe=oo(NE),$oe=un({icon:{type:Ai,default:()=>Y9},title:String,content:{type:String,default:""}}),Uoe={back:()=>!0},joe=We({name:"ElPageHeader"}),Hoe=We({...joe,props:$oe,emits:Uoe,setup(e,{emit:t}){const{t:o}=qr(),a=Xt("page-header");function d(){t("back")}return(p,y)=>(ae(),Pe("div",{class:fe([b(a).b(),{[b(a).m("has-breadcrumb")]:!!p.$slots.breadcrumb,[b(a).m("has-extra")]:!!p.$slots.extra,[b(a).is("contentful")]:!!p.$slots.default}])},[p.$slots.breadcrumb?(ae(),Pe("div",{key:0,class:fe(b(a).e("breadcrumb"))},[gt(p.$slots,"breadcrumb")],2)):bt("v-if",!0),Ue("div",{class:fe(b(a).e("header"))},[Ue("div",{class:fe(b(a).e("left"))},[Ue("div",{class:fe(b(a).e("back")),role:"button",tabindex:"0",onClick:d},[p.icon||p.$slots.icon?(ae(),Pe("div",{key:0,"aria-label":p.title||b(o)("el.pageHeader.title"),class:fe(b(a).e("icon"))},[gt(p.$slots,"icon",{},()=>[p.icon?(ae(),At(b(zn),{key:0},{default:ot(()=>[(ae(),At(Ir(p.icon)))]),_:1})):bt("v-if",!0)])],10,["aria-label"])):bt("v-if",!0),Ue("div",{class:fe(b(a).e("title"))},[gt(p.$slots,"title",{},()=>[Nr(fn(p.title||b(o)("el.pageHeader.title")),1)])],2)],2),qe(b(mF),{direction:"vertical"}),Ue("div",{class:fe(b(a).e("content"))},[gt(p.$slots,"content",{},()=>[Nr(fn(p.content),1)])],2)],2),p.$slots.extra?(ae(),Pe("div",{key:0,class:fe(b(a).e("extra"))},[gt(p.$slots,"extra")],2)):bt("v-if",!0)],2),p.$slots.default?(ae(),Pe("div",{key:1,class:fe(b(a).e("main"))},[gt(p.$slots,"default")],2)):bt("v-if",!0)],2))}});var Goe=dn(Hoe,[["__file","page-header.vue"]]);const Woe=lr(Goe),OF=Symbol("elPaginationKey"),qoe=un({disabled:Boolean,currentPage:{type:Number,default:1},prevText:{type:String},prevIcon:{type:Ai}}),Koe={click:e=>e instanceof MouseEvent},Zoe=We({name:"ElPaginationPrev"}),Yoe=We({...Zoe,props:qoe,emits:Koe,setup(e){const t=e,{t:o}=qr(),a=ee(()=>t.disabled||t.currentPage<=1);return(d,p)=>(ae(),Pe("button",{type:"button",class:"btn-prev",disabled:b(a),"aria-label":d.prevText||b(o)("el.pagination.prev"),"aria-disabled":b(a),onClick:y=>d.$emit("click",y)},[d.prevText?(ae(),Pe("span",{key:0},fn(d.prevText),1)):(ae(),At(b(zn),{key:1},{default:ot(()=>[(ae(),At(Ir(d.prevIcon)))]),_:1}))],8,["disabled","aria-label","aria-disabled","onClick"]))}});var Xoe=dn(Yoe,[["__file","prev.vue"]]);const Joe=un({disabled:Boolean,currentPage:{type:Number,default:1},pageCount:{type:Number,default:50},nextText:{type:String},nextIcon:{type:Ai}}),Qoe=We({name:"ElPaginationNext"}),ese=We({...Qoe,props:Joe,emits:["click"],setup(e){const t=e,{t:o}=qr(),a=ee(()=>t.disabled||t.currentPage===t.pageCount||t.pageCount===0);return(d,p)=>(ae(),Pe("button",{type:"button",class:"btn-next",disabled:b(a),"aria-label":d.nextText||b(o)("el.pagination.next"),"aria-disabled":b(a),onClick:y=>d.$emit("click",y)},[d.nextText?(ae(),Pe("span",{key:0},fn(d.nextText),1)):(ae(),At(b(zn),{key:1},{default:ot(()=>[(ae(),At(Ir(d.nextIcon)))]),_:1}))],8,["disabled","aria-label","aria-disabled","onClick"]))}});var tse=dn(ese,[["__file","next.vue"]]);const LF=Symbol("ElSelectGroup"),cg=Symbol("ElSelect");function nse(e,t){const o=Pn(cg),a=Pn(LF,{disabled:!1}),d=ee(()=>M(Fs(o.props.modelValue),e.value)),p=ee(()=>{var F;if(o.props.multiple){const V=Fs((F=o.props.modelValue)!=null?F:[]);return!d.value&&V.length>=o.props.multipleLimit&&o.props.multipleLimit>0}else return!1}),y=ee(()=>e.label||(xr(e.value)?"":e.value)),r=ee(()=>e.value||e.label||""),S=ee(()=>e.disabled||t.groupDisabled||p.value),C=Cr(),M=(F=[],V)=>{if(xr(e.value)){const N=o.props.valueKey;return F&&F.some(H=>wi(Eo(H,N))===Eo(V,N))}else return F&&F.includes(V)},P=()=>{!e.disabled&&!a.disabled&&(o.states.hoveringIndex=o.optionsArray.indexOf(C.proxy))},z=F=>{const V=new RegExp(xE(F),"i");t.visible=V.test(y.value)||e.created};return Wt(()=>y.value,()=>{!e.created&&!o.props.remote&&o.setSelected()}),Wt(()=>e.value,(F,V)=>{const{remote:N,valueKey:H}=o.props;if(F!==V&&(o.onOptionDestroy(V,C.proxy),o.onOptionCreate(C.proxy)),!e.created&&!N){if(H&&xr(F)&&xr(V)&&F[H]===V[H])return;o.setSelected()}}),Wt(()=>a.disabled,()=>{t.groupDisabled=a.disabled},{immediate:!0}),{select:o,currentLabel:y,currentValue:r,itemSelected:d,isDisabled:S,hoverItem:P,updateOption:z}}const rse=We({name:"ElOption",componentName:"ElOption",props:{value:{required:!0,type:[String,Number,Boolean,Object]},label:[String,Number],created:Boolean,disabled:Boolean},setup(e){const t=Xt("select"),o=us(),a=ee(()=>[t.be("dropdown","item"),t.is("disabled",b(r)),t.is("selected",b(y)),t.is("hovering",b(z))]),d=si({index:-1,groupDisabled:!1,visible:!0,hover:!1}),{currentLabel:p,itemSelected:y,isDisabled:r,select:S,hoverItem:C,updateOption:M}=nse(e,d),{visible:P,hover:z}=Go(d),F=Cr().proxy;S.onOptionCreate(F),Li(()=>{const N=F.value,{selected:H}=S.states,U=H.some(te=>te.value===F.value);jn(()=>{S.states.cachedOptions.get(N)===F&&!U&&S.states.cachedOptions.delete(N)}),S.onOptionDestroy(N,F)});function V(){r.value||S.handleOptionSelect(F)}return{ns:t,id:o,containerKls:a,currentLabel:p,itemSelected:y,isDisabled:r,select:S,hoverItem:C,updateOption:M,visible:P,hover:z,selectOptionClick:V,states:d}}});function ise(e,t,o,a,d,p){return hr((ae(),Pe("li",{id:e.id,class:fe(e.containerKls),role:"option","aria-disabled":e.isDisabled||void 0,"aria-selected":e.itemSelected,onMousemove:e.hoverItem,onClick:Jn(e.selectOptionClick,["stop"])},[gt(e.$slots,"default",{},()=>[Ue("span",null,fn(e.currentLabel),1)])],42,["id","aria-disabled","aria-selected","onMousemove","onClick"])),[[ii,e.visible]])}var BE=dn(rse,[["render",ise],["__file","option.vue"]]);const ose=We({name:"ElSelectDropdown",componentName:"ElSelectDropdown",setup(){const e=Pn(cg),t=Xt("select"),o=ee(()=>e.props.popperClass),a=ee(()=>e.props.multiple),d=ee(()=>e.props.fitInputWidth),p=xe("");function y(){var r;p.value=`${(r=e.selectRef)==null?void 0:r.offsetWidth}px`}return yr(()=>{y(),ro(e.selectRef,y)}),{ns:t,minWidth:p,popperClass:o,isMultiple:a,isFitInputWidth:d}}});function sse(e,t,o,a,d,p){return ae(),Pe("div",{class:fe([e.ns.b("dropdown"),e.ns.is("multiple",e.isMultiple),e.popperClass]),style:Un({[e.isFitInputWidth?"width":"minWidth"]:e.minWidth})},[e.$slots.header?(ae(),Pe("div",{key:0,class:fe(e.ns.be("dropdown","header"))},[gt(e.$slots,"header")],2)):bt("v-if",!0),gt(e.$slots,"default"),e.$slots.footer?(ae(),Pe("div",{key:1,class:fe(e.ns.be("dropdown","footer"))},[gt(e.$slots,"footer")],2)):bt("v-if",!0)],6)}var ase=dn(ose,[["render",sse],["__file","select-dropdown.vue"]]);const lse=(e,t)=>{const{t:o}=qr(),a=us(),d=Xt("select"),p=Xt("input"),y=si({inputValue:"",options:new Map,cachedOptions:new Map,optionValues:[],selected:[],selectionWidth:0,collapseItemWidth:0,selectedLabel:"",hoveringIndex:-1,previousQuery:null,inputHovering:!1,menuVisibleOnFocus:!1,isBeforeHide:!1}),r=xe(null),S=xe(null),C=xe(null),M=xe(null),P=xe(null),z=xe(null),F=xe(null),V=xe(null),N=xe(null),H=xe(null),U=xe(null),{isComposing:te,handleCompositionStart:Z,handleCompositionUpdate:q,handleCompositionEnd:J}=cv({afterComposition:Qe=>er(Qe)}),{wrapperRef:re,isFocused:se,handleBlur:he}=af(P,{beforeFocus(){return ye.value},afterFocus(){e.automaticDropdown&&!le.value&&(le.value=!0,y.menuVisibleOnFocus=!0)},beforeBlur(Qe){var yt,Qt;return((yt=C.value)==null?void 0:yt.isFocusInsideContent(Qe))||((Qt=M.value)==null?void 0:Qt.isFocusInsideContent(Qe))},afterBlur(){le.value=!1,y.menuVisibleOnFocus=!1}}),le=xe(!1),ce=xe(),{form:pe,formItem:de}=xs(),{inputId:Ie}=ml(e,{formItemContext:de}),{valueOnClear:Ve,isEmptyValue:be}=hx(e),ye=ee(()=>e.disabled||(pe==null?void 0:pe.disabled)),Me=ee(()=>sn(e.modelValue)?e.modelValue.length>0:!be(e.modelValue)),we=ee(()=>{var Qe;return(Qe=pe==null?void 0:pe.statusIcon)!=null?Qe:!1}),me=ee(()=>e.clearable&&!ye.value&&y.inputHovering&&Me.value),De=ee(()=>e.remote&&e.filterable&&!e.remoteShowSuffix?"":e.suffixIcon),Ge=ee(()=>d.is("reverse",De.value&&le.value)),rt=ee(()=>(de==null?void 0:de.validateState)||""),Oe=ee(()=>_x[rt.value]),Ct=ee(()=>e.remote?300:0),kt=ee(()=>e.remote&&!y.inputValue&&y.options.size===0),Bt=ee(()=>e.loading?e.loadingText||o("el.select.loading"):e.filterable&&y.inputValue&&y.options.size>0&&_t.value===0?e.noMatchText||o("el.select.noMatch"):y.options.size===0?e.noDataText||o("el.select.noData"):null),_t=ee(()=>jt.value.filter(Qe=>Qe.visible).length),jt=ee(()=>{const Qe=Array.from(y.options.values()),yt=[];return y.optionValues.forEach(Qt=>{const bn=Qe.findIndex(Mn=>Mn.value===Qt);bn>-1&&yt.push(Qe[bn])}),yt.length>=Qe.length?yt:Qe}),Gt=ee(()=>Array.from(y.cachedOptions.values())),Ne=ee(()=>{const Qe=jt.value.filter(yt=>!yt.created).some(yt=>yt.currentLabel===y.inputValue);return e.filterable&&e.allowCreate&&y.inputValue!==""&&!Qe}),an=()=>{e.filterable&&$n(e.filterMethod)||e.filterable&&e.remote&&$n(e.remoteMethod)||jt.value.forEach(Qe=>{var yt;(yt=Qe.updateOption)==null||yt.call(Qe,y.inputValue)})},Ae=Ro(),tt=ee(()=>["small"].includes(Ae.value)?"small":"default"),Je=ee({get(){return le.value&&!kt.value},set(Qe){le.value=Qe}}),Jt=ee(()=>{if(e.multiple&&!ai(e.modelValue))return Fs(e.modelValue).length===0&&!y.inputValue;const Qe=sn(e.modelValue)?e.modelValue[0]:e.modelValue;return e.filterable||ai(Qe)?!y.inputValue:!0}),Kt=ee(()=>{var Qe;const yt=(Qe=e.placeholder)!=null?Qe:o("el.select.placeholder");return e.multiple||!Me.value?yt:y.selectedLabel}),Nt=ee(()=>QS?null:"mouseenter");Wt(()=>e.modelValue,(Qe,yt)=>{e.multiple&&e.filterable&&!e.reserveKeyword&&(y.inputValue="",Pt("")),rn(),!_s(Qe,yt)&&e.validateEvent&&(de==null||de.validate("change").catch(Qt=>void 0))},{flush:"post",deep:!0}),Wt(()=>le.value,Qe=>{Qe?Pt(y.inputValue):(y.inputValue="",y.previousQuery=null,y.isBeforeHide=!0),t("visible-change",Qe)}),Wt(()=>y.options.entries(),()=>{Wr&&(rn(),e.defaultFirstOption&&(e.filterable||e.remote)&&_t.value&&Dt())},{flush:"post"}),Wt(()=>y.hoveringIndex,Qe=>{Wn(Qe)&&Qe>-1?ce.value=jt.value[Qe]||{}:ce.value={},jt.value.forEach(yt=>{yt.hover=ce.value===yt})}),gs(()=>{y.isBeforeHide||an()});const Pt=Qe=>{y.previousQuery===Qe||te.value||(y.previousQuery=Qe,e.filterable&&$n(e.filterMethod)?e.filterMethod(Qe):e.filterable&&e.remote&&$n(e.remoteMethod)&&e.remoteMethod(Qe),e.defaultFirstOption&&(e.filterable||e.remote)&&_t.value?jn(Dt):jn(Ln))},Dt=()=>{const Qe=jt.value.filter(Mn=>Mn.visible&&!Mn.disabled&&!Mn.states.groupDisabled),yt=Qe.find(Mn=>Mn.created),Qt=Qe[0],bn=jt.value.map(Mn=>Mn.value);y.hoveringIndex=Ye(bn,yt||Qt)},rn=()=>{if(e.multiple)y.selectedLabel="";else{const yt=sn(e.modelValue)?e.modelValue[0]:e.modelValue,Qt=on(yt);y.selectedLabel=Qt.currentLabel,y.selected=[Qt];return}const Qe=[];ai(e.modelValue)||Fs(e.modelValue).forEach(yt=>{Qe.push(on(yt))}),y.selected=Qe},on=Qe=>{let yt;const Qt=wy(Qe);for(let or=y.cachedOptions.size-1;or>=0;or--){const dr=Gt.value[or];if(Qt?Eo(dr.value,e.valueKey)===Eo(Qe,e.valueKey):dr.value===Qe){yt={value:Qe,currentLabel:dr.currentLabel,get isDisabled(){return dr.isDisabled}};break}}if(yt)return yt;const bn=Qt?Qe.label:Qe??"";return{value:Qe,currentLabel:bn}},Ln=()=>{y.hoveringIndex=jt.value.findIndex(Qe=>y.selected.some(yt=>ke(yt)===ke(Qe)))},yn=()=>{y.selectionWidth=S.value.getBoundingClientRect().width},Et=()=>{y.collapseItemWidth=H.value.getBoundingClientRect().width},En=()=>{var Qe,yt;(yt=(Qe=C.value)==null?void 0:Qe.updatePopper)==null||yt.call(Qe)},Xn=()=>{var Qe,yt;(yt=(Qe=M.value)==null?void 0:Qe.updatePopper)==null||yt.call(Qe)},vr=()=>{y.inputValue.length>0&&!le.value&&(le.value=!0),Pt(y.inputValue)},er=Qe=>{if(y.inputValue=Qe.target.value,e.remote)Dr();else return vr()},Dr=Ca(()=>{vr()},Ct.value),Ar=Qe=>{_s(e.modelValue,Qe)||t(Ii,Qe)},Di=Qe=>sz(Qe,yt=>{const Qt=y.cachedOptions.get(yt);return Qt&&!Qt.disabled&&!Qt.states.groupDisabled}),ui=Qe=>{if(e.multiple&&Qe.code!==Cn.delete&&Qe.target.value.length<=0){const yt=Fs(e.modelValue).slice(),Qt=Di(yt);if(Qt<0)return;const bn=yt[Qt];yt.splice(Qt,1),t(gr,yt),Ar(yt),t("remove-tag",bn)}},zt=(Qe,yt)=>{const Qt=y.selected.indexOf(yt);if(Qt>-1&&!ye.value){const bn=Fs(e.modelValue).slice();bn.splice(Qt,1),t(gr,bn),Ar(bn),t("remove-tag",yt.value)}Qe.stopPropagation(),Qi()},st=Qe=>{Qe.stopPropagation();const yt=e.multiple?[]:Ve.value;if(e.multiple)for(const Qt of y.selected)Qt.isDisabled&&yt.push(Qt.value);t(gr,yt),Ar(yt),y.hoveringIndex=-1,le.value=!1,t("clear"),Qi()},Ft=Qe=>{var yt;if(e.multiple){const Qt=Fs((yt=e.modelValue)!=null?yt:[]).slice(),bn=Ye(Qt,Qe);bn>-1?Qt.splice(bn,1):(e.multipleLimit<=0||Qt.length<e.multipleLimit)&&Qt.push(Qe.value),t(gr,Qt),Ar(Qt),Qe.created&&Pt(""),e.filterable&&!e.reserveKeyword&&(y.inputValue="")}else t(gr,Qe.value),Ar(Qe.value),le.value=!1;Qi(),!le.value&&jn(()=>{pn(Qe)})},Ye=(Qe=[],yt)=>ai(yt)?-1:xr(yt.value)?Qe.findIndex(Qt=>_s(Eo(Qt,e.valueKey),ke(yt))):Qe.indexOf(yt.value),pn=Qe=>{var yt,Qt,bn,Mn,or;const dr=sn(Qe)?Qe[0]:Qe;let ur=null;if(dr!=null&&dr.value){const cr=jt.value.filter(ei=>ei.value===dr.value);cr.length>0&&(ur=cr[0].$el)}if(C.value&&ur){const cr=(Mn=(bn=(Qt=(yt=C.value)==null?void 0:yt.popperRef)==null?void 0:Qt.contentRef)==null?void 0:bn.querySelector)==null?void 0:Mn.call(bn,`.${d.be("dropdown","wrap")}`);cr&&XC(cr,ur)}(or=U.value)==null||or.handleScroll()},xn=Qe=>{y.options.set(Qe.value,Qe),y.cachedOptions.set(Qe.value,Qe)},_r=(Qe,yt)=>{y.options.get(Qe)===yt&&y.options.delete(Qe)},yi=ee(()=>{var Qe,yt;return(yt=(Qe=C.value)==null?void 0:Qe.popperRef)==null?void 0:yt.contentRef}),xi=()=>{y.isBeforeHide=!1,jn(()=>pn(y.selected))},Qi=()=>{var Qe;(Qe=P.value)==null||Qe.focus()},ci=()=>{var Qe;if(le.value){le.value=!1,jn(()=>{var yt;return(yt=P.value)==null?void 0:yt.blur()});return}(Qe=P.value)==null||Qe.blur()},co=Qe=>{st(Qe)},pi=Qe=>{if(le.value=!1,se.value){const yt=new FocusEvent("focus",Qe);jn(()=>he(yt))}},Oo=()=>{y.inputValue.length>0?y.inputValue="":le.value=!1},Ut=()=>{ye.value||(QS&&(y.inputHovering=!0),y.menuVisibleOnFocus?y.menuVisibleOnFocus=!1:le.value=!le.value)},Ee=()=>{if(!le.value)Ut();else{const Qe=jt.value[y.hoveringIndex];Qe&&!Qe.isDisabled&&Ft(Qe)}},ke=Qe=>xr(Qe.value)?Eo(Qe.value,e.valueKey):Qe.value,He=ee(()=>jt.value.filter(Qe=>Qe.visible).every(Qe=>Qe.isDisabled)),ut=ee(()=>e.multiple?e.collapseTags?y.selected.slice(0,e.maxCollapseTags):y.selected:[]),ft=ee(()=>e.multiple?e.collapseTags?y.selected.slice(e.maxCollapseTags):[]:[]),xt=Qe=>{if(!le.value){le.value=!0;return}if(!(y.options.size===0||_t.value===0||te.value)&&!He.value){Qe==="next"?(y.hoveringIndex++,y.hoveringIndex===y.options.size&&(y.hoveringIndex=0)):Qe==="prev"&&(y.hoveringIndex--,y.hoveringIndex<0&&(y.hoveringIndex=y.options.size-1));const yt=jt.value[y.hoveringIndex];(yt.isDisabled||!yt.visible)&&xt(Qe),jn(()=>pn(ce.value))}},Lt=()=>{if(!S.value)return 0;const Qe=window.getComputedStyle(S.value);return Number.parseFloat(Qe.gap||"6px")},Tt=ee(()=>{const Qe=Lt();return{maxWidth:`${H.value&&e.maxCollapseTags===1?y.selectionWidth-y.collapseItemWidth-Qe:y.selectionWidth}px`}}),$t=ee(()=>({maxWidth:`${y.selectionWidth}px`}));return ro(S,yn),ro(V,En),ro(re,En),ro(N,Xn),ro(H,Et),yr(()=>{rn()}),{inputId:Ie,contentId:a,nsSelect:d,nsInput:p,states:y,isFocused:se,expanded:le,optionsArray:jt,hoverOption:ce,selectSize:Ae,filteredOptionsCount:_t,updateTooltip:En,updateTagTooltip:Xn,debouncedOnInputChange:Dr,onInput:er,deletePrevTag:ui,deleteTag:zt,deleteSelected:st,handleOptionSelect:Ft,scrollToOption:pn,hasModelValue:Me,shouldShowPlaceholder:Jt,currentPlaceholder:Kt,mouseEnterEventName:Nt,needStatusIcon:we,showClose:me,iconComponent:De,iconReverse:Ge,validateState:rt,validateIcon:Oe,showNewOption:Ne,updateOptions:an,collapseTagSize:tt,setSelected:rn,selectDisabled:ye,emptyText:Bt,handleCompositionStart:Z,handleCompositionUpdate:q,handleCompositionEnd:J,onOptionCreate:xn,onOptionDestroy:_r,handleMenuEnter:xi,focus:Qi,blur:ci,handleClearClick:co,handleClickOutside:pi,handleEsc:Oo,toggleMenu:Ut,selectOption:Ee,getValueKey:ke,navigateOptions:xt,dropdownMenuVisible:Je,showTagList:ut,collapseTagList:ft,tagStyle:Tt,collapseTagStyle:$t,popperRef:yi,inputRef:P,tooltipRef:C,tagTooltipRef:M,prefixRef:z,suffixRef:F,selectRef:r,wrapperRef:re,selectionRef:S,scrollbarRef:U,menuRef:V,tagMenuRef:N,collapseItemRef:H}};var use=We({name:"ElOptions",setup(e,{slots:t}){const o=Pn(cg);let a=[];return()=>{var d,p;const y=(d=t.default)==null?void 0:d.call(t),r=[];function S(C){sn(C)&&C.forEach(M=>{var P,z,F,V;const N=(P=(M==null?void 0:M.type)||{})==null?void 0:P.name;N==="ElOptionGroup"?S(!Nn(M.children)&&!sn(M.children)&&$n((z=M.children)==null?void 0:z.default)?(F=M.children)==null?void 0:F.default():M.children):N==="ElOption"?r.push((V=M.props)==null?void 0:V.value):sn(M.children)&&S(M.children)})}return y.length&&S((p=y[0])==null?void 0:p.children),_s(r,a)||(a=r,o&&(o.states.optionValues=r)),y}}});const cse=un({name:String,id:String,modelValue:{type:[Array,String,Number,Boolean,Object],default:void 0},autocomplete:{type:String,default:"off"},automaticDropdown:Boolean,size:zo,effect:{type:lt(String),default:"light"},disabled:Boolean,clearable:Boolean,filterable:Boolean,allowCreate:Boolean,loading:Boolean,popperClass:{type:String,default:""},popperOptions:{type:lt(Object),default:()=>({})},remote:Boolean,loadingText:String,noMatchText:String,noDataText:String,remoteMethod:Function,filterMethod:Function,multiple:Boolean,multipleLimit:{type:Number,default:0},placeholder:{type:String},defaultFirstOption:Boolean,reserveKeyword:{type:Boolean,default:!0},valueKey:{type:String,default:"value"},collapseTags:Boolean,collapseTagsTooltip:Boolean,maxCollapseTags:{type:Number,default:1},teleported:Jo.teleported,persistent:{type:Boolean,default:!0},clearIcon:{type:Ai,default:Fc},fitInputWidth:Boolean,suffixIcon:{type:Ai,default:zc},tagType:{...kc.type,default:"info"},tagEffect:{...kc.effect,default:"light"},validateEvent:{type:Boolean,default:!0},remoteShowSuffix:Boolean,showArrow:{type:Boolean,default:!0},offset:{type:Number,default:12},placement:{type:lt(String),values:Nc,default:"bottom-start"},fallbackPlacements:{type:lt(Array),default:["bottom-start","top-start","right","left"]},tabindex:{type:[String,Number],default:0},appendTo:String,...sg,...cs(["ariaLabel"])}),LR="ElSelect",dse=We({name:LR,componentName:LR,components:{ElSelectMenu:ase,ElOption:BE,ElOptions:use,ElTag:Um,ElScrollbar:Hu,ElTooltip:bs,ElIcon:zn},directives:{ClickOutside:Pc},props:cse,emits:[gr,Ii,"remove-tag","clear","visible-change","focus","blur"],setup(e,{emit:t}){const o=ee(()=>{const{modelValue:S,multiple:C}=e,M=C?[]:void 0;return sn(S)?C?S:M:C?M:S}),a=si({...Go(e),modelValue:o}),d=lse(a,t),{calculatorRef:p,inputStyle:y}=FE();Vr(cg,si({props:a,states:d.states,optionsArray:d.optionsArray,handleOptionSelect:d.handleOptionSelect,onOptionCreate:d.onOptionCreate,onOptionDestroy:d.onOptionDestroy,selectRef:d.selectRef,setSelected:d.setSelected}));const r=ee(()=>e.multiple?d.states.selected.map(S=>S.currentLabel):d.states.selectedLabel);return{...d,modelValue:o,selectedLabel:r,calculatorRef:p,inputStyle:y}}});function fse(e,t,o,a,d,p){const y=Er("el-tag"),r=Er("el-tooltip"),S=Er("el-icon"),C=Er("el-option"),M=Er("el-options"),P=Er("el-scrollbar"),z=Er("el-select-menu"),F=ex("click-outside");return hr((ae(),Pe("div",{ref:"selectRef",class:fe([e.nsSelect.b(),e.nsSelect.m(e.selectSize)]),[sy(e.mouseEnterEventName)]:V=>e.states.inputHovering=!0,onMouseleave:V=>e.states.inputHovering=!1},[qe(r,{ref:"tooltipRef",visible:e.dropdownMenuVisible,placement:e.placement,teleported:e.teleported,"popper-class":[e.nsSelect.e("popper"),e.popperClass],"popper-options":e.popperOptions,"fallback-placements":e.fallbackPlacements,effect:e.effect,pure:"",trigger:"click",transition:`${e.nsSelect.namespace.value}-zoom-in-top`,"stop-popper-mouse-event":!1,"gpu-acceleration":!1,persistent:e.persistent,"append-to":e.appendTo,"show-arrow":e.showArrow,offset:e.offset,onBeforeShow:e.handleMenuEnter,onHide:V=>e.states.isBeforeHide=!1},{default:ot(()=>{var V;return[Ue("div",{ref:"wrapperRef",class:fe([e.nsSelect.e("wrapper"),e.nsSelect.is("focused",e.isFocused),e.nsSelect.is("hovering",e.states.inputHovering),e.nsSelect.is("filterable",e.filterable),e.nsSelect.is("disabled",e.selectDisabled)]),onClick:Jn(e.toggleMenu,["prevent"])},[e.$slots.prefix?(ae(),Pe("div",{key:0,ref:"prefixRef",class:fe(e.nsSelect.e("prefix"))},[gt(e.$slots,"prefix")],2)):bt("v-if",!0),Ue("div",{ref:"selectionRef",class:fe([e.nsSelect.e("selection"),e.nsSelect.is("near",e.multiple&&!e.$slots.prefix&&!!e.states.selected.length)])},[e.multiple?gt(e.$slots,"tag",{key:0},()=>[(ae(!0),Pe(Vn,null,Fr(e.showTagList,N=>(ae(),Pe("div",{key:e.getValueKey(N),class:fe(e.nsSelect.e("selected-item"))},[qe(y,{closable:!e.selectDisabled&&!N.isDisabled,size:e.collapseTagSize,type:e.tagType,effect:e.tagEffect,"disable-transitions":"",style:Un(e.tagStyle),onClose:H=>e.deleteTag(H,N)},{default:ot(()=>[Ue("span",{class:fe(e.nsSelect.e("tags-text"))},[gt(e.$slots,"label",{label:N.currentLabel,value:N.value},()=>[Nr(fn(N.currentLabel),1)])],2)]),_:2},1032,["closable","size","type","effect","style","onClose"])],2))),128)),e.collapseTags&&e.states.selected.length>e.maxCollapseTags?(ae(),At(r,{key:0,ref:"tagTooltipRef",disabled:e.dropdownMenuVisible||!e.collapseTagsTooltip,"fallback-placements":["bottom","top","right","left"],effect:e.effect,placement:"bottom",teleported:e.teleported},{default:ot(()=>[Ue("div",{ref:"collapseItemRef",class:fe(e.nsSelect.e("selected-item"))},[qe(y,{closable:!1,size:e.collapseTagSize,type:e.tagType,effect:e.tagEffect,"disable-transitions":"",style:Un(e.collapseTagStyle)},{default:ot(()=>[Ue("span",{class:fe(e.nsSelect.e("tags-text"))}," + "+fn(e.states.selected.length-e.maxCollapseTags),3)]),_:1},8,["size","type","effect","style"])],2)]),content:ot(()=>[Ue("div",{ref:"tagMenuRef",class:fe(e.nsSelect.e("selection"))},[(ae(!0),Pe(Vn,null,Fr(e.collapseTagList,N=>(ae(),Pe("div",{key:e.getValueKey(N),class:fe(e.nsSelect.e("selected-item"))},[qe(y,{class:"in-tooltip",closable:!e.selectDisabled&&!N.isDisabled,size:e.collapseTagSize,type:e.tagType,effect:e.tagEffect,"disable-transitions":"",onClose:H=>e.deleteTag(H,N)},{default:ot(()=>[Ue("span",{class:fe(e.nsSelect.e("tags-text"))},[gt(e.$slots,"label",{label:N.currentLabel,value:N.value},()=>[Nr(fn(N.currentLabel),1)])],2)]),_:2},1032,["closable","size","type","effect","onClose"])],2))),128))],2)]),_:3},8,["disabled","effect","teleported"])):bt("v-if",!0)]):bt("v-if",!0),Ue("div",{class:fe([e.nsSelect.e("selected-item"),e.nsSelect.e("input-wrapper"),e.nsSelect.is("hidden",!e.filterable)])},[hr(Ue("input",{id:e.inputId,ref:"inputRef","onUpdate:modelValue":N=>e.states.inputValue=N,type:"text",name:e.name,class:fe([e.nsSelect.e("input"),e.nsSelect.is(e.selectSize)]),disabled:e.selectDisabled,autocomplete:e.autocomplete,style:Un(e.inputStyle),tabindex:e.tabindex,role:"combobox",readonly:!e.filterable,spellcheck:"false","aria-activedescendant":((V=e.hoverOption)==null?void 0:V.id)||"","aria-controls":e.contentId,"aria-expanded":e.dropdownMenuVisible,"aria-label":e.ariaLabel,"aria-autocomplete":"none","aria-haspopup":"listbox",onKeydown:[Ri(Jn(N=>e.navigateOptions("next"),["stop","prevent"]),["down"]),Ri(Jn(N=>e.navigateOptions("prev"),["stop","prevent"]),["up"]),Ri(Jn(e.handleEsc,["stop","prevent"]),["esc"]),Ri(Jn(e.selectOption,["stop","prevent"]),["enter"]),Ri(Jn(e.deletePrevTag,["stop"]),["delete"])],onCompositionstart:e.handleCompositionStart,onCompositionupdate:e.handleCompositionUpdate,onCompositionend:e.handleCompositionEnd,onInput:e.onInput,onClick:Jn(e.toggleMenu,["stop"])},null,46,["id","onUpdate:modelValue","name","disabled","autocomplete","tabindex","readonly","aria-activedescendant","aria-controls","aria-expanded","aria-label","onKeydown","onCompositionstart","onCompositionupdate","onCompositionend","onInput","onClick"]),[[rx,e.states.inputValue]]),e.filterable?(ae(),Pe("span",{key:0,ref:"calculatorRef","aria-hidden":"true",class:fe(e.nsSelect.e("input-calculator")),textContent:fn(e.states.inputValue)},null,10,["textContent"])):bt("v-if",!0)],2),e.shouldShowPlaceholder?(ae(),Pe("div",{key:1,class:fe([e.nsSelect.e("selected-item"),e.nsSelect.e("placeholder"),e.nsSelect.is("transparent",!e.hasModelValue||e.expanded&&!e.states.inputValue)])},[e.hasModelValue?gt(e.$slots,"label",{key:0,label:e.currentPlaceholder,value:e.modelValue},()=>[Ue("span",null,fn(e.currentPlaceholder),1)]):(ae(),Pe("span",{key:1},fn(e.currentPlaceholder),1))],2)):bt("v-if",!0)],2),Ue("div",{ref:"suffixRef",class:fe(e.nsSelect.e("suffix"))},[e.iconComponent&&!e.showClose?(ae(),At(S,{key:0,class:fe([e.nsSelect.e("caret"),e.nsSelect.e("icon"),e.iconReverse])},{default:ot(()=>[(ae(),At(Ir(e.iconComponent)))]),_:1},8,["class"])):bt("v-if",!0),e.showClose&&e.clearIcon?(ae(),At(S,{key:1,class:fe([e.nsSelect.e("caret"),e.nsSelect.e("icon"),e.nsSelect.e("clear")]),onClick:e.handleClearClick},{default:ot(()=>[(ae(),At(Ir(e.clearIcon)))]),_:1},8,["class","onClick"])):bt("v-if",!0),e.validateState&&e.validateIcon&&e.needStatusIcon?(ae(),At(S,{key:2,class:fe([e.nsInput.e("icon"),e.nsInput.e("validateIcon"),e.nsInput.is("loading",e.validateState==="validating")])},{default:ot(()=>[(ae(),At(Ir(e.validateIcon)))]),_:1},8,["class"])):bt("v-if",!0)],2)],10,["onClick"])]}),content:ot(()=>[qe(z,{ref:"menuRef"},{default:ot(()=>[e.$slots.header?(ae(),Pe("div",{key:0,class:fe(e.nsSelect.be("dropdown","header")),onClick:Jn(()=>{},["stop"])},[gt(e.$slots,"header")],10,["onClick"])):bt("v-if",!0),hr(qe(P,{id:e.contentId,ref:"scrollbarRef",tag:"ul","wrap-class":e.nsSelect.be("dropdown","wrap"),"view-class":e.nsSelect.be("dropdown","list"),class:fe([e.nsSelect.is("empty",e.filteredOptionsCount===0)]),role:"listbox","aria-label":e.ariaLabel,"aria-orientation":"vertical"},{default:ot(()=>[e.showNewOption?(ae(),At(C,{key:0,value:e.states.inputValue,created:!0},null,8,["value"])):bt("v-if",!0),qe(M,null,{default:ot(()=>[gt(e.$slots,"default")]),_:3})]),_:3},8,["id","wrap-class","view-class","class","aria-label"]),[[ii,e.states.options.size>0&&!e.loading]]),e.$slots.loading&&e.loading?(ae(),Pe("div",{key:1,class:fe(e.nsSelect.be("dropdown","loading"))},[gt(e.$slots,"loading")],2)):e.loading||e.filteredOptionsCount===0?(ae(),Pe("div",{key:2,class:fe(e.nsSelect.be("dropdown","empty"))},[gt(e.$slots,"empty",{},()=>[Ue("span",null,fn(e.emptyText),1)])],2)):bt("v-if",!0),e.$slots.footer?(ae(),Pe("div",{key:3,class:fe(e.nsSelect.be("dropdown","footer")),onClick:Jn(()=>{},["stop"])},[gt(e.$slots,"footer")],10,["onClick"])):bt("v-if",!0)]),_:3},512)]),_:3},8,["visible","placement","teleported","popper-class","popper-options","fallback-placements","effect","transition","persistent","append-to","show-arrow","offset","onBeforeShow","onHide"])],16,["onMouseleave"])),[[F,e.handleClickOutside,e.popperRef]])}var hse=dn(dse,[["render",fse],["__file","select.vue"]]);const pse=We({name:"ElOptionGroup",componentName:"ElOptionGroup",props:{label:String,disabled:Boolean},setup(e){const t=Xt("select"),o=xe(null),a=Cr(),d=xe([]);Vr(LF,si({...Go(e)}));const p=ee(()=>d.value.some(C=>C.visible===!0)),y=C=>{var M,P;return((M=C.type)==null?void 0:M.name)==="ElOption"&&!!((P=C.component)!=null&&P.proxy)},r=C=>{const M=Fs(C),P=[];return M.forEach(z=>{var F,V;y(z)?P.push(z.component.proxy):(F=z.children)!=null&&F.length?P.push(...r(z.children)):(V=z.component)!=null&&V.subTree&&P.push(...r(z.component.subTree))}),P},S=()=>{d.value=r(a.subTree)};return yr(()=>{S()}),hz(o,S,{attributes:!0,subtree:!0,childList:!0}),{groupRef:o,visible:p,ns:t}}});function mse(e,t,o,a,d,p){return hr((ae(),Pe("ul",{ref:"groupRef",class:fe(e.ns.be("group","wrap"))},[Ue("li",{class:fe(e.ns.be("group","title"))},fn(e.label),3),Ue("li",null,[Ue("ul",{class:fe(e.ns.b("group"))},[gt(e.$slots,"default")],2)])],2)),[[ii,e.visible]])}var DF=dn(pse,[["render",mse],["__file","option-group.vue"]]);const Ch=lr(hse,{Option:BE,OptionGroup:DF}),A1=oo(BE),gse=oo(DF),VE=()=>Pn(OF,{}),_se=un({pageSize:{type:Number,required:!0},pageSizes:{type:lt(Array),default:()=>io([10,20,30,40,50,100])},popperClass:{type:String},disabled:Boolean,teleported:Boolean,size:{type:String,values:ju},appendSizeTo:String}),yse=We({name:"ElPaginationSizes"}),vse=We({...yse,props:_se,emits:["page-size-change"],setup(e,{emit:t}){const o=e,{t:a}=qr(),d=Xt("pagination"),p=VE(),y=xe(o.pageSize);Wt(()=>o.pageSizes,(C,M)=>{if(!_s(C,M)&&sn(C)){const P=C.includes(o.pageSize)?o.pageSize:o.pageSizes[0];t("page-size-change",P)}}),Wt(()=>o.pageSize,C=>{y.value=C});const r=ee(()=>o.pageSizes);function S(C){var M;C!==y.value&&(y.value=C,(M=p.handleSizeChange)==null||M.call(p,Number(C)))}return(C,M)=>(ae(),Pe("span",{class:fe(b(d).e("sizes"))},[qe(b(Ch),{"model-value":y.value,disabled:C.disabled,"popper-class":C.popperClass,size:C.size,teleported:C.teleported,"validate-event":!1,"append-to":C.appendSizeTo,onChange:S},{default:ot(()=>[(ae(!0),Pe(Vn,null,Fr(b(r),P=>(ae(),At(b(A1),{key:P,value:P,label:P+b(a)("el.pagination.pagesize")},null,8,["value","label"]))),128))]),_:1},8,["model-value","disabled","popper-class","size","teleported","append-to"])],2))}});var bse=dn(vse,[["__file","sizes.vue"]]);const xse=un({size:{type:String,values:ju}}),wse=We({name:"ElPaginationJumper"}),Sse=We({...wse,props:xse,setup(e){const{t}=qr(),o=Xt("pagination"),{pageCount:a,disabled:d,currentPage:p,changeEvent:y}=VE(),r=xe(),S=ee(()=>{var P;return(P=r.value)!=null?P:p==null?void 0:p.value});function C(P){r.value=P?+P:""}function M(P){P=Math.trunc(+P),y==null||y(P),r.value=void 0}return(P,z)=>(ae(),Pe("span",{class:fe(b(o).e("jump")),disabled:b(d)},[Ue("span",{class:fe([b(o).e("goto")])},fn(b(t)("el.pagination.goto")),3),qe(b(Bs),{size:P.size,class:fe([b(o).e("editor"),b(o).is("in-pagination")]),min:1,max:b(a),disabled:b(d),"model-value":b(S),"validate-event":!1,"aria-label":b(t)("el.pagination.page"),type:"number","onUpdate:modelValue":C,onChange:M},null,8,["size","class","max","disabled","model-value","aria-label"]),Ue("span",{class:fe([b(o).e("classifier")])},fn(b(t)("el.pagination.pageClassifier")),3)],10,["disabled"]))}});var Tse=dn(Sse,[["__file","jumper.vue"]]);const Cse=un({total:{type:Number,default:1e3}}),Ese=We({name:"ElPaginationTotal"}),Mse=We({...Ese,props:Cse,setup(e){const{t}=qr(),o=Xt("pagination"),{disabled:a}=VE();return(d,p)=>(ae(),Pe("span",{class:fe(b(o).e("total")),disabled:b(a)},fn(b(t)("el.pagination.total",{total:d.total})),11,["disabled"]))}});var Ise=dn(Mse,[["__file","total.vue"]]);const Ase=un({currentPage:{type:Number,default:1},pageCount:{type:Number,required:!0},pagerCount:{type:Number,default:7},disabled:Boolean}),kse=We({name:"ElPaginationPager"}),Pse=We({...kse,props:Ase,emits:["change"],setup(e,{emit:t}){const o=e,a=Xt("pager"),d=Xt("icon"),{t:p}=qr(),y=xe(!1),r=xe(!1),S=xe(!1),C=xe(!1),M=xe(!1),P=xe(!1),z=ee(()=>{const q=o.pagerCount,J=(q-1)/2,re=Number(o.currentPage),se=Number(o.pageCount);let he=!1,le=!1;se>q&&(re>q-J&&(he=!0),re<se-J&&(le=!0));const ce=[];if(he&&!le){const pe=se-(q-2);for(let de=pe;de<se;de++)ce.push(de)}else if(!he&&le)for(let pe=2;pe<q;pe++)ce.push(pe);else if(he&&le){const pe=Math.floor(q/2)-1;for(let de=re-pe;de<=re+pe;de++)ce.push(de)}else for(let pe=2;pe<se;pe++)ce.push(pe);return ce}),F=ee(()=>["more","btn-quickprev",d.b(),a.is("disabled",o.disabled)]),V=ee(()=>["more","btn-quicknext",d.b(),a.is("disabled",o.disabled)]),N=ee(()=>o.disabled?-1:0);gs(()=>{const q=(o.pagerCount-1)/2;y.value=!1,r.value=!1,o.pageCount>o.pagerCount&&(o.currentPage>o.pagerCount-q&&(y.value=!0),o.currentPage<o.pageCount-q&&(r.value=!0))});function H(q=!1){o.disabled||(q?S.value=!0:C.value=!0)}function U(q=!1){q?M.value=!0:P.value=!0}function te(q){const J=q.target;if(J.tagName.toLowerCase()==="li"&&Array.from(J.classList).includes("number")){const re=Number(J.textContent);re!==o.currentPage&&t("change",re)}else J.tagName.toLowerCase()==="li"&&Array.from(J.classList).includes("more")&&Z(q)}function Z(q){const J=q.target;if(J.tagName.toLowerCase()==="ul"||o.disabled)return;let re=Number(J.textContent);const se=o.pageCount,he=o.currentPage,le=o.pagerCount-2;J.className.includes("more")&&(J.className.includes("quickprev")?re=he-le:J.className.includes("quicknext")&&(re=he+le)),Number.isNaN(+re)||(re<1&&(re=1),re>se&&(re=se)),re!==he&&t("change",re)}return(q,J)=>(ae(),Pe("ul",{class:fe(b(a).b()),onClick:Z,onKeyup:Ri(te,["enter"])},[q.pageCount>0?(ae(),Pe("li",{key:0,class:fe([[b(a).is("active",q.currentPage===1),b(a).is("disabled",q.disabled)],"number"]),"aria-current":q.currentPage===1,"aria-label":b(p)("el.pagination.currentPage",{pager:1}),tabindex:b(N)}," 1 ",10,["aria-current","aria-label","tabindex"])):bt("v-if",!0),y.value?(ae(),Pe("li",{key:1,class:fe(b(F)),tabindex:b(N),"aria-label":b(p)("el.pagination.prevPages",{pager:q.pagerCount-2}),onMouseenter:re=>H(!0),onMouseleave:re=>S.value=!1,onFocus:re=>U(!0),onBlur:re=>M.value=!1},[(S.value||M.value)&&!q.disabled?(ae(),At(b(Xd),{key:0})):(ae(),At(b(O3),{key:1}))],42,["tabindex","aria-label","onMouseenter","onMouseleave","onFocus","onBlur"])):bt("v-if",!0),(ae(!0),Pe(Vn,null,Fr(b(z),re=>(ae(),Pe("li",{key:re,class:fe([[b(a).is("active",q.currentPage===re),b(a).is("disabled",q.disabled)],"number"]),"aria-current":q.currentPage===re,"aria-label":b(p)("el.pagination.currentPage",{pager:re}),tabindex:b(N)},fn(re),11,["aria-current","aria-label","tabindex"]))),128)),r.value?(ae(),Pe("li",{key:2,class:fe(b(V)),tabindex:b(N),"aria-label":b(p)("el.pagination.nextPages",{pager:q.pagerCount-2}),onMouseenter:re=>H(),onMouseleave:re=>C.value=!1,onFocus:re=>U(),onBlur:re=>P.value=!1},[(C.value||P.value)&&!q.disabled?(ae(),At(b(Jd),{key:0})):(ae(),At(b(O3),{key:1}))],42,["tabindex","aria-label","onMouseenter","onMouseleave","onFocus","onBlur"])):bt("v-if",!0),q.pageCount>1?(ae(),Pe("li",{key:3,class:fe([[b(a).is("active",q.currentPage===q.pageCount),b(a).is("disabled",q.disabled)],"number"]),"aria-current":q.currentPage===q.pageCount,"aria-label":b(p)("el.pagination.currentPage",{pager:q.pageCount}),tabindex:b(N)},fn(q.pageCount),11,["aria-current","aria-label","tabindex"])):bt("v-if",!0)],42,["onKeyup"]))}});var Rse=dn(Pse,[["__file","pager.vue"]]);const Ws=e=>typeof e!="number",Ose=un({pageSize:Number,defaultPageSize:Number,total:Number,pageCount:Number,pagerCount:{type:Number,validator:e=>Wn(e)&&Math.trunc(e)===e&&e>4&&e<22&&e%2===1,default:7},currentPage:Number,defaultCurrentPage:Number,layout:{type:String,default:["prev","pager","next","jumper","->","total"].join(", ")},pageSizes:{type:lt(Array),default:()=>io([10,20,30,40,50,100])},popperClass:{type:String,default:""},prevText:{type:String,default:""},prevIcon:{type:Ai,default:()=>Yd},nextText:{type:String,default:""},nextIcon:{type:Ai,default:()=>ta},teleported:{type:Boolean,default:!0},small:Boolean,size:zo,background:Boolean,disabled:Boolean,hideOnSinglePage:Boolean,appendSizeTo:String}),Lse={"update:current-page":e=>Wn(e),"update:page-size":e=>Wn(e),"size-change":e=>Wn(e),change:(e,t)=>Wn(e)&&Wn(t),"current-change":e=>Wn(e),"prev-click":e=>Wn(e),"next-click":e=>Wn(e)},DR="ElPagination";var Dse=We({name:DR,props:Ose,emits:Lse,setup(e,{emit:t,slots:o}){const{t:a}=qr(),d=Xt("pagination"),p=Cr().vnode.props||{},y=bz(),r=ee(()=>{var J;return e.small?"small":(J=e.size)!=null?J:y.value});Ud({from:"small",replacement:"size",version:"3.0.0",scope:"el-pagination",ref:"https://element-plus.org/zh-CN/component/pagination.html"},ee(()=>!!e.small));const S="onUpdate:currentPage"in p||"onUpdate:current-page"in p||"onCurrentChange"in p,C="onUpdate:pageSize"in p||"onUpdate:page-size"in p||"onSizeChange"in p,M=ee(()=>{if(Ws(e.total)&&Ws(e.pageCount)||!Ws(e.currentPage)&&!S)return!1;if(e.layout.includes("sizes")){if(Ws(e.pageCount)){if(!Ws(e.total)&&!Ws(e.pageSize)&&!C)return!1}else if(!C)return!1}return!0}),P=xe(Ws(e.defaultPageSize)?10:e.defaultPageSize),z=xe(Ws(e.defaultCurrentPage)?1:e.defaultCurrentPage),F=ee({get(){return Ws(e.pageSize)?P.value:e.pageSize},set(J){Ws(e.pageSize)&&(P.value=J),C&&(t("update:page-size",J),t("size-change",J))}}),V=ee(()=>{let J=0;return Ws(e.pageCount)?Ws(e.total)||(J=Math.max(1,Math.ceil(e.total/F.value))):J=e.pageCount,J}),N=ee({get(){return Ws(e.currentPage)?z.value:e.currentPage},set(J){let re=J;J<1?re=1:J>V.value&&(re=V.value),Ws(e.currentPage)&&(z.value=re),S&&(t("update:current-page",re),t("current-change",re))}});Wt(V,J=>{N.value>J&&(N.value=J)}),Wt([N,F],J=>{t("change",...J)},{flush:"post"});function H(J){N.value=J}function U(J){F.value=J;const re=V.value;N.value>re&&(N.value=re)}function te(){e.disabled||(N.value-=1,t("prev-click",N.value))}function Z(){e.disabled||(N.value+=1,t("next-click",N.value))}function q(J,re){J&&(J.props||(J.props={}),J.props.class=[J.props.class,re].join(" "))}return Vr(OF,{pageCount:V,disabled:ee(()=>e.disabled),currentPage:N,changeEvent:H,handleSizeChange:U}),()=>{var J,re;if(!M.value)return a("el.pagination.deprecationWarning"),null;if(!e.layout||e.hideOnSinglePage&&V.value<=1)return null;const se=[],he=[],le=Zn("div",{class:d.e("rightwrapper")},he),ce={prev:Zn(Xoe,{disabled:e.disabled,currentPage:N.value,prevText:e.prevText,prevIcon:e.prevIcon,onClick:te}),jumper:Zn(Tse,{size:r.value}),pager:Zn(Rse,{currentPage:N.value,pageCount:V.value,pagerCount:e.pagerCount,onChange:H,disabled:e.disabled}),next:Zn(tse,{disabled:e.disabled,currentPage:N.value,pageCount:V.value,nextText:e.nextText,nextIcon:e.nextIcon,onClick:Z}),sizes:Zn(bse,{pageSize:F.value,pageSizes:e.pageSizes,popperClass:e.popperClass,disabled:e.disabled,teleported:e.teleported,size:r.value,appendSizeTo:e.appendSizeTo}),slot:(re=(J=o==null?void 0:o.default)==null?void 0:J.call(o))!=null?re:null,total:Zn(Ise,{total:Ws(e.total)?0:e.total})},pe=e.layout.split(",").map(Ie=>Ie.trim());let de=!1;return pe.forEach(Ie=>{if(Ie==="->"){de=!0;return}de?he.push(ce[Ie]):se.push(ce[Ie])}),q(se[0],d.is("first")),q(se[se.length-1],d.is("last")),de&&he.length>0&&(q(he[0],d.is("first")),q(he[he.length-1],d.is("last")),se.push(le)),Zn("div",{class:[d.b(),d.is("background",e.background),d.m(r.value)]},se)}}});const zse=lr(Dse),Fse=un({title:String,confirmButtonText:String,cancelButtonText:String,confirmButtonType:{type:String,values:tT,default:"primary"},cancelButtonType:{type:String,values:tT,default:"text"},icon:{type:Ai,default:()=>P7},iconColor:{type:String,default:"#f90"},hideIcon:{type:Boolean,default:!1},hideAfter:{type:Number,default:200},teleported:Jo.teleported,persistent:Jo.persistent,width:{type:[String,Number],default:150}}),Nse={confirm:e=>e instanceof MouseEvent,cancel:e=>e instanceof MouseEvent},Bse=We({name:"ElPopconfirm"}),Vse=We({...Bse,props:Fse,emits:Nse,setup(e,{emit:t}){const o=e,{t:a}=qr(),d=Xt("popconfirm"),p=xe(),y=()=>{var z,F;(F=(z=p.value)==null?void 0:z.onClose)==null||F.call(z)},r=ee(()=>({width:_o(o.width)})),S=z=>{t("confirm",z),y()},C=z=>{t("cancel",z),y()},M=ee(()=>o.confirmButtonText||a("el.popconfirm.confirmButtonText")),P=ee(()=>o.cancelButtonText||a("el.popconfirm.cancelButtonText"));return(z,F)=>(ae(),At(b(bs),kr({ref_key:"tooltipRef",ref:p,trigger:"click",effect:"light"},z.$attrs,{"popper-class":`${b(d).namespace.value}-popover`,"popper-style":b(r),teleported:z.teleported,"fallback-placements":["bottom","top","right","left"],"hide-after":z.hideAfter,persistent:z.persistent}),{content:ot(()=>[Ue("div",{class:fe(b(d).b())},[Ue("div",{class:fe(b(d).e("main"))},[!z.hideIcon&&z.icon?(ae(),At(b(zn),{key:0,class:fe(b(d).e("icon")),style:Un({color:z.iconColor})},{default:ot(()=>[(ae(),At(Ir(z.icon)))]),_:1},8,["class","style"])):bt("v-if",!0),Nr(" "+fn(z.title),1)],2),Ue("div",{class:fe(b(d).e("action"))},[gt(z.$slots,"actions",{confirm:S,cancel:C},()=>[qe(b(ts),{size:"small",type:z.cancelButtonType==="text"?"":z.cancelButtonType,text:z.cancelButtonType==="text",onClick:C},{default:ot(()=>[Nr(fn(b(P)),1)]),_:1},8,["type","text"]),qe(b(ts),{size:"small",type:z.confirmButtonType==="text"?"":z.confirmButtonType,text:z.confirmButtonType==="text",onClick:S},{default:ot(()=>[Nr(fn(b(M)),1)]),_:1},8,["type","text"])])],2)],2)]),default:ot(()=>[z.$slots.reference?gt(z.$slots,"reference",{key:0}):bt("v-if",!0)]),_:3},16,["popper-class","popper-style","teleported","hide-after","persistent"]))}});var $se=dn(Vse,[["__file","popconfirm.vue"]]);const Use=lr($se),jse=un({trigger:Fy.trigger,placement:Xb.placement,disabled:Fy.disabled,visible:Jo.visible,transition:Jo.transition,popperOptions:Xb.popperOptions,tabindex:Xb.tabindex,content:Jo.content,popperStyle:Jo.popperStyle,popperClass:Jo.popperClass,enterable:{...Jo.enterable,default:!0},effect:{...Jo.effect,default:"light"},teleported:Jo.teleported,title:String,width:{type:[String,Number],default:150},offset:{type:Number,default:void 0},showAfter:{type:Number,default:0},hideAfter:{type:Number,default:200},autoClose:{type:Number,default:0},showArrow:{type:Boolean,default:!0},persistent:{type:Boolean,default:!0},"onUpdate:visible":{type:Function}}),Hse={"update:visible":e=>Oi(e),"before-enter":()=>!0,"before-leave":()=>!0,"after-enter":()=>!0,"after-leave":()=>!0},Gse="onUpdate:visible",Wse=We({name:"ElPopover"}),qse=We({...Wse,props:jse,emits:Hse,setup(e,{expose:t,emit:o}){const a=e,d=ee(()=>a[Gse]),p=Xt("popover"),y=xe(),r=ee(()=>{var H;return(H=b(y))==null?void 0:H.popperRef}),S=ee(()=>[{width:_o(a.width)},a.popperStyle]),C=ee(()=>[p.b(),a.popperClass,{[p.m("plain")]:!!a.content}]),M=ee(()=>a.transition===`${p.namespace.value}-fade-in-linear`),P=()=>{var H;(H=y.value)==null||H.hide()},z=()=>{o("before-enter")},F=()=>{o("before-leave")},V=()=>{o("after-enter")},N=()=>{o("update:visible",!1),o("after-leave")};return t({popperRef:r,hide:P}),(H,U)=>(ae(),At(b(bs),kr({ref_key:"tooltipRef",ref:y},H.$attrs,{trigger:H.trigger,placement:H.placement,disabled:H.disabled,visible:H.visible,transition:H.transition,"popper-options":H.popperOptions,tabindex:H.tabindex,content:H.content,offset:H.offset,"show-after":H.showAfter,"hide-after":H.hideAfter,"auto-close":H.autoClose,"show-arrow":H.showArrow,"aria-label":H.title,effect:H.effect,enterable:H.enterable,"popper-class":b(C),"popper-style":b(S),teleported:H.teleported,persistent:H.persistent,"gpu-acceleration":b(M),"onUpdate:visible":b(d),onBeforeShow:z,onBeforeHide:F,onShow:V,onHide:N}),{content:ot(()=>[H.title?(ae(),Pe("div",{key:0,class:fe(b(p).e("title")),role:"title"},fn(H.title),3)):bt("v-if",!0),gt(H.$slots,"default",{},()=>[Nr(fn(H.content),1)])]),default:ot(()=>[H.$slots.reference?gt(H.$slots,"reference",{key:0}):bt("v-if",!0)]),_:3},16,["trigger","placement","disabled","visible","transition","popper-options","tabindex","content","offset","show-after","hide-after","auto-close","show-arrow","aria-label","effect","enterable","popper-class","popper-style","teleported","persistent","gpu-acceleration","onUpdate:visible"]))}});var Kse=dn(qse,[["__file","popover.vue"]]);const zR=(e,t)=>{const o=t.arg||t.value,a=o==null?void 0:o.popperRef;a&&(a.triggerRef=e)};var Zse={mounted(e,t){zR(e,t)},updated(e,t){zR(e,t)}};const Yse="popover",zF=B9(Zse,Yse),Xse=lr(Kse,{directive:zF}),Jse=un({type:{type:String,default:"line",values:["line","circle","dashboard"]},percentage:{type:Number,default:0,validator:e=>e>=0&&e<=100},status:{type:String,default:"",values:["","success","exception","warning"]},indeterminate:Boolean,duration:{type:Number,default:3},strokeWidth:{type:Number,default:6},strokeLinecap:{type:lt(String),default:"round"},textInside:Boolean,width:{type:Number,default:126},showText:{type:Boolean,default:!0},color:{type:lt([String,Array,Function]),default:""},striped:Boolean,stripedFlow:Boolean,format:{type:lt(Function),default:e=>`${e}%`}}),Qse=We({name:"ElProgress"}),eae=We({...Qse,props:Jse,setup(e){const t=e,o={success:"#13ce66",exception:"#ff4949",warning:"#e6a23c",default:"#20a0ff"},a=Xt("progress"),d=ee(()=>{const Z={width:`${t.percentage}%`,animationDuration:`${t.duration}s`},q=te(t.percentage);return q.includes("gradient")?Z.background=q:Z.backgroundColor=q,Z}),p=ee(()=>(t.strokeWidth/t.width*100).toFixed(1)),y=ee(()=>["circle","dashboard"].includes(t.type)?Number.parseInt(`${50-Number.parseFloat(p.value)/2}`,10):0),r=ee(()=>{const Z=y.value,q=t.type==="dashboard";return`
          M 50 50
          m 0 ${q?"":"-"}${Z}
          a ${Z} ${Z} 0 1 1 0 ${q?"-":""}${Z*2}
          a ${Z} ${Z} 0 1 1 0 ${q?"":"-"}${Z*2}
          `}),S=ee(()=>2*Math.PI*y.value),C=ee(()=>t.type==="dashboard"?.75:1),M=ee(()=>`${-1*S.value*(1-C.value)/2}px`),P=ee(()=>({strokeDasharray:`${S.value*C.value}px, ${S.value}px`,strokeDashoffset:M.value})),z=ee(()=>({strokeDasharray:`${S.value*C.value*(t.percentage/100)}px, ${S.value}px`,strokeDashoffset:M.value,transition:"stroke-dasharray 0.6s ease 0s, stroke 0.6s ease, opacity ease 0.6s"})),F=ee(()=>{let Z;return t.color?Z=te(t.percentage):Z=o[t.status]||o.default,Z}),V=ee(()=>t.status==="warning"?gx:t.type==="line"?t.status==="success"?QC:Fc:t.status==="success"?lv:Ql),N=ee(()=>t.type==="line"?12+t.strokeWidth*.4:t.width*.111111+2),H=ee(()=>t.format(t.percentage));function U(Z){const q=100/Z.length;return Z.map((re,se)=>Nn(re)?{color:re,percentage:(se+1)*q}:re).sort((re,se)=>re.percentage-se.percentage)}const te=Z=>{var q;const{color:J}=t;if($n(J))return J(Z);if(Nn(J))return J;{const re=U(J);for(const se of re)if(se.percentage>Z)return se.color;return(q=re[re.length-1])==null?void 0:q.color}};return(Z,q)=>(ae(),Pe("div",{class:fe([b(a).b(),b(a).m(Z.type),b(a).is(Z.status),{[b(a).m("without-text")]:!Z.showText,[b(a).m("text-inside")]:Z.textInside}]),role:"progressbar","aria-valuenow":Z.percentage,"aria-valuemin":"0","aria-valuemax":"100"},[Z.type==="line"?(ae(),Pe("div",{key:0,class:fe(b(a).b("bar"))},[Ue("div",{class:fe(b(a).be("bar","outer")),style:Un({height:`${Z.strokeWidth}px`})},[Ue("div",{class:fe([b(a).be("bar","inner"),{[b(a).bem("bar","inner","indeterminate")]:Z.indeterminate},{[b(a).bem("bar","inner","striped")]:Z.striped},{[b(a).bem("bar","inner","striped-flow")]:Z.stripedFlow}]),style:Un(b(d))},[(Z.showText||Z.$slots.default)&&Z.textInside?(ae(),Pe("div",{key:0,class:fe(b(a).be("bar","innerText"))},[gt(Z.$slots,"default",{percentage:Z.percentage},()=>[Ue("span",null,fn(b(H)),1)])],2)):bt("v-if",!0)],6)],6)],2)):(ae(),Pe("div",{key:1,class:fe(b(a).b("circle")),style:Un({height:`${Z.width}px`,width:`${Z.width}px`})},[(ae(),Pe("svg",{viewBox:"0 0 100 100"},[Ue("path",{class:fe(b(a).be("circle","track")),d:b(r),stroke:`var(${b(a).cssVarName("fill-color-light")}, #e5e9f2)`,"stroke-linecap":Z.strokeLinecap,"stroke-width":b(p),fill:"none",style:Un(b(P))},null,14,["d","stroke","stroke-linecap","stroke-width"]),Ue("path",{class:fe(b(a).be("circle","path")),d:b(r),stroke:b(F),fill:"none",opacity:Z.percentage?1:0,"stroke-linecap":Z.strokeLinecap,"stroke-width":b(p),style:Un(b(z))},null,14,["d","stroke","opacity","stroke-linecap","stroke-width"])]))],6)),(Z.showText||Z.$slots.default)&&!Z.textInside?(ae(),Pe("div",{key:2,class:fe(b(a).e("text")),style:Un({fontSize:`${b(N)}px`})},[gt(Z.$slots,"default",{percentage:Z.percentage},()=>[Z.status?(ae(),At(b(zn),{key:1},{default:ot(()=>[(ae(),At(Ir(b(V))))]),_:1})):(ae(),Pe("span",{key:0},fn(b(H)),1))])],6)):bt("v-if",!0)],10,["aria-valuenow"]))}});var tae=dn(eae,[["__file","progress.vue"]]);const FF=lr(tae),nae=un({modelValue:{type:Number,default:0},id:{type:String,default:void 0},lowThreshold:{type:Number,default:2},highThreshold:{type:Number,default:4},max:{type:Number,default:5},colors:{type:lt([Array,Object]),default:()=>io(["","",""])},voidColor:{type:String,default:""},disabledVoidColor:{type:String,default:""},icons:{type:lt([Array,Object]),default:()=>[wb,wb,wb]},voidIcon:{type:Ai,default:()=>W7},disabledVoidIcon:{type:Ai,default:()=>wb},disabled:Boolean,allowHalf:Boolean,showText:Boolean,showScore:Boolean,textColor:{type:String,default:""},texts:{type:lt(Array),default:()=>io(["Extremely bad","Disappointed","Fair","Satisfied","Surprise"])},scoreTemplate:{type:String,default:"{value}"},size:zo,clearable:Boolean,...cs(["ariaLabel"])}),rae={[Ii]:e=>Wn(e),[gr]:e=>Wn(e)},iae=We({name:"ElRate"}),oae=We({...iae,props:nae,emits:rae,setup(e,{expose:t,emit:o}){const a=e;function d(ye,Me){const we=Ge=>xr(Ge),me=Object.keys(Me).map(Ge=>+Ge).filter(Ge=>{const rt=Me[Ge];return(we(rt)?rt.excluded:!1)?ye<Ge:ye<=Ge}).sort((Ge,rt)=>Ge-rt),De=Me[me[0]];return we(De)&&De.value||De}const p=Pn(Rh,void 0),y=Pn(Nu,void 0),r=Ro(),S=Xt("rate"),{inputId:C,isLabeledByFormItem:M}=ml(a,{formItemContext:y}),P=xe(a.modelValue),z=xe(-1),F=xe(!0),V=ee(()=>[S.b(),S.m(r.value)]),N=ee(()=>a.disabled||(p==null?void 0:p.disabled)),H=ee(()=>S.cssVarBlock({"void-color":a.voidColor,"disabled-void-color":a.disabledVoidColor,"fill-color":q.value})),U=ee(()=>{let ye="";return a.showScore?ye=a.scoreTemplate.replace(/\{\s*value\s*\}/,N.value?`${a.modelValue}`:`${P.value}`):a.showText&&(ye=a.texts[Math.ceil(P.value)-1]),ye}),te=ee(()=>a.modelValue*100-Math.floor(a.modelValue)*100),Z=ee(()=>sn(a.colors)?{[a.lowThreshold]:a.colors[0],[a.highThreshold]:{value:a.colors[1],excluded:!0},[a.max]:a.colors[2]}:a.colors),q=ee(()=>{const ye=d(P.value,Z.value);return xr(ye)?"":ye}),J=ee(()=>{let ye="";return N.value?ye=`${te.value}%`:a.allowHalf&&(ye="50%"),{color:q.value,width:ye}}),re=ee(()=>{let ye=sn(a.icons)?[...a.icons]:{...a.icons};return ye=Ou(ye),sn(ye)?{[a.lowThreshold]:ye[0],[a.highThreshold]:{value:ye[1],excluded:!0},[a.max]:ye[2]}:ye}),se=ee(()=>d(a.modelValue,re.value)),he=ee(()=>N.value?Nn(a.disabledVoidIcon)?a.disabledVoidIcon:Ou(a.disabledVoidIcon):Nn(a.voidIcon)?a.voidIcon:Ou(a.voidIcon)),le=ee(()=>d(P.value,re.value));function ce(ye){const Me=N.value&&te.value>0&&ye-1<a.modelValue&&ye>a.modelValue,we=a.allowHalf&&F.value&&ye-.5<=P.value&&ye>P.value;return Me||we}function pe(ye){a.clearable&&ye===a.modelValue&&(ye=0),o(gr,ye),a.modelValue!==ye&&o("change",ye)}function de(ye){N.value||(a.allowHalf&&F.value?pe(P.value):pe(ye))}function Ie(ye){if(N.value)return;let Me=P.value;const we=ye.code;return we===Cn.up||we===Cn.right?(a.allowHalf?Me+=.5:Me+=1,ye.stopPropagation(),ye.preventDefault()):(we===Cn.left||we===Cn.down)&&(a.allowHalf?Me-=.5:Me-=1,ye.stopPropagation(),ye.preventDefault()),Me=Me<0?0:Me,Me=Me>a.max?a.max:Me,o(gr,Me),o("change",Me),Me}function Ve(ye,Me){if(!N.value){if(a.allowHalf&&Me){let we=Me.target;wa(we,S.e("item"))&&(we=we.querySelector(`.${S.e("icon")}`)),(we.clientWidth===0||wa(we,S.e("decimal")))&&(we=we.parentNode),F.value=Me.offsetX*2<=we.clientWidth,P.value=F.value?ye-.5:ye}else P.value=ye;z.value=ye}}function be(){N.value||(a.allowHalf&&(F.value=a.modelValue!==Math.floor(a.modelValue)),P.value=a.modelValue,z.value=-1)}return Wt(()=>a.modelValue,ye=>{P.value=ye,F.value=a.modelValue!==Math.floor(a.modelValue)}),a.modelValue||o(gr,0),t({setCurrentValue:Ve,resetCurrentValue:be}),(ye,Me)=>{var we;return ae(),Pe("div",{id:b(C),class:fe([b(V),b(S).is("disabled",b(N))]),role:"slider","aria-label":b(M)?void 0:ye.ariaLabel||"rating","aria-labelledby":b(M)?(we=b(y))==null?void 0:we.labelId:void 0,"aria-valuenow":P.value,"aria-valuetext":b(U)||void 0,"aria-valuemin":"0","aria-valuemax":ye.max,tabindex:"0",style:Un(b(H)),onKeydown:Ie},[(ae(!0),Pe(Vn,null,Fr(ye.max,(me,De)=>(ae(),Pe("span",{key:De,class:fe(b(S).e("item")),onMousemove:Ge=>Ve(me,Ge),onMouseleave:be,onClick:Ge=>de(me)},[qe(b(zn),{class:fe([b(S).e("icon"),{hover:z.value===me},b(S).is("active",me<=P.value)])},{default:ot(()=>[ce(me)?bt("v-if",!0):(ae(),Pe(Vn,{key:0},[hr((ae(),At(Ir(b(le)),null,null,512)),[[ii,me<=P.value]]),hr((ae(),At(Ir(b(he)),null,null,512)),[[ii,!(me<=P.value)]])],64)),ce(me)?(ae(),Pe(Vn,{key:1},[(ae(),At(Ir(b(he)),{class:fe([b(S).em("decimal","box")])},null,8,["class"])),qe(b(zn),{style:Un(b(J)),class:fe([b(S).e("icon"),b(S).e("decimal")])},{default:ot(()=>[(ae(),At(Ir(b(se))))]),_:1},8,["style","class"])],64)):bt("v-if",!0)]),_:2},1032,["class"])],42,["onMousemove","onClick"]))),128)),ye.showText||ye.showScore?(ae(),Pe("span",{key:0,class:fe(b(S).e("text")),style:Un({color:ye.textColor})},fn(b(U)),7)):bt("v-if",!0)],46,["id","aria-label","aria-labelledby","aria-valuenow","aria-valuetext","aria-valuemax"])}}});var sae=dn(oae,[["__file","rate.vue"]]);const aae=lr(sae),ym={success:"icon-success",warning:"icon-warning",error:"icon-error",info:"icon-info"},FR={[ym.success]:i7,[ym.warning]:gx,[ym.error]:eE,[ym.info]:tE},lae=un({title:{type:String,default:""},subTitle:{type:String,default:""},icon:{type:String,values:["success","warning","info","error"],default:"info"}}),uae=We({name:"ElResult"}),cae=We({...uae,props:lae,setup(e){const t=e,o=Xt("result"),a=ee(()=>{const d=t.icon,p=d&&ym[d]?ym[d]:"icon-info",y=FR[p]||FR["icon-info"];return{class:p,component:y}});return(d,p)=>(ae(),Pe("div",{class:fe(b(o).b())},[Ue("div",{class:fe(b(o).e("icon"))},[gt(d.$slots,"icon",{},()=>[b(a).component?(ae(),At(Ir(b(a).component),{key:0,class:fe(b(a).class)},null,8,["class"])):bt("v-if",!0)])],2),d.title||d.$slots.title?(ae(),Pe("div",{key:0,class:fe(b(o).e("title"))},[gt(d.$slots,"title",{},()=>[Ue("p",null,fn(d.title),1)])],2)):bt("v-if",!0),d.subTitle||d.$slots["sub-title"]?(ae(),Pe("div",{key:1,class:fe(b(o).e("subtitle"))},[gt(d.$slots,"sub-title",{},()=>[Ue("p",null,fn(d.subTitle),1)])],2)):bt("v-if",!0),d.$slots.extra?(ae(),Pe("div",{key:2,class:fe(b(o).e("extra"))},[gt(d.$slots,"extra")],2)):bt("v-if",!0)],2))}});var dae=dn(cae,[["__file","result.vue"]]);const fae=lr(dae),hae=["start","center","end","space-around","space-between","space-evenly"],pae=["top","middle","bottom"],mae=un({tag:{type:String,default:"div"},gutter:{type:Number,default:0},justify:{type:String,values:hae,default:"start"},align:{type:String,values:pae}}),gae=We({name:"ElRow"}),_ae=We({...gae,props:mae,setup(e){const t=e,o=Xt("row"),a=ee(()=>t.gutter);Vr(F4,{gutter:a});const d=ee(()=>{const y={};return t.gutter&&(y.marginRight=y.marginLeft=`-${t.gutter/2}px`),y}),p=ee(()=>[o.b(),o.is(`justify-${t.justify}`,t.justify!=="start"),o.is(`align-${t.align}`,!!t.align)]);return(y,r)=>(ae(),At(Ir(y.tag),{class:fe(b(p)),style:Un(b(d))},{default:ot(()=>[gt(y.$slots,"default")]),_:3},8,["class","style"]))}});var yae=dn(_ae,[["__file","row.vue"]]);const vae=lr(yae),bae=We({props:{item:{type:Object,required:!0},style:{type:Object},height:Number},setup(){return{ns:Xt("select")}}});function xae(e,t,o,a,d,p){return ae(),Pe("div",{class:fe(e.ns.be("group","title")),style:Un({...e.style,lineHeight:`${e.height}px`})},fn(e.item.label),7)}var wae=dn(bae,[["render",xae],["__file","group-item.vue"]]);function Sae(e,{emit:t}){return{hoverItem:()=>{e.disabled||t("hover",e.index)},selectOptionClick:()=>{e.disabled||t("select",e.item,e.index)}}}const NF={label:"label",value:"value",disabled:"disabled",options:"options"};function Ex(e){const t=ee(()=>({...NF,...e.props}));return{aliasProps:t,getLabel:y=>Eo(y,t.value.label),getValue:y=>Eo(y,t.value.value),getDisabled:y=>Eo(y,t.value.disabled),getOptions:y=>Eo(y,t.value.options)}}const Tae=un({allowCreate:Boolean,autocomplete:{type:lt(String),default:"none"},automaticDropdown:Boolean,clearable:Boolean,clearIcon:{type:Ai,default:Fc},effect:{type:lt(String),default:"light"},collapseTags:Boolean,collapseTagsTooltip:Boolean,maxCollapseTags:{type:Number,default:1},defaultFirstOption:Boolean,disabled:Boolean,estimatedOptionHeight:{type:Number,default:void 0},filterable:Boolean,filterMethod:Function,height:{type:Number,default:274},itemHeight:{type:Number,default:34},id:String,loading:Boolean,loadingText:String,modelValue:{type:lt([Array,String,Number,Boolean,Object])},multiple:Boolean,multipleLimit:{type:Number,default:0},name:String,noDataText:String,noMatchText:String,remoteMethod:Function,reserveKeyword:{type:Boolean,default:!0},options:{type:lt(Array),required:!0},placeholder:{type:String},teleported:Jo.teleported,persistent:{type:Boolean,default:!0},popperClass:{type:String,default:""},popperOptions:{type:lt(Object),default:()=>({})},remote:Boolean,size:zo,props:{type:lt(Object),default:()=>NF},valueKey:{type:String,default:"value"},scrollbarAlwaysOn:Boolean,validateEvent:{type:Boolean,default:!0},offset:{type:Number,default:12},showArrow:{type:Boolean,default:!0},placement:{type:lt(String),values:Nc,default:"bottom-start"},fallbackPlacements:{type:lt(Array),default:["bottom-start","top-start","right","left"]},tagType:{...kc.type,default:"info"},tagEffect:{...kc.effect,default:"light"},tabindex:{type:[String,Number],default:0},appendTo:String,fitInputWidth:{type:[Boolean,Number],default:!0,validator(e){return Oi(e)||Wn(e)}},...sg,...cs(["ariaLabel"])}),Cae=un({data:Array,disabled:Boolean,hovering:Boolean,item:{type:lt(Object),required:!0},index:Number,style:Object,selected:Boolean,created:Boolean}),Eae={[gr]:e=>!0,[Ii]:e=>!0,"remove-tag":e=>!0,"visible-change":e=>!0,focus:e=>e instanceof FocusEvent,blur:e=>e instanceof FocusEvent,clear:()=>!0},Mae={hover:e=>Wn(e),select:(e,t)=>!0},$E=Symbol("ElSelectV2Injection"),Iae=We({props:Cae,emits:Mae,setup(e,{emit:t}){const o=Pn($E),a=Xt("select"),{hoverItem:d,selectOptionClick:p}=Sae(e,{emit:t}),{getLabel:y}=Ex(o.props);return{ns:a,hoverItem:d,selectOptionClick:p,getLabel:y}}});function Aae(e,t,o,a,d,p){return ae(),Pe("li",{"aria-selected":e.selected,style:Un(e.style),class:fe([e.ns.be("dropdown","item"),e.ns.is("selected",e.selected),e.ns.is("disabled",e.disabled),e.ns.is("created",e.created),e.ns.is("hovering",e.hovering)]),onMousemove:e.hoverItem,onClick:Jn(e.selectOptionClick,["stop"])},[gt(e.$slots,"default",{item:e.item,index:e.index,disabled:e.disabled},()=>[Ue("span",null,fn(e.getLabel(e.item)),1)])],46,["aria-selected","onMousemove","onClick"])}var kae=dn(Iae,[["render",Aae],["__file","option-item.vue"]]),NR=Number.isNaN||function(t){return typeof t=="number"&&t!==t};function Pae(e,t){return!!(e===t||NR(e)&&NR(t))}function Rae(e,t){if(e.length!==t.length)return!1;for(var o=0;o<e.length;o++)if(!Pae(e[o],t[o]))return!1;return!0}function Oae(e,t){t===void 0&&(t=Rae);var o=null;function a(){for(var d=[],p=0;p<arguments.length;p++)d[p]=arguments[p];if(o&&o.lastThis===this&&t(d,o.lastArgs))return o.lastResult;var y=e.apply(this,d);return o={lastResult:y,lastArgs:d,lastThis:this},y}return a.clear=function(){o=null},a}const BF=()=>{const t=Cr().proxy.$props;return ee(()=>{const o=(a,d,p)=>({});return t.perfMode?ux(o):Oae(o)})},wT=50,k1="itemRendered",P1="scroll",vm="forward",R1="backward",sl="auto",Mx="smart",$y="start",Ru="center",Uy="end",Hm="horizontal",UE="vertical",Lae="ltr",Im="rtl",jy="negative",jE="positive-ascending",HE="positive-descending",Dae={[Hm]:"left",[UE]:"top"},zae=20,Fae={[Hm]:"deltaX",[UE]:"deltaY"},Nae=({atEndEdge:e,atStartEdge:t,layout:o},a)=>{let d,p=0;const y=S=>S<0&&t.value||S>0&&e.value;return{hasReachedEdge:y,onWheel:S=>{Th(d);const C=S[Fae[o.value]];y(p)&&y(p+C)||(p+=C,yx()||S.preventDefault(),d=Zd(()=>{a(p),p=0}))}}},ST=su({type:lt([Number,Function]),required:!0}),TT=su({type:Number}),CT=su({type:Number,default:2}),Bae=su({type:String,values:["ltr","rtl"],default:"ltr"}),ET=su({type:Number,default:0}),O1=su({type:Number,required:!0}),VF=su({type:String,values:["horizontal","vertical"],default:UE}),$F=un({className:{type:String,default:""},containerElement:{type:lt([String,Object]),default:"div"},data:{type:lt(Array),default:()=>io([])},direction:Bae,height:{type:[String,Number],required:!0},innerElement:{type:[String,Object],default:"div"},style:{type:lt([Object,String,Array])},useIsScrolling:{type:Boolean,default:!1},width:{type:[Number,String],required:!1},perfMode:{type:Boolean,default:!0},scrollbarAlwaysOn:{type:Boolean,default:!1}}),UF=un({cache:CT,estimatedItemSize:TT,layout:VF,initScrollOffset:ET,total:O1,itemSize:ST,...$F}),MT={type:Number,default:6},jF={type:Number,default:0},HF={type:Number,default:2},yh=un({columnCache:CT,columnWidth:ST,estimatedColumnWidth:TT,estimatedRowHeight:TT,initScrollLeft:ET,initScrollTop:ET,itemKey:{type:lt(Function),default:({columnIndex:e,rowIndex:t})=>`${t}:${e}`},rowCache:CT,rowHeight:ST,totalColumn:O1,totalRow:O1,hScrollbarSize:MT,vScrollbarSize:MT,scrollbarStartGap:jF,scrollbarEndGap:HF,role:String,...$F}),GF=un({alwaysOn:Boolean,class:String,layout:VF,total:O1,ratio:{type:Number,required:!0},clientSize:{type:Number,required:!0},scrollFrom:{type:Number,required:!0},scrollbarSize:MT,startGap:jF,endGap:HF,visible:Boolean}),ch=(e,t)=>e<t?vm:R1,Hy=e=>e===Lae||e===Im||e===Hm,BR=e=>e===Im;let um=null;function L1(e=!1){if(um===null||e){const t=document.createElement("div"),o=t.style;o.width="50px",o.height="50px",o.overflow="scroll",o.direction="rtl";const a=document.createElement("div"),d=a.style;return d.width="100px",d.height="100px",t.appendChild(a),document.body.appendChild(t),t.scrollLeft>0?um=HE:(t.scrollLeft=1,t.scrollLeft===0?um=jy:um=jE),document.body.removeChild(t),um}return um}function Vae({move:e,size:t,bar:o},a){const d={},p=`translate${o.axis}(${e}px)`;return d[o.size]=t,d.transform=p,d.msTransform=p,d.webkitTransform=p,a==="horizontal"?d.height="100%":d.width="100%",d}const IT=We({name:"ElVirtualScrollBar",props:GF,emits:["scroll","start-move","stop-move"],setup(e,{emit:t}){const o=ee(()=>e.startGap+e.endGap),a=Xt("virtual-scrollbar"),d=Xt("scrollbar"),p=xe(),y=xe();let r=null,S=null;const C=si({isDragging:!1,traveled:0}),M=ee(()=>Lz[e.layout]),P=ee(()=>e.clientSize-b(o)),z=ee(()=>({position:"absolute",width:`${Hm===e.layout?P.value:e.scrollbarSize}px`,height:`${Hm===e.layout?e.scrollbarSize:P.value}px`,[Dae[e.layout]]:"2px",right:"2px",bottom:"2px",borderRadius:"4px"})),F=ee(()=>{const re=e.ratio,se=e.clientSize;if(re>=100)return Number.POSITIVE_INFINITY;if(re>=50)return re*se/100;const he=se/3;return Math.floor(Math.min(Math.max(re*se,zae),he))}),V=ee(()=>{if(!Number.isFinite(F.value))return{display:"none"};const re=`${F.value}px`;return Vae({bar:M.value,size:re,move:C.traveled},e.layout)}),N=ee(()=>Math.floor(e.clientSize-F.value-b(o))),H=()=>{window.addEventListener("mousemove",q),window.addEventListener("mouseup",Z);const re=b(y);re&&(S=document.onselectstart,document.onselectstart=()=>!1,re.addEventListener("touchmove",q,{passive:!0}),re.addEventListener("touchend",Z))},U=()=>{window.removeEventListener("mousemove",q),window.removeEventListener("mouseup",Z),document.onselectstart=S,S=null;const re=b(y);re&&(re.removeEventListener("touchmove",q),re.removeEventListener("touchend",Z))},te=re=>{re.stopImmediatePropagation(),!(re.ctrlKey||[1,2].includes(re.button))&&(C.isDragging=!0,C[M.value.axis]=re.currentTarget[M.value.offset]-(re[M.value.client]-re.currentTarget.getBoundingClientRect()[M.value.direction]),t("start-move"),H())},Z=()=>{C.isDragging=!1,C[M.value.axis]=0,t("stop-move"),U()},q=re=>{const{isDragging:se}=C;if(!se||!y.value||!p.value)return;const he=C[M.value.axis];if(!he)return;Th(r);const le=(p.value.getBoundingClientRect()[M.value.direction]-re[M.value.client])*-1,ce=y.value[M.value.offset]-he,pe=le-ce;r=Zd(()=>{C.traveled=Math.max(e.startGap,Math.min(pe,N.value)),t("scroll",pe,N.value)})},J=re=>{const se=Math.abs(re.target.getBoundingClientRect()[M.value.direction]-re[M.value.client]),he=y.value[M.value.offset]/2,le=se-he;C.traveled=Math.max(0,Math.min(le,N.value)),t("scroll",le,N.value)};return Wt(()=>e.scrollFrom,re=>{C.isDragging||(C.traveled=Math.ceil(re*N.value))}),Li(()=>{U()}),()=>Zn("div",{role:"presentation",ref:p,class:[a.b(),e.class,(e.alwaysOn||C.isDragging)&&"always-on"],style:z.value,onMousedown:Jn(J,["stop","prevent"]),onTouchstartPrevent:te},Zn("div",{ref:y,class:d.e("thumb"),style:V.value,onMousedown:te},[]))}}),WF=({name:e,getOffset:t,getItemSize:o,getItemOffset:a,getEstimatedTotalSize:d,getStartIndexForOffset:p,getStopIndexForStartIndex:y,initCache:r,clearCache:S,validateProps:C})=>We({name:e??"ElVirtualList",props:UF,emits:[k1,P1],setup(M,{emit:P,expose:z}){C(M);const F=Cr(),V=Xt("vl"),N=xe(r(M,F)),H=BF(),U=xe(),te=xe(),Z=xe(),q=xe({isScrolling:!1,scrollDir:"forward",scrollOffset:Wn(M.initScrollOffset)?M.initScrollOffset:0,updateRequested:!1,isScrollbarDragging:!1,scrollbarAlwaysOn:M.scrollbarAlwaysOn}),J=ee(()=>{const{total:Oe,cache:Ct}=M,{isScrolling:kt,scrollDir:Bt,scrollOffset:_t}=b(q);if(Oe===0)return[0,0,0,0];const jt=p(M,_t,b(N)),Gt=y(M,jt,_t,b(N)),Ne=!kt||Bt===R1?Math.max(1,Ct):1,an=!kt||Bt===vm?Math.max(1,Ct):1;return[Math.max(0,jt-Ne),Math.max(0,Math.min(Oe-1,Gt+an)),jt,Gt]}),re=ee(()=>d(M,b(N))),se=ee(()=>Hy(M.layout)),he=ee(()=>[{position:"relative",[`overflow-${se.value?"x":"y"}`]:"scroll",WebkitOverflowScrolling:"touch",willChange:"transform"},{direction:M.direction,height:Wn(M.height)?`${M.height}px`:M.height,width:Wn(M.width)?`${M.width}px`:M.width},M.style]),le=ee(()=>{const Oe=b(re),Ct=b(se);return{height:Ct?"100%":`${Oe}px`,pointerEvents:b(q).isScrolling?"none":void 0,width:Ct?`${Oe}px`:"100%"}}),ce=ee(()=>se.value?M.width:M.height),{onWheel:pe}=Nae({atStartEdge:ee(()=>q.value.scrollOffset<=0),atEndEdge:ee(()=>q.value.scrollOffset>=re.value),layout:ee(()=>M.layout)},Oe=>{var Ct,kt;(kt=(Ct=Z.value).onMouseUp)==null||kt.call(Ct),Me(Math.min(q.value.scrollOffset+Oe,re.value-ce.value))});Si(U,"wheel",pe,{passive:!1});const de=()=>{const{total:Oe}=M;if(Oe>0){const[_t,jt,Gt,Ne]=b(J);P(k1,_t,jt,Gt,Ne)}const{scrollDir:Ct,scrollOffset:kt,updateRequested:Bt}=b(q);P(P1,Ct,kt,Bt)},Ie=Oe=>{const{clientHeight:Ct,scrollHeight:kt,scrollTop:Bt}=Oe.currentTarget,_t=b(q);if(_t.scrollOffset===Bt)return;const jt=Math.max(0,Math.min(Bt,kt-Ct));q.value={..._t,isScrolling:!0,scrollDir:ch(_t.scrollOffset,jt),scrollOffset:jt,updateRequested:!1},jn(De)},Ve=Oe=>{const{clientWidth:Ct,scrollLeft:kt,scrollWidth:Bt}=Oe.currentTarget,_t=b(q);if(_t.scrollOffset===kt)return;const{direction:jt}=M;let Gt=kt;if(jt===Im)switch(L1()){case jy:{Gt=-kt;break}case HE:{Gt=Bt-Ct-kt;break}}Gt=Math.max(0,Math.min(Gt,Bt-Ct)),q.value={..._t,isScrolling:!0,scrollDir:ch(_t.scrollOffset,Gt),scrollOffset:Gt,updateRequested:!1},jn(De)},be=Oe=>{b(se)?Ve(Oe):Ie(Oe),de()},ye=(Oe,Ct)=>{const kt=(re.value-ce.value)/Ct*Oe;Me(Math.min(re.value-ce.value,kt))},Me=Oe=>{Oe=Math.max(Oe,0),Oe!==b(q).scrollOffset&&(q.value={...b(q),scrollOffset:Oe,scrollDir:ch(b(q).scrollOffset,Oe),updateRequested:!0},jn(De))},we=(Oe,Ct=sl)=>{const{scrollOffset:kt}=b(q);Oe=Math.max(0,Math.min(Oe,M.total-1)),Me(t(M,Oe,Ct,kt,b(N)))},me=Oe=>{const{direction:Ct,itemSize:kt,layout:Bt}=M,_t=H.value(S&&kt,S&&Bt,S&&Ct);let jt;if(ri(_t,String(Oe)))jt=_t[Oe];else{const Gt=a(M,Oe,b(N)),Ne=o(M,Oe,b(N)),an=b(se),Ae=Ct===Im,tt=an?Gt:0;_t[Oe]=jt={position:"absolute",left:Ae?void 0:`${tt}px`,right:Ae?`${tt}px`:void 0,top:an?0:`${Gt}px`,height:an?"100%":`${Ne}px`,width:an?`${Ne}px`:"100%"}}return jt},De=()=>{q.value.isScrolling=!1,jn(()=>{H.value(-1,null,null)})},Ge=()=>{const Oe=U.value;Oe&&(Oe.scrollTop=0)};yr(()=>{if(!Wr)return;const{initScrollOffset:Oe}=M,Ct=b(U);Wn(Oe)&&Ct&&(b(se)?Ct.scrollLeft=Oe:Ct.scrollTop=Oe),de()}),Uu(()=>{const{direction:Oe,layout:Ct}=M,{scrollOffset:kt,updateRequested:Bt}=b(q),_t=b(U);if(Bt&&_t)if(Ct===Hm)if(Oe===Im)switch(L1()){case jy:{_t.scrollLeft=-kt;break}case jE:{_t.scrollLeft=kt;break}default:{const{clientWidth:jt,scrollWidth:Gt}=_t;_t.scrollLeft=Gt-jt-kt;break}}else _t.scrollLeft=kt;else _t.scrollTop=kt}),TC(()=>{b(U).scrollTop=b(q).scrollOffset});const rt={ns:V,clientSize:ce,estimatedTotalSize:re,windowStyle:he,windowRef:U,innerRef:te,innerStyle:le,itemsToRender:J,scrollbarRef:Z,states:q,getItemStyle:me,onScroll:be,onScrollbarScroll:ye,onWheel:pe,scrollTo:Me,scrollToItem:we,resetScrollTop:Ge};return z({windowRef:U,innerRef:te,getItemStyleCache:H,scrollTo:Me,scrollToItem:we,resetScrollTop:Ge,states:q}),rt},render(M){var P;const{$slots:z,className:F,clientSize:V,containerElement:N,data:H,getItemStyle:U,innerElement:te,itemsToRender:Z,innerStyle:q,layout:J,total:re,onScroll:se,onScrollbarScroll:he,states:le,useIsScrolling:ce,windowStyle:pe,ns:de}=M,[Ie,Ve]=Z,be=Ir(N),ye=Ir(te),Me=[];if(re>0)for(let Ge=Ie;Ge<=Ve;Ge++)Me.push(Zn(Vn,{key:Ge},(P=z.default)==null?void 0:P.call(z,{data:H,index:Ge,isScrolling:ce?le.isScrolling:void 0,style:U(Ge)})));const we=[Zn(ye,{style:q,ref:"innerRef"},Nn(ye)?Me:{default:()=>Me})],me=Zn(IT,{ref:"scrollbarRef",clientSize:V,layout:J,onScroll:he,ratio:V*100/this.estimatedTotalSize,scrollFrom:le.scrollOffset/(this.estimatedTotalSize-V),total:re}),De=Zn(be,{class:[de.e("window"),F],style:pe,onScroll:se,ref:"windowRef",key:0},Nn(be)?[we]:{default:()=>[we]});return Zn("div",{key:0,class:[de.e("wrapper"),le.scrollbarAlwaysOn?"always-on":""]},[De,me])}}),qF=WF({name:"ElFixedSizeList",getItemOffset:({itemSize:e},t)=>t*e,getItemSize:({itemSize:e})=>e,getEstimatedTotalSize:({total:e,itemSize:t})=>t*e,getOffset:({height:e,total:t,itemSize:o,layout:a,width:d},p,y,r)=>{const S=Hy(a)?d:e,C=Math.max(0,t*o-S),M=Math.min(C,p*o),P=Math.max(0,(p+1)*o-S);switch(y===Mx&&(r>=P-S&&r<=M+S?y=sl:y=Ru),y){case $y:return M;case Uy:return P;case Ru:{const z=Math.round(P+(M-P)/2);return z<Math.ceil(S/2)?0:z>C+Math.floor(S/2)?C:z}case sl:default:return r>=P&&r<=M?r:r<P?P:M}},getStartIndexForOffset:({total:e,itemSize:t},o)=>Math.max(0,Math.min(e-1,Math.floor(o/t))),getStopIndexForStartIndex:({height:e,total:t,itemSize:o,layout:a,width:d},p,y)=>{const r=p*o,S=Hy(a)?d:e,C=Math.ceil((S+y-r)/o);return Math.max(0,Math.min(t-1,p+C-1))},initCache(){},clearCache:!0,validateProps(){}}),bm=(e,t,o)=>{const{itemSize:a}=e,{items:d,lastVisitedIndex:p}=o;if(t>p){let y=0;if(p>=0){const r=d[p];y=r.offset+r.size}for(let r=p+1;r<=t;r++){const S=a(r);d[r]={offset:y,size:S},y+=S}o.lastVisitedIndex=t}return d[t]},$ae=(e,t,o)=>{const{items:a,lastVisitedIndex:d}=t;return(d>0?a[d].offset:0)>=o?KF(e,t,0,d,o):Uae(e,t,Math.max(0,d),o)},KF=(e,t,o,a,d)=>{for(;o<=a;){const p=o+Math.floor((a-o)/2),y=bm(e,p,t).offset;if(y===d)return p;y<d?o=p+1:y>d&&(a=p-1)}return Math.max(0,o-1)},Uae=(e,t,o,a)=>{const{total:d}=e;let p=1;for(;o<d&&bm(e,o,t).offset<a;)o+=p,p*=2;return KF(e,t,Math.floor(o/2),Math.min(o,d-1),a)},VR=({total:e},{items:t,estimatedItemSize:o,lastVisitedIndex:a})=>{let d=0;if(a>=e&&(a=e-1),a>=0){const r=t[a];d=r.offset+r.size}const y=(e-a-1)*o;return d+y},jae=WF({name:"ElDynamicSizeList",getItemOffset:(e,t,o)=>bm(e,t,o).offset,getItemSize:(e,t,{items:o})=>o[t].size,getEstimatedTotalSize:VR,getOffset:(e,t,o,a,d)=>{const{height:p,layout:y,width:r}=e,S=Hy(y)?r:p,C=bm(e,t,d),M=VR(e,d),P=Math.max(0,Math.min(M-S,C.offset)),z=Math.max(0,C.offset-S+C.size);switch(o===Mx&&(a>=z-S&&a<=P+S?o=sl:o=Ru),o){case $y:return P;case Uy:return z;case Ru:return Math.round(z+(P-z)/2);case sl:default:return a>=z&&a<=P?a:a<z?z:P}},getStartIndexForOffset:(e,t,o)=>$ae(e,o,t),getStopIndexForStartIndex:(e,t,o,a)=>{const{height:d,total:p,layout:y,width:r}=e,S=Hy(y)?r:d,C=bm(e,t,a),M=o+S;let P=C.offset+C.size,z=t;for(;z<p-1&&P<M;)z++,P+=bm(e,z,a).size;return z},initCache({estimatedItemSize:e=wT},t){const o={items:{},estimatedItemSize:e,lastVisitedIndex:-1};return o.clearCacheAfterIndex=(a,d=!0)=>{var p,y;o.lastVisitedIndex=Math.min(o.lastVisitedIndex,a-1),(p=t.exposed)==null||p.getItemStyleCache(-1),d&&((y=t.proxy)==null||y.$forceUpdate())},o},clearCache:!1,validateProps:({itemSize:e})=>{}}),Hae={loading:Boolean,data:{type:Array,required:!0},hoveringIndex:Number,width:Number};var Gae=We({name:"ElSelectDropdown",props:Hae,setup(e,{slots:t,expose:o}){const a=Pn($E),d=Xt("select"),{getLabel:p,getValue:y,getDisabled:r}=Ex(a.props),S=xe([]),C=xe(),M=ee(()=>e.data.length);Wt(()=>M.value,()=>{var pe,de;(de=(pe=a.tooltipRef.value).updatePopper)==null||de.call(pe)});const P=ee(()=>ai(a.props.estimatedOptionHeight)),z=ee(()=>P.value?{itemSize:a.props.itemHeight}:{estimatedSize:a.props.estimatedOptionHeight,itemSize:pe=>S.value[pe]}),F=(pe=[],de)=>{const{props:{valueKey:Ie}}=a;return xr(de)?pe&&pe.some(Ve=>wi(Eo(Ve,Ie))===Eo(de,Ie)):pe.includes(de)},V=(pe,de)=>{if(xr(de)){const{valueKey:Ie}=a.props;return Eo(pe,Ie)===Eo(de,Ie)}else return pe===de},N=(pe,de)=>a.props.multiple?F(pe,y(de)):V(pe,y(de)),H=(pe,de)=>{const{disabled:Ie,multiple:Ve,multipleLimit:be}=a.props;return Ie||!de&&(Ve?be>0&&pe.length>=be:!1)},U=pe=>e.hoveringIndex===pe;o({listRef:C,isSized:P,isItemDisabled:H,isItemHovering:U,isItemSelected:N,scrollToItem:pe=>{const de=C.value;de&&de.scrollToItem(pe)},resetScrollTop:()=>{const pe=C.value;pe&&pe.resetScrollTop()}});const J=pe=>{const{index:de,data:Ie,style:Ve}=pe,be=b(P),{itemSize:ye,estimatedSize:Me}=b(z),{modelValue:we}=a.props,{onSelect:me,onHover:De}=a,Ge=Ie[de];if(Ge.type==="Group")return qe(wae,{item:Ge,style:Ve,height:be?ye:Me},null);const rt=N(we,Ge),Oe=H(we,rt),Ct=U(de);return qe(kae,kr(pe,{selected:rt,disabled:r(Ge)||Oe,created:!!Ge.created,hovering:Ct,item:Ge,onSelect:me,onHover:De}),{default:kt=>{var Bt;return((Bt=t.default)==null?void 0:Bt.call(t,kt))||qe("span",null,[p(Ge)])}})},{onKeyboardNavigate:re,onKeyboardSelect:se}=a,he=()=>{re("forward")},le=()=>{re("backward")},ce=pe=>{const{code:de}=pe,{tab:Ie,esc:Ve,down:be,up:ye,enter:Me,numpadEnter:we}=Cn;switch(de!==Ie&&(pe.preventDefault(),pe.stopPropagation()),de){case Ie:case Ve:break;case be:he();break;case ye:le();break;case Me:case we:se();break}};return()=>{var pe,de,Ie,Ve;const{data:be,width:ye}=e,{height:Me,multiple:we,scrollbarAlwaysOn:me}=a.props,De=b(P)?qF:jae;return qe("div",{class:[d.b("dropdown"),d.is("multiple",we)],style:{width:`${ye}px`}},[(pe=t.header)==null?void 0:pe.call(t),((de=t.loading)==null?void 0:de.call(t))||((Ie=t.empty)==null?void 0:Ie.call(t))||qe(De,kr({ref:C},b(z),{className:d.be("dropdown","list"),scrollbarAlwaysOn:me,data:be,height:Me,width:ye,total:be.length,onKeydown:ce}),{default:Ge=>qe(J,Ge,null)}),(Ve=t.footer)==null?void 0:Ve.call(t)])}}});function Wae(e,t){const{aliasProps:o,getLabel:a,getValue:d}=Ex(e),p=xe(0),y=xe(),r=ee(()=>e.allowCreate&&e.filterable);function S(F){const V=N=>a(N)===F;return e.options&&e.options.some(V)||t.createdOptions.some(V)}function C(F){r.value&&(e.multiple&&F.created?p.value++:y.value=F)}function M(F){if(r.value)if(F&&F.length>0){if(S(F))return;const V={[o.value.value]:F,[o.value.label]:F,created:!0,[o.value.disabled]:!1};t.createdOptions.length>=p.value?t.createdOptions[p.value]=V:t.createdOptions.push(V)}else if(e.multiple)t.createdOptions.length=p.value;else{const V=y.value;t.createdOptions.length=0,V&&V.created&&t.createdOptions.push(V)}}function P(F){if(!r.value||!F||!F.created||F.created&&e.reserveKeyword&&t.inputValue===a(F))return;const V=t.createdOptions.findIndex(N=>d(N)===d(F));~V&&(t.createdOptions.splice(V,1),p.value--)}function z(){r.value&&(t.createdOptions.length=0,p.value=0)}return{createNewOption:M,removeNewOption:P,selectNewOption:C,clearAllNewOption:z}}const qae=(e,t)=>{const{t:o}=qr(),a=Xt("select"),d=Xt("input"),{form:p,formItem:y}=xs(),{inputId:r}=ml(e,{formItemContext:y}),{aliasProps:S,getLabel:C,getValue:M,getDisabled:P,getOptions:z}=Ex(e),{valueOnClear:F,isEmptyValue:V}=hx(e),N=si({inputValue:"",cachedOptions:[],createdOptions:[],hoveringIndex:-1,inputHovering:!1,selectionWidth:0,collapseItemWidth:0,previousQuery:null,previousValue:void 0,selectedLabel:"",menuVisibleOnFocus:!1,isBeforeHide:!1}),H=xe(-1),U=xe(),te=xe(),Z=xe(),q=xe(),J=xe(),re=xe(),se=xe(),he=xe(),le=xe(),ce=xe(),{isComposing:pe,handleCompositionStart:de,handleCompositionEnd:Ie,handleCompositionUpdate:Ve}=cv({afterComposition:Yt=>Mn(Yt)}),{wrapperRef:be,isFocused:ye,handleBlur:Me}=af(J,{beforeFocus(){return Ge.value},afterFocus(){e.automaticDropdown&&!De.value&&(De.value=!0,N.menuVisibleOnFocus=!0)},beforeBlur(Yt){var wn,Kn;return((wn=Z.value)==null?void 0:wn.isFocusInsideContent(Yt))||((Kn=q.value)==null?void 0:Kn.isFocusInsideContent(Yt))},afterBlur(){De.value=!1,N.menuVisibleOnFocus=!1}}),we=xe([]),me=xe([]),De=xe(!1),Ge=ee(()=>e.disabled||(p==null?void 0:p.disabled)),rt=ee(()=>{var Yt;return(Yt=p==null?void 0:p.statusIcon)!=null?Yt:!1}),Oe=ee(()=>{const Yt=me.value.length*e.itemHeight;return Yt>e.height?e.height:Yt}),Ct=ee(()=>e.multiple?sn(e.modelValue)&&e.modelValue.length>0:!V(e.modelValue)),kt=ee(()=>e.clearable&&!Ge.value&&N.inputHovering&&Ct.value),Bt=ee(()=>e.remote&&e.filterable?"":zc),_t=ee(()=>Bt.value&&a.is("reverse",De.value)),jt=ee(()=>(y==null?void 0:y.validateState)||""),Gt=ee(()=>{if(jt.value)return _x[jt.value]}),Ne=ee(()=>e.remote?300:0),an=ee(()=>e.loading?e.loadingText||o("el.select.loading"):e.remote&&!N.inputValue&&we.value.length===0?!1:e.filterable&&N.inputValue&&we.value.length>0&&me.value.length===0?e.noMatchText||o("el.select.noMatch"):we.value.length===0?e.noDataText||o("el.select.noData"):null),Ae=Yt=>{const wn=Kn=>{if(e.filterable&&$n(e.filterMethod)||e.filterable&&e.remote&&$n(e.remoteMethod))return!0;const Qn=new RegExp(xE(Yt),"i");return Yt?Qn.test(C(Kn)||""):!0};return e.loading?[]:[...N.createdOptions,...e.options].reduce((Kn,Qn)=>{const di=z(Qn);if(sn(di)){const eo=di.filter(wn);eo.length>0&&Kn.push({label:C(Qn),type:"Group"},...eo)}else(e.remote||wn(Qn))&&Kn.push(Qn);return Kn},[])},tt=()=>{we.value=Ae(""),me.value=Ae(N.inputValue)},Je=ee(()=>{const Yt=new Map;return we.value.forEach((wn,Kn)=>{Yt.set(ci(M(wn)),{option:wn,index:Kn})}),Yt}),Jt=ee(()=>{const Yt=new Map;return me.value.forEach((wn,Kn)=>{Yt.set(ci(M(wn)),{option:wn,index:Kn})}),Yt}),Kt=ee(()=>me.value.every(Yt=>P(Yt))),Nt=Ro(),Pt=ee(()=>Nt.value==="small"?"small":"default"),Dt=()=>{var Yt;if(Wn(e.fitInputWidth)){H.value=e.fitInputWidth;return}const wn=((Yt=U.value)==null?void 0:Yt.offsetWidth)||200;!e.fitInputWidth&&we.value.length>0?jn(()=>{H.value=Math.max(wn,rn())}):H.value=wn},rn=()=>{var Yt,wn;const Qn=document.createElement("canvas").getContext("2d"),di=a.be("dropdown","item"),vo=(((wn=(Yt=he.value)==null?void 0:Yt.listRef)==null?void 0:wn.innerRef)||document).querySelector(`.${di}`);if(vo===null||Qn===null)return 0;const bo=getComputedStyle(vo),gl=Number.parseFloat(bo.paddingLeft)+Number.parseFloat(bo.paddingRight);return Qn.font=bo.font,me.value.reduce((cf,Bc)=>{const _l=Qn.measureText(C(Bc));return Math.max(_l.width,cf)},0)+gl},on=()=>{if(!te.value)return 0;const Yt=window.getComputedStyle(te.value);return Number.parseFloat(Yt.gap||"6px")},Ln=ee(()=>{const Yt=on();return{maxWidth:`${ce.value&&e.maxCollapseTags===1?N.selectionWidth-N.collapseItemWidth-Yt:N.selectionWidth}px`}}),yn=ee(()=>({maxWidth:`${N.selectionWidth}px`})),Et=ee(()=>sn(e.modelValue)?e.modelValue.length===0&&!N.inputValue:e.filterable?!N.inputValue:!0),En=ee(()=>{var Yt;const wn=(Yt=e.placeholder)!=null?Yt:o("el.select.placeholder");return e.multiple||!Ct.value?wn:N.selectedLabel}),Xn=ee(()=>{var Yt,wn;return(wn=(Yt=Z.value)==null?void 0:Yt.popperRef)==null?void 0:wn.contentRef}),vr=ee(()=>{if(e.multiple){const Yt=e.modelValue.length;if(e.modelValue.length>0&&Jt.value.has(e.modelValue[Yt-1])){const{index:wn}=Jt.value.get(e.modelValue[Yt-1]);return wn}}else if(!V(e.modelValue)&&Jt.value.has(e.modelValue)){const{index:Yt}=Jt.value.get(e.modelValue);return Yt}return-1}),er=ee({get(){return De.value&&an.value!==!1},set(Yt){De.value=Yt}}),Dr=ee(()=>e.multiple?e.collapseTags?N.cachedOptions.slice(0,e.maxCollapseTags):N.cachedOptions:[]),Ar=ee(()=>e.multiple?e.collapseTags?N.cachedOptions.slice(e.maxCollapseTags):[]:[]),{createNewOption:Di,removeNewOption:ui,selectNewOption:zt,clearAllNewOption:st}=Wae(e,N),Ft=()=>{Ge.value||(N.menuVisibleOnFocus?N.menuVisibleOnFocus=!1:De.value=!De.value)},Ye=()=>{N.inputValue.length>0&&!De.value&&(De.value=!0),Di(N.inputValue),xn(N.inputValue)},pn=Ca(Ye,Ne.value),xn=Yt=>{N.previousQuery===Yt||pe.value||(N.previousQuery=Yt,e.filterable&&$n(e.filterMethod)?e.filterMethod(Yt):e.filterable&&e.remote&&$n(e.remoteMethod)&&e.remoteMethod(Yt),e.defaultFirstOption&&(e.filterable||e.remote)&&me.value.length?jn(_r):jn(bn))},_r=()=>{const Yt=me.value.filter(Qn=>!Qn.disabled&&Qn.type!=="Group"),wn=Yt.find(Qn=>Qn.created),Kn=Yt[0];N.hoveringIndex=Qi(me.value,wn||Kn)},yi=Yt=>{_s(e.modelValue,Yt)||t(Ii,Yt)},xi=Yt=>{t(gr,Yt),yi(Yt),N.previousValue=e.multiple?String(Yt):Yt},Qi=(Yt=[],wn)=>{if(!xr(wn))return Yt.indexOf(wn);const Kn=e.valueKey;let Qn=-1;return Yt.some((di,eo)=>Eo(di,Kn)===Eo(wn,Kn)?(Qn=eo,!0):!1),Qn},ci=Yt=>xr(Yt)?Eo(Yt,e.valueKey):Yt,co=()=>{Dt()},pi=()=>{N.selectionWidth=te.value.getBoundingClientRect().width},Oo=()=>{N.collapseItemWidth=ce.value.getBoundingClientRect().width},Ut=()=>{var Yt,wn;(wn=(Yt=Z.value)==null?void 0:Yt.updatePopper)==null||wn.call(Yt)},Ee=()=>{var Yt,wn;(wn=(Yt=q.value)==null?void 0:Yt.updatePopper)==null||wn.call(Yt)},ke=Yt=>{if(e.multiple){let wn=e.modelValue.slice();const Kn=Qi(wn,M(Yt));Kn>-1?(wn=[...wn.slice(0,Kn),...wn.slice(Kn+1)],N.cachedOptions.splice(Kn,1),ui(Yt)):(e.multipleLimit<=0||wn.length<e.multipleLimit)&&(wn=[...wn,M(Yt)],N.cachedOptions.push(Yt),zt(Yt)),xi(wn),Yt.created&&xn(""),e.filterable&&!e.reserveKeyword&&(N.inputValue="")}else N.selectedLabel=C(Yt),xi(M(Yt)),De.value=!1,zt(Yt),Yt.created||st();ut()},He=(Yt,wn)=>{let Kn=e.modelValue.slice();const Qn=Qi(Kn,M(wn));Qn>-1&&!Ge.value&&(Kn=[...e.modelValue.slice(0,Qn),...e.modelValue.slice(Qn+1)],N.cachedOptions.splice(Qn,1),xi(Kn),t("remove-tag",M(wn)),ui(wn)),Yt.stopPropagation(),ut()},ut=()=>{var Yt;(Yt=J.value)==null||Yt.focus()},ft=()=>{var Yt;if(De.value){De.value=!1,jn(()=>{var wn;return(wn=J.value)==null?void 0:wn.blur()});return}(Yt=J.value)==null||Yt.blur()},xt=()=>{N.inputValue.length>0?N.inputValue="":De.value=!1},Lt=Yt=>sz(Yt,wn=>!N.cachedOptions.some(Kn=>M(Kn)===wn&&P(Kn))),Tt=Yt=>{if(e.multiple&&Yt.code!==Cn.delete&&N.inputValue.length===0){Yt.preventDefault();const wn=e.modelValue.slice(),Kn=Lt(wn);if(Kn<0)return;const Qn=wn[Kn];wn.splice(Kn,1);const di=N.cachedOptions[Kn];N.cachedOptions.splice(Kn,1),ui(di),xi(wn),t("remove-tag",Qn)}},$t=()=>{let Yt;sn(e.modelValue)?Yt=[]:Yt=F.value,e.multiple?N.cachedOptions=[]:N.selectedLabel="",De.value=!1,xi(Yt),t("clear"),st(),ut()},Qe=(Yt,wn=void 0)=>{const Kn=me.value;if(!["forward","backward"].includes(Yt)||Ge.value||Kn.length<=0||Kt.value||pe.value)return;if(!De.value)return Ft();wn===void 0&&(wn=N.hoveringIndex);let Qn=-1;Yt==="forward"?(Qn=wn+1,Qn>=Kn.length&&(Qn=0)):Yt==="backward"&&(Qn=wn-1,(Qn<0||Qn>=Kn.length)&&(Qn=Kn.length-1));const di=Kn[Qn];if(P(di)||di.type==="Group")return Qe(Yt,Qn);N.hoveringIndex=Qn,ur(Qn)},yt=()=>{if(De.value)~N.hoveringIndex&&me.value[N.hoveringIndex]&&ke(me.value[N.hoveringIndex]);else return Ft()},Qt=Yt=>{N.hoveringIndex=Yt??-1},bn=()=>{e.multiple?N.hoveringIndex=me.value.findIndex(Yt=>e.modelValue.some(wn=>ci(wn)===ci(Yt))):N.hoveringIndex=me.value.findIndex(Yt=>ci(Yt)===ci(e.modelValue))},Mn=Yt=>{if(N.inputValue=Yt.target.value,e.remote)pn();else return Ye()},or=Yt=>{if(De.value=!1,ye.value){const wn=new FocusEvent("focus",Yt);Me(wn)}},dr=()=>(N.isBeforeHide=!1,jn(()=>{~vr.value&&ur(N.hoveringIndex)})),ur=Yt=>{he.value.scrollToItem(Yt)},cr=(Yt,wn)=>{const Kn=ci(Yt);if(Je.value.has(Kn)){const{option:Qn}=Je.value.get(Kn);return Qn}if(wn&&wn.length){const Qn=wn.find(di=>ci(M(di))===Kn);if(Qn)return Qn}return{[S.value.value]:Yt,[S.value.label]:Yt}},ei=(Yt=!1)=>{if(e.multiple)if(e.modelValue.length>0){const wn=N.cachedOptions.slice();N.cachedOptions.length=0,N.previousValue=e.modelValue.toString();for(const Kn of e.modelValue){const Qn=cr(Kn,wn);N.cachedOptions.push(Qn)}}else N.cachedOptions=[],N.previousValue=void 0;else if(Ct.value){N.previousValue=e.modelValue;const wn=me.value,Kn=wn.findIndex(Qn=>ci(M(Qn))===ci(e.modelValue));~Kn?N.selectedLabel=C(wn[Kn]):(!N.selectedLabel||Yt)&&(N.selectedLabel=ci(e.modelValue))}else N.selectedLabel="",N.previousValue=void 0;st(),Dt()};return Wt(()=>e.fitInputWidth,()=>{Dt()}),Wt(De,Yt=>{Yt?(e.persistent||Dt(),xn("")):(N.inputValue="",N.previousQuery=null,N.isBeforeHide=!0,Di("")),t("visible-change",Yt)}),Wt(()=>e.modelValue,(Yt,wn)=>{var Kn;(!Yt||sn(Yt)&&Yt.length===0||e.multiple&&!_s(Yt.toString(),N.previousValue)||!e.multiple&&ci(Yt)!==ci(N.previousValue))&&ei(!0),!_s(Yt,wn)&&e.validateEvent&&((Kn=y==null?void 0:y.validate)==null||Kn.call(y,"change").catch(di=>void 0))},{deep:!0}),Wt(()=>e.options,()=>{const Yt=J.value;(!Yt||Yt&&document.activeElement!==Yt)&&ei()},{deep:!0,flush:"post"}),Wt(()=>me.value,()=>(Dt(),he.value&&jn(he.value.resetScrollTop))),gs(()=>{N.isBeforeHide||tt()}),gs(()=>{const{valueKey:Yt,options:wn}=e,Kn=new Map;for(const Qn of wn){const di=M(Qn);let eo=di;if(xr(eo)&&(eo=Eo(di,Yt)),Kn.get(eo))break;Kn.set(eo,!0)}}),yr(()=>{ei()}),ro(U,co),ro(te,pi),ro(he,Ut),ro(be,Ut),ro(le,Ee),ro(ce,Oo),{inputId:r,collapseTagSize:Pt,currentPlaceholder:En,expanded:De,emptyText:an,popupHeight:Oe,debounce:Ne,allOptions:we,filteredOptions:me,iconComponent:Bt,iconReverse:_t,tagStyle:Ln,collapseTagStyle:yn,popperSize:H,dropdownMenuVisible:er,hasModelValue:Ct,shouldShowPlaceholder:Et,selectDisabled:Ge,selectSize:Nt,needStatusIcon:rt,showClearBtn:kt,states:N,isFocused:ye,nsSelect:a,nsInput:d,inputRef:J,menuRef:he,tagMenuRef:le,tooltipRef:Z,tagTooltipRef:q,selectRef:U,wrapperRef:be,selectionRef:te,prefixRef:re,suffixRef:se,collapseItemRef:ce,popperRef:Xn,validateState:jt,validateIcon:Gt,showTagList:Dr,collapseTagList:Ar,debouncedOnInputChange:pn,deleteTag:He,getLabel:C,getValue:M,getDisabled:P,getValueKey:ci,handleClear:$t,handleClickOutside:or,handleDel:Tt,handleEsc:xt,focus:ut,blur:ft,handleMenuEnter:dr,handleResize:co,resetSelectionWidth:pi,updateTooltip:Ut,updateTagTooltip:Ee,updateOptions:tt,toggleMenu:Ft,scrollTo:ur,onInput:Mn,onKeyboardNavigate:Qe,onKeyboardSelect:yt,onSelect:ke,onHover:Qt,handleCompositionStart:de,handleCompositionEnd:Ie,handleCompositionUpdate:Ve}},Kae=We({name:"ElSelectV2",components:{ElSelectMenu:Gae,ElTag:Um,ElTooltip:bs,ElIcon:zn},directives:{ClickOutside:Pc},props:Tae,emits:Eae,setup(e,{emit:t}){const o=ee(()=>{const{modelValue:r,multiple:S}=e,C=S?[]:void 0;return sn(r)?S?r:C:S?C:r}),a=qae(si({...Go(e),modelValue:o}),t),{calculatorRef:d,inputStyle:p}=FE();Vr($E,{props:si({...Go(e),height:a.popupHeight,modelValue:o}),expanded:a.expanded,tooltipRef:a.tooltipRef,onSelect:a.onSelect,onHover:a.onHover,onKeyboardNavigate:a.onKeyboardNavigate,onKeyboardSelect:a.onKeyboardSelect});const y=ee(()=>e.multiple?a.states.cachedOptions.map(r=>r.label):a.states.selectedLabel);return{...a,modelValue:o,selectedLabel:y,calculatorRef:d,inputStyle:p}}});function Zae(e,t,o,a,d,p){const y=Er("el-tag"),r=Er("el-tooltip"),S=Er("el-icon"),C=Er("el-select-menu"),M=ex("click-outside");return hr((ae(),Pe("div",{ref:"selectRef",class:fe([e.nsSelect.b(),e.nsSelect.m(e.selectSize)]),onMouseenter:P=>e.states.inputHovering=!0,onMouseleave:P=>e.states.inputHovering=!1},[qe(r,{ref:"tooltipRef",visible:e.dropdownMenuVisible,teleported:e.teleported,"popper-class":[e.nsSelect.e("popper"),e.popperClass],"gpu-acceleration":!1,"stop-popper-mouse-event":!1,"popper-options":e.popperOptions,"fallback-placements":e.fallbackPlacements,effect:e.effect,placement:e.placement,pure:"",transition:`${e.nsSelect.namespace.value}-zoom-in-top`,trigger:"click",persistent:e.persistent,"append-to":e.appendTo,"show-arrow":e.showArrow,offset:e.offset,onBeforeShow:e.handleMenuEnter,onHide:P=>e.states.isBeforeHide=!1},{default:ot(()=>[Ue("div",{ref:"wrapperRef",class:fe([e.nsSelect.e("wrapper"),e.nsSelect.is("focused",e.isFocused),e.nsSelect.is("hovering",e.states.inputHovering),e.nsSelect.is("filterable",e.filterable),e.nsSelect.is("disabled",e.selectDisabled)]),onClick:Jn(e.toggleMenu,["prevent"])},[e.$slots.prefix?(ae(),Pe("div",{key:0,ref:"prefixRef",class:fe(e.nsSelect.e("prefix"))},[gt(e.$slots,"prefix")],2)):bt("v-if",!0),Ue("div",{ref:"selectionRef",class:fe([e.nsSelect.e("selection"),e.nsSelect.is("near",e.multiple&&!e.$slots.prefix&&!!e.modelValue.length)])},[e.multiple?gt(e.$slots,"tag",{key:0},()=>[(ae(!0),Pe(Vn,null,Fr(e.showTagList,P=>(ae(),Pe("div",{key:e.getValueKey(e.getValue(P)),class:fe(e.nsSelect.e("selected-item"))},[qe(y,{closable:!e.selectDisabled&&!e.getDisabled(P),size:e.collapseTagSize,type:e.tagType,effect:e.tagEffect,"disable-transitions":"",style:Un(e.tagStyle),onClose:z=>e.deleteTag(z,P)},{default:ot(()=>[Ue("span",{class:fe(e.nsSelect.e("tags-text"))},[gt(e.$slots,"label",{label:e.getLabel(P),value:e.getValue(P)},()=>[Nr(fn(e.getLabel(P)),1)])],2)]),_:2},1032,["closable","size","type","effect","style","onClose"])],2))),128)),e.collapseTags&&e.modelValue.length>e.maxCollapseTags?(ae(),At(r,{key:0,ref:"tagTooltipRef",disabled:e.dropdownMenuVisible||!e.collapseTagsTooltip,"fallback-placements":["bottom","top","right","left"],effect:e.effect,placement:"bottom",teleported:e.teleported},{default:ot(()=>[Ue("div",{ref:"collapseItemRef",class:fe(e.nsSelect.e("selected-item"))},[qe(y,{closable:!1,size:e.collapseTagSize,type:e.tagType,effect:e.tagEffect,style:Un(e.collapseTagStyle),"disable-transitions":""},{default:ot(()=>[Ue("span",{class:fe(e.nsSelect.e("tags-text"))}," + "+fn(e.modelValue.length-e.maxCollapseTags),3)]),_:1},8,["size","type","effect","style"])],2)]),content:ot(()=>[Ue("div",{ref:"tagMenuRef",class:fe(e.nsSelect.e("selection"))},[(ae(!0),Pe(Vn,null,Fr(e.collapseTagList,P=>(ae(),Pe("div",{key:e.getValueKey(e.getValue(P)),class:fe(e.nsSelect.e("selected-item"))},[qe(y,{class:"in-tooltip",closable:!e.selectDisabled&&!e.getDisabled(P),size:e.collapseTagSize,type:e.tagType,effect:e.tagEffect,"disable-transitions":"",onClose:z=>e.deleteTag(z,P)},{default:ot(()=>[Ue("span",{class:fe(e.nsSelect.e("tags-text"))},[gt(e.$slots,"label",{label:e.getLabel(P),value:e.getValue(P)},()=>[Nr(fn(e.getLabel(P)),1)])],2)]),_:2},1032,["closable","size","type","effect","onClose"])],2))),128))],2)]),_:3},8,["disabled","effect","teleported"])):bt("v-if",!0)]):bt("v-if",!0),Ue("div",{class:fe([e.nsSelect.e("selected-item"),e.nsSelect.e("input-wrapper"),e.nsSelect.is("hidden",!e.filterable)])},[hr(Ue("input",{id:e.inputId,ref:"inputRef","onUpdate:modelValue":P=>e.states.inputValue=P,style:Un(e.inputStyle),autocomplete:e.autocomplete,tabindex:e.tabindex,"aria-autocomplete":"list","aria-haspopup":"listbox",autocapitalize:"off","aria-expanded":e.expanded,"aria-label":e.ariaLabel,class:fe([e.nsSelect.e("input"),e.nsSelect.is(e.selectSize)]),disabled:e.selectDisabled,role:"combobox",readonly:!e.filterable,spellcheck:"false",type:"text",name:e.name,onInput:e.onInput,onCompositionstart:e.handleCompositionStart,onCompositionupdate:e.handleCompositionUpdate,onCompositionend:e.handleCompositionEnd,onKeydown:[Ri(Jn(P=>e.onKeyboardNavigate("backward"),["stop","prevent"]),["up"]),Ri(Jn(P=>e.onKeyboardNavigate("forward"),["stop","prevent"]),["down"]),Ri(Jn(e.onKeyboardSelect,["stop","prevent"]),["enter"]),Ri(Jn(e.handleEsc,["stop","prevent"]),["esc"]),Ri(Jn(e.handleDel,["stop"]),["delete"])],onClick:Jn(e.toggleMenu,["stop"])},null,46,["id","onUpdate:modelValue","autocomplete","tabindex","aria-expanded","aria-label","disabled","readonly","name","onInput","onCompositionstart","onCompositionupdate","onCompositionend","onKeydown","onClick"]),[[rx,e.states.inputValue]]),e.filterable?(ae(),Pe("span",{key:0,ref:"calculatorRef","aria-hidden":"true",class:fe(e.nsSelect.e("input-calculator")),textContent:fn(e.states.inputValue)},null,10,["textContent"])):bt("v-if",!0)],2),e.shouldShowPlaceholder?(ae(),Pe("div",{key:1,class:fe([e.nsSelect.e("selected-item"),e.nsSelect.e("placeholder"),e.nsSelect.is("transparent",!e.hasModelValue||e.expanded&&!e.states.inputValue)])},[e.hasModelValue?gt(e.$slots,"label",{key:0,label:e.currentPlaceholder,value:e.modelValue},()=>[Ue("span",null,fn(e.currentPlaceholder),1)]):(ae(),Pe("span",{key:1},fn(e.currentPlaceholder),1))],2)):bt("v-if",!0)],2),Ue("div",{ref:"suffixRef",class:fe(e.nsSelect.e("suffix"))},[e.iconComponent?hr((ae(),At(S,{key:0,class:fe([e.nsSelect.e("caret"),e.nsInput.e("icon"),e.iconReverse])},{default:ot(()=>[(ae(),At(Ir(e.iconComponent)))]),_:1},8,["class"])),[[ii,!e.showClearBtn]]):bt("v-if",!0),e.showClearBtn&&e.clearIcon?(ae(),At(S,{key:1,class:fe([e.nsSelect.e("caret"),e.nsInput.e("icon"),e.nsSelect.e("clear")]),onClick:Jn(e.handleClear,["prevent","stop"])},{default:ot(()=>[(ae(),At(Ir(e.clearIcon)))]),_:1},8,["class","onClick"])):bt("v-if",!0),e.validateState&&e.validateIcon&&e.needStatusIcon?(ae(),At(S,{key:2,class:fe([e.nsInput.e("icon"),e.nsInput.e("validateIcon"),e.nsInput.is("loading",e.validateState==="validating")])},{default:ot(()=>[(ae(),At(Ir(e.validateIcon)))]),_:1},8,["class"])):bt("v-if",!0)],2)],10,["onClick"])]),content:ot(()=>[qe(C,{ref:"menuRef",data:e.filteredOptions,width:e.popperSize,"hovering-index":e.states.hoveringIndex,"scrollbar-always-on":e.scrollbarAlwaysOn},cl({default:ot(P=>[gt(e.$slots,"default",Gl(Wd(P)))]),_:2},[e.$slots.header?{name:"header",fn:ot(()=>[Ue("div",{class:fe(e.nsSelect.be("dropdown","header"))},[gt(e.$slots,"header")],2)])}:void 0,e.$slots.loading&&e.loading?{name:"loading",fn:ot(()=>[Ue("div",{class:fe(e.nsSelect.be("dropdown","loading"))},[gt(e.$slots,"loading")],2)])}:e.loading||e.filteredOptions.length===0?{name:"empty",fn:ot(()=>[Ue("div",{class:fe(e.nsSelect.be("dropdown","empty"))},[gt(e.$slots,"empty",{},()=>[Ue("span",null,fn(e.emptyText),1)])],2)])}:void 0,e.$slots.footer?{name:"footer",fn:ot(()=>[Ue("div",{class:fe(e.nsSelect.be("dropdown","footer"))},[gt(e.$slots,"footer")],2)])}:void 0]),1032,["data","width","hovering-index","scrollbar-always-on"])]),_:3},8,["visible","teleported","popper-class","popper-options","fallback-placements","effect","placement","transition","persistent","append-to","show-arrow","offset","onBeforeShow","onHide"])],42,["onMouseenter","onMouseleave"])),[[M,e.handleClickOutside,e.popperRef]])}var Yae=dn(Kae,[["render",Zae],["__file","select.vue"]]);const Xae=lr(Yae),Jae=un({animated:{type:Boolean,default:!1},count:{type:Number,default:1},rows:{type:Number,default:3},loading:{type:Boolean,default:!0},throttle:{type:lt([Number,Object])}}),Qae=un({variant:{type:String,values:["circle","rect","h1","h3","text","caption","p","image","button"],default:"text"}}),ele=We({name:"ElSkeletonItem"}),tle=We({...ele,props:Qae,setup(e){const t=Xt("skeleton");return(o,a)=>(ae(),Pe("div",{class:fe([b(t).e("item"),b(t).e(o.variant)])},[o.variant==="image"?(ae(),At(b(I7),{key:0})):bt("v-if",!0)],2))}});var D1=dn(tle,[["__file","skeleton-item.vue"]]);const nle=(e,t=0)=>{if(t===0)return e;const o=xr(t)&&!!t.initVal,a=xe(o);let d=null;const p=r=>{if(ai(r)){a.value=e.value;return}d&&clearTimeout(d),d=setTimeout(()=>{a.value=e.value},r)},y=r=>{r==="leading"?Wn(t)?p(t):p(t.leading):xr(t)?p(t.trailing):a.value=!1};return yr(()=>y("leading")),Wt(()=>e.value,r=>{y(r?"leading":"trailing")}),a},rle=We({name:"ElSkeleton"}),ile=We({...rle,props:Jae,setup(e,{expose:t}){const o=e,a=Xt("skeleton"),d=nle(hi(o,"loading"),o.throttle);return t({uiLoading:d}),(p,y)=>b(d)?(ae(),Pe("div",kr({key:0,class:[b(a).b(),b(a).is("animated",p.animated)]},p.$attrs),[(ae(!0),Pe(Vn,null,Fr(p.count,r=>(ae(),Pe(Vn,{key:r},[b(d)?gt(p.$slots,"template",{key:r},()=>[qe(D1,{class:fe(b(a).is("first")),variant:"p"},null,8,["class"]),(ae(!0),Pe(Vn,null,Fr(p.rows,S=>(ae(),At(D1,{key:S,class:fe([b(a).e("paragraph"),b(a).is("last",S===p.rows&&p.rows>1)]),variant:"p"},null,8,["class"]))),128))]):bt("v-if",!0)],64))),128))],16)):gt(p.$slots,"default",Gl(kr({key:1},p.$attrs)))}});var ole=dn(ile,[["__file","skeleton.vue"]]);const sle=lr(ole,{SkeletonItem:D1}),ale=oo(D1),ZF=Symbol("sliderContextKey"),lle=un({modelValue:{type:lt([Number,Array]),default:0},id:{type:String,default:void 0},min:{type:Number,default:0},max:{type:Number,default:100},step:{type:Number,default:1},showInput:Boolean,showInputControls:{type:Boolean,default:!0},size:zo,inputSize:zo,showStops:Boolean,showTooltip:{type:Boolean,default:!0},formatTooltip:{type:lt(Function),default:void 0},disabled:Boolean,range:Boolean,vertical:Boolean,height:String,debounce:{type:Number,default:300},rangeStartLabel:{type:String,default:void 0},rangeEndLabel:{type:String,default:void 0},formatValueText:{type:lt(Function),default:void 0},tooltipClass:{type:String,default:void 0},placement:{type:String,values:Nc,default:"top"},marks:{type:lt(Object)},validateEvent:{type:Boolean,default:!0},...cs(["ariaLabel"])}),gS=e=>Wn(e)||sn(e)&&e.every(Wn),ule={[gr]:gS,[ys]:gS,[Ii]:gS},cle=un({modelValue:{type:Number,default:0},vertical:Boolean,tooltipClass:String,placement:{type:String,values:Nc,default:"top"}}),dle={[gr]:e=>Wn(e)},fle=(e,t,o)=>{const a=xe(),d=xe(!1),p=ee(()=>t.value instanceof Function),y=ee(()=>p.value&&t.value(e.modelValue)||e.modelValue),r=Ca(()=>{o.value&&(d.value=!0)},50),S=Ca(()=>{o.value&&(d.value=!1)},50);return{tooltip:a,tooltipVisible:d,formatValue:y,displayTooltip:r,hideTooltip:S}},hle=(e,t,o)=>{const{disabled:a,min:d,max:p,step:y,showTooltip:r,precision:S,sliderSize:C,formatTooltip:M,emitChange:P,resetSize:z,updateDragging:F}=Pn(ZF),{tooltip:V,tooltipVisible:N,formatValue:H,displayTooltip:U,hideTooltip:te}=fle(e,M,r),Z=xe(),q=ee(()=>`${(e.modelValue-d.value)/(p.value-d.value)*100}%`),J=ee(()=>e.vertical?{bottom:q.value}:{left:q.value}),re=()=>{t.hovering=!0,U()},se=()=>{t.hovering=!1,t.dragging||te()},he=rt=>{a.value||(rt.preventDefault(),we(rt),window.addEventListener("mousemove",me),window.addEventListener("touchmove",me),window.addEventListener("mouseup",De),window.addEventListener("touchend",De),window.addEventListener("contextmenu",De),Z.value.focus())},le=rt=>{a.value||(t.newPosition=Number.parseFloat(q.value)+rt/(p.value-d.value)*100,Ge(t.newPosition),P())},ce=()=>{le(-y.value)},pe=()=>{le(y.value)},de=()=>{le(-y.value*4)},Ie=()=>{le(y.value*4)},Ve=()=>{a.value||(Ge(0),P())},be=()=>{a.value||(Ge(100),P())},ye=rt=>{let Oe=!0;switch(rt.code){case Cn.left:case Cn.down:ce();break;case Cn.right:case Cn.up:pe();break;case Cn.home:Ve();break;case Cn.end:be();break;case Cn.pageDown:de();break;case Cn.pageUp:Ie();break;default:Oe=!1;break}Oe&&rt.preventDefault()},Me=rt=>{let Oe,Ct;return rt.type.startsWith("touch")?(Ct=rt.touches[0].clientY,Oe=rt.touches[0].clientX):(Ct=rt.clientY,Oe=rt.clientX),{clientX:Oe,clientY:Ct}},we=rt=>{t.dragging=!0,t.isClick=!0;const{clientX:Oe,clientY:Ct}=Me(rt);e.vertical?t.startY=Ct:t.startX=Oe,t.startPosition=Number.parseFloat(q.value),t.newPosition=t.startPosition},me=rt=>{if(t.dragging){t.isClick=!1,U(),z();let Oe;const{clientX:Ct,clientY:kt}=Me(rt);e.vertical?(t.currentY=kt,Oe=(t.startY-t.currentY)/C.value*100):(t.currentX=Ct,Oe=(t.currentX-t.startX)/C.value*100),t.newPosition=t.startPosition+Oe,Ge(t.newPosition)}},De=()=>{t.dragging&&(setTimeout(()=>{t.dragging=!1,t.hovering||te(),t.isClick||Ge(t.newPosition),P()},0),window.removeEventListener("mousemove",me),window.removeEventListener("touchmove",me),window.removeEventListener("mouseup",De),window.removeEventListener("touchend",De),window.removeEventListener("contextmenu",De))},Ge=async rt=>{if(rt===null||Number.isNaN(+rt))return;rt<0?rt=0:rt>100&&(rt=100);const Oe=100/((p.value-d.value)/y.value);let kt=Math.round(rt/Oe)*Oe*(p.value-d.value)*.01+d.value;kt=Number.parseFloat(kt.toFixed(S.value)),kt!==e.modelValue&&o(gr,kt),!t.dragging&&e.modelValue!==t.oldValue&&(t.oldValue=e.modelValue),await jn(),t.dragging&&U(),V.value.updatePopper()};return Wt(()=>t.dragging,rt=>{F(rt)}),Si(Z,"touchstart",he,{passive:!1}),{disabled:a,button:Z,tooltip:V,tooltipVisible:N,showTooltip:r,wrapperStyle:J,formatValue:H,handleMouseEnter:re,handleMouseLeave:se,onButtonDown:he,onKeyDown:ye,setPosition:Ge}},ple=We({name:"ElSliderButton"}),mle=We({...ple,props:cle,emits:dle,setup(e,{expose:t,emit:o}){const a=e,d=Xt("slider"),p=si({hovering:!1,dragging:!1,isClick:!1,startX:0,currentX:0,startY:0,currentY:0,startPosition:0,newPosition:0,oldValue:a.modelValue}),{disabled:y,button:r,tooltip:S,showTooltip:C,tooltipVisible:M,wrapperStyle:P,formatValue:z,handleMouseEnter:F,handleMouseLeave:V,onButtonDown:N,onKeyDown:H,setPosition:U}=hle(a,p,o),{hovering:te,dragging:Z}=Go(p);return t({onButtonDown:N,onKeyDown:H,setPosition:U,hovering:te,dragging:Z}),(q,J)=>(ae(),Pe("div",{ref_key:"button",ref:r,class:fe([b(d).e("button-wrapper"),{hover:b(te),dragging:b(Z)}]),style:Un(b(P)),tabindex:b(y)?-1:0,onMouseenter:b(F),onMouseleave:b(V),onMousedown:b(N),onFocus:b(F),onBlur:b(V),onKeydown:b(H)},[qe(b(bs),{ref_key:"tooltip",ref:S,visible:b(M),placement:q.placement,"fallback-placements":["top","bottom","right","left"],"stop-popper-mouse-event":!1,"popper-class":q.tooltipClass,disabled:!b(C),persistent:b(C)},{content:ot(()=>[Ue("span",null,fn(b(z)),1)]),default:ot(()=>[Ue("div",{class:fe([b(d).e("button"),{hover:b(te),dragging:b(Z)}])},null,2)]),_:1},8,["visible","placement","popper-class","disabled","persistent"])],46,["tabindex","onMouseenter","onMouseleave","onMousedown","onFocus","onBlur","onKeydown"]))}});var $R=dn(mle,[["__file","button.vue"]]);const gle=un({mark:{type:lt([String,Object]),default:void 0}});var _le=We({name:"ElSliderMarker",props:gle,setup(e){const t=Xt("slider"),o=ee(()=>Nn(e.mark)?e.mark:e.mark.label),a=ee(()=>Nn(e.mark)?void 0:e.mark.style);return()=>Zn("div",{class:t.e("marks-text"),style:a.value},o.value)}});const yle=(e,t,o)=>{const{form:a,formItem:d}=xs(),p=Hi(),y=xe(),r=xe(),S={firstButton:y,secondButton:r},C=ee(()=>e.disabled||(a==null?void 0:a.disabled)||!1),M=ee(()=>Math.min(t.firstValue,t.secondValue)),P=ee(()=>Math.max(t.firstValue,t.secondValue)),z=ee(()=>e.range?`${100*(P.value-M.value)/(e.max-e.min)}%`:`${100*(t.firstValue-e.min)/(e.max-e.min)}%`),F=ee(()=>e.range?`${100*(M.value-e.min)/(e.max-e.min)}%`:"0%"),V=ee(()=>e.vertical?{height:e.height}:{}),N=ee(()=>e.vertical?{height:z.value,bottom:F.value}:{width:z.value,left:F.value}),H=()=>{p.value&&(t.sliderSize=p.value[`client${e.vertical?"Height":"Width"}`])},U=de=>{const Ie=e.min+de*(e.max-e.min)/100;if(!e.range)return y;let Ve;return Math.abs(M.value-Ie)<Math.abs(P.value-Ie)?Ve=t.firstValue<t.secondValue?"firstButton":"secondButton":Ve=t.firstValue>t.secondValue?"firstButton":"secondButton",S[Ve]},te=de=>{const Ie=U(de);return Ie.value.setPosition(de),Ie},Z=de=>{t.firstValue=de??e.min,J(e.range?[M.value,P.value]:de??e.min)},q=de=>{t.secondValue=de,e.range&&J([M.value,P.value])},J=de=>{o(gr,de),o(ys,de)},re=async()=>{await jn(),o(Ii,e.range?[M.value,P.value]:e.modelValue)},se=de=>{var Ie,Ve,be,ye,Me,we;if(C.value||t.dragging)return;H();let me=0;if(e.vertical){const De=(be=(Ve=(Ie=de.touches)==null?void 0:Ie.item(0))==null?void 0:Ve.clientY)!=null?be:de.clientY;me=(p.value.getBoundingClientRect().bottom-De)/t.sliderSize*100}else{const De=(we=(Me=(ye=de.touches)==null?void 0:ye.item(0))==null?void 0:Me.clientX)!=null?we:de.clientX,Ge=p.value.getBoundingClientRect().left;me=(De-Ge)/t.sliderSize*100}if(!(me<0||me>100))return te(me)};return{elFormItem:d,slider:p,firstButton:y,secondButton:r,sliderDisabled:C,minValue:M,maxValue:P,runwayStyle:V,barStyle:N,resetSize:H,setPosition:te,emitChange:re,onSliderWrapperPrevent:de=>{var Ie,Ve;((Ie=S.firstButton.value)!=null&&Ie.dragging||(Ve=S.secondButton.value)!=null&&Ve.dragging)&&de.preventDefault()},onSliderClick:de=>{se(de)&&re()},onSliderDown:async de=>{const Ie=se(de);Ie&&(await jn(),Ie.value.onButtonDown(de))},onSliderMarkerDown:de=>{C.value||t.dragging||te(de)},setFirstValue:Z,setSecondValue:q}},vle=(e,t,o,a)=>({stops:ee(()=>{if(!e.showStops||e.min>e.max)return[];if(e.step===0)return[];const y=(e.max-e.min)/e.step,r=100*e.step/(e.max-e.min),S=Array.from({length:y-1}).map((C,M)=>(M+1)*r);return e.range?S.filter(C=>C<100*(o.value-e.min)/(e.max-e.min)||C>100*(a.value-e.min)/(e.max-e.min)):S.filter(C=>C>100*(t.firstValue-e.min)/(e.max-e.min))}),getStopStyle:y=>e.vertical?{bottom:`${y}%`}:{left:`${y}%`}}),ble=e=>ee(()=>e.marks?Object.keys(e.marks).map(Number.parseFloat).sort((o,a)=>o-a).filter(o=>o<=e.max&&o>=e.min).map(o=>({point:o,position:(o-e.min)*100/(e.max-e.min),mark:e.marks[o]})):[]),xle=(e,t,o,a,d,p)=>{const y=C=>{d(gr,C),d(ys,C)},r=()=>e.range?![o.value,a.value].every((C,M)=>C===t.oldValue[M]):e.modelValue!==t.oldValue,S=()=>{var C,M;e.min>e.max&&No("Slider","min should not be greater than max.");const P=e.modelValue;e.range&&sn(P)?P[1]<e.min?y([e.min,e.min]):P[0]>e.max?y([e.max,e.max]):P[0]<e.min?y([e.min,P[1]]):P[1]>e.max?y([P[0],e.max]):(t.firstValue=P[0],t.secondValue=P[1],r()&&(e.validateEvent&&((C=p==null?void 0:p.validate)==null||C.call(p,"change").catch(z=>void 0)),t.oldValue=P.slice())):!e.range&&Wn(P)&&!Number.isNaN(P)&&(P<e.min?y(e.min):P>e.max?y(e.max):(t.firstValue=P,r()&&(e.validateEvent&&((M=p==null?void 0:p.validate)==null||M.call(p,"change").catch(z=>void 0)),t.oldValue=P)))};S(),Wt(()=>t.dragging,C=>{C||S()}),Wt(()=>e.modelValue,(C,M)=>{t.dragging||sn(C)&&sn(M)&&C.every((P,z)=>P===M[z])&&t.firstValue===C[0]&&t.secondValue===C[1]||S()},{deep:!0}),Wt(()=>[e.min,e.max],()=>{S()})},wle=(e,t,o)=>{const a=xe();return yr(async()=>{e.range?(sn(e.modelValue)?(t.firstValue=Math.max(e.min,e.modelValue[0]),t.secondValue=Math.min(e.max,e.modelValue[1])):(t.firstValue=e.min,t.secondValue=e.max),t.oldValue=[t.firstValue,t.secondValue]):(!Wn(e.modelValue)||Number.isNaN(e.modelValue)?t.firstValue=e.min:t.firstValue=Math.min(e.max,Math.max(e.min,e.modelValue)),t.oldValue=t.firstValue),Si(window,"resize",o),await jn(),o()}),{sliderWrapper:a}},Sle=We({name:"ElSlider"}),Tle=We({...Sle,props:lle,emits:ule,setup(e,{expose:t,emit:o}){const a=e,d=Xt("slider"),{t:p}=qr(),y=si({firstValue:0,secondValue:0,oldValue:0,dragging:!1,sliderSize:1}),{elFormItem:r,slider:S,firstButton:C,secondButton:M,sliderDisabled:P,minValue:z,maxValue:F,runwayStyle:V,barStyle:N,resetSize:H,emitChange:U,onSliderWrapperPrevent:te,onSliderClick:Z,onSliderDown:q,onSliderMarkerDown:J,setFirstValue:re,setSecondValue:se}=yle(a,y,o),{stops:he,getStopStyle:le}=vle(a,y,z,F),{inputId:ce,isLabeledByFormItem:pe}=ml(a,{formItemContext:r}),de=Ro(),Ie=ee(()=>a.inputSize||de.value),Ve=ee(()=>a.ariaLabel||p("el.slider.defaultLabel",{min:a.min,max:a.max})),be=ee(()=>a.range?a.rangeStartLabel||p("el.slider.defaultRangeStartLabel"):Ve.value),ye=ee(()=>a.formatValueText?a.formatValueText(Oe.value):`${Oe.value}`),Me=ee(()=>a.rangeEndLabel||p("el.slider.defaultRangeEndLabel")),we=ee(()=>a.formatValueText?a.formatValueText(Ct.value):`${Ct.value}`),me=ee(()=>[d.b(),d.m(de.value),d.is("vertical",a.vertical),{[d.m("with-input")]:a.showInput}]),De=ble(a);xle(a,y,z,F,o,r);const Ge=ee(()=>{const _t=[a.min,a.max,a.step].map(jt=>{const Gt=`${jt}`.split(".")[1];return Gt?Gt.length:0});return Math.max.apply(null,_t)}),{sliderWrapper:rt}=wle(a,y,H),{firstValue:Oe,secondValue:Ct,sliderSize:kt}=Go(y),Bt=_t=>{y.dragging=_t};return Si(rt,"touchstart",te,{passive:!1}),Si(rt,"touchmove",te,{passive:!1}),Vr(ZF,{...Go(a),sliderSize:kt,disabled:P,precision:Ge,emitChange:U,resetSize:H,updateDragging:Bt}),t({onSliderClick:Z}),(_t,jt)=>{var Gt,Ne;return ae(),Pe("div",{id:_t.range?b(ce):void 0,ref_key:"sliderWrapper",ref:rt,class:fe(b(me)),role:_t.range?"group":void 0,"aria-label":_t.range&&!b(pe)?b(Ve):void 0,"aria-labelledby":_t.range&&b(pe)?(Gt=b(r))==null?void 0:Gt.labelId:void 0},[Ue("div",{ref_key:"slider",ref:S,class:fe([b(d).e("runway"),{"show-input":_t.showInput&&!_t.range},b(d).is("disabled",b(P))]),style:Un(b(V)),onMousedown:b(q),onTouchstartPassive:b(q)},[Ue("div",{class:fe(b(d).e("bar")),style:Un(b(N))},null,6),qe($R,{id:_t.range?void 0:b(ce),ref_key:"firstButton",ref:C,"model-value":b(Oe),vertical:_t.vertical,"tooltip-class":_t.tooltipClass,placement:_t.placement,role:"slider","aria-label":_t.range||!b(pe)?b(be):void 0,"aria-labelledby":!_t.range&&b(pe)?(Ne=b(r))==null?void 0:Ne.labelId:void 0,"aria-valuemin":_t.min,"aria-valuemax":_t.range?b(Ct):_t.max,"aria-valuenow":b(Oe),"aria-valuetext":b(ye),"aria-orientation":_t.vertical?"vertical":"horizontal","aria-disabled":b(P),"onUpdate:modelValue":b(re)},null,8,["id","model-value","vertical","tooltip-class","placement","aria-label","aria-labelledby","aria-valuemin","aria-valuemax","aria-valuenow","aria-valuetext","aria-orientation","aria-disabled","onUpdate:modelValue"]),_t.range?(ae(),At($R,{key:0,ref_key:"secondButton",ref:M,"model-value":b(Ct),vertical:_t.vertical,"tooltip-class":_t.tooltipClass,placement:_t.placement,role:"slider","aria-label":b(Me),"aria-valuemin":b(Oe),"aria-valuemax":_t.max,"aria-valuenow":b(Ct),"aria-valuetext":b(we),"aria-orientation":_t.vertical?"vertical":"horizontal","aria-disabled":b(P),"onUpdate:modelValue":b(se)},null,8,["model-value","vertical","tooltip-class","placement","aria-label","aria-valuemin","aria-valuemax","aria-valuenow","aria-valuetext","aria-orientation","aria-disabled","onUpdate:modelValue"])):bt("v-if",!0),_t.showStops?(ae(),Pe("div",{key:1},[(ae(!0),Pe(Vn,null,Fr(b(he),(an,Ae)=>(ae(),Pe("div",{key:Ae,class:fe(b(d).e("stop")),style:Un(b(le)(an))},null,6))),128))])):bt("v-if",!0),b(De).length>0?(ae(),Pe(Vn,{key:2},[Ue("div",null,[(ae(!0),Pe(Vn,null,Fr(b(De),(an,Ae)=>(ae(),Pe("div",{key:Ae,style:Un(b(le)(an.position)),class:fe([b(d).e("stop"),b(d).e("marks-stop")])},null,6))),128))]),Ue("div",{class:fe(b(d).e("marks"))},[(ae(!0),Pe(Vn,null,Fr(b(De),(an,Ae)=>(ae(),At(b(_le),{key:Ae,mark:an.mark,style:Un(b(le)(an.position)),onMousedown:Jn(tt=>b(J)(an.position),["stop"])},null,8,["mark","style","onMousedown"]))),128))],2)],64)):bt("v-if",!0)],46,["onMousedown","onTouchstartPassive"]),_t.showInput&&!_t.range?(ae(),At(b(IF),{key:0,ref:"input","model-value":b(Oe),class:fe(b(d).e("input")),step:_t.step,disabled:b(P),controls:_t.showInputControls,min:_t.min,max:_t.max,precision:b(Ge),debounce:_t.debounce,size:b(Ie),"onUpdate:modelValue":b(re),onChange:b(U)},null,8,["model-value","class","step","disabled","controls","min","max","precision","debounce","size","onUpdate:modelValue","onChange"])):bt("v-if",!0)],10,["id","role","aria-label","aria-labelledby"])}}});var Cle=dn(Tle,[["__file","slider.vue"]]);const Ele=lr(Cle),Mle=un({prefixCls:{type:String}}),UR=We({name:"ElSpaceItem",props:Mle,setup(e,{slots:t}){const o=Xt("space"),a=ee(()=>`${e.prefixCls||o.b()}__item`);return()=>Zn("div",{class:a.value},gt(t,"default"))}}),jR={small:8,default:12,large:16};function Ile(e){const t=Xt("space"),o=ee(()=>[t.b(),t.m(e.direction),e.class]),a=xe(0),d=xe(0),p=ee(()=>{const r=e.wrap||e.fill?{flexWrap:"wrap"}:{},S={alignItems:e.alignment},C={rowGap:`${d.value}px`,columnGap:`${a.value}px`};return[r,S,C,e.style]}),y=ee(()=>e.fill?{flexGrow:1,minWidth:`${e.fillRatio}%`}:{});return gs(()=>{const{size:r="small",wrap:S,direction:C,fill:M}=e;if(sn(r)){const[P=0,z=0]=r;a.value=P,d.value=z}else{let P;Wn(r)?P=r:P=jR[r||"small"]||jR.small,(S||M)&&C==="horizontal"?a.value=d.value=P:C==="horizontal"?(a.value=P,d.value=0):(d.value=P,a.value=0)}}),{classes:o,containerStyle:p,itemStyle:y}}const Ale=un({direction:{type:String,values:["horizontal","vertical"],default:"horizontal"},class:{type:lt([String,Object,Array]),default:""},style:{type:lt([String,Array,Object]),default:""},alignment:{type:lt(String),default:"center"},prefixCls:{type:String},spacer:{type:lt([Object,String,Number,Array]),default:null,validator:e=>Ji(e)||Wn(e)||Nn(e)},wrap:Boolean,fill:Boolean,fillRatio:{type:Number,default:100},size:{type:[String,Array,Number],values:ju,validator:e=>Wn(e)||sn(e)&&e.length===2&&e.every(Wn)}}),kle=We({name:"ElSpace",props:Ale,setup(e,{slots:t}){const{classes:o,containerStyle:a,itemStyle:d}=Ile(e);function p(y,r="",S=[]){const{prefixCls:C}=e;return y.forEach((M,P)=>{oT(M)?sn(M.children)&&M.children.forEach((z,F)=>{oT(z)&&sn(z.children)?p(z.children,`${r+F}-`,S):S.push(qe(UR,{style:d.value,prefixCls:C,key:`nested-${r+F}`},{default:()=>[z]},nl.PROPS|nl.STYLE,["style","prefixCls"]))}):CJ(M)&&S.push(qe(UR,{style:d.value,prefixCls:C,key:`LoopKey${r+P}`},{default:()=>[M]},nl.PROPS|nl.STYLE,["style","prefixCls"]))}),S}return()=>{var y;const{spacer:r,direction:S}=e,C=gt(t,"default",{key:0},()=>[]);if(((y=C.children)!=null?y:[]).length===0)return null;if(sn(C.children)){let M=p(C.children);if(r){const P=M.length-1;M=M.reduce((z,F,V)=>{const N=[...z,F];return V!==P&&N.push(qe("span",{style:[d.value,S==="vertical"?"width: 100%":null],key:V},[Ji(r)?r:Nr(r,nl.TEXT)],nl.STYLE)),N},[])}return qe("div",{class:o.value,style:a.value},M,nl.STYLE|nl.CLASS)}return C.children}}}),Ple=lr(kle),Rle=un({decimalSeparator:{type:String,default:"."},groupSeparator:{type:String,default:","},precision:{type:Number,default:0},formatter:Function,value:{type:lt([Number,Object]),default:0},prefix:String,suffix:String,title:String,valueStyle:{type:lt([String,Object,Array])}}),Ole=We({name:"ElStatistic"}),Lle=We({...Ole,props:Rle,setup(e,{expose:t}){const o=e,a=Xt("statistic"),d=ee(()=>{const{value:p,formatter:y,precision:r,decimalSeparator:S,groupSeparator:C}=o;if($n(y))return y(p);if(!Wn(p)||Number.isNaN(p))return p;let[M,P=""]=String(p).split(".");return P=P.padEnd(r,"0").slice(0,r>0?r:0),M=M.replace(/\B(?=(\d{3})+(?!\d))/g,C),[M,P].join(P?S:"")});return t({displayValue:d}),(p,y)=>(ae(),Pe("div",{class:fe(b(a).b())},[p.$slots.title||p.title?(ae(),Pe("div",{key:0,class:fe(b(a).e("head"))},[gt(p.$slots,"title",{},()=>[Nr(fn(p.title),1)])],2)):bt("v-if",!0),Ue("div",{class:fe(b(a).e("content"))},[p.$slots.prefix||p.prefix?(ae(),Pe("div",{key:0,class:fe(b(a).e("prefix"))},[gt(p.$slots,"prefix",{},()=>[Ue("span",null,fn(p.prefix),1)])],2)):bt("v-if",!0),Ue("span",{class:fe(b(a).e("number")),style:Un(p.valueStyle)},fn(b(d)),7),p.$slots.suffix||p.suffix?(ae(),Pe("div",{key:1,class:fe(b(a).e("suffix"))},[gt(p.$slots,"suffix",{},()=>[Ue("span",null,fn(p.suffix),1)])],2)):bt("v-if",!0)],2)],2))}});var Dle=dn(Lle,[["__file","statistic.vue"]]);const YF=lr(Dle),zle=un({format:{type:String,default:"HH:mm:ss"},prefix:String,suffix:String,title:String,value:{type:lt([Number,Object]),default:0},valueStyle:{type:lt([String,Object,Array])}}),Fle={finish:()=>!0,[Ii]:e=>Wn(e)},Nle=[["Y",1e3*60*60*24*365],["M",1e3*60*60*24*30],["D",1e3*60*60*24],["H",1e3*60*60],["m",1e3*60],["s",1e3],["S",1]],HR=e=>Wn(e)?new Date(e).getTime():e.valueOf(),GR=(e,t)=>{let o=e;const a=/\[([^\]]*)]/g;return Nle.reduce((p,[y,r])=>{const S=new RegExp(`${y}+(?![^\\[\\]]*\\])`,"g");if(S.test(p)){const C=Math.floor(o/r);return o-=C*r,p.replace(S,M=>String(C).padStart(M.length,"0"))}return p},t).replace(a,"$1")},Ble=We({name:"ElCountdown"}),Vle=We({...Ble,props:zle,emits:Fle,setup(e,{expose:t,emit:o}){const a=e;let d;const p=xe(0),y=ee(()=>GR(p.value,a.format)),r=M=>GR(M,a.format),S=()=>{d&&(Th(d),d=void 0)},C=()=>{const M=HR(a.value),P=()=>{let z=M-Date.now();o("change",z),z<=0?(z=0,S(),o("finish")):d=Zd(P),p.value=z};d=Zd(P)};return yr(()=>{p.value=HR(a.value)-Date.now(),Wt(()=>[a.value,a.format],()=>{S(),C()},{immediate:!0})}),Li(()=>{S()}),t({displayValue:y}),(M,P)=>(ae(),At(b(YF),{value:p.value,title:M.title,prefix:M.prefix,suffix:M.suffix,"value-style":M.valueStyle,formatter:r},cl({_:2},[Fr(M.$slots,(z,F)=>({name:F,fn:ot(()=>[gt(M.$slots,F)])}))]),1032,["value","title","prefix","suffix","value-style"]))}});var $le=dn(Vle,[["__file","countdown.vue"]]);const Ule=lr($le),jle=un({space:{type:[Number,String],default:""},active:{type:Number,default:0},direction:{type:String,default:"horizontal",values:["horizontal","vertical"]},alignCenter:{type:Boolean},simple:{type:Boolean},finishStatus:{type:String,values:["wait","process","finish","error","success"],default:"finish"},processStatus:{type:String,values:["wait","process","finish","error","success"],default:"process"}}),Hle={[Ii]:(e,t)=>[e,t].every(Wn)},Gle=We({name:"ElSteps"}),Wle=We({...Gle,props:jle,emits:Hle,setup(e,{emit:t}){const o=e,a=Xt("steps"),{children:d,addChild:p,removeChild:y}=vE(Cr(),"ElStep");return Wt(d,()=>{d.value.forEach((r,S)=>{r.setIndex(S)})}),Vr("ElSteps",{props:o,steps:d,addStep:p,removeStep:y}),Wt(()=>o.active,(r,S)=>{t(Ii,r,S)}),(r,S)=>(ae(),Pe("div",{class:fe([b(a).b(),b(a).m(r.simple?"simple":r.direction)])},[gt(r.$slots,"default")],2))}});var qle=dn(Wle,[["__file","steps.vue"]]);const Kle=un({title:{type:String,default:""},icon:{type:Ai},description:{type:String,default:""},status:{type:String,values:["","wait","process","finish","error","success"],default:""}}),Zle=We({name:"ElStep"}),Yle=We({...Zle,props:Kle,setup(e){const t=e,o=Xt("step"),a=xe(-1),d=xe({}),p=xe(""),y=Pn("ElSteps"),r=Cr();yr(()=>{Wt([()=>y.props.active,()=>y.props.processStatus,()=>y.props.finishStatus],([re])=>{q(re)},{immediate:!0})}),Li(()=>{y.removeStep(J.uid)});const S=ee(()=>t.status||p.value),C=ee(()=>{const re=y.steps.value[a.value-1];return re?re.currentStatus:"wait"}),M=ee(()=>y.props.alignCenter),P=ee(()=>y.props.direction==="vertical"),z=ee(()=>y.props.simple),F=ee(()=>y.steps.value.length),V=ee(()=>{var re;return((re=y.steps.value[F.value-1])==null?void 0:re.uid)===(r==null?void 0:r.uid)}),N=ee(()=>z.value?"":y.props.space),H=ee(()=>[o.b(),o.is(z.value?"simple":y.props.direction),o.is("flex",V.value&&!N.value&&!M.value),o.is("center",M.value&&!P.value&&!z.value)]),U=ee(()=>{const re={flexBasis:Wn(N.value)?`${N.value}px`:N.value?N.value:`${100/(F.value-(M.value?0:1))}%`};return P.value||V.value&&(re.maxWidth=`${100/F.value}%`),re}),te=re=>{a.value=re},Z=re=>{const se=re==="wait",he={transitionDelay:`${se?"-":""}${150*a.value}ms`},le=re===y.props.processStatus||se?0:100;he.borderWidth=le&&!z.value?"1px":0,he[y.props.direction==="vertical"?"height":"width"]=`${le}%`,d.value=he},q=re=>{re>a.value?p.value=y.props.finishStatus:re===a.value&&C.value!=="error"?p.value=y.props.processStatus:p.value="wait";const se=y.steps.value[a.value-1];se&&se.calcProgress(p.value)},J=si({uid:r.uid,currentStatus:S,setIndex:te,calcProgress:Z});return y.addStep(J),(re,se)=>(ae(),Pe("div",{style:Un(b(U)),class:fe(b(H))},[bt(" icon & line "),Ue("div",{class:fe([b(o).e("head"),b(o).is(b(S))])},[b(z)?bt("v-if",!0):(ae(),Pe("div",{key:0,class:fe(b(o).e("line"))},[Ue("i",{class:fe(b(o).e("line-inner")),style:Un(d.value)},null,6)],2)),Ue("div",{class:fe([b(o).e("icon"),b(o).is(re.icon||re.$slots.icon?"icon":"text")])},[gt(re.$slots,"icon",{},()=>[re.icon?(ae(),At(b(zn),{key:0,class:fe(b(o).e("icon-inner"))},{default:ot(()=>[(ae(),At(Ir(re.icon)))]),_:1},8,["class"])):b(S)==="success"?(ae(),At(b(zn),{key:1,class:fe([b(o).e("icon-inner"),b(o).is("status")])},{default:ot(()=>[qe(b(lv))]),_:1},8,["class"])):b(S)==="error"?(ae(),At(b(zn),{key:2,class:fe([b(o).e("icon-inner"),b(o).is("status")])},{default:ot(()=>[qe(b(Ql))]),_:1},8,["class"])):b(z)?bt("v-if",!0):(ae(),Pe("div",{key:3,class:fe(b(o).e("icon-inner"))},fn(a.value+1),3))])],2)],2),bt(" title & description "),Ue("div",{class:fe(b(o).e("main"))},[Ue("div",{class:fe([b(o).e("title"),b(o).is(b(S))])},[gt(re.$slots,"title",{},()=>[Nr(fn(re.title),1)])],2),b(z)?(ae(),Pe("div",{key:0,class:fe(b(o).e("arrow"))},null,2)):(ae(),Pe("div",{key:1,class:fe([b(o).e("description"),b(o).is(b(S))])},[gt(re.$slots,"description",{},()=>[Nr(fn(re.description),1)])],2))],2)],6))}});var XF=dn(Yle,[["__file","item.vue"]]);const Xle=lr(qle,{Step:XF}),Jle=oo(XF),JF=e=>["",...ju].includes(e),Qle=un({modelValue:{type:[Boolean,String,Number],default:!1},disabled:Boolean,loading:Boolean,size:{type:String,validator:JF},width:{type:[String,Number],default:""},inlinePrompt:Boolean,inactiveActionIcon:{type:Ai},activeActionIcon:{type:Ai},activeIcon:{type:Ai},inactiveIcon:{type:Ai},activeText:{type:String,default:""},inactiveText:{type:String,default:""},activeValue:{type:[Boolean,String,Number],default:!0},inactiveValue:{type:[Boolean,String,Number],default:!1},name:{type:String,default:""},validateEvent:{type:Boolean,default:!0},beforeChange:{type:lt(Function)},id:String,tabindex:{type:[String,Number]},...cs(["ariaLabel"])}),eue={[gr]:e=>Oi(e)||Nn(e)||Wn(e),[Ii]:e=>Oi(e)||Nn(e)||Wn(e),[ys]:e=>Oi(e)||Nn(e)||Wn(e)},QF="ElSwitch",tue=We({name:QF}),nue=We({...tue,props:Qle,emits:eue,setup(e,{expose:t,emit:o}){const a=e,{formItem:d}=xs(),p=Ro(),y=Xt("switch"),{inputId:r}=ml(a,{formItemContext:d}),S=ws(ee(()=>a.loading)),C=xe(a.modelValue!==!1),M=xe(),P=xe(),z=ee(()=>[y.b(),y.m(p.value),y.is("disabled",S.value),y.is("checked",U.value)]),F=ee(()=>[y.e("label"),y.em("label","left"),y.is("active",!U.value)]),V=ee(()=>[y.e("label"),y.em("label","right"),y.is("active",U.value)]),N=ee(()=>({width:_o(a.width)}));Wt(()=>a.modelValue,()=>{C.value=!0});const H=ee(()=>C.value?a.modelValue:!1),U=ee(()=>H.value===a.activeValue);[a.activeValue,a.inactiveValue].includes(H.value)||(o(gr,a.inactiveValue),o(Ii,a.inactiveValue),o(ys,a.inactiveValue)),Wt(U,J=>{var re;M.value.checked=J,a.validateEvent&&((re=d==null?void 0:d.validate)==null||re.call(d,"change").catch(se=>void 0))});const te=()=>{const J=U.value?a.inactiveValue:a.activeValue;o(gr,J),o(Ii,J),o(ys,J),jn(()=>{M.value.checked=U.value})},Z=()=>{if(S.value)return;const{beforeChange:J}=a;if(!J){te();return}const re=J();[xy(re),Oi(re)].includes(!0)||No(QF,"beforeChange must return type `Promise<boolean>` or `boolean`"),xy(re)?re.then(he=>{he&&te()}).catch(he=>{}):re&&te()},q=()=>{var J,re;(re=(J=M.value)==null?void 0:J.focus)==null||re.call(J)};return yr(()=>{M.value.checked=U.value}),t({focus:q,checked:U}),(J,re)=>(ae(),Pe("div",{class:fe(b(z)),onClick:Jn(Z,["prevent"])},[Ue("input",{id:b(r),ref_key:"input",ref:M,class:fe(b(y).e("input")),type:"checkbox",role:"switch","aria-checked":b(U),"aria-disabled":b(S),"aria-label":J.ariaLabel,name:J.name,"true-value":J.activeValue,"false-value":J.inactiveValue,disabled:b(S),tabindex:J.tabindex,onChange:te,onKeydown:Ri(Z,["enter"])},null,42,["id","aria-checked","aria-disabled","aria-label","name","true-value","false-value","disabled","tabindex","onKeydown"]),!J.inlinePrompt&&(J.inactiveIcon||J.inactiveText)?(ae(),Pe("span",{key:0,class:fe(b(F))},[J.inactiveIcon?(ae(),At(b(zn),{key:0},{default:ot(()=>[(ae(),At(Ir(J.inactiveIcon)))]),_:1})):bt("v-if",!0),!J.inactiveIcon&&J.inactiveText?(ae(),Pe("span",{key:1,"aria-hidden":b(U)},fn(J.inactiveText),9,["aria-hidden"])):bt("v-if",!0)],2)):bt("v-if",!0),Ue("span",{ref_key:"core",ref:P,class:fe(b(y).e("core")),style:Un(b(N))},[J.inlinePrompt?(ae(),Pe("div",{key:0,class:fe(b(y).e("inner"))},[J.activeIcon||J.inactiveIcon?(ae(),At(b(zn),{key:0,class:fe(b(y).is("icon"))},{default:ot(()=>[(ae(),At(Ir(b(U)?J.activeIcon:J.inactiveIcon)))]),_:1},8,["class"])):J.activeText||J.inactiveText?(ae(),Pe("span",{key:1,class:fe(b(y).is("text")),"aria-hidden":!b(U)},fn(b(U)?J.activeText:J.inactiveText),11,["aria-hidden"])):bt("v-if",!0)],2)):bt("v-if",!0),Ue("div",{class:fe(b(y).e("action"))},[J.loading?(ae(),At(b(zn),{key:0,class:fe(b(y).is("loading"))},{default:ot(()=>[qe(b(Fu))]),_:1},8,["class"])):b(U)?gt(J.$slots,"active-action",{key:1},()=>[J.activeActionIcon?(ae(),At(b(zn),{key:0},{default:ot(()=>[(ae(),At(Ir(J.activeActionIcon)))]),_:1})):bt("v-if",!0)]):b(U)?bt("v-if",!0):gt(J.$slots,"inactive-action",{key:2},()=>[J.inactiveActionIcon?(ae(),At(b(zn),{key:0},{default:ot(()=>[(ae(),At(Ir(J.inactiveActionIcon)))]),_:1})):bt("v-if",!0)])],2)],6),!J.inlinePrompt&&(J.activeIcon||J.activeText)?(ae(),Pe("span",{key:1,class:fe(b(V))},[J.activeIcon?(ae(),At(b(zn),{key:0},{default:ot(()=>[(ae(),At(Ir(J.activeIcon)))]),_:1})):bt("v-if",!0),!J.activeIcon&&J.activeText?(ae(),Pe("span",{key:1,"aria-hidden":!b(U)},fn(J.activeText),9,["aria-hidden"])):bt("v-if",!0)],2)):bt("v-if",!0)],10,["onClick"]))}});var rue=dn(nue,[["__file","switch.vue"]]);const iue=lr(rue),_S=function(e){var t;return(t=e.target)==null?void 0:t.closest("td")},oue=function(e,t,o,a,d){if(!t&&!a&&(!d||sn(d)&&!d.length))return e;Nn(o)?o=o==="descending"?-1:1:o=o&&o<0?-1:1;const p=a?null:function(r,S){return d?(sn(d)||(d=[d]),d.map(C=>Nn(C)?Eo(r,C):C(r,S,e))):(t!=="$key"&&xr(r)&&"$value"in r&&(r=r.$value),[xr(r)?Eo(r,t):r])},y=function(r,S){if(a)return a(r.value,S.value);for(let C=0,M=r.key.length;C<M;C++){if(r.key[C]<S.key[C])return-1;if(r.key[C]>S.key[C])return 1}return 0};return e.map((r,S)=>({value:r,index:S,key:p?p(r,S):null})).sort((r,S)=>{let C=y(r,S);return C||(C=r.index-S.index),C*+o}).map(r=>r.value)},eN=function(e,t){let o=null;return e.columns.forEach(a=>{a.id===t&&(o=a)}),o},sue=function(e,t){let o=null;for(let a=0;a<e.columns.length;a++){const d=e.columns[a];if(d.columnKey===t){o=d;break}}return o||No("ElTable",`No column matching with column-key: ${t}`),o},WR=function(e,t,o){const a=(t.className||"").match(new RegExp(`${o}-table_[^\\s]+`,"gm"));return a?eN(e,a[0]):null},Ns=(e,t)=>{if(!e)throw new Error("Row is required when get row identity");if(Nn(t)){if(!t.includes("."))return`${e[t]}`;const o=t.split(".");let a=e;for(const d of o)a=a[d];return`${a}`}else if($n(t))return t.call(null,e)},vy=function(e,t){const o={};return(e||[]).forEach((a,d)=>{o[Ns(a,t)]={row:a,index:d}}),o};function aue(e,t){const o={};let a;for(a in e)o[a]=e[a];for(a in t)if(ri(t,a)){const d=t[a];ai(d)||(o[a]=d)}return o}function GE(e){return e===""||ai(e)||(e=Number.parseInt(e,10),Number.isNaN(e)&&(e="")),e}function tN(e){return e===""||ai(e)||(e=GE(e),Number.isNaN(e)&&(e=80)),e}function lue(e){return Wn(e)?e:Nn(e)?/^\d+(?:px)?$/.test(e)?Number.parseInt(e,10):e:null}function uue(...e){return e.length===0?t=>t:e.length===1?e[0]:e.reduce((t,o)=>(...a)=>t(o(...a)))}function z1(e,t,o,a,d,p){let y=p??0,r=!1;const S=e.indexOf(t),C=S!==-1,M=d==null?void 0:d.call(null,t,p),P=F=>{F==="add"?e.push(t):e.splice(S,1),r=!0},z=F=>{let V=0;const N=(a==null?void 0:a.children)&&F[a.children];return N&&sn(N)&&(V+=N.length,N.forEach(H=>{V+=z(H)})),V};return(!d||M)&&(Oi(o)?o&&!C?P("add"):!o&&C&&P("remove"):P(C?"remove":"add")),!(a!=null&&a.checkStrictly)&&(a!=null&&a.children)&&sn(t[a.children])&&t[a.children].forEach(F=>{z1(e,F,o??!C,a,d,y+1),y+=z(F)+1}),r}function cue(e,t,o="children",a="hasChildren"){const d=y=>!(sn(y)&&y.length);function p(y,r,S){t(y,r,S),r.forEach(C=>{if(C[a]){t(C,null,S+1);return}const M=C[o];d(M)||p(C,M,S+1)})}e.forEach(y=>{if(y[a]){t(y,null,0);return}const r=y[o];d(r)||p(y,r,0)})}const qR=(e,t)=>({content:t,...e,popperOptions:{strategy:"fixed",...e.popperOptions}});let va=null;function due(e,t,o,a){if((va==null?void 0:va.trigger)===o){lz(va.vm.component.props,qR(e,t));return}va==null||va();const d=a==null?void 0:a.refs.tableWrapper,p=d==null?void 0:d.dataset.prefix,y=qe(bs,{virtualTriggering:!0,virtualRef:o,appendTo:d,placement:"top",transition:"none",offset:0,hideAfter:0,...qR(e,t)});y.appContext={...a.appContext,...a};const r=document.createElement("div");qd(y,r),y.component.exposed.onOpen();const S=d==null?void 0:d.querySelector(`.${p}-scrollbar__wrap`);va=()=>{qd(null,r),S==null||S.removeEventListener("scroll",va),va=null},va.trigger=o,va.vm=y,S==null||S.addEventListener("scroll",va)}function nN(e){return e.children?Sq(e.children,nN):[e]}function KR(e,t){return e+t.colSpan}const rN=(e,t,o,a)=>{let d=0,p=e;const y=o.states.columns.value;if(a){const S=nN(a[e]);d=y.slice(0,y.indexOf(S[0])).reduce(KR,0),p=d+S.reduce(KR,0)-1}else d=e;let r;switch(t){case"left":p<o.states.fixedLeafColumnsLength.value&&(r="left");break;case"right":d>=y.length-o.states.rightFixedLeafColumnsLength.value&&(r="right");break;default:p<o.states.fixedLeafColumnsLength.value?r="left":d>=y.length-o.states.rightFixedLeafColumnsLength.value&&(r="right")}return r?{direction:r,start:d,after:p}:{}},WE=(e,t,o,a,d,p=0)=>{const y=[],{direction:r,start:S,after:C}=rN(t,o,a,d);if(r){const M=r==="left";y.push(`${e}-fixed-column--${r}`),M&&C+p===a.states.fixedLeafColumnsLength.value-1?y.push("is-last-column"):!M&&S-p===a.states.columns.value.length-a.states.rightFixedLeafColumnsLength.value&&y.push("is-first-column")}return y};function ZR(e,t){return e+(sv(t.realWidth)||Number.isNaN(t.realWidth)?Number(t.width):t.realWidth)}const qE=(e,t,o,a)=>{const{direction:d,start:p=0,after:y=0}=rN(e,t,o,a);if(!d)return;const r={},S=d==="left",C=o.states.columns.value;return S?r.left=C.slice(0,p).reduce(ZR,0):r.right=C.slice(y+1).reverse().reduce(ZR,0),r},Gm=(e,t)=>{e&&(Number.isNaN(e[t])||(e[t]=`${e[t]}px`))};function fue(e){const t=Cr(),o=xe(!1),a=xe([]);return{updateExpandRows:()=>{const S=e.data.value||[],C=e.rowKey.value;if(o.value)a.value=S.slice();else if(C){const M=vy(a.value,C);a.value=S.reduce((P,z)=>{const F=Ns(z,C);return M[F]&&P.push(z),P},[])}else a.value=[]},toggleRowExpansion:(S,C)=>{z1(a.value,S,C)&&t.emit("expand-change",S,a.value.slice())},setExpandRowKeys:S=>{t.store.assertRowKey();const C=e.data.value||[],M=e.rowKey.value,P=vy(C,M);a.value=S.reduce((z,F)=>{const V=P[F];return V&&z.push(V.row),z},[])},isRowExpanded:S=>{const C=e.rowKey.value;return C?!!vy(a.value,C)[Ns(S,C)]:a.value.includes(S)},states:{expandRows:a,defaultExpandAll:o}}}function hue(e){const t=Cr(),o=xe(null),a=xe(null),d=C=>{t.store.assertRowKey(),o.value=C,y(C)},p=()=>{o.value=null},y=C=>{const{data:M,rowKey:P}=e;let z=null;P.value&&(z=(b(M)||[]).find(F=>Ns(F,P.value)===C)),a.value=z,t.emit("current-change",a.value,null)};return{setCurrentRowKey:d,restoreCurrentRowKey:p,setCurrentRowByKey:y,updateCurrentRow:C=>{const M=a.value;if(C&&C!==M){a.value=C,t.emit("current-change",a.value,M);return}!C&&M&&(a.value=null,t.emit("current-change",null,M))},updateCurrentRowData:()=>{const C=e.rowKey.value,M=e.data.value||[],P=a.value;if(!M.includes(P)&&P){if(C){const z=Ns(P,C);y(z)}else a.value=null;sv(a.value)&&t.emit("current-change",null,P)}else o.value&&(y(o.value),p())},states:{_currentRowKey:o,currentRow:a}}}function pue(e){const t=xe([]),o=xe({}),a=xe(16),d=xe(!1),p=xe({}),y=xe("hasChildren"),r=xe("children"),S=xe(!1),C=Cr(),M=ee(()=>{if(!e.rowKey.value)return{};const Z=e.data.value||[];return z(Z)}),P=ee(()=>{const Z=e.rowKey.value,q=Object.keys(p.value),J={};return q.length&&q.forEach(re=>{if(p.value[re].length){const se={children:[]};p.value[re].forEach(he=>{const le=Ns(he,Z);se.children.push(le),he[y.value]&&!J[le]&&(J[le]={children:[]})}),J[re]=se}}),J}),z=Z=>{const q=e.rowKey.value,J={};return cue(Z,(re,se,he)=>{const le=Ns(re,q);sn(se)?J[le]={children:se.map(ce=>Ns(ce,q)),level:he}:d.value&&(J[le]={children:[],lazy:!0,level:he})},r.value,y.value),J},F=(Z=!1,q=(J=>(J=C.store)==null?void 0:J.states.defaultExpandAll.value)())=>{var J;const re=M.value,se=P.value,he=Object.keys(re),le={};if(he.length){const ce=b(o),pe=[],de=(Ve,be)=>{if(Z)return t.value?q||t.value.includes(be):!!(q||Ve!=null&&Ve.expanded);{const ye=q||t.value&&t.value.includes(be);return!!(Ve!=null&&Ve.expanded||ye)}};he.forEach(Ve=>{const be=ce[Ve],ye={...re[Ve]};if(ye.expanded=de(be,Ve),ye.lazy){const{loaded:Me=!1,loading:we=!1}=be||{};ye.loaded=!!Me,ye.loading=!!we,pe.push(Ve)}le[Ve]=ye});const Ie=Object.keys(se);d.value&&Ie.length&&pe.length&&Ie.forEach(Ve=>{const be=ce[Ve],ye=se[Ve].children;if(pe.includes(Ve)){if(le[Ve].children.length!==0)throw new Error("[ElTable]children must be an empty array.");le[Ve].children=ye}else{const{loaded:Me=!1,loading:we=!1}=be||{};le[Ve]={lazy:!0,loaded:!!Me,loading:!!we,expanded:de(be,Ve),children:ye,level:""}}})}o.value=le,(J=C.store)==null||J.updateTableScrollY()};Wt(()=>t.value,()=>{F(!0)}),Wt(()=>M.value,()=>{F()}),Wt(()=>P.value,()=>{F()});const V=Z=>{t.value=Z,F()},N=(Z,q)=>{C.store.assertRowKey();const J=e.rowKey.value,re=Ns(Z,J),se=re&&o.value[re];if(re&&se&&"expanded"in se){const he=se.expanded;q=ai(q)?!se.expanded:q,o.value[re].expanded=q,he!==q&&C.emit("expand-change",Z,q),C.store.updateTableScrollY()}},H=Z=>{C.store.assertRowKey();const q=e.rowKey.value,J=Ns(Z,q),re=o.value[J];d.value&&re&&"loaded"in re&&!re.loaded?U(Z,J,re):N(Z,void 0)},U=(Z,q,J)=>{const{load:re}=C.props;re&&!o.value[q].loaded&&(o.value[q].loading=!0,re(Z,J,se=>{if(!sn(se))throw new TypeError("[ElTable] data must be an array");o.value[q].loading=!1,o.value[q].loaded=!0,o.value[q].expanded=!0,se.length&&(p.value[q]=se),C.emit("expand-change",Z,!0)}))};return{loadData:U,loadOrToggle:H,toggleTreeExpansion:N,updateTreeExpandKeys:V,updateTreeData:F,updateKeyChildren:(Z,q)=>{const{lazy:J,rowKey:re}=C.props;if(J){if(!re)throw new Error("[Table] rowKey is required in updateKeyChild");p.value[Z]&&(p.value[Z]=q)}},normalize:z,states:{expandRowKeys:t,treeData:o,indent:a,lazy:d,lazyTreeNodeMap:p,lazyColumnIdentifier:y,childrenColumnName:r,checkStrictly:S}}}const mue=(e,t)=>{const o=t.sortingColumn;return!o||Nn(o.sortable)?e:oue(e,t.sortProp,t.sortOrder,o.sortMethod,o.sortBy)},Qb=e=>{const t=[];return e.forEach(o=>{o.children&&o.children.length>0?t.push.apply(t,Qb(o.children)):t.push(o)}),t};function gue(){var e;const t=Cr(),{size:o}=Go((e=t.proxy)==null?void 0:e.$props),a=xe(null),d=xe([]),p=xe([]),y=xe(!1),r=xe([]),S=xe([]),C=xe([]),M=xe([]),P=xe([]),z=xe([]),F=xe([]),V=xe([]),N=[],H=xe(0),U=xe(0),te=xe(0),Z=xe(!1),q=xe([]),J=xe(!1),re=xe(!1),se=xe(null),he=xe({}),le=xe(null),ce=xe(null),pe=xe(null),de=xe(null),Ie=xe(null),Ve=ee(()=>a.value?vy(q.value,a.value):void 0);Wt(d,()=>{var zt;t.state&&(me(!1),t.props.tableLayout==="auto"&&((zt=t.refs.tableHeaderRef)==null||zt.updateFixedColumnStyle()))},{deep:!0});const be=()=>{if(!a.value)throw new Error("[ElTable] prop row-key is required")},ye=zt=>{var st;(st=zt.children)==null||st.forEach(Ft=>{Ft.fixed=zt.fixed,ye(Ft)})};let Me;const we=()=>{r.value.forEach(pn=>{ye(pn)}),M.value=r.value.filter(pn=>pn.fixed===!0||pn.fixed==="left"),P.value=r.value.filter(pn=>pn.fixed==="right"),ai(Me)&&r.value[0]&&r.value[0].type==="selection"&&(Me=!!r.value[0].fixed),M.value.length>0&&r.value[0]&&r.value[0].type==="selection"&&(r.value[0].fixed?M.value.some(xn=>xn.type!=="selection")?Me=void 0:(r.value[0].fixed=Me,Me||M.value.shift()):(r.value[0].fixed=!0,M.value.unshift(r.value[0])));const zt=r.value.filter(pn=>!pn.fixed);S.value=[].concat(M.value).concat(zt).concat(P.value);const st=Qb(zt),Ft=Qb(M.value),Ye=Qb(P.value);H.value=st.length,U.value=Ft.length,te.value=Ye.length,C.value=[].concat(Ft).concat(st).concat(Ye),y.value=M.value.length>0||P.value.length>0},me=(zt,st=!1)=>{zt&&we(),st?t.state.doLayout():t.state.debouncedUpdateLayout()},De=zt=>Ve.value?!!Ve.value[Ns(zt,a.value)]:q.value.includes(zt),Ge=()=>{Z.value=!1;const zt=q.value;q.value=[],zt.length&&t.emit("selection-change",[])},rt=()=>{let zt;if(a.value){zt=[];const st=vy(d.value,a.value);for(const Ft in Ve.value)ri(Ve.value,Ft)&&!st[Ft]&&zt.push(Ve.value[Ft].row)}else zt=q.value.filter(st=>!d.value.includes(st));if(zt.length){const st=q.value.filter(Ft=>!zt.includes(Ft));q.value=st,t.emit("selection-change",st.slice())}},Oe=()=>(q.value||[]).slice(),Ct=(zt,st,Ft=!0,Ye=!1)=>{var pn,xn,_r,yi;const xi={children:(xn=(pn=t==null?void 0:t.store)==null?void 0:pn.states)==null?void 0:xn.childrenColumnName.value,checkStrictly:(yi=(_r=t==null?void 0:t.store)==null?void 0:_r.states)==null?void 0:yi.checkStrictly.value};if(z1(q.value,zt,st,xi,Ye?void 0:se.value)){const ci=(q.value||[]).slice();Ft&&t.emit("select",ci,zt),t.emit("selection-change",ci)}},kt=()=>{var zt,st;const Ft=re.value?!Z.value:!(Z.value||q.value.length);Z.value=Ft;let Ye=!1,pn=0;const xn=(st=(zt=t==null?void 0:t.store)==null?void 0:zt.states)==null?void 0:st.rowKey.value,{childrenColumnName:_r}=t.store.states,yi={children:_r.value,checkStrictly:!1};d.value.forEach((xi,Qi)=>{const ci=Qi+pn;z1(q.value,xi,Ft,yi,se.value,ci)&&(Ye=!0),pn+=jt(Ns(xi,xn))}),Ye&&t.emit("selection-change",q.value?q.value.slice():[]),t.emit("select-all",(q.value||[]).slice())},Bt=()=>{d.value.forEach(zt=>{const st=Ns(zt,a.value),Ft=Ve.value[st];Ft&&(q.value[Ft.index]=zt)})},_t=()=>{var zt;if(((zt=d.value)==null?void 0:zt.length)===0){Z.value=!1;return}const{childrenColumnName:st}=t.store.states;let Ft=0,Ye=0;const pn=_r=>{var yi;for(const xi of _r){const Qi=se.value&&se.value.call(null,xi,Ft);if(De(xi))Ye++;else if(!se.value||Qi)return!1;if(Ft++,(yi=xi[st.value])!=null&&yi.length&&!pn(xi[st.value]))return!1}return!0},xn=pn(d.value||[]);Z.value=Ye===0?!1:xn},jt=zt=>{var st;if(!t||!t.store)return 0;const{treeData:Ft}=t.store.states;let Ye=0;const pn=(st=Ft.value[zt])==null?void 0:st.children;return pn&&(Ye+=pn.length,pn.forEach(xn=>{Ye+=jt(xn)})),Ye},Gt=(zt,st)=>{sn(zt)||(zt=[zt]);const Ft={};return zt.forEach(Ye=>{he.value[Ye.id]=st,Ft[Ye.columnKey||Ye.id]=st}),Ft},Ne=(zt,st,Ft)=>{ce.value&&ce.value!==zt&&(ce.value.order=null),ce.value=zt,pe.value=st,de.value=Ft},an=()=>{let zt=b(p);Object.keys(he.value).forEach(st=>{const Ft=he.value[st];if(!Ft||Ft.length===0)return;const Ye=eN({columns:C.value},st);Ye&&Ye.filterMethod&&(zt=zt.filter(pn=>Ft.some(xn=>Ye.filterMethod.call(null,xn,pn,Ye))))}),le.value=zt},Ae=()=>{d.value=mue(le.value,{sortingColumn:ce.value,sortProp:pe.value,sortOrder:de.value})},tt=(zt=void 0)=>{zt&&zt.filter||an(),Ae()},Je=zt=>{const{tableHeaderRef:st}=t.refs;if(!st)return;const Ft=Object.assign({},st.filterPanels),Ye=Object.keys(Ft);if(Ye.length)if(Nn(zt)&&(zt=[zt]),sn(zt)){const pn=zt.map(xn=>sue({columns:C.value},xn));Ye.forEach(xn=>{const _r=pn.find(yi=>yi.id===xn);_r&&(_r.filteredValue=[])}),t.store.commit("filterChange",{column:pn,values:[],silent:!0,multi:!0})}else Ye.forEach(pn=>{const xn=C.value.find(_r=>_r.id===pn);xn&&(xn.filteredValue=[])}),he.value={},t.store.commit("filterChange",{column:{},values:[],silent:!0})},Jt=()=>{ce.value&&(Ne(null,null,null),t.store.commit("changeSortCondition",{silent:!0}))},{setExpandRowKeys:Kt,toggleRowExpansion:Nt,updateExpandRows:Pt,states:Dt,isRowExpanded:rn}=fue({data:d,rowKey:a}),{updateTreeExpandKeys:on,toggleTreeExpansion:Ln,updateTreeData:yn,updateKeyChildren:Et,loadOrToggle:En,states:Xn}=pue({data:d,rowKey:a}),{updateCurrentRowData:vr,updateCurrentRow:er,setCurrentRowKey:Dr,states:Ar}=hue({data:d,rowKey:a});return{assertRowKey:be,updateColumns:we,scheduleLayout:me,isSelected:De,clearSelection:Ge,cleanSelection:rt,getSelectionRows:Oe,toggleRowSelection:Ct,_toggleAllSelection:kt,toggleAllSelection:null,updateSelectionByRowKey:Bt,updateAllSelected:_t,updateFilters:Gt,updateCurrentRow:er,updateSort:Ne,execFilter:an,execSort:Ae,execQuery:tt,clearFilter:Je,clearSort:Jt,toggleRowExpansion:Nt,setExpandRowKeysAdapter:zt=>{Kt(zt),on(zt)},setCurrentRowKey:Dr,toggleRowExpansionAdapter:(zt,st)=>{C.value.some(({type:Ye})=>Ye==="expand")?Nt(zt,st):Ln(zt,st)},isRowExpanded:rn,updateExpandRows:Pt,updateCurrentRowData:vr,loadOrToggle:En,updateTreeData:yn,updateKeyChildren:Et,states:{tableSize:o,rowKey:a,data:d,_data:p,isComplex:y,_columns:r,originColumns:S,columns:C,fixedColumns:M,rightFixedColumns:P,leafColumns:z,fixedLeafColumns:F,rightFixedLeafColumns:V,updateOrderFns:N,leafColumnsLength:H,fixedLeafColumnsLength:U,rightFixedLeafColumnsLength:te,isAllSelected:Z,selection:q,reserveSelection:J,selectOnIndeterminate:re,selectable:se,filters:he,filteredData:le,sortingColumn:ce,sortProp:pe,sortOrder:de,hoverRow:Ie,...Dt,...Xn,...Ar}}}function AT(e,t){return e.map(o=>{var a;return o.id===t.id?t:((a=o.children)!=null&&a.length&&(o.children=AT(o.children,t)),o)})}function kT(e){e.forEach(t=>{var o,a;t.no=(o=t.getColumnIndex)==null?void 0:o.call(t),(a=t.children)!=null&&a.length&&kT(t.children)}),e.sort((t,o)=>t.no-o.no)}function _ue(){const e=Cr(),t=gue();return{ns:Xt("table"),...t,mutations:{setData(y,r){const S=b(y._data)!==r;y.data.value=r,y._data.value=r,e.store.execQuery(),e.store.updateCurrentRowData(),e.store.updateExpandRows(),e.store.updateTreeData(e.store.states.defaultExpandAll.value),b(y.reserveSelection)?(e.store.assertRowKey(),e.store.updateSelectionByRowKey()):S?e.store.clearSelection():e.store.cleanSelection(),e.store.updateAllSelected(),e.$ready&&e.store.scheduleLayout()},insertColumn(y,r,S,C){const M=b(y._columns);let P=[];S?(S&&!S.children&&(S.children=[]),S.children.push(r),P=AT(M,S)):(M.push(r),P=M),kT(P),y._columns.value=P,y.updateOrderFns.push(C),r.type==="selection"&&(y.selectable.value=r.selectable,y.reserveSelection.value=r.reserveSelection),e.$ready&&(e.store.updateColumns(),e.store.scheduleLayout())},updateColumnOrder(y,r){var S;((S=r.getColumnIndex)==null?void 0:S.call(r))!==r.no&&(kT(y._columns.value),e.$ready&&e.store.updateColumns())},removeColumn(y,r,S,C){const M=b(y._columns)||[];if(S)S.children.splice(S.children.findIndex(z=>z.id===r.id),1),jn(()=>{var z;((z=S.children)==null?void 0:z.length)===0&&delete S.children}),y._columns.value=AT(M,S);else{const z=M.indexOf(r);z>-1&&(M.splice(z,1),y._columns.value=M)}const P=y.updateOrderFns.indexOf(C);P>-1&&y.updateOrderFns.splice(P,1),e.$ready&&(e.store.updateColumns(),e.store.scheduleLayout())},sort(y,r){const{prop:S,order:C,init:M}=r;if(S){const P=b(y.columns).find(z=>z.property===S);P&&(P.order=C,e.store.updateSort(P,S,C),e.store.commit("changeSortCondition",{init:M}))}},changeSortCondition(y,r){const{sortingColumn:S,sortProp:C,sortOrder:M}=y,P=b(S),z=b(C),F=b(M);sv(F)&&(y.sortingColumn.value=null,y.sortProp.value=null);const V={filter:!0};e.store.execQuery(V),(!r||!(r.silent||r.init))&&e.emit("sort-change",{column:P,prop:z,order:F}),e.store.updateTableScrollY()},filterChange(y,r){const{column:S,values:C,silent:M}=r,P=e.store.updateFilters(S,C);e.store.execQuery(),M||e.emit("filter-change",P),e.store.updateTableScrollY()},toggleAllSelection(){e.store.toggleAllSelection()},rowSelectedChanged(y,r){e.store.toggleRowSelection(r),e.store.updateAllSelected()},setHoverRow(y,r){y.hoverRow.value=r},setCurrentRow(y,r){e.store.updateCurrentRow(r)}},commit:function(y,...r){const S=e.store.mutations;if(S[y])S[y].apply(e,[e.store.states].concat(r));else throw new Error(`Action not found: ${y}`)},updateTableScrollY:function(){jn(()=>e.layout.updateScrollY.apply(e.layout))}}}const by={rowKey:"rowKey",defaultExpandAll:"defaultExpandAll",selectOnIndeterminate:"selectOnIndeterminate",indent:"indent",lazy:"lazy",data:"data","treeProps.hasChildren":{key:"lazyColumnIdentifier",default:"hasChildren"},"treeProps.children":{key:"childrenColumnName",default:"children"},"treeProps.checkStrictly":{key:"checkStrictly",default:!1}};function yue(e,t){if(!e)throw new Error("Table is required.");const o=_ue();return o.toggleAllSelection=Ca(o._toggleAllSelection,10),Object.keys(by).forEach(a=>{iN(oN(t,a),a,o)}),vue(o,t),o}function vue(e,t){Object.keys(by).forEach(o=>{Wt(()=>oN(t,o),a=>{iN(a,o,e)})})}function iN(e,t,o){let a=e,d=by[t];xr(by[t])&&(d=d.key,a=a||by[t].default),o.states[d].value=a}function oN(e,t){if(t.includes(".")){const o=t.split(".");let a=e;return o.forEach(d=>{a=a[d]}),a}else return e[t]}class bue{constructor(t){this.observers=[],this.table=null,this.store=null,this.columns=[],this.fit=!0,this.showHeader=!0,this.height=xe(null),this.scrollX=xe(!1),this.scrollY=xe(!1),this.bodyWidth=xe(null),this.fixedWidth=xe(null),this.rightFixedWidth=xe(null),this.gutterWidth=0;for(const o in t)ri(t,o)&&(Ti(this[o])?this[o].value=t[o]:this[o]=t[o]);if(!this.table)throw new Error("Table is required for Table Layout");if(!this.store)throw new Error("Store is required for Table Layout")}updateScrollY(){const t=this.height.value;if(sv(t))return!1;const o=this.table.refs.scrollBarRef;if(this.table.vnode.el&&(o!=null&&o.wrapRef)){let a=!0;const d=this.scrollY.value;return a=o.wrapRef.scrollHeight>o.wrapRef.clientHeight,this.scrollY.value=a,d!==a}return!1}setHeight(t,o="height"){if(!Wr)return;const a=this.table.vnode.el;if(t=lue(t),this.height.value=Number(t),!a&&(t||t===0))return jn(()=>this.setHeight(t,o));Wn(t)?(a.style[o]=`${t}px`,this.updateElsHeight()):Nn(t)&&(a.style[o]=t,this.updateElsHeight())}setMaxHeight(t){this.setHeight(t,"max-height")}getFlattenColumns(){const t=[];return this.table.store.states.columns.value.forEach(a=>{a.isColumnGroup?t.push.apply(t,a.columns):t.push(a)}),t}updateElsHeight(){this.updateScrollY(),this.notifyObservers("scrollable")}headerDisplayNone(t){if(!t)return!0;let o=t;for(;o.tagName!=="DIV";){if(getComputedStyle(o).display==="none")return!0;o=o.parentElement}return!1}updateColumnsWidth(){if(!Wr)return;const t=this.fit,o=this.table.vnode.el.clientWidth;let a=0;const d=this.getFlattenColumns(),p=d.filter(S=>!Wn(S.width));if(d.forEach(S=>{Wn(S.width)&&S.realWidth&&(S.realWidth=null)}),p.length>0&&t){if(d.forEach(S=>{a+=Number(S.width||S.minWidth||80)}),a<=o){this.scrollX.value=!1;const S=o-a;if(p.length===1)p[0].realWidth=Number(p[0].minWidth||80)+S;else{const C=p.reduce((z,F)=>z+Number(F.minWidth||80),0),M=S/C;let P=0;p.forEach((z,F)=>{if(F===0)return;const V=Math.floor(Number(z.minWidth||80)*M);P+=V,z.realWidth=Number(z.minWidth||80)+V}),p[0].realWidth=Number(p[0].minWidth||80)+S-P}}else this.scrollX.value=!0,p.forEach(S=>{S.realWidth=Number(S.minWidth)});this.bodyWidth.value=Math.max(a,o),this.table.state.resizeState.value.width=this.bodyWidth.value}else d.forEach(S=>{!S.width&&!S.minWidth?S.realWidth=80:S.realWidth=Number(S.width||S.minWidth),a+=S.realWidth}),this.scrollX.value=a>o,this.bodyWidth.value=a;const y=this.store.states.fixedColumns.value;if(y.length>0){let S=0;y.forEach(C=>{S+=Number(C.realWidth||C.width)}),this.fixedWidth.value=S}const r=this.store.states.rightFixedColumns.value;if(r.length>0){let S=0;r.forEach(C=>{S+=Number(C.realWidth||C.width)}),this.rightFixedWidth.value=S}this.notifyObservers("columns")}addObserver(t){this.observers.push(t)}removeObserver(t){const o=this.observers.indexOf(t);o!==-1&&this.observers.splice(o,1)}notifyObservers(t){this.observers.forEach(a=>{var d,p;switch(t){case"columns":(d=a.state)==null||d.onColumnsChange(this);break;case"scrollable":(p=a.state)==null||p.onScrollableChange(this);break;default:throw new Error(`Table Layout don't have event ${t}.`)}})}}const{CheckboxGroup:xue}=pl,wue=We({name:"ElTableFilterPanel",components:{ElCheckbox:pl,ElCheckboxGroup:xue,ElScrollbar:Hu,ElTooltip:bs,ElIcon:zn,ArrowDown:zc,ArrowUp:JC},directives:{ClickOutside:Pc},props:{placement:{type:String,default:"bottom-start"},store:{type:Object},column:{type:Object},upDataColumn:{type:Function},appendTo:{type:String}},setup(e){const t=Cr(),{t:o}=qr(),a=Xt("table-filter"),d=t==null?void 0:t.parent;d.filterPanels.value[e.column.id]||(d.filterPanels.value[e.column.id]=t);const p=xe(!1),y=xe(null),r=ee(()=>e.column&&e.column.filters),S=ee(()=>e.column.filterClassName?`${a.b()} ${e.column.filterClassName}`:a.b()),C=ee({get:()=>{var J;return(((J=e.column)==null?void 0:J.filteredValue)||[])[0]},set:J=>{M.value&&(Yl(J)?M.value.splice(0,1):M.value.splice(0,1,J))}}),M=ee({get(){return e.column?e.column.filteredValue||[]:[]},set(J){e.column&&e.upDataColumn("filteredValue",J)}}),P=ee(()=>e.column?e.column.filterMultiple:!0),z=J=>J.value===C.value,F=()=>{p.value=!1},V=J=>{J.stopPropagation(),p.value=!p.value},N=()=>{p.value=!1},H=()=>{Z(M.value),F()},U=()=>{M.value=[],Z(M.value),F()},te=J=>{C.value=J,Yl(J)?Z([]):Z(M.value),F()},Z=J=>{e.store.commit("filterChange",{column:e.column,values:J}),e.store.updateAllSelected()};Wt(p,J=>{e.column&&e.upDataColumn("filterOpened",J)},{immediate:!0});const q=ee(()=>{var J,re;return(re=(J=y.value)==null?void 0:J.popperRef)==null?void 0:re.contentRef});return{tooltipVisible:p,multiple:P,filterClassName:S,filteredValue:M,filterValue:C,filters:r,handleConfirm:H,handleReset:U,handleSelect:te,isPropAbsent:Yl,isActive:z,t:o,ns:a,showFilterPanel:V,hideFilterPanel:N,popperPaneRef:q,tooltip:y}}});function Sue(e,t,o,a,d,p){const y=Er("el-checkbox"),r=Er("el-checkbox-group"),S=Er("el-scrollbar"),C=Er("arrow-up"),M=Er("arrow-down"),P=Er("el-icon"),z=Er("el-tooltip"),F=ex("click-outside");return ae(),At(z,{ref:"tooltip",visible:e.tooltipVisible,offset:0,placement:e.placement,"show-arrow":!1,"stop-popper-mouse-event":!1,teleported:"",effect:"light",pure:"","popper-class":e.filterClassName,persistent:"","append-to":e.appendTo},{content:ot(()=>[e.multiple?(ae(),Pe("div",{key:0},[Ue("div",{class:fe(e.ns.e("content"))},[qe(S,{"wrap-class":e.ns.e("wrap")},{default:ot(()=>[qe(r,{modelValue:e.filteredValue,"onUpdate:modelValue":V=>e.filteredValue=V,class:fe(e.ns.e("checkbox-group"))},{default:ot(()=>[(ae(!0),Pe(Vn,null,Fr(e.filters,V=>(ae(),At(y,{key:V.value,value:V.value},{default:ot(()=>[Nr(fn(V.text),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue","onUpdate:modelValue","class"])]),_:1},8,["wrap-class"])],2),Ue("div",{class:fe(e.ns.e("bottom"))},[Ue("button",{class:fe({[e.ns.is("disabled")]:e.filteredValue.length===0}),disabled:e.filteredValue.length===0,type:"button",onClick:e.handleConfirm},fn(e.t("el.table.confirmFilter")),11,["disabled","onClick"]),Ue("button",{type:"button",onClick:e.handleReset},fn(e.t("el.table.resetFilter")),9,["onClick"])],2)])):(ae(),Pe("ul",{key:1,class:fe(e.ns.e("list"))},[Ue("li",{class:fe([e.ns.e("list-item"),{[e.ns.is("active")]:e.isPropAbsent(e.filterValue)}]),onClick:V=>e.handleSelect(null)},fn(e.t("el.table.clearFilter")),11,["onClick"]),(ae(!0),Pe(Vn,null,Fr(e.filters,V=>(ae(),Pe("li",{key:V.value,class:fe([e.ns.e("list-item"),e.ns.is("active",e.isActive(V))]),label:V.value,onClick:N=>e.handleSelect(V.value)},fn(V.text),11,["label","onClick"]))),128))],2))]),default:ot(()=>[hr((ae(),Pe("span",{class:fe([`${e.ns.namespace.value}-table__column-filter-trigger`,`${e.ns.namespace.value}-none-outline`]),onClick:e.showFilterPanel},[qe(P,null,{default:ot(()=>[gt(e.$slots,"filter-icon",{},()=>[e.column.filterOpened?(ae(),At(C,{key:0})):(ae(),At(M,{key:1}))])]),_:3})],10,["onClick"])),[[F,e.hideFilterPanel,e.popperPaneRef]])]),_:3},8,["visible","placement","popper-class","append-to"])}var Tue=dn(wue,[["render",Sue],["__file","filter-panel.vue"]]);function sN(e){const t=Cr();ev(()=>{o.value.addObserver(t)}),yr(()=>{a(o.value),d(o.value)}),Uu(()=>{a(o.value),d(o.value)}),rf(()=>{o.value.removeObserver(t)});const o=ee(()=>{const p=e.layout;if(!p)throw new Error("Can not find table layout.");return p}),a=p=>{var y;const r=((y=e.vnode.el)==null?void 0:y.querySelectorAll("colgroup > col"))||[];if(!r.length)return;const S=p.getFlattenColumns(),C={};S.forEach(M=>{C[M.id]=M});for(let M=0,P=r.length;M<P;M++){const z=r[M],F=z.getAttribute("name"),V=C[F];V&&z.setAttribute("width",V.realWidth||V.width)}},d=p=>{var y,r;const S=((y=e.vnode.el)==null?void 0:y.querySelectorAll("colgroup > col[name=gutter]"))||[];for(let M=0,P=S.length;M<P;M++)S[M].setAttribute("width",p.scrollY.value?p.gutterWidth:"0");const C=((r=e.vnode.el)==null?void 0:r.querySelectorAll("th.gutter"))||[];for(let M=0,P=C.length;M<P;M++){const z=C[M];z.style.width=p.scrollY.value?`${p.gutterWidth}px`:"0",z.style.display=p.scrollY.value?"":"none"}};return{tableLayout:o.value,onColumnsChange:a,onScrollableChange:d}}const Wu=Symbol("ElTable");function Cue(e,t){const o=Cr(),a=Pn(Wu),d=N=>{N.stopPropagation()},p=(N,H)=>{!H.filters&&H.sortable?V(N,H,!1):H.filterable&&!H.sortable&&d(N),a==null||a.emit("header-click",H,N)},y=(N,H)=>{a==null||a.emit("header-contextmenu",H,N)},r=xe(null),S=xe(!1),C=xe({}),M=(N,H)=>{if(Wr&&!(H.children&&H.children.length>0)&&r.value&&e.border){S.value=!0;const U=a;t("set-drag-visible",!0);const Z=(U==null?void 0:U.vnode.el).getBoundingClientRect().left,q=o.vnode.el.querySelector(`th.${H.id}`),J=q.getBoundingClientRect(),re=J.left-Z+30;ol(q,"noclick"),C.value={startMouseLeft:N.clientX,startLeft:J.right-Z,startColumnLeft:J.left-Z,tableLeft:Z};const se=U==null?void 0:U.refs.resizeProxy;se.style.left=`${C.value.startLeft}px`,document.onselectstart=function(){return!1},document.ondragstart=function(){return!1};const he=ce=>{const pe=ce.clientX-C.value.startMouseLeft,de=C.value.startLeft+pe;se.style.left=`${Math.max(re,de)}px`},le=()=>{if(S.value){const{startColumnLeft:ce,startLeft:pe}=C.value,Ie=Number.parseInt(se.style.left,10)-ce;H.width=H.realWidth=Ie,U==null||U.emit("header-dragend",H.width,pe-ce,H,N),requestAnimationFrame(()=>{e.store.scheduleLayout(!1,!0)}),document.body.style.cursor="",S.value=!1,r.value=null,C.value={},t("set-drag-visible",!1)}document.removeEventListener("mousemove",he),document.removeEventListener("mouseup",le),document.onselectstart=null,document.ondragstart=null,setTimeout(()=>{Vs(q,"noclick")},0)};document.addEventListener("mousemove",he),document.addEventListener("mouseup",le)}},P=(N,H)=>{var U;if(H.children&&H.children.length>0)return;const te=N.target;if(!ea(te))return;const Z=te==null?void 0:te.closest("th");if(!(!H||!H.resizable||!Z)&&!S.value&&e.border){const q=Z.getBoundingClientRect(),J=document.body.style,re=((U=Z.parentNode)==null?void 0:U.lastElementChild)===Z,se=e.allowDragLastColumn||!re;q.width>12&&q.right-N.pageX<8&&se?(J.cursor="col-resize",wa(Z,"is-sortable")&&(Z.style.cursor="col-resize"),r.value=H):S.value||(J.cursor="",wa(Z,"is-sortable")&&(Z.style.cursor="pointer"),r.value=null)}},z=()=>{Wr&&(document.body.style.cursor="")},F=({order:N,sortOrders:H})=>{if(N==="")return H[0];const U=H.indexOf(N||null);return H[U>H.length-2?0:U+1]},V=(N,H,U)=>{var te;N.stopPropagation();const Z=H.order===U?null:U||F(H),q=(te=N.target)==null?void 0:te.closest("th");if(q&&wa(q,"noclick")){Vs(q,"noclick");return}if(!H.sortable)return;const J=N.currentTarget;if(["ascending","descending"].some(ce=>wa(J,ce)&&!H.sortOrders.includes(ce)))return;const re=e.store.states;let se=re.sortProp.value,he;const le=re.sortingColumn.value;(le!==H||le===H&&sv(le.order))&&(le&&(le.order=null),re.sortingColumn.value=H,se=H.property),Z?he=H.order=Z:he=H.order=null,re.sortProp.value=se,re.sortOrder.value=he,a==null||a.store.commit("changeSortCondition")};return{handleHeaderClick:p,handleHeaderContextMenu:y,handleMouseDown:M,handleMouseMove:P,handleMouseOut:z,handleSortClick:V,handleFilterClick:d}}function Eue(e){const t=Pn(Wu),o=Xt("table");return{getHeaderRowStyle:r=>{const S=t==null?void 0:t.props.headerRowStyle;return $n(S)?S.call(null,{rowIndex:r}):S},getHeaderRowClass:r=>{const S=[],C=t==null?void 0:t.props.headerRowClassName;return Nn(C)?S.push(C):$n(C)&&S.push(C.call(null,{rowIndex:r})),S.join(" ")},getHeaderCellStyle:(r,S,C,M)=>{var P;let z=(P=t==null?void 0:t.props.headerCellStyle)!=null?P:{};$n(z)&&(z=z.call(null,{rowIndex:r,columnIndex:S,row:C,column:M}));const F=qE(S,M.fixed,e.store,C);return Gm(F,"left"),Gm(F,"right"),Object.assign({},z,F)},getHeaderCellClass:(r,S,C,M)=>{const P=WE(o.b(),S,M.fixed,e.store,C),z=[M.id,M.order,M.headerAlign,M.className,M.labelClassName,...P];M.children||z.push("is-leaf"),M.sortable&&z.push("is-sortable");const F=t==null?void 0:t.props.headerCellClassName;return Nn(F)?z.push(F):$n(F)&&z.push(F.call(null,{rowIndex:r,columnIndex:S,row:C,column:M})),z.push(o.e("cell")),z.filter(V=>!!V).join(" ")}}}const aN=e=>{const t=[];return e.forEach(o=>{o.children?(t.push(o),t.push.apply(t,aN(o.children))):t.push(o)}),t},lN=e=>{let t=1;const o=(p,y)=>{if(y&&(p.level=y.level+1,t<p.level&&(t=p.level)),p.children){let r=0;p.children.forEach(S=>{o(S,p),r+=S.colSpan}),p.colSpan=r}else p.colSpan=1};e.forEach(p=>{p.level=1,o(p,void 0)});const a=[];for(let p=0;p<t;p++)a.push([]);return aN(e).forEach(p=>{p.children?(p.rowSpan=1,p.children.forEach(y=>y.isSubColumn=!0)):p.rowSpan=t-p.level+1,a[p.level-1].push(p)}),a};function Mue(e){const t=Pn(Wu),o=ee(()=>lN(e.store.states.originColumns.value));return{isGroup:ee(()=>{const p=o.value.length>1;return p&&t&&(t.state.isGroup.value=!0),p}),toggleAllSelection:p=>{p.stopPropagation(),t==null||t.store.commit("toggleAllSelection")},columnRows:o}}var Iue=We({name:"ElTableHeader",components:{ElCheckbox:pl},props:{fixed:{type:String,default:""},store:{required:!0,type:Object},border:Boolean,defaultSort:{type:Object,default:()=>({prop:"",order:""})},appendFilterPanelTo:{type:String},allowDragLastColumn:{type:Boolean}},setup(e,{emit:t}){const o=Cr(),a=Pn(Wu),d=Xt("table"),p=xe({}),{onColumnsChange:y,onScrollableChange:r}=sN(a),S=(a==null?void 0:a.props.tableLayout)==="auto",C=si(new Map),M=xe(),P=()=>{setTimeout(()=>{C.size>0&&(C.forEach((ce,pe)=>{const de=M.value.querySelector(`.${pe.replace(/\s/g,".")}`);if(de){const Ie=de.getBoundingClientRect().width;ce.width=Ie}}),C.clear())})};Wt(C,P),yr(async()=>{await jn(),await jn();const{prop:ce,order:pe}=e.defaultSort;a==null||a.store.commit("sort",{prop:ce,order:pe,init:!0}),P()});const{handleHeaderClick:z,handleHeaderContextMenu:F,handleMouseDown:V,handleMouseMove:N,handleMouseOut:H,handleSortClick:U,handleFilterClick:te}=Cue(e,t),{getHeaderRowStyle:Z,getHeaderRowClass:q,getHeaderCellStyle:J,getHeaderCellClass:re}=Eue(e),{isGroup:se,toggleAllSelection:he,columnRows:le}=Mue(e);return o.state={onColumnsChange:y,onScrollableChange:r},o.filterPanels=p,{ns:d,filterPanels:p,onColumnsChange:y,onScrollableChange:r,columnRows:le,getHeaderRowClass:q,getHeaderRowStyle:Z,getHeaderCellClass:re,getHeaderCellStyle:J,handleHeaderClick:z,handleHeaderContextMenu:F,handleMouseDown:V,handleMouseMove:N,handleMouseOut:H,handleSortClick:U,handleFilterClick:te,isGroup:se,toggleAllSelection:he,saveIndexSelection:C,isTableLayoutAuto:S,theadRef:M,updateFixedColumnStyle:P}},render(){const{ns:e,isGroup:t,columnRows:o,getHeaderCellStyle:a,getHeaderCellClass:d,getHeaderRowClass:p,getHeaderRowStyle:y,handleHeaderClick:r,handleHeaderContextMenu:S,handleMouseDown:C,handleMouseMove:M,handleSortClick:P,handleMouseOut:z,store:F,$parent:V,saveIndexSelection:N,isTableLayoutAuto:H}=this;let U=1;return Zn("thead",{ref:"theadRef",class:{[e.is("group")]:t}},o.map((te,Z)=>Zn("tr",{class:p(Z),key:Z,style:y(Z)},te.map((q,J)=>{q.rowSpan>U&&(U=q.rowSpan);const re=d(Z,J,te,q);return H&&q.fixed&&N.set(re,q),Zn("th",{class:re,colspan:q.colSpan,key:`${q.id}-thead`,rowspan:q.rowSpan,style:a(Z,J,te,q),onClick:se=>{se.currentTarget.classList.contains("noclick")||r(se,q)},onContextmenu:se=>S(se,q),onMousedown:se=>C(se,q),onMousemove:se=>M(se,q),onMouseout:z},[Zn("div",{class:["cell",q.filteredValue&&q.filteredValue.length>0?"highlight":""]},[q.renderHeader?q.renderHeader({column:q,$index:J,store:F,_self:V}):q.label,q.sortable&&Zn("span",{onClick:se=>P(se,q),class:"caret-wrapper"},[Zn("i",{onClick:se=>P(se,q,"ascending"),class:"sort-caret ascending"}),Zn("i",{onClick:se=>P(se,q,"descending"),class:"sort-caret descending"})]),q.filterable&&Zn(Tue,{store:F,placement:q.filterPlacement||"bottom-start",appendTo:V.appendFilterPanelTo,column:q,upDataColumn:(se,he)=>{q[se]=he}},{"filter-icon":()=>q.renderFilterIcon?q.renderFilterIcon({filterOpened:q.filterOpened}):null})])])}))))}});function yS(e,t,o=.03){return e-t>o}function Aue(e){const t=Pn(Wu),o=xe(""),a=xe(Zn("div")),d=(V,N,H)=>{var U;const te=t,Z=_S(V);let q;const J=(U=te==null?void 0:te.vnode.el)==null?void 0:U.dataset.prefix;Z&&(q=WR({columns:e.store.states.columns.value},Z,J),q&&(te==null||te.emit(`cell-${H}`,N,q,Z,V))),te==null||te.emit(`row-${H}`,N,q,V)},p=(V,N)=>{d(V,N,"dblclick")},y=(V,N)=>{e.store.commit("setCurrentRow",N),d(V,N,"click")},r=(V,N)=>{d(V,N,"contextmenu")},S=Ca(V=>{e.store.commit("setHoverRow",V)},30),C=Ca(()=>{e.store.commit("setHoverRow",null)},30),M=V=>{const N=window.getComputedStyle(V,null),H=Number.parseInt(N.paddingLeft,10)||0,U=Number.parseInt(N.paddingRight,10)||0,te=Number.parseInt(N.paddingTop,10)||0,Z=Number.parseInt(N.paddingBottom,10)||0;return{left:H,right:U,top:te,bottom:Z}},P=(V,N,H)=>{let U=N.target.parentNode;for(;V>1&&(U=U==null?void 0:U.nextSibling,!(!U||U.nodeName!=="TR"));)H(U,"hover-row hover-fixed-row"),V--};return{handleDoubleClick:p,handleClick:y,handleContextMenu:r,handleMouseEnter:S,handleMouseLeave:C,handleCellMouseEnter:(V,N,H)=>{var U,te,Z;const q=t,J=_S(V),re=(U=q==null?void 0:q.vnode.el)==null?void 0:U.dataset.prefix;if(J){const me=WR({columns:e.store.states.columns.value},J,re);J.rowSpan>1&&P(J.rowSpan,V,ol);const De=q.hoverState={cell:J,column:me,row:N};q==null||q.emit("cell-mouse-enter",De.row,De.column,De.cell,V)}if(!H)return;const se=V.target.querySelector(".cell");if(!(wa(se,`${re}-tooltip`)&&se.childNodes.length))return;const he=document.createRange();he.setStart(se,0),he.setEnd(se,se.childNodes.length);const{width:le,height:ce}=he.getBoundingClientRect(),{width:pe,height:de}=se.getBoundingClientRect(),{top:Ie,left:Ve,right:be,bottom:ye}=M(se),Me=Ve+be,we=Ie+ye;yS(le+Me,pe)||yS(ce+we,de)||yS(se.scrollWidth,pe)?due(H,J.innerText||J.textContent,J,q):((te=va)==null?void 0:te.trigger)===J&&((Z=va)==null||Z())},handleCellMouseLeave:V=>{const N=_S(V);if(!N)return;N.rowSpan>1&&P(N.rowSpan,V,Vs);const H=t==null?void 0:t.hoverState;t==null||t.emit("cell-mouse-leave",H==null?void 0:H.row,H==null?void 0:H.column,H==null?void 0:H.cell,V)},tooltipContent:o,tooltipTrigger:a}}function kue(e){const t=Pn(Wu),o=Xt("table");return{getRowStyle:(C,M)=>{const P=t==null?void 0:t.props.rowStyle;return $n(P)?P.call(null,{row:C,rowIndex:M}):P||null},getRowClass:(C,M)=>{const P=[o.e("row")];t!=null&&t.props.highlightCurrentRow&&C===e.store.states.currentRow.value&&P.push("current-row"),e.stripe&&M%2===1&&P.push(o.em("row","striped"));const z=t==null?void 0:t.props.rowClassName;return Nn(z)?P.push(z):$n(z)&&P.push(z.call(null,{row:C,rowIndex:M})),P},getCellStyle:(C,M,P,z)=>{const F=t==null?void 0:t.props.cellStyle;let V=F??{};$n(F)&&(V=F.call(null,{rowIndex:C,columnIndex:M,row:P,column:z}));const N=qE(M,e==null?void 0:e.fixed,e.store);return Gm(N,"left"),Gm(N,"right"),Object.assign({},V,N)},getCellClass:(C,M,P,z,F)=>{const V=WE(o.b(),M,e==null?void 0:e.fixed,e.store,void 0,F),N=[z.id,z.align,z.className,...V],H=t==null?void 0:t.props.cellClassName;return Nn(H)?N.push(H):$n(H)&&N.push(H.call(null,{rowIndex:C,columnIndex:M,row:P,column:z})),N.push(o.e("cell")),N.filter(U=>!!U).join(" ")},getSpan:(C,M,P,z)=>{let F=1,V=1;const N=t==null?void 0:t.props.spanMethod;if($n(N)){const H=N({row:C,column:M,rowIndex:P,columnIndex:z});sn(H)?(F=H[0],V=H[1]):xr(H)&&(F=H.rowspan,V=H.colspan)}return{rowspan:F,colspan:V}},getColspanRealWidth:(C,M,P)=>{if(M<1)return C[P].realWidth;const z=C.map(({realWidth:F,width:V})=>F||V).slice(P,P+M);return Number(z.reduce((F,V)=>Number(F)+Number(V),-1))}}}const Pue=We({name:"TableTdWrapper"}),Rue=We({...Pue,props:{colspan:{type:Number,default:1},rowspan:{type:Number,default:1}},setup(e){return(t,o)=>(ae(),Pe("td",{colspan:e.colspan,rowspan:e.rowspan},[gt(t.$slots,"default")],8,["colspan","rowspan"]))}});var Oue=dn(Rue,[["__file","td-wrapper.vue"]]);function Lue(e){const t=Pn(Wu),o=Xt("table"),{handleDoubleClick:a,handleClick:d,handleContextMenu:p,handleMouseEnter:y,handleMouseLeave:r,handleCellMouseEnter:S,handleCellMouseLeave:C,tooltipContent:M,tooltipTrigger:P}=Aue(e),{getRowStyle:z,getRowClass:F,getCellStyle:V,getCellClass:N,getSpan:H,getColspanRealWidth:U}=kue(e),te=ee(()=>e.store.states.columns.value.findIndex(({type:se})=>se==="default")),Z=(se,he)=>{const le=t.props.rowKey;return le?Ns(se,le):he},q=(se,he,le,ce=!1)=>{const{tooltipEffect:pe,tooltipOptions:de,store:Ie}=e,{indent:Ve,columns:be}=Ie.states,ye=F(se,he);let Me=!0;return le&&(ye.push(o.em("row",`level-${le.level}`)),Me=le.display),Zn("tr",{style:[Me?null:{display:"none"},z(se,he)],class:ye,key:Z(se,he),onDblclick:me=>a(me,se),onClick:me=>d(me,se),onContextmenu:me=>p(me,se),onMouseenter:()=>y(he),onMouseleave:r},be.value.map((me,De)=>{const{rowspan:Ge,colspan:rt}=H(se,me,he,De);if(!Ge||!rt)return null;const Oe=Object.assign({},me);Oe.realWidth=U(be.value,rt,De);const Ct={store:e.store,_self:e.context||t,column:Oe,row:se,$index:he,cellIndex:De,expanded:ce};De===te.value&&le&&(Ct.treeNode={indent:le.level*Ve.value,level:le.level},Oi(le.expanded)&&(Ct.treeNode.expanded=le.expanded,"loading"in le&&(Ct.treeNode.loading=le.loading),"noLazyChildren"in le&&(Ct.treeNode.noLazyChildren=le.noLazyChildren)));const kt=`${Z(se,he)},${De}`,Bt=Oe.columnKey||Oe.rawColumnKey||"",_t=me.showOverflowTooltip&&lz({effect:pe},de,me.showOverflowTooltip);return Zn(Oue,{style:V(he,De,se,me),class:N(he,De,se,me,rt-1),key:`${Bt}${kt}`,rowspan:Ge,colspan:rt,onMouseenter:jt=>S(jt,se,_t),onMouseleave:C},{default:()=>J(De,me,Ct)})}))},J=(se,he,le)=>he.renderCell(le);return{wrappedRowRender:(se,he)=>{const le=e.store,{isRowExpanded:ce,assertRowKey:pe}=le,{treeData:de,lazyTreeNodeMap:Ie,childrenColumnName:Ve,rowKey:be}=le.states,ye=le.states.columns.value;if(ye.some(({type:we})=>we==="expand")){const we=ce(se),me=q(se,he,void 0,we),De=t.renderExpanded;return we?De?[[me,Zn("tr",{key:`expanded-row__${me.key}`},[Zn("td",{colspan:ye.length,class:`${o.e("cell")} ${o.e("expanded-cell")}`},[De({row:se,$index:he,store:le,expanded:we})])])]]:(console.error("[Element Error]renderExpanded is required."),me):[[me]]}else if(Object.keys(de.value).length){pe();const we=Ns(se,be.value);let me=de.value[we],De=null;me&&(De={expanded:me.expanded,level:me.level,display:!0},Oi(me.lazy)&&(Oi(me.loaded)&&me.loaded&&(De.noLazyChildren=!(me.children&&me.children.length)),De.loading=me.loading));const Ge=[q(se,he,De)];if(me){let rt=0;const Oe=(kt,Bt)=>{kt&&kt.length&&Bt&&kt.forEach(_t=>{const jt={display:Bt.display&&Bt.expanded,level:Bt.level+1,expanded:!1,noLazyChildren:!1,loading:!1},Gt=Ns(_t,be.value);if(Yl(Gt))throw new Error("For nested data item, row-key is required.");if(me={...de.value[Gt]},me&&(jt.expanded=me.expanded,me.level=me.level||jt.level,me.display=!!(me.expanded&&jt.display),Oi(me.lazy)&&(Oi(me.loaded)&&me.loaded&&(jt.noLazyChildren=!(me.children&&me.children.length)),jt.loading=me.loading)),rt++,Ge.push(q(_t,he+rt,jt)),me){const Ne=Ie.value[Gt]||_t[Ve.value];Oe(Ne,me)}})};me.display=!0;const Ct=Ie.value[we]||se[Ve.value];Oe(Ct,me)}return Ge}else return q(se,he,void 0)},tooltipContent:M,tooltipTrigger:P}}const Due={store:{required:!0,type:Object},stripe:Boolean,tooltipEffect:String,tooltipOptions:{type:Object},context:{default:()=>({}),type:Object},rowClassName:[String,Function],rowStyle:[Object,Function],fixed:{type:String,default:""},highlight:Boolean};var zue=We({name:"ElTableBody",props:Due,setup(e){const t=Cr(),o=Pn(Wu),a=Xt("table"),{wrappedRowRender:d,tooltipContent:p,tooltipTrigger:y}=Lue(e),{onColumnsChange:r,onScrollableChange:S}=sN(o),C=[];return Wt(e.store.states.hoverRow,(M,P)=>{var z;const F=t==null?void 0:t.vnode.el,V=Array.from((F==null?void 0:F.children)||[]).filter(U=>U==null?void 0:U.classList.contains(`${a.e("row")}`));let N=M;const H=(z=V[N])==null?void 0:z.childNodes;if(H!=null&&H.length){let U=0;Array.from(H).reduce((Z,q,J)=>{var re,se;return((re=H[J])==null?void 0:re.colSpan)>1&&(U=(se=H[J])==null?void 0:se.colSpan),q.nodeName!=="TD"&&U===0&&Z.push(J),U>0&&U--,Z},[]).forEach(Z=>{var q;for(N=M;N>0;){const J=(q=V[N-1])==null?void 0:q.childNodes;if(J[Z]&&J[Z].nodeName==="TD"&&J[Z].rowSpan>1){ol(J[Z],"hover-cell"),C.push(J[Z]);break}N--}})}else C.forEach(U=>Vs(U,"hover-cell")),C.length=0;!e.store.states.isComplex.value||!Wr||Zd(()=>{const U=V[P],te=V[M];U&&!U.classList.contains("hover-fixed-row")&&Vs(U,"hover-row"),te&&ol(te,"hover-row")})}),rf(()=>{var M;(M=va)==null||M()}),{ns:a,onColumnsChange:r,onScrollableChange:S,wrappedRowRender:d,tooltipContent:p,tooltipTrigger:y}},render(){const{wrappedRowRender:e,store:t}=this,o=t.states.data.value||[];return Zn("tbody",{tabIndex:-1},[o.reduce((a,d)=>a.concat(e(d,a.length)),[])])}});function Fue(){const e=Pn(Wu),t=e==null?void 0:e.store,o=ee(()=>t.states.fixedLeafColumnsLength.value),a=ee(()=>t.states.rightFixedColumns.value.length),d=ee(()=>t.states.columns.value.length),p=ee(()=>t.states.fixedColumns.value.length),y=ee(()=>t.states.rightFixedColumns.value.length);return{leftFixedLeafCount:o,rightFixedLeafCount:a,columnsCount:d,leftFixedCount:p,rightFixedCount:y,columns:t.states.columns}}function Nue(e){const{columns:t}=Fue(),o=Xt("table");return{getCellClasses:(p,y)=>{const r=p[y],S=[o.e("cell"),r.id,r.align,r.labelClassName,...WE(o.b(),y,r.fixed,e.store)];return r.className&&S.push(r.className),r.children||S.push(o.is("leaf")),S},getCellStyles:(p,y)=>{const r=qE(y,p.fixed,e.store);return Gm(r,"left"),Gm(r,"right"),r},columns:t}}var Bue=We({name:"ElTableFooter",props:{fixed:{type:String,default:""},store:{required:!0,type:Object},summaryMethod:Function,sumText:String,border:Boolean,defaultSort:{type:Object,default:()=>({prop:"",order:""})}},setup(e){const{getCellClasses:t,getCellStyles:o,columns:a}=Nue(e);return{ns:Xt("table"),getCellClasses:t,getCellStyles:o,columns:a}},render(){const{columns:e,getCellStyles:t,getCellClasses:o,summaryMethod:a,sumText:d}=this,p=this.store.states.data.value;let y=[];return a?y=a({columns:e,data:p}):e.forEach((r,S)=>{if(S===0){y[S]=d;return}const C=p.map(F=>Number(F[r.property])),M=[];let P=!0;C.forEach(F=>{if(!Number.isNaN(+F)){P=!1;const V=`${F}`.split(".")[1];M.push(V?V.length:0)}});const z=Math.max.apply(null,M);P?y[S]="":y[S]=C.reduce((F,V)=>{const N=Number(V);return Number.isNaN(+N)?F:Number.parseFloat((F+V).toFixed(Math.min(z,20)))},0)}),Zn(Zn("tfoot",[Zn("tr",{},[...e.map((r,S)=>Zn("td",{key:S,colspan:r.colSpan,rowspan:r.rowSpan,class:o(e,S),style:t(r,S)},[Zn("div",{class:["cell",r.labelClassName]},[y[S]])]))])]))}});function Vue(e){return{setCurrentRow:P=>{e.commit("setCurrentRow",P)},getSelectionRows:()=>e.getSelectionRows(),toggleRowSelection:(P,z,F=!0)=>{e.toggleRowSelection(P,z,!1,F),e.updateAllSelected()},clearSelection:()=>{e.clearSelection()},clearFilter:P=>{e.clearFilter(P)},toggleAllSelection:()=>{e.commit("toggleAllSelection")},toggleRowExpansion:(P,z)=>{e.toggleRowExpansionAdapter(P,z)},clearSort:()=>{e.clearSort()},sort:(P,z)=>{e.commit("sort",{prop:P,order:z})},updateKeyChildren:(P,z)=>{e.updateKeyChildren(P,z)}}}function $ue(e,t,o,a){const d=xe(!1),p=xe(null),y=xe(!1),r=we=>{y.value=we},S=xe({width:null,height:null,headerHeight:null}),C=xe(!1),M={display:"inline-block",verticalAlign:"middle"},P=xe(),z=xe(0),F=xe(0),V=xe(0),N=xe(0),H=xe(0);gs(()=>{t.setHeight(e.height)}),gs(()=>{t.setMaxHeight(e.maxHeight)}),Wt(()=>[e.currentRowKey,o.states.rowKey],([we,me])=>{!b(me)||!b(we)||o.setCurrentRowKey(`${we}`)},{immediate:!0}),Wt(()=>e.data,we=>{a.store.commit("setData",we)},{immediate:!0,deep:!0}),gs(()=>{e.expandRowKeys&&o.setExpandRowKeysAdapter(e.expandRowKeys)});const U=()=>{a.store.commit("setHoverRow",null),a.hoverState&&(a.hoverState=null)},te=(we,me)=>{const{pixelX:De,pixelY:Ge}=me;Math.abs(De)>=Math.abs(Ge)&&(a.refs.bodyWrapper.scrollLeft+=me.pixelX/5)},Z=ee(()=>e.height||e.maxHeight||o.states.fixedColumns.value.length>0||o.states.rightFixedColumns.value.length>0),q=ee(()=>({width:t.bodyWidth.value?`${t.bodyWidth.value}px`:""})),J=()=>{Z.value&&t.updateElsHeight(),t.updateColumnsWidth(),requestAnimationFrame(le)};yr(async()=>{await jn(),o.updateColumns(),ce(),requestAnimationFrame(J);const we=a.vnode.el,me=a.refs.headerWrapper;e.flexible&&we&&we.parentElement&&(we.parentElement.style.minWidth="0"),S.value={width:P.value=we.offsetWidth,height:we.offsetHeight,headerHeight:e.showHeader&&me?me.offsetHeight:null},o.states.columns.value.forEach(De=>{De.filteredValue&&De.filteredValue.length&&a.store.commit("filterChange",{column:De,values:De.filteredValue,silent:!0})}),a.$ready=!0});const re=(we,me)=>{if(!we)return;const De=Array.from(we.classList).filter(Ge=>!Ge.startsWith("is-scrolling-"));De.push(t.scrollX.value?me:"is-scrolling-none"),we.className=De.join(" ")},se=we=>{const{tableWrapper:me}=a.refs;re(me,we)},he=we=>{const{tableWrapper:me}=a.refs;return!!(me&&me.classList.contains(we))},le=function(){if(!a.refs.scrollBarRef)return;if(!t.scrollX.value){const kt="is-scrolling-none";he(kt)||se(kt);return}const we=a.refs.scrollBarRef.wrapRef;if(!we)return;const{scrollLeft:me,offsetWidth:De,scrollWidth:Ge}=we,{headerWrapper:rt,footerWrapper:Oe}=a.refs;rt&&(rt.scrollLeft=me),Oe&&(Oe.scrollLeft=me);const Ct=Ge-De-1;me>=Ct?se("is-scrolling-right"):se(me===0?"is-scrolling-left":"is-scrolling-middle")},ce=()=>{a.refs.scrollBarRef&&(a.refs.scrollBarRef.wrapRef&&Si(a.refs.scrollBarRef.wrapRef,"scroll",le,{passive:!0}),e.fit?ro(a.vnode.el,pe):Si(window,"resize",pe),ro(a.refs.bodyWrapper,()=>{var we,me;pe(),(me=(we=a.refs)==null?void 0:we.scrollBarRef)==null||me.update()}))},pe=()=>{var we,me,De,Ge;const rt=a.vnode.el;if(!a.$ready||!rt)return;let Oe=!1;const{width:Ct,height:kt,headerHeight:Bt}=S.value,_t=P.value=rt.offsetWidth;Ct!==_t&&(Oe=!0);const jt=rt.offsetHeight;(e.height||Z.value)&&kt!==jt&&(Oe=!0);const Gt=e.tableLayout==="fixed"?a.refs.headerWrapper:(we=a.refs.tableHeaderRef)==null?void 0:we.$el;e.showHeader&&(Gt==null?void 0:Gt.offsetHeight)!==Bt&&(Oe=!0),z.value=((me=a.refs.tableWrapper)==null?void 0:me.scrollHeight)||0,V.value=(Gt==null?void 0:Gt.scrollHeight)||0,N.value=((De=a.refs.footerWrapper)==null?void 0:De.offsetHeight)||0,H.value=((Ge=a.refs.appendWrapper)==null?void 0:Ge.offsetHeight)||0,F.value=z.value-V.value-N.value-H.value,Oe&&(S.value={width:_t,height:jt,headerHeight:e.showHeader&&(Gt==null?void 0:Gt.offsetHeight)||0},J())},de=Ro(),Ie=ee(()=>{const{bodyWidth:we,scrollY:me,gutterWidth:De}=t;return we.value?`${we.value-(me.value?De:0)}px`:""}),Ve=ee(()=>e.maxHeight?"fixed":e.tableLayout),be=ee(()=>{if(e.data&&e.data.length)return null;let we="100%";e.height&&F.value&&(we=`${F.value}px`);const me=P.value;return{width:me?`${me}px`:"",height:we}}),ye=ee(()=>e.height?{height:"100%"}:e.maxHeight?Number.isNaN(Number(e.maxHeight))?{maxHeight:`calc(${e.maxHeight} - ${V.value+N.value}px)`}:{maxHeight:`${e.maxHeight-V.value-N.value}px`}:{});return{isHidden:d,renderExpanded:p,setDragVisible:r,isGroup:C,handleMouseLeave:U,handleHeaderFooterMousewheel:te,tableSize:de,emptyBlockStyle:be,handleFixedMousewheel:(we,me)=>{const De=a.refs.bodyWrapper;if(Math.abs(me.spinY)>0){const Ge=De.scrollTop;me.pixelY<0&&Ge!==0&&we.preventDefault(),me.pixelY>0&&De.scrollHeight-De.clientHeight>Ge&&we.preventDefault(),De.scrollTop+=Math.ceil(me.pixelY/5)}else De.scrollLeft+=Math.ceil(me.pixelX/5)},resizeProxyVisible:y,bodyWidth:Ie,resizeState:S,doLayout:J,tableBodyStyles:q,tableLayout:Ve,scrollbarViewStyle:M,scrollbarStyle:ye}}function Uue(e){const t=xe(),o=()=>{const d=e.vnode.el.querySelector(".hidden-columns"),p={childList:!0,subtree:!0},y=e.store.states.updateOrderFns;t.value=new MutationObserver(()=>{y.forEach(r=>r())}),t.value.observe(d,p)};yr(()=>{o()}),rf(()=>{var a;(a=t.value)==null||a.disconnect()})}var jue={data:{type:Array,default:()=>[]},size:zo,width:[String,Number],height:[String,Number],maxHeight:[String,Number],fit:{type:Boolean,default:!0},stripe:Boolean,border:Boolean,rowKey:[String,Function],showHeader:{type:Boolean,default:!0},showSummary:Boolean,sumText:String,summaryMethod:Function,rowClassName:[String,Function],rowStyle:[Object,Function],cellClassName:[String,Function],cellStyle:[Object,Function],headerRowClassName:[String,Function],headerRowStyle:[Object,Function],headerCellClassName:[String,Function],headerCellStyle:[Object,Function],highlightCurrentRow:Boolean,currentRowKey:[String,Number],emptyText:String,expandRowKeys:Array,defaultExpandAll:Boolean,defaultSort:Object,tooltipEffect:String,tooltipOptions:Object,spanMethod:Function,selectOnIndeterminate:{type:Boolean,default:!0},indent:{type:Number,default:16},treeProps:{type:Object,default:()=>({hasChildren:"hasChildren",children:"children",checkStrictly:!1})},lazy:Boolean,load:Function,style:{type:Object,default:()=>({})},className:{type:String,default:""},tableLayout:{type:String,default:"fixed"},scrollbarAlwaysOn:Boolean,flexible:Boolean,showOverflowTooltip:[Boolean,Object],appendFilterPanelTo:String,scrollbarTabindex:{type:[Number,String],default:void 0},allowDragLastColumn:{type:Boolean,default:!0}};function uN(e){const t=e.tableLayout==="auto";let o=e.columns||[];t&&o.every(({width:d})=>ai(d))&&(o=[]);const a=d=>{const p={key:`${e.tableLayout}_${d.id}`,style:{},name:void 0};return t?p.style={width:`${d.width}px`}:p.name=d.id,p};return Zn("colgroup",{},o.map(d=>Zn("col",a(d))))}uN.props=["columns","tableLayout"];const Hue=()=>{const e=xe(),t=(p,y)=>{const r=e.value;r&&r.scrollTo(p,y)},o=(p,y)=>{const r=e.value;r&&Wn(y)&&["Top","Left"].includes(p)&&r[`setScroll${p}`](y)};return{scrollBarRef:e,scrollTo:t,setScrollTop:p=>o("Top",p),setScrollLeft:p=>o("Left",p)}};var YR=!1,sh,PT,RT,e1,t1,cN,n1,OT,LT,DT,dN,zT,FT,fN,hN;function ya(){if(!YR){YR=!0;var e=navigator.userAgent,t=/(?:MSIE.(\d+\.\d+))|(?:(?:Firefox|GranParadiso|Iceweasel).(\d+\.\d+))|(?:Opera(?:.+Version.|.)(\d+\.\d+))|(?:AppleWebKit.(\d+(?:\.\d+)?))|(?:Trident\/\d+\.\d+.*rv:(\d+\.\d+))/.exec(e),o=/(Mac OS X)|(Windows)|(Linux)/.exec(e);if(zT=/\b(iPhone|iP[ao]d)/.exec(e),FT=/\b(iP[ao]d)/.exec(e),DT=/Android/i.exec(e),fN=/FBAN\/\w+;/i.exec(e),hN=/Mobile/i.exec(e),dN=!!/Win64/.exec(e),t){sh=t[1]?parseFloat(t[1]):t[5]?parseFloat(t[5]):NaN,sh&&document&&document.documentMode&&(sh=document.documentMode);var a=/(?:Trident\/(\d+.\d+))/.exec(e);cN=a?parseFloat(a[1])+4:sh,PT=t[2]?parseFloat(t[2]):NaN,RT=t[3]?parseFloat(t[3]):NaN,e1=t[4]?parseFloat(t[4]):NaN,e1?(t=/(?:Chrome\/(\d+\.\d+))/.exec(e),t1=t&&t[1]?parseFloat(t[1]):NaN):t1=NaN}else sh=PT=RT=t1=e1=NaN;if(o){if(o[1]){var d=/(?:Mac OS X (\d+(?:[._]\d+)?))/.exec(e);n1=d?parseFloat(d[1].replace("_",".")):!0}else n1=!1;OT=!!o[2],LT=!!o[3]}else n1=OT=LT=!1}}var NT={ie:function(){return ya()||sh},ieCompatibilityMode:function(){return ya()||cN>sh},ie64:function(){return NT.ie()&&dN},firefox:function(){return ya()||PT},opera:function(){return ya()||RT},webkit:function(){return ya()||e1},safari:function(){return NT.webkit()},chrome:function(){return ya()||t1},windows:function(){return ya()||OT},osx:function(){return ya()||n1},linux:function(){return ya()||LT},iphone:function(){return ya()||zT},mobile:function(){return ya()||zT||FT||DT||hN},nativeApp:function(){return ya()||fN},android:function(){return ya()||DT},ipad:function(){return ya()||FT}},Gue=NT,Lb=!!(typeof window<"u"&&window.document&&window.document.createElement),Wue={canUseDOM:Lb,canUseWorkers:typeof Worker<"u",canUseEventListeners:Lb&&!!(window.addEventListener||window.attachEvent),canUseViewport:Lb&&!!window.screen,isInWorker:!Lb},pN=Wue,mN;pN.canUseDOM&&(mN=document.implementation&&document.implementation.hasFeature&&document.implementation.hasFeature("","")!==!0);function que(e,t){if(!pN.canUseDOM||t&&!("addEventListener"in document))return!1;var o="on"+e,a=o in document;if(!a){var d=document.createElement("div");d.setAttribute(o,"return;"),a=typeof d[o]=="function"}return!a&&mN&&e==="wheel"&&(a=document.implementation.hasFeature("Events.wheel","3.0")),a}var Kue=que,XR=10,JR=40,QR=800;function gN(e){var t=0,o=0,a=0,d=0;return"detail"in e&&(o=e.detail),"wheelDelta"in e&&(o=-e.wheelDelta/120),"wheelDeltaY"in e&&(o=-e.wheelDeltaY/120),"wheelDeltaX"in e&&(t=-e.wheelDeltaX/120),"axis"in e&&e.axis===e.HORIZONTAL_AXIS&&(t=o,o=0),a=t*XR,d=o*XR,"deltaY"in e&&(d=e.deltaY),"deltaX"in e&&(a=e.deltaX),(a||d)&&e.deltaMode&&(e.deltaMode==1?(a*=JR,d*=JR):(a*=QR,d*=QR)),a&&!t&&(t=a<1?-1:1),d&&!o&&(o=d<1?-1:1),{spinX:t,spinY:o,pixelX:a,pixelY:d}}gN.getEventType=function(){return Gue.firefox()?"DOMMouseScroll":Kue("wheel")?"wheel":"mousewheel"};var Zue=gN;/**
* Checks if an event is supported in the current execution environment.
*
* NOTE: This will not work correctly for non-generic events such as `change`,
* `reset`, `load`, `error`, and `select`.
*
* Borrows from Modernizr.
*
* @param {string} eventNameSuffix Event name, e.g. "click".
* @param {?boolean} capture Check if the capture phase is supported.
* @return {boolean} True if the event is supported.
* @internal
* @license Modernizr 3.0.0pre (Custom Build) | MIT
*/const Yue=function(e,t){if(e&&e.addEventListener){const o=function(a){const d=Zue(a);t&&Reflect.apply(t,this,[a,d])};e.addEventListener("wheel",o,{passive:!0})}},Xue={beforeMount(e,t){Yue(e,t.value)}};let Jue=1;const Que=We({name:"ElTable",directives:{Mousewheel:Xue},components:{TableHeader:Iue,TableBody:zue,TableFooter:Bue,ElScrollbar:Hu,hColgroup:uN},props:jue,emits:["select","select-all","selection-change","cell-mouse-enter","cell-mouse-leave","cell-contextmenu","cell-click","cell-dblclick","row-click","row-contextmenu","row-dblclick","header-click","header-contextmenu","sort-change","filter-change","current-change","header-dragend","expand-change","scroll"],setup(e){const{t}=qr(),o=Xt("table"),a=Cr();Vr(Wu,a);const d=yue(a,e);a.store=d;const p=new bue({store:a.store,table:a,fit:e.fit,showHeader:e.showHeader});a.layout=p;const y=ee(()=>(d.states.data.value||[]).length===0),{setCurrentRow:r,getSelectionRows:S,toggleRowSelection:C,clearSelection:M,clearFilter:P,toggleAllSelection:z,toggleRowExpansion:F,clearSort:V,sort:N,updateKeyChildren:H}=Vue(d),{isHidden:U,renderExpanded:te,setDragVisible:Z,isGroup:q,handleMouseLeave:J,handleHeaderFooterMousewheel:re,tableSize:se,emptyBlockStyle:he,handleFixedMousewheel:le,resizeProxyVisible:ce,bodyWidth:pe,resizeState:de,doLayout:Ie,tableBodyStyles:Ve,tableLayout:be,scrollbarViewStyle:ye,scrollbarStyle:Me}=$ue(e,p,d,a),{scrollBarRef:we,scrollTo:me,setScrollLeft:De,setScrollTop:Ge}=Hue(),rt=Ca(Ie,50),Oe=`${o.namespace.value}-table_${Jue++}`;a.tableId=Oe,a.state={isGroup:q,resizeState:de,doLayout:Ie,debouncedUpdateLayout:rt};const Ct=ee(()=>{var _t;return(_t=e.sumText)!=null?_t:t("el.table.sumText")}),kt=ee(()=>{var _t;return(_t=e.emptyText)!=null?_t:t("el.table.emptyText")}),Bt=ee(()=>lN(d.states.originColumns.value)[0]);return Uue(a),Li(()=>{rt.cancel()}),{ns:o,layout:p,store:d,columns:Bt,handleHeaderFooterMousewheel:re,handleMouseLeave:J,tableId:Oe,tableSize:se,isHidden:U,isEmpty:y,renderExpanded:te,resizeProxyVisible:ce,resizeState:de,isGroup:q,bodyWidth:pe,tableBodyStyles:Ve,emptyBlockStyle:he,debouncedUpdateLayout:rt,handleFixedMousewheel:le,setCurrentRow:r,getSelectionRows:S,toggleRowSelection:C,clearSelection:M,clearFilter:P,toggleAllSelection:z,toggleRowExpansion:F,clearSort:V,doLayout:Ie,sort:N,updateKeyChildren:H,t,setDragVisible:Z,context:a,computedSumText:Ct,computedEmptyText:kt,tableLayout:be,scrollbarViewStyle:ye,scrollbarStyle:Me,scrollBarRef:we,scrollTo:me,setScrollLeft:De,setScrollTop:Ge,allowDragLastColumn:e.allowDragLastColumn}}});function ece(e,t,o,a,d,p){const y=Er("hColgroup"),r=Er("table-header"),S=Er("table-body"),C=Er("table-footer"),M=Er("el-scrollbar"),P=ex("mousewheel");return ae(),Pe("div",{ref:"tableWrapper",class:fe([{[e.ns.m("fit")]:e.fit,[e.ns.m("striped")]:e.stripe,[e.ns.m("border")]:e.border||e.isGroup,[e.ns.m("hidden")]:e.isHidden,[e.ns.m("group")]:e.isGroup,[e.ns.m("fluid-height")]:e.maxHeight,[e.ns.m("scrollable-x")]:e.layout.scrollX.value,[e.ns.m("scrollable-y")]:e.layout.scrollY.value,[e.ns.m("enable-row-hover")]:!e.store.states.isComplex.value,[e.ns.m("enable-row-transition")]:(e.store.states.data.value||[]).length!==0&&(e.store.states.data.value||[]).length<100,"has-footer":e.showSummary},e.ns.m(e.tableSize),e.className,e.ns.b(),e.ns.m(`layout-${e.tableLayout}`)]),style:Un(e.style),"data-prefix":e.ns.namespace.value,onMouseleave:e.handleMouseLeave},[Ue("div",{class:fe(e.ns.e("inner-wrapper"))},[Ue("div",{ref:"hiddenColumns",class:"hidden-columns"},[gt(e.$slots,"default")],512),e.showHeader&&e.tableLayout==="fixed"?hr((ae(),Pe("div",{key:0,ref:"headerWrapper",class:fe(e.ns.e("header-wrapper"))},[Ue("table",{ref:"tableHeader",class:fe(e.ns.e("header")),style:Un(e.tableBodyStyles),border:"0",cellpadding:"0",cellspacing:"0"},[qe(y,{columns:e.store.states.columns.value,"table-layout":e.tableLayout},null,8,["columns","table-layout"]),qe(r,{ref:"tableHeaderRef",border:e.border,"default-sort":e.defaultSort,store:e.store,"append-filter-panel-to":e.appendFilterPanelTo,"allow-drag-last-column":e.allowDragLastColumn,onSetDragVisible:e.setDragVisible},null,8,["border","default-sort","store","append-filter-panel-to","allow-drag-last-column","onSetDragVisible"])],6)],2)),[[P,e.handleHeaderFooterMousewheel]]):bt("v-if",!0),Ue("div",{ref:"bodyWrapper",class:fe(e.ns.e("body-wrapper"))},[qe(M,{ref:"scrollBarRef","view-style":e.scrollbarViewStyle,"wrap-style":e.scrollbarStyle,always:e.scrollbarAlwaysOn,tabindex:e.scrollbarTabindex,onScroll:z=>e.$emit("scroll",z)},{default:ot(()=>[Ue("table",{ref:"tableBody",class:fe(e.ns.e("body")),cellspacing:"0",cellpadding:"0",border:"0",style:Un({width:e.bodyWidth,tableLayout:e.tableLayout})},[qe(y,{columns:e.store.states.columns.value,"table-layout":e.tableLayout},null,8,["columns","table-layout"]),e.showHeader&&e.tableLayout==="auto"?(ae(),At(r,{key:0,ref:"tableHeaderRef",class:fe(e.ns.e("body-header")),border:e.border,"default-sort":e.defaultSort,store:e.store,"append-filter-panel-to":e.appendFilterPanelTo,onSetDragVisible:e.setDragVisible},null,8,["class","border","default-sort","store","append-filter-panel-to","onSetDragVisible"])):bt("v-if",!0),qe(S,{context:e.context,highlight:e.highlightCurrentRow,"row-class-name":e.rowClassName,"tooltip-effect":e.tooltipEffect,"tooltip-options":e.tooltipOptions,"row-style":e.rowStyle,store:e.store,stripe:e.stripe},null,8,["context","highlight","row-class-name","tooltip-effect","tooltip-options","row-style","store","stripe"]),e.showSummary&&e.tableLayout==="auto"?(ae(),At(C,{key:1,class:fe(e.ns.e("body-footer")),border:e.border,"default-sort":e.defaultSort,store:e.store,"sum-text":e.computedSumText,"summary-method":e.summaryMethod},null,8,["class","border","default-sort","store","sum-text","summary-method"])):bt("v-if",!0)],6),e.isEmpty?(ae(),Pe("div",{key:0,ref:"emptyBlock",style:Un(e.emptyBlockStyle),class:fe(e.ns.e("empty-block"))},[Ue("span",{class:fe(e.ns.e("empty-text"))},[gt(e.$slots,"empty",{},()=>[Nr(fn(e.computedEmptyText),1)])],2)],6)):bt("v-if",!0),e.$slots.append?(ae(),Pe("div",{key:1,ref:"appendWrapper",class:fe(e.ns.e("append-wrapper"))},[gt(e.$slots,"append")],2)):bt("v-if",!0)]),_:3},8,["view-style","wrap-style","always","tabindex","onScroll"])],2),e.showSummary&&e.tableLayout==="fixed"?hr((ae(),Pe("div",{key:1,ref:"footerWrapper",class:fe(e.ns.e("footer-wrapper"))},[Ue("table",{class:fe(e.ns.e("footer")),cellspacing:"0",cellpadding:"0",border:"0",style:Un(e.tableBodyStyles)},[qe(y,{columns:e.store.states.columns.value,"table-layout":e.tableLayout},null,8,["columns","table-layout"]),qe(C,{border:e.border,"default-sort":e.defaultSort,store:e.store,"sum-text":e.computedSumText,"summary-method":e.summaryMethod},null,8,["border","default-sort","store","sum-text","summary-method"])],6)],2)),[[ii,!e.isEmpty],[P,e.handleHeaderFooterMousewheel]]):bt("v-if",!0),e.border||e.isGroup?(ae(),Pe("div",{key:2,class:fe(e.ns.e("border-left-patch"))},null,2)):bt("v-if",!0)],2),hr(Ue("div",{ref:"resizeProxy",class:fe(e.ns.e("column-resize-proxy"))},null,2),[[ii,e.resizeProxyVisible]])],46,["data-prefix","onMouseleave"])}var tce=dn(Que,[["render",ece],["__file","table.vue"]]);const nce={selection:"table-column--selection",expand:"table__expand-column"},rce={default:{order:""},selection:{width:48,minWidth:48,realWidth:48,order:""},expand:{width:48,minWidth:48,realWidth:48,order:""},index:{width:48,minWidth:48,realWidth:48,order:""}},ice=e=>nce[e]||"",oce={selection:{renderHeader({store:e,column:t}){function o(){return e.states.data.value&&e.states.data.value.length===0}return Zn(pl,{disabled:o(),size:e.states.tableSize.value,indeterminate:e.states.selection.value.length>0&&!e.states.isAllSelected.value,"onUpdate:modelValue":e.toggleAllSelection,modelValue:e.states.isAllSelected.value,ariaLabel:t.label})},renderCell({row:e,column:t,store:o,$index:a}){return Zn(pl,{disabled:t.selectable?!t.selectable.call(null,e,a):!1,size:o.states.tableSize.value,onChange:()=>{o.commit("rowSelectedChanged",e)},onClick:d=>d.stopPropagation(),modelValue:o.isSelected(e),ariaLabel:t.label})},sortable:!1,resizable:!1},index:{renderHeader({column:e}){return e.label||"#"},renderCell({column:e,$index:t}){let o=t+1;const a=e.index;return Wn(a)?o=t+a:$n(a)&&(o=a(t)),Zn("div",{},[o])},sortable:!1},expand:{renderHeader({column:e}){return e.label||""},renderCell({row:e,store:t,expanded:o}){const{ns:a}=t,d=[a.e("expand-icon")];return o&&d.push(a.em("expand-icon","expanded")),Zn("div",{class:d,onClick:function(y){y.stopPropagation(),t.toggleRowExpansion(e)}},{default:()=>[Zn(zn,null,{default:()=>[Zn(ta)]})]})},sortable:!1,resizable:!1}};function sce({row:e,column:t,$index:o}){var a;const d=t.property,p=d&&Wb(e,d).value;return t&&t.formatter?t.formatter(e,t,p,o):((a=p==null?void 0:p.toString)==null?void 0:a.call(p))||""}function ace({row:e,treeNode:t,store:o},a=!1){const{ns:d}=o;if(!t)return a?[Zn("span",{class:d.e("placeholder")})]:null;const p=[],y=function(r){r.stopPropagation(),!t.loading&&o.loadOrToggle(e)};if(t.indent&&p.push(Zn("span",{class:d.e("indent"),style:{"padding-left":`${t.indent}px`}})),Oi(t.expanded)&&!t.noLazyChildren){const r=[d.e("expand-icon"),t.expanded?d.em("expand-icon","expanded"):""];let S=ta;t.loading&&(S=Fu),p.push(Zn("div",{class:r,onClick:y},{default:()=>[Zn(zn,{class:{[d.is("loading")]:t.loading}},{default:()=>[Zn(S)]})]}))}else p.push(Zn("span",{class:d.e("placeholder")}));return p}function eO(e,t){return e.reduce((o,a)=>(o[a]=a,o),t)}function lce(e,t){const o=Cr();return{registerComplexWatchers:()=>{const p=["fixed"],y={realWidth:"width",realMinWidth:"minWidth"},r=eO(p,y);Object.keys(r).forEach(S=>{const C=y[S];ri(t,C)&&Wt(()=>t[C],M=>{let P=M;C==="width"&&S==="realWidth"&&(P=GE(M)),C==="minWidth"&&S==="realMinWidth"&&(P=tN(M)),o.columnConfig.value[C]=P,o.columnConfig.value[S]=P;const z=C==="fixed";e.value.store.scheduleLayout(z)})})},registerNormalWatchers:()=>{const p=["label","filters","filterMultiple","filteredValue","sortable","index","formatter","className","labelClassName","filterClassName","showOverflowTooltip"],y={property:"prop",align:"realAlign",headerAlign:"realHeaderAlign"},r=eO(p,y);Object.keys(r).forEach(S=>{const C=y[S];ri(t,C)&&Wt(()=>t[C],M=>{o.columnConfig.value[S]=M})})}}}function uce(e,t,o){const a=Cr(),d=xe(""),p=xe(!1),y=xe(),r=xe(),S=Xt("table");gs(()=>{y.value=e.align?`is-${e.align}`:null,y.value}),gs(()=>{r.value=e.headerAlign?`is-${e.headerAlign}`:y.value,r.value});const C=ee(()=>{let q=a.vnode.vParent||a.parent;for(;q&&!q.tableId&&!q.columnId;)q=q.vnode.vParent||q.parent;return q}),M=ee(()=>{const{store:q}=a.parent;if(!q)return!1;const{treeData:J}=q.states,re=J.value;return re&&Object.keys(re).length>0}),P=xe(GE(e.width)),z=xe(tN(e.minWidth)),F=q=>(P.value&&(q.width=P.value),z.value&&(q.minWidth=z.value),!P.value&&z.value&&(q.width=void 0),q.minWidth||(q.minWidth=80),q.realWidth=Number(ai(q.width)?q.minWidth:q.width),q),V=q=>{const J=q.type,re=oce[J]||{};Object.keys(re).forEach(he=>{const le=re[he];he!=="className"&&!ai(le)&&(q[he]=le)});const se=ice(J);if(se){const he=`${b(S.namespace)}-${se}`;q.className=q.className?`${q.className} ${he}`:he}return q},N=q=>{sn(q)?q.forEach(re=>J(re)):J(q);function J(re){var se;((se=re==null?void 0:re.type)==null?void 0:se.name)==="ElTableColumn"&&(re.vParent=a)}};return{columnId:d,realAlign:y,isSubColumn:p,realHeaderAlign:r,columnOrTableParent:C,setColumnWidth:F,setColumnForcedProps:V,setColumnRenders:q=>{e.renderHeader||q.type!=="selection"&&(q.renderHeader=re=>(a.columnConfig.value.label,gt(t,"header",re,()=>[q.label]))),t["filter-icon"]&&(q.renderFilterIcon=re=>gt(t,"filter-icon",re));let J=q.renderCell;return q.type==="expand"?(q.renderCell=re=>Zn("div",{class:"cell"},[J(re)]),o.value.renderExpanded=re=>t.default?t.default(re):t.default):(J=J||sce,q.renderCell=re=>{let se=null;if(t.default){const Ie=t.default(re);se=Ie.some(Ve=>Ve.type!==Qo)?Ie:J(re)}else se=J(re);const{columns:he}=o.value.store.states,le=he.value.findIndex(Ie=>Ie.type==="default"),ce=M.value&&re.cellIndex===le,pe=ace(re,ce),de={class:"cell",style:{}};return q.showOverflowTooltip&&(de.class=`${de.class} ${b(S.namespace)}-tooltip`,de.style={width:`${(re.column.realWidth||Number(re.column.width))-1}px`}),N(se),Zn("div",de,[pe,se])}),q},getPropsData:(...q)=>q.reduce((J,re)=>(sn(re)&&re.forEach(se=>{J[se]=e[se]}),J),{}),getColumnElIndex:(q,J)=>Array.prototype.indexOf.call(q,J),updateColumnOrder:()=>{o.value.store.commit("updateColumnOrder",a.columnConfig.value)}}}var cce={type:{type:String,default:"default"},label:String,className:String,labelClassName:String,property:String,prop:String,width:{type:[String,Number],default:""},minWidth:{type:[String,Number],default:""},renderHeader:Function,sortable:{type:[Boolean,String],default:!1},sortMethod:Function,sortBy:[String,Function,Array],resizable:{type:Boolean,default:!0},columnKey:String,align:String,headerAlign:String,showOverflowTooltip:{type:[Boolean,Object],default:void 0},fixed:[Boolean,String],formatter:Function,selectable:Function,reserveSelection:Boolean,filterMethod:Function,filteredValue:Array,filters:Array,filterPlacement:String,filterMultiple:{type:Boolean,default:!0},filterClassName:String,index:[Number,Function],sortOrders:{type:Array,default:()=>["ascending","descending",null],validator:e=>e.every(t=>["ascending","descending",null].includes(t))}};let dce=1;var _N=We({name:"ElTableColumn",components:{ElCheckbox:pl},props:cce,setup(e,{slots:t}){const o=Cr(),a=xe({}),d=ee(()=>{let Z=o.parent;for(;Z&&!Z.tableId;)Z=Z.parent;return Z}),{registerNormalWatchers:p,registerComplexWatchers:y}=lce(d,e),{columnId:r,isSubColumn:S,realHeaderAlign:C,columnOrTableParent:M,setColumnWidth:P,setColumnForcedProps:z,setColumnRenders:F,getPropsData:V,getColumnElIndex:N,realAlign:H,updateColumnOrder:U}=uce(e,t,d),te=M.value;r.value=`${te.tableId||te.columnId}_column_${dce++}`,ev(()=>{S.value=d.value!==te;const Z=e.type||"default",q=e.sortable===""?!0:e.sortable,J=ai(e.showOverflowTooltip)?te.props.showOverflowTooltip:e.showOverflowTooltip,re={...rce[Z],id:r.value,type:Z,property:e.prop||e.property,align:H,headerAlign:C,showOverflowTooltip:J,filterable:e.filters||e.filterMethod,filteredValue:[],filterPlacement:"",filterClassName:"",isColumnGroup:!1,isSubColumn:!1,filterOpened:!1,sortable:q,index:e.index,rawColumnKey:o.vnode.key};let pe=V(["columnKey","label","className","labelClassName","type","renderHeader","formatter","fixed","resizable"],["sortMethod","sortBy","sortOrders"],["selectable","reserveSelection"],["filterMethod","filters","filterMultiple","filterOpened","filteredValue","filterPlacement","filterClassName"]);pe=aue(re,pe),pe=uue(F,P,z)(pe),a.value=pe,p(),y()}),yr(()=>{var Z;const q=M.value,J=S.value?q.vnode.el.children:(Z=q.refs.hiddenColumns)==null?void 0:Z.children,re=()=>N(J||[],o.vnode.el);a.value.getColumnIndex=re,re()>-1&&d.value.store.commit("insertColumn",a.value,S.value?q.columnConfig.value:null,U)}),Li(()=>{const Z=a.value.getColumnIndex;(Z?Z():-1)>-1&&d.value.store.commit("removeColumn",a.value,S.value?te.columnConfig.value:null,U)}),o.columnId=r.value,o.columnConfig=a},render(){var e,t,o;try{const a=(t=(e=this.$slots).default)==null?void 0:t.call(e,{row:{},column:{},$index:-1}),d=[];if(sn(a))for(const y of a)((o=y.type)==null?void 0:o.name)==="ElTableColumn"||y.shapeFlag&2?d.push(y):y.type===Vn&&sn(y.children)&&y.children.forEach(r=>{(r==null?void 0:r.patchFlag)!==1024&&!Nn(r==null?void 0:r.children)&&d.push(r)});return Zn("div",d)}catch{return Zn("div",[])}}});const fce=lr(tce,{TableColumn:_N}),hce=oo(_N);var Gy=(e=>(e.ASC="asc",e.DESC="desc",e))(Gy||{}),Wy=(e=>(e.CENTER="center",e.RIGHT="right",e))(Wy||{}),yN=(e=>(e.LEFT="left",e.RIGHT="right",e))(yN||{});const BT={asc:"desc",desc:"asc"},qy=Symbol("placeholder"),pce=(e,t,o)=>{var a;const d={flexGrow:0,flexShrink:0,...o?{}:{flexGrow:e.flexGrow||0,flexShrink:e.flexShrink||1}};o||(d.flexShrink=1);const p={...(a=e.style)!=null?a:{},...d,flexBasis:"auto",width:e.width};return t||(e.maxWidth&&(p.maxWidth=e.maxWidth),e.minWidth&&(p.minWidth=e.minWidth)),p};function mce(e,t,o){const a=ee(()=>b(t).map((H,U)=>{var te,Z;return{...H,key:(Z=(te=H.key)!=null?te:H.dataKey)!=null?Z:U}})),d=ee(()=>b(a).filter(H=>!H.hidden)),p=ee(()=>b(d).filter(H=>H.fixed==="left"||H.fixed===!0)),y=ee(()=>b(d).filter(H=>H.fixed==="right")),r=ee(()=>b(d).filter(H=>!H.fixed)),S=ee(()=>{const H=[];return b(p).forEach(U=>{H.push({...U,placeholderSign:qy})}),b(r).forEach(U=>{H.push(U)}),b(y).forEach(U=>{H.push({...U,placeholderSign:qy})}),H}),C=ee(()=>b(p).length||b(y).length),M=ee(()=>b(a).reduce((H,U)=>(H[U.key]=pce(U,b(o),e.fixed),H),{})),P=ee(()=>b(d).reduce((H,U)=>H+U.width,0)),z=H=>b(a).find(U=>U.key===H),F=H=>b(M)[H],V=(H,U)=>{H.width=U};function N(H){var U;const{key:te}=H.currentTarget.dataset;if(!te)return;const{sortState:Z,sortBy:q}=e;let J=Gy.ASC;xr(Z)?J=BT[Z[te]]:J=BT[q.order],(U=e.onColumnSort)==null||U.call(e,{column:z(te),key:te,order:J})}return{columns:a,columnsStyles:M,columnsTotalWidth:P,fixedColumnsOnLeft:p,fixedColumnsOnRight:y,hasFixedColumns:C,mainColumns:S,normalColumns:r,visibleColumns:d,getColumn:z,getColumnStyle:F,updateColumnWidth:V,onColumnSorted:N}}const gce=(e,{mainTableRef:t,leftTableRef:o,rightTableRef:a,onMaybeEndReached:d})=>{const p=xe({scrollLeft:0,scrollTop:0});function y(F){var V,N,H;const{scrollTop:U}=F;(V=t.value)==null||V.scrollTo(F),(N=o.value)==null||N.scrollToTop(U),(H=a.value)==null||H.scrollToTop(U)}function r(F){p.value=F,y(F)}function S(F){p.value.scrollTop=F,y(b(p))}function C(F){var V,N;p.value.scrollLeft=F,(N=(V=t.value)==null?void 0:V.scrollTo)==null||N.call(V,b(p))}function M(F){var V;r(F),(V=e.onScroll)==null||V.call(e,F)}function P({scrollTop:F}){const{scrollTop:V}=b(p);F!==V&&S(F)}function z(F,V="auto"){var N;(N=t.value)==null||N.scrollToRow(F,V)}return Wt(()=>b(p).scrollTop,(F,V)=>{F>V&&d()}),{scrollPos:p,scrollTo:r,scrollToLeft:C,scrollToTop:S,scrollToRow:z,onScroll:M,onVerticalScroll:P}},_ce=(e,{mainTableRef:t,leftTableRef:o,rightTableRef:a,tableInstance:d,ns:p,isScrolling:y})=>{const r=Cr(),{emit:S}=r,C=Hi(!1),M=xe(e.defaultExpandedRowKeys||[]),P=xe(-1),z=Hi(null),F=xe({}),V=xe({}),N=Hi({}),H=Hi({}),U=Hi({}),te=ee(()=>Wn(e.estimatedRowHeight));function Z(ce){var pe;(pe=e.onRowsRendered)==null||pe.call(e,ce),ce.rowCacheEnd>b(P)&&(P.value=ce.rowCacheEnd)}function q({hovered:ce,rowKey:pe}){if(y.value)return;d.vnode.el.querySelectorAll(`[rowkey="${String(pe)}"]`).forEach(Ve=>{ce?Ve.classList.add(p.is("hovered")):Ve.classList.remove(p.is("hovered"))})}function J({expanded:ce,rowData:pe,rowIndex:de,rowKey:Ie}){var Ve,be;const ye=[...b(M)],Me=ye.indexOf(Ie);ce?Me===-1&&ye.push(Ie):Me>-1&&ye.splice(Me,1),M.value=ye,S("update:expandedRowKeys",ye),(Ve=e.onRowExpand)==null||Ve.call(e,{expanded:ce,rowData:pe,rowIndex:de,rowKey:Ie}),(be=e.onExpandedRowsChange)==null||be.call(e,ye)}const re=Ca(()=>{var ce,pe,de,Ie;C.value=!0,F.value={...b(F),...b(V)},se(b(z),!1),V.value={},z.value=null,(ce=t.value)==null||ce.forceUpdate(),(pe=o.value)==null||pe.forceUpdate(),(de=a.value)==null||de.forceUpdate(),(Ie=r.proxy)==null||Ie.$forceUpdate(),C.value=!1},0);function se(ce,pe=!1){b(te)&&[t,o,a].forEach(de=>{const Ie=b(de);Ie&&Ie.resetAfterRowIndex(ce,pe)})}function he(ce,pe,de){const Ie=b(z);(Ie===null||Ie>de)&&(z.value=de),V.value[ce]=pe}function le({rowKey:ce,height:pe,rowIndex:de},Ie){Ie?Ie===yN.RIGHT?U.value[ce]=pe:N.value[ce]=pe:H.value[ce]=pe;const Ve=Math.max(...[N,U,H].map(be=>be.value[ce]||0));b(F)[ce]!==Ve&&(he(ce,Ve,de),re())}return{expandedRowKeys:M,lastRenderedRowIndex:P,isDynamic:te,isResetting:C,rowHeights:F,resetAfterIndex:se,onRowExpanded:J,onRowHovered:q,onRowsRendered:Z,onRowHeightChange:le}},yce=(e,{expandedRowKeys:t,lastRenderedRowIndex:o,resetAfterIndex:a})=>{const d=xe({}),p=ee(()=>{const r={},{data:S,rowKey:C}=e,M=b(t);if(!M||!M.length)return S;const P=[],z=new Set;M.forEach(V=>z.add(V));let F=S.slice();for(F.forEach(V=>r[V[C]]=0);F.length>0;){const V=F.shift();P.push(V),z.has(V[C])&&sn(V.children)&&V.children.length>0&&(F=[...V.children,...F],V.children.forEach(N=>r[N[C]]=r[V[C]]+1))}return d.value=r,P}),y=ee(()=>{const{data:r,expandColumnKey:S}=e;return S?b(p):r});return Wt(y,(r,S)=>{r!==S&&(o.value=-1,a(0,!0))}),{data:y,depthMap:d}},vce=(e,t)=>e+t,r1=e=>sn(e)?e.reduce(vce,0):e,Eh=(e,t,o={})=>$n(e)?e(t):e??o,Bd=e=>(["width","maxWidth","minWidth","height"].forEach(t=>{e[t]=_o(e[t])}),e),vN=e=>Ji(e)?t=>Zn(e,t):e,bce=(e,{columnsTotalWidth:t,rowsHeight:o,fixedColumnsOnLeft:a,fixedColumnsOnRight:d})=>{const p=ee(()=>{const{fixed:te,width:Z,vScrollbarSize:q}=e,J=Z-q;return te?Math.max(Math.round(b(t)),J):J}),y=ee(()=>b(p)+e.vScrollbarSize),r=ee(()=>{const{height:te=0,maxHeight:Z=0,footerHeight:q,hScrollbarSize:J}=e;if(Z>0){const re=b(F),se=b(o),le=b(z)+re+se+J;return Math.min(le,Z-q)}return te-q}),S=ee(()=>{const{maxHeight:te}=e,Z=b(r);if(Wn(te)&&te>0)return Z;const q=b(o)+b(z)+b(F);return Math.min(Z,q)}),C=te=>te.width,M=ee(()=>r1(b(a).map(C))),P=ee(()=>r1(b(d).map(C))),z=ee(()=>r1(e.headerHeight)),F=ee(()=>{var te;return(((te=e.fixedData)==null?void 0:te.length)||0)*e.rowHeight}),V=ee(()=>b(r)-b(z)-b(F)),N=ee(()=>{const{style:te={},height:Z,width:q}=e;return Bd({...te,height:Z,width:q})}),H=ee(()=>Bd({height:e.footerHeight})),U=ee(()=>({top:_o(b(z)),bottom:_o(e.footerHeight),width:_o(e.width)}));return{bodyWidth:p,fixedTableHeight:S,mainTableHeight:r,leftTableWidth:M,rightTableWidth:P,headerWidth:y,windowHeight:V,footerHeight:H,emptyStyle:U,rootStyle:N,headerHeight:z}};function xce(e){const t=xe(),o=xe(),a=xe(),{columns:d,columnsStyles:p,columnsTotalWidth:y,fixedColumnsOnLeft:r,fixedColumnsOnRight:S,hasFixedColumns:C,mainColumns:M,onColumnSorted:P}=mce(e,hi(e,"columns"),hi(e,"fixed")),{scrollTo:z,scrollToLeft:F,scrollToTop:V,scrollToRow:N,onScroll:H,onVerticalScroll:U,scrollPos:te}=gce(e,{mainTableRef:t,leftTableRef:o,rightTableRef:a,onMaybeEndReached:tt}),Z=Xt("table-v2"),q=Cr(),J=Hi(!1),{expandedRowKeys:re,lastRenderedRowIndex:se,isDynamic:he,isResetting:le,rowHeights:ce,resetAfterIndex:pe,onRowExpanded:de,onRowHeightChange:Ie,onRowHovered:Ve,onRowsRendered:be}=_ce(e,{mainTableRef:t,leftTableRef:o,rightTableRef:a,tableInstance:q,ns:Z,isScrolling:J}),{data:ye,depthMap:Me}=yce(e,{expandedRowKeys:re,lastRenderedRowIndex:se,resetAfterIndex:pe}),we=ee(()=>{const{estimatedRowHeight:Je,rowHeight:Jt}=e,Kt=b(ye);return Wn(Je)?Object.values(b(ce)).reduce((Nt,Pt)=>Nt+Pt,0):Kt.length*Jt}),{bodyWidth:me,fixedTableHeight:De,mainTableHeight:Ge,leftTableWidth:rt,rightTableWidth:Oe,headerWidth:Ct,windowHeight:kt,footerHeight:Bt,emptyStyle:_t,rootStyle:jt,headerHeight:Gt}=bce(e,{columnsTotalWidth:y,fixedColumnsOnLeft:r,fixedColumnsOnRight:S,rowsHeight:we}),Ne=xe(),an=ee(()=>{const Je=b(ye).length===0;return sn(e.fixedData)?e.fixedData.length===0&&Je:Je});function Ae(Je){const{estimatedRowHeight:Jt,rowHeight:Kt,rowKey:Nt}=e;return Jt?b(ce)[b(ye)[Je][Nt]]||Jt:Kt}function tt(){const{onEndReached:Je}=e;if(!Je)return;const{scrollTop:Jt}=b(te),Kt=b(we),Nt=b(kt),Pt=Kt-(Jt+Nt)+e.hScrollbarSize;b(se)>=0&&Kt===Jt+b(Ge)-b(Gt)&&Je(Pt)}return Wt(()=>e.expandedRowKeys,Je=>re.value=Je,{deep:!0}),{columns:d,containerRef:Ne,mainTableRef:t,leftTableRef:o,rightTableRef:a,isDynamic:he,isResetting:le,isScrolling:J,hasFixedColumns:C,columnsStyles:p,columnsTotalWidth:y,data:ye,expandedRowKeys:re,depthMap:Me,fixedColumnsOnLeft:r,fixedColumnsOnRight:S,mainColumns:M,bodyWidth:me,emptyStyle:_t,rootStyle:jt,headerWidth:Ct,footerHeight:Bt,mainTableHeight:Ge,fixedTableHeight:De,leftTableWidth:rt,rightTableWidth:Oe,showEmpty:an,getRowHeight:Ae,onColumnSorted:P,onRowHovered:Ve,onRowExpanded:de,onRowsRendered:be,onRowHeightChange:Ie,scrollTo:z,scrollToLeft:F,scrollToTop:V,scrollToRow:N,onScroll:H,onVerticalScroll:U}}const KE=Symbol("tableV2"),bN=String,pv={type:lt(Array),required:!0},ZE={type:lt(Array)},xN={...ZE,required:!0},wce=String,tO={type:lt(Array),default:()=>io([])},ah={type:Number,required:!0},wN={type:lt([String,Number,Symbol]),default:"id"},nO={type:lt(Object)},dh=un({class:String,columns:pv,columnsStyles:{type:lt(Object),required:!0},depth:Number,expandColumnKey:wce,estimatedRowHeight:{...yh.estimatedRowHeight,default:void 0},isScrolling:Boolean,onRowExpand:{type:lt(Function)},onRowHover:{type:lt(Function)},onRowHeightChange:{type:lt(Function)},rowData:{type:lt(Object),required:!0},rowEventHandlers:{type:lt(Object)},rowIndex:{type:Number,required:!0},rowKey:wN,style:{type:lt(Object)}}),vS={type:Number,required:!0},YE=un({class:String,columns:pv,fixedHeaderData:{type:lt(Array)},headerData:{type:lt(Array),required:!0},headerHeight:{type:lt([Number,Array]),default:50},rowWidth:vS,rowHeight:{type:Number,default:50},height:vS,width:vS}),i1=un({columns:pv,data:xN,fixedData:ZE,estimatedRowHeight:dh.estimatedRowHeight,width:ah,height:ah,headerWidth:ah,headerHeight:YE.headerHeight,bodyWidth:ah,rowHeight:ah,cache:UF.cache,useIsScrolling:Boolean,scrollbarAlwaysOn:yh.scrollbarAlwaysOn,scrollbarStartGap:yh.scrollbarStartGap,scrollbarEndGap:yh.scrollbarEndGap,class:bN,style:nO,containerStyle:nO,getRowHeight:{type:lt(Function),required:!0},rowKey:dh.rowKey,onRowsRendered:{type:lt(Function)},onScroll:{type:lt(Function)}}),Sce=un({cache:i1.cache,estimatedRowHeight:dh.estimatedRowHeight,rowKey:wN,headerClass:{type:lt([String,Function])},headerProps:{type:lt([Object,Function])},headerCellProps:{type:lt([Object,Function])},headerHeight:YE.headerHeight,footerHeight:{type:Number,default:0},rowClass:{type:lt([String,Function])},rowProps:{type:lt([Object,Function])},rowHeight:{type:Number,default:50},cellProps:{type:lt([Object,Function])},columns:pv,data:xN,dataGetter:{type:lt(Function)},fixedData:ZE,expandColumnKey:dh.expandColumnKey,expandedRowKeys:tO,defaultExpandedRowKeys:tO,class:bN,fixed:Boolean,style:{type:lt(Object)},width:ah,height:ah,maxHeight:Number,useIsScrolling:Boolean,indentSize:{type:Number,default:12},iconSize:{type:Number,default:12},hScrollbarSize:yh.hScrollbarSize,vScrollbarSize:yh.vScrollbarSize,scrollbarAlwaysOn:GF.alwaysOn,sortBy:{type:lt(Object),default:()=>({})},sortState:{type:lt(Object),default:void 0},onColumnSort:{type:lt(Function)},onExpandedRowsChange:{type:lt(Function)},onEndReached:{type:lt(Function)},onRowExpand:dh.onRowExpand,onScroll:i1.onScroll,onRowsRendered:i1.onRowsRendered,rowEventHandlers:dh.rowEventHandlers}),Tce="ElTableV2Header",Cce=We({name:Tce,props:YE,setup(e,{slots:t,expose:o}){const a=Xt("table-v2"),d=Pn("tableV2GridScrollLeft"),p=xe(),y=ee(()=>Bd({width:e.width,height:e.height})),r=ee(()=>Bd({width:e.rowWidth,height:e.height})),S=ee(()=>Fs(b(e.headerHeight))),C=z=>{const F=b(p);jn(()=>{F!=null&&F.scroll&&F.scroll({left:z})})},M=()=>{const z=a.e("fixed-header-row"),{columns:F,fixedHeaderData:V,rowHeight:N}=e;return V==null?void 0:V.map((H,U)=>{var te;const Z=Bd({height:N,width:"100%"});return(te=t.fixed)==null?void 0:te.call(t,{class:z,columns:F,rowData:H,rowIndex:-(U+1),style:Z})})},P=()=>{const z=a.e("dynamic-header-row"),{columns:F}=e;return b(S).map((V,N)=>{var H;const U=Bd({width:"100%",height:V});return(H=t.dynamic)==null?void 0:H.call(t,{class:z,columns:F,headerIndex:N,style:U})})};return Uu(()=>{d!=null&&d.value&&C(d.value)}),o({scrollToLeft:C}),()=>{if(!(e.height<=0))return qe("div",{ref:p,class:e.class,style:b(y),role:"rowgroup"},[qe("div",{style:b(r),class:a.e("header")},[P(),M()])])}}});var Ece=Cce;const Mce=({atXEndEdge:e,atXStartEdge:t,atYEndEdge:o,atYStartEdge:a},d)=>{let p=null,y=0,r=0;const S=(M,P)=>{const z=M<=0&&t.value||M>=0&&e.value,F=P<=0&&a.value||P>=0&&o.value;return z&&F};return{hasReachedEdge:S,onWheel:M=>{Th(p);let P=M.deltaX,z=M.deltaY;Math.abs(P)>Math.abs(z)?z=0:P=0,M.shiftKey&&z!==0&&(P=z,z=0),!(S(y,r)&&S(y+P,r+z))&&(y+=P,r+=z,M.preventDefault(),p=Zd(()=>{d(y,r),y=0,r=0}))}}},SN=({name:e,clearCache:t,getColumnPosition:o,getColumnStartIndexForOffset:a,getColumnStopIndexForStartIndex:d,getEstimatedTotalHeight:p,getEstimatedTotalWidth:y,getColumnOffset:r,getRowOffset:S,getRowPosition:C,getRowStartIndexForOffset:M,getRowStopIndexForStartIndex:P,initCache:z,injectToInstance:F,validateProps:V})=>We({name:e??"ElVirtualList",props:yh,emits:[k1,P1],setup(N,{emit:H,expose:U,slots:te}){const Z=Xt("vl");V(N);const q=Cr(),J=xe(z(N,q));F==null||F(q,J);const re=xe(),se=xe(),he=xe(),le=xe(null),ce=xe({isScrolling:!1,scrollLeft:Wn(N.initScrollLeft)?N.initScrollLeft:0,scrollTop:Wn(N.initScrollTop)?N.initScrollTop:0,updateRequested:!1,xAxisScrollDir:vm,yAxisScrollDir:vm}),pe=BF(),de=ee(()=>Number.parseInt(`${N.height}`,10)),Ie=ee(()=>Number.parseInt(`${N.width}`,10)),Ve=ee(()=>{const{totalColumn:Nt,totalRow:Pt,columnCache:Dt}=N,{isScrolling:rn,xAxisScrollDir:on,scrollLeft:Ln}=b(ce);if(Nt===0||Pt===0)return[0,0,0,0];const yn=a(N,Ln,b(J)),Et=d(N,yn,Ln,b(J)),En=!rn||on===R1?Math.max(1,Dt):1,Xn=!rn||on===vm?Math.max(1,Dt):1;return[Math.max(0,yn-En),Math.max(0,Math.min(Nt-1,Et+Xn)),yn,Et]}),be=ee(()=>{const{totalColumn:Nt,totalRow:Pt,rowCache:Dt}=N,{isScrolling:rn,yAxisScrollDir:on,scrollTop:Ln}=b(ce);if(Nt===0||Pt===0)return[0,0,0,0];const yn=M(N,Ln,b(J)),Et=P(N,yn,Ln,b(J)),En=!rn||on===R1?Math.max(1,Dt):1,Xn=!rn||on===vm?Math.max(1,Dt):1;return[Math.max(0,yn-En),Math.max(0,Math.min(Pt-1,Et+Xn)),yn,Et]}),ye=ee(()=>p(N,b(J))),Me=ee(()=>y(N,b(J))),we=ee(()=>{var Nt;return[{position:"relative",overflow:"hidden",WebkitOverflowScrolling:"touch",willChange:"transform"},{direction:N.direction,height:Wn(N.height)?`${N.height}px`:N.height,width:Wn(N.width)?`${N.width}px`:N.width},(Nt=N.style)!=null?Nt:{}]}),me=ee(()=>{const Nt=`${b(Me)}px`;return{height:`${b(ye)}px`,pointerEvents:b(ce).isScrolling?"none":void 0,width:Nt}}),De=()=>{const{totalColumn:Nt,totalRow:Pt}=N;if(Nt>0&&Pt>0){const[Et,En,Xn,vr]=b(Ve),[er,Dr,Ar,Di]=b(be);H(k1,{columnCacheStart:Et,columnCacheEnd:En,rowCacheStart:er,rowCacheEnd:Dr,columnVisibleStart:Xn,columnVisibleEnd:vr,rowVisibleStart:Ar,rowVisibleEnd:Di})}const{scrollLeft:Dt,scrollTop:rn,updateRequested:on,xAxisScrollDir:Ln,yAxisScrollDir:yn}=b(ce);H(P1,{xAxisScrollDir:Ln,scrollLeft:Dt,yAxisScrollDir:yn,scrollTop:rn,updateRequested:on})},Ge=Nt=>{const{clientHeight:Pt,clientWidth:Dt,scrollHeight:rn,scrollLeft:on,scrollTop:Ln,scrollWidth:yn}=Nt.currentTarget,Et=b(ce);if(Et.scrollTop===Ln&&Et.scrollLeft===on)return;let En=on;if(BR(N.direction))switch(L1()){case jy:En=-on;break;case HE:En=yn-Dt-on;break}ce.value={...Et,isScrolling:!0,scrollLeft:En,scrollTop:Math.max(0,Math.min(Ln,rn-Pt)),updateRequested:!0,xAxisScrollDir:ch(Et.scrollLeft,En),yAxisScrollDir:ch(Et.scrollTop,Ln)},jn(()=>jt()),Gt(),De()},rt=(Nt,Pt)=>{const Dt=b(de),rn=(ye.value-Dt)/Pt*Nt;kt({scrollTop:Math.min(ye.value-Dt,rn)})},Oe=(Nt,Pt)=>{const Dt=b(Ie),rn=(Me.value-Dt)/Pt*Nt;kt({scrollLeft:Math.min(Me.value-Dt,rn)})},{onWheel:Ct}=Mce({atXStartEdge:ee(()=>ce.value.scrollLeft<=0),atXEndEdge:ee(()=>ce.value.scrollLeft>=Me.value-b(Ie)),atYStartEdge:ee(()=>ce.value.scrollTop<=0),atYEndEdge:ee(()=>ce.value.scrollTop>=ye.value-b(de))},(Nt,Pt)=>{var Dt,rn,on,Ln;(rn=(Dt=se.value)==null?void 0:Dt.onMouseUp)==null||rn.call(Dt),(Ln=(on=he.value)==null?void 0:on.onMouseUp)==null||Ln.call(on);const yn=b(Ie),Et=b(de);kt({scrollLeft:Math.min(ce.value.scrollLeft+Nt,Me.value-yn),scrollTop:Math.min(ce.value.scrollTop+Pt,ye.value-Et)})});Si(re,"wheel",Ct,{passive:!1});const kt=({scrollLeft:Nt=ce.value.scrollLeft,scrollTop:Pt=ce.value.scrollTop})=>{Nt=Math.max(Nt,0),Pt=Math.max(Pt,0);const Dt=b(ce);Pt===Dt.scrollTop&&Nt===Dt.scrollLeft||(ce.value={...Dt,xAxisScrollDir:ch(Dt.scrollLeft,Nt),yAxisScrollDir:ch(Dt.scrollTop,Pt),scrollLeft:Nt,scrollTop:Pt,updateRequested:!0},jn(()=>jt()),Gt(),De())},Bt=(Nt=0,Pt=0,Dt=sl)=>{const rn=b(ce);Pt=Math.max(0,Math.min(Pt,N.totalColumn-1)),Nt=Math.max(0,Math.min(Nt,N.totalRow-1));const on=Cz(Z.namespace.value),Ln=b(J),yn=p(N,Ln),Et=y(N,Ln);kt({scrollLeft:r(N,Pt,Dt,rn.scrollLeft,Ln,Et>N.width?on:0),scrollTop:S(N,Nt,Dt,rn.scrollTop,Ln,yn>N.height?on:0)})},_t=(Nt,Pt)=>{const{columnWidth:Dt,direction:rn,rowHeight:on}=N,Ln=pe.value(t&&Dt,t&&on,t&&rn),yn=`${Nt},${Pt}`;if(ri(Ln,yn))return Ln[yn];{const[,Et]=o(N,Pt,b(J)),En=b(J),Xn=BR(rn),[vr,er]=C(N,Nt,En),[Dr]=o(N,Pt,En);return Ln[yn]={position:"absolute",left:Xn?void 0:`${Et}px`,right:Xn?`${Et}px`:void 0,top:`${er}px`,height:`${vr}px`,width:`${Dr}px`},Ln[yn]}},jt=()=>{ce.value.isScrolling=!1,jn(()=>{pe.value(-1,null,null)})};yr(()=>{if(!Wr)return;const{initScrollLeft:Nt,initScrollTop:Pt}=N,Dt=b(re);Dt&&(Wn(Nt)&&(Dt.scrollLeft=Nt),Wn(Pt)&&(Dt.scrollTop=Pt)),De()});const Gt=()=>{const{direction:Nt}=N,{scrollLeft:Pt,scrollTop:Dt,updateRequested:rn}=b(ce),on=b(re);if(rn&&on){if(Nt===Im)switch(L1()){case jy:{on.scrollLeft=-Pt;break}case jE:{on.scrollLeft=Pt;break}default:{const{clientWidth:Ln,scrollWidth:yn}=on;on.scrollLeft=yn-Ln-Pt;break}}else on.scrollLeft=Math.max(0,Pt);on.scrollTop=Math.max(0,Dt)}},{resetAfterColumnIndex:Ne,resetAfterRowIndex:an,resetAfter:Ae}=q.proxy;U({windowRef:re,innerRef:le,getItemStyleCache:pe,scrollTo:kt,scrollToItem:Bt,states:ce,resetAfterColumnIndex:Ne,resetAfterRowIndex:an,resetAfter:Ae});const tt=()=>{const{scrollbarAlwaysOn:Nt,scrollbarStartGap:Pt,scrollbarEndGap:Dt,totalColumn:rn,totalRow:on}=N,Ln=b(Ie),yn=b(de),Et=b(Me),En=b(ye),{scrollLeft:Xn,scrollTop:vr}=b(ce),er=Zn(IT,{ref:se,alwaysOn:Nt,startGap:Pt,endGap:Dt,class:Z.e("horizontal"),clientSize:Ln,layout:"horizontal",onScroll:Oe,ratio:Ln*100/Et,scrollFrom:Xn/(Et-Ln),total:on,visible:!0}),Dr=Zn(IT,{ref:he,alwaysOn:Nt,startGap:Pt,endGap:Dt,class:Z.e("vertical"),clientSize:yn,layout:"vertical",onScroll:rt,ratio:yn*100/En,scrollFrom:vr/(En-yn),total:rn,visible:!0});return{horizontalScrollbar:er,verticalScrollbar:Dr}},Je=()=>{var Nt;const[Pt,Dt]=b(Ve),[rn,on]=b(be),{data:Ln,totalColumn:yn,totalRow:Et,useIsScrolling:En,itemKey:Xn}=N,vr=[];if(Et>0&&yn>0)for(let er=rn;er<=on;er++)for(let Dr=Pt;Dr<=Dt;Dr++){const Ar=Xn({columnIndex:Dr,data:Ln,rowIndex:er});vr.push(Zn(Vn,{key:Ar},(Nt=te.default)==null?void 0:Nt.call(te,{columnIndex:Dr,data:Ln,isScrolling:En?b(ce).isScrolling:void 0,style:_t(er,Dr),rowIndex:er})))}return vr},Jt=()=>{const Nt=Ir(N.innerElement),Pt=Je();return[Zn(Nt,{style:b(me),ref:le},Nn(Nt)?Pt:{default:()=>Pt})]};return()=>{const Nt=Ir(N.containerElement),{horizontalScrollbar:Pt,verticalScrollbar:Dt}=tt(),rn=Jt();return Zn("div",{key:0,class:Z.e("wrapper"),role:N.role},[Zn(Nt,{class:N.className,style:b(we),onScroll:Ge,ref:re},Nn(Nt)?rn:{default:()=>rn}),Pt,Dt])}}}),{max:F1,min:TN,floor:CN}=Math,Ice={column:"columnWidth",row:"rowHeight"},VT={column:"lastVisitedColumnIndex",row:"lastVisitedRowIndex"},xc=(e,t,o,a)=>{const[d,p,y]=[o[a],e[Ice[a]],o[VT[a]]];if(t>y){let r=0;if(y>=0){const S=d[y];r=S.offset+S.size}for(let S=y+1;S<=t;S++){const C=p(S);d[S]={offset:r,size:C},r+=C}o[VT[a]]=t}return d[t]},EN=(e,t,o,a,d,p)=>{for(;o<=a;){const y=o+CN((a-o)/2),r=xc(e,y,t,p).offset;if(r===d)return y;r<d?o=y+1:a=y-1}return F1(0,o-1)},Ace=(e,t,o,a,d)=>{const p=d==="column"?e.totalColumn:e.totalRow;let y=1;for(;o<p&&xc(e,o,t,d).offset<a;)o+=y,y*=2;return EN(e,t,CN(o/2),TN(o,p-1),a,d)},rO=(e,t,o,a)=>{const[d,p]=[t[a],t[VT[a]]];return(p>0?d[p].offset:0)>=o?EN(e,t,0,p,o,a):Ace(e,t,F1(0,p),o,a)},MN=({totalRow:e},{estimatedRowHeight:t,lastVisitedRowIndex:o,row:a})=>{let d=0;if(o>=e&&(o=e-1),o>=0){const r=a[o];d=r.offset+r.size}const y=(e-o-1)*t;return d+y},IN=({totalColumn:e},{column:t,estimatedColumnWidth:o,lastVisitedColumnIndex:a})=>{let d=0;if(a>e&&(a=e-1),a>=0){const r=t[a];d=r.offset+r.size}const y=(e-a-1)*o;return d+y},kce={column:IN,row:MN},iO=(e,t,o,a,d,p,y)=>{const[r,S]=[p==="row"?e.height:e.width,kce[p]],C=xc(e,t,d,p),M=S(e,d),P=F1(0,TN(M-r,C.offset)),z=F1(0,C.offset-r+y+C.size);switch(o===Mx&&(a>=z-r&&a<=P+r?o=sl:o=Ru),o){case $y:return P;case Uy:return z;case Ru:return Math.round(z+(P-z)/2);case sl:default:return a>=z&&a<=P?a:z>P||a<z?z:P}},Pce=SN({name:"ElDynamicSizeGrid",getColumnPosition:(e,t,o)=>{const a=xc(e,t,o,"column");return[a.size,a.offset]},getRowPosition:(e,t,o)=>{const a=xc(e,t,o,"row");return[a.size,a.offset]},getColumnOffset:(e,t,o,a,d,p)=>iO(e,t,o,a,d,"column",p),getRowOffset:(e,t,o,a,d,p)=>iO(e,t,o,a,d,"row",p),getColumnStartIndexForOffset:(e,t,o)=>rO(e,o,t,"column"),getColumnStopIndexForStartIndex:(e,t,o,a)=>{const d=xc(e,t,a,"column"),p=o+e.width;let y=d.offset+d.size,r=t;for(;r<e.totalColumn-1&&y<p;)r++,y+=xc(e,t,a,"column").size;return r},getEstimatedTotalHeight:MN,getEstimatedTotalWidth:IN,getRowStartIndexForOffset:(e,t,o)=>rO(e,o,t,"row"),getRowStopIndexForStartIndex:(e,t,o,a)=>{const{totalRow:d,height:p}=e,y=xc(e,t,a,"row"),r=o+p;let S=y.size+y.offset,C=t;for(;C<d-1&&S<r;)C++,S+=xc(e,C,a,"row").size;return C},injectToInstance:(e,t)=>{const o=({columnIndex:p,rowIndex:y},r)=>{var S,C;r=ai(r)?!0:r,Wn(p)&&(t.value.lastVisitedColumnIndex=Math.min(t.value.lastVisitedColumnIndex,p-1)),Wn(y)&&(t.value.lastVisitedRowIndex=Math.min(t.value.lastVisitedRowIndex,y-1)),(S=e.exposed)==null||S.getItemStyleCache.value(-1,null,null),r&&((C=e.proxy)==null||C.$forceUpdate())},a=(p,y)=>{o({columnIndex:p},y)},d=(p,y)=>{o({rowIndex:p},y)};Object.assign(e.proxy,{resetAfterColumnIndex:a,resetAfterRowIndex:d,resetAfter:o})},initCache:({estimatedColumnWidth:e=wT,estimatedRowHeight:t=wT})=>({column:{},estimatedColumnWidth:e,estimatedRowHeight:t,lastVisitedColumnIndex:-1,lastVisitedRowIndex:-1,row:{}}),clearCache:!1,validateProps:({columnWidth:e,rowHeight:t})=>{}}),Rce=SN({name:"ElFixedSizeGrid",getColumnPosition:({columnWidth:e},t)=>[e,t*e],getRowPosition:({rowHeight:e},t)=>[e,t*e],getEstimatedTotalHeight:({totalRow:e,rowHeight:t})=>t*e,getEstimatedTotalWidth:({totalColumn:e,columnWidth:t})=>t*e,getColumnOffset:({totalColumn:e,columnWidth:t,width:o},a,d,p,y,r)=>{o=Number(o);const S=Math.max(0,e*t-o),C=Math.min(S,a*t),M=Math.max(0,a*t-o+r+t);switch(d==="smart"&&(p>=M-o&&p<=C+o?d=sl:d=Ru),d){case $y:return C;case Uy:return M;case Ru:{const P=Math.round(M+(C-M)/2);return P<Math.ceil(o/2)?0:P>S+Math.floor(o/2)?S:P}case sl:default:return p>=M&&p<=C?p:M>C||p<M?M:C}},getRowOffset:({rowHeight:e,height:t,totalRow:o},a,d,p,y,r)=>{t=Number(t);const S=Math.max(0,o*e-t),C=Math.min(S,a*e),M=Math.max(0,a*e-t+r+e);switch(d===Mx&&(p>=M-t&&p<=C+t?d=sl:d=Ru),d){case $y:return C;case Uy:return M;case Ru:{const P=Math.round(M+(C-M)/2);return P<Math.ceil(t/2)?0:P>S+Math.floor(t/2)?S:P}case sl:default:return p>=M&&p<=C?p:M>C||p<M?M:C}},getColumnStartIndexForOffset:({columnWidth:e,totalColumn:t},o)=>Math.max(0,Math.min(t-1,Math.floor(o/e))),getColumnStopIndexForStartIndex:({columnWidth:e,totalColumn:t,width:o},a,d)=>{const p=a*e,y=Math.ceil((o+d-p)/e);return Math.max(0,Math.min(t-1,a+y-1))},getRowStartIndexForOffset:({rowHeight:e,totalRow:t},o)=>Math.max(0,Math.min(t-1,Math.floor(o/e))),getRowStopIndexForStartIndex:({rowHeight:e,totalRow:t,height:o},a,d)=>{const p=a*e,y=Math.ceil((o+d-p)/e);return Math.max(0,Math.min(t-1,a+y-1))},initCache:()=>{},clearCache:!0,validateProps:({columnWidth:e,rowHeight:t})=>{}}),Oce="ElTableV2Grid",Lce=e=>{const t=xe(),o=xe(),a=xe(0),d=ee(()=>{const{data:H,rowHeight:U,estimatedRowHeight:te}=e;if(!te)return H.length*U}),p=ee(()=>{const{fixedData:H,rowHeight:U}=e;return((H==null?void 0:H.length)||0)*U}),y=ee(()=>r1(e.headerHeight)),r=ee(()=>{const{height:H}=e;return Math.max(0,H-b(y)-b(p))}),S=ee(()=>b(y)+b(p)>0),C=({data:H,rowIndex:U})=>H[U][e.rowKey];function M({rowCacheStart:H,rowCacheEnd:U,rowVisibleStart:te,rowVisibleEnd:Z}){var q;(q=e.onRowsRendered)==null||q.call(e,{rowCacheStart:H,rowCacheEnd:U,rowVisibleStart:te,rowVisibleEnd:Z})}function P(H,U){var te;(te=o.value)==null||te.resetAfterRowIndex(H,U)}function z(H,U){const te=b(t),Z=b(o);xr(H)?(te==null||te.scrollToLeft(H.scrollLeft),a.value=H.scrollLeft,Z==null||Z.scrollTo(H)):(te==null||te.scrollToLeft(H),a.value=H,Z==null||Z.scrollTo({scrollLeft:H,scrollTop:U}))}function F(H){var U;(U=b(o))==null||U.scrollTo({scrollTop:H})}function V(H,U){var te;(te=b(o))==null||te.scrollToItem(H,1,U)}function N(){var H,U;(H=b(o))==null||H.$forceUpdate(),(U=b(t))==null||U.$forceUpdate()}return{bodyRef:o,forceUpdate:N,fixedRowHeight:p,gridHeight:r,hasHeader:S,headerHeight:y,headerRef:t,totalHeight:d,itemKey:C,onItemRendered:M,resetAfterRowIndex:P,scrollTo:z,scrollToTop:F,scrollToRow:V,scrollLeft:a}},Dce=We({name:Oce,props:i1,setup(e,{slots:t,expose:o}){const{ns:a}=Pn(KE),{bodyRef:d,fixedRowHeight:p,gridHeight:y,hasHeader:r,headerRef:S,headerHeight:C,totalHeight:M,forceUpdate:P,itemKey:z,onItemRendered:F,resetAfterRowIndex:V,scrollTo:N,scrollToTop:H,scrollToRow:U,scrollLeft:te}=Lce(e);Vr("tableV2GridScrollLeft",te),o({forceUpdate:P,totalHeight:M,scrollTo:N,scrollToTop:H,scrollToRow:U,resetAfterRowIndex:V});const Z=()=>e.bodyWidth;return()=>{const{cache:q,columns:J,data:re,fixedData:se,useIsScrolling:he,scrollbarAlwaysOn:le,scrollbarEndGap:ce,scrollbarStartGap:pe,style:de,rowHeight:Ie,bodyWidth:Ve,estimatedRowHeight:be,headerWidth:ye,height:Me,width:we,getRowHeight:me,onScroll:De}=e,Ge=Wn(be),rt=Ge?Pce:Rce,Oe=b(C);return qe("div",{role:"table",class:[a.e("table"),e.class],style:de},[qe(rt,{ref:d,data:re,useIsScrolling:he,itemKey:z,columnCache:0,columnWidth:Ge?Z:Ve,totalColumn:1,totalRow:re.length,rowCache:q,rowHeight:Ge?me:Ie,width:we,height:b(y),class:a.e("body"),role:"rowgroup",scrollbarStartGap:pe,scrollbarEndGap:ce,scrollbarAlwaysOn:le,onScroll:De,onItemRendered:F,perfMode:!1},{default:Ct=>{var kt;const Bt=re[Ct.rowIndex];return(kt=t.row)==null?void 0:kt.call(t,{...Ct,columns:J,rowData:Bt})}}),b(r)&&qe(Ece,{ref:S,class:a.e("header-wrapper"),columns:J,headerData:re,headerHeight:e.headerHeight,fixedHeaderData:se,rowWidth:ye,rowHeight:Ie,width:we,height:Math.min(Oe+b(p),Me)},{dynamic:t.header,fixed:t.row})])}}});var XE=Dce;function zce(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!Ji(e)}const Fce=(e,{slots:t})=>{const{mainTableRef:o,...a}=e;return qe(XE,kr({ref:o},a),zce(t)?t:{default:()=>[t]})};var Nce=Fce;function Bce(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!Ji(e)}const Vce=(e,{slots:t})=>{if(!e.columns.length)return;const{leftTableRef:o,...a}=e;return qe(XE,kr({ref:o},a),Bce(t)?t:{default:()=>[t]})};var $ce=Vce;function Uce(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!Ji(e)}const jce=(e,{slots:t})=>{if(!e.columns.length)return;const{rightTableRef:o,...a}=e;return qe(XE,kr({ref:o},a),Uce(t)?t:{default:()=>[t]})};var Hce=jce;const Gce=e=>{const{isScrolling:t}=Pn(KE),o=xe(!1),a=xe(),d=ee(()=>Wn(e.estimatedRowHeight)&&e.rowIndex>=0),p=(S=!1)=>{const C=b(a);if(!C)return;const{columns:M,onRowHeightChange:P,rowKey:z,rowIndex:F,style:V}=e,{height:N}=C.getBoundingClientRect();o.value=!0,jn(()=>{if(S||N!==Number.parseInt(V.height)){const H=M[0],U=(H==null?void 0:H.placeholderSign)===qy;P==null||P({rowKey:z,height:N,rowIndex:F},H&&!U&&H.fixed)}})},y=ee(()=>{const{rowData:S,rowIndex:C,rowKey:M,onRowHover:P}=e,z=e.rowEventHandlers||{},F={};return Object.entries(z).forEach(([V,N])=>{$n(N)&&(F[V]=H=>{N({event:H,rowData:S,rowIndex:C,rowKey:M})})}),P&&[{name:"onMouseleave",hovered:!1},{name:"onMouseenter",hovered:!0}].forEach(({name:V,hovered:N})=>{const H=F[V];F[V]=U=>{P({event:U,hovered:N,rowData:S,rowIndex:C,rowKey:M}),H==null||H(U)}}),F}),r=S=>{const{onRowExpand:C,rowData:M,rowIndex:P,rowKey:z}=e;C==null||C({expanded:S,rowData:M,rowIndex:P,rowKey:z})};return yr(()=>{b(d)&&p(!0)}),{isScrolling:t,measurable:d,measured:o,rowRef:a,eventHandlers:y,onExpand:r}},Wce="ElTableV2TableRow",qce=We({name:Wce,props:dh,setup(e,{expose:t,slots:o,attrs:a}){const{eventHandlers:d,isScrolling:p,measurable:y,measured:r,rowRef:S,onExpand:C}=Gce(e);return t({onExpand:C}),()=>{const{columns:M,columnsStyles:P,expandColumnKey:z,depth:F,rowData:V,rowIndex:N,style:H}=e;let U=M.map((te,Z)=>{const q=sn(V.children)&&V.children.length>0&&te.key===z;return o.cell({column:te,columns:M,columnIndex:Z,depth:F,style:P[te.key],rowData:V,rowIndex:N,isScrolling:b(p),expandIconProps:q?{rowData:V,rowIndex:N,onExpand:C}:void 0})});if(o.row&&(U=o.row({cells:U.map(te=>sn(te)&&te.length===1?te[0]:te),style:H,columns:M,depth:F,rowData:V,rowIndex:N,isScrolling:b(p)})),b(y)){const{height:te,...Z}=H||{},q=b(r);return qe("div",kr({ref:S,class:e.class,style:q?H:Z,role:"row"},a,b(d)),[U])}return qe("div",kr(a,{ref:S,class:e.class,style:H,role:"row"},b(d)),[U])}}});var Kce=qce;function Zce(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!Ji(e)}const Yce=(e,{slots:t})=>{const{columns:o,columnsStyles:a,depthMap:d,expandColumnKey:p,expandedRowKeys:y,estimatedRowHeight:r,hasFixedColumns:S,rowData:C,rowIndex:M,style:P,isScrolling:z,rowProps:F,rowClass:V,rowKey:N,rowEventHandlers:H,ns:U,onRowHovered:te,onRowExpanded:Z}=e,q=Eh(V,{columns:o,rowData:C,rowIndex:M},""),J=Eh(F,{columns:o,rowData:C,rowIndex:M}),re=C[N],se=d[re]||0,he=!!p,le=M<0,ce=[U.e("row"),q,{[U.e(`row-depth-${se}`)]:he&&M>=0,[U.is("expanded")]:he&&y.includes(re),[U.is("fixed")]:!se&&le,[U.is("customized")]:!!t.row}],pe=S?te:void 0,de={...J,columns:o,columnsStyles:a,class:ce,depth:se,expandColumnKey:p,estimatedRowHeight:le?void 0:r,isScrolling:z,rowIndex:M,rowData:C,rowKey:re,rowEventHandlers:H,style:P};return qe(Kce,kr(de,{onRowExpand:Z,onMouseenter:be=>{pe==null||pe({hovered:!0,rowKey:re,event:be,rowData:C,rowIndex:M})},onMouseleave:be=>{pe==null||pe({hovered:!1,rowKey:re,event:be,rowData:C,rowIndex:M})},rowkey:re}),Zce(t)?t:{default:()=>[t]})};var Xce=Yce;const JE=(e,{slots:t})=>{var o;const{cellData:a,style:d}=e,p=((o=a==null?void 0:a.toString)==null?void 0:o.call(a))||"",y=gt(t,"default",e,()=>[p]);return qe("div",{class:e.class,title:p,style:d},[y])};JE.displayName="ElTableV2Cell";JE.inheritAttrs=!1;var Jce=JE;const Qce=e=>{const{expanded:t,expandable:o,onExpand:a,style:d,size:p}=e,y={onClick:o?()=>a(!t):void 0,class:e.class};return qe(zn,kr(y,{size:p,style:d}),{default:()=>[qe(ta,null,null)]})};var ede=Qce;const AN=({columns:e,column:t,columnIndex:o,depth:a,expandIconProps:d,isScrolling:p,rowData:y,rowIndex:r,style:S,expandedRowKeys:C,ns:M,cellProps:P,expandColumnKey:z,indentSize:F,iconSize:V,rowKey:N},{slots:H})=>{const U=Bd(S);if(t.placeholderSign===qy)return qe("div",{class:M.em("row-cell","placeholder"),style:U},null);const{cellRenderer:te,dataKey:Z,dataGetter:q}=t,J=$n(q)?q({columns:e,column:t,columnIndex:o,rowData:y,rowIndex:r}):Eo(y,Z??""),re=Eh(P,{cellData:J,columns:e,column:t,columnIndex:o,rowIndex:r,rowData:y}),se={class:M.e("cell-text"),columns:e,column:t,columnIndex:o,cellData:J,isScrolling:p,rowData:y,rowIndex:r},he=vN(te),le=he?he(se):gt(H,"default",se,()=>[qe(Jce,se,null)]),ce=[M.e("row-cell"),t.class,t.align===Wy.CENTER&&M.is("align-center"),t.align===Wy.RIGHT&&M.is("align-right")],pe=r>=0&&z&&t.key===z,de=r>=0&&C.includes(y[N]);let Ie;const Ve=`margin-inline-start: ${a*F}px;`;return pe&&(xr(d)?Ie=qe(ede,kr(d,{class:[M.e("expand-icon"),M.is("expanded",de)],size:V,expanded:de,style:Ve,expandable:!0}),null):Ie=qe("div",{style:[Ve,`width: ${V}px; height: ${V}px;`].join(" ")},null)),qe("div",kr({class:ce,style:U},re,{role:"cell"}),[Ie,le])};AN.inheritAttrs=!1;var oO=AN;const tde=un({class:String,columns:pv,columnsStyles:{type:lt(Object),required:!0},headerIndex:Number,style:{type:lt(Object)}}),nde=We({name:"ElTableV2HeaderRow",props:tde,setup(e,{slots:t}){return()=>{const{columns:o,columnsStyles:a,headerIndex:d,style:p}=e;let y=o.map((r,S)=>t.cell({columns:o,column:r,columnIndex:S,headerIndex:d,style:a[r.key]}));return t.header&&(y=t.header({cells:y.map(r=>sn(r)&&r.length===1?r[0]:r),columns:o,headerIndex:d})),qe("div",{class:e.class,style:p,role:"row"},[y])}}});var rde=nde;function ide(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!Ji(e)}const ode=({columns:e,columnsStyles:t,headerIndex:o,style:a,headerClass:d,headerProps:p,ns:y},{slots:r})=>{const S={columns:e,headerIndex:o},C=[y.e("header-row"),Eh(d,S,""),{[y.is("customized")]:!!r.header}],M={...Eh(p,S),columnsStyles:t,class:C,columns:e,headerIndex:o,style:a};return qe(rde,M,ide(r)?r:{default:()=>[r]})};var sde=ode;const QE=(e,{slots:t})=>gt(t,"default",e,()=>{var o,a;return[qe("div",{class:e.class,title:(o=e.column)==null?void 0:o.title},[(a=e.column)==null?void 0:a.title])]});QE.displayName="ElTableV2HeaderCell";QE.inheritAttrs=!1;var ade=QE;const lde=e=>{const{sortOrder:t}=e;return qe(zn,{size:14,class:e.class},{default:()=>[t===Gy.ASC?qe(j7,null,null):qe($7,null,null)]})};var ude=lde;const cde=(e,{slots:t})=>{const{column:o,ns:a,style:d,onColumnSorted:p}=e,y=Bd(d);if(o.placeholderSign===qy)return qe("div",{class:a.em("header-row-cell","placeholder"),style:y},null);const{headerCellRenderer:r,headerClass:S,sortable:C}=o,M={...e,class:a.e("header-cell-text")},P=vN(r),z=P?P(M):gt(t,"default",M,()=>[qe(ade,M,null)]),{sortBy:F,sortState:V,headerCellProps:N}=e;let H,U;if(V){const q=V[o.key];H=!!BT[q],U=H?q:Gy.ASC}else H=o.key===F.key,U=H?F.order:Gy.ASC;const te=[a.e("header-cell"),Eh(S,e,""),o.align===Wy.CENTER&&a.is("align-center"),o.align===Wy.RIGHT&&a.is("align-right"),C&&a.is("sortable")],Z={...Eh(N,e),onClick:o.sortable?p:void 0,class:te,style:y,"data-key":o.key};return qe("div",kr(Z,{role:"columnheader"}),[z,C&&qe(ude,{class:[a.e("sort-icon"),H&&a.is("sorting")],sortOrder:U},null)])};var sO=cde;const kN=(e,{slots:t})=>{var o;return qe("div",{class:e.class,style:e.style},[(o=t.default)==null?void 0:o.call(t)])};kN.displayName="ElTableV2Footer";var dde=kN;const PN=(e,{slots:t})=>{const o=gt(t,"default",{},()=>[qe(TF,null,null)]);return qe("div",{class:e.class,style:e.style},[o])};PN.displayName="ElTableV2Empty";var fde=PN;const RN=(e,{slots:t})=>{var o;return qe("div",{class:e.class,style:e.style},[(o=t.default)==null?void 0:o.call(t)])};RN.displayName="ElTableV2Overlay";var hde=RN;function Q_(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!Ji(e)}const pde="ElTableV2",mde=We({name:pde,props:Sce,setup(e,{slots:t,expose:o}){const a=Xt("table-v2"),{columnsStyles:d,fixedColumnsOnLeft:p,fixedColumnsOnRight:y,mainColumns:r,mainTableHeight:S,fixedTableHeight:C,leftTableWidth:M,rightTableWidth:P,data:z,depthMap:F,expandedRowKeys:V,hasFixedColumns:N,mainTableRef:H,leftTableRef:U,rightTableRef:te,isDynamic:Z,isResetting:q,isScrolling:J,bodyWidth:re,emptyStyle:se,rootStyle:he,headerWidth:le,footerHeight:ce,showEmpty:pe,scrollTo:de,scrollToLeft:Ie,scrollToTop:Ve,scrollToRow:be,getRowHeight:ye,onColumnSorted:Me,onRowHeightChange:we,onRowHovered:me,onRowExpanded:De,onRowsRendered:Ge,onScroll:rt,onVerticalScroll:Oe}=xce(e);return o({scrollTo:de,scrollToLeft:Ie,scrollToTop:Ve,scrollToRow:be}),Vr(KE,{ns:a,isResetting:q,isScrolling:J}),()=>{const{cache:Ct,cellProps:kt,estimatedRowHeight:Bt,expandColumnKey:_t,fixedData:jt,headerHeight:Gt,headerClass:Ne,headerProps:an,headerCellProps:Ae,sortBy:tt,sortState:Je,rowHeight:Jt,rowClass:Kt,rowEventHandlers:Nt,rowKey:Pt,rowProps:Dt,scrollbarAlwaysOn:rn,indentSize:on,iconSize:Ln,useIsScrolling:yn,vScrollbarSize:Et,width:En}=e,Xn=b(z),vr={cache:Ct,class:a.e("main"),columns:b(r),data:Xn,fixedData:jt,estimatedRowHeight:Bt,bodyWidth:b(re)+Et,headerHeight:Gt,headerWidth:b(le),height:b(S),mainTableRef:H,rowKey:Pt,rowHeight:Jt,scrollbarAlwaysOn:rn,scrollbarStartGap:2,scrollbarEndGap:Et,useIsScrolling:yn,width:En,getRowHeight:ye,onRowsRendered:Ge,onScroll:rt},er=b(M),Dr=b(C),Ar={cache:Ct,class:a.e("left"),columns:b(p),data:Xn,estimatedRowHeight:Bt,leftTableRef:U,rowHeight:Jt,bodyWidth:er,headerWidth:er,headerHeight:Gt,height:Dr,rowKey:Pt,scrollbarAlwaysOn:rn,scrollbarStartGap:2,scrollbarEndGap:Et,useIsScrolling:yn,width:er,getRowHeight:ye,onScroll:Oe},ui=b(P)+Et,zt={cache:Ct,class:a.e("right"),columns:b(y),data:Xn,estimatedRowHeight:Bt,rightTableRef:te,rowHeight:Jt,bodyWidth:ui,headerWidth:ui,headerHeight:Gt,height:Dr,rowKey:Pt,scrollbarAlwaysOn:rn,scrollbarStartGap:2,scrollbarEndGap:Et,width:ui,style:`--${b(a.namespace)}-table-scrollbar-size: ${Et}px`,useIsScrolling:yn,getRowHeight:ye,onScroll:Oe},st=b(d),Ft={ns:a,depthMap:b(F),columnsStyles:st,expandColumnKey:_t,expandedRowKeys:b(V),estimatedRowHeight:Bt,hasFixedColumns:b(N),rowProps:Dt,rowClass:Kt,rowKey:Pt,rowEventHandlers:Nt,onRowHovered:me,onRowExpanded:De,onRowHeightChange:we},Ye={cellProps:kt,expandColumnKey:_t,indentSize:on,iconSize:Ln,rowKey:Pt,expandedRowKeys:b(V),ns:a},pn={ns:a,headerClass:Ne,headerProps:an,columnsStyles:st},xn={ns:a,sortBy:tt,sortState:Je,headerCellProps:Ae,onColumnSorted:Me},_r={row:Qi=>qe(Xce,kr(Qi,Ft),{row:t.row,cell:ci=>{let co;return t.cell?qe(oO,kr(ci,Ye,{style:st[ci.column.key]}),Q_(co=t.cell(ci))?co:{default:()=>[co]}):qe(oO,kr(ci,Ye,{style:st[ci.column.key]}),null)}}),header:Qi=>qe(sde,kr(Qi,pn),{header:t.header,cell:ci=>{let co;return t["header-cell"]?qe(sO,kr(ci,xn,{style:st[ci.column.key]}),Q_(co=t["header-cell"](ci))?co:{default:()=>[co]}):qe(sO,kr(ci,xn,{style:st[ci.column.key]}),null)}})},yi=[e.class,a.b(),a.e("root"),{[a.is("dynamic")]:b(Z)}],xi={class:a.e("footer"),style:b(ce)};return qe("div",{class:yi,style:b(he)},[qe(Nce,vr,Q_(_r)?_r:{default:()=>[_r]}),qe($ce,Ar,Q_(_r)?_r:{default:()=>[_r]}),qe(Hce,zt,Q_(_r)?_r:{default:()=>[_r]}),t.footer&&qe(dde,xi,{default:t.footer}),b(pe)&&qe(fde,{class:a.e("empty"),style:b(se)},{default:t.empty}),t.overlay&&qe(hde,{class:a.e("overlay")},{default:t.overlay})])}}});var gde=mde;const _de=un({disableWidth:Boolean,disableHeight:Boolean,onResize:{type:lt(Function)}}),yde=e=>{const t=xe(),o=xe(0),a=xe(0);let d;return yr(()=>{d=ro(t,([p])=>{const{width:y,height:r}=p.contentRect,{paddingLeft:S,paddingRight:C,paddingTop:M,paddingBottom:P}=getComputedStyle(p.target),z=Number.parseInt(S)||0,F=Number.parseInt(C)||0,V=Number.parseInt(M)||0,N=Number.parseInt(P)||0;o.value=y-z-F,a.value=r-V-N}).stop}),Li(()=>{d==null||d()}),Wt([o,a],([p,y])=>{var r;(r=e.onResize)==null||r.call(e,{width:p,height:y})}),{sizer:t,width:o,height:a}},vde=We({name:"ElAutoResizer",props:_de,setup(e,{slots:t}){const o=Xt("auto-resizer"),{height:a,width:d,sizer:p}=yde(e),y={width:"100%",height:"100%"};return()=>{var r;return qe("div",{ref:p,class:o.b(),style:y},[(r=t.default)==null?void 0:r.call(t,{height:a.value,width:d.value})])}}});var bde=vde;const xde=lr(gde),wde=lr(bde),Ix=Symbol("tabsRootContextKey"),Sde=un({tabs:{type:lt(Array),default:()=>io([])}}),ON="ElTabBar",Tde=We({name:ON}),Cde=We({...Tde,props:Sde,setup(e,{expose:t}){const o=e,a=Cr(),d=Pn(Ix);d||No(ON,"<el-tabs><el-tab-bar /></el-tabs>");const p=Xt("tabs"),y=xe(),r=xe(),S=()=>{let F=0,V=0;const N=["top","bottom"].includes(d.props.tabPosition)?"width":"height",H=N==="width"?"x":"y",U=H==="x"?"left":"top";return o.tabs.every(te=>{var Z,q;const J=(q=(Z=a.parent)==null?void 0:Z.refs)==null?void 0:q[`tab-${te.uid}`];if(!J)return!1;if(!te.active)return!0;F=J[`offset${Pu(U)}`],V=J[`client${Pu(N)}`];const re=window.getComputedStyle(J);return N==="width"&&(V-=Number.parseFloat(re.paddingLeft)+Number.parseFloat(re.paddingRight),F+=Number.parseFloat(re.paddingLeft)),!1}),{[N]:`${V}px`,transform:`translate${Pu(H)}(${F}px)`}},C=()=>r.value=S(),M=[],P=()=>{var F;M.forEach(N=>N.stop()),M.length=0;const V=(F=a.parent)==null?void 0:F.refs;if(V){for(const N in V)if(N.startsWith("tab-")){const H=V[N];H&&M.push(ro(H,C))}}};Wt(()=>o.tabs,async()=>{await jn(),C(),P()},{immediate:!0});const z=ro(y,()=>C());return Li(()=>{M.forEach(F=>F.stop()),M.length=0,z.stop()}),t({ref:y,update:C}),(F,V)=>(ae(),Pe("div",{ref_key:"barRef",ref:y,class:fe([b(p).e("active-bar"),b(p).is(b(d).props.tabPosition)]),style:Un(r.value)},null,6))}});var Ede=dn(Cde,[["__file","tab-bar.vue"]]);const Mde=un({panes:{type:lt(Array),default:()=>io([])},currentName:{type:[String,Number],default:""},editable:Boolean,type:{type:String,values:["card","border-card",""],default:""},stretch:Boolean}),Ide={tabClick:(e,t,o)=>o instanceof Event,tabRemove:(e,t)=>t instanceof Event},aO="ElTabNav",Ade=We({name:aO,props:Mde,emits:Ide,setup(e,{expose:t,emit:o}){const a=Pn(Ix);a||No(aO,"<el-tabs><tab-nav /></el-tabs>");const d=Xt("tabs"),p=a9(),y=v9(),r=xe(),S=xe(),C=xe(),M=xe(),P=xe(!1),z=xe(0),F=xe(!1),V=xe(!0),N=ee(()=>["top","bottom"].includes(a.props.tabPosition)?"width":"height"),H=ee(()=>({transform:`translate${N.value==="width"?"X":"Y"}(-${z.value}px)`})),U=()=>{if(!r.value)return;const he=r.value[`offset${Pu(N.value)}`],le=z.value;if(!le)return;const ce=le>he?le-he:0;z.value=ce},te=()=>{if(!r.value||!S.value)return;const he=S.value[`offset${Pu(N.value)}`],le=r.value[`offset${Pu(N.value)}`],ce=z.value;if(he-ce<=le)return;const pe=he-ce>le*2?ce+le:he-le;z.value=pe},Z=async()=>{const he=S.value;if(!P.value||!C.value||!r.value||!he)return;await jn();const le=C.value.querySelector(".is-active");if(!le)return;const ce=r.value,pe=["top","bottom"].includes(a.props.tabPosition),de=le.getBoundingClientRect(),Ie=ce.getBoundingClientRect(),Ve=pe?he.offsetWidth-Ie.width:he.offsetHeight-Ie.height,be=z.value;let ye=be;pe?(de.left<Ie.left&&(ye=be-(Ie.left-de.left)),de.right>Ie.right&&(ye=be+de.right-Ie.right)):(de.top<Ie.top&&(ye=be-(Ie.top-de.top)),de.bottom>Ie.bottom&&(ye=be+(de.bottom-Ie.bottom))),ye=Math.max(ye,0),z.value=Math.min(ye,Ve)},q=()=>{var he;if(!S.value||!r.value)return;e.stretch&&((he=M.value)==null||he.update());const le=S.value[`offset${Pu(N.value)}`],ce=r.value[`offset${Pu(N.value)}`],pe=z.value;ce<le?(P.value=P.value||{},P.value.prev=pe,P.value.next=pe+ce<le,le-pe<ce&&(z.value=le-ce)):(P.value=!1,pe>0&&(z.value=0))},J=he=>{let le=0;switch(he.code){case Cn.left:case Cn.up:le=-1;break;case Cn.right:case Cn.down:le=1;break;default:return}const ce=Array.from(he.currentTarget.querySelectorAll("[role=tab]:not(.is-disabled)"));let de=ce.indexOf(he.target)+le;de<0?de=ce.length-1:de>=ce.length&&(de=0),ce[de].focus({preventScroll:!0}),ce[de].click(),re()},re=()=>{V.value&&(F.value=!0)},se=()=>F.value=!1;return Wt(p,he=>{he==="hidden"?V.value=!1:he==="visible"&&setTimeout(()=>V.value=!0,50)}),Wt(y,he=>{he?setTimeout(()=>V.value=!0,50):V.value=!1}),ro(C,q),yr(()=>setTimeout(()=>Z(),0)),Uu(()=>q()),t({scrollToActiveTab:Z,removeFocus:se}),()=>{const he=P.value?[qe("span",{class:[d.e("nav-prev"),d.is("disabled",!P.value.prev)],onClick:U},[qe(zn,null,{default:()=>[qe(Yd,null,null)]})]),qe("span",{class:[d.e("nav-next"),d.is("disabled",!P.value.next)],onClick:te},[qe(zn,null,{default:()=>[qe(ta,null,null)]})])]:null,le=e.panes.map((ce,pe)=>{var de,Ie,Ve,be;const ye=ce.uid,Me=ce.props.disabled,we=(Ie=(de=ce.props.name)!=null?de:ce.index)!=null?Ie:`${pe}`,me=!Me&&(ce.isClosable||e.editable);ce.index=`${pe}`;const De=me?qe(zn,{class:"is-icon-close",onClick:Oe=>o("tabRemove",ce,Oe)},{default:()=>[qe(Ql,null,null)]}):null,Ge=((be=(Ve=ce.slots).label)==null?void 0:be.call(Ve))||ce.props.label,rt=!Me&&ce.active?0:-1;return qe("div",{ref:`tab-${ye}`,class:[d.e("item"),d.is(a.props.tabPosition),d.is("active",ce.active),d.is("disabled",Me),d.is("closable",me),d.is("focus",F.value)],id:`tab-${we}`,key:`tab-${ye}`,"aria-controls":`pane-${we}`,role:"tab","aria-selected":ce.active,tabindex:rt,onFocus:()=>re(),onBlur:()=>se(),onClick:Oe=>{se(),o("tabClick",ce,we,Oe)},onKeydown:Oe=>{me&&(Oe.code===Cn.delete||Oe.code===Cn.backspace)&&o("tabRemove",ce,Oe)}},[Ge,De])});return qe("div",{ref:C,class:[d.e("nav-wrap"),d.is("scrollable",!!P.value),d.is(a.props.tabPosition)]},[he,qe("div",{class:d.e("nav-scroll"),ref:r},[qe("div",{class:[d.e("nav"),d.is(a.props.tabPosition),d.is("stretch",e.stretch&&["top","bottom"].includes(a.props.tabPosition))],ref:S,style:H.value,role:"tablist",onKeydown:J},[e.type?null:qe(Ede,{ref:M,tabs:[...e.panes]},null),le])])])}}}),kde=un({type:{type:String,values:["card","border-card",""],default:""},closable:Boolean,addable:Boolean,modelValue:{type:[String,Number]},editable:Boolean,tabPosition:{type:String,values:["top","right","bottom","left"],default:"top"},beforeLeave:{type:lt(Function),default:()=>!0},stretch:Boolean}),bS=e=>Nn(e)||Wn(e),Pde={[gr]:e=>bS(e),tabClick:(e,t)=>t instanceof Event,tabChange:e=>bS(e),edit:(e,t)=>["remove","add"].includes(t),tabRemove:e=>bS(e),tabAdd:()=>!0},Rde=We({name:"ElTabs",props:kde,emits:Pde,setup(e,{emit:t,slots:o,expose:a}){var d;const p=Xt("tabs"),y=ee(()=>["left","right"].includes(e.tabPosition)),{children:r,addChild:S,removeChild:C}=vE(Cr(),"ElTabPane"),M=xe(),P=xe((d=e.modelValue)!=null?d:"0"),z=async(U,te=!1)=>{var Z,q,J;if(!(P.value===U||ai(U)))try{await((Z=e.beforeLeave)==null?void 0:Z.call(e,U,P.value))!==!1&&(P.value=U,te&&(t(gr,U),t("tabChange",U)),(J=(q=M.value)==null?void 0:q.removeFocus)==null||J.call(q))}catch{}},F=(U,te,Z)=>{U.props.disabled||(z(te,!0),t("tabClick",U,Z))},V=(U,te)=>{U.props.disabled||ai(U.props.name)||(te.stopPropagation(),t("edit",U.props.name,"remove"),t("tabRemove",U.props.name))},N=()=>{t("edit",void 0,"add"),t("tabAdd")};Wt(()=>e.modelValue,U=>z(U)),Wt(P,async()=>{var U;await jn(),(U=M.value)==null||U.scrollToActiveTab()}),Vr(Ix,{props:e,currentName:P,registerPane:U=>{r.value.push(U)},sortPane:S,unregisterPane:C}),a({currentName:P});const H=({render:U})=>U();return()=>{const U=o["add-icon"],te=e.editable||e.addable?qe("div",{class:[p.e("new-tab"),y.value&&p.e("new-tab-vertical")],tabindex:"0",onClick:N,onKeydown:J=>{[Cn.enter,Cn.numpadEnter].includes(J.code)&&N()}},[U?gt(o,"add-icon"):qe(zn,{class:p.is("icon-plus")},{default:()=>[qe(kz,null,null)]})]):null,Z=qe("div",{class:[p.e("header"),y.value&&p.e("header-vertical"),p.is(e.tabPosition)]},[qe(H,{render:()=>{const J=r.value.some(re=>re.slots.label);return qe(Ade,{ref:M,currentName:P.value,editable:e.editable,type:e.type,panes:r.value,stretch:e.stretch,onTabClick:F,onTabRemove:V},{$stable:!J})}},null),te]),q=qe("div",{class:p.e("content")},[gt(o,"default")]);return qe("div",{class:[p.b(),p.m(e.tabPosition),{[p.m("card")]:e.type==="card",[p.m("border-card")]:e.type==="border-card"}]},[q,Z])}}});var Ode=Rde;const Lde=un({label:{type:String,default:""},name:{type:[String,Number]},closable:Boolean,disabled:Boolean,lazy:Boolean}),LN="ElTabPane",Dde=We({name:LN}),zde=We({...Dde,props:Lde,setup(e){const t=e,o=Cr(),a=Bo(),d=Pn(Ix);d||No(LN,"usage: <el-tabs><el-tab-pane /></el-tabs/>");const p=Xt("tab-pane"),y=xe(),r=ee(()=>t.closable||d.props.closable),S=XS(()=>{var F;return d.currentName.value===((F=t.name)!=null?F:y.value)}),C=xe(S.value),M=ee(()=>{var F;return(F=t.name)!=null?F:y.value}),P=XS(()=>!t.lazy||C.value||S.value);Wt(S,F=>{F&&(C.value=!0)});const z=si({uid:o.uid,slots:a,props:t,paneName:M,active:S,index:y,isClosable:r});return d.registerPane(z),yr(()=>{d.sortPane(z)}),rf(()=>{d.unregisterPane(z.uid)}),(F,V)=>b(P)?hr((ae(),Pe("div",{key:0,id:`pane-${b(M)}`,class:fe(b(p).b()),role:"tabpanel","aria-hidden":!b(S),"aria-labelledby":`tab-${b(M)}`},[gt(F.$slots,"default")],10,["id","aria-hidden","aria-labelledby"])),[[ii,b(S)]]):bt("v-if",!0)}});var DN=dn(zde,[["__file","tab-pane.vue"]]);const Fde=lr(Ode,{TabPane:DN}),Nde=oo(DN),Bde=un({type:{type:String,values:["primary","success","info","warning","danger",""],default:""},size:{type:String,values:ju,default:""},truncated:Boolean,lineClamp:{type:[String,Number]},tag:{type:String,default:"span"}}),Vde=We({name:"ElText"}),$de=We({...Vde,props:Bde,setup(e){const t=e,o=Ro(),a=Xt("text"),d=ee(()=>[a.b(),a.m(t.type),a.m(o.value),a.is("truncated",t.truncated),a.is("line-clamp",!ai(t.lineClamp))]);return(p,y)=>(ae(),At(Ir(p.tag),{class:fe(b(d)),style:Un({"-webkit-line-clamp":p.lineClamp})},{default:ot(()=>[gt(p.$slots,"default")]),_:3},8,["class","style"]))}});var Ude=dn($de,[["__file","text.vue"]]);const jde=lr(Ude),Hde=un({format:{type:String,default:"HH:mm"},modelValue:String,disabled:Boolean,editable:{type:Boolean,default:!0},effect:{type:lt(String),default:"light"},clearable:{type:Boolean,default:!0},size:zo,placeholder:String,start:{type:String,default:"09:00"},end:{type:String,default:"18:00"},step:{type:String,default:"00:30"},minTime:String,maxTime:String,name:String,prefixIcon:{type:lt([String,Object]),default:()=>Az},clearIcon:{type:lt([String,Object]),default:()=>Fc},...sg}),Cc=e=>{const t=(e||"").split(":");if(t.length>=2){let o=Number.parseInt(t[0],10);const a=Number.parseInt(t[1],10),d=e.toUpperCase();return d.includes("AM")&&o===12?o=0:d.includes("PM")&&o!==12&&(o+=12),{hours:o,minutes:a}}return null},xS=(e,t)=>{const o=Cc(e);if(!o)return-1;const a=Cc(t);if(!a)return-1;const d=o.minutes+o.hours*60,p=a.minutes+a.hours*60;return d===p?0:d>p?1:-1},lO=e=>`${e}`.padStart(2,"0"),mm=e=>`${lO(e.hours)}:${lO(e.minutes)}`,Gde=(e,t)=>{const o=Cc(e);if(!o)return"";const a=Cc(t);if(!a)return"";const d={hours:o.hours,minutes:o.minutes};return d.minutes+=a.minutes,d.hours+=a.hours,d.hours+=Math.floor(d.minutes/60),d.minutes=d.minutes%60,mm(d)},Wde=We({name:"ElTimeSelect"}),qde=We({...Wde,props:Hde,emits:["change","blur","focus","clear","update:modelValue"],setup(e,{expose:t}){const o=e;sr.extend(SE);const{Option:a}=Ch,d=Xt("input"),p=xe(),y=ws(),{lang:r}=qr(),S=ee(()=>o.modelValue),C=ee(()=>{const U=Cc(o.start);return U?mm(U):null}),M=ee(()=>{const U=Cc(o.end);return U?mm(U):null}),P=ee(()=>{const U=Cc(o.step);return U?mm(U):null}),z=ee(()=>{const U=Cc(o.minTime||"");return U?mm(U):null}),F=ee(()=>{const U=Cc(o.maxTime||"");return U?mm(U):null}),V=ee(()=>{const U=[];if(o.start&&o.end&&o.step){let te=C.value,Z;for(;te&&M.value&&xS(te,M.value)<=0;)Z=sr(te,"HH:mm").locale(r.value).format(o.format),U.push({value:Z,disabled:xS(te,z.value||"-1:-1")<=0||xS(te,F.value||"100:100")>=0}),te=Gde(te,P.value)}return U});return t({blur:()=>{var U,te;(te=(U=p.value)==null?void 0:U.blur)==null||te.call(U)},focus:()=>{var U,te;(te=(U=p.value)==null?void 0:U.focus)==null||te.call(U)}}),(U,te)=>(ae(),At(b(Ch),{ref_key:"select",ref:p,"model-value":b(S),disabled:b(y),clearable:U.clearable,"clear-icon":U.clearIcon,size:U.size,effect:U.effect,placeholder:U.placeholder,"default-first-option":"",filterable:U.editable,"empty-values":U.emptyValues,"value-on-clear":U.valueOnClear,"onUpdate:modelValue":Z=>U.$emit("update:modelValue",Z),onChange:Z=>U.$emit("change",Z),onBlur:Z=>U.$emit("blur",Z),onFocus:Z=>U.$emit("focus",Z),onClear:()=>U.$emit("clear")},{prefix:ot(()=>[U.prefixIcon?(ae(),At(b(zn),{key:0,class:fe(b(d).e("prefix-icon"))},{default:ot(()=>[(ae(),At(Ir(U.prefixIcon)))]),_:1},8,["class"])):bt("v-if",!0)]),default:ot(()=>[(ae(!0),Pe(Vn,null,Fr(b(V),Z=>(ae(),At(b(a),{key:Z.value,label:Z.value,value:Z.value,disabled:Z.disabled},null,8,["label","value","disabled"]))),128))]),_:1},8,["model-value","disabled","clearable","clear-icon","size","effect","placeholder","filterable","empty-values","value-on-clear","onUpdate:modelValue","onChange","onBlur","onFocus","onClear"]))}});var Kde=dn(qde,[["__file","time-select.vue"]]);const Zde=lr(Kde),Yde=We({name:"ElTimeline",setup(e,{slots:t}){const o=Xt("timeline");return Vr("timeline",t),()=>Zn("ul",{class:[o.b()]},[gt(t,"default")])}}),Xde=un({timestamp:{type:String,default:""},hideTimestamp:Boolean,center:Boolean,placement:{type:String,values:["top","bottom"],default:"bottom"},type:{type:String,values:["primary","success","warning","danger","info"],default:""},color:{type:String,default:""},size:{type:String,values:["normal","large"],default:"normal"},icon:{type:Ai},hollow:Boolean}),Jde=We({name:"ElTimelineItem"}),Qde=We({...Jde,props:Xde,setup(e){const t=e,o=Xt("timeline-item"),a=ee(()=>[o.e("node"),o.em("node",t.size||""),o.em("node",t.type||""),o.is("hollow",t.hollow)]);return(d,p)=>(ae(),Pe("li",{class:fe([b(o).b(),{[b(o).e("center")]:d.center}])},[Ue("div",{class:fe(b(o).e("tail"))},null,2),d.$slots.dot?bt("v-if",!0):(ae(),Pe("div",{key:0,class:fe(b(a)),style:Un({backgroundColor:d.color})},[d.icon?(ae(),At(b(zn),{key:0,class:fe(b(o).e("icon"))},{default:ot(()=>[(ae(),At(Ir(d.icon)))]),_:1},8,["class"])):bt("v-if",!0)],6)),d.$slots.dot?(ae(),Pe("div",{key:1,class:fe(b(o).e("dot"))},[gt(d.$slots,"dot")],2)):bt("v-if",!0),Ue("div",{class:fe(b(o).e("wrapper"))},[!d.hideTimestamp&&d.placement==="top"?(ae(),Pe("div",{key:0,class:fe([b(o).e("timestamp"),b(o).is("top")])},fn(d.timestamp),3)):bt("v-if",!0),Ue("div",{class:fe(b(o).e("content"))},[gt(d.$slots,"default")],2),!d.hideTimestamp&&d.placement==="bottom"?(ae(),Pe("div",{key:1,class:fe([b(o).e("timestamp"),b(o).is("bottom")])},fn(d.timestamp),3)):bt("v-if",!0)],2)],2))}});var zN=dn(Qde,[["__file","timeline-item.vue"]]);const efe=lr(Yde,{TimelineItem:zN}),tfe=oo(zN),FN=un({nowrap:Boolean});var NN=(e=>(e.top="top",e.bottom="bottom",e.left="left",e.right="right",e))(NN||{});const nfe=Object.values(NN),eM=un({width:{type:Number,default:10},height:{type:Number,default:10},style:{type:lt(Object),default:null}}),rfe=un({side:{type:lt(String),values:nfe,required:!0}}),ife=["absolute","fixed"],ofe=["top-start","top-end","top","bottom-start","bottom-end","bottom","left-start","left-end","left","right-start","right-end","right"],tM=un({arrowPadding:{type:lt(Number),default:5},effect:{type:lt(String),default:"light"},contentClass:String,placement:{type:lt(String),values:ofe,default:"bottom"},reference:{type:lt(Object),default:null},offset:{type:Number,default:8},strategy:{type:lt(String),values:ife,default:"absolute"},showArrow:Boolean,...cs(["ariaLabel"])}),nM=un({delayDuration:{type:Number,default:300},defaultOpen:Boolean,open:{type:Boolean,default:void 0},onOpenChange:{type:lt(Function)},"onUpdate:open":{type:lt(Function)}}),cm={type:lt(Function)},rM=un({onBlur:cm,onClick:cm,onFocus:cm,onMouseDown:cm,onMouseEnter:cm,onMouseLeave:cm}),sfe=un({...nM,...eM,...rM,...tM,alwaysOn:Boolean,fullTransition:Boolean,transitionProps:{type:lt(Object),default:null},teleported:Boolean,to:{type:lt(String),default:"body"}}),Ax=Symbol("tooltipV2"),BN=Symbol("tooltipV2Content"),wS="tooltip_v2.open",afe=We({name:"ElTooltipV2Root"}),lfe=We({...afe,props:nM,setup(e,{expose:t}){const o=e,a=xe(o.defaultOpen),d=xe(null),p=ee({get:()=>Yl(o.open)?a.value:o.open,set:H=>{var U;a.value=H,(U=o["onUpdate:open"])==null||U.call(o,H)}}),y=ee(()=>Wn(o.delayDuration)&&o.delayDuration>0),{start:r,stop:S}=Sh(()=>{p.value=!0},ee(()=>o.delayDuration),{immediate:!1}),C=Xt("tooltip-v2"),M=us(),P=()=>{S(),p.value=!0},z=()=>{b(y)?r():P()},F=P,V=()=>{S(),p.value=!1};return Wt(p,H=>{var U;H&&(document.dispatchEvent(new CustomEvent(wS)),F()),(U=o.onOpenChange)==null||U.call(o,H)}),yr(()=>{document.addEventListener(wS,V)}),Li(()=>{S(),document.removeEventListener(wS,V)}),Vr(Ax,{contentId:M,triggerRef:d,ns:C,onClose:V,onDelayOpen:z,onOpen:F}),t({onOpen:F,onClose:V}),(H,U)=>gt(H.$slots,"default",{open:b(p)})}});var ufe=dn(lfe,[["__file","root.vue"]]);const cfe=We({name:"ElTooltipV2Arrow"}),dfe=We({...cfe,props:{...eM,...rfe},setup(e){const t=e,{ns:o}=Pn(Ax),{arrowRef:a}=Pn(BN),d=ee(()=>{const{style:p,width:y,height:r}=t,S=o.namespace.value;return{[`--${S}-tooltip-v2-arrow-width`]:`${y}px`,[`--${S}-tooltip-v2-arrow-height`]:`${r}px`,[`--${S}-tooltip-v2-arrow-border-width`]:`${y/2}px`,[`--${S}-tooltip-v2-arrow-cover-width`]:y/2-1,...p||{}}});return(p,y)=>(ae(),Pe("span",{ref_key:"arrowRef",ref:a,style:Un(b(d)),class:fe(b(o).e("arrow"))},null,6))}});var uO=dn(dfe,[["__file","arrow.vue"]]);const Wm=Math.min,vh=Math.max,N1=Math.round,Db=Math.floor,Du=e=>({x:e,y:e}),ffe={left:"right",right:"left",bottom:"top",top:"bottom"},hfe={start:"end",end:"start"};function $T(e,t,o){return vh(e,Wm(t,o))}function mv(e,t){return typeof e=="function"?e(t):e}function Mh(e){return e.split("-")[0]}function gv(e){return e.split("-")[1]}function VN(e){return e==="x"?"y":"x"}function iM(e){return e==="y"?"height":"width"}function qm(e){return["top","bottom"].includes(Mh(e))?"y":"x"}function oM(e){return VN(qm(e))}function pfe(e,t,o){o===void 0&&(o=!1);const a=gv(e),d=oM(e),p=iM(d);let y=d==="x"?a===(o?"end":"start")?"right":"left":a==="start"?"bottom":"top";return t.reference[p]>t.floating[p]&&(y=B1(y)),[y,B1(y)]}function mfe(e){const t=B1(e);return[UT(e),t,UT(t)]}function UT(e){return e.replace(/start|end/g,t=>hfe[t])}function gfe(e,t,o){const a=["left","right"],d=["right","left"],p=["top","bottom"],y=["bottom","top"];switch(e){case"top":case"bottom":return o?t?d:a:t?a:d;case"left":case"right":return t?p:y;default:return[]}}function _fe(e,t,o,a){const d=gv(e);let p=gfe(Mh(e),o==="start",a);return d&&(p=p.map(y=>y+"-"+d),t&&(p=p.concat(p.map(UT)))),p}function B1(e){return e.replace(/left|right|bottom|top/g,t=>ffe[t])}function yfe(e){return{top:0,right:0,bottom:0,left:0,...e}}function $N(e){return typeof e!="number"?yfe(e):{top:e,right:e,bottom:e,left:e}}function V1(e){const{x:t,y:o,width:a,height:d}=e;return{width:a,height:d,top:o,left:t,right:t+a,bottom:o+d,x:t,y:o}}function cO(e,t,o){let{reference:a,floating:d}=e;const p=qm(t),y=oM(t),r=iM(y),S=Mh(t),C=p==="y",M=a.x+a.width/2-d.width/2,P=a.y+a.height/2-d.height/2,z=a[r]/2-d[r]/2;let F;switch(S){case"top":F={x:M,y:a.y-d.height};break;case"bottom":F={x:M,y:a.y+a.height};break;case"right":F={x:a.x+a.width,y:P};break;case"left":F={x:a.x-d.width,y:P};break;default:F={x:a.x,y:a.y}}switch(gv(t)){case"start":F[y]-=z*(o&&C?-1:1);break;case"end":F[y]+=z*(o&&C?-1:1);break}return F}const vfe=async(e,t,o)=>{const{placement:a="bottom",strategy:d="absolute",middleware:p=[],platform:y}=o,r=p.filter(Boolean),S=await(y.isRTL==null?void 0:y.isRTL(t));let C=await y.getElementRects({reference:e,floating:t,strategy:d}),{x:M,y:P}=cO(C,a,S),z=a,F={},V=0;for(let N=0;N<r.length;N++){const{name:H,fn:U}=r[N],{x:te,y:Z,data:q,reset:J}=await U({x:M,y:P,initialPlacement:a,placement:z,strategy:d,middlewareData:F,rects:C,platform:y,elements:{reference:e,floating:t}});M=te??M,P=Z??P,F={...F,[H]:{...F[H],...q}},J&&V<=50&&(V++,typeof J=="object"&&(J.placement&&(z=J.placement),J.rects&&(C=J.rects===!0?await y.getElementRects({reference:e,floating:t,strategy:d}):J.rects),{x:M,y:P}=cO(C,z,S)),N=-1)}return{x:M,y:P,placement:z,strategy:d,middlewareData:F}};async function sM(e,t){var o;t===void 0&&(t={});const{x:a,y:d,platform:p,rects:y,elements:r,strategy:S}=e,{boundary:C="clippingAncestors",rootBoundary:M="viewport",elementContext:P="floating",altBoundary:z=!1,padding:F=0}=mv(t,e),V=$N(F),H=r[z?P==="floating"?"reference":"floating":P],U=V1(await p.getClippingRect({element:(o=await(p.isElement==null?void 0:p.isElement(H)))==null||o?H:H.contextElement||await(p.getDocumentElement==null?void 0:p.getDocumentElement(r.floating)),boundary:C,rootBoundary:M,strategy:S})),te=P==="floating"?{x:a,y:d,width:y.floating.width,height:y.floating.height}:y.reference,Z=await(p.getOffsetParent==null?void 0:p.getOffsetParent(r.floating)),q=await(p.isElement==null?void 0:p.isElement(Z))?await(p.getScale==null?void 0:p.getScale(Z))||{x:1,y:1}:{x:1,y:1},J=V1(p.convertOffsetParentRelativeRectToViewportRelativeRect?await p.convertOffsetParentRelativeRectToViewportRelativeRect({elements:r,rect:te,offsetParent:Z,strategy:S}):te);return{top:(U.top-J.top+V.top)/q.y,bottom:(J.bottom-U.bottom+V.bottom)/q.y,left:(U.left-J.left+V.left)/q.x,right:(J.right-U.right+V.right)/q.x}}const bfe=e=>({name:"arrow",options:e,async fn(t){const{x:o,y:a,placement:d,rects:p,platform:y,elements:r,middlewareData:S}=t,{element:C,padding:M=0}=mv(e,t)||{};if(C==null)return{};const P=$N(M),z={x:o,y:a},F=oM(d),V=iM(F),N=await y.getDimensions(C),H=F==="y",U=H?"top":"left",te=H?"bottom":"right",Z=H?"clientHeight":"clientWidth",q=p.reference[V]+p.reference[F]-z[F]-p.floating[V],J=z[F]-p.reference[F],re=await(y.getOffsetParent==null?void 0:y.getOffsetParent(C));let se=re?re[Z]:0;(!se||!await(y.isElement==null?void 0:y.isElement(re)))&&(se=r.floating[Z]||p.floating[V]);const he=q/2-J/2,le=se/2-N[V]/2-1,ce=Wm(P[U],le),pe=Wm(P[te],le),de=ce,Ie=se-N[V]-pe,Ve=se/2-N[V]/2+he,be=$T(de,Ve,Ie),ye=!S.arrow&&gv(d)!=null&&Ve!==be&&p.reference[V]/2-(Ve<de?ce:pe)-N[V]/2<0,Me=ye?Ve<de?Ve-de:Ve-Ie:0;return{[F]:z[F]+Me,data:{[F]:be,centerOffset:Ve-be-Me,...ye&&{alignmentOffset:Me}},reset:ye}}}),xfe=function(e){return e===void 0&&(e={}),{name:"flip",options:e,async fn(t){var o,a;const{placement:d,middlewareData:p,rects:y,initialPlacement:r,platform:S,elements:C}=t,{mainAxis:M=!0,crossAxis:P=!0,fallbackPlacements:z,fallbackStrategy:F="bestFit",fallbackAxisSideDirection:V="none",flipAlignment:N=!0,...H}=mv(e,t);if((o=p.arrow)!=null&&o.alignmentOffset)return{};const U=Mh(d),te=qm(r),Z=Mh(r)===r,q=await(S.isRTL==null?void 0:S.isRTL(C.floating)),J=z||(Z||!N?[B1(r)]:mfe(r)),re=V!=="none";!z&&re&&J.push(..._fe(r,N,V,q));const se=[r,...J],he=await sM(t,H),le=[];let ce=((a=p.flip)==null?void 0:a.overflows)||[];if(M&&le.push(he[U]),P){const Ve=pfe(d,y,q);le.push(he[Ve[0]],he[Ve[1]])}if(ce=[...ce,{placement:d,overflows:le}],!le.every(Ve=>Ve<=0)){var pe,de;const Ve=(((pe=p.flip)==null?void 0:pe.index)||0)+1,be=se[Ve];if(be)return{data:{index:Ve,overflows:ce},reset:{placement:be}};let ye=(de=ce.filter(Me=>Me.overflows[0]<=0).sort((Me,we)=>Me.overflows[1]-we.overflows[1])[0])==null?void 0:de.placement;if(!ye)switch(F){case"bestFit":{var Ie;const Me=(Ie=ce.filter(we=>{if(re){const me=qm(we.placement);return me===te||me==="y"}return!0}).map(we=>[we.placement,we.overflows.filter(me=>me>0).reduce((me,De)=>me+De,0)]).sort((we,me)=>we[1]-me[1])[0])==null?void 0:Ie[0];Me&&(ye=Me);break}case"initialPlacement":ye=r;break}if(d!==ye)return{reset:{placement:ye}}}return{}}}};async function wfe(e,t){const{placement:o,platform:a,elements:d}=e,p=await(a.isRTL==null?void 0:a.isRTL(d.floating)),y=Mh(o),r=gv(o),S=qm(o)==="y",C=["left","top"].includes(y)?-1:1,M=p&&S?-1:1,P=mv(t,e);let{mainAxis:z,crossAxis:F,alignmentAxis:V}=typeof P=="number"?{mainAxis:P,crossAxis:0,alignmentAxis:null}:{mainAxis:P.mainAxis||0,crossAxis:P.crossAxis||0,alignmentAxis:P.alignmentAxis};return r&&typeof V=="number"&&(F=r==="end"?V*-1:V),S?{x:F*M,y:z*C}:{x:z*C,y:F*M}}const Sfe=function(e){return e===void 0&&(e=0),{name:"offset",options:e,async fn(t){var o,a;const{x:d,y:p,placement:y,middlewareData:r}=t,S=await wfe(t,e);return y===((o=r.offset)==null?void 0:o.placement)&&(a=r.arrow)!=null&&a.alignmentOffset?{}:{x:d+S.x,y:p+S.y,data:{...S,placement:y}}}}},Tfe=function(e){return e===void 0&&(e={}),{name:"shift",options:e,async fn(t){const{x:o,y:a,placement:d}=t,{mainAxis:p=!0,crossAxis:y=!1,limiter:r={fn:H=>{let{x:U,y:te}=H;return{x:U,y:te}}},...S}=mv(e,t),C={x:o,y:a},M=await sM(t,S),P=qm(Mh(d)),z=VN(P);let F=C[z],V=C[P];if(p){const H=z==="y"?"top":"left",U=z==="y"?"bottom":"right",te=F+M[H],Z=F-M[U];F=$T(te,F,Z)}if(y){const H=P==="y"?"top":"left",U=P==="y"?"bottom":"right",te=V+M[H],Z=V-M[U];V=$T(te,V,Z)}const N=r.fn({...t,[z]:F,[P]:V});return{...N,data:{x:N.x-o,y:N.y-a,enabled:{[z]:p,[P]:y}}}}}};function kx(){return typeof window<"u"}function dg(e){return UN(e)?(e.nodeName||"").toLowerCase():"#document"}function Wa(e){var t;return(e==null||(t=e.ownerDocument)==null?void 0:t.defaultView)||window}function qu(e){var t;return(t=(UN(e)?e.ownerDocument:e.document)||window.document)==null?void 0:t.documentElement}function UN(e){return kx()?e instanceof Node||e instanceof Wa(e).Node:!1}function eu(e){return kx()?e instanceof Element||e instanceof Wa(e).Element:!1}function Vu(e){return kx()?e instanceof HTMLElement||e instanceof Wa(e).HTMLElement:!1}function dO(e){return!kx()||typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof Wa(e).ShadowRoot}function _v(e){const{overflow:t,overflowX:o,overflowY:a,display:d}=tu(e);return/auto|scroll|overlay|hidden|clip/.test(t+a+o)&&!["inline","contents"].includes(d)}function Cfe(e){return["table","td","th"].includes(dg(e))}function Px(e){return[":popover-open",":modal"].some(t=>{try{return e.matches(t)}catch{return!1}})}function aM(e){const t=lM(),o=eu(e)?tu(e):e;return["transform","translate","scale","rotate","perspective"].some(a=>o[a]?o[a]!=="none":!1)||(o.containerType?o.containerType!=="normal":!1)||!t&&(o.backdropFilter?o.backdropFilter!=="none":!1)||!t&&(o.filter?o.filter!=="none":!1)||["transform","translate","scale","rotate","perspective","filter"].some(a=>(o.willChange||"").includes(a))||["paint","layout","strict","content"].some(a=>(o.contain||"").includes(a))}function Efe(e){let t=ef(e);for(;Vu(t)&&!Km(t);){if(aM(t))return t;if(Px(t))return null;t=ef(t)}return null}function lM(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function Km(e){return["html","body","#document"].includes(dg(e))}function tu(e){return Wa(e).getComputedStyle(e)}function Rx(e){return eu(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function ef(e){if(dg(e)==="html")return e;const t=e.assignedSlot||e.parentNode||dO(e)&&e.host||qu(e);return dO(t)?t.host:t}function jN(e){const t=ef(e);return Km(t)?e.ownerDocument?e.ownerDocument.body:e.body:Vu(t)&&_v(t)?t:jN(t)}function Ky(e,t,o){var a;t===void 0&&(t=[]),o===void 0&&(o=!0);const d=jN(e),p=d===((a=e.ownerDocument)==null?void 0:a.body),y=Wa(d);if(p){const r=jT(y);return t.concat(y,y.visualViewport||[],_v(d)?d:[],r&&o?Ky(r):[])}return t.concat(d,Ky(d,[],o))}function jT(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function HN(e){const t=tu(e);let o=parseFloat(t.width)||0,a=parseFloat(t.height)||0;const d=Vu(e),p=d?e.offsetWidth:o,y=d?e.offsetHeight:a,r=N1(o)!==p||N1(a)!==y;return r&&(o=p,a=y),{width:o,height:a,$:r}}function uM(e){return eu(e)?e:e.contextElement}function Am(e){const t=uM(e);if(!Vu(t))return Du(1);const o=t.getBoundingClientRect(),{width:a,height:d,$:p}=HN(t);let y=(p?N1(o.width):o.width)/a,r=(p?N1(o.height):o.height)/d;return(!y||!Number.isFinite(y))&&(y=1),(!r||!Number.isFinite(r))&&(r=1),{x:y,y:r}}const Mfe=Du(0);function GN(e){const t=Wa(e);return!lM()||!t.visualViewport?Mfe:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function Ife(e,t,o){return t===void 0&&(t=!1),!o||t&&o!==Wa(e)?!1:t}function Ih(e,t,o,a){t===void 0&&(t=!1),o===void 0&&(o=!1);const d=e.getBoundingClientRect(),p=uM(e);let y=Du(1);t&&(a?eu(a)&&(y=Am(a)):y=Am(e));const r=Ife(p,o,a)?GN(p):Du(0);let S=(d.left+r.x)/y.x,C=(d.top+r.y)/y.y,M=d.width/y.x,P=d.height/y.y;if(p){const z=Wa(p),F=a&&eu(a)?Wa(a):a;let V=z,N=jT(V);for(;N&&a&&F!==V;){const H=Am(N),U=N.getBoundingClientRect(),te=tu(N),Z=U.left+(N.clientLeft+parseFloat(te.paddingLeft))*H.x,q=U.top+(N.clientTop+parseFloat(te.paddingTop))*H.y;S*=H.x,C*=H.y,M*=H.x,P*=H.y,S+=Z,C+=q,V=Wa(N),N=jT(V)}}return V1({width:M,height:P,x:S,y:C})}function cM(e,t){const o=Rx(e).scrollLeft;return t?t.left+o:Ih(qu(e)).left+o}function WN(e,t,o){o===void 0&&(o=!1);const a=e.getBoundingClientRect(),d=a.left+t.scrollLeft-(o?0:cM(e,a)),p=a.top+t.scrollTop;return{x:d,y:p}}function Afe(e){let{elements:t,rect:o,offsetParent:a,strategy:d}=e;const p=d==="fixed",y=qu(a),r=t?Px(t.floating):!1;if(a===y||r&&p)return o;let S={scrollLeft:0,scrollTop:0},C=Du(1);const M=Du(0),P=Vu(a);if((P||!P&&!p)&&((dg(a)!=="body"||_v(y))&&(S=Rx(a)),Vu(a))){const F=Ih(a);C=Am(a),M.x=F.x+a.clientLeft,M.y=F.y+a.clientTop}const z=y&&!P&&!p?WN(y,S,!0):Du(0);return{width:o.width*C.x,height:o.height*C.y,x:o.x*C.x-S.scrollLeft*C.x+M.x+z.x,y:o.y*C.y-S.scrollTop*C.y+M.y+z.y}}function kfe(e){return Array.from(e.getClientRects())}function Pfe(e){const t=qu(e),o=Rx(e),a=e.ownerDocument.body,d=vh(t.scrollWidth,t.clientWidth,a.scrollWidth,a.clientWidth),p=vh(t.scrollHeight,t.clientHeight,a.scrollHeight,a.clientHeight);let y=-o.scrollLeft+cM(e);const r=-o.scrollTop;return tu(a).direction==="rtl"&&(y+=vh(t.clientWidth,a.clientWidth)-d),{width:d,height:p,x:y,y:r}}function Rfe(e,t){const o=Wa(e),a=qu(e),d=o.visualViewport;let p=a.clientWidth,y=a.clientHeight,r=0,S=0;if(d){p=d.width,y=d.height;const C=lM();(!C||C&&t==="fixed")&&(r=d.offsetLeft,S=d.offsetTop)}return{width:p,height:y,x:r,y:S}}function Ofe(e,t){const o=Ih(e,!0,t==="fixed"),a=o.top+e.clientTop,d=o.left+e.clientLeft,p=Vu(e)?Am(e):Du(1),y=e.clientWidth*p.x,r=e.clientHeight*p.y,S=d*p.x,C=a*p.y;return{width:y,height:r,x:S,y:C}}function fO(e,t,o){let a;if(t==="viewport")a=Rfe(e,o);else if(t==="document")a=Pfe(qu(e));else if(eu(t))a=Ofe(t,o);else{const d=GN(e);a={x:t.x-d.x,y:t.y-d.y,width:t.width,height:t.height}}return V1(a)}function qN(e,t){const o=ef(e);return o===t||!eu(o)||Km(o)?!1:tu(o).position==="fixed"||qN(o,t)}function Lfe(e,t){const o=t.get(e);if(o)return o;let a=Ky(e,[],!1).filter(r=>eu(r)&&dg(r)!=="body"),d=null;const p=tu(e).position==="fixed";let y=p?ef(e):e;for(;eu(y)&&!Km(y);){const r=tu(y),S=aM(y);!S&&r.position==="fixed"&&(d=null),(p?!S&&!d:!S&&r.position==="static"&&!!d&&["absolute","fixed"].includes(d.position)||_v(y)&&!S&&qN(e,y))?a=a.filter(M=>M!==y):d=r,y=ef(y)}return t.set(e,a),a}function Dfe(e){let{element:t,boundary:o,rootBoundary:a,strategy:d}=e;const y=[...o==="clippingAncestors"?Px(t)?[]:Lfe(t,this._c):[].concat(o),a],r=y[0],S=y.reduce((C,M)=>{const P=fO(t,M,d);return C.top=vh(P.top,C.top),C.right=Wm(P.right,C.right),C.bottom=Wm(P.bottom,C.bottom),C.left=vh(P.left,C.left),C},fO(t,r,d));return{width:S.right-S.left,height:S.bottom-S.top,x:S.left,y:S.top}}function zfe(e){const{width:t,height:o}=HN(e);return{width:t,height:o}}function Ffe(e,t,o){const a=Vu(t),d=qu(t),p=o==="fixed",y=Ih(e,!0,p,t);let r={scrollLeft:0,scrollTop:0};const S=Du(0);if(a||!a&&!p)if((dg(t)!=="body"||_v(d))&&(r=Rx(t)),a){const z=Ih(t,!0,p,t);S.x=z.x+t.clientLeft,S.y=z.y+t.clientTop}else d&&(S.x=cM(d));const C=d&&!a&&!p?WN(d,r):Du(0),M=y.left+r.scrollLeft-S.x-C.x,P=y.top+r.scrollTop-S.y-C.y;return{x:M,y:P,width:y.width,height:y.height}}function SS(e){return tu(e).position==="static"}function hO(e,t){if(!Vu(e)||tu(e).position==="fixed")return null;if(t)return t(e);let o=e.offsetParent;return qu(e)===o&&(o=o.ownerDocument.body),o}function KN(e,t){const o=Wa(e);if(Px(e))return o;if(!Vu(e)){let d=ef(e);for(;d&&!Km(d);){if(eu(d)&&!SS(d))return d;d=ef(d)}return o}let a=hO(e,t);for(;a&&Cfe(a)&&SS(a);)a=hO(a,t);return a&&Km(a)&&SS(a)&&!aM(a)?o:a||Efe(e)||o}const Nfe=async function(e){const t=this.getOffsetParent||KN,o=this.getDimensions,a=await o(e.floating);return{reference:Ffe(e.reference,await t(e.floating),e.strategy),floating:{x:0,y:0,width:a.width,height:a.height}}};function Bfe(e){return tu(e).direction==="rtl"}const Vfe={convertOffsetParentRelativeRectToViewportRelativeRect:Afe,getDocumentElement:qu,getClippingRect:Dfe,getOffsetParent:KN,getElementRects:Nfe,getClientRects:kfe,getDimensions:zfe,getScale:Am,isElement:eu,isRTL:Bfe};function ZN(e,t){return e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height}function $fe(e,t){let o=null,a;const d=qu(e);function p(){var r;clearTimeout(a),(r=o)==null||r.disconnect(),o=null}function y(r,S){r===void 0&&(r=!1),S===void 0&&(S=1),p();const C=e.getBoundingClientRect(),{left:M,top:P,width:z,height:F}=C;if(r||t(),!z||!F)return;const V=Db(P),N=Db(d.clientWidth-(M+z)),H=Db(d.clientHeight-(P+F)),U=Db(M),Z={rootMargin:-V+"px "+-N+"px "+-H+"px "+-U+"px",threshold:vh(0,Wm(1,S))||1};let q=!0;function J(re){const se=re[0].intersectionRatio;if(se!==S){if(!q)return y();se?y(!1,se):a=setTimeout(()=>{y(!1,1e-7)},1e3)}se===1&&!ZN(C,e.getBoundingClientRect())&&y(),q=!1}try{o=new IntersectionObserver(J,{...Z,root:d.ownerDocument})}catch{o=new IntersectionObserver(J,Z)}o.observe(e)}return y(!0),p}function Ufe(e,t,o,a){a===void 0&&(a={});const{ancestorScroll:d=!0,ancestorResize:p=!0,elementResize:y=typeof ResizeObserver=="function",layoutShift:r=typeof IntersectionObserver=="function",animationFrame:S=!1}=a,C=uM(e),M=d||p?[...C?Ky(C):[],...Ky(t)]:[];M.forEach(U=>{d&&U.addEventListener("scroll",o,{passive:!0}),p&&U.addEventListener("resize",o)});const P=C&&r?$fe(C,o):null;let z=-1,F=null;y&&(F=new ResizeObserver(U=>{let[te]=U;te&&te.target===C&&F&&(F.unobserve(t),cancelAnimationFrame(z),z=requestAnimationFrame(()=>{var Z;(Z=F)==null||Z.observe(t)})),o()}),C&&!S&&F.observe(C),F.observe(t));let V,N=S?Ih(e):null;S&&H();function H(){const U=Ih(e);N&&!ZN(N,U)&&o(),N=U,V=requestAnimationFrame(H)}return o(),()=>{var U;M.forEach(te=>{d&&te.removeEventListener("scroll",o),p&&te.removeEventListener("resize",o)}),P==null||P(),(U=F)==null||U.disconnect(),F=null,S&&cancelAnimationFrame(V)}}const jfe=sM,YN=Sfe,Hfe=Tfe,Gfe=xfe,XN=bfe,JN=(e,t,o)=>{const a=new Map,d={platform:Vfe,...o},p={...d.platform,_c:a};return vfe(e,t,{...d,platform:p})},Wfe=un({style:{type:lt([String,Object,Array]),default:()=>({})}}),qfe=We({name:"ElVisuallyHidden"}),Kfe=We({...qfe,props:Wfe,setup(e){const t=e,o=ee(()=>[t.style,{position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}]);return(a,d)=>(ae(),Pe("span",kr(a.$attrs,{style:b(o)}),[gt(a.$slots,"default")],16))}});var Zfe=dn(Kfe,[["__file","visual-hidden.vue"]]);un({});const Yfe=e=>{if(!Wr)return;if(!e)return e;const t=Qs(e);return t||(Ti(e)?t:e)},Xfe=({middleware:e,placement:t,strategy:o})=>{const a=xe(),d=xe(),p=xe(),y=xe(),r=xe({}),S={x:p,y,placement:t,strategy:o,middlewareData:r},C=async()=>{if(!Wr)return;const M=Yfe(a),P=Qs(d);if(!M||!P)return;const z=await JN(M,P,{placement:b(t),strategy:b(o),middleware:b(e)});zm(S).forEach(F=>{S[F].value=z[F]})};return yr(()=>{gs(()=>{C()})}),{...S,update:C,referenceRef:a,contentRef:d}},Jfe=({arrowRef:e,padding:t})=>({name:"arrow",options:{element:e,padding:t},fn(o){const a=b(e);return a?XN({element:a,padding:t}).fn(o):{}}}),Qfe=We({name:"ElTooltipV2Content"}),ehe=We({...Qfe,props:{...tM,...FN},setup(e){const t=e,{triggerRef:o,contentId:a}=Pn(Ax),d=xe(t.placement),p=xe(t.strategy),y=xe(null),{referenceRef:r,contentRef:S,middlewareData:C,x:M,y:P,update:z}=Xfe({placement:d,strategy:p,middleware:ee(()=>{const Z=[YN(t.offset)];return t.showArrow&&Z.push(Jfe({arrowRef:y})),Z})}),F=og().nextZIndex(),V=Xt("tooltip-v2"),N=ee(()=>d.value.split("-")[0]),H=ee(()=>({position:b(p),top:`${b(P)||0}px`,left:`${b(M)||0}px`,zIndex:F})),U=ee(()=>{if(!t.showArrow)return{};const{arrow:Z}=b(C);return{[`--${V.namespace.value}-tooltip-v2-arrow-x`]:`${Z==null?void 0:Z.x}px`||"",[`--${V.namespace.value}-tooltip-v2-arrow-y`]:`${Z==null?void 0:Z.y}px`||""}}),te=ee(()=>[V.e("content"),V.is("dark",t.effect==="dark"),V.is(b(p)),t.contentClass]);return Wt(y,()=>z()),Wt(()=>t.placement,Z=>d.value=Z),yr(()=>{Wt(()=>t.reference||o.value,Z=>{r.value=Z||void 0},{immediate:!0})}),Vr(BN,{arrowRef:y}),(Z,q)=>(ae(),Pe("div",{ref_key:"contentRef",ref:S,style:Un(b(H)),"data-tooltip-v2-root":""},[Z.nowrap?bt("v-if",!0):(ae(),Pe("div",{key:0,"data-side":b(N),class:fe(b(te))},[gt(Z.$slots,"default",{contentStyle:b(H),contentClass:b(te)}),qe(b(Zfe),{id:b(a),role:"tooltip"},{default:ot(()=>[Z.ariaLabel?(ae(),Pe(Vn,{key:0},[Nr(fn(Z.ariaLabel),1)],64)):gt(Z.$slots,"default",{key:1})]),_:3},8,["id"]),gt(Z.$slots,"arrow",{style:Un(b(U)),side:b(N)})],10,["data-side"]))],4))}});var pO=dn(ehe,[["__file","content.vue"]]);const the=un({setRef:{type:lt(Function),required:!0},onlyChild:Boolean});var nhe=We({props:the,setup(e,{slots:t}){const o=xe(),a=Tx(o,d=>{d?e.setRef(d.nextElementSibling):e.setRef(null)});return()=>{var d;const[p]=((d=t.default)==null?void 0:d.call(t))||[],y=e.onlyChild?MJ(p.children):p.children;return qe(Vn,{ref:a},[y])}}});const rhe=We({name:"ElTooltipV2Trigger"}),ihe=We({...rhe,props:{...FN,...rM},setup(e){const t=e,{onClose:o,onOpen:a,onDelayOpen:d,triggerRef:p,contentId:y}=Pn(Ax);let r=!1;const S=te=>{p.value=te},C=()=>{r=!1},M=go(t.onMouseEnter,d),P=go(t.onMouseLeave,o),z=go(t.onMouseDown,()=>{o(),r=!0,document.addEventListener("mouseup",C,{once:!0})}),F=go(t.onFocus,()=>{r||a()}),V=go(t.onBlur,o),N=go(t.onClick,te=>{te.detail===0&&o()}),H={blur:V,click:N,focus:F,mousedown:z,mouseenter:M,mouseleave:P},U=(te,Z,q)=>{te&&Object.entries(Z).forEach(([J,re])=>{te[q](J,re)})};return Wt(p,(te,Z)=>{U(te,H,"addEventListener"),U(Z,H,"removeEventListener"),te&&te.setAttribute("aria-describedby",y.value)}),Li(()=>{U(p.value,H,"removeEventListener"),document.removeEventListener("mouseup",C)}),(te,Z)=>te.nowrap?(ae(),At(b(nhe),{key:0,"set-ref":S,"only-child":""},{default:ot(()=>[gt(te.$slots,"default")]),_:3})):(ae(),Pe("button",kr({key:1,ref_key:"triggerRef",ref:p},te.$attrs),[gt(te.$slots,"default")],16))}});var ohe=dn(ihe,[["__file","trigger.vue"]]);const she=We({name:"ElTooltipV2"}),ahe=We({...she,props:sfe,setup(e){const o=Go(e),a=si(Wl(o,Object.keys(eM))),d=si(Wl(o,Object.keys(tM))),p=si(Wl(o,Object.keys(nM))),y=si(Wl(o,Object.keys(rM)));return(r,S)=>(ae(),At(ufe,Gl(Wd(p)),{default:ot(({open:C})=>[qe(ohe,kr(y,{nowrap:""}),{default:ot(()=>[gt(r.$slots,"trigger")]),_:3},16),qe(b(lg),{to:r.to,disabled:!r.teleported},{default:ot(()=>[r.fullTransition?(ae(),At(rs,Gl(kr({key:0},r.transitionProps)),{default:ot(()=>[r.alwaysOn||C?(ae(),At(pO,Gl(kr({key:0},d)),{arrow:ot(({style:M,side:P})=>[r.showArrow?(ae(),At(uO,kr({key:0},a,{style:M,side:P}),null,16,["style","side"])):bt("v-if",!0)]),default:ot(()=>[gt(r.$slots,"default")]),_:3},16)):bt("v-if",!0)]),_:2},1040)):(ae(),Pe(Vn,{key:1},[r.alwaysOn||C?(ae(),At(pO,Gl(kr({key:0},d)),{arrow:ot(({style:M,side:P})=>[r.showArrow?(ae(),At(uO,kr({key:0},a,{style:M,side:P}),null,16,["style","side"])):bt("v-if",!0)]),default:ot(()=>[gt(r.$slots,"default")]),_:3},16)):bt("v-if",!0)],64))]),_:2},1032,["to","disabled"])]),_:3},16))}});var lhe=dn(ahe,[["__file","tooltip.vue"]]);const uhe=lr(lhe),QN="left-check-change",eB="right-check-change",gm=un({data:{type:lt(Array),default:()=>[]},titles:{type:lt(Array),default:()=>[]},buttonTexts:{type:lt(Array),default:()=>[]},filterPlaceholder:String,filterMethod:{type:lt(Function)},leftDefaultChecked:{type:lt(Array),default:()=>[]},rightDefaultChecked:{type:lt(Array),default:()=>[]},renderContent:{type:lt(Function)},modelValue:{type:lt(Array),default:()=>[]},format:{type:lt(Object),default:()=>({})},filterable:Boolean,props:{type:lt(Object),default:()=>io({label:"label",key:"key",disabled:"disabled"})},targetOrder:{type:String,values:["original","push","unshift"],default:"original"},validateEvent:{type:Boolean,default:!0}}),HT=(e,t)=>[e,t].every(sn)||sn(e)&&Ho(t),che={[Ii]:(e,t,o)=>[e,o].every(sn)&&["left","right"].includes(t),[gr]:e=>sn(e),[QN]:HT,[eB]:HT},GT="checked-change",dhe=un({data:gm.data,optionRender:{type:lt(Function)},placeholder:String,title:String,filterable:Boolean,format:gm.format,filterMethod:gm.filterMethod,defaultChecked:gm.leftDefaultChecked,props:gm.props}),fhe={[GT]:HT},yv=e=>{const t={label:"label",key:"key",disabled:"disabled"};return ee(()=>({...t,...e.props}))},hhe=(e,t,o)=>{const a=yv(e),d=ee(()=>e.data.filter(M=>$n(e.filterMethod)?e.filterMethod(t.query,M):String(M[a.value.label]||M[a.value.key]).toLowerCase().includes(t.query.toLowerCase()))),p=ee(()=>d.value.filter(M=>!M[a.value.disabled])),y=ee(()=>{const M=t.checked.length,P=e.data.length,{noChecked:z,hasChecked:F}=e.format;return z&&F?M>0?F.replace(/\${checked}/g,M.toString()).replace(/\${total}/g,P.toString()):z.replace(/\${total}/g,P.toString()):`${M}/${P}`}),r=ee(()=>{const M=t.checked.length;return M>0&&M<p.value.length}),S=()=>{const M=p.value.map(P=>P[a.value.key]);t.allChecked=M.length>0&&M.every(P=>t.checked.includes(P))},C=M=>{t.checked=M?p.value.map(P=>P[a.value.key]):[]};return Wt(()=>t.checked,(M,P)=>{if(S(),t.checkChangeByUser){const z=M.concat(P).filter(F=>!M.includes(F)||!P.includes(F));o(GT,M,z)}else o(GT,M),t.checkChangeByUser=!0}),Wt(p,()=>{S()}),Wt(()=>e.data,()=>{const M=[],P=d.value.map(z=>z[a.value.key]);t.checked.forEach(z=>{P.includes(z)&&M.push(z)}),t.checkChangeByUser=!1,t.checked=M}),Wt(()=>e.defaultChecked,(M,P)=>{if(P&&M.length===P.length&&M.every(V=>P.includes(V)))return;const z=[],F=p.value.map(V=>V[a.value.key]);M.forEach(V=>{F.includes(V)&&z.push(V)}),t.checkChangeByUser=!1,t.checked=z},{immediate:!0}),{filteredData:d,checkableData:p,checkedSummary:y,isIndeterminate:r,updateAllChecked:S,handleAllCheckedChange:C}},phe=We({name:"ElTransferPanel"}),mhe=We({...phe,props:dhe,emits:fhe,setup(e,{expose:t,emit:o}){const a=e,d=Bo(),p=({option:Z})=>Z,{t:y}=qr(),r=Xt("transfer"),S=si({checked:[],allChecked:!1,query:"",checkChangeByUser:!0}),C=yv(a),{filteredData:M,checkedSummary:P,isIndeterminate:z,handleAllCheckedChange:F}=hhe(a,S,o),V=ee(()=>!$a(S.query)&&$a(M.value)),N=ee(()=>!$a(d.default()[0].children)),{checked:H,allChecked:U,query:te}=Go(S);return t({query:te}),(Z,q)=>(ae(),Pe("div",{class:fe(b(r).b("panel"))},[Ue("p",{class:fe(b(r).be("panel","header"))},[qe(b(pl),{modelValue:b(U),"onUpdate:modelValue":J=>Ti(U)?U.value=J:null,indeterminate:b(z),"validate-event":!1,onChange:b(F)},{default:ot(()=>[Nr(fn(Z.title)+" ",1),Ue("span",null,fn(b(P)),1)]),_:1},8,["modelValue","onUpdate:modelValue","indeterminate","onChange"])],2),Ue("div",{class:fe([b(r).be("panel","body"),b(r).is("with-footer",b(N))])},[Z.filterable?(ae(),At(b(Bs),{key:0,modelValue:b(te),"onUpdate:modelValue":J=>Ti(te)?te.value=J:null,class:fe(b(r).be("panel","filter")),size:"default",placeholder:Z.placeholder,"prefix-icon":b(B7),clearable:"","validate-event":!1},null,8,["modelValue","onUpdate:modelValue","class","placeholder","prefix-icon"])):bt("v-if",!0),hr(qe(b(M4),{modelValue:b(H),"onUpdate:modelValue":J=>Ti(H)?H.value=J:null,"validate-event":!1,class:fe([b(r).is("filterable",Z.filterable),b(r).be("panel","list")])},{default:ot(()=>[(ae(!0),Pe(Vn,null,Fr(b(M),J=>(ae(),At(b(pl),{key:J[b(C).key],class:fe(b(r).be("panel","item")),value:J[b(C).key],disabled:J[b(C).disabled],"validate-event":!1},{default:ot(()=>{var re;return[qe(p,{option:(re=Z.optionRender)==null?void 0:re.call(Z,J)},null,8,["option"])]}),_:2},1032,["class","value","disabled"]))),128))]),_:1},8,["modelValue","onUpdate:modelValue","class"]),[[ii,!b(V)&&!b($a)(Z.data)]]),hr(Ue("div",{class:fe(b(r).be("panel","empty"))},[gt(Z.$slots,"empty",{},()=>[Nr(fn(b(V)?b(y)("el.transfer.noMatch"):b(y)("el.transfer.noData")),1)])],2),[[ii,b(V)||b($a)(Z.data)]])],2),b(N)?(ae(),Pe("p",{key:0,class:fe(b(r).be("panel","footer"))},[gt(Z.$slots,"default")],2)):bt("v-if",!0)],2))}});var mO=dn(mhe,[["__file","transfer-panel.vue"]]);const ghe=e=>{const t=yv(e),o=ee(()=>e.data.reduce((p,y)=>(p[y[t.value.key]]=y)&&p,{})),a=ee(()=>e.data.filter(p=>!e.modelValue.includes(p[t.value.key]))),d=ee(()=>e.targetOrder==="original"?e.data.filter(p=>e.modelValue.includes(p[t.value.key])):e.modelValue.reduce((p,y)=>{const r=o.value[y];return r&&p.push(r),p},[]));return{sourceData:a,targetData:d}},_he=(e,t,o)=>{const a=yv(e),d=(r,S,C)=>{o(gr,r),o(Ii,r,S,C)};return{addToLeft:()=>{const r=e.modelValue.slice();t.rightChecked.forEach(S=>{const C=r.indexOf(S);C>-1&&r.splice(C,1)}),d(r,"left",t.rightChecked)},addToRight:()=>{let r=e.modelValue.slice();const S=e.data.filter(C=>{const M=C[a.value.key];return t.leftChecked.includes(M)&&!e.modelValue.includes(M)}).map(C=>C[a.value.key]);r=e.targetOrder==="unshift"?S.concat(r):r.concat(S),e.targetOrder==="original"&&(r=e.data.filter(C=>r.includes(C[a.value.key])).map(C=>C[a.value.key])),d(r,"right",t.leftChecked)}}},yhe=(e,t)=>({onSourceCheckedChange:(d,p)=>{e.leftChecked=d,p&&t(QN,d,p)},onTargetCheckedChange:(d,p)=>{e.rightChecked=d,p&&t(eB,d,p)}}),vhe=We({name:"ElTransfer"}),bhe=We({...vhe,props:gm,emits:che,setup(e,{expose:t,emit:o}){const a=e,d=Bo(),{t:p}=qr(),y=Xt("transfer"),{formItem:r}=xs(),S=si({leftChecked:[],rightChecked:[]}),C=yv(a),{sourceData:M,targetData:P}=ghe(a),{onSourceCheckedChange:z,onTargetCheckedChange:F}=yhe(S,o),{addToLeft:V,addToRight:N}=_he(a,S,o),H=xe(),U=xe(),te=he=>{switch(he){case"left":H.value.query="";break;case"right":U.value.query="";break}},Z=ee(()=>a.buttonTexts.length===2),q=ee(()=>a.titles[0]||p("el.transfer.titles.0")),J=ee(()=>a.titles[1]||p("el.transfer.titles.1")),re=ee(()=>a.filterPlaceholder||p("el.transfer.filterPlaceholder"));Wt(()=>a.modelValue,()=>{var he;a.validateEvent&&((he=r==null?void 0:r.validate)==null||he.call(r,"change").catch(le=>void 0))});const se=ee(()=>he=>{var le;if(a.renderContent)return a.renderContent(Zn,he);const ce=(((le=d.default)==null?void 0:le.call(d,{option:he}))||[]).filter(pe=>pe.type!==Qo);return ce.length?ce:Zn("span",he[C.value.label]||he[C.value.key])});return t({clearQuery:te,leftPanel:H,rightPanel:U}),(he,le)=>(ae(),Pe("div",{class:fe(b(y).b())},[qe(mO,{ref_key:"leftPanel",ref:H,data:b(M),"option-render":b(se),placeholder:b(re),title:b(q),filterable:he.filterable,format:he.format,"filter-method":he.filterMethod,"default-checked":he.leftDefaultChecked,props:a.props,onCheckedChange:b(z)},{empty:ot(()=>[gt(he.$slots,"left-empty")]),default:ot(()=>[gt(he.$slots,"left-footer")]),_:3},8,["data","option-render","placeholder","title","filterable","format","filter-method","default-checked","props","onCheckedChange"]),Ue("div",{class:fe(b(y).e("buttons"))},[qe(b(ts),{type:"primary",class:fe([b(y).e("button"),b(y).is("with-texts",b(Z))]),disabled:b($a)(S.rightChecked),onClick:b(V)},{default:ot(()=>[qe(b(zn),null,{default:ot(()=>[qe(b(Yd))]),_:1}),b(ai)(he.buttonTexts[0])?bt("v-if",!0):(ae(),Pe("span",{key:0},fn(he.buttonTexts[0]),1))]),_:1},8,["class","disabled","onClick"]),qe(b(ts),{type:"primary",class:fe([b(y).e("button"),b(y).is("with-texts",b(Z))]),disabled:b($a)(S.leftChecked),onClick:b(N)},{default:ot(()=>[b(ai)(he.buttonTexts[1])?bt("v-if",!0):(ae(),Pe("span",{key:0},fn(he.buttonTexts[1]),1)),qe(b(zn),null,{default:ot(()=>[qe(b(ta))]),_:1})]),_:1},8,["class","disabled","onClick"])],2),qe(mO,{ref_key:"rightPanel",ref:U,data:b(P),"option-render":b(se),placeholder:b(re),filterable:he.filterable,format:he.format,"filter-method":he.filterMethod,title:b(J),"default-checked":he.rightDefaultChecked,props:a.props,onCheckedChange:b(F)},{empty:ot(()=>[gt(he.$slots,"right-empty")]),default:ot(()=>[gt(he.$slots,"right-footer")]),_:3},8,["data","option-render","placeholder","filterable","format","filter-method","title","default-checked","props","onCheckedChange"])],2))}});var xhe=dn(bhe,[["__file","transfer.vue"]]);const whe=lr(xhe),km="$treeNodeId",gO=function(e,t){!t||t[km]||Object.defineProperty(t,km,{value:e.id,enumerable:!1,configurable:!1,writable:!1})},dM=function(e,t){return e?t[e]:t[km]},WT=(e,t,o)=>{const a=e.value.currentNode;o();const d=e.value.currentNode;a!==d&&t("current-change",d?d.data:null,d)},qT=e=>{let t=!0,o=!0,a=!0;for(let d=0,p=e.length;d<p;d++){const y=e[d];(y.checked!==!0||y.indeterminate)&&(t=!1,y.disabled||(a=!1)),(y.checked!==!1||y.indeterminate)&&(o=!1)}return{all:t,none:o,allWithoutDisable:a,half:!t&&!o}},ry=function(e){if(e.childNodes.length===0||e.loading)return;const{all:t,none:o,half:a}=qT(e.childNodes);t?(e.checked=!0,e.indeterminate=!1):a?(e.checked=!1,e.indeterminate=!0):o&&(e.checked=!1,e.indeterminate=!1);const d=e.parent;!d||d.level===0||e.store.checkStrictly||ry(d)},zb=function(e,t){const o=e.store.props,a=e.data||{},d=o[t];if($n(d))return d(a,e);if(Nn(d))return a[d];if(ai(d)){const p=a[t];return p===void 0?"":p}};let She=0,KT=class o1{constructor(t){this.id=She++,this.text=null,this.checked=!1,this.indeterminate=!1,this.data=null,this.expanded=!1,this.parent=null,this.visible=!0,this.isCurrent=!1,this.canFocus=!1;for(const o in t)ri(t,o)&&(this[o]=t[o]);this.level=0,this.loaded=!1,this.childNodes=[],this.loading=!1,this.parent&&(this.level=this.parent.level+1)}initialize(){const t=this.store;if(!t)throw new Error("[Node]store is required!");t.registerNode(this);const o=t.props;if(o&&typeof o.isLeaf<"u"){const p=zb(this,"isLeaf");Oi(p)&&(this.isLeafByUser=p)}if(t.lazy!==!0&&this.data?(this.setData(this.data),t.defaultExpandAll&&(this.expanded=!0,this.canFocus=!0)):this.level>0&&t.lazy&&t.defaultExpandAll&&!this.isLeafByUser&&this.expand(),sn(this.data)||gO(this,this.data),!this.data)return;const a=t.defaultExpandedKeys,d=t.key;d&&a&&a.includes(this.key)&&this.expand(null,t.autoExpandParent),d&&t.currentNodeKey!==void 0&&this.key===t.currentNodeKey&&(t.currentNode=this,t.currentNode.isCurrent=!0),t.lazy&&t._initDefaultCheckedNode(this),this.updateLeafState(),this.parent&&(this.level===1||this.parent.expanded===!0)&&(this.canFocus=!0)}setData(t){sn(t)||gO(this,t),this.data=t,this.childNodes=[];let o;this.level===0&&sn(this.data)?o=this.data:o=zb(this,"children")||[];for(let a=0,d=o.length;a<d;a++)this.insertChild({data:o[a]})}get label(){return zb(this,"label")}get key(){const t=this.store.key;return this.data?this.data[t]:null}get disabled(){return zb(this,"disabled")}get nextSibling(){const t=this.parent;if(t){const o=t.childNodes.indexOf(this);if(o>-1)return t.childNodes[o+1]}return null}get previousSibling(){const t=this.parent;if(t){const o=t.childNodes.indexOf(this);if(o>-1)return o>0?t.childNodes[o-1]:null}return null}contains(t,o=!0){return(this.childNodes||[]).some(a=>a===t||o&&a.contains(t))}remove(){const t=this.parent;t&&t.removeChild(this)}insertChild(t,o,a){if(!t)throw new Error("InsertChild error: child is required.");if(!(t instanceof o1)){if(!a){const d=this.getChildren(!0);d.includes(t.data)||(ai(o)||o<0?d.push(t.data):d.splice(o,0,t.data))}Object.assign(t,{parent:this,store:this.store}),t=si(new o1(t)),t instanceof o1&&t.initialize()}t.level=this.level+1,ai(o)||o<0?this.childNodes.push(t):this.childNodes.splice(o,0,t),this.updateLeafState()}insertBefore(t,o){let a;o&&(a=this.childNodes.indexOf(o)),this.insertChild(t,a)}insertAfter(t,o){let a;o&&(a=this.childNodes.indexOf(o),a!==-1&&(a+=1)),this.insertChild(t,a)}removeChild(t){const o=this.getChildren()||[],a=o.indexOf(t.data);a>-1&&o.splice(a,1);const d=this.childNodes.indexOf(t);d>-1&&(this.store&&this.store.deregisterNode(t),t.parent=null,this.childNodes.splice(d,1)),this.updateLeafState()}removeChildByData(t){let o=null;for(let a=0;a<this.childNodes.length;a++)if(this.childNodes[a].data===t){o=this.childNodes[a];break}o&&this.removeChild(o)}expand(t,o){const a=()=>{if(o){let d=this.parent;for(;d.level>0;)d.expanded=!0,d=d.parent}this.expanded=!0,t&&t(),this.childNodes.forEach(d=>{d.canFocus=!0})};this.shouldLoadData()?this.loadData(d=>{sn(d)&&(this.checked?this.setChecked(!0,!0):this.store.checkStrictly||ry(this),a())}):a()}doCreateChildren(t,o={}){t.forEach(a=>{this.insertChild(Object.assign({data:a},o),void 0,!0)})}collapse(){this.expanded=!1,this.childNodes.forEach(t=>{t.canFocus=!1})}shouldLoadData(){return this.store.lazy===!0&&this.store.load&&!this.loaded}updateLeafState(){if(this.store.lazy===!0&&this.loaded!==!0&&typeof this.isLeafByUser<"u"){this.isLeaf=this.isLeafByUser;return}const t=this.childNodes;if(!this.store.lazy||this.store.lazy===!0&&this.loaded===!0){this.isLeaf=!t||t.length===0;return}this.isLeaf=!1}setChecked(t,o,a,d){if(this.indeterminate=t==="half",this.checked=t===!0,this.store.checkStrictly)return;if(!(this.shouldLoadData()&&!this.store.checkDescendants)){const{all:y,allWithoutDisable:r}=qT(this.childNodes);!this.isLeaf&&!y&&r&&(this.checked=!1,t=!1);const S=()=>{if(o){const C=this.childNodes;for(let z=0,F=C.length;z<F;z++){const V=C[z];d=d||t!==!1;const N=V.disabled?V.checked:d;V.setChecked(N,o,!0,d)}const{half:M,all:P}=qT(C);P||(this.checked=P,this.indeterminate=M)}};if(this.shouldLoadData()){this.loadData(()=>{S(),ry(this)},{checked:t!==!1});return}else S()}const p=this.parent;!p||p.level===0||a||ry(p)}getChildren(t=!1){if(this.level===0)return this.data;const o=this.data;if(!o)return null;const a=this.store.props;let d="children";return a&&(d=a.children||"children"),o[d]===void 0&&(o[d]=null),t&&!o[d]&&(o[d]=[]),o[d]}updateChildren(){const t=this.getChildren()||[],o=this.childNodes.map(p=>p.data),a={},d=[];t.forEach((p,y)=>{const r=p[km];!!r&&o.findIndex(C=>C[km]===r)>=0?a[r]={index:y,data:p}:d.push({index:y,data:p})}),this.store.lazy||o.forEach(p=>{a[p[km]]||this.removeChildByData(p)}),d.forEach(({index:p,data:y})=>{this.insertChild({data:y},p)}),this.updateLeafState()}loadData(t,o={}){if(this.store.lazy===!0&&this.store.load&&!this.loaded&&(!this.loading||Object.keys(o).length)){this.loading=!0;const a=p=>{this.childNodes=[],this.doCreateChildren(p,o),this.loaded=!0,this.loading=!1,this.updateLeafState(),t&&t.call(this,p)},d=()=>{this.loading=!1};this.store.load(this,a,d)}else t&&t.call(this)}eachNode(t){const o=[this];for(;o.length;){const a=o.shift();o.unshift(...a.childNodes),t(a)}}reInitChecked(){this.store.checkStrictly||ry(this)}};class The{constructor(t){this.currentNode=null,this.currentNodeKey=null;for(const o in t)ri(t,o)&&(this[o]=t[o]);this.nodesMap={}}initialize(){if(this.root=new KT({data:this.data,store:this}),this.root.initialize(),this.lazy&&this.load){const t=this.load;t(this.root,o=>{this.root.doCreateChildren(o),this._initDefaultCheckedNodes()})}else this._initDefaultCheckedNodes()}filter(t){const o=this.filterNodeMethod,a=this.lazy,d=function(p){const y=p.root?p.root.childNodes:p.childNodes;if(y.forEach(r=>{r.visible=o.call(r,t,r.data,r),d(r)}),!p.visible&&y.length){let r=!0;r=!y.some(S=>S.visible),p.root?p.root.visible=r===!1:p.visible=r===!1}t&&p.visible&&!p.isLeaf&&(!a||p.loaded)&&p.expand()};d(this)}setData(t){t!==this.root.data?(this.nodesMap={},this.root.setData(t),this._initDefaultCheckedNodes(),this.setCurrentNodeKey(this.currentNodeKey)):this.root.updateChildren()}getNode(t){if(t instanceof KT)return t;const o=xr(t)?dM(this.key,t):t;return this.nodesMap[o]||null}insertBefore(t,o){const a=this.getNode(o);a.parent.insertBefore({data:t},a)}insertAfter(t,o){const a=this.getNode(o);a.parent.insertAfter({data:t},a)}remove(t){const o=this.getNode(t);o&&o.parent&&(o===this.currentNode&&(this.currentNode=null),o.parent.removeChild(o))}append(t,o){const a=Yl(o)?this.root:this.getNode(o);a&&a.insertChild({data:t})}_initDefaultCheckedNodes(){const t=this.defaultCheckedKeys||[],o=this.nodesMap;t.forEach(a=>{const d=o[a];d&&d.setChecked(!0,!this.checkStrictly)})}_initDefaultCheckedNode(t){(this.defaultCheckedKeys||[]).includes(t.key)&&t.setChecked(!0,!this.checkStrictly)}setDefaultCheckedKey(t){t!==this.defaultCheckedKeys&&(this.defaultCheckedKeys=t,this._initDefaultCheckedNodes())}registerNode(t){const o=this.key;!t||!t.data||(o?t.key!==void 0&&(this.nodesMap[t.key]=t):this.nodesMap[t.id]=t)}deregisterNode(t){!this.key||!t||!t.data||(t.childNodes.forEach(a=>{this.deregisterNode(a)}),delete this.nodesMap[t.key])}getCheckedNodes(t=!1,o=!1){const a=[],d=function(p){(p.root?p.root.childNodes:p.childNodes).forEach(r=>{(r.checked||o&&r.indeterminate)&&(!t||t&&r.isLeaf)&&a.push(r.data),d(r)})};return d(this),a}getCheckedKeys(t=!1){return this.getCheckedNodes(t).map(o=>(o||{})[this.key])}getHalfCheckedNodes(){const t=[],o=function(a){(a.root?a.root.childNodes:a.childNodes).forEach(p=>{p.indeterminate&&t.push(p.data),o(p)})};return o(this),t}getHalfCheckedKeys(){return this.getHalfCheckedNodes().map(t=>(t||{})[this.key])}_getAllNodes(){const t=[],o=this.nodesMap;for(const a in o)ri(o,a)&&t.push(o[a]);return t}updateChildren(t,o){const a=this.nodesMap[t];if(!a)return;const d=a.childNodes;for(let p=d.length-1;p>=0;p--){const y=d[p];this.remove(y.data)}for(let p=0,y=o.length;p<y;p++){const r=o[p];this.append(r,a.data)}}_setCheckedKeys(t,o=!1,a){const d=this._getAllNodes().sort((S,C)=>S.level-C.level),p=Object.create(null),y=Object.keys(a);d.forEach(S=>S.setChecked(!1,!1));const r=S=>{S.childNodes.forEach(C=>{var M;p[C.data[t]]=!0,(M=C.childNodes)!=null&&M.length&&r(C)})};for(let S=0,C=d.length;S<C;S++){const M=d[S],P=M.data[t].toString();if(!y.includes(P)){M.checked&&!p[P]&&M.setChecked(!1,!1);continue}if(M.childNodes.length&&r(M),M.isLeaf||this.checkStrictly){M.setChecked(!0,!1);continue}if(M.setChecked(!0,!0),o){M.setChecked(!1,!1);const F=function(V){V.childNodes.forEach(H=>{H.isLeaf||H.setChecked(!1,!1),F(H)})};F(M)}}}setCheckedNodes(t,o=!1){const a=this.key,d={};t.forEach(p=>{d[(p||{})[a]]=!0}),this._setCheckedKeys(a,o,d)}setCheckedKeys(t,o=!1){this.defaultCheckedKeys=t;const a=this.key,d={};t.forEach(p=>{d[p]=!0}),this._setCheckedKeys(a,o,d)}setDefaultExpandedKeys(t){t=t||[],this.defaultExpandedKeys=t,t.forEach(o=>{const a=this.getNode(o);a&&a.expand(null,this.autoExpandParent)})}setChecked(t,o,a){const d=this.getNode(t);d&&d.setChecked(!!o,a)}getCurrentNode(){return this.currentNode}setCurrentNode(t){const o=this.currentNode;o&&(o.isCurrent=!1),this.currentNode=t,this.currentNode.isCurrent=!0}setUserCurrentNode(t,o=!0){const a=t[this.key],d=this.nodesMap[a];this.setCurrentNode(d),o&&this.currentNode.level>1&&this.currentNode.parent.expand(null,!0)}setCurrentNodeKey(t,o=!0){if(this.currentNodeKey=t,t==null){this.currentNode&&(this.currentNode.isCurrent=!1),this.currentNode=null;return}const a=this.getNode(t);a&&(this.setCurrentNode(a),o&&this.currentNode.level>1&&this.currentNode.parent.expand(null,!0))}}const Che=We({name:"ElTreeNodeContent",props:{node:{type:Object,required:!0},renderContent:Function},setup(e){const t=Xt("tree"),o=Pn("NodeInstance"),a=Pn("RootTree");return()=>{const d=e.node,{data:p,store:y}=d;return e.renderContent?e.renderContent(Zn,{_self:o,node:d,data:p,store:y}):gt(a.ctx.slots,"default",{node:d,data:p},()=>[Zn("span",{class:t.be("node","label")},[d.label])])}}});var Ehe=dn(Che,[["__file","tree-node-content.vue"]]);function tB(e){const t=Pn("TreeNodeMap",null),o={treeNodeExpand:a=>{e.node!==a&&e.node.collapse()},children:[]};return t&&t.children.push(o),Vr("TreeNodeMap",o),{broadcastExpanded:a=>{if(e.accordion)for(const d of o.children)d.treeNodeExpand(a)}}}const nB=Symbol("dragEvents");function Mhe({props:e,ctx:t,el$:o,dropIndicator$:a,store:d}){const p=Xt("tree"),y=xe({showDropIndicator:!1,draggingNode:null,dropNode:null,allowDrop:!0,dropType:null});return Vr(nB,{treeNodeDragStart:({event:M,treeNode:P})=>{if($n(e.allowDrag)&&!e.allowDrag(P.node))return M.preventDefault(),!1;M.dataTransfer.effectAllowed="move";try{M.dataTransfer.setData("text/plain","")}catch{}y.value.draggingNode=P,t.emit("node-drag-start",P.node,M)},treeNodeDragOver:({event:M,treeNode:P})=>{const z=P,F=y.value.dropNode;F&&F.node.id!==z.node.id&&Vs(F.$el,p.is("drop-inner"));const V=y.value.draggingNode;if(!V||!z)return;let N=!0,H=!0,U=!0,te=!0;$n(e.allowDrop)&&(N=e.allowDrop(V.node,z.node,"prev"),te=H=e.allowDrop(V.node,z.node,"inner"),U=e.allowDrop(V.node,z.node,"next")),M.dataTransfer.dropEffect=H||N||U?"move":"none",(N||H||U)&&(F==null?void 0:F.node.id)!==z.node.id&&(F&&t.emit("node-drag-leave",V.node,F.node,M),t.emit("node-drag-enter",V.node,z.node,M)),N||H||U?y.value.dropNode=z:y.value.dropNode=null,z.node.nextSibling===V.node&&(U=!1),z.node.previousSibling===V.node&&(N=!1),z.node.contains(V.node,!1)&&(H=!1),(V.node===z.node||V.node.contains(z.node))&&(N=!1,H=!1,U=!1);const Z=z.$el.querySelector(`.${p.be("node","content")}`).getBoundingClientRect(),q=o.value.getBoundingClientRect();let J;const re=N?H?.25:U?.45:1:-1,se=U?H?.75:N?.55:0:1;let he=-9999;const le=M.clientY-Z.top;le<Z.height*re?J="before":le>Z.height*se?J="after":H?J="inner":J="none";const ce=z.$el.querySelector(`.${p.be("node","expand-icon")}`).getBoundingClientRect(),pe=a.value;J==="before"?he=ce.top-q.top:J==="after"&&(he=ce.bottom-q.top),pe.style.top=`${he}px`,pe.style.left=`${ce.right-q.left}px`,J==="inner"?ol(z.$el,p.is("drop-inner")):Vs(z.$el,p.is("drop-inner")),y.value.showDropIndicator=J==="before"||J==="after",y.value.allowDrop=y.value.showDropIndicator||te,y.value.dropType=J,t.emit("node-drag-over",V.node,z.node,M)},treeNodeDragEnd:M=>{const{draggingNode:P,dropType:z,dropNode:F}=y.value;if(M.preventDefault(),M.dataTransfer&&(M.dataTransfer.dropEffect="move"),P&&F){const V={data:P.node.data};z!=="none"&&P.node.remove(),z==="before"?F.node.parent.insertBefore(V,F.node):z==="after"?F.node.parent.insertAfter(V,F.node):z==="inner"&&F.node.insertChild(V),z!=="none"&&(d.value.registerNode(V),d.value.key&&P.node.eachNode(N=>{var H;(H=d.value.nodesMap[N.data[d.value.key]])==null||H.setChecked(N.checked,!d.value.checkStrictly)})),Vs(F.$el,p.is("drop-inner")),t.emit("node-drag-end",P.node,F.node,z,M),z!=="none"&&t.emit("node-drop",P.node,F.node,z,M)}P&&!F&&t.emit("node-drag-end",P.node,null,z,M),y.value.showDropIndicator=!1,y.value.draggingNode=null,y.value.dropNode=null,y.value.allowDrop=!0}}),{dragState:y}}const Ihe=We({name:"ElTreeNode",components:{ElCollapseTransition:wx,ElCheckbox:pl,NodeContent:Ehe,ElIcon:zn,Loading:Fu},props:{node:{type:KT,default:()=>({})},props:{type:Object,default:()=>({})},accordion:Boolean,renderContent:Function,renderAfterExpand:Boolean,showCheckbox:{type:Boolean,default:!1}},emits:["node-expand"],setup(e,t){const o=Xt("tree"),{broadcastExpanded:a}=tB(e),d=Pn("RootTree"),p=xe(!1),y=xe(!1),r=xe(null),S=xe(null),C=xe(null),M=Pn(nB),P=Cr();Vr("NodeInstance",P),e.node.expanded&&(p.value=!0,y.value=!0);const z=d.props.props.children||"children";Wt(()=>{const le=e.node.data[z];return le&&[...le]},()=>{e.node.updateChildren()}),Wt(()=>e.node.indeterminate,le=>{N(e.node.checked,le)}),Wt(()=>e.node.checked,le=>{N(le,e.node.indeterminate)}),Wt(()=>e.node.childNodes.length,()=>e.node.reInitChecked()),Wt(()=>e.node.expanded,le=>{jn(()=>p.value=le),le&&(y.value=!0)});const F=le=>dM(d.props.nodeKey,le.data),V=le=>{const ce=e.props.class;if(!ce)return{};let pe;if($n(ce)){const{data:de}=le;pe=ce(de,le)}else pe=ce;return Nn(pe)?{[pe]:!0}:pe},N=(le,ce)=>{(r.value!==le||S.value!==ce)&&d.ctx.emit("check-change",e.node.data,le,ce),r.value=le,S.value=ce},H=le=>{WT(d.store,d.ctx.emit,()=>{var ce;if((ce=d==null?void 0:d.props)==null?void 0:ce.nodeKey){const de=F(e.node);d.store.value.setCurrentNodeKey(de)}else d.store.value.setCurrentNode(e.node)}),d.currentNode.value=e.node,d.props.expandOnClickNode&&te(),d.props.checkOnClickNode&&!e.node.disabled&&Z(null,{target:{checked:!e.node.checked}}),d.ctx.emit("node-click",e.node.data,e.node,P,le)},U=le=>{d.instance.vnode.props.onNodeContextmenu&&(le.stopPropagation(),le.preventDefault()),d.ctx.emit("node-contextmenu",le,e.node.data,e.node,P)},te=()=>{e.node.isLeaf||(p.value?(d.ctx.emit("node-collapse",e.node.data,e.node,P),e.node.collapse()):e.node.expand(()=>{t.emit("node-expand",e.node.data,e.node,P)}))},Z=(le,ce)=>{e.node.setChecked(ce.target.checked,!d.props.checkStrictly),jn(()=>{const pe=d.store.value;d.ctx.emit("check",e.node.data,{checkedNodes:pe.getCheckedNodes(),checkedKeys:pe.getCheckedKeys(),halfCheckedNodes:pe.getHalfCheckedNodes(),halfCheckedKeys:pe.getHalfCheckedKeys()})})};return{ns:o,node$:C,tree:d,expanded:p,childNodeRendered:y,oldChecked:r,oldIndeterminate:S,getNodeKey:F,getNodeClass:V,handleSelectChange:N,handleClick:H,handleContextMenu:U,handleExpandIconClick:te,handleCheckChange:Z,handleChildNodeExpand:(le,ce,pe)=>{a(ce),d.ctx.emit("node-expand",le,ce,pe)},handleDragStart:le=>{d.props.draggable&&M.treeNodeDragStart({event:le,treeNode:e})},handleDragOver:le=>{le.preventDefault(),d.props.draggable&&M.treeNodeDragOver({event:le,treeNode:{$el:C.value,node:e.node}})},handleDrop:le=>{le.preventDefault()},handleDragEnd:le=>{d.props.draggable&&M.treeNodeDragEnd(le)},CaretRight:Iz}}});function Ahe(e,t,o,a,d,p){const y=Er("el-icon"),r=Er("el-checkbox"),S=Er("loading"),C=Er("node-content"),M=Er("el-tree-node"),P=Er("el-collapse-transition");return hr((ae(),Pe("div",{ref:"node$",class:fe([e.ns.b("node"),e.ns.is("expanded",e.expanded),e.ns.is("current",e.node.isCurrent),e.ns.is("hidden",!e.node.visible),e.ns.is("focusable",!e.node.disabled),e.ns.is("checked",!e.node.disabled&&e.node.checked),e.getNodeClass(e.node)]),role:"treeitem",tabindex:"-1","aria-expanded":e.expanded,"aria-disabled":e.node.disabled,"aria-checked":e.node.checked,draggable:e.tree.props.draggable,"data-key":e.getNodeKey(e.node),onClick:Jn(e.handleClick,["stop"]),onContextmenu:e.handleContextMenu,onDragstart:Jn(e.handleDragStart,["stop"]),onDragover:Jn(e.handleDragOver,["stop"]),onDragend:Jn(e.handleDragEnd,["stop"]),onDrop:Jn(e.handleDrop,["stop"])},[Ue("div",{class:fe(e.ns.be("node","content")),style:Un({paddingLeft:(e.node.level-1)*e.tree.props.indent+"px"})},[e.tree.props.icon||e.CaretRight?(ae(),At(y,{key:0,class:fe([e.ns.be("node","expand-icon"),e.ns.is("leaf",e.node.isLeaf),{expanded:!e.node.isLeaf&&e.expanded}]),onClick:Jn(e.handleExpandIconClick,["stop"])},{default:ot(()=>[(ae(),At(Ir(e.tree.props.icon||e.CaretRight)))]),_:1},8,["class","onClick"])):bt("v-if",!0),e.showCheckbox?(ae(),At(r,{key:1,"model-value":e.node.checked,indeterminate:e.node.indeterminate,disabled:!!e.node.disabled,onClick:Jn(()=>{},["stop"]),onChange:e.handleCheckChange},null,8,["model-value","indeterminate","disabled","onClick","onChange"])):bt("v-if",!0),e.node.loading?(ae(),At(y,{key:2,class:fe([e.ns.be("node","loading-icon"),e.ns.is("loading")])},{default:ot(()=>[qe(S)]),_:1},8,["class"])):bt("v-if",!0),qe(C,{node:e.node,"render-content":e.renderContent},null,8,["node","render-content"])],6),qe(P,null,{default:ot(()=>[!e.renderAfterExpand||e.childNodeRendered?hr((ae(),Pe("div",{key:0,class:fe(e.ns.be("node","children")),role:"group","aria-expanded":e.expanded},[(ae(!0),Pe(Vn,null,Fr(e.node.childNodes,z=>(ae(),At(M,{key:e.getNodeKey(z),"render-content":e.renderContent,"render-after-expand":e.renderAfterExpand,"show-checkbox":e.showCheckbox,node:z,accordion:e.accordion,props:e.props,onNodeExpand:e.handleChildNodeExpand},null,8,["render-content","render-after-expand","show-checkbox","node","accordion","props","onNodeExpand"]))),128))],10,["aria-expanded"])),[[ii,e.expanded]]):bt("v-if",!0)]),_:1})],42,["aria-expanded","aria-disabled","aria-checked","draggable","data-key","onClick","onContextmenu","onDragstart","onDragover","onDragend","onDrop"])),[[ii,e.node.visible]])}var khe=dn(Ihe,[["render",Ahe],["__file","tree-node.vue"]]);function Phe({el$:e},t){const o=Xt("tree"),a=Hi([]),d=Hi([]);yr(()=>{y()}),Uu(()=>{a.value=Array.from(e.value.querySelectorAll("[role=treeitem]")),d.value=Array.from(e.value.querySelectorAll("input[type=checkbox]"))}),Wt(d,r=>{r.forEach(S=>{S.setAttribute("tabindex","-1")})}),Si(e,"keydown",r=>{const S=r.target;if(!S.className.includes(o.b("node")))return;const C=r.code;a.value=Array.from(e.value.querySelectorAll(`.${o.is("focusable")}[role=treeitem]`));const M=a.value.indexOf(S);let P;if([Cn.up,Cn.down].includes(C)){if(r.preventDefault(),C===Cn.up){P=M===-1?0:M!==0?M-1:a.value.length-1;const F=P;for(;!t.value.getNode(a.value[P].dataset.key).canFocus;){if(P--,P===F){P=-1;break}P<0&&(P=a.value.length-1)}}else{P=M===-1?0:M<a.value.length-1?M+1:0;const F=P;for(;!t.value.getNode(a.value[P].dataset.key).canFocus;){if(P++,P===F){P=-1;break}P>=a.value.length&&(P=0)}}P!==-1&&a.value[P].focus()}[Cn.left,Cn.right].includes(C)&&(r.preventDefault(),S.click());const z=S.querySelector('[type="checkbox"]');[Cn.enter,Cn.numpadEnter,Cn.space].includes(C)&&z&&(r.preventDefault(),z.click())});const y=()=>{var r;a.value=Array.from(e.value.querySelectorAll(`.${o.is("focusable")}[role=treeitem]`)),d.value=Array.from(e.value.querySelectorAll("input[type=checkbox]"));const S=e.value.querySelectorAll(`.${o.is("checked")}[role=treeitem]`);if(S.length){S[0].setAttribute("tabindex","0");return}(r=a.value[0])==null||r.setAttribute("tabindex","0")}}const Rhe=We({name:"ElTree",components:{ElTreeNode:khe},props:{data:{type:Array,default:()=>[]},emptyText:{type:String},renderAfterExpand:{type:Boolean,default:!0},nodeKey:String,checkStrictly:Boolean,defaultExpandAll:Boolean,expandOnClickNode:{type:Boolean,default:!0},checkOnClickNode:Boolean,checkDescendants:{type:Boolean,default:!1},autoExpandParent:{type:Boolean,default:!0},defaultCheckedKeys:Array,defaultExpandedKeys:Array,currentNodeKey:[String,Number],renderContent:Function,showCheckbox:{type:Boolean,default:!1},draggable:{type:Boolean,default:!1},allowDrag:Function,allowDrop:Function,props:{type:Object,default:()=>({children:"children",label:"label",disabled:"disabled"})},lazy:{type:Boolean,default:!1},highlightCurrent:Boolean,load:Function,filterNodeMethod:Function,accordion:Boolean,indent:{type:Number,default:18},icon:{type:Ai}},emits:["check-change","current-change","node-click","node-contextmenu","node-collapse","node-expand","check","node-drag-start","node-drag-end","node-drop","node-drag-leave","node-drag-enter","node-drag-over"],setup(e,t){const{t:o}=qr(),a=Xt("tree"),d=Pn(cg,null),p=xe(new The({key:e.nodeKey,data:e.data,lazy:e.lazy,props:e.props,load:e.load,currentNodeKey:e.currentNodeKey,checkStrictly:e.checkStrictly,checkDescendants:e.checkDescendants,defaultCheckedKeys:e.defaultCheckedKeys,defaultExpandedKeys:e.defaultExpandedKeys,autoExpandParent:e.autoExpandParent,defaultExpandAll:e.defaultExpandAll,filterNodeMethod:e.filterNodeMethod}));p.value.initialize();const y=xe(p.value.root),r=xe(null),S=xe(null),C=xe(null),{broadcastExpanded:M}=tB(e),{dragState:P}=Mhe({props:e,ctx:t,el$:S,dropIndicator$:C,store:p});Phe({el$:S},p);const z=ee(()=>{const{childNodes:we}=y.value,me=d?d.hasFilteredOptions!==0:!1;return(!we||we.length===0||we.every(({visible:De})=>!De))&&!me});Wt(()=>e.currentNodeKey,we=>{p.value.setCurrentNodeKey(we)}),Wt(()=>e.defaultCheckedKeys,we=>{p.value.setDefaultCheckedKey(we)}),Wt(()=>e.defaultExpandedKeys,we=>{p.value.setDefaultExpandedKeys(we)}),Wt(()=>e.data,we=>{p.value.setData(we)},{deep:!0}),Wt(()=>e.checkStrictly,we=>{p.value.checkStrictly=we});const F=we=>{if(!e.filterNodeMethod)throw new Error("[Tree] filterNodeMethod is required when filter");p.value.filter(we)},V=we=>dM(e.nodeKey,we.data),N=we=>{if(!e.nodeKey)throw new Error("[Tree] nodeKey is required in getNodePath");const me=p.value.getNode(we);if(!me)return[];const De=[me.data];let Ge=me.parent;for(;Ge&&Ge!==y.value;)De.push(Ge.data),Ge=Ge.parent;return De.reverse()},H=(we,me)=>p.value.getCheckedNodes(we,me),U=we=>p.value.getCheckedKeys(we),te=()=>{const we=p.value.getCurrentNode();return we?we.data:null},Z=()=>{if(!e.nodeKey)throw new Error("[Tree] nodeKey is required in getCurrentKey");const we=te();return we?we[e.nodeKey]:null},q=(we,me)=>{if(!e.nodeKey)throw new Error("[Tree] nodeKey is required in setCheckedNodes");p.value.setCheckedNodes(we,me)},J=(we,me)=>{if(!e.nodeKey)throw new Error("[Tree] nodeKey is required in setCheckedKeys");p.value.setCheckedKeys(we,me)},re=(we,me,De)=>{p.value.setChecked(we,me,De)},se=()=>p.value.getHalfCheckedNodes(),he=()=>p.value.getHalfCheckedKeys(),le=(we,me=!0)=>{if(!e.nodeKey)throw new Error("[Tree] nodeKey is required in setCurrentNode");WT(p,t.emit,()=>{M(we),p.value.setUserCurrentNode(we,me)})},ce=(we,me=!0)=>{if(!e.nodeKey)throw new Error("[Tree] nodeKey is required in setCurrentKey");WT(p,t.emit,()=>{M(),p.value.setCurrentNodeKey(we,me)})},pe=we=>p.value.getNode(we),de=we=>{p.value.remove(we)},Ie=(we,me)=>{p.value.append(we,me)},Ve=(we,me)=>{p.value.insertBefore(we,me)},be=(we,me)=>{p.value.insertAfter(we,me)},ye=(we,me,De)=>{M(me),t.emit("node-expand",we,me,De)},Me=(we,me)=>{if(!e.nodeKey)throw new Error("[Tree] nodeKey is required in updateKeyChild");p.value.updateChildren(we,me)};return Vr("RootTree",{ctx:t,props:e,store:p,root:y,currentNode:r,instance:Cr()}),Vr(Nu,void 0),{ns:a,store:p,root:y,currentNode:r,dragState:P,el$:S,dropIndicator$:C,isEmpty:z,filter:F,getNodeKey:V,getNodePath:N,getCheckedNodes:H,getCheckedKeys:U,getCurrentNode:te,getCurrentKey:Z,setCheckedNodes:q,setCheckedKeys:J,setChecked:re,getHalfCheckedNodes:se,getHalfCheckedKeys:he,setCurrentNode:le,setCurrentKey:ce,t:o,getNode:pe,remove:de,append:Ie,insertBefore:Ve,insertAfter:be,handleNodeExpand:ye,updateKeyChildren:Me}}});function Ohe(e,t,o,a,d,p){const y=Er("el-tree-node");return ae(),Pe("div",{ref:"el$",class:fe([e.ns.b(),e.ns.is("dragging",!!e.dragState.draggingNode),e.ns.is("drop-not-allow",!e.dragState.allowDrop),e.ns.is("drop-inner",e.dragState.dropType==="inner"),{[e.ns.m("highlight-current")]:e.highlightCurrent}]),role:"tree"},[(ae(!0),Pe(Vn,null,Fr(e.root.childNodes,r=>(ae(),At(y,{key:e.getNodeKey(r),node:r,props:e.props,accordion:e.accordion,"render-after-expand":e.renderAfterExpand,"show-checkbox":e.showCheckbox,"render-content":e.renderContent,onNodeExpand:e.handleNodeExpand},null,8,["node","props","accordion","render-after-expand","show-checkbox","render-content","onNodeExpand"]))),128)),e.isEmpty?(ae(),Pe("div",{key:0,class:fe(e.ns.e("empty-block"))},[gt(e.$slots,"empty",{},()=>{var r;return[Ue("span",{class:fe(e.ns.e("empty-text"))},fn((r=e.emptyText)!=null?r:e.t("el.tree.emptyText")),3)]})],2)):bt("v-if",!0),hr(Ue("div",{ref:"dropIndicator$",class:fe(e.ns.e("drop-indicator"))},null,2),[[ii,e.dragState.showDropIndicator]])],2)}var Lhe=dn(Rhe,[["render",Ohe],["__file","tree.vue"]]);const $1=lr(Lhe),Dhe=(e,{attrs:t,emit:o},{select:a,tree:d,key:p})=>{const y=Xt("tree-select");return Wt(()=>e.data,()=>{e.filterable&&jn(()=>{var S,C;(C=d.value)==null||C.filter((S=a.value)==null?void 0:S.states.inputValue)})},{flush:"post"}),{...Wl(Go(e),Object.keys(Ch.props)),...t,"onUpdate:modelValue":S=>o(gr,S),valueKey:p,popperClass:ee(()=>{const S=[y.e("popper")];return e.popperClass&&S.push(e.popperClass),S.join(" ")}),filterMethod:(S="")=>{var C;e.filterMethod?e.filterMethod(S):e.remoteMethod?e.remoteMethod(S):(C=d.value)==null||C.filter(S)}}},zhe=We({extends:A1,setup(e,t){const o=A1.setup(e,t);delete o.selectOptionClick;const a=Cr().proxy;return jn(()=>{o.select.states.cachedOptions.get(a.value)||o.select.onOptionCreate(a)}),Wt(()=>t.attrs.visible,d=>{o.states.visible=d},{immediate:!0}),o},methods:{selectOptionClick(){this.$el.parentElement.click()}}});function ZT(e){return e||e===0}function fM(e){return sn(e)&&e.length}function dm(e){return sn(e)?e:ZT(e)?[e]:[]}function s1(e,t,o,a,d){for(let p=0;p<e.length;p++){const y=e[p];if(t(y,p,e,d))return a?a(y,p,e,d):y;{const r=o(y);if(fM(r)){const S=s1(r,t,o,a,y);if(S)return S}}}}function a1(e,t,o,a){for(let d=0;d<e.length;d++){const p=e[d];t(p,d,e,a);const y=o(p);fM(y)&&a1(y,t,o,p)}}const Fhe=(e,{attrs:t,slots:o,emit:a},{select:d,tree:p,key:y})=>{Wt(()=>e.modelValue,()=>{e.showCheckbox&&jn(()=>{const z=p.value;z&&!_s(z.getCheckedKeys(),dm(e.modelValue))&&z.setCheckedKeys(dm(e.modelValue))})},{immediate:!0,deep:!0});const r=ee(()=>({value:y.value,label:"label",children:"children",disabled:"disabled",isLeaf:"isLeaf",...e.props})),S=(z,F)=>{var V;const N=r.value[z];return $n(N)?N(F,(V=p.value)==null?void 0:V.getNode(S("value",F))):F[N]},C=dm(e.modelValue).map(z=>s1(e.data||[],F=>S("value",F)===z,F=>S("children",F),(F,V,N,H)=>H&&S("value",H))).filter(z=>ZT(z)),M=ee(()=>{if(!e.renderAfterExpand&&!e.lazy)return[];const z=[];return a1(e.data.concat(e.cacheData),F=>{const V=S("value",F);z.push({value:V,currentLabel:S("label",F),isDisabled:S("disabled",F)})},F=>S("children",F)),z}),P=()=>{var z;return(z=p.value)==null?void 0:z.getCheckedKeys().filter(F=>{var V;const N=(V=p.value)==null?void 0:V.getNode(F);return!Ho(N)&&$a(N.childNodes)})};return{...Wl(Go(e),Object.keys($1.props)),...t,nodeKey:y,expandOnClickNode:ee(()=>!e.checkStrictly&&e.expandOnClickNode),defaultExpandedKeys:ee(()=>e.defaultExpandedKeys?e.defaultExpandedKeys.concat(C):C),renderContent:(z,{node:F,data:V,store:N})=>z(zhe,{value:S("value",V),label:S("label",V),disabled:S("disabled",V),visible:F.visible},e.renderContent?()=>e.renderContent(z,{node:F,data:V,store:N}):o.default?()=>o.default({node:F,data:V,store:N}):void 0),filterNodeMethod:(z,F,V)=>e.filterNodeMethod?e.filterNodeMethod(z,F,V):z?new RegExp(xE(z),"i").test(S("label",F)||""):!0,onNodeClick:(z,F,V)=>{var N,H,U,te;if((N=t.onNodeClick)==null||N.call(t,z,F,V),!(e.showCheckbox&&e.checkOnClickNode)){if(!e.showCheckbox&&(e.checkStrictly||F.isLeaf)){if(!S("disabled",z)){const Z=(H=d.value)==null?void 0:H.states.options.get(S("value",z));(U=d.value)==null||U.handleOptionSelect(Z)}}else e.expandOnClickNode&&V.proxy.handleExpandIconClick();(te=d.value)==null||te.focus()}},onCheck:(z,F)=>{var V;if(!e.showCheckbox)return;const N=S("value",z),H={};a1([p.value.store.root],q=>H[q.key]=q,q=>q.childNodes);const U=F.checkedKeys,te=e.multiple?dm(e.modelValue).filter(q=>!(q in H)&&!U.includes(q)):[],Z=te.concat(U);if(e.checkStrictly)a(gr,e.multiple?Z:Z.includes(N)?N:void 0);else if(e.multiple){const q=P();a(gr,te.concat(q))}else{const q=s1([z],se=>!fM(S("children",se))&&!S("disabled",se),se=>S("children",se)),J=q?S("value",q):void 0,re=ZT(e.modelValue)&&!!s1([z],se=>S("value",se)===e.modelValue,se=>S("children",se));a(gr,J===e.modelValue||re?void 0:J)}jn(()=>{var q;const J=dm(e.modelValue);p.value.setCheckedKeys(J),(q=t.onCheck)==null||q.call(t,z,{checkedKeys:p.value.getCheckedKeys(),checkedNodes:p.value.getCheckedNodes(),halfCheckedKeys:p.value.getHalfCheckedKeys(),halfCheckedNodes:p.value.getHalfCheckedNodes()})}),(V=d.value)==null||V.focus()},onNodeExpand:(z,F,V)=>{var N;(N=t.onNodeExpand)==null||N.call(t,z,F,V),jn(()=>{if(!e.checkStrictly&&e.lazy&&e.multiple&&F.checked){const H={},U=p.value.getCheckedKeys();a1([p.value.store.root],q=>H[q.key]=q,q=>q.childNodes);const te=dm(e.modelValue).filter(q=>!(q in H)&&!U.includes(q)),Z=P();a(gr,te.concat(Z))}})},cacheOptions:M}};var Nhe=We({props:{data:{type:Array,default:()=>[]}},setup(e){const t=Pn(cg);return Wt(()=>e.data,()=>{var o;e.data.forEach(d=>{t.states.cachedOptions.has(d.value)||t.states.cachedOptions.set(d.value,d)});const a=((o=t.selectRef)==null?void 0:o.querySelectorAll("input"))||[];Wr&&!Array.from(a).includes(document.activeElement)&&t.setSelected()},{flush:"post",immediate:!0}),()=>{}}});const Bhe=We({name:"ElTreeSelect",inheritAttrs:!1,props:{...Ch.props,...$1.props,cacheData:{type:Array,default:()=>[]}},setup(e,t){const{slots:o,expose:a}=t,d=xe(),p=xe(),y=ee(()=>e.nodeKey||e.valueKey||"value"),r=Dhe(e,t,{select:d,tree:p,key:y}),{cacheOptions:S,...C}=Fhe(e,t,{select:d,tree:p,key:y}),M=si({});return a(M),yr(()=>{Object.assign(M,{...Wl(p.value,["filter","updateKeyChildren","getCheckedNodes","setCheckedNodes","getCheckedKeys","setCheckedKeys","setChecked","getHalfCheckedNodes","getHalfCheckedKeys","getCurrentKey","getCurrentNode","setCurrentKey","setCurrentNode","getNode","remove","append","insertBefore","insertAfter"]),...Wl(d.value,["focus","blur","selectedLabel"])})}),()=>Zn(Ch,si({...r,ref:P=>d.value=P}),{...o,default:()=>[Zn(Nhe,{data:S.value}),Zn($1,si({...C,ref:P=>p.value=P}))]})}});var Vhe=dn(Bhe,[["__file","tree-select.vue"]]);const $he=lr(Vhe),hM=Symbol(),Uhe={key:-1,level:-1,data:{}};var iy=(e=>(e.KEY="id",e.LABEL="label",e.CHILDREN="children",e.DISABLED="disabled",e.CLASS="",e))(iy||{}),YT=(e=>(e.ADD="add",e.DELETE="delete",e))(YT||{});const rB={type:Number,default:26},jhe=un({data:{type:lt(Array),default:()=>io([])},emptyText:{type:String},height:{type:Number,default:200},props:{type:lt(Object),default:()=>io({children:"children",label:"label",disabled:"disabled",value:"id",class:""})},highlightCurrent:{type:Boolean,default:!1},showCheckbox:{type:Boolean,default:!1},defaultCheckedKeys:{type:lt(Array),default:()=>io([])},checkStrictly:{type:Boolean,default:!1},defaultExpandedKeys:{type:lt(Array),default:()=>io([])},indent:{type:Number,default:16},itemSize:rB,icon:{type:Ai},expandOnClickNode:{type:Boolean,default:!0},checkOnClickNode:{type:Boolean,default:!1},currentNodeKey:{type:lt([String,Number])},accordion:{type:Boolean,default:!1},filterMethod:{type:lt(Function)},perfMode:{type:Boolean,default:!0}}),Hhe=un({node:{type:lt(Object),default:()=>io(Uhe)},expanded:{type:Boolean,default:!1},checked:{type:Boolean,default:!1},indeterminate:{type:Boolean,default:!1},showCheckbox:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},current:{type:Boolean,default:!1},hiddenExpandIcon:{type:Boolean,default:!1},itemSize:rB}),Ghe=un({node:{type:lt(Object),required:!0}}),iB="node-click",oB="node-drop",sB="node-expand",aB="node-collapse",lB="current-change",uB="check",cB="check-change",dB="node-contextmenu",Whe={[iB]:(e,t,o)=>e&&t&&o,[oB]:(e,t,o)=>e&&t&&o,[sB]:(e,t)=>e&&t,[aB]:(e,t)=>e&&t,[lB]:(e,t)=>e&&t,[uB]:(e,t)=>e&&t,[cB]:(e,t)=>e&&Oi(t),[dB]:(e,t,o)=>e&&t&&o},qhe={click:(e,t)=>!!(e&&t),drop:(e,t)=>!!(e&&t),toggle:e=>!!e,check:(e,t)=>e&&Oi(t)};function Khe(e,t){const o=xe(new Set),a=xe(new Set),{emit:d}=Cr();Wt([()=>t.value,()=>e.defaultCheckedKeys],()=>jn(()=>{te(e.defaultCheckedKeys)}),{immediate:!0});const p=()=>{if(!t.value||!e.showCheckbox||e.checkStrictly)return;const{levelTreeNodeMap:Z,maxLevel:q}=t.value,J=o.value,re=new Set;for(let se=q-1;se>=1;--se){const he=Z.get(se);he&&he.forEach(le=>{const ce=le.children;if(ce){let pe=!0,de=!1;for(const Ie of ce){const Ve=Ie.key;if(J.has(Ve))de=!0;else if(re.has(Ve)){pe=!1,de=!0;break}else pe=!1}pe?J.add(le.key):de?(re.add(le.key),J.delete(le.key)):(J.delete(le.key),re.delete(le.key))}})}a.value=re},y=Z=>o.value.has(Z.key),r=Z=>a.value.has(Z.key),S=(Z,q,J=!0,re=!0)=>{const se=o.value,he=(le,ce)=>{se[ce?YT.ADD:YT.DELETE](le.key);const pe=le.children;!e.checkStrictly&&pe&&pe.forEach(de=>{de.disabled||he(de,ce)})};he(Z,q),re&&p(),J&&C(Z,q)},C=(Z,q)=>{const{checkedNodes:J,checkedKeys:re}=V(),{halfCheckedNodes:se,halfCheckedKeys:he}=N();d(uB,Z.data,{checkedKeys:re,checkedNodes:J,halfCheckedKeys:he,halfCheckedNodes:se}),d(cB,Z.data,q)};function M(Z=!1){return V(Z).checkedKeys}function P(Z=!1){return V(Z).checkedNodes}function z(){return N().halfCheckedKeys}function F(){return N().halfCheckedNodes}function V(Z=!1){const q=[],J=[];if(t!=null&&t.value&&e.showCheckbox){const{treeNodeMap:re}=t.value;o.value.forEach(se=>{const he=re.get(se);he&&(!Z||Z&&he.isLeaf)&&(J.push(se),q.push(he.data))})}return{checkedKeys:J,checkedNodes:q}}function N(){const Z=[],q=[];if(t!=null&&t.value&&e.showCheckbox){const{treeNodeMap:J}=t.value;a.value.forEach(re=>{const se=J.get(re);se&&(q.push(re),Z.push(se.data))})}return{halfCheckedNodes:Z,halfCheckedKeys:q}}function H(Z){o.value.clear(),a.value.clear(),jn(()=>{te(Z)})}function U(Z,q){if(t!=null&&t.value&&e.showCheckbox){const J=t.value.treeNodeMap.get(Z);J&&S(J,q,!1)}}function te(Z){if(t!=null&&t.value){const{treeNodeMap:q}=t.value;if(e.showCheckbox&&q&&(Z==null?void 0:Z.length)>0){for(const J of Z){const re=q.get(J);re&&!y(re)&&S(re,!0,!1,!1)}p()}}}return{updateCheckedKeys:p,toggleCheckbox:S,isChecked:y,isIndeterminate:r,getCheckedKeys:M,getCheckedNodes:P,getHalfCheckedKeys:z,getHalfCheckedNodes:F,setChecked:U,setCheckedKeys:H}}function Zhe(e,t){const o=xe(new Set([])),a=xe(new Set([])),d=ee(()=>$n(e.filterMethod));function p(r){var S;if(!d.value)return;const C=new Set,M=a.value,P=o.value,z=[],F=((S=t.value)==null?void 0:S.treeNodes)||[],V=e.filterMethod;P.clear();function N(H){H.forEach(U=>{z.push(U),V!=null&&V(r,U.data,U)?z.forEach(Z=>{C.add(Z.key)}):U.isLeaf&&P.add(U.key);const te=U.children;if(te&&N(te),!U.isLeaf){if(!C.has(U.key))P.add(U.key);else if(te){let Z=!0;for(const q of te)if(!P.has(q.key)){Z=!1;break}Z?M.add(U.key):M.delete(U.key)}}z.pop()})}return N(F),C}function y(r){return a.value.has(r.key)}return{hiddenExpandIconKeySet:a,hiddenNodeKeySet:o,doFilter:p,isForceHiddenExpandIcon:y}}function Yhe(e,t){const o=xe(new Set(e.defaultExpandedKeys)),a=xe(),d=Hi(),p=xe();Wt(()=>e.currentNodeKey,Ae=>{a.value=Ae},{immediate:!0}),Wt(()=>e.data,Ae=>{jt(Ae)},{immediate:!0});const{isIndeterminate:y,isChecked:r,toggleCheckbox:S,getCheckedKeys:C,getCheckedNodes:M,getHalfCheckedKeys:P,getHalfCheckedNodes:z,setChecked:F,setCheckedKeys:V}=Khe(e,d),{doFilter:N,hiddenNodeKeySet:H,isForceHiddenExpandIcon:U}=Zhe(e,d),te=ee(()=>{var Ae;return((Ae=e.props)==null?void 0:Ae.value)||iy.KEY}),Z=ee(()=>{var Ae;return((Ae=e.props)==null?void 0:Ae.children)||iy.CHILDREN}),q=ee(()=>{var Ae;return((Ae=e.props)==null?void 0:Ae.disabled)||iy.DISABLED}),J=ee(()=>{var Ae;return((Ae=e.props)==null?void 0:Ae.label)||iy.LABEL}),re=ee(()=>{var Ae;const tt=o.value,Je=H.value,Jt=[],Kt=((Ae=d.value)==null?void 0:Ae.treeNodes)||[],Nt=[];for(let Pt=Kt.length-1;Pt>=0;--Pt)Nt.push(Kt[Pt]);for(;Nt.length;){const Pt=Nt.pop();if(!Je.has(Pt.key)&&(Jt.push(Pt),Pt.children&&tt.has(Pt.key)))for(let Dt=Pt.children.length-1;Dt>=0;--Dt)Nt.push(Pt.children[Dt])}return Jt}),se=ee(()=>re.value.length>0);function he(Ae){const tt=new Map,Je=new Map;let Jt=1;function Kt(Pt,Dt=1,rn=void 0){var on;const Ln=[];for(const yn of Pt){const Et=pe(yn),En={level:Dt,key:Et,data:yn};En.label=Ie(yn),En.parent=rn;const Xn=ce(yn);En.disabled=de(yn),En.isLeaf=!Xn||Xn.length===0,Xn&&Xn.length&&(En.children=Kt(Xn,Dt+1,En)),Ln.push(En),tt.set(Et,En),Je.has(Dt)||Je.set(Dt,[]),(on=Je.get(Dt))==null||on.push(En)}return Dt>Jt&&(Jt=Dt),Ln}const Nt=Kt(Ae);return{treeNodeMap:tt,levelTreeNodeMap:Je,maxLevel:Jt,treeNodes:Nt}}function le(Ae){const tt=N(Ae);tt&&(o.value=tt)}function ce(Ae){return Ae[Z.value]}function pe(Ae){return Ae?Ae[te.value]:""}function de(Ae){return Ae[q.value]}function Ie(Ae){return Ae[J.value]}function Ve(Ae){o.value.has(Ae.key)?Ge(Ae):De(Ae)}function be(Ae){const tt=new Set,Je=d.value.treeNodeMap;Ae.forEach(Jt=>{let Kt=Je.get(Jt);for(;Kt&&!tt.has(Kt.key);)tt.add(Kt.key),Kt=Kt.parent}),o.value=tt}function ye(Ae,tt){t(iB,Ae.data,Ae,tt),we(Ae),e.expandOnClickNode&&Ve(Ae),e.showCheckbox&&e.checkOnClickNode&&!Ae.disabled&&S(Ae,!r(Ae),!0)}function Me(Ae,tt){t(oB,Ae.data,Ae,tt)}function we(Ae){Ct(Ae)||(a.value=Ae.key,t(lB,Ae.data,Ae))}function me(Ae,tt){S(Ae,tt)}function De(Ae){const tt=o.value;if(d.value&&e.accordion){const{treeNodeMap:Je}=d.value;tt.forEach(Jt=>{const Kt=Je.get(Jt);Ae&&Ae.level===(Kt==null?void 0:Kt.level)&&tt.delete(Jt)})}tt.add(Ae.key),t(sB,Ae.data,Ae)}function Ge(Ae){o.value.delete(Ae.key),t(aB,Ae.data,Ae)}function rt(Ae){return o.value.has(Ae.key)}function Oe(Ae){return!!Ae.disabled}function Ct(Ae){const tt=a.value;return tt!==void 0&&tt===Ae.key}function kt(){var Ae,tt;if(a.value)return(tt=(Ae=d.value)==null?void 0:Ae.treeNodeMap.get(a.value))==null?void 0:tt.data}function Bt(){return a.value}function _t(Ae){a.value=Ae}function jt(Ae){jn(()=>d.value=he(Ae))}function Gt(Ae){var tt;const Je=xr(Ae)?pe(Ae):Ae;return(tt=d.value)==null?void 0:tt.treeNodeMap.get(Je)}function Ne(Ae,tt="auto"){const Je=Gt(Ae);Je&&p.value&&p.value.scrollToItem(re.value.indexOf(Je),tt)}function an(Ae){var tt;(tt=p.value)==null||tt.scrollTo(Ae)}return{tree:d,flattenTree:re,isNotEmpty:se,listRef:p,getKey:pe,getChildren:ce,toggleExpand:Ve,toggleCheckbox:S,isExpanded:rt,isChecked:r,isIndeterminate:y,isDisabled:Oe,isCurrent:Ct,isForceHiddenExpandIcon:U,handleNodeClick:ye,handleNodeDrop:Me,handleNodeCheck:me,getCurrentNode:kt,getCurrentKey:Bt,setCurrentKey:_t,getCheckedKeys:C,getCheckedNodes:M,getHalfCheckedKeys:P,getHalfCheckedNodes:z,setChecked:F,setCheckedKeys:V,filter:le,setData:jt,getNode:Gt,expandNode:De,collapseNode:Ge,setExpandedKeys:be,scrollToNode:Ne,scrollTo:an}}var Xhe=We({name:"ElTreeNodeContent",props:Ghe,setup(e){const t=Pn(hM),o=Xt("tree");return()=>{const a=e.node,{data:d}=a;return t!=null&&t.ctx.slots.default?t.ctx.slots.default({node:a,data:d}):Zn("span",{class:o.be("node","label")},[a==null?void 0:a.label])}}});const Jhe=We({name:"ElTreeNode"}),Qhe=We({...Jhe,props:Hhe,emits:qhe,setup(e,{emit:t}){const o=e,a=Pn(hM),d=Xt("tree"),p=ee(()=>{var F;return(F=a==null?void 0:a.props.indent)!=null?F:16}),y=ee(()=>{var F;return(F=a==null?void 0:a.props.icon)!=null?F:Iz}),r=F=>{const V=a==null?void 0:a.props.props.class;if(!V)return{};let N;if($n(V)){const{data:H}=F;N=V(H,F)}else N=V;return Nn(N)?{[N]:!0}:N},S=F=>{t("click",o.node,F)},C=F=>{t("drop",o.node,F)},M=()=>{t("toggle",o.node)},P=F=>{t("check",o.node,F)},z=F=>{var V,N,H,U;(H=(N=(V=a==null?void 0:a.instance)==null?void 0:V.vnode)==null?void 0:N.props)!=null&&H.onNodeContextmenu&&(F.stopPropagation(),F.preventDefault()),a==null||a.ctx.emit(dB,F,(U=o.node)==null?void 0:U.data,o.node)};return(F,V)=>{var N,H,U;return ae(),Pe("div",{ref:"node$",class:fe([b(d).b("node"),b(d).is("expanded",F.expanded),b(d).is("current",F.current),b(d).is("focusable",!F.disabled),b(d).is("checked",!F.disabled&&F.checked),r(F.node)]),role:"treeitem",tabindex:"-1","aria-expanded":F.expanded,"aria-disabled":F.disabled,"aria-checked":F.checked,"data-key":(N=F.node)==null?void 0:N.key,onClick:Jn(S,["stop"]),onContextmenu:z,onDragover:Jn(()=>{},["prevent"]),onDragenter:Jn(()=>{},["prevent"]),onDrop:Jn(C,["stop"])},[Ue("div",{class:fe(b(d).be("node","content")),style:Un({paddingLeft:`${(F.node.level-1)*b(p)}px`,height:F.itemSize+"px"})},[b(y)?(ae(),At(b(zn),{key:0,class:fe([b(d).is("leaf",!!((H=F.node)!=null&&H.isLeaf)),b(d).is("hidden",F.hiddenExpandIcon),{expanded:!((U=F.node)!=null&&U.isLeaf)&&F.expanded},b(d).be("node","expand-icon")]),onClick:Jn(M,["stop"])},{default:ot(()=>[(ae(),At(Ir(b(y))))]),_:1},8,["class","onClick"])):bt("v-if",!0),F.showCheckbox?(ae(),At(b(pl),{key:1,"model-value":F.checked,indeterminate:F.indeterminate,disabled:F.disabled,onChange:P,onClick:Jn(()=>{},["stop"])},null,8,["model-value","indeterminate","disabled","onClick"])):bt("v-if",!0),qe(b(Xhe),{node:F.node},null,8,["node"])],6)],42,["aria-expanded","aria-disabled","aria-checked","data-key","onClick","onDragover","onDragenter","onDrop"])}}});var epe=dn(Qhe,[["__file","tree-node.vue"]]);const tpe=We({name:"ElTreeV2"}),npe=We({...tpe,props:jhe,emits:Whe,setup(e,{expose:t,emit:o}){const a=e,d=Bo(),p=ee(()=>a.itemSize);Vr(hM,{ctx:{emit:o,slots:d},props:a,instance:Cr()}),Vr(Nu,void 0);const{t:y}=qr(),r=Xt("tree"),{flattenTree:S,isNotEmpty:C,listRef:M,toggleExpand:P,isExpanded:z,isIndeterminate:F,isChecked:V,isDisabled:N,isCurrent:H,isForceHiddenExpandIcon:U,handleNodeClick:te,handleNodeDrop:Z,handleNodeCheck:q,toggleCheckbox:J,getCurrentNode:re,getCurrentKey:se,setCurrentKey:he,getCheckedKeys:le,getCheckedNodes:ce,getHalfCheckedKeys:pe,getHalfCheckedNodes:de,setChecked:Ie,setCheckedKeys:Ve,filter:be,setData:ye,getNode:Me,expandNode:we,collapseNode:me,setExpandedKeys:De,scrollToNode:Ge,scrollTo:rt}=Yhe(a,o);return t({toggleCheckbox:J,getCurrentNode:re,getCurrentKey:se,setCurrentKey:he,getCheckedKeys:le,getCheckedNodes:ce,getHalfCheckedKeys:pe,getHalfCheckedNodes:de,setChecked:Ie,setCheckedKeys:Ve,filter:be,setData:ye,getNode:Me,expandNode:we,collapseNode:me,setExpandedKeys:De,scrollToNode:Ge,scrollTo:rt}),(Oe,Ct)=>(ae(),Pe("div",{class:fe([b(r).b(),{[b(r).m("highlight-current")]:Oe.highlightCurrent}]),role:"tree"},[b(C)?(ae(),At(b(qF),{key:0,ref_key:"listRef",ref:M,"class-name":b(r).b("virtual-list"),data:b(S),total:b(S).length,height:Oe.height,"item-size":b(p),"perf-mode":Oe.perfMode},{default:ot(({data:kt,index:Bt,style:_t})=>[(ae(),At(epe,{key:kt[Bt].key,style:Un(_t),node:kt[Bt],expanded:b(z)(kt[Bt]),"show-checkbox":Oe.showCheckbox,checked:b(V)(kt[Bt]),indeterminate:b(F)(kt[Bt]),"item-size":b(p),disabled:b(N)(kt[Bt]),current:b(H)(kt[Bt]),"hidden-expand-icon":b(U)(kt[Bt]),onClick:b(te),onToggle:b(P),onCheck:b(q),onDrop:b(Z)},null,8,["style","node","expanded","show-checkbox","checked","indeterminate","item-size","disabled","current","hidden-expand-icon","onClick","onToggle","onCheck","onDrop"]))]),_:1},8,["class-name","data","total","height","item-size","perf-mode"])):(ae(),Pe("div",{key:1,class:fe(b(r).e("empty-block"))},[gt(Oe.$slots,"empty",{},()=>{var kt;return[Ue("span",{class:fe(b(r).e("empty-text"))},fn((kt=Oe.emptyText)!=null?kt:b(y)("el.tree.emptyText")),3)]})],2))],2))}});var rpe=dn(npe,[["__file","tree.vue"]]);const ipe=lr(rpe),fB=Symbol("uploadContextKey"),ope="ElUpload";class spe extends Error{constructor(t,o,a,d){super(t),this.name="UploadAjaxError",this.status=o,this.method=a,this.url=d}}function _O(e,t,o){let a;return o.response?a=`${o.response.error||o.response}`:o.responseText?a=`${o.responseText}`:a=`fail to ${t.method} ${e} ${o.status}`,new spe(a,o.status,t.method,e)}function ape(e){const t=e.responseText||e.response;if(!t)return t;try{return JSON.parse(t)}catch{return t}}const lpe=e=>{typeof XMLHttpRequest>"u"&&No(ope,"XMLHttpRequest is undefined");const t=new XMLHttpRequest,o=e.action;t.upload&&t.upload.addEventListener("progress",p=>{const y=p;y.percent=p.total>0?p.loaded/p.total*100:0,e.onProgress(y)});const a=new FormData;if(e.data)for(const[p,y]of Object.entries(e.data))sn(y)&&y.length?a.append(p,...y):a.append(p,y);a.append(e.filename,e.file,e.file.name),t.addEventListener("error",()=>{e.onError(_O(o,e,t))}),t.addEventListener("load",()=>{if(t.status<200||t.status>=300)return e.onError(_O(o,e,t));e.onSuccess(ape(t))}),t.open(e.method,o,!0),e.withCredentials&&"withCredentials"in t&&(t.withCredentials=!0);const d=e.headers||{};if(d instanceof Headers)d.forEach((p,y)=>t.setRequestHeader(y,p));else for(const[p,y]of Object.entries(d))Ho(y)||t.setRequestHeader(p,String(y));return t.send(a),t},hB=["text","picture","picture-card"];let upe=1;const XT=()=>Date.now()+upe++,pB=un({action:{type:String,default:"#"},headers:{type:lt(Object)},method:{type:String,default:"post"},data:{type:lt([Object,Function,Promise]),default:()=>io({})},multiple:Boolean,name:{type:String,default:"file"},drag:Boolean,withCredentials:Boolean,showFileList:{type:Boolean,default:!0},accept:{type:String,default:""},fileList:{type:lt(Array),default:()=>io([])},autoUpload:{type:Boolean,default:!0},listType:{type:String,values:hB,default:"text"},httpRequest:{type:lt(Function),default:lpe},disabled:Boolean,limit:Number}),cpe=un({...pB,beforeUpload:{type:lt(Function),default:vi},beforeRemove:{type:lt(Function)},onRemove:{type:lt(Function),default:vi},onChange:{type:lt(Function),default:vi},onPreview:{type:lt(Function),default:vi},onSuccess:{type:lt(Function),default:vi},onProgress:{type:lt(Function),default:vi},onError:{type:lt(Function),default:vi},onExceed:{type:lt(Function),default:vi},crossorigin:{type:lt(String)}}),dpe=un({files:{type:lt(Array),default:()=>io([])},disabled:{type:Boolean,default:!1},handlePreview:{type:lt(Function),default:vi},listType:{type:String,values:hB,default:"text"},crossorigin:{type:lt(String)}}),fpe={remove:e=>!!e},hpe=We({name:"ElUploadList"}),ppe=We({...hpe,props:dpe,emits:fpe,setup(e,{emit:t}){const o=e,{t:a}=qr(),d=Xt("upload"),p=Xt("icon"),y=Xt("list"),r=ws(),S=xe(!1),C=ee(()=>[d.b("list"),d.bm("list",o.listType),d.is("disabled",o.disabled)]),M=P=>{t("remove",P)};return(P,z)=>(ae(),At(cD,{tag:"ul",class:fe(b(C)),name:b(y).b()},{default:ot(()=>[(ae(!0),Pe(Vn,null,Fr(P.files,(F,V)=>(ae(),Pe("li",{key:F.uid||F.name,class:fe([b(d).be("list","item"),b(d).is(F.status),{focusing:S.value}]),tabindex:"0",onKeydown:Ri(N=>!b(r)&&M(F),["delete"]),onFocus:N=>S.value=!0,onBlur:N=>S.value=!1,onClick:N=>S.value=!1},[gt(P.$slots,"default",{file:F,index:V},()=>[P.listType==="picture"||F.status!=="uploading"&&P.listType==="picture-card"?(ae(),Pe("img",{key:0,class:fe(b(d).be("list","item-thumbnail")),src:F.url,crossorigin:P.crossorigin,alt:""},null,10,["src","crossorigin"])):bt("v-if",!0),F.status==="uploading"||P.listType!=="picture-card"?(ae(),Pe("div",{key:1,class:fe(b(d).be("list","item-info"))},[Ue("a",{class:fe(b(d).be("list","item-name")),onClick:Jn(N=>P.handlePreview(F),["prevent"])},[qe(b(zn),{class:fe(b(p).m("document"))},{default:ot(()=>[qe(b(m7))]),_:1},8,["class"]),Ue("span",{class:fe(b(d).be("list","item-file-name")),title:F.name},fn(F.name),11,["title"])],10,["onClick"]),F.status==="uploading"?(ae(),At(b(FF),{key:0,type:P.listType==="picture-card"?"circle":"line","stroke-width":P.listType==="picture-card"?6:2,percentage:Number(F.percentage),style:Un(P.listType==="picture-card"?"":"margin-top: 0.5rem")},null,8,["type","stroke-width","percentage","style"])):bt("v-if",!0)],2)):bt("v-if",!0),Ue("label",{class:fe(b(d).be("list","item-status-label"))},[P.listType==="text"?(ae(),At(b(zn),{key:0,class:fe([b(p).m("upload-success"),b(p).m("circle-check")])},{default:ot(()=>[qe(b(QC))]),_:1},8,["class"])):["picture-card","picture"].includes(P.listType)?(ae(),At(b(zn),{key:1,class:fe([b(p).m("upload-success"),b(p).m("check")])},{default:ot(()=>[qe(b(lv))]),_:1},8,["class"])):bt("v-if",!0)],2),b(r)?bt("v-if",!0):(ae(),At(b(zn),{key:2,class:fe(b(p).m("close")),onClick:N=>M(F)},{default:ot(()=>[qe(b(Ql))]),_:2},1032,["class","onClick"])),bt(" Due to close btn only appears when li gets focused disappears after li gets blurred, thus keyboard navigation can never reach close btn"),bt(" This is a bug which needs to be fixed "),bt(" TODO: Fix the incorrect navigation interaction "),b(r)?bt("v-if",!0):(ae(),Pe("i",{key:3,class:fe(b(p).m("close-tip"))},fn(b(a)("el.upload.deleteTip")),3)),P.listType==="picture-card"?(ae(),Pe("span",{key:4,class:fe(b(d).be("list","item-actions"))},[Ue("span",{class:fe(b(d).be("list","item-preview")),onClick:N=>P.handlePreview(F)},[qe(b(zn),{class:fe(b(p).m("zoom-in"))},{default:ot(()=>[qe(b(Rz))]),_:1},8,["class"])],10,["onClick"]),b(r)?bt("v-if",!0):(ae(),Pe("span",{key:0,class:fe(b(d).be("list","item-delete")),onClick:N=>M(F)},[qe(b(zn),{class:fe(b(p).m("delete"))},{default:ot(()=>[qe(b(h7))]),_:1},8,["class"])],10,["onClick"]))],2)):bt("v-if",!0)])],42,["onKeydown","onFocus","onBlur","onClick"]))),128)),gt(P.$slots,"append")]),_:3},8,["class","name"]))}});var yO=dn(ppe,[["__file","upload-list.vue"]]);const mpe=un({disabled:{type:Boolean,default:!1}}),gpe={file:e=>sn(e)},mB="ElUploadDrag",_pe=We({name:mB}),ype=We({..._pe,props:mpe,emits:gpe,setup(e,{emit:t}){Pn(fB)||No(mB,"usage: <el-upload><el-upload-dragger /></el-upload>");const a=Xt("upload"),d=xe(!1),p=ws(),y=S=>{if(p.value)return;d.value=!1,S.stopPropagation();const C=Array.from(S.dataTransfer.files);t("file",C)},r=()=>{p.value||(d.value=!0)};return(S,C)=>(ae(),Pe("div",{class:fe([b(a).b("dragger"),b(a).is("dragover",d.value)]),onDrop:Jn(y,["prevent"]),onDragover:Jn(r,["prevent"]),onDragleave:Jn(M=>d.value=!1,["prevent"])},[gt(S.$slots,"default")],42,["onDrop","onDragover","onDragleave"]))}});var vpe=dn(ype,[["__file","upload-dragger.vue"]]);const bpe=un({...pB,beforeUpload:{type:lt(Function),default:vi},onRemove:{type:lt(Function),default:vi},onStart:{type:lt(Function),default:vi},onSuccess:{type:lt(Function),default:vi},onProgress:{type:lt(Function),default:vi},onError:{type:lt(Function),default:vi},onExceed:{type:lt(Function),default:vi}}),xpe=We({name:"ElUploadContent",inheritAttrs:!1}),wpe=We({...xpe,props:bpe,setup(e,{expose:t}){const o=e,a=Xt("upload"),d=ws(),p=Hi({}),y=Hi(),r=N=>{if(N.length===0)return;const{autoUpload:H,limit:U,fileList:te,multiple:Z,onStart:q,onExceed:J}=o;if(U&&te.length+N.length>U){J(N,te);return}Z||(N=N.slice(0,1));for(const re of N){const se=re;se.uid=XT(),q(se),H&&S(se)}},S=async N=>{if(y.value.value="",!o.beforeUpload)return M(N);let H,U={};try{const Z=o.data,q=o.beforeUpload(N);U=wy(o.data)?w1(o.data):o.data,H=await q,wy(o.data)&&_s(Z,U)&&(U=w1(o.data))}catch{H=!1}if(H===!1){o.onRemove(N);return}let te=N;H instanceof Blob&&(H instanceof File?te=H:te=new File([H],N.name,{type:N.type})),M(Object.assign(te,{uid:N.uid}),U)},C=async(N,H)=>$n(N)?N(H):N,M=async(N,H)=>{const{headers:U,data:te,method:Z,withCredentials:q,name:J,action:re,onProgress:se,onSuccess:he,onError:le,httpRequest:ce}=o;try{H=await C(H??te,N)}catch{o.onRemove(N);return}const{uid:pe}=N,de={headers:U||{},withCredentials:q,file:N,data:H,method:Z,filename:J,action:re,onProgress:Ve=>{se(Ve,N)},onSuccess:Ve=>{he(Ve,N),delete p.value[pe]},onError:Ve=>{le(Ve,N),delete p.value[pe]}},Ie=ce(de);p.value[pe]=Ie,Ie instanceof Promise&&Ie.then(de.onSuccess,de.onError)},P=N=>{const H=N.target.files;H&&r(Array.from(H))},z=()=>{d.value||(y.value.value="",y.value.click())},F=()=>{z()};return t({abort:N=>{wz(p.value).filter(N?([U])=>String(N.uid)===U:()=>!0).forEach(([U,te])=>{te instanceof XMLHttpRequest&&te.abort(),delete p.value[U]})},upload:S}),(N,H)=>(ae(),Pe("div",{class:fe([b(a).b(),b(a).m(N.listType),b(a).is("drag",N.drag),b(a).is("disabled",b(d))]),tabindex:b(d)?"-1":"0",onClick:z,onKeydown:Ri(Jn(F,["self"]),["enter","space"])},[N.drag?(ae(),At(vpe,{key:0,disabled:b(d),onFile:r},{default:ot(()=>[gt(N.$slots,"default")]),_:3},8,["disabled"])):gt(N.$slots,"default",{key:1}),Ue("input",{ref_key:"inputRef",ref:y,class:fe(b(a).e("input")),name:N.name,disabled:b(d),multiple:N.multiple,accept:N.accept,type:"file",onChange:P,onClick:Jn(()=>{},["stop"])},null,42,["name","disabled","multiple","accept","onClick"])],42,["tabindex","onKeydown"]))}});var vO=dn(wpe,[["__file","upload-content.vue"]]);const bO="ElUpload",xO=e=>{var t;(t=e.url)!=null&&t.startsWith("blob:")&&URL.revokeObjectURL(e.url)},Spe=(e,t)=>{const o=pz(e,"fileList",void 0,{passive:!0}),a=F=>o.value.find(V=>V.uid===F.uid);function d(F){var V;(V=t.value)==null||V.abort(F)}function p(F=["ready","uploading","success","fail"]){o.value=o.value.filter(V=>!F.includes(V.status))}function y(F){o.value=o.value.filter(V=>V.uid!==F.uid)}const r=(F,V)=>{const N=a(V);N&&(console.error(F),N.status="fail",y(N),e.onError(F,N,o.value),e.onChange(N,o.value))},S=(F,V)=>{const N=a(V);N&&(e.onProgress(F,N,o.value),N.status="uploading",N.percentage=Math.round(F.percent))},C=(F,V)=>{const N=a(V);N&&(N.status="success",N.response=F,e.onSuccess(F,N,o.value),e.onChange(N,o.value))},M=F=>{Ho(F.uid)&&(F.uid=XT());const V={name:F.name,percentage:0,status:"ready",size:F.size,raw:F,uid:F.uid};if(e.listType==="picture-card"||e.listType==="picture")try{V.url=URL.createObjectURL(F)}catch(N){N.message,e.onError(N,V,o.value)}o.value=[...o.value,V],e.onChange(V,o.value)},P=async F=>{const V=F instanceof File?a(F):F;V||No(bO,"file to be removed not found");const N=H=>{d(H),y(H),e.onRemove(H,o.value),xO(H)};e.beforeRemove?await e.beforeRemove(V,o.value)!==!1&&N(V):N(V)};function z(){o.value.filter(({status:F})=>F==="ready").forEach(({raw:F})=>{var V;return F&&((V=t.value)==null?void 0:V.upload(F))})}return Wt(()=>e.listType,F=>{F!=="picture-card"&&F!=="picture"||(o.value=o.value.map(V=>{const{raw:N,url:H}=V;if(!H&&N)try{V.url=URL.createObjectURL(N)}catch(U){e.onError(U,V,o.value)}return V}))}),Wt(o,F=>{for(const V of F)V.uid||(V.uid=XT()),V.status||(V.status="success")},{immediate:!0,deep:!0}),{uploadFiles:o,abort:d,clearFiles:p,handleError:r,handleProgress:S,handleStart:M,handleSuccess:C,handleRemove:P,submit:z,revokeFileObjectURL:xO}},Tpe=We({name:"ElUpload"}),Cpe=We({...Tpe,props:cpe,setup(e,{expose:t}){const o=e,a=ws(),d=Hi(),{abort:p,submit:y,clearFiles:r,uploadFiles:S,handleStart:C,handleError:M,handleRemove:P,handleSuccess:z,handleProgress:F,revokeFileObjectURL:V}=Spe(o,d),N=ee(()=>o.listType==="picture-card"),H=ee(()=>({...o,fileList:S.value,onStart:C,onProgress:F,onSuccess:z,onError:M,onRemove:P}));return Li(()=>{S.value.forEach(V)}),Vr(fB,{accept:hi(o,"accept")}),t({abort:p,submit:y,clearFiles:r,handleStart:C,handleRemove:P}),(U,te)=>(ae(),Pe("div",null,[b(N)&&U.showFileList?(ae(),At(yO,{key:0,disabled:b(a),"list-type":U.listType,files:b(S),crossorigin:U.crossorigin,"handle-preview":U.onPreview,onRemove:b(P)},cl({append:ot(()=>[qe(vO,kr({ref_key:"uploadRef",ref:d},b(H)),{default:ot(()=>[U.$slots.trigger?gt(U.$slots,"trigger",{key:0}):bt("v-if",!0),!U.$slots.trigger&&U.$slots.default?gt(U.$slots,"default",{key:1}):bt("v-if",!0)]),_:3},16)]),_:2},[U.$slots.file?{name:"default",fn:ot(({file:Z,index:q})=>[gt(U.$slots,"file",{file:Z,index:q})])}:void 0]),1032,["disabled","list-type","files","crossorigin","handle-preview","onRemove"])):bt("v-if",!0),!b(N)||b(N)&&!U.showFileList?(ae(),At(vO,kr({key:1,ref_key:"uploadRef",ref:d},b(H)),{default:ot(()=>[U.$slots.trigger?gt(U.$slots,"trigger",{key:0}):bt("v-if",!0),!U.$slots.trigger&&U.$slots.default?gt(U.$slots,"default",{key:1}):bt("v-if",!0)]),_:3},16)):bt("v-if",!0),U.$slots.trigger?gt(U.$slots,"default",{key:2}):bt("v-if",!0),gt(U.$slots,"tip"),!b(N)&&U.showFileList?(ae(),At(yO,{key:3,disabled:b(a),"list-type":U.listType,files:b(S),crossorigin:U.crossorigin,"handle-preview":U.onPreview,onRemove:b(P)},cl({_:2},[U.$slots.file?{name:"default",fn:ot(({file:Z,index:q})=>[gt(U.$slots,"file",{file:Z,index:q})])}:void 0]),1032,["disabled","list-type","files","crossorigin","handle-preview","onRemove"])):bt("v-if",!0)]))}});var Epe=dn(Cpe,[["__file","upload.vue"]]);const Mpe=lr(Epe),Ipe=un({zIndex:{type:Number,default:9},rotate:{type:Number,default:-22},width:Number,height:Number,image:String,content:{type:lt([String,Array]),default:"Element Plus"},font:{type:lt(Object)},gap:{type:lt(Array),default:()=>[100,100]},offset:{type:lt(Array)}});function Ape(e){return e.replace(/([A-Z])/g,"-$1").toLowerCase()}function kpe(e){return Object.keys(e).map(t=>`${Ape(t)}: ${e[t]};`).join(" ")}function Ppe(){return window.devicePixelRatio||1}const Rpe=(e,t)=>{let o=!1;return e.removedNodes.length&&t&&(o=Array.from(e.removedNodes).includes(t)),e.type==="attributes"&&e.target===t&&(o=!0),o},gB=3;function TS(e,t,o=1){const a=document.createElement("canvas"),d=a.getContext("2d"),p=e*o,y=t*o;return a.setAttribute("width",`${p}px`),a.setAttribute("height",`${y}px`),d.save(),[d,a,p,y]}function Ope(){function e(t,o,a,d,p,y,r,S){const[C,M,P,z]=TS(d,p,a);if(t instanceof HTMLImageElement)C.drawImage(t,0,0,P,z);else{const{color:Ge,fontSize:rt,fontStyle:Oe,fontWeight:Ct,fontFamily:kt,textAlign:Bt,textBaseline:_t}=y,jt=Number(rt)*a;C.font=`${Oe} normal ${Ct} ${jt}px/${p}px ${kt}`,C.fillStyle=Ge,C.textAlign=Bt,C.textBaseline=_t;const Gt=sn(t)?t:[t];Gt==null||Gt.forEach((Ne,an)=>{C.fillText(Ne??"",P/2,an*(jt+gB*a))})}const F=Math.PI/180*Number(o),V=Math.max(d,p),[N,H,U]=TS(V,V,a);N.translate(U/2,U/2),N.rotate(F),P>0&&z>0&&N.drawImage(M,-P/2,-z/2);function te(Ge,rt){const Oe=Ge*Math.cos(F)-rt*Math.sin(F),Ct=Ge*Math.sin(F)+rt*Math.cos(F);return[Oe,Ct]}let Z=0,q=0,J=0,re=0;const se=P/2,he=z/2;[[0-se,0-he],[0+se,0-he],[0+se,0+he],[0-se,0+he]].forEach(([Ge,rt])=>{const[Oe,Ct]=te(Ge,rt);Z=Math.min(Z,Oe),q=Math.max(q,Oe),J=Math.min(J,Ct),re=Math.max(re,Ct)});const ce=Z+U/2,pe=J+U/2,de=q-Z,Ie=re-J,Ve=r*a,be=S*a,ye=(de+Ve)*2,Me=Ie+be,[we,me]=TS(ye,Me);function De(Ge=0,rt=0){we.drawImage(H,ce,pe,de,Ie,Ge,rt,de,Ie)}return De(),De(de+Ve,-Ie/2-be/2),De(de+Ve,+Ie/2+be/2),[me.toDataURL(),ye/a,Me/a]}return e}const Lpe=We({name:"ElWatermark"}),Dpe=We({...Lpe,props:Ipe,setup(e){const t=e,o={position:"relative"},a=ee(()=>{var ce,pe;return(pe=(ce=t.font)==null?void 0:ce.color)!=null?pe:"rgba(0,0,0,.15)"}),d=ee(()=>{var ce,pe;return(pe=(ce=t.font)==null?void 0:ce.fontSize)!=null?pe:16}),p=ee(()=>{var ce,pe;return(pe=(ce=t.font)==null?void 0:ce.fontWeight)!=null?pe:"normal"}),y=ee(()=>{var ce,pe;return(pe=(ce=t.font)==null?void 0:ce.fontStyle)!=null?pe:"normal"}),r=ee(()=>{var ce,pe;return(pe=(ce=t.font)==null?void 0:ce.fontFamily)!=null?pe:"sans-serif"}),S=ee(()=>{var ce,pe;return(pe=(ce=t.font)==null?void 0:ce.textAlign)!=null?pe:"center"}),C=ee(()=>{var ce,pe;return(pe=(ce=t.font)==null?void 0:ce.textBaseline)!=null?pe:"hanging"}),M=ee(()=>t.gap[0]),P=ee(()=>t.gap[1]),z=ee(()=>M.value/2),F=ee(()=>P.value/2),V=ee(()=>{var ce,pe;return(pe=(ce=t.offset)==null?void 0:ce[0])!=null?pe:z.value}),N=ee(()=>{var ce,pe;return(pe=(ce=t.offset)==null?void 0:ce[1])!=null?pe:F.value}),H=()=>{const ce={zIndex:t.zIndex,position:"absolute",left:0,top:0,width:"100%",height:"100%",pointerEvents:"none",backgroundRepeat:"repeat"};let pe=V.value-z.value,de=N.value-F.value;return pe>0&&(ce.left=`${pe}px`,ce.width=`calc(100% - ${pe}px)`,pe=0),de>0&&(ce.top=`${de}px`,ce.height=`calc(100% - ${de}px)`,de=0),ce.backgroundPosition=`${pe}px ${de}px`,ce},U=Hi(null),te=Hi(),Z=xe(!1),q=()=>{te.value&&(te.value.remove(),te.value=void 0)},J=(ce,pe)=>{var de;U.value&&te.value&&(Z.value=!0,te.value.setAttribute("style",kpe({...H(),backgroundImage:`url('${ce}')`,backgroundSize:`${Math.floor(pe)}px`})),(de=U.value)==null||de.append(te.value),setTimeout(()=>{Z.value=!1}))},re=ce=>{let pe=120,de=64;const Ie=t.image,Ve=t.content,be=t.width,ye=t.height;if(!Ie&&ce.measureText){ce.font=`${Number(d.value)}px ${r.value}`;const Me=sn(Ve)?Ve:[Ve],we=Me.map(me=>{const De=ce.measureText(me);return[De.width,De.fontBoundingBoxAscent!==void 0?De.fontBoundingBoxAscent+De.fontBoundingBoxDescent:De.actualBoundingBoxAscent+De.actualBoundingBoxDescent]});pe=Math.ceil(Math.max(...we.map(me=>me[0]))),de=Math.ceil(Math.max(...we.map(me=>me[1])))*Me.length+(Me.length-1)*gB}return[be??pe,ye??de]},se=Ope(),he=()=>{const pe=document.createElement("canvas").getContext("2d"),de=t.image,Ie=t.content,Ve=t.rotate;if(pe){te.value||(te.value=document.createElement("div"));const be=Ppe(),[ye,Me]=re(pe),we=me=>{const[De,Ge]=se(me||"",Ve,be,ye,Me,{color:a.value,fontSize:d.value,fontStyle:y.value,fontWeight:p.value,fontFamily:r.value,textAlign:S.value,textBaseline:C.value},M.value,P.value);J(De,Ge)};if(de){const me=new Image;me.onload=()=>{we(me)},me.onerror=()=>{we(Ie)},me.crossOrigin="anonymous",me.referrerPolicy="no-referrer",me.src=de}else we(Ie)}};return yr(()=>{he()}),Wt(()=>t,()=>{he()},{deep:!0,flush:"post"}),Li(()=>{q()}),hz(U,ce=>{Z.value||ce.forEach(pe=>{Rpe(pe,te.value)&&(q(),he())})},{attributes:!0,subtree:!0,childList:!0}),(ce,pe)=>(ae(),Pe("div",{ref_key:"containerRef",ref:U,style:Un([o])},[gt(ce.$slots,"default")],4))}});var zpe=dn(Dpe,[["__file","watermark.vue"]]);const Fpe=lr(zpe),Npe=un({zIndex:{type:Number,default:1001},visible:Boolean,fill:{type:String,default:"rgba(0,0,0,0.5)"},pos:{type:lt(Object)},targetAreaClickable:{type:Boolean,default:!0}}),Bpe=(e,t,o,a,d)=>{const p=xe(null),y=()=>{let P;return Nn(e.value)?P=document.querySelector(e.value):$n(e.value)?P=e.value():P=e.value,P},r=()=>{const P=y();if(!P||!t.value){p.value=null;return}Vpe(P)||P.scrollIntoView(d.value);const{left:z,top:F,width:V,height:N}=P.getBoundingClientRect();p.value={left:z,top:F,width:V,height:N,radius:0}};yr(()=>{Wt([t,e],()=>{r()},{immediate:!0}),window.addEventListener("resize",r)}),Li(()=>{window.removeEventListener("resize",r)});const S=P=>{var z;return(z=sn(o.value.offset)?o.value.offset[P]:o.value.offset)!=null?z:6},C=ee(()=>{var P;if(!p.value)return p.value;const z=S(0),F=S(1),V=((P=o.value)==null?void 0:P.radius)||2;return{left:p.value.left-z,top:p.value.top-F,width:p.value.width+z*2,height:p.value.height+F*2,radius:V}}),M=ee(()=>{const P=y();return!a.value||!P||!window.DOMRect?P||void 0:{getBoundingClientRect(){var z,F,V,N;return window.DOMRect.fromRect({width:((z=C.value)==null?void 0:z.width)||0,height:((F=C.value)==null?void 0:F.height)||0,x:((V=C.value)==null?void 0:V.left)||0,y:((N=C.value)==null?void 0:N.top)||0})}}});return{mergedPosInfo:C,triggerTarget:M}},Ox=Symbol("ElTour");function Vpe(e){const t=window.innerWidth||document.documentElement.clientWidth,o=window.innerHeight||document.documentElement.clientHeight,{top:a,right:d,bottom:p,left:y}=e.getBoundingClientRect();return a>=0&&y>=0&&d<=t&&p<=o}const $pe=(e,t,o,a,d,p,y,r)=>{const S=xe(),C=xe(),M=xe({}),P={x:S,y:C,placement:a,strategy:d,middlewareData:M},z=ee(()=>{const U=[YN(b(p)),Gfe(),Hfe(),Upe()];return b(r)&&b(o)&&U.push(XN({element:b(o)})),U}),F=async()=>{if(!Wr)return;const U=b(e),te=b(t);if(!U||!te)return;const Z=await JN(U,te,{placement:b(a),strategy:b(d),middleware:b(z)});zm(P).forEach(q=>{P[q].value=Z[q]})},V=ee(()=>{if(!b(e))return{position:"fixed",top:"50%",left:"50%",transform:"translate3d(-50%, -50%, 0)",maxWidth:"100vw",zIndex:b(y)};const{overflow:U}=b(M);return{position:b(d),zIndex:b(y),top:b(C)!=null?`${b(C)}px`:"",left:b(S)!=null?`${b(S)}px`:"",maxWidth:U!=null&&U.maxWidth?`${U==null?void 0:U.maxWidth}px`:""}}),N=ee(()=>{if(!b(r))return{};const{arrow:U}=b(M);return{left:(U==null?void 0:U.x)!=null?`${U==null?void 0:U.x}px`:"",top:(U==null?void 0:U.y)!=null?`${U==null?void 0:U.y}px`:""}});let H;return yr(()=>{const U=b(e),te=b(t);U&&te&&(H=Ufe(U,te,F)),gs(()=>{F()})}),Li(()=>{H&&H()}),{update:F,contentStyle:V,arrowStyle:N}},Upe=()=>({name:"overflow",async fn(e){const t=await jfe(e);let o=0;return t.left>0&&(o=t.left),t.right>0&&(o=t.right),{data:{maxWidth:e.rects.floating.width-o}}}}),jpe=We({name:"ElTourMask",inheritAttrs:!1}),Hpe=We({...jpe,props:Npe,setup(e){const t=e,{ns:o}=Pn(Ox),a=ee(()=>{var r,S;return(S=(r=t.pos)==null?void 0:r.radius)!=null?S:2}),d=ee(()=>{const r=a.value,S=`a${r},${r} 0 0 1`;return{topRight:`${S} ${r},${r}`,bottomRight:`${S} ${-r},${r}`,bottomLeft:`${S} ${-r},${-r}`,topLeft:`${S} ${r},${-r}`}}),p=ee(()=>{const r=window.innerWidth,S=window.innerHeight,C=d.value,M=`M${r},0 L0,0 L0,${S} L${r},${S} L${r},0 Z`,P=a.value;return t.pos?`${M} M${t.pos.left+P},${t.pos.top} h${t.pos.width-P*2} ${C.topRight} v${t.pos.height-P*2} ${C.bottomRight} h${-t.pos.width+P*2} ${C.bottomLeft} v${-t.pos.height+P*2} ${C.topLeft} z`:M}),y=ee(()=>({fill:t.fill,pointerEvents:"auto",cursor:"auto"}));return OE(hi(t,"visible"),{ns:o}),(r,S)=>r.visible?(ae(),Pe("div",kr({key:0,class:b(o).e("mask"),style:{position:"fixed",left:0,right:0,top:0,bottom:0,zIndex:r.zIndex,pointerEvents:r.pos&&r.targetAreaClickable?"none":"auto"}},r.$attrs),[(ae(),Pe("svg",{style:{width:"100%",height:"100%"}},[Ue("path",{class:fe(b(o).e("hollow")),style:Un(b(y)),d:b(p)},null,14,["d"])]))],16)):bt("v-if",!0)}});var Gpe=dn(Hpe,[["__file","mask.vue"]]);const Wpe=["absolute","fixed"],qpe=["top-start","top-end","top","bottom-start","bottom-end","bottom","left-start","left-end","left","right-start","right-end","right"],pM=un({placement:{type:lt(String),values:qpe,default:"bottom"},reference:{type:lt(Object),default:null},strategy:{type:lt(String),values:Wpe,default:"absolute"},offset:{type:Number,default:10},showArrow:Boolean,zIndex:{type:Number,default:2001}}),Kpe={close:()=>!0},Zpe=We({name:"ElTourContent"}),Ype=We({...Zpe,props:pM,emits:Kpe,setup(e,{emit:t}){const o=e,a=xe(o.placement),d=xe(o.strategy),p=xe(null),y=xe(null);Wt(()=>o.placement,()=>{a.value=o.placement});const{contentStyle:r,arrowStyle:S}=$pe(hi(o,"reference"),p,y,a,d,hi(o,"offset"),hi(o,"zIndex"),hi(o,"showArrow")),C=ee(()=>a.value.split("-")[0]),{ns:M}=Pn(Ox),P=()=>{t("close")},z=F=>{F.detail.focusReason==="pointer"&&F.preventDefault()};return(F,V)=>(ae(),Pe("div",{ref_key:"contentRef",ref:p,style:Un(b(r)),class:fe(b(M).e("content")),"data-side":b(C),tabindex:"-1"},[qe(b(ag),{loop:"",trapped:"","focus-start-el":"container","focus-trap-el":p.value||void 0,onReleaseRequested:P,onFocusoutPrevented:z},{default:ot(()=>[gt(F.$slots,"default")]),_:3},8,["focus-trap-el"]),F.showArrow?(ae(),Pe("span",{key:0,ref_key:"arrowRef",ref:y,style:Un(b(S)),class:fe(b(M).e("arrow"))},null,6)):bt("v-if",!0)],14,["data-side"]))}});var Xpe=dn(Ype,[["__file","content.vue"]]),Jpe=We({name:"ElTourSteps",props:{current:{type:Number,default:0}},emits:["update-total"],setup(e,{slots:t,emit:o}){let a=0;return()=>{var d,p;const y=(d=t.default)==null?void 0:d.call(t),r=[];let S=0;function C(M){sn(M)&&M.forEach(P=>{var z;((z=(P==null?void 0:P.type)||{})==null?void 0:z.name)==="ElTourStep"&&(r.push(P),S+=1)})}return y.length&&C(Hd((p=y[0])==null?void 0:p.children)),a!==S&&(a=S,o("update-total",S)),r.length?r[e.current]:null}}});const Qpe=un({modelValue:Boolean,current:{type:Number,default:0},showArrow:{type:Boolean,default:!0},showClose:{type:Boolean,default:!0},closeIcon:{type:Ai},placement:pM.placement,contentStyle:{type:lt([Object])},mask:{type:lt([Boolean,Object]),default:!0},gap:{type:lt(Object),default:()=>({offset:6,radius:2})},zIndex:{type:Number},scrollIntoViewOptions:{type:lt([Boolean,Object]),default:()=>({block:"center"})},type:{type:lt(String)},appendTo:{type:lt([String,Object]),default:"body"},closeOnPressEscape:{type:Boolean,default:!0},targetAreaClickable:{type:Boolean,default:!0}}),eme={[gr]:e=>Oi(e),"update:current":e=>Wn(e),close:e=>Wn(e),finish:()=>!0,change:e=>Wn(e)},tme=We({name:"ElTour"}),nme=We({...tme,props:Qpe,emits:eme,setup(e,{emit:t}){const o=e,a=Xt("tour"),d=xe(0),p=xe(),y=pz(o,"current",t,{passive:!0}),r=ee(()=>{var le;return(le=p.value)==null?void 0:le.target}),S=ee(()=>[a.b(),H.value==="primary"?a.m("primary"):""]),C=ee(()=>{var le;return((le=p.value)==null?void 0:le.placement)||o.placement}),M=ee(()=>{var le,ce;return(ce=(le=p.value)==null?void 0:le.contentStyle)!=null?ce:o.contentStyle}),P=ee(()=>{var le,ce;return(ce=(le=p.value)==null?void 0:le.mask)!=null?ce:o.mask}),z=ee(()=>!!P.value&&o.modelValue),F=ee(()=>Oi(P.value)?void 0:P.value),V=ee(()=>{var le,ce;return!!r.value&&((ce=(le=p.value)==null?void 0:le.showArrow)!=null?ce:o.showArrow)}),N=ee(()=>{var le,ce;return(ce=(le=p.value)==null?void 0:le.scrollIntoViewOptions)!=null?ce:o.scrollIntoViewOptions}),H=ee(()=>{var le,ce;return(ce=(le=p.value)==null?void 0:le.type)!=null?ce:o.type}),{nextZIndex:U}=og(),te=U(),Z=ee(()=>{var le;return(le=o.zIndex)!=null?le:te}),{mergedPosInfo:q,triggerTarget:J}=Bpe(r,hi(o,"modelValue"),hi(o,"gap"),P,N);Wt(()=>o.modelValue,le=>{le||(y.value=0)});const re=()=>{o.closeOnPressEscape&&(t("update:modelValue",!1),t("close",y.value))},se=le=>{d.value=le},he=Bo();return Vr(Ox,{currentStep:p,current:y,total:d,showClose:hi(o,"showClose"),closeIcon:hi(o,"closeIcon"),mergedType:H,ns:a,slots:he,updateModelValue(le){t("update:modelValue",le)},onClose(){t("close",y.value)},onFinish(){t("finish")},onChange(){t("change",y.value)}}),(le,ce)=>(ae(),Pe(Vn,null,[qe(b(lg),{to:le.appendTo},{default:ot(()=>{var pe,de;return[Ue("div",kr({class:b(S)},le.$attrs),[qe(Gpe,{visible:b(z),fill:(pe=b(F))==null?void 0:pe.color,style:Un((de=b(F))==null?void 0:de.style),pos:b(q),"z-index":b(Z),"target-area-clickable":le.targetAreaClickable},null,8,["visible","fill","style","pos","z-index","target-area-clickable"]),le.modelValue?(ae(),At(Xpe,{key:b(y),reference:b(J),placement:b(C),"show-arrow":b(V),"z-index":b(Z),style:Un(b(M)),onClose:re},{default:ot(()=>[qe(b(Jpe),{current:b(y),onUpdateTotal:se},{default:ot(()=>[gt(le.$slots,"default")]),_:3},8,["current"])]),_:3},8,["reference","placement","show-arrow","z-index","style"])):bt("v-if",!0)],16)]}),_:3},8,["to"]),bt(" just for IDE "),bt("v-if",!0)],64))}});var rme=dn(nme,[["__file","tour.vue"]]);const ime=un({target:{type:lt([String,Object,Function])},title:String,description:String,showClose:{type:Boolean,default:void 0},closeIcon:{type:Ai},showArrow:{type:Boolean,default:void 0},placement:pM.placement,mask:{type:lt([Boolean,Object]),default:void 0},contentStyle:{type:lt([Object])},prevButtonProps:{type:lt(Object)},nextButtonProps:{type:lt(Object)},scrollIntoViewOptions:{type:lt([Boolean,Object]),default:void 0},type:{type:lt(String)}}),ome={close:()=>!0},sme=We({name:"ElTourStep"}),ame=We({...sme,props:ime,emits:ome,setup(e,{emit:t}){const o=e,{Close:a}=nE,{t:d}=qr(),{currentStep:p,current:y,total:r,showClose:S,closeIcon:C,mergedType:M,ns:P,slots:z,updateModelValue:F,onClose:V,onFinish:N,onChange:H}=Pn(Ox);Wt(o,he=>{p.value=he},{immediate:!0});const U=ee(()=>{var he;return(he=o.showClose)!=null?he:S.value}),te=ee(()=>{var he,le;return(le=(he=o.closeIcon)!=null?he:C.value)!=null?le:a}),Z=he=>{if(he)return Rq(he,["children","onClick"])},q=()=>{var he,le;y.value-=1,(he=o.prevButtonProps)!=null&&he.onClick&&((le=o.prevButtonProps)==null||le.onClick()),H()},J=()=>{var he;y.value>=r.value-1?re():y.value+=1,(he=o.nextButtonProps)!=null&&he.onClick&&o.nextButtonProps.onClick(),H()},re=()=>{se(),N()},se=()=>{F(!1),V(),t("close")};return(he,le)=>(ae(),Pe(Vn,null,[b(U)?(ae(),Pe("button",{key:0,"aria-label":"Close",class:fe(b(P).e("closebtn")),type:"button",onClick:se},[qe(b(zn),{class:fe(b(P).e("close"))},{default:ot(()=>[(ae(),At(Ir(b(te))))]),_:1},8,["class"])],2)):bt("v-if",!0),Ue("header",{class:fe([b(P).e("header"),{"show-close":b(S)}])},[gt(he.$slots,"header",{},()=>[Ue("span",{role:"heading",class:fe(b(P).e("title"))},fn(he.title),3)])],2),Ue("div",{class:fe(b(P).e("body"))},[gt(he.$slots,"default",{},()=>[Ue("span",null,fn(he.description),1)])],2),Ue("footer",{class:fe(b(P).e("footer"))},[Ue("div",{class:fe(b(P).b("indicators"))},[b(z).indicators?(ae(),At(Ir(b(z).indicators),{key:0,current:b(y),total:b(r)},null,8,["current","total"])):(ae(!0),Pe(Vn,{key:1},Fr(b(r),(ce,pe)=>(ae(),Pe("span",{key:ce,class:fe([b(P).b("indicator"),pe===b(y)?"is-active":""])},null,2))),128))],2),Ue("div",{class:fe(b(P).b("buttons"))},[b(y)>0?(ae(),At(b(ts),kr({key:0,size:"small",type:b(M)},Z(he.prevButtonProps),{onClick:q}),{default:ot(()=>{var ce,pe;return[Nr(fn((pe=(ce=he.prevButtonProps)==null?void 0:ce.children)!=null?pe:b(d)("el.tour.previous")),1)]}),_:1},16,["type"])):bt("v-if",!0),b(y)<=b(r)-1?(ae(),At(b(ts),kr({key:1,size:"small",type:b(M)==="primary"?"default":"primary"},Z(he.nextButtonProps),{onClick:J}),{default:ot(()=>{var ce,pe;return[Nr(fn((pe=(ce=he.nextButtonProps)==null?void 0:ce.children)!=null?pe:b(y)===b(r)-1?b(d)("el.tour.finish"):b(d)("el.tour.next")),1)]}),_:1},16,["type"])):bt("v-if",!0)],2)],2)],64))}});var _B=dn(ame,[["__file","step.vue"]]);const lme=lr(rme,{TourStep:_B}),ume=oo(_B),cme=un({container:{type:lt([String,Object])},offset:{type:Number,default:0},bound:{type:Number,default:15},duration:{type:Number,default:300},marker:{type:Boolean,default:!0},type:{type:lt(String),default:"default"},direction:{type:lt(String),default:"vertical"},selectScrollTop:{type:Boolean,default:!1}}),dme={change:e=>Nn(e),click:(e,t)=>e instanceof MouseEvent&&(Nn(t)||ai(t))},yB=Symbol("anchor"),Fb=e=>{if(!Wr||e==="")return null;if(Nn(e))try{return document.querySelector(e)}catch{return null}return e};function fme(e){let t=0;const o=(...a)=>{t&&Th(t),t=Zd(()=>{e(...a),t=0})};return o.cancel=()=>{Th(t),t=0},o}const hme=We({name:"ElAnchor"}),pme=We({...hme,props:cme,emits:dme,setup(e,{expose:t,emit:o}){const a=e,d=xe(""),p=xe(null),y=xe(null),r=xe(),S={};let C=!1,M=0;const P=Xt("anchor"),z=ee(()=>[P.b(),a.type==="underline"?P.m("underline"):"",P.m(a.direction)]),F=he=>{S[he.href]=he.el},V=he=>{delete S[he]},N=he=>{d.value!==he&&(d.value=he,o("change",he))};let H=null;const U=he=>{if(!r.value)return;const le=Fb(he);if(!le)return;H&&H(),C=!0;const ce=P3(le,r.value),pe=uT(le,ce),de=ce.scrollHeight-ce.clientHeight,Ie=Math.min(pe-a.offset,de);H=D9(r.value,M,Ie,a.duration,()=>{setTimeout(()=>{C=!1},20)})},te=he=>{he&&(N(he),U(he))},Z=(he,le)=>{o("click",he,le),te(le)},q=fme(()=>{r.value&&(M=R3(r.value));const he=J();C||ai(he)||N(he)}),J=()=>{if(!r.value)return;const he=R3(r.value),le=[];for(const ce of Object.keys(S)){const pe=Fb(ce);if(!pe)continue;const de=P3(pe,r.value),Ie=uT(pe,de);le.push({top:Ie-a.offset-a.bound,href:ce})}le.sort((ce,pe)=>ce.top-pe.top);for(let ce=0;ce<le.length;ce++){const pe=le[ce],de=le[ce+1];if(ce===0&&he===0)return a.selectScrollTop?pe.href:"";if(pe.top<=he&&(!de||de.top>he))return pe.href}},re=()=>{const he=Fb(a.container);!he||fx(he)?r.value=window:r.value=he};Si(r,"scroll",q);const se=ee(()=>{if(!p.value||!y.value||!d.value)return{};const he=S[d.value];if(!he)return{};const le=p.value.getBoundingClientRect(),ce=y.value.getBoundingClientRect(),pe=he.getBoundingClientRect();return a.direction==="horizontal"?{left:`${pe.left-le.left}px`,width:`${pe.width}px`,opacity:1}:{top:`${pe.top-le.top+(pe.height-ce.height)/2}px`,opacity:1}});return yr(()=>{re();const he=decodeURIComponent(window.location.hash);Fb(he)?te(he):q()}),Wt(()=>a.container,()=>{re()}),Vr(yB,{ns:P,direction:a.direction,currentAnchor:d,addLink:F,removeLink:V,handleClick:Z}),t({scrollTo:te}),(he,le)=>(ae(),Pe("div",{ref_key:"anchorRef",ref:p,class:fe(b(z))},[he.marker?(ae(),Pe("div",{key:0,ref_key:"markerRef",ref:y,class:fe(b(P).e("marker")),style:Un(b(se))},null,6)):bt("v-if",!0),Ue("div",{class:fe(b(P).e("list"))},[gt(he.$slots,"default")],2)],2))}});var mme=dn(pme,[["__file","anchor.vue"]]);const gme=un({title:String,href:String}),_me=We({name:"ElAnchorLink"}),yme=We({..._me,props:gme,setup(e){const t=e,o=xe(null),{ns:a,direction:d,currentAnchor:p,addLink:y,removeLink:r,handleClick:S}=Pn(yB),C=ee(()=>[a.e("link"),a.is("active",p.value===t.href)]),M=P=>{S(P,t.href)};return Wt(()=>t.href,(P,z)=>{jn(()=>{z&&r(z),P&&y({href:P,el:o.value})})}),yr(()=>{const{href:P}=t;P&&y({href:P,el:o.value})}),Li(()=>{const{href:P}=t;P&&r(P)}),(P,z)=>(ae(),Pe("div",{class:fe(b(a).e("item"))},[Ue("a",{ref_key:"linkRef",ref:o,class:fe(b(C)),href:P.href,onClick:M},[gt(P.$slots,"default",{},()=>[Nr(fn(P.title),1)])],10,["href"]),P.$slots["sub-link"]&&b(d)==="vertical"?(ae(),Pe("div",{key:0,class:fe(b(a).e("list"))},[gt(P.$slots,"sub-link")],2)):bt("v-if",!0)],2))}});var vB=dn(yme,[["__file","anchor-link.vue"]]);const vme=lr(mme,{AnchorLink:vB}),bme=oo(vB),xme=un({direction:{type:lt(String),default:"horizontal"},options:{type:lt(Array),default:()=>[]},modelValue:{type:[String,Number,Boolean],default:void 0},block:Boolean,size:zo,disabled:Boolean,validateEvent:{type:Boolean,default:!0},id:String,name:String,...cs(["ariaLabel"])}),wme={[gr]:e=>Nn(e)||Wn(e)||Oi(e),[Ii]:e=>Nn(e)||Wn(e)||Oi(e)},Sme=We({name:"ElSegmented"}),Tme=We({...Sme,props:xme,emits:wme,setup(e,{emit:t}){const o=e,a=Xt("segmented"),d=us(),p=Ro(),y=ws(),{formItem:r}=xs(),{inputId:S,isLabeledByFormItem:C}=ml(o,{formItemContext:r}),M=xe(null),P=i9(),z=si({isInit:!1,width:0,height:0,translateX:0,translateY:0,focusVisible:!1}),F=le=>{const ce=V(le);t(gr,ce),t(Ii,ce)},V=le=>xr(le)?le.value:le,N=le=>xr(le)?le.label:le,H=le=>!!(y.value||xr(le)&&le.disabled),U=le=>o.modelValue===V(le),te=le=>o.options.find(ce=>V(ce)===le),Z=le=>[a.e("item"),a.is("selected",U(le)),a.is("disabled",H(le))],q=()=>{if(!M.value)return;const le=M.value.querySelector(".is-selected"),ce=M.value.querySelector(".is-selected input");if(!le||!ce){z.width=0,z.height=0,z.translateX=0,z.translateY=0,z.focusVisible=!1;return}const pe=le.getBoundingClientRect();z.isInit=!0,o.direction==="vertical"?(z.height=pe.height,z.translateY=le.offsetTop):(z.width=pe.width,z.translateX=le.offsetLeft);try{z.focusVisible=ce.matches(":focus-visible")}catch{}},J=ee(()=>[a.b(),a.m(p.value),a.is("block",o.block)]),re=ee(()=>({width:o.direction==="vertical"?"100%":`${z.width}px`,height:o.direction==="vertical"?`${z.height}px`:"100%",transform:o.direction==="vertical"?`translateY(${z.translateY}px)`:`translateX(${z.translateX}px)`,display:z.isInit?"block":"none"})),se=ee(()=>[a.e("item-selected"),a.is("disabled",H(te(o.modelValue))),a.is("focus-visible",z.focusVisible)]),he=ee(()=>o.name||d.value);return ro(M,q),Wt(P,q),Wt(()=>o.modelValue,()=>{var le;q(),o.validateEvent&&((le=r==null?void 0:r.validate)==null||le.call(r,"change").catch(ce=>void 0))},{flush:"post"}),(le,ce)=>le.options.length?(ae(),Pe("div",{key:0,id:b(S),ref_key:"segmentedRef",ref:M,class:fe(b(J)),role:"radiogroup","aria-label":b(C)?void 0:le.ariaLabel||"segmented","aria-labelledby":b(C)?b(r).labelId:void 0},[Ue("div",{class:fe([b(a).e("group"),b(a).m(o.direction)])},[Ue("div",{style:Un(b(re)),class:fe(b(se))},null,6),(ae(!0),Pe(Vn,null,Fr(le.options,(pe,de)=>(ae(),Pe("label",{key:de,class:fe(Z(pe))},[Ue("input",{class:fe(b(a).e("item-input")),type:"radio",name:b(he),disabled:H(pe),checked:U(pe),onChange:Ie=>F(pe)},null,42,["name","disabled","checked","onChange"]),Ue("div",{class:fe(b(a).e("item-label"))},[gt(le.$slots,"default",{item:pe},()=>[Nr(fn(N(pe)),1)])],2)],2))),128))],2)],10,["id","aria-label","aria-labelledby"])):bt("v-if",!0)}});var Cme=dn(Tme,[["__file","segmented.vue"]]);const Eme=lr(Cme),Mme=(e,t)=>{const o=e.toLowerCase();return(t.label||t.value).toLowerCase().includes(o)},Ime=(e,t,o)=>{const{selectionEnd:a}=e;if(a===null)return;const d=e.value,p=Fs(t);let y=-1,r;for(let S=a-1;S>=0;--S){const C=d[S];if(C===o||C===`
`||C==="\r"){y=S;continue}if(p.includes(C)){const M=y===-1?a:y;r={pattern:d.slice(S+1,M),start:S+1,end:M,prefix:C,prefixIndex:S,splitIndex:y,selectionEnd:a};break}}return r},Ame=(e,t={debug:!1,useSelectionEnd:!1})=>{const o=e.selectionStart!==null?e.selectionStart:0,a=e.selectionEnd!==null?e.selectionEnd:0,d=t.useSelectionEnd?a:o,p=["direction","boxSizing","width","height","overflowX","overflowY","borderTopWidth","borderRightWidth","borderBottomWidth","borderLeftWidth","borderStyle","paddingTop","paddingRight","paddingBottom","paddingLeft","fontStyle","fontVariant","fontWeight","fontStretch","fontSize","fontSizeAdjust","lineHeight","fontFamily","textAlign","textTransform","textIndent","textDecoration","letterSpacing","wordSpacing","tabSize","MozTabSize"];if(t.debug){const z=document.querySelector("#input-textarea-caret-position-mirror-div");z!=null&&z.parentNode&&z.parentNode.removeChild(z)}const y=document.createElement("div");y.id="input-textarea-caret-position-mirror-div",document.body.appendChild(y);const r=y.style,S=window.getComputedStyle(e),C=e.nodeName==="INPUT";r.whiteSpace=C?"nowrap":"pre-wrap",C||(r.wordWrap="break-word"),r.position="absolute",t.debug||(r.visibility="hidden"),p.forEach(z=>{if(C&&z==="lineHeight")if(S.boxSizing==="border-box"){const F=Number.parseInt(S.height),V=Number.parseInt(S.paddingTop)+Number.parseInt(S.paddingBottom)+Number.parseInt(S.borderTopWidth)+Number.parseInt(S.borderBottomWidth),N=V+Number.parseInt(S.lineHeight);F>N?r.lineHeight=`${F-V}px`:F===N?r.lineHeight=S.lineHeight:r.lineHeight="0"}else r.lineHeight=S.height;else r[z]=S[z]}),yx()?e.scrollHeight>Number.parseInt(S.height)&&(r.overflowY="scroll"):r.overflow="hidden",y.textContent=e.value.slice(0,Math.max(0,d)),C&&y.textContent&&(y.textContent=y.textContent.replace(/\s/g,""));const M=document.createElement("span");M.textContent=e.value.slice(Math.max(0,d))||".",M.style.position="relative",M.style.left=`${-e.scrollLeft}px`,M.style.top=`${-e.scrollTop}px`,y.appendChild(M);const P={top:M.offsetTop+Number.parseInt(S.borderTopWidth),left:M.offsetLeft+Number.parseInt(S.borderLeftWidth),height:Number.parseInt(S.fontSize)*1.5};return t.debug?M.style.backgroundColor="#aaa":document.body.removeChild(y),P.left>=e.clientWidth&&(P.left=e.clientWidth),P},kme=un({...iE,options:{type:lt(Array),default:()=>[]},prefix:{type:lt([String,Array]),default:"@",validator:e=>Nn(e)?e.length===1:e.every(t=>Nn(t)&&t.length===1)},split:{type:String,default:" ",validator:e=>e.length===1},filterOption:{type:lt([Boolean,Function]),default:()=>Mme,validator:e=>e===!1?!0:$n(e)},placement:{type:lt(String),default:"bottom"},showArrow:Boolean,offset:{type:Number,default:0},whole:Boolean,checkIsWhole:{type:lt(Function)},modelValue:String,loading:Boolean,popperClass:{type:String,default:""},popperOptions:{type:lt(Object),default:()=>({})}}),Pme={[gr]:e=>Nn(e),search:(e,t)=>Nn(e)&&Nn(t),select:(e,t)=>Nn(e.value)&&Nn(t),focus:e=>e instanceof FocusEvent,blur:e=>e instanceof FocusEvent},Rme=un({options:{type:lt(Array),default:()=>[]},loading:Boolean,disabled:Boolean,contentId:String,ariaLabel:String}),Ome={select:e=>Nn(e.value)},Lme=We({name:"ElMentionDropdown"}),Dme=We({...Lme,props:Rme,emits:Ome,setup(e,{expose:t,emit:o}){const a=e,d=Xt("mention"),{t:p}=qr(),y=xe(-1),r=xe(),S=xe(),C=xe(),M=(Z,q)=>[d.be("dropdown","item"),d.is("hovering",y.value===q),d.is("disabled",Z.disabled||a.disabled)],P=Z=>{Z.disabled||a.disabled||o("select",Z)},z=Z=>{y.value=Z},F=ee(()=>a.disabled||a.options.every(Z=>Z.disabled)),V=ee(()=>a.options[y.value]),N=()=>{V.value&&o("select",V.value)},H=Z=>{const{options:q}=a;if(q.length===0||F.value)return;Z==="next"?(y.value++,y.value===q.length&&(y.value=0)):Z==="prev"&&(y.value--,y.value<0&&(y.value=q.length-1));const J=q[y.value];if(J.disabled){H(Z);return}jn(()=>U(J))},U=Z=>{var q,J,re,se;const{options:he}=a,le=he.findIndex(pe=>pe.value===Z.value),ce=(q=S.value)==null?void 0:q[le];if(ce){const pe=(re=(J=C.value)==null?void 0:J.querySelector)==null?void 0:re.call(J,`.${d.be("dropdown","wrap")}`);pe&&XC(pe,ce)}(se=r.value)==null||se.handleScroll()};return Wt(()=>a.options,()=>{F.value||a.options.length===0?y.value=-1:y.value=0},{immediate:!0}),t({hoveringIndex:y,navigateOptions:H,selectHoverOption:N,hoverOption:V}),(Z,q)=>(ae(),Pe("div",{ref_key:"dropdownRef",ref:C,class:fe(b(d).b("dropdown"))},[Z.$slots.header?(ae(),Pe("div",{key:0,class:fe(b(d).be("dropdown","header"))},[gt(Z.$slots,"header")],2)):bt("v-if",!0),hr(qe(b(Hu),{id:Z.contentId,ref_key:"scrollbarRef",ref:r,tag:"ul","wrap-class":b(d).be("dropdown","wrap"),"view-class":b(d).be("dropdown","list"),role:"listbox","aria-label":Z.ariaLabel,"aria-orientation":"vertical"},{default:ot(()=>[(ae(!0),Pe(Vn,null,Fr(Z.options,(J,re)=>(ae(),Pe("li",{id:`${Z.contentId}-${re}`,ref_for:!0,ref_key:"optionRefs",ref:S,key:re,class:fe(M(J,re)),role:"option","aria-disabled":J.disabled||Z.disabled||void 0,"aria-selected":y.value===re,onMousemove:se=>z(re),onClick:Jn(se=>P(J),["stop"])},[gt(Z.$slots,"label",{item:J,index:re},()=>{var se;return[Ue("span",null,fn((se=J.label)!=null?se:J.value),1)]})],42,["id","aria-disabled","aria-selected","onMousemove","onClick"]))),128))]),_:3},8,["id","wrap-class","view-class","aria-label"]),[[ii,Z.options.length>0&&!Z.loading]]),Z.loading?(ae(),Pe("div",{key:1,class:fe(b(d).be("dropdown","loading"))},[gt(Z.$slots,"loading",{},()=>[Nr(fn(b(p)("el.mention.loading")),1)])],2)):bt("v-if",!0),Z.$slots.footer?(ae(),Pe("div",{key:2,class:fe(b(d).be("dropdown","footer"))},[gt(Z.$slots,"footer")],2)):bt("v-if",!0)],2))}});var zme=dn(Dme,[["__file","mention-dropdown.vue"]]);const Fme=We({name:"ElMention",inheritAttrs:!1}),Nme=We({...Fme,props:kme,emits:Pme,setup(e,{expose:t,emit:o}){const a=e,d=ee(()=>Wl(a,Object.keys(iE))),p=Xt("mention"),y=ws(),r=us(),S=xe(),C=xe(),M=xe(),P=xe(!1),z=xe(),F=xe(),V=ee(()=>a.showArrow?a.placement:`${a.placement}-start`),N=ee(()=>a.showArrow?["bottom","top"]:["bottom-start","top-start"]),H=ee(()=>{const{filterOption:de,options:Ie}=a;return!F.value||!de?Ie:Ie.filter(Ve=>de(F.value.pattern,Ve))}),U=ee(()=>P.value&&(!!H.value.length||a.loading)),te=ee(()=>{var de;return`${r.value}-${(de=M.value)==null?void 0:de.hoveringIndex}`}),Z=de=>{o("update:modelValue",de),le()},q=de=>{var Ie,Ve,be,ye;if(!(!("code"in de)||(Ie=S.value)!=null&&Ie.isComposing))switch(de.code){case Cn.left:case Cn.right:le();break;case Cn.up:case Cn.down:if(!P.value)return;de.preventDefault(),(Ve=M.value)==null||Ve.navigateOptions(de.code===Cn.up?"prev":"next");break;case Cn.enter:case Cn.numpadEnter:if(!P.value)return;de.preventDefault(),(be=M.value)!=null&&be.hoverOption?(ye=M.value)==null||ye.selectHoverOption():P.value=!1;break;case Cn.esc:if(!P.value)return;de.preventDefault(),P.value=!1;break;case Cn.backspace:if(a.whole&&F.value){const{splitIndex:Me,selectionEnd:we,pattern:me,prefixIndex:De,prefix:Ge}=F.value,rt=he();if(!rt)return;const Oe=rt.value,Ct=a.options.find(Bt=>Bt.value===me);if(($n(a.checkIsWhole)?a.checkIsWhole(me,Ge):Ct)&&Me!==-1&&Me+1===we){de.preventDefault();const Bt=Oe.slice(0,De)+Oe.slice(Me+1);o(gr,Bt);const _t=De;jn(()=>{rt.selectionStart=_t,rt.selectionEnd=_t,pe()})}}}},{wrapperRef:J}=af(S,{beforeFocus(){return y.value},afterFocus(){le()},beforeBlur(de){var Ie;return(Ie=C.value)==null?void 0:Ie.isFocusInsideContent(de)},afterBlur(){P.value=!1}}),re=()=>{le()},se=de=>{if(!F.value)return;const Ie=he();if(!Ie)return;const Ve=Ie.value,{split:be}=a,ye=Ve.slice(F.value.end),Me=ye.startsWith(be),we=`${de.value}${Me?"":be}`,me=Ve.slice(0,F.value.start)+we+ye;o(gr,me),o("select",de,F.value.prefix);const De=F.value.start+we.length+(Me?1:0);jn(()=>{Ie.selectionStart=De,Ie.selectionEnd=De,Ie.focus(),pe()})},he=()=>{var de,Ie;return a.type==="textarea"?(de=S.value)==null?void 0:de.textarea:(Ie=S.value)==null?void 0:Ie.input},le=()=>{setTimeout(()=>{ce(),pe(),jn(()=>{var de;return(de=C.value)==null?void 0:de.updatePopper()})},0)},ce=()=>{const de=he();if(!de)return;const Ie=Ame(de),Ve=de.getBoundingClientRect(),be=S.value.$el.getBoundingClientRect();z.value={position:"absolute",width:0,height:`${Ie.height}px`,left:`${Ie.left+Ve.left-be.left}px`,top:`${Ie.top+Ve.top-be.top}px`}},pe=()=>{const de=he();if(document.activeElement!==de){P.value=!1;return}const{prefix:Ie,split:Ve}=a;if(F.value=Ime(de,Ie,Ve),F.value&&F.value.splitIndex===-1){P.value=!0,o("search",F.value.pattern,F.value.prefix);return}P.value=!1};return t({input:S,tooltip:C,dropdownVisible:U}),(de,Ie)=>(ae(),Pe("div",{ref_key:"wrapperRef",ref:J,class:fe([b(p).b(),b(p).is("disabled",b(y))])},[qe(b(Bs),kr(kr(b(d),de.$attrs),{ref_key:"elInputRef",ref:S,"model-value":de.modelValue,disabled:b(y),role:b(U)?"combobox":void 0,"aria-activedescendant":b(U)?b(te)||"":void 0,"aria-controls":b(U)?b(r):void 0,"aria-expanded":b(U)||void 0,"aria-label":de.ariaLabel,"aria-autocomplete":b(U)?"none":void 0,"aria-haspopup":b(U)?"listbox":void 0,onInput:Z,onKeydown:q,onMousedown:re}),cl({_:2},[Fr(de.$slots,(Ve,be)=>({name:be,fn:ot(ye=>[gt(de.$slots,be,Gl(Wd(ye)))])}))]),1040,["model-value","disabled","role","aria-activedescendant","aria-controls","aria-expanded","aria-label","aria-autocomplete","aria-haspopup"]),qe(b(bs),{ref_key:"tooltipRef",ref:C,visible:b(U),"popper-class":[b(p).e("popper"),de.popperClass],"popper-options":de.popperOptions,placement:b(V),"fallback-placements":b(N),effect:"light",pure:"",offset:de.offset,"show-arrow":de.showArrow},{default:ot(()=>[Ue("div",{style:Un(z.value)},null,4)]),content:ot(()=>{var Ve;return[qe(zme,{ref_key:"dropdownRef",ref:M,options:b(H),disabled:b(y),loading:de.loading,"content-id":b(r),"aria-label":de.ariaLabel,onSelect:se,onClick:Jn((Ve=S.value)==null?void 0:Ve.focus,["stop"])},cl({_:2},[Fr(de.$slots,(be,ye)=>({name:ye,fn:ot(Me=>[gt(de.$slots,ye,Gl(Wd(Me)))])}))]),1032,["options","disabled","loading","content-id","aria-label","onClick"])]}),_:3},8,["visible","popper-class","popper-options","placement","fallback-placements","offset","show-arrow"])],2))}});var Bme=dn(Nme,[["__file","mention.vue"]]);const Vme=lr(Bme);var $me=[V9,sK,eX,wde,sX,hX,a4,CX,EX,ts,p4,gJ,xJ,NJ,BJ,BQ,z4,GQ,pl,QJ,M4,YQ,fee,hee,wx,Bee,Uee,ete,tte,nte,rte,ite,mne,Cne,Ene,Nne,mF,Kne,Fre,Nre,Bre,TF,Nie,Bie,zn,Yie,MF,Bs,IF,doe,_oe,Foe,Noe,Boe,Voe,Woe,zse,Use,Xse,r4,FF,L4,fQ,dQ,aae,fae,vae,Hu,Ch,A1,gse,Xae,sle,ale,Ele,Ple,YF,Ule,Xle,Jle,iue,fce,hce,xde,Fde,Nde,Um,jde,Dte,Zde,efe,tfe,bs,uhe,whe,$1,$he,ipe,Mpe,Fpe,lme,ume,vme,bme,Eme,Vme];const rl="ElInfiniteScroll",Ume=50,jme=200,Hme=0,Gme={delay:{type:Number,default:jme},distance:{type:Number,default:Hme},disabled:{type:Boolean,default:!1},immediate:{type:Boolean,default:!0}},mM=(e,t)=>Object.entries(Gme).reduce((o,[a,d])=>{var p,y;const{type:r,default:S}=d,C=e.getAttribute(`infinite-scroll-${a}`);let M=(y=(p=t[C])!=null?p:C)!=null?y:S;return M=M==="false"?!1:M,M=r(M),o[a]=Number.isNaN(M)?S:M,o},{}),bB=e=>{const{observer:t}=e[rl];t&&(t.disconnect(),delete e[rl].observer)},Wme=(e,t)=>{const{container:o,containerEl:a,instance:d,observer:p,lastScrollTop:y}=e[rl],{disabled:r,distance:S}=mM(e,d),{clientHeight:C,scrollHeight:M,scrollTop:P}=a,z=P-y;if(e[rl].lastScrollTop=P,p||r||z<0)return;let F=!1;if(o===e)F=M-(C+P)<=S;else{const{clientTop:V,scrollHeight:N}=e,H=uT(e,a);F=P+C>=H+V+N-S}F&&t.call(d)};function CS(e,t){const{containerEl:o,instance:a}=e[rl],{disabled:d}=mM(e,a);d||o.clientHeight===0||(o.scrollHeight<=o.clientHeight?t.call(a):bB(e))}const qme={async mounted(e,t){const{instance:o,value:a}=t;$n(a)||No(rl,"'v-infinite-scroll' binding value must be a function"),await jn();const{delay:d,immediate:p}=mM(e,o),y=YC(e,!0),r=y===window?document.documentElement:y,S=gh(Wme.bind(null,e,a),d);if(y){if(e[rl]={instance:o,container:y,containerEl:r,delay:d,cb:a,onScroll:S,lastScrollTop:r.scrollTop},p){const C=new MutationObserver(gh(CS.bind(null,e,a),Ume));e[rl].observer=C,C.observe(e,{childList:!0,subtree:!0}),CS(e,a)}y.addEventListener("scroll",S)}},unmounted(e){if(!e[rl])return;const{container:t,onScroll:o}=e[rl];t==null||t.removeEventListener("scroll",o),bB(e)},async updated(e){if(!e[rl])await jn();else{const{containerEl:t,cb:o,observer:a}=e[rl];t.clientHeight&&a&&CS(e,o)}}},JT=qme;JT.install=e=>{e.directive("InfiniteScroll",JT)};const Kme=JT;function Zme(e){let t;const o=xe(!1),a=si({...e,originalPosition:"",originalOverflow:"",visible:!1});function d(z){a.text=z}function p(){const z=a.parent,F=P.ns;if(!z.vLoadingAddClassList){let V=z.getAttribute("loading-number");V=Number.parseInt(V)-1,V?z.setAttribute("loading-number",V.toString()):(Vs(z,F.bm("parent","relative")),z.removeAttribute("loading-number")),Vs(z,F.bm("parent","hidden"))}y(),M.unmount()}function y(){var z,F;(F=(z=P.$el)==null?void 0:z.parentNode)==null||F.removeChild(P.$el)}function r(){var z;e.beforeClose&&!e.beforeClose()||(o.value=!0,clearTimeout(t),t=setTimeout(S,400),a.visible=!1,(z=e.closed)==null||z.call(e))}function S(){if(!o.value)return;const z=a.parent;o.value=!1,z.vLoadingAddClassList=void 0,p()}const M=mD(We({name:"ElLoading",setup(z,{expose:F}){const{ns:V,zIndex:N}=mx("loading");return F({ns:V,zIndex:N}),()=>{const H=a.spinner||a.svg,U=Zn("svg",{class:"circular",viewBox:a.svgViewBox?a.svgViewBox:"0 0 50 50",...H?{innerHTML:H}:{}},[Zn("circle",{class:"path",cx:"25",cy:"25",r:"20",fill:"none"})]),te=a.text?Zn("p",{class:V.b("text")},[a.text]):void 0;return Zn(rs,{name:V.b("fade"),onAfterLeave:S},{default:ot(()=>[hr(qe("div",{style:{backgroundColor:a.background||""},class:[V.b("mask"),a.customClass,a.fullscreen?"is-fullscreen":""]},[Zn("div",{class:V.b("spinner")},[U,te])]),[[ii,a.visible]])])})}}})),P=M.mount(document.createElement("div"));return{...Go(a),setText:d,removeElLoadingChild:y,close:r,handleAfterLeave:S,vm:P,get $el(){return P.$el}}}let Nb;const QT=function(e={}){if(!Wr)return;const t=Yme(e);if(t.fullscreen&&Nb)return Nb;const o=Zme({...t,closed:()=>{var d;(d=t.closed)==null||d.call(t),t.fullscreen&&(Nb=void 0)}});Xme(t,t.parent,o),wO(t,t.parent,o),t.parent.vLoadingAddClassList=()=>wO(t,t.parent,o);let a=t.parent.getAttribute("loading-number");return a?a=`${Number.parseInt(a)+1}`:a="1",t.parent.setAttribute("loading-number",a),t.parent.appendChild(o.$el),jn(()=>o.visible.value=t.visible),t.fullscreen&&(Nb=o),o},Yme=e=>{var t,o,a,d;let p;return Nn(e.target)?p=(t=document.querySelector(e.target))!=null?t:document.body:p=e.target||document.body,{parent:p===document.body||e.body?document.body:p,background:e.background||"",svg:e.svg||"",svgViewBox:e.svgViewBox||"",spinner:e.spinner||!1,text:e.text||"",fullscreen:p===document.body&&((o=e.fullscreen)!=null?o:!0),lock:(a=e.lock)!=null?a:!1,customClass:e.customClass||"",visible:(d=e.visible)!=null?d:!0,beforeClose:e.beforeClose,closed:e.closed,target:p}},Xme=async(e,t,o)=>{const{nextZIndex:a}=o.vm.zIndex||o.vm._.exposed.zIndex,d={};if(e.fullscreen)o.originalPosition.value=Tc(document.body,"position"),o.originalOverflow.value=Tc(document.body,"overflow"),d.zIndex=a();else if(e.parent===document.body){o.originalPosition.value=Tc(document.body,"position"),await jn();for(const p of["top","left"]){const y=p==="top"?"scrollTop":"scrollLeft";d[p]=`${e.target.getBoundingClientRect()[p]+document.body[y]+document.documentElement[y]-Number.parseInt(Tc(document.body,`margin-${p}`),10)}px`}for(const p of["height","width"])d[p]=`${e.target.getBoundingClientRect()[p]}px`}else o.originalPosition.value=Tc(t,"position");for(const[p,y]of Object.entries(d))o.$el.style[p]=y},wO=(e,t,o)=>{const a=o.vm.ns||o.vm._.exposed.ns;["absolute","fixed","sticky"].includes(o.originalPosition.value)?Vs(t,a.bm("parent","relative")):ol(t,a.bm("parent","relative")),e.fullscreen&&e.lock?ol(t,a.bm("parent","hidden")):Vs(t,a.bm("parent","hidden"))},l1=Symbol("ElLoading"),SO=(e,t)=>{var o,a,d,p;const y=t.instance,r=z=>xr(t.value)?t.value[z]:void 0,S=z=>{const F=Nn(z)&&(y==null?void 0:y[z])||z;return F&&xe(F)},C=z=>S(r(z)||e.getAttribute(`element-loading-${Rc(z)}`)),M=(o=r("fullscreen"))!=null?o:t.modifiers.fullscreen,P={text:C("text"),svg:C("svg"),svgViewBox:C("svgViewBox"),spinner:C("spinner"),background:C("background"),customClass:C("customClass"),fullscreen:M,target:(a=r("target"))!=null?a:M?void 0:e,body:(d=r("body"))!=null?d:t.modifiers.body,lock:(p=r("lock"))!=null?p:t.modifiers.lock};e[l1]={options:P,instance:QT(P)}},Jme=(e,t)=>{for(const o of Object.keys(t))Ti(t[o])&&(t[o].value=e[o])},TO={mounted(e,t){t.value&&SO(e,t)},updated(e,t){const o=e[l1];t.oldValue!==t.value&&(t.value&&!t.oldValue?SO(e,t):t.value&&t.oldValue?xr(t.value)&&Jme(t.value,o.options):o==null||o.instance.close())},unmounted(e){var t;(t=e[l1])==null||t.instance.close(),e[l1]=null}},Qme={install(e){e.directive("loading",TO),e.config.globalProperties.$loading=QT},directive:TO,service:QT},xB=["success","info","warning","error"],Ls=io({customClass:"",center:!1,dangerouslyUseHTMLString:!1,duration:3e3,icon:void 0,id:"",message:"",onClose:void 0,showClose:!1,type:"info",plain:!1,offset:16,zIndex:0,grouping:!1,repeatNum:1,appendTo:Wr?document.body:void 0}),ege=un({customClass:{type:String,default:Ls.customClass},center:{type:Boolean,default:Ls.center},dangerouslyUseHTMLString:{type:Boolean,default:Ls.dangerouslyUseHTMLString},duration:{type:Number,default:Ls.duration},icon:{type:Ai,default:Ls.icon},id:{type:String,default:Ls.id},message:{type:lt([String,Object,Function]),default:Ls.message},onClose:{type:lt(Function),default:Ls.onClose},showClose:{type:Boolean,default:Ls.showClose},type:{type:String,values:xB,default:Ls.type},plain:{type:Boolean,default:Ls.plain},offset:{type:Number,default:Ls.offset},zIndex:{type:Number,default:Ls.zIndex},grouping:{type:Boolean,default:Ls.grouping},repeatNum:{type:Number,default:Ls.repeatNum}}),tge={destroy:()=>!0},ql=cL([]),nge=e=>{const t=ql.findIndex(d=>d.id===e),o=ql[t];let a;return t>0&&(a=ql[t-1]),{current:o,prev:a}},rge=e=>{const{prev:t}=nge(e);return t?t.vm.exposed.bottom.value:0},ige=(e,t)=>ql.findIndex(a=>a.id===e)>0?16:t,oge=We({name:"ElMessage"}),sge=We({...oge,props:ege,emits:tge,setup(e,{expose:t}){const o=e,{Close:a}=rE,{ns:d,zIndex:p}=mx("message"),{currentZIndex:y,nextZIndex:r}=p,S=xe(),C=xe(!1),M=xe(0);let P;const z=ee(()=>o.type?o.type==="error"?"danger":o.type:"info"),F=ee(()=>{const se=o.type;return{[d.bm("icon",se)]:se&&Qd[se]}}),V=ee(()=>o.icon||Qd[o.type]||""),N=ee(()=>rge(o.id)),H=ee(()=>ige(o.id,o.offset)+N.value),U=ee(()=>M.value+H.value),te=ee(()=>({top:`${H.value}px`,zIndex:y.value}));function Z(){o.duration!==0&&({stop:P}=Sh(()=>{J()},o.duration))}function q(){P==null||P()}function J(){C.value=!1}function re({code:se}){se===Cn.esc&&J()}return yr(()=>{Z(),r(),C.value=!0}),Wt(()=>o.repeatNum,()=>{q(),Z()}),Si(document,"keydown",re),ro(S,()=>{M.value=S.value.getBoundingClientRect().height}),t({visible:C,bottom:U,close:J}),(se,he)=>(ae(),At(rs,{name:b(d).b("fade"),onBeforeLeave:se.onClose,onAfterLeave:le=>se.$emit("destroy"),persisted:""},{default:ot(()=>[hr(Ue("div",{id:se.id,ref_key:"messageRef",ref:S,class:fe([b(d).b(),{[b(d).m(se.type)]:se.type},b(d).is("center",se.center),b(d).is("closable",se.showClose),b(d).is("plain",se.plain),se.customClass]),style:Un(b(te)),role:"alert",onMouseenter:q,onMouseleave:Z},[se.repeatNum>1?(ae(),At(b(a4),{key:0,value:se.repeatNum,type:b(z),class:fe(b(d).e("badge"))},null,8,["value","type","class"])):bt("v-if",!0),b(V)?(ae(),At(b(zn),{key:1,class:fe([b(d).e("icon"),b(F)])},{default:ot(()=>[(ae(),At(Ir(b(V))))]),_:1},8,["class"])):bt("v-if",!0),gt(se.$slots,"default",{},()=>[se.dangerouslyUseHTMLString?(ae(),Pe(Vn,{key:1},[bt(" Caution here, message could've been compromised, never use user's input as message "),Ue("p",{class:fe(b(d).e("content")),innerHTML:se.message},null,10,["innerHTML"])],2112)):(ae(),Pe("p",{key:0,class:fe(b(d).e("content"))},fn(se.message),3))]),se.showClose?(ae(),At(b(zn),{key:2,class:fe(b(d).e("closeBtn")),onClick:Jn(J,["stop"])},{default:ot(()=>[qe(b(a))]),_:1},8,["class","onClick"])):bt("v-if",!0)],46,["id"]),[[ii,C.value]])]),_:3},8,["name","onBeforeLeave","onAfterLeave"]))}});var age=dn(sge,[["__file","message.vue"]]);let lge=1;const wB=e=>{const t=!e||Nn(e)||Ji(e)||$n(e)?{message:e}:e,o={...Ls,...t};if(!o.appendTo)o.appendTo=document.body;else if(Nn(o.appendTo)){let a=document.querySelector(o.appendTo);ea(a)||(a=document.body),o.appendTo=a}return Oi(jl.grouping)&&!o.grouping&&(o.grouping=jl.grouping),Wn(jl.duration)&&o.duration===3e3&&(o.duration=jl.duration),Wn(jl.offset)&&o.offset===16&&(o.offset=jl.offset),Oi(jl.showClose)&&!o.showClose&&(o.showClose=jl.showClose),o},uge=e=>{const t=ql.indexOf(e);if(t===-1)return;ql.splice(t,1);const{handler:o}=e;o.close()},cge=({appendTo:e,...t},o)=>{const a=`message_${lge++}`,d=t.onClose,p=document.createElement("div"),y={...t,id:a,onClose:()=>{d==null||d(),uge(M)},onDestroy:()=>{qd(null,p)}},r=qe(age,y,$n(y.message)||Ji(y.message)?{default:$n(y.message)?y.message:()=>y.message}:null);r.appContext=o||Zm._context,qd(r,p),e.appendChild(p.firstElementChild);const S=r.component,M={id:a,vnode:r,vm:S,handler:{close:()=>{S.exposed.visible.value=!1}},props:r.component.props};return M},Zm=(e={},t)=>{if(!Wr)return{close:()=>{}};const o=wB(e);if(o.grouping&&ql.length){const d=ql.find(({vnode:p})=>{var y;return((y=p.props)==null?void 0:y.message)===o.message});if(d)return d.props.repeatNum+=1,d.props.type=o.type,d.handler}if(Wn(jl.max)&&ql.length>=jl.max)return{close:()=>{}};const a=cge(o,t);return ql.push(a),a.handler};xB.forEach(e=>{Zm[e]=(t={},o)=>{const a=wB(t);return Zm({...a,type:e},o)}});function dge(e){for(const t of ql)(!e||e===t.props.type)&&t.handler.close()}Zm.closeAll=dge;Zm._context=null;const fge=Mz(Zm,"$message"),eC="_trap-focus-children",fh=[],CO=e=>{if(fh.length===0)return;const t=fh[fh.length-1][eC];if(t.length>0&&e.code===Cn.tab){if(t.length===1){e.preventDefault(),document.activeElement!==t[0]&&t[0].focus();return}const o=e.shiftKey,a=e.target===t[0],d=e.target===t[t.length-1];a&&o&&(e.preventDefault(),t[t.length-1].focus()),d&&!o&&(e.preventDefault(),t[0].focus())}},hge={beforeMount(e){e[eC]=F3(e),fh.push(e),fh.length<=1&&document.addEventListener("keydown",CO)},updated(e){jn(()=>{e[eC]=F3(e)})},unmounted(){fh.shift(),fh.length===0&&document.removeEventListener("keydown",CO)}},pge=We({name:"ElMessageBox",directives:{TrapFocus:hge},components:{ElButton:ts,ElFocusTrap:ag,ElInput:Bs,ElOverlay:RE,ElIcon:zn,...rE},inheritAttrs:!1,props:{buttonSize:{type:String,validator:JF},modal:{type:Boolean,default:!0},lockScroll:{type:Boolean,default:!0},showClose:{type:Boolean,default:!0},closeOnClickModal:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0},closeOnHashChange:{type:Boolean,default:!0},center:Boolean,draggable:Boolean,overflow:Boolean,roundButton:{default:!1,type:Boolean},container:{type:String,default:"body"},boxType:{type:String,default:""}},emits:["vanish","action"],setup(e,{emit:t}){const{locale:o,zIndex:a,ns:d,size:p}=mx("message-box",ee(()=>e.buttonSize)),{t:y}=o,{nextZIndex:r}=a,S=xe(!1),C=si({autofocus:!0,beforeClose:null,callback:null,cancelButtonText:"",cancelButtonClass:"",confirmButtonText:"",confirmButtonClass:"",customClass:"",customStyle:{},dangerouslyUseHTMLString:!1,distinguishCancelAndClose:!1,icon:"",inputPattern:null,inputPlaceholder:"",inputType:"text",inputValue:null,inputValidator:null,inputErrorMessage:"",message:null,modalFade:!0,modalClass:"",showCancelButton:!1,showConfirmButton:!0,type:"",title:void 0,showInput:!1,action:"",confirmButtonLoading:!1,cancelButtonLoading:!1,confirmButtonLoadingIcon:Ou(Fu),cancelButtonLoadingIcon:Ou(Fu),confirmButtonDisabled:!1,editorErrorMessage:"",validateError:!1,zIndex:r()}),M=ee(()=>{const ye=C.type;return{[d.bm("icon",ye)]:ye&&Qd[ye]}}),P=us(),z=us(),F=ee(()=>C.icon||Qd[C.type]||""),V=ee(()=>!!C.message),N=xe(),H=xe(),U=xe(),te=xe(),Z=xe(),q=ee(()=>C.confirmButtonClass);Wt(()=>C.inputValue,async ye=>{await jn(),e.boxType==="prompt"&&ye!==null&&de()},{immediate:!0}),Wt(()=>S.value,ye=>{var Me,we;ye&&(e.boxType!=="prompt"&&(C.autofocus?U.value=(we=(Me=Z.value)==null?void 0:Me.$el)!=null?we:N.value:U.value=N.value),C.zIndex=r()),e.boxType==="prompt"&&(ye?jn().then(()=>{var me;te.value&&te.value.$el&&(C.autofocus?U.value=(me=Ie())!=null?me:N.value:U.value=N.value)}):(C.editorErrorMessage="",C.validateError=!1))});const J=ee(()=>e.draggable),re=ee(()=>e.overflow);dF(N,H,J,re),yr(async()=>{await jn(),e.closeOnHashChange&&window.addEventListener("hashchange",se)}),Li(()=>{e.closeOnHashChange&&window.removeEventListener("hashchange",se)});function se(){S.value&&(S.value=!1,jn(()=>{C.action&&t("action",C.action)}))}const he=()=>{e.closeOnClickModal&&pe(C.distinguishCancelAndClose?"close":"cancel")},le=PE(he),ce=ye=>{if(C.inputType!=="textarea")return ye.preventDefault(),pe("confirm")},pe=ye=>{var Me;e.boxType==="prompt"&&ye==="confirm"&&!de()||(C.action=ye,C.beforeClose?(Me=C.beforeClose)==null||Me.call(C,ye,C,se):se())},de=()=>{if(e.boxType==="prompt"){const ye=C.inputPattern;if(ye&&!ye.test(C.inputValue||""))return C.editorErrorMessage=C.inputErrorMessage||y("el.messagebox.error"),C.validateError=!0,!1;const Me=C.inputValidator;if($n(Me)){const we=Me(C.inputValue);if(we===!1)return C.editorErrorMessage=C.inputErrorMessage||y("el.messagebox.error"),C.validateError=!0,!1;if(Nn(we))return C.editorErrorMessage=we,C.validateError=!0,!1}}return C.editorErrorMessage="",C.validateError=!1,!0},Ie=()=>{const ye=te.value.$refs;return ye.input||ye.textarea},Ve=()=>{pe("close")},be=()=>{e.closeOnPressEscape&&Ve()};return e.lockScroll&&OE(S),{...Go(C),ns:d,overlayEvent:le,visible:S,hasMessage:V,typeClass:M,contentId:P,inputId:z,btnSize:p,iconComponent:F,confirmButtonClasses:q,rootRef:N,focusStartRef:U,headerRef:H,inputRef:te,confirmRef:Z,doClose:se,handleClose:Ve,onCloseRequested:be,handleWrapperClick:he,handleInputEnter:ce,handleAction:pe,t:y}}});function mge(e,t,o,a,d,p){const y=Er("el-icon"),r=Er("close"),S=Er("el-input"),C=Er("el-button"),M=Er("el-focus-trap"),P=Er("el-overlay");return ae(),At(rs,{name:"fade-in-linear",onAfterLeave:z=>e.$emit("vanish"),persisted:""},{default:ot(()=>[hr(qe(P,{"z-index":e.zIndex,"overlay-class":[e.ns.is("message-box"),e.modalClass],mask:e.modal},{default:ot(()=>[Ue("div",{role:"dialog","aria-label":e.title,"aria-modal":"true","aria-describedby":e.showInput?void 0:e.contentId,class:fe(`${e.ns.namespace.value}-overlay-message-box`),onClick:e.overlayEvent.onClick,onMousedown:e.overlayEvent.onMousedown,onMouseup:e.overlayEvent.onMouseup},[qe(M,{loop:"",trapped:e.visible,"focus-trap-el":e.rootRef,"focus-start-el":e.focusStartRef,onReleaseRequested:e.onCloseRequested},{default:ot(()=>[Ue("div",{ref:"rootRef",class:fe([e.ns.b(),e.customClass,e.ns.is("draggable",e.draggable),{[e.ns.m("center")]:e.center}]),style:Un(e.customStyle),tabindex:"-1",onClick:Jn(()=>{},["stop"])},[e.title!==null&&e.title!==void 0?(ae(),Pe("div",{key:0,ref:"headerRef",class:fe([e.ns.e("header"),{"show-close":e.showClose}])},[Ue("div",{class:fe(e.ns.e("title"))},[e.iconComponent&&e.center?(ae(),At(y,{key:0,class:fe([e.ns.e("status"),e.typeClass])},{default:ot(()=>[(ae(),At(Ir(e.iconComponent)))]),_:1},8,["class"])):bt("v-if",!0),Ue("span",null,fn(e.title),1)],2),e.showClose?(ae(),Pe("button",{key:0,type:"button",class:fe(e.ns.e("headerbtn")),"aria-label":e.t("el.messagebox.close"),onClick:z=>e.handleAction(e.distinguishCancelAndClose?"close":"cancel"),onKeydown:Ri(Jn(z=>e.handleAction(e.distinguishCancelAndClose?"close":"cancel"),["prevent"]),["enter"])},[qe(y,{class:fe(e.ns.e("close"))},{default:ot(()=>[qe(r)]),_:1},8,["class"])],42,["aria-label","onClick","onKeydown"])):bt("v-if",!0)],2)):bt("v-if",!0),Ue("div",{id:e.contentId,class:fe(e.ns.e("content"))},[Ue("div",{class:fe(e.ns.e("container"))},[e.iconComponent&&!e.center&&e.hasMessage?(ae(),At(y,{key:0,class:fe([e.ns.e("status"),e.typeClass])},{default:ot(()=>[(ae(),At(Ir(e.iconComponent)))]),_:1},8,["class"])):bt("v-if",!0),e.hasMessage?(ae(),Pe("div",{key:1,class:fe(e.ns.e("message"))},[gt(e.$slots,"default",{},()=>[e.dangerouslyUseHTMLString?(ae(),At(Ir(e.showInput?"label":"p"),{key:1,for:e.showInput?e.inputId:void 0,innerHTML:e.message},null,8,["for","innerHTML"])):(ae(),At(Ir(e.showInput?"label":"p"),{key:0,for:e.showInput?e.inputId:void 0},{default:ot(()=>[Nr(fn(e.dangerouslyUseHTMLString?"":e.message),1)]),_:1},8,["for"]))])],2)):bt("v-if",!0)],2),hr(Ue("div",{class:fe(e.ns.e("input"))},[qe(S,{id:e.inputId,ref:"inputRef",modelValue:e.inputValue,"onUpdate:modelValue":z=>e.inputValue=z,type:e.inputType,placeholder:e.inputPlaceholder,"aria-invalid":e.validateError,class:fe({invalid:e.validateError}),onKeydown:Ri(e.handleInputEnter,["enter"])},null,8,["id","modelValue","onUpdate:modelValue","type","placeholder","aria-invalid","class","onKeydown"]),Ue("div",{class:fe(e.ns.e("errormsg")),style:Un({visibility:e.editorErrorMessage?"visible":"hidden"})},fn(e.editorErrorMessage),7)],2),[[ii,e.showInput]])],10,["id"]),Ue("div",{class:fe(e.ns.e("btns"))},[e.showCancelButton?(ae(),At(C,{key:0,loading:e.cancelButtonLoading,"loading-icon":e.cancelButtonLoadingIcon,class:fe([e.cancelButtonClass]),round:e.roundButton,size:e.btnSize,onClick:z=>e.handleAction("cancel"),onKeydown:Ri(Jn(z=>e.handleAction("cancel"),["prevent"]),["enter"])},{default:ot(()=>[Nr(fn(e.cancelButtonText||e.t("el.messagebox.cancel")),1)]),_:1},8,["loading","loading-icon","class","round","size","onClick","onKeydown"])):bt("v-if",!0),hr(qe(C,{ref:"confirmRef",type:"primary",loading:e.confirmButtonLoading,"loading-icon":e.confirmButtonLoadingIcon,class:fe([e.confirmButtonClasses]),round:e.roundButton,disabled:e.confirmButtonDisabled,size:e.btnSize,onClick:z=>e.handleAction("confirm"),onKeydown:Ri(Jn(z=>e.handleAction("confirm"),["prevent"]),["enter"])},{default:ot(()=>[Nr(fn(e.confirmButtonText||e.t("el.messagebox.confirm")),1)]),_:1},8,["loading","loading-icon","class","round","disabled","size","onClick","onKeydown"]),[[ii,e.showConfirmButton]])],2)],14,["onClick"])]),_:3},8,["trapped","focus-trap-el","focus-start-el","onReleaseRequested"])],42,["aria-label","aria-describedby","onClick","onMousedown","onMouseup"])]),_:3},8,["z-index","overlay-class","mask"]),[[ii,e.visible]])]),_:3},8,["onAfterLeave"])}var gge=dn(pge,[["render",mge],["__file","index.vue"]]);const Zy=new Map,_ge=e=>{let t=document.body;return e.appendTo&&(Nn(e.appendTo)&&(t=document.querySelector(e.appendTo)),ea(e.appendTo)&&(t=e.appendTo),ea(t)||(t=document.body)),t},yge=(e,t,o=null)=>{const a=qe(gge,e,$n(e.message)||Ji(e.message)?{default:$n(e.message)?e.message:()=>e.message}:null);return a.appContext=o,qd(a,t),_ge(e).appendChild(t.firstElementChild),a.component},vge=()=>document.createElement("div"),bge=(e,t)=>{const o=vge();e.onVanish=()=>{qd(null,o),Zy.delete(d)},e.onAction=p=>{const y=Zy.get(d);let r;e.showInput?r={value:d.inputValue,action:p}:r=p,e.callback?e.callback(r,a.proxy):p==="cancel"||p==="close"?e.distinguishCancelAndClose&&p!=="cancel"?y.reject("close"):y.reject("cancel"):y.resolve(r)};const a=yge(e,o,t),d=a.proxy;for(const p in e)ri(e,p)&&!ri(d.$props,p)&&(d[p]=e[p]);return d.visible=!0,d};function fg(e,t=null){if(!Wr)return Promise.reject();let o;return Nn(e)||Ji(e)?e={message:e}:o=e.callback,new Promise((a,d)=>{const p=bge(e,t??fg._context);Zy.set(p,{options:e,callback:o,resolve:a,reject:d})})}const xge=["alert","confirm","prompt"],wge={alert:{closeOnPressEscape:!1,closeOnClickModal:!1},confirm:{showCancelButton:!0},prompt:{showCancelButton:!0,showInput:!0}};xge.forEach(e=>{fg[e]=Sge(e)});function Sge(e){return(t,o,a,d)=>{let p="";return xr(o)?(a=o,p=""):ai(o)?p="":p=o,fg(Object.assign({title:p,message:t,type:"",...wge[e]},a,{boxType:e}),d)}}fg.close=()=>{Zy.forEach((e,t)=>{t.doClose()}),Zy.clear()};fg._context=null;const Od=fg;Od.install=e=>{Od._context=e._context,e.config.globalProperties.$msgbox=Od,e.config.globalProperties.$messageBox=Od,e.config.globalProperties.$alert=Od.alert,e.config.globalProperties.$confirm=Od.confirm,e.config.globalProperties.$prompt=Od.prompt};const Tge=Od,SB=["success","info","warning","error"],Cge=un({customClass:{type:String,default:""},dangerouslyUseHTMLString:Boolean,duration:{type:Number,default:4500},icon:{type:Ai},id:{type:String,default:""},message:{type:lt([String,Object,Function]),default:""},offset:{type:Number,default:0},onClick:{type:lt(Function),default:()=>{}},onClose:{type:lt(Function),required:!0},position:{type:String,values:["top-right","top-left","bottom-right","bottom-left"],default:"top-right"},showClose:{type:Boolean,default:!0},title:{type:String,default:""},type:{type:String,values:[...SB,""],default:""},zIndex:Number}),Ege={destroy:()=>!0},Mge=We({name:"ElNotification"}),Ige=We({...Mge,props:Cge,emits:Ege,setup(e,{expose:t}){const o=e,{ns:a,zIndex:d}=mx("notification"),{nextZIndex:p,currentZIndex:y}=d,{Close:r}=nE,S=xe(!1);let C;const M=ee(()=>{const Z=o.type;return Z&&Qd[o.type]?a.m(Z):""}),P=ee(()=>o.type&&Qd[o.type]||o.icon),z=ee(()=>o.position.endsWith("right")?"right":"left"),F=ee(()=>o.position.startsWith("top")?"top":"bottom"),V=ee(()=>{var Z;return{[F.value]:`${o.offset}px`,zIndex:(Z=o.zIndex)!=null?Z:y.value}});function N(){o.duration>0&&({stop:C}=Sh(()=>{S.value&&U()},o.duration))}function H(){C==null||C()}function U(){S.value=!1}function te({code:Z}){Z===Cn.delete||Z===Cn.backspace?H():Z===Cn.esc?S.value&&U():N()}return yr(()=>{N(),p(),S.value=!0}),Si(document,"keydown",te),t({visible:S,close:U}),(Z,q)=>(ae(),At(rs,{name:b(a).b("fade"),onBeforeLeave:Z.onClose,onAfterLeave:J=>Z.$emit("destroy"),persisted:""},{default:ot(()=>[hr(Ue("div",{id:Z.id,class:fe([b(a).b(),Z.customClass,b(z)]),style:Un(b(V)),role:"alert",onMouseenter:H,onMouseleave:N,onClick:Z.onClick},[b(P)?(ae(),At(b(zn),{key:0,class:fe([b(a).e("icon"),b(M)])},{default:ot(()=>[(ae(),At(Ir(b(P))))]),_:1},8,["class"])):bt("v-if",!0),Ue("div",{class:fe(b(a).e("group"))},[Ue("h2",{class:fe(b(a).e("title")),textContent:fn(Z.title)},null,10,["textContent"]),hr(Ue("div",{class:fe(b(a).e("content")),style:Un(Z.title?void 0:{margin:0})},[gt(Z.$slots,"default",{},()=>[Z.dangerouslyUseHTMLString?(ae(),Pe(Vn,{key:1},[bt(" Caution here, message could've been compromised, never use user's input as message "),Ue("p",{innerHTML:Z.message},null,8,["innerHTML"])],2112)):(ae(),Pe("p",{key:0},fn(Z.message),1))])],6),[[ii,Z.message]]),Z.showClose?(ae(),At(b(zn),{key:0,class:fe(b(a).e("closeBtn")),onClick:Jn(U,["stop"])},{default:ot(()=>[qe(b(r))]),_:1},8,["class","onClick"])):bt("v-if",!0)],2)],46,["id","onClick"]),[[ii,S.value]])]),_:3},8,["name","onBeforeLeave","onAfterLeave"]))}});var Age=dn(Ige,[["__file","notification.vue"]]);const U1={"top-left":[],"top-right":[],"bottom-left":[],"bottom-right":[]},tC=16;let kge=1;const Ym=function(e={},t){if(!Wr)return{close:()=>{}};(Nn(e)||Ji(e))&&(e={message:e});const o=e.position||"top-right";let a=e.offset||0;U1[o].forEach(({vm:M})=>{var P;a+=(((P=M.el)==null?void 0:P.offsetHeight)||0)+tC}),a+=tC;const d=`notification_${kge++}`,p=e.onClose,y={...e,offset:a,id:d,onClose:()=>{Pge(d,o,p)}};let r=document.body;ea(e.appendTo)?r=e.appendTo:Nn(e.appendTo)&&(r=document.querySelector(e.appendTo)),ea(r)||(r=document.body);const S=document.createElement("div"),C=qe(Age,y,$n(y.message)?y.message:Ji(y.message)?()=>y.message:null);return C.appContext=ai(t)?Ym._context:t,C.props.onDestroy=()=>{qd(null,S)},qd(C,S),U1[o].push({vm:C}),r.appendChild(S.firstElementChild),{close:()=>{C.component.exposed.visible.value=!1}}};SB.forEach(e=>{Ym[e]=(t={},o)=>((Nn(t)||Ji(t))&&(t={message:t}),Ym({...t,type:e},o))});function Pge(e,t,o){const a=U1[t],d=a.findIndex(({vm:C})=>{var M;return((M=C.component)==null?void 0:M.props.id)===e});if(d===-1)return;const{vm:p}=a[d];if(!p)return;o==null||o(p);const y=p.el.offsetHeight,r=t.split("-")[0];a.splice(d,1);const S=a.length;if(!(S<1))for(let C=d;C<S;C++){const{el:M,component:P}=a[C].vm,z=Number.parseInt(M.style[r],10)-y-tC;P.props.offset=z}}function Rge(){for(const e of Object.values(U1))e.forEach(({vm:t})=>{t.component.exposed.visible.value=!1})}Ym.closeAll=Rge;Ym._context=null;const Oge=Mz(Ym,"$notify");var Lge=[Kme,Qme,fge,Tge,Oge,zF],Dge=k9([...$me,...Lge]),Lx={};/*!
 * vite-plugin-qiankun.js v1.0.14
 * (c) 2021-2022 Teng Mao Qing
 * Released under the MIT License.
 */Object.defineProperty(Lx,"__esModule",{value:!0});var _m=typeof window<"u"?window.proxy||window:{},TB=function(e){_m!=null&&_m.__POWERED_BY_QIANKUN__&&(window.moudleQiankunAppLifeCycles||(window.moudleQiankunAppLifeCycles={}),_m.qiankunName&&(window.moudleQiankunAppLifeCycles[_m.qiankunName]=e))};Lx.default=TB;var zge=Lx.qiankunWindow=_m,Fge=Lx.renderWithQiankun=TB,CB={exports:{}};(function(e,t){(function(o,a){e.exports=a()})(Gu,function(){var o,a,d;function p(r,S){if(!o)o=S;else if(!a)a=S;else{var C="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+o+")(sharedChunk); ("+a+")(sharedChunk); self.onerror = null;",M={};o(M),d=S(M),typeof window<"u"&&window&&window.URL&&window.URL.createObjectURL&&(d.workerUrl=window.URL.createObjectURL(new Blob([C],{type:"text/javascript"})))}}p(["exports"],function(r){function S(u){return u&&u.__esModule&&Object.prototype.hasOwnProperty.call(u,"default")?u.default:u}var C,M={},P={};function z(){if(C)return P;C=1,Object.defineProperty(P,"__esModule",{value:!0}),P.setMatrixArrayType=function(g){P.ARRAY_TYPE=n=g},P.toRadian=function(g){return g*c},P.equals=function(g,f){return Math.abs(g-f)<=u*Math.max(1,Math.abs(g),Math.abs(f))},P.RANDOM=P.ARRAY_TYPE=P.EPSILON=void 0;var u=1e-6;P.EPSILON=u;var n=typeof Float32Array<"u"?Float32Array:Array;P.ARRAY_TYPE=n;var s=Math.random;P.RANDOM=s;var c=Math.PI/180;return Math.hypot||(Math.hypot=function(){for(var g=0,f=arguments.length;f--;)g+=arguments[f]*arguments[f];return Math.sqrt(g)}),P}var F,V={};function N(){if(F)return V;function u(f){return u=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(_){return typeof _}:function(_){return _&&typeof Symbol=="function"&&_.constructor===Symbol&&_!==Symbol.prototype?"symbol":typeof _},u(f)}F=1,Object.defineProperty(V,"__esModule",{value:!0}),V.create=function(){var f=new n.ARRAY_TYPE(4);return n.ARRAY_TYPE!=Float32Array&&(f[1]=0,f[2]=0),f[0]=1,f[3]=1,f},V.clone=function(f){var _=new n.ARRAY_TYPE(4);return _[0]=f[0],_[1]=f[1],_[2]=f[2],_[3]=f[3],_},V.copy=function(f,_){return f[0]=_[0],f[1]=_[1],f[2]=_[2],f[3]=_[3],f},V.identity=function(f){return f[0]=1,f[1]=0,f[2]=0,f[3]=1,f},V.fromValues=function(f,_,T,A){var D=new n.ARRAY_TYPE(4);return D[0]=f,D[1]=_,D[2]=T,D[3]=A,D},V.set=function(f,_,T,A,D){return f[0]=_,f[1]=T,f[2]=A,f[3]=D,f},V.transpose=function(f,_){if(f===_){var T=_[1];f[1]=_[2],f[2]=T}else f[0]=_[0],f[1]=_[2],f[2]=_[1],f[3]=_[3];return f},V.invert=function(f,_){var T=_[0],A=_[1],D=_[2],w=_[3],k=T*w-D*A;return k?(f[0]=w*(k=1/k),f[1]=-A*k,f[2]=-D*k,f[3]=T*k,f):null},V.adjoint=function(f,_){var T=_[0];return f[0]=_[3],f[1]=-_[1],f[2]=-_[2],f[3]=T,f},V.determinant=function(f){return f[0]*f[3]-f[2]*f[1]},V.multiply=c,V.rotate=function(f,_,T){var A=_[0],D=_[1],w=_[2],k=_[3],O=Math.sin(T),I=Math.cos(T);return f[0]=A*I+w*O,f[1]=D*I+k*O,f[2]=A*-O+w*I,f[3]=D*-O+k*I,f},V.scale=function(f,_,T){var A=_[1],D=_[2],w=_[3],k=T[0],O=T[1];return f[0]=_[0]*k,f[1]=A*k,f[2]=D*O,f[3]=w*O,f},V.fromRotation=function(f,_){var T=Math.sin(_),A=Math.cos(_);return f[0]=A,f[1]=T,f[2]=-T,f[3]=A,f},V.fromScaling=function(f,_){return f[0]=_[0],f[1]=0,f[2]=0,f[3]=_[1],f},V.str=function(f){return"mat2("+f[0]+", "+f[1]+", "+f[2]+", "+f[3]+")"},V.frob=function(f){return Math.hypot(f[0],f[1],f[2],f[3])},V.LDU=function(f,_,T,A){return f[2]=A[2]/A[0],T[0]=A[0],T[1]=A[1],T[3]=A[3]-f[2]*T[1],[f,_,T]},V.add=function(f,_,T){return f[0]=_[0]+T[0],f[1]=_[1]+T[1],f[2]=_[2]+T[2],f[3]=_[3]+T[3],f},V.subtract=g,V.exactEquals=function(f,_){return f[0]===_[0]&&f[1]===_[1]&&f[2]===_[2]&&f[3]===_[3]},V.equals=function(f,_){var T=f[0],A=f[1],D=f[2],w=f[3],k=_[0],O=_[1],I=_[2],R=_[3];return Math.abs(T-k)<=n.EPSILON*Math.max(1,Math.abs(T),Math.abs(k))&&Math.abs(A-O)<=n.EPSILON*Math.max(1,Math.abs(A),Math.abs(O))&&Math.abs(D-I)<=n.EPSILON*Math.max(1,Math.abs(D),Math.abs(I))&&Math.abs(w-R)<=n.EPSILON*Math.max(1,Math.abs(w),Math.abs(R))},V.multiplyScalar=function(f,_,T){return f[0]=_[0]*T,f[1]=_[1]*T,f[2]=_[2]*T,f[3]=_[3]*T,f},V.multiplyScalarAndAdd=function(f,_,T,A){return f[0]=_[0]+T[0]*A,f[1]=_[1]+T[1]*A,f[2]=_[2]+T[2]*A,f[3]=_[3]+T[3]*A,f},V.sub=V.mul=void 0;var n=function(f,_){if(f&&f.__esModule)return f;if(f===null||u(f)!=="object"&&typeof f!="function")return{default:f};var T=s(void 0);if(T&&T.has(f))return T.get(f);var A={},D=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var w in f)if(w!=="default"&&Object.prototype.hasOwnProperty.call(f,w)){var k=D?Object.getOwnPropertyDescriptor(f,w):null;k&&(k.get||k.set)?Object.defineProperty(A,w,k):A[w]=f[w]}return A.default=f,T&&T.set(f,A),A}(z());function s(f){if(typeof WeakMap!="function")return null;var _=new WeakMap,T=new WeakMap;return(s=function(A){return A?T:_})(f)}function c(f,_,T){var A=_[0],D=_[1],w=_[2],k=_[3],O=T[0],I=T[1],R=T[2],B=T[3];return f[0]=A*O+w*I,f[1]=D*O+k*I,f[2]=A*R+w*B,f[3]=D*R+k*B,f}function g(f,_,T){return f[0]=_[0]-T[0],f[1]=_[1]-T[1],f[2]=_[2]-T[2],f[3]=_[3]-T[3],f}return V.mul=c,V.sub=g,V}var H,U={};function te(){if(H)return U;function u(f){return u=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(_){return typeof _}:function(_){return _&&typeof Symbol=="function"&&_.constructor===Symbol&&_!==Symbol.prototype?"symbol":typeof _},u(f)}H=1,Object.defineProperty(U,"__esModule",{value:!0}),U.create=function(){var f=new n.ARRAY_TYPE(6);return n.ARRAY_TYPE!=Float32Array&&(f[1]=0,f[2]=0,f[4]=0,f[5]=0),f[0]=1,f[3]=1,f},U.clone=function(f){var _=new n.ARRAY_TYPE(6);return _[0]=f[0],_[1]=f[1],_[2]=f[2],_[3]=f[3],_[4]=f[4],_[5]=f[5],_},U.copy=function(f,_){return f[0]=_[0],f[1]=_[1],f[2]=_[2],f[3]=_[3],f[4]=_[4],f[5]=_[5],f},U.identity=function(f){return f[0]=1,f[1]=0,f[2]=0,f[3]=1,f[4]=0,f[5]=0,f},U.fromValues=function(f,_,T,A,D,w){var k=new n.ARRAY_TYPE(6);return k[0]=f,k[1]=_,k[2]=T,k[3]=A,k[4]=D,k[5]=w,k},U.set=function(f,_,T,A,D,w,k){return f[0]=_,f[1]=T,f[2]=A,f[3]=D,f[4]=w,f[5]=k,f},U.invert=function(f,_){var T=_[0],A=_[1],D=_[2],w=_[3],k=_[4],O=_[5],I=T*w-A*D;return I?(f[0]=w*(I=1/I),f[1]=-A*I,f[2]=-D*I,f[3]=T*I,f[4]=(D*O-w*k)*I,f[5]=(A*k-T*O)*I,f):null},U.determinant=function(f){return f[0]*f[3]-f[1]*f[2]},U.multiply=c,U.rotate=function(f,_,T){var A=_[0],D=_[1],w=_[2],k=_[3],O=_[4],I=_[5],R=Math.sin(T),B=Math.cos(T);return f[0]=A*B+w*R,f[1]=D*B+k*R,f[2]=A*-R+w*B,f[3]=D*-R+k*B,f[4]=O,f[5]=I,f},U.scale=function(f,_,T){var A=_[1],D=_[2],w=_[3],k=_[4],O=_[5],I=T[0],R=T[1];return f[0]=_[0]*I,f[1]=A*I,f[2]=D*R,f[3]=w*R,f[4]=k,f[5]=O,f},U.translate=function(f,_,T){var A=_[0],D=_[1],w=_[2],k=_[3],O=_[4],I=_[5],R=T[0],B=T[1];return f[0]=A,f[1]=D,f[2]=w,f[3]=k,f[4]=A*R+w*B+O,f[5]=D*R+k*B+I,f},U.fromRotation=function(f,_){var T=Math.sin(_),A=Math.cos(_);return f[0]=A,f[1]=T,f[2]=-T,f[3]=A,f[4]=0,f[5]=0,f},U.fromScaling=function(f,_){return f[0]=_[0],f[1]=0,f[2]=0,f[3]=_[1],f[4]=0,f[5]=0,f},U.fromTranslation=function(f,_){return f[0]=1,f[1]=0,f[2]=0,f[3]=1,f[4]=_[0],f[5]=_[1],f},U.str=function(f){return"mat2d("+f[0]+", "+f[1]+", "+f[2]+", "+f[3]+", "+f[4]+", "+f[5]+")"},U.frob=function(f){return Math.hypot(f[0],f[1],f[2],f[3],f[4],f[5],1)},U.add=function(f,_,T){return f[0]=_[0]+T[0],f[1]=_[1]+T[1],f[2]=_[2]+T[2],f[3]=_[3]+T[3],f[4]=_[4]+T[4],f[5]=_[5]+T[5],f},U.subtract=g,U.multiplyScalar=function(f,_,T){return f[0]=_[0]*T,f[1]=_[1]*T,f[2]=_[2]*T,f[3]=_[3]*T,f[4]=_[4]*T,f[5]=_[5]*T,f},U.multiplyScalarAndAdd=function(f,_,T,A){return f[0]=_[0]+T[0]*A,f[1]=_[1]+T[1]*A,f[2]=_[2]+T[2]*A,f[3]=_[3]+T[3]*A,f[4]=_[4]+T[4]*A,f[5]=_[5]+T[5]*A,f},U.exactEquals=function(f,_){return f[0]===_[0]&&f[1]===_[1]&&f[2]===_[2]&&f[3]===_[3]&&f[4]===_[4]&&f[5]===_[5]},U.equals=function(f,_){var T=f[0],A=f[1],D=f[2],w=f[3],k=f[4],O=f[5],I=_[0],R=_[1],B=_[2],W=_[3],K=_[4],ie=_[5];return Math.abs(T-I)<=n.EPSILON*Math.max(1,Math.abs(T),Math.abs(I))&&Math.abs(A-R)<=n.EPSILON*Math.max(1,Math.abs(A),Math.abs(R))&&Math.abs(D-B)<=n.EPSILON*Math.max(1,Math.abs(D),Math.abs(B))&&Math.abs(w-W)<=n.EPSILON*Math.max(1,Math.abs(w),Math.abs(W))&&Math.abs(k-K)<=n.EPSILON*Math.max(1,Math.abs(k),Math.abs(K))&&Math.abs(O-ie)<=n.EPSILON*Math.max(1,Math.abs(O),Math.abs(ie))},U.sub=U.mul=void 0;var n=function(f,_){if(f&&f.__esModule)return f;if(f===null||u(f)!=="object"&&typeof f!="function")return{default:f};var T=s(void 0);if(T&&T.has(f))return T.get(f);var A={},D=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var w in f)if(w!=="default"&&Object.prototype.hasOwnProperty.call(f,w)){var k=D?Object.getOwnPropertyDescriptor(f,w):null;k&&(k.get||k.set)?Object.defineProperty(A,w,k):A[w]=f[w]}return A.default=f,T&&T.set(f,A),A}(z());function s(f){if(typeof WeakMap!="function")return null;var _=new WeakMap,T=new WeakMap;return(s=function(A){return A?T:_})(f)}function c(f,_,T){var A=_[0],D=_[1],w=_[2],k=_[3],O=_[4],I=_[5],R=T[0],B=T[1],W=T[2],K=T[3],ie=T[4],oe=T[5];return f[0]=A*R+w*B,f[1]=D*R+k*B,f[2]=A*W+w*K,f[3]=D*W+k*K,f[4]=A*ie+w*oe+O,f[5]=D*ie+k*oe+I,f}function g(f,_,T){return f[0]=_[0]-T[0],f[1]=_[1]-T[1],f[2]=_[2]-T[2],f[3]=_[3]-T[3],f[4]=_[4]-T[4],f[5]=_[5]-T[5],f}return U.mul=c,U.sub=g,U}var Z,q={};function J(){if(Z)return q;function u(f){return u=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(_){return typeof _}:function(_){return _&&typeof Symbol=="function"&&_.constructor===Symbol&&_!==Symbol.prototype?"symbol":typeof _},u(f)}Z=1,Object.defineProperty(q,"__esModule",{value:!0}),q.create=function(){var f=new n.ARRAY_TYPE(9);return n.ARRAY_TYPE!=Float32Array&&(f[1]=0,f[2]=0,f[3]=0,f[5]=0,f[6]=0,f[7]=0),f[0]=1,f[4]=1,f[8]=1,f},q.fromMat4=function(f,_){return f[0]=_[0],f[1]=_[1],f[2]=_[2],f[3]=_[4],f[4]=_[5],f[5]=_[6],f[6]=_[8],f[7]=_[9],f[8]=_[10],f},q.clone=function(f){var _=new n.ARRAY_TYPE(9);return _[0]=f[0],_[1]=f[1],_[2]=f[2],_[3]=f[3],_[4]=f[4],_[5]=f[5],_[6]=f[6],_[7]=f[7],_[8]=f[8],_},q.copy=function(f,_){return f[0]=_[0],f[1]=_[1],f[2]=_[2],f[3]=_[3],f[4]=_[4],f[5]=_[5],f[6]=_[6],f[7]=_[7],f[8]=_[8],f},q.fromValues=function(f,_,T,A,D,w,k,O,I){var R=new n.ARRAY_TYPE(9);return R[0]=f,R[1]=_,R[2]=T,R[3]=A,R[4]=D,R[5]=w,R[6]=k,R[7]=O,R[8]=I,R},q.set=function(f,_,T,A,D,w,k,O,I,R){return f[0]=_,f[1]=T,f[2]=A,f[3]=D,f[4]=w,f[5]=k,f[6]=O,f[7]=I,f[8]=R,f},q.identity=function(f){return f[0]=1,f[1]=0,f[2]=0,f[3]=0,f[4]=1,f[5]=0,f[6]=0,f[7]=0,f[8]=1,f},q.transpose=function(f,_){if(f===_){var T=_[1],A=_[2],D=_[5];f[1]=_[3],f[2]=_[6],f[3]=T,f[5]=_[7],f[6]=A,f[7]=D}else f[0]=_[0],f[1]=_[3],f[2]=_[6],f[3]=_[1],f[4]=_[4],f[5]=_[7],f[6]=_[2],f[7]=_[5],f[8]=_[8];return f},q.invert=function(f,_){var T=_[0],A=_[1],D=_[2],w=_[3],k=_[4],O=_[5],I=_[6],R=_[7],B=_[8],W=B*k-O*R,K=-B*w+O*I,ie=R*w-k*I,oe=T*W+A*K+D*ie;return oe?(f[0]=W*(oe=1/oe),f[1]=(-B*A+D*R)*oe,f[2]=(O*A-D*k)*oe,f[3]=K*oe,f[4]=(B*T-D*I)*oe,f[5]=(-O*T+D*w)*oe,f[6]=ie*oe,f[7]=(-R*T+A*I)*oe,f[8]=(k*T-A*w)*oe,f):null},q.adjoint=function(f,_){var T=_[0],A=_[1],D=_[2],w=_[3],k=_[4],O=_[5],I=_[6],R=_[7],B=_[8];return f[0]=k*B-O*R,f[1]=D*R-A*B,f[2]=A*O-D*k,f[3]=O*I-w*B,f[4]=T*B-D*I,f[5]=D*w-T*O,f[6]=w*R-k*I,f[7]=A*I-T*R,f[8]=T*k-A*w,f},q.determinant=function(f){var _=f[3],T=f[4],A=f[5],D=f[6],w=f[7],k=f[8];return f[0]*(k*T-A*w)+f[1]*(-k*_+A*D)+f[2]*(w*_-T*D)},q.multiply=c,q.translate=function(f,_,T){var A=_[0],D=_[1],w=_[2],k=_[3],O=_[4],I=_[5],R=_[6],B=_[7],W=_[8],K=T[0],ie=T[1];return f[0]=A,f[1]=D,f[2]=w,f[3]=k,f[4]=O,f[5]=I,f[6]=K*A+ie*k+R,f[7]=K*D+ie*O+B,f[8]=K*w+ie*I+W,f},q.rotate=function(f,_,T){var A=_[0],D=_[1],w=_[2],k=_[3],O=_[4],I=_[5],R=_[6],B=_[7],W=_[8],K=Math.sin(T),ie=Math.cos(T);return f[0]=ie*A+K*k,f[1]=ie*D+K*O,f[2]=ie*w+K*I,f[3]=ie*k-K*A,f[4]=ie*O-K*D,f[5]=ie*I-K*w,f[6]=R,f[7]=B,f[8]=W,f},q.scale=function(f,_,T){var A=T[0],D=T[1];return f[0]=A*_[0],f[1]=A*_[1],f[2]=A*_[2],f[3]=D*_[3],f[4]=D*_[4],f[5]=D*_[5],f[6]=_[6],f[7]=_[7],f[8]=_[8],f},q.fromTranslation=function(f,_){return f[0]=1,f[1]=0,f[2]=0,f[3]=0,f[4]=1,f[5]=0,f[6]=_[0],f[7]=_[1],f[8]=1,f},q.fromRotation=function(f,_){var T=Math.sin(_),A=Math.cos(_);return f[0]=A,f[1]=T,f[2]=0,f[3]=-T,f[4]=A,f[5]=0,f[6]=0,f[7]=0,f[8]=1,f},q.fromScaling=function(f,_){return f[0]=_[0],f[1]=0,f[2]=0,f[3]=0,f[4]=_[1],f[5]=0,f[6]=0,f[7]=0,f[8]=1,f},q.fromMat2d=function(f,_){return f[0]=_[0],f[1]=_[1],f[2]=0,f[3]=_[2],f[4]=_[3],f[5]=0,f[6]=_[4],f[7]=_[5],f[8]=1,f},q.fromQuat=function(f,_){var T=_[0],A=_[1],D=_[2],w=_[3],k=T+T,O=A+A,I=D+D,R=T*k,B=A*k,W=A*O,K=D*k,ie=D*O,oe=D*I,Q=w*k,ue=w*O,ge=w*I;return f[0]=1-W-oe,f[3]=B-ge,f[6]=K+ue,f[1]=B+ge,f[4]=1-R-oe,f[7]=ie-Q,f[2]=K-ue,f[5]=ie+Q,f[8]=1-R-W,f},q.normalFromMat4=function(f,_){var T=_[0],A=_[1],D=_[2],w=_[3],k=_[4],O=_[5],I=_[6],R=_[7],B=_[8],W=_[9],K=_[10],ie=_[11],oe=_[12],Q=_[13],ue=_[14],ge=_[15],Se=T*O-A*k,Fe=T*I-D*k,ze=T*R-w*k,Le=A*I-D*O,nt=A*R-w*O,$e=D*R-w*I,it=B*Q-W*oe,dt=B*ue-K*oe,ct=B*ge-ie*oe,mt=W*ue-K*Q,wt=W*ge-ie*Q,Mt=K*ge-ie*ue,vt=Se*Mt-Fe*wt+ze*mt+Le*ct-nt*dt+$e*it;return vt?(f[0]=(O*Mt-I*wt+R*mt)*(vt=1/vt),f[1]=(I*ct-k*Mt-R*dt)*vt,f[2]=(k*wt-O*ct+R*it)*vt,f[3]=(D*wt-A*Mt-w*mt)*vt,f[4]=(T*Mt-D*ct+w*dt)*vt,f[5]=(A*ct-T*wt-w*it)*vt,f[6]=(Q*$e-ue*nt+ge*Le)*vt,f[7]=(ue*ze-oe*$e-ge*Fe)*vt,f[8]=(oe*nt-Q*ze+ge*Se)*vt,f):null},q.projection=function(f,_,T){return f[0]=2/_,f[1]=0,f[2]=0,f[3]=0,f[4]=-2/T,f[5]=0,f[6]=-1,f[7]=1,f[8]=1,f},q.str=function(f){return"mat3("+f[0]+", "+f[1]+", "+f[2]+", "+f[3]+", "+f[4]+", "+f[5]+", "+f[6]+", "+f[7]+", "+f[8]+")"},q.frob=function(f){return Math.hypot(f[0],f[1],f[2],f[3],f[4],f[5],f[6],f[7],f[8])},q.add=function(f,_,T){return f[0]=_[0]+T[0],f[1]=_[1]+T[1],f[2]=_[2]+T[2],f[3]=_[3]+T[3],f[4]=_[4]+T[4],f[5]=_[5]+T[5],f[6]=_[6]+T[6],f[7]=_[7]+T[7],f[8]=_[8]+T[8],f},q.subtract=g,q.multiplyScalar=function(f,_,T){return f[0]=_[0]*T,f[1]=_[1]*T,f[2]=_[2]*T,f[3]=_[3]*T,f[4]=_[4]*T,f[5]=_[5]*T,f[6]=_[6]*T,f[7]=_[7]*T,f[8]=_[8]*T,f},q.multiplyScalarAndAdd=function(f,_,T,A){return f[0]=_[0]+T[0]*A,f[1]=_[1]+T[1]*A,f[2]=_[2]+T[2]*A,f[3]=_[3]+T[3]*A,f[4]=_[4]+T[4]*A,f[5]=_[5]+T[5]*A,f[6]=_[6]+T[6]*A,f[7]=_[7]+T[7]*A,f[8]=_[8]+T[8]*A,f},q.exactEquals=function(f,_){return f[0]===_[0]&&f[1]===_[1]&&f[2]===_[2]&&f[3]===_[3]&&f[4]===_[4]&&f[5]===_[5]&&f[6]===_[6]&&f[7]===_[7]&&f[8]===_[8]},q.equals=function(f,_){var T=f[0],A=f[1],D=f[2],w=f[3],k=f[4],O=f[5],I=f[6],R=f[7],B=f[8],W=_[0],K=_[1],ie=_[2],oe=_[3],Q=_[4],ue=_[5],ge=_[6],Se=_[7],Fe=_[8];return Math.abs(T-W)<=n.EPSILON*Math.max(1,Math.abs(T),Math.abs(W))&&Math.abs(A-K)<=n.EPSILON*Math.max(1,Math.abs(A),Math.abs(K))&&Math.abs(D-ie)<=n.EPSILON*Math.max(1,Math.abs(D),Math.abs(ie))&&Math.abs(w-oe)<=n.EPSILON*Math.max(1,Math.abs(w),Math.abs(oe))&&Math.abs(k-Q)<=n.EPSILON*Math.max(1,Math.abs(k),Math.abs(Q))&&Math.abs(O-ue)<=n.EPSILON*Math.max(1,Math.abs(O),Math.abs(ue))&&Math.abs(I-ge)<=n.EPSILON*Math.max(1,Math.abs(I),Math.abs(ge))&&Math.abs(R-Se)<=n.EPSILON*Math.max(1,Math.abs(R),Math.abs(Se))&&Math.abs(B-Fe)<=n.EPSILON*Math.max(1,Math.abs(B),Math.abs(Fe))},q.sub=q.mul=void 0;var n=function(f,_){if(f&&f.__esModule)return f;if(f===null||u(f)!=="object"&&typeof f!="function")return{default:f};var T=s(void 0);if(T&&T.has(f))return T.get(f);var A={},D=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var w in f)if(w!=="default"&&Object.prototype.hasOwnProperty.call(f,w)){var k=D?Object.getOwnPropertyDescriptor(f,w):null;k&&(k.get||k.set)?Object.defineProperty(A,w,k):A[w]=f[w]}return A.default=f,T&&T.set(f,A),A}(z());function s(f){if(typeof WeakMap!="function")return null;var _=new WeakMap,T=new WeakMap;return(s=function(A){return A?T:_})(f)}function c(f,_,T){var A=_[0],D=_[1],w=_[2],k=_[3],O=_[4],I=_[5],R=_[6],B=_[7],W=_[8],K=T[0],ie=T[1],oe=T[2],Q=T[3],ue=T[4],ge=T[5],Se=T[6],Fe=T[7],ze=T[8];return f[0]=K*A+ie*k+oe*R,f[1]=K*D+ie*O+oe*B,f[2]=K*w+ie*I+oe*W,f[3]=Q*A+ue*k+ge*R,f[4]=Q*D+ue*O+ge*B,f[5]=Q*w+ue*I+ge*W,f[6]=Se*A+Fe*k+ze*R,f[7]=Se*D+Fe*O+ze*B,f[8]=Se*w+Fe*I+ze*W,f}function g(f,_,T){return f[0]=_[0]-T[0],f[1]=_[1]-T[1],f[2]=_[2]-T[2],f[3]=_[3]-T[3],f[4]=_[4]-T[4],f[5]=_[5]-T[5],f[6]=_[6]-T[6],f[7]=_[7]-T[7],f[8]=_[8]-T[8],f}return q.mul=c,q.sub=g,q}var re,se={};function he(){if(re)return se;function u(w){return u=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(k){return typeof k}:function(k){return k&&typeof Symbol=="function"&&k.constructor===Symbol&&k!==Symbol.prototype?"symbol":typeof k},u(w)}re=1,Object.defineProperty(se,"__esModule",{value:!0}),se.create=function(){var w=new n.ARRAY_TYPE(16);return n.ARRAY_TYPE!=Float32Array&&(w[1]=0,w[2]=0,w[3]=0,w[4]=0,w[6]=0,w[7]=0,w[8]=0,w[9]=0,w[11]=0,w[12]=0,w[13]=0,w[14]=0),w[0]=1,w[5]=1,w[10]=1,w[15]=1,w},se.clone=function(w){var k=new n.ARRAY_TYPE(16);return k[0]=w[0],k[1]=w[1],k[2]=w[2],k[3]=w[3],k[4]=w[4],k[5]=w[5],k[6]=w[6],k[7]=w[7],k[8]=w[8],k[9]=w[9],k[10]=w[10],k[11]=w[11],k[12]=w[12],k[13]=w[13],k[14]=w[14],k[15]=w[15],k},se.copy=function(w,k){return w[0]=k[0],w[1]=k[1],w[2]=k[2],w[3]=k[3],w[4]=k[4],w[5]=k[5],w[6]=k[6],w[7]=k[7],w[8]=k[8],w[9]=k[9],w[10]=k[10],w[11]=k[11],w[12]=k[12],w[13]=k[13],w[14]=k[14],w[15]=k[15],w},se.fromValues=function(w,k,O,I,R,B,W,K,ie,oe,Q,ue,ge,Se,Fe,ze){var Le=new n.ARRAY_TYPE(16);return Le[0]=w,Le[1]=k,Le[2]=O,Le[3]=I,Le[4]=R,Le[5]=B,Le[6]=W,Le[7]=K,Le[8]=ie,Le[9]=oe,Le[10]=Q,Le[11]=ue,Le[12]=ge,Le[13]=Se,Le[14]=Fe,Le[15]=ze,Le},se.set=function(w,k,O,I,R,B,W,K,ie,oe,Q,ue,ge,Se,Fe,ze,Le){return w[0]=k,w[1]=O,w[2]=I,w[3]=R,w[4]=B,w[5]=W,w[6]=K,w[7]=ie,w[8]=oe,w[9]=Q,w[10]=ue,w[11]=ge,w[12]=Se,w[13]=Fe,w[14]=ze,w[15]=Le,w},se.identity=c,se.transpose=function(w,k){if(w===k){var O=k[1],I=k[2],R=k[3],B=k[6],W=k[7],K=k[11];w[1]=k[4],w[2]=k[8],w[3]=k[12],w[4]=O,w[6]=k[9],w[7]=k[13],w[8]=I,w[9]=B,w[11]=k[14],w[12]=R,w[13]=W,w[14]=K}else w[0]=k[0],w[1]=k[4],w[2]=k[8],w[3]=k[12],w[4]=k[1],w[5]=k[5],w[6]=k[9],w[7]=k[13],w[8]=k[2],w[9]=k[6],w[10]=k[10],w[11]=k[14],w[12]=k[3],w[13]=k[7],w[14]=k[11],w[15]=k[15];return w},se.invert=function(w,k){var O=k[0],I=k[1],R=k[2],B=k[3],W=k[4],K=k[5],ie=k[6],oe=k[7],Q=k[8],ue=k[9],ge=k[10],Se=k[11],Fe=k[12],ze=k[13],Le=k[14],nt=k[15],$e=O*K-I*W,it=O*ie-R*W,dt=O*oe-B*W,ct=I*ie-R*K,mt=I*oe-B*K,wt=R*oe-B*ie,Mt=Q*ze-ue*Fe,vt=Q*Le-ge*Fe,qt=Q*nt-Se*Fe,mn=ue*Le-ge*ze,Zt=ue*nt-Se*ze,Tn=ge*nt-Se*Le,Sn=$e*Tn-it*Zt+dt*mn+ct*qt-mt*vt+wt*Mt;return Sn?(w[0]=(K*Tn-ie*Zt+oe*mn)*(Sn=1/Sn),w[1]=(R*Zt-I*Tn-B*mn)*Sn,w[2]=(ze*wt-Le*mt+nt*ct)*Sn,w[3]=(ge*mt-ue*wt-Se*ct)*Sn,w[4]=(ie*qt-W*Tn-oe*vt)*Sn,w[5]=(O*Tn-R*qt+B*vt)*Sn,w[6]=(Le*dt-Fe*wt-nt*it)*Sn,w[7]=(Q*wt-ge*dt+Se*it)*Sn,w[8]=(W*Zt-K*qt+oe*Mt)*Sn,w[9]=(I*qt-O*Zt-B*Mt)*Sn,w[10]=(Fe*mt-ze*dt+nt*$e)*Sn,w[11]=(ue*dt-Q*mt-Se*$e)*Sn,w[12]=(K*vt-W*mn-ie*Mt)*Sn,w[13]=(O*mn-I*vt+R*Mt)*Sn,w[14]=(ze*it-Fe*ct-Le*$e)*Sn,w[15]=(Q*ct-ue*it+ge*$e)*Sn,w):null},se.adjoint=function(w,k){var O=k[0],I=k[1],R=k[2],B=k[3],W=k[4],K=k[5],ie=k[6],oe=k[7],Q=k[8],ue=k[9],ge=k[10],Se=k[11],Fe=k[12],ze=k[13],Le=k[14],nt=k[15];return w[0]=K*(ge*nt-Se*Le)-ue*(ie*nt-oe*Le)+ze*(ie*Se-oe*ge),w[1]=-(I*(ge*nt-Se*Le)-ue*(R*nt-B*Le)+ze*(R*Se-B*ge)),w[2]=I*(ie*nt-oe*Le)-K*(R*nt-B*Le)+ze*(R*oe-B*ie),w[3]=-(I*(ie*Se-oe*ge)-K*(R*Se-B*ge)+ue*(R*oe-B*ie)),w[4]=-(W*(ge*nt-Se*Le)-Q*(ie*nt-oe*Le)+Fe*(ie*Se-oe*ge)),w[5]=O*(ge*nt-Se*Le)-Q*(R*nt-B*Le)+Fe*(R*Se-B*ge),w[6]=-(O*(ie*nt-oe*Le)-W*(R*nt-B*Le)+Fe*(R*oe-B*ie)),w[7]=O*(ie*Se-oe*ge)-W*(R*Se-B*ge)+Q*(R*oe-B*ie),w[8]=W*(ue*nt-Se*ze)-Q*(K*nt-oe*ze)+Fe*(K*Se-oe*ue),w[9]=-(O*(ue*nt-Se*ze)-Q*(I*nt-B*ze)+Fe*(I*Se-B*ue)),w[10]=O*(K*nt-oe*ze)-W*(I*nt-B*ze)+Fe*(I*oe-B*K),w[11]=-(O*(K*Se-oe*ue)-W*(I*Se-B*ue)+Q*(I*oe-B*K)),w[12]=-(W*(ue*Le-ge*ze)-Q*(K*Le-ie*ze)+Fe*(K*ge-ie*ue)),w[13]=O*(ue*Le-ge*ze)-Q*(I*Le-R*ze)+Fe*(I*ge-R*ue),w[14]=-(O*(K*Le-ie*ze)-W*(I*Le-R*ze)+Fe*(I*ie-R*K)),w[15]=O*(K*ge-ie*ue)-W*(I*ge-R*ue)+Q*(I*ie-R*K),w},se.determinant=function(w){var k=w[0],O=w[1],I=w[2],R=w[3],B=w[4],W=w[5],K=w[6],ie=w[7],oe=w[8],Q=w[9],ue=w[10],ge=w[11],Se=w[12],Fe=w[13],ze=w[14],Le=w[15];return(k*W-O*B)*(ue*Le-ge*ze)-(k*K-I*B)*(Q*Le-ge*Fe)+(k*ie-R*B)*(Q*ze-ue*Fe)+(O*K-I*W)*(oe*Le-ge*Se)-(O*ie-R*W)*(oe*ze-ue*Se)+(I*ie-R*K)*(oe*Fe-Q*Se)},se.multiply=g,se.translate=function(w,k,O){var I,R,B,W,K,ie,oe,Q,ue,ge,Se,Fe,ze=O[0],Le=O[1],nt=O[2];return k===w?(w[12]=k[0]*ze+k[4]*Le+k[8]*nt+k[12],w[13]=k[1]*ze+k[5]*Le+k[9]*nt+k[13],w[14]=k[2]*ze+k[6]*Le+k[10]*nt+k[14],w[15]=k[3]*ze+k[7]*Le+k[11]*nt+k[15]):(R=k[1],B=k[2],W=k[3],K=k[4],ie=k[5],oe=k[6],Q=k[7],ue=k[8],ge=k[9],Se=k[10],Fe=k[11],w[0]=I=k[0],w[1]=R,w[2]=B,w[3]=W,w[4]=K,w[5]=ie,w[6]=oe,w[7]=Q,w[8]=ue,w[9]=ge,w[10]=Se,w[11]=Fe,w[12]=I*ze+K*Le+ue*nt+k[12],w[13]=R*ze+ie*Le+ge*nt+k[13],w[14]=B*ze+oe*Le+Se*nt+k[14],w[15]=W*ze+Q*Le+Fe*nt+k[15]),w},se.scale=function(w,k,O){var I=O[0],R=O[1],B=O[2];return w[0]=k[0]*I,w[1]=k[1]*I,w[2]=k[2]*I,w[3]=k[3]*I,w[4]=k[4]*R,w[5]=k[5]*R,w[6]=k[6]*R,w[7]=k[7]*R,w[8]=k[8]*B,w[9]=k[9]*B,w[10]=k[10]*B,w[11]=k[11]*B,w[12]=k[12],w[13]=k[13],w[14]=k[14],w[15]=k[15],w},se.rotate=function(w,k,O,I){var R,B,W,K,ie,oe,Q,ue,ge,Se,Fe,ze,Le,nt,$e,it,dt,ct,mt,wt,Mt,vt,qt,mn,Zt=I[0],Tn=I[1],Sn=I[2],On=Math.hypot(Zt,Tn,Sn);return On<n.EPSILON?null:(Zt*=On=1/On,Tn*=On,Sn*=On,R=Math.sin(O),B=Math.cos(O),ie=k[1],oe=k[2],Q=k[3],ge=k[5],Se=k[6],Fe=k[7],Le=k[9],nt=k[10],$e=k[11],it=Zt*Zt*(W=1-B)+B,mt=Zt*Tn*W-Sn*R,wt=Tn*Tn*W+B,Mt=Sn*Tn*W+Zt*R,vt=Zt*Sn*W+Tn*R,qt=Tn*Sn*W-Zt*R,mn=Sn*Sn*W+B,w[0]=(K=k[0])*it+(ue=k[4])*(dt=Tn*Zt*W+Sn*R)+(ze=k[8])*(ct=Sn*Zt*W-Tn*R),w[1]=ie*it+ge*dt+Le*ct,w[2]=oe*it+Se*dt+nt*ct,w[3]=Q*it+Fe*dt+$e*ct,w[4]=K*mt+ue*wt+ze*Mt,w[5]=ie*mt+ge*wt+Le*Mt,w[6]=oe*mt+Se*wt+nt*Mt,w[7]=Q*mt+Fe*wt+$e*Mt,w[8]=K*vt+ue*qt+ze*mn,w[9]=ie*vt+ge*qt+Le*mn,w[10]=oe*vt+Se*qt+nt*mn,w[11]=Q*vt+Fe*qt+$e*mn,k!==w&&(w[12]=k[12],w[13]=k[13],w[14]=k[14],w[15]=k[15]),w)},se.rotateX=function(w,k,O){var I=Math.sin(O),R=Math.cos(O),B=k[4],W=k[5],K=k[6],ie=k[7],oe=k[8],Q=k[9],ue=k[10],ge=k[11];return k!==w&&(w[0]=k[0],w[1]=k[1],w[2]=k[2],w[3]=k[3],w[12]=k[12],w[13]=k[13],w[14]=k[14],w[15]=k[15]),w[4]=B*R+oe*I,w[5]=W*R+Q*I,w[6]=K*R+ue*I,w[7]=ie*R+ge*I,w[8]=oe*R-B*I,w[9]=Q*R-W*I,w[10]=ue*R-K*I,w[11]=ge*R-ie*I,w},se.rotateY=function(w,k,O){var I=Math.sin(O),R=Math.cos(O),B=k[0],W=k[1],K=k[2],ie=k[3],oe=k[8],Q=k[9],ue=k[10],ge=k[11];return k!==w&&(w[4]=k[4],w[5]=k[5],w[6]=k[6],w[7]=k[7],w[12]=k[12],w[13]=k[13],w[14]=k[14],w[15]=k[15]),w[0]=B*R-oe*I,w[1]=W*R-Q*I,w[2]=K*R-ue*I,w[3]=ie*R-ge*I,w[8]=B*I+oe*R,w[9]=W*I+Q*R,w[10]=K*I+ue*R,w[11]=ie*I+ge*R,w},se.rotateZ=function(w,k,O){var I=Math.sin(O),R=Math.cos(O),B=k[0],W=k[1],K=k[2],ie=k[3],oe=k[4],Q=k[5],ue=k[6],ge=k[7];return k!==w&&(w[8]=k[8],w[9]=k[9],w[10]=k[10],w[11]=k[11],w[12]=k[12],w[13]=k[13],w[14]=k[14],w[15]=k[15]),w[0]=B*R+oe*I,w[1]=W*R+Q*I,w[2]=K*R+ue*I,w[3]=ie*R+ge*I,w[4]=oe*R-B*I,w[5]=Q*R-W*I,w[6]=ue*R-K*I,w[7]=ge*R-ie*I,w},se.fromTranslation=function(w,k){return w[0]=1,w[1]=0,w[2]=0,w[3]=0,w[4]=0,w[5]=1,w[6]=0,w[7]=0,w[8]=0,w[9]=0,w[10]=1,w[11]=0,w[12]=k[0],w[13]=k[1],w[14]=k[2],w[15]=1,w},se.fromScaling=function(w,k){return w[0]=k[0],w[1]=0,w[2]=0,w[3]=0,w[4]=0,w[5]=k[1],w[6]=0,w[7]=0,w[8]=0,w[9]=0,w[10]=k[2],w[11]=0,w[12]=0,w[13]=0,w[14]=0,w[15]=1,w},se.fromRotation=function(w,k,O){var I,R,B,W=O[0],K=O[1],ie=O[2],oe=Math.hypot(W,K,ie);return oe<n.EPSILON?null:(W*=oe=1/oe,K*=oe,ie*=oe,I=Math.sin(k),R=Math.cos(k),w[0]=W*W*(B=1-R)+R,w[1]=K*W*B+ie*I,w[2]=ie*W*B-K*I,w[3]=0,w[4]=W*K*B-ie*I,w[5]=K*K*B+R,w[6]=ie*K*B+W*I,w[7]=0,w[8]=W*ie*B+K*I,w[9]=K*ie*B-W*I,w[10]=ie*ie*B+R,w[11]=0,w[12]=0,w[13]=0,w[14]=0,w[15]=1,w)},se.fromXRotation=function(w,k){var O=Math.sin(k),I=Math.cos(k);return w[0]=1,w[1]=0,w[2]=0,w[3]=0,w[4]=0,w[5]=I,w[6]=O,w[7]=0,w[8]=0,w[9]=-O,w[10]=I,w[11]=0,w[12]=0,w[13]=0,w[14]=0,w[15]=1,w},se.fromYRotation=function(w,k){var O=Math.sin(k),I=Math.cos(k);return w[0]=I,w[1]=0,w[2]=-O,w[3]=0,w[4]=0,w[5]=1,w[6]=0,w[7]=0,w[8]=O,w[9]=0,w[10]=I,w[11]=0,w[12]=0,w[13]=0,w[14]=0,w[15]=1,w},se.fromZRotation=function(w,k){var O=Math.sin(k),I=Math.cos(k);return w[0]=I,w[1]=O,w[2]=0,w[3]=0,w[4]=-O,w[5]=I,w[6]=0,w[7]=0,w[8]=0,w[9]=0,w[10]=1,w[11]=0,w[12]=0,w[13]=0,w[14]=0,w[15]=1,w},se.fromRotationTranslation=f,se.fromQuat2=function(w,k){var O=new n.ARRAY_TYPE(3),I=-k[0],R=-k[1],B=-k[2],W=k[3],K=k[4],ie=k[5],oe=k[6],Q=k[7],ue=I*I+R*R+B*B+W*W;return ue>0?(O[0]=2*(K*W+Q*I+ie*B-oe*R)/ue,O[1]=2*(ie*W+Q*R+oe*I-K*B)/ue,O[2]=2*(oe*W+Q*B+K*R-ie*I)/ue):(O[0]=2*(K*W+Q*I+ie*B-oe*R),O[1]=2*(ie*W+Q*R+oe*I-K*B),O[2]=2*(oe*W+Q*B+K*R-ie*I)),f(w,k,O),w},se.getTranslation=function(w,k){return w[0]=k[12],w[1]=k[13],w[2]=k[14],w},se.getScaling=_,se.getRotation=function(w,k){var O=new n.ARRAY_TYPE(3);_(O,k);var I=1/O[0],R=1/O[1],B=1/O[2],W=k[0]*I,K=k[1]*R,ie=k[2]*B,oe=k[4]*I,Q=k[5]*R,ue=k[6]*B,ge=k[8]*I,Se=k[9]*R,Fe=k[10]*B,ze=W+Q+Fe,Le=0;return ze>0?(Le=2*Math.sqrt(ze+1),w[3]=.25*Le,w[0]=(ue-Se)/Le,w[1]=(ge-ie)/Le,w[2]=(K-oe)/Le):W>Q&&W>Fe?(Le=2*Math.sqrt(1+W-Q-Fe),w[3]=(ue-Se)/Le,w[0]=.25*Le,w[1]=(K+oe)/Le,w[2]=(ge+ie)/Le):Q>Fe?(Le=2*Math.sqrt(1+Q-W-Fe),w[3]=(ge-ie)/Le,w[0]=(K+oe)/Le,w[1]=.25*Le,w[2]=(ue+Se)/Le):(Le=2*Math.sqrt(1+Fe-W-Q),w[3]=(K-oe)/Le,w[0]=(ge+ie)/Le,w[1]=(ue+Se)/Le,w[2]=.25*Le),w},se.fromRotationTranslationScale=function(w,k,O,I){var R=k[0],B=k[1],W=k[2],K=k[3],ie=R+R,oe=B+B,Q=W+W,ue=R*ie,ge=R*oe,Se=R*Q,Fe=B*oe,ze=B*Q,Le=W*Q,nt=K*ie,$e=K*oe,it=K*Q,dt=I[0],ct=I[1],mt=I[2];return w[0]=(1-(Fe+Le))*dt,w[1]=(ge+it)*dt,w[2]=(Se-$e)*dt,w[3]=0,w[4]=(ge-it)*ct,w[5]=(1-(ue+Le))*ct,w[6]=(ze+nt)*ct,w[7]=0,w[8]=(Se+$e)*mt,w[9]=(ze-nt)*mt,w[10]=(1-(ue+Fe))*mt,w[11]=0,w[12]=O[0],w[13]=O[1],w[14]=O[2],w[15]=1,w},se.fromRotationTranslationScaleOrigin=function(w,k,O,I,R){var B=k[0],W=k[1],K=k[2],ie=k[3],oe=B+B,Q=W+W,ue=K+K,ge=B*oe,Se=B*Q,Fe=B*ue,ze=W*Q,Le=W*ue,nt=K*ue,$e=ie*oe,it=ie*Q,dt=ie*ue,ct=I[0],mt=I[1],wt=I[2],Mt=R[0],vt=R[1],qt=R[2],mn=(1-(ze+nt))*ct,Zt=(Se+dt)*ct,Tn=(Fe-it)*ct,Sn=(Se-dt)*mt,On=(1-(ge+nt))*mt,nn=(Le+$e)*mt,Yn=(Fe+it)*wt,In=(Le-$e)*wt,qn=(1-(ge+ze))*wt;return w[0]=mn,w[1]=Zt,w[2]=Tn,w[3]=0,w[4]=Sn,w[5]=On,w[6]=nn,w[7]=0,w[8]=Yn,w[9]=In,w[10]=qn,w[11]=0,w[12]=O[0]+Mt-(mn*Mt+Sn*vt+Yn*qt),w[13]=O[1]+vt-(Zt*Mt+On*vt+In*qt),w[14]=O[2]+qt-(Tn*Mt+nn*vt+qn*qt),w[15]=1,w},se.fromQuat=function(w,k){var O=k[0],I=k[1],R=k[2],B=k[3],W=O+O,K=I+I,ie=R+R,oe=O*W,Q=I*W,ue=I*K,ge=R*W,Se=R*K,Fe=R*ie,ze=B*W,Le=B*K,nt=B*ie;return w[0]=1-ue-Fe,w[1]=Q+nt,w[2]=ge-Le,w[3]=0,w[4]=Q-nt,w[5]=1-oe-Fe,w[6]=Se+ze,w[7]=0,w[8]=ge+Le,w[9]=Se-ze,w[10]=1-oe-ue,w[11]=0,w[12]=0,w[13]=0,w[14]=0,w[15]=1,w},se.frustum=function(w,k,O,I,R,B,W){var K=1/(O-k),ie=1/(R-I),oe=1/(B-W);return w[0]=2*B*K,w[1]=0,w[2]=0,w[3]=0,w[4]=0,w[5]=2*B*ie,w[6]=0,w[7]=0,w[8]=(O+k)*K,w[9]=(R+I)*ie,w[10]=(W+B)*oe,w[11]=-1,w[12]=0,w[13]=0,w[14]=W*B*2*oe,w[15]=0,w},se.perspectiveNO=T,se.perspectiveZO=function(w,k,O,I,R){var B,W=1/Math.tan(k/2);return w[0]=W/O,w[1]=0,w[2]=0,w[3]=0,w[4]=0,w[5]=W,w[6]=0,w[7]=0,w[8]=0,w[9]=0,w[11]=-1,w[12]=0,w[13]=0,w[15]=0,R!=null&&R!==1/0?(w[10]=R*(B=1/(I-R)),w[14]=R*I*B):(w[10]=-1,w[14]=-I),w},se.perspectiveFromFieldOfView=function(w,k,O,I){var R=Math.tan(k.upDegrees*Math.PI/180),B=Math.tan(k.downDegrees*Math.PI/180),W=Math.tan(k.leftDegrees*Math.PI/180),K=Math.tan(k.rightDegrees*Math.PI/180),ie=2/(W+K),oe=2/(R+B);return w[0]=ie,w[1]=0,w[2]=0,w[3]=0,w[4]=0,w[5]=oe,w[6]=0,w[7]=0,w[8]=-(W-K)*ie*.5,w[9]=(R-B)*oe*.5,w[10]=I/(O-I),w[11]=-1,w[12]=0,w[13]=0,w[14]=I*O/(O-I),w[15]=0,w},se.orthoNO=A,se.orthoZO=function(w,k,O,I,R,B,W){var K=1/(k-O),ie=1/(I-R),oe=1/(B-W);return w[0]=-2*K,w[1]=0,w[2]=0,w[3]=0,w[4]=0,w[5]=-2*ie,w[6]=0,w[7]=0,w[8]=0,w[9]=0,w[10]=oe,w[11]=0,w[12]=(k+O)*K,w[13]=(R+I)*ie,w[14]=B*oe,w[15]=1,w},se.lookAt=function(w,k,O,I){var R,B,W,K,ie,oe,Q,ue,ge,Se,Fe=k[0],ze=k[1],Le=k[2],nt=I[0],$e=I[1],it=I[2],dt=O[0],ct=O[1],mt=O[2];return Math.abs(Fe-dt)<n.EPSILON&&Math.abs(ze-ct)<n.EPSILON&&Math.abs(Le-mt)<n.EPSILON?c(w):(Q=Fe-dt,ue=ze-ct,ge=Le-mt,R=$e*(ge*=Se=1/Math.hypot(Q,ue,ge))-it*(ue*=Se),B=it*(Q*=Se)-nt*ge,W=nt*ue-$e*Q,(Se=Math.hypot(R,B,W))?(R*=Se=1/Se,B*=Se,W*=Se):(R=0,B=0,W=0),K=ue*W-ge*B,ie=ge*R-Q*W,oe=Q*B-ue*R,(Se=Math.hypot(K,ie,oe))?(K*=Se=1/Se,ie*=Se,oe*=Se):(K=0,ie=0,oe=0),w[0]=R,w[1]=K,w[2]=Q,w[3]=0,w[4]=B,w[5]=ie,w[6]=ue,w[7]=0,w[8]=W,w[9]=oe,w[10]=ge,w[11]=0,w[12]=-(R*Fe+B*ze+W*Le),w[13]=-(K*Fe+ie*ze+oe*Le),w[14]=-(Q*Fe+ue*ze+ge*Le),w[15]=1,w)},se.targetTo=function(w,k,O,I){var R=k[0],B=k[1],W=k[2],K=I[0],ie=I[1],oe=I[2],Q=R-O[0],ue=B-O[1],ge=W-O[2],Se=Q*Q+ue*ue+ge*ge;Se>0&&(Q*=Se=1/Math.sqrt(Se),ue*=Se,ge*=Se);var Fe=ie*ge-oe*ue,ze=oe*Q-K*ge,Le=K*ue-ie*Q;return(Se=Fe*Fe+ze*ze+Le*Le)>0&&(Fe*=Se=1/Math.sqrt(Se),ze*=Se,Le*=Se),w[0]=Fe,w[1]=ze,w[2]=Le,w[3]=0,w[4]=ue*Le-ge*ze,w[5]=ge*Fe-Q*Le,w[6]=Q*ze-ue*Fe,w[7]=0,w[8]=Q,w[9]=ue,w[10]=ge,w[11]=0,w[12]=R,w[13]=B,w[14]=W,w[15]=1,w},se.str=function(w){return"mat4("+w[0]+", "+w[1]+", "+w[2]+", "+w[3]+", "+w[4]+", "+w[5]+", "+w[6]+", "+w[7]+", "+w[8]+", "+w[9]+", "+w[10]+", "+w[11]+", "+w[12]+", "+w[13]+", "+w[14]+", "+w[15]+")"},se.frob=function(w){return Math.hypot(w[0],w[1],w[2],w[3],w[4],w[5],w[6],w[7],w[8],w[9],w[10],w[11],w[12],w[13],w[14],w[15])},se.add=function(w,k,O){return w[0]=k[0]+O[0],w[1]=k[1]+O[1],w[2]=k[2]+O[2],w[3]=k[3]+O[3],w[4]=k[4]+O[4],w[5]=k[5]+O[5],w[6]=k[6]+O[6],w[7]=k[7]+O[7],w[8]=k[8]+O[8],w[9]=k[9]+O[9],w[10]=k[10]+O[10],w[11]=k[11]+O[11],w[12]=k[12]+O[12],w[13]=k[13]+O[13],w[14]=k[14]+O[14],w[15]=k[15]+O[15],w},se.subtract=D,se.multiplyScalar=function(w,k,O){return w[0]=k[0]*O,w[1]=k[1]*O,w[2]=k[2]*O,w[3]=k[3]*O,w[4]=k[4]*O,w[5]=k[5]*O,w[6]=k[6]*O,w[7]=k[7]*O,w[8]=k[8]*O,w[9]=k[9]*O,w[10]=k[10]*O,w[11]=k[11]*O,w[12]=k[12]*O,w[13]=k[13]*O,w[14]=k[14]*O,w[15]=k[15]*O,w},se.multiplyScalarAndAdd=function(w,k,O,I){return w[0]=k[0]+O[0]*I,w[1]=k[1]+O[1]*I,w[2]=k[2]+O[2]*I,w[3]=k[3]+O[3]*I,w[4]=k[4]+O[4]*I,w[5]=k[5]+O[5]*I,w[6]=k[6]+O[6]*I,w[7]=k[7]+O[7]*I,w[8]=k[8]+O[8]*I,w[9]=k[9]+O[9]*I,w[10]=k[10]+O[10]*I,w[11]=k[11]+O[11]*I,w[12]=k[12]+O[12]*I,w[13]=k[13]+O[13]*I,w[14]=k[14]+O[14]*I,w[15]=k[15]+O[15]*I,w},se.exactEquals=function(w,k){return w[0]===k[0]&&w[1]===k[1]&&w[2]===k[2]&&w[3]===k[3]&&w[4]===k[4]&&w[5]===k[5]&&w[6]===k[6]&&w[7]===k[7]&&w[8]===k[8]&&w[9]===k[9]&&w[10]===k[10]&&w[11]===k[11]&&w[12]===k[12]&&w[13]===k[13]&&w[14]===k[14]&&w[15]===k[15]},se.equals=function(w,k){var O=w[0],I=w[1],R=w[2],B=w[3],W=w[4],K=w[5],ie=w[6],oe=w[7],Q=w[8],ue=w[9],ge=w[10],Se=w[11],Fe=w[12],ze=w[13],Le=w[14],nt=w[15],$e=k[0],it=k[1],dt=k[2],ct=k[3],mt=k[4],wt=k[5],Mt=k[6],vt=k[7],qt=k[8],mn=k[9],Zt=k[10],Tn=k[11],Sn=k[12],On=k[13],nn=k[14],Yn=k[15];return Math.abs(O-$e)<=n.EPSILON*Math.max(1,Math.abs(O),Math.abs($e))&&Math.abs(I-it)<=n.EPSILON*Math.max(1,Math.abs(I),Math.abs(it))&&Math.abs(R-dt)<=n.EPSILON*Math.max(1,Math.abs(R),Math.abs(dt))&&Math.abs(B-ct)<=n.EPSILON*Math.max(1,Math.abs(B),Math.abs(ct))&&Math.abs(W-mt)<=n.EPSILON*Math.max(1,Math.abs(W),Math.abs(mt))&&Math.abs(K-wt)<=n.EPSILON*Math.max(1,Math.abs(K),Math.abs(wt))&&Math.abs(ie-Mt)<=n.EPSILON*Math.max(1,Math.abs(ie),Math.abs(Mt))&&Math.abs(oe-vt)<=n.EPSILON*Math.max(1,Math.abs(oe),Math.abs(vt))&&Math.abs(Q-qt)<=n.EPSILON*Math.max(1,Math.abs(Q),Math.abs(qt))&&Math.abs(ue-mn)<=n.EPSILON*Math.max(1,Math.abs(ue),Math.abs(mn))&&Math.abs(ge-Zt)<=n.EPSILON*Math.max(1,Math.abs(ge),Math.abs(Zt))&&Math.abs(Se-Tn)<=n.EPSILON*Math.max(1,Math.abs(Se),Math.abs(Tn))&&Math.abs(Fe-Sn)<=n.EPSILON*Math.max(1,Math.abs(Fe),Math.abs(Sn))&&Math.abs(ze-On)<=n.EPSILON*Math.max(1,Math.abs(ze),Math.abs(On))&&Math.abs(Le-nn)<=n.EPSILON*Math.max(1,Math.abs(Le),Math.abs(nn))&&Math.abs(nt-Yn)<=n.EPSILON*Math.max(1,Math.abs(nt),Math.abs(Yn))},se.sub=se.mul=se.ortho=se.perspective=void 0;var n=function(w,k){if(w&&w.__esModule)return w;if(w===null||u(w)!=="object"&&typeof w!="function")return{default:w};var O=s(void 0);if(O&&O.has(w))return O.get(w);var I={},R=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var B in w)if(B!=="default"&&Object.prototype.hasOwnProperty.call(w,B)){var W=R?Object.getOwnPropertyDescriptor(w,B):null;W&&(W.get||W.set)?Object.defineProperty(I,B,W):I[B]=w[B]}return I.default=w,O&&O.set(w,I),I}(z());function s(w){if(typeof WeakMap!="function")return null;var k=new WeakMap,O=new WeakMap;return(s=function(I){return I?O:k})(w)}function c(w){return w[0]=1,w[1]=0,w[2]=0,w[3]=0,w[4]=0,w[5]=1,w[6]=0,w[7]=0,w[8]=0,w[9]=0,w[10]=1,w[11]=0,w[12]=0,w[13]=0,w[14]=0,w[15]=1,w}function g(w,k,O){var I=k[0],R=k[1],B=k[2],W=k[3],K=k[4],ie=k[5],oe=k[6],Q=k[7],ue=k[8],ge=k[9],Se=k[10],Fe=k[11],ze=k[12],Le=k[13],nt=k[14],$e=k[15],it=O[0],dt=O[1],ct=O[2],mt=O[3];return w[0]=it*I+dt*K+ct*ue+mt*ze,w[1]=it*R+dt*ie+ct*ge+mt*Le,w[2]=it*B+dt*oe+ct*Se+mt*nt,w[3]=it*W+dt*Q+ct*Fe+mt*$e,w[4]=(it=O[4])*I+(dt=O[5])*K+(ct=O[6])*ue+(mt=O[7])*ze,w[5]=it*R+dt*ie+ct*ge+mt*Le,w[6]=it*B+dt*oe+ct*Se+mt*nt,w[7]=it*W+dt*Q+ct*Fe+mt*$e,w[8]=(it=O[8])*I+(dt=O[9])*K+(ct=O[10])*ue+(mt=O[11])*ze,w[9]=it*R+dt*ie+ct*ge+mt*Le,w[10]=it*B+dt*oe+ct*Se+mt*nt,w[11]=it*W+dt*Q+ct*Fe+mt*$e,w[12]=(it=O[12])*I+(dt=O[13])*K+(ct=O[14])*ue+(mt=O[15])*ze,w[13]=it*R+dt*ie+ct*ge+mt*Le,w[14]=it*B+dt*oe+ct*Se+mt*nt,w[15]=it*W+dt*Q+ct*Fe+mt*$e,w}function f(w,k,O){var I=k[0],R=k[1],B=k[2],W=k[3],K=I+I,ie=R+R,oe=B+B,Q=I*K,ue=I*ie,ge=I*oe,Se=R*ie,Fe=R*oe,ze=B*oe,Le=W*K,nt=W*ie,$e=W*oe;return w[0]=1-(Se+ze),w[1]=ue+$e,w[2]=ge-nt,w[3]=0,w[4]=ue-$e,w[5]=1-(Q+ze),w[6]=Fe+Le,w[7]=0,w[8]=ge+nt,w[9]=Fe-Le,w[10]=1-(Q+Se),w[11]=0,w[12]=O[0],w[13]=O[1],w[14]=O[2],w[15]=1,w}function _(w,k){var O=k[4],I=k[5],R=k[6],B=k[8],W=k[9],K=k[10];return w[0]=Math.hypot(k[0],k[1],k[2]),w[1]=Math.hypot(O,I,R),w[2]=Math.hypot(B,W,K),w}function T(w,k,O,I,R){var B,W=1/Math.tan(k/2);return w[0]=W/O,w[1]=0,w[2]=0,w[3]=0,w[4]=0,w[5]=W,w[6]=0,w[7]=0,w[8]=0,w[9]=0,w[11]=-1,w[12]=0,w[13]=0,w[15]=0,R!=null&&R!==1/0?(w[10]=(R+I)*(B=1/(I-R)),w[14]=2*R*I*B):(w[10]=-1,w[14]=-2*I),w}function A(w,k,O,I,R,B,W){var K=1/(k-O),ie=1/(I-R),oe=1/(B-W);return w[0]=-2*K,w[1]=0,w[2]=0,w[3]=0,w[4]=0,w[5]=-2*ie,w[6]=0,w[7]=0,w[8]=0,w[9]=0,w[10]=2*oe,w[11]=0,w[12]=(k+O)*K,w[13]=(R+I)*ie,w[14]=(W+B)*oe,w[15]=1,w}function D(w,k,O){return w[0]=k[0]-O[0],w[1]=k[1]-O[1],w[2]=k[2]-O[2],w[3]=k[3]-O[3],w[4]=k[4]-O[4],w[5]=k[5]-O[5],w[6]=k[6]-O[6],w[7]=k[7]-O[7],w[8]=k[8]-O[8],w[9]=k[9]-O[9],w[10]=k[10]-O[10],w[11]=k[11]-O[11],w[12]=k[12]-O[12],w[13]=k[13]-O[13],w[14]=k[14]-O[14],w[15]=k[15]-O[15],w}return se.perspective=T,se.ortho=A,se.mul=g,se.sub=D,se}var le,ce={},pe={};function de(){if(le)return pe;function u(R){return u=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(B){return typeof B}:function(B){return B&&typeof Symbol=="function"&&B.constructor===Symbol&&B!==Symbol.prototype?"symbol":typeof B},u(R)}le=1,Object.defineProperty(pe,"__esModule",{value:!0}),pe.create=c,pe.clone=function(R){var B=new n.ARRAY_TYPE(3);return B[0]=R[0],B[1]=R[1],B[2]=R[2],B},pe.length=g,pe.fromValues=function(R,B,W){var K=new n.ARRAY_TYPE(3);return K[0]=R,K[1]=B,K[2]=W,K},pe.copy=function(R,B){return R[0]=B[0],R[1]=B[1],R[2]=B[2],R},pe.set=function(R,B,W,K){return R[0]=B,R[1]=W,R[2]=K,R},pe.add=function(R,B,W){return R[0]=B[0]+W[0],R[1]=B[1]+W[1],R[2]=B[2]+W[2],R},pe.subtract=f,pe.multiply=_,pe.divide=T,pe.ceil=function(R,B){return R[0]=Math.ceil(B[0]),R[1]=Math.ceil(B[1]),R[2]=Math.ceil(B[2]),R},pe.floor=function(R,B){return R[0]=Math.floor(B[0]),R[1]=Math.floor(B[1]),R[2]=Math.floor(B[2]),R},pe.min=function(R,B,W){return R[0]=Math.min(B[0],W[0]),R[1]=Math.min(B[1],W[1]),R[2]=Math.min(B[2],W[2]),R},pe.max=function(R,B,W){return R[0]=Math.max(B[0],W[0]),R[1]=Math.max(B[1],W[1]),R[2]=Math.max(B[2],W[2]),R},pe.round=function(R,B){return R[0]=Math.round(B[0]),R[1]=Math.round(B[1]),R[2]=Math.round(B[2]),R},pe.scale=function(R,B,W){return R[0]=B[0]*W,R[1]=B[1]*W,R[2]=B[2]*W,R},pe.scaleAndAdd=function(R,B,W,K){return R[0]=B[0]+W[0]*K,R[1]=B[1]+W[1]*K,R[2]=B[2]+W[2]*K,R},pe.distance=A,pe.squaredDistance=D,pe.squaredLength=w,pe.negate=function(R,B){return R[0]=-B[0],R[1]=-B[1],R[2]=-B[2],R},pe.inverse=function(R,B){return R[0]=1/B[0],R[1]=1/B[1],R[2]=1/B[2],R},pe.normalize=function(R,B){var W=B[0],K=B[1],ie=B[2],oe=W*W+K*K+ie*ie;return oe>0&&(oe=1/Math.sqrt(oe)),R[0]=B[0]*oe,R[1]=B[1]*oe,R[2]=B[2]*oe,R},pe.dot=k,pe.cross=function(R,B,W){var K=B[0],ie=B[1],oe=B[2],Q=W[0],ue=W[1],ge=W[2];return R[0]=ie*ge-oe*ue,R[1]=oe*Q-K*ge,R[2]=K*ue-ie*Q,R},pe.lerp=function(R,B,W,K){var ie=B[0],oe=B[1],Q=B[2];return R[0]=ie+K*(W[0]-ie),R[1]=oe+K*(W[1]-oe),R[2]=Q+K*(W[2]-Q),R},pe.hermite=function(R,B,W,K,ie,oe){var Q=oe*oe,ue=Q*(2*oe-3)+1,ge=Q*(oe-2)+oe,Se=Q*(oe-1),Fe=Q*(3-2*oe);return R[0]=B[0]*ue+W[0]*ge+K[0]*Se+ie[0]*Fe,R[1]=B[1]*ue+W[1]*ge+K[1]*Se+ie[1]*Fe,R[2]=B[2]*ue+W[2]*ge+K[2]*Se+ie[2]*Fe,R},pe.bezier=function(R,B,W,K,ie,oe){var Q=1-oe,ue=Q*Q,ge=oe*oe,Se=ue*Q,Fe=3*oe*ue,ze=3*ge*Q,Le=ge*oe;return R[0]=B[0]*Se+W[0]*Fe+K[0]*ze+ie[0]*Le,R[1]=B[1]*Se+W[1]*Fe+K[1]*ze+ie[1]*Le,R[2]=B[2]*Se+W[2]*Fe+K[2]*ze+ie[2]*Le,R},pe.random=function(R,B){B=B||1;var W=2*n.RANDOM()*Math.PI,K=2*n.RANDOM()-1,ie=Math.sqrt(1-K*K)*B;return R[0]=Math.cos(W)*ie,R[1]=Math.sin(W)*ie,R[2]=K*B,R},pe.transformMat4=function(R,B,W){var K=B[0],ie=B[1],oe=B[2],Q=W[3]*K+W[7]*ie+W[11]*oe+W[15];return R[0]=(W[0]*K+W[4]*ie+W[8]*oe+W[12])/(Q=Q||1),R[1]=(W[1]*K+W[5]*ie+W[9]*oe+W[13])/Q,R[2]=(W[2]*K+W[6]*ie+W[10]*oe+W[14])/Q,R},pe.transformMat3=function(R,B,W){var K=B[0],ie=B[1],oe=B[2];return R[0]=K*W[0]+ie*W[3]+oe*W[6],R[1]=K*W[1]+ie*W[4]+oe*W[7],R[2]=K*W[2]+ie*W[5]+oe*W[8],R},pe.transformQuat=function(R,B,W){var K=W[0],ie=W[1],oe=W[2],Q=B[0],ue=B[1],ge=B[2],Se=ie*ge-oe*ue,Fe=oe*Q-K*ge,ze=K*ue-ie*Q,Le=ie*ze-oe*Fe,nt=oe*Se-K*ze,$e=K*Fe-ie*Se,it=2*W[3];return Fe*=it,ze*=it,nt*=2,$e*=2,R[0]=Q+(Se*=it)+(Le*=2),R[1]=ue+Fe+nt,R[2]=ge+ze+$e,R},pe.rotateX=function(R,B,W,K){var ie=[],oe=[];return ie[0]=B[0]-W[0],ie[1]=B[1]-W[1],ie[2]=B[2]-W[2],oe[0]=ie[0],oe[1]=ie[1]*Math.cos(K)-ie[2]*Math.sin(K),oe[2]=ie[1]*Math.sin(K)+ie[2]*Math.cos(K),R[0]=oe[0]+W[0],R[1]=oe[1]+W[1],R[2]=oe[2]+W[2],R},pe.rotateY=function(R,B,W,K){var ie=[],oe=[];return ie[0]=B[0]-W[0],ie[1]=B[1]-W[1],ie[2]=B[2]-W[2],oe[0]=ie[2]*Math.sin(K)+ie[0]*Math.cos(K),oe[1]=ie[1],oe[2]=ie[2]*Math.cos(K)-ie[0]*Math.sin(K),R[0]=oe[0]+W[0],R[1]=oe[1]+W[1],R[2]=oe[2]+W[2],R},pe.rotateZ=function(R,B,W,K){var ie=[],oe=[];return ie[0]=B[0]-W[0],ie[1]=B[1]-W[1],ie[2]=B[2]-W[2],oe[0]=ie[0]*Math.cos(K)-ie[1]*Math.sin(K),oe[1]=ie[0]*Math.sin(K)+ie[1]*Math.cos(K),oe[2]=ie[2],R[0]=oe[0]+W[0],R[1]=oe[1]+W[1],R[2]=oe[2]+W[2],R},pe.angle=function(R,B){var W=R[0],K=R[1],ie=R[2],oe=B[0],Q=B[1],ue=B[2],ge=Math.sqrt(W*W+K*K+ie*ie)*Math.sqrt(oe*oe+Q*Q+ue*ue),Se=ge&&k(R,B)/ge;return Math.acos(Math.min(Math.max(Se,-1),1))},pe.zero=function(R){return R[0]=0,R[1]=0,R[2]=0,R},pe.str=function(R){return"vec3("+R[0]+", "+R[1]+", "+R[2]+")"},pe.exactEquals=function(R,B){return R[0]===B[0]&&R[1]===B[1]&&R[2]===B[2]},pe.equals=function(R,B){var W=R[0],K=R[1],ie=R[2],oe=B[0],Q=B[1],ue=B[2];return Math.abs(W-oe)<=n.EPSILON*Math.max(1,Math.abs(W),Math.abs(oe))&&Math.abs(K-Q)<=n.EPSILON*Math.max(1,Math.abs(K),Math.abs(Q))&&Math.abs(ie-ue)<=n.EPSILON*Math.max(1,Math.abs(ie),Math.abs(ue))},pe.forEach=pe.sqrLen=pe.len=pe.sqrDist=pe.dist=pe.div=pe.mul=pe.sub=void 0;var n=function(R,B){if(R&&R.__esModule)return R;if(R===null||u(R)!=="object"&&typeof R!="function")return{default:R};var W=s(void 0);if(W&&W.has(R))return W.get(R);var K={},ie=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var oe in R)if(oe!=="default"&&Object.prototype.hasOwnProperty.call(R,oe)){var Q=ie?Object.getOwnPropertyDescriptor(R,oe):null;Q&&(Q.get||Q.set)?Object.defineProperty(K,oe,Q):K[oe]=R[oe]}return K.default=R,W&&W.set(R,K),K}(z());function s(R){if(typeof WeakMap!="function")return null;var B=new WeakMap,W=new WeakMap;return(s=function(K){return K?W:B})(R)}function c(){var R=new n.ARRAY_TYPE(3);return n.ARRAY_TYPE!=Float32Array&&(R[0]=0,R[1]=0,R[2]=0),R}function g(R){return Math.hypot(R[0],R[1],R[2])}function f(R,B,W){return R[0]=B[0]-W[0],R[1]=B[1]-W[1],R[2]=B[2]-W[2],R}function _(R,B,W){return R[0]=B[0]*W[0],R[1]=B[1]*W[1],R[2]=B[2]*W[2],R}function T(R,B,W){return R[0]=B[0]/W[0],R[1]=B[1]/W[1],R[2]=B[2]/W[2],R}function A(R,B){return Math.hypot(B[0]-R[0],B[1]-R[1],B[2]-R[2])}function D(R,B){var W=B[0]-R[0],K=B[1]-R[1],ie=B[2]-R[2];return W*W+K*K+ie*ie}function w(R){var B=R[0],W=R[1],K=R[2];return B*B+W*W+K*K}function k(R,B){return R[0]*B[0]+R[1]*B[1]+R[2]*B[2]}pe.sub=f,pe.mul=_,pe.div=T,pe.dist=A,pe.sqrDist=D,pe.len=g,pe.sqrLen=w;var O,I=(O=c(),function(R,B,W,K,ie,oe){var Q,ue;for(B||(B=3),W||(W=0),ue=K?Math.min(K*B+W,R.length):R.length,Q=W;Q<ue;Q+=B)O[0]=R[Q],O[1]=R[Q+1],O[2]=R[Q+2],ie(O,O,oe),R[Q]=O[0],R[Q+1]=O[1],R[Q+2]=O[2];return R});return pe.forEach=I,pe}var Ie,Ve,be={};function ye(){if(Ie)return be;function u(I){return u=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(R){return typeof R}:function(R){return R&&typeof Symbol=="function"&&R.constructor===Symbol&&R!==Symbol.prototype?"symbol":typeof R},u(I)}Ie=1,Object.defineProperty(be,"__esModule",{value:!0}),be.create=c,be.clone=function(I){var R=new n.ARRAY_TYPE(4);return R[0]=I[0],R[1]=I[1],R[2]=I[2],R[3]=I[3],R},be.fromValues=function(I,R,B,W){var K=new n.ARRAY_TYPE(4);return K[0]=I,K[1]=R,K[2]=B,K[3]=W,K},be.copy=function(I,R){return I[0]=R[0],I[1]=R[1],I[2]=R[2],I[3]=R[3],I},be.set=function(I,R,B,W,K){return I[0]=R,I[1]=B,I[2]=W,I[3]=K,I},be.add=function(I,R,B){return I[0]=R[0]+B[0],I[1]=R[1]+B[1],I[2]=R[2]+B[2],I[3]=R[3]+B[3],I},be.subtract=g,be.multiply=f,be.divide=_,be.ceil=function(I,R){return I[0]=Math.ceil(R[0]),I[1]=Math.ceil(R[1]),I[2]=Math.ceil(R[2]),I[3]=Math.ceil(R[3]),I},be.floor=function(I,R){return I[0]=Math.floor(R[0]),I[1]=Math.floor(R[1]),I[2]=Math.floor(R[2]),I[3]=Math.floor(R[3]),I},be.min=function(I,R,B){return I[0]=Math.min(R[0],B[0]),I[1]=Math.min(R[1],B[1]),I[2]=Math.min(R[2],B[2]),I[3]=Math.min(R[3],B[3]),I},be.max=function(I,R,B){return I[0]=Math.max(R[0],B[0]),I[1]=Math.max(R[1],B[1]),I[2]=Math.max(R[2],B[2]),I[3]=Math.max(R[3],B[3]),I},be.round=function(I,R){return I[0]=Math.round(R[0]),I[1]=Math.round(R[1]),I[2]=Math.round(R[2]),I[3]=Math.round(R[3]),I},be.scale=function(I,R,B){return I[0]=R[0]*B,I[1]=R[1]*B,I[2]=R[2]*B,I[3]=R[3]*B,I},be.scaleAndAdd=function(I,R,B,W){return I[0]=R[0]+B[0]*W,I[1]=R[1]+B[1]*W,I[2]=R[2]+B[2]*W,I[3]=R[3]+B[3]*W,I},be.distance=T,be.squaredDistance=A,be.length=D,be.squaredLength=w,be.negate=function(I,R){return I[0]=-R[0],I[1]=-R[1],I[2]=-R[2],I[3]=-R[3],I},be.inverse=function(I,R){return I[0]=1/R[0],I[1]=1/R[1],I[2]=1/R[2],I[3]=1/R[3],I},be.normalize=function(I,R){var B=R[0],W=R[1],K=R[2],ie=R[3],oe=B*B+W*W+K*K+ie*ie;return oe>0&&(oe=1/Math.sqrt(oe)),I[0]=B*oe,I[1]=W*oe,I[2]=K*oe,I[3]=ie*oe,I},be.dot=function(I,R){return I[0]*R[0]+I[1]*R[1]+I[2]*R[2]+I[3]*R[3]},be.cross=function(I,R,B,W){var K=B[0]*W[1]-B[1]*W[0],ie=B[0]*W[2]-B[2]*W[0],oe=B[0]*W[3]-B[3]*W[0],Q=B[1]*W[2]-B[2]*W[1],ue=B[1]*W[3]-B[3]*W[1],ge=B[2]*W[3]-B[3]*W[2],Se=R[0],Fe=R[1],ze=R[2],Le=R[3];return I[0]=Fe*ge-ze*ue+Le*Q,I[1]=-Se*ge+ze*oe-Le*ie,I[2]=Se*ue-Fe*oe+Le*K,I[3]=-Se*Q+Fe*ie-ze*K,I},be.lerp=function(I,R,B,W){var K=R[0],ie=R[1],oe=R[2],Q=R[3];return I[0]=K+W*(B[0]-K),I[1]=ie+W*(B[1]-ie),I[2]=oe+W*(B[2]-oe),I[3]=Q+W*(B[3]-Q),I},be.random=function(I,R){var B,W,K,ie,oe,Q;R=R||1;do oe=(B=2*n.RANDOM()-1)*B+(W=2*n.RANDOM()-1)*W;while(oe>=1);do Q=(K=2*n.RANDOM()-1)*K+(ie=2*n.RANDOM()-1)*ie;while(Q>=1);var ue=Math.sqrt((1-oe)/Q);return I[0]=R*B,I[1]=R*W,I[2]=R*K*ue,I[3]=R*ie*ue,I},be.transformMat4=function(I,R,B){var W=R[0],K=R[1],ie=R[2],oe=R[3];return I[0]=B[0]*W+B[4]*K+B[8]*ie+B[12]*oe,I[1]=B[1]*W+B[5]*K+B[9]*ie+B[13]*oe,I[2]=B[2]*W+B[6]*K+B[10]*ie+B[14]*oe,I[3]=B[3]*W+B[7]*K+B[11]*ie+B[15]*oe,I},be.transformQuat=function(I,R,B){var W=R[0],K=R[1],ie=R[2],oe=B[0],Q=B[1],ue=B[2],ge=B[3],Se=ge*W+Q*ie-ue*K,Fe=ge*K+ue*W-oe*ie,ze=ge*ie+oe*K-Q*W,Le=-oe*W-Q*K-ue*ie;return I[0]=Se*ge+Le*-oe+Fe*-ue-ze*-Q,I[1]=Fe*ge+Le*-Q+ze*-oe-Se*-ue,I[2]=ze*ge+Le*-ue+Se*-Q-Fe*-oe,I[3]=R[3],I},be.zero=function(I){return I[0]=0,I[1]=0,I[2]=0,I[3]=0,I},be.str=function(I){return"vec4("+I[0]+", "+I[1]+", "+I[2]+", "+I[3]+")"},be.exactEquals=function(I,R){return I[0]===R[0]&&I[1]===R[1]&&I[2]===R[2]&&I[3]===R[3]},be.equals=function(I,R){var B=I[0],W=I[1],K=I[2],ie=I[3],oe=R[0],Q=R[1],ue=R[2],ge=R[3];return Math.abs(B-oe)<=n.EPSILON*Math.max(1,Math.abs(B),Math.abs(oe))&&Math.abs(W-Q)<=n.EPSILON*Math.max(1,Math.abs(W),Math.abs(Q))&&Math.abs(K-ue)<=n.EPSILON*Math.max(1,Math.abs(K),Math.abs(ue))&&Math.abs(ie-ge)<=n.EPSILON*Math.max(1,Math.abs(ie),Math.abs(ge))},be.forEach=be.sqrLen=be.len=be.sqrDist=be.dist=be.div=be.mul=be.sub=void 0;var n=function(I,R){if(I&&I.__esModule)return I;if(I===null||u(I)!=="object"&&typeof I!="function")return{default:I};var B=s(void 0);if(B&&B.has(I))return B.get(I);var W={},K=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var ie in I)if(ie!=="default"&&Object.prototype.hasOwnProperty.call(I,ie)){var oe=K?Object.getOwnPropertyDescriptor(I,ie):null;oe&&(oe.get||oe.set)?Object.defineProperty(W,ie,oe):W[ie]=I[ie]}return W.default=I,B&&B.set(I,W),W}(z());function s(I){if(typeof WeakMap!="function")return null;var R=new WeakMap,B=new WeakMap;return(s=function(W){return W?B:R})(I)}function c(){var I=new n.ARRAY_TYPE(4);return n.ARRAY_TYPE!=Float32Array&&(I[0]=0,I[1]=0,I[2]=0,I[3]=0),I}function g(I,R,B){return I[0]=R[0]-B[0],I[1]=R[1]-B[1],I[2]=R[2]-B[2],I[3]=R[3]-B[3],I}function f(I,R,B){return I[0]=R[0]*B[0],I[1]=R[1]*B[1],I[2]=R[2]*B[2],I[3]=R[3]*B[3],I}function _(I,R,B){return I[0]=R[0]/B[0],I[1]=R[1]/B[1],I[2]=R[2]/B[2],I[3]=R[3]/B[3],I}function T(I,R){return Math.hypot(R[0]-I[0],R[1]-I[1],R[2]-I[2],R[3]-I[3])}function A(I,R){var B=R[0]-I[0],W=R[1]-I[1],K=R[2]-I[2],ie=R[3]-I[3];return B*B+W*W+K*K+ie*ie}function D(I){return Math.hypot(I[0],I[1],I[2],I[3])}function w(I){var R=I[0],B=I[1],W=I[2],K=I[3];return R*R+B*B+W*W+K*K}be.sub=g,be.mul=f,be.div=_,be.dist=T,be.sqrDist=A,be.len=D,be.sqrLen=w;var k,O=(k=c(),function(I,R,B,W,K,ie){var oe,Q;for(R||(R=4),B||(B=0),Q=W?Math.min(W*R+B,I.length):I.length,oe=B;oe<Q;oe+=R)k[0]=I[oe],k[1]=I[oe+1],k[2]=I[oe+2],k[3]=I[oe+3],K(k,k,ie),I[oe]=k[0],I[oe+1]=k[1],I[oe+2]=k[2],I[oe+3]=k[3];return I});return be.forEach=O,be}function Me(){if(Ve)return ce;function u($e){return u=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(it){return typeof it}:function(it){return it&&typeof Symbol=="function"&&it.constructor===Symbol&&it!==Symbol.prototype?"symbol":typeof it},u($e)}Ve=1,Object.defineProperty(ce,"__esModule",{value:!0}),ce.create=T,ce.identity=function($e){return $e[0]=0,$e[1]=0,$e[2]=0,$e[3]=1,$e},ce.setAxisAngle=A,ce.getAxisAngle=function($e,it){var dt=2*Math.acos(it[3]),ct=Math.sin(dt/2);return ct>n.EPSILON?($e[0]=it[0]/ct,$e[1]=it[1]/ct,$e[2]=it[2]/ct):($e[0]=1,$e[1]=0,$e[2]=0),dt},ce.getAngle=function($e,it){var dt=B($e,it);return Math.acos(2*dt*dt-1)},ce.multiply=D,ce.rotateX=function($e,it,dt){dt*=.5;var ct=it[0],mt=it[1],wt=it[2],Mt=it[3],vt=Math.sin(dt),qt=Math.cos(dt);return $e[0]=ct*qt+Mt*vt,$e[1]=mt*qt+wt*vt,$e[2]=wt*qt-mt*vt,$e[3]=Mt*qt-ct*vt,$e},ce.rotateY=function($e,it,dt){dt*=.5;var ct=it[0],mt=it[1],wt=it[2],Mt=it[3],vt=Math.sin(dt),qt=Math.cos(dt);return $e[0]=ct*qt-wt*vt,$e[1]=mt*qt+Mt*vt,$e[2]=wt*qt+ct*vt,$e[3]=Mt*qt-mt*vt,$e},ce.rotateZ=function($e,it,dt){dt*=.5;var ct=it[0],mt=it[1],wt=it[2],Mt=it[3],vt=Math.sin(dt),qt=Math.cos(dt);return $e[0]=ct*qt+mt*vt,$e[1]=mt*qt-ct*vt,$e[2]=wt*qt+Mt*vt,$e[3]=Mt*qt-wt*vt,$e},ce.calculateW=function($e,it){var dt=it[0],ct=it[1],mt=it[2];return $e[0]=dt,$e[1]=ct,$e[2]=mt,$e[3]=Math.sqrt(Math.abs(1-dt*dt-ct*ct-mt*mt)),$e},ce.exp=w,ce.ln=k,ce.pow=function($e,it,dt){return k($e,it),R($e,$e,dt),w($e,$e),$e},ce.slerp=O,ce.random=function($e){var it=n.RANDOM(),dt=n.RANDOM(),ct=n.RANDOM(),mt=Math.sqrt(1-it),wt=Math.sqrt(it);return $e[0]=mt*Math.sin(2*Math.PI*dt),$e[1]=mt*Math.cos(2*Math.PI*dt),$e[2]=wt*Math.sin(2*Math.PI*ct),$e[3]=wt*Math.cos(2*Math.PI*ct),$e},ce.invert=function($e,it){var dt=it[0],ct=it[1],mt=it[2],wt=it[3],Mt=dt*dt+ct*ct+mt*mt+wt*wt,vt=Mt?1/Mt:0;return $e[0]=-dt*vt,$e[1]=-ct*vt,$e[2]=-mt*vt,$e[3]=wt*vt,$e},ce.conjugate=function($e,it){return $e[0]=-it[0],$e[1]=-it[1],$e[2]=-it[2],$e[3]=it[3],$e},ce.fromMat3=I,ce.fromEuler=function($e,it,dt,ct){var mt=.5*Math.PI/180;it*=mt,dt*=mt,ct*=mt;var wt=Math.sin(it),Mt=Math.cos(it),vt=Math.sin(dt),qt=Math.cos(dt),mn=Math.sin(ct),Zt=Math.cos(ct);return $e[0]=wt*qt*Zt-Mt*vt*mn,$e[1]=Mt*vt*Zt+wt*qt*mn,$e[2]=Mt*qt*mn-wt*vt*Zt,$e[3]=Mt*qt*Zt+wt*vt*mn,$e},ce.str=function($e){return"quat("+$e[0]+", "+$e[1]+", "+$e[2]+", "+$e[3]+")"},ce.setAxes=ce.sqlerp=ce.rotationTo=ce.equals=ce.exactEquals=ce.normalize=ce.sqrLen=ce.squaredLength=ce.len=ce.length=ce.lerp=ce.dot=ce.scale=ce.mul=ce.add=ce.set=ce.copy=ce.fromValues=ce.clone=void 0;var n=_(z()),s=_(J()),c=_(de()),g=_(ye());function f($e){if(typeof WeakMap!="function")return null;var it=new WeakMap,dt=new WeakMap;return(f=function(ct){return ct?dt:it})($e)}function _($e,it){if($e&&$e.__esModule)return $e;if($e===null||u($e)!=="object"&&typeof $e!="function")return{default:$e};var dt=f(it);if(dt&&dt.has($e))return dt.get($e);var ct={},mt=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var wt in $e)if(wt!=="default"&&Object.prototype.hasOwnProperty.call($e,wt)){var Mt=mt?Object.getOwnPropertyDescriptor($e,wt):null;Mt&&(Mt.get||Mt.set)?Object.defineProperty(ct,wt,Mt):ct[wt]=$e[wt]}return ct.default=$e,dt&&dt.set($e,ct),ct}function T(){var $e=new n.ARRAY_TYPE(4);return n.ARRAY_TYPE!=Float32Array&&($e[0]=0,$e[1]=0,$e[2]=0),$e[3]=1,$e}function A($e,it,dt){dt*=.5;var ct=Math.sin(dt);return $e[0]=ct*it[0],$e[1]=ct*it[1],$e[2]=ct*it[2],$e[3]=Math.cos(dt),$e}function D($e,it,dt){var ct=it[0],mt=it[1],wt=it[2],Mt=it[3],vt=dt[0],qt=dt[1],mn=dt[2],Zt=dt[3];return $e[0]=ct*Zt+Mt*vt+mt*mn-wt*qt,$e[1]=mt*Zt+Mt*qt+wt*vt-ct*mn,$e[2]=wt*Zt+Mt*mn+ct*qt-mt*vt,$e[3]=Mt*Zt-ct*vt-mt*qt-wt*mn,$e}function w($e,it){var dt=it[0],ct=it[1],mt=it[2],wt=it[3],Mt=Math.sqrt(dt*dt+ct*ct+mt*mt),vt=Math.exp(wt),qt=Mt>0?vt*Math.sin(Mt)/Mt:0;return $e[0]=dt*qt,$e[1]=ct*qt,$e[2]=mt*qt,$e[3]=vt*Math.cos(Mt),$e}function k($e,it){var dt=it[0],ct=it[1],mt=it[2],wt=it[3],Mt=Math.sqrt(dt*dt+ct*ct+mt*mt),vt=Mt>0?Math.atan2(Mt,wt)/Mt:0;return $e[0]=dt*vt,$e[1]=ct*vt,$e[2]=mt*vt,$e[3]=.5*Math.log(dt*dt+ct*ct+mt*mt+wt*wt),$e}function O($e,it,dt,ct){var mt,wt,Mt,vt,qt,mn=it[0],Zt=it[1],Tn=it[2],Sn=it[3],On=dt[0],nn=dt[1],Yn=dt[2],In=dt[3];return(wt=mn*On+Zt*nn+Tn*Yn+Sn*In)<0&&(wt=-wt,On=-On,nn=-nn,Yn=-Yn,In=-In),1-wt>n.EPSILON?(mt=Math.acos(wt),Mt=Math.sin(mt),vt=Math.sin((1-ct)*mt)/Mt,qt=Math.sin(ct*mt)/Mt):(vt=1-ct,qt=ct),$e[0]=vt*mn+qt*On,$e[1]=vt*Zt+qt*nn,$e[2]=vt*Tn+qt*Yn,$e[3]=vt*Sn+qt*In,$e}function I($e,it){var dt,ct=it[0]+it[4]+it[8];if(ct>0)dt=Math.sqrt(ct+1),$e[3]=.5*dt,$e[0]=(it[5]-it[7])*(dt=.5/dt),$e[1]=(it[6]-it[2])*dt,$e[2]=(it[1]-it[3])*dt;else{var mt=0;it[4]>it[0]&&(mt=1),it[8]>it[3*mt+mt]&&(mt=2);var wt=(mt+1)%3,Mt=(mt+2)%3;dt=Math.sqrt(it[3*mt+mt]-it[3*wt+wt]-it[3*Mt+Mt]+1),$e[mt]=.5*dt,$e[3]=(it[3*wt+Mt]-it[3*Mt+wt])*(dt=.5/dt),$e[wt]=(it[3*wt+mt]+it[3*mt+wt])*dt,$e[Mt]=(it[3*Mt+mt]+it[3*mt+Mt])*dt}return $e}ce.clone=g.clone,ce.fromValues=g.fromValues,ce.copy=g.copy,ce.set=g.set,ce.add=g.add,ce.mul=D;var R=g.scale;ce.scale=R;var B=g.dot;ce.dot=B,ce.lerp=g.lerp;var W=g.length;ce.length=W,ce.len=W;var K=g.squaredLength;ce.squaredLength=K,ce.sqrLen=K;var ie=g.normalize;ce.normalize=ie,ce.exactEquals=g.exactEquals,ce.equals=g.equals;var oe,Q,ue,ge=(oe=c.create(),Q=c.fromValues(1,0,0),ue=c.fromValues(0,1,0),function($e,it,dt){var ct=c.dot(it,dt);return ct<-.999999?(c.cross(oe,Q,it),c.len(oe)<1e-6&&c.cross(oe,ue,it),c.normalize(oe,oe),A($e,oe,Math.PI),$e):ct>.999999?($e[0]=0,$e[1]=0,$e[2]=0,$e[3]=1,$e):(c.cross(oe,it,dt),$e[0]=oe[0],$e[1]=oe[1],$e[2]=oe[2],$e[3]=1+ct,ie($e,$e))});ce.rotationTo=ge;var Se,Fe,ze=(Se=T(),Fe=T(),function($e,it,dt,ct,mt,wt){return O(Se,it,mt,wt),O(Fe,dt,ct,wt),O($e,Se,Fe,2*wt*(1-wt)),$e});ce.sqlerp=ze;var Le,nt=(Le=s.create(),function($e,it,dt,ct){return Le[0]=dt[0],Le[3]=dt[1],Le[6]=dt[2],Le[1]=ct[0],Le[4]=ct[1],Le[7]=ct[2],Le[2]=-it[0],Le[5]=-it[1],Le[8]=-it[2],ie($e,I($e,Le))});return ce.setAxes=nt,ce}var we,me={};function De(){if(we)return me;function u(O){return u=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(I){return typeof I}:function(I){return I&&typeof Symbol=="function"&&I.constructor===Symbol&&I!==Symbol.prototype?"symbol":typeof I},u(O)}we=1,Object.defineProperty(me,"__esModule",{value:!0}),me.create=function(){var O=new n.ARRAY_TYPE(8);return n.ARRAY_TYPE!=Float32Array&&(O[0]=0,O[1]=0,O[2]=0,O[4]=0,O[5]=0,O[6]=0,O[7]=0),O[3]=1,O},me.clone=function(O){var I=new n.ARRAY_TYPE(8);return I[0]=O[0],I[1]=O[1],I[2]=O[2],I[3]=O[3],I[4]=O[4],I[5]=O[5],I[6]=O[6],I[7]=O[7],I},me.fromValues=function(O,I,R,B,W,K,ie,oe){var Q=new n.ARRAY_TYPE(8);return Q[0]=O,Q[1]=I,Q[2]=R,Q[3]=B,Q[4]=W,Q[5]=K,Q[6]=ie,Q[7]=oe,Q},me.fromRotationTranslationValues=function(O,I,R,B,W,K,ie){var oe=new n.ARRAY_TYPE(8);oe[0]=O,oe[1]=I,oe[2]=R,oe[3]=B;var Q=.5*W,ue=.5*K,ge=.5*ie;return oe[4]=Q*B+ue*R-ge*I,oe[5]=ue*B+ge*O-Q*R,oe[6]=ge*B+Q*I-ue*O,oe[7]=-Q*O-ue*I-ge*R,oe},me.fromRotationTranslation=_,me.fromTranslation=function(O,I){return O[0]=0,O[1]=0,O[2]=0,O[3]=1,O[4]=.5*I[0],O[5]=.5*I[1],O[6]=.5*I[2],O[7]=0,O},me.fromRotation=function(O,I){return O[0]=I[0],O[1]=I[1],O[2]=I[2],O[3]=I[3],O[4]=0,O[5]=0,O[6]=0,O[7]=0,O},me.fromMat4=function(O,I){var R=s.create();c.getRotation(R,I);var B=new n.ARRAY_TYPE(3);return c.getTranslation(B,I),_(O,R,B),O},me.copy=T,me.identity=function(O){return O[0]=0,O[1]=0,O[2]=0,O[3]=1,O[4]=0,O[5]=0,O[6]=0,O[7]=0,O},me.set=function(O,I,R,B,W,K,ie,oe,Q){return O[0]=I,O[1]=R,O[2]=B,O[3]=W,O[4]=K,O[5]=ie,O[6]=oe,O[7]=Q,O},me.getDual=function(O,I){return O[0]=I[4],O[1]=I[5],O[2]=I[6],O[3]=I[7],O},me.setDual=function(O,I){return O[4]=I[0],O[5]=I[1],O[6]=I[2],O[7]=I[3],O},me.getTranslation=function(O,I){var R=I[4],B=I[5],W=I[6],K=I[7],ie=-I[0],oe=-I[1],Q=-I[2],ue=I[3];return O[0]=2*(R*ue+K*ie+B*Q-W*oe),O[1]=2*(B*ue+K*oe+W*ie-R*Q),O[2]=2*(W*ue+K*Q+R*oe-B*ie),O},me.translate=function(O,I,R){var B=I[0],W=I[1],K=I[2],ie=I[3],oe=.5*R[0],Q=.5*R[1],ue=.5*R[2],ge=I[4],Se=I[5],Fe=I[6],ze=I[7];return O[0]=B,O[1]=W,O[2]=K,O[3]=ie,O[4]=ie*oe+W*ue-K*Q+ge,O[5]=ie*Q+K*oe-B*ue+Se,O[6]=ie*ue+B*Q-W*oe+Fe,O[7]=-B*oe-W*Q-K*ue+ze,O},me.rotateX=function(O,I,R){var B=-I[0],W=-I[1],K=-I[2],ie=I[3],oe=I[4],Q=I[5],ue=I[6],ge=I[7],Se=oe*ie+ge*B+Q*K-ue*W,Fe=Q*ie+ge*W+ue*B-oe*K,ze=ue*ie+ge*K+oe*W-Q*B,Le=ge*ie-oe*B-Q*W-ue*K;return s.rotateX(O,I,R),O[4]=Se*(ie=O[3])+Le*(B=O[0])+Fe*(K=O[2])-ze*(W=O[1]),O[5]=Fe*ie+Le*W+ze*B-Se*K,O[6]=ze*ie+Le*K+Se*W-Fe*B,O[7]=Le*ie-Se*B-Fe*W-ze*K,O},me.rotateY=function(O,I,R){var B=-I[0],W=-I[1],K=-I[2],ie=I[3],oe=I[4],Q=I[5],ue=I[6],ge=I[7],Se=oe*ie+ge*B+Q*K-ue*W,Fe=Q*ie+ge*W+ue*B-oe*K,ze=ue*ie+ge*K+oe*W-Q*B,Le=ge*ie-oe*B-Q*W-ue*K;return s.rotateY(O,I,R),O[4]=Se*(ie=O[3])+Le*(B=O[0])+Fe*(K=O[2])-ze*(W=O[1]),O[5]=Fe*ie+Le*W+ze*B-Se*K,O[6]=ze*ie+Le*K+Se*W-Fe*B,O[7]=Le*ie-Se*B-Fe*W-ze*K,O},me.rotateZ=function(O,I,R){var B=-I[0],W=-I[1],K=-I[2],ie=I[3],oe=I[4],Q=I[5],ue=I[6],ge=I[7],Se=oe*ie+ge*B+Q*K-ue*W,Fe=Q*ie+ge*W+ue*B-oe*K,ze=ue*ie+ge*K+oe*W-Q*B,Le=ge*ie-oe*B-Q*W-ue*K;return s.rotateZ(O,I,R),O[4]=Se*(ie=O[3])+Le*(B=O[0])+Fe*(K=O[2])-ze*(W=O[1]),O[5]=Fe*ie+Le*W+ze*B-Se*K,O[6]=ze*ie+Le*K+Se*W-Fe*B,O[7]=Le*ie-Se*B-Fe*W-ze*K,O},me.rotateByQuatAppend=function(O,I,R){var B=R[0],W=R[1],K=R[2],ie=R[3],oe=I[0],Q=I[1],ue=I[2],ge=I[3];return O[0]=oe*ie+ge*B+Q*K-ue*W,O[1]=Q*ie+ge*W+ue*B-oe*K,O[2]=ue*ie+ge*K+oe*W-Q*B,O[3]=ge*ie-oe*B-Q*W-ue*K,O[4]=(oe=I[4])*ie+(ge=I[7])*B+(Q=I[5])*K-(ue=I[6])*W,O[5]=Q*ie+ge*W+ue*B-oe*K,O[6]=ue*ie+ge*K+oe*W-Q*B,O[7]=ge*ie-oe*B-Q*W-ue*K,O},me.rotateByQuatPrepend=function(O,I,R){var B=I[0],W=I[1],K=I[2],ie=I[3],oe=R[0],Q=R[1],ue=R[2],ge=R[3];return O[0]=B*ge+ie*oe+W*ue-K*Q,O[1]=W*ge+ie*Q+K*oe-B*ue,O[2]=K*ge+ie*ue+B*Q-W*oe,O[3]=ie*ge-B*oe-W*Q-K*ue,O[4]=B*(ge=R[7])+ie*(oe=R[4])+W*(ue=R[6])-K*(Q=R[5]),O[5]=W*ge+ie*Q+K*oe-B*ue,O[6]=K*ge+ie*ue+B*Q-W*oe,O[7]=ie*ge-B*oe-W*Q-K*ue,O},me.rotateAroundAxis=function(O,I,R,B){if(Math.abs(B)<n.EPSILON)return T(O,I);var W=Math.hypot(R[0],R[1],R[2]);B*=.5;var K=Math.sin(B),ie=K*R[0]/W,oe=K*R[1]/W,Q=K*R[2]/W,ue=Math.cos(B),ge=I[0],Se=I[1],Fe=I[2],ze=I[3];O[0]=ge*ue+ze*ie+Se*Q-Fe*oe,O[1]=Se*ue+ze*oe+Fe*ie-ge*Q,O[2]=Fe*ue+ze*Q+ge*oe-Se*ie,O[3]=ze*ue-ge*ie-Se*oe-Fe*Q;var Le=I[4],nt=I[5],$e=I[6],it=I[7];return O[4]=Le*ue+it*ie+nt*Q-$e*oe,O[5]=nt*ue+it*oe+$e*ie-Le*Q,O[6]=$e*ue+it*Q+Le*oe-nt*ie,O[7]=it*ue-Le*ie-nt*oe-$e*Q,O},me.add=function(O,I,R){return O[0]=I[0]+R[0],O[1]=I[1]+R[1],O[2]=I[2]+R[2],O[3]=I[3]+R[3],O[4]=I[4]+R[4],O[5]=I[5]+R[5],O[6]=I[6]+R[6],O[7]=I[7]+R[7],O},me.multiply=A,me.scale=function(O,I,R){return O[0]=I[0]*R,O[1]=I[1]*R,O[2]=I[2]*R,O[3]=I[3]*R,O[4]=I[4]*R,O[5]=I[5]*R,O[6]=I[6]*R,O[7]=I[7]*R,O},me.lerp=function(O,I,R,B){var W=1-B;return D(I,R)<0&&(B=-B),O[0]=I[0]*W+R[0]*B,O[1]=I[1]*W+R[1]*B,O[2]=I[2]*W+R[2]*B,O[3]=I[3]*W+R[3]*B,O[4]=I[4]*W+R[4]*B,O[5]=I[5]*W+R[5]*B,O[6]=I[6]*W+R[6]*B,O[7]=I[7]*W+R[7]*B,O},me.invert=function(O,I){var R=k(I);return O[0]=-I[0]/R,O[1]=-I[1]/R,O[2]=-I[2]/R,O[3]=I[3]/R,O[4]=-I[4]/R,O[5]=-I[5]/R,O[6]=-I[6]/R,O[7]=I[7]/R,O},me.conjugate=function(O,I){return O[0]=-I[0],O[1]=-I[1],O[2]=-I[2],O[3]=I[3],O[4]=-I[4],O[5]=-I[5],O[6]=-I[6],O[7]=I[7],O},me.normalize=function(O,I){var R=k(I);if(R>0){R=Math.sqrt(R);var B=I[0]/R,W=I[1]/R,K=I[2]/R,ie=I[3]/R,oe=I[4],Q=I[5],ue=I[6],ge=I[7],Se=B*oe+W*Q+K*ue+ie*ge;O[0]=B,O[1]=W,O[2]=K,O[3]=ie,O[4]=(oe-B*Se)/R,O[5]=(Q-W*Se)/R,O[6]=(ue-K*Se)/R,O[7]=(ge-ie*Se)/R}return O},me.str=function(O){return"quat2("+O[0]+", "+O[1]+", "+O[2]+", "+O[3]+", "+O[4]+", "+O[5]+", "+O[6]+", "+O[7]+")"},me.exactEquals=function(O,I){return O[0]===I[0]&&O[1]===I[1]&&O[2]===I[2]&&O[3]===I[3]&&O[4]===I[4]&&O[5]===I[5]&&O[6]===I[6]&&O[7]===I[7]},me.equals=function(O,I){var R=O[0],B=O[1],W=O[2],K=O[3],ie=O[4],oe=O[5],Q=O[6],ue=O[7],ge=I[0],Se=I[1],Fe=I[2],ze=I[3],Le=I[4],nt=I[5],$e=I[6],it=I[7];return Math.abs(R-ge)<=n.EPSILON*Math.max(1,Math.abs(R),Math.abs(ge))&&Math.abs(B-Se)<=n.EPSILON*Math.max(1,Math.abs(B),Math.abs(Se))&&Math.abs(W-Fe)<=n.EPSILON*Math.max(1,Math.abs(W),Math.abs(Fe))&&Math.abs(K-ze)<=n.EPSILON*Math.max(1,Math.abs(K),Math.abs(ze))&&Math.abs(ie-Le)<=n.EPSILON*Math.max(1,Math.abs(ie),Math.abs(Le))&&Math.abs(oe-nt)<=n.EPSILON*Math.max(1,Math.abs(oe),Math.abs(nt))&&Math.abs(Q-$e)<=n.EPSILON*Math.max(1,Math.abs(Q),Math.abs($e))&&Math.abs(ue-it)<=n.EPSILON*Math.max(1,Math.abs(ue),Math.abs(it))},me.sqrLen=me.squaredLength=me.len=me.length=me.dot=me.mul=me.setReal=me.getReal=void 0;var n=f(z()),s=f(Me()),c=f(he());function g(O){if(typeof WeakMap!="function")return null;var I=new WeakMap,R=new WeakMap;return(g=function(B){return B?R:I})(O)}function f(O,I){if(O&&O.__esModule)return O;if(O===null||u(O)!=="object"&&typeof O!="function")return{default:O};var R=g(I);if(R&&R.has(O))return R.get(O);var B={},W=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var K in O)if(K!=="default"&&Object.prototype.hasOwnProperty.call(O,K)){var ie=W?Object.getOwnPropertyDescriptor(O,K):null;ie&&(ie.get||ie.set)?Object.defineProperty(B,K,ie):B[K]=O[K]}return B.default=O,R&&R.set(O,B),B}function _(O,I,R){var B=.5*R[0],W=.5*R[1],K=.5*R[2],ie=I[0],oe=I[1],Q=I[2],ue=I[3];return O[0]=ie,O[1]=oe,O[2]=Q,O[3]=ue,O[4]=B*ue+W*Q-K*oe,O[5]=W*ue+K*ie-B*Q,O[6]=K*ue+B*oe-W*ie,O[7]=-B*ie-W*oe-K*Q,O}function T(O,I){return O[0]=I[0],O[1]=I[1],O[2]=I[2],O[3]=I[3],O[4]=I[4],O[5]=I[5],O[6]=I[6],O[7]=I[7],O}function A(O,I,R){var B=I[0],W=I[1],K=I[2],ie=I[3],oe=R[4],Q=R[5],ue=R[6],ge=R[7],Se=I[4],Fe=I[5],ze=I[6],Le=I[7],nt=R[0],$e=R[1],it=R[2],dt=R[3];return O[0]=B*dt+ie*nt+W*it-K*$e,O[1]=W*dt+ie*$e+K*nt-B*it,O[2]=K*dt+ie*it+B*$e-W*nt,O[3]=ie*dt-B*nt-W*$e-K*it,O[4]=B*ge+ie*oe+W*ue-K*Q+Se*dt+Le*nt+Fe*it-ze*$e,O[5]=W*ge+ie*Q+K*oe-B*ue+Fe*dt+Le*$e+ze*nt-Se*it,O[6]=K*ge+ie*ue+B*Q-W*oe+ze*dt+Le*it+Se*$e-Fe*nt,O[7]=ie*ge-B*oe-W*Q-K*ue+Le*dt-Se*nt-Fe*$e-ze*it,O}me.getReal=s.copy,me.setReal=s.copy,me.mul=A;var D=s.dot;me.dot=D;var w=s.length;me.length=w,me.len=w;var k=s.squaredLength;return me.squaredLength=k,me.sqrLen=k,me}var Ge,rt,Oe={};function Ct(){if(Ge)return Oe;function u(I){return u=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(R){return typeof R}:function(R){return R&&typeof Symbol=="function"&&R.constructor===Symbol&&R!==Symbol.prototype?"symbol":typeof R},u(I)}Ge=1,Object.defineProperty(Oe,"__esModule",{value:!0}),Oe.create=c,Oe.clone=function(I){var R=new n.ARRAY_TYPE(2);return R[0]=I[0],R[1]=I[1],R},Oe.fromValues=function(I,R){var B=new n.ARRAY_TYPE(2);return B[0]=I,B[1]=R,B},Oe.copy=function(I,R){return I[0]=R[0],I[1]=R[1],I},Oe.set=function(I,R,B){return I[0]=R,I[1]=B,I},Oe.add=function(I,R,B){return I[0]=R[0]+B[0],I[1]=R[1]+B[1],I},Oe.subtract=g,Oe.multiply=f,Oe.divide=_,Oe.ceil=function(I,R){return I[0]=Math.ceil(R[0]),I[1]=Math.ceil(R[1]),I},Oe.floor=function(I,R){return I[0]=Math.floor(R[0]),I[1]=Math.floor(R[1]),I},Oe.min=function(I,R,B){return I[0]=Math.min(R[0],B[0]),I[1]=Math.min(R[1],B[1]),I},Oe.max=function(I,R,B){return I[0]=Math.max(R[0],B[0]),I[1]=Math.max(R[1],B[1]),I},Oe.round=function(I,R){return I[0]=Math.round(R[0]),I[1]=Math.round(R[1]),I},Oe.scale=function(I,R,B){return I[0]=R[0]*B,I[1]=R[1]*B,I},Oe.scaleAndAdd=function(I,R,B,W){return I[0]=R[0]+B[0]*W,I[1]=R[1]+B[1]*W,I},Oe.distance=T,Oe.squaredDistance=A,Oe.length=D,Oe.squaredLength=w,Oe.negate=function(I,R){return I[0]=-R[0],I[1]=-R[1],I},Oe.inverse=function(I,R){return I[0]=1/R[0],I[1]=1/R[1],I},Oe.normalize=function(I,R){var B=R[0],W=R[1],K=B*B+W*W;return K>0&&(K=1/Math.sqrt(K)),I[0]=R[0]*K,I[1]=R[1]*K,I},Oe.dot=function(I,R){return I[0]*R[0]+I[1]*R[1]},Oe.cross=function(I,R,B){var W=R[0]*B[1]-R[1]*B[0];return I[0]=I[1]=0,I[2]=W,I},Oe.lerp=function(I,R,B,W){var K=R[0],ie=R[1];return I[0]=K+W*(B[0]-K),I[1]=ie+W*(B[1]-ie),I},Oe.random=function(I,R){R=R||1;var B=2*n.RANDOM()*Math.PI;return I[0]=Math.cos(B)*R,I[1]=Math.sin(B)*R,I},Oe.transformMat2=function(I,R,B){var W=R[0],K=R[1];return I[0]=B[0]*W+B[2]*K,I[1]=B[1]*W+B[3]*K,I},Oe.transformMat2d=function(I,R,B){var W=R[0],K=R[1];return I[0]=B[0]*W+B[2]*K+B[4],I[1]=B[1]*W+B[3]*K+B[5],I},Oe.transformMat3=function(I,R,B){var W=R[0],K=R[1];return I[0]=B[0]*W+B[3]*K+B[6],I[1]=B[1]*W+B[4]*K+B[7],I},Oe.transformMat4=function(I,R,B){var W=R[0],K=R[1];return I[0]=B[0]*W+B[4]*K+B[12],I[1]=B[1]*W+B[5]*K+B[13],I},Oe.rotate=function(I,R,B,W){var K=R[0]-B[0],ie=R[1]-B[1],oe=Math.sin(W),Q=Math.cos(W);return I[0]=K*Q-ie*oe+B[0],I[1]=K*oe+ie*Q+B[1],I},Oe.angle=function(I,R){var B=I[0],W=I[1],K=R[0],ie=R[1],oe=Math.sqrt(B*B+W*W)*Math.sqrt(K*K+ie*ie);return Math.acos(Math.min(Math.max(oe&&(B*K+W*ie)/oe,-1),1))},Oe.zero=function(I){return I[0]=0,I[1]=0,I},Oe.str=function(I){return"vec2("+I[0]+", "+I[1]+")"},Oe.exactEquals=function(I,R){return I[0]===R[0]&&I[1]===R[1]},Oe.equals=function(I,R){var B=I[0],W=I[1],K=R[0],ie=R[1];return Math.abs(B-K)<=n.EPSILON*Math.max(1,Math.abs(B),Math.abs(K))&&Math.abs(W-ie)<=n.EPSILON*Math.max(1,Math.abs(W),Math.abs(ie))},Oe.forEach=Oe.sqrLen=Oe.sqrDist=Oe.dist=Oe.div=Oe.mul=Oe.sub=Oe.len=void 0;var n=function(I,R){if(I&&I.__esModule)return I;if(I===null||u(I)!=="object"&&typeof I!="function")return{default:I};var B=s(void 0);if(B&&B.has(I))return B.get(I);var W={},K=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var ie in I)if(ie!=="default"&&Object.prototype.hasOwnProperty.call(I,ie)){var oe=K?Object.getOwnPropertyDescriptor(I,ie):null;oe&&(oe.get||oe.set)?Object.defineProperty(W,ie,oe):W[ie]=I[ie]}return W.default=I,B&&B.set(I,W),W}(z());function s(I){if(typeof WeakMap!="function")return null;var R=new WeakMap,B=new WeakMap;return(s=function(W){return W?B:R})(I)}function c(){var I=new n.ARRAY_TYPE(2);return n.ARRAY_TYPE!=Float32Array&&(I[0]=0,I[1]=0),I}function g(I,R,B){return I[0]=R[0]-B[0],I[1]=R[1]-B[1],I}function f(I,R,B){return I[0]=R[0]*B[0],I[1]=R[1]*B[1],I}function _(I,R,B){return I[0]=R[0]/B[0],I[1]=R[1]/B[1],I}function T(I,R){return Math.hypot(R[0]-I[0],R[1]-I[1])}function A(I,R){var B=R[0]-I[0],W=R[1]-I[1];return B*B+W*W}function D(I){return Math.hypot(I[0],I[1])}function w(I){var R=I[0],B=I[1];return R*R+B*B}Oe.len=D,Oe.sub=g,Oe.mul=f,Oe.div=_,Oe.dist=T,Oe.sqrDist=A,Oe.sqrLen=w;var k,O=(k=c(),function(I,R,B,W,K,ie){var oe,Q;for(R||(R=2),B||(B=0),Q=W?Math.min(W*R+B,I.length):I.length,oe=B;oe<Q;oe+=R)k[0]=I[oe],k[1]=I[oe+1],K(k,k,ie),I[oe]=k[0],I[oe+1]=k[1];return I});return Oe.forEach=O,Oe}function kt(){if(rt)return M;function u(I){return u=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(R){return typeof R}:function(R){return R&&typeof Symbol=="function"&&R.constructor===Symbol&&R!==Symbol.prototype?"symbol":typeof R},u(I)}rt=1,Object.defineProperty(M,"__esModule",{value:!0}),M.vec4=M.vec3=M.vec2=M.quat2=M.quat=M.mat4=M.mat3=M.mat2d=M.mat2=M.glMatrix=void 0;var n=O(z());M.glMatrix=n;var s=O(N());M.mat2=s;var c=O(te());M.mat2d=c;var g=O(J());M.mat3=g;var f=O(he());M.mat4=f;var _=O(Me());M.quat=_;var T=O(De());M.quat2=T;var A=O(Ct());M.vec2=A;var D=O(de());M.vec3=D;var w=O(ye());function k(I){if(typeof WeakMap!="function")return null;var R=new WeakMap,B=new WeakMap;return(k=function(W){return W?B:R})(I)}function O(I,R){if(I&&I.__esModule)return I;if(I===null||u(I)!=="object"&&typeof I!="function")return{default:I};var B=k(R);if(B&&B.has(I))return B.get(I);var W={},K=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var ie in I)if(ie!=="default"&&Object.prototype.hasOwnProperty.call(I,ie)){var oe=K?Object.getOwnPropertyDescriptor(I,ie):null;oe&&(oe.get||oe.set)?Object.defineProperty(W,ie,oe):W[ie]=I[ie]}return W.default=I,B&&B.set(I,W),W}return M.vec4=w,M}var Bt,_t,jt,Gt,Ne=kt(),an=function(){if(_t)return Bt;function u(n,s,c,g){this.cx=3*n,this.bx=3*(c-n)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*s,this.by=3*(g-s)-this.cy,this.ay=1-this.cy-this.by,this.p1x=n,this.p1y=s,this.p2x=c,this.p2y=g}return _t=1,Bt=u,u.prototype={sampleCurveX:function(n){return((this.ax*n+this.bx)*n+this.cx)*n},sampleCurveY:function(n){return((this.ay*n+this.by)*n+this.cy)*n},sampleCurveDerivativeX:function(n){return(3*this.ax*n+2*this.bx)*n+this.cx},solveCurveX:function(n,s){if(s===void 0&&(s=1e-6),n<0)return 0;if(n>1)return 1;for(var c=n,g=0;g<8;g++){var f=this.sampleCurveX(c)-n;if(Math.abs(f)<s)return c;var _=this.sampleCurveDerivativeX(c);if(Math.abs(_)<1e-6)break;c-=f/_}var T=0,A=1;for(c=n,g=0;g<20&&(f=this.sampleCurveX(c),!(Math.abs(f-n)<s));g++)n>f?T=c:A=c,c=.5*(A-T)+T;return c},solve:function(n,s){return this.sampleCurveY(this.solveCurveX(n,s))}},Bt}(),Ae=S(an);function tt(){if(Gt)return jt;function u(n,s){this.x=n,this.y=s}return Gt=1,jt=u,u.prototype={clone:function(){return new u(this.x,this.y)},add:function(n){return this.clone()._add(n)},sub:function(n){return this.clone()._sub(n)},multByPoint:function(n){return this.clone()._multByPoint(n)},divByPoint:function(n){return this.clone()._divByPoint(n)},mult:function(n){return this.clone()._mult(n)},div:function(n){return this.clone()._div(n)},rotate:function(n){return this.clone()._rotate(n)},rotateAround:function(n,s){return this.clone()._rotateAround(n,s)},matMult:function(n){return this.clone()._matMult(n)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(n){return this.x===n.x&&this.y===n.y},dist:function(n){return Math.sqrt(this.distSqr(n))},distSqr:function(n){var s=n.x-this.x,c=n.y-this.y;return s*s+c*c},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(n){return Math.atan2(this.y-n.y,this.x-n.x)},angleWith:function(n){return this.angleWithSep(n.x,n.y)},angleWithSep:function(n,s){return Math.atan2(this.x*s-this.y*n,this.x*n+this.y*s)},_matMult:function(n){var s=n[2]*this.x+n[3]*this.y;return this.x=n[0]*this.x+n[1]*this.y,this.y=s,this},_add:function(n){return this.x+=n.x,this.y+=n.y,this},_sub:function(n){return this.x-=n.x,this.y-=n.y,this},_mult:function(n){return this.x*=n,this.y*=n,this},_div:function(n){return this.x/=n,this.y/=n,this},_multByPoint:function(n){return this.x*=n.x,this.y*=n.y,this},_divByPoint:function(n){return this.x/=n.x,this.y/=n.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var n=this.y;return this.y=this.x,this.x=-n,this},_rotate:function(n){var s=Math.cos(n),c=Math.sin(n),g=c*this.x+s*this.y;return this.x=s*this.x-c*this.y,this.y=g,this},_rotateAround:function(n,s){var c=Math.cos(n),g=Math.sin(n),f=s.y+g*(this.x-s.x)+c*(this.y-s.y);return this.x=s.x+c*(this.x-s.x)-g*(this.y-s.y),this.y=f,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},u.convert=function(n){return n instanceof u?n:Array.isArray(n)?new u(n[0],n[1]):n},jt}var Je=S(tt());function Jt(u,n){if(Array.isArray(u)){if(!Array.isArray(n)||u.length!==n.length)return!1;for(let s=0;s<u.length;s++)if(!Jt(u[s],n[s]))return!1;return!0}if(typeof u=="object"&&u!==null&&n!==null){if(typeof n!="object"||Object.keys(u).length!==Object.keys(n).length)return!1;for(const s in u)if(!Jt(u[s],n[s]))return!1;return!0}return u===n}const Kt=Math.PI/180,Nt=180/Math.PI;function Pt(u){return u*Kt}function Dt(u){return u*Nt}const rn=[[0,0],[1,0],[1,1],[0,1]];function on(u){if(u<=0)return 0;if(u>=1)return 1;const n=u*u,s=n*u;return 4*(u<.5?s:3*(u-n)+s-.75)}function Ln(u,n,s,c){const g=new Ae(u,n,s,c);return function(f){return g.solve(f)}}const yn=Ln(.25,.1,.25,1);function Et(u,n,s){return Math.min(s,Math.max(n,u))}function En(u,n,s){return(s=Et((s-u)/(n-u),0,1))*s*(3-2*s)}function Xn(u,n,s){const c=s-n,g=((u-n)%c+c)%c+n;return g===n?s:g}function vr(u,n,s){if(!u.length)return s(null,[]);let c=u.length;const g=new Array(u.length);let f=null;u.forEach((_,T)=>{n(_,(A,D)=>{A&&(f=A),g[T]=D,--c==0&&s(f,g)})})}function er(u,...n){for(const s of n)for(const c in s)u[c]=s[c];return u}let Dr=1;function Ar(){return Dr++}function Di(u){return u<=1?1:Math.pow(2,Math.ceil(Math.log(u)/Math.LN2))}function ui(u,n){u.forEach(s=>{n[s]&&(n[s]=n[s].bind(n))})}function zt(u,n){return u.indexOf(n,u.length-n.length)!==-1}function st(u,n,s){const c={};for(const g in u)c[g]=n.call(this,u[g],g,u);return c}function Ft(u,n,s){const c={};for(const g in u)n.call(this,u[g],g,u)&&(c[g]=u[g]);return c}function Ye(u){return Array.isArray(u)?u.map(Ye):typeof u=="object"&&u?st(u,Ye):u}const pn={};function xn(u){pn[u]||(typeof console<"u"&&console.warn(u),pn[u]=!0)}function _r(u,n,s){return(s.y-u.y)*(n.x-u.x)>(n.y-u.y)*(s.x-u.x)}function yi(u){let n=0;for(let s,c,g=0,f=u.length,_=f-1;g<f;_=g++)s=u[g],c=u[_],n+=(c.x-s.x)*(s.y+c.y);return n}function xi([u,n,s]){const c=Pt(n+90),g=Pt(s);return{x:u*Math.cos(c)*Math.sin(g),y:u*Math.sin(c)*Math.sin(g),z:u*Math.cos(g),azimuthal:n,polar:s}}function Qi(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function ci(u){const n={};if(u.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(s,c,g,f)=>{const _=g||f;return n[c]=!_||_.toLowerCase(),""}),n["max-age"]){const s=parseInt(n["max-age"],10);isNaN(s)?delete n["max-age"]:n["max-age"]=s}return n}let co=null;function pi(u,n){return[u[4*n],u[4*n+1],u[4*n+2],u[4*n+3]]}function Oo(u,n,s,c){for(;n<s;){const g=n+s>>1;u[g]<c?n=g+1:s=g}return n}function Ut(u,n,s,c){for(;n<s;){const g=n+s>>1;u[g]<=c?n=g+1:s=g}return n}function Ee(u){return u>0?1/(1.001-u):1+u}function ke(u){return u>0?1-1/(1.001-u):-u}const He={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){if(!He.API_URL)return null;try{const u=new URL(He.API_URL);return u.hostname==="api.mapbox.cn"?"https://events.mapbox.cn/events/v2":u.hostname==="api.mapbox.com"?"https://events.mapbox.com/events/v2":null}catch{return null}},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",RASTERARRAYS_URL_PREFIX:"rasterarrays/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,DEFAULT_STYLE:"mapbox://styles/mapbox/standard",MAX_PARALLEL_IMAGE_REQUESTS:16,DRACO_URL:"https://api.mapbox.com/mapbox-gl-js/draco_decoder_gltf_v1.5.6.wasm",MESHOPT_URL:"https://api.mapbox.com/mapbox-gl-js/meshopt_base_v0.20.wasm",MESHOPT_SIMD_URL:"https://api.mapbox.com/mapbox-gl-js/meshopt_simd_v0.20.wasm",GLYPHS_URL:"mapbox://fonts/mapbox/{fontstack}/{range}.pbf",TILES3D_URL_PREFIX:"3dtiles/v1"};function ut(u){return He.API_URL_REGEX.test(u)}function ft(u){return He.API_SPRITE_REGEX.test(u)}let xt,Lt,Tt,$t,Qe,yt;function Qt(){return xt==null&&(xt=self.OffscreenCanvas&&new OffscreenCanvas(1,1).getContext("2d")&&typeof self.createImageBitmap=="function"),xt}const bn={now:()=>$t!==void 0?$t:performance.now(),setNow(u){$t=u},restoreNow(){$t=void 0},frame(u){const n=requestAnimationFrame(u);return{cancel:()=>cancelAnimationFrame(n)}},getImageData(u,n=0){const{width:s,height:c}=u;Qe||(Qe=document.createElement("canvas"));const g=Qe.getContext("2d",{willReadFrequently:!0});if(!g)throw new Error("failed to create canvas 2d context");return(s>Qe.width||c>Qe.height)&&(Qe.width=s,Qe.height=c),g.clearRect(-n,-n,s+2*n,c+2*n),g.drawImage(u,0,0,s,c),g.getImageData(-n,-n,s+2*n,c+2*n)},resolveURL:u=>(Lt||(Lt=document.createElement("a")),Lt.href=u,Lt.href),get devicePixelRatio(){return window.devicePixelRatio},get prefersReducedMotion(){return!!window.matchMedia&&(Tt==null&&(Tt=window.matchMedia("(prefers-reduced-motion: reduce)")),Tt.matches)},hasCanvasFingerprintNoise(){if(yt!==void 0)return yt;if(!Qt())return yt=!1,!1;const u=new OffscreenCanvas(85,1),n=u.getContext("2d",{willReadFrequently:!0});let s=0;for(let g=0;g<u.width;++g)n.fillStyle=`rgba(${s++},${s++},${s++}, 255)`,n.fillRect(g,0,1,1);const c=n.getImageData(0,0,u.width,u.height);s=0;for(let g=0;g<c.data.length;++g)if(g%4!=3&&s++!==c.data[g])return yt=!0,!0;return yt=!1,!1}};function Mn(u,n){const s=u.indexOf("?");if(s<0)return`${u}?${new URLSearchParams(n).toString()}`;const c=new URLSearchParams(u.slice(s));for(const g in n)c.set(g,n[g]);return`${u.slice(0,s)}?${c.toString()}`}function or(u,n={persistentParams:[]}){const s=u.indexOf("?");if(s<0)return u;const c=new URLSearchParams,g=new URLSearchParams(u.slice(s));for(const _ of n.persistentParams){const T=g.get(_);T&&c.set(_,T)}const f=c.toString();return`${u.slice(0,s)}${f.length>0?`?${f}`:""}`}const dr="mapbox-tiles";let ur=500,cr=50;const ei=["language","worldview","jobid"];let Yt,wn;function Kn(){try{return caches}catch{}}function Qn(){const u=Kn();u&&Yt==null&&(Yt=u.open(dr))}let di=1/0;const eo={supported:!1,testSupport:function(u){!gl&&bo&&(Ea?Bc(u):vo=u)}};let vo,bo,gl=!1,Ea=!1;const cf=typeof self<"u"?self:{};function Bc(u){const n=u.createTexture();u.bindTexture(u.TEXTURE_2D,n);try{if(u.texImage2D(u.TEXTURE_2D,0,u.RGBA,u.RGBA,u.UNSIGNED_BYTE,bo),u.isContextLost())return;eo.supported=!0}catch{}u.deleteTexture(n),gl=!0}cf.document&&(bo=cf.document.createElement("img"),bo.onload=function(){vo&&Bc(vo),vo=null,Ea=!0},bo.onerror=function(){gl=!0,vo=null},bo.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const _l={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Iconset:"Iconset",Image:"Image",Model:"Model"};typeof Object.freeze=="function"&&Object.freeze(_l);class Lh extends Error{constructor(n,s,c){s===401&&ut(c)&&(n+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(n),this.status=s,this.url=c}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const Vc=Qi()?()=>self.worker&&self.worker.referrer:()=>(location.protocol==="blob:"?parent:self).location.href,yl=function(u,n){if(!(/^file:/.test(s=u.url)||/^file:/.test(Vc())&&!/^\w+:/.test(s))){if(self.fetch&&self.Request&&self.AbortController&&Request.prototype.hasOwnProperty("signal"))return function(c,g){const f=new AbortController,_=new Request(c.url,{method:c.method||"GET",body:c.body,credentials:c.credentials,headers:c.headers,referrer:Vc(),referrerPolicy:c.referrerPolicy,signal:f.signal});let T=!1,A=!1;const D=(w=_.url).indexOf("sku=")>0&&ut(w);var w;c.type==="json"&&_.headers.set("Accept","application/json");const k=(I,R,B)=>{if(A)return;if(I&&I.message!=="SecurityError"&&xn(I.toString()),R&&B)return O(R);const W=Date.now();fetch(_).then(K=>{if(K.ok){const ie=D?K.clone():null;return O(K,ie,W)}return g(new Lh(K.statusText,K.status,c.url))}).catch(K=>{K.name!=="AbortError"&&g(new Error(`${K.message} ${c.url}`))})},O=(I,R,B)=>{(c.type==="arrayBuffer"?I.arrayBuffer():c.type==="json"?I.json():I.text()).then(W=>{A||(R&&B&&function(K,ie,oe){if(Qn(),Yt==null)return;const Q=ci(ie.headers.get("Cache-Control")||"");if(Q["no-store"])return;const ue={status:ie.status,statusText:ie.statusText,headers:new Headers};ie.headers.forEach((Fe,ze)=>ue.headers.set(ze,Fe)),Q["max-age"]&&ue.headers.set("Expires",new Date(oe+1e3*Q["max-age"]).toUTCString());const ge=ue.headers.get("Expires");if(!ge||new Date(ge).getTime()-oe<42e4)return;let Se=or(K.url,{persistentParams:ei});if(ie.status===206){const Fe=K.headers.get("Range");if(!Fe)return;ue.status=200,Se=Mn(Se,{range:Fe})}(function(Fe,ze){if(wn===void 0)try{new Response(new ReadableStream),wn=!0}catch{wn=!1}wn?ze(Fe.body):Fe.blob().then(ze)})(ie,Fe=>{const ze=new Response((Le=ie.status)!==200&&Le!==404&&[101,103,204,205,304].includes(Le)?null:Fe,ue);var Le;Qn(),Yt!=null&&Yt.then(nt=>nt.put(Se,ze)).catch(nt=>xn(nt.message))})}(_,R,B),T=!0,g(null,W,I.headers.get("Cache-Control"),I.headers.get("Expires")))}).catch(W=>{A||g(new Error(W.message))})};return D?function(I,R){if(Qn(),Yt==null)return R(null);Yt.then(B=>{let W=or(I.url,{persistentParams:ei});const K=I.headers.get("Range");K&&(W=Mn(W,{range:K})),B.match(W).then(ie=>{const oe=function(Q){if(!Q)return!1;const ue=new Date(Q.headers.get("Expires")||0),ge=ci(Q.headers.get("Cache-Control")||"");return ue>Date.now()&&!ge["no-cache"]}(ie);B.delete(W),oe&&B.put(W,ie.clone()),R(null,ie,oe)}).catch(R)}).catch(R)}(_,k):k(null,null),{cancel:()=>{A=!0,T||f.abort()}}}(u,n);if(Qi()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",u,n,void 0,!0)}var s;return function(c,g){const f=new XMLHttpRequest;f.open(c.method||"GET",c.url,!0),c.type==="arrayBuffer"&&(f.responseType="arraybuffer");for(const _ in c.headers)f.setRequestHeader(_,c.headers[_]);return c.type==="json"&&(f.responseType="text",f.setRequestHeader("Accept","application/json")),f.withCredentials=c.credentials==="include",f.onerror=()=>{g(new Error(f.statusText))},f.onload=()=>{if((f.status>=200&&f.status<300||f.status===0)&&f.response!==null){let _=f.response;if(c.type==="json")try{_=JSON.parse(f.response)}catch(T){return g(T)}g(null,_,f.getResponseHeader("Cache-Control"),f.getResponseHeader("Expires"))}else g(new Lh(f.statusText,f.status,c.url))},f.send(c.body),{cancel:()=>f.abort()}}(u,n)},Zu=function(u,n){return yl(er(u,{type:"arrayBuffer"}),n)};function hg(u){const n=document.createElement("a");return n.href=u,n.protocol===location.protocol&&n.host===location.host}const wv="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let Dh,df;Dh=[],df=0;const zh=function(u,n){if(eo.supported&&(u.headers||(u.headers={}),u.headers.accept="image/webp,*/*"),df>=He.MAX_PARALLEL_IMAGE_REQUESTS){const f={requestParameters:u,callback:n,cancelled:!1,cancel(){this.cancelled=!0}};return Dh.push(f),f}df++;let s=!1;const c=()=>{if(!s)for(s=!0,df--;Dh.length&&df<He.MAX_PARALLEL_IMAGE_REQUESTS;){const f=Dh.shift(),{requestParameters:_,callback:T,cancelled:A}=f;A||(f.cancel=zh(_,T).cancel)}},g=Zu(u,(f,_,T,A)=>{c(),f?n(f):_&&(self.createImageBitmap?function(D,w){const k=new Blob([new Uint8Array(D)],{type:"image/png"});createImageBitmap(k).then(O=>{w(null,O)}).catch(O=>{w(new Error(`Could not load image because of ${O.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(_,(D,w)=>n(D,w,T,A)):function(D,w){const k=new Image;k.onload=()=>{w(null,k),URL.revokeObjectURL(k.src),k.onload=null,requestAnimationFrame(()=>{k.src=wv})},k.onerror=()=>w(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const O=new Blob([new Uint8Array(D)],{type:"image/png"});k.src=D.byteLength?URL.createObjectURL(O):wv}(_,(D,w)=>n(D,w,T,A)))});return{cancel:()=>{g.cancel(),c()}}};var pg,Us,Ma,la={exports:{}},Ia={exports:{}},vl={exports:{}},Fh=function(){if(Ma)return la.exports;Ma=1;var u=(pg||(pg=1,Ia.exports=function(s,c){var g,f,_,T,A,D,w,k;for(f=s.length-(g=3&s.length),_=c,A=3432918353,D=461845907,k=0;k<f;)w=255&s.charCodeAt(k)|(255&s.charCodeAt(++k))<<8|(255&s.charCodeAt(++k))<<16|(255&s.charCodeAt(++k))<<24,++k,_=27492+(65535&(T=5*(65535&(_=(_^=w=(65535&(w=(w=(65535&w)*A+(((w>>>16)*A&65535)<<16)&4294967295)<<15|w>>>17))*D+(((w>>>16)*D&65535)<<16)&4294967295)<<13|_>>>19))+((5*(_>>>16)&65535)<<16)&4294967295))+((58964+(T>>>16)&65535)<<16);switch(w=0,g){case 3:w^=(255&s.charCodeAt(k+2))<<16;case 2:w^=(255&s.charCodeAt(k+1))<<8;case 1:_^=w=(65535&(w=(w=(65535&(w^=255&s.charCodeAt(k)))*A+(((w>>>16)*A&65535)<<16)&4294967295)<<15|w>>>17))*D+(((w>>>16)*D&65535)<<16)&4294967295}return _^=s.length,_=2246822507*(65535&(_^=_>>>16))+((2246822507*(_>>>16)&65535)<<16)&4294967295,_=3266489909*(65535&(_^=_>>>13))+((3266489909*(_>>>16)&65535)<<16)&4294967295,(_^=_>>>16)>>>0}),Ia.exports),n=(Us||(Us=1,vl.exports=function(s,c){for(var g,f=s.length,_=c^f,T=0;f>=4;)g=1540483477*(65535&(g=255&s.charCodeAt(T)|(255&s.charCodeAt(++T))<<8|(255&s.charCodeAt(++T))<<16|(255&s.charCodeAt(++T))<<24))+((1540483477*(g>>>16)&65535)<<16),_=1540483477*(65535&_)+((1540483477*(_>>>16)&65535)<<16)^(g=1540483477*(65535&(g^=g>>>24))+((1540483477*(g>>>16)&65535)<<16)),f-=4,++T;switch(f){case 3:_^=(255&s.charCodeAt(T+2))<<16;case 2:_^=(255&s.charCodeAt(T+1))<<8;case 1:_=1540483477*(65535&(_^=255&s.charCodeAt(T)))+((1540483477*(_>>>16)&65535)<<16)}return _=1540483477*(65535&(_^=_>>>13))+((1540483477*(_>>>16)&65535)<<16),(_^=_>>>15)>>>0}),vl.exports);return la.exports=u,la.exports.murmur3=u,la.exports.murmur2=n,la.exports}(),ff=S(Fh);class lu{constructor(n,...s){er(this,s[0]||{}),this.type=n}}class uu extends lu{constructor(n,s={}){super("error",er({error:n},s))}}function Nh(u,n,s){s[u]&&s[u].indexOf(n)!==-1||(s[u]=s[u]||[],s[u].push(n))}function mg(u,n,s){if(s&&s[u]){const c=s[u].indexOf(n);c!==-1&&s[u].splice(c,1)}}class $c{on(n,s){return this._listeners=this._listeners||{},Nh(n,s,this._listeners),this}off(n,s){return mg(n,s,this._listeners),mg(n,s,this._oneTimeListeners),this}once(n,s){return s?(this._oneTimeListeners=this._oneTimeListeners||{},Nh(n,s,this._oneTimeListeners),this):new Promise(c=>this.once(n,c))}fire(n,s){const c=typeof n=="string"?new lu(n,s):n,g=c.type;if(this.listens(g)){c.target=this;const f=this._listeners&&this._listeners[g]?this._listeners[g].slice():[];for(const A of f)A.call(this,c);const _=this._oneTimeListeners&&this._oneTimeListeners[g]?this._oneTimeListeners[g].slice():[];for(const A of _)mg(g,A,this._oneTimeListeners),A.call(this,c);const T=this._eventedParent;T&&(er(c,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),T.fire(c))}else c instanceof uu&&console.error(c.error);return this}listens(n){return!!(this._listeners&&this._listeners[n]&&this._listeners[n].length>0||this._oneTimeListeners&&this._oneTimeListeners[n]&&this._oneTimeListeners[n].length>0||this._eventedParent&&this._eventedParent.listens(n))}setEventedParent(n,s){return this._eventedParent=n,this._eventedParentData=s,this}}var ua,Bh={},Vh=function(){if(ua)return Bh;ua=1;var u={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function n(f){return(f=Math.round(f))<0?0:f>255?255:f}function s(f){return n(f[f.length-1]==="%"?parseFloat(f)/100*255:parseInt(f))}function c(f){return(_=f[f.length-1]==="%"?parseFloat(f)/100:parseFloat(f))<0?0:_>1?1:_;var _}function g(f,_,T){return T<0?T+=1:T>1&&(T-=1),6*T<1?f+(_-f)*T*6:2*T<1?_:3*T<2?f+(_-f)*(2/3-T)*6:f}try{Bh.parseCSSColor=function(f){var _,T=f.replace(/ /g,"").toLowerCase();if(T in u)return u[T].slice();if(T[0]==="#")return T.length===4?(_=parseInt(T.substr(1),16))>=0&&_<=4095?[(3840&_)>>4|(3840&_)>>8,240&_|(240&_)>>4,15&_|(15&_)<<4,1]:null:T.length===7&&(_=parseInt(T.substr(1),16))>=0&&_<=16777215?[(16711680&_)>>16,(65280&_)>>8,255&_,1]:null;var A=T.indexOf("("),D=T.indexOf(")");if(A!==-1&&D+1===T.length){var w=T.substr(0,A),k=T.substr(A+1,D-(A+1)).split(","),O=1;switch(w){case"rgba":if(k.length!==4)return null;O=c(k.pop());case"rgb":return k.length!==3?null:[s(k[0]),s(k[1]),s(k[2]),O];case"hsla":if(k.length!==4)return null;O=c(k.pop());case"hsl":if(k.length!==3)return null;var I=(parseFloat(k[0])%360+360)%360/360,R=c(k[1]),B=c(k[2]),W=B<=.5?B*(R+1):B+R-B*R,K=2*B-W;return[n(255*g(K,W,I+1/3)),n(255*g(K,W,I)),n(255*g(K,W,I-1/3)),O];default:return null}}return null}}catch{}return Bh}();class Jr{constructor(n,s,c,g=1){this.r=n,this.g=s,this.b=c,this.a=g}static parse(n){if(!n)return;if(n instanceof Jr)return n;if(typeof n!="string")return;const s=Vh.parseCSSColor(n);return s?new Jr(s[0]/255*s[3],s[1]/255*s[3],s[2]/255*s[3],s[3]):void 0}toStringPremultipliedAlpha(){const[n,s,c,g]=this.a===0?[0,0,0,0]:[255*this.r/this.a,255*this.g/this.a,255*this.b/this.a,this.a];return`rgba(${Math.round(n)},${Math.round(s)},${Math.round(c)},${g})`}toString(){const[n,s,c,g]=[this.r,this.g,this.b,this.a];return`rgba(${Math.round(255*n)},${Math.round(255*s)},${Math.round(255*c)},${g})`}toRenderColor(n){const{r:s,g:c,b:g,a:f}=this;return new Ux(n,s,c,g,f)}clone(){return new Jr(this.r,this.g,this.b,this.a)}}class Ux{constructor(n,s,c,g,f){if(n){const _=n.image.height,T=_*_;s=f===0?0:s/f*(_-1),c=f===0?0:c/f*(_-1),g=f===0?0:g/f*(_-1);const A=Math.floor(s),D=Math.floor(c),w=Math.floor(g),k=Math.ceil(s),O=Math.ceil(c),I=Math.ceil(g),R=s-A,B=c-D,W=g-w,K=n.image.data,ie=4*(A+D*T+w*_),oe=4*(A+D*T+I*_),Q=4*(A+O*T+w*_),ue=4*(A+O*T+I*_),ge=4*(k+D*T+w*_),Se=4*(k+D*T+I*_),Fe=4*(k+O*T+w*_),ze=4*(k+O*T+I*_);if(ie<0||ze>=K.length)throw new Error("out of range");this.r=pr(pr(pr(K[ie],K[oe],W),pr(K[Q],K[ue],W),B),pr(pr(K[ge],K[Se],W),pr(K[Fe],K[ze],W),B),R)/255*f,this.g=pr(pr(pr(K[ie+1],K[oe+1],W),pr(K[Q+1],K[ue+1],W),B),pr(pr(K[ge+1],K[Se+1],W),pr(K[Fe+1],K[ze+1],W),B),R)/255*f,this.b=pr(pr(pr(K[ie+2],K[oe+2],W),pr(K[Q+2],K[ue+2],W),B),pr(pr(K[ge+2],K[Se+2],W),pr(K[Fe+2],K[ze+2],W),B),R)/255*f,this.a=f}else this.r=s,this.g=c,this.b=g,this.a=f}toArray(){const{r:n,g:s,b:c,a:g}=this;return g===0?[0,0,0,0]:[255*n/g,255*s/g,255*c/g,g]}toHslaArray(){if(this.a===0)return[0,0,0,0];const{r:n,g:s,b:c,a:g}=this,f=Math.min(Math.max(n/g,0),1),_=Math.min(Math.max(s/g,0),1),T=Math.min(Math.max(c/g,0),1),A=Math.min(f,_,T),D=Math.max(f,_,T),w=(A+D)/2;if(A===D)return[0,0,100*w,g];const k=D-A,O=w>.5?k/(2-D-A):k/(D+A);let I=0;return D===f?I=(_-T)/k+(_<T?6:0):D===_?I=(T-f)/k+2:D===T&&(I=(f-_)/k+4),I*=60,[Math.min(Math.max(I,0),360),Math.min(Math.max(100*O,0),100),Math.min(Math.max(100*w,0),100),g]}toArray01(){const{r:n,g:s,b:c,a:g}=this;return g===0?[0,0,0,0]:[n/g,s/g,c/g,g]}toArray01Scaled(n){const{r:s,g:c,b:g,a:f}=this;return f===0?[0,0,0]:[s/f*n,c/f*n,g/f*n]}toArray01PremultipliedAlpha(){const{r:n,g:s,b:c,a:g}=this;return[n,s,c,g]}toArray01Linear(){const{r:n,g:s,b:c,a:g}=this;return g===0?[0,0,0,0]:[Math.pow(n/g,2.2),Math.pow(s/g,2.2),Math.pow(c/g,2.2),g]}}function pr(u,n,s){return u*(1-s)+n*s}function gg(u,n,s){return u.map((c,g)=>pr(c,n[g],s))}Jr.black=new Jr(0,0,0,1),Jr.white=new Jr(1,1,1,1),Jr.transparent=new Jr(0,0,0,0),Jr.red=new Jr(1,0,0,1),Jr.blue=new Jr(0,0,1,1);var Yr=Object.freeze({__proto__:null,array:gg,color:function(u,n,s){return new Jr(pr(u.r,n.r,s),pr(u.g,n.g,s),pr(u.b,n.b,s),pr(u.a,n.a,s))},number:pr});function $h(u,...n){for(const s of n)for(const c in s)u[c]=s[c];return u}class ca extends Error{constructor(n,s){super(s),this.message=s,this.key=n}}class _g{constructor(n,s=[]){this.parent=n,this.bindings={};for(const[c,g]of s)this.bindings[c]=g}concat(n){return new _g(this,n)}get(n){if(this.bindings[n])return this.bindings[n];if(this.parent)return this.parent.get(n);throw new Error(`${n} not found in scope.`)}has(n){return!!this.bindings[n]||!!this.parent&&this.parent.has(n)}}const Uc={kind:"null"},Hn={kind:"number"},oi={kind:"string"},Xr={kind:"boolean"},Ss={kind:"color"},Yu={kind:"object"},Hr={kind:"value"},Uh={kind:"collator"},bl={kind:"formatted"},Xu={kind:"resolvedImage"};function Wo(u,n){return{kind:"array",itemType:u,N:n}}function zi(u){if(u.kind==="array"){const n=zi(u.itemType);return typeof u.N=="number"?`array<${n}, ${u.N}>`:u.itemType.kind==="value"?"array":`array<${n}>`}return u.kind}const Sv=[Uc,Hn,oi,Xr,Ss,bl,Yu,Wo(Hr),Xu];function hf(u,n){if(n.kind==="error")return null;if(u.kind==="array"){if(n.kind==="array"&&(n.N===0&&n.itemType.kind==="value"||!hf(u.itemType,n.itemType))&&(typeof u.N!="number"||u.N===n.N))return null}else{if(u.kind===n.kind)return null;if(u.kind==="value"){for(const s of Sv)if(!hf(s,n))return null}}return`Expected ${zi(u)} but found ${zi(n)} instead.`}function jh(u,n){return n.some(s=>s.kind===u.kind)}function jc(u,n){return n.some(s=>s==="null"?u===null:s==="array"?Array.isArray(u):s==="object"?u&&!Array.isArray(u)&&typeof u=="object":s===typeof u)}class Hh{constructor(n,s,c){this.sensitivity=n?s?"variant":"case":s?"accent":"base",this.locale=c,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(n,s){return this.collator.compare(n,s)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class pf{constructor(n,s,c,g,f){this.text=n.normalize?n.normalize():n,this.image=s,this.scale=c,this.fontStack=g,this.textColor=f}}class qo{constructor(n){this.sections=n}static fromString(n){return new qo([new pf(n,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(n=>n.text.length!==0||n.image&&n.image.namePrimary)}static factory(n){return n instanceof qo?n:qo.fromString(n)}toString(){return this.sections.length===0?"":this.sections.map(n=>n.text).join("")}serialize(){const n=["format"];for(const s of this.sections){if(s.image){n.push(["image",s.image.namePrimary]);continue}n.push(s.text);const c={};s.fontStack&&(c["text-font"]=["literal",s.fontStack.split(",")]),s.scale&&(c["font-scale"]=s.scale),s.textColor&&(c["text-color"]=["rgba"].concat(s.textColor.toRenderColor(null).toArray())),n.push(c)}return n}}class Za{constructor(n,s){if(this.id=n,this.options=s||{params:{}},this.options.transform){const{a:c,b:g,c:f,d:_,e:T,f:A}=this.options.transform;this.options.transform=new DOMMatrix([c,g,f,_,T,A])}else this.options.transform=new DOMMatrix([1,0,0,1,0,0])}static deserializeId(n){return JSON.parse(n).id}static deserializeFromString(n){const s=JSON.parse(n),{a:c,b:g,c:f,d:_,e:T,f:A}=s.options.transform;return new DOMMatrix([c,g,f,_,T,A]),new Za(s.id,s.options)}scaleSelf(n){return this.options.transform=this.options.transform.scale(n),this}serialize(){const n={id:this.id};this.options&&(n.options=this.options);const{a:s,b:c,c:g,d:f,e:_,f:T}=this.options.transform;return n.options.transform={a:s,b:c,c:g,d:f,e:_,f:T},JSON.stringify(n)}}class Lo{constructor(n){this.namePrimary=n.namePrimary,n.nameSecondary&&(this.nameSecondary=n.nameSecondary),n.optionsPrimary&&(this.optionsPrimary=n.optionsPrimary),n.optionsSecondary&&(this.optionsSecondary=n.optionsSecondary),this.available=n.available}toString(){return this.namePrimary&&this.nameSecondary?`[${this.namePrimary},${this.nameSecondary}]`:this.namePrimary}getPrimary(){return new Za(this.namePrimary,{params:this.optionsPrimary&&this.optionsPrimary.params||{}})}getSerializedPrimary(){return this.getPrimary().serialize()}getSecondary(){return this.nameSecondary?new Za(this.nameSecondary,{params:this.optionsSecondary&&this.optionsSecondary.params||{}}):null}static from(n){return typeof n=="string"?Lo.build(n):n}static build(n,s,c,g){return n?new Lo({namePrimary:n,nameSecondary:s,optionsPrimary:c,optionsSecondary:g,available:!1}):null}}function Ju(u,n,s,c){return typeof u=="number"&&u>=0&&u<=255&&typeof n=="number"&&n>=0&&n<=255&&typeof s=="number"&&s>=0&&s<=255?c===void 0||typeof c=="number"&&c>=0&&c<=1?null:`Invalid rgba value [${[u,n,s,c].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof c=="number"?[u,n,s,c]:[u,n,s]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Qu(u){if(u===null||typeof u=="string"||typeof u=="boolean"||typeof u=="number"||u instanceof Jr||u instanceof Hh||u instanceof qo||u instanceof Lo)return!0;if(Array.isArray(u)){for(const n of u)if(!Qu(n))return!1;return!0}if(typeof u=="object"){for(const n in u)if(!Qu(u[n]))return!1;return!0}return!1}function Gi(u){if(u===null)return Uc;if(typeof u=="string")return oi;if(typeof u=="boolean")return Xr;if(typeof u=="number")return Hn;if(u instanceof Jr)return Ss;if(u instanceof Hh)return Uh;if(u instanceof qo)return bl;if(u instanceof Lo)return Xu;if(Array.isArray(u)){const n=u.length;let s;for(const c of u){const g=Gi(c);if(s){if(s===g)continue;s=Hr;break}s=g}return Wo(s||Hr,n)}return Yu}function Aa(u){const n=typeof u;return u===null?"":n==="string"||n==="number"||n==="boolean"?String(u):u instanceof Jr?u.toStringPremultipliedAlpha():u instanceof qo||u instanceof Lo?u.toString():JSON.stringify(u)}class da{constructor(n,s){this.type=n,this.value=s}static parse(n,s){if(n.length!==2)return s.error(`'literal' expression requires exactly one argument, but found ${n.length-1} instead.`);if(!Qu(n[1]))return s.error("invalid value");const c=n[1];let g=Gi(c);const f=s.expectedType;return g.kind!=="array"||g.N!==0||!f||f.kind!=="array"||typeof f.N=="number"&&f.N!==0||(g=f),new da(g,c)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof Jr?["rgba"].concat(this.value.toRenderColor(null).toArray()):this.value instanceof qo?this.value.serialize():this.value}}class fo{constructor(n){this.name="ExpressionEvaluationError",this.message=n}toJSON(){return this.message}}const mf={string:oi,number:Hn,boolean:Xr,object:Yu};class fa{constructor(n,s){this.type=n,this.args=s}static parse(n,s){if(n.length<2)return s.error("Expected at least one argument.");let c,g=1;const f=n[0];if(f==="array"){let T,A;if(n.length>2){const D=n[1];if(typeof D!="string"||!(D in mf)||D==="object")return s.error('The item type argument of "array" must be one of string, number, boolean',1);T=mf[D],g++}else T=Hr;if(n.length>3){if(n[2]!==null&&(typeof n[2]!="number"||n[2]<0||n[2]!==Math.floor(n[2])))return s.error('The length argument to "array" must be a positive integer literal',2);A=n[2],g++}c=Wo(T,A)}else c=mf[f];const _=[];for(;g<n.length;g++){const T=s.parse(n[g],g,Hr);if(!T)return null;_.push(T)}return new fa(c,_)}evaluate(n){for(let s=0;s<this.args.length;s++){const c=this.args[s].evaluate(n);if(!hf(this.type,Gi(c)))return c;if(s===this.args.length-1)throw new fo(`The expression ${JSON.stringify(this.args[s].serialize())} evaluated to ${zi(Gi(c))} but was expected to be of type ${zi(this.type)}.`)}return null}eachChild(n){this.args.forEach(n)}outputDefined(){return this.args.every(n=>n.outputDefined())}serialize(){const n=this.type,s=[n.kind];if(n.kind==="array"){const c=n.itemType;if(c.kind==="string"||c.kind==="number"||c.kind==="boolean"){s.push(c.kind);const g=n.N;(typeof g=="number"||this.args.length>1)&&s.push(g)}}return s.concat(this.args.map(c=>c.serialize()))}}class xl{constructor(n){this.type=bl,this.sections=n}static parse(n,s){if(n.length<2)return s.error("Expected at least one argument.");const c=n[1];if(!Array.isArray(c)&&typeof c=="object")return s.error("First argument must be an image or text section.");const g=[];let f=!1;for(let _=1;_<=n.length-1;++_){const T=n[_];if(f&&typeof T=="object"&&!Array.isArray(T)){f=!1;let A=null;if(T["font-scale"]&&(A=s.parseObjectValue(T["font-scale"],_,"font-scale",Hn),!A))return null;let D=null;if(T["text-font"]&&(D=s.parseObjectValue(T["text-font"],_,"text-font",Wo(oi)),!D))return null;let w=null;if(T["text-color"]&&(w=s.parseObjectValue(T["text-color"],_,"text-color",Ss),!w))return null;const k=g[g.length-1];k.scale=A,k.font=D,k.textColor=w}else{const A=s.parse(n[_],_,Hr);if(!A)return null;const D=A.type.kind;if(D!=="string"&&D!=="value"&&D!=="null"&&D!=="resolvedImage")return s.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");f=!0,g.push({content:A,scale:null,font:null,textColor:null})}}return new xl(g)}evaluate(n){return new qo(this.sections.map(s=>{const c=s.content.evaluate(n);return Gi(c)===Xu?new pf("",c,null,null,null):new pf(Aa(c),null,s.scale?s.scale.evaluate(n):null,s.font?s.font.evaluate(n).join(","):null,s.textColor?s.textColor.evaluate(n):null)}))}eachChild(n){for(const s of this.sections)n(s.content),s.scale&&n(s.scale),s.font&&n(s.font),s.textColor&&n(s.textColor)}outputDefined(){return!1}serialize(){const n=["format"];for(const s of this.sections){n.push(s.content.serialize());const c={};s.scale&&(c["font-scale"]=s.scale.serialize()),s.font&&(c["text-font"]=s.font.serialize()),s.textColor&&(c["text-color"]=s.textColor.serialize()),n.push(c)}return n}}class Hc{constructor(n,s,c,g){this._imageWarnHistory={},this.type=Xu,this.inputPrimary=n,this.inputSecondary=s,this.inputPrimaryParams=c,this.inputSecondaryParams=g}static parse(n,s){if(n.length<2)return s.error("Expected two or more arguments.");let c=1;const g=[];function f(){if(c<n.length){const T=s.parse(n[c],c++,oi);return T?(g.push({image:T,options:void 0}),!0):(s.error(g.length?"Secondary image variant is not a string.":"No image name provided."),!1)}return!0}function _(){if(c<n.length){if((T=n[c])===null||typeof T!="object"||Array.isArray(T))return!0;const A=n[c].params,D=s.concat(c);if(!A)return c++,!0;if(typeof A!="object"||A.constructor!==Object)return D.error('Image options "params" should be an object'),!1;const w={},k=D.concat(void 0,"params");for(const O in A){if(!O)return k.error("Image parameter name should be non-empty"),!1;const I=k.concat(void 0,O).parse(A[O],void 0,Ss,void 0,{typeAnnotation:"coerce"});if(!I)return!1;w[O]=I}return g[g.length-1].options=w,c++,!0}var T;return!0}for(let T=0;T<2;T++)if(!f()||!_())return;return new Hc(g[0].image,g[1]?g[1].image:void 0,g[0].options,g[1]?g[1].options:void 0)}evaluateParams(n,s){const c={};if(s){for(const g in s)if(s[g])try{const f=s[g].evaluate(n),_=`Ignoring image parameter "${g}" with semi-transparent color ${f.toString()}`;if(f.a!==1){this._imageWarnHistory[_]||(console.warn(_),this._imageWarnHistory[_]=!0);continue}c[g]=f}catch{continue}if(Object.keys(c).length!==0)return{params:c}}}evaluate(n){const s=Lo.build(this.inputPrimary.evaluate(n),this.inputSecondary?this.inputSecondary.evaluate(n):void 0,this.inputPrimaryParams?this.evaluateParams(n,this.inputPrimaryParams):void 0,this.inputSecondaryParams?this.evaluateParams(n,this.inputSecondaryParams):void 0);return s&&n.availableImages&&(s.available=n.availableImages.indexOf(s.namePrimary)>-1,s.nameSecondary&&s.available&&n.availableImages&&(s.available=n.availableImages.indexOf(s.nameSecondary)>-1)),s}eachChild(n){if(n(this.inputPrimary),this.inputPrimaryParams)for(const s in this.inputPrimaryParams)this.inputPrimaryParams[s]&&n(this.inputPrimaryParams[s]);if(this.inputSecondary&&(n(this.inputSecondary),this.inputSecondaryParams))for(const s in this.inputSecondaryParams)this.inputSecondaryParams[s]&&n(this.inputSecondaryParams[s])}outputDefined(){return!1}serializeParams(n){const s={};if(n){for(const c in n)n[c]&&(s[c]=n[c].serialize());return{params:s}}}serialize(){const n=["image",this.inputPrimary.serialize()];return this.inputPrimaryParams&&n.push(this.serializeParams(this.inputPrimaryParams)),this.inputSecondary&&(n.push(this.inputSecondary.serialize()),this.inputSecondaryParams&&n.push(this.serializeParams(this.inputSecondaryParams))),n}}function ec(u){return u instanceof Number?"number":u instanceof String?"string":u instanceof Boolean?"boolean":Array.isArray(u)?"array":u===null?"null":typeof u}const jx={"to-boolean":Xr,"to-color":Ss,"to-number":Hn,"to-string":oi};class wl{constructor(n,s){this.type=n,this.args=s}static parse(n,s){if(n.length<2)return s.error("Expected at least one argument.");const c=n[0],g=[];let f=Uc;if(c==="to-array"){if(!Array.isArray(n[1]))return null;const _=n[1].length;if(s.expectedType){if(s.expectedType.kind!=="array")return s.error(`Expected ${s.expectedType.kind} but found array.`);f=Wo(s.expectedType.itemType,_)}else{if(!(_>0&&Qu(n[1][0])))return null;f=Wo(Gi(n[1][0]),_)}for(let T=0;T<_;T++){const A=n[1][T];let D;if(ec(A)==="array")D=s.parse(A,void 0,f.itemType);else{const w=ec(A);if(w!==f.itemType.kind)return s.error(`Expected ${f.itemType.kind} but found ${w}.`);D=s.registry.literal.parse(["literal",A===void 0?null:A],s)}if(!D)return null;g.push(D)}}else{if((c==="to-boolean"||c==="to-string")&&n.length!==2)return s.error("Expected one argument.");f=jx[c];for(let _=1;_<n.length;_++){const T=s.parse(n[_],_,Hr);if(!T)return null;g.push(T)}}return new wl(f,g)}evaluate(n){if(this.type.kind==="boolean")return!!this.args[0].evaluate(n);if(this.type.kind==="color"){let s,c;for(const g of this.args){if(s=g.evaluate(n),c=null,s instanceof Jr)return s;if(typeof s=="string"){const f=n.parseColor(s);if(f)return f}else if(Array.isArray(s)&&(c=s.length<3||s.length>4?`Invalid rbga value ${JSON.stringify(s)}: expected an array containing either three or four numeric values.`:Ju(s[0],s[1],s[2],s[3]),!c))return new Jr(s[0]/255,s[1]/255,s[2]/255,s[3])}throw new fo(c||`Could not parse color from value '${typeof s=="string"?s:String(JSON.stringify(s))}'`)}if(this.type.kind==="number"){let s=null;for(const c of this.args){if(s=c.evaluate(n),s===null)return 0;const g=Number(s);if(!isNaN(g))return g}throw new fo(`Could not convert ${JSON.stringify(s)} to number.`)}return this.type.kind==="formatted"?qo.fromString(Aa(this.args[0].evaluate(n))):this.type.kind==="resolvedImage"?Lo.build(Aa(this.args[0].evaluate(n))):this.type.kind==="array"?this.args.map(s=>s.evaluate(n)):Aa(this.args[0].evaluate(n))}eachChild(n){this.args.forEach(n)}outputDefined(){return this.args.every(n=>n.outputDefined())}serialize(){if(this.type.kind==="formatted")return new xl([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new Hc(this.args[0]).serialize();const n=this.type.kind==="array"?[]:[`to-${this.type.kind}`];return this.eachChild(s=>{n.push(s.serialize())}),n}}const Tv=["Unknown","Point","LineString","Polygon"];class Gh{constructor(n,s){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null,this.scope=n,this.options=s}id(){return this.feature&&this.feature.id!==void 0?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?Tv[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}measureLight(n){return this.globals.brightness||0}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const n=this.featureDistanceData.center,s=this.featureDistanceData.scale,{x:c,y:g}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(c*s-n[0])+this.featureDistanceData.bearing[1]*(g*s-n[1])}return 0}parseColor(n){let s=this._parseColorCache[n];return s||(s=this._parseColorCache[n]=Jr.parse(n)),s}getConfig(n){return this.options?this.options.get(n):null}}class Ts{constructor(n,s,c,g,f){this.name=n,this.type=s,this._evaluate=c,this.args=g,this._overloadIndex=f}evaluate(n){if(!this._evaluate){const s=Ts.definitions[this.name];this._evaluate=Array.isArray(s)?s[2]:s.overloads[this._overloadIndex][1]}return this._evaluate(n,this.args)}eachChild(n){this.args.forEach(n)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(n=>n.serialize()))}static parse(n,s){const c=n[0],g=Ts.definitions[c];if(!g)return s.error(`Unknown expression "${c}". If you wanted a literal array, use ["literal", [...]].`,0);const f=Array.isArray(g)?g[0]:g.type,_=Array.isArray(g)?[[g[1],g[2]]]:g.overloads,T=[];let A=null,D=-1;for(const[w,k]of _){if(Array.isArray(w)&&w.length!==n.length-1)continue;T.push(w),D++,A=new Tg(s.registry,s.path,null,s.scope,void 0,s._scope,s.options);const O=[];let I=!1;for(let R=1;R<n.length;R++){const B=n[R],W=Array.isArray(w)?w[R-1]:w.type,K=A.parse(B,1+O.length,W);if(!K){I=!0;break}O.push(K)}if(!I)if(Array.isArray(w)&&w.length!==O.length)A.error(`Expected ${w.length} arguments, but found ${O.length} instead.`);else{for(let R=0;R<O.length;R++){const B=Array.isArray(w)?w[R]:w.type,W=O[R];A.concat(R+1).checkSubtype(B,W.type)}if(A.errors.length===0)return new Ts(c,f,k,O,D)}}if(T.length===1)s.errors.push(...A.errors);else{const w=(T.length?T:_.map(([O])=>O)).map(Wh).join(" | "),k=[];for(let O=1;O<n.length;O++){const I=s.parse(n[O],1+k.length);if(!I)return null;k.push(zi(I.type))}s.error(`Expected arguments of type ${w}, but found (${k.join(", ")}) instead.`)}return null}static register(n,s){Ts.definitions=s;for(const c in s)n[c]=Ts}}function Wh(u){return Array.isArray(u)?`(${u.map(zi).join(", ")})`:`(${zi(u.type)}...)`}class qh{constructor(n,s,c){this.type=Uh,this.locale=c,this.caseSensitive=n,this.diacriticSensitive=s}static parse(n,s){if(n.length!==2)return s.error("Expected one argument.");const c=n[1];if(typeof c!="object"||Array.isArray(c))return s.error("Collator options argument must be an object.");const g=c["case-sensitive"]===void 0?s.parse(!1,1,Xr):s.parseObjectValue(c["case-sensitive"],1,"case-sensitive",Xr);if(!g)return null;const f=c["diacritic-sensitive"]===void 0?s.parse(!1,1,Xr):s.parseObjectValue(c["diacritic-sensitive"],1,"diacritic-sensitive",Xr);if(!f)return null;let _=null;return c.locale&&(_=s.parseObjectValue(c.locale,1,"locale",oi),!_)?null:new qh(g,f,_)}evaluate(n){return new Hh(this.caseSensitive.evaluate(n),this.diacriticSensitive.evaluate(n),this.locale?this.locale.evaluate(n):null)}eachChild(n){n(this.caseSensitive),n(this.diacriticSensitive),this.locale&&n(this.locale)}outputDefined(){return!1}serialize(){const n={};return n["case-sensitive"]=this.caseSensitive.serialize(),n["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(n.locale=this.locale.serialize()),["collator",n]}}function Cv(u,n,s=0,c=u.length-1,g=Hx){for(;c>s;){if(c-s>600){const A=c-s+1,D=n-s+1,w=Math.log(A),k=.5*Math.exp(2*w/3),O=.5*Math.sqrt(w*k*(A-k)/A)*(D-A/2<0?-1:1);Cv(u,n,Math.max(s,Math.floor(n-D*k/A+O)),Math.min(c,Math.floor(n+(A-D)*k/A+O)),g)}const f=u[n];let _=s,T=c;for(gf(u,s,n),g(u[c],f)>0&&gf(u,s,c);_<T;){for(gf(u,_,T),_++,T--;g(u[_],f)<0;)_++;for(;g(u[T],f)>0;)T--}g(u[s],f)===0?gf(u,s,T):(T++,gf(u,T,c)),T<=n&&(s=T+1),n<=T&&(c=T-1)}}function gf(u,n,s){const c=u[n];u[n]=u[s],u[s]=c}function Hx(u,n){return u<n?-1:u>n?1:0}function Gx(u){let n=0;for(let s,c,g=0,f=u.length,_=f-1;g<f;_=g++)s=u[g],c=u[_],n+=(c.x-s.x)*(s.y+c.y);return n}function _f(u,n){u[0]=Math.min(u[0],n[0]),u[1]=Math.min(u[1],n[1]),u[2]=Math.max(u[2],n[0]),u[3]=Math.max(u[3],n[1])}function yf(u,n){return!(u[0]<=n[0]||u[2]>=n[2]||u[1]<=n[1]||u[3]>=n[3])}function Ev(u,n,s){const c=u[0]-n[0],g=u[1]-n[1],f=u[0]-s[0],_=u[1]-s[1];return c*_-f*g==0&&c*f<=0&&g*_<=0}function ka(u,n,s=!1){let c=!1;for(let T=0,A=n.length;T<A;T++){const D=n[T];for(let w=0,k=D.length,O=k-1;w<k;O=w++){const I=D[O],R=D[w];if(Ev(u,I,R))return s;(f=I)[1]>(g=u)[1]!=(_=R)[1]>g[1]&&g[0]<(_[0]-f[0])*(g[1]-f[1])/(_[1]-f[1])+f[0]&&(c=!c)}}var g,f,_;return c}function Mv(u,n,s,c){const g=c[0]-s[0],f=c[1]-s[1],_=(u[0]-s[0])*f-g*(u[1]-s[1]),T=(n[0]-s[0])*f-g*(n[1]-s[1]);return _>0&&T<0||_<0&&T>0}function Kh(u,n,s,c){return(g=[c[0]-s[0],c[1]-s[1]])[0]*(f=[n[0]-u[0],n[1]-u[1]])[1]-g[1]*f[0]!=0&&!(!Mv(u,n,s,c)||!Mv(s,c,u,n));var g,f}const Ya=8192;function Wx(u,n){const s=(180+u[0])/360,c=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+u[1]*Math.PI/360)))/360,g=Math.pow(2,n.z);return[Math.round(s*g*Ya),Math.round(c*g*Ya)]}function qx(u,n){for(let s=0;s<n.length;s++)if(ka(u,n[s]))return!0;return!1}function Kx(u,n,s){for(const c of s)for(let g=0,f=c.length,_=f-1;g<f;_=g++)if(Kh(u,n,c[_],c[g]))return!0;return!1}function Iv(u,n){for(let s=0;s<u.length;++s)if(!ka(u[s],n))return!1;for(let s=0;s<u.length-1;++s)if(Kx(u[s],u[s+1],n))return!1;return!0}function Gc(u,n){for(let s=0;s<n.length;s++)if(Iv(u,n[s]))return!0;return!1}function zr(u,n,s){const c=[];for(let g=0;g<u.length;g++){const f=[];for(let _=0;_<u[g].length;_++){const T=Wx(u[g][_],s);_f(n,T),f.push(T)}c.push(f)}return c}function nr(u,n,s){const c=[];for(let g=0;g<u.length;g++){const f=zr(u[g],n,s);c.push(f)}return c}function Zh(u,n,s,c){if(u[0]<s[0]||u[0]>s[2]){const g=.5*c;let f=u[0]-s[0]>g?-c:s[0]-u[0]>g?c:0;f===0&&(f=u[0]-s[2]>g?-c:s[2]-u[0]>g?c:0),u[0]+=f}_f(n,u)}function Tr(u,n,s,c){const g=Math.pow(2,c.z)*Ya,f=[c.x*Ya,c.y*Ya],_=[];if(!u)return _;for(const T of u)for(const A of T){const D=[A.x+f[0],A.y+f[1]];Zh(D,n,s,g),_.push(D)}return _}function Yh(u,n,s,c){const g=Math.pow(2,c.z)*Ya,f=[c.x*Ya,c.y*Ya],_=[];if(!u)return _;for(const A of u){const D=[];for(const w of A){const k=[w.x+f[0],w.y+f[1]];_f(n,k),D.push(k)}_.push(D)}if(n[2]-n[0]<=g/2){(T=n)[0]=T[1]=1/0,T[2]=T[3]=-1/0;for(const A of _)for(const D of A)Zh(D,n,s,g)}var T;return _}class Sl{constructor(n,s){this.type=Xr,this.geojson=n,this.geometries=s}static parse(n,s){if(n.length!==2)return s.error(`'within' expression requires exactly one argument, but found ${n.length-1} instead.`);if(Qu(n[1])){const c=n[1];if(c.type==="FeatureCollection")for(let g=0;g<c.features.length;++g){const f=c.features[g].geometry.type;if(f==="Polygon"||f==="MultiPolygon")return new Sl(c,c.features[g].geometry)}else if(c.type==="Feature"){const g=c.geometry.type;if(g==="Polygon"||g==="MultiPolygon")return new Sl(c,c.geometry)}else if(c.type==="Polygon"||c.type==="MultiPolygon")return new Sl(c,c)}return s.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(n){if(n.geometry()!=null&&n.canonicalID()!=null){if(n.geometryType()==="Point")return function(s,c){const g=[1/0,1/0,-1/0,-1/0],f=[1/0,1/0,-1/0,-1/0],_=s.canonicalID();if(!_)return!1;if(c.type==="Polygon"){const T=zr(c.coordinates,f,_),A=Tr(s.geometry(),g,f,_);if(!yf(g,f))return!1;for(const D of A)if(!ka(D,T))return!1}if(c.type==="MultiPolygon"){const T=nr(c.coordinates,f,_),A=Tr(s.geometry(),g,f,_);if(!yf(g,f))return!1;for(const D of A)if(!qx(D,T))return!1}return!0}(n,this.geometries);if(n.geometryType()==="LineString")return function(s,c){const g=[1/0,1/0,-1/0,-1/0],f=[1/0,1/0,-1/0,-1/0],_=s.canonicalID();if(!_)return!1;if(c.type==="Polygon"){const T=zr(c.coordinates,f,_),A=Yh(s.geometry(),g,f,_);if(!yf(g,f))return!1;for(const D of A)if(!Iv(D,T))return!1}if(c.type==="MultiPolygon"){const T=nr(c.coordinates,f,_),A=Yh(s.geometry(),g,f,_);if(!yf(g,f))return!1;for(const D of A)if(!Gc(D,T))return!1}return!0}(n,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}const mr={kilometers:1,miles:1e3/1609.344,nauticalmiles:1e3/1852,meters:1e3,metres:1e3,yards:1e3/.9144,feet:1e3/.3048,inches:1e3/.0254},yg=1/298.257223563,Xh=yg*(2-yg),Wc=Math.PI/180;class qc{static fromTile(n,s,c){const g=Math.PI*(1-2*(n+.5)/Math.pow(2,s)),f=Math.atan(.5*(Math.exp(g)-Math.exp(-g)))/Wc;return new qc(f,c)}static get units(){return mr}constructor(n,s){if(n===void 0)throw new Error("No latitude given.");if(s&&!mr[s])throw new Error(`Unknown unit ${s}. Use one of: ${Object.keys(mr).join(", ")}`);const c=6378.137*Wc*(s?mr[s]:1),g=Math.cos(n*Wc),f=1/(1-Xh*(1-g*g)),_=Math.sqrt(f);this.kx=c*_*g,this.ky=c*_*f*(1-Xh)}distance(n,s){const c=Cs(n[0]-s[0])*this.kx,g=(n[1]-s[1])*this.ky;return Math.sqrt(c*c+g*g)}bearing(n,s){const c=Cs(s[0]-n[0])*this.kx;return Math.atan2(c,(s[1]-n[1])*this.ky)/Wc}destination(n,s,c){const g=c*Wc;return this.offset(n,Math.sin(g)*s,Math.cos(g)*s)}offset(n,s,c){return[n[0]+s/this.kx,n[1]+c/this.ky]}lineDistance(n){let s=0;for(let c=0;c<n.length-1;c++)s+=this.distance(n[c],n[c+1]);return s}area(n){let s=0;for(let c=0;c<n.length;c++){const g=n[c];for(let f=0,_=g.length,T=_-1;f<_;T=f++)s+=Cs(g[f][0]-g[T][0])*(g[f][1]+g[T][1])*(c?-1:1)}return Math.abs(s)/2*this.kx*this.ky}along(n,s){let c=0;if(s<=0)return n[0];for(let g=0;g<n.length-1;g++){const f=n[g],_=n[g+1],T=this.distance(f,_);if(c+=T,c>s)return Vo(f,_,(s-(c-T))/T)}return n[n.length-1]}pointToSegmentDistance(n,s,c){let[g,f]=s,_=Cs(c[0]-g)*this.kx,T=(c[1]-f)*this.ky;if(_!==0||T!==0){const A=(Cs(n[0]-g)*this.kx*_+(n[1]-f)*this.ky*T)/(_*_+T*T);A>1?(g=c[0],f=c[1]):A>0&&(g+=_/this.kx*A,f+=T/this.ky*A)}return _=Cs(n[0]-g)*this.kx,T=(n[1]-f)*this.ky,Math.sqrt(_*_+T*T)}pointOnLine(n,s){let c=1/0,g=n[0][0],f=n[0][1],_=0,T=0;for(let A=0;A<n.length-1;A++){let D=n[A][0],w=n[A][1],k=Cs(n[A+1][0]-D)*this.kx,O=(n[A+1][1]-w)*this.ky,I=0;k===0&&O===0||(I=(Cs(s[0]-D)*this.kx*k+(s[1]-w)*this.ky*O)/(k*k+O*O),I>1?(D=n[A+1][0],w=n[A+1][1]):I>0&&(D+=k/this.kx*I,w+=O/this.ky*I)),k=Cs(s[0]-D)*this.kx,O=(s[1]-w)*this.ky;const R=k*k+O*O;R<c&&(c=R,g=D,f=w,_=A,T=I)}return{point:[g,f],index:_,t:Math.max(0,Math.min(1,T))}}lineSlice(n,s,c){let g=this.pointOnLine(c,n),f=this.pointOnLine(c,s);if(g.index>f.index||g.index===f.index&&g.t>f.t){const D=g;g=f,f=D}const _=[g.point],T=g.index+1,A=f.index;!vf(c[T],_[0])&&T<=A&&_.push(c[T]);for(let D=T+1;D<=A;D++)_.push(c[D]);return vf(c[A],f.point)||_.push(f.point),_}lineSliceAlong(n,s,c){let g=0;const f=[];for(let _=0;_<c.length-1;_++){const T=c[_],A=c[_+1],D=this.distance(T,A);if(g+=D,g>n&&f.length===0&&f.push(Vo(T,A,(n-(g-D))/D)),g>=s)return f.push(Vo(T,A,(s-(g-D))/D)),f;g>n&&f.push(A)}return f}bufferPoint(n,s){const c=s/this.ky,g=s/this.kx;return[n[0]-g,n[1]-c,n[0]+g,n[1]+c]}bufferBBox(n,s){const c=s/this.ky,g=s/this.kx;return[n[0]-g,n[1]-c,n[2]+g,n[3]+c]}insideBBox(n,s){return Cs(n[0]-s[0])>=0&&Cs(n[0]-s[2])<=0&&n[1]>=s[1]&&n[1]<=s[3]}}function vf(u,n){return u[0]===n[0]&&u[1]===n[1]}function Vo(u,n,s){const c=Cs(n[0]-u[0]);return[u[0]+c*s,u[1]+(n[1]-u[1])*s]}function Cs(u){for(;u<-180;)u+=360;for(;u>180;)u-=360;return u}class Jh{constructor(n=[],s=(c,g)=>c<g?-1:c>g?1:0){if(this.data=n,this.length=this.data.length,this.compare=s,this.length>0)for(let c=(this.length>>1)-1;c>=0;c--)this._down(c)}push(n){this.data.push(n),this._up(this.length++)}pop(){if(this.length===0)return;const n=this.data[0],s=this.data.pop();return--this.length>0&&(this.data[0]=s,this._down(0)),n}peek(){return this.data[0]}_up(n){const{data:s,compare:c}=this,g=s[n];for(;n>0;){const f=n-1>>1,_=s[f];if(c(g,_)>=0)break;s[n]=_,n=f}s[n]=g}_down(n){const{data:s,compare:c}=this,g=this.length>>1,f=s[n];for(;n<g;){let _=1+(n<<1);const T=_+1;if(T<this.length&&c(s[T],s[_])<0&&(_=T),c(s[_],f)>=0)break;s[n]=s[_],n=_}s[n]=f}}var kn=8192;function Qh(u,n){return n.dist-u.dist}const Tl=100,$o=50;function Av(u){const n=[1/0,1/0,-1/0,-1/0];if(n.length!==u.length)return!1;for(let s=0;s<n.length;s++)if(n[s]!==u[s])return!1;return!0}function ep(u){return u[1]-u[0]+1}function Cl(u,n){const s=u[1]>=u[0]&&u[1]<n;return s||console.warn("Distance Expression: Index is out of range"),s}function Kc(u,n){if(u[0]>u[1])return[null,null];const s=ep(u);if(n){if(s===2)return[u,null];const c=Math.floor(s/2);return[[u[0],u[0]+c],[u[0]+c,u[1]]]}{if(s===1)return[u,null];const c=Math.floor(s/2)-1;return[[u[0],u[0]+c],[u[0]+c+1,u[1]]]}}function cu(u,n){const s=[1/0,1/0,-1/0,-1/0];if(!Cl(n,u.length))return s;for(let c=n[0];c<=n[1];++c)_f(s,u[c]);return s}function Zc(u){const n=[1/0,1/0,-1/0,-1/0];for(let s=0;s<u.length;++s)for(let c=0;c<u[s].length;++c)_f(n,u[s][c]);return n}function Yc(u,n,s){if(Av(u)||Av(n))return NaN;let c=0,g=0;return u[2]<n[0]&&(c=n[0]-u[2]),u[0]>n[2]&&(c=u[0]-n[2]),u[1]>n[3]&&(g=u[1]-n[3]),u[3]<n[1]&&(g=n[1]-u[3]),s.distance([0,0],[c,g])}function Zx(u){return 360*u-180}function Yx(u){return 360/Math.PI*Math.atan(Math.exp((180-360*u)*Math.PI/180))-90}function vg(u,n){const s=Math.pow(2,n.z),c=(u.y/kn+n.y)/s;return[Zx((u.x/kn+n.x)/s),Yx(c)]}function kv(u,n){const s=[];for(let c=0;c<u.length;++c)s.push(vg(u[c],n));return s}function Pv(u,n,s){const c=s.pointOnLine(n,u).point;return s.distance(u,c)}function Rv(u,n,s,c,g){const f=s.slice(c[0],c[1]+1);let _=1/0;for(let T=n[0];T<=n[1];++T)if((_=Math.min(_,Pv(u[T],f,g)))===0)return 0;return _}function El(u,n,s,c,g){const f=Math.min(g.pointToSegmentDistance(u,s,c),g.pointToSegmentDistance(n,s,c)),_=Math.min(g.pointToSegmentDistance(s,u,n),g.pointToSegmentDistance(c,u,n));return Math.min(f,_)}function Xx(u,n,s,c,g){if(!Cl(n,u.length)||!Cl(c,s.length))return NaN;let f=1/0;for(let _=n[0];_<n[1];++_)for(let T=c[0];T<c[1];++T){if(Kh(u[_],u[_+1],s[T],s[T+1]))return 0;f=Math.min(f,El(u[_],u[_+1],s[T],s[T+1],g))}return f}function Jx(u,n,s,c,g){if(!Cl(n,u.length)||!Cl(c,s.length))return NaN;let f=1/0;for(let _=n[0];_<=n[1];++_)for(let T=c[0];T<=c[1];++T)if((f=Math.min(f,g.distance(u[_],s[T])))===0)return f;return f}function bg(u,n,s){if(ka(u,n,!0))return 0;let c=1/0;for(const g of n){const f=g.length;if(f<2)return console.warn("Distance Expression: Invalid polygon!"),NaN;if(g[0]!==g[f-1]&&(c=Math.min(c,s.pointToSegmentDistance(u,g[f-1],g[0])))===0||(c=Math.min(c,Pv(u,g,s)))===0)return c}return c}function Ov(u,n,s,c){if(!Cl(n,u.length))return NaN;for(let f=n[0];f<=n[1];++f)if(ka(u[f],s,!0))return 0;let g=1/0;for(let f=n[0];f<n[1];++f)for(const _ of s)for(let T=0,A=_.length,D=A-1;T<A;D=T++){if(Kh(u[f],u[f+1],_[D],_[T]))return 0;g=Math.min(g,El(u[f],u[f+1],_[D],_[T],c))}return g}function xg(u,n){for(const s of u)for(let c=0;c<=s.length-1;++c)if(ka(s[c],n,!0))return!0;return!1}function Pa(u,n,s,c=1/0){const g=Zc(u),f=Zc(n);if(c!==1/0&&Yc(g,f,s)>=c)return c;if(yf(g,f)){if(xg(u,n))return 0}else if(xg(n,u))return 0;let _=c;for(const T of u)for(let A=0,D=T.length,w=D-1;A<D;w=A++)for(const k of n)for(let O=0,I=k.length,R=I-1;O<I;R=O++){if(Kh(T[w],T[A],k[R],k[O]))return 0;_=Math.min(_,El(T[w],T[A],k[R],k[O],s))}return _}function bf(u,n,s,c,g,f,_){if(f===null||_===null)return;const T=Yc(cu(c,f),cu(g,_),s);T<n&&u.push({dist:T,range1:f,range2:_})}function Lv(u,n,s,c,g=1/0){let f=Math.min(c.distance(u[0],s[0][0]),g);if(f===0)return f;const _=new Jh([{dist:0,range1:[0,u.length-1],range2:[0,0]}],Qh),T=n?$o:Tl,A=Zc(s);for(;_.length;){const D=_.pop();if(D.dist>=f)continue;const w=D.range1;if(ep(w)<=T){if(!Cl(w,u.length))return NaN;if(n){const k=Ov(u,w,s,c);if((f=Math.min(f,k))===0)return f}else for(let k=w[0];k<=w[1];++k){const O=bg(u[k],s,c);if((f=Math.min(f,O))===0)return f}}else{const k=Kc(w,n);if(k[0]!==null){const O=Yc(cu(u,k[0]),A,c);O<f&&_.push({dist:O,range1:k[0],range2:[0,0]})}if(k[1]!==null){const O=Yc(cu(u,k[1]),A,c);O<f&&_.push({dist:O,range1:k[1],range2:[0,0]})}}}return f}function wg(u,n,s,c,g,f=1/0){let _=Math.min(f,g.distance(u[0],s[0]));if(_===0)return _;const T=new Jh([{dist:0,range1:[0,u.length-1],range2:[0,s.length-1]}],Qh),A=n?$o:Tl,D=c?$o:Tl;for(;T.length;){const w=T.pop();if(w.dist>=_)continue;const k=w.range1,O=w.range2;if(ep(k)<=A&&ep(O)<=D){if(!Cl(k,u.length)||!Cl(O,s.length))return NaN;if(n&&c?_=Math.min(_,Xx(u,k,s,O,g)):n||c?n&&!c?_=Math.min(_,Rv(s,O,u,k,g)):!n&&c&&(_=Math.min(_,Rv(u,k,s,O,g))):_=Math.min(_,Jx(u,k,s,O,g)),_===0)return _}else{const I=Kc(k,n),R=Kc(O,c);bf(T,_,g,u,s,I[0],R[0]),bf(T,_,g,u,s,I[0],R[1]),bf(T,_,g,u,s,I[1],R[0]),bf(T,_,g,u,s,I[1],R[1])}}return _}function tp(u,n,s,c,g=1/0){let f=g;const _=cu(u,[0,u.length-1]);for(const T of s)if(!(f!==1/0&&Yc(_,cu(T,[0,T.length-1]),c)>=f)&&(f=Math.min(f,wg(u,n,T,!0,c,f)),f===0))return f;return f}function xf(u,n,s,c,g=1/0){let f=g;const _=cu(u,[0,u.length-1]);for(const T of s){if(f!==1/0&&Yc(_,Zc(T),c)>=f)continue;const A=Lv(u,n,T,c,f);if(isNaN(A))return A;if((f=Math.min(f,A))===0)return f}return f}function np(u){return u==="Point"||u==="MultiPoint"||u==="LineString"||u==="MultiLineString"||u==="Polygon"||u==="MultiPolygon"}class du{constructor(n,s){this.type=Hn,this.geojson=n,this.geometries=s}static parse(n,s){if(n.length!==2)return s.error(`'distance' expression requires either one argument, but found ' ${n.length-1} instead.`);if(Qu(n[1])){const c=n[1];if(c.type==="FeatureCollection"){for(let g=0;g<c.features.length;++g)if(np(c.features[g].geometry.type))return new du(c,c.features[g].geometry)}else if(c.type==="Feature"){if(np(c.geometry.type))return new du(c,c.geometry)}else if(np(c.type))return new du(c,c)}return s.error("'distance' expression needs to be an array with format ['Distance', GeoJSONObj].")}evaluate(n){const s=n.geometry(),c=n.canonicalID();if(s!=null&&c!=null){if(n.geometryType()==="Point")return function(g,f,_){const T=[];for(const D of g)for(const w of D)T.push(vg(w,f));const A=new qc(T[0][1],"meters");return _.type==="Point"||_.type==="MultiPoint"||_.type==="LineString"?wg(T,!1,_.type==="Point"?[_.coordinates]:_.coordinates,_.type==="LineString",A):_.type==="MultiLineString"?tp(T,!1,_.coordinates,A):_.type==="Polygon"||_.type==="MultiPolygon"?xf(T,!1,_.type==="Polygon"?[_.coordinates]:_.coordinates,A):null}(s,c,this.geometries);if(n.geometryType()==="LineString")return function(g,f,_){const T=[];for(const D of g){const w=[];for(const k of D)w.push(vg(k,f));T.push(w)}const A=new qc(T[0][0][1],"meters");if(_.type==="Point"||_.type==="MultiPoint"||_.type==="LineString")return tp(_.type==="Point"?[_.coordinates]:_.coordinates,_.type==="LineString",T,A);if(_.type==="MultiLineString"){let D=1/0;for(let w=0;w<_.coordinates.length;w++){const k=tp(_.coordinates[w],!0,T,A,D);if(isNaN(k))return k;if((D=Math.min(D,k))===0)return D}return D}if(_.type==="Polygon"||_.type==="MultiPolygon"){let D=1/0;for(let w=0;w<T.length;w++){const k=xf(T[w],!0,_.type==="Polygon"?[_.coordinates]:_.coordinates,A,D);if(isNaN(k))return k;if((D=Math.min(D,k))===0)return D}return D}return null}(s,c,this.geometries);if(n.geometryType()==="Polygon")return function(g,f,_){const T=[];for(const D of function(w,k){const O=w.length;if(O<=1)return[w];const I=[];let R,B;for(let W=0;W<O;W++){const K=Gx(w[W]);K!==0&&(w[W].area=Math.abs(K),B===void 0&&(B=K<0),B===K<0?(R&&I.push(R),R=[w[W]]):R.push(w[W]))}return R&&I.push(R),I}(g)){const w=[];for(let k=0;k<D.length;++k)w.push(kv(D[k],f));T.push(w)}const A=new qc(T[0][0][0][1],"meters");if(_.type==="Point"||_.type==="MultiPoint"||_.type==="LineString")return xf(_.type==="Point"?[_.coordinates]:_.coordinates,_.type==="LineString",T,A);if(_.type==="MultiLineString"){let D=1/0;for(let w=0;w<_.coordinates.length;w++){const k=xf(_.coordinates[w],!0,T,A,D);if(isNaN(k))return k;if((D=Math.min(D,k))===0)return D}return D}return _.type==="Polygon"||_.type==="MultiPolygon"?function(D,w,k){let O=1/0;for(const I of D)for(const R of w){const B=Pa(I,R,k,O);if(isNaN(B))return B;if((O=Math.min(O,B))===0)return O}return O}(_.type==="Polygon"?[_.coordinates]:_.coordinates,T,A):null}(s,c,this.geometries);console.warn("Distance Expression: currently only evaluates valid Point/LineString/Polygon geometries.")}else console.warn("Distance Expression: requirs valid feature and canonical information.");return null}eachChild(){}outputDefined(){return!0}serialize(){return["distance",this.geojson]}}function rp(u,n){switch(u){case"string":return Aa(n);case"number":return+n;case"boolean":return!!n;case"color":return Jr.parse(n);case"formatted":return qo.fromString(Aa(n));case"resolvedImage":return Lo.build(Aa(n))}return n}function Sg(u,n,s,c){return c!==void 0&&(u=c*Math.round(u/c)),n!==void 0&&u<n&&(u=n),s!==void 0&&u>s&&(u=s),u}class tc{constructor(n,s,c){this.type=n,this.key=s,this.scope=c}static parse(n,s){let c=s.expectedType;if(c==null&&(c=Hr),n.length<2||n.length>3)return s.error("Invalid number of arguments for 'config' expression.");const g=s.parse(n[1],1);if(!(g instanceof da))return s.error("Key name of 'config' expression must be a string literal.");if(n.length>=3){const f=s.parse(n[2],2);return f instanceof da?new tc(c,Aa(g.value),Aa(f.value)):s.error("Scope of 'config' expression must be a string literal.")}return new tc(c,Aa(g.value))}evaluate(n){const s=[this.key,this.scope,n.scope].filter(Boolean).join(""),c=n.getConfig(s);if(!c)return null;const{type:g,value:f,values:_,minValue:T,maxValue:A,stepValue:D}=c,w=c.default.evaluate(n);let k=w;if(f){const O=n.scope;n.scope=(O||"").split("").slice(1).join(""),k=f.evaluate(n),n.scope=O}return g&&(k=rp(g,k)),k===void 0||T===void 0&&A===void 0&&D===void 0||(typeof k=="number"?k=Sg(k,T,A,D):Array.isArray(k)&&(k=k.map(O=>typeof O=="number"?Sg(O,T,A,D):O))),f!==void 0&&k!==void 0&&_&&!_.includes(k)&&(k=w,g&&(k=rp(g,k))),(g&&g!==this.type||k!==void 0&&Gi(k)!==this.type)&&(k=rp(this.type.kind,k)),k}eachChild(){}outputDefined(){return!1}serialize(){const n=["config",this.key];return this.scope&&n.concat(this.key),n}}function Xc(u){if(u instanceof Ts&&(u.name==="get"&&u.args.length===1||u.name==="feature-state"||u.name==="has"&&u.args.length===1||u.name==="properties"||u.name==="geometry-type"||u.name==="id"||/^filter-/.test(u.name))||u instanceof Sl||u instanceof du)return!1;let n=!0;return u.eachChild(s=>{n&&!Xc(s)&&(n=!1)}),n}function nc(u){if(u instanceof Ts&&u.name==="feature-state")return!1;let n=!0;return u.eachChild(s=>{n&&!nc(s)&&(n=!1)}),n}function rc(u){if(u instanceof tc)return new Set([u.key]);let n=new Set;return u.eachChild(s=>{n=new Set([...n,...rc(s)])}),n}function Ml(u,n){if(u instanceof Ts&&n.indexOf(u.name)>=0)return!1;let s=!0;return u.eachChild(c=>{s&&!Ml(c,n)&&(s=!1)}),s}class wf{constructor(n,s){this.type=s.type,this.name=n,this.boundExpression=s}static parse(n,s){if(n.length!==2||typeof n[1]!="string")return s.error("'var' expression requires exactly one string literal argument.");const c=n[1];return s.scope.has(c)?new wf(c,s.scope.get(c)):s.error(`Unknown variable "${c}". Make sure "${c}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(n){return this.boundExpression.evaluate(n)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}class ip{constructor(n,s=[],c,g=new _g,f=[],_,T){this.registry=n,this.path=s,this.key=s.map(A=>typeof A=="string"?`['${A}']`:`[${A}]`).join(""),this.scope=g,this.errors=f,this.expectedType=c,this._scope=_,this.options=T}parse(n,s,c,g,f={}){return s||c?this.concat(s,null,c,g)._parse(n,f):this._parse(n,f)}parseObjectValue(n,s,c,g,f,_={}){return this.concat(s,c,g,f)._parse(n,_)}_parse(n,s){function c(g,f,_){return _==="assert"?new fa(f,[g]):_==="coerce"?new wl(f,[g]):g}if(n!==null&&typeof n!="string"&&typeof n!="boolean"&&typeof n!="number"||(n=["literal",n]),Array.isArray(n)){if(n.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const g=typeof n[0]=="string"?this.registry[n[0]]:void 0;if(g){let f=g.parse(n,this);if(!f)return null;if(this.expectedType){const _=this.expectedType,T=f.type;if(_.kind!=="string"&&_.kind!=="number"&&_.kind!=="boolean"&&_.kind!=="object"&&_.kind!=="array"||T.kind!=="value")if(_.kind!=="color"&&_.kind!=="formatted"&&_.kind!=="resolvedImage"||T.kind!=="value"&&T.kind!=="string"){if(this.checkSubtype(_,T))return null}else f=c(f,_,s.typeAnnotation||"coerce");else f=c(f,_,s.typeAnnotation||"assert")}if(!(f instanceof da)&&f.type.kind!=="resolvedImage"&&fu(f)){const _=new Gh(this._scope,this.options);try{f=new da(f.type,f.evaluate(_))}catch(T){return this.error(T.message),null}}return f}return wl.parse(["to-array",n],this)}return this.error(n===void 0?"'undefined' value invalid. Use null instead.":typeof n=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof n} instead.`)}concat(n,s,c,g){let f=typeof n=="number"?this.path.concat(n):this.path;f=typeof s=="string"?f.concat(s):f;const _=g?this.scope.concat(g):this.scope;return new ip(this.registry,f,c||null,_,this.errors,this._scope,this.options)}error(n,...s){const c=`${this.key}${s.map(g=>`[${g}]`).join("")}`;this.errors.push(new ca(c,n))}checkSubtype(n,s){const c=hf(n,s);return c&&this.error(c),c}}var Tg=ip;function fu(u){if(u instanceof wf)return fu(u.boundExpression);if(u instanceof Ts&&u.name==="error"||u instanceof qh||u instanceof Sl||u instanceof du||u instanceof tc)return!1;const n=u instanceof wl||u instanceof fa;let s=!0;return u.eachChild(c=>{s=n?s&&fu(c):s&&c instanceof da}),!!s&&Xc(u)&&Ml(u,["zoom","heatmap-density","line-progress","raster-value","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center","measure-light","raster-particle-speed"])}function jr(u,n){const s=u.length-1;let c,g,f=0,_=s,T=0;for(;f<=_;)if(T=Math.floor((f+_)/2),c=u[T],g=u[T+1],c<=n){if(T===s||n<g)return T;f=T+1}else{if(!(c>n))throw new fo("Input is not a number.");_=T-1}return 0}class Sf{constructor(n,s,c){this.type=n,this.input=s,this.labels=[],this.outputs=[];for(const[g,f]of c)this.labels.push(g),this.outputs.push(f)}static parse(n,s){if(n.length-1<4)return s.error(`Expected at least 4 arguments, but found only ${n.length-1}.`);if((n.length-1)%2!=0)return s.error("Expected an even number of arguments.");const c=s.parse(n[1],1,Hn);if(!c)return null;const g=[];let f=null;s.expectedType&&s.expectedType.kind!=="value"&&(f=s.expectedType);for(let _=1;_<n.length;_+=2){const T=_===1?-1/0:n[_],A=n[_+1],D=_,w=_+1;if(typeof T!="number")return s.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',D);if(g.length&&g[g.length-1][0]>=T)return s.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',D);const k=s.parse(A,w,f);if(!k)return null;f=f||k.type,g.push([T,k])}return new Sf(f,c,g)}evaluate(n){const s=this.labels,c=this.outputs;if(s.length===1)return c[0].evaluate(n);const g=this.input.evaluate(n);if(g<=s[0])return c[0].evaluate(n);const f=s.length;return g>=s[f-1]?c[f-1].evaluate(n):c[jr(s,g)].evaluate(n)}eachChild(n){n(this.input);for(const s of this.outputs)n(s)}outputDefined(){return this.outputs.every(n=>n.outputDefined())}serialize(){const n=["step",this.input.serialize()];for(let s=0;s<this.labels.length;s++)s>0&&n.push(this.labels[s]),n.push(this.outputs[s].serialize());return n}}const Dv=.95047,zv=1.08883,Cg=4/29,Jc=6/29,$i=3*Jc*Jc,Qx=Jc*Jc*Jc,ew=Math.PI/180,tw=180/Math.PI;function Eg(u){return u>Qx?Math.pow(u,1/3):u/$i+Cg}function Mg(u){return u>Jc?u*u*u:$i*(u-Cg)}function Ig(u){return 255*(u<=.0031308?12.92*u:1.055*Math.pow(u,1/2.4)-.055)}function Ag(u){return(u/=255)<=.04045?u/12.92:Math.pow((u+.055)/1.055,2.4)}function Fv(u){const n=Ag(u.r),s=Ag(u.g),c=Ag(u.b),g=Eg((.4124564*n+.3575761*s+.1804375*c)/Dv),f=Eg((.2126729*n+.7151522*s+.072175*c)/1);return{l:116*f-16,a:500*(g-f),b:200*(f-Eg((.0193339*n+.119192*s+.9503041*c)/zv)),alpha:u.a}}function Nv(u){let n=(u.l+16)/116,s=isNaN(u.a)?n:n+u.a/500,c=isNaN(u.b)?n:n-u.b/200;return n=1*Mg(n),s=Dv*Mg(s),c=zv*Mg(c),new Jr(Ig(3.2404542*s-1.5371385*n-.4985314*c),Ig(-.969266*s+1.8760108*n+.041556*c),Ig(.0556434*s-.2040259*n+1.0572252*c),u.alpha)}function nw(u,n,s){const c=n-u;return u+s*(c>180||c<-180?c-360*Math.round(c/360):c)}const Tf={forward:Fv,reverse:Nv,interpolate:function(u,n,s){return{l:pr(u.l,n.l,s),a:pr(u.a,n.a,s),b:pr(u.b,n.b,s),alpha:pr(u.alpha,n.alpha,s)}}},Cf={forward:function(u){const{l:n,a:s,b:c}=Fv(u),g=Math.atan2(c,s)*tw;return{h:g<0?g+360:g,c:Math.sqrt(s*s+c*c),l:n,alpha:u.a}},reverse:function(u){const n=u.h*ew,s=u.c;return Nv({l:u.l,a:Math.cos(n)*s,b:Math.sin(n)*s,alpha:u.alpha})},interpolate:function(u,n,s){return{h:nw(u.h,n.h,s),c:pr(u.c,n.c,s),l:pr(u.l,n.l,s),alpha:pr(u.alpha,n.alpha,s)}}};var Bv=Object.freeze({__proto__:null,hcl:Cf,lab:Tf});class Es{constructor(n,s,c,g,f,_){this.type=n,this.operator=s,this.interpolation=c,this.input=g,this.dynamicStops=f,this.labels=[],this.outputs=[];for(const[T,A]of _)this.labels.push(T),this.outputs.push(A)}static interpolationFactor(n,s,c,g){let f=0;if(n.name==="exponential")f=kg(s,n.base,c,g);else if(n.name==="linear")f=kg(s,1,c,g);else if(n.name==="cubic-bezier"){const _=n.controlPoints;f=new Ae(_[0],_[1],_[2],_[3]).solve(kg(s,1,c,g))}return f}static parse(n,s){let[c,g,f,..._]=n;if(!Array.isArray(g)||g.length===0)return s.error("Expected an interpolation type expression.",1);if(g[0]==="linear")g={name:"linear"};else if(g[0]==="exponential"){const D=g[1];if(typeof D!="number")return s.error("Exponential interpolation requires a numeric base.",1,1);g={name:"exponential",base:D}}else{if(g[0]!=="cubic-bezier")return s.error(`Unknown interpolation type ${String(g[0])}`,1,0);{const D=g.slice(1);if(D.length!==4||D.some(w=>typeof w!="number"||w<0||w>1))return s.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);g={name:"cubic-bezier",controlPoints:D}}}if(n.length-1<3)return s.error(`Expected at least 3 arguments, but found only ${n.length-1}.`);if(n.length-1>3&&(n.length-1)%2!=0)return s.error("Expected an even number of arguments.");if(f=s.parse(f,2,Hn),!f)return null;const T=[];let A=null;if(c==="interpolate-hcl"||c==="interpolate-lab"?A=Ss:s.expectedType&&s.expectedType.kind!=="value"&&(A=s.expectedType),n.length-1==3){const D=s.parse(_[0],3,Hr);return D?new Es(A,c,g,f,D,T):null}for(let D=0;D<_.length;D+=2){const w=_[D],k=_[D+1],O=D+3,I=D+4;if(typeof w!="number")return s.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',O);if(T.length&&T[T.length-1][0]>=w)return s.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',O);const R=s.parse(k,I,A);if(!R)return null;A=A||R.type,T.push([w,R])}return A.kind==="number"||A.kind==="color"||A.kind==="array"&&A.itemType.kind==="number"&&typeof A.N=="number"?new Es(A,c,g,f,null,T):s.error(`Type ${zi(A)} is not interpolatable.`)}evaluate(n){let s=this.labels,c=this.outputs;if(this.dynamicStops){const w=this.dynamicStops.evaluate(n);if(w.length%2!=0)throw new fo("Expected an even number of arguments.");s=[],c=[];for(let k=0;k<w.length;k+=2){const O=w[k],I=new da(Hn,w[k+1]);if(typeof O!="number")throw new fo('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.');if(s.length&&s[s.length-1]>=O)throw new fo('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.');s.push(O),c.push(I)}if(s.length===0)throw new fo("Expected at least one input/output pair.")}if(s.length===1)return c[0].evaluate(n);const g=this.input.evaluate(n);if(g<=s[0])return c[0].evaluate(n);const f=s.length;if(g>=s[f-1])return c[f-1].evaluate(n);const _=jr(s,g),T=Es.interpolationFactor(this.interpolation,g,s[_],s[_+1]),A=c[_].evaluate(n),D=c[_+1].evaluate(n);return this.operator==="interpolate"?Yr[this.type.kind.toLowerCase()](A,D,T):this.operator==="interpolate-hcl"?Cf.reverse(Cf.interpolate(Cf.forward(A),Cf.forward(D),T)):Tf.reverse(Tf.interpolate(Tf.forward(A),Tf.forward(D),T))}eachChild(n){n(this.input);for(const s of this.outputs)n(s)}outputDefined(){return this.outputs.every(n=>n.outputDefined())}serialize(){let n;n=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const s=[this.operator,n,this.input.serialize()];if(this.dynamicStops)s.push(this.dynamicStops.serialize());else for(let c=0;c<this.labels.length;c++)s.push(this.labels[c],this.outputs[c].serialize());return s}}function kg(u,n,s,c){const g=c-s,f=u-s;return g===0?0:n===1?f/g:(Math.pow(n,f)-1)/(Math.pow(n,g)-1)}class op{constructor(n,s){this.type=n,this.args=s}static parse(n,s){if(n.length<2)return s.error("Expectected at least one argument.");let c=null;const g=s.expectedType;g&&g.kind!=="value"&&(c=g);const f=[];for(const T of n.slice(1)){const A=s.parse(T,1+f.length,c,void 0,{typeAnnotation:"omit"});if(!A)return null;c=c||A.type,f.push(A)}const _=g&&f.some(T=>hf(g,T.type));return new op(_?Hr:c,f)}evaluate(n){let s,c=null,g=0;for(const f of this.args){if(g++,c=f.evaluate(n),c&&c instanceof Lo&&!c.available&&(s||(s=c),c=null,g===this.args.length))return s;if(c!==null)break}return c}eachChild(n){this.args.forEach(n)}outputDefined(){return this.args.every(n=>n.outputDefined())}serialize(){const n=["coalesce"];return this.eachChild(s=>{n.push(s.serialize())}),n}}class sp{constructor(n,s){this.type=s.type,this.bindings=[].concat(n),this.result=s}evaluate(n){return this.result.evaluate(n)}eachChild(n){for(const s of this.bindings)n(s[1]);n(this.result)}static parse(n,s){if(n.length<4)return s.error(`Expected at least 3 arguments, but found ${n.length-1} instead.`);const c=[];for(let f=1;f<n.length-1;f+=2){const _=n[f];if(typeof _!="string")return s.error(`Expected string, but found ${typeof _} instead.`,f);if(/[^a-zA-Z0-9_]/.test(_))return s.error("Variable names must contain only alphanumeric characters or '_'.",f);const T=s.parse(n[f+1],f+1);if(!T)return null;c.push([_,T])}const g=s.parse(n[n.length-1],n.length-1,s.expectedType,c);return g?new sp(c,g):null}outputDefined(){return this.result.outputDefined()}serialize(){const n=["let"];for(const[s,c]of this.bindings)n.push(s,c.serialize());return n.push(this.result.serialize()),n}}class Pg{constructor(n,s,c){this.type=n,this.index=s,this.input=c}static parse(n,s){if(n.length!==3)return s.error(`Expected 2 arguments, but found ${n.length-1} instead.`);const c=s.parse(n[1],1,Hn),g=s.parse(n[2],2,Wo(s.expectedType||Hr));return c&&g?new Pg(g.type.itemType,c,g):null}evaluate(n){const s=this.index.evaluate(n),c=this.input.evaluate(n);if(s<0)throw new fo(`Array index out of bounds: ${s} < 0.`);if(s>c.length-1)throw new fo(`Array index out of bounds: ${s} > ${c.length-1}.`);if(s===Math.floor(s))return c[s];const g=Math.floor(s),f=Math.ceil(s),_=c[g],T=c[f];if(typeof _!="number"||typeof T!="number")throw new fo(`Cannot interpolate between non-number values at index ${s}.`);const A=s-g;return _*(1-A)+T*A}eachChild(n){n(this.index),n(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}class Rg{constructor(n,s){this.type=Xr,this.needle=n,this.haystack=s}static parse(n,s){if(n.length!==3)return s.error(`Expected 2 arguments, but found ${n.length-1} instead.`);const c=s.parse(n[1],1,Hr),g=s.parse(n[2],2,Hr);return c&&g?jh(c.type,[Xr,oi,Hn,Uc,Hr])?new Rg(c,g):s.error(`Expected first argument to be of type boolean, string, number or null, but found ${zi(c.type)} instead`):null}evaluate(n){const s=this.needle.evaluate(n),c=this.haystack.evaluate(n);if(c==null)return!1;if(!jc(s,["boolean","string","number","null"]))throw new fo(`Expected first argument to be of type boolean, string, number or null, but found ${zi(Gi(s))} instead.`);if(!jc(c,["string","array"]))throw new fo(`Expected second argument to be of type array or string, but found ${zi(Gi(c))} instead.`);return c.indexOf(s)>=0}eachChild(n){n(this.needle),n(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}class ap{constructor(n,s,c){this.type=Hn,this.needle=n,this.haystack=s,this.fromIndex=c}static parse(n,s){if(n.length<=2||n.length>=5)return s.error(`Expected 3 or 4 arguments, but found ${n.length-1} instead.`);const c=s.parse(n[1],1,Hr),g=s.parse(n[2],2,Hr);if(!c||!g)return null;if(!jh(c.type,[Xr,oi,Hn,Uc,Hr]))return s.error(`Expected first argument to be of type boolean, string, number or null, but found ${zi(c.type)} instead`);if(n.length===4){const f=s.parse(n[3],3,Hn);return f?new ap(c,g,f):null}return new ap(c,g)}evaluate(n){const s=this.needle.evaluate(n),c=this.haystack.evaluate(n);if(!jc(s,["boolean","string","number","null"]))throw new fo(`Expected first argument to be of type boolean, string, number or null, but found ${zi(Gi(s))} instead.`);if(!jc(c,["string","array"]))throw new fo(`Expected second argument to be of type array or string, but found ${zi(Gi(c))} instead.`);if(this.fromIndex){const g=this.fromIndex.evaluate(n);return c.indexOf(s,g)}return c.indexOf(s)}eachChild(n){n(this.needle),n(this.haystack),this.fromIndex&&n(this.fromIndex)}outputDefined(){return!1}serialize(){if(this.fromIndex!=null&&this.fromIndex!==void 0){const n=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),n]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}class Og{constructor(n,s,c,g,f,_){this.inputType=n,this.type=s,this.input=c,this.cases=g,this.outputs=f,this.otherwise=_}static parse(n,s){if(n.length<5)return s.error(`Expected at least 4 arguments, but found only ${n.length-1}.`);if(n.length%2!=1)return s.error("Expected an even number of arguments.");let c,g;s.expectedType&&s.expectedType.kind!=="value"&&(g=s.expectedType);const f={},_=[];for(let D=2;D<n.length-1;D+=2){let w=n[D];const k=n[D+1];Array.isArray(w)||(w=[w]);const O=s.concat(D);if(w.length===0)return O.error("Expected at least one branch label.");for(const R of w){if(typeof R!="number"&&typeof R!="string")return O.error("Branch labels must be numbers or strings.");if(typeof R=="number"&&Math.abs(R)>Number.MAX_SAFE_INTEGER)return O.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof R=="number"&&Math.floor(R)!==R)return O.error("Numeric branch labels must be integer values.");if(c){if(O.checkSubtype(c,Gi(R)))return null}else c=Gi(R);if(f[String(R)]!==void 0)return O.error("Branch labels must be unique.");f[String(R)]=_.length}const I=s.parse(k,D,g);if(!I)return null;g=g||I.type,_.push(I)}const T=s.parse(n[1],1,Hr);if(!T)return null;const A=s.parse(n[n.length-1],n.length-1,g);return A?T.type.kind!=="value"&&s.concat(1).checkSubtype(c,T.type)?null:new Og(c,g,T,f,_,A):null}evaluate(n){const s=this.input.evaluate(n);return(Gi(s)===this.inputType&&this.outputs[this.cases[s]]||this.otherwise).evaluate(n)}eachChild(n){n(this.input),this.outputs.forEach(n),n(this.otherwise)}outputDefined(){return this.outputs.every(n=>n.outputDefined())&&this.otherwise.outputDefined()}serialize(){const n=["match",this.input.serialize()],s=Object.keys(this.cases).sort(),c=[],g={};for(const _ of s){const T=g[this.cases[_]];T===void 0?(g[this.cases[_]]=c.length,c.push([this.cases[_],[_]])):c[T][1].push(_)}const f=_=>this.inputType.kind==="number"?Number(_):_;for(const[_,T]of c)n.push(T.length===1?f(T[0]):T.map(f)),n.push(this.outputs[_].serialize());return n.push(this.otherwise.serialize()),n}}class Lg{constructor(n,s,c){this.type=n,this.branches=s,this.otherwise=c}static parse(n,s){if(n.length<4)return s.error(`Expected at least 3 arguments, but found only ${n.length-1}.`);if(n.length%2!=0)return s.error("Expected an odd number of arguments.");let c;s.expectedType&&s.expectedType.kind!=="value"&&(c=s.expectedType);const g=[];for(let _=1;_<n.length-1;_+=2){const T=s.parse(n[_],_,Xr);if(!T)return null;const A=s.parse(n[_+1],_+1,c);if(!A)return null;g.push([T,A]),c=c||A.type}const f=s.parse(n[n.length-1],n.length-1,c);return f?new Lg(c,g,f):null}evaluate(n){for(const[s,c]of this.branches)if(s.evaluate(n))return c.evaluate(n);return this.otherwise.evaluate(n)}eachChild(n){for(const[s,c]of this.branches)n(s),n(c);n(this.otherwise)}outputDefined(){return this.branches.every(([n,s])=>s.outputDefined())&&this.otherwise.outputDefined()}serialize(){const n=["case"];return this.eachChild(s=>{n.push(s.serialize())}),n}}class lp{constructor(n,s,c,g){this.type=n,this.input=s,this.beginIndex=c,this.endIndex=g}static parse(n,s){if(n.length<=2||n.length>=5)return s.error(`Expected 3 or 4 arguments, but found ${n.length-1} instead.`);const c=s.parse(n[1],1,Hr),g=s.parse(n[2],2,Hn);if(!c||!g)return null;if(!jh(c.type,[Wo(Hr),oi,Hr]))return s.error(`Expected first argument to be of type array or string, but found ${zi(c.type)} instead`);if(n.length===4){const f=s.parse(n[3],3,Hn);return f?new lp(c.type,c,g,f):null}return new lp(c.type,c,g)}evaluate(n){const s=this.input.evaluate(n),c=this.beginIndex.evaluate(n);if(!jc(s,["string","array"]))throw new fo(`Expected first argument to be of type array or string, but found ${zi(Gi(s))} instead.`);if(this.endIndex){const g=this.endIndex.evaluate(n);return s.slice(c,g)}return s.slice(c)}eachChild(n){n(this.input),n(this.beginIndex),this.endIndex&&n(this.endIndex)}outputDefined(){return!1}serialize(){if(this.endIndex!=null&&this.endIndex!==void 0){const n=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),n]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}function Vv(u,n){return u==="=="||u==="!="?n.kind==="boolean"||n.kind==="string"||n.kind==="number"||n.kind==="null"||n.kind==="value":n.kind==="string"||n.kind==="number"||n.kind==="value"}function $v(u,n,s,c){return c.compare(n,s)===0}function Qc(u,n,s){const c=u!=="=="&&u!=="!=";return class EB{constructor(f,_,T){this.type=Xr,this.lhs=f,this.rhs=_,this.collator=T,this.hasUntypedArgument=f.type.kind==="value"||_.type.kind==="value"}static parse(f,_){if(f.length!==3&&f.length!==4)return _.error("Expected two or three arguments.");const T=f[0];let A=_.parse(f[1],1,Hr);if(!A)return null;if(!Vv(T,A.type))return _.concat(1).error(`"${T}" comparisons are not supported for type '${zi(A.type)}'.`);let D=_.parse(f[2],2,Hr);if(!D)return null;if(!Vv(T,D.type))return _.concat(2).error(`"${T}" comparisons are not supported for type '${zi(D.type)}'.`);if(A.type.kind!==D.type.kind&&A.type.kind!=="value"&&D.type.kind!=="value")return _.error(`Cannot compare types '${zi(A.type)}' and '${zi(D.type)}'.`);c&&(A.type.kind==="value"&&D.type.kind!=="value"?A=new fa(D.type,[A]):A.type.kind!=="value"&&D.type.kind==="value"&&(D=new fa(A.type,[D])));let w=null;if(f.length===4){if(A.type.kind!=="string"&&D.type.kind!=="string"&&A.type.kind!=="value"&&D.type.kind!=="value")return _.error("Cannot use collator to compare non-string types.");if(w=_.parse(f[3],3,Uh),!w)return null}return new EB(A,D,w)}evaluate(f){const _=this.lhs.evaluate(f),T=this.rhs.evaluate(f);if(c&&this.hasUntypedArgument){const A=Gi(_),D=Gi(T);if(A.kind!==D.kind||A.kind!=="string"&&A.kind!=="number")throw new fo(`Expected arguments for "${u}" to be (string, string) or (number, number), but found (${A.kind}, ${D.kind}) instead.`)}if(this.collator&&!c&&this.hasUntypedArgument){const A=Gi(_),D=Gi(T);if(A.kind!=="string"||D.kind!=="string")return n(f,_,T)}return this.collator?s(f,_,T,this.collator.evaluate(f)):n(f,_,T)}eachChild(f){f(this.lhs),f(this.rhs),this.collator&&f(this.collator)}outputDefined(){return!0}serialize(){const f=[u];return this.eachChild(_=>{f.push(_.serialize())}),f}}}const rw=Qc("==",function(u,n,s){return n===s},$v),iw=Qc("!=",function(u,n,s){return n!==s},function(u,n,s,c){return!$v(0,n,s,c)}),ow=Qc("<",function(u,n,s){return n<s},function(u,n,s,c){return c.compare(n,s)<0}),sw=Qc(">",function(u,n,s){return n>s},function(u,n,s,c){return c.compare(n,s)>0}),aw=Qc("<=",function(u,n,s){return n<=s},function(u,n,s,c){return c.compare(n,s)<=0}),Dg=Qc(">=",function(u,n,s){return n>=s},function(u,n,s,c){return c.compare(n,s)>=0});class zg{constructor(n,s,c,g,f,_){this.type=oi,this.number=n,this.locale=s,this.currency=c,this.unit=g,this.minFractionDigits=f,this.maxFractionDigits=_}static parse(n,s){if(n.length!==3)return s.error("Expected two arguments.");const c=s.parse(n[1],1,Hn);if(!c)return null;const g=n[2];if(typeof g!="object"||Array.isArray(g))return s.error("NumberFormat options argument must be an object.");let f=null;if(g.locale&&(f=s.parseObjectValue(g.locale,2,"locale",oi),!f))return null;let _=null;if(g.currency&&(_=s.parseObjectValue(g.currency,2,"currency",oi),!_))return null;let T=null;if(g.unit&&(T=s.parseObjectValue(g.unit,2,"unit",oi),!T))return null;let A=null;if(g["min-fraction-digits"]&&(A=s.parseObjectValue(g["min-fraction-digits"],2,"min-fraction-digits",Hn),!A))return null;let D=null;return g["max-fraction-digits"]&&(D=s.parseObjectValue(g["max-fraction-digits"],2,"max-fraction-digits",Hn),!D)?null:new zg(c,f,_,T,A,D)}evaluate(n){return new Intl.NumberFormat(this.locale?this.locale.evaluate(n):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(n):void 0,unit:this.unit?this.unit.evaluate(n):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(n):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(n):void 0}).format(this.number.evaluate(n))}eachChild(n){n(this.number),this.locale&&n(this.locale),this.currency&&n(this.currency),this.unit&&n(this.unit),this.minFractionDigits&&n(this.minFractionDigits),this.maxFractionDigits&&n(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const n={};return this.locale&&(n.locale=this.locale.serialize()),this.currency&&(n.currency=this.currency.serialize()),this.unit&&(n.unit=this.unit.serialize()),this.minFractionDigits&&(n["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(n["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),n]}}class up{constructor(n){this.type=Hn,this.input=n}static parse(n,s){if(n.length!==2)return s.error(`Expected 1 argument, but found ${n.length-1} instead.`);const c=s.parse(n[1],1);return c?c.type.kind!=="array"&&c.type.kind!=="string"&&c.type.kind!=="value"?s.error(`Expected argument of type string or array, but found ${zi(c.type)} instead.`):new up(c):null}evaluate(n){const s=this.input.evaluate(n);if(typeof s=="string"||Array.isArray(s))return s.length;throw new fo(`Expected value to be of type string or array, but found ${zi(Gi(s))} instead.`)}eachChild(n){n(this.input)}outputDefined(){return!1}serialize(){const n=["length"];return this.eachChild(s=>{n.push(s.serialize())}),n}}function Uv(u){return function(){u=1831565813+(u|=0)|0;let n=Math.imul(u^u>>>15,1|u);return n=n+Math.imul(n^n>>>7,61|n)^n,((n^n>>>14)>>>0)/4294967296}}const ed={"==":rw,"!=":iw,">":sw,"<":ow,">=":Dg,"<=":aw,array:fa,at:Pg,boolean:fa,case:Lg,coalesce:op,collator:qh,format:xl,image:Hc,in:Rg,"index-of":ap,interpolate:Es,"interpolate-hcl":Es,"interpolate-lab":Es,length:up,let:sp,literal:da,match:Og,number:fa,"number-format":zg,object:fa,slice:lp,step:Sf,string:fa,"to-boolean":wl,"to-color":wl,"to-number":wl,"to-string":wl,var:wf,within:Sl,distance:du,config:tc};function jv(u,[n,s,c,g]){n=n.evaluate(u),s=s.evaluate(u),c=c.evaluate(u);const f=g?g.evaluate(u):1,_=Ju(n,s,c,f);if(_)throw new fo(_);return new Jr(n/255*f,s/255*f,c/255*f,f)}function Fg(u,[n,s,c,g]){n=n.evaluate(u),s=s.evaluate(u),c=c.evaluate(u);const f=g?g.evaluate(u):1,_=function(D,w,k,O){return typeof D=="number"&&D>=0&&D<=360?typeof w=="number"&&w>=0&&w<=100&&typeof k=="number"&&k>=0&&k<=100?O===void 0||typeof O=="number"&&O>=0&&O<=1?null:`Invalid hsla value [${[D,w,k,O].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid hsla value [${(typeof O=="number"?[D,w,k,O]:[D,w,k]).join(", ")}]: 's', and 'l' must be between 0 and 100.`:`Invalid hsla value [${(typeof O=="number"?[D,w,k,O]:[D,w,k]).join(", ")}]: 'h' must be between 0 and 360.`}(n,s,c,f);if(_)throw new fo(_);const T=`hsla(${n}, ${s}%, ${c}%, ${f})`,A=Jr.parse(T);if(!A)throw new fo(`Failed to parse HSLA color: ${T}`);return A}function Ng(u,n){return u in n}function hu(u,n){const s=n[u];return s===void 0?null:s}function pu(u){return{type:u}}function Bg(u){return{result:"success",value:u}}function mu(u){return{result:"error",value:u}}function Ef(u,n){return!!u&&!!u.parameters&&u.parameters.indexOf(n)>-1}function td(u){return u["property-type"]==="data-driven"}function Hv(u){return Ef(u.expression,"measure-light")}function Gv(u){return Ef(u.expression,"zoom")}function cp(u){return!!u.expression&&u.expression.interpolated}function dp(u){return typeof u=="object"&&u!==null&&!Array.isArray(u)}function lw(u){return u}function Wv(u,n){const s=n.type==="color",c=u.stops&&typeof u.stops[0][0]=="object",g=c||!(c||u.property!==void 0),f=u.type||(cp(n)?"exponential":"interval");if(s&&((u=$h({},u)).stops&&(u.stops=u.stops.map(D=>[D[0],Jr.parse(D[1])])),u.default=Jr.parse(u.default?u.default:n.default)),u.colorSpace&&u.colorSpace!=="rgb"&&!Bv[u.colorSpace])throw new Error(`Unknown color space: ${u.colorSpace}`);let _,T,A;if(f==="exponential")_=If;else if(f==="interval")_=Kv;else if(f==="categorical"){_=qv,T=Object.create(null);for(const D of u.stops)T[D[0]]=D[1];A=typeof u.stops[0][0]}else{if(f!=="identity")throw new Error(`Unknown function type "${f}"`);_=uw}if(c){const D={},w=[];for(let I=0;I<u.stops.length;I++){const R=u.stops[I],B=R[0].zoom;D[B]===void 0&&(D[B]={zoom:B,type:u.type,property:u.property,default:u.default,stops:[]},w.push(B)),D[B].stops.push([R[0].value,R[1]])}const k=[];for(const I of w)k.push([D[I].zoom,Wv(D[I],n)]);const O={name:"linear"};return{kind:"composite",interpolationType:O,interpolationFactor:Es.interpolationFactor.bind(void 0,O),zoomStops:k.map(I=>I[0]),evaluate:({zoom:I},R)=>If({stops:k,base:u.base},n,I).evaluate(I,R)}}if(g){const D=f==="exponential"?{name:"exponential",base:u.base!==void 0?u.base:1}:null;return{kind:"camera",interpolationType:D,interpolationFactor:Es.interpolationFactor.bind(void 0,D),zoomStops:u.stops.map(w=>w[0]),evaluate:({zoom:w})=>_(u,n,w,T,A)}}return{kind:"source",evaluate(D,w){const k=w&&w.properties?w.properties[u.property]:void 0;return k===void 0?Mf(u.default,n.default):_(u,n,k,T,A)}}}function Mf(u,n,s){return u!==void 0?u:n!==void 0?n:s!==void 0?s:void 0}function qv(u,n,s,c,g){return Mf(typeof s===g?c[s]:void 0,u.default,n.default)}function Kv(u,n,s){if(ec(s)!=="number")return Mf(u.default,n.default);const c=u.stops.length;if(c===1||s<=u.stops[0][0])return u.stops[0][1];if(s>=u.stops[c-1][0])return u.stops[c-1][1];const g=jr(u.stops.map(f=>f[0]),s);return u.stops[g][1]}function If(u,n,s){const c=u.base!==void 0?u.base:1;if(ec(s)!=="number")return Mf(u.default,n.default);const g=u.stops.length;if(g===1||s<=u.stops[0][0])return u.stops[0][1];if(s>=u.stops[g-1][0])return u.stops[g-1][1];const f=jr(u.stops.map(w=>w[0]),s),_=function(w,k,O,I){const R=I-O,B=w-O;return R===0?0:k===1?B/R:(Math.pow(k,B)-1)/(Math.pow(k,R)-1)}(s,c,u.stops[f][0],u.stops[f+1][0]),T=u.stops[f][1],A=u.stops[f+1][1];let D=Yr[n.type]||lw;if(u.colorSpace&&u.colorSpace!=="rgb"){const w=Bv[u.colorSpace];D=(k,O)=>w.reverse(w.interpolate(w.forward(k),w.forward(O),_))}return typeof T.evaluate=="function"?{evaluate(...w){const k=T.evaluate.apply(void 0,w),O=A.evaluate.apply(void 0,w);if(k!==void 0&&O!==void 0)return D(k,O,_)}}:D(T,A,_)}function uw(u,n,s){return n.type==="color"?s=Jr.parse(s):n.type==="formatted"?s=qo.fromString(s.toString()):n.type==="resolvedImage"?s=Lo.build(s.toString()):ec(s)===n.type||n.type==="enum"&&n.values[s]||(s=void 0),Mf(s,u.default,n.default)}Ts.register(ed,{error:[{kind:"error"},[oi],(u,[n])=>{throw new fo(n.evaluate(u))}],typeof:[oi,[Hr],(u,[n])=>zi(Gi(n.evaluate(u)))],"to-rgba":[Wo(Hn,4),[Ss],(u,[n])=>n.evaluate(u).toRenderColor(null).toArray()],"to-hsla":[Wo(Hn,4),[Ss],(u,[n])=>n.evaluate(u).toRenderColor(null).toHslaArray()],rgb:[Ss,[Hn,Hn,Hn],jv],rgba:[Ss,[Hn,Hn,Hn,Hn],jv],hsl:[Ss,[Hn,Hn,Hn],Fg],hsla:[Ss,[Hn,Hn,Hn,Hn],Fg],has:{type:Xr,overloads:[[[oi],(u,[n])=>Ng(n.evaluate(u),u.properties())],[[oi,Yu],(u,[n,s])=>Ng(n.evaluate(u),s.evaluate(u))]]},get:{type:Hr,overloads:[[[oi],(u,[n])=>hu(n.evaluate(u),u.properties())],[[oi,Yu],(u,[n,s])=>hu(n.evaluate(u),s.evaluate(u))]]},"feature-state":[Hr,[oi],(u,[n])=>hu(n.evaluate(u),u.featureState||{})],properties:[Yu,[],u=>u.properties()],"geometry-type":[oi,[],u=>u.geometryType()],id:[Hr,[],u=>u.id()],zoom:[Hn,[],u=>u.globals.zoom],pitch:[Hn,[],u=>u.globals.pitch||0],"distance-from-center":[Hn,[],u=>u.distanceFromCenter()],"measure-light":[Hn,[oi],(u,[n])=>u.measureLight(n.evaluate(u))],"heatmap-density":[Hn,[],u=>u.globals.heatmapDensity||0],"line-progress":[Hn,[],u=>u.globals.lineProgress||0],"raster-value":[Hn,[],u=>u.globals.rasterValue||0],"raster-particle-speed":[Hn,[],u=>u.globals.rasterParticleSpeed||0],"sky-radial-progress":[Hn,[],u=>u.globals.skyRadialProgress||0],accumulated:[Hr,[],u=>u.globals.accumulated===void 0?null:u.globals.accumulated],"+":[Hn,pu(Hn),(u,n)=>{let s=0;for(const c of n)s+=c.evaluate(u);return s}],"*":[Hn,pu(Hn),(u,n)=>{let s=1;for(const c of n)s*=c.evaluate(u);return s}],"-":{type:Hn,overloads:[[[Hn,Hn],(u,[n,s])=>n.evaluate(u)-s.evaluate(u)],[[Hn],(u,[n])=>-n.evaluate(u)]]},"/":[Hn,[Hn,Hn],(u,[n,s])=>n.evaluate(u)/s.evaluate(u)],"%":[Hn,[Hn,Hn],(u,[n,s])=>n.evaluate(u)%s.evaluate(u)],ln2:[Hn,[],()=>Math.LN2],pi:[Hn,[],()=>Math.PI],e:[Hn,[],()=>Math.E],"^":[Hn,[Hn,Hn],(u,[n,s])=>Math.pow(n.evaluate(u),s.evaluate(u))],sqrt:[Hn,[Hn],(u,[n])=>Math.sqrt(n.evaluate(u))],log10:[Hn,[Hn],(u,[n])=>Math.log(n.evaluate(u))/Math.LN10],ln:[Hn,[Hn],(u,[n])=>Math.log(n.evaluate(u))],log2:[Hn,[Hn],(u,[n])=>Math.log(n.evaluate(u))/Math.LN2],sin:[Hn,[Hn],(u,[n])=>Math.sin(n.evaluate(u))],cos:[Hn,[Hn],(u,[n])=>Math.cos(n.evaluate(u))],tan:[Hn,[Hn],(u,[n])=>Math.tan(n.evaluate(u))],asin:[Hn,[Hn],(u,[n])=>Math.asin(n.evaluate(u))],acos:[Hn,[Hn],(u,[n])=>Math.acos(n.evaluate(u))],atan:[Hn,[Hn],(u,[n])=>Math.atan(n.evaluate(u))],min:[Hn,pu(Hn),(u,n)=>Math.min(...n.map(s=>s.evaluate(u)))],max:[Hn,pu(Hn),(u,n)=>Math.max(...n.map(s=>s.evaluate(u)))],abs:[Hn,[Hn],(u,[n])=>Math.abs(n.evaluate(u))],round:[Hn,[Hn],(u,[n])=>{const s=n.evaluate(u);return s<0?-Math.round(-s):Math.round(s)}],floor:[Hn,[Hn],(u,[n])=>Math.floor(n.evaluate(u))],ceil:[Hn,[Hn],(u,[n])=>Math.ceil(n.evaluate(u))],"filter-==":[Xr,[oi,Hr],(u,[n,s])=>u.properties()[n.value]===s.value],"filter-id-==":[Xr,[Hr],(u,[n])=>u.id()===n.value],"filter-type-==":[Xr,[oi],(u,[n])=>u.geometryType()===n.value],"filter-<":[Xr,[oi,Hr],(u,[n,s])=>{const c=u.properties()[n.value],g=s.value;return typeof c==typeof g&&c<g}],"filter-id-<":[Xr,[Hr],(u,[n])=>{const s=u.id(),c=n.value;return typeof s==typeof c&&s<c}],"filter->":[Xr,[oi,Hr],(u,[n,s])=>{const c=u.properties()[n.value],g=s.value;return typeof c==typeof g&&c>g}],"filter-id->":[Xr,[Hr],(u,[n])=>{const s=u.id(),c=n.value;return typeof s==typeof c&&s>c}],"filter-<=":[Xr,[oi,Hr],(u,[n,s])=>{const c=u.properties()[n.value],g=s.value;return typeof c==typeof g&&c<=g}],"filter-id-<=":[Xr,[Hr],(u,[n])=>{const s=u.id(),c=n.value;return typeof s==typeof c&&s<=c}],"filter->=":[Xr,[oi,Hr],(u,[n,s])=>{const c=u.properties()[n.value],g=s.value;return typeof c==typeof g&&c>=g}],"filter-id->=":[Xr,[Hr],(u,[n])=>{const s=u.id(),c=n.value;return typeof s==typeof c&&s>=c}],"filter-has":[Xr,[Hr],(u,[n])=>n.value in u.properties()],"filter-has-id":[Xr,[],u=>u.id()!==null&&u.id()!==void 0],"filter-type-in":[Xr,[Wo(oi)],(u,[n])=>n.value.indexOf(u.geometryType())>=0],"filter-id-in":[Xr,[Wo(Hr)],(u,[n])=>n.value.indexOf(u.id())>=0],"filter-in-small":[Xr,[oi,Wo(Hr)],(u,[n,s])=>s.value.indexOf(u.properties()[n.value])>=0],"filter-in-large":[Xr,[oi,Wo(Hr)],(u,[n,s])=>function(c,g,f,_){for(;f<=_;){const T=f+_>>1;if(g[T]===c)return!0;g[T]>c?_=T-1:f=T+1}return!1}(u.properties()[n.value],s.value,0,s.value.length-1)],all:{type:Xr,overloads:[[[Xr,Xr],(u,[n,s])=>n.evaluate(u)&&s.evaluate(u)],[pu(Xr),(u,n)=>{for(const s of n)if(!s.evaluate(u))return!1;return!0}]]},any:{type:Xr,overloads:[[[Xr,Xr],(u,[n,s])=>n.evaluate(u)||s.evaluate(u)],[pu(Xr),(u,n)=>{for(const s of n)if(s.evaluate(u))return!0;return!1}]]},"!":[Xr,[Xr],(u,[n])=>!n.evaluate(u)],"is-supported-script":[Xr,[oi],(u,[n])=>{const s=u.globals&&u.globals.isSupportedScript;return!s||s(n.evaluate(u))}],upcase:[oi,[oi],(u,[n])=>n.evaluate(u).toUpperCase()],downcase:[oi,[oi],(u,[n])=>n.evaluate(u).toLowerCase()],concat:[oi,pu(Hr),(u,n)=>n.map(s=>Aa(s.evaluate(u))).join("")],"resolved-locale":[oi,[Uh],(u,[n])=>n.evaluate(u).resolvedLocale()],random:[Hn,[Hn,Hn,Hr],(u,n)=>{const[s,c,g]=n.map(_=>_.evaluate(u));if(s>c||s===c)return s;let f;if(typeof g=="string")f=function(_){let T=0;if(_.length===0)return T;for(let A=0;A<_.length;A++)T=(T<<5)-T+_.charCodeAt(A),T|=0;return T}(g);else{if(typeof g!="number")throw new fo(`Invalid seed input: ${g}`);f=g}return s+Uv(f)()*(c-s)}]});class fp{constructor(n,s,c,g){this.expression=n,this._warningHistory={},this._evaluator=new Gh(c,g),this._defaultValue=s?function(f){return f.type==="color"&&(dp(f.default)||Array.isArray(f.default))?new Jr(0,0,0,0):f.type==="color"?Jr.parse(f.default)||null:f.default===void 0?null:f.default}(s):null,this._enumValues=s&&s.type==="enum"?s.values:null,this.configDependencies=rc(n)}evaluateWithoutErrorHandling(n,s,c,g,f,_,T,A){return this._evaluator.globals=n,this._evaluator.feature=s,this._evaluator.featureState=c,this._evaluator.canonical=g||null,this._evaluator.availableImages=f||null,this._evaluator.formattedSection=_,this._evaluator.featureTileCoord=T||null,this._evaluator.featureDistanceData=A||null,this.expression.evaluate(this._evaluator)}evaluate(n,s,c,g,f,_,T,A){this._evaluator.globals=n,this._evaluator.feature=s||null,this._evaluator.featureState=c||null,this._evaluator.canonical=g||null,this._evaluator.availableImages=f||null,this._evaluator.formattedSection=_||null,this._evaluator.featureTileCoord=T||null,this._evaluator.featureDistanceData=A||null;try{const D=this.expression.evaluate(this._evaluator);if(D==null||typeof D=="number"&&D!=D)return this._defaultValue;if(this._enumValues&&!(D in this._enumValues))throw new fo(`Expected value to be one of ${Object.keys(this._enumValues).map(w=>JSON.stringify(w)).join(", ")}, but found ${JSON.stringify(D)} instead.`);return D}catch(D){return this._warningHistory[D.message]||(this._warningHistory[D.message]=!0,typeof console<"u"&&console.warn(`Failed to evaluate expression "${JSON.stringify(this.expression.serialize())}". ${D.message}`)),this._defaultValue}}}function Vg(u){return Array.isArray(u)&&u.length>0&&typeof u[0]=="string"&&u[0]in ed}function Af(u,n,s,c){const g=new Tg(ed,[],n?function(_){const T={color:Ss,string:oi,number:Hn,enum:oi,boolean:Xr,formatted:bl,resolvedImage:Xu};return _.type==="array"?Wo(T[_.value]||Hr,_.length):T[_.type]}(n):void 0,void 0,void 0,s,c),f=g.parse(u,void 0,void 0,void 0,n&&n.type==="string"?{typeAnnotation:"coerce"}:void 0);return f?Bg(new fp(f,n,s,c)):mu(g.errors)}class hp{constructor(n,s,c,g){this.kind=n,this._styleExpression=s,this.isLightConstant=c,this.isLineProgressConstant=g,this.isStateDependent=n!=="constant"&&!nc(s.expression),this.configDependencies=rc(s.expression)}evaluateWithoutErrorHandling(n,s,c,g,f,_){return this._styleExpression.evaluateWithoutErrorHandling(n,s,c,g,f,_)}evaluate(n,s,c,g,f,_){return this._styleExpression.evaluate(n,s,c,g,f,_)}}class nd{constructor(n,s,c,g,f,_){this.kind=n,this.zoomStops=c,this._styleExpression=s,this.isStateDependent=n!=="camera"&&!nc(s.expression),this.isLightConstant=f,this.isLineProgressConstant=_,this.configDependencies=rc(s.expression),this.interpolationType=g}evaluateWithoutErrorHandling(n,s,c,g,f,_){return this._styleExpression.evaluateWithoutErrorHandling(n,s,c,g,f,_)}evaluate(n,s,c,g,f,_){return this._styleExpression.evaluate(n,s,c,g,f,_)}interpolationFactor(n,s,c){return this.interpolationType?Es.interpolationFactor(this.interpolationType,n,s,c):0}}function Zv(u,n,s,c){if((u=Af(u,n,s,c)).result==="error")return u;const g=u.value.expression,f=Xc(g);if(!f&&!td(n))return mu([new ca("","data expressions not supported")]);const _=Ml(g,["zoom","pitch","distance-from-center"]);if(!_&&!Gv(n))return mu([new ca("","zoom expressions not supported")]);const T=Ml(g,["measure-light"]);if(!T&&!Hv(n))return mu([new ca("","measure-light expression not supported")]);const A=Ml(g,["line-progress"]);if(!A&&!function(k){return Ef(k.expression,"line-progress")}(n))return mu([new ca("","line-progress expression not supported")]);const D=n.expression&&n.expression.relaxZoomRestriction,w=mp(g);return w||_||D?w instanceof ca?mu([w]):w instanceof Es&&!cp(n)?mu([new ca("",'"interpolate" expressions cannot be used with this property')]):Bg(w?new nd(f&&A?"camera":"composite",u.value,w.labels,w instanceof Es?w.interpolation:void 0,T,A):new hp(f&&A?"constant":"source",u.value,T,A)):mu([new ca("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression, or in the properties of atmosphere.')])}class pp{constructor(n,s){this._parameters=n,this._specification=s,$h(this,Wv(this._parameters,this._specification))}static deserialize(n){return new pp(n._parameters,n._specification)}static serialize(n){return{_parameters:n._parameters,_specification:n._specification}}}function mp(u){let n=null;if(u instanceof sp)n=mp(u.result);else if(u instanceof op){for(const s of u.args)if(n=mp(s),n)break}else(u instanceof Sf||u instanceof Es)&&u.input instanceof Ts&&u.input.name==="zoom"&&(n=u);return n instanceof ca||u.eachChild(s=>{const c=mp(s);c instanceof ca?n=c:n&&c&&n!==c&&(n=new ca("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),n}var gp,Yv,cw=function(){if(Yv)return gp;Yv=1,gp=n;var u=3;function n(s,c,g){var f=this.cells=[];if(s instanceof ArrayBuffer){this.arrayBuffer=s;var _=new Int32Array(this.arrayBuffer);s=_[0],this.d=(c=_[1])+2*(g=_[2]);for(var T=0;T<this.d*this.d;T++){var A=_[u+T],D=_[u+T+1];f.push(A===D?null:_.subarray(A,D))}var w=_[u+f.length+1];this.keys=_.subarray(_[u+f.length],w),this.bboxes=_.subarray(w),this.insert=this._insertReadonly}else{this.d=c+2*g;for(var k=0;k<this.d*this.d;k++)f.push([]);this.keys=[],this.bboxes=[]}this.n=c,this.extent=s,this.padding=g,this.scale=c/s,this.uid=0;var O=g/c*s;this.min=-O,this.max=s+O}return n.prototype.insert=function(s,c,g,f,_){this._forEachCell(c,g,f,_,this._insertCell,this.uid++),this.keys.push(s),this.bboxes.push(c),this.bboxes.push(g),this.bboxes.push(f),this.bboxes.push(_)},n.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},n.prototype._insertCell=function(s,c,g,f,_,T){this.cells[_].push(T)},n.prototype.query=function(s,c,g,f,_){var T=this.min,A=this.max;if(s<=T&&c<=T&&A<=g&&A<=f&&!_)return Array.prototype.slice.call(this.keys);var D=[];return this._forEachCell(s,c,g,f,this._queryCell,D,{},_),D},n.prototype._queryCell=function(s,c,g,f,_,T,A,D){var w=this.cells[_];if(w!==null)for(var k=this.keys,O=this.bboxes,I=0;I<w.length;I++){var R=w[I];if(A[R]===void 0){var B=4*R;(D?D(O[B+0],O[B+1],O[B+2],O[B+3]):s<=O[B+2]&&c<=O[B+3]&&g>=O[B+0]&&f>=O[B+1])?(A[R]=!0,T.push(k[R])):A[R]=!1}}},n.prototype._forEachCell=function(s,c,g,f,_,T,A,D){for(var w=this._convertToCellCoord(s),k=this._convertToCellCoord(c),O=this._convertToCellCoord(g),I=this._convertToCellCoord(f),R=w;R<=O;R++)for(var B=k;B<=I;B++){var W=this.d*B+R;if((!D||D(this._convertFromCellCoord(R),this._convertFromCellCoord(B),this._convertFromCellCoord(R+1),this._convertFromCellCoord(B+1)))&&_.call(this,s,c,g,f,W,T,A,D))return}},n.prototype._convertFromCellCoord=function(s){return(s-this.padding)/this.scale},n.prototype._convertToCellCoord=function(s){return Math.max(0,Math.min(this.d-1,Math.floor(s*this.scale)+this.padding))},n.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var s=this.cells,c=u+this.cells.length+1+1,g=0,f=0;f<this.cells.length;f++)g+=this.cells[f].length;var _=new Int32Array(c+g+this.keys.length+this.bboxes.length);_[0]=this.extent,_[1]=this.n,_[2]=this.padding;for(var T=c,A=0;A<s.length;A++){var D=s[A];_[u+A]=T,_.set(D,T),T+=D.length}return _[u+s.length]=T,_.set(this.keys,T),_[u+s.length+1]=T+=this.keys.length,_.set(this.bboxes,T),T+=this.bboxes.length,_.buffer},gp}(),ic=S(cw);const kf={};function Gn(u,n,s={}){Object.defineProperty(u,"_classRegistryKey",{value:n,writable:!1}),kf[n]={klass:u,omit:s.omit||[]}}Gn(Object,"Object"),ic.serialize=function(u,n){const s=u.toArrayBuffer();return n&&n.add(s),{buffer:s}},ic.deserialize=function(u){return new ic(u.buffer)},Object.defineProperty(ic,"name",{value:"Grid"}),Gn(ic,"Grid"),typeof DOMMatrix<"u"&&Gn(DOMMatrix,"DOMMatrix"),Gn(Jr,"Color"),Gn(Error,"Error"),Gn(qo,"Formatted"),Gn(pf,"FormattedSection"),Gn(Lh,"AJAXError"),Gn(Lo,"ResolvedImage"),Gn(pp,"StylePropertyFunction"),Gn(fp,"StyleExpression",{omit:["_evaluator"]}),Gn(Za,"ImageIdWithOptions"),Gn(nd,"ZoomDependentExpression"),Gn(hp,"ZoomConstantExpression"),Gn(Ts,"CompoundExpression",{omit:["_evaluate"]});for(const u in ed)kf[ed[u]._classRegistryKey]||Gn(ed[u],`Expression${u}`);function Xv(u){return u&&typeof ArrayBuffer<"u"&&(u instanceof ArrayBuffer||u.constructor&&u.constructor.name==="ArrayBuffer")}function oc(u){return self.ImageBitmap&&u instanceof ImageBitmap}function sc(u,n){if(u==null||typeof u=="boolean"||typeof u=="number"||typeof u=="string"||u instanceof Boolean||u instanceof Number||u instanceof String||u instanceof Date||u instanceof RegExp)return u;if(Xv(u)||oc(u))return n&&n.add(u),u;if(ArrayBuffer.isView(u))return n&&n.add(u.buffer),u;if(u instanceof ImageData)return n&&n.add(u.data.buffer),u;if(Array.isArray(u)){const s=[];for(const c of u)s.push(sc(c,n));return s}if(u instanceof Map){const s={$name:"Map"};for(const[c,g]of u.entries())s[c]=sc(g);return s}if(u instanceof Set){const s={$name:"Set"};let c=0;for(const g of u.values())s[++c]=sc(g);return s}if(typeof u=="object"){const s=u.constructor,c=s._classRegistryKey;if(!c)throw new Error(`Can't serialize object of unregistered class "${c}".`);const g=s.serialize?s.serialize(u,n):{};if(!s.serialize){for(const f in u)u.hasOwnProperty(f)&&(kf[c].omit.indexOf(f)>=0||(g[f]=sc(u[f],n)));u instanceof Error&&(g.message=u.message)}if(g.$name)throw new Error("$name property is reserved for worker serialization logic.");return c!=="Object"&&(g.$name=c),g}throw new Error("can't serialize object of type "+typeof u)}function ac(u){if(u==null||typeof u=="boolean"||typeof u=="number"||typeof u=="string"||u instanceof Boolean||u instanceof Number||u instanceof String||u instanceof Date||u instanceof RegExp||Xv(u)||oc(u)||ArrayBuffer.isView(u)||u instanceof ImageData)return u;if(Array.isArray(u))return u.map(ac);if(typeof u=="object"){const n=u.$name||"Object";if(n==="Map"){const g=new Map;for(const f of Object.keys(u))f!=="$name"&&g.set(f,ac(u[f]));return g}if(n==="Set"){const g=new Set;for(const f of Object.keys(u))f!=="$name"&&g.add(ac(u[f]));return g}const{klass:s}=kf[n];if(!s)throw new Error(`Can't deserialize unregistered class "${n}".`);if(s.deserialize)return s.deserialize(u);const c=Object.create(s.prototype);for(const g of Object.keys(u))g!=="$name"&&(c[g]=ac(u[g]));return c}throw new Error("can't deserialize object of type "+typeof u)}const tr={"Latin-1 Supplement":u=>u>=128&&u<=255,Arabic:u=>u>=1536&&u<=1791,"Arabic Supplement":u=>u>=1872&&u<=1919,"Arabic Extended-A":u=>u>=2208&&u<=2303,"Hangul Jamo":u=>u>=4352&&u<=4607,"Unified Canadian Aboriginal Syllabics":u=>u>=5120&&u<=5759,Khmer:u=>u>=6016&&u<=6143,"Unified Canadian Aboriginal Syllabics Extended":u=>u>=6320&&u<=6399,"General Punctuation":u=>u>=8192&&u<=8303,"Letterlike Symbols":u=>u>=8448&&u<=8527,"Number Forms":u=>u>=8528&&u<=8591,"Miscellaneous Technical":u=>u>=8960&&u<=9215,"Control Pictures":u=>u>=9216&&u<=9279,"Optical Character Recognition":u=>u>=9280&&u<=9311,"Enclosed Alphanumerics":u=>u>=9312&&u<=9471,"Geometric Shapes":u=>u>=9632&&u<=9727,"Miscellaneous Symbols":u=>u>=9728&&u<=9983,"Miscellaneous Symbols and Arrows":u=>u>=11008&&u<=11263,"CJK Radicals Supplement":u=>u>=11904&&u<=12031,"Kangxi Radicals":u=>u>=12032&&u<=12255,"Ideographic Description Characters":u=>u>=12272&&u<=12287,"CJK Symbols and Punctuation":u=>u>=12288&&u<=12351,Hiragana:u=>u>=12352&&u<=12447,Katakana:u=>u>=12448&&u<=12543,Bopomofo:u=>u>=12544&&u<=12591,"Hangul Compatibility Jamo":u=>u>=12592&&u<=12687,Kanbun:u=>u>=12688&&u<=12703,"Bopomofo Extended":u=>u>=12704&&u<=12735,"CJK Strokes":u=>u>=12736&&u<=12783,"Katakana Phonetic Extensions":u=>u>=12784&&u<=12799,"Enclosed CJK Letters and Months":u=>u>=12800&&u<=13055,"CJK Compatibility":u=>u>=13056&&u<=13311,"CJK Unified Ideographs Extension A":u=>u>=13312&&u<=19903,"Yijing Hexagram Symbols":u=>u>=19904&&u<=19967,"CJK Unified Ideographs":u=>u>=19968&&u<=40959,"Yi Syllables":u=>u>=40960&&u<=42127,"Yi Radicals":u=>u>=42128&&u<=42191,"Hangul Jamo Extended-A":u=>u>=43360&&u<=43391,"Hangul Syllables":u=>u>=44032&&u<=55215,"Hangul Jamo Extended-B":u=>u>=55216&&u<=55295,"Private Use Area":u=>u>=57344&&u<=63743,"CJK Compatibility Ideographs":u=>u>=63744&&u<=64255,"Arabic Presentation Forms-A":u=>u>=64336&&u<=65023,"Vertical Forms":u=>u>=65040&&u<=65055,"CJK Compatibility Forms":u=>u>=65072&&u<=65103,"Small Form Variants":u=>u>=65104&&u<=65135,"Arabic Presentation Forms-B":u=>u>=65136&&u<=65279,"Halfwidth and Fullwidth Forms":u=>u>=65280&&u<=65519,Osage:u=>u>=66736&&u<=66815,"CJK Unified Ideographs Extension B":u=>u>=131072&&u<=173791};function _p(u){for(const n of u)if(yp(n.charCodeAt(0)))return!0;return!1}function Jv(u){for(const n of u)if(!Qv(n.charCodeAt(0)))return!1;return!0}function Qv(u){return!(tr.Arabic(u)||tr["Arabic Supplement"](u)||tr["Arabic Extended-A"](u)||tr["Arabic Presentation Forms-A"](u)||tr["Arabic Presentation Forms-B"](u))}function yp(u){return!(u!==746&&u!==747&&(u<4352||!(tr["Bopomofo Extended"](u)||tr.Bopomofo(u)||tr["CJK Compatibility Forms"](u)&&!(u>=65097&&u<=65103)||tr["CJK Compatibility Ideographs"](u)||tr["CJK Compatibility"](u)||tr["CJK Radicals Supplement"](u)||tr["CJK Strokes"](u)||!(!tr["CJK Symbols and Punctuation"](u)||u>=12296&&u<=12305||u>=12308&&u<=12319||u===12336)||tr["CJK Unified Ideographs Extension A"](u)||tr["CJK Unified Ideographs"](u)||tr["Enclosed CJK Letters and Months"](u)||tr["Hangul Compatibility Jamo"](u)||tr["Hangul Jamo Extended-A"](u)||tr["Hangul Jamo Extended-B"](u)||tr["Hangul Jamo"](u)||tr["Hangul Syllables"](u)||tr.Hiragana(u)||tr["Ideographic Description Characters"](u)||tr.Kanbun(u)||tr["Kangxi Radicals"](u)||tr["Katakana Phonetic Extensions"](u)||tr.Katakana(u)&&u!==12540||!(!tr["Halfwidth and Fullwidth Forms"](u)||u===65288||u===65289||u===65293||u>=65306&&u<=65310||u===65339||u===65341||u===65343||u>=65371&&u<=65503||u===65507||u>=65512&&u<=65519)||!(!tr["Small Form Variants"](u)||u>=65112&&u<=65118||u>=65123&&u<=65126)||tr["Unified Canadian Aboriginal Syllabics"](u)||tr["Unified Canadian Aboriginal Syllabics Extended"](u)||tr["Vertical Forms"](u)||tr["Yijing Hexagram Symbols"](u)||tr["Yi Syllables"](u)||tr["Yi Radicals"](u))))}function vp(u){return!(yp(u)||function(n){return!!(tr["Latin-1 Supplement"](n)&&(n===167||n===169||n===174||n===177||n===188||n===189||n===190||n===215||n===247)||tr["General Punctuation"](n)&&(n===8214||n===8224||n===8225||n===8240||n===8241||n===8251||n===8252||n===8258||n===8263||n===8264||n===8265||n===8273)||tr["Letterlike Symbols"](n)||tr["Number Forms"](n)||tr["Miscellaneous Technical"](n)&&(n>=8960&&n<=8967||n>=8972&&n<=8991||n>=8996&&n<=9e3||n===9003||n>=9085&&n<=9114||n>=9150&&n<=9165||n===9167||n>=9169&&n<=9179||n>=9186&&n<=9215)||tr["Control Pictures"](n)&&n!==9251||tr["Optical Character Recognition"](n)||tr["Enclosed Alphanumerics"](n)||tr["Geometric Shapes"](n)||tr["Miscellaneous Symbols"](n)&&!(n>=9754&&n<=9759)||tr["Miscellaneous Symbols and Arrows"](n)&&(n>=11026&&n<=11055||n>=11088&&n<=11097||n>=11192&&n<=11243)||tr["CJK Symbols and Punctuation"](n)||tr.Katakana(n)||tr["Private Use Area"](n)||tr["CJK Compatibility Forms"](n)||tr["Small Form Variants"](n)||tr["Halfwidth and Fullwidth Forms"](n)||n===8734||n===8756||n===8757||n>=9984&&n<=10087||n>=10102&&n<=10131||n===65532||n===65533)}(u))}function bp(u){return u>=1424&&u<=2303||tr["Arabic Presentation Forms-A"](u)||tr["Arabic Presentation Forms-B"](u)}function e0(u,n){return!(!n&&bp(u)||u>=2304&&u<=3583||u>=3840&&u<=4255||tr.Khmer(u))}function dw(u){for(const n of u)if(bp(n.charCodeAt(0)))return!0;return!1}const Xa="deferred",$g="loading",Ug="loaded";let xp=null,Ms="unavailable",Ra=null;const jg=function(u){u&&typeof u=="string"&&u.indexOf("NetworkError")>-1&&(Ms="error"),xp&&xp(u)};function rd(){wp.fire(new lu("pluginStateChange",{pluginStatus:Ms,pluginURL:Ra}))}const wp=new $c,Hg=function(){return Ms},t0=function(){if(Ms!==Xa||!Ra)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");Ms=$g,rd(),Ra&&Zu({url:Ra},u=>{u?jg(u):(Ms=Ug,rd())})},Is={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>Ms===Ug||Is.applyArabicShaping!=null,isLoading:()=>Ms===$g,setState(u){Ms=u.pluginStatus,Ra=u.pluginURL},isParsed:()=>Is.applyArabicShaping!=null&&Is.processBidirectionalText!=null&&Is.processStyledBidirectionalText!=null,getPluginURL:()=>Ra};class ji{constructor(n,s){this.zoom=n,s?(this.now=s.now,this.fadeDuration=s.fadeDuration,this.transition=s.transition,this.pitch=s.pitch,this.brightness=s.brightness):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0,this.brightness=0)}isSupportedScript(n){return function(s,c){for(const g of s)if(!e0(g.charCodeAt(0),c))return!1;return!0}(n,Is.isLoaded())}}class Pf{constructor(n,s,c,g){this.property=n,this.value=s,this.expression=function(f,_,T,A){if(dp(f))return new pp(f,_);if(Vg(f)||Array.isArray(f)&&f.length>0){const D=Zv(f,_,T,A);if(D.result==="error")throw new Error(D.value.map(w=>`${w.key}: ${w.message}`).join(", "));return D.value}{let D=f;return typeof f=="string"&&_.type==="color"&&(D=Jr.parse(f)),{kind:"constant",configDependencies:new Set,evaluate:()=>D}}}(s===void 0?n.specification.default:s,n.specification,c,g)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(n,s,c){return this.property.possiblyEvaluate(this,n,s,c)}}class id{constructor(n,s,c){this.property=n,this.value=new Pf(n,void 0,s,c)}transitioned(n,s){return new n0(this.property,this.value,s,er({},n.transition,this.transition),n.now)}untransitioned(){return new n0(this.property,this.value,null,{},0)}}class lc{constructor(n,s,c){this._properties=n,this._values=Object.create(n.defaultTransitionablePropertyValues),this._scope=s,this._options=c,this.configDependencies=new Set}getValue(n){return Ye(this._values[n].value.value)}setValue(n,s){this._values.hasOwnProperty(n)||(this._values[n]=new id(this._values[n].property,this._scope,this._options)),this._values[n].value=new Pf(this._values[n].property,s===null?void 0:Ye(s),this._scope,this._options),this._values[n].value.expression.configDependencies&&(this.configDependencies=new Set([...this.configDependencies,...this._values[n].value.expression.configDependencies]))}setTransitionOrValue(n,s){s&&(this._options=s);const c=this._properties.properties;if(n)for(const g in n){const f=n[g];if(zt(g,"-transition")){const _=g.slice(0,-11);c[_]&&this.setTransition(_,f)}else c.hasOwnProperty(g)&&this.setValue(g,f)}}getTransition(n){return Ye(this._values[n].transition)}setTransition(n,s){this._values.hasOwnProperty(n)||(this._values[n]=new id(this._values[n].property)),this._values[n].transition=Ye(s)||void 0}serialize(){const n={};for(const s of Object.keys(this._values)){const c=this.getValue(s);c!==void 0&&(n[s]=c);const g=this.getTransition(s);g!==void 0&&(n[`${s}-transition`]=g)}return n}transitioned(n,s){const c=new r0(this._properties);for(const g of Object.keys(this._values))c._values[g]=this._values[g].transitioned(n,s._values[g]);return c}untransitioned(){const n=new r0(this._properties);for(const s of Object.keys(this._values))n._values[s]=this._values[s].untransitioned();return n}}class n0{constructor(n,s,c,g,f){const _=g.delay||0,T=g.duration||0;f=f||0,this.property=n,this.value=s,this.begin=f+_,this.end=this.begin+T,n.specification.transition&&(g.delay||g.duration)&&(this.prior=c)}possiblyEvaluate(n,s,c){const g=n.now||0,f=this.value.possiblyEvaluate(n,s,c),_=this.prior;if(_){if(g>this.end)return this.prior=null,f;if(this.value.isDataDriven())return this.prior=null,f;if(g<this.begin)return _.possiblyEvaluate(n,s,c);{const T=(g-this.begin)/(this.end-this.begin);return this.property.interpolate(_.possiblyEvaluate(n,s,c),f,on(T))}}return f}}class r0{constructor(n){this._properties=n,this._values=Object.create(n.defaultTransitioningPropertyValues)}possiblyEvaluate(n,s,c){const g=new sd(this._properties);for(const f of Object.keys(this._values))g._values[f]=this._values[f].possiblyEvaluate(n,s,c);return g}hasTransition(){for(const n of Object.keys(this._values))if(this._values[n].prior)return!0;return!1}}class fw{constructor(n,s,c){this._properties=n,this._values=Object.create(n.defaultPropertyValues),this._scope=s,this._options=c,this.configDependencies=new Set}getValue(n){return Ye(this._values[n].value)}setValue(n,s){this._values[n]=new Pf(this._values[n].property,s===null?void 0:Ye(s),this._scope,this._options),this._values[n].expression.configDependencies&&(this.configDependencies=new Set([...this.configDependencies,...this._values[n].expression.configDependencies]))}serialize(){const n={};for(const s of Object.keys(this._values)){const c=this.getValue(s);c!==void 0&&(n[s]=c)}return n}possiblyEvaluate(n,s,c){const g=new sd(this._properties);for(const f of Object.keys(this._values))g._values[f]=this._values[f].possiblyEvaluate(n,s,c);return g}}class od{constructor(n,s,c){this.property=n,this.value=s,this.parameters=c}isConstant(){return this.value.kind==="constant"}constantOr(n){return this.value.kind==="constant"?this.value.value:n}evaluate(n,s,c,g){return this.property.evaluate(this.value,this.parameters,n,s,c,g)}}class sd{constructor(n){this._properties=n,this._values=Object.create(n.defaultPossiblyEvaluatedValues)}get(n){return this._values[n]}}class _n{constructor(n){this.specification=n}possiblyEvaluate(n,s){return n.expression.evaluate(s)}interpolate(n,s,c){const g=Yr[this.specification.type];return g?g(n,s,c):n}}class Fn{constructor(n,s){this.specification=n,this.overrides=s}possiblyEvaluate(n,s,c,g){return new od(this,n.expression.kind==="constant"||n.expression.kind==="camera"?{kind:"constant",value:n.expression.evaluate(s,null,{},c,g)}:n.expression,s)}interpolate(n,s,c){if(n.value.kind!=="constant"||s.value.kind!=="constant")return n;if(n.value.value===void 0||s.value.value===void 0)return new od(this,{kind:"constant",value:void 0},n.parameters);const g=Yr[this.specification.type];return g?new od(this,{kind:"constant",value:g(n.value.value,s.value.value,c)},n.parameters):n}evaluate(n,s,c,g,f,_){return n.kind==="constant"?n.value:n.evaluate(s,c,g,f,_)}}class ad{constructor(n){this.specification=n}possiblyEvaluate(n,s,c,g){return!!n.expression.evaluate(s,null,{},c,g)}interpolate(){return!1}}class Zi{constructor(n){this.properties=n,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const s=new ji(0,{});for(const c in n){const g=n[c];g.specification.overridable&&this.overridableProperties.push(c);const f=this.defaultPropertyValues[c]=new Pf(g,void 0),_=this.defaultTransitionablePropertyValues[c]=new id(g);this.defaultTransitioningPropertyValues[c]=_.untransitioned(),this.defaultPossiblyEvaluatedValues[c]=f.possiblyEvaluate(s)}}}Gn(Fn,"DataDrivenProperty"),Gn(_n,"DataConstantProperty"),Gn(ad,"ColorRampProperty");var Ot=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"fragment":{"type":"boolean"},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360},"pitch":{"type":"number","default":0},"light":{"type":"light"},"lights":{"required":false,"type":"array","value":"light-3d"},"terrain":{"type":"terrain","optional":true},"fog":{"type":"fog"},"snow":{"type":"snow","experimental":true},"rain":{"type":"rain","experimental":true},"camera":{"type":"camera"},"color-theme":{"type":"colorTheme"},"indoor":{"type":"indoor","experimental":true},"imports":{"type":"array","value":"import"},"schema":{"type":"schema"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string","default":"mapbox://fonts/mapbox/{fontstack}/{range}.pbf"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"},"models":{"type":"models"},"featuresets":{"experimental":true,"type":"featuresets"}},"featuresets":{"experimental":true,"*":{"type":"featureset"}},"featureset":{"experimental":true,"metadata":{"type":"*"},"selectors":{"type":"array","value":"selector"}},"selector":{"experimental":true,"layer":{"type":"string","required":true},"properties":{"type":"selectorProperty","required":false},"featureNamespace":{"type":"string","required":false}},"selectorProperty":{"experimental":true,"*":{"type":"*"}},"model":{"type":"string","required":true},"import":{"id":{"type":"string","required":true},"url":{"type":"string","required":true},"config":{"type":"config"},"data":{"type":"$root"},"color-theme":{"type":"colorTheme","optional":true}},"config":{"*":{"type":"*"}},"schema":{"*":{"type":"option"}},"option":{"default":{"type":"*","property-type":"data-constant","expression":{},"required":true},"type":{"type":"enum","values":{"string":1,"number":1,"boolean":1,"color":1}},"array":{"type":"boolean"},"minValue":{"type":"number"},"maxValue":{"type":"number"},"stepValue":{"type":"number"},"values":{"type":"array","value":"*"},"metadata":{"type":"*"}},"models":{"*":{"type":"model"}},"light-3d":{"id":{"type":"string","required":true},"properties":{"type":"properties"},"type":{"type":"enum","values":{"ambient":{},"directional":{},"flat":{}}}},"properties":["properties_light_directional","properties_light_ambient","properties_light_flat"],"properties_light_directional":{"direction":{"type":"array","default":[210,30],"minimum":[0,0],"maximum":[360,90],"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"cast-shadows":{"type":"boolean","default":false,"property-type":"data-constant"},"shadow-quality":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"expression":{"parameters":["zoom"]},"experimental":true},"shadow-intensity":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_ambient":{"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_flat":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"property-type":"data-constant","expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_raster_array","source_geojson","source_video","source_image","source_model"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":1,"mapbox":1},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_array":{"experimental":true,"type":{"required":true,"type":"enum","values":{"raster-array":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"rasterLayers":{"type":"*"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":1}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"minzoom":{"type":"number","default":0},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"},"dynamic":{"type":"boolean","default":false}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":1}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":1}},"url":{"required":false,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_model":{"type":{"required":true,"type":"enum","values":{"model":1,"batched-model":1}},"maxzoom":{"type":"number","default":18},"minzoom":{"type":"number","default":0},"tiles":{"type":"array","value":"string"}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"raster-particle":{"experimental":true},"hillshade":{},"model":{"experimental":true},"background":{},"sky":{},"slot":{},"clip":{}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"slot":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_clip","layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_raster-particle","layout_hillshade","layout_background","layout_sky","layout_model"],"layout_background":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_model":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"model-id":{"type":"string","default":"","property-type":"data-driven","expression":{"parameters":["zoom","feature"]}}},"layout_clip":{"clip-layer-types":{"type":"array","value":"enum","values":{"model":1,"symbol":1},"default":[],"expression":{},"property-type":"data-constant"},"clip-layer-scope":{"type":"array","value":"string","default":[],"expression":{},"property-type":"data-constant"}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"fill-elevation-reference":{"type":"enum","values":{"none":1,"hd-road-base":1,"hd-road-markup":1},"default":"none","experimental":true,"private":true,"expression":{},"property-type":"data-constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"fill-extrusion-edge-radius":{"type":"number","experimental":true,"default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":1,"round":1,"square":1},"default":"butt","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":1,"round":1,"miter":1,"none":1},"default":"miter","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-z-offset":{"type":"number","experimental":true,"default":0,"expression":{"parameters":["zoom","feature","line-progress"]},"property-type":"data-driven"},"line-elevation-reference":{"type":"enum","values":{"none":1,"sea":1,"ground":1,"hd-road-markup":1},"default":"none","experimental":true,"expression":{},"property-type":"data-constant"},"line-cross-slope":{"type":"number","experimental":true,"expression":{},"property-type":"constant"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"line-width-unit":{"type":"enum","values":{"pixels":1,"meters":1},"default":"pixels","experimental":true,"private":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":1,"line":1,"line-center":1},"default":"point","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":1,"viewport-y":1,"source":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-z-elevate":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-elevation-reference":{"type":"enum","values":{"sea":1,"ground":1,"hd-road-markup":1},"default":"ground","experimental":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-size-scale-range":{"type":"array","value":"number","length":2,"default":[0.8,2],"minimum":0.1,"maximum":10,"experimental":true,"private":true,"expression":{},"property-type":"data-constant"},"icon-text-fit":{"type":"enum","values":{"none":1,"width":1,"height":1,"both":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size-scale-range":{"type":"array","value":"number","length":2,"default":[0.8,2],"minimum":0.1,"maximum":10,"experimental":true,"private":true,"expression":{},"property-type":"data-constant"},"text-max-width":{"type":"number","default":10,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":1,"left":1,"center":1,"right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","default":0,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":1,"vertical":1},"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":1,"uppercase":1,"lowercase":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","length":2,"default":[0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_raster-particle":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_hillshade":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_raster":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_raster-particle":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_clip":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_model":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":1,"!=":1,">":1,">=":1,"<":1,"<=":1,"in":1,"!in":1,"all":1,"any":1,"none":1,"has":1,"!has":1}},"geometry_type":{"type":"enum","values":{"Point":1,"LineString":1,"Polygon":1}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":1,"exponential":1,"interval":1,"categorical":1},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":1,"lab":1,"hcl":1},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"high-color":{"type":"color","property-type":"data-constant","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"space-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"star-intensity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vertical-range":{"type":"array","default":[0,0],"minimum":0,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}}},"snow":{"density":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],11,0,13,0.85],"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"opacity":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],11,0,13,0.3],"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette-color":{"type":"color","property-type":"data-constant","default":"#ffffff","experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"center-thinning":{"type":"number","property-type":"data-constant","default":0.4,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"direction":{"type":"array","default":[0,50],"minimum":0,"maximum":360,"length":2,"value":"number","property-type":"data-constant","transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"flake-size":{"type":"number","property-type":"data-constant","default":0.71,"minimum":0,"maximum":5,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true}},"rain":{"density":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],11,0,13,0.5],"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["measure-light","brightness"],0,"#03113d",0.3,"#a8adbc"],"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"opacity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["measure-light","brightness"],0,0.88,1,0.7],"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],11,0,13,1],"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["measure-light","brightness"],0,"#001736",0.3,"#464646"],"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"center-thinning":{"type":"number","property-type":"data-constant","default":0.57,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"direction":{"type":"array","default":[0,80],"minimum":0,"maximum":360,"length":2,"value":"number","property-type":"data-constant","transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"droplet-size":{"type":"array","default":[2.6,18.2],"minimum":0,"maximum":50,"length":2,"value":"number","property-type":"data-constant","transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"distortion-strength":{"type":"number","property-type":"data-constant","default":0.7,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true}},"camera":{"camera-projection":{"type":"enum","values":{"perspective":1,"orthographic":1},"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"default":"perspective","property-type":"data-constant"}},"colorTheme":{"data":{"type":"string","property-type":"data-constant","expression":{}}},"indoor":{"floorplanFeaturesetId":{"type":"string","experimental":true,"property-type":"data-constant","expression":{}},"buildingFeaturesetId":{"type":"string","experimental":true,"property-type":"data-constant","expression":{}}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"property-type":"data-constant","expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":1,"equalEarth":1,"equirectangular":1,"lambertConformalConic":1,"mercator":1,"naturalEarth":1,"winkelTripel":1,"globe":1},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-180,-90],"maximum":[180,90]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-90,-90],"maximum":[90,90]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_raster-particle","paint_hillshade","paint_background","paint_sky","paint_model"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"fill-z-offset":{"type":"number","default":0,"minimum":0,"transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-height-alignment":{"type":"enum","experimental":true,"values":{"terrain":1,"flat":1},"default":"flat","property-type":"data-constant"},"fill-extrusion-base-alignment":{"type":"enum","experimental":true,"values":{"terrain":1,"flat":1},"default":"terrain","property-type":"data-constant"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-ambient-occlusion-intensity":{"property-type":"data-constant","type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"property-type":"data-constant","type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-wall-radius":{"property-type":"data-constant","type":"number","experimental":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-radius":{"property-type":"data-constant","type":"number","experimental":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-attenuation":{"property-type":"data-constant","type":"number","experimental":true,"default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-flood-light-color":{"property-type":"data-constant","type":"color","experimental":true,"default":"#ffffff","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-intensity":{"property-type":"data-constant","type":"number","experimental":true,"default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-wall-radius":{"property-type":"data-driven","type":"number","experimental":true,"default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-radius":{"property-type":"data-driven","type":"number","experimental":true,"default":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-attenuation":{"property-type":"data-constant","type":"number","experimental":true,"default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-vertical-scale":{"property-type":"data-constant","type":"number","experimental":true,"default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-rounded-roof":{"property-type":"data-constant","type":"boolean","default":true,"experimental":true,"expression":{"parameters":["zoom"]}},"fill-extrusion-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"fill-extrusion-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"fill-extrusion-line-width":{"type":"number","default":0,"minimum":0,"transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-extrusion-cast-shadows":{"type":"boolean","default":true,"property-type":"data-constant"}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light","line-progress"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-gradient":{"type":"color","expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"property-type":"constant"},"line-trim-fade-range":{"type":"array","value":"number","experimental":true,"length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"line-trim-color":{"type":"color","experimental":true,"default":"transparent","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"line-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"line-border-width":{"type":"number","private":true,"default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-border-color":{"type":"color","private":true,"default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-occlusion-opacity":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"property-type":"data-constant"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-occlusion-opacity":{"type":"number","minimum":0,"maximum":1,"default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"text-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-image-cross-fade":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"transition":true},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-occlusion-opacity":{"type":"number","minimum":0,"maximum":1,"default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-color-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"expression":{},"property-type":"data-constant"},"icon-color-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"expression":{},"property-type":"data-constant"},"icon-color-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"icon-color-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"symbol-z-offset":{"type":"number","default":0,"minimum":0,"transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-color":{"type":"color","expression":{"interpolated":true,"parameters":["raster-value"]},"property-type":"color-ramp"},"raster-color-mix":{"type":"array","default":[0.2126,0.7152,0.0722,0],"length":4,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-color-range":{"type":"array","length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":1,"nearest":1},"default":"linear","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"raster-array-band":{"type":"string","required":false,"experimental":true,"property-type":"data-constant"},"raster-elevation":{"type":"number","default":0,"minimum":0,"transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster-particle":{"raster-particle-array-band":{"type":"string","required":false,"property-type":"data-constant"},"raster-particle-count":{"type":"number","default":512,"minimum":1,"property-type":"data-constant"},"raster-particle-color":{"type":"color","expression":{"interpolated":true,"parameters":["raster-particle-speed"]},"property-type":"color-ramp"},"raster-particle-max-speed":{"type":"number","default":1,"minimum":1,"property-type":"data-constant"},"raster-particle-speed-factor":{"type":"number","default":0.2,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-particle-fade-opacity-factor":{"type":"number","default":0.98,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-particle-reset-rate-factor":{"type":"number","default":0.8,"minimum":0,"maximum":1,"property-type":"data-constant"},"raster-particle-elevation":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_background":{"background-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":[]},"experimental":true,"property-type":"data-constant"},"background-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":1,"atmosphere":1},"default":"atmosphere","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","default":10,"minimum":0,"maximum":100,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","value":"number","default":[0,0],"length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","default":90,"minimum":0,"maximum":180,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_model":{"model-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"property-type":"data-driven"},"model-rotation":{"type":"array","value":"number","length":3,"default":[0,0,0],"period":360,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-scale":{"type":"array","value":"number","length":3,"default":[1,1,1],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-translation":{"type":"array","value":"number","length":3,"default":[0,0,0],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-color":{"type":"color","default":"#ffffff","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light","zoom"]},"transition":true},"model-color-mix-intensity":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-type":{"type":"enum","values":{"common-3d":1,"location-indicator":1},"default":"common-3d","property-type":"data-constant"},"model-cast-shadows":{"type":"boolean","default":true,"property-type":"data-constant"},"model-receive-shadows":{"type":"boolean","default":true,"property-type":"data-constant"},"model-ambient-occlusion-intensity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant","transition":true},"model-emissive-strength":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":5,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-roughness":{"type":"number","default":1,"minimum":0,"maximum":1,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state"]},"transition":true},"model-height-based-emissive-strength-multiplier":{"type":"array","default":[1,1,1,1,0],"length":5,"value":"number","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"model-front-cutoff":{"type":"array","private":true,"value":"number","property-type":"data-constant","expression":{"interpolated":true,"parameters":["zoom"]},"length":3,"default":[0,0,1],"minimum":[0,0,0],"maximum":[1,1,1]}},"transition":{"duration":{"type":"number","default":300,"minimum":0},"delay":{"type":"number","default":0,"minimum":0}},"property-type":{"data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"string"}}}');function i0(u){return u instanceof Number||u instanceof String||u instanceof Boolean?u.valueOf():u}function Sp(u){if(Array.isArray(u))return u.map(Sp);if(u instanceof Object&&!(u instanceof Number||u instanceof String||u instanceof Boolean)){const n={};for(const s in u)n[s]=Sp(u[s]);return n}return i0(u)}function Gg(u){if(u===!0||u===!1)return!0;if(!Array.isArray(u)||u.length===0)return!1;switch(u[0]){case"has":return u.length>=2&&u[1]!=="$id"&&u[1]!=="$type";case"in":return u.length>=3&&(typeof u[1]!="string"||Array.isArray(u[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return u.length!==3||Array.isArray(u[1])||Array.isArray(u[2]);case"any":case"all":for(const n of u.slice(1))if(!Gg(n)&&typeof n!="boolean")return!1;return!0;default:return!0}}function o0(u,n="",s=null,c="fill"){if(u==null)return{filter:()=>!0,needGeometry:!1,needFeature:!1};Gg(u)||(u=Rf(u));const g=u;let f=!0;try{f=function(w){if(!ld(w))return w;let k=Sp(w);return a0(k),k=s0(k),k}(g)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.
This is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md
and paste the contents of this message in the report.
Thank you!
Filter Expression:
${JSON.stringify(g,null,2)}
        `)}let _=null,T=null;if(c!=="background"&&c!=="sky"&&c!=="slot"){T=Ot[`filter_${c}`];const w=Af(f,T,n,s);if(w.result==="error")throw new Error(w.value.map(k=>`${k.key}: ${k.message}`).join(", "));_=(k,O,I)=>w.value.evaluate(k,O,{},I)}let A=null,D=null;if(f!==g){const w=Af(g,T,n,s);if(w.result==="error")throw new Error(w.value.map(k=>`${k.key}: ${k.message}`).join(", "));A=(k,O,I,R,B)=>w.value.evaluate(k,O,{},I,void 0,void 0,R,B),D=!Xc(w.value.expression)}return{filter:_,dynamicFilter:A||void 0,needGeometry:Wg(f),needFeature:!!D}}function s0(u){if(!Array.isArray(u))return u;const n=function(s){if(hw.has(s[0])){for(let c=1;c<s.length;c++)if(ld(s[c]))return!0}return s}(u);return n===!0?n:n.map(s=>s0(s))}function a0(u){let n=!1;const s=[];if(u[0]==="case"){for(let c=1;c<u.length-1;c+=2)n=n||ld(u[c]),s.push(u[c+1]);s.push(u[u.length-1])}else if(u[0]==="match"){n=n||ld(u[1]);for(let c=2;c<u.length-1;c+=2)s.push(u[c+1]);s.push(u[u.length-1])}else if(u[0]==="step"){n=n||ld(u[1]);for(let c=1;c<u.length-1;c+=2)s.push(u[c+1])}n&&(u.length=0,u.push("any",...s));for(let c=1;c<u.length;c++)a0(u[c])}function ld(u){if(!Array.isArray(u))return!1;if((n=u[0])==="pitch"||n==="distance-from-center")return!0;var n;for(let s=1;s<u.length;s++)if(ld(u[s]))return!0;return!1}const hw=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function ud(u,n){return u<n?-1:u>n?1:0}function Wg(u){if(!Array.isArray(u))return!1;if(u[0]==="within"||u[0]==="distance")return!0;for(let n=1;n<u.length;n++)if(Wg(u[n]))return!0;return!1}function Rf(u){if(!u)return!0;const n=u[0];return u.length<=1?n!=="any":n==="=="?cd(u[1],u[2],"=="):n==="!="?Oa(cd(u[1],u[2],"==")):n==="<"||n===">"||n==="<="||n===">="?cd(u[1],u[2],n):n==="any"?(s=u.slice(1),["any"].concat(s.map(Rf))):n==="all"?["all"].concat(u.slice(1).map(Rf)):n==="none"?["all"].concat(u.slice(1).map(Rf).map(Oa)):n==="in"?l0(u[1],u.slice(2)):n==="!in"?Oa(l0(u[1],u.slice(2))):n==="has"?u0(u[1]):n!=="!has"||Oa(u0(u[1]));var s}function cd(u,n,s){switch(u){case"$type":return[`filter-type-${s}`,n];case"$id":return[`filter-id-${s}`,n];default:return[`filter-${s}`,u,n]}}function l0(u,n){if(n.length===0)return!1;switch(u){case"$type":return["filter-type-in",["literal",n]];case"$id":return["filter-id-in",["literal",n]];default:return n.length>200&&!n.some(s=>typeof s!=typeof n[0])?["filter-in-large",u,["literal",n.sort(ud)]]:["filter-in-small",u,["literal",n]]}}function u0(u){switch(u){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",u]}}function Oa(u){return["!",u]}const Of="";function ds(u,n){return n?`${u}${Of}${n}`:u}const c0="-transition",pw=new Set(["fill","line","background","hillshade","raster"]);class fs extends $c{constructor(n,s,c,g,f){if(super(),this.id=n.id,this.fqid=ds(this.id,c),this.type=n.type,this.scope=c,this.lut=g,this.options=f,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,this.configDependencies=new Set,n.type!=="custom"){if(this.metadata=n.metadata,this.minzoom=n.minzoom,this.maxzoom=n.maxzoom,n.type&&n.type!=="background"&&n.type!=="sky"&&n.type!=="slot"){this.source=n.source,this.sourceLayer=n["source-layer"],this.filter=n.filter;const _=Af(this.filter,Ot[`filter_${n.type}`]);_.result!=="error"&&(this.configDependencies=new Set([...this.configDependencies,..._.value.configDependencies]))}if(n.slot&&(this.slot=n.slot),s.layout&&(this._unevaluatedLayout=new fw(s.layout,this.scope,f),this.configDependencies=new Set([...this.configDependencies,...this._unevaluatedLayout.configDependencies])),s.paint){this._transitionablePaint=new lc(s.paint,this.scope,f);for(const _ in n.paint)this.setPaintProperty(_,n.paint[_]);for(const _ in n.layout)this.setLayoutProperty(_,n.layout[_]);this.configDependencies=new Set([...this.configDependencies,...this._transitionablePaint.configDependencies]),this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new sd(s.paint)}}}onAdd(n){}onRemove(n){}isDraped(n){return!this.is3D()&&pw.has(this.type)}getLayoutProperty(n){return n==="visibility"?this.visibility:this._unevaluatedLayout.getValue(n)}setLayoutProperty(n,s){if(this.type==="custom"&&n==="visibility")return void(this.visibility=s);const c=this._unevaluatedLayout;c._properties.properties[n]&&(c.setValue(n,s),this.configDependencies=new Set([...this.configDependencies,...c.configDependencies]),n==="visibility"&&this.possiblyEvaluateVisibility())}possiblyEvaluateVisibility(){this._unevaluatedLayout._values.visibility&&(this.visibility=this._unevaluatedLayout._values.visibility.possiblyEvaluate({zoom:0}))}getPaintProperty(n){return zt(n,c0)?this._transitionablePaint.getTransition(n.slice(0,-11)):this._transitionablePaint.getValue(n)}setPaintProperty(n,s){const c=this._transitionablePaint,g=c._properties.properties;if(zt(n,c0)){const k=n.slice(0,-11);return g[k]&&c.setTransition(k,s||void 0),!1}if(!g[n])return!1;const f=c._values[n],_=f.value.isDataDriven(),T=f.value;c.setValue(n,s),this.configDependencies=new Set([...this.configDependencies,...c.configDependencies]),this._handleSpecialPaintPropertyUpdate(n);const A=c._values[n].value,D=A.isDataDriven(),w=zt(n,"pattern")||n==="line-dasharray";return D||_||w||this._handleOverridablePaintPropertyUpdate(n,T,A)}_handleSpecialPaintPropertyUpdate(n){}getProgramIds(){return null}getDefaultProgramParams(n,s,c){return null}_handleOverridablePaintPropertyUpdate(n,s,c){return!1}isHidden(n){return!!(this.minzoom&&n<this.minzoom)||!!(this.maxzoom&&n>=this.maxzoom)||this.visibility==="none"}updateTransitions(n){this._transitioningPaint=this._transitionablePaint.transitioned(n,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(n,s){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(n,void 0,s)),this.paint=this._transitioningPaint.possiblyEvaluate(n,void 0,s)}serialize(){return Ft({id:this.id,type:this.type,slot:this.slot,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()},(n,s)=>!(n===void 0||s==="layout"&&!Object.keys(n).length||s==="paint"&&!Object.keys(n).length))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}hasShadowPass(){return!1}canCastShadows(){return!1}hasLightBeamPass(){return!1}cutoffRange(){return 0}tileCoverLift(){return 0}resize(){}isStateDependent(){for(const n in this.paint._values){const s=this.paint.get(n);if(s instanceof od&&td(s.property.specification)&&(s.value.kind==="source"||s.value.kind==="composite")&&s.value.isStateDependent)return!0}return!1}compileFilter(n){this._filterCompiled||(this._featureFilter=o0(this.filter,this.scope,n),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}getLayerRenderingStats(){return this._stats}resetLayerRenderingStats(n){this._stats&&(n.renderPass==="shadow"?this._stats.numRenderedVerticesInShadowPass=0:this._stats.numRenderedVerticesInTransparentPass=0)}queryRadius(n){}queryIntersectsFeature(n,s,c,g,f,_,T,A,D){}}const mw={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Lf{constructor(n,s){this._structArray=n,this._pos1=s*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Fi{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(n,s){return n._trim(),s&&(n.isTransferred=!0,s.add(n.arrayBuffer)),{length:n.length,arrayBuffer:n.arrayBuffer}}static deserialize(n){const s=Object.create(this.prototype);return s.arrayBuffer=n.arrayBuffer,s.length=n.length,s.capacity=n.arrayBuffer.byteLength/s.bytesPerElement,s._refreshViews(),s}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(n){this.reserve(n),this.length=n}reserve(n){if(n>this.capacity){this.capacity=Math.max(n,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const s=this.uint8;this._refreshViews(),s&&this.uint8.set(s)}}_refreshViews(){throw new Error("StructArray#_refreshViews() must be implemented by each concrete StructArray layout")}emplace(...n){throw new Error("StructArray#emplace() must be implemented by each concrete StructArray layout")}emplaceBack(...n){throw new Error("StructArray#emplaceBack() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function ti(u,n=1){let s=0,c=0;return{members:u.map(g=>{const f=mw[g.type].BYTES_PER_ELEMENT,_=s=Df(s,Math.max(n,f)),T=g.components||1;return c=Math.max(c,f),s+=f*T,{name:g.name,type:g.type,components:T,offset:_}}),size:Df(s,Math.max(c,n)),alignment:n}}function Df(u,n){return Math.ceil(u/n)*n}class Il extends Fi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,s){const c=this.length;return this.resize(c+1),this.emplace(c,n,s)}emplace(n,s,c){const g=2*n;return this.int16[g+0]=s,this.int16[g+1]=c,n}}Il.prototype.bytesPerElement=4,Gn(Il,"StructArrayLayout2i4");class dd extends Fi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,s,c){const g=this.length;return this.resize(g+1),this.emplace(g,n,s,c)}emplace(n,s,c,g){const f=3*n;return this.int16[f+0]=s,this.int16[f+1]=c,this.int16[f+2]=g,n}}dd.prototype.bytesPerElement=6,Gn(dd,"StructArrayLayout3i6");class fd extends Fi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,s,c,g){const f=this.length;return this.resize(f+1),this.emplace(f,n,s,c,g)}emplace(n,s,c,g,f){const _=4*n;return this.int16[_+0]=s,this.int16[_+1]=c,this.int16[_+2]=g,this.int16[_+3]=f,n}}fd.prototype.bytesPerElement=8,Gn(fd,"StructArrayLayout4i8");class ha extends Fi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,s,c,g,f){const _=this.length;return this.resize(_+1),this.emplace(_,n,s,c,g,f)}emplace(n,s,c,g,f,_){const T=5*n;return this.int16[T+0]=s,this.int16[T+1]=c,this.int16[T+2]=g,this.int16[T+3]=f,this.int16[T+4]=_,n}}ha.prototype.bytesPerElement=10,Gn(ha,"StructArrayLayout5i10");class qg extends Fi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,s,c,g,f,_,T){const A=this.length;return this.resize(A+1),this.emplace(A,n,s,c,g,f,_,T)}emplace(n,s,c,g,f,_,T,A){const D=6*n,w=12*n,k=3*n;return this.int16[D+0]=s,this.int16[D+1]=c,this.uint8[w+4]=g,this.uint8[w+5]=f,this.uint8[w+6]=_,this.uint8[w+7]=T,this.float32[k+2]=A,n}}qg.prototype.bytesPerElement=12,Gn(qg,"StructArrayLayout2i4ub1f12");class Al extends Fi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,s,c,g){const f=this.length;return this.resize(f+1),this.emplace(f,n,s,c,g)}emplace(n,s,c,g,f){const _=4*n;return this.float32[_+0]=s,this.float32[_+1]=c,this.float32[_+2]=g,this.float32[_+3]=f,n}}Al.prototype.bytesPerElement=16,Gn(Al,"StructArrayLayout4f16");class gu extends Fi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,s,c){const g=this.length;return this.resize(g+1),this.emplace(g,n,s,c)}emplace(n,s,c,g){const f=3*n;return this.float32[f+0]=s,this.float32[f+1]=c,this.float32[f+2]=g,n}}gu.prototype.bytesPerElement=12,Gn(gu,"StructArrayLayout3f12");class _u extends Fi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,s,c,g,f){const _=this.length;return this.resize(_+1),this.emplace(_,n,s,c,g,f)}emplace(n,s,c,g,f,_){const T=6*n,A=3*n;return this.uint16[T+0]=s,this.uint16[T+1]=c,this.uint16[T+2]=g,this.uint16[T+3]=f,this.float32[A+2]=_,n}}_u.prototype.bytesPerElement=12,Gn(_u,"StructArrayLayout4ui1f12");class Tp extends Fi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,s,c,g){const f=this.length;return this.resize(f+1),this.emplace(f,n,s,c,g)}emplace(n,s,c,g,f){const _=4*n;return this.uint16[_+0]=s,this.uint16[_+1]=c,this.uint16[_+2]=g,this.uint16[_+3]=f,n}}Tp.prototype.bytesPerElement=8,Gn(Tp,"StructArrayLayout4ui8");class Cp extends Fi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,s,c,g,f,_){const T=this.length;return this.resize(T+1),this.emplace(T,n,s,c,g,f,_)}emplace(n,s,c,g,f,_,T){const A=6*n;return this.int16[A+0]=s,this.int16[A+1]=c,this.int16[A+2]=g,this.int16[A+3]=f,this.int16[A+4]=_,this.int16[A+5]=T,n}}Cp.prototype.bytesPerElement=12,Gn(Cp,"StructArrayLayout6i12");class Kg extends Fi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,s,c,g,f,_,T,A,D,w,k,O){const I=this.length;return this.resize(I+1),this.emplace(I,n,s,c,g,f,_,T,A,D,w,k,O)}emplace(n,s,c,g,f,_,T,A,D,w,k,O,I){const R=12*n;return this.int16[R+0]=s,this.int16[R+1]=c,this.int16[R+2]=g,this.int16[R+3]=f,this.uint16[R+4]=_,this.uint16[R+5]=T,this.uint16[R+6]=A,this.uint16[R+7]=D,this.int16[R+8]=w,this.int16[R+9]=k,this.int16[R+10]=O,this.int16[R+11]=I,n}}Kg.prototype.bytesPerElement=24,Gn(Kg,"StructArrayLayout4i4ui4i24");class Zg extends Fi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,s,c,g,f,_){const T=this.length;return this.resize(T+1),this.emplace(T,n,s,c,g,f,_)}emplace(n,s,c,g,f,_,T){const A=10*n,D=5*n;return this.int16[A+0]=s,this.int16[A+1]=c,this.int16[A+2]=g,this.float32[D+2]=f,this.float32[D+3]=_,this.float32[D+4]=T,n}}Zg.prototype.bytesPerElement=20,Gn(Zg,"StructArrayLayout3i3f20");class Yg extends Fi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(n){const s=this.length;return this.resize(s+1),this.emplace(s,n)}emplace(n,s){return this.uint32[1*n+0]=s,n}}Yg.prototype.bytesPerElement=4,Gn(Yg,"StructArrayLayout1ul4");class yu extends Fi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,s){const c=this.length;return this.resize(c+1),this.emplace(c,n,s)}emplace(n,s,c){const g=2*n;return this.uint16[g+0]=s,this.uint16[g+1]=c,n}}yu.prototype.bytesPerElement=4,Gn(yu,"StructArrayLayout2ui4");class Xg extends Fi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,s,c,g,f,_,T,A,D,w,k,O,I){const R=this.length;return this.resize(R+1),this.emplace(R,n,s,c,g,f,_,T,A,D,w,k,O,I)}emplace(n,s,c,g,f,_,T,A,D,w,k,O,I,R){const B=20*n,W=10*n;return this.int16[B+0]=s,this.int16[B+1]=c,this.int16[B+2]=g,this.int16[B+3]=f,this.int16[B+4]=_,this.float32[W+3]=T,this.float32[W+4]=A,this.float32[W+5]=D,this.float32[W+6]=w,this.int16[B+14]=k,this.uint32[W+8]=O,this.uint16[B+18]=I,this.uint16[B+19]=R,n}}Xg.prototype.bytesPerElement=40,Gn(Xg,"StructArrayLayout5i4f1i1ul2ui40");class zf extends Fi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,s,c,g,f,_,T){const A=this.length;return this.resize(A+1),this.emplace(A,n,s,c,g,f,_,T)}emplace(n,s,c,g,f,_,T,A){const D=8*n;return this.int16[D+0]=s,this.int16[D+1]=c,this.int16[D+2]=g,this.int16[D+4]=f,this.int16[D+5]=_,this.int16[D+6]=T,this.int16[D+7]=A,n}}zf.prototype.bytesPerElement=16,Gn(zf,"StructArrayLayout3i2i2i16");class Jg extends Fi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,s,c,g,f){const _=this.length;return this.resize(_+1),this.emplace(_,n,s,c,g,f)}emplace(n,s,c,g,f,_){const T=4*n,A=8*n;return this.float32[T+0]=s,this.float32[T+1]=c,this.float32[T+2]=g,this.int16[A+6]=f,this.int16[A+7]=_,n}}Jg.prototype.bytesPerElement=16,Gn(Jg,"StructArrayLayout2f1f2i16");class Qg extends Fi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,s,c,g,f,_){const T=this.length;return this.resize(T+1),this.emplace(T,n,s,c,g,f,_)}emplace(n,s,c,g,f,_,T){const A=20*n,D=5*n;return this.uint8[A+0]=s,this.uint8[A+1]=c,this.float32[D+1]=g,this.float32[D+2]=f,this.float32[D+3]=_,this.float32[D+4]=T,n}}Qg.prototype.bytesPerElement=20,Gn(Qg,"StructArrayLayout2ub4f20");class Uo extends Fi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,s,c){const g=this.length;return this.resize(g+1),this.emplace(g,n,s,c)}emplace(n,s,c,g){const f=3*n;return this.uint16[f+0]=s,this.uint16[f+1]=c,this.uint16[f+2]=g,n}}Uo.prototype.bytesPerElement=6,Gn(Uo,"StructArrayLayout3ui6");class Ep extends Fi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(n,s,c,g,f,_,T,A,D,w,k,O,I,R,B,W,K,ie,oe,Q,ue){const ge=this.length;return this.resize(ge+1),this.emplace(ge,n,s,c,g,f,_,T,A,D,w,k,O,I,R,B,W,K,ie,oe,Q,ue)}emplace(n,s,c,g,f,_,T,A,D,w,k,O,I,R,B,W,K,ie,oe,Q,ue,ge){const Se=30*n,Fe=15*n,ze=60*n;return this.int16[Se+0]=s,this.int16[Se+1]=c,this.int16[Se+2]=g,this.float32[Fe+2]=f,this.float32[Fe+3]=_,this.uint16[Se+8]=T,this.uint16[Se+9]=A,this.uint32[Fe+5]=D,this.uint32[Fe+6]=w,this.uint32[Fe+7]=k,this.uint16[Se+16]=O,this.uint16[Se+17]=I,this.uint16[Se+18]=R,this.float32[Fe+10]=B,this.float32[Fe+11]=W,this.uint8[ze+48]=K,this.uint8[ze+49]=ie,this.uint8[ze+50]=oe,this.uint32[Fe+13]=Q,this.int16[Se+28]=ue,this.uint8[ze+58]=ge,n}}Ep.prototype.bytesPerElement=60,Gn(Ep,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class Mp extends Fi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(n,s,c,g,f,_,T,A,D,w,k,O,I,R,B,W,K,ie,oe,Q,ue,ge,Se,Fe,ze,Le,nt,$e,it,dt,ct,mt){const wt=this.length;return this.resize(wt+1),this.emplace(wt,n,s,c,g,f,_,T,A,D,w,k,O,I,R,B,W,K,ie,oe,Q,ue,ge,Se,Fe,ze,Le,nt,$e,it,dt,ct,mt)}emplace(n,s,c,g,f,_,T,A,D,w,k,O,I,R,B,W,K,ie,oe,Q,ue,ge,Se,Fe,ze,Le,nt,$e,it,dt,ct,mt,wt){const Mt=20*n,vt=40*n,qt=80*n;return this.float32[Mt+0]=s,this.float32[Mt+1]=c,this.int16[vt+4]=g,this.int16[vt+5]=f,this.int16[vt+6]=_,this.int16[vt+7]=T,this.int16[vt+8]=A,this.int16[vt+9]=D,this.int16[vt+10]=w,this.int16[vt+11]=k,this.int16[vt+12]=O,this.uint16[vt+13]=I,this.uint16[vt+14]=R,this.uint16[vt+15]=B,this.uint16[vt+16]=W,this.uint16[vt+17]=K,this.uint16[vt+18]=ie,this.uint16[vt+19]=oe,this.uint16[vt+20]=Q,this.uint16[vt+21]=ue,this.uint16[vt+22]=ge,this.uint16[vt+23]=Se,this.uint16[vt+24]=Fe,this.uint16[vt+25]=ze,this.uint16[vt+26]=Le,this.uint16[vt+27]=nt,this.uint32[Mt+14]=$e,this.float32[Mt+15]=it,this.float32[Mt+16]=dt,this.float32[Mt+17]=ct,this.float32[Mt+18]=mt,this.uint8[qt+76]=wt,n}}Mp.prototype.bytesPerElement=80,Gn(Mp,"StructArrayLayout2f9i15ui1ul4f1ub80");class pa extends Fi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n){const s=this.length;return this.resize(s+1),this.emplace(s,n)}emplace(n,s){return this.float32[1*n+0]=s,n}}pa.prototype.bytesPerElement=4,Gn(pa,"StructArrayLayout1f4");class vu extends Fi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,s,c,g,f){const _=this.length;return this.resize(_+1),this.emplace(_,n,s,c,g,f)}emplace(n,s,c,g,f,_){const T=5*n;return this.float32[T+0]=s,this.float32[T+1]=c,this.float32[T+2]=g,this.float32[T+3]=f,this.float32[T+4]=_,n}}vu.prototype.bytesPerElement=20,Gn(vu,"StructArrayLayout5f20");class e_ extends Fi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,s,c,g,f,_,T){const A=this.length;return this.resize(A+1),this.emplace(A,n,s,c,g,f,_,T)}emplace(n,s,c,g,f,_,T,A){const D=7*n;return this.float32[D+0]=s,this.float32[D+1]=c,this.float32[D+2]=g,this.float32[D+3]=f,this.float32[D+4]=_,this.float32[D+5]=T,this.float32[D+6]=A,n}}e_.prototype.bytesPerElement=28,Gn(e_,"StructArrayLayout7f28");class t_ extends Fi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,s,c,g,f,_,T,A,D,w,k){const O=this.length;return this.resize(O+1),this.emplace(O,n,s,c,g,f,_,T,A,D,w,k)}emplace(n,s,c,g,f,_,T,A,D,w,k,O){const I=11*n;return this.float32[I+0]=s,this.float32[I+1]=c,this.float32[I+2]=g,this.float32[I+3]=f,this.float32[I+4]=_,this.float32[I+5]=T,this.float32[I+6]=A,this.float32[I+7]=D,this.float32[I+8]=w,this.float32[I+9]=k,this.float32[I+10]=O,n}}t_.prototype.bytesPerElement=44,Gn(t_,"StructArrayLayout11f44");class n_ extends Fi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,s,c,g,f,_,T,A,D){const w=this.length;return this.resize(w+1),this.emplace(w,n,s,c,g,f,_,T,A,D)}emplace(n,s,c,g,f,_,T,A,D,w){const k=9*n;return this.float32[k+0]=s,this.float32[k+1]=c,this.float32[k+2]=g,this.float32[k+3]=f,this.float32[k+4]=_,this.float32[k+5]=T,this.float32[k+6]=A,this.float32[k+7]=D,this.float32[k+8]=w,n}}n_.prototype.bytesPerElement=36,Gn(n_,"StructArrayLayout9f36");class kl extends Fi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,s){const c=this.length;return this.resize(c+1),this.emplace(c,n,s)}emplace(n,s,c){const g=2*n;return this.float32[g+0]=s,this.float32[g+1]=c,n}}kl.prototype.bytesPerElement=8,Gn(kl,"StructArrayLayout2f8");class Ip extends Fi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,s,c,g){const f=this.length;return this.resize(f+1),this.emplace(f,n,s,c,g)}emplace(n,s,c,g,f){const _=6*n;return this.uint32[3*n+0]=s,this.uint16[_+2]=c,this.uint16[_+3]=g,this.uint16[_+4]=f,n}}Ip.prototype.bytesPerElement=12,Gn(Ip,"StructArrayLayout1ul3ui12");class r_ extends Fi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n){const s=this.length;return this.resize(s+1),this.emplace(s,n)}emplace(n,s){return this.uint16[1*n+0]=s,n}}r_.prototype.bytesPerElement=2,Gn(r_,"StructArrayLayout1ui2");class Ap extends Fi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,s,c,g,f,_,T,A,D,w,k,O,I,R,B,W){const K=this.length;return this.resize(K+1),this.emplace(K,n,s,c,g,f,_,T,A,D,w,k,O,I,R,B,W)}emplace(n,s,c,g,f,_,T,A,D,w,k,O,I,R,B,W,K){const ie=16*n;return this.float32[ie+0]=s,this.float32[ie+1]=c,this.float32[ie+2]=g,this.float32[ie+3]=f,this.float32[ie+4]=_,this.float32[ie+5]=T,this.float32[ie+6]=A,this.float32[ie+7]=D,this.float32[ie+8]=w,this.float32[ie+9]=k,this.float32[ie+10]=O,this.float32[ie+11]=I,this.float32[ie+12]=R,this.float32[ie+13]=B,this.float32[ie+14]=W,this.float32[ie+15]=K,n}}Ap.prototype.bytesPerElement=64,Gn(Ap,"StructArrayLayout16f64");class kp extends Fi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,s,c,g,f,_,T){const A=this.length;return this.resize(A+1),this.emplace(A,n,s,c,g,f,_,T)}emplace(n,s,c,g,f,_,T,A){const D=10*n,w=5*n;return this.uint16[D+0]=s,this.uint16[D+1]=c,this.uint16[D+2]=g,this.uint16[D+3]=f,this.float32[w+2]=_,this.float32[w+3]=T,this.float32[w+4]=A,n}}kp.prototype.bytesPerElement=20,Gn(kp,"StructArrayLayout4ui3f20");class Pp extends Fi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n){const s=this.length;return this.resize(s+1),this.emplace(s,n)}emplace(n,s){return this.int16[1*n+0]=s,n}}Pp.prototype.bytesPerElement=2,Gn(Pp,"StructArrayLayout1i2");class hd extends Fi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer)}emplaceBack(n){const s=this.length;return this.resize(s+1),this.emplace(s,n)}emplace(n,s){return this.uint8[1*n+0]=s,n}}hd.prototype.bytesPerElement=1,Gn(hd,"StructArrayLayout1ub1");class d0 extends Lf{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}d0.prototype.size=40;class f0 extends Xg{get(n){return new d0(this,n)}}Gn(f0,"CollisionBoxArray");class h0 extends Lf{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(n){this._structArray.uint8[this._pos1+49]=n}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(n){this._structArray.uint8[this._pos1+50]=n}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(n){this._structArray.uint32[this._pos4+13]=n}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(n){this._structArray.uint8[this._pos1+58]=n}}h0.prototype.size=60;class p0 extends Ep{get(n){return new h0(this,n)}}Gn(p0,"PlacedSymbolArray");class m0 extends Lf{get tileAnchorX(){return this._structArray.float32[this._pos4+0]}get tileAnchorY(){return this._structArray.float32[this._pos4+1]}get projectedAnchorX(){return this._structArray.int16[this._pos2+4]}get projectedAnchorY(){return this._structArray.int16[this._pos2+5]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+6]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+7]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+11]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get key(){return this._structArray.uint16[this._pos2+13]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+14]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+15]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+17]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+19]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+21]}get featureIndex(){return this._structArray.uint16[this._pos2+22]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+23]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numIconVertices(){return this._structArray.uint16[this._pos2+25]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+26]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+27]}get crossTileID(){return this._structArray.uint32[this._pos4+14]}set crossTileID(n){this._structArray.uint32[this._pos4+14]=n}get textOffset0(){return this._structArray.float32[this._pos4+15]}get textOffset1(){return this._structArray.float32[this._pos4+16]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+17]}get zOffset(){return this._structArray.float32[this._pos4+18]}set zOffset(n){this._structArray.float32[this._pos4+18]=n}get hasIconTextFit(){return this._structArray.uint8[this._pos1+76]}}m0.prototype.size=80;class Ff extends Mp{get(n){return new m0(this,n)}}Gn(Ff,"SymbolInstanceArray");class Nf extends pa{getoffsetX(n){return this.float32[1*n+0]}}Gn(Nf,"GlyphOffsetArray");class As extends Il{getx(n){return this.int16[2*n+0]}gety(n){return this.int16[2*n+1]}}Gn(As,"SymbolLineVertexArray");class Bf extends Lf{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}Bf.prototype.size=12;class g0 extends Ip{get(n){return new Bf(this,n)}}Gn(g0,"FeatureIndexArray");class _0 extends yu{geta_centroid_pos0(n){return this.uint16[2*n+0]}geta_centroid_pos1(n){return this.uint16[2*n+1]}}Gn(_0,"FillExtrusionCentroidArray");class y0 extends Lf{get a_join_normal_inside0(){return this._structArray.int16[this._pos2+0]}get a_join_normal_inside1(){return this._structArray.int16[this._pos2+1]}get a_join_normal_inside2(){return this._structArray.int16[this._pos2+2]}}y0.prototype.size=6;class v0 extends dd{get(n){return new y0(this,n)}}Gn(v0,"FillExtrusionWallArray");const i_=ti([{name:"a_pos",components:2,type:"Int16"}],4),gw=ti([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class Yi{constructor(n=[]){this.segments=n}_prepareSegment(n,s,c,g){let f=this.segments[this.segments.length-1];return n>Yi.MAX_VERTEX_ARRAY_LENGTH&&xn(`Max vertices per segment is ${Yi.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${n}`),(!f||f.vertexLength+n>Yi.MAX_VERTEX_ARRAY_LENGTH||f.sortKey!==g)&&(f={vertexOffset:s,primitiveOffset:c,vertexLength:0,primitiveLength:0},g!==void 0&&(f.sortKey=g),this.segments.push(f)),f}prepareSegment(n,s,c,g){return this._prepareSegment(n,s.length,c.length,g)}get(){return this.segments}destroy(){for(const n of this.segments)for(const s in n.vaos)n.vaos[s].destroy()}static simpleSegment(n,s,c,g){return new Yi([{vertexOffset:n,primitiveOffset:s,vertexLength:c,primitiveLength:g,vaos:{},sortKey:0}])}}function b0(u,n){return 256*(u=Et(Math.floor(u),0,255))+Et(Math.floor(n),0,255)}Yi.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Gn(Yi,"SegmentVector");const _w=ti([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),o_=ti([{name:"a_dash",components:4,type:"Uint16"}]);class Vf{constructor(){this.ids=[],this.uniqueIds=[],this.positions=[],this.indexed=!1}add(n,s,c,g){this.ids.push(s_(n)),this.positions.push(s,c,g)}eachPosition(n,s){const c=s_(n);let g=0,f=this.ids.length-1;for(;g<f;){const _=g+f>>1;this.ids[_]>=c?f=_:g=_+1}for(;this.ids[g]===c;)s(this.positions[3*g],this.positions[3*g+1],this.positions[3*g+2]),g++}static serialize(n,s){const c=new Float64Array(n.ids),g=new Uint32Array(n.positions);return Rp(c,g,0,c.length-1),s&&(s.add(c.buffer),s.add(g.buffer)),{ids:c,positions:g}}static deserialize(n){const s=new Vf;let c;s.ids=n.ids,s.positions=n.positions;for(const g of s.ids)g!==c&&s.uniqueIds.push(g),c=g;return s.indexed=!0,s}}function s_(u){const n=+u;return!isNaN(n)&&Number.MIN_SAFE_INTEGER<=n&&n<=Number.MAX_SAFE_INTEGER?n:ff(String(u))}function Rp(u,n,s,c){for(;s<c;){const g=u[s+c>>1];let f=s-1,_=c+1;for(;;){do f++;while(u[f]<g);do _--;while(u[_]>g);if(f>=_)break;Op(u,f,_),Op(n,3*f,3*_),Op(n,3*f+1,3*_+1),Op(n,3*f+2,3*_+2)}_-s<c-_?(Rp(u,n,s,_),s=_+1):(Rp(u,n,_+1,c),c=_)}}function Op(u,n,s){const c=u[n];u[n]=u[s],u[s]=c}Gn(Vf,"FeaturePositionMap");class La{constructor(n){this.gl=n.gl,this.initialized=!1}fetchUniformLocation(n,s){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(n,s),this.initialized=!0),!!this.location}set(n,s,c){throw new Error("Uniform#set() must be implemented by each concrete Uniform")}}class uc extends La{constructor(n){super(n),this.current=0}set(n,s,c){this.fetchUniformLocation(n,s)&&this.current!==c&&(this.current=c,this.gl.uniform1i(this.location,c))}}class no extends La{constructor(n){super(n),this.current=0}set(n,s,c){this.fetchUniformLocation(n,s)&&this.current!==c&&(this.current=c,this.gl.uniform1f(this.location,c))}}class Ja extends La{constructor(n){super(n),this.current=[0,0]}set(n,s,c){this.fetchUniformLocation(n,s)&&(c[0]===this.current[0]&&c[1]===this.current[1]||(this.current=c,this.gl.uniform2f(this.location,c[0],c[1])))}}class Lp extends La{constructor(n){super(n),this.current=[0,0,0]}set(n,s,c){this.fetchUniformLocation(n,s)&&(c[0]===this.current[0]&&c[1]===this.current[1]&&c[2]===this.current[2]||(this.current=c,this.gl.uniform3f(this.location,c[0],c[1],c[2])))}}class Dp extends La{constructor(n){super(n),this.current=[0,0,0,0]}set(n,s,c){this.fetchUniformLocation(n,s)&&(c[0]===this.current[0]&&c[1]===this.current[1]&&c[2]===this.current[2]&&c[3]===this.current[3]||(this.current=c,this.gl.uniform4f(this.location,c[0],c[1],c[2],c[3])))}}class zp extends La{constructor(n){super(n),this.current=Jr.transparent.toRenderColor(null)}set(n,s,c){this.fetchUniformLocation(n,s)&&(c.r===this.current.r&&c.g===this.current.g&&c.b===this.current.b&&c.a===this.current.a||(this.current=c,this.gl.uniform4f(this.location,c.r,c.g,c.b,c.a)))}}const yw=new Float32Array(16);class $f extends La{constructor(n){super(n),this.current=yw}set(n,s,c){if(this.fetchUniformLocation(n,s)){if(c[12]!==this.current[12]||c[0]!==this.current[0])return this.current=c,void this.gl.uniformMatrix4fv(this.location,!1,c);for(let g=1;g<16;g++)if(c[g]!==this.current[g]){this.current=c,this.gl.uniformMatrix4fv(this.location,!1,c);break}}}}const vw=new Float32Array(9),bw=new Float32Array(4);class Fp extends La{constructor(n){super(n),this.current=bw}set(n,s,c){if(this.fetchUniformLocation(n,s)){for(let g=0;g<4;g++)if(c[g]!==this.current[g]){this.current=c,this.gl.uniformMatrix2fv(this.location,!1,c);break}}}}function a_(u){return[b0(255*u.r,255*u.g),b0(255*u.b,255*u.a)]}class pd{constructor(n,s,c,g){this.value=n,this.uniformNames=s.map(f=>`u_${f}`),this.type=c,this.context=g}setUniform(n,s,c,g,f){const _=g.constantOr(this.value);s.set(n,f,_ instanceof Jr?_.toRenderColor(this.ignoreLut?null:this.context.lut):_)}getBinding(n,s){return this.type==="color"?new zp(n):new no(n)}}class md{constructor(n,s){this.uniformNames=s.map(c=>`u_${c}`),this.pattern=null,this.pixelRatio=1}setConstantPatternPositions(n){this.pixelRatio=n.pixelRatio||1,this.pattern=n.tl.concat(n.br)}setUniform(n,s,c,g,f){const _=f==="u_pattern"||f==="u_dash"?this.pattern:f==="u_pixel_ratio"?this.pixelRatio:null;_&&s.set(n,f,_)}getBinding(n,s){return s==="u_pattern"||s==="u_dash"?new Dp(n):new no(n)}}class Pl{constructor(n,s,c,g){this.expression=n,this.type=c,this.maxValue=0,this.paintVertexAttributes=s.map(f=>({name:`a_${f}`,type:"Float32",components:c==="color"?2:1,offset:0})),this.paintVertexArray=new g}populatePaintArray(n,s,c,g,f,_,T){const A=this.paintVertexArray.length,D=this.expression.evaluate(new ji(0,{brightness:_}),s,{},f,g,T);this.paintVertexArray.resize(n),this._setPaintValue(A,n,D,this.context)}updatePaintArray(n,s,c,g,f,_,T){const A=this.expression.evaluate({zoom:0,brightness:T},c,g,void 0,f);this._setPaintValue(n,s,A,this.context)}_setPaintValue(n,s,c,g){if(this.type==="color"){const f=a_(c.toRenderColor(this.ignoreLut?null:g.lut));for(let _=n;_<s;_++)this.paintVertexArray.emplace(_,f[0],f[1])}else{for(let f=n;f<s;f++)this.paintVertexArray.emplace(f,c);this.maxValue=Math.max(this.maxValue,Math.abs(c))}}upload(n){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=n.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Da{constructor(n,s,c,g,f,_){this.expression=n,this.uniformNames=s.map(T=>`u_${T}_t`),this.type=c,this.useIntegerZoom=g,this.context=f,this.maxValue=0,this.paintVertexAttributes=s.map(T=>({name:`a_${T}`,type:"Float32",components:c==="color"?4:2,offset:0})),this.paintVertexArray=new _}populatePaintArray(n,s,c,g,f,_,T){const A=this.expression.evaluate(new ji(this.context.zoom,{brightness:_}),s,{},f,g,T),D=this.expression.evaluate(new ji(this.context.zoom+1,{brightness:_}),s,{},f,g,T),w=this.paintVertexArray.length;this.paintVertexArray.resize(n),this._setPaintValue(w,n,A,D,this.context)}updatePaintArray(n,s,c,g,f,_,T){const A=this.expression.evaluate({zoom:this.context.zoom,brightness:T},c,g,void 0,f),D=this.expression.evaluate({zoom:this.context.zoom+1,brightness:T},c,g,void 0,f);this._setPaintValue(n,s,A,D,this.context)}_setPaintValue(n,s,c,g,f){if(this.type==="color"){const _=a_(c.toRenderColor(this.ignoreLut?null:f.lut)),T=a_(c.toRenderColor(this.ignoreLut?null:f.lut));for(let A=n;A<s;A++)this.paintVertexArray.emplace(A,_[0],_[1],T[0],T[1])}else{for(let _=n;_<s;_++)this.paintVertexArray.emplace(_,c,g);this.maxValue=Math.max(this.maxValue,Math.abs(c),Math.abs(g))}}upload(n){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=n.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(n,s,c,g,f){const _=this.useIntegerZoom?Math.floor(c.zoom):c.zoom,T=Et(this.expression.interpolationFactor(_,this.context.zoom,this.context.zoom+1),0,1);s.set(n,f,T)}getBinding(n,s){return new no(n)}}class bu{constructor(n,s,c,g,f){this.expression=n,this.layerId=f,this.paintVertexAttributes=(c==="array"?o_:_w).members;for(let _=0;_<s.length;++_);this.paintVertexArray=new g}populatePaintArray(n,s,c,g){const f=this.paintVertexArray.length;this.paintVertexArray.resize(n),this._setPaintValues(f,n,s.patterns&&s.patterns[this.layerId],c)}updatePaintArray(n,s,c,g,f,_,T){this._setPaintValues(n,s,c.patterns&&c.patterns[this.layerId],_)}_setPaintValues(n,s,c,g){if(!g||!c)return;const f=g[c];if(!f)return;const{tl:_,br:T,pixelRatio:A}=f;for(let D=n;D<s;D++)this.paintVertexArray.emplace(D,_[0],_[1],T[0],T[1],A)}upload(n){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=n.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class cc{constructor(n,s,c=()=>!0){this.binders={},this._buffers=[],this.context=s;const g=[];for(const f in n.paint._values){const _=n.paint.get(f),T=n.paint.get(`${f}-use-theme`);if(f.endsWith("-use-theme")||!c(f)||!(_ instanceof od&&td(_.property.specification)))continue;const A=xw(f,n.type),D=_.value,w=_.property.specification.type,k=!!_.property.useIntegerZoom,O=f==="line-dasharray"||f.endsWith("pattern"),I=f==="line-dasharray"&&n.layout.get("line-cap").value.kind!=="constant";if(D.kind!=="constant"||I)if(D.kind==="source"||I||O){const R=x0(f,w,"source");this.binders[f]=O?new bu(D,A,w,R,n.id):new Pl(D,A,w,R),g.push(`/a_${f}`)}else{const R=x0(f,w,"composite");this.binders[f]=new Da(D,A,w,k,s,R),g.push(`/z_${f}`)}else this.binders[f]=O?new md(D.value,A):new pd(D.value,A,w,s),g.push(`/u_${f}`);T&&(this.binders[f].ignoreLut=T.constantOr("default")==="none",this.binders[f].checkUseTheme=!0)}this.cacheKey=g.sort().join("")}getMaxValue(n){const s=this.binders[n];return s instanceof Pl||s instanceof Da?s.maxValue:0}populatePaintArrays(n,s,c,g,f,_,T){for(const A in this.binders){const D=this.binders[A];D.context=this.context,(D instanceof Pl||D instanceof Da||D instanceof bu)&&D.populatePaintArray(n,s,c,g,f,_,T)}}setConstantPatternPositions(n){for(const s in this.binders){const c=this.binders[s];c instanceof md&&c.setConstantPatternPositions(n)}}updatePaintArrays(n,s,c,g,f,_,T,A,D){let w=!1;const k=Object.keys(n),O=k.length!==0&&!A,I=O?k:s.uniqueIds;this.context.lut=f.lut;for(const R in this.binders){const B=this.binders[R];if(B.context=this.context,(B instanceof Pl||B instanceof Da||B instanceof bu)&&(B.expression.isStateDependent===!0||B.expression.isLightConstant===!1)){const W=f.paint.get(R);B.expression=W.value;for(const K of I){const ie=n[K.toString()];s.eachPosition(K,(oe,Q,ue)=>{const ge=g.feature(oe);B.updatePaintArray(Q,ue,ge,ie,_,T,D)})}if(!O)for(const K of c.uniqueIds){const ie=n[K.toString()];c.eachPosition(K,(oe,Q,ue)=>{const ge=g.feature(oe);B.updatePaintArray(Q,ue,ge,ie,_,T,D)})}w=!0}}return w}defines(){const n=[];for(const s in this.binders){const c=this.binders[s];(c instanceof pd||c instanceof md)&&n.push(...c.uniformNames.map(g=>`#define HAS_UNIFORM_${g}`))}return n}getBinderAttributes(){const n=[];for(const s in this.binders){const c=this.binders[s];if(c instanceof Pl||c instanceof Da||c instanceof bu)for(let g=0;g<c.paintVertexAttributes.length;g++)n.push(c.paintVertexAttributes[g].name)}return n}getBinderUniforms(){const n=[];for(const s in this.binders){const c=this.binders[s];if(c instanceof pd||c instanceof md||c instanceof Da)for(const g of c.uniformNames)n.push(g)}return n}getPaintVertexBuffers(){return this._buffers}getUniforms(n){const s=[];for(const c in this.binders){const g=this.binders[c];if(g instanceof pd||g instanceof md||g instanceof Da)for(const f of g.uniformNames)s.push({name:f,property:c,binding:g.getBinding(n,f)})}return s}setUniforms(n,s,c,g,f){for(const{name:_,property:T,binding:A}of c){if(this.binders[T].checkUseTheme&&this.binders[T]instanceof pd){const D=g.get(`${T}-use-theme`);D.isConstant()&&(this.binders[T].ignoreLut=D.constantOr("default")==="none")}this.binders[T].setUniform(n,A,f,g.get(T),_)}}updatePaintBuffers(){this._buffers=[];for(const n in this.binders){const s=this.binders[n];(s instanceof Pl||s instanceof Da||s instanceof bu)&&s.paintVertexBuffer&&this._buffers.push(s.paintVertexBuffer)}}upload(n){for(const s in this.binders){const c=this.binders[s];(c instanceof Pl||c instanceof Da||c instanceof bu)&&c.upload(n)}this.updatePaintBuffers()}destroy(){for(const n in this.binders){const s=this.binders[n];(s instanceof Pl||s instanceof Da||s instanceof bu)&&s.destroy()}}}class xu{constructor(n,s,c=()=>!0){this.programConfigurations={};for(const g of n)this.programConfigurations[g.id]=new cc(g,s,c);this.needsUpload=!1,this._featureMap=new Vf,this._featureMapWithoutIds=new Vf,this._bufferOffset=0,this._idlessCounter=0}populatePaintArrays(n,s,c,g,f,_,T,A){for(const D in this.programConfigurations)this.programConfigurations[D].populatePaintArrays(n,s,g,f,_,T,A);s.id!==void 0?this._featureMap.add(s.id,c,this._bufferOffset,n):(this._featureMapWithoutIds.add(this._idlessCounter,c,this._bufferOffset,n),this._idlessCounter+=1),this._bufferOffset=n,this.needsUpload=!0}updatePaintArrays(n,s,c,g,f,_,T){for(const A of c)this.needsUpload=this.programConfigurations[A.id].updatePaintArrays(n,this._featureMap,this._featureMapWithoutIds,s,A,g,f,_,T||0)||this.needsUpload}get(n){return this.programConfigurations[n]}upload(n){if(this.needsUpload){for(const s in this.programConfigurations)this.programConfigurations[s].upload(n);this.needsUpload=!1}}destroy(){for(const n in this.programConfigurations)this.programConfigurations[n].destroy()}}const Np={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-occlusion-opacity":["occlusion_opacity"],"icon-occlusion-opacity":["occlusion_opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-emissive-strength":["emissive_strength"],"icon-emissive-strength":["emissive_strength"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"symbol-z-offset":["z_offset"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio"],"fill-pattern":["pattern","pixel_ratio"],"fill-extrusion-pattern":["pattern","pixel_ratio"],"line-dasharray":["dash"]};function xw(u,n){return Np[u]||[u.replace(`${n}-`,"").replace(/-/g,"_")]}const ww={"line-pattern":{source:_u,composite:_u},"fill-pattern":{source:_u,composite:_u},"fill-extrusion-pattern":{source:_u,composite:_u},"line-dasharray":{source:Tp,composite:Tp}},Bp={color:{source:kl,composite:Al},number:{source:pa,composite:kl}};function x0(u,n,s){const c=ww[u];return c&&c[s]||Bp[n][s]}Gn(pd,"ConstantBinder"),Gn(md,"PatternConstantBinder"),Gn(Pl,"SourceExpressionBinder"),Gn(bu,"PatternCompositeBinder"),Gn(Da,"CompositeExpressionBinder"),Gn(cc,"ProgramConfiguration",{omit:["_buffers"]}),Gn(xu,"ProgramConfigurationSet");const Ko=kn/Math.PI/2,l_=5,u_=6,w0=16383,dc=64,c_=[dc,32,16],ma=-Ko,ga=Ko;function fc(u,n,s,c=Ko){return s=Pt(s),[u*Math.sin(s)*c,-n*c,u*Math.cos(s)*c]}function hc(u,n,s){return fc(Math.cos(Pt(u)),Math.sin(Pt(u)),n,s)}const gd=63710088e-1,d_=2*Math.PI*gd;class Qr{constructor(n,s){if(isNaN(n)||isNaN(s))throw new Error(`Invalid LngLat object: (${n}, ${s})`);if(this.lng=+n,this.lat=+s,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Qr(Xn(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(n){const s=Math.PI/180,c=this.lat*s,g=n.lat*s,f=Math.sin(c)*Math.sin(g)+Math.cos(c)*Math.cos(g)*Math.cos((n.lng-this.lng)*s);return gd*Math.acos(Math.min(f,1))}toBounds(n=0){const s=360*n/40075017,c=s/Math.cos(Math.PI/180*this.lat);return new wu({lng:this.lng-c,lat:this.lat-s},{lng:this.lng+c,lat:this.lat+s})}toEcef(n){return hc(this.lat,this.lng,Ko+n*Ko/gd)}static convert(n){if(n instanceof Qr)return n;if(Array.isArray(n)&&(n.length===2||n.length===3))return new Qr(Number(n[0]),Number(n[1]));if(!Array.isArray(n)&&typeof n=="object"&&n!==null)return new Qr(Number("lng"in n?n.lng:n.lon),Number(n.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}class wu{constructor(n,s){if(n)if(s)this.setSouthWest(n).setNorthEast(s);else if(n.length===4){const c=n;this.setSouthWest([c[0],c[1]]).setNorthEast([c[2],c[3]])}else{const c=n;this.setSouthWest(c[0]).setNorthEast(c[1])}}setNorthEast(n){return this._ne=n instanceof Qr?new Qr(n.lng,n.lat):Qr.convert(n),this}setSouthWest(n){return this._sw=n instanceof Qr?new Qr(n.lng,n.lat):Qr.convert(n),this}extend(n){const s=this._sw,c=this._ne;let g,f;if(n instanceof Qr)g=n,f=n;else{if(!(n instanceof wu))return Array.isArray(n)?n.length===4||n.every(Array.isArray)?this.extend(wu.convert(n)):this.extend(Qr.convert(n)):typeof n=="object"&&n!==null&&n.hasOwnProperty("lat")&&(n.hasOwnProperty("lon")||n.hasOwnProperty("lng"))?this.extend(Qr.convert(n)):this;if(g=n._sw,f=n._ne,!g||!f)return this}return s||c?(s.lng=Math.min(g.lng,s.lng),s.lat=Math.min(g.lat,s.lat),c.lng=Math.max(f.lng,c.lng),c.lat=Math.max(f.lat,c.lat)):(this._sw=new Qr(g.lng,g.lat),this._ne=new Qr(f.lng,f.lat)),this}getCenter(){return new Qr((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new Qr(this.getWest(),this.getNorth())}getSouthEast(){return new Qr(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(n){const{lng:s,lat:c}=Qr.convert(n);let g=this._sw.lng<=s&&s<=this._ne.lng;return this._sw.lng>this._ne.lng&&(g=this._sw.lng>=s&&s>=this._ne.lng),this._sw.lat<=c&&c<=this._ne.lat&&g}static convert(n){if(n)return n instanceof wu?n:new wu(n)}}const S0=0,f_=25.5;function Uf(u){return d_*Math.cos(u*Math.PI/180)}function Su(u){return(180+u)/360}function Rl(u){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+u*Math.PI/360)))/360}function os(u,n){return u/Uf(n)}function ks(u){return 360*u-180}function Fo(u){return 360/Math.PI*Math.atan(Math.exp((180-360*u)*Math.PI/180))-90}function h_(u,n){return u*Uf(Fo(n))}const Ps=85.051129;function h(u){return Math.cos(Pt(Et(u,-85.051129,Ps)))}function i(u,n){const s=Et(n,S0,f_),c=Math.pow(2,s);return h(u)*d_/(512*c)}function l(u){return 1/Math.cos(u*Math.PI/180)}function m(u,n=0){const s=Math.exp(Math.PI*(1-(u.y+n/kn)/(1<<u.z)*2));return 80150034*s/(s*s+1)/kn/(1<<u.z)}class v{constructor(n,s,c=0){this.x=+n,this.y=+s,this.z=+c}static fromLngLat(n,s=0){const c=Qr.convert(n);return new v(Su(c.lng),Rl(c.lat),os(s,c.lat))}toLngLat(){return new Qr(ks(this.x),Fo(this.y))}toAltitude(){return h_(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/d_*l(Fo(this.y))}}function x(u,n,s,c,g,f,_,T,A){const D=(n+c)/2,w=(s+g)/2,k=new Je(D,w);T(k),function(O,I,R,B,W,K){const ie=R-W,oe=B-K;return Math.abs((B-I)*ie-(R-O)*oe)/Math.hypot(ie,oe)}(k.x,k.y,f.x,f.y,_.x,_.y)>=A?(x(u,n,s,D,w,f,k,T,A),x(u,D,w,c,g,k,_,T,A)):u.push(_)}function E(u,n,s){let c=u[0],g=c.x,f=c.y;n(c);const _=[c];for(let T=1;T<u.length;T++){const A=u[T],{x:D,y:w}=A;n(A),x(_,g,f,D,w,c,A,n,s),g=D,f=w,c=A}return _}function L(u,n,s,c){if(c(n,s)){const g=n.add(s)._mult(.5);L(u,n,g,c),L(u,g,s,c)}else u.push(s)}function $(u,n){let s=u[0];const c=[s];for(let g=1;g<u.length;g++){const f=u[g];L(c,s,f,n),s=f}return c}const j=Math.pow(2,14)-1,G=-j-1;function X(u,n){const s=Math.round(u.x*n),c=Math.round(u.y*n);return u.x=Et(s,G,j),u.y=Et(c,G,j),(s<u.x||s>u.x+1||c<u.y||c>u.y+1)&&xn("Geometry exceeds allowed extent, reduce your vector tile buffer size"),u}function Y(u,n,s){const c=u.loadGeometry(),g=u.extent,f=kn/g;if(n&&s&&s.projection.isReprojectedInTileSpace){const _=1<<n.z,{scale:T,x:A,y:D,projection:w}=s,k=O=>{const I=ks((n.x+O.x/g)/_),R=Fo((n.y+O.y/g)/_),B=w.project(I,R);O.x=(B.x*T-A)*g,O.y=(B.y*T-D)*g};for(let O=0;O<c.length;O++)if(u.type!==1)c[O]=E(c[O],k,1);else{const I=[];for(const R of c[O])R.x<0||R.x>=g||R.y<0||R.y>=g||(k(R),I.push(R));c[O]=I}}for(const _ of c)for(const T of _)X(T,f);return c}function ne(u,n){return{type:u.type,id:u.id,properties:u.properties,geometry:n?Y(u):[]}}function ve(u,n,s,c,g){u.emplaceBack(2*n+(c+1)/2,2*s+(g+1)/2)}function _e(u,n,s){u.emplaceBack(n.x,n.y,n.z,s[0]*16384,s[1]*16384,s[2]*16384)}class Te{constructor(n){this.zoom=n.zoom,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map(s=>s.fqid),this.index=n.index,this.hasPattern=!1,this.projection=n.projection,this.layoutVertexArray=new Il,this.indexArray=new Uo,this.segments=new Yi,this.programConfigurations=new xu(n.layers,{zoom:n.zoom,lut:n.lut}),this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id)}updateFootprints(n,s){}populate(n,s,c,g){const f=this.layers[0],_=[];let T=null;f.type==="circle"&&(T=f.layout.get("circle-sort-key"));for(const{feature:D,id:w,index:k,sourceLayerIndex:O}of n){const I=this.layers[0]._featureFilter.needGeometry,R=ne(D,I);if(!this.layers[0]._featureFilter.filter(new ji(this.zoom),R,c))continue;const B=T?T.evaluate(R,{},c):void 0,W={id:w,properties:D.properties,type:D.type,sourceLayerIndex:O,index:k,geometry:I?R.geometry:Y(D,c,g),patterns:{},sortKey:B};_.push(W)}T&&_.sort((D,w)=>D.sortKey-w.sortKey);let A=null;g.projection.name==="globe"&&(this.globeExtVertexArray=new Cp,A=g.projection);for(const D of _){const{geometry:w,index:k,sourceLayerIndex:O}=D,I=n[k].feature;this.addFeature(D,w,k,s.availableImages,c,A,s.brightness),s.featureIndex.insert(I,w,k,O,this.index)}}update(n,s,c,g,f,_,T){this.programConfigurations.updatePaintArrays(n,s,f,c,g,_,T)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(n){this.uploaded||(this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,i_.members),this.indexBuffer=n.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=n.createVertexBuffer(this.globeExtVertexArray,gw.members))),this.programConfigurations.upload(n),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(n,s,c,g,f,_,T){for(const A of s)for(const D of A){const w=D.x,k=D.y;if(w<0||w>=kn||k<0||k>=kn)continue;if(_){const R=_.projectTilePoint(w,k,f),B=_.upVector(f,w,k),W=this.globeExtVertexArray;_e(W,R,B),_e(W,R,B),_e(W,R,B),_e(W,R,B)}const O=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,n.sortKey),I=O.vertexLength;ve(this.layoutVertexArray,w,k,-1,-1),ve(this.layoutVertexArray,w,k,1,-1),ve(this.layoutVertexArray,w,k,1,1),ve(this.layoutVertexArray,w,k,-1,1),this.indexArray.emplaceBack(I,I+1,I+2),this.indexArray.emplaceBack(I,I+2,I+3),O.vertexLength+=4,O.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,n,c,{},g,f,T)}}function Ce(u,n){for(let s=0;s<u.length;s++)if(pt(n,u[s]))return!0;for(let s=0;s<n.length;s++)if(pt(u,n[s]))return!0;return!!et(u,n)}function Re(u,n,s){return!!pt(u,n)||!!Xe(n,u,s)}function je(u,n){if(u.length===1)return at(n,u[0]);for(let s=0;s<n.length;s++){const c=n[s];for(let g=0;g<c.length;g++)if(pt(u,c[g]))return!0}for(let s=0;s<u.length;s++)if(at(n,u[s]))return!0;for(let s=0;s<n.length;s++)if(et(u,n[s]))return!0;return!1}function Be(u,n,s){if(u.length>1){if(et(u,n))return!0;for(let c=0;c<n.length;c++)if(Xe(n[c],u,s))return!0}for(let c=0;c<u.length;c++)if(Xe(u[c],n,s))return!0;return!1}function et(u,n){if(u.length===0||n.length===0)return!1;for(let s=0;s<u.length-1;s++){const c=u[s],g=u[s+1];for(let f=0;f<n.length-1;f++)if(Ze(c,g,n[f],n[f+1]))return!0}return!1}function Ze(u,n,s,c){return _r(u,s,c)!==_r(n,s,c)&&_r(u,n,s)!==_r(u,n,c)}function Xe(u,n,s){const c=s*s;if(n.length===1)return u.distSqr(n[0])<c;for(let g=1;g<n.length;g++)if(Ke(u,n[g-1],n[g])<c)return!0;return!1}function Ke(u,n,s){const c=n.distSqr(s);if(c===0)return u.distSqr(n);const g=((u.x-n.x)*(s.x-n.x)+(u.y-n.y)*(s.y-n.y))/c;return u.distSqr(g<0?n:g>1?s:s.sub(n)._mult(g)._add(n))}function at(u,n){let s,c,g,f=!1;for(let _=0;_<u.length;_++){s=u[_];for(let T=0,A=s.length-1;T<s.length;A=T++)c=s[T],g=s[A],c.y>n.y!=g.y>n.y&&n.x<(g.x-c.x)*(n.y-c.y)/(g.y-c.y)+c.x&&(f=!f)}return f}function pt(u,n){let s=!1;for(let c=0,g=u.length-1;c<u.length;g=c++){const f=u[c],_=u[g];f.y>n.y!=_.y>n.y&&n.x<(_.x-f.x)*(n.y-f.y)/(_.y-f.y)+f.x&&(s=!s)}return s}function Vt(u,n,s,c,g){for(const _ of u)if(n<=_.x&&s<=_.y&&c>=_.x&&g>=_.y)return!0;const f=[new Je(n,s),new Je(n,g),new Je(c,g),new Je(c,s)];if(u.length>2){for(const _ of f)if(pt(u,_))return!0}for(let _=0;_<u.length-1;_++)if(Rt(u[_],u[_+1],f))return!0;return!1}function Rt(u,n,s){const c=s[0],g=s[2];if(u.x<c.x&&n.x<c.x||u.x>g.x&&n.x>g.x||u.y<c.y&&n.y<c.y||u.y>g.y&&n.y>g.y)return!1;const f=_r(u,n,s[0]);return f!==_r(u,n,s[1])||f!==_r(u,n,s[2])||f!==_r(u,n,s[3])}function ht(u,n,s,c,g,f){let _=n.y-u.y,T=u.x-n.x;if(f=f||0){const A=_*_+T*T;if(A===0)return!0;const D=Math.sqrt(A);_/=D,T/=D}return!((s.x-u.x)*_+(s.y-u.y)*T-f<0||(c.x-u.x)*_+(c.y-u.y)*T-f<0||(g.x-u.x)*_+(g.y-u.y)*T-f<0)}function St(u,n,s,c,g,f,_){return!(ht(u,n,c,g,f,_)||ht(n,s,c,g,f,_)||ht(s,u,c,g,f,_)||ht(c,g,u,n,s,_)||ht(g,f,u,n,s,_)||ht(f,c,u,n,s,_))}function en(u,n,s){const c=n.paint.get(u).value;return c.kind==="constant"?c.value:s.programConfigurations.get(n.id).getMaxValue(u)}function hn(u){return Math.sqrt(u[0]*u[0]+u[1]*u[1])}function vn(u,n,s,c,g){if(!n[0]&&!n[1])return u;const f=Je.convert(n)._mult(g);s==="viewport"&&f._rotate(-c);const _=[];for(let T=0;T<u.length;T++)_.push(u[T].sub(f));return _}function It(u,n,s,c){const g=Je.convert(u)._mult(c);return n==="viewport"&&g._rotate(-s),g}let ln,Ht;Gn(Te,"CircleBucket",{omit:["layers"]});var gn,cn={exports:{}},tn=(gn||(gn=1,function(u,n){(function(s){function c(f,_,T){var A=g(256*f,256*(_=Math.pow(2,T)-_-1),T),D=g(256*(f+1),256*(_+1),T);return A[0]+","+A[1]+","+D[0]+","+D[1]}function g(f,_,T){var A=2*Math.PI*6378137/256/Math.pow(2,T);return[f*A-2*Math.PI*6378137/2,_*A-2*Math.PI*6378137/2]}s.getURL=function(f,_,T,A,D,w){return w=w||{},f+"?"+["bbox="+c(T,A,D),"format="+(w.format||"image/png"),"service="+(w.service||"WMS"),"version="+(w.version||"1.1.1"),"request="+(w.request||"GetMap"),"srs="+(w.srs||"EPSG:3857"),"width="+(w.width||256),"height="+(w.height||256),"layers="+_].join("&")},s.getTileBBox=c,s.getMercCoords=g,Object.defineProperty(s,"__esModule",{value:!0})})(n)}(0,cn.exports)),cn.exports);class Rn{constructor(n,s,c){this.z=n,this.x=s,this.y=c,this.key=Bn(0,n,n,s,c)}equals(n){return this.z===n.z&&this.x===n.x&&this.y===n.y}url(n,s){const c=tn.getTileBBox(this.x,this.y,this.z),g=function(f,_,T){let A,D="";for(let w=f;w>0;w--)A=1<<w-1,D+=(_&A?1:0)+(T&A?2:0);return D}(this.z,this.x,this.y);return n[(this.x+this.y)%n.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(s==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",g).replace("{bbox-epsg-3857}",c)}toString(){return`${this.z}/${this.x}/${this.y}`}}class Dn{constructor(n,s){this.wrap=n,this.canonical=s,this.key=Bn(n,s.z,s.z,s.x,s.y)}}class An{constructor(n,s,c,g,f){this.overscaledZ=n,this.wrap=s,this.canonical=new Rn(c,+g,+f),this.key=s===0&&n===c?this.canonical.key:Bn(s,n,c,g,f)}equals(n){return this.overscaledZ===n.overscaledZ&&this.wrap===n.wrap&&this.canonical.equals(n.canonical)}scaledTo(n){const s=this.canonical.z-n;return n>this.canonical.z?new An(n,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new An(n,this.wrap,n,this.canonical.x>>s,this.canonical.y>>s)}calculateScaledKey(n,s=!0){if(this.overscaledZ===n&&s)return this.key;if(n>this.canonical.z)return Bn(this.wrap*+s,n,this.canonical.z,this.canonical.x,this.canonical.y);{const c=this.canonical.z-n;return Bn(this.wrap*+s,n,n,this.canonical.x>>c,this.canonical.y>>c)}}isChildOf(n){if(n.wrap!==this.wrap)return!1;const s=this.canonical.z-n.canonical.z;return n.overscaledZ===0||n.overscaledZ<this.overscaledZ&&n.canonical.z<this.canonical.z&&n.canonical.x===this.canonical.x>>s&&n.canonical.y===this.canonical.y>>s}children(n){if(this.overscaledZ>=n)return[new An(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const s=this.canonical.z+1,c=2*this.canonical.x,g=2*this.canonical.y;return[new An(s,this.wrap,s,c,g),new An(s,this.wrap,s,c+1,g),new An(s,this.wrap,s,c,g+1),new An(s,this.wrap,s,c+1,g+1)]}isLessThan(n){return this.wrap<n.wrap||!(this.wrap>n.wrap)&&(this.overscaledZ<n.overscaledZ||!(this.overscaledZ>n.overscaledZ)&&(this.canonical.x<n.canonical.x||!(this.canonical.x>n.canonical.x)&&this.canonical.y<n.canonical.y))}wrapped(){return new An(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(n){return new An(this.overscaledZ,n,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new Dn(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function Bn(u,n,s,c,g){const f=1<<Math.min(s,22);let _=f*(g%f)+c%f;return u&&s<22&&(_+=f*f*((u<0?-2*u-1:2*u)%(1<<2*(22-s)))),16*(32*_+s)+(n-s)}const br=[u=>{let n=u.canonical.x-1,s=u.wrap;return n<0&&(n=(1<<u.canonical.z)-1,s--),new An(u.overscaledZ,s,u.canonical.z,n,u.canonical.y)},u=>{let n=u.canonical.x+1,s=u.wrap;return n===1<<u.canonical.z&&(n=0,s++),new An(u.overscaledZ,s,u.canonical.z,n,u.canonical.y)},u=>new An(u.overscaledZ,u.wrap,u.canonical.z,u.canonical.x,(u.canonical.y===0?1<<u.canonical.z:u.canonical.y)-1),u=>new An(u.overscaledZ,u.wrap,u.canonical.z,u.canonical.x,u.canonical.y===(1<<u.canonical.z)-1?0:u.canonical.y+1)];Gn(Rn,"CanonicalTileID"),Gn(An,"OverscaledTileID",{omit:["projMatrix","expandedProjMatrix"]});const ir=ti([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:rr}=ir,wr=ti([{name:"a_pos_3",components:3,type:"Int16"}]);var Gr=ti([{name:"a_pos",type:"Int16",components:2}]);class Or{constructor(n,s){this.pos=n,this.dir=s}intersectsPlane(n,s,c){const g=Ne.vec3.dot(s,this.dir);if(Math.abs(g)<1e-6)return!1;const f=((n[0]-this.pos[0])*s[0]+(n[1]-this.pos[1])*s[1]+(n[2]-this.pos[2])*s[2])/g;return c[0]=this.pos[0]+this.dir[0]*f,c[1]=this.pos[1]+this.dir[1]*f,c[2]=this.pos[2]+this.dir[2]*f,!0}closestPointOnSphere(n,s,c){if(Ne.vec3.equals(this.pos,n)||s===0)return c[0]=c[1]=c[2]=0,!1;const[g,f,_]=this.dir,T=this.pos[0]-n[0],A=this.pos[1]-n[1],D=this.pos[2]-n[2],w=g*g+f*f+_*_,k=2*(T*g+A*f+D*_),O=k*k-4*w*(T*T+A*A+D*D-s*s);if(O<0){const I=Math.max(-k/2,0),R=T+g*I,B=A+f*I,W=D+_*I,K=Math.hypot(R,B,W);return c[0]=R*s/K,c[1]=B*s/K,c[2]=W*s/K,!1}{const I=(-k-Math.sqrt(O))/(2*w);if(I<0){const R=Math.hypot(T,A,D);return c[0]=T*s/R,c[1]=A*s/R,c[2]=D*s/R,!1}return c[0]=T+g*I,c[1]=A+f*I,c[2]=D+_*I,!0}}}class Ui{constructor(n,s,c,g,f){this.TL=n,this.TR=s,this.BR=c,this.BL=g,this.horizon=f}static fromInvProjectionMatrix(n,s,c){const g=[-1,1,1],f=[1,1,1],_=[1,-1,1],T=[-1,-1,1],A=Ne.vec3.transformMat4(g,g,n),D=Ne.vec3.transformMat4(f,f,n),w=Ne.vec3.transformMat4(_,_,n),k=Ne.vec3.transformMat4(T,T,n);return new Ui(A,D,w,k,s/c)}}function ki(u,n,s){let c=1/0,g=-1/0;const f=[];for(const _ of u){Ne.vec3.sub(f,_,n);const T=Ne.vec3.dot(f,s);c=Math.min(c,T),g=Math.max(g,T)}return[c,g]}function li(u,n){let s=!0;for(let c=0;c<u.planes.length;c++){const g=u.planes[c];let f=0;for(let _=0;_<n.length;_++)f+=Ne.vec3.dot(g,n[_])+g[3]>=0;if(f===0)return 0;f!==n.length&&(s=!1)}return s?2:1}function mi(u,n){for(const s of u.projections){const c=ki(n,u.points[0],s.axis);if(s.projection[1]<c[0]||s.projection[0]>c[1])return 0}return 1}function Lr(u,n){let s=0;const c=[0,0,0,0];for(let g=0;g<u.length;g++)c[0]=u[g][0],c[1]=u[g][1],c[2]=u[g][2],c[3]=1,Ne.vec4.dot(c,n)>=0&&s++;return s}class Kr{constructor(n,s){this.points=n||new Array(8).fill([0,0,0]),this.planes=s||new Array(6).fill([0,0,0,0]),this.bounds=fr.fromPoints(this.points),this.projections=[],this.frustumEdges=[Ne.vec3.sub([],this.points[2],this.points[3]),Ne.vec3.sub([],this.points[0],this.points[3]),Ne.vec3.sub([],this.points[4],this.points[0]),Ne.vec3.sub([],this.points[5],this.points[1]),Ne.vec3.sub([],this.points[6],this.points[2]),Ne.vec3.sub([],this.points[7],this.points[3])];for(const c of this.frustumEdges){const g=[0,-c[2],c[1]],f=[c[2],0,-c[0]];this.projections.push({axis:g,projection:ki(this.points,this.points[0],g)}),this.projections.push({axis:f,projection:ki(this.points,this.points[0],f)})}}static fromInvProjectionMatrix(n,s,c,g){const f=Math.pow(2,c),_=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(D=>{const w=Ne.vec4.transformMat4([],D,n),k=1/w[3]/s*f;return Ne.vec4.mul(w,w,[k,k,g?1/w[3]:k,k])}),T=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(D=>{const w=Ne.vec3.sub([],_[D[0]],_[D[1]]),k=Ne.vec3.sub([],_[D[2]],_[D[1]]),O=Ne.vec3.normalize([],Ne.vec3.cross([],w,k)),I=-Ne.vec3.dot(O,_[D[1]]);return O.concat(I)}),A=[];for(let D=0;D<_.length;D++)A.push([_[D][0],_[D][1],_[D][2]]);return new Kr(A,T)}intersectsPrecise(n,s,c){for(let g=0;g<s.length;g++)if(!Lr(n,s[g]))return 0;for(let g=0;g<this.planes.length;g++)if(!Lr(n,this.planes[g]))return 0;for(const g of c)for(const f of this.frustumEdges){const _=Ne.vec3.cross([],g,f),T=Ne.vec3.length(_);if(T===0)continue;Ne.vec3.scale(_,_,1/T);const A=ki(this.points,this.points[0],_),D=ki(n,this.points[0],_);if(A[0]>D[1]||D[0]>A[1])return 0}return 1}containsPoint(n){for(const s of this.planes){const c=s[3];if(Ne.vec3.dot([s[0],s[1],s[2]],n)+c<0)return!1}return!0}}class fr{static fromPoints(n){const s=[1/0,1/0,1/0],c=[-1/0,-1/0,-1/0];for(const g of n)Ne.vec3.min(s,s,g),Ne.vec3.max(c,c,g);return new fr(s,c)}static fromTileIdAndHeight(n,s,c){const g=1<<n.canonical.z,f=n.canonical.x,_=n.canonical.y;return new fr([f/g,_/g,s],[(f+1)/g,(_+1)/g,c])}static applyTransform(n,s){const c=n.getCorners();for(let g=0;g<c.length;++g)Ne.vec3.transformMat4(c[g],c[g],s);return fr.fromPoints(c)}static applyTransformFast(n,s){const c=[s[12],s[13],s[14]],g=[...c];for(let f=0;f<3;f++)for(let _=0;_<3;_++){const T=s[4*_+f],A=T*n.min[_],D=T*n.max[_];c[f]+=Math.min(A,D),g[f]+=Math.max(A,D)}return new fr(c,g)}static projectAabbCorners(n,s){const c=n.getCorners();for(let g=0;g<c.length;++g)Ne.vec3.transformMat4(c[g],c[g],s);return c}constructor(n,s){this.min=n,this.max=s,this.center=Ne.vec3.scale([],Ne.vec3.add([],this.min,this.max),.5)}quadrant(n){const s=[n%2==0,n<2],c=Ne.vec3.clone(this.min),g=Ne.vec3.clone(this.max);for(let f=0;f<s.length;f++)c[f]=s[f]?this.min[f]:this.center[f],g[f]=s[f]?this.center[f]:this.max[f];return g[2]=this.max[2],new fr(c,g)}distanceX(n){return Math.max(Math.min(this.max[0],n[0]),this.min[0])-n[0]}distanceY(n){return Math.max(Math.min(this.max[1],n[1]),this.min[1])-n[1]}distanceZ(n){return Math.max(Math.min(this.max[2],n[2]),this.min[2])-n[2]}getCorners(){const n=this.min,s=this.max;return[[n[0],n[1],n[2]],[s[0],n[1],n[2]],[s[0],s[1],n[2]],[n[0],s[1],n[2]],[n[0],n[1],s[2]],[s[0],n[1],s[2]],[s[0],s[1],s[2]],[n[0],s[1],s[2]]]}intersects(n){return this.intersectsAabb(n.bounds)?li(n,this.getCorners()):0}intersectsFlat(n){return this.intersectsAabb(n.bounds)?li(n,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsPrecise(n,s){return s||this.intersects(n)?mi(n,this.getCorners()):0}intersectsPreciseFlat(n,s){return s||this.intersectsFlat(n)?mi(n,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsAabb(n){for(let s=0;s<3;++s)if(this.min[s]>n.max[s]||n.min[s]>this.max[s])return!1;return!0}intersectsAabbXY(n){return!(this.min[0]>n.max[0]||n.min[0]>this.max[0]||this.min[1]>n.max[1]||n.min[1]>this.max[1])}encapsulate(n){for(let s=0;s<3;s++)this.min[s]=Math.min(this.min[s],n.min[s]),this.max[s]=Math.max(this.max[s],n.max[s])}encapsulatePoint(n){for(let s=0;s<3;s++)this.min[s]=Math.min(this.min[s],n[s]),this.max[s]=Math.max(this.max[s],n[s])}closestPoint(n){return[Math.max(Math.min(this.max[0],n[0]),this.min[0]),Math.max(Math.min(this.max[1],n[1]),this.min[1]),Math.max(Math.min(this.max[2],n[2]),this.min[2])]}}function ni(u){return u*Ko/gd}Gn(fr,"Aabb");const Ki=[new fr([ma,ma,ma],[ga,ga,ga]),new fr([ma,ma,ma],[0,0,ga]),new fr([0,ma,ma],[ga,0,ga]),new fr([ma,0,ma],[0,ga,ga]),new fr([0,0,ma],[ga,ga,ga])];function Do(u,n,s,c=!0){const g=Ne.vec3.scale([],u._camera.position,u.worldSize),f=[n,s,1,1];Ne.vec4.transformMat4(f,f,u.pixelMatrixInverse),Ne.vec4.scale(f,f,1/f[3]);const _=Ne.vec3.sub([],f,g),T=Ne.vec3.normalize([],_),A=u.globeMatrix,D=[A[12],A[13],A[14]],w=Ne.vec3.sub([],D,g),k=Ne.vec3.length(w),O=Ne.vec3.normalize([],w),I=u.worldSize/(2*Math.PI),R=Ne.vec3.dot(O,T),B=Math.asin(I/k);if(B<Math.acos(R)){if(!c)return null;const nt=[],$e=[];Ne.vec3.scale(nt,T,k/R),Ne.vec3.normalize($e,Ne.vec3.sub($e,nt,w)),Ne.vec3.normalize(T,Ne.vec3.add(T,w,Ne.vec3.scale(T,$e,Math.tan(B)*k)))}const W=[];new Or(g,T).closestPointOnSphere(D,I,W);const K=Ne.vec3.normalize([],pi(A,0)),ie=Ne.vec3.normalize([],pi(A,1)),oe=Ne.vec3.normalize([],pi(A,2)),Q=Ne.vec3.dot(K,W),ue=Ne.vec3.dot(ie,W),ge=Ne.vec3.dot(oe,W),Se=Dt(Math.asin(-ue/I));let Fe=Dt(Math.atan2(Q,ge));Fe=u.center.lng+function(nt,$e){const it=($e-nt+180)%360-180;return it<-180?it+360:it}(u.center.lng,Fe);const ze=Su(Fe),Le=Et(Rl(Se),0,1);return new v(ze,Le)}class Rs{constructor(n,s,c){this.a=Ne.vec3.sub([],n,c),this.b=Ne.vec3.sub([],s,c),this.center=c;const g=Ne.vec3.normalize([],this.a),f=Ne.vec3.normalize([],this.b);this.angle=Math.acos(Ne.vec3.dot(g,f))}}function Zo(u,n){if(u.angle===0)return null;let s;return s=u.a[n]===0?1/u.angle*.5*Math.PI:1/u.angle*Math.atan(u.b[n]/u.a[n]/Math.sin(u.angle)-1/Math.tan(u.angle)),s<0||s>1?null:function(c,g,f,_){const T=Math.sin(f);return c*(Math.sin((1-_)*f)/T)+g*(Math.sin(_*f)/T)}(u.a[n],u.b[n],u.angle,Et(s,0,1))+u.center[n]}function Io(u){if(u.z<=1)return Ki[u.z+2*u.y+u.x];const n=Zr(Ci(u));return fr.fromPoints(n)}function ho(u,n,s){return Ne.vec3.scale(u,u,1-s),Ne.vec3.scaleAndAdd(u,u,n,s)}function to(u,n,s){for(const c of u)Ne.vec3.transformMat4(c,c,n),Ne.vec3.scale(c,c,s)}function Ni(u,n,s,c){const g=n/u.worldSize,f=u.globeMatrix;if(s.z<=1){const ze=Io(s).getCorners();return to(ze,f,g),fr.fromPoints(ze)}const _=Ci(s,c),T=Zr(_,Ko+ni(u._tileCoverLift));to(T,f,g);const A=Number.MAX_VALUE,D=[-A,-A,-A],w=[A,A,A];if(_.contains(u.center)){for(const nt of T)Ne.vec3.min(w,w,nt),Ne.vec3.max(D,D,nt);D[2]=0;const ze=u.point,Le=[ze.x*g,ze.y*g,0];return Ne.vec3.min(w,w,Le),Ne.vec3.max(D,D,Le),new fr(w,D)}if(u._tileCoverLift>0){for(const ze of T)Ne.vec3.min(w,w,ze),Ne.vec3.max(D,D,ze);return new fr(w,D)}const k=[f[12]*g,f[13]*g,f[14]*g],O=_.getCenter(),I=Et(u.center.lat,-85.051129,Ps),R=Et(O.lat,-85.051129,Ps),B=Su(u.center.lng),W=Rl(I);let K=B-Su(O.lng);const ie=W-Rl(R);K>.5?K-=1:K<-.5&&(K+=1);let oe=0;if(Math.abs(K)>Math.abs(ie))oe=K>=0?1:3;else{oe=ie>=0?0:2;const ze=[f[4]*g,f[5]*g,f[6]*g],Le=-Math.sin(Pt(ie>=0?_.getSouth():_.getNorth()))*Ko;Ne.vec3.scaleAndAdd(k,k,ze,Le)}const Q=T[oe],ue=T[(oe+1)%4],ge=new Rs(Q,ue,k),Se=[Zo(ge,0)||Q[0],Zo(ge,1)||Q[1],Zo(ge,2)||Q[2]],Fe=Yo(u.zoom);if(Fe>0){const ze=function({x:nt,y:$e,z:it},dt,ct,mt,wt){const Mt=1/(1<<it);let vt=nt*Mt,qt=vt+Mt,mn=$e*Mt,Zt=mn+Mt,Tn=0;const Sn=(vt+qt)/2-mt;return Sn>.5?Tn=-1:Sn<-.5&&(Tn=1),vt=((vt+Tn)*dt-(mt*=dt))*ct+mt,qt=((qt+Tn)*dt-mt)*ct+mt,mn=(mn*dt-(wt*=dt))*ct+wt,Zt=(Zt*dt-wt)*ct+wt,[[vt,Zt,0],[qt,Zt,0],[qt,mn,0],[vt,mn,0]]}(s,n,u._pixelsPerMercatorPixel,B,W);for(let nt=0;nt<T.length;nt++)ho(T[nt],ze[nt],Fe);const Le=Ne.vec3.add([],ze[oe],ze[(oe+1)%4]);Ne.vec3.scale(Le,Le,.5),ho(Se,Le,Fe)}for(const ze of T)Ne.vec3.min(w,w,ze),Ne.vec3.max(D,D,ze);return w[2]=Math.min(Q[2],ue[2]),Ne.vec3.min(w,w,Se),Ne.vec3.max(D,D,Se),new fr(w,D)}function Ci({x:u,y:n,z:s},c=!1){const g=1/(1<<s),f=new Qr(ks(u*g),n===(1<<s)-1&&c?-90:Fo((n+1)*g)),_=new Qr(ks((u+1)*g),n===0&&c?90:Fo(n*g));return new wu(f,_)}function Zr(u,n=Ko){const s=Pt(u.getNorth()),c=Pt(u.getSouth()),g=Math.cos(s),f=Math.cos(c),_=Math.sin(s),T=Math.sin(c),A=u.getWest(),D=u.getEast();return[fc(f,T,A,n),fc(f,T,D,n),fc(g,_,D,n),fc(g,_,A,n)]}function Xi(u,n,s,c){const g=1<<s.z,f=(u/kn+s.x)/g;return hc(Fo((n/kn+s.y)/g),ks(f),c)}function Ao({min:u,max:n}){return w0/Math.max(n[0]-u[0],n[1]-u[1],n[2]-u[2])}const Pi=new Float64Array(16);function jo(u){const n=Ao(u),s=Ne.mat4.fromScaling(Pi,[n,n,n]);return Ne.mat4.translate(s,s,Ne.vec3.negate([],u.min))}function js(u){const n=Ne.mat4.fromTranslation(Pi,u.min),s=1/Ao(u);return Ne.mat4.scale(n,n,[s,s,s])}function hs(u){const n=kn/(2*Math.PI);return u/(2*Math.PI)/n}function Ol(u,n){return kn/(512*Math.pow(2,u))*Ao(Io(n))}function Qa(u,n,s,c,g){const f=hs(s),_=[u,n,-s/(2*Math.PI)],T=Ne.mat4.identity(new Float64Array(16));return Ne.mat4.translate(T,T,_),Ne.mat4.scale(T,T,[f,f,f]),Ne.mat4.rotateX(T,T,Pt(-g)),Ne.mat4.rotateY(T,T,Pt(-c)),T}function Yo(u){return En(l_,u_,u)}function Hs(u,n){const s=hc(n.lat,n.lng),c=function(f){const _=hc(f._center.lat,f._center.lng),T=Ne.vec3.fromValues(0,1,0);let A=Ne.vec3.cross([],T,_);const D=Ne.mat4.fromRotation([],-f.angle,_);A=Ne.vec3.transformMat4(A,A,D),Ne.mat4.fromRotation(D,-f._pitch,A);const w=Ne.vec3.normalize([],_);return Ne.vec3.scale(w,w,ni(f.cameraToCenterDistance/f.pixelsPerMeter)),Ne.vec3.transformMat4(w,w,D),Ne.vec3.add([],_,w)}(u),g=Ne.vec3.subtract([],c,s);return Ne.vec3.angle(g,s)}function Ll(u,n){return Hs(u,n)>Math.PI/2*1.01}const za=Pt(85),pc=Math.cos(za),jf=Math.sin(za),p_=Ne.mat4.create(),Vp=u=>{const n=[];return u.paint.get("circle-pitch-alignment")==="map"&&n.push("PITCH_WITH_MAP"),u.paint.get("circle-pitch-scale")==="map"&&n.push("SCALE_WITH_MAP"),n};function MM(u,n,s,c,g,f,_,T,A){if(f&&u.queryGeometry.isAboveHorizon)return!1;f&&(A*=u.pixelToTileUnitsFactor);const D=u.tileID.canonical,w=s.projection.upVectorScale(D,s.center.lat,s.worldSize).metersToTile;for(const k of n)for(const O of k){const I=O.add(T),R=g&&s.elevation?s.elevation.exaggeration()*g.getElevationAt(I.x,I.y,!0):0,B=s.projection.projectTilePoint(I.x,I.y,D);if(R>0){const oe=s.projection.upVector(D,I.x,I.y);B.x+=oe[0]*w*R,B.y+=oe[1]*w*R,B.z+=oe[2]*w*R}const W=f?I:WB(B.x,B.y,B.z,c),K=f?u.tilespaceRays.map(oe=>KB(oe,R)):u.queryGeometry.screenGeometry,ie=Ne.vec4.transformMat4([],[B.x,B.y,B.z,1],c);if(!_&&f?A*=ie[3]/s.cameraToCenterDistance:_&&!f&&(A*=s.cameraToCenterDistance/ie[3]),f){const oe=Fo((O.y/kn+D.y)/(1<<D.z));A/=s.projection.pixelsPerMeter(oe,1)/os(1,oe)}if(Re(K,W,A))return!0}return!1}function WB(u,n,s,c){const g=Ne.vec4.transformMat4([],[u,n,s,1],c);return new Je(g[0]/g[3],g[1]/g[3])}const IM=Ne.vec3.fromValues(0,0,0),qB=Ne.vec3.fromValues(0,0,1);function KB(u,n){const s=Ne.vec3.create();return IM[2]=n,u.intersectsPlane(IM,qB,s),new Je(s[0],s[1])}class AM extends Te{}let kM,PM,RM,OM;function LM(u,{width:n,height:s},c,g){if(g){if(g instanceof Uint8ClampedArray)g=new Uint8Array(g.buffer);else if(g.length!==n*s*c)throw new RangeError("mismatched image size")}else g=new Uint8Array(n*s*c);return u.width=n,u.height=s,u.data=g,u}function DM(u,n,s){const{width:c,height:g}=n;c===u.width&&g===u.height||(Sw(u,n,{x:0,y:0},{x:0,y:0},{width:Math.min(u.width,c),height:Math.min(u.height,g)},s,null),u.width=c,u.height=g,u.data=n.data)}function Sw(u,n,s,c,g,f,_,T){if(g.width===0||g.height===0)return n;if(g.width>u.width||g.height>u.height||s.x>u.width-g.width||s.y>u.height-g.height)throw new RangeError("out of range source coordinates for image copy");if(g.width>n.width||g.height>n.height||c.x>n.width-g.width||c.y>n.height-g.height)throw new RangeError("out of range destination coordinates for image copy");const A=u.data,D=n.data,w=f===4&&T;for(let k=0;k<g.height;k++){const O=((s.y+k)*u.width+s.x)*f,I=((c.y+k)*n.width+c.x)*f;if(w)for(let R=0;R<g.width;R++){const B=O+R*f+3,W=I+R*f;D[W+0]=255,D[W+1]=255,D[W+2]=255,D[W+3]=A[B]}else if(_)for(let R=0;R<g.width;R++){const B=O+R*f,W=I+R*f,K=A[B+3],ie=new Jr(A[B+0]/255*K,A[B+1]/255*K,A[B+2]/255*K,K).toRenderColor(_).toArray();D[W+0]=ie[0],D[W+1]=ie[1],D[W+2]=ie[2],D[W+3]=ie[3]}else for(let R=0;R<g.width*f;R++)D[I+R]=A[O+R]}return n}Gn(AM,"HeatmapBucket",{omit:["layers"]});class _d{constructor(n,s){LM(this,n,1,s)}resize(n){DM(this,new _d(n),1)}clone(){return new _d({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(n,s,c,g,f){Sw(n,s,c,g,f,1,null)}}class ss{constructor(n,s){LM(this,n,4,s)}resize(n){DM(this,new ss(n),4)}replace(n,s){s?this.data.set(n):this.data=n instanceof Uint8ClampedArray?new Uint8Array(n.buffer):n}clone(){return new ss({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(n,s,c,g,f,_,T){Sw(n,s,c,g,f,4,_,T)}}class zM{constructor(n,s){this.width=n.width,this.height=n.height,this.data=s instanceof Uint8Array?new Float32Array(s.buffer):s}}function m_(u){const n={},s=u.resolution||256,c=u.clips?u.clips.length:1,g=u.image||new ss({width:s,height:c}),f=(_,T,A)=>{n[u.evaluationKey]=A;const D=u.expression.evaluate(n);D&&(g.data[_+T+0]=Math.floor(255*D.r/D.a),g.data[_+T+1]=Math.floor(255*D.g/D.a),g.data[_+T+2]=Math.floor(255*D.b/D.a),g.data[_+T+3]=Math.floor(255*D.a))};if(u.clips)for(let _=0,T=0;_<c;++_,T+=4*s)for(let A=0,D=0;A<s;A++,D+=4){const w=A/(s-1),{start:k,end:O}=u.clips[_];f(T,D,k*(1-w)+O*w)}else for(let _=0,T=0;_<s;_++,T+=4)f(0,T,_/(s-1));return g}Gn(_d,"AlphaImage"),Gn(ss,"RGBAImage");const ZB=ti([{name:"a_pos",components:2,type:"Int16"}],4),{members:YB}=ZB;function g_(u,n,s=2){const c=n&&n.length,g=c?n[0]*s:u.length;let f=FM(u,0,g,s,!0);const _=[];if(!f||f.next===f.prev)return _;let T,A,D;if(c&&(f=function(w,k,O,I){const R=[];for(let B=0,W=k.length;B<W;B++){const K=FM(w,k[B]*I,B<W-1?k[B+1]*I:w.length,I,!1);K===K.next&&(K.steiner=!0),R.push(i5(K))}R.sort(t5);for(let B=0;B<R.length;B++)O=n5(R[B],O);return O}(u,n,f,s)),u.length>80*s){T=1/0,A=1/0;let w=-1/0,k=-1/0;for(let O=s;O<g;O+=s){const I=u[O],R=u[O+1];I<T&&(T=I),R<A&&(A=R),I>w&&(w=I),R>k&&(k=R)}D=Math.max(w-T,k-A),D=D!==0?32767/D:0}return __(f,_,s,T,A,D,0),_}function FM(u,n,s,c,g){let f;if(g===function(_,T,A,D){let w=0;for(let k=T,O=A-D;k<A;k+=D)w+=(_[O]-_[k])*(_[k+1]+_[O+1]),O=k;return w}(u,n,s,c)>0)for(let _=n;_<s;_+=c)f=VM(_/c|0,u[_],u[_+1],f);else for(let _=s-c;_>=n;_-=c)f=VM(_/c|0,u[_],u[_+1],f);return f&&T0(f,f.next)&&(v_(f),f=f.next),f}function Hf(u,n){if(!u)return u;n||(n=u);let s,c=u;do if(s=!1,c.steiner||!T0(c,c.next)&&ko(c.prev,c,c.next)!==0)c=c.next;else{if(v_(c),c=n=c.prev,c===c.next)break;s=!0}while(s||c!==n);return n}function __(u,n,s,c,g,f,_){if(!u)return;!_&&f&&function(A,D,w,k){let O=A;do O.z===0&&(O.z=Tw(O.x,O.y,D,w,k)),O.prevZ=O.prev,O.nextZ=O.next,O=O.next;while(O!==A);O.prevZ.nextZ=null,O.prevZ=null,function(I){let R,B=1;do{let W,K=I;I=null;let ie=null;for(R=0;K;){R++;let oe=K,Q=0;for(let ge=0;ge<B&&(Q++,oe=oe.nextZ,oe);ge++);let ue=B;for(;Q>0||ue>0&&oe;)Q!==0&&(ue===0||!oe||K.z<=oe.z)?(W=K,K=K.nextZ,Q--):(W=oe,oe=oe.nextZ,ue--),ie?ie.nextZ=W:I=W,W.prevZ=ie,ie=W;K=oe}ie.nextZ=null,B*=2}while(R>1)}(O)}(u,c,g,f);let T=u;for(;u.prev!==u.next;){const A=u.prev,D=u.next;if(f?JB(u,c,g,f):XB(u))n.push(A.i,u.i,D.i),v_(u),u=D.next,T=D.next;else if((u=D)===T){_?_===1?__(u=QB(Hf(u),n),n,s,c,g,f,2):_===2&&e5(u,n,s,c,g,f):__(Hf(u),n,s,c,g,f,1);break}}}function XB(u){const n=u.prev,s=u,c=u.next;if(ko(n,s,c)>=0)return!1;const g=n.x,f=s.x,_=c.x,T=n.y,A=s.y,D=c.y,w=g<f?g<_?g:_:f<_?f:_,k=T<A?T<D?T:D:A<D?A:D,O=g>f?g>_?g:_:f>_?f:_,I=T>A?T>D?T:D:A>D?A:D;let R=c.next;for(;R!==n;){if(R.x>=w&&R.x<=O&&R.y>=k&&R.y<=I&&$p(g,T,f,A,_,D,R.x,R.y)&&ko(R.prev,R,R.next)>=0)return!1;R=R.next}return!0}function JB(u,n,s,c){const g=u.prev,f=u,_=u.next;if(ko(g,f,_)>=0)return!1;const T=g.x,A=f.x,D=_.x,w=g.y,k=f.y,O=_.y,I=T<A?T<D?T:D:A<D?A:D,R=w<k?w<O?w:O:k<O?k:O,B=T>A?T>D?T:D:A>D?A:D,W=w>k?w>O?w:O:k>O?k:O,K=Tw(I,R,n,s,c),ie=Tw(B,W,n,s,c);let oe=u.prevZ,Q=u.nextZ;for(;oe&&oe.z>=K&&Q&&Q.z<=ie;){if(oe.x>=I&&oe.x<=B&&oe.y>=R&&oe.y<=W&&oe!==g&&oe!==_&&$p(T,w,A,k,D,O,oe.x,oe.y)&&ko(oe.prev,oe,oe.next)>=0||(oe=oe.prevZ,Q.x>=I&&Q.x<=B&&Q.y>=R&&Q.y<=W&&Q!==g&&Q!==_&&$p(T,w,A,k,D,O,Q.x,Q.y)&&ko(Q.prev,Q,Q.next)>=0))return!1;Q=Q.nextZ}for(;oe&&oe.z>=K;){if(oe.x>=I&&oe.x<=B&&oe.y>=R&&oe.y<=W&&oe!==g&&oe!==_&&$p(T,w,A,k,D,O,oe.x,oe.y)&&ko(oe.prev,oe,oe.next)>=0)return!1;oe=oe.prevZ}for(;Q&&Q.z<=ie;){if(Q.x>=I&&Q.x<=B&&Q.y>=R&&Q.y<=W&&Q!==g&&Q!==_&&$p(T,w,A,k,D,O,Q.x,Q.y)&&ko(Q.prev,Q,Q.next)>=0)return!1;Q=Q.nextZ}return!0}function QB(u,n){let s=u;do{const c=s.prev,g=s.next.next;!T0(c,g)&&NM(c,s,s.next,g)&&y_(c,g)&&y_(g,c)&&(n.push(c.i,s.i,g.i),v_(s),v_(s.next),s=u=g),s=s.next}while(s!==u);return Hf(s)}function e5(u,n,s,c,g,f){let _=u;do{let T=_.next.next;for(;T!==_.prev;){if(_.i!==T.i&&o5(_,T)){let A=BM(_,T);return _=Hf(_,_.next),A=Hf(A,A.next),__(_,n,s,c,g,f,0),void __(A,n,s,c,g,f,0)}T=T.next}_=_.next}while(_!==u)}function t5(u,n){return u.x-n.x}function n5(u,n){const s=function(g,f){let _=f;const T=g.x,A=g.y;let D,w=-1/0;do{if(A<=_.y&&A>=_.next.y&&_.next.y!==_.y){const B=_.x+(A-_.y)*(_.next.x-_.x)/(_.next.y-_.y);if(B<=T&&B>w&&(w=B,D=_.x<_.next.x?_:_.next,B===T))return D}_=_.next}while(_!==f);if(!D)return null;const k=D,O=D.x,I=D.y;let R=1/0;_=D;do{if(T>=_.x&&_.x>=O&&T!==_.x&&$p(A<I?T:w,A,O,I,A<I?w:T,A,_.x,_.y)){const B=Math.abs(A-_.y)/(T-_.x);y_(_,g)&&(B<R||B===R&&(_.x>D.x||_.x===D.x&&r5(D,_)))&&(D=_,R=B)}_=_.next}while(_!==k);return D}(u,n);if(!s)return n;const c=BM(s,u);return Hf(c,c.next),Hf(s,s.next)}function r5(u,n){return ko(u.prev,u,n.prev)<0&&ko(n.next,u,u.next)<0}function Tw(u,n,s,c,g){return(u=1431655765&((u=858993459&((u=252645135&((u=16711935&((u=(u-s)*g|0)|u<<8))|u<<4))|u<<2))|u<<1))|(n=1431655765&((n=858993459&((n=252645135&((n=16711935&((n=(n-c)*g|0)|n<<8))|n<<4))|n<<2))|n<<1))<<1}function i5(u){let n=u,s=u;do(n.x<s.x||n.x===s.x&&n.y<s.y)&&(s=n),n=n.next;while(n!==u);return s}function $p(u,n,s,c,g,f,_,T){return(g-_)*(n-T)>=(u-_)*(f-T)&&(u-_)*(c-T)>=(s-_)*(n-T)&&(s-_)*(f-T)>=(g-_)*(c-T)}function o5(u,n){return u.next.i!==n.i&&u.prev.i!==n.i&&!function(s,c){let g=s;do{if(g.i!==s.i&&g.next.i!==s.i&&g.i!==c.i&&g.next.i!==c.i&&NM(g,g.next,s,c))return!0;g=g.next}while(g!==s);return!1}(u,n)&&(y_(u,n)&&y_(n,u)&&function(s,c){let g=s,f=!1;const _=(s.x+c.x)/2,T=(s.y+c.y)/2;do g.y>T!=g.next.y>T&&g.next.y!==g.y&&_<(g.next.x-g.x)*(T-g.y)/(g.next.y-g.y)+g.x&&(f=!f),g=g.next;while(g!==s);return f}(u,n)&&(ko(u.prev,u,n.prev)||ko(u,n.prev,n))||T0(u,n)&&ko(u.prev,u,u.next)>0&&ko(n.prev,n,n.next)>0)}function ko(u,n,s){return(n.y-u.y)*(s.x-n.x)-(n.x-u.x)*(s.y-n.y)}function T0(u,n){return u.x===n.x&&u.y===n.y}function NM(u,n,s,c){const g=E0(ko(u,n,s)),f=E0(ko(u,n,c)),_=E0(ko(s,c,u)),T=E0(ko(s,c,n));return g!==f&&_!==T||!(g!==0||!C0(u,s,n))||!(f!==0||!C0(u,c,n))||!(_!==0||!C0(s,u,c))||!(T!==0||!C0(s,n,c))}function C0(u,n,s){return n.x<=Math.max(u.x,s.x)&&n.x>=Math.min(u.x,s.x)&&n.y<=Math.max(u.y,s.y)&&n.y>=Math.min(u.y,s.y)}function E0(u){return u>0?1:u<0?-1:0}function y_(u,n){return ko(u.prev,u,u.next)<0?ko(u,n,u.next)>=0&&ko(u,u.prev,n)>=0:ko(u,n,u.prev)<0||ko(u,u.next,n)<0}function BM(u,n){const s=Cw(u.i,u.x,u.y),c=Cw(n.i,n.x,n.y),g=u.next,f=n.prev;return u.next=n,n.prev=u,s.next=g,g.prev=s,c.next=s,s.prev=c,f.next=c,c.prev=f,c}function VM(u,n,s,c){const g=Cw(u,n,s);return c?(g.next=c.next,g.prev=c,c.next.prev=g,c.next=g):(g.prev=g,g.next=g),g}function v_(u){u.next.prev=u.prev,u.prev.next=u.next,u.prevZ&&(u.prevZ.nextZ=u.nextZ),u.nextZ&&(u.nextZ.prevZ=u.prevZ)}function Cw(u,n,s){return{i:u,x:n,y:s,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function M0(u,n){const s=u.length;if(s<=1)return[u];const c=[];let g,f;for(let _=0;_<s;_++){const T=yi(u[_]);T!==0&&(u[_].area=Math.abs(T),f===void 0&&(f=T<0),f===T<0?(g&&c.push(g),g=[u[_]]):g.push(u[_]))}if(g&&c.push(g),n>1)for(let _=0;_<c.length;_++)c[_].length<=n||(Cv(c[_],n,1,c[_].length-1,s5),c[_]=c[_].slice(0,n));return c}function s5(u,n){return n.area-u.area}function $M(u,n){if(!u)return null;const s=typeof u=="string"?u:u.getPrimary().id;n[s]||(n[s]=[]);const c=Lo.from(u).getPrimary();return n[s].push(c),c.serialize()}function Ew(u,n,s){const c=s.patternDependencies;let g=!1;for(const f of n){const _=f.paint.get(`${u}-pattern`);_.isConstant()||(g=!0),$M(_.constantOr(null),c)&&(g=!0)}return g}function Mw(u,n,s,c,g){const f=g.patternDependencies;for(const _ of n){const T=_.paint.get(`${u}-pattern`).value;if(T.kind!=="constant"){let A=T.evaluate({zoom:c},s,{},g.availableImages);A=A&&A.name?A.name:A;const D=$M(A,f);D&&(s.patterns[_.id]=D)}}return s}class Iw{constructor(n){this.zoom=n.zoom,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map(s=>s.fqid),this.index=n.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Il,this.indexArray=new Uo,this.indexArray2=new yu,this.programConfigurations=new xu(n.layers,{zoom:n.zoom,lut:n.lut}),this.segments=new Yi,this.segments2=new Yi,this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id),this.projection=n.projection}updateFootprints(n,s){}populate(n,s,c,g){this.hasPattern=Ew("fill",this.layers,s);const f=this.layers[0].layout.get("fill-sort-key"),_=[];for(const{feature:T,id:A,index:D,sourceLayerIndex:w}of n){const k=this.layers[0]._featureFilter.needGeometry,O=ne(T,k);if(!this.layers[0]._featureFilter.filter(new ji(this.zoom),O,c))continue;const I=f?f.evaluate(O,{},c,s.availableImages):void 0,R={id:A,properties:T.properties,type:T.type,sourceLayerIndex:w,index:D,geometry:k?O.geometry:Y(T,c,g),patterns:{},sortKey:I};_.push(R)}f&&_.sort((T,A)=>T.sortKey-A.sortKey);for(const T of _){const{geometry:A,index:D,sourceLayerIndex:w}=T;if(this.hasPattern){const k=Mw("fill",this.layers,T,this.zoom,s);this.patternFeatures.push(k)}else this.addFeature(T,A,D,c,{},s.availableImages,s.brightness);s.featureIndex.insert(n[D].feature,A,D,w,this.index)}}update(n,s,c,g,f,_,T){this.programConfigurations.updatePaintArrays(n,s,f,c,g,_,T)}addFeatures(n,s,c,g,f,_){for(const T of this.patternFeatures)this.addFeature(T,T.geometry,T.index,s,c,g,_)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(n){this.uploaded||(this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,YB),this.indexBuffer=n.createIndexBuffer(this.indexArray),this.indexBuffer2=n.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(n),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(n,s,c,g,f,_=[],T){for(const A of M0(s,500)){let D=0;for(const B of A)D+=B.length;const w=this.segments.prepareSegment(D,this.layoutVertexArray,this.indexArray),k=w.vertexLength,O=[],I=[];for(const B of A){if(B.length===0)continue;B!==A[0]&&I.push(O.length/2);const W=this.segments2.prepareSegment(B.length,this.layoutVertexArray,this.indexArray2),K=W.vertexLength;this.layoutVertexArray.emplaceBack(B[0].x,B[0].y),this.indexArray2.emplaceBack(K+B.length-1,K),O.push(B[0].x),O.push(B[0].y);for(let ie=1;ie<B.length;ie++)this.layoutVertexArray.emplaceBack(B[ie].x,B[ie].y),this.indexArray2.emplaceBack(K+ie-1,K+ie),O.push(B[ie].x),O.push(B[ie].y);W.vertexLength+=B.length,W.primitiveLength+=B.length}const R=g_(O,I);for(let B=0;B<R.length;B+=3)this.indexArray.emplaceBack(k+R[B],k+R[B+1],k+R[B+2]);w.vertexLength+=D,w.primitiveLength+=R.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,n,c,f,_,g,T)}}let UM,jM,HM,GM;Gn(Iw,"FillBucket",{omit:["layers","patternFeatures"]});class Aw{constructor(n,s,c,g){if(this.triangleCount=s.length/3,this.min=new Je(0,0),this.max=new Je(0,0),this.xScale=0,this.yScale=0,this.cellsX=0,this.cellsY=0,this.cells=[],this.payload=[],this.triangleCount===0||n.length===0)return;const[f,_]=[n[0].clone(),n[0].clone()];for(let k=1;k<n.length;++k){const O=n[k];f.x=Math.min(f.x,O.x),f.y=Math.min(f.y,O.y),_.x=Math.max(_.x,O.x),_.y=Math.max(_.y,O.y)}if(g){const k=Math.ceil(Math.max(_.x-f.x,_.y-f.y)/g);c=Math.max(c,k)}if(c===0)return;this.min=f,this.max=_;const T=this.max.sub(this.min);T.x=Math.max(T.x,1),T.y=Math.max(T.y,1);const A=Math.max(T.x,T.y)/c;this.cellsX=Math.max(1,Math.ceil(T.x/A)),this.cellsY=Math.max(1,Math.ceil(T.y/A)),this.xScale=1/A,this.yScale=1/A;const D=[];for(let k=0;k<this.triangleCount;k++){const O=n[s[3*k+0]].sub(this.min),I=n[s[3*k+1]].sub(this.min),R=n[s[3*k+2]].sub(this.min),B=Tu(Math.floor(Math.min(O.x,I.x,R.x)),this.xScale,this.cellsX),W=Tu(Math.floor(Math.max(O.x,I.x,R.x)),this.xScale,this.cellsX),K=Tu(Math.floor(Math.min(O.y,I.y,R.y)),this.yScale,this.cellsY),ie=Tu(Math.floor(Math.max(O.y,I.y,R.y)),this.yScale,this.cellsY),oe=new Je(0,0),Q=new Je(0,0),ue=new Je(0,0),ge=new Je(0,0);for(let Se=K;Se<=ie;++Se){oe.y=Q.y=Se*A,ue.y=ge.y=(Se+1)*A;for(let Fe=B;Fe<=W;++Fe)oe.x=ue.x=Fe*A,Q.x=ge.x=(Fe+1)*A,(St(O,I,R,oe,Q,ge)||St(O,I,R,oe,ge,ue))&&D.push({cellIdx:Se*this.cellsX+Fe,triIdx:k})}}if(D.length===0)return;D.sort((k,O)=>k.cellIdx-O.cellIdx||k.triIdx-O.triIdx);let w=0;for(;w<D.length;){const k=D[w].cellIdx,O={start:this.payload.length,len:0};for(;w<D.length&&D[w].cellIdx===k;)++O.len,this.payload.push(D[w++].triIdx);this.cells[k]=O}}_lazyInitLookup(){this.lookup||(this.lookup=new Uint8Array(Math.ceil(this.triangleCount/8))),this.lookup.fill(0)}queryPoint(n,s){if(this.triangleCount===0||this.cells.length===0||n.x>this.max.x||this.min.x>n.x||n.y>this.max.y||this.min.y>n.y)return;const c=Tu(n.x-this.min.x,this.xScale,this.cellsX),g=Tu(n.y-this.min.y,this.yScale,this.cellsY),f=this.cells[g*this.cellsX+c];if(f){this._lazyInitLookup();for(let _=0;_<f.len;_++){const T=this.payload[f.start+_],A=Math.floor(T/8),D=1<<T%8;if(!(this.lookup[A]&D)&&(this.lookup[A]|=D,s.push(T),s.length===this.triangleCount))return}}}query(n,s,c){if(this.triangleCount===0||this.cells.length===0||n.x>this.max.x||this.min.x>s.x||n.y>this.max.y||this.min.y>s.y)return;this._lazyInitLookup();const g=Tu(n.x-this.min.x,this.xScale,this.cellsX),f=Tu(s.x-this.min.x,this.xScale,this.cellsX),_=Tu(n.y-this.min.y,this.yScale,this.cellsY),T=Tu(s.y-this.min.y,this.yScale,this.cellsY);for(let A=_;A<=T;A++)for(let D=g;D<=f;D++){const w=this.cells[A*this.cellsX+D];if(w)for(let k=0;k<w.len;k++){const O=this.payload[w.start+k],I=Math.floor(O/8),R=1<<O%8;if(!(this.lookup[I]&R)&&(this.lookup[I]|=R,c.push(O),c.length===this.triangleCount))return}}}}function Tu(u,n,s){return Math.max(0,Math.min(s-1,Math.floor(u*n)))}Gn(Aw,"TriangleGridIndex");class WM{constructor(n){this.zoom=n.zoom,this.layers=n.layers,this.layerIds=this.layers.map(s=>s.fqid),this.index=n.index,this.hasPattern=!1,this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id),this.footprints=[]}updateFootprints(n,s){for(const c of this.footprints)s.push({footprint:c,id:n})}populate(n,s,c,g){const f=[];for(const{feature:_,id:T,index:A,sourceLayerIndex:D}of n){const w=this.layers[0]._featureFilter.needGeometry,k=ne(_,w);if(!this.layers[0]._featureFilter.filter(new ji(this.zoom),k,c))continue;const O={id:T,properties:_.properties,type:_.type,sourceLayerIndex:D,index:A,geometry:w?k.geometry:Y(_,c,g),patterns:{}};f.push(O)}for(const _ of f){const{geometry:T,index:A,sourceLayerIndex:D}=_;this.addFeature(_,T,A,c,{},s.availableImages,s.brightness),s.featureIndex.insert(n[A].feature,T,A,D,this.index)}}isEmpty(){return this.footprints.length===0}uploadPending(){return!1}upload(n){}update(n,s,c,g,f,_,T){}destroy(){}addFeature(n,s,c,g,f,_=[],T){for(const A of M0(s,2)){const D=[],w=[],k=[],O=new Je(1/0,1/0),I=new Je(-1/0,-1/0);for(const W of A)if(W.length!==0){W!==A[0]&&k.push(w.length/2);for(let K=0;K<W.length;K++)w.push(W[K].x),w.push(W[K].y),D.push(W[K]),O.x=Math.min(O.x,W[K].x),O.y=Math.min(O.y,W[K].y),I.x=Math.max(I.x,W[K].x),I.y=Math.max(I.y,W[K].y)}const R=g_(w,k),B=new Aw(D,R,8,256);this.footprints.push({vertices:D,indices:R,grid:B,min:O,max:I})}}}Gn(WM,"ClipBucket",{omit:["layers"]});const a5=ti([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),l5=ti([{name:"a_pos_end",components:4,type:"Int16"},{name:"a_angular_offset_factor",components:1,type:"Int16"}]),u5=ti([{name:"a_centroid_pos",components:2,type:"Uint16"}]),c5=ti([{name:"a_join_normal_inside",components:3,type:"Int16"}]),d5=ti([{name:"a_hidden_by_landmark",components:1,type:"Uint8"}]),f5=ti([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:h5}=a5;var kw,qM,Pw,KM,Rw,ZM,YM,I0={};function XM(){if(qM)return kw;qM=1;var u=tt();function n(g,f,_,T,A){this.properties={},this.extent=_,this.type=0,this._pbf=g,this._geometry=-1,this._keys=T,this._values=A,g.readFields(s,this,f)}function s(g,f,_){g==1?f.id=_.readVarint():g==2?function(T,A){for(var D=T.readVarint()+T.pos;T.pos<D;){var w=A._keys[T.readVarint()],k=A._values[T.readVarint()];A.properties[w]=k}}(_,f):g==3?f.type=_.readVarint():g==4&&(f._geometry=_.pos)}function c(g){for(var f,_,T=0,A=0,D=g.length,w=D-1;A<D;w=A++)T+=((_=g[w]).x-(f=g[A]).x)*(f.y+_.y);return T}return kw=n,n.types=["Unknown","Point","LineString","Polygon"],n.prototype.loadGeometry=function(){var g=this._pbf;g.pos=this._geometry;for(var f,_=g.readVarint()+g.pos,T=1,A=0,D=0,w=0,k=[];g.pos<_;){if(A<=0){var O=g.readVarint();T=7&O,A=O>>3}if(A--,T===1||T===2)D+=g.readSVarint(),w+=g.readSVarint(),T===1&&(f&&k.push(f),f=[]),f.push(new u(D,w));else{if(T!==7)throw new Error("unknown command "+T);f&&f.push(f[0].clone())}}return f&&k.push(f),k},n.prototype.bbox=function(){var g=this._pbf;g.pos=this._geometry;for(var f=g.readVarint()+g.pos,_=1,T=0,A=0,D=0,w=1/0,k=-1/0,O=1/0,I=-1/0;g.pos<f;){if(T<=0){var R=g.readVarint();_=7&R,T=R>>3}if(T--,_===1||_===2)(A+=g.readSVarint())<w&&(w=A),A>k&&(k=A),(D+=g.readSVarint())<O&&(O=D),D>I&&(I=D);else if(_!==7)throw new Error("unknown command "+_)}return[w,O,k,I]},n.prototype.toGeoJSON=function(g,f,_){var T,A,D=this.extent*Math.pow(2,_),w=this.extent*g,k=this.extent*f,O=this.loadGeometry(),I=n.types[this.type];function R(K){for(var ie=0;ie<K.length;ie++){var oe=K[ie];K[ie]=[360*(oe.x+w)/D-180,360/Math.PI*Math.atan(Math.exp((180-360*(oe.y+k)/D)*Math.PI/180))-90]}}switch(this.type){case 1:var B=[];for(T=0;T<O.length;T++)B[T]=O[T][0];R(O=B);break;case 2:for(T=0;T<O.length;T++)R(O[T]);break;case 3:for(O=function(K){var ie=K.length;if(ie<=1)return[K];for(var oe,Q,ue=[],ge=0;ge<ie;ge++){var Se=c(K[ge]);Se!==0&&(Q===void 0&&(Q=Se<0),Q===Se<0?(oe&&ue.push(oe),oe=[K[ge]]):oe.push(K[ge]))}return oe&&ue.push(oe),ue}(O),T=0;T<O.length;T++)for(A=0;A<O[T].length;A++)R(O[T][A])}O.length===1?O=O[0]:I="Multi"+I;var W={type:"Feature",geometry:{type:I,coordinates:O},properties:this.properties};return"id"in this&&(W.id=this.id),W},kw}function JM(){if(KM)return Pw;KM=1;var u=XM();function n(c,g){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=c,this._keys=[],this._values=[],this._features=[],c.readFields(s,this,g),this.length=this._features.length}function s(c,g,f){c===15?g.version=f.readVarint():c===1?g.name=f.readString():c===5?g.extent=f.readVarint():c===2?g._features.push(f.pos):c===3?g._keys.push(f.readString()):c===4&&g._values.push(function(_){for(var T=null,A=_.readVarint()+_.pos;_.pos<A;){var D=_.readVarint()>>3;T=D===1?_.readString():D===2?_.readFloat():D===3?_.readDouble():D===4?_.readVarint64():D===5?_.readVarint():D===6?_.readSVarint():D===7?_.readBoolean():null}return T}(f))}return Pw=n,n.prototype.feature=function(c){if(c<0||c>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[c];var g=this._pbf.readVarint()+this._pbf.pos;return new u(this._pbf,g,this.extent,this._keys,this._values)},Pw}function QM(){return YM||(YM=1,I0.VectorTile=function(){if(ZM)return Rw;ZM=1;var u=JM();function n(s,c,g){if(s===3){var f=new u(g,g.readVarint()+g.pos);f.length&&(c[f.name]=f)}}return Rw=function(s,c){this.layers=s.readFields(n,{},c)},Rw}(),I0.VectorTileFeature=XM(),I0.VectorTileLayer=JM()),I0}var Up=QM();class Gf extends Je{constructor(n,s,c){super(n,s),this.z=c}}class eI extends Gf{constructor(n,s,c,g){super(n,s,c),this.w=g}}function A0(u,n,s,c){const g=[],f=c===0?(_,T,A,D,w,k)=>{_.push(new Je(k,A+(k-T)/(D-T)*(w-A)))}:(_,T,A,D,w,k)=>{_.push(new Je(T+(k-A)/(w-A)*(D-T),k))};for(const _ of u){const T=[];for(const A of _){if(A.length<=2)continue;const D=[];for(let O=0;O<A.length-1;O++){const I=A[O].x,R=A[O].y,B=A[O+1].x,W=A[O+1].y,K=c===0?I:R,ie=c===0?B:W;K<n?ie>n&&f(D,I,R,B,W,n):K>s?ie<s&&f(D,I,R,B,W,s):D.push(A[O]),ie<n&&K>=n&&f(D,I,R,B,W,n),ie>s&&K<=s&&f(D,I,R,B,W,s)}let w=A[A.length-1];const k=c===0?w.x:w.y;k>=n&&k<=s&&D.push(w),D.length&&(w=D[D.length-1],D[0].x===w.x&&D[0].y===w.y||D.push(D[0]),T.push(D))}T.length&&g.push(T)}return g}function tI(u,n,s,c){const g=s==="x"?"y":"x",f=(c-u[s])/(n[s]-u[s]);u[g]=u[g]+(n[g]-u[g])*f,u[s]=c,u.hasOwnProperty("z")&&(u.z=pr(u.z,n.z,f)),u.hasOwnProperty("w")&&(u.w=pr(u.w,n.w,f))}function nI(u,n,s,c){const g=s,f=c;for(const _ of["x","y"]){let T=u,A=n;T[_]>=A[_]&&(T=n,A=u),T[_]<g&&A[_]>g&&tI(T,A,_,g),T[_]<f&&A[_]>f&&tI(A,T,_,f)}}const k0=Number.MAX_SAFE_INTEGER;function rI(u,n,s,c){return u.order<n||u.order===k0||!(u.clipMask&s)||function(g,f){return f.length!==0&&f.find(_=>_===g)===void 0}(c,u.clipScope)}function P0(u,n){return u.x-n.x||u.y-n.y}function iI(u,n){return P0(u.min,n.min)===0&&P0(u.max,n.max)===0}function Ow(u,n){return!(u.min.x>n.max.x||u.max.x<n.min.x||u.min.y>n.max.y||u.max.y<n.min.y)}function Lw(u,n){if(u.length!==n.length)return!1;for(let s=0;s<u.length;s++)if(u[s].sourceId!==n[s].sourceId||!iI(u[s],n[s])||u[s].order!==n[s].order||u[s].clipMask!==n[s].clipMask||!Jt(u[s].clipScope,n[s].clipScope))return!1;return!0}function oI(u,n,s){const c=1/kn,g=1/(1<<s.canonical.z),f=(n.x*c+s.canonical.x)*g+s.wrap,_=(n.y*c+s.canonical.y)*g;return{min:new Je((u.x*c+s.canonical.x)*g+s.wrap,(u.y*c+s.canonical.y)*g),max:new Je(f,_)}}function p5(u,n,s){const c=1<<s.canonical.z,g=((n.x-s.wrap)*c-s.canonical.x)*kn,f=(n.y*c-s.canonical.y)*kn;return{min:new Je(((u.x-s.wrap)*c-s.canonical.x)*kn,(u.y*c-s.canonical.y)*kn),max:new Je(g,f)}}function sI(u,n,s,c,g,f,_){const T=u.indices,A=u.vertices,D=[];for(let w=c;w<c+g;w+=3){const k=n[s[w+0]+f],O=n[s[w+1]+f],I=n[s[w+2]+f],R=Math.min(k.x,O.x,I.x),B=Math.max(k.x,O.x,I.x),W=Math.min(k.y,O.y,I.y),K=Math.max(k.y,O.y,I.y);D.length=0,u.grid.query(new Je(R,W),new Je(B,K),D);for(let ie=0;ie<D.length;ie++){const oe=D[ie];if(St(A[T[3*oe+0]],A[T[3*oe+1]],A[T[3*oe+2]],k,O,I,_))return!0}}return!1}function aI(u,n,s,c){if(!u||!s)return!1;let g=u.vertices;if(!n.canonical.equals(c.canonical)||n.wrap!==c.wrap){if(s.vertices.length<u.vertices.length)return aI(s,c,u,n);const f=n.canonical,_=c.canonical,T=Math.pow(2,_.z-f.z);g=u.vertices.map(A=>new Je((A.x+f.x*kn)*T-_.x*kn,(A.y+f.y*kn)*T-_.y*kn))}return sI(s,g,u.indices,0,u.indices.length,0,0)}function lI(u,n,s,c){const g=Math.pow(2,c.z-s.z);return new Je((u+s.x*kn)*g-c.x*kn,(n+s.y*kn)*g-c.y*kn)}function uI(u,n){const s=[];n.grid.queryPoint(u,s);const c=n.indices,g=n.vertices;for(let f=0;f<s.length;f++){const _=s[f];if(pt([g[c[3*_+0]],g[c[3*_+1]],g[c[3*_+2]]],u))return!0}return!1}const Dw=[new Je(0,0),new Je(kn,0),new Je(kn,kn),new Je(0,kn)];function cI(u,n){const s=[];let c=[];if(!n||u.length<2)return[u];if(u.length===2)return Rt(u[0],u[1],Dw)?[u]:[];for(let g=0;g<u.length+2;g++){const f=u[g%u.length],_=u[(g+1)%u.length],T=Rt(g===0?u[u.length-1]:u[(g-1)%u.length],f,Dw),A=Rt(f,_,Dw),D=T||A;D&&c.push(f),D&&A||c.length>0&&(c.length>1&&s.push(c),c=[])}return c.length>1&&s.push(c),s}const zw=Up.VectorTileFeature.types,m5=["fill-extrusion-base","fill-extrusion-height","fill-extrusion-color","fill-extrusion-pattern","fill-extrusion-flood-light-wall-radius","fill-extrusion-line-width","fill-extrusion-emissive-strength"],g5=["fill-extrusion-flood-light-ground-radius"],_5=Math.pow(2,13),y5=Math.pow(2,15)-1,dI=new Je(0,1),yd=2147483648;function b_(u,n,s,c,g,f,_,T){u.emplaceBack((n<<1)+_,(s<<1)+f,(Math.floor(c*_5)<<1)+g,Math.round(T))}function x_(u,n,s){u.emplaceBack(n.x*kn,n.y*kn,s?1:0)}function R0(u,n,s,c,g,f){u.emplaceBack(n.x,n.y,(s.x<<1)+c,(s.y<<1)+g,f)}function w_(u,n,s){u.emplaceBack(n.x,n.y,n.z,s[0]*16384,s[1]*16384,s[2]*16384)}class fI{constructor(){this.vertexOffset=0,this.vertexCount=0,this.indexOffset=0,this.indexCount=0}}class hI{constructor(){this.centroidXY=new Je(0,0),this.vertexArrayOffset=0,this.vertexCount=0,this.groundVertexArrayOffset=0,this.groundVertexCount=0,this.flags=0,this.footprintSegIdx=-1,this.footprintSegLen=0,this.polygonSegIdx=-1,this.polygonSegLen=0,this.min=new Je(Number.MAX_VALUE,Number.MAX_VALUE),this.max=new Je(-Number.MAX_VALUE,-Number.MAX_VALUE),this.height=0}span(){return new Je(this.max.x-this.min.x,this.max.y-this.min.y)}}class pI{constructor(){this.acc=new Je(0,0),this.accCount=0,this.centroidDataIndex=0}startRing(n,s){n.min.x===Number.MAX_VALUE&&(n.min.x=n.max.x=s.x,n.min.y=n.max.y=s.y)}appendEdge(n,s,c){this.accCount++,this.acc._add(s);let g=!!this.borders;s.x<n.min.x?(n.min.x=s.x,g=!0):s.x>n.max.x&&(n.max.x=s.x,g=!0),s.y<n.min.y?(n.min.y=s.y,g=!0):s.y>n.max.y&&(n.max.y=s.y,g=!0),((s.x===0||s.x===kn)&&s.x===c.x)!=((s.y===0||s.y===kn)&&s.y===c.y)&&this.processBorderOverlap(s,c),g&&this.checkBorderIntersection(s,c)}checkBorderIntersection(n,s){s.x<0!=n.x<0&&this.addBorderIntersection(0,pr(s.y,n.y,(0-s.x)/(n.x-s.x))),s.x>kn!=n.x>kn&&this.addBorderIntersection(1,pr(s.y,n.y,(kn-s.x)/(n.x-s.x))),s.y<0!=n.y<0&&this.addBorderIntersection(2,pr(s.x,n.x,(0-s.y)/(n.y-s.y))),s.y>kn!=n.y>kn&&this.addBorderIntersection(3,pr(s.x,n.x,(kn-s.y)/(n.y-s.y)))}addBorderIntersection(n,s){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const c=this.borders[n];s<c[0]&&(c[0]=s),s>c[1]&&(c[1]=s)}processBorderOverlap(n,s){if(n.x===s.x){if(n.y===s.y)return;const c=n.x===0?0:1;this.addBorderIntersection(c,s.y),this.addBorderIntersection(c,n.y)}else{const c=n.y===0?2:3;this.addBorderIntersection(c,s.x),this.addBorderIntersection(c,n.x)}}centroid(){return this.accCount===0?new Je(0,0):new Je(Math.floor(Math.max(0,this.acc.x)/this.accCount),Math.floor(Math.max(0,this.acc.y)/this.accCount))}intersectsCount(){return this.borders?this.borders.reduce((n,s)=>n+ +(s[0]!==Number.MAX_VALUE),0):0}}function mI(u,n){const s=u.add(n)._unit(),c=Et(u.x*s.x+u.y*s.y,-1,1);var g,f,_;return _=Math.acos(c),Math.min(4,Math.max(-4,Math.tan(_)))/4*y5*((g=u).x*(f=n).y-g.y*f.x<0?-1:1)}const v5=[u=>u.x<0,u=>u.x>kn,u=>u.y<0,u=>u.y>kn];function b5(u,n,s,c){const g=[4];if(c===0)return g;s._mult(c);const f=u.sub(s),_=n.sub(s),T=[u,n,f,_];for(let A=0;A<4;A++)for(const D of T)if(v5[A](D)){g.push(A);break}return g}class gI{constructor(n){this.vertexArray=new ha,this.indexArray=new Uo,this.programConfigurations=new xu(n.layers,{zoom:n.zoom,lut:n.lut},s=>g5.includes(s)),this._segments=new Yi,this.hiddenByLandmarkVertexArray=new hd,this._segmentToGroundQuads={},this._segmentToGroundQuads[0]=[],this._segmentToRegionTriCounts={},this._segmentToRegionTriCounts[0]=[0,0,0,0,0],this.regionSegments={},this.regionSegments[4]=new Yi}getDefaultSegment(){return this.regionSegments[4]}hasData(){return this.vertexArray.length!==0}addData(n,s,c,g=!1){const f=n.length;if(f>2){let _=Math.max(0,this._segments.get().length-1);const T=this._segments._prepareSegment(4*f,this.vertexArray.length,2*this._segmentToGroundQuads[_].length);let A;_!==this._segments.get().length-1&&(_++,this._segmentToGroundQuads[_]=[],this._segmentToRegionTriCounts[_]=[0,0,0,0,0]);{const D=n[0],w=n[1];A=mI(D.sub(n[f-1])._perp()._unit(),w.sub(D)._perp()._unit())}for(let D=0;D<f;D++){const w=D===f-1?0:D+1,k=n[D],O=n[w],I=n[w===f-1?0:w+1],R=O.sub(k)._perp()._unit(),B=mI(R,I.sub(O)._perp()._unit()),W=A,K=B;if(Fw(k,O,s)||g&&vI(k,s)&&vI(O,s)){A=B;continue}const ie=T.vertexLength;R0(this.vertexArray,k,O,1,1,W),R0(this.vertexArray,k,O,1,0,W),R0(this.vertexArray,k,O,0,1,K),R0(this.vertexArray,k,O,0,0,K),T.vertexLength+=4;const oe=b5(k,O,R,c);for(const Q of oe)this._segmentToGroundQuads[_].push({id:ie,region:Q}),this._segmentToRegionTriCounts[_][Q]+=2,T.primitiveLength+=2;A=B}}}prepareBorderSegments(){if(!this.hasData())return;const n=this._segments.get(),s=n.length;for(let c=0;c<s;c++)this._segmentToGroundQuads[c].sort((g,f)=>g.region-f.region);for(let c=0;c<s;c++){const g=this._segmentToGroundQuads[c],f=n[c],_=this._segmentToRegionTriCounts[c];_.reduce((A,D)=>A+D,0);let T=0;for(let A=0;A<=4;A++){const D=_[A];if(D!==0){let w=this.regionSegments[A];w||(w=this.regionSegments[A]=new Yi);const k={vertexOffset:f.vertexOffset,primitiveOffset:f.primitiveOffset+T,vertexLength:f.vertexLength,primitiveLength:D};w.get().push(k)}T+=D}for(let A=0;A<g.length;A++){const D=g[A].id;this.indexArray.emplaceBack(D,D+1,D+3),this.indexArray.emplaceBack(D,D+3,D+2)}}this._segmentToGroundQuads=null,this._segmentToRegionTriCounts=null,this._segments.destroy(),this._segments=null}addPaintPropertiesData(n,s,c,g,f,_){this.hasData()&&this.programConfigurations.populatePaintArrays(this.vertexArray.length,n,s,c,g,f,_)}upload(n){this.hasData()&&(this.vertexBuffer=n.createVertexBuffer(this.vertexArray,l5.members),this.indexBuffer=n.createIndexBuffer(this.indexArray))}uploadPaintProperties(n){this.hasData()&&this.programConfigurations.upload(n)}update(n,s,c,g,f,_,T){this.hasData()&&this.programConfigurations.updatePaintArrays(n,s,c,g,f,_,T)}updateHiddenByLandmark(n){if(!this.hasData())return;const s=n.groundVertexCount+n.groundVertexArrayOffset;if(n.groundVertexCount===0)return;const c=n.flags&yd?1:0;for(let g=n.groundVertexArrayOffset;g<s;++g)this.hiddenByLandmarkVertexArray.emplace(g,c);this._needsHiddenByLandmarkUpdate=!0}uploadHiddenByLandmark(n){this.hasData()&&this._needsHiddenByLandmarkUpdate&&(!this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexArray.length>0?this.hiddenByLandmarkVertexBuffer=n.createVertexBuffer(this.hiddenByLandmarkVertexArray,d5.members,!0):this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.updateData(this.hiddenByLandmarkVertexArray),this._needsHiddenByLandmarkUpdate=!1)}destroy(){if(this.vertexBuffer){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.destroy(),this._segments&&this._segments.destroy(),this.programConfigurations.destroy();for(let n=0;n<=4;n++){const s=this.regionSegments[n];s&&s.destroy()}}}}class O0{constructor(n){this.zoom=n.zoom,this.canonical=n.canonical,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map(s=>s.fqid),this.index=n.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=n.projection,this.activeReplacements=[],this.replacementUpdateTime=0,this.centroidData=[],this.footprintIndices=new Uo,this.footprintVertices=new Il,this.footprintSegments=[],this.layoutVertexArray=new fd,this.centroidVertexArray=new _0,this.wallVertexArray=new v0,this.indexArray=new Uo,this.programConfigurations=new xu(n.layers,{zoom:n.zoom,lut:n.lut},s=>m5.includes(s)),this.segments=new Yi,this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id),this.groundEffect=new gI(n),this.maxHeight=0,this.partLookup={},this.triangleSubSegments=[],this.polygonSegments=[]}updateFootprints(n,s){}populate(n,s,c,g){this.features=[],this.hasPattern=Ew("fill-extrusion",this.layers,s),this.featuresOnBorder=[],this.borderFeatureIndices=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.selfDEMTileTimestamp=Number.MAX_VALUE,this.borderDEMTileTimestamp=[Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE],this.tileToMeter=m(c),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter,this.wallMode=this.layers[0].paint.get("fill-extrusion-line-width").constantOr(1)!==0;for(const{feature:f,id:_,index:T,sourceLayerIndex:A}of n){const D=this.layers[0]._featureFilter.needGeometry,w=ne(f,D);if(!this.layers[0]._featureFilter.filter(new ji(this.zoom),w,c))continue;const k={id:_,sourceLayerIndex:A,index:T,geometry:D?w.geometry:Y(f,c,g),properties:f.properties,type:f.type,patterns:{}},O=this.layoutVertexArray.length,I=zw[k.type]==="Polygon";if(this.hasPattern)this.features.push(Mw("fill-extrusion",this.layers,k,this.zoom,s));else if(this.wallMode)for(const R of k.geometry)for(const B of cI(R,I))this.addFeature(k,[B],T,c,{},s.availableImages,g,s.brightness);else this.addFeature(k,k.geometry,T,c,{},s.availableImages,g,s.brightness);s.featureIndex.insert(f,k.geometry,T,A,this.index,O)}this.sortBorders(),this.projection.name==="mercator"&&this.splitToSubtiles(),this.groundEffect.prepareBorderSegments(),this.polygonSegments.length=0}addFeatures(n,s,c,g,f,_){for(const T of this.features){const A=zw[T.type]==="Polygon",{geometry:D}=T;if(this.wallMode)for(const w of D)for(const k of cI(w,A))this.addFeature(T,[k],T.index,s,c,g,f,_);else this.addFeature(T,D,T.index,s,c,g,f,_)}this.sortBorders(),this.projection.name==="mercator"&&this.splitToSubtiles()}update(n,s,c,g,f,_,T){this.programConfigurations.updatePaintArrays(n,s,f,c,g,_,T),this.groundEffect.update(n,s,f,c,g,_,T)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload||this.groundEffect.programConfigurations.needsUpload}upload(n){this.uploaded||(this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,h5),this.indexBuffer=n.createIndexBuffer(this.indexArray),this.wallVertexBuffer=n.createVertexBuffer(this.wallVertexArray,c5.members),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=n.createVertexBuffer(this.layoutVertexExtArray,f5.members,!0)),this.groundEffect.upload(n)),this.groundEffect.uploadPaintProperties(n),this.programConfigurations.upload(n),this.uploaded=!0}uploadCentroid(n){this.groundEffect.uploadHiddenByLandmark(n),this.needsCentroidUpdate&&(!this.centroidVertexBuffer&&this.centroidVertexArray.length>0?this.centroidVertexBuffer=n.createVertexBuffer(this.centroidVertexArray,u5.members,!0):this.centroidVertexBuffer&&this.centroidVertexBuffer.updateData(this.centroidVertexArray),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.groundEffect.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(n,s,c,g,f,_,T,A){const D=this.layers[0].paint.get("fill-extrusion-flood-light-ground-radius").evaluate(n,{})/this.tileToMeter,w=[new Je(0,0),new Je(kn,kn)],k=T.projection,O=k.name==="globe",I=this.wallMode||zw[n.type]==="Polygon",R=new pI;R.centroidDataIndex=this.centroidData.length;const B=new hI,W=this.layers[0].paint.get("fill-extrusion-base").evaluate(n,{},g)<=0,K=this.layers[0].paint.get("fill-extrusion-height").evaluate(n,{},g);let ie;if(B.height=K,B.vertexArrayOffset=this.layoutVertexArray.length,B.groundVertexArrayOffset=this.groundEffect.vertexArray.length,O&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new Cp),this.wallMode){if(O)return void xn("Non zero fill-extrusion-line-width is not yet supported on globe.");if(s.length!==1)return;ie=function(Le){const nt=Le[0].x===Le[Le.length-1].x&&Le[0].y===Le[Le.length-1].y;(function(On){let nn=0;const Yn=On.length;for(let In=0;In<Yn;In++)nn+=(On[(In+1)%Yn].x-On[In].x)*(On[(In+1)%Yn].y+On[In].y);return nn>=0})(Le)||(Le=Le.reverse());const it={geometry:[],joinNormals:[],indices:[]},dt=[],ct=[],mt=[];let wt=Le.length;for(;wt>=2&&Le[wt-1].equals(Le[wt-2]);)wt--;if(wt<(nt?3:2))return it;let Mt,vt,qt,mn,Zt,Tn=0;for(;Tn<wt-1&&Le[Tn].equals(Le[Tn+1]);)Tn++;nt&&(Mt=Le[wt-2],Zt=Le[Tn].sub(Mt)._unit()._perp());for(let On=Tn;On<wt;On++){if(qt=On===wt-1?nt?Le[Tn+1]:void 0:Le[On+1],qt&&Le[On].equals(qt))continue;Zt&&(mn=Zt),Mt&&(vt=Mt),Mt=Le[On],Zt=qt?qt.sub(Mt)._unit()._perp():mn,mn=mn||Zt;let nn=mn.add(Zt);nn.x===0&&nn.y===0||nn._unit();const Yn=nn.x*Zt.x+nn.y*Zt.y,In=Yn!==0?1/Yn:1/0,qn=mn.x*Zt.y-mn.y*Zt.x>0;let ar="miter";const Mr=2;ar==="miter"&&In>Mr&&(ar="bevel"),ar==="bevel"&&(In>100&&(ar="flipbevel"),In<Mr&&(ar="miter"));const Pr=(Br,Rr,Ur,Ei)=>{const gi=new Je(Br.x,Br.y),Sr=new Je(Br.x,Br.y);gi.x+=Rr.x*Ei,gi.y+=Rr.y*Ei,Sr.x-=Rr.x*Math.max(Ur,1),Sr.y-=Rr.y*Math.max(Ur,1),mt.push(Rr),dt.push(gi),ct.push(Sr)};if(ar==="miter")nn._mult(In),Pr(Mt,nn,0,0);else if(ar==="flipbevel")nn=Zt.mult(-1),Pr(Mt,nn,0,0),Pr(Mt,nn.mult(-1),0,0);else{const Br=-Math.sqrt(In*In-1),Rr=qn?Br:0,Ur=qn?0:Br;vt&&Pr(Mt,mn,Rr,Ur),qt&&Pr(Mt,Zt,Rr,Ur)}}it.geometry=[...dt,...ct.reverse(),dt[0]],it.joinNormals=[...mt,...mt.reverse(),mt[mt.length-1]];const Sn=it.geometry.length-1;for(let On=0;On<Sn/2;On++)if(On+1<Sn/2){let nn=On,Yn=On+1,In=Sn-1-On,qn=Sn-2-On;nn=nn===0?Sn-1:nn-1,Yn=Yn===0?Sn-1:Yn-1,In=In===0?Sn-1:In-1,qn=qn===0?Sn-1:qn-1,it.indices.push(In),it.indices.push(Yn),it.indices.push(nn),it.indices.push(In),it.indices.push(qn),it.indices.push(Yn)}return it}(s[0]),s=[ie.geometry]}const oe=(Le,nt)=>Le<(nt.length-1)/2||Le===nt.length-1,Q=this.wallMode?[s]:M0(s,500);for(let Le=Q.length-1;Le>=0;Le--){const nt=Q[Le];(nt.length===0||(ue=nt[0]).every($e=>$e.x<=0)||ue.every($e=>$e.x>=kn)||ue.every($e=>$e.y<=0)||ue.every($e=>$e.y>=kn))&&Q.splice(Le,1)}var ue;let ge;if(O)ge=SI(Q,w,g);else{ge=[];for(const Le of Q)ge.push({polygon:Le,bounds:w})}const Se=I?this.edgeRadius:0,Fe=Se>0&&this.zoom<17,ze=(Le,nt)=>{if(Le.length===0)return!1;const $e=Le[Le.length-1];return nt.x===$e.x&&nt.y===$e.y};for(const{polygon:Le,bounds:nt}of ge){let $e=0,it=0;for(const wt of Le)I&&!wt[0].equals(wt[wt.length-1])&&wt.push(wt[0]),it+=I?wt.length-1:wt.length;const dt=this.segments.prepareSegment((I?5:4)*it,this.layoutVertexArray,this.indexArray);B.footprintSegIdx<0&&(B.footprintSegIdx=this.footprintSegments.length),B.polygonSegIdx<0&&(B.polygonSegIdx=this.polygonSegments.length);const ct={triangleArrayOffset:this.indexArray.length,triangleCount:0,triangleSegIdx:this.segments.segments.length-1},mt=new fI;if(mt.vertexOffset=this.footprintVertices.length,mt.indexOffset=3*this.footprintIndices.length,mt.ringIndices=[],I){const wt=[],Mt=[];$e=dt.vertexLength;for(let qt=0;qt<Le.length;qt++){const mn=Le[qt];mn.length&&qt!==0&&Mt.push(wt.length/2);const Zt=[];let Tn,Sn;Tn=mn[1].sub(mn[0])._perp()._unit(),mt.ringIndices.push(mn.length-1);for(let On=1;On<mn.length;On++){const nn=mn[On],Yn=mn[On===mn.length-1?1:On+1],In=nn.clone();if(Se){Sn=Yn.sub(nn)._perp()._unit();const qn=Tn.add(Sn)._unit(),ar=Se*Math.min(4,1/(Tn.x*qn.x+Tn.y*qn.y));In.x+=ar*qn.x,In.y+=ar*qn.y,In.x=Math.round(In.x),In.y=Math.round(In.y),Tn=Sn}if(!W||Se!==0&&!Fe||ze(Zt,In)||Zt.push(In),b_(this.layoutVertexArray,In.x,In.y,0,0,1,1,0),this.wallMode){const qn=oe(On,mn);x_(this.wallVertexArray,ie.joinNormals[On],!qn)}dt.vertexLength++,this.footprintVertices.emplaceBack(nn.x,nn.y),wt.push(nn.x,nn.y),O&&w_(this.layoutVertexExtArray,k.projectTilePoint(In.x,In.y,g),k.upVector(g,In.x,In.y))}W&&(Se===0||Fe)&&(Zt.length!==0&&ze(Zt,Zt[0])&&Zt.pop(),this.groundEffect.addData(Zt,nt,D))}const vt=this.wallMode?ie.indices:g_(wt,Mt);for(let qt=0;qt<vt.length;qt+=3)this.footprintIndices.emplaceBack(mt.vertexOffset+vt[qt+0],mt.vertexOffset+vt[qt+1],mt.vertexOffset+vt[qt+2]),this.indexArray.emplaceBack($e+vt[qt],$e+vt[qt+2],$e+vt[qt+1]),dt.primitiveLength++;mt.indexCount+=vt.length,mt.vertexCount+=this.footprintVertices.length-mt.vertexOffset}for(let wt=0;wt<Le.length;wt++){const Mt=Le[wt];R.startRing(B,Mt[0]);let vt=Mt.length>4&&bI(Mt[Mt.length-2],Mt[0],Mt[1]),qt=Se?x5(Mt[Mt.length-2],Mt[0],Mt[1],Se):0;const mn=[];let Zt,Tn,Sn;Tn=Mt[1].sub(Mt[0])._perp()._unit();let On=!0;for(let nn=1,Yn=0;nn<Mt.length;nn++){let In=Mt[nn-1],qn=Mt[nn];const ar=Mt[nn===Mt.length-1?1:nn+1];if(R.appendEdge(B,qn,In),Fw(qn,In,nt)){Se&&(Tn=ar.sub(qn)._perp()._unit(),On=!On);continue}const Mr=qn.sub(In)._perp(),Pr=Mr.x/(Math.abs(Mr.x)+Math.abs(Mr.y)),Br=Mr.y>0?1:0,Rr=In.dist(qn);if(Yn+Rr>32768&&(Yn=0),Se){Sn=ar.sub(qn)._perp()._unit();let Sr=yI(In,qn,ar,_I(Tn,Sn),Se);isNaN(Sr)&&(Sr=0);const _i=qn.sub(In)._unit();In=In.add(_i.mult(qt))._round(),qn=qn.add(_i.mult(-Sr))._round(),qt=Sr,Tn=Sn,W&&this.zoom>=17&&(ze(mn,In)||mn.push(In),ze(mn,qn)||mn.push(qn))}const Ur=dt.vertexLength,Ei=Mt.length>4&&bI(In,qn,ar);let gi=xI(Yn,vt,On);if(b_(this.layoutVertexArray,In.x,In.y,Pr,Br,0,0,gi),b_(this.layoutVertexArray,In.x,In.y,Pr,Br,0,1,gi),this.wallMode){const Sr=oe(nn-1,Mt),_i=ie.joinNormals[nn-1];x_(this.wallVertexArray,_i,Sr),x_(this.wallVertexArray,_i,Sr)}if(Yn+=Rr,gi=xI(Yn,Ei,!On),vt=Ei,b_(this.layoutVertexArray,qn.x,qn.y,Pr,Br,0,0,gi),b_(this.layoutVertexArray,qn.x,qn.y,Pr,Br,0,1,gi),this.wallMode){const Sr=oe(nn,Mt),_i=ie.joinNormals[nn];x_(this.wallVertexArray,_i,Sr),x_(this.wallVertexArray,_i,Sr)}if(dt.vertexLength+=4,this.indexArray.emplaceBack(Ur+0,Ur+1,Ur+2),this.indexArray.emplaceBack(Ur+1,Ur+3,Ur+2),dt.primitiveLength+=2,Se){const Sr=$e+(nn===1?Mt.length-2:nn-2),_i=nn===1?$e:Sr+1;if(this.indexArray.emplaceBack(Ur+1,Sr,Ur+3),this.indexArray.emplaceBack(Sr,_i,Ur+3),dt.primitiveLength+=2,Zt===void 0&&(Zt=Ur),!Fw(ar,Mt[nn],nt)){const fi=nn===Mt.length-1?Zt:dt.vertexLength;this.indexArray.emplaceBack(Ur+2,Ur+3,fi),this.indexArray.emplaceBack(Ur+3,fi+1,fi),this.indexArray.emplaceBack(Ur+3,_i,fi+1),dt.primitiveLength+=3}On=!On}if(O){const Sr=this.layoutVertexExtArray,_i=k.projectTilePoint(In.x,In.y,g),fi=k.projectTilePoint(qn.x,qn.y,g),Mi=k.upVector(g,In.x,In.y),wo=k.upVector(g,qn.x,qn.y);w_(Sr,_i,Mi),w_(Sr,_i,Mi),w_(Sr,fi,wo),w_(Sr,fi,wo)}}I&&($e+=Mt.length-1),W&&Se&&this.zoom>=17&&(mn.length!==0&&ze(mn,mn[0])&&mn.pop(),this.groundEffect.addData(mn,nt,D,Se>0))}this.footprintSegments.push(mt),ct.triangleCount=this.indexArray.length-ct.triangleArrayOffset,this.polygonSegments.push(ct),++B.footprintSegLen,++B.polygonSegLen}if(B.vertexCount=this.layoutVertexArray.length-B.vertexArrayOffset,B.groundVertexCount=this.groundEffect.vertexArray.length-B.groundVertexArrayOffset,B.vertexCount!==0){if(B.centroidXY=R.borders?dI:this.encodeCentroid(R,B),this.centroidData.push(B),R.borders){this.featuresOnBorder.push(R);const Le=this.featuresOnBorder.length-1;for(let nt=0;nt<R.borders.length;nt++)R.borders[nt][0]!==Number.MAX_VALUE&&this.borderFeatureIndices[nt].push(Le)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,n,c,f,_,g,A),this.groundEffect.addPaintPropertiesData(n,c,f,_,g,A),this.maxHeight=Math.max(this.maxHeight,K)}}sortBorders(){for(let n=0;n<this.borderFeatureIndices.length;n++)this.borderFeatureIndices[n].sort((s,c)=>this.featuresOnBorder[s].borders[n][0]-this.featuresOnBorder[c].borders[n][0])}splitToSubtiles(){const n=[];for(let T=0;T<this.centroidData.length;T++){const A=this.centroidData[T],D=+(A.min.y+A.max.y>kn),w=2*D+(+(A.min.x+A.max.x>kn)^D);for(let k=0;k<A.polygonSegLen;k++){const O=A.polygonSegIdx+k;n.push({centroidIdx:T,subtile:w,polygonSegmentIdx:O,triangleSegmentIdx:this.polygonSegments[O].triangleSegIdx})}}const s=new Uo;n.sort((T,A)=>T.triangleSegmentIdx===A.triangleSegmentIdx?T.subtile-A.subtile:T.triangleSegmentIdx-A.triangleSegmentIdx);let c=0,g=0,f=0;for(const T of n){if(T.triangleSegmentIdx!==c)break;f++}const _=n.length;for(;g!==n.length;){c=n[g].triangleSegmentIdx;let T=0,A=g,D=g;for(let w=A;w<f&&n[w].subtile===T;w++)D++;for(;A!==f;){const w=n[A];T=w.subtile;const k=this.centroidData[w.centroidIdx].min.clone(),O=this.centroidData[w.centroidIdx].max.clone(),I={vertexOffset:this.segments.segments[c].vertexOffset,primitiveOffset:s.length,vertexLength:this.segments.segments[c].vertexLength,primitiveLength:0,sortKey:void 0,vaos:{}};for(let R=A;R<D;R++){const B=n[R],W=this.polygonSegments[B.polygonSegmentIdx],K=this.centroidData[B.centroidIdx].min,ie=this.centroidData[B.centroidIdx].max,oe=this.indexArray.uint16;for(let Q=W.triangleArrayOffset;Q<W.triangleArrayOffset+W.triangleCount;Q++)s.emplaceBack(oe[3*Q],oe[3*Q+1],oe[3*Q+2]);I.primitiveLength+=W.triangleCount,k.x=Math.min(k.x,K.x),k.y=Math.min(k.y,K.y),O.x=Math.max(O.x,ie.x),O.y=Math.max(O.y,ie.y)}I.primitiveLength>0&&this.triangleSubSegments.push({segment:I,min:k,max:O}),A=D;for(let R=A;R<f&&n[R].subtile===n[A].subtile;R++)D++}g=f;for(let w=g;w<_&&n[w].triangleSegmentIdx===n[g].triangleSegmentIdx;w++)f++}s._trim(),this.indexArray=s}getVisibleSegments(n,s,c){const g=new Yi;if(this.wallMode){for(const B of this.triangleSubSegments)g.segments.push(B.segment);return g}let f=0,_=0;const T=1<<n.canonical.z;if(s){const B=s.getMinMaxForTile(n);B&&(f=B.min,_=B.max)}_+=this.maxHeight;const A=n.toUnwrapped();let D;const w=[A.canonical.x/T+A.wrap,A.canonical.y/T],k=[(A.canonical.x+1)/T+A.wrap,(A.canonical.y+1)/T],O=(B,W,K)=>[B[0]*(1-K[0])+W[0]*K[0],B[1]*(1-K[1])+W[1]*K[1]],I=[],R=[];for(const B of this.triangleSubSegments){I[0]=B.min.x/kn,I[1]=B.min.y/kn,R[0]=B.max.x/kn,R[1]=B.max.y/kn;const W=O(w,k,I),K=O(w,k,R);if(new fr([W[0],W[1],f],[K[0],K[1],_]).intersectsPrecise(c)===0){D&&(g.segments.push(D),D=void 0);continue}const ie=B.segment;D&&D.vertexOffset!==ie.vertexOffset&&(g.segments.push(D),D=void 0),D?(D.vertexLength+=ie.vertexLength,D.primitiveLength+=ie.primitiveLength):D={vertexOffset:ie.vertexOffset,primitiveLength:ie.primitiveLength,vertexLength:ie.vertexLength,primitiveOffset:ie.primitiveOffset,sortKey:void 0,vaos:{}}}return D&&g.segments.push(D),g}encodeCentroid(n,s){const c=n.centroid(),g=s.span(),f=Math.min(7,Math.round(g.x*this.tileToMeter/10)),_=Math.min(7,Math.round(g.y*this.tileToMeter/10));return new Je(Et(c.x,1,kn-1)<<3|f,Et(c.y,1,kn-1)<<3|_)}encodeBorderCentroid(n){if(!n.borders)return new Je(0,0);const s=n.borders,c=Number.MAX_VALUE;if(s[0][0]!==c||s[1][0]!==c){const g=s[0][0]!==c?0:1;return new Je(6|(s[0][0]!==c?0:65528),(s[g][0]+s[g][1])/2<<3|6)}{const g=s[2][0]!==c?2:3;return new Je((s[g][0]+s[g][1])/2<<3|6,6|(s[2][0]!==c?0:65528))}}showCentroid(n){const s=this.centroidData[n.centroidDataIndex];s.flags&=yd,s.centroidXY.x=0,s.centroidXY.y=0,this.writeCentroidToBuffer(s)}writeCentroidToBuffer(n){this.groundEffect.updateHiddenByLandmark(n);const s=n.vertexArrayOffset,c=n.vertexCount+n.vertexArrayOffset,g=n.flags&yd?dI:n.centroidXY,f=this.centroidVertexArray.geta_centroid_pos0(s);if(this.centroidVertexArray.geta_centroid_pos1(s)!==g.y||f!==g.x){for(let _=s;_<c;++_)this.centroidVertexArray.emplace(_,g.x,g.y);this.needsCentroidUpdate=!0}}createCentroidsBuffer(){this.centroidVertexArray.resize(this.layoutVertexArray.length),this.groundEffect.hiddenByLandmarkVertexArray.resize(this.groundEffect.vertexArray.length);for(const n of this.centroidData)this.writeCentroidToBuffer(n)}updateReplacement(n,s,c){if(s.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=s.updateTime;const g=s.getReplacementRegionsForTile(n.toUnwrapped());if(Lw(this.activeReplacements,g))return;if(this.activeReplacements=g,this.centroidVertexArray.length===0)this.createCentroidsBuffer();else for(const _ of this.centroidData)_.flags&=2147483647;const f=[];for(const _ of this.activeReplacements){if(_.order<c)continue;const T=Math.max(1,Math.pow(2,_.footprintTileId.canonical.z-n.canonical.z));for(const A of this.centroidData)if(!(A.flags&yd||_.min.x>A.max.x||A.min.x>_.max.x||_.min.y>A.max.y||A.min.y>_.max.y))for(let D=0;D<A.footprintSegLen;D++){const w=this.footprintSegments[A.footprintSegIdx+D];if(f.length=0,w5(this.footprintVertices,w.vertexOffset,w.vertexCount,_.footprintTileId.canonical,n.canonical,f),sI(_.footprint,f,this.footprintIndices.uint16,w.indexOffset,w.indexCount,-w.vertexOffset,-T)){A.flags|=yd;break}}}for(const _ of this.centroidData)this.writeCentroidToBuffer(_);this.borderDoneWithNeighborZ=[-1,-1,-1,-1]}footprintContainsPoint(n,s,c){let g=!1;for(let f=0;f<c.footprintSegLen;f++){const _=this.footprintSegments[c.footprintSegIdx+f];let T=0;for(const A of _.ringIndices){for(let D=T,w=A+T-1;D<A+T;w=D++){const k=this.footprintVertices.int16[2*(D+_.vertexOffset)+0],O=this.footprintVertices.int16[2*(D+_.vertexOffset)+1],I=this.footprintVertices.int16[2*(w+_.vertexOffset)+1];O>s!=I>s&&n<(this.footprintVertices.int16[2*(w+_.vertexOffset)+0]-k)*(s-O)/(I-O)+k&&(g=!g)}T=A}}return g}getHeightAtTileCoord(n,s){let c=Number.NEGATIVE_INFINITY,g=!0;const f=4*(n+kn)*kn+(s+kn);if(this.partLookup.hasOwnProperty(f)){const _=this.partLookup[f];return _?{height:_.height,hidden:!!(_.flags&yd)}:void 0}for(const _ of this.centroidData)n>_.max.x||_.min.x>n||s>_.max.y||_.min.y>s||this.footprintContainsPoint(n,s,_)&&_&&_.height>c&&(c=_.height,this.partLookup[f]=_,g=!!(_.flags&yd));if(c!==Number.NEGATIVE_INFINITY)return{height:c,hidden:g};this.partLookup[f]=void 0}}function _I(u,n){const s=u.add(n)._unit();return u.x*s.x+u.y*s.y}function x5(u,n,s,c){const g=n.sub(u)._perp()._unit(),f=s.sub(n)._perp()._unit();return yI(u,n,s,_I(g,f),c)}function yI(u,n,s,c,g){const f=Math.sqrt(1-c*c);return Math.min(u.dist(n)/3,n.dist(s)/3,g*f/c)}function Fw(u,n,s){return u.x<s[0].x&&n.x<s[0].x||u.x>s[1].x&&n.x>s[1].x||u.y<s[0].y&&n.y<s[0].y||u.y>s[1].y&&n.y>s[1].y}function vI(u,n){return u.x<n[0].x||u.x>n[1].x||u.y<n[0].y||u.y>n[1].y}function bI(u,n,s){if(u.x<0||u.x>=kn||n.x<0||n.x>=kn||s.x<0||s.x>=kn)return!1;const c=s.sub(n),g=c.perp(),f=u.sub(n);return(c.x*f.x+c.y*f.y)/Math.sqrt((c.x*c.x+c.y*c.y)*(f.x*f.x+f.y*f.y))>-.866&&g.x*f.x+g.y*f.y<0}function xI(u,n,s){const c=n?2|u:-3&u;return s?1|c:-2&c}function wI(){const u=Math.PI/32,n=Math.tan(u),s=gd;return s*Math.sqrt(1+2*n*n)-s}function SI(u,n,s){const c=1<<s.z,g=ks(s.x/c),f=ks((s.x+1)/c),_=Fo(s.y/c),T=Fo((s.y+1)/c);return function(A,D,w,k,O=0,I){const R=[];if(!A.length||!w||!k)return R;const B=(ge,Se)=>{for(const Fe of ge)R.push({polygon:Fe,bounds:Se})},W=Math.ceil(Math.log2(w)),K=Math.ceil(Math.log2(k)),ie=W-K,oe=[];for(let ge=0;ge<Math.abs(ie);ge++)oe.push(ie>0?0:1);for(let ge=0;ge<Math.min(W,K);ge++)oe.push(0),oe.push(1);let Q=A;if(Q=A0(Q,D[0].y-O,D[1].y+O,1),Q=A0(Q,D[0].x-O,D[1].x+O,0),!Q.length)return R;const ue=[];for(oe.length?ue.push({polygons:Q,bounds:D,depth:0}):B(Q,D);ue.length;){const ge=ue.pop(),Se=ge.depth,Fe=oe[Se],ze=ge.bounds[0],Le=ge.bounds[1],nt=Fe===0?ze.x:ze.y,$e=Fe===0?Le.x:Le.y,it=I(Fe,nt,$e),dt=A0(ge.polygons,nt-O,it+O,Fe),ct=A0(ge.polygons,it-O,$e+O,Fe);if(dt.length){const mt=[ze,new Je(Fe===0?it:Le.x,Fe===1?it:Le.y)];oe.length>Se+1?ue.push({polygons:dt,bounds:mt,depth:Se+1}):B(dt,mt)}if(ct.length){const mt=[new Je(Fe===0?it:ze.x,Fe===1?it:ze.y),Le];oe.length>Se+1?ue.push({polygons:ct,bounds:mt,depth:Se+1}):B(ct,mt)}}return R}(u,n,Math.ceil((f-g)/11.25),Math.ceil((_-T)/11.25),1,(A,D,w)=>{if(A===0)return .5*(D+w);{const k=Fo((s.y+D/kn)/c);return(Rl(.5*(Fo((s.y+w/kn)/c)+k))*c-s.y)*kn}})}function w5(u,n,s,c,g,f){const _=Math.pow(2,c.z-g.z);for(let T=0;T<s;T++){let A=u.int16[2*(T+n)+0],D=u.int16[2*(T+n)+1];A=(A+g.x*kn)*_-c.x*kn,D=(D+g.y*kn)*_-c.y*kn,f.push(new Je(A,D))}}let TI,CI;function S_(u,n){return u.x*n.x+u.y*n.y}function EI(u,n){if(u.length===1){let s=0;const c=n[s++];let g;for(;!g||c.equals(g);)if(g=n[s++],!g)return 1/0;for(;s<n.length;s++){const f=n[s],_=u[0],T=g.sub(c),A=f.sub(c),D=_.sub(c),w=S_(T,T),k=S_(T,A),O=S_(A,A),I=S_(D,T),R=S_(D,A),B=w*O-k*k,W=(O*I-k*R)/B,K=(w*R-k*I)/B,ie=c.z*(1-W-K)+g.z*W+f.z*K;if(isFinite(ie))return ie}return 1/0}{let s=1/0;for(const c of n)s=Math.min(s,c.z);return s}}function MI(u,n,s,c,g,f,_,T){const A=_*g.getElevationAt(u,n,!0,!0),D=f[0]!==0,w=D?f[1]===0?_*(f[0]/7-450):_*function(k,O,I){const R=Math.floor(O[0]/8),B=Math.floor(O[1]/8),W=10*(O[0]-8*R),K=10*(O[1]-8*B),ie=k.getElevationAt(R,B,!0,!0),oe=k.getMeterToDEM(I),Q=Math.floor(.5*(W*oe-1)),ue=Math.floor(.5*(K*oe-1)),ge=k.tileCoordToPixel(R,B),Se=2*Q+1,Fe=2*ue+1,ze=function(ct,mt,wt,Mt,vt){return[ct.getElevationAtPixel(mt,wt,!0),ct.getElevationAtPixel(mt+vt,wt,!0),ct.getElevationAtPixel(mt,wt+vt,!0),ct.getElevationAtPixel(mt+Mt,wt+vt,!0)]}(k,ge.x-Q,ge.y-ue,Se,Fe),Le=Math.abs(ze[0]-ze[1]),nt=Math.abs(ze[2]-ze[3]),$e=Math.abs(ze[0]-ze[2])+Math.abs(ze[1]-ze[3]),it=Math.min(.25,.5*oe*(Le+nt)/Se),dt=Math.min(.25,.5*oe*$e/Fe);return ie+Math.max(it*W,dt*K)}(g,f,T):A;return{base:A+(s===0?-1:s),top:D?Math.max(w+c,A+s+2):A+c}}Gn(O0,"FillExtrusionBucket",{omit:["layers","features"]}),Gn(hI,"PartData"),Gn(fI,"FootprintSegment"),Gn(pI,"BorderCentroidData"),Gn(gI,"GroundEffect");const S5=ti([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),T5=ti([{name:"a_z_offset_width",components:2,type:"Float32"}],4),{members:C5}=S5,E5=ti([{name:"a_packed",components:4,type:"Float32"}]),{members:M5}=E5,I5=ti([{name:"a_pattern_data",components:3,type:"Float32"}]),{members:A5}=I5;class II{constructor(n,s){this.width=n,this.height=s,this.nextRow=0,this.image=new _d({width:n,height:s}),this.positions={},this.uploaded=!1}getDash(n,s){const c=this.getKey(n,s);return this.positions[c]}trim(){const n=this.width,s=this.height=Di(this.nextRow);this.image.resize({width:n,height:s})}getKey(n,s){return n.join(",")+s}getDashRanges(n,s,c){const g=[];let f=n.length%2==1?-n[n.length-1]*c:0,_=n[0]*c,T=!0;g.push({left:f,right:_,isDash:T,zeroLength:n[0]===0});let A=n[0];for(let D=1;D<n.length;D++){T=!T;const w=n[D];f=A*c,A+=w,_=A*c,g.push({left:f,right:_,isDash:T,zeroLength:w===0})}return g}addRoundDash(n,s,c){const g=s/2;for(let f=-c;f<=c;f++){const _=this.width*(this.nextRow+c+f);let T=0,A=n[T];for(let D=0;D<this.width;D++){D/A.right>1&&(A=n[++T]);const w=Math.abs(D-A.left),k=Math.abs(D-A.right),O=Math.min(w,k);let I;const R=f/c*(g+1);if(A.isDash){const B=g-Math.abs(R);I=Math.sqrt(O*O+B*B)}else I=g-Math.sqrt(O*O+R*R);this.image.data[_+D]=Math.max(0,Math.min(255,I+128))}}}addRegularDash(n,s){for(let A=n.length-1;A>=0;--A){const D=n[A],w=n[A+1];D.zeroLength?n.splice(A,1):w&&w.isDash===D.isDash&&(w.left=D.left,n.splice(A,1))}const c=n[0],g=n[n.length-1];c.isDash===g.isDash&&(c.left=g.left-this.width,g.right=c.right+this.width);const f=this.width*this.nextRow;let _=0,T=n[_];for(let A=0;A<this.width;A++){A/T.right>1&&(T=n[++_]);const D=Math.abs(A-T.left),w=Math.abs(A-T.right),k=Math.min(D,w);this.image.data[f+A]=Math.max(0,Math.min(255,(T.isDash?k:-k)+s+128))}}addDash(n,s){const c=this.getKey(n,s);if(this.positions[c])return this.positions[c];const g=s==="round",f=g?7:0,_=2*f+1;if(this.nextRow+_>this.height)return xn("LineAtlas out of space"),null;n.length===0&&n.push(1);let T=0;for(let w=0;w<n.length;w++)n[w]<0&&(xn("Negative value is found in line dasharray, replacing values with 0"),n[w]=0),T+=n[w];if(T!==0){const w=this.width/T,k=this.getDashRanges(n,this.width,w);g?this.addRoundDash(k,w,f):this.addRegularDash(k,s==="square"?.5*w:0)}const A=this.nextRow+f;this.nextRow+=_;const D={tl:[A,f],br:[T,0]};return this.positions[c]=D,D}}Gn(II,"LineAtlas");const k5=Up.VectorTileFeature.types,P5=Math.cos(Math.PI/180*37.5),R5=Math.cos(Math.PI/180*5);class Nw{constructor(n){this.evaluationGlobals={zoom:0,lineProgress:void 0},this.zoom=n.zoom,this.evaluationGlobals.zoom=this.zoom,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map(s=>s.fqid),this.index=n.index,this.projection=n.projection,this.hasPattern=!1,this.hasZOffset=!1,this.hasCrossSlope=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(s=>{this.gradients[s.id]={}}),this.layoutVertexArray=new qg,this.layoutVertexArray2=new Al,this.patternVertexArray=new gu,this.indexArray=new Uo,this.programConfigurations=new xu(n.layers,{zoom:n.zoom,lut:n.lut}),this.segments=new Yi,this.maxLineLength=0,this.zOffsetVertexArray=new kl,this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id),this.tessellationStep=n.tessellationStep?n.tessellationStep:kn/64}updateFootprints(n,s){}populate(n,s,c,g){this.hasPattern=Ew("line",this.layers,s);const f=this.layers[0].layout.get("line-sort-key");this.tileToMeter=m(c),this.hasZOffset=!this.layers[0].isDraped();const _=this.layers[0].layout.get("line-elevation-reference");this.hasZOffset&&_==="none"&&xn(`line-elevation-reference: ground is used for the layer ${this.layerIds[0]} because non-zero line-z-offset value was found.`);const T=this.layers[0].layout.get("line-cross-slope");this.hasCrossSlope=this.hasZOffset&&T!==void 0;const A=[];for(const{feature:O,id:I,index:R,sourceLayerIndex:B}of n){const W=this.layers[0]._featureFilter.needGeometry,K=ne(O,W);if(!this.layers[0]._featureFilter.filter(new ji(this.zoom),K,c))continue;const ie=f?f.evaluate(K,{},c):void 0,oe={id:I,properties:O.properties,type:O.type,sourceLayerIndex:B,index:R,geometry:W?K.geometry:Y(O,c,g),patterns:{},sortKey:ie};A.push(oe)}f&&A.sort((O,I)=>O.sortKey-I.sortKey);const{lineAtlas:D,featureIndex:w}=s,k=this.addConstantDashes(D);for(const O of A){const{geometry:I,index:R,sourceLayerIndex:B}=O;if(k&&this.addFeatureDashes(O,D),this.hasPattern){const W=Mw("line",this.layers,O,this.zoom,s);this.patternFeatures.push(W)}else this.addFeature(O,I,R,c,D.positions,s.availableImages,s.brightness);w.insert(n[R].feature,I,R,B,this.index)}}addConstantDashes(n){let s=!1;for(const c of this.layers){const g=c.paint.get("line-dasharray").value,f=c.layout.get("line-cap").value;if(g.kind!=="constant"||f.kind!=="constant")s=!0;else{const _=f.value,T=g.value;if(!T)continue;n.addDash(T,_)}}return s}addFeatureDashes(n,s){const c=this.zoom;for(const g of this.layers){const f=g.paint.get("line-dasharray").value,_=g.layout.get("line-cap").value;if(f.kind==="constant"&&_.kind==="constant")continue;let T,A;if(f.kind==="constant"){if(T=f.value,!T)continue}else T=f.evaluate({zoom:c},n);A=_.kind==="constant"?_.value:_.evaluate({zoom:c},n),s.addDash(T,A),n.patterns[g.id]=s.getKey(T,A)}}update(n,s,c,g,f,_,T){this.programConfigurations.updatePaintArrays(n,s,f,c,g,_,T)}addFeatures(n,s,c,g,f,_){for(const T of this.patternFeatures)this.addFeature(T,T.geometry,T.index,s,c,g,_)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(n){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=n.createVertexBuffer(this.layoutVertexArray2,M5)),this.patternVertexArray.length!==0&&(this.patternVertexBuffer=n.createVertexBuffer(this.patternVertexArray,A5)),!this.zOffsetVertexBuffer&&this.zOffsetVertexArray.length>0&&(this.zOffsetVertexBuffer=n.createVertexBuffer(this.zOffsetVertexArray,T5.members,!0)),this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,C5),this.indexBuffer=n.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(n),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.zOffsetVertexBuffer&&this.zOffsetVertexBuffer.destroy(),this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(n){if(n.properties&&n.properties.hasOwnProperty("mapbox_clip_start")&&n.properties.hasOwnProperty("mapbox_clip_end"))return{start:+n.properties.mapbox_clip_start,end:+n.properties.mapbox_clip_end}}addFeature(n,s,c,g,f,_,T){const A=this.layers[0].layout,D=A.get("line-join").evaluate(n,{}),w=A.get("line-cap").evaluate(n,{}),k=A.get("line-miter-limit"),O=A.get("line-round-limit");this.lineClips=this.lineFeatureClips(n),this.lineFeature=n,this.zOffsetValue=A.get("line-z-offset").value;const I=this.layers[0].paint.get("line-width").value;I.kind!=="constant"&&I.isLineProgressConstant===!1&&(this.variableWidthValue=I);for(const R of s)this.addLine(R,n,g,D,w,k,O);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,n,c,f,_,g,T)}addLine(n,s,c,g,f,_,T){this.distance=0,this.prevDistance=0,this.scaledDistance=0,this.totalDistance=0,this.totalFeatureLength=0,this.lineSoFar=0,this.currentVertex=void 0;const A=g==="none";if(this.patternJoinNone=this.hasPattern&&A,this.segmentStart=0,this.segmentStartf32=0,this.segmentPoints=[],this.lineClips){this.lineClipsArray.push(this.lineClips);for(let oe=0;oe<n.length-1;oe++)this.totalDistance+=n[oe].dist(n[oe+1]);this.totalFeatureLength=this.totalDistance/(this.lineClips.end-this.lineClips.start),this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const D=k5[s.type]==="Polygon";let w=n.length;for(;w>=2&&n[w-1].equals(n[w-2]);)w--;let k=0;for(;k<w-1&&n[k].equals(n[k+1]);)k++;if(w<(D?3:2))return;g==="bevel"&&(_=1.05);const O=this.segments.prepareSegment(10*w,this.layoutVertexArray,this.indexArray);let I,R,B,W,K,ie;this.e1=this.e2=-1,D&&(I=n[w-2],K=n[k].sub(I)._unit()._perp());for(let oe=k;oe<w;oe++){if(B=oe===w-1?D?n[k+1]:void 0:n[oe+1],B&&n[oe].equals(B))continue;K&&(W=K),I&&(R=I),I=n[oe],ie=this.evaluateLineProgressFeatures(R?R.dist(I):0),K=B?B.sub(I)._unit()._perp():W,W=W||K;const Q=R&&B;let ue=Q?g:D||A?"butt":f;const ge=W.x*K.x+W.y*K.y;if(A){const dt=function(ct){if(ct.patternJoinNone){const mt=ct.segmentPoints.length/2,wt=ct.lineSoFar-ct.segmentStart;for(let Mt=0;Mt<mt;++Mt){const vt=ct.segmentPoints[2*Mt+1],qt=Math.round(ct.segmentPoints[2*Mt])+.5+.25*vt;ct.patternVertexArray.emplaceBack(qt,wt,ct.segmentStart),ct.patternVertexArray.emplaceBack(qt,wt,ct.segmentStart)}ct.segmentPoints.length=0}ct.e1=ct.e2=-1};if(Q&&ge<R5){this.updateDistance(R,I),this.addCurrentVertex(I,W,1,1,O,ie),dt(this),this.addCurrentVertex(I,K,-1,-1,O,ie);continue}if(R){if(!B){this.updateDistance(R,I),this.addCurrentVertex(I,W,1,1,O,ie),dt(this);continue}ue="miter"}}let Se=W.add(K);Se.x===0&&Se.y===0||Se._unit();const Fe=Se.x*K.x+Se.y*K.y,ze=Fe!==0?1/Fe:1/0,Le=2*Math.sqrt(2-2*Fe),nt=Fe<P5&&R&&B,$e=W.x*K.y-W.y*K.x>0,it=this.overscaling<=16?15*kn/(512*this.overscaling):0;if(Q&&ue==="round"){if(ze<T)ue="miter";else if(ze<=2){const dt=Bw(I,-10,kn+10);ue=this.hasZOffset&&(dt||this.hasCrossSlope)?"miter":"fakeround"}}if(ue==="miter"&&ze>_&&(ue="bevel"),ue==="bevel"&&(ze>2&&(ue="flipbevel"),ze<_&&(ue="miter")),R&&!(ue==="miter"&&nt)&&this.updateDistance(R,I),ue==="miter")if(nt){const dt=I.dist(R);if(dt>2*it){const mt=I.sub(I.sub(R)._mult(it/dt)._round());this.updateDistance(R,mt),this.addCurrentVertex(mt,W,0,0,O,ie),R=mt}this.updateDistance(R,I),Se._mult(ze),this.addCurrentVertex(I,Se,0,0,O,ie);const ct=I.dist(B);if(ct>2*it){const mt=I.add(B.sub(I)._mult(it/ct)._round());this.updateDistance(I,mt),this.addCurrentVertex(mt,K,0,0,O,ie),I=mt}}else Se._mult(ze),this.addCurrentVertex(I,Se,0,0,O,ie);else if(ue==="flipbevel"){if(ze>100)Se=K.mult(-1);else{const dt=ze*W.add(K).mag()/W.sub(K).mag();Se._perp()._mult(dt*($e?-1:1))}this.addCurrentVertex(I,Se,0,0,O,ie),this.addCurrentVertex(I,Se.mult(-1),0,0,O,ie)}else if(ue==="bevel"||ue==="fakeround"){ie!=null&&R&&this.addCurrentVertex(I,W,-1,-1,O,ie);const dt=I.dist(R)<=2*it&&ue!=="bevel",ct=Se.mult($e?1:-1);ct._mult(ze);const mt=K.mult($e?-1:1),wt=W.mult($e?-1:1),Mt=this.evaluateLineProgressFeatures(this.distance);if(ie==null&&(this.addHalfVertex(I,ct.x,ct.y,!1,!$e,0,O,Mt),dt||this.addHalfVertex(I,ct.x+2*wt.x,ct.y+2*wt.y,!1,$e,0,O,Mt)),ue==="fakeround"){const vt=Math.round(180*Le/Math.PI/20);this.addHalfVertex(I,wt.x,wt.y,!1,$e,0,O,Mt);for(let qt=0;qt<vt;qt++){let mn=qt/vt;if(mn!==.5){const Tn=mn-.5;mn+=mn*Tn*(mn-1)*((1.0904+ge*(ge*(3.55645-1.43519*ge)-3.2452))*Tn*Tn+(.848013+ge*(.215638*ge-1.06021)))}const Zt=mt.sub(wt)._mult(mn)._add(wt)._unit();this.addHalfVertex(I,Zt.x,Zt.y,!1,$e,0,O,Mt)}this.addHalfVertex(I,mt.x,mt.y,!1,$e,0,O,Mt)}dt||ie!=null||this.addHalfVertex(I,ct.x+2*mt.x,ct.y+2*mt.y,!1,$e,0,O,Mt),ie!=null&&B&&this.addCurrentVertex(I,K,1,1,O,ie)}else ue==="butt"?this.addCurrentVertex(I,Se,0,0,O,ie):ue==="square"?(R||this.addCurrentVertex(I,Se,-1,-1,O,ie),this.addCurrentVertex(I,Se,0,0,O,ie),R&&this.addCurrentVertex(I,Se,1,1,O,ie)):ue==="round"&&(R&&(this.addCurrentVertex(I,W,0,0,O,ie),this.addCurrentVertex(I,W,1,1,O,ie,!0)),B&&(this.addCurrentVertex(I,K,-1,-1,O,ie,!0),this.addCurrentVertex(I,K,0,0,O,ie)))}}addVerticesTo(n,s,c,g,f,_,T,A,D,w){const k=(s.w-n.w)/this.tessellationStep|0;let O=0;const I=this.scaledDistance;if(k>1){this.lineSoFar=n.w;const B=(s.x-n.x)/k,W=(s.y-n.y)/k,K=(s.z-n.z)/k,ie=(s.w-n.w)/k;for(let oe=1;oe<k;++oe){n.x+=B,n.y+=W,n.z+=K,this.lineSoFar+=ie,O+=ie;const Q=this.evaluateLineProgressFeatures(this.prevDistance+O);this.scaledDistance=(this.prevDistance+O)/this.totalDistance,this.addHalfVertex(n,c,g,w,!1,T,D,Q),this.addHalfVertex(n,f,_,w,!0,-A,D,Q)}}this.lineSoFar=s.w,this.scaledDistance=I;const R=this.evaluateLineProgressFeatures(this.distance);this.addHalfVertex(s,c,g,w,!1,T,D,R),this.addHalfVertex(s,f,_,w,!0,-A,D,R)}evaluateLineProgressFeatures(n){if(!this.variableWidthValue&&!this.hasZOffset)return null;this.evaluationGlobals.lineProgress=0,this.lineClips?this.evaluationGlobals.lineProgress=Math.min(1,(this.totalFeatureLength*this.lineClips.start+n)/this.totalFeatureLength):xn(`line-progress evaluation for ${this.layerIds[0]} requires enabling 'lineMetrics' for the source.`);let s=0;return this.variableWidthValue&&this.variableWidthValue.kind!=="constant"&&(s=this.variableWidthValue.evaluate(this.evaluationGlobals,this.lineFeature)||0),this.hasZOffset?this.zOffsetValue.kind==="constant"?{zOffset:this.zOffsetValue.value,variableWidth:s}:{zOffset:this.zOffsetValue.evaluate(this.evaluationGlobals,this.lineFeature)||0,variableWidth:s}:{zOffset:0,variableWidth:s}}addCurrentVertex(n,s,c,g,f,_,T=!1){const A=s.x+s.y*c,D=s.y-s.x*c,w=s.y*g-s.x,k=-s.y-s.x*g;if(_!=null){const O=this.hasZOffset,I=-10,R=kn+10,B=_.zOffset,W=new eI(n.x,n.y,B,this.lineSoFar),K=!!O&&Bw(n,I,R),ie=this.lineSoFar,oe=this.distance;if(this.currentVertex)if(K){const Q=this.currentVertexIsOutside,ue=this.currentVertex,ge=new eI(n.x,n.y,B,this.lineSoFar);if(nI(ue,ge,I,R),!Bw(ge,I,R)){if(Q){this.e1=this.e2=-1,this.distance-=ue.dist(W),this.lineSoFar=ue.w;const Se=this.evaluateLineProgressFeatures(ue.w-this.totalFeatureLength*(this.lineClips?this.lineClips.start:0));this.addHalfVertex(ue,A,D,T,!1,c,f,Se),this.addHalfVertex(ue,w,k,T,!0,-g,f,Se),this.prevDistance=this.distance}this.distance=this.prevDistance+ue.dist(ge),this.scaledDistance=this.distance/this.totalDistance,this.addVerticesTo(ue,ge,A,D,w,k,c,g,f,T),this.distance=oe,this.scaledDistance=this.distance/this.totalDistance}}else{const Q=this.currentVertex;if(this.currentVertexIsOutside){nI(Q,W,I,R),this.e1=this.e2=-1,this.distance-=Q.dist(W),this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=Q.w;const ue=this.evaluateLineProgressFeatures(Q.w-this.totalFeatureLength*(this.lineClips?this.lineClips.start:0));this.addHalfVertex(Q,A,D,T,!1,c,f,ue),this.addHalfVertex(Q,w,k,T,!0,-g,f,ue),this.prevDistance=this.distance,this.distance=oe,this.scaledDistance=this.distance/this.totalDistance}this.addVerticesTo(Q,W,A,D,w,k,c,g,f,T)}else K||(this.addHalfVertex(n,A,D,T,!1,c,f,_),this.addHalfVertex(n,w,k,T,!0,-g,f,_));this.currentVertex=W,this.currentVertexIsOutside=K,this.lineSoFar=ie}else this.addHalfVertex(n,A,D,T,!1,c,f,_),this.addHalfVertex(n,w,k,T,!0,-g,f,_)}addHalfVertex({x:n,y:s},c,g,f,_,T,A,D){this.patternJoinNone&&(this.segmentPoints.length===0&&(this.segmentStart=this.lineSoFar,this.segmentStartf32=Math.fround(this.lineSoFar)),_||this.segmentPoints.push(this.lineSoFar-this.segmentStart,T)),this.layoutVertexArray.emplaceBack((n<<1)+(f?1:0),(s<<1)+(_?1:0),Math.round(63*c)+128,Math.round(63*g)+128,1+(T===0?0:T<0?-1:1),0,this.lineSoFar-this.segmentStartf32),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,this.lineClips.start,this.lineClips.end);const w=A.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,w),A.primitiveLength++),_?this.e2=w:this.e1=w,D!=null&&this.zOffsetVertexArray.emplaceBack(D.zOffset,D.variableWidth)}updateScaledDistance(){this.lineClips?(this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=this.totalFeatureLength*this.lineClips.start+this.distance):this.lineSoFar=this.distance}updateDistance(n,s){this.prevDistance=this.distance,this.distance+=n.dist(s),this.updateScaledDistance()}}function Bw(u,n,s){return u.x<n||u.x>s||u.y<n||u.y>s}let AI,kI;function PI(u,n,s){return n*(kn/(u.tileSize*Math.pow(2,s-u.tileID.overscaledZ)))}Gn(Nw,"LineBucket",{omit:["layers","patternFeatures","currentVertex","currentVertexIsOutside"]});const RI=(u,n,s)=>(1-s)*u+s*n;function OI(u,n){return 1/PI(u,1,n.tileZoom)}function LI(u,n,s,c){return u.translatePosMatrix(c||n.tileID.projMatrix,n,s.paint.get("line-translate"),s.paint.get("line-translate-anchor"))}const DI=u=>{const n=[];zI(u)&&n.push("RENDER_LINE_DASH"),u.paint.get("line-gradient")&&n.push("RENDER_LINE_GRADIENT");const s=u.paint.get("line-trim-offset");s[0]===0&&s[1]===0||n.push("RENDER_LINE_TRIM_OFFSET"),u.paint.get("line-border-width").constantOr(1)!==0&&n.push("RENDER_LINE_BORDER");const c=u.layout.get("line-join").constantOr("miter")==="none",g=!!u.paint.get("line-pattern").constantOr(1);return c&&g&&n.push("LINE_JOIN_NONE"),n};function zI(u){const n=u.paint.get("line-dasharray").value;return n.value||n.kind!=="constant"}let Vw;const FI=()=>Vw||(Vw={layout:AI||(AI=new Zi({"line-cap":new Fn(Ot.layout_line["line-cap"]),"line-join":new Fn(Ot.layout_line["line-join"]),"line-miter-limit":new _n(Ot.layout_line["line-miter-limit"]),"line-round-limit":new _n(Ot.layout_line["line-round-limit"]),"line-sort-key":new Fn(Ot.layout_line["line-sort-key"]),"line-z-offset":new Fn(Ot.layout_line["line-z-offset"]),"line-elevation-reference":new _n(Ot.layout_line["line-elevation-reference"]),"line-cross-slope":new _n(Ot.layout_line["line-cross-slope"]),visibility:new _n(Ot.layout_line.visibility),"line-width-unit":new _n(Ot.layout_line["line-width-unit"])})),paint:kI||(kI=new Zi({"line-opacity":new Fn(Ot.paint_line["line-opacity"]),"line-color":new Fn(Ot.paint_line["line-color"]),"line-translate":new _n(Ot.paint_line["line-translate"]),"line-translate-anchor":new _n(Ot.paint_line["line-translate-anchor"]),"line-width":new Fn(Ot.paint_line["line-width"]),"line-gap-width":new Fn(Ot.paint_line["line-gap-width"]),"line-offset":new Fn(Ot.paint_line["line-offset"]),"line-blur":new Fn(Ot.paint_line["line-blur"]),"line-dasharray":new Fn(Ot.paint_line["line-dasharray"]),"line-pattern":new Fn(Ot.paint_line["line-pattern"]),"line-gradient":new ad(Ot.paint_line["line-gradient"]),"line-trim-offset":new _n(Ot.paint_line["line-trim-offset"]),"line-trim-fade-range":new _n(Ot.paint_line["line-trim-fade-range"]),"line-trim-color":new _n(Ot.paint_line["line-trim-color"]),"line-emissive-strength":new _n(Ot.paint_line["line-emissive-strength"]),"line-border-width":new Fn(Ot.paint_line["line-border-width"]),"line-border-color":new Fn(Ot.paint_line["line-border-color"]),"line-occlusion-opacity":new _n(Ot.paint_line["line-occlusion-opacity"]),"line-color-use-theme":new Fn({type:"string",default:"default","property-type":"data-driven"}),"line-gradient-use-theme":new Fn({type:"string",default:"default","property-type":"data-driven"}),"line-trim-color-use-theme":new Fn({type:"string",default:"default","property-type":"data-driven"}),"line-border-color-use-theme":new Fn({type:"string",default:"default","property-type":"data-driven"})}))},Vw);class O5 extends Fn{possiblyEvaluate(n,s){return s=new ji(Math.floor(s.zoom),{now:s.now,fadeDuration:s.fadeDuration,transition:s.transition}),super.possiblyEvaluate(n,s)}evaluate(n,s,c,g){return s=er({},s,{zoom:Math.floor(s.zoom)}),super.evaluate(n,s,c,g)}}let T_;function NI(u,n){return n>0?n+2*u:u}const L5=ti([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),D5=ti([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),z5=ti([{name:"a_projected_pos",components:4,type:"Float32"}],4);ti([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const F5=ti([{name:"a_auto_z_offset",components:1,type:"Float32"}],4),N5=ti([{name:"a_texb",components:2,type:"Uint16"}]),B5=ti([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_elevation_from_sea",components:2,type:"Float32"}]),V5=ti([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"},{name:"a_auto_z_offset",components:1,type:"Float32"}]);ti([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const BI=ti([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),$5=ti([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);ti([{name:"triangle",components:3,type:"Uint16"}]),ti([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),ti([{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Float32",name:"zOffset"},{type:"Uint8",name:"hasIconTextFit"}]),ti([{type:"Float32",name:"offsetX"}]),ti([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);var Xo=24;const Dl=128;function L0(u,n,s,c,g){if(u.kind==="camera")return u.maxSize;if(u.kind==="composite"){const f=n.possiblyEvaluate(new ji(u.maxZoom),s).evaluate(g,{},s),_=n.possiblyEvaluate(new ji(u.minZoom),s).evaluate(g,{},s);return Math.max(f,_)}return n.possiblyEvaluate(new ji(c)).evaluate(g,{},s)}function $w(u,n){const{expression:s}=n;if(s.kind==="constant")return{kind:"constant",layoutSize:s.evaluate(new ji(u+1))};if(s.kind==="source")return{kind:"source"};{const{zoomStops:c,interpolationType:g}=s;let f=0;for(;f<c.length&&c[f]<=u;)f++;f=Math.max(0,f-1);let _=f;for(;_<c.length&&c[_]<u+1;)_++;_=Math.min(c.length-1,_);const T=c[f],A=c[_];return s.kind==="composite"?{kind:"composite",minZoom:T,maxZoom:A,interpolationType:g}:{kind:"camera",minZoom:T,maxZoom:A,minSize:s.evaluate(new ji(T)),maxSize:s.evaluate(new ji(A)),interpolationType:g}}}function D0(u,{uSize:n,uSizeT:s},{lowerSize:c,upperSize:g}){return u.kind==="source"?c/Dl:u.kind==="composite"?pr(c/Dl,g/Dl,s):n}function jp(u,n,s=1){let c=0,g=0;if(u.kind==="constant")g=u.layoutSize*s;else if(u.kind!=="source"){const{interpolationType:f,minZoom:_,maxZoom:T}=u,A=f?Et(Es.interpolationFactor(f,n,_,T),0,1):0;u.kind==="camera"?g=pr(u.minSize,u.maxSize,A)*s:c=A*s}return{uSizeT:c,uSize:g}}var U5=Object.freeze({__proto__:null,SIZE_PACK_FACTOR:Dl,evaluateSizeForFeature:D0,evaluateSizeForZoom:jp,getRasterizedIconSize:L0,getSizeData:$w});function j5(u,n,s){return u.sections.forEach(c=>{c.text=function(g,f,_){const T=f.layout.get("text-transform").evaluate(_,{});return T==="uppercase"?g=g.toLocaleUpperCase():T==="lowercase"&&(g=g.toLocaleLowerCase()),Is.applyArabicShaping&&(g=Is.applyArabicShaping(g)),g}(c.text,n,s)}),u}const C_={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};function H5(u){return u===""||u===""||u===""||u===""||u===""||u===""||u===""||u===""||u===""||u===""||u===""||u===""||u===""||u===""||u===""||u===""||u===""}function G5(u){return u===""||u===""||u===""||u===""||u===""||u===""||u===""||u===""||u===""||u===""}var VI,Uw,$I,jw={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */function W5(){return VI||(VI=1,jw.read=function(u,n,s,c,g){var f,_,T=8*g-c-1,A=(1<<T)-1,D=A>>1,w=-7,k=s?g-1:0,O=s?-1:1,I=u[n+k];for(k+=O,f=I&(1<<-w)-1,I>>=-w,w+=T;w>0;f=256*f+u[n+k],k+=O,w-=8);for(_=f&(1<<-w)-1,f>>=-w,w+=c;w>0;_=256*_+u[n+k],k+=O,w-=8);if(f===0)f=1-D;else{if(f===A)return _?NaN:1/0*(I?-1:1);_+=Math.pow(2,c),f-=D}return(I?-1:1)*_*Math.pow(2,f-c)},jw.write=function(u,n,s,c,g,f){var _,T,A,D=8*f-g-1,w=(1<<D)-1,k=w>>1,O=g===23?Math.pow(2,-24)-Math.pow(2,-77):0,I=c?0:f-1,R=c?1:-1,B=n<0||n===0&&1/n<0?1:0;for(n=Math.abs(n),isNaN(n)||n===1/0?(T=isNaN(n)?1:0,_=w):(_=Math.floor(Math.log(n)/Math.LN2),n*(A=Math.pow(2,-_))<1&&(_--,A*=2),(n+=_+k>=1?O/A:O*Math.pow(2,1-k))*A>=2&&(_++,A/=2),_+k>=w?(T=0,_=w):_+k>=1?(T=(n*A-1)*Math.pow(2,g),_+=k):(T=n*Math.pow(2,k-1)*Math.pow(2,g),_=0));g>=8;u[s+I]=255&T,I+=R,T/=256,g-=8);for(_=_<<g|T,D+=g;D>0;u[s+I]=255&_,I+=R,_/=256,D-=8);u[s+I-R]|=128*B}),jw}function UI(){if($I)return Uw;$I=1,Uw=n;var u=W5();function n(Q){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(Q)?Q:new Uint8Array(Q||0),this.pos=0,this.type=0,this.length=this.buf.length}n.Varint=0,n.Fixed64=1,n.Bytes=2,n.Fixed32=5;var s=4294967296,c=1/s,g=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function f(Q){return Q.type===n.Bytes?Q.readVarint()+Q.pos:Q.pos+1}function _(Q,ue,ge){return ge?4294967296*ue+(Q>>>0):4294967296*(ue>>>0)+(Q>>>0)}function T(Q,ue,ge){var Se=ue<=16383?1:ue<=2097151?2:ue<=268435455?3:Math.floor(Math.log(ue)/(7*Math.LN2));ge.realloc(Se);for(var Fe=ge.pos-1;Fe>=Q;Fe--)ge.buf[Fe+Se]=ge.buf[Fe]}function A(Q,ue){for(var ge=0;ge<Q.length;ge++)ue.writeVarint(Q[ge])}function D(Q,ue){for(var ge=0;ge<Q.length;ge++)ue.writeSVarint(Q[ge])}function w(Q,ue){for(var ge=0;ge<Q.length;ge++)ue.writeFloat(Q[ge])}function k(Q,ue){for(var ge=0;ge<Q.length;ge++)ue.writeDouble(Q[ge])}function O(Q,ue){for(var ge=0;ge<Q.length;ge++)ue.writeBoolean(Q[ge])}function I(Q,ue){for(var ge=0;ge<Q.length;ge++)ue.writeFixed32(Q[ge])}function R(Q,ue){for(var ge=0;ge<Q.length;ge++)ue.writeSFixed32(Q[ge])}function B(Q,ue){for(var ge=0;ge<Q.length;ge++)ue.writeFixed64(Q[ge])}function W(Q,ue){for(var ge=0;ge<Q.length;ge++)ue.writeSFixed64(Q[ge])}function K(Q,ue){return(Q[ue]|Q[ue+1]<<8|Q[ue+2]<<16)+16777216*Q[ue+3]}function ie(Q,ue,ge){Q[ge]=ue,Q[ge+1]=ue>>>8,Q[ge+2]=ue>>>16,Q[ge+3]=ue>>>24}function oe(Q,ue){return(Q[ue]|Q[ue+1]<<8|Q[ue+2]<<16)+(Q[ue+3]<<24)}return n.prototype={destroy:function(){this.buf=null},readFields:function(Q,ue,ge){for(ge=ge||this.length;this.pos<ge;){var Se=this.readVarint(),Fe=Se>>3,ze=this.pos;this.type=7&Se,Q(Fe,ue,this),this.pos===ze&&this.skip(Se)}return ue},readMessage:function(Q,ue){return this.readFields(Q,ue,this.readVarint()+this.pos)},readFixed32:function(){var Q=K(this.buf,this.pos);return this.pos+=4,Q},readSFixed32:function(){var Q=oe(this.buf,this.pos);return this.pos+=4,Q},readFixed64:function(){var Q=K(this.buf,this.pos)+K(this.buf,this.pos+4)*s;return this.pos+=8,Q},readSFixed64:function(){var Q=K(this.buf,this.pos)+oe(this.buf,this.pos+4)*s;return this.pos+=8,Q},readFloat:function(){var Q=u.read(this.buf,this.pos,!0,23,4);return this.pos+=4,Q},readDouble:function(){var Q=u.read(this.buf,this.pos,!0,52,8);return this.pos+=8,Q},readVarint:function(Q){var ue,ge,Se=this.buf;return ue=127&(ge=Se[this.pos++]),ge<128?ue:(ue|=(127&(ge=Se[this.pos++]))<<7,ge<128?ue:(ue|=(127&(ge=Se[this.pos++]))<<14,ge<128?ue:(ue|=(127&(ge=Se[this.pos++]))<<21,ge<128?ue:function(Fe,ze,Le){var nt,$e,it=Le.buf;if(nt=(112&($e=it[Le.pos++]))>>4,$e<128||(nt|=(127&($e=it[Le.pos++]))<<3,$e<128)||(nt|=(127&($e=it[Le.pos++]))<<10,$e<128)||(nt|=(127&($e=it[Le.pos++]))<<17,$e<128)||(nt|=(127&($e=it[Le.pos++]))<<24,$e<128)||(nt|=(1&($e=it[Le.pos++]))<<31,$e<128))return _(Fe,nt,ze);throw new Error("Expected varint not more than 10 bytes")}(ue|=(15&(ge=Se[this.pos]))<<28,Q,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var Q=this.readVarint();return Q%2==1?(Q+1)/-2:Q/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var Q=this.readVarint()+this.pos,ue=this.pos;return this.pos=Q,Q-ue>=12&&g?function(ge,Se,Fe){return g.decode(ge.subarray(Se,Fe))}(this.buf,ue,Q):function(ge,Se,Fe){for(var ze="",Le=Se;Le<Fe;){var nt,$e,it,dt=ge[Le],ct=null,mt=dt>239?4:dt>223?3:dt>191?2:1;if(Le+mt>Fe)break;mt===1?dt<128&&(ct=dt):mt===2?(192&(nt=ge[Le+1]))==128&&(ct=(31&dt)<<6|63&nt)<=127&&(ct=null):mt===3?($e=ge[Le+2],(192&(nt=ge[Le+1]))==128&&(192&$e)==128&&((ct=(15&dt)<<12|(63&nt)<<6|63&$e)<=2047||ct>=55296&&ct<=57343)&&(ct=null)):mt===4&&($e=ge[Le+2],it=ge[Le+3],(192&(nt=ge[Le+1]))==128&&(192&$e)==128&&(192&it)==128&&((ct=(15&dt)<<18|(63&nt)<<12|(63&$e)<<6|63&it)<=65535||ct>=1114112)&&(ct=null)),ct===null?(ct=65533,mt=1):ct>65535&&(ct-=65536,ze+=String.fromCharCode(ct>>>10&1023|55296),ct=56320|1023&ct),ze+=String.fromCharCode(ct),Le+=mt}return ze}(this.buf,ue,Q)},readBytes:function(){var Q=this.readVarint()+this.pos,ue=this.buf.subarray(this.pos,Q);return this.pos=Q,ue},readPackedVarint:function(Q,ue){if(this.type!==n.Bytes)return Q.push(this.readVarint(ue));var ge=f(this);for(Q=Q||[];this.pos<ge;)Q.push(this.readVarint(ue));return Q},readPackedSVarint:function(Q){if(this.type!==n.Bytes)return Q.push(this.readSVarint());var ue=f(this);for(Q=Q||[];this.pos<ue;)Q.push(this.readSVarint());return Q},readPackedBoolean:function(Q){if(this.type!==n.Bytes)return Q.push(this.readBoolean());var ue=f(this);for(Q=Q||[];this.pos<ue;)Q.push(this.readBoolean());return Q},readPackedFloat:function(Q){if(this.type!==n.Bytes)return Q.push(this.readFloat());var ue=f(this);for(Q=Q||[];this.pos<ue;)Q.push(this.readFloat());return Q},readPackedDouble:function(Q){if(this.type!==n.Bytes)return Q.push(this.readDouble());var ue=f(this);for(Q=Q||[];this.pos<ue;)Q.push(this.readDouble());return Q},readPackedFixed32:function(Q){if(this.type!==n.Bytes)return Q.push(this.readFixed32());var ue=f(this);for(Q=Q||[];this.pos<ue;)Q.push(this.readFixed32());return Q},readPackedSFixed32:function(Q){if(this.type!==n.Bytes)return Q.push(this.readSFixed32());var ue=f(this);for(Q=Q||[];this.pos<ue;)Q.push(this.readSFixed32());return Q},readPackedFixed64:function(Q){if(this.type!==n.Bytes)return Q.push(this.readFixed64());var ue=f(this);for(Q=Q||[];this.pos<ue;)Q.push(this.readFixed64());return Q},readPackedSFixed64:function(Q){if(this.type!==n.Bytes)return Q.push(this.readSFixed64());var ue=f(this);for(Q=Q||[];this.pos<ue;)Q.push(this.readSFixed64());return Q},skip:function(Q){var ue=7&Q;if(ue===n.Varint)for(;this.buf[this.pos++]>127;);else if(ue===n.Bytes)this.pos=this.readVarint()+this.pos;else if(ue===n.Fixed32)this.pos+=4;else{if(ue!==n.Fixed64)throw new Error("Unimplemented type: "+ue);this.pos+=8}},writeTag:function(Q,ue){this.writeVarint(Q<<3|ue)},realloc:function(Q){for(var ue=this.length||16;ue<this.pos+Q;)ue*=2;if(ue!==this.length){var ge=new Uint8Array(ue);ge.set(this.buf),this.buf=ge,this.length=ue}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(Q){this.realloc(4),ie(this.buf,Q,this.pos),this.pos+=4},writeSFixed32:function(Q){this.realloc(4),ie(this.buf,Q,this.pos),this.pos+=4},writeFixed64:function(Q){this.realloc(8),ie(this.buf,-1&Q,this.pos),ie(this.buf,Math.floor(Q*c),this.pos+4),this.pos+=8},writeSFixed64:function(Q){this.realloc(8),ie(this.buf,-1&Q,this.pos),ie(this.buf,Math.floor(Q*c),this.pos+4),this.pos+=8},writeVarint:function(Q){(Q=+Q||0)>268435455||Q<0?function(ue,ge){var Se,Fe;if(ue>=0?(Se=ue%4294967296|0,Fe=ue/4294967296|0):(Fe=~(-ue/4294967296),4294967295^(Se=~(-ue%4294967296))?Se=Se+1|0:(Se=0,Fe=Fe+1|0)),ue>=18446744073709552e3||ue<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");ge.realloc(10),function(ze,Le,nt){nt.buf[nt.pos++]=127&ze|128,ze>>>=7,nt.buf[nt.pos++]=127&ze|128,ze>>>=7,nt.buf[nt.pos++]=127&ze|128,ze>>>=7,nt.buf[nt.pos++]=127&ze|128,nt.buf[nt.pos]=127&(ze>>>=7)}(Se,0,ge),function(ze,Le){var nt=(7&ze)<<4;Le.buf[Le.pos++]|=nt|((ze>>>=3)?128:0),ze&&(Le.buf[Le.pos++]=127&ze|((ze>>>=7)?128:0),ze&&(Le.buf[Le.pos++]=127&ze|((ze>>>=7)?128:0),ze&&(Le.buf[Le.pos++]=127&ze|((ze>>>=7)?128:0),ze&&(Le.buf[Le.pos++]=127&ze|((ze>>>=7)?128:0),ze&&(Le.buf[Le.pos++]=127&ze)))))}(Fe,ge)}(Q,this):(this.realloc(4),this.buf[this.pos++]=127&Q|(Q>127?128:0),Q<=127||(this.buf[this.pos++]=127&(Q>>>=7)|(Q>127?128:0),Q<=127||(this.buf[this.pos++]=127&(Q>>>=7)|(Q>127?128:0),Q<=127||(this.buf[this.pos++]=Q>>>7&127))))},writeSVarint:function(Q){this.writeVarint(Q<0?2*-Q-1:2*Q)},writeBoolean:function(Q){this.writeVarint(!!Q)},writeString:function(Q){Q=String(Q),this.realloc(4*Q.length),this.pos++;var ue=this.pos;this.pos=function(Se,Fe,ze){for(var Le,nt,$e=0;$e<Fe.length;$e++){if((Le=Fe.charCodeAt($e))>55295&&Le<57344){if(!nt){Le>56319||$e+1===Fe.length?(Se[ze++]=239,Se[ze++]=191,Se[ze++]=189):nt=Le;continue}if(Le<56320){Se[ze++]=239,Se[ze++]=191,Se[ze++]=189,nt=Le;continue}Le=nt-55296<<10|Le-56320|65536,nt=null}else nt&&(Se[ze++]=239,Se[ze++]=191,Se[ze++]=189,nt=null);Le<128?Se[ze++]=Le:(Le<2048?Se[ze++]=Le>>6|192:(Le<65536?Se[ze++]=Le>>12|224:(Se[ze++]=Le>>18|240,Se[ze++]=Le>>12&63|128),Se[ze++]=Le>>6&63|128),Se[ze++]=63&Le|128)}return ze}(this.buf,Q,this.pos);var ge=this.pos-ue;ge>=128&&T(ue,ge,this),this.pos=ue-1,this.writeVarint(ge),this.pos+=ge},writeFloat:function(Q){this.realloc(4),u.write(this.buf,Q,this.pos,!0,23,4),this.pos+=4},writeDouble:function(Q){this.realloc(8),u.write(this.buf,Q,this.pos,!0,52,8),this.pos+=8},writeBytes:function(Q){var ue=Q.length;this.writeVarint(ue),this.realloc(ue);for(var ge=0;ge<ue;ge++)this.buf[this.pos++]=Q[ge]},writeRawMessage:function(Q,ue){this.pos++;var ge=this.pos;Q(ue,this);var Se=this.pos-ge;Se>=128&&T(ge,Se,this),this.pos=ge-1,this.writeVarint(Se),this.pos+=Se},writeMessage:function(Q,ue,ge){this.writeTag(Q,n.Bytes),this.writeRawMessage(ue,ge)},writePackedVarint:function(Q,ue){ue.length&&this.writeMessage(Q,A,ue)},writePackedSVarint:function(Q,ue){ue.length&&this.writeMessage(Q,D,ue)},writePackedBoolean:function(Q,ue){ue.length&&this.writeMessage(Q,O,ue)},writePackedFloat:function(Q,ue){ue.length&&this.writeMessage(Q,w,ue)},writePackedDouble:function(Q,ue){ue.length&&this.writeMessage(Q,k,ue)},writePackedFixed32:function(Q,ue){ue.length&&this.writeMessage(Q,I,ue)},writePackedSFixed32:function(Q,ue){ue.length&&this.writeMessage(Q,R,ue)},writePackedFixed64:function(Q,ue){ue.length&&this.writeMessage(Q,B,ue)},writePackedSFixed64:function(Q,ue){ue.length&&this.writeMessage(Q,W,ue)},writeBytesField:function(Q,ue){this.writeTag(Q,n.Bytes),this.writeBytes(ue)},writeFixed32Field:function(Q,ue){this.writeTag(Q,n.Fixed32),this.writeFixed32(ue)},writeSFixed32Field:function(Q,ue){this.writeTag(Q,n.Fixed32),this.writeSFixed32(ue)},writeFixed64Field:function(Q,ue){this.writeTag(Q,n.Fixed64),this.writeFixed64(ue)},writeSFixed64Field:function(Q,ue){this.writeTag(Q,n.Fixed64),this.writeSFixed64(ue)},writeVarintField:function(Q,ue){this.writeTag(Q,n.Varint),this.writeVarint(ue)},writeSVarintField:function(Q,ue){this.writeTag(Q,n.Varint),this.writeSVarint(ue)},writeStringField:function(Q,ue){this.writeTag(Q,n.Bytes),this.writeString(ue)},writeFloatField:function(Q,ue){this.writeTag(Q,n.Fixed32),this.writeFloat(ue)},writeDoubleField:function(Q,ue){this.writeTag(Q,n.Fixed64),this.writeDouble(ue)},writeBooleanField:function(Q,ue){this.writeVarintField(Q,!!ue)}},Uw}var z0=S(UI());const Hw=3;function q5(u,n,s){n.glyphs=[],u===1&&s.readMessage(K5,n)}function K5(u,n,s){if(u===3){const{id:c,bitmap:g,width:f,height:_,left:T,top:A,advance:D}=s.readMessage(Z5,{});n.glyphs.push({id:c,bitmap:new _d({width:f+2*Hw,height:_+2*Hw},g),metrics:{width:f,height:_,left:T,top:A,advance:D}})}else u===4?n.ascender=s.readSVarint():u===5&&(n.descender=s.readSVarint())}function Z5(u,n,s){u===1?n.id=s.readVarint():u===2?n.bitmap=s.readBytes():u===3?n.width=s.readVarint():u===4?n.height=s.readVarint():u===5?n.left=s.readSVarint():u===6?n.top=s.readSVarint():u===7&&(n.advance=s.readVarint())}const Y5=Hw,Fa={horizontal:1,vertical:2,horizontalOnly:3};class E_{constructor(){this.scale=1,this.fontStack="",this.image=null}static forText(n,s){const c=new E_;return c.scale=n||1,c.fontStack=s,c}static forImage(n){const s=new E_;return s.image=n,s}}class Hp{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(n,s){const c=new Hp;for(let g=0;g<n.sections.length;g++){const f=n.sections[g];f.image?c.addImageSection(f):c.addTextSection(f,s)}return c}length(){return this.text.length}getSection(n){return this.sections[this.sectionIndex[n]]}getSections(){return this.sections}getSectionIndex(n){return this.sectionIndex[n]}getCodePoint(n){return this.text.codePointAt(n)}verticalizePunctuation(n){this.text=function(s,c){let g="";for(let f=0;f<s.length;f++){const _=s.charCodeAt(f+1)||null,T=s.charCodeAt(f-1)||null;g+=!c&&(_&&vp(_)&&!C_[s[f+1]]||T&&vp(T)&&!C_[s[f-1]])||!C_[s[f]]?s[f]:C_[s[f]]}return g}(this.text,n)}trim(){let n=0;for(let c=0;c<this.text.length&&F0[this.text.charCodeAt(c)];c++)n++;let s=this.text.length;for(let c=this.text.length-1;c>=0&&c>=n&&F0[this.text.charCodeAt(c)];c--)s--;this.text=this.text.substring(n,s),this.sectionIndex=this.sectionIndex.slice(n,s)}substring(n,s){const c=new Hp;return c.text=this.text.substring(n,s),c.sectionIndex=this.sectionIndex.slice(n,s),c.sections=this.sections,c}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((n,s)=>Math.max(n,this.sections[s].scale),0)}addTextSection(n,s){this.text+=n.text,this.sections.push(E_.forText(n.scale,n.fontStack||s));const c=this.sections.length-1;for(let g=0;g<n.text.length;++g)this.sectionIndex.push(c)}addImageSection(n){const s=n.image&&n.image.namePrimary?n.image.getPrimary():null;if(!s)return void xn("Can't add FormattedSection with an empty image.");const c=this.getNextImageSectionCharCode();c?(this.text+=String.fromCodePoint(c),this.sections.push(E_.forImage(s)),this.sectionIndex.push(this.sections.length-1)):xn("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function Gw(u,n,s,c,g,f,_,T,A,D,w,k,O,I,R){const B=Hp.fromFeature(u,g);k===Fa.vertical&&B.verticalizePunctuation(O);let W=[];const K=function(ge,Se,Fe,ze,Le,nt){if(!ge)return[];const $e=[],it=function(wt,Mt,vt,qt,mn,Zt){let Tn=0;for(let Sn=0;Sn<wt.length();Sn++){const On=wt.getSection(Sn);Tn+=jI(wt.getCodePoint(Sn),On,qt,mn,Mt,Zt)}return Tn/Math.max(1,Math.ceil(Tn/vt))}(ge,Se,Fe,ze,Le,nt),dt=ge.text.indexOf("")>=0;let ct=0;for(let wt=0;wt<ge.length();wt++){const Mt=ge.getSection(wt),vt=ge.getCodePoint(wt);if(F0[vt]||(ct+=jI(vt,Mt,ze,Le,Se,nt)),wt<ge.length()-1){const qt=!((mt=vt)<11904||!(tr["Bopomofo Extended"](mt)||tr.Bopomofo(mt)||tr["CJK Compatibility Forms"](mt)||tr["CJK Compatibility Ideographs"](mt)||tr["CJK Compatibility"](mt)||tr["CJK Radicals Supplement"](mt)||tr["CJK Strokes"](mt)||tr["CJK Symbols and Punctuation"](mt)||tr["CJK Unified Ideographs Extension A"](mt)||tr["CJK Unified Ideographs"](mt)||tr["Enclosed CJK Letters and Months"](mt)||tr["Halfwidth and Fullwidth Forms"](mt)||tr.Hiragana(mt)||tr["Ideographic Description Characters"](mt)||tr["Kangxi Radicals"](mt)||tr["Katakana Phonetic Extensions"](mt)||tr.Katakana(mt)||tr["Vertical Forms"](mt)||tr["Yi Radicals"](mt)||tr["Yi Syllables"](mt)));(X5[vt]||qt||Mt.image)&&$e.push(GI(wt+1,ct,it,$e,J5(vt,ge.getCodePoint(wt+1),qt&&dt),!1))}}var mt;return WI(GI(ge.length(),ct,it,$e,0,!0))}(B,D,f,n,c,I),{processBidirectionalText:ie,processStyledBidirectionalText:oe}=Is;if(ie&&B.sections.length===1){const ge=ie(B.toString(),K);for(const Se of ge){const Fe=new Hp;Fe.text=Se,Fe.sections=B.sections;for(let ze=0;ze<Se.length;ze++)Fe.sectionIndex.push(0);W.push(Fe)}}else if(oe){const ge=oe(B.text,B.sectionIndex,K);for(const Se of ge){const Fe=new Hp;Fe.text=Se[0],Fe.sectionIndex=Se[1],Fe.sections=B.sections,W.push(Fe)}}else W=function(ge,Se){const Fe=[],ze=ge.text;let Le=0;for(const nt of Se)Fe.push(ge.substring(Le,nt)),Le=nt;return Le<ze.length&&Fe.push(ge.substring(Le,ze.length)),Fe}(B,K);const Q=[],ue={positionedLines:Q,text:B.toString(),top:w[1],bottom:w[1],left:w[0],right:w[0],writingMode:k,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(ge,Se,Fe,ze,Le,nt,$e,it,dt,ct,mt,wt){let Mt=0,vt=0,qt=0;const mn=it==="right"?1:it==="left"?0:.5;let Zt=!1;for(const In of Le){const qn=In.getSections();for(const ar of qn){if(ar.image)continue;const Mr=Se[ar.fontStack];if(Mr&&(Zt=Mr.ascender!==void 0&&Mr.descender!==void 0,!Zt))break}if(!Zt)break}let Tn=0;for(const In of Le){In.trim();const qn=In.getMaxScale(),ar=(qn-1)*Xo,Mr={positionedGlyphs:[],lineOffset:0};ge.positionedLines[Tn]=Mr;const Pr=Mr.positionedGlyphs;let Br=0;if(!In.length()){vt+=nt,++Tn;continue}let Rr=0,Ur=0;for(let gi=0;gi<In.length();gi++){const Sr=In.getSection(gi),_i=In.getSectionIndex(gi),fi=In.getCodePoint(gi);let Mi=Sr.scale,wo=null,So=null,so=null,Os=Xo,Wi=0;const qi=!(dt===Fa.horizontal||!mt&&!yp(fi)||mt&&(F0[fi]||(Sn=fi,tr.Arabic(Sn)||tr["Arabic Supplement"](Sn)||tr["Arabic Extended-A"](Sn)||tr["Arabic Presentation Forms-A"](Sn)||tr["Arabic Presentation Forms-B"](Sn))));if(Sr.image){const ps=ze[Sr.image.serialize()];if(!ps)continue;so=Sr.image.id,ge.iconsInText=ge.iconsInText||!0,So=ps.paddedRect;const To=ps.displaySize;Mi=Mi*Xo/wt,wo={width:To[0],height:To[1],left:0,top:-3,advance:qi?To[1]:To[0],localGlyph:!1},Wi=Zt?-wo.height*Mi:qn*Xo-17-To[1]*Mi,Os=wo.advance;const Gs=(qi?To[0]:To[1])*Mi-Xo*qn;Gs>0&&Gs>Br&&(Br=Gs)}else{const ps=Fe[Sr.fontStack];if(!ps)continue;ps[fi]&&(So=ps[fi]);const To=Se[Sr.fontStack];if(!To)continue;const Gs=To.glyphs[fi];if(!Gs)continue;if(wo=Gs.metrics,Os=fi!==8203?Xo:0,Zt){const Po=To.ascender!==void 0?Math.abs(To.ascender):0,Cu=To.descender!==void 0?Math.abs(To.descender):0,Sd=(Po+Cu)*Mi;Rr<Sd&&(Rr=Sd,Ur=(Po-Cu)/2*Mi),Wi=-Po*Mi}else Wi=(qn-Mi)*Xo-17}qi?(ge.verticalizable=!0,Pr.push({glyph:fi,imageName:so,x:Mt,y:vt+Wi,vertical:qi,scale:Mi,localGlyph:wo.localGlyph,fontStack:Sr.fontStack,sectionIndex:_i,metrics:wo,rect:So}),Mt+=Os*Mi+ct):(Pr.push({glyph:fi,imageName:so,x:Mt,y:vt+Wi,vertical:qi,scale:Mi,localGlyph:wo.localGlyph,fontStack:Sr.fontStack,sectionIndex:_i,metrics:wo,rect:So}),Mt+=wo.advance*Mi+ct)}Pr.length!==0&&(qt=Math.max(Mt-ct,qt),Zt?qI(Pr,mn,Br,Ur,nt*qn/2):qI(Pr,mn,Br,0,nt/2)),Mt=0;const Ei=nt*qn+Br;Mr.lineOffset=Math.max(Br,ar),vt+=Ei,++Tn}var Sn;const On=vt,{horizontalAlign:nn,verticalAlign:Yn}=Ww($e);(function(In,qn,ar,Mr,Pr,Br){const Rr=(qn-ar)*Pr,Ur=-Br*Mr;for(const Ei of In)for(const gi of Ei.positionedGlyphs)gi.x+=Rr,gi.y+=Ur})(ge.positionedLines,mn,nn,Yn,qt,On),ge.top+=-Yn*On,ge.bottom=ge.top+On,ge.left+=-nn*qt,ge.right=ge.left+qt,ge.hasBaseline=Zt}(ue,n,s,c,W,_,T,A,k,D,O,R),!function(ge){for(const Se of ge)if(Se.positionedGlyphs.length!==0)return!1;return!0}(Q)&&ue}const F0={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},X5={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function jI(u,n,s,c,g,f){if(n.image){const _=c[n.image.serialize()];return _?_.displaySize[0]*n.scale*Xo/f+g:0}{const _=s[n.fontStack],T=_&&_.glyphs[u];return T?T.metrics.advance*n.scale+g:0}}function HI(u,n,s,c){const g=Math.pow(u-n,2);return c?u<n?g/2:2*g:g+Math.abs(s)*s}function J5(u,n,s){let c=0;return u===10&&(c-=1e4),s&&(c+=150),u!==40&&u!==65288||(c+=50),n!==41&&n!==65289||(c+=50),c}function GI(u,n,s,c,g,f){let _=null,T=HI(n,s,g,f);for(const A of c){const D=HI(n-A.x,s,g,f)+A.badness;D<=T&&(_=A,T=D)}return{index:u,x:n,priorBreak:_,badness:T}}function WI(u){return u?WI(u.priorBreak).concat(u.index):[]}function Ww(u){let n=.5,s=.5;switch(u){case"right":case"top-right":case"bottom-right":n=1;break;case"left":case"top-left":case"bottom-left":n=0}switch(u){case"bottom":case"bottom-right":case"bottom-left":s=1;break;case"top":case"top-right":case"top-left":s=0}return{horizontalAlign:n,verticalAlign:s}}function qI(u,n,s,c,g){if(!(n||s||c||g))return;const f=u.length-1,_=u[f],T=(_.x+_.metrics.advance*_.scale)*n;for(let A=0;A<=f;A++)u[A].x-=T,u[A].y+=s+c+g}function Q5(u,n,s,c){const{horizontalAlign:g,verticalAlign:f}=Ww(c),_=s[0]-u.displaySize[0]*g,T=s[1]-u.displaySize[1]*f;return{imagePrimary:u,imageSecondary:n,top:T,bottom:T+u.displaySize[1],left:_,right:_+u.displaySize[0]}}function KI(u,n,s,c,g,f){const _=u.imagePrimary;let T;if(_.content){const W=_.content,K=_.pixelRatio||1;T=[W[0]/K,W[1]/K,_.displaySize[0]-W[2]/K,_.displaySize[1]-W[3]/K]}const A=n.left*f,D=n.right*f;let w,k,O,I;s==="width"||s==="both"?(I=g[0]+A-c[3],k=g[0]+D+c[1]):(I=g[0]+(A+D-_.displaySize[0])/2,k=I+_.displaySize[0]);const R=n.top*f,B=n.bottom*f;return s==="height"||s==="both"?(w=g[1]+R-c[0],O=g[1]+B+c[2]):(w=g[1]+(R+B-_.displaySize[1])/2,O=w+_.displaySize[1]),{imagePrimary:_,imageSecondary:void 0,top:w,right:k,bottom:O,left:I,collisionPadding:T}}class mc extends Je{constructor(n,s,c,g,f){super(n,s),this.angle=g,this.z=c,f!==void 0&&(this.segment=f)}clone(){return new mc(this.x,this.y,this.z,this.angle,this.segment)}}function ZI(u,n,s,c,g){if(n.segment===void 0)return!0;let f=n,_=n.segment+1,T=0;for(;T>-s/2;){if(_--,_<0)return!1;T-=u[_].dist(f),f=u[_]}T+=u[_].dist(u[_+1]),_++;const A=[];let D=0;for(;T<s/2;){const w=u[_],k=u[_+1];if(!k)return!1;let O=u[_-1].angleTo(w)-w.angleTo(k);for(O=Math.abs((O+3*Math.PI)%(2*Math.PI)-Math.PI),A.push({distance:T,angleDelta:O}),D+=O;T-A[0].distance>c;)D-=A.shift().angleDelta;if(D>g)return!1;_++,T+=w.dist(k)}return!0}function YI(u){let n=0;for(let s=0;s<u.length-1;s++)n+=u[s].dist(u[s+1]);return n}function XI(u,n,s){return u?.6*n*s:0}function JI(u,n){return Math.max(u?u.right-u.left:0,n?n.right-n.left:0)}function eV(u,n,s,c,g,f){const _=XI(s,g,f),T=JI(s,c)*f;let A=0;const D=YI(u)/2;for(let w=0;w<u.length-1;w++){const k=u[w],O=u[w+1],I=k.dist(O);if(A+I>D){const R=(D-A)/I,B=pr(k.x,O.x,R),W=pr(k.y,O.y,R),K=new mc(B,W,0,O.angleTo(k),w);return!_||ZI(u,K,T,_,n)?K:void 0}A+=I}}function tV(u,n,s,c,g,f,_,T,A){const D=XI(c,f,_),w=JI(c,g),k=w*_,O=u[0].x===0||u[0].x===A||u[0].y===0||u[0].y===A;return n-k<n/4&&(n=k+n/4),QI(u,O?n/2*T%n:(w/2+2*f)*_*T%n,n,D,s,k,O,!1,A)}function QI(u,n,s,c,g,f,_,T,A){const D=f/2,w=YI(u);let k=0,O=n-s,I=[];for(let R=0;R<u.length-1;R++){const B=u[R],W=u[R+1],K=B.dist(W),ie=W.angleTo(B);for(;O+s<k+K;){O+=s;const oe=(O-k)/K,Q=pr(B.x,W.x,oe),ue=pr(B.y,W.y,oe);if(Q>=0&&Q<A&&ue>=0&&ue<A&&O-D>=0&&O+D<=w){const ge=new mc(Q,ue,0,ie,R);c&&!ZI(u,ge,f,c,g)||I.push(ge)}}k+=K}return T||I.length||_||(I=QI(u,k/2,s,c,g,f,_,!0,A)),I}function eA(u,n,s,c,g){const f=[];for(let _=0;_<u.length;_++){const T=u[_];let A;for(let D=0;D<T.length-1;D++){let w=T[D],k=T[D+1];w.x<n&&k.x<n||(w.x<n?w=new Je(n,w.y+(n-w.x)/(k.x-w.x)*(k.y-w.y))._round():k.x<n&&(k=new Je(n,w.y+(n-w.x)/(k.x-w.x)*(k.y-w.y))._round()),w.y<s&&k.y<s||(w.y<s?w=new Je(w.x+(s-w.y)/(k.y-w.y)*(k.x-w.x),s)._round():k.y<s&&(k=new Je(w.x+(s-w.y)/(k.y-w.y)*(k.x-w.x),s)._round()),w.x>=c&&k.x>=c||(w.x>=c?w=new Je(c,w.y+(c-w.x)/(k.x-w.x)*(k.y-w.y))._round():k.x>=c&&(k=new Je(c,w.y+(c-w.x)/(k.x-w.x)*(k.y-w.y))._round()),w.y>=g&&k.y>=g||(w.y>=g?w=new Je(w.x+(g-w.y)/(k.y-w.y)*(k.x-w.x),g)._round():k.y>=g&&(k=new Je(w.x+(g-w.y)/(k.y-w.y)*(k.x-w.x),g)._round()),A&&w.equals(A[A.length-1])||(A=[w],f.push(A)),A.push(k)))))}}return f}function tA(u){let n=0,s=0;for(const _ of u)n+=_.w*_.h,s=Math.max(s,_.w);u.sort((_,T)=>T.h-_.h);const c=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(n/.95)),s),h:1/0}];let g=0,f=0;for(const _ of u)for(let T=c.length-1;T>=0;T--){const A=c[T];if(!(_.w>A.w||_.h>A.h)){if(_.x=A.x,_.y=A.y,f=Math.max(f,_.y+_.h),g=Math.max(g,_.x+_.w),_.w===A.w&&_.h===A.h){const D=c.pop();T<c.length&&(c[T]=D)}else _.h===A.h?(A.x+=_.w,A.w-=_.w):_.w===A.w?(A.y+=_.h,A.h-=_.h):(c.push({x:A.x+_.w,y:A.y,w:A.w-_.w,h:_.h}),A.y+=_.h,A.h-=_.h);break}}return{w:g,h:f,fill:n/(g*f)||0}}Gn(mc,"Anchor");const M_=1;class qw{constructor(n,{pixelRatio:s,version:c,stretchX:g,stretchY:f,content:_},T){this.paddedRect=n,this.pixelRatio=s,this.stretchX=g,this.stretchY=f,this.content=_,this.version=c,this.padding=T}get tl(){return[this.paddedRect.x+this.padding,this.paddedRect.y+this.padding]}get br(){return[this.paddedRect.x+this.paddedRect.w-this.padding,this.paddedRect.y+this.paddedRect.h-this.padding]}get displaySize(){return[(this.paddedRect.w-2*this.padding)/this.pixelRatio,(this.paddedRect.h-2*this.padding)/this.pixelRatio]}}class nA{constructor(n,s,c){const g={},f={};this.haveRenderCallbacks=[];const _=[];this.addImages(n,g,M_,_),this.addImages(s,f,2,_);const{w:T,h:A}=tA(_),D=new ss({width:T||1,height:A||1});for(const w in n){const k=n[w],O=g[w].paddedRect;ss.copy(k.data,D,{x:0,y:0},{x:O.x+M_,y:O.y+M_},k.data,c,k.sdf)}for(const w in s){const k=s[w],O=f[w].paddedRect;let I=f[w].padding;const R=O.x+I,B=O.y+I,W=k.data.width,K=k.data.height;I=I>1?I-1:I,ss.copy(k.data,D,{x:0,y:0},{x:R,y:B},k.data,c),ss.copy(k.data,D,{x:0,y:K-I},{x:R,y:B-I},{width:W,height:I},c),ss.copy(k.data,D,{x:0,y:0},{x:R,y:B+K},{width:W,height:I},c),ss.copy(k.data,D,{x:W-I,y:0},{x:R-I,y:B},{width:I,height:K},c),ss.copy(k.data,D,{x:0,y:0},{x:R+W,y:B},{width:I,height:K},c),ss.copy(k.data,D,{x:W-I,y:K-I},{x:R-I,y:B-I},{width:I,height:I},c),ss.copy(k.data,D,{x:0,y:K-I},{x:R+W,y:B-I},{width:I,height:I},c),ss.copy(k.data,D,{x:0,y:0},{x:R+W,y:B+K},{width:I,height:I},c),ss.copy(k.data,D,{x:W-I,y:0},{x:R-I,y:B+K},{width:I,height:I},c)}this.image=D,this.iconPositions=g,this.patternPositions=f}addImages(n,s,c,g){for(const f in n){const _=n[f],T={x:0,y:0,w:_.data.width+2*c,h:_.data.height+2*c};g.push(T),s[f]=new qw(T,_,c),_.hasRenderCallback&&this.haveRenderCallbacks.push(Za.deserializeId(f))}}patchUpdatedImages(n,s,c){this.haveRenderCallbacks=this.haveRenderCallbacks.filter(g=>n.hasImage(g,c)),n.dispatchRenderCallbacks(this.haveRenderCallbacks,c);for(const g in n.getUpdatedImages(c)){for(const f of Object.keys(this.iconPositions))Za.deserializeId(f)===g&&this.patchUpdatedImage(this.iconPositions[f],n.getImage(g,c),s);for(const f of Object.keys(this.patternPositions))Za.deserializeId(f)===g&&this.patchUpdatedImage(this.patternPositions[f],n.getImage(g,c),s)}}patchUpdatedImage(n,s,c){if(!n||!s||n.version===s.version)return;n.version=s.version;const[g,f]=n.tl;c.update(s.data,{position:{x:g,y:f}})}}Gn(qw,"ImagePosition"),Gn(nA,"ImageAtlas");const N0=1e20;function rA(u,n,s,c,g,f,_,T,A){for(let D=n;D<n+c;D++)iA(u,s*f+D,f,g,_,T,A);for(let D=s;D<s+g;D++)iA(u,D*f+n,1,c,_,T,A)}function iA(u,n,s,c,g,f,_){f[0]=0,_[0]=-1e20,_[1]=N0,g[0]=u[n];for(let T=1,A=0,D=0;T<c;T++){g[T]=u[n+T*s];const w=T*T;do{const k=f[A];D=(g[T]-g[k]+w-k*k)/(T-k)/2}while(D<=_[A]&&--A>-1);A++,f[A]=T,_[A]=D,_[A+1]=N0}for(let T=0,A=0;T<c;T++){for(;_[A+1]<T;)A++;const D=f[A],w=T-D;u[n+T*s]=g[D]+w*w}}const zl=2,Kw={none:0,ideographs:1,all:2};class Gp{constructor(n,s,c){this.requestManager=n,this.localGlyphMode=s,this.localFontFamily=c,this.urls={},this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(n,s){this.urls[s]=n}getGlyphs(n,s,c){const g=[],f=this.urls[s]||He.GLYPHS_URL;for(const _ in n)for(const T of n[_])g.push({stack:_,id:T});vr(g,({stack:_,id:T},A)=>{let D=this.entries[_];D||(D=this.entries[_]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let w=D.glyphs[T];if(w!==void 0)return void A(null,{stack:_,id:T,glyph:w});if(w=this._tinySDF(D,_,T),w)return D.glyphs[T]=w,void A(null,{stack:_,id:T,glyph:w});const k=Math.floor(T/256);if(256*k>65535)return xn("glyphs > 65535 not supported"),void A(null,{stack:_,id:T,glyph:w});if(D.ranges[k])return void A(null,{stack:_,id:T,glyph:w});let O=D.requests[k];O||(O=D.requests[k]=[],Gp.loadGlyphRange(_,k,f,this.requestManager,(I,R)=>{if(R){D.ascender=R.ascender,D.descender=R.descender;for(const B in R.glyphs)this._doesCharSupportLocalGlyph(+B)||(D.glyphs[+B]=R.glyphs[+B]);D.ranges[k]=!0}for(const B of O)B(I,R);delete D.requests[k]})),O.push((I,R)=>{I?A(I):R&&A(null,{stack:_,id:T,glyph:R.glyphs[T]||null})})},(_,T)=>{if(_)c(_);else if(T){const A={};for(const{stack:D,id:w,glyph:k}of T)A[D]===void 0&&(A[D]={}),A[D].glyphs===void 0&&(A[D].glyphs={}),A[D].glyphs[w]=k&&{id:k.id,bitmap:k.bitmap.clone(),metrics:k.metrics},A[D].ascender=this.entries[D].ascender,A[D].descender=this.entries[D].descender;c(null,A)}})}_doesCharSupportLocalGlyph(n){return this.localGlyphMode!==Kw.none&&(this.localGlyphMode===Kw.all?!!this.localFontFamily:!!this.localFontFamily&&(tr["CJK Unified Ideographs"](n)||tr["Hangul Syllables"](n)||tr.Hiragana(n)||tr.Katakana(n)||tr["CJK Symbols and Punctuation"](n)||tr["CJK Unified Ideographs Extension A"](n)||tr["CJK Unified Ideographs Extension B"](n)||tr.Osage(n)))}_tinySDF(n,s,c){const g=this.localFontFamily;if(!g||!this._doesCharSupportLocalGlyph(c))return;let f=n.tinySDF;if(!f){let B="400";/bold/i.test(s)?B="900":/medium/i.test(s)?B="500":/light/i.test(s)&&(B="200"),f=n.tinySDF=new Gp.TinySDF({fontFamily:g,fontWeight:B,fontSize:24*zl,buffer:3*zl,radius:8*zl}),f.fontWeight=B}if(this.localGlyphs[f.fontWeight][c])return this.localGlyphs[f.fontWeight][c];const _=String.fromCodePoint(c),{data:T,width:A,height:D,glyphWidth:w,glyphHeight:k,glyphLeft:O,glyphTop:I,glyphAdvance:R}=f.draw(_);return this.localGlyphs[f.fontWeight][c]={id:c,bitmap:new _d({width:A,height:D},T),metrics:{width:w/zl,height:k/zl,left:O/zl,top:I/zl-27,advance:R/zl,localGlyph:!0}}}}Gp.loadGlyphRange=function(u,n,s,c,g){const f=256*n,_=f+255,T=c.transformRequest(c.normalizeGlyphsURL(s).replace("{fontstack}",u).replace("{range}",`${f}-${_}`),_l.Glyphs);Zu(T,(A,D)=>{if(A)g(A);else if(D){const w={},k=function(O){return new z0(O).readFields(q5,{})}(D);for(const O of k.glyphs)w[O.id]=O;g(null,{glyphs:w,ascender:k.ascender,descender:k.descender})}})},Gp.TinySDF=class{constructor({fontSize:u=24,buffer:n=3,radius:s=8,cutoff:c=.25,fontFamily:g="sans-serif",fontWeight:f="normal",fontStyle:_="normal"}={}){this.buffer=n,this.cutoff=c,this.radius=s;const T=this.size=u+4*n,A=this._createCanvas(T),D=this.ctx=A.getContext("2d",{willReadFrequently:!0});D.font=`${_} ${f} ${u}px ${g}`,D.textBaseline="alphabetic",D.textAlign="left",D.fillStyle="black",this.gridOuter=new Float64Array(T*T),this.gridInner=new Float64Array(T*T),this.f=new Float64Array(T),this.z=new Float64Array(T+1),this.v=new Uint16Array(T)}_createCanvas(u){const n=document.createElement("canvas");return n.width=n.height=u,n}draw(u){const{width:n,actualBoundingBoxAscent:s,actualBoundingBoxDescent:c,actualBoundingBoxLeft:g,actualBoundingBoxRight:f}=this.ctx.measureText(u),_=Math.ceil(s),T=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(f-g))),A=Math.min(this.size-this.buffer,_+Math.ceil(c)),D=T+2*this.buffer,w=A+2*this.buffer,k=Math.max(D*w,0),O=new Uint8ClampedArray(k),I={data:O,width:D,height:w,glyphWidth:T,glyphHeight:A,glyphTop:_,glyphLeft:0,glyphAdvance:n};if(T===0||A===0)return I;const{ctx:R,buffer:B,gridInner:W,gridOuter:K}=this;R.clearRect(B,B,T,A),R.fillText(u,B,B+_);const ie=R.getImageData(B,B,T,A);K.fill(N0,0,k),W.fill(0,0,k);for(let oe=0;oe<A;oe++)for(let Q=0;Q<T;Q++){const ue=ie.data[4*(oe*T+Q)+3]/255;if(ue===0)continue;const ge=(oe+B)*D+Q+B;if(ue===1)K[ge]=0,W[ge]=N0;else{const Se=.5-ue;K[ge]=Se>0?Se*Se:0,W[ge]=Se<0?Se*Se:0}}rA(K,0,0,D,w,D,this.f,this.v,this.z),rA(W,B,B,T,A,D,this.f,this.v,this.z);for(let oe=0;oe<k;oe++){const Q=Math.sqrt(K[oe])-Math.sqrt(W[oe]);O[oe]=Math.round(255-255*(Q/this.radius+this.cutoff))}return I}};const Wf=M_;function oA(u,n){return u+n[1]-n[0]}function sA(u,n,s,c,g=1){const f=[],_=u.imagePrimary,T=_.pixelRatio,A=_.paddedRect.w-2*Wf,D=_.paddedRect.h-2*Wf,w=(u.right-u.left)*g,k=(u.bottom-u.top)*g,O=_.stretchX||[[0,A]],I=_.stretchY||[[0,D]],R=O.reduce(oA,0),B=I.reduce(oA,0),W=A-R,K=D-B;let ie=0,oe=R,Q=0,ue=B,ge=0,Se=W,Fe=0,ze=K;if(_.content&&c){const nt=_.content;ie=B0(O,0,nt[0]),Q=B0(I,0,nt[1]),oe=B0(O,nt[0],nt[2]),ue=B0(I,nt[1],nt[3]),ge=nt[0]-ie,Fe=nt[1]-Q,Se=nt[2]-nt[0]-oe,ze=nt[3]-nt[1]-ue}const Le=(nt,$e,it,dt)=>{const ct=V0(nt.stretch-ie,oe,w,u.left*g),mt=$0(nt.fixed-ge,Se,nt.stretch,R),wt=V0($e.stretch-Q,ue,k,u.top*g),Mt=$0($e.fixed-Fe,ze,$e.stretch,B),vt=V0(it.stretch-ie,oe,w,u.left*g),qt=$0(it.fixed-ge,Se,it.stretch,R),mn=V0(dt.stretch-Q,ue,k,u.top*g),Zt=$0(dt.fixed-Fe,ze,dt.stretch,B),Tn=new Je(ct,wt),Sn=new Je(vt,wt),On=new Je(vt,mn),nn=new Je(ct,mn),Yn=new Je(mt/T,Mt/T),In=new Je(qt/T,Zt/T),qn=n*Math.PI/180;if(qn){const Ur=Math.sin(qn),Ei=Math.cos(qn),gi=[Ei,-Ur,Ur,Ei];Tn._matMult(gi),Sn._matMult(gi),nn._matMult(gi),On._matMult(gi)}const ar=nt.stretch+nt.fixed,Mr=it.stretch+it.fixed,Pr=$e.stretch+$e.fixed,Br=dt.stretch+dt.fixed,Rr=u.imageSecondary;return{tl:Tn,tr:Sn,bl:nn,br:On,texPrimary:{x:_.paddedRect.x+Wf+ar,y:_.paddedRect.y+Wf+Pr,w:Mr-ar,h:Br-Pr},texSecondary:Rr?{x:Rr.paddedRect.x+Wf+ar,y:Rr.paddedRect.y+Wf+Pr,w:Mr-ar,h:Br-Pr}:void 0,writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Yn,pixelOffsetBR:In,minFontScaleX:Se/T/w,minFontScaleY:ze/T/k,isSDF:s}};if(c&&(_.stretchX||_.stretchY)){const nt=aA(O,W,R),$e=aA(I,K,B);for(let it=0;it<nt.length-1;it++){const dt=nt[it],ct=nt[it+1];for(let mt=0;mt<$e.length-1;mt++)f.push(Le(dt,$e[mt],ct,$e[mt+1]))}}else f.push(Le({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:A+1},{fixed:0,stretch:D+1}));return f}function B0(u,n,s){let c=0;for(const g of u)c+=Math.max(n,Math.min(s,g[1]))-Math.max(n,Math.min(s,g[0]));return c}function aA(u,n,s){const c=[{fixed:-1,stretch:0}];for(const[g,f]of u){const _=c[c.length-1];c.push({fixed:g-_.stretch,stretch:_.stretch}),c.push({fixed:g-_.stretch,stretch:_.stretch+(f-g)})}return c.push({fixed:n+Wf,stretch:s}),c}function V0(u,n,s,c){return u/n*s+c}function $0(u,n,s,c){return u-n*s/c}function nV(u,n,s,c){const g=n+u.positionedLines[c].lineOffset;return c===0?s+g/2:s+(g+(n+u.positionedLines[c-1].lineOffset))/2}function rV(u,n=1,s=!1){let c=1/0,g=1/0,f=-1/0,_=-1/0;const T=u[0];for(let I=0;I<T.length;I++){const R=T[I];(!I||R.x<c)&&(c=R.x),(!I||R.y<g)&&(g=R.y),(!I||R.x>f)&&(f=R.x),(!I||R.y>_)&&(_=R.y)}const A=Math.min(f-c,_-g);let D=A/2;const w=new Jh([],iV);if(A===0)return new Je(c,g);for(let I=c;I<f;I+=A)for(let R=g;R<_;R+=A)w.push(new Wp(I+D,R+D,D,u));let k=function(I){let R=0,B=0,W=0;const K=I[0];for(let ie=0,oe=K.length,Q=oe-1;ie<oe;Q=ie++){const ue=K[ie],ge=K[Q],Se=ue.x*ge.y-ge.x*ue.y;B+=(ue.x+ge.x)*Se,W+=(ue.y+ge.y)*Se,R+=3*Se}return new Wp(B/R,W/R,0,I)}(u),O=w.length;for(;w.length;){const I=w.pop();(I.d>k.d||!k.d)&&(k=I,s&&console.log("found best %d after %d probes",Math.round(1e4*I.d)/1e4,O)),I.max-k.d<=n||(D=I.h/2,w.push(new Wp(I.p.x-D,I.p.y-D,D,u)),w.push(new Wp(I.p.x+D,I.p.y-D,D,u)),w.push(new Wp(I.p.x-D,I.p.y+D,D,u)),w.push(new Wp(I.p.x+D,I.p.y+D,D,u)),O+=4)}return s&&(console.log(`num probes: ${O}`),console.log(`best distance: ${k.d}`)),k.p}function iV(u,n){return n.max-u.max}class Wp{constructor(n,s,c,g){this.p=new Je(n,s),this.h=c,this.d=function(f,_){let T=!1,A=1/0;for(let D=0;D<_.length;D++){const w=_[D];for(let k=0,O=w.length,I=O-1;k<O;I=k++){const R=w[k],B=w[I];R.y>f.y!=B.y>f.y&&f.x<(B.x-R.x)*(f.y-R.y)/(B.y-R.y)+R.x&&(T=!T),A=Math.min(A,Ke(f,R,B))}}return(T?1:-1)*Math.sqrt(A)}(this.p,g),this.max=this.d+this.h*Math.SQRT2}}const Zw=Number.POSITIVE_INFINITY,oV=Math.sqrt(2);function lA(u,[n,s]){let c=0,g=0;if(s===Zw){n<0&&(n=0);const f=n/oV;switch(u){case"top-right":case"top-left":g=f-7;break;case"bottom-right":case"bottom-left":g=7-f;break;case"bottom":g=7-n;break;case"top":g=n-7}switch(u){case"top-right":case"bottom-right":c=-f;break;case"top-left":case"bottom-left":c=f;break;case"left":c=n;break;case"right":c=-n}}else{switch(n=Math.abs(n),s=Math.abs(s),u){case"top-right":case"top-left":case"top":g=s-7;break;case"bottom-right":case"bottom-left":case"bottom":g=7-s}switch(u){case"top-right":case"bottom-right":case"right":c=-n;break;case"top-left":case"bottom-left":case"left":c=n}}return[c,g]}function Yw(u){switch(u){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function sV(u,n,s,c,g,f,_,T,A,D,w,k,O,I,R,B){let W=f.textMaxSize.evaluate(n,{},O);W===void 0?W=_*f.textScaleFactor:W*=f.textScaleFactor;const K=u.layers[0].layout,ie=K.get("icon-offset").evaluate(n,{},O),oe=cA(s.horizontal)||s.vertical,Q=I.name==="globe",ue=Xo,ge=_*f.textScaleFactor/ue,Se=u.tilePixelRatio*W/ue,Fe=(mt=u.overscaling,u.zoom>18&&mt>2&&(mt>>=1),Math.max(kn/(512*mt),1)*K.get("symbol-spacing")),ze=K.get("text-padding")*u.tilePixelRatio,Le=K.get("icon-padding")*u.tilePixelRatio,nt=Pt(K.get("text-max-angle")),$e=K.get("text-rotation-alignment")==="map"&&K.get("symbol-placement")!=="point",it=K.get("icon-rotation-alignment")==="map"&&K.get("symbol-placement")!=="point",dt=K.get("symbol-placement"),ct=Fe/2;var mt;const wt=K.get("icon-text-fit").evaluate(n,{},O),Mt=K.get("icon-text-fit-padding").evaluate(n,{},O),vt=wt!=="none";let qt;u.hasAnyIconTextFit===!1&&vt&&(u.hasAnyIconTextFit=!0),c&&vt&&(u.allowVerticalPlacement&&s.vertical&&(qt=KI(c,s.vertical,wt,Mt,ie,ge)),oe&&(c=KI(c,oe,wt,Mt,ie,ge)));const mn=(Zt,Tn,Sn)=>{if(Tn.x<0||Tn.x>=kn||Tn.y<0||Tn.y>=kn)return;let On=null;if(Q){const{x:nn,y:Yn,z:In}=I.projectTilePoint(Tn.x,Tn.y,Sn);On={anchor:new mc(nn,Yn,In,0,void 0),up:I.upVector(Sn,Tn.x,Tn.y)}}(function(nn,Yn,In,qn,ar,Mr,Pr,Br,Rr,Ur,Ei,gi,Sr,_i,fi,Mi,wo,So,so,Os,Wi,qi,ps,To,Gs,Po,Cu,Sd){const Td=nn.addToLineVertexArray(Yn,qn);let gc,Cd,Ed,pb,Uk,jk,Hk,Gk=0,Wk=0,qk=0,Kk=0,P2=-1,R2=-1;const Eu={};let Zk=ff("");const Xf=In?In.anchor:Yn,O2=Rr.layout.get("icon-text-fit").evaluate(Wi,{},Po)!=="none";let L2=0,D2=0;if(Rr._unevaluatedLayout.getValue("text-radial-offset")===void 0?[L2,D2]=Rr.layout.get("text-offset").evaluate(Wi,{},Po).map(Ba=>Ba*Xo):(L2=Rr.layout.get("text-radial-offset").evaluate(Wi,{},Po)*Xo,D2=Zw),nn.allowVerticalPlacement&&ar.vertical){const Ba=ar.vertical;if(fi)jk=Xw(Ba),Br&&(Hk=Xw(Br));else{const _a=Rr.layout.get("text-rotate").evaluate(Wi,{},Po)+90;Ed=U0(Ur,Xf,Yn,Ei,gi,Sr,Ba,_i,_a,Mi),Br&&(pb=U0(Ur,Xf,Yn,Ei,gi,Sr,Br,So,_a))}}if(Mr){const Ba=nn.iconSizeData,_a=To?L0(nn.iconSizeData,nn.layers[0]._unevaluatedLayout._values["icon-size"],Po,nn.zoom,Wi):1,rm=Rr.layout.get("icon-rotate").evaluate(Wi,{},Po),Yk=sA(Mr,rm,ps,O2,To?1/_a:qi.iconScaleFactor),F2=Br?sA(Br,rm,ps,O2,qi.iconScaleFactor):void 0;Cd=U0(Ur,Xf,Yn,Ei,gi,Sr,Mr,So,rm,null,To?qi.iconScaleFactor*_a:1),Gk=4*Yk.length;let Jf=null;Ba.kind==="source"?(Jf=[Dl*Rr.layout.get("icon-size").evaluate(Wi,{},Po)*qi.iconScaleFactor],Jf[0]>vd&&xn(`${nn.layerIds[0]}: Value for "icon-size" is >= ${I_}. Reduce your "icon-size".`)):Ba.kind==="composite"&&(Jf=[Dl*qi.compositeIconSizes[0].evaluate(Wi,{},Po)*qi.iconScaleFactor,Dl*qi.compositeIconSizes[1].evaluate(Wi,{},Po)*qi.iconScaleFactor],(Jf[0]>vd||Jf[1]>vd)&&xn(`${nn.layerIds[0]}: Value for "icon-size" is >= ${I_}. Reduce your "icon-size".`)),nn.addSymbols(nn.icon,Yk,Jf,Os,so,Wi,!1,In,Yn,Td.lineStartIndex,Td.lineLength,-1,Gs,Po,Cu,Sd),P2=nn.icon.placedSymbolArray.length-1,F2&&(Wk=4*F2.length,nn.addSymbols(nn.icon,F2,Jf,Os,so,Wi,Fa.vertical,In,Yn,Td.lineStartIndex,Td.lineLength,-1,Gs,Po,Cu,Sd),R2=nn.icon.placedSymbolArray.length-1)}for(const Ba in ar.horizontal){const _a=ar.horizontal[Ba];gc||(Zk=ff(_a.text),fi?Uk=Xw(_a):gc=U0(Ur,Xf,Yn,Ei,gi,Sr,_a,_i,Rr.layout.get("text-rotate").evaluate(Wi,{},Po),Mi));const rm=_a.positionedLines.length===1;if(qk+=uA(nn,In,Yn,_a,Pr,Rr,fi,Wi,Mi,Td,ar.vertical?Fa.horizontal:Fa.horizontalOnly,rm?Object.keys(ar.horizontal):[Ba],Eu,P2,qi,Gs,Po,Cu),rm)break}ar.vertical&&(Kk+=uA(nn,In,Yn,ar.vertical,Pr,Rr,fi,Wi,Mi,Td,Fa.vertical,["vertical"],Eu,R2,qi,Gs,Po,Cu));let Md=-1;const z2=(Ba,_a)=>Ba?Math.max(Ba,_a):_a;Md=z2(Uk,Md),Md=z2(jk,Md),Md=z2(Hk,Md);const B$=Md>-1?1:0;nn.glyphOffsetArray.length>=65535&&xn("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Wi.sortKey!==void 0&&nn.addToSortKeyRanges(nn.symbolInstances.length,Wi.sortKey),nn.symbolInstances.emplaceBack(Yn.x,Yn.y,Xf.x,Xf.y,Xf.z,Eu.right>=0?Eu.right:-1,Eu.center>=0?Eu.center:-1,Eu.left>=0?Eu.left:-1,Eu.vertical>=0?Eu.vertical:-1,P2,R2,Zk,gc!==void 0?gc:nn.collisionBoxArray.length,gc!==void 0?gc+1:nn.collisionBoxArray.length,Ed!==void 0?Ed:nn.collisionBoxArray.length,Ed!==void 0?Ed+1:nn.collisionBoxArray.length,Cd!==void 0?Cd:nn.collisionBoxArray.length,Cd!==void 0?Cd+1:nn.collisionBoxArray.length,pb||nn.collisionBoxArray.length,pb?pb+1:nn.collisionBoxArray.length,Ei,qk,Kk,Gk,Wk,B$,0,L2,D2,Md,0,O2?1:0)})(u,Tn,On,Zt,s,c,g,qt,u.layers[0],u.collisionBoxArray,n.index,n.sourceLayerIndex,u.index,ze,$e,A,0,Le,it,ie,n,f,D,w,k,O,R,B)};if(dt==="line")for(const Zt of eA(n.geometry,0,0,kn,kn)){const Tn=tV(Zt,Fe,nt,s.vertical||oe,c,ue,Se,u.overscaling,kn);for(const Sn of Tn)oe&&aV(u,oe.text,ct,Sn)||mn(Zt,Sn,O)}else if(dt==="line-center"){for(const Zt of n.geometry)if(Zt.length>1){const Tn=eV(Zt,nt,s.vertical||oe,c,ue,Se);Tn&&mn(Zt,Tn,O)}}else if(n.type==="Polygon")for(const Zt of M0(n.geometry,0)){const Tn=rV(Zt,16);mn(Zt[0],new mc(Tn.x,Tn.y,0,0,void 0),O)}else if(n.type==="LineString")for(const Zt of n.geometry)mn(Zt,new mc(Zt[0].x,Zt[0].y,0,0,void 0),O);else if(n.type==="Point")for(const Zt of n.geometry)for(const Tn of Zt)mn([Tn],new mc(Tn.x,Tn.y,0,0,void 0),O)}const I_=255,vd=I_*Dl;function uA(u,n,s,c,g,f,_,T,A,D,w,k,O,I,R,B,W,K){const ie=function(ue,ge,Se,Fe,ze,Le,nt,$e){const it=[];if(ge.positionedLines.length===0)return it;const dt=Fe.layout.get("text-rotate").evaluate(Le,{})*Math.PI/180,ct=function(qt){const mn=qt[0],Zt=qt[1],Tn=mn*Zt;return Tn>0?[mn,-Zt]:Tn<0?[-mn,Zt]:mn===0?[Zt,mn]:[Zt,-mn]}(Se);let mt=Math.abs(ge.top-ge.bottom);for(const qt of ge.positionedLines)mt-=qt.lineOffset;const wt=ge.positionedLines.length,Mt=mt/wt;let vt=ge.top-Se[1];for(let qt=0;qt<wt;++qt){const mn=ge.positionedLines[qt];vt=nV(ge,Mt,vt,qt);for(const Zt of mn.positionedGlyphs){if(!Zt.rect)continue;const Tn=Zt.rect||{};let Sn=Y5+1,On=!0,nn=1,Yn=0;if(Zt.imageName){const so=nt[Lo.build(Zt.imageName).getSerializedPrimary()];if(!so)continue;if(so.sdf){xn("SDF images are not supported in formatted text and will be ignored.");continue}On=!1,nn=so.pixelRatio,Sn=M_/nn}const In=(ze||$e)&&Zt.vertical,qn=Zt.metrics.advance*Zt.scale/2,ar=Zt.metrics,Mr=Zt.rect;if(Mr===null)continue;$e&&ge.verticalizable&&(Yn=Zt.imageName?qn-Zt.metrics.width*Zt.scale/2:0);const Pr=ze?[Zt.x+qn,Zt.y]:[0,0];let Br=[0,0],Rr=[0,0],Ur=!1;ze||(In?(Rr=[Zt.x+qn+ct[0],Zt.y+ct[1]-Yn],Ur=!0):Br=[Zt.x+qn+Se[0],Zt.y+Se[1]-Yn]);const Ei=Mr.w*Zt.scale/(nn*(Zt.localGlyph?zl:1)),gi=Mr.h*Zt.scale/(nn*(Zt.localGlyph?zl:1));let Sr,_i,fi,Mi;if(In){const so=Zt.y-vt,Os=new Je(-qn,qn-so),Wi=-Math.PI/2,qi=new Je(...Rr);Sr=new Je(-qn+Br[0],Br[1]),Sr._rotateAround(Wi,Os)._add(qi),Sr.x+=-so+qn,Sr.y-=(ar.left-Sn)*Zt.scale;const ps=Zt.imageName?ar.advance*Zt.scale:Xo*Zt.scale,To=String.fromCodePoint(Zt.glyph);H5(To)?Sr.x+=(1-Sn)*Zt.scale:G5(To)?Sr.x+=ps-ar.height*Zt.scale+(-Sn-1)*Zt.scale:Sr.x+=Zt.imageName||ar.width+2*Sn===Mr.w&&ar.height+2*Sn===Mr.h?(ps-gi)/2:(ps-(ar.height+2*Sn)*Zt.scale)/2,_i=new Je(Sr.x,Sr.y-Ei),fi=new Je(Sr.x+gi,Sr.y),Mi=new Je(Sr.x+gi,Sr.y-Ei)}else{const so=(ar.left-Sn)*Zt.scale-qn+Br[0],Os=(-ar.top-Sn)*Zt.scale+Br[1],Wi=so+Ei,qi=Os+gi;Sr=new Je(so,Os),_i=new Je(Wi,Os),fi=new Je(so,qi),Mi=new Je(Wi,qi)}if(dt){let so;so=ze?new Je(0,0):Ur?new Je(ct[0],ct[1]):new Je(Se[0],Se[1]),Sr._rotateAround(dt,so),_i._rotateAround(dt,so),fi._rotateAround(dt,so),Mi._rotateAround(dt,so)}const wo=new Je(0,0),So=new Je(0,0);it.push({tl:Sr,tr:_i,bl:fi,br:Mi,texPrimary:Tn,texSecondary:void 0,writingMode:ge.writingMode,glyphOffset:Pr,sectionIndex:Zt.sectionIndex,isSDF:On,pixelOffsetTL:wo,pixelOffsetBR:So,minFontScaleX:0,minFontScaleY:0})}}return it}(0,c,A,f,_,T,g,u.allowVerticalPlacement),oe=u.textSizeData;let Q=null;oe.kind==="source"?(Q=[Dl*f.layout.get("text-size").evaluate(T,{},W)*R.textScaleFactor],Q[0]>vd&&xn(`${u.layerIds[0]}: Value for "text-size" is >= ${I_}. Reduce your "text-size".`)):oe.kind==="composite"&&(Q=[Dl*R.compositeTextSizes[0].evaluate(T,{},W)*R.textScaleFactor,Dl*R.compositeTextSizes[1].evaluate(T,{},W)*R.textScaleFactor],(Q[0]>vd||Q[1]>vd)&&xn(`${u.layerIds[0]}: Value for "text-size" is >= ${I_}. Reduce your "text-size".`)),u.addSymbols(u.text,ie,Q,A,_,T,w,n,s,D.lineStartIndex,D.lineLength,I,B,W,K,!1);for(const ue of k)O[ue]=u.text.placedSymbolArray.length-1;return 4*ie.length}function cA(u){for(const n in u)return u[n];return null}function U0(u,n,s,c,g,f,_,T,A,D,w=1){let k=_.top/w,O=_.bottom/w,I=_.left/w,R=_.right/w;const B=_.collisionPadding;if(B&&(I-=B[0],k-=B[1],R+=B[2],O+=B[3]),A){const W=new Je(I,k),K=new Je(R,k),ie=new Je(I,O),oe=new Je(R,O),Q=Pt(A);let ue=new Je(0,0);D&&(ue=new Je(D[0],D[1])),W._rotateAround(Q,ue),K._rotateAround(Q,ue),ie._rotateAround(Q,ue),oe._rotateAround(Q,ue),I=Math.min(W.x,K.x,ie.x,oe.x),R=Math.max(W.x,K.x,ie.x,oe.x),k=Math.min(W.y,K.y,ie.y,oe.y),O=Math.max(W.y,K.y,ie.y,oe.y)}return u.emplaceBack(n.x,n.y,n.z,s.x,s.y,I,k,R,O,T,c,g,f),u.length-1}function Xw(u){u.collisionPadding&&(u.top-=u.collisionPadding[1],u.bottom+=u.collisionPadding[3]);const n=u.bottom-u.top;return n>0?Math.max(10,n):null}function aV(u,n,s,c){const g=u.compareText;if(n in g){const f=g[n];for(let _=f.length-1;_>=0;_--)if(c.dist(f[_])<s)return!0}else g[n]=[];return g[n].push(c),!1}function dA(u,n){const s=u.fovAboveCenter,c=u.elevation?u.elevation.getMinElevationBelowMSL()*n:0,g=(u._camera.position[2]*u.worldSize-c)/Math.cos(u._pitch),f=Math.sin(s)*g/Math.sin(Math.max(Math.PI/2-u._pitch-s,.01));let _=Math.sin(u._pitch)*f+g;const T=g*(1/u._horizonShift);return u.elevation&&u.elevation.exaggeration()!==0||(_*=1+Math.max(u.zoom-17,0)),Math.min(1.01*_,T)}function A_(u,n){if(!n.isReprojectedInTileSpace)return{scale:1<<u.z,x:u.x,y:u.y,x2:u.x+1,y2:u.y+1,projection:n};const s=Math.pow(2,-u.z),c=u.x*s,g=(u.x+1)*s,f=u.y*s,_=(u.y+1)*s,T=ks(c),A=ks(g),D=Fo(f),w=Fo(_),k=n.project(T,D),O=n.project(A,D),I=n.project(A,w),R=n.project(T,w);let B=Math.min(k.x,O.x,I.x,R.x),W=Math.min(k.y,O.y,I.y,R.y),K=Math.max(k.x,O.x,I.x,R.x),ie=Math.max(k.y,O.y,I.y,R.y);const oe=s/16;function Q(ge,Se,Fe,ze,Le,nt){const $e=(Fe+Le)/2,it=(ze+nt)/2,dt=n.project(ks($e),Fo(it)),ct=Math.max(0,B-dt.x,W-dt.y,dt.x-K,dt.y-ie);B=Math.min(B,dt.x),K=Math.max(K,dt.x),W=Math.min(W,dt.y),ie=Math.max(ie,dt.y),ct>oe&&(Q(ge,dt,Fe,ze,$e,it),Q(dt,Se,$e,it,Le,nt))}Q(k,O,c,f,g,f),Q(O,I,g,f,g,_),Q(I,R,g,_,c,_),Q(R,k,c,_,c,f),B-=oe,W-=oe,K+=oe,ie+=oe;const ue=1/Math.max(K-B,ie-W);return{scale:ue,x:B*ue,y:W*ue,x2:K*ue,y2:ie*ue,projection:n}}function fA(u,{x:n,y:s},c=0){return new Je(((n-c)*u.scale-u.x)*kn,(s*u.scale-u.y)*kn)}const lV=Ne.mat4.identity(new Float32Array(16));class bd{constructor(n){this.spec=n,this.name=n.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(n,s){return{x:0,y:0,z:0}}unproject(n,s){return new Qr(0,0)}projectTilePoint(n,s,c){return{x:n,y:s,z:0}}locationPoint(n,s,c=!0){return n._coordinatePoint(n.locationCoordinate(s),c)}pixelsPerMeter(n,s){return os(1,n)*s}pixelSpaceConversion(n,s,c){return 1}farthestPixelDistance(n){return dA(n,n.pixelsPerMeter)}pointCoordinate(n,s,c,g){const f=n.horizonLineFromTop(!1),_=new Je(s,Math.max(f,c));return n.rayIntersectionCoordinate(n.pointRayIntersection(_,g))}pointCoordinate3D(n,s,c){const g=new Je(s,c);if(n.elevation)return n.elevation.pointCoordinate(g);{const f=this.pointCoordinate(n,g.x,g.y,0);return[f.x,f.y,f.z]}}isPointAboveHorizon(n,s){if(n.elevation&&n.elevation.visibleDemTiles.length)return!this.pointCoordinate3D(n,s.x,s.y);const c=n.horizonLineFromTop();return s.y<c}createInversionMatrix(n,s){return lV}createTileMatrix(n,s,c){let g,f,_;const T=c.canonical,A=Ne.mat4.identity(new Float64Array(16));if(this.isReprojectedInTileSpace){const D=A_(T,this);g=1,f=D.x+c.wrap*D.scale,_=D.y,Ne.mat4.scale(A,A,[g/D.scale,g/D.scale,n.pixelsPerMeter/s])}else g=s/n.zoomScale(T.z),f=(T.x+Math.pow(2,T.z)*c.wrap)*g,_=T.y*g;return Ne.mat4.translate(A,A,[f,_,0]),Ne.mat4.scale(A,A,[g/kn,g/kn,1]),A}upVector(n,s,c){return[0,0,1]}upVectorScale(n,s,c){return{metersToTile:1}}}class uV extends bd{constructor(n){super(n),this.range=[4,7],this.center=n.center||[-96,37.5];const[s,c]=this.parallels=n.parallels||[29.5,45.5],g=Math.sin(Pt(s));this.n=(g+Math.sin(Pt(c)))/2,this.c=1+g*(2*this.n-g),this.r0=Math.sqrt(this.c)/this.n}project(n,s){const{n:c,c:g,r0:f}=this,_=Pt(n-this.center[0]),T=Pt(s),A=Math.sqrt(g-2*c*Math.sin(T))/c;return{x:A*Math.sin(_*c),y:A*Math.cos(_*c)-f,z:0}}unproject(n,s){const{n:c,c:g,r0:f}=this,_=f+s;let T=Math.atan2(n,Math.abs(_))*Math.sign(_);_*c<0&&(T-=Math.PI*Math.sign(n)*Math.sign(_));const A=Pt(this.center[0])*c;T=Xn(T,-Math.PI-A,Math.PI-A);const D=Et(Dt(T/c)+this.center[0],-180,180),w=Math.asin(Et((g-(n*n+_*_)*c*c)/(2*c),-1,1)),k=Et(Dt(w),-85.051129,Ps);return new Qr(D,k)}}const k_=1.340264,P_=-.081106,R_=893e-6,O_=.003796,j0=Math.sqrt(3)/2;class cV extends bd{project(n,s){s=s/180*Math.PI,n=n/180*Math.PI;const c=Math.asin(j0*Math.sin(s)),g=c*c,f=g*g*g;return{x:.5*(n*Math.cos(c)/(j0*(k_+3*P_*g+f*(7*R_+9*O_*g)))/Math.PI+.5),y:1-.5*(c*(k_+P_*g+f*(R_+O_*g))/Math.PI+1),z:0}}unproject(n,s){n=(2*n-.5)*Math.PI;let c=s=(2*(1-s)-1)*Math.PI,g=c*c,f=g*g*g;for(let w,k,O,I=0;I<12&&(k=c*(k_+P_*g+f*(R_+O_*g))-s,O=k_+3*P_*g+f*(7*R_+9*O_*g),w=k/O,c=Et(c-w,-Math.PI/3,Math.PI/3),g=c*c,f=g*g*g,!(Math.abs(w)<1e-12));++I);const _=j0*n*(k_+3*P_*g+f*(7*R_+9*O_*g))/Math.cos(c),T=Math.asin(Math.sin(c)/j0),A=Et(180*_/Math.PI,-180,180),D=Et(180*T/Math.PI,-85.051129,Ps);return new Qr(A,D)}}class dV extends bd{constructor(n){super(n),this.wrap=!0,this.supportsWorldCopies=!0}project(n,s){return{x:.5+n/360,y:.5-s/360,z:0}}unproject(n,s){const c=360*(n-.5),g=Et(360*(.5-s),-85.051129,Ps);return new Qr(c,g)}}const qp=Math.PI/2;function H0(u){return Math.tan((qp+u)/2)}class fV extends bd{constructor(n){super(n),this.center=n.center||[0,30];const[s,c]=this.parallels=n.parallels||[30,30];let g=Pt(s),f=Pt(c);this.southernCenter=g+f<0,this.southernCenter&&(g=-g,f=-f);const _=Math.cos(g),T=H0(g);this.n=g===f?Math.sin(g):Math.log(_/Math.cos(f))/Math.log(H0(f)/T),this.f=_*Math.pow(H0(g),this.n)/this.n}project(n,s){s=Pt(s),this.southernCenter&&(s=-s),n=Pt(n-this.center[0]);const c=1e-6,{n:g,f}=this;f>0?s<-qp+c&&(s=-qp+c):s>qp-c&&(s=qp-c);const _=f/Math.pow(H0(s),g);let T=_*Math.sin(g*n),A=f-_*Math.cos(g*n);return T=.5*(T/Math.PI+.5),A=.5*(A/Math.PI+.5),{x:T,y:this.southernCenter?A:1-A,z:0}}unproject(n,s){n=(2*n-.5)*Math.PI,this.southernCenter&&(s=1-s),s=(2*(1-s)-.5)*Math.PI;const{n:c,f:g}=this,f=g-s,_=Math.sign(f),T=Math.sign(c)*Math.sqrt(n*n+f*f);let A=Math.atan2(n,Math.abs(f))*_;f*c<0&&(A-=Math.PI*Math.sign(n)*_);const D=Et(Dt(A/c)+this.center[0],-180,180),w=Et(Dt(2*Math.atan(Math.pow(g/T,1/c))-qp),-85.051129,Ps);return new Qr(D,this.southernCenter?-w:w)}}class hA extends bd{constructor(n){super(n),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(n,s){return{x:Su(n),y:Rl(s),z:0}}unproject(n,s){const c=ks(n),g=Fo(s);return new Qr(c,g)}}const pA=Pt(Ps);class hV extends bd{project(n,s){const c=(s=Pt(s))*s,g=c*c;return{x:.5*((n=Pt(n))*(.8707-.131979*c+g*(g*(.003971*c-.001529*g)-.013791))/Math.PI+.5),y:1-.5*(s*(1.007226+c*(.015085+g*(.028874*c-.044475-.005916*g)))/Math.PI+1),z:0}}unproject(n,s){n=(2*n-.5)*Math.PI;let c=s=(2*(1-s)-1)*Math.PI,g=25,f=0,_=c*c;do{_=c*c;const D=_*_;f=(c*(1.007226+_*(.015085+D*(.028874*_-.044475-.005916*D)))-s)/(1.007226+_*(.045255+D*(.259866*_-.311325-.005916*11*D))),c=Et(c-f,-pA,pA)}while(Math.abs(f)>1e-6&&--g>0);_=c*c;const T=Et(Dt(n/(.8707+_*(_*(_*_*_*(.003971-.001529*_)-.013791)-.131979))),-180,180),A=Dt(c);return new Qr(T,A)}}const mA=Pt(Ps);class pV extends bd{project(n,s){s=Pt(s),n=Pt(n);const c=Math.cos(s),g=2/Math.PI,f=Math.acos(c*Math.cos(n/2)),_=Math.sin(f)/f,T=.5*(n*g+2*c*Math.sin(n/2)/_)||0,A=.5*(s+Math.sin(s)/_)||0;return{x:.5*(T/Math.PI+.5),y:1-.5*(A/Math.PI+1),z:0}}unproject(n,s){let c=n=(2*n-.5)*Math.PI,g=s=(2*(1-s)-1)*Math.PI,f=25;const _=1e-6;let T=0,A=0;do{const D=Math.cos(g),w=Math.sin(g),k=2*w*D,O=w*w,I=D*D,R=Math.cos(c/2),B=Math.sin(c/2),W=2*R*B,K=B*B,ie=1-I*R*R,oe=ie?1/ie:0,Q=ie?Math.acos(D*R)*Math.sqrt(1/ie):0,ue=.5*(2*Q*D*B+2*c/Math.PI)-n,ge=.5*(Q*w+g)-s,Se=.5*oe*(I*K+Q*D*R*O)+1/Math.PI,Fe=oe*(W*k/4-Q*w*B),ze=.125*oe*(k*B-Q*w*I*W),Le=.5*oe*(O*R+Q*K*D)+.5,nt=Fe*ze-Le*Se;T=(ge*Fe-ue*Le)/nt,A=(ue*ze-ge*Se)/nt,c=Et(c-T,-Math.PI,Math.PI),g=Et(g-A,-mA,mA)}while((Math.abs(T)>_||Math.abs(A)>_)&&--f>0);return new Qr(Dt(c),Dt(g))}}class gA extends bd{constructor(n){super(n),this.center=n.center||[0,0],this.parallels=n.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(Pt(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(n,s){const{scale:c,cosPhi:g}=this;return{x:Pt(n)*g*c+.5,y:-Math.sin(Pt(s))/g*c+.5,z:0}}unproject(n,s){const{scale:c,cosPhi:g}=this,f=-(s-.5)/c,_=Et(Dt((n-.5)/c)/g,-180,180),T=Math.asin(Et(f*g,-1,1)),A=Et(Dt(T),-85.051129,Ps);return new Qr(_,A)}}class mV extends hA{constructor(n){super(n),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug"],this.range=[3,5]}projectTilePoint(n,s,c){const g=Xi(n,s,c),f=jo(Io(c));return Ne.vec3.transformMat4(g,g,f),{x:g[0],y:g[1],z:g[2]}}locationPoint(n,s){const c=hc(s.lat,s.lng),g=Ne.vec3.normalize([],c),f=n.elevation?n.elevation.getAtPointOrZero(n.locationCoordinate(s),n._centerAltitude):n._centerAltitude,_=os(1,0)*kn*f;Ne.vec3.scaleAndAdd(c,c,g,_);const T=Ne.mat4.identity(new Float64Array(16));return Ne.mat4.multiply(T,n.pixelMatrix,n.globeMatrix),Ne.vec3.transformMat4(c,c,T),new Je(c[0],c[1])}pixelsPerMeter(n,s){return os(1,0)*s}pixelSpaceConversion(n,s,c){const g=os(1,n)*s,f=pr(os(1,45)*s,g,c);return this.pixelsPerMeter(n,s)/f}createTileMatrix(n,s,c){const g=js(Io(c.canonical));return Ne.mat4.multiply(new Float64Array(16),n.globeMatrix,g)}createInversionMatrix(n,s){const{center:c}=n,g=jo(Io(s));return Ne.mat4.rotateY(g,g,Pt(c.lng)),Ne.mat4.rotateX(g,g,Pt(c.lat)),Ne.mat4.scale(g,g,[n._pixelsPerMercatorPixel,n._pixelsPerMercatorPixel,1]),Float32Array.from(g)}pointCoordinate(n,s,c,g){return Do(n,s,c,!0)||new v(0,0)}pointCoordinate3D(n,s,c){const g=this.pointCoordinate(n,s,c,0);return[g.x,g.y,g.z]}isPointAboveHorizon(n,s){return!Do(n,s.x,s.y,!1)}farthestPixelDistance(n){const s=function(g,f){const _=g.cameraToCenterDistance,T=g._centerAltitude*f,A=g._camera,D=g._camera.forward(),w=Ne.vec3.add([],Ne.vec3.scale([],D,-_),[0,0,T]),k=g.worldSize/(2*Math.PI),O=[0,0,-k],I=g.width/g.height,R=Math.tan(g.fovAboveCenter),B=Ne.vec3.scale([],A.up(),R),W=Ne.vec3.scale([],A.right(),R*I),K=Ne.vec3.normalize([],Ne.vec3.add([],Ne.vec3.add([],D,B),W)),ie=[];let oe;if(new Or(w,K).closestPointOnSphere(O,k,ie)){const Q=Ne.vec3.add([],ie,O),ue=Ne.vec3.sub([],Q,w);oe=Math.cos(g.fovAboveCenter)*Ne.vec3.length(ue)}else{const Q=Ne.vec3.sub([],w,O),ue=Ne.vec3.sub([],O,w);Ne.vec3.normalize(ue,ue);const ge=Ne.vec3.length(Q)-k;oe=Math.sqrt(ge*(ge+2*k));const Se=Math.acos(oe/(k+ge))-Math.acos(Ne.vec3.dot(D,ue));oe*=Math.cos(Se)}return 1.01*oe}(n,this.pixelsPerMeter(n.center.lat,n.worldSize)),c=Yo(n.zoom);if(c>0){const g=dA(n,os(1,n.center.lat)*n.worldSize),f=n.worldSize/(2*Math.PI),_=Math.max(n.width,n.height)/n.worldSize*Math.PI;return pr(s,g+f*(1-Math.cos(_)),Math.pow(c,10))}return s}upVector(n,s,c){return Xi(s,c,n,1)}upVectorScale(n){return{metersToTile:ni(Ao(Io(n)))}}}function _A(u){const n=u.parallels,s=!!n&&Math.abs(n[0]+n[1])<.01;switch(u.name){case"mercator":return new hA(u);case"equirectangular":return new dV(u);case"naturalEarth":return new hV(u);case"equalEarth":return new cV(u);case"winkelTripel":return new pV(u);case"albers":return s?new gA(u):new uV(u);case"lambertConformalConic":return s?new gA(u):new fV(u);case"globe":return new mV(u)}throw new Error(`Invalid projection name: ${u.name}`)}const gV=Up.VectorTileFeature.types,_V=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function G0(u,n,s,c,g,f,_,T,A,D,w,k,O){const I=T?Math.min(vd,Math.round(T[0])):0,R=T?Math.min(vd,Math.round(T[1])):0;u.emplaceBack(n,s,Math.round(32*c),Math.round(32*g),f,_,(I<<1)+(A?1:0),R,16*D,16*w,256*k,256*O)}function W0(u,n,s){u.emplaceBack(n,s)}function q0(u,n,s,c,g,f,_){u.emplaceBack(n,s,c,g,f,_)}function K0(u,n,s,c,g){u.emplaceBack(n,s,c,g),u.emplaceBack(n,s,c,g),u.emplaceBack(n,s,c,g),u.emplaceBack(n,s,c,g)}function yV(u){for(const n of u.sections)if(dw(n.text))return!0;return!1}class Jw{constructor(n){this.layoutVertexArray=new Kg,this.indexArray=new Uo,this.programConfigurations=n,this.segments=new Yi,this.dynamicLayoutVertexArray=new Al,this.opacityVertexArray=new Yg,this.placedSymbolArray=new p0,this.iconTransitioningVertexArray=new yu,this.globeExtVertexArray=new Zg,this.zOffsetVertexArray=new pa}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0&&this.iconTransitioningVertexArray.length===0}upload(n,s,c,g,f){this.isEmpty()||(c&&(this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,L5.members),this.indexBuffer=n.createIndexBuffer(this.indexArray,s),this.dynamicLayoutVertexBuffer=n.createVertexBuffer(this.dynamicLayoutVertexArray,z5.members,!0),this.opacityVertexBuffer=n.createVertexBuffer(this.opacityVertexArray,_V,!0),this.iconTransitioningVertexArray.length>0&&(this.iconTransitioningVertexBuffer=n.createVertexBuffer(this.iconTransitioningVertexArray,N5.members,!0)),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=n.createVertexBuffer(this.globeExtVertexArray,D5.members,!0)),!this.zOffsetVertexBuffer&&(this.zOffsetVertexArray.length>0||f)&&(this.zOffsetVertexBuffer=n.createVertexBuffer(this.zOffsetVertexArray,F5.members,!0)),this.opacityVertexBuffer.itemSize=1),(c||g)&&this.programConfigurations.upload(n))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.iconTransitioningVertexBuffer&&this.iconTransitioningVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy(),this.zOffsetVertexBuffer&&this.zOffsetVertexBuffer.destroy())}}Gn(Jw,"SymbolBuffers");class Qw{constructor(n,s,c){this.layoutVertexArray=new n,this.layoutAttributes=s,this.indexArray=new c,this.segments=new Yi,this.collisionVertexArray=new Qg,this.collisionVertexArrayExt=new Al}upload(n){this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=n.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=n.createVertexBuffer(this.collisionVertexArray,B5.members,!0),this.collisionVertexBufferExt=n.createVertexBuffer(this.collisionVertexArrayExt,V5.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}Gn(Qw,"CollisionBuffers");class Z0{constructor(n){this.collisionBoxArray=n.collisionBoxArray,this.zoom=n.zoom,this.lut=n.lut,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map(_=>_.fqid),this.index=n.index,this.pixelRatio=n.pixelRatio,this.sourceLayerIndex=n.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.hasAnyIconTextFit=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Ne.mat4.identity([]),this.placementViewportMatrix=Ne.mat4.identity([]);const s=this.layers[0]._unevaluatedLayout._values;this.textSizeData=$w(this.zoom,s["text-size"]),this.iconSizeData=$w(this.zoom,s["icon-size"]);const c=this.layers[0].layout,g=c.get("symbol-sort-key"),f=c.get("symbol-z-order");this.canOverlap=c.get("text-allow-overlap")||c.get("icon-allow-overlap")||c.get("text-ignore-placement")||c.get("icon-ignore-placement"),this.sortFeaturesByKey=f!=="viewport-y"&&g.constantOr(1)!==void 0,this.sortFeaturesByY=(f==="viewport-y"||f==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=c.get("text-writing-mode").map(_=>Fa[_]),this.stateDependentLayerIds=this.layers.filter(_=>_.isStateDependent()).map(_=>_.id),this.sourceID=n.sourceID,this.projection=n.projection,this.hasAnyZOffset=!1,this.zOffsetSortDirty=!1,this.zOffsetBuffersNeedUpload=c.get("symbol-z-elevate"),this.activeReplacements=[],this.replacementUpdateTime=0}createArrays(){this.text=new Jw(new xu(this.layers,{zoom:this.zoom,lut:this.lut},n=>n.startsWith("text")||n.startsWith("symbol"))),this.icon=new Jw(new xu(this.layers,{zoom:this.zoom,lut:this.lut},n=>n.startsWith("icon")||n.startsWith("symbol"))),this.glyphOffsetArray=new Nf,this.lineVertexArray=new As,this.symbolInstances=new Ff}calculateGlyphDependencies(n,s,c,g,f){for(const _ of n){const T=_.codePointAt(0);if(T===void 0)break;if(s[T]=!0,g&&f&&T<=65535){const A=C_[_];A&&(s[A.charCodeAt(0)]=!0)}}}updateFootprints(n,s){}updateReplacement(n,s){if(s.updateTime===this.replacementUpdateTime)return!1;this.replacementUpdateTime=s.updateTime;const c=s.getReplacementRegionsForTile(n.toUnwrapped(),!0);return!Lw(this.activeReplacements,c)&&(this.activeReplacements=c,!0)}populate(n,s,c,g){const f=this.layers[0],_=f.layout,T=this.projection.name==="globe",A=_.get("text-font"),D=_.get("text-field"),w=_.get("icon-image"),[k,O]=_.get("icon-size-scale-range"),I=Et(s.scaleFactor||1,k,O),R=(D.value.kind!=="constant"||D.value.value instanceof qo&&!D.value.value.isEmpty()||D.value.value.toString().length>0)&&(A.value.kind!=="constant"||A.value.value.length>0),B=w.value.kind!=="constant"||!!w.value.value||Object.keys(w.parameters).length>0,W=_.get("symbol-sort-key");if(this.features=[],!R&&!B)return;const K=s.iconDependencies,ie=s.glyphDependencies,oe=s.availableImages,Q=new ji(this.zoom);for(const{feature:ue,id:ge,index:Se,sourceLayerIndex:Fe}of n){const ze=f._featureFilter.needGeometry,Le=ne(ue,ze);if(!f._featureFilter.filter(Q,Le,c))continue;if(ze||(Le.geometry=Y(ue,c,g)),T&&ue.type!==1&&c.z<=5){const ct=Le.geometry,mt=.98078528056,wt=(Mt,vt)=>{const qt=Xi(Mt.x,Mt.y,c,1),mn=Xi(vt.x,vt.y,c,1);return Ne.vec3.dot(qt,mn)<mt};for(let Mt=0;Mt<ct.length;Mt++)ct[Mt]=$(ct[Mt],wt)}let nt,$e;if(R){const ct=f.getValueAndResolveTokens("text-field",Le,c,oe),mt=qo.factory(ct);yV(mt)&&(this.hasRTLText=!0),(!this.hasRTLText||Hg()==="unavailable"||this.hasRTLText&&Is.isParsed())&&(nt=j5(mt,f,Le))}if(B){const ct=f.getValueAndResolveTokens("icon-image",Le,c,oe);$e=ct instanceof Lo?ct:Lo.build(ct)}if(!nt&&!$e)continue;const it=this.sortFeaturesByKey?W.evaluate(Le,{},c):void 0,dt={id:ge,text:nt,icon:$e,index:Se,sourceLayerIndex:Fe,geometry:Le.geometry,properties:ue.properties,type:gV[ue.type],sortKey:it};if(this.features.push(dt),$e){const ct=L0(this.iconSizeData,this.layers[0]._unevaluatedLayout._values["icon-size"],c,this.zoom,dt)*I*this.pixelRatio,mt=$e.getPrimary().scaleSelf(ct);if(K[mt.id]=K[mt.id]||[],K[mt.id].push(mt),$e.nameSecondary){const wt=$e.getSecondary().scaleSelf(ct);K[wt.id]=K[wt.id]||[],K[wt.id].push(wt)}}if(nt){const ct=A.evaluate(Le,{},c).join(","),mt=_.get("text-rotation-alignment")==="map"&&_.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(Fa.vertical)>=0;for(const wt of nt.sections)if(wt.image){const Mt=wt.image.getPrimary().scaleSelf(this.pixelRatio);K[Mt.id]=K[Mt.id]||[],K[Mt.id].push(Mt)}else{const Mt=_p(nt.toString()),vt=wt.fontStack||ct,qt=ie[vt]=ie[vt]||{};this.calculateGlyphDependencies(wt.text,qt,mt,this.allowVerticalPlacement,Mt)}}}_.get("symbol-placement")==="line"&&(this.features=function(ue){const ge={},Se={},Fe=[];let ze=0;function Le(dt){Fe.push(ue[dt]),ze++}function nt(dt,ct,mt){const wt=Se[dt];return delete Se[dt],Se[ct]=wt,Fe[wt].geometry[0].pop(),Fe[wt].geometry[0]=Fe[wt].geometry[0].concat(mt[0]),wt}function $e(dt,ct,mt){const wt=ge[ct];return delete ge[ct],ge[dt]=wt,Fe[wt].geometry[0].shift(),Fe[wt].geometry[0]=mt[0].concat(Fe[wt].geometry[0]),wt}function it(dt,ct,mt){const wt=mt?ct[0][ct[0].length-1]:ct[0][0];return`${dt}:${wt.x}:${wt.y}`}for(let dt=0;dt<ue.length;dt++){const ct=ue[dt],mt=ct.geometry,wt=ct.text?ct.text.toString():null;if(!wt){Le(dt);continue}const Mt=it(wt,mt),vt=it(wt,mt,!0);if(Mt in Se&&vt in ge&&Se[Mt]!==ge[vt]){const qt=$e(Mt,vt,mt),mn=nt(Mt,vt,Fe[qt].geometry);delete ge[Mt],delete Se[vt],Se[it(wt,Fe[mn].geometry,!0)]=mn,Fe[qt].geometry=null}else Mt in Se?nt(Mt,vt,mt):vt in ge?$e(Mt,vt,mt):(Le(dt),ge[Mt]=ze-1,Se[vt]=ze-1)}return Fe.filter(dt=>dt.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((ue,ge)=>ue.sortKey-ge.sortKey)}update(n,s,c,g,f,_,T){this.text.programConfigurations.updatePaintArrays(n,s,f,c,g,_,T),this.icon.programConfigurations.updatePaintArrays(n,s,f,c,g,_,T)}updateZOffset(){const n=(f,_,T)=>{c+=_,c>f.length&&f.resize(c);for(let A=-_;A<0;A++)f.emplace(A+c,T)},s=(f,_,T)=>{g+=_,g>f.length&&f.resize(g);for(let A=-_;A<0;A++)f.emplace(A+g,T)};if(!this.zOffsetBuffersNeedUpload)return;this.zOffsetBuffersNeedUpload=!1;let c=0,g=0;for(let f=0;f<this.symbolInstances.length;f++){const _=this.symbolInstances.get(f),{numHorizontalGlyphVertices:T,numVerticalGlyphVertices:A,numIconVertices:D}=_,w=_.zOffset,k=D>0;if((T>0||A>0)&&(n(this.text.zOffsetVertexArray,T,w),n(this.text.zOffsetVertexArray,A,w)),k){const{placedIconSymbolIndex:O,verticalPlacedIconSymbolIndex:I}=_;O>=0&&s(this.icon.zOffsetVertexArray,D,w),I>=0&&s(this.icon.zOffsetVertexArray,_.numVerticalIconVertices,w)}}this.text.zOffsetVertexBuffer&&this.text.zOffsetVertexBuffer.updateData(this.text.zOffsetVertexArray),this.icon.zOffsetVertexBuffer&&this.icon.zOffsetVertexBuffer.updateData(this.icon.zOffsetVertexArray)}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(n){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(n),this.iconCollisionBox.upload(n)),this.text.upload(n,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload),this.icon.upload(n,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=_A(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(n,s){const c=this.lineVertexArray.length;if(n.segment!==void 0)for(const{x:g,y:f}of s)this.lineVertexArray.emplaceBack(g,f);return{lineStartIndex:c,lineLength:this.lineVertexArray.length-c}}addSymbols(n,s,c,g,f,_,T,A,D,w,k,O,I,R,B,W){const K=n.indexArray,ie=n.layoutVertexArray,oe=n.globeExtVertexArray,Q=n.segments.prepareSegment(4*s.length,ie,K,this.canOverlap?_.sortKey:void 0),ue=this.glyphOffsetArray.length,ge=Q.vertexLength,Se=this.allowVerticalPlacement&&T===Fa.vertical?Math.PI/2:0,Fe=_.text&&_.text.sections;for(let Le=0;Le<s.length;Le++){const{tl:nt,tr:$e,bl:it,br:dt,texPrimary:ct,texSecondary:mt,pixelOffsetTL:wt,pixelOffsetBR:Mt,minFontScaleX:vt,minFontScaleY:qt,glyphOffset:mn,isSDF:Zt,sectionIndex:Tn}=s[Le],Sn=Q.vertexLength,On=mn[1];if(G0(ie,D.x,D.y,nt.x,On+nt.y,ct.x,ct.y,c,Zt,wt.x,wt.y,vt,qt),G0(ie,D.x,D.y,$e.x,On+$e.y,ct.x+ct.w,ct.y,c,Zt,Mt.x,wt.y,vt,qt),G0(ie,D.x,D.y,it.x,On+it.y,ct.x,ct.y+ct.h,c,Zt,wt.x,Mt.y,vt,qt),G0(ie,D.x,D.y,dt.x,On+dt.y,ct.x+ct.w,ct.y+ct.h,c,Zt,Mt.x,Mt.y,vt,qt),A){const{x:nn,y:Yn,z:In}=A.anchor,[qn,ar,Mr]=A.up;q0(oe,nn,Yn,In,qn,ar,Mr),q0(oe,nn,Yn,In,qn,ar,Mr),q0(oe,nn,Yn,In,qn,ar,Mr),q0(oe,nn,Yn,In,qn,ar,Mr),K0(n.dynamicLayoutVertexArray,nn,Yn,In,Se)}else K0(n.dynamicLayoutVertexArray,D.x,D.y,D.z,Se);if(W){const nn=mt||ct;W0(n.iconTransitioningVertexArray,nn.x,nn.y),W0(n.iconTransitioningVertexArray,nn.x+nn.w,nn.y),W0(n.iconTransitioningVertexArray,nn.x,nn.y+nn.h),W0(n.iconTransitioningVertexArray,nn.x+nn.w,nn.y+nn.h)}K.emplaceBack(Sn,Sn+1,Sn+2),K.emplaceBack(Sn+1,Sn+2,Sn+3),Q.vertexLength+=4,Q.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(mn[0]),Le!==s.length-1&&Tn===s[Le+1].sectionIndex||n.programConfigurations.populatePaintArrays(ie.length,_,_.index,{},I,R,B,Fe&&Fe[Tn])}const ze=A?A.anchor:D;n.placedSymbolArray.emplaceBack(ze.x,ze.y,ze.z,D.x,D.y,ue,this.glyphOffsetArray.length-ue,ge,w,k,D.segment,c?c[0]:0,c?c[1]:0,g[0],g[1],T,0,!1,0,O,0)}_commitLayoutVertex(n,s,c,g,f,_,T){n.emplaceBack(s,c,g,f,_,Math.round(T.x),Math.round(T.y))}_addCollisionDebugVertices(n,s,c,g,f,_,T){const A=c.segments.prepareSegment(4,c.layoutVertexArray,c.indexArray),D=A.vertexLength,w=T.tileAnchorX,k=T.tileAnchorY;for(let I=0;I<4;I++)c.collisionVertexArray.emplaceBack(0,0,0,0,0,0);this._commitDebugCollisionVertexUpdate(c.collisionVertexArrayExt,s,n.padding,T.zOffset),this._commitLayoutVertex(c.layoutVertexArray,g,f,_,w,k,new Je(n.x1,n.y1)),this._commitLayoutVertex(c.layoutVertexArray,g,f,_,w,k,new Je(n.x2,n.y1)),this._commitLayoutVertex(c.layoutVertexArray,g,f,_,w,k,new Je(n.x2,n.y2)),this._commitLayoutVertex(c.layoutVertexArray,g,f,_,w,k,new Je(n.x1,n.y2)),A.vertexLength+=4;const O=c.indexArray;O.emplaceBack(D,D+1),O.emplaceBack(D+1,D+2),O.emplaceBack(D+2,D+3),O.emplaceBack(D+3,D),A.primitiveLength+=4}_addTextDebugCollisionBoxes(n,s,c,g,f,_){for(let T=g;T<f;T++){const A=c.get(T),D=this.getSymbolInstanceTextSize(n,_,s,T);this._addCollisionDebugVertices(A,D,this.textCollisionBox,A.projectedAnchorX,A.projectedAnchorY,A.projectedAnchorZ,_)}}_addIconDebugCollisionBoxes(n,s,c,g,f,_){for(let T=g;T<f;T++){const A=c.get(T),D=this.getSymbolInstanceIconSize(n,s,_.placedIconSymbolIndex);this._addCollisionDebugVertices(A,D,this.iconCollisionBox,A.projectedAnchorX,A.projectedAnchorY,A.projectedAnchorZ,_)}}generateCollisionDebugBuffers(n,s,c){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Qw(zf,BI.members,yu),this.iconCollisionBox=new Qw(zf,BI.members,yu);const g=jp(this.iconSizeData,n),f=jp(this.textSizeData,n,c);for(let _=0;_<this.symbolInstances.length;_++){const T=this.symbolInstances.get(_);this._addTextDebugCollisionBoxes(f,n,s,T.textBoxStartIndex,T.textBoxEndIndex,T),this._addTextDebugCollisionBoxes(f,n,s,T.verticalTextBoxStartIndex,T.verticalTextBoxEndIndex,T),this._addIconDebugCollisionBoxes(g,n,s,T.iconBoxStartIndex,T.iconBoxEndIndex,T),this._addIconDebugCollisionBoxes(g,n,s,T.verticalIconBoxStartIndex,T.verticalIconBoxEndIndex,T)}}getSymbolInstanceTextSize(n,s,c,g){const f=this.text.placedSymbolArray.get(s.rightJustifiedTextSymbolIndex>=0?s.rightJustifiedTextSymbolIndex:s.centerJustifiedTextSymbolIndex>=0?s.centerJustifiedTextSymbolIndex:s.leftJustifiedTextSymbolIndex>=0?s.leftJustifiedTextSymbolIndex:s.verticalPlacedTextSymbolIndex>=0?s.verticalPlacedTextSymbolIndex:g),_=D0(this.textSizeData,n,f)/Xo;return this.tilePixelRatio*_}getSymbolInstanceIconSize(n,s,c){const g=this.icon.placedSymbolArray.get(c),f=D0(this.iconSizeData,n,g);return this.tilePixelRatio*f}_commitDebugCollisionVertexUpdate(n,s,c,g){n.emplaceBack(s,-c,-c,g),n.emplaceBack(s,c,-c,g),n.emplaceBack(s,c,c,g),n.emplaceBack(s,-c,c,g)}_updateTextDebugCollisionBoxes(n,s,c,g,f,_,T){for(let A=g;A<f;A++){const D=c.get(A),w=this.getSymbolInstanceTextSize(n,_,s,A);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,w,D.padding,_.zOffset)}}_updateIconDebugCollisionBoxes(n,s,c,g,f,_,T){for(let A=g;A<f;A++){const D=c.get(A),w=this.getSymbolInstanceIconSize(n,s,_.placedIconSymbolIndex);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,w,D.padding,_.zOffset)}}updateCollisionDebugBuffers(n,s,c,g){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const f=jp(this.iconSizeData,n,g),_=jp(this.textSizeData,n,c);for(let T=0;T<this.symbolInstances.length;T++){const A=this.symbolInstances.get(T);this._updateTextDebugCollisionBoxes(_,n,s,A.textBoxStartIndex,A.textBoxEndIndex,A,c),this._updateTextDebugCollisionBoxes(_,n,s,A.verticalTextBoxStartIndex,A.verticalTextBoxEndIndex,A,c),this._updateIconDebugCollisionBoxes(f,n,s,A.iconBoxStartIndex,A.iconBoxEndIndex,A,g),this._updateIconDebugCollisionBoxes(f,n,s,A.verticalIconBoxStartIndex,A.verticalIconBoxEndIndex,A,g)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(n,s,c,g,f,_,T,A,D){const w={};if(s<c){const{x1:k,y1:O,x2:I,y2:R,padding:B,projectedAnchorX:W,projectedAnchorY:K,projectedAnchorZ:ie,tileAnchorX:oe,tileAnchorY:Q,featureIndex:ue}=n.get(s);w.textBox={x1:k,y1:O,x2:I,y2:R,padding:B,projectedAnchorX:W,projectedAnchorY:K,projectedAnchorZ:ie,tileAnchorX:oe,tileAnchorY:Q},w.textFeatureIndex=ue}if(g<f){const{x1:k,y1:O,x2:I,y2:R,padding:B,projectedAnchorX:W,projectedAnchorY:K,projectedAnchorZ:ie,tileAnchorX:oe,tileAnchorY:Q,featureIndex:ue}=n.get(g);w.verticalTextBox={x1:k,y1:O,x2:I,y2:R,padding:B,projectedAnchorX:W,projectedAnchorY:K,projectedAnchorZ:ie,tileAnchorX:oe,tileAnchorY:Q},w.verticalTextFeatureIndex=ue}if(_<T){const{x1:k,y1:O,x2:I,y2:R,padding:B,projectedAnchorX:W,projectedAnchorY:K,projectedAnchorZ:ie,tileAnchorX:oe,tileAnchorY:Q,featureIndex:ue}=n.get(_);w.iconBox={x1:k,y1:O,x2:I,y2:R,padding:B,projectedAnchorX:W,projectedAnchorY:K,projectedAnchorZ:ie,tileAnchorX:oe,tileAnchorY:Q},w.iconFeatureIndex=ue}if(A<D){const{x1:k,y1:O,x2:I,y2:R,padding:B,projectedAnchorX:W,projectedAnchorY:K,projectedAnchorZ:ie,tileAnchorX:oe,tileAnchorY:Q,featureIndex:ue}=n.get(A);w.verticalIconBox={x1:k,y1:O,x2:I,y2:R,padding:B,projectedAnchorX:W,projectedAnchorY:K,projectedAnchorZ:ie,tileAnchorX:oe,tileAnchorY:Q},w.verticalIconFeatureIndex=ue}return w}deserializeCollisionBoxes(n){this.collisionArrays=[];for(let s=0;s<this.symbolInstances.length;s++){const c=this.symbolInstances.get(s);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(n,c.textBoxStartIndex,c.textBoxEndIndex,c.verticalTextBoxStartIndex,c.verticalTextBoxEndIndex,c.iconBoxStartIndex,c.iconBoxEndIndex,c.verticalIconBoxStartIndex,c.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}hasIconTextFit(){return this.hasAnyIconTextFit}addIndicesForPlacedSymbol(n,s){const c=n.placedSymbolArray.get(s),g=c.vertexStartIndex+4*c.numGlyphs;for(let f=c.vertexStartIndex;f<g;f+=4)n.indexArray.emplaceBack(f,f+1,f+2),n.indexArray.emplaceBack(f+1,f+2,f+3)}getSortedSymbolIndexes(n){if(this.sortedAngle===n&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const s=Math.sin(n),c=Math.cos(n),g=[],f=[],_=[];for(let T=0;T<this.symbolInstances.length;++T){_.push(T);const A=this.symbolInstances.get(T);g.push(0|Math.round(s*A.tileAnchorX+c*A.tileAnchorY)),f.push(A.featureIndex)}return _.sort((T,A)=>g[T]-g[A]||f[A]-f[T]),_}getSortedIndexesByZOffset(){if(!this.zOffsetSortDirty)return this.symbolInstanceIndexesSortedZOffset;if(!this.symbolInstanceIndexesSortedZOffset){this.symbolInstanceIndexesSortedZOffset=[];for(let n=0;n<this.symbolInstances.length;++n)this.symbolInstanceIndexesSortedZOffset.push(n)}return this.zOffsetSortDirty=!1,this.symbolInstanceIndexesSortedZOffset.sort((n,s)=>this.symbolInstances.get(s).zOffset-this.symbolInstances.get(n).zOffset)}addToSortKeyRanges(n,s){const c=this.sortKeyRanges[this.sortKeyRanges.length-1];c&&c.sortKey===s?c.symbolInstanceEnd=n+1:this.sortKeyRanges.push({sortKey:s,symbolInstanceStart:n,symbolInstanceEnd:n+1})}sortFeatures(n){if(this.sortFeaturesByY&&this.sortedAngle!==n&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(n),this.sortedAngle=n,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const s of this.symbolInstanceIndexes){const c=this.symbolInstances.get(s);this.featureSortOrder.push(c.featureIndex);const{rightJustifiedTextSymbolIndex:g,centerJustifiedTextSymbolIndex:f,leftJustifiedTextSymbolIndex:_,verticalPlacedTextSymbolIndex:T,placedIconSymbolIndex:A,verticalPlacedIconSymbolIndex:D}=c;g>=0&&this.addIndicesForPlacedSymbol(this.text,g),f>=0&&f!==g&&this.addIndicesForPlacedSymbol(this.text,f),_>=0&&_!==f&&_!==g&&this.addIndicesForPlacedSymbol(this.text,_),T>=0&&this.addIndicesForPlacedSymbol(this.text,T),A>=0&&this.addIndicesForPlacedSymbol(this.icon,A),D>=0&&this.addIndicesForPlacedSymbol(this.icon,D)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let yA,vA,e2;Gn(Z0,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),Z0.addDynamicAttributes=K0;class bA{constructor(n){this.type=n.property.overrides?n.property.overrides.runtimeType:Uc,this.defaultValue=n}evaluate(n){if(n.formattedSection){const s=this.defaultValue.property.overrides;if(s&&s.hasOverride(n.formattedSection))return s.getOverride(n.formattedSection)}return n.feature&&n.featureState?this.defaultValue.evaluate(n.feature,n.featureState):this.defaultValue.property.specification.default}eachChild(n){this.defaultValue.isConstant()||n(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Gn(bA,"FormatSectionOverride",{omit:["defaultValue"]});const t2=()=>e2||(e2={layout:yA||(yA=new Zi({"symbol-placement":new _n(Ot.layout_symbol["symbol-placement"]),"symbol-spacing":new _n(Ot.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new _n(Ot.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Fn(Ot.layout_symbol["symbol-sort-key"]),"symbol-z-order":new _n(Ot.layout_symbol["symbol-z-order"]),"symbol-z-elevate":new _n(Ot.layout_symbol["symbol-z-elevate"]),"symbol-elevation-reference":new _n(Ot.layout_symbol["symbol-elevation-reference"]),"icon-allow-overlap":new _n(Ot.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new _n(Ot.layout_symbol["icon-ignore-placement"]),"icon-optional":new _n(Ot.layout_symbol["icon-optional"]),"icon-rotation-alignment":new _n(Ot.layout_symbol["icon-rotation-alignment"]),"icon-size":new Fn(Ot.layout_symbol["icon-size"]),"icon-size-scale-range":new _n(Ot.layout_symbol["icon-size-scale-range"]),"icon-text-fit":new Fn(Ot.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Fn(Ot.layout_symbol["icon-text-fit-padding"]),"icon-image":new Fn(Ot.layout_symbol["icon-image"]),"icon-rotate":new Fn(Ot.layout_symbol["icon-rotate"]),"icon-padding":new _n(Ot.layout_symbol["icon-padding"]),"icon-keep-upright":new _n(Ot.layout_symbol["icon-keep-upright"]),"icon-offset":new Fn(Ot.layout_symbol["icon-offset"]),"icon-anchor":new Fn(Ot.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new _n(Ot.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new _n(Ot.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new _n(Ot.layout_symbol["text-rotation-alignment"]),"text-field":new Fn(Ot.layout_symbol["text-field"]),"text-font":new Fn(Ot.layout_symbol["text-font"]),"text-size":new Fn(Ot.layout_symbol["text-size"]),"text-size-scale-range":new _n(Ot.layout_symbol["text-size-scale-range"]),"text-max-width":new Fn(Ot.layout_symbol["text-max-width"]),"text-line-height":new Fn(Ot.layout_symbol["text-line-height"]),"text-letter-spacing":new Fn(Ot.layout_symbol["text-letter-spacing"]),"text-justify":new Fn(Ot.layout_symbol["text-justify"]),"text-radial-offset":new Fn(Ot.layout_symbol["text-radial-offset"]),"text-variable-anchor":new _n(Ot.layout_symbol["text-variable-anchor"]),"text-anchor":new Fn(Ot.layout_symbol["text-anchor"]),"text-max-angle":new _n(Ot.layout_symbol["text-max-angle"]),"text-writing-mode":new _n(Ot.layout_symbol["text-writing-mode"]),"text-rotate":new Fn(Ot.layout_symbol["text-rotate"]),"text-padding":new _n(Ot.layout_symbol["text-padding"]),"text-keep-upright":new _n(Ot.layout_symbol["text-keep-upright"]),"text-transform":new Fn(Ot.layout_symbol["text-transform"]),"text-offset":new Fn(Ot.layout_symbol["text-offset"]),"text-allow-overlap":new _n(Ot.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new _n(Ot.layout_symbol["text-ignore-placement"]),"text-optional":new _n(Ot.layout_symbol["text-optional"]),visibility:new _n(Ot.layout_symbol.visibility)})),paint:vA||(vA=new Zi({"icon-opacity":new Fn(Ot.paint_symbol["icon-opacity"]),"icon-occlusion-opacity":new Fn(Ot.paint_symbol["icon-occlusion-opacity"]),"icon-emissive-strength":new Fn(Ot.paint_symbol["icon-emissive-strength"]),"text-emissive-strength":new Fn(Ot.paint_symbol["text-emissive-strength"]),"icon-color":new Fn(Ot.paint_symbol["icon-color"]),"icon-halo-color":new Fn(Ot.paint_symbol["icon-halo-color"]),"icon-halo-width":new Fn(Ot.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Fn(Ot.paint_symbol["icon-halo-blur"]),"icon-translate":new _n(Ot.paint_symbol["icon-translate"]),"icon-translate-anchor":new _n(Ot.paint_symbol["icon-translate-anchor"]),"icon-image-cross-fade":new Fn(Ot.paint_symbol["icon-image-cross-fade"]),"text-opacity":new Fn(Ot.paint_symbol["text-opacity"]),"text-occlusion-opacity":new Fn(Ot.paint_symbol["text-occlusion-opacity"]),"text-color":new Fn(Ot.paint_symbol["text-color"],{runtimeType:Ss,getOverride:u=>u.textColor,hasOverride:u=>!!u.textColor}),"text-halo-color":new Fn(Ot.paint_symbol["text-halo-color"]),"text-halo-width":new Fn(Ot.paint_symbol["text-halo-width"]),"text-halo-blur":new Fn(Ot.paint_symbol["text-halo-blur"]),"text-translate":new _n(Ot.paint_symbol["text-translate"]),"text-translate-anchor":new _n(Ot.paint_symbol["text-translate-anchor"]),"icon-color-saturation":new _n(Ot.paint_symbol["icon-color-saturation"]),"icon-color-contrast":new _n(Ot.paint_symbol["icon-color-contrast"]),"icon-color-brightness-min":new _n(Ot.paint_symbol["icon-color-brightness-min"]),"icon-color-brightness-max":new _n(Ot.paint_symbol["icon-color-brightness-max"]),"symbol-z-offset":new Fn(Ot.paint_symbol["symbol-z-offset"]),"icon-color-use-theme":new Fn({type:"string",default:"default","property-type":"data-driven"}),"icon-halo-color-use-theme":new Fn({type:"string",default:"default","property-type":"data-driven"}),"text-color-use-theme":new Fn({type:"string",default:"default","property-type":"data-driven"}),"text-halo-color-use-theme":new Fn({type:"string",default:"default","property-type":"data-driven"})}))},e2);class Y0 extends fs{constructor(n,s,c,g){super(n,t2(),s,c,g),this._colorAdjustmentMatrix=Ne.mat4.identity([]),this.hasInitialOcclusionOpacityProperties=n.paint!==void 0&&("icon-occlusion-opacity"in n.paint||"text-occlusion-opacity"in n.paint)}recalculate(n,s){super.recalculate(n,s),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const c=this.layout.get("text-writing-mode");if(c){const g=[];for(const f of c)g.indexOf(f)<0&&g.push(f);this.layout._values["text-writing-mode"]=g}else this.layout._values["text-writing-mode"]=this.layout.get("symbol-placement")==="point"?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getColorAdjustmentMatrix(n,s,c,g){return this._saturation===n&&this._contrast===s&&this._brightnessMin===c&&this._brightnessMax===g||(this._colorAdjustmentMatrix=function(f,_,T,A){f=ke(f),_=Ee(_);const D=Ne.mat4.create(),w=f/3,k=1-2*w,O=[k,w,w,0,w,k,w,0,w,w,k,0,0,0,0,1],I=.5-.5*_,R=A-T;return Ne.mat4.multiply(D,[R,0,0,0,0,R,0,0,0,0,R,0,T,T,T,1],[_,0,0,0,0,_,0,0,0,0,_,0,I,I,I,1]),Ne.mat4.multiply(D,D,O),D}(n,s,c,g),this._saturation=n,this._contrast=s,this._brightnessMin=c,this._brightnessMax=g),this._colorAdjustmentMatrix}getValueAndResolveTokens(n,s,c,g){const f=this.layout.get(n).evaluate(s,{},c,g),_=this._unevaluatedLayout._values[n];return _.isDataDriven()||Vg(_.value)||!f?f:function(T,A){return A.replace(/{([^{}]+)}/g,(D,w)=>w in T?String(T[w]):"")}(s.properties,f)}createBucket(n){return new Z0(n)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const n of t2().paint.overridableProperties){if(!Y0.hasPaintOverride(this.layout,n))continue;const s=this.paint.get(n),c=new bA(s),g=new fp(c,s.property.specification,this.scope,this.options);let f=null;f=s.value.kind==="constant"||s.value.kind==="source"?new hp("source",g):new nd("composite",g,s.value.zoomStops,s.value._interpolationType),this.paint._values[n]=new od(s.property,f,s.parameters)}}_handleOverridablePaintPropertyUpdate(n,s,c){return!(!this.layout||s.isDataDriven()||c.isDataDriven())&&Y0.hasPaintOverride(this.layout,n)}static hasPaintOverride(n,s){const c=n.get("text-field"),g=t2().paint.properties[s];let f=!1;const _=T=>{for(const A of T)if(g.overrides&&g.overrides.hasOverride(A))return void(f=!0)};if(c.value.kind==="constant"&&c.value.value instanceof qo)_(c.value.value.sections);else if(c.value.kind==="source"){const T=D=>{f||(D instanceof da&&Gi(D.value)===bl?_(D.value.sections):D instanceof xl?_(D.sections):D.eachChild(T))},A=c.value;A._styleExpression&&T(A._styleExpression.expression)}return f}getProgramIds(){return["symbol"]}getDefaultProgramParams(n,s,c){return{config:new cc(this,{zoom:s,lut:c}),overrideFog:!1}}}let xA,wA,SA,TA;var n2=ti([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);function r2(u){switch(u){case WebGL2RenderingContext.RGBA8:return WebGL2RenderingContext.RGBA;case WebGL2RenderingContext.DEPTH_COMPONENT16:return WebGL2RenderingContext.DEPTH_COMPONENT;case WebGL2RenderingContext.DEPTH24_STENCIL8:return WebGL2RenderingContext.DEPTH_STENCIL;case WebGL2RenderingContext.R8:case WebGL2RenderingContext.R32F:return WebGL2RenderingContext.RED}}function i2(u){switch(u){case WebGL2RenderingContext.RGBA8:return WebGL2RenderingContext.UNSIGNED_BYTE;case WebGL2RenderingContext.DEPTH_COMPONENT16:return WebGL2RenderingContext.UNSIGNED_SHORT;case WebGL2RenderingContext.DEPTH24_STENCIL8:return WebGL2RenderingContext.UNSIGNED_INT_24_8;case WebGL2RenderingContext.R8:return WebGL2RenderingContext.UNSIGNED_BYTE;case WebGL2RenderingContext.R32F:return WebGL2RenderingContext.FLOAT}}class o2{constructor(n,s,c,g){this.context=n,this.format=c,this.useMipmap=g&&g.useMipmap,this.texture=n.gl.createTexture(),this.update(s,{premultiply:g&&g.premultiply})}update(n,s){const c=n&&n instanceof HTMLVideoElement&&n.width===0?n.videoWidth:n.width,g=n&&n instanceof HTMLVideoElement&&n.height===0?n.videoHeight:n.height,{context:f}=this,{gl:_}=f,{x:T,y:A}=s&&s.position?s.position:{x:0,y:0},D=Math.max(T+c,this.size?this.size[0]:0),w=Math.max(A+g,this.size?this.size[1]:0);!this.size||this.size[0]===D&&this.size[1]===w||(_.bindTexture(_.TEXTURE_2D,null),_.deleteTexture(this.texture),this.texture=_.createTexture(),this.size=null),_.bindTexture(_.TEXTURE_2D,this.texture),f.pixelStoreUnpackFlipY.set(!1),f.pixelStoreUnpack.set(1),f.pixelStoreUnpackPremultiplyAlpha.set(this.format===_.RGBA8&&(!s||s.premultiply!==!1));const k=n instanceof HTMLImageElement||n instanceof HTMLCanvasElement||n instanceof HTMLVideoElement||n instanceof ImageData||ImageBitmap&&n instanceof ImageBitmap;if(!this.size&&D>0&&w>0){const O=this.useMipmap?Math.floor(Math.log2(Math.max(D,w)))+1:1;_.texStorage2D(_.TEXTURE_2D,O,this.format,D,w),this.size=[D,w]}if(this.size)if(k)_.texSubImage2D(_.TEXTURE_2D,0,T,A,r2(this.format),i2(this.format),n);else{const O=n.data;O&&_.texSubImage2D(_.TEXTURE_2D,0,T,A,c,g,r2(this.format),i2(this.format),O)}this.useMipmap&&_.generateMipmap(_.TEXTURE_2D)}bind(n,s,c=!1){const{context:g}=this,{gl:f}=g;f.bindTexture(f.TEXTURE_2D,this.texture),n!==this.minFilter&&(f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MAG_FILTER,n),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MIN_FILTER,this.useMipmap&&!c?n===f.NEAREST?f.NEAREST_MIPMAP_NEAREST:f.LINEAR_MIPMAP_LINEAR:n),this.minFilter=n),s!==this.wrapS&&(f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_S,s),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_T,s),this.wrapS=s)}bindExtraParam(n,s,c,g){const{context:f}=this,{gl:_}=f;_.bindTexture(_.TEXTURE_2D,this.texture),s!==this.magFilter&&(_.texParameteri(_.TEXTURE_2D,_.TEXTURE_MAG_FILTER,s),this.magFilter=s),n!==this.minFilter&&(_.texParameteri(_.TEXTURE_2D,_.TEXTURE_MIN_FILTER,this.useMipmap?n===_.NEAREST?_.NEAREST_MIPMAP_NEAREST:_.LINEAR_MIPMAP_LINEAR:n),this.minFilter=n),c!==this.wrapS&&(_.texParameteri(_.TEXTURE_2D,_.TEXTURE_WRAP_S,c),this.wrapS=c),g!==this.wrapT&&(_.texParameteri(_.TEXTURE_2D,_.TEXTURE_WRAP_T,g),this.wrapT=g)}destroy(){const{gl:n}=this.context;n.deleteTexture(this.texture),this.texture=null}}class X0{constructor(n,s){this.context=n,this.texture=s}bind(n,s){const{context:c}=this,{gl:g}=c;g.bindTexture(g.TEXTURE_2D,this.texture),n!==this.minFilter&&(g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MAG_FILTER,n),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MIN_FILTER,n),this.minFilter=n),s!==this.wrapS&&(g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_S,s),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_T,s),this.wrapS=s)}}function J0(u,n,s,c,g,f,_,T){const A=[u,n,1,s,c,1,g,f,1],D=[_,T,1],w=Ne.mat3.adjoint([],A),[k,O,I]=Ne.vec3.transformMat3(D,D,w);return Ne.mat3.multiply(A,A,[k,0,0,0,O,0,0,0,I])}function CA(u,n,s,c,g,f,_,T){const A=function(D,w,k,O,I,R,B,W){const K=J0(0,0,1,0,1,1,0,1),ie=J0(D,w,k,O,I,R,B,W),oe=Ne.mat3.adjoint([],K);return Ne.mat3.multiply(ie,ie,oe)}(u,n,s,c,g,f,_,T);return[A[2]/A[8]/kn,A[5]/A[8]/kn]}function Q0(u){return[u[0],Math.min(Math.max(u[1],-85.051129),Ps)]}class EA extends $c{constructor(n,s,c,g){super(),this.id=n,this.dispatcher=c,this.coordinates=s.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.onNorthPole=!1,this.onSouthPole=!1,this.setEventedParent(g),this.options=s,this._dirty=!1}load(n,s){if(this._loaded=s||!1,this.fire(new lu("dataloading",{dataType:"source"})),this.url=this.options.url,!this.url)return n&&(this.coordinates=n),this._loaded=!0,void this._finishLoading();this._imageRequest=zh(this.map._requestManager.transformRequest(this.url,_l.Image),(c,g)=>{this._imageRequest=null,this._loaded=!0,c?this.fire(new uu(c)):g&&(this.image=g instanceof HTMLImageElement?bn.getImageData(g):g,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,n&&(this.coordinates=n),this._finishLoading())})}loaded(){return this._loaded}updateImage(n){return n.url?(this._imageRequest&&n.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=n.url,this.load(n.coordinates,this._loaded),this):this}setTexture(n){if(!(n.handle instanceof WebGLTexture))throw new Error("The provided handle is not a WebGLTexture instance");return this.texture=new X0(this.map.painter.context,n.handle),this.width=n.dimensions[0],this.height=n.dimensions[1],this._dirty=!1,this._loaded=!0,this._finishLoading(),this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new lu("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(n){this.map=n,this.load()}onRemove(n){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),!this.texture||this.texture instanceof X0||this.texture.destroy(),this.boundsBuffer&&(this.boundsBuffer.destroy(),this.elevatedGlobeVertexBuffer&&this.elevatedGlobeVertexBuffer.destroy(),this.elevatedGlobeIndexBuffer&&this.elevatedGlobeIndexBuffer.destroy())}setCoordinates(n){if(this.coordinates=n,this._boundsArray=void 0,this._unsupportedCoords=!1,!n.length)return this;this.onNorthPole=!1,this.onSouthPole=!1;let s=n[0][1],c=n[0][1];for(const f of n)f[1]>c&&(c=f[1]),f[1]<s&&(s=f[1]);const g=(c+s)/2;if(g>Ps?this.onNorthPole=!0:g<-85.051129&&(this.onSouthPole=!0),!this.onNorthPole&&!this.onSouthPole){const f=n.map(v.fromLngLat);this.tileID=function(_){let T=1/0,A=1/0,D=-1/0,w=-1/0;for(const B of _)T=Math.min(T,B.x),A=Math.min(A,B.y),D=Math.max(D,B.x),w=Math.max(w,B.y);const k=Math.max(D-T,w-A),O=Math.max(0,Math.floor(-Math.log(k)/Math.LN2)),I=Math.pow(2,O);let R=Math.floor((T+D)/2*I);return R>1&&(R-=1),new Rn(O,R,Math.floor((A+w)/2*I))}(f),this.minzoom=this.maxzoom=this.tileID.z}return this.fire(new lu("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0,this._unsupportedCoords=!1}_prepareData(n){for(const K in this.tiles){const ie=this.tiles[K];ie.state!=="loaded"&&(ie.state="loaded",ie.texture=this.texture)}if(this._boundsArray||this.onNorthPole||this.onSouthPole||this._unsupportedCoords)return;const s=A_(new Rn(0,0,0),this.map.transform.projection),c=[s.projection.project(this.coordinates[0][0],this.coordinates[0][1]),s.projection.project(this.coordinates[1][0],this.coordinates[1][1]),s.projection.project(this.coordinates[2][0],this.coordinates[2][1]),s.projection.project(this.coordinates[3][0],this.coordinates[3][1])];if(!function(K){const ie=K[1].x-K[0].x,oe=K[1].y-K[0].y,Q=K[2].x-K[1].x,ue=K[2].y-K[1].y,ge=K[3].x-K[2].x,Se=K[3].y-K[2].y,Fe=K[0].x-K[3].x,ze=K[0].y-K[3].y,Le=ie*ue-Q*oe,nt=Q*Se-ge*ue,$e=ge*ze-Fe*Se,it=Fe*oe-ie*ze;return Le>0&&nt>0&&$e>0&&it>0||Le<0&&nt<0&&$e<0&&it<0}(c))return console.warn("Image source coordinates are defining non-convex area in the Mercator projection"),void(this._unsupportedCoords=!0);const g=A_(this.tileID,this.map.transform.projection),[f,_,T,A]=this.coordinates.map(K=>{const ie=g.projection.project(K[0],K[1]);return fA(g,ie)._round()});this.perspectiveTransform=CA(f.x,f.y,_.x,_.y,T.x,T.y,A.x,A.y);const D=this._boundsArray=new fd;D.emplaceBack(f.x,f.y,0,0),D.emplaceBack(_.x,_.y,kn,0),D.emplaceBack(A.x,A.y,0,kn),D.emplaceBack(T.x,T.y,kn,kn),this.boundsBuffer&&(this.boundsBuffer.destroy(),this.elevatedGlobeVertexBuffer&&this.elevatedGlobeVertexBuffer.destroy(),this.elevatedGlobeIndexBuffer&&this.elevatedGlobeIndexBuffer.destroy()),this.boundsBuffer=n.createVertexBuffer(D,n2.members),this.boundsSegments=Yi.simpleSegment(0,0,4,2);const w=[],k=[Q0((O=this.coordinates)[0]),Q0(O[1]),Q0(O[2]),Q0(O[3])];var O;const[I,R,B,W]=function(K){let ie=K[0][0],oe=ie,Q=K[0][1],ue=Q;for(let ge=1;ge<K.length;ge++)K[ge][0]<ie?ie=K[ge][0]:K[ge][0]>oe&&(oe=K[ge][0]),K[ge][1]<Q?Q=K[ge][1]:K[ge][1]>ue&&(ue=K[ge][1]);return[ie,Q,oe-ie,ue-Q]}(k);{const K=new fd,[ie,oe,Q,ue]=function(wt){let Mt=wt[0].x,vt=Mt,qt=wt[0].y,mn=qt;for(let Zt=1;Zt<wt.length;Zt++)wt[Zt].x<Mt?Mt=wt[Zt].x:wt[Zt].x>vt&&(vt=wt[Zt].x),wt[Zt].y<qt?qt=wt[Zt].y:wt[Zt].y>mn&&(mn=wt[Zt].y);return[Mt,qt,vt-Mt,mn-qt]}(c),ge=wt=>[(wt.x-ie)/Q,(wt.y-oe)/ue],[Se,Fe,ze,Le]=c.map(ge),nt=function(wt,Mt,vt,qt,mn,Zt,Tn,Sn){const On=J0(0,0,1,0,1,1,0,1),nn=J0(wt,Mt,vt,qt,mn,Zt,Tn,Sn),Yn=Ne.mat3.adjoint([],nn);return Ne.mat3.multiply(On,On,Yn)}(Se[0],Se[1],Fe[0],Fe[1],ze[0],ze[1],Le[0],Le[1]);this.elevatedGlobePerspectiveTransform=CA(Se[0],Se[1],Fe[0],Fe[1],ze[0],ze[1],Le[0],Le[1]);const $e=(wt,Mt)=>{w.push(wt.lng);const vt=Math.round((wt.lng-I)/B*kn),qt=Math.round((wt.lat-R)/W*kn),mn=ge(Mt),Zt=Ne.vec3.transformMat3([],[mn[0],mn[1],1],nt),Tn=Math.round(Zt[0]/Zt[2]*kn),Sn=Math.round(Zt[1]/Zt[2]*kn);K.emplaceBack(vt,qt,Tn,Sn)},it=c[3].x-c[0].x,dt=c[3].y-c[0].y,ct=c[2].x-c[1].x,mt=c[2].y-c[1].y;for(let wt=0;wt<65;wt++){const Mt=wt/64,vt=[c[0].x+Mt*it,c[0].y+Mt*dt],qt=[c[1].x+Mt*ct,c[1].y+Mt*mt],mn=qt[0]-vt[0],Zt=qt[1]-vt[1];for(let Tn=0;Tn<65;Tn++){const Sn=Tn/64,On={x:vt[0]+mn*Sn,y:vt[1]+Zt*Sn,z:0};$e(s.projection.unproject(On.x,On.y),On)}}this.elevatedGlobeVertexBuffer=n.createVertexBuffer(K,n2.members)}{this.maxLongitudeTriangleSize=0;let K=[],ie=new Uo;const oe=(Q,ue,ge)=>{ie.emplaceBack(Q,ue,ge);const Se=w[Q],Fe=w[ue],ze=w[ge],Le=Math.min(Math.min(Se,Fe),ze),nt=Math.max(Math.max(Se,Fe),ze)-Le;nt>this.maxLongitudeTriangleSize&&(this.maxLongitudeTriangleSize=nt),K.push(Le+nt/2)};for(let Q=0;Q<64;Q++)for(let ue=0;ue<64;ue++){const ge=65*Q+ue,Se=ge+1,Fe=ge+65,ze=Fe+1;oe(ge,Fe,Se),oe(Se,Fe,ze)}[K,ie]=function(Q,ue){const ge=Array.from({length:Q.length},(ze,Le)=>Le);ge.sort((ze,Le)=>Q[ze]-Q[Le]);const Se=[],Fe=new Uo;for(let ze=0;ze<ge.length;ze++){const Le=ge[ze];Se.push(Q[Le]);const nt=3*Le,$e=nt+1;Fe.emplaceBack(ue.uint16[nt],ue.uint16[$e],ue.uint16[$e+1])}return[Se,Fe]}(K,ie),this.elevatedGlobeTrianglesCenterLongitudes=K,this.elevatedGlobeIndexBuffer=n.createIndexBuffer(ie)}this.elevatedGlobeSegments=Yi.simpleSegment(0,0,4225,8192),this.elevatedGlobeGridMatrix=new Float32Array([0,B/kn,0,W/kn,0,0,R,I,0])}prepare(){const n=Object.keys(this.tiles).length!==0;if(this.tileID&&!n)return;const s=this.map.painter.context,c=s.gl;!this._dirty||this.texture instanceof X0||(this.texture?this.texture.update(this.image):(this.texture=new o2(s,this.image,c.RGBA8),this.texture.bind(c.LINEAR,c.CLAMP_TO_EDGE)),this._dirty=!1),n&&this._prepareData(s)}loadTile(n,s){this.tileID&&this.tileID.equals(n.tileID.canonical)?(this.tiles[String(n.tileID.wrap)]=n,n.buckets={},s(null)):(n.state="errored",s(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}getSegmentsForLongitude(n){const s=this.elevatedGlobeSegments;if(!this.elevatedGlobeTrianglesCenterLongitudes||!s)return null;const c=this.elevatedGlobeTrianglesCenterLongitudes;let g=(f=n+180)+360*Math.round((c[0]-f)/360);var f;const _=new Yi,T=(k,O)=>{_.segments.push({vertexOffset:0,primitiveOffset:k,vertexLength:s.segments[0].vertexLength,primitiveLength:O,sortKey:void 0,vaos:{}})},A=.51*this.maxLongitudeTriangleSize;if(Math.abs(c[0]-g)<=A){const k=Ut(c,0,c.length,g+A);return k===c.length||T(k,Oo(c,k+1,c.length,g+360-A)-k),_}g<c[0]&&(g+=360);const D=Oo(c,0,c.length,g-A);if(D===c.length)return T(0,c.length),_;T(0,D-0);const w=Ut(c,D+1,c.length,g+A);return w!==c.length&&T(w,c.length-w),_}}const vV=(Math.pow(256,2)-1)/16907520;class MA extends fs{constructor(n,s,c,g){super(n,{layout:SA||(SA=new Zi({visibility:new _n(Ot.layout_raster.visibility)})),paint:TA||(TA=new Zi({"raster-opacity":new _n(Ot.paint_raster["raster-opacity"]),"raster-color":new ad(Ot.paint_raster["raster-color"]),"raster-color-mix":new _n(Ot.paint_raster["raster-color-mix"]),"raster-color-range":new _n(Ot.paint_raster["raster-color-range"]),"raster-hue-rotate":new _n(Ot.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new _n(Ot.paint_raster["raster-brightness-min"]),"raster-brightness-max":new _n(Ot.paint_raster["raster-brightness-max"]),"raster-saturation":new _n(Ot.paint_raster["raster-saturation"]),"raster-contrast":new _n(Ot.paint_raster["raster-contrast"]),"raster-resampling":new _n(Ot.paint_raster["raster-resampling"]),"raster-fade-duration":new _n(Ot.paint_raster["raster-fade-duration"]),"raster-emissive-strength":new _n(Ot.paint_raster["raster-emissive-strength"]),"raster-array-band":new _n(Ot.paint_raster["raster-array-band"]),"raster-elevation":new _n(Ot.paint_raster["raster-elevation"]),"raster-color-use-theme":new Fn({type:"string",default:"default","property-type":"data-driven"})}))},s,c,g),this.updateColorRamp(),this._curRampRange=[NaN,NaN]}getProgramIds(){return["raster"]}hasColorMap(){return!!this._transitionablePaint._values["raster-color"].value.value}tileCoverLift(){return this.paint.get("raster-elevation")}isDraped(n){return!(n&&n._source instanceof EA&&(n._source.onNorthPole||n._source.onSouthPole))&&this.paint.get("raster-elevation")===0}_handleSpecialPaintPropertyUpdate(n){n!=="raster-color"&&n!=="raster-color-range"||(this._curRampRange=[NaN,NaN],this.updateColorRamp())}updateColorRamp(n){if(!this.hasColorMap()||!this._curRampRange)return;const s=this._transitionablePaint._values["raster-color"].value.expression,[c,g]=n||this._transitionablePaint._values["raster-color-range"].value.expression.evaluate({zoom:0})||[NaN,NaN];isNaN(c)&&isNaN(g)||c===this._curRampRange[0]&&g===this._curRampRange[1]||(this.colorRamp=m_({expression:s,evaluationKey:"rasterValue",image:this.colorRamp,clips:[{start:c,end:g}],resolution:256}),this.colorRampTexture=null,this._curRampRange=[c,g])}}let IA,AA,kA,PA,RA;class OA extends fs{constructor(n,s,c,g){super(n,{layout:IA||(IA=new Zi({visibility:new _n(Ot["layout_raster-particle"].visibility)})),paint:AA||(AA=new Zi({"raster-particle-array-band":new _n(Ot["paint_raster-particle"]["raster-particle-array-band"]),"raster-particle-count":new _n(Ot["paint_raster-particle"]["raster-particle-count"]),"raster-particle-color":new ad(Ot["paint_raster-particle"]["raster-particle-color"]),"raster-particle-max-speed":new _n(Ot["paint_raster-particle"]["raster-particle-max-speed"]),"raster-particle-speed-factor":new _n(Ot["paint_raster-particle"]["raster-particle-speed-factor"]),"raster-particle-fade-opacity-factor":new _n(Ot["paint_raster-particle"]["raster-particle-fade-opacity-factor"]),"raster-particle-reset-rate-factor":new _n(Ot["paint_raster-particle"]["raster-particle-reset-rate-factor"]),"raster-particle-elevation":new _n(Ot["paint_raster-particle"]["raster-particle-elevation"]),"raster-particle-color-use-theme":new Fn({type:"string",default:"default","property-type":"data-driven"})}))},s,c,g),this._updateColorRamp(),this.lastInvalidatedAt=bn.now()}onRemove(n){this.colorRampTexture&&this.colorRampTexture.destroy(),this.tileFramebuffer&&this.tileFramebuffer.destroy(),this.particleFramebuffer&&this.particleFramebuffer.destroy()}hasColorMap(){return!!this._transitionablePaint._values["raster-particle-color"].value.value}getProgramIds(){return["rasterParticle"]}hasOffscreenPass(){return this.visibility!=="none"}isDraped(n){return!1}_handleSpecialPaintPropertyUpdate(n){n!=="raster-particle-color"&&n!=="raster-particle-max-speed"||(this._updateColorRamp(),this._invalidateAnimationState()),n==="raster-particle-count"&&this._invalidateAnimationState()}_updateColorRamp(){if(!this.hasColorMap())return;const n=this._transitionablePaint._values["raster-particle-color"].value.expression,s=this._transitionablePaint._values["raster-particle-max-speed"].value.expression.evaluate({zoom:0});this.colorRamp=m_({expression:n,evaluationKey:"rasterParticleSpeed",image:this.colorRamp,clips:[{start:0,end:s}],resolution:256}),this.colorRampTexture=null}_invalidateAnimationState(){this.lastInvalidatedAt=bn.now()}tileCoverLift(){return this.paint.get("raster-particle-elevation")}}class bV extends fs{constructor(n,s){super(n,{},s,null),this.implementation=n,n.slot&&(this.slot=n.slot)}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}isDraped(n){return this.implementation.renderToTile!==void 0}shouldRedrape(){return!!this.implementation.shouldRerenderTiles&&this.implementation.shouldRerenderTiles()}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(n){this.implementation.onAdd&&this.implementation.onAdd(n,n.painter.context.gl)}onRemove(n){this.implementation.onRemove&&this.implementation.onRemove(n,n.painter.context.gl)}}function s2(u,n,s){const c=[0,0,1],g=Ne.quat.identity([]);return Ne.quat.rotateY(g,g,s?-Pt(u)+Math.PI:Pt(u)),Ne.quat.rotateX(g,g,-Pt(n)),Ne.vec3.transformQuat(c,c,g),Ne.vec3.normalize(c,c)}function LA(u,n){const s=eb(u.projection,u.zoom,u.width,u.height),c=function(f,_,T,A,D){const w=new Qr(T.lng-180*xd,T.lat),k=new Qr(T.lng+180*xd,T.lat),O=f.project(w.lng,w.lat),I=f.project(k.lng,k.lat),R=-Math.atan2(I.y-O.y,I.x-O.x),B=v.fromLngLat(T);B.y=Et(B.y,-1+xd,1-xd);const W=B.toLngLat(),K=f.project(W.lng,W.lat),ie=v.fromLngLat(W);ie.x+=xd;const oe=ie.toLngLat(),Q=f.project(oe.lng,oe.lat),ue=zA(Q.x-K.x,Q.y-K.y,R),ge=v.fromLngLat(W);ge.y+=xd;const Se=ge.toLngLat(),Fe=f.project(Se.lng,Se.lat),ze=zA(Fe.x-K.x,Fe.y-K.y,R),Le=Math.abs(ue.x)/Math.abs(ze.y),nt=Ne.mat4.identity([]);Ne.mat4.rotateZ(nt,nt,-R*(1-(D?0:A)));const $e=Ne.mat4.identity([]);return Ne.mat4.scale($e,$e,[1,1-(1-Le)*A,1]),$e[4]=-ze.x/ze.y*A,Ne.mat4.rotateZ($e,$e,R),Ne.mat4.multiply($e,nt,$e),$e}(u.projection,0,u.center,s,n),g=DA(u);return Ne.mat4.scale(c,c,[g,g,1]),c}function DA(u){const n=u.projection,s=eb(u.projection,u.zoom,u.width,u.height),c=a2(n,u.center),g=a2(n,Qr.convert(n.center));return Math.pow(2,c*s+(1-s)*g)}function eb(u,n,s,c,g=1/0){const f=u.range;if(!f)return 0;const _=Math.min(g,Math.max(s,c)),T=Math.log(_/1024)/Math.LN2;return En(f[0]+T,f[1]+T,n)}const xd=1/4e4;function a2(u,n){const s=Et(n.lat,-85.051129,Ps),c=new Qr(n.lng-180*xd,s),g=new Qr(n.lng+180*xd,s),f=u.project(c.lng,s),_=u.project(g.lng,s),T=v.fromLngLat(c),A=v.fromLngLat(g),D=_.x-f.x,w=_.y-f.y,k=A.x-T.x,O=A.y-T.y,I=Math.sqrt((k*k+O*O)/(D*D+w*w));return Math.log(I)/Math.LN2}function zA(u,n,s){const c=Math.cos(s),g=Math.sin(s);return{x:u*c-n*g,y:u*g+n*c}}function FA(u,n,s){Ne.mat4.identity(u),Ne.mat4.rotateZ(u,u,Pt(n[2])),Ne.mat4.rotateX(u,u,Pt(n[0])),Ne.mat4.rotateY(u,u,Pt(n[1])),Ne.mat4.scale(u,u,s),Ne.mat4.multiply(u,u,[1,0,0,0,0,0,1,0,0,1,0,0,0,0,0,1])}function tb(u,n,s,c,g,f,_,T){const A=[s[0]-n[0],s[1]-n[1],0],D=[c[0]-n[0],c[1]-n[1],0];if(Ne.vec3.length(A)<1e-12||Ne.vec3.length(D)<1e-12)return Ne.quat.identity(u);const w=Ne.vec3.cross([],A,D);Ne.vec3.normalize(w,w),Ne.vec3.subtract(D,c,n),A[2]=(f-g)*T,D[2]=(_-g)*T;const k=A;return Ne.vec3.cross(k,A,D),Ne.vec3.normalize(k,k),Ne.quat.rotationTo(u,w,k)}function l2(u,n,s=!1){const c=Yo(n.zoom),g=function(f,_,T){const A=_.worldSize,D=[f[12],f[13],f[14]],w=Fo(D[1]/A),k=ks(D[0]/A),O=Ne.mat4.identity([]),I=os(1,w)*A,R=os(1,0)*A*i(w,_.zoom),B=1/hs(A);let W=R*B;if(T){const Q=eb(_.projection,_.zoom,_.width,_.height,1024);W=B*_.projection.pixelSpaceConversion(_.center.lat,A,Q)}const K=hc(w,k);Ne.vec3.add(K,K,Ne.vec3.scale([],Ne.vec3.normalize([],K),I*W*D[2]));const ie=function(Q){const ue=[Q[0],Q[1],Q[2]];let ge=[0,1,0];const Se=Ne.vec3.cross([],ge,ue);return Ne.vec3.cross(ge,ue,Se),Ne.vec3.squaredLength(ge)===0&&(ge=[0,1,0],Ne.vec3.cross(Se,ue,ge)),Ne.vec3.normalize(Se,Se),Ne.vec3.normalize(ge,ge),Ne.vec3.normalize(ue,ue),[Se[0],Se[1],Se[2],0,ge[0],ge[1],ge[2],0,ue[0],ue[1],ue[2],0,Q[0],Q[1],Q[2],1]}(K);Ne.mat4.scale(O,O,[W,W,W*I]),Ne.mat4.translate(O,O,[-D[0],-D[1],-D[2]]);const oe=Ne.mat4.multiply([],_.globeMatrix,ie);return Ne.mat4.multiply(oe,oe,O),Ne.mat4.multiply(oe,oe,f),oe}(u,n,s);if(c>0){const f=function(_,T){const A=T.worldSize,D=os(1,0)*A*i(T.center.lat,T.zoom)/hs(A),w=os(1,T.center.lat)*A,k=Ne.mat4.identity([]);return Ne.mat4.rotateY(k,k,Pt(T.center.lng)),Ne.mat4.rotateX(k,k,Pt(T.center.lat)),Ne.mat4.translate(k,k,[0,0,Ko]),Ne.mat4.scale(k,k,[D,D,D*w]),Ne.mat4.translate(k,k,[T.point.x-.5*A,T.point.y-.5*A,0]),Ne.mat4.multiply(k,k,_),Ne.mat4.multiply(k,T.globeMatrix,k)}(u,n);return function(_,T,A){const D=(R,B,W)=>{const K=Ne.vec3.length(R),ie=Ne.vec3.length(B),oe=ho(R,B,W);return Ne.vec3.scale(oe,oe,1/Ne.vec3.length(oe)*pr(K,ie,W))},w=D([_[0],_[1],_[2]],[T[0],T[1],T[2]],A),k=D([_[4],_[5],_[6]],[T[4],T[5],T[6]],A),O=D([_[8],_[9],_[10]],[T[8],T[9],T[10]],A),I=ho([_[12],_[13],_[14]],[T[12],T[13],T[14]],A);return[w[0],w[1],w[2],0,k[0],k[1],k[2],0,O[0],O[1],O[2],0,I[0],I[1],I[2],1]}(g,f,c)}return g}function NA(u,n,s,c){const g=fr.projectAabbCorners(c,s);let f=Number.MAX_VALUE,_=-1;for(let D=0;D<g.length;++D){const w=g[D];w[0]=(.5*w[0]+.5)*n.width,w[1]=(.5-.5*w[1])*n.height,w[2]<f&&(_=D,f=w[2])}const T=D=>new Je(g[D][0],g[D][1]);let A;switch(_){case 0:case 6:A=[T(1),T(5),T(4),T(7),T(3),T(2),T(1)];break;case 1:case 7:A=[T(0),T(4),T(5),T(6),T(2),T(3),T(0)];break;case 3:case 5:A=[T(1),T(0),T(4),T(7),T(6),T(2),T(1)];break;default:A=[T(1),T(5),T(6),T(7),T(3),T(0),T(1)]}if(Ce(u,A))return f}const xV=ti([{name:"a_pos_3f",components:3,type:"Float32"}]),wV=ti([{name:"a_color_3f",components:3,type:"Float32"}]),SV=ti([{name:"a_color_4f",components:4,type:"Float32"}]),TV=ti([{name:"a_uv_2f",components:2,type:"Float32"}]),CV=ti([{name:"a_normal_3f",components:3,type:"Float32"}]),EV=ti([{name:"a_normal_matrix0",components:4,type:"Float32"},{name:"a_normal_matrix1",components:4,type:"Float32"},{name:"a_normal_matrix2",components:4,type:"Float32"},{name:"a_normal_matrix3",components:4,type:"Float32"}]),MV=ti([{name:"a_pbr",components:4,type:"Uint16"},{name:"a_heightBasedEmissiveStrength",components:3,type:"Float32"}]),BA={None:0,Model:1,Symbol:2,FillExtrusion:4,All:7};class nb{constructor(n,s,c,g){this.message=(n?`${n}: `:"")+c,g&&(this.identifier=g),s!=null&&s.__line__&&(this.line=s.__line__)}}function VA(u,n){const s=u.indexOf("://")===-1;try{return new URL(u,s&&n?"http://example.com":void 0),!0}catch{return!1}}class $A{constructor(n,s){this.feature=n,this.instancedDataOffset=s,this.instancedDataCount=0,this.rotation=[0,0,0],this.scale=[1,1,1],this.translation=[0,0,0]}}class UA{constructor(){this.instancedDataArray=new Ap,this.instancesEvaluatedElevation=[],this.features=[],this.idToFeaturesIndex={}}}class u2{constructor(n){this.zoom=n.zoom,this.canonical=n.canonical,this.layers=n.layers,this.layerIds=this.layers.map(s=>s.fqid),this.projection=n.projection,this.index=n.index,this.hasZoomDependentProperties=this.layers[0].isZoomDependent(),this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id),this.hasPattern=!1,this.instancesPerModel={},this.validForExaggeration=0,this.maxVerticalOffset=0,this.maxScale=0,this.maxHeight=0,this.lookupDim=this.zoom>this.canonical.z?256:this.zoom>15?75:100,this.instanceCount=0,this.terrainElevationMin=0,this.terrainElevationMax=0,this.validForDEMTile={id:null,timestamp:0},this.modelUris=[],this.modelsRequested=!1,this.activeReplacements=[],this.replacementUpdateTime=0}updateFootprints(n,s){}populate(n,s,c,g){this.tileToMeter=m(c);const f=this.layers[0]._featureFilter.needGeometry;this.lookup=new Uint8Array(this.lookupDim*this.lookupDim);for(const{feature:_,id:T,index:A,sourceLayerIndex:D}of n){const w=T??(_.properties&&_.properties.hasOwnProperty("id")?_.properties.id:void 0),k=ne(_,f);if(!this.layers[0]._featureFilter.filter(new ji(this.zoom),k,c))continue;const O={id:w,sourceLayerIndex:D,index:A,geometry:f?k.geometry:Y(_,c,g),properties:_.properties,type:_.type,patterns:{}},I=this.addFeature(O,O.geometry,k);I&&s.featureIndex.insert(_,O.geometry,A,D,this.index,this.instancesPerModel[I].instancedDataArray.length,kn/32)}this.lookup=null}update(n,s,c,g){for(const f in this.instancesPerModel){const _=this.instancesPerModel[f];for(const T in n)_.idToFeaturesIndex.hasOwnProperty(T)&&(this.evaluate(_.features[_.idToFeaturesIndex[T]],n[T],_,!0),this.uploaded=!1)}this.maxHeight=0}updateZoomBasedPaintProperties(){if(!this.hasZoomDependentProperties)return!1;let n=!1;for(const s in this.instancesPerModel){const c=this.instancesPerModel[s];for(const g of c.features){const f=this.layers[0],_=g.feature,T=this.canonical,A=f.paint.get("model-rotation").evaluate(_,{},T),D=f.paint.get("model-scale").evaluate(_,{},T),w=f.paint.get("model-translation").evaluate(_,{},T);Ne.vec3.exactEquals(g.rotation,A)&&Ne.vec3.exactEquals(g.scale,D)&&Ne.vec3.exactEquals(g.translation,w)||(this.evaluate(g,g.featureStates,c,!0),n=!0)}}return n}updateReplacement(n,s,c,g){if(s.updateTime===this.replacementUpdateTime)return!1;this.replacementUpdateTime=s.updateTime;const f=s.getReplacementRegionsForTile(n.toUnwrapped(),!0);if(Lw(this.activeReplacements,f))return!1;this.activeReplacements=f;let _=!1;for(const T in this.instancesPerModel){const A=this.instancesPerModel[T],D=A.instancedDataArray;for(const w of A.features){const k=w.instancedDataOffset,O=w.instancedDataCount;for(let I=0;I<O;I++){const R=16*(I+k);let B=D.float32[R+0];const W=B>kn;B=W?B-kn:B;const K=Math.floor(B),ie=D.float32[R+1];let oe=!1;for(const Q of this.activeReplacements)if(!rI(Q,c,BA.Model,g)&&!(Q.min.x>K||K>Q.max.x||Q.min.y>ie||ie>Q.max.y)&&(oe=uI(lI(K,ie,n.canonical,Q.footprintTileId.canonical),Q.footprint),oe))break;D.float32[R]=oe?B+kn:B,_=_||oe!==W}}}return _}isEmpty(){for(const n in this.instancesPerModel)if(this.instancesPerModel[n].instancedDataArray.length!==0)return!1;return!0}uploadPending(){return!this.uploaded}upload(n){if(!this.uploaded)for(const s in this.instancesPerModel){const c=this.instancesPerModel[s];c.instancedDataArray.length<0||c.instancedDataArray.length===0||(c.instancedDataBuffer?c.instancedDataBuffer.updateData(c.instancedDataArray):c.instancedDataBuffer=n.createVertexBuffer(c.instancedDataArray,EV.members,!0,void 0,this.instanceCount))}this.uploaded=!0}destroy(){for(const s in this.instancesPerModel){const c=this.instancesPerModel[s];c.instancedDataArray.length!==0&&c.instancedDataBuffer&&c.instancedDataBuffer.destroy()}const n=this.layers[0].modelManager;if(n&&this.modelUris)for(const s of this.modelUris)n.removeModel(s,"")}addFeature(n,s,c){const g=this.layers[0],f=g.layout.get("model-id").evaluate(c,{},this.canonical);if(!f)return xn(`modelId is not evaluated for layer ${g.id} and it is not going to get rendered.`),f;VA(f,!1)&&(this.modelUris.includes(f)||this.modelUris.push(f)),this.instancesPerModel[f]||(this.instancesPerModel[f]=new UA);const _=this.instancesPerModel[f],T=_.instancedDataArray,A=new $A(c,T.length);for(const D of s)for(const w of D){if(w.x<0||w.x>=kn||w.y<0||w.y>=kn)continue;const k=(this.lookupDim-1)/kn,O=this.lookupDim*(w.y*k|0)+w.x*k|0;if(this.lookup){if(this.lookup[O]!==0)continue;this.lookup[O]=1}this.instanceCount++;const I=T.length;T.resize(I+1),_.instancesEvaluatedElevation.push(0),T.float32[16*I]=w.x,T.float32[16*I+1]=w.y}return A.instancedDataCount=_.instancedDataArray.length-A.instancedDataOffset,A.instancedDataCount>0&&(n.id&&(_.idToFeaturesIndex[n.id]=_.features.length),_.features.push(A),this.evaluate(A,{},_,!1)),f}getModelUris(){return this.modelUris}evaluate(n,s,c,g){const f=this.layers[0],_=n.feature,T=this.canonical,A=n.rotation=f.paint.get("model-rotation").evaluate(_,s,T),D=n.scale=f.paint.get("model-scale").evaluate(_,s,T),w=n.translation=f.paint.get("model-translation").evaluate(_,s,T),k=f.paint.get("model-color").evaluate(_,s,T);k.a=f.paint.get("model-color-mix-intensity").evaluate(_,s,T);const O=[];this.maxVerticalOffset<w[2]&&(this.maxVerticalOffset=w[2]),this.maxScale=Math.max(Math.max(this.maxScale,D[0]),Math.max(D[1],D[2])),FA(O,A,D);const I=Math.round(100*k.a)+k.b/1.05;for(let R=0;R<n.instancedDataCount;++R){const B=n.instancedDataOffset+R,W=16*B,K=c.instancedDataArray.float32;let ie=0;g&&(ie=K[W+6]-c.instancesEvaluatedElevation[B]);const oe=0|K[W+1];K[W]=(0|K[W])+k.r/1.05,K[W+1]=oe+k.g/1.05,K[W+2]=I,K[W+3]=1/(T.z>10?this.tileToMeter:m(T,oe)),K[W+4]=w[0],K[W+5]=w[1],K[W+6]=w[2]+ie,K[W+7]=O[0],K[W+8]=O[1],K[W+9]=O[2],K[W+10]=O[4],K[W+11]=O[5],K[W+12]=O[6],K[W+13]=O[8],K[W+14]=O[9],K[W+15]=O[10],c.instancesEvaluatedElevation[B]=w[2]}}}let jA,HA;Gn(u2,"ModelBucket",{omit:["layers"]}),Gn(UA,"PerModelAttributes"),Gn($A,"ModelFeature");const qf=64,Kp={CoordinateSpaceTile:1,CoordinateSpaceYUp:2,HasMapboxMeshFeatures:4,HasMeshoptCompression:8};function GA(u,n,s,c,g,f,_,T,A,D=!1){const w=s.zoom,k=s.project(c),O=i(c.lat,w),I=1/O;Ne.mat4.identity(u),Ne.mat4.translate(u,u,[k.x+_[0]*I,k.y+_[1]*I,_[2]]);let R=1,B=1;const W=s.worldSize;if(D){if(s.projection.name==="mercator"){let Q=0;s.elevation&&(Q=s.elevation.getAtPointOrZero(new v(k.x/W,k.y/W),0));const ue=Ne.vec4.transformMat4([],[k.x,k.y,Q,1],s.projMatrix)[3]/s.cameraToCenterDistance;R=ue,B=ue*i(s.center.lat,w)}else if(s.projection.name==="globe"){const Q=l2(u,s),ue=Ne.mat4.multiply([],s.projMatrix,Q),ge=[0,0,0,1];Ne.vec4.transformMat4(ge,ge,ue);const Se=ge[3]/s.cameraToCenterDistance,Fe=Yo(w),ze=s.projection.pixelsPerMeter(c.lat,W)*i(c.lat,w),Le=s.projection.pixelsPerMeter(s.center.lat,W)*i(s.center.lat,w);R=Se/pr(ze,h(s.center.lat),Fe),B=Se*O/ze,R*=Le,B*=Le}}else R=I;Ne.mat4.scale(u,u,[R,R,B]);const K=[...u],ie=n.orientation,oe=[];if(FA(oe,[ie[0]+g[0],ie[1]+g[1],ie[2]+g[2]],f),Ne.mat4.multiply(u,K,oe),T&&s.elevation){let Q=0;const ue=[];if(A&&s.elevation){Q=function(Fe,ze,Le,nt,$e){const it=ze.elevation;if(!it)return 0;const dt=fr.projectAabbCorners(Le,nt),ct=os(1,$e.lat)*ze.worldSize,mt=function(Yn,In){const qn=[0,0,1],ar=[{corners:[0,1,3,2],dotProductWithUp:0},{corners:[1,5,2,6],dotProductWithUp:0},{corners:[0,4,1,5],dotProductWithUp:0},{corners:[2,6,3,7],dotProductWithUp:0},{corners:[4,7,5,6],dotProductWithUp:0},{corners:[0,3,4,7],dotProductWithUp:0}];for(const Mr of ar){const Pr=Yn[Mr.corners[0]],Br=Yn[Mr.corners[1]],Rr=Yn[Mr.corners[2]],Ur=[Br[0]-Pr[0],Br[1]-Pr[1],In*(Br[2]-Pr[2])],Ei=Ne.vec3.cross(Ur,Ur,[Rr[0]-Pr[0],Rr[1]-Pr[1],In*(Rr[2]-Pr[2])]);Ne.vec3.normalize(Ei,Ei),Mr.dotProductWithUp=Ne.vec3.dot(Ei,qn)}return ar.sort((Mr,Pr)=>Mr.dotProductWithUp-Pr.dotProductWithUp),ar[0].corners}(dt,ct),wt=dt[mt[0]],Mt=dt[mt[1]],vt=dt[mt[2]],qt=dt[mt[3]],mn=it.getAtPointOrZero(new v(wt[0]/ze.worldSize,wt[1]/ze.worldSize),0),Zt=it.getAtPointOrZero(new v(Mt[0]/ze.worldSize,Mt[1]/ze.worldSize),0),Tn=it.getAtPointOrZero(new v(vt[0]/ze.worldSize,vt[1]/ze.worldSize),0),Sn=it.getAtPointOrZero(new v(qt[0]/ze.worldSize,qt[1]/ze.worldSize),0),On=(mn+Sn)/2,nn=(Zt+Tn)/2;return On>nn?Zt<Tn?tb(Fe,Mt,qt,wt,Zt,Sn,mn,ct):tb(Fe,vt,wt,qt,Tn,mn,Sn,ct):mn<Sn?tb(Fe,wt,Mt,vt,mn,Zt,Tn,ct):tb(Fe,qt,vt,Mt,Sn,Tn,Zt,ct),Math.max(On,nn)}(ue,s,n.aabb,u,c);const ge=Ne.mat4.fromQuat([],ue),Se=Ne.mat4.multiply([],ge,oe);Ne.mat4.multiply(u,K,Se)}else Q=s.elevation.getAtPointOrZero(new v(k.x/W,k.y/W),0);Q!==0&&(u[14]+=Q)}}function L_(u,n,s=!1){u.uploaded||(u.gfxTexture=new o2(n,u.image,s?n.gl.R8:n.gl.RGBA8,{useMipmap:u.sampler.minFilter>=n.gl.NEAREST_MIPMAP_NEAREST}),u.uploaded=!0,u.image=null)}function IV(u,n,s){u.indexBuffer=n.createIndexBuffer(u.indexArray,!1,!0),u.vertexBuffer=n.createVertexBuffer(u.vertexArray,xV.members,!1,!0),u.normalArray&&(u.normalBuffer=n.createVertexBuffer(u.normalArray,CV.members,!1,!0)),u.texcoordArray&&(u.texcoordBuffer=n.createVertexBuffer(u.texcoordArray,TV.members,!1,!0)),u.colorArray&&(u.colorBuffer=n.createVertexBuffer(u.colorArray,(u.colorArray.bytesPerElement===12?wV:SV).members,!1,!0)),u.featureArray&&(u.pbrBuffer=n.createVertexBuffer(u.featureArray,MV.members,!0)),u.segments=Yi.simpleSegment(0,0,u.vertexArray.length,u.indexArray.length);const c=u.material;c.pbrMetallicRoughness.baseColorTexture&&L_(c.pbrMetallicRoughness.baseColorTexture,n),c.pbrMetallicRoughness.metallicRoughnessTexture&&L_(c.pbrMetallicRoughness.metallicRoughnessTexture,n),c.normalTexture&&L_(c.normalTexture,n),c.occlusionTexture&&L_(c.occlusionTexture,n,s),c.emissionTexture&&L_(c.emissionTexture,n)}function c2(u,n,s){if(u.meshes)for(const c of u.meshes)IV(c,n,s);if(u.children)for(const c of u.children)c2(c,n,s)}function rb(u){if(u.meshes)for(const n of u.meshes)n.indexArray.destroy(),n.vertexArray.destroy(),n.colorArray&&n.colorArray.destroy(),n.normalArray&&n.normalArray.destroy(),n.texcoordArray&&n.texcoordArray.destroy(),n.featureArray&&n.featureArray.destroy();if(u.children)for(const n of u.children)rb(n)}function d2(u){if(u.meshes)for(const s of u.meshes)s.vertexBuffer&&(s.vertexBuffer.destroy(),s.indexBuffer.destroy(),s.normalBuffer&&s.normalBuffer.destroy(),s.texcoordBuffer&&s.texcoordBuffer.destroy(),s.colorBuffer&&s.colorBuffer.destroy(),s.pbrBuffer&&s.pbrBuffer.destroy(),s.segments.destroy(),s.material&&((n=s.material).pbrMetallicRoughness.baseColorTexture&&n.pbrMetallicRoughness.baseColorTexture.gfxTexture&&n.pbrMetallicRoughness.baseColorTexture.gfxTexture.destroy(),n.pbrMetallicRoughness.metallicRoughnessTexture&&n.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture&&n.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture.destroy(),n.normalTexture&&n.normalTexture.gfxTexture&&n.normalTexture.gfxTexture.destroy(),n.emissionTexture&&n.emissionTexture.gfxTexture&&n.emissionTexture.gfxTexture.destroy(),n.occlusionTexture&&n.occlusionTexture.gfxTexture&&n.occlusionTexture.gfxTexture.destroy()));var n;if(u.children)for(const s of u.children)d2(s)}class Zp{constructor(n,s,c){this._demTile=n,this._dem=this._demTile.dem,this._scale=s,this._offset=c}static create(n,s,c){const g=c||n.findDEMTileFor(s);if(!g||!g.dem)return;const f=g.dem,_=g.tileID,T=1<<s.canonical.z-_.canonical.z;return new Zp(g,f.dim/kn/T,[(s.canonical.x/T-_.canonical.x)*f.dim,(s.canonical.y/T-_.canonical.y)*f.dim])}tileCoordToPixel(n,s){const c=s*this._scale+this._offset[1],g=Math.floor(n*this._scale+this._offset[0]),f=Math.floor(c);return new Je(g,f)}getElevationAt(n,s,c,g){const f=n*this._scale+this._offset[0],_=s*this._scale+this._offset[1],T=Math.floor(f),A=Math.floor(_),D=this._dem;return g=!!g,c?pr(pr(D.get(T,A,g),D.get(T,A+1,g),_-A),pr(D.get(T+1,A,g),D.get(T+1,A+1,g),_-A),f-T):D.get(T,A,g)}getElevationAtPixel(n,s,c){return this._dem.get(n,s,!!c)}getMeterToDEM(n){return(1<<this._demTile.tileID.canonical.z)*os(1,n)*this._dem.stride}}const f2=new Float32Array(262144),Kf=new Uint8Array(262144);function WA(u){let n=0;if(u.meshes)for(const s of u.meshes)n=Math.max(n,s.aabb.max[2]);if(u.children)for(const s of u.children)n=Math.max(n,WA(s));return n}function qA(u,n,s){if(u.meshes)for(const c of u.meshes){if(c.aabb.min[0]===1/0)continue;const g=fr.applyTransform(c.aabb,u.matrix);s.insert(n,g.min[0],g.min[1],g.max[0],g.max[1])}if(u.children)for(const c of u.children)qA(c,n,s)}const KA=["","wall","door","roof","window","lamp","logo"];class ZA{constructor(n){this.node=n,this.evaluatedRMEA=[[1,0,0,1],[1,0,0,1],[1,0,0,1],[1,0,0,1],[.4,1,0,1],[1,0,0,1],[1,0,0,1]],this.hiddenByReplacement=!1,this.evaluatedScale=[1,1,1],this.evaluatedColor=[],this.emissionHeightBasedParams=[],this.cameraCollisionOpacity=1,this.feature={type:"Point",id:n.id,geometry:[],properties:{height:WA(n)}},this.aabb=this._getLocalBounds(),this.state=null}_getLocalBounds(){if(!this.node.meshes)return new fr([1/0,1/0,1/0],[-1/0,-1/0,-1/0]);if(!this.aabb){let n=0;const s=new fr([1/0,1/0,1/0],[-1/0,-1/0,-1/0]);for(const c of this.node.meshes)this.node.lightMeshIndex!==n&&(c.transformedAabb=fr.applyTransformFast(c.aabb,this.node.matrix),s.encapsulate(c.transformedAabb)),n++;this.aabb=s}return this.aabb}}class ib{constructor(n,s,c,g,f,_,T){this.id=c,this.layers=n,this.layerIds=this.layers.map(A=>A.fqid),this.stateDependentLayerIds=this.layers.filter(A=>A.isStateDependent()).map(A=>A.id),this.modelTraits|=Kp.CoordinateSpaceTile,this.uploaded=!1,this.hasPattern=!1,g&&(this.modelTraits|=Kp.HasMapboxMeshFeatures),f&&(this.modelTraits|=Kp.HasMeshoptCompression),this.zoom=-1,this.terrainExaggeration=1,this.projection={name:"mercator"},this.replacementUpdateTime=0,this.elevationReadFromZ=255,this.brightness=_,this.dirty=!0,this.needsUpload=!1,this.nodesInfo=[];for(const A of s)this.nodesInfo.push(new ZA(A)),qA(A,T.featureIndexArray.length,T.grid),T.featureIndexArray.emplaceBack(this.nodesInfo.length-1,0,T.bucketLayerIDs.length-1,0);this.states={}}updateFootprints(n,s){for(const c of this.getNodesInfo()){const g=c.node;g.footprint&&s.push({footprint:g.footprint,id:n})}}update(n){const s=Object.keys(n).length!==0;if(s&&!this.stateDependentLayers.length)return;const c=s?this.stateDependentLayers:this.layers;if(!Jt(n,this.states))for(const g of c)this.evaluate(g,n);this.states=structuredClone(n)}populate(){console.log("populate 3D model bucket")}uploadPending(){return!this.uploaded||this.needsUpload}upload(n){if(!this.needsUpload)return;const s=this.getNodesInfo();for(const c of s){const g=c.node;this.uploaded?this.updatePbrBuffer(g):c2(g,n,!0)}for(const c of s)rb(c.node);this.uploaded=!0,this.needsUpload=!1}updatePbrBuffer(n){let s=!1;if(!n.meshes)return s;for(const c of n.meshes)c.pbrBuffer&&(c.pbrBuffer.updateData(c.featureArray),s=!0);return s}needsReEvaluation(n,s,c){const g=n.transform.projectionOptions,f=n.style.getBrightness(),_=this.brightness!==f;if(!this.uploaded||this.dirty||g.name!==this.projection.name||D_(c.paint.get("model-color").value,_)||D_(c.paint.get("model-color-mix-intensity").value,_)||D_(c.paint.get("model-roughness").value,_)||D_(c.paint.get("model-emissive-strength").value,_)||D_(c.paint.get("model-height-based-emissive-strength-multiplier").value,_)){this.projection=g,this.brightness=f;const T=this.getNodesInfo();for(const A of T)A.state=null;return!0}return!1}evaluateScale(n,s){if(n.transform.zoom===this.zoom)return;this.zoom=n.transform.zoom;const c=this.getNodesInfo(),g=this.id.canonical;for(const f of c){const _=f.feature;f.evaluatedScale=s.paint.get("model-scale").evaluate(_,{},g)}}evaluate(n,s){const c=this.getNodesInfo();for(const g of c){if(!g.node.meshes)continue;const f=g.feature,_=s&&s[f.id];if(Jt(_,g.state))continue;g.state=structuredClone(_);const T=g.node.meshes&&g.node.meshes[0].featureData,A=g.evaluatedColor[2],D=g.evaluatedRMEA[2],w=this.id.canonical;if(g.hasTranslucentParts=!1,T){for(let k=0;k<KA.length;k++){const O=KA[k];O.length&&(f.properties.part=O);const I=n.paint.get("model-color").evaluate(f,_,w).toRenderColor(null),R=n.paint.get("model-color-mix-intensity").evaluate(f,_,w);g.evaluatedColor[k]=[I.r,I.g,I.b,R],g.evaluatedRMEA[k][0]=n.paint.get("model-roughness").evaluate(f,_,w),g.evaluatedRMEA[k][2]=n.paint.get("model-emissive-strength").evaluate(f,_,w),g.evaluatedRMEA[k][3]=I.a,g.emissionHeightBasedParams[k]=n.paint.get("model-height-based-emissive-strength-multiplier").evaluate(f,_,w),!g.hasTranslucentParts&&I.a<1&&(g.hasTranslucentParts=!0)}delete f.properties.part,kV(g,A!==g.evaluatedColor[2]||D!==g.evaluatedRMEA[2],this.modelTraits)}else g.evaluatedRMEA[0][2]=n.paint.get("model-emissive-strength").evaluate(f,_,w);g.evaluatedScale=n.paint.get("model-scale").evaluate(f,_,w),this.updatePbrBuffer(g.node)||(this.needsUpload=!0)}this.dirty=!1}elevationUpdate(n,s,c,g){const f=n.findDEMTileFor(c);if(f&&(f.tileID.canonical!==this.terrainTile||s!==this.terrainExaggeration)){if(f.dem&&f.tileID.overscaledZ!==this.elevationReadFromZ){this.elevationReadFromZ=f.tileID.overscaledZ;const _=Zp.create(n,c,f);if(!_)return;this.modelTraits&Kp.HasMapboxMeshFeatures&&this.updateDEM(n,_,c,g);for(const T of this.getNodesInfo()){const A=T.node;if(!A.footprint||!A.footprint.vertices||!A.footprint.vertices.length)continue;const D=A.footprint.vertices;let w=_.getElevationAt(D[0].x,D[0].y,!0,!0);for(let k=1;k<D.length;k++)w=Math.min(w,_.getElevationAt(D[k].x,D[k].y,!0,!0));A.elevation=w}}this.terrainTile=f.tileID.canonical,this.terrainExaggeration=s}}updateDEM(n,s,c,g){let f=s._dem._modifiedForSources[g];if(f===void 0&&(s._dem._modifiedForSources[g]=[],f=s._dem._modifiedForSources[g]),f.includes(c.canonical))return;const _=s._dem.dim;f.push(c.canonical);let T=!1;for(const A of this.getNodesInfo()){const D=A.node;if(!D.footprint||!D.footprint.grid)continue;const w=D.footprint.grid,k=s.tileCoordToPixel(w.min.x,w.min.y),O=s.tileCoordToPixel(w.max.x,w.max.y),I=Math.min(Math.min(_-O.y,k.x),Math.min(k.y,_-O.x));if(I<0)continue;const R=Et(I,2,5);let B=Math.max(0,k.x-R),W=Math.max(0,k.y-R),K=Math.min(O.x+R,_-1),ie=Math.min(O.y+R,_-1);for(let ge=W;ge<=ie;++ge)for(let Se=B;Se<=K;++Se)Kf[ge*_+Se]=255;let oe=0,Q=0;for(let ge=0;ge<w.cellsY;++ge)for(let Se=0;Se<w.cellsX;++Se){if(!w.cells[ge*w.cellsX+Se])continue;const Fe=s.tileCoordToPixel(w.min.x+Se/w.xScale,w.min.y+ge/w.yScale),ze=s.tileCoordToPixel(w.min.x+(Se+1)/w.xScale,w.min.y+(ge+1)/w.yScale);for(let Le=Fe.y;Le<=Math.min(ze.y+1,_-1);++Le)for(let nt=Fe.x;nt<=Math.min(ze.x+1,_-1);++nt)Kf[Le*_+nt]===255&&(Kf[Le*_+nt]=0,oe+=s.getElevationAtPixel(nt,Le),Q++)}const ue=oe/Q;B=Math.max(1,k.x-R),W=Math.max(1,k.y-R),K=Math.min(O.x+R,_-2),ie=Math.min(O.y+R,_-2),T=!0;for(let ge=W;ge<=ie;++ge)for(let Se=B;Se<=K;++Se)Kf[ge*_+Se]===0&&(f2[ge*_+Se]=s._dem.set(Se,ge,ue));for(let ge=1;ge<R;++ge){B=Math.max(1,k.x-ge),W=Math.max(1,k.y-ge),K=Math.min(O.x+ge,_-2),ie=Math.min(O.y+ge,_-2);for(let Se=W;Se<=ie;++Se)for(let Fe=B;Fe<=K;++Fe){const ze=Se*_+Fe;if(Kf[ze]===255){let Le=0,nt=0,$e=-1,it=-1;for(let dt=-1;dt<=1;++dt)for(let ct=-1;ct<=1;++ct){const mt=(Se+dt)*_+Fe+ct;if(Kf[mt]>=ge)continue;const wt=f2[mt],Mt=Math.abs(wt);Mt>nt&&(Le=wt,nt=Mt,$e=ct,it=dt)}if(nt>.1){const dt=1-(ge+.5*Math.abs($e*it))/R;let ct=s._dem.get(Fe,Se)+Le*dt;const mt=s._dem.get(Fe+$e,Se+it),wt=s._dem.get(Fe-$e,Se-it,!0);(ct-mt)*(ct-wt)>0&&(ct=(mt+wt)/2),f2[ze]=s._dem.set(Fe,Se,ct),Kf[ze]=ge}}}}}T&&(s._demTile.needsDEMTextureUpload=!0,s._dem._timestamp=bn.now())}getNodesInfo(){return this.nodesInfo}destroy(){const n=this.getNodesInfo();for(const s of n)rb(s.node),d2(s.node)}isEmpty(){return!this.nodesInfo.length}updateReplacement(n,s){if(s.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=s.updateTime;const c=s.getReplacementRegionsForTile(n.toUnwrapped()),g=this.getNodesInfo();for(let f=0;f<this.nodesInfo.length;f++){const _=g[f].node;g[f].hiddenByReplacement=!!_.footprint&&!c.find(T=>T.footprint===_.footprint)}}getHeightAtTileCoord(n,s){const c=this.getNodesInfo(),g=[],f=[0,0,0],_=Ne.mat4.identity([]);for(let T=0;T<this.nodesInfo.length;T++){const A=c[T],D=A.node.meshes[0],w=D.transformedAabb;if(n<w.min[0]||s<w.min[1]||n>w.max[0]||s>w.max[1])continue;if(A.node.hidden===!0)return{height:1/0,maxHeight:A.feature.properties.height,hidden:!1,verticalScale:A.evaluatedScale[2]};Ne.mat4.invert(_,A.node.matrix),f[0]=n,f[1]=s,Ne.vec3.transformMat4(f,f,_);const k=(f[0]-D.aabb.min[0])/(D.aabb.max[0]-D.aabb.min[0])*qf|0,O=Math.min(63,(f[1]-D.aabb.min[1])/(D.aabb.max[1]-D.aabb.min[1])*qf|0)*qf+Math.min(63,k),I=D.heightmap[O];if(!(I<0&&A.node.footprint))return A.hiddenByReplacement?void 0:{height:I,maxHeight:A.feature.properties.height,hidden:!1,verticalScale:A.evaluatedScale[2]};if(A.node.footprint.grid.query(new Je(n,s),new Je(n,s),g),g.length>0)return{height:void 0,maxHeight:A.feature.properties.height,hidden:A.hiddenByReplacement,verticalScale:A.evaluatedScale[2]}}}}function D_(u,n){return!u.isLightConstant&&n}function AV(u,n,s,c,g,f,_,T){let A=(61440&n|(61440&n)>>4)>>8,D=(3840&n|(3840&n)>>4)>>4,w=240&n|(240&n)>>4;s[3]>0&&(A=pr(A,255*s[0],s[3]),D=pr(D,255*s[1],s[3]),w=pr(w,255*s[2],s[3]));const k=A<<8|D,O=w<<8|Math.floor(255*c[3]),I=function(ge){const Se=Et(ge,0,2);return Math.min(Math.round(.5*Se*255),255)}(c[2])<<8|15*c[0]<<4|15*c[1],R=Et(g[0],0,1),B=Et(g[1],0,1),W=Et(g[2],0,1),K=Et(g[3],0,1);let ie,oe,Q,ue;if(R!==B&&_!==f&&B!==R){const ge=_-f;oe=1/(ge*(B-R)),Q=-(f+ge*R)/(ge*(B-R));const Se=Et(g[4],-1,1);ue=Math.pow(10,Se),ie=255*W<<8|255*K}else ie=65535,oe=0,Q=1,ue=1;if(u.emplaceBack(k,O,I,ie,oe,Q,ue),T){const ge=T.length;T.clear();for(let Se=0;Se<ge;Se++)T.emplaceBack(k,O,I,ie,oe,Q,ue)}}function kV(u,n,s){const c=u.node;let g=0;const f=s&Kp.HasMeshoptCompression;for(const _ of c.meshes){if(c.lights&&c.lightMeshIndex===g||!_.featureData)continue;_.featureArray=new kp,_.featureArray.reserve(_.featureData.length);let T=n;for(const A of _.featureData){const D=f?65535&A:A>>16&65535,w=f?A>>16&65535:65535&A,k=(15&w)<8?15&w:0,O=u.evaluatedRMEA[k],I=u.evaluatedColor[k],R=u.emissionHeightBasedParams[k];let B;if(T&&k===2&&c.lights&&(B=new kp,B.resize(10*c.lights.length)),AV(_.featureArray,D,I,O,R,_.aabb.min[2],_.aabb.max[2],B),B&&T){T=!1;const W=c.meshes[c.lightMeshIndex];W.featureArray=B,W.featureArray._trim()}}_.featureArray._trim(),g++}}function YA(u,n,s,c){const g=1<<u.z;n.lat=Fo((c/kn+u.y)/g),n.lng=ks((s/kn+u.x)/g)}Gn(ib,"Tiled3dModelBucket",{omit:["layers"]}),Gn(ZA,"Tiled3dModelFeature");const PV={circle:class extends fs{constructor(u,n,s,c){super(u,{layout:ln||(ln=new Zi({"circle-sort-key":new Fn(Ot.layout_circle["circle-sort-key"]),visibility:new _n(Ot.layout_circle.visibility)})),paint:Ht||(Ht=new Zi({"circle-radius":new Fn(Ot.paint_circle["circle-radius"]),"circle-color":new Fn(Ot.paint_circle["circle-color"]),"circle-blur":new Fn(Ot.paint_circle["circle-blur"]),"circle-opacity":new Fn(Ot.paint_circle["circle-opacity"]),"circle-translate":new _n(Ot.paint_circle["circle-translate"]),"circle-translate-anchor":new _n(Ot.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new _n(Ot.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new _n(Ot.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Fn(Ot.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Fn(Ot.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Fn(Ot.paint_circle["circle-stroke-opacity"]),"circle-emissive-strength":new _n(Ot.paint_circle["circle-emissive-strength"]),"circle-color-use-theme":new Fn({type:"string",default:"default","property-type":"data-driven"}),"circle-stroke-color-use-theme":new Fn({type:"string",default:"default","property-type":"data-driven"})}))},n,s,c)}createBucket(u){return new Te(u)}queryRadius(u){const n=u;return en("circle-radius",this,n)+en("circle-stroke-width",this,n)+hn(this.paint.get("circle-translate"))}queryIntersectsFeature(u,n,s,c,g,f,_,T){const A=It(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),f.angle,u.pixelToTileUnitsFactor),D=this.paint.get("circle-radius").evaluate(n,s)+this.paint.get("circle-stroke-width").evaluate(n,s);return MM(u,c,f,_,T,this.paint.get("circle-pitch-alignment")==="map",this.paint.get("circle-pitch-scale")==="map",A,D)}getProgramIds(){return["circle"]}getDefaultProgramParams(u,n,s){const c=Vp(this);return{config:new cc(this,{zoom:n,lut:s}),defines:c,overrideFog:!1}}},heatmap:class extends fs{createBucket(u){return new AM(u)}constructor(u,n,s,c){super(u,{layout:kM||(kM=new Zi({visibility:new _n(Ot.layout_heatmap.visibility)})),paint:PM||(PM=new Zi({"heatmap-radius":new Fn(Ot.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Fn(Ot.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new _n(Ot.paint_heatmap["heatmap-intensity"]),"heatmap-color":new ad(Ot.paint_heatmap["heatmap-color"]),"heatmap-opacity":new _n(Ot.paint_heatmap["heatmap-opacity"]),"heatmap-color-use-theme":new Fn({type:"string",default:"default","property-type":"data-driven"})}))},n,s,c),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(u){u==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=m_({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(u){return en("heatmap-radius",this,u)}queryIntersectsFeature(u,n,s,c,g,f,_,T){const A=this.paint.get("heatmap-radius").evaluate(n,s);return MM(u,c,f,_,T,!0,!0,new Je(0,0),A)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}getProgramIds(){return["heatmap","heatmapTexture"]}getDefaultProgramParams(u,n,s){return u==="heatmap"?{config:new cc(this,{zoom:n,lut:s}),overrideFog:!1}:{}}},hillshade:class extends fs{constructor(u,n,s,c){super(u,{layout:RM||(RM=new Zi({visibility:new _n(Ot.layout_hillshade.visibility)})),paint:OM||(OM=new Zi({"hillshade-illumination-direction":new _n(Ot.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new _n(Ot.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new _n(Ot.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new _n(Ot.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new _n(Ot.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new _n(Ot.paint_hillshade["hillshade-accent-color"]),"hillshade-emissive-strength":new _n(Ot.paint_hillshade["hillshade-emissive-strength"]),"hillshade-shadow-color-use-theme":new Fn({type:"string",default:"default","property-type":"data-driven"}),"hillshade-highlight-color-use-theme":new Fn({type:"string",default:"default","property-type":"data-driven"}),"hillshade-accent-color-use-theme":new Fn({type:"string",default:"default","property-type":"data-driven"})}))},n,s,c)}shouldRedrape(){return this.hasOffscreenPass()&&this.paint.get("hillshade-illumination-anchor")==="viewport"}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}getProgramIds(){return["hillshade","hillshadePrepare"]}getDefaultProgramParams(u,n,s){return{overrideFog:!1}}},fill:class extends fs{constructor(u,n,s,c){super(u,{layout:UM||(UM=new Zi({"fill-sort-key":new Fn(Ot.layout_fill["fill-sort-key"]),visibility:new _n(Ot.layout_fill.visibility),"fill-elevation-reference":new _n(Ot.layout_fill["fill-elevation-reference"])})),paint:jM||(jM=new Zi({"fill-antialias":new _n(Ot.paint_fill["fill-antialias"]),"fill-opacity":new Fn(Ot.paint_fill["fill-opacity"]),"fill-color":new Fn(Ot.paint_fill["fill-color"]),"fill-outline-color":new Fn(Ot.paint_fill["fill-outline-color"]),"fill-translate":new _n(Ot.paint_fill["fill-translate"]),"fill-translate-anchor":new _n(Ot.paint_fill["fill-translate-anchor"]),"fill-pattern":new Fn(Ot.paint_fill["fill-pattern"]),"fill-emissive-strength":new _n(Ot.paint_fill["fill-emissive-strength"]),"fill-z-offset":new Fn(Ot.paint_fill["fill-z-offset"]),"fill-color-use-theme":new Fn({type:"string",default:"default","property-type":"data-driven"}),"fill-outline-color-use-theme":new Fn({type:"string",default:"default","property-type":"data-driven"})}))},n,s,c)}getProgramIds(){const u=this.paint.get("fill-pattern"),n=u&&u.constantOr(1),s=[n?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&s.push(n&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),s}getDefaultProgramParams(u,n,s){return{config:new cc(this,{zoom:n,lut:s}),overrideFog:!1}}recalculate(u,n){super.recalculate(u,n);const s=this.paint._values["fill-outline-color"];s.value.kind==="constant"&&s.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(u){return new Iw(u)}queryRadius(){return hn(this.paint.get("fill-translate"))}queryIntersectsFeature(u,n,s,c,g,f){return!u.queryGeometry.isAboveHorizon&&je(vn(u.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),f.angle,u.pixelToTileUnitsFactor),c)}isTileClipped(){return!0}is3D(){return this.paint.get("fill-z-offset").constantOr(1)!==0}},"fill-extrusion":class extends fs{constructor(u,n,s,c){super(u,{layout:TI||(TI=new Zi({visibility:new _n(Ot["layout_fill-extrusion"].visibility),"fill-extrusion-edge-radius":new _n(Ot["layout_fill-extrusion"]["fill-extrusion-edge-radius"])})),paint:CI||(CI=new Zi({"fill-extrusion-opacity":new _n(Ot["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Fn(Ot["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new _n(Ot["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new _n(Ot["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Fn(Ot["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Fn(Ot["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Fn(Ot["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-height-alignment":new _n(Ot["paint_fill-extrusion"]["fill-extrusion-height-alignment"]),"fill-extrusion-base-alignment":new _n(Ot["paint_fill-extrusion"]["fill-extrusion-base-alignment"]),"fill-extrusion-vertical-gradient":new _n(Ot["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new _n(Ot["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new _n(Ot["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"]),"fill-extrusion-ambient-occlusion-wall-radius":new _n(Ot["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-wall-radius"]),"fill-extrusion-ambient-occlusion-ground-radius":new _n(Ot["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-radius"]),"fill-extrusion-ambient-occlusion-ground-attenuation":new _n(Ot["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-attenuation"]),"fill-extrusion-flood-light-color":new _n(Ot["paint_fill-extrusion"]["fill-extrusion-flood-light-color"]),"fill-extrusion-flood-light-intensity":new _n(Ot["paint_fill-extrusion"]["fill-extrusion-flood-light-intensity"]),"fill-extrusion-flood-light-wall-radius":new Fn(Ot["paint_fill-extrusion"]["fill-extrusion-flood-light-wall-radius"]),"fill-extrusion-flood-light-ground-radius":new Fn(Ot["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-radius"]),"fill-extrusion-flood-light-ground-attenuation":new _n(Ot["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-attenuation"]),"fill-extrusion-vertical-scale":new _n(Ot["paint_fill-extrusion"]["fill-extrusion-vertical-scale"]),"fill-extrusion-rounded-roof":new _n(Ot["paint_fill-extrusion"]["fill-extrusion-rounded-roof"]),"fill-extrusion-cutoff-fade-range":new _n(Ot["paint_fill-extrusion"]["fill-extrusion-cutoff-fade-range"]),"fill-extrusion-emissive-strength":new Fn(Ot["paint_fill-extrusion"]["fill-extrusion-emissive-strength"]),"fill-extrusion-line-width":new Fn(Ot["paint_fill-extrusion"]["fill-extrusion-line-width"]),"fill-extrusion-cast-shadows":new _n(Ot["paint_fill-extrusion"]["fill-extrusion-cast-shadows"]),"fill-extrusion-color-use-theme":new Fn({type:"string",default:"default","property-type":"data-driven"}),"fill-extrusion-flood-light-color-use-theme":new Fn({type:"string",default:"default","property-type":"data-driven"})}))},n,s,c),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(u){return new O0(u)}queryRadius(){return hn(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}hasShadowPass(){return this.paint.get("fill-extrusion-cast-shadows")}cutoffRange(){return this.paint.get("fill-extrusion-cutoff-fade-range")}canCastShadows(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}queryIntersectsFeature(u,n,s,c,g,f,_,T,A){const D=It(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),f.angle,u.pixelToTileUnitsFactor),w=this.paint.get("fill-extrusion-height").evaluate(n,s),k=this.paint.get("fill-extrusion-base").evaluate(n,s),O=[0,0],I=T&&f.elevation,R=f.elevation?f.elevation.exaggeration():1,B=u.tile.getBucket(this);if(I&&B instanceof O0){const Q=B.centroidVertexArray,ue=A+1;ue<Q.length&&(O[0]=Q.geta_centroid_pos0(ue),O[1]=Q.geta_centroid_pos1(ue))}if(O[0]===0&&O[1]===1)return!1;f.projection.name==="globe"&&(c=SI([c],[new Je(0,0),new Je(kn,kn)],u.tileID.canonical).map(Q=>Q.polygon).flat());const W=I?T:null,[K,ie]=function(Q,ue,ge,Se,Fe,ze,Le,nt,$e,it,dt){return Q.projection.name==="globe"?function(ct,mt,wt,Mt,vt,qt,mn,Zt,Tn,Sn,On){const nn=[],Yn=[],In=ct.projection.upVectorScale(On,ct.center.lat,ct.worldSize).metersToTile,qn=[0,0,0,1],ar=[0,0,0,1],Mr=(Br,Rr,Ur,Ei)=>{Br[0]=Rr,Br[1]=Ur,Br[2]=Ei,Br[3]=1},Pr=wI();wt>0&&(wt+=Pr),Mt+=Pr;for(const Br of mt){const Rr=[],Ur=[];for(const Ei of Br){const gi=Ei.x+vt.x,Sr=Ei.y+vt.y,_i=ct.projection.projectTilePoint(gi,Sr,On),fi=ct.projection.upVector(On,Ei.x,Ei.y);let Mi=wt,wo=Mt;if(mn){const So=MI(gi,Sr,wt,Mt,mn,Zt,Tn,Sn);Mi+=So.base,wo+=So.top}wt!==0?Mr(qn,_i.x+fi[0]*In*Mi,_i.y+fi[1]*In*Mi,_i.z+fi[2]*In*Mi):Mr(qn,_i.x,_i.y,_i.z),Mr(ar,_i.x+fi[0]*In*wo,_i.y+fi[1]*In*wo,_i.z+fi[2]*In*wo),Ne.vec3.transformMat4(qn,qn,qt),Ne.vec3.transformMat4(ar,ar,qt),Rr.push(new Gf(qn[0],qn[1],qn[2])),Ur.push(new Gf(ar[0],ar[1],ar[2]))}nn.push(Rr),Yn.push(Ur)}return[nn,Yn]}(Q,ue,ge,Se,Fe,ze,Le,nt,$e,it,dt):Le?function(ct,mt,wt,Mt,vt,qt,mn,Zt,Tn){const Sn=[],On=[],nn=[0,0,0,1];for(const Yn of ct){const In=[],qn=[];for(const ar of Yn){const Mr=ar.x+Mt.x,Pr=ar.y+Mt.y,Br=MI(Mr,Pr,mt,wt,qt,mn,Zt,Tn);nn[0]=Mr,nn[1]=Pr,nn[2]=Br.base,nn[3]=1,Ne.vec4.transformMat4(nn,nn,vt),nn[3]=Math.max(nn[3],1e-5);const Rr=new Gf(nn[0]/nn[3],nn[1]/nn[3],nn[2]/nn[3]);nn[0]=Mr,nn[1]=Pr,nn[2]=Br.top,nn[3]=1,Ne.vec4.transformMat4(nn,nn,vt),nn[3]=Math.max(nn[3],1e-5);const Ur=new Gf(nn[0]/nn[3],nn[1]/nn[3],nn[2]/nn[3]);In.push(Rr),qn.push(Ur)}Sn.push(In),On.push(qn)}return[Sn,On]}(ue,ge,Se,Fe,ze,Le,nt,$e,it):function(ct,mt,wt,Mt,vt){const qt=[],mn=[],Zt=vt[8]*mt,Tn=vt[9]*mt,Sn=vt[10]*mt,On=vt[11]*mt,nn=vt[8]*wt,Yn=vt[9]*wt,In=vt[10]*wt,qn=vt[11]*wt;for(const ar of ct){const Mr=[],Pr=[];for(const Br of ar){const Rr=Br.x+Mt.x,Ur=Br.y+Mt.y,Ei=vt[0]*Rr+vt[4]*Ur+vt[12],gi=vt[1]*Rr+vt[5]*Ur+vt[13],Sr=vt[2]*Rr+vt[6]*Ur+vt[14],_i=vt[3]*Rr+vt[7]*Ur+vt[15],fi=Ei+Zt,Mi=gi+Tn,wo=Sr+Sn,So=Math.max(_i+On,1e-5),so=Ei+nn,Os=gi+Yn,Wi=Sr+In,qi=Math.max(_i+qn,1e-5);Mr.push(new Gf(fi/So,Mi/So,wo/So)),Pr.push(new Gf(so/qi,Os/qi,Wi/qi))}qt.push(Mr),mn.push(Pr)}return[qt,mn]}(ue,ge,Se,Fe,ze)}(f,c,k,w,D,_,W,O,R,f.center.lat,u.tileID.canonical),oe=u.queryGeometry;return function(Q,ue,ge){let Se=1/0;je(ge,ue)&&(Se=EI(ge,ue[0]));for(let Fe=0;Fe<ue.length;Fe++){const ze=ue[Fe],Le=Q[Fe];for(let nt=0;nt<ze.length-1;nt++){const $e=ze[nt],it=[$e,ze[nt+1],Le[nt+1],Le[nt],$e];Ce(ge,it)&&(Se=Math.min(Se,EI(ge,it)))}}return Se!==1/0&&Se}(K,ie,oe.isPointQuery()?oe.screenBounds:oe.screenGeometry)}},line:class extends fs{constructor(u,n,s,c){const g=FI();super(u,g,n,s,c),g.layout&&(this.layout=new sd(g.layout)),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(u){if(u==="line-gradient"){const n=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=n._styleExpression&&n._styleExpression.expression instanceof Sf,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}widthExpression(){return this._transitionablePaint._values["line-width"].value.expression}recalculate(u,n){super.recalculate(u,n),this.paint._values["line-floorwidth"]=(()=>{if(T_)return T_;const s=FI();return T_=new O5(s.paint.properties["line-width"].specification),T_.useIntegerZoom=!0,T_})().possiblyEvaluate(this._transitioningPaint._values["line-width"].value,u)}createBucket(u){return new Nw(u)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getDefaultProgramParams(u,n,s){const c=DI(this);return{config:new cc(this,{zoom:n,lut:s}),defines:c,overrideFog:!1}}queryRadius(u){const n=u,s=NI(en("line-width",this,n),en("line-gap-width",this,n)),c=en("line-offset",this,n);return s/2+Math.abs(c)+hn(this.paint.get("line-translate"))}queryIntersectsFeature(u,n,s,c,g,f){if(u.queryGeometry.isAboveHorizon)return!1;const _=vn(u.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),f.angle,u.pixelToTileUnitsFactor),T=u.pixelToTileUnitsFactor/2*NI(this.paint.get("line-width").evaluate(n,s),this.paint.get("line-gap-width").evaluate(n,s)),A=this.paint.get("line-offset").evaluate(n,s);return A&&(c=function(D,w){const k=[],O=new Je(0,0);for(let I=0;I<D.length;I++){const R=D[I],B=[];for(let W=0;W<R.length;W++){const K=R[W],ie=R[W+1],oe=W===0?O:K.sub(R[W-1])._unit()._perp(),Q=W===R.length-1?O:ie.sub(K)._unit()._perp(),ue=oe._add(Q)._unit();ue._mult(1/(ue.x*Q.x+ue.y*Q.y)),B.push(ue._mult(w)._add(K))}k.push(B)}return k}(c,A*u.pixelToTileUnitsFactor)),function(D,w,k){for(let O=0;O<w.length;O++){const I=w[O];if(D.length>=3){for(let R=0;R<I.length;R++)if(pt(D,I[R]))return!0}if(Be(D,I,k))return!0}return!1}(_,c,T)}isTileClipped(){return!0}isDraped(u){const n=this.layout.get("line-z-offset"),s=n.isConstant()&&!n.constantOr(0),c=this.layout.get("line-elevation-reference");return!(c==="sea"||c==="ground")&&(s||c!=="none")}},symbol:Y0,background:class extends fs{constructor(u,n,s,c){super(u,{layout:xA||(xA=new Zi({visibility:new _n(Ot.layout_background.visibility)})),paint:wA||(wA=new Zi({"background-pitch-alignment":new _n(Ot.paint_background["background-pitch-alignment"]),"background-color":new _n(Ot.paint_background["background-color"]),"background-pattern":new _n(Ot.paint_background["background-pattern"]),"background-opacity":new _n(Ot.paint_background["background-opacity"]),"background-emissive-strength":new _n(Ot.paint_background["background-emissive-strength"]),"background-color-use-theme":new Fn({type:"string",default:"default","property-type":"data-driven"})}))},n,s,c)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}getDefaultProgramParams(u,n,s){return{overrideFog:!1}}is3D(){return this.paint.get("background-pitch-alignment")==="viewport"}},raster:MA,"raster-particle":OA,sky:class extends fs{constructor(u,n,s,c){super(u,{layout:kA||(kA=new Zi({visibility:new _n(Ot.layout_sky.visibility)})),paint:PA||(PA=new Zi({"sky-type":new _n(Ot.paint_sky["sky-type"]),"sky-atmosphere-sun":new _n(Ot.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new _n(Ot.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new _n(Ot.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new _n(Ot.paint_sky["sky-gradient-radius"]),"sky-gradient":new ad(Ot.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new _n(Ot.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new _n(Ot.paint_sky["sky-atmosphere-color"]),"sky-opacity":new _n(Ot.paint_sky["sky-opacity"]),"sky-gradient-use-theme":new Fn({type:"string",default:"default","property-type":"data-driven"}),"sky-atmosphere-halo-color-use-theme":new Fn({type:"string",default:"default","property-type":"data-driven"}),"sky-atmosphere-color-use-theme":new Fn({type:"string",default:"default","property-type":"data-driven"})}))},n,s,c),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(u){u==="sky-gradient"?this._updateColorRamp():u!=="sky-atmosphere-sun"&&u!=="sky-atmosphere-halo-color"&&u!=="sky-atmosphere-color"&&u!=="sky-atmosphere-sun-intensity"||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=m_({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(u){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const n=u.style.light.properties.get("position");return this._lightPosition.azimuthal!==n.azimuthal||this._lightPosition.polar!==n.polar}return!1}getCenter(u,n){if(this.paint.get("sky-type")==="atmosphere"){const c=this.paint.get("sky-atmosphere-sun"),g=!c,f=u.style.light,_=f.properties.get("position");return g&&f.properties.get("anchor")==="viewport"&&xn("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),g?s2(_.azimuthal,90-_.polar,n):s2(c[0],90-c[1],n)}const s=this.paint.get("sky-gradient-center");return s2(s[0],90-s[1],n)}isSky(){return!0}markSkyboxValid(u){this._skyboxInvalidated=!1,this._lightPosition=u.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const u=this.paint.get("sky-type");return u==="atmosphere"?["skyboxCapture","skybox"]:u==="gradient"?["skyboxGradient"]:null}},slot:class extends fs{constructor(u,n,s,c){super(u,{paint:RA||(RA=new Zi({}))},n,null)}},model:class extends fs{constructor(u,n,s,c){super(u,{layout:jA||(jA=new Zi({visibility:new _n(Ot.layout_model.visibility),"model-id":new Fn(Ot.layout_model["model-id"])})),paint:HA||(HA=new Zi({"model-opacity":new Fn(Ot.paint_model["model-opacity"]),"model-rotation":new Fn(Ot.paint_model["model-rotation"]),"model-scale":new Fn(Ot.paint_model["model-scale"]),"model-translation":new Fn(Ot.paint_model["model-translation"]),"model-color":new Fn(Ot.paint_model["model-color"]),"model-color-mix-intensity":new Fn(Ot.paint_model["model-color-mix-intensity"]),"model-type":new _n(Ot.paint_model["model-type"]),"model-cast-shadows":new _n(Ot.paint_model["model-cast-shadows"]),"model-receive-shadows":new _n(Ot.paint_model["model-receive-shadows"]),"model-ambient-occlusion-intensity":new _n(Ot.paint_model["model-ambient-occlusion-intensity"]),"model-emissive-strength":new Fn(Ot.paint_model["model-emissive-strength"]),"model-roughness":new Fn(Ot.paint_model["model-roughness"]),"model-height-based-emissive-strength-multiplier":new Fn(Ot.paint_model["model-height-based-emissive-strength-multiplier"]),"model-cutoff-fade-range":new _n(Ot.paint_model["model-cutoff-fade-range"]),"model-front-cutoff":new _n(Ot.paint_model["model-front-cutoff"]),"model-color-use-theme":new Fn({type:"string",default:"default","property-type":"data-driven"})}))},n,s,c),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(u){return new u2(u)}getProgramIds(){return["model"]}is3D(){return!0}hasShadowPass(){return!0}canCastShadows(){return!0}hasLightBeamPass(){return!0}cutoffRange(){return this.paint.get("model-cutoff-fade-range")}queryRadius(u){return u instanceof ib?kn-1:0}queryIntersectsFeature(u,n,s,c,g,f){if(!this.modelManager)return!1;const _=this.modelManager,T=u.tile.getBucket(this);if(!(T&&T instanceof u2))return!1;for(const A in T.instancesPerModel){const D=T.instancesPerModel[A],w=n.id!==void 0?n.id:n.properties&&n.properties.hasOwnProperty("id")?n.properties.id:void 0;if(D.idToFeaturesIndex.hasOwnProperty(w)){const k=D.features[D.idToFeaturesIndex[w]],O=_.getModel(A,this.scope);if(!O)return!1;let I=Ne.mat4.create();const R=new Qr(0,0),B=T.canonical;let W=Number.MAX_VALUE;for(let K=0;K<k.instancedDataCount;++K){const ie=16*(k.instancedDataOffset+K),oe=D.instancedDataArray.float32,Q=[oe[ie+4],oe[ie+5],oe[ie+6]];YA(B,R,oe[ie],0|oe[ie+1]),GA(I,O,f,R,k.rotation,k.scale,Q,!1,!1,!1),f.projection.name==="globe"&&(I=l2(I,f));const ue=Ne.mat4.multiply([],f.projMatrix,I),ge=u.queryGeometry,Se=NA(ge.isPointQuery()?ge.screenBounds:ge.screenGeometry,f,ue,O.aabb);Se!=null&&(W=Math.min(Se,W))}return W!==Number.MAX_VALUE&&W}}return!1}_handleOverridablePaintPropertyUpdate(u,n,s){return!(!this.layout||n.isDataDriven()||s.isDataDriven()||u!=="model-color"&&u!=="model-color-mix-intensity"&&u!=="model-rotation"&&u!=="model-scale"&&u!=="model-translation"&&u!=="model-emissive-strength")}_isPropertyZoomDependent(u){const n=this._transitionablePaint._values[u];return n!=null&&n.value!=null&&n.value.expression!=null&&n.value.expression instanceof nd}isZoomDependent(){return this._isPropertyZoomDependent("model-scale")||this._isPropertyZoomDependent("model-rotation")||this._isPropertyZoomDependent("model-translation")}},clip:class extends fs{constructor(u,n,s,c){super(u,{layout:HM||(HM=new Zi({"clip-layer-types":new _n(Ot.layout_clip["clip-layer-types"]),"clip-layer-scope":new _n(Ot.layout_clip["clip-layer-scope"])})),paint:GM||(GM=new Zi({}))},n,s,c)}recalculate(u,n){super.recalculate(u,n)}createBucket(u){return new WM(u)}isTileClipped(){return!0}is3D(){return!0}}};class RV{constructor(n){this._callback=n,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){this._channel=void 0,this._callback=()=>{}}}class OV{constructor(){this.tasks={},this.taskQueue=[],ui(["process"],this),this.invoker=new RV(this.process),this.nextId=0}add(n,s){const c=this.nextId++,g=function({type:f,isSymbolTile:_,zoom:T}){return T=T||0,f==="message"?0:f!=="maybePrepare"||_?f!=="parseTile"||_?f==="parseTile"&&_?300-T:f==="maybePrepare"&&_?400-T:500:200-T:100-T}(s);if(g===0){try{n()}finally{}return null}return this.tasks[c]={fn:n,metadata:s,priority:g,id:c},this.taskQueue.push(c),this.invoker.trigger(),{cancel:()=>{delete this.tasks[c]}}}process(){try{if(this.taskQueue=this.taskQueue.filter(c=>!!this.tasks[c]),!this.taskQueue.length)return;const n=this.pick();if(n===null)return;const s=this.tasks[n];if(delete this.tasks[n],this.taskQueue.length&&this.invoker.trigger(),!s)return;s.fn()}finally{}}pick(){let n=null,s=1/0;for(let g=0;g<this.taskQueue.length;g++){const f=this.tasks[this.taskQueue[g]];f.priority<s&&(s=f.priority,n=g)}if(n===null)return null;const c=this.taskQueue[n];return this.taskQueue.splice(n,1),c}remove(){this.invoker.remove()}}class XA{constructor(n,s,c){this.target=n,this.parent=s,this.mapId=c,this.callbacks={},this.cancelCallbacks={},ui(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.scheduler=new OV}send(n,s,c,g,f=!1,_){const T=Math.round(1e18*Math.random()).toString(36).substring(0,10);c&&(c.metadata=_,this.callbacks[T]=c);const A=new Set;return this.target.postMessage({id:T,type:n,hasCallback:!!c,targetMapId:g,mustQueue:f,sourceMapId:this.mapId,data:sc(s,A)},A),{cancel:()=>{c&&delete this.callbacks[T],this.target.postMessage({id:T,type:"<cancel>",targetMapId:g,sourceMapId:this.mapId})}}}receive(n){const s=n.data,c=s.id;if(c&&(!s.targetMapId||this.mapId===s.targetMapId))if(s.type==="<cancel>"){const g=this.cancelCallbacks[c];delete this.cancelCallbacks[c],g&&g.cancel()}else if(s.mustQueue||Qi()){const g=this.callbacks[c],f=this.scheduler.add(()=>this.processTask(c,s),g&&g.metadata||{type:"message"});f&&(this.cancelCallbacks[c]=f)}else this.processTask(c,s)}processTask(n,s){if(delete this.cancelCallbacks[n],s.type==="<response>"){const c=this.callbacks[n];delete this.callbacks[n],c&&(s.error?c(ac(s.error)):c(null,ac(s.data)))}else{const c=new Set,g=s.hasCallback?(_,T)=>{this.target.postMessage({id:n,type:"<response>",sourceMapId:this.mapId,error:_?sc(_):null,data:sc(T,c)},c)}:()=>{},f=ac(s.data);if(this.parent[s.type])this.parent[s.type](s.sourceMapId,f,g);else if(this.parent.getWorkerSource){const _=s.type.split(".");this.parent.getWorkerSource(s.sourceMapId,_[0],f.source,f.scope)[_[1]](f,g)}else g(new Error(`Could not find function ${s.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}}var z_={workerUrl:"",workerClass:null,workerParams:void 0};const h2="mapboxgl_preloaded_worker_pool";class Zf{constructor(){this.active={}}acquire(n,s=Zf.workerCount){if(!this.workers)for(this.workers=[];this.workers.length<s;)this.workers.push(z_.workerClass!=null?new z_.workerClass:new self.Worker(z_.workerUrl,z_.workerParams));return this.active[n]=!0,this.workers.slice()}release(n){delete this.active[n],this.workers&&this.numActive()===0&&(this.workers.forEach(s=>{s.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[h2]}numActive(){return Object.keys(this.active).length}}Zf.workerCount=2;class Yp{constructor(n,s,c="Worker",g=Zf.workerCount){this.workerPool=n,this.actors=[],this.currentActor=0,this.id=Ar();const f=this.workerPool.acquire(this.id,g);for(let _=0;_<f.length;_++){const T=new Yp.Actor(f[_],s,this.id);T.name=`${c} ${_}`,this.actors.push(T)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(n,s,c){vr(this.actors,(g,f)=>{g.send(n,s,f)},c=c||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(n=>{n.remove()}),this.actors=[],this.workerPool.release(this.id)}}let F_,p2;function ob(){return F_||(F_=new Zf),F_}Yp.Actor=XA;const m2=new Jr(0,0,0);var sb=(u=>(u[u.PATH_RULE_UNSPECIFIED=0]="PATH_RULE_UNSPECIFIED",u[u.PATH_RULE_NON_ZERO=1]="PATH_RULE_NON_ZERO",u[u.PATH_RULE_EVEN_ODD=2]="PATH_RULE_EVEN_ODD",u))(sb||{}),ab=(u=>(u[u.LINE_CAP_UNSPECIFIED=0]="LINE_CAP_UNSPECIFIED",u[u.LINE_CAP_BUTT=1]="LINE_CAP_BUTT",u[u.LINE_CAP_ROUND=2]="LINE_CAP_ROUND",u[u.LINE_CAP_SQUARE=3]="LINE_CAP_SQUARE",u))(ab||{}),N_=(u=>(u[u.LINE_JOIN_UNSPECIFIED=0]="LINE_JOIN_UNSPECIFIED",u[u.LINE_JOIN_MITER=1]="LINE_JOIN_MITER",u[u.LINE_JOIN_MITER_CLIP=2]="LINE_JOIN_MITER_CLIP",u[u.LINE_JOIN_ROUND=3]="LINE_JOIN_ROUND",u[u.LINE_JOIN_BEVEL=4]="LINE_JOIN_BEVEL",u))(N_||{}),JA=(u=>(u[u.PAINT_ORDER_UNSPECIFIED=0]="PAINT_ORDER_UNSPECIFIED",u[u.PAINT_ORDER_FILL_AND_STROKE=1]="PAINT_ORDER_FILL_AND_STROKE",u[u.PAINT_ORDER_STROKE_AND_FILL=2]="PAINT_ORDER_STROKE_AND_FILL",u))(JA||{}),Xp=(u=>(u[u.PATH_COMMAND_UNSPECIFIED=0]="PATH_COMMAND_UNSPECIFIED",u[u.PATH_COMMAND_MOVE=1]="PATH_COMMAND_MOVE",u[u.PATH_COMMAND_LINE=2]="PATH_COMMAND_LINE",u[u.PATH_COMMAND_QUAD=3]="PATH_COMMAND_QUAD",u[u.PATH_COMMAND_CUBIC=4]="PATH_COMMAND_CUBIC",u[u.PATH_COMMAND_CLOSE=5]="PATH_COMMAND_CLOSE",u))(Xp||{}),QA=(u=>(u[u.MASK_TYPE_UNSPECIFIED=0]="MASK_TYPE_UNSPECIFIED",u[u.MASK_TYPE_LUMINANCE=1]="MASK_TYPE_LUMINANCE",u[u.MASK_TYPE_ALPHA=2]="MASK_TYPE_ALPHA",u))(QA||{});function LV(u,n,s){u===1&&n.icons.push(function(c,g){return function(f){if(f.usvg_tree.height||(f.usvg_tree.height=f.usvg_tree.width),!f.metadata)return f;const{metadata:_}=f;if(_.content_area){const{content_area:T}=_;T.top==null&&(T.top=T.left),T.width==null&&(T.width=f.usvg_tree.width),T.height==null&&(T.height=T.width)}return _.stretch_x&&_.stretch_x.length&&ek(_,"x"),_.stretch_y&&_.stretch_y.length&&ek(_,"y"),f}(c.readFields(DV,{name:void 0},g))}(s,s.readVarint()+s.pos))}function ek(u,n){const s=[],c=u[`stretch_${n}`];let g=null;for(let f=0;f<c.length;f++)g===null?g=s.length===0?c[0]:s[s.length-1][1]+c[f]:(s.push([g,g+c[f]]),g=null);u[`stretch_${n}_areas`]=s}function DV(u,n,s){u===1?n.name=s.readString():u===2?n.metadata=function(c,g){return c.readFields(zV,{stretch_x:null,stretch_y:null,stretch_x_areas:null,stretch_y_areas:null,variables:[]},g)}(s,s.readVarint()+s.pos):u===3&&(n.usvg_tree=function(c,g){return c.readFields(BV,{width:20,children:[],linear_gradients:[],radial_gradients:[],clip_paths:[],masks:[]},g)}(s,s.readVarint()+s.pos),n.data="usvg_tree")}function zV(u,n,s){u===1?n.stretch_x=s.readPackedVarint():u===2?n.stretch_y=s.readPackedVarint():u===3?n.content_area=function(c,g){return c.readFields(FV,{left:0},g)}(s,s.readVarint()+s.pos):u===4&&n.variables.push(function(c,g){return c.readFields(NV,{name:void 0},g)}(s,s.readVarint()+s.pos))}function FV(u,n,s){u===1?n.left=s.readVarint():u===2?n.width=s.readVarint():u===3?n.top=s.readVarint():u===4&&(n.height=s.readVarint())}function NV(u,n,s){u===1?n.name=s.readString():u===2&&(n.rgb_color=cb(s.readVarint()),n.value="rgb_color")}function BV(u,n,s){u===1?n.width=n.height=s.readVarint():u===2?n.height=s.readVarint():u===3?n.children.push(lb(s,s.readVarint()+s.pos)):u===4?n.linear_gradients.push(function(c,g){return c.readFields(WV,{spread_method:1,stops:[],x1:0,y1:0,x2:1,y2:0},g)}(s,s.readVarint()+s.pos)):u===5?n.radial_gradients.push(function(c,g){return c.readFields(KV,{spread_method:1,stops:[],cx:.5,cy:.5,r:.5,fx:.5,fy:.5,fr:0},g)}(s,s.readVarint()+s.pos)):u===7?n.clip_paths.push(function(c,g){return c.readFields(ZV,{children:[]},g)}(s,s.readVarint()+s.pos)):u===8&&n.masks.push(function(c,g){const f=c.readFields(YV,{left:0,width:20,mask_type:1,children:[]},g);return f.height==null&&(f.height=f.width),f.top==null&&(f.top=f.left),f}(s,s.readVarint()+s.pos))}function lb(u,n){return u.readFields(VV,{},n)}function VV(u,n,s){u===1?(n.group=function(c,g){return c.readFields($V,{opacity:255,children:[]},g)}(s,s.readVarint()+s.pos),n.node="group"):u===2&&(n.path=function(c,g){return c.readFields(jV,{paint_order:1,commands:[],step:1,diffs:[],rule:1},g)}(s,s.readVarint()+s.pos),n.node="path")}function $V(u,n,s){u===1?n.transform=ub(s,s.readVarint()+s.pos):u===2?n.opacity=s.readVarint():u===5?n.clip_path_idx=s.readVarint():u===6?n.mask_idx=s.readVarint():u===7&&n.children.push(lb(s,s.readVarint()+s.pos))}function ub(u,n){return u.readFields(UV,{sx:1,ky:0,kx:0,sy:1,tx:0,ty:0},n)}function UV(u,n,s){u===1?n.sx=s.readFloat():u===2?n.ky=s.readFloat():u===3?n.kx=s.readFloat():u===4?n.sy=s.readFloat():u===5?n.tx=s.readFloat():u===6&&(n.ty=s.readFloat())}function jV(u,n,s){u===1?n.fill=function(c,g){return c.readFields(HV,{rgb_color:m2,paint:"rgb_color",opacity:255},g)}(s,s.readVarint()+s.pos):u===2?n.stroke=function(c,g){return c.readFields(GV,{rgb_color:m2,paint:"rgb_color",dasharray:[],dashoffset:0,miterlimit:4,opacity:255,width:1,linecap:1,linejoin:1},g)}(s,s.readVarint()+s.pos):u===3?n.paint_order=s.readVarint():u===5?s.readPackedVarint(n.commands):u===6?n.step=s.readFloat():u===7?s.readPackedSVarint(n.diffs):u===8&&(n.rule=s.readVarint())}function HV(u,n,s){u===1?(n.rgb_color=cb(s.readVarint()),n.paint="rgb_color"):u===2?(n.linear_gradient_idx=s.readVarint(),n.paint="linear_gradient_idx"):u===3?(n.radial_gradient_idx=s.readVarint(),n.paint="radial_gradient_idx"):u===5&&(n.opacity=s.readVarint())}function cb(u){return new Jr((u>>16&255)/255,(u>>8&255)/255,(255&u)/255,1)}function GV(u,n,s){u===1?(n.rgb_color=cb(s.readVarint()),n.paint="rgb_color"):u===2?(n.linear_gradient_idx=s.readVarint(),n.paint="linear_gradient_idx"):u===3?(n.radial_gradient_idx=s.readVarint(),n.paint="radial_gradient_idx"):u===5?s.readPackedFloat(n.dasharray):u===6?n.dashoffset=s.readFloat():u===7?n.miterlimit=s.readFloat():u===8?n.opacity=s.readVarint():u===9?n.width=s.readFloat():u===10?n.linecap=s.readVarint():u===11&&(n.linejoin=s.readVarint())}function WV(u,n,s){u===1?n.transform=ub(s,s.readVarint()+s.pos):u===2?n.spread_method=s.readVarint():u===3?n.stops.push(tk(s,s.readVarint()+s.pos)):u===4?n.x1=s.readFloat():u===5?n.y1=s.readFloat():u===6?n.x2=s.readFloat():u===7&&(n.y2=s.readFloat())}function tk(u,n){return u.readFields(qV,{offset:0,opacity:255,rgb_color:m2},n)}function qV(u,n,s){u===1?n.offset=s.readFloat():u===2?n.opacity=s.readVarint():u===3&&(n.rgb_color=cb(s.readVarint()))}function KV(u,n,s){u===1?n.transform=ub(s,s.readVarint()+s.pos):u===2?n.spread_method=s.readVarint():u===3?n.stops.push(tk(s,s.readVarint()+s.pos)):u===4?n.cx=s.readFloat():u===5?n.cy=s.readFloat():u===6?n.r=s.readFloat():u===7?n.fx=s.readFloat():u===8?n.fy=s.readFloat():u===9&&(n.fr=s.readFloat())}function ZV(u,n,s){u===1?n.transform=ub(s,s.readVarint()+s.pos):u===2?n.clip_path_idx=s.readVarint():u===3&&n.children.push(lb(s,s.readVarint()+s.pos))}function YV(u,n,s){u===1?n.left=n.top=s.readFloat():u===2?n.width=n.height=s.readFloat():u===3?n.top=s.readFloat():u===4?n.height=s.readFloat():u===5?n.mask_type=s.readVarint():u===6?n.mask_idx=s.readVarint():u===7&&n.children.push(lb(s,s.readVarint()+s.pos))}class XV{static calculate(n,s){const c=new Map,g=new Map;if(Object.keys(n).length===0)return c;s.forEach(f=>{g.set(f.name,f.rgb_color||new Jr(0,0,0))});for(const[f,_]of Object.entries(n))g.has(f)?c.set(g.get(f).toStringPremultipliedAlpha(),_):console.warn(`Ignoring unknown image variable "${f}"`);return c}}function Jp(u,n=255,s){const c=n/255,g=u.toStringPremultipliedAlpha(),f=s.has(g)?s.get(g).clone():u.clone();return f.a=c,f.toString()}function g2(u,n){if(!Qt()){const s=document.createElement("canvas");return s.width=u,s.height=n,s}return new OffscreenCanvas(u,n)}function JV(u,n){const s=XV.calculate(n.params,u.metadata?u.metadata.variables:[]),c=u.usvg_tree,g=c.width,f=c.height,_=n.transform?n.transform:new DOMMatrix,T=Math.max(1,Math.round(g*_.a)),A=Math.max(1,Math.round(f*_.d)),D=new DOMMatrix([T/g,0,0,A/f,0,0]),w=g2(T,A).getContext("2d");return _2(w,D,c,c,s),w.getImageData(0,0,T,A)}function _2(u,n,s,c,g){for(const f of c.children)nk(u,n,s,f,g)}function nk(u,n,s,c,g){c.group?(u.save(),function(f,_,T,A,D){const w=A.mask_idx!=null?T.masks[A.mask_idx]:null,k=A.clip_path_idx!=null?T.clip_paths[A.clip_path_idx]:null;if(A.transform&&(_=B_(A.transform).preMultiplySelf(_)),!function(R,B,W){return R.opacity!==255||B||W}(A,k!=null,w!=null))return void _2(f,_,T,A,D);const O=g2(f.canvas.width,f.canvas.height),I=O.getContext("2d");k&&ak(I,_,T,k),_2(I,_,T,A,D),w&&lk(I,_,T,w,D),f.globalAlpha=A.opacity/255,f.drawImage(O,0,0)}(u,n,s,c.group,g),u.restore()):c.path&&(u.save(),function(f,_,T,A,D){const w=uk(A);f.setTransform(_),A.paint_order===JA.PAINT_ORDER_FILL_AND_STROKE?(rk(f,T,A,w,D),ik(f,T,A,w,D)):(ik(f,T,A,w,D),rk(f,T,A,w,D))}(u,n,s,c.path,g),u.restore())}function rk(u,n,s,c,g){const f=s.fill;if(!f)return;const _=f.opacity/255;switch(f.paint){case"rgb_color":u.fillStyle=Jp(f.rgb_color,f.opacity,g);break;case"linear_gradient_idx":u.fillStyle=ok(u,n.linear_gradients[f.linear_gradient_idx],_,g);break;case"radial_gradient_idx":u.fillStyle=sk(u,n.radial_gradients[f.radial_gradient_idx],_,g)}let T;switch(s.rule){case sb.PATH_RULE_NON_ZERO:T="nonzero";break;case sb.PATH_RULE_EVEN_ODD:T="evenodd"}u.fill(c,T)}function ik(u,n,s,c,g){const f=s.stroke;if(!f)return;u.lineWidth=f.width,u.miterLimit=f.miterlimit,u.setLineDash(f.dasharray),u.lineDashOffset=f.dashoffset;const _=f.opacity/255;switch(f.paint){case"rgb_color":u.strokeStyle=Jp(f.rgb_color,f.opacity,g);break;case"linear_gradient_idx":u.strokeStyle=ok(u,n.linear_gradients[f.linear_gradient_idx],_,g);break;case"radial_gradient_idx":u.strokeStyle=sk(u,n.radial_gradients[f.radial_gradient_idx],_,g)}switch(f.linejoin){case N_.LINE_JOIN_MITER_CLIP:case N_.LINE_JOIN_MITER:u.lineJoin="miter";break;case N_.LINE_JOIN_ROUND:u.lineJoin="round";break;case N_.LINE_JOIN_BEVEL:u.lineJoin="bevel"}switch(f.linecap){case ab.LINE_CAP_BUTT:u.lineCap="butt";break;case ab.LINE_CAP_ROUND:u.lineCap="round";break;case ab.LINE_CAP_SQUARE:u.lineCap="square"}u.stroke(c)}function ok(u,n,s,c){if(n.stops.length===1){const O=n.stops[0];return Jp(O.rgb_color,O.opacity*s,c)}const g=B_(n.transform),{x1:f,y1:_,x2:T,y2:A}=n,D=g.transformPoint(new DOMPoint(f,_)),w=g.transformPoint(new DOMPoint(T,A)),k=u.createLinearGradient(D.x,D.y,w.x,w.y);for(const O of n.stops)k.addColorStop(O.offset,Jp(O.rgb_color,O.opacity*s,c));return k}function sk(u,n,s,c){if(n.stops.length===1){const O=n.stops[0];return Jp(O.rgb_color,O.opacity*s,c)}const g=B_(n.transform),{fx:f,fy:_,cx:T,cy:A}=n,D=g.transformPoint(new DOMPoint(f,_)),w=g.transformPoint(new DOMPoint(T,A)),k=u.createRadialGradient(D.x,D.y,0,w.x,w.y,n.r*((g.a+g.d)/2));for(const O of n.stops)k.addColorStop(O.offset,Jp(O.rgb_color,O.opacity*s,c));return k}function ak(u,n,s,c){const g=B_(c.transform).preMultiplySelf(n),f=c.clip_path_idx!=null?s.clip_paths[c.clip_path_idx]:null;f&&ak(u,g,s,f);const _=new Path2D;let T;function A(D,w){if(D.path){const k=D.path;_.addPath(uk(k),w),k.rule===sb.PATH_RULE_EVEN_ODD&&(T="evenodd")}else if(D.group){const k=D.group.transform?B_(D.group.transform).preMultiplySelf(w):w;for(const O of D.group.children)A(O,k)}}for(const D of c.children)A(D,g);u.clip(_,T)}function lk(u,n,s,c,g){if(c.children.length===0)return;const f=c.mask_idx!=null?s.masks[c.mask_idx]:null;f&&lk(u,n,s,f,g);const _=u.canvas.width,T=u.canvas.height,A=g2(_,T),D=A.getContext("2d"),w=c.width,k=c.height,O=c.left,I=c.top,R=new Path2D,B=new Path2D;B.rect(O,I,w,k),R.addPath(B,n),D.clip(R);for(const ie of c.children)nk(D,n,s,ie,g);const W=D.getImageData(0,0,_,T),K=W.data;if(c.mask_type===QA.MASK_TYPE_LUMINANCE)for(let ie=0;ie<K.length;ie+=4)K[ie+3]=K[ie+3]/255*(.2126*K[ie]+.7152*K[ie+1]+.0722*K[ie+2]);D.putImageData(W,0,0),u.globalCompositeOperation="destination-in",u.drawImage(A,0,0)}function B_(u){return u?new DOMMatrix([u.sx,u.ky,u.kx,u.sy,u.tx,u.ty]):new DOMMatrix}function uk(u){const n=new Path2D,s=u.step;let c=u.diffs[0]*s,g=u.diffs[1]*s;n.moveTo(c,g);for(let f=0,_=2;f<u.commands.length;f++)switch(u.commands[f]){case Xp.PATH_COMMAND_MOVE:c+=u.diffs[_++]*s,g+=u.diffs[_++]*s,n.moveTo(c,g);break;case Xp.PATH_COMMAND_LINE:c+=u.diffs[_++]*s,g+=u.diffs[_++]*s,n.lineTo(c,g);break;case Xp.PATH_COMMAND_QUAD:{const T=c+u.diffs[_++]*s,A=g+u.diffs[_++]*s;c=T+u.diffs[_++]*s,g=A+u.diffs[_++]*s,n.quadraticCurveTo(T,A,c,g);break}case Xp.PATH_COMMAND_CUBIC:{const T=c+u.diffs[_++]*s,A=g+u.diffs[_++]*s,D=T+u.diffs[_++]*s,w=A+u.diffs[_++]*s;c=D+u.diffs[_++]*s,g=w+u.diffs[_++]*s,n.bezierCurveTo(T,A,D,w,c,g);break}case Xp.PATH_COMMAND_CLOSE:n.closePath()}return n}class y2{constructor(n){this.capacity=n,this.cache=new Map}get(n){if(!this.cache.has(n))return;const s=this.cache.get(n);return this.cache.delete(n),this.cache.set(n,s),s}put(n,s){this.cache.has(n)?this.cache.delete(n):this.cache.size===this.capacity&&this.cache.delete(this.cache.keys().next().value),this.cache.set(n,s)}delete(n){this.cache.delete(n)}}class v2{constructor(){this.cacheMap=new Map,this.cacheDependenciesMap=new Map}static _getImage(n){return new ss(n,n.data)}getFromCache(n,s,c){return this.cacheMap.has(c)||this.cacheMap.set(c,new y2(150)),this.cacheMap.get(c).get(ds(n.serialize(),s))}setInCache(n,s,c,g){this.cacheDependenciesMap.has(g)||this.cacheDependenciesMap.set(g,new Map),this.cacheMap.has(g)||this.cacheMap.set(g,new y2(150));const f=this.cacheDependenciesMap.get(g);f.get(ds(n.id,c))||f.set(ds(n.id,c),new Set);const _=this.cacheMap.get(g),T=n.serialize();f.get(ds(n.id,c)).add(T),_.put(ds(n.serialize(),c),s)}removeImagesFromCacheByIds(n,s,c=""){if(!this.cacheMap.has(c)||!this.cacheDependenciesMap.has(c))return;const g=this.cacheMap.get(c),f=this.cacheDependenciesMap.get(c);for(const _ of n)if(f.has(ds(_,s))){for(const T of f.get(ds(_,s)))g.delete(T);f.delete(ds(_,s))}}rasterize(n,s,c,g,f=JV){const _=this.getFromCache(n,c,g);if(_)return _.clone();const T=f(s.icon,n.options),A=v2._getImage(T);return this.setInCache(n,A,c,g),A.clone()}}class ck{constructor(n){this.size=n,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(n,s){const c=this.toIdx(n,s);return{min:this.minimums[c],max:this.maximums[c]}}isLeaf(n,s){return this.leaves[this.toIdx(n,s)]}toIdx(n,s){return s*this.size+n}}function dk(u,n,s,c){let g=0,f=Number.MAX_VALUE;for(let _=0;_<3;_++)if(Math.abs(c[_])<1e-15){if(s[_]<u[_]||s[_]>n[_])return null}else{const T=1/c[_];let A=(u[_]-s[_])*T,D=(n[_]-s[_])*T;if(A>D){const w=A;A=D,D=w}if(A>g&&(g=A),D<f&&(f=D),g>f)return null}return g}function fk(u,n,s,c,g,f,_,T,A,D,w){const k=c-u,O=g-n,I=f-s,R=_-u,B=T-n,W=A-s,K=w[1]*W-w[2]*B,ie=w[2]*R-w[0]*W,oe=w[0]*B-w[1]*R,Q=k*K+O*ie+I*oe;if(Math.abs(Q)<1e-15)return null;const ue=1/Q,ge=D[0]-u,Se=D[1]-n,Fe=D[2]-s,ze=(ge*K+Se*ie+Fe*oe)*ue;if(ze<0||ze>1)return null;const Le=Se*I-Fe*O,nt=Fe*k-ge*I,$e=ge*O-Se*k,it=(w[0]*Le+w[1]*nt+w[2]*$e)*ue;return it<0||ze+it>1?null:(R*Le+B*nt+W*$e)*ue}function hk(u,n,s){return(u-n)/(s-n)}function pk(u,n,s,c,g,f,_,T,A){const D=1<<s,w=f-c,k=_-g,O=(u+1)/D*w+c,I=(n+0)/D*k+g,R=(n+1)/D*k+g;T[0]=(u+0)/D*w+c,T[1]=I,A[0]=O,A[1]=R}class mk{constructor(n){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=n,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const s=function(f){const _=Math.ceil(Math.log2(f.dim/8)),T=[];let A=Math.ceil(Math.pow(2,_));const D=1/A,w=(I,R,B,W,K)=>{const ie=W?1:0,oe=(I+1)*B-ie,Q=R*B,ue=(R+1)*B-ie;K[0]=I*B,K[1]=Q,K[2]=oe,K[3]=ue};let k=new ck(A);const O=[];for(let I=0;I<A*A;I++){w(I%A,Math.floor(I/A),D,!1,O);const R=wd(O[0],O[1],f),B=wd(O[2],O[1],f),W=wd(O[2],O[3],f),K=wd(O[0],O[3],f);k.minimums.push(Math.min(R,B,W,K)),k.maximums.push(Math.max(R,B,W,K)),k.leaves.push(1)}for(T.push(k),A/=2;A>=1;A/=2){const I=T[T.length-1];k=new ck(A);for(let R=0;R<A*A;R++){w(R%A,Math.floor(R/A),2,!0,O);const B=I.getElevation(O[0],O[1]),W=I.getElevation(O[2],O[1]),K=I.getElevation(O[2],O[3]),ie=I.getElevation(O[0],O[3]),oe=I.isLeaf(O[0],O[1]),Q=I.isLeaf(O[2],O[1]),ue=I.isLeaf(O[2],O[3]),ge=I.isLeaf(O[0],O[3]),Se=Math.min(B.min,W.min,K.min,ie.min),Fe=Math.max(B.max,W.max,K.max,ie.max),ze=oe&&Q&&ue&&ge;k.maximums.push(Fe),k.minimums.push(Se),k.leaves.push(Fe-Se<=5&&ze?1:0)}T.push(k)}return T}(this.dem),c=s.length-1,g=s[c];this._addNode(g.minimums[0],g.maximums[0],g.leaves[0]),this._construct(s,0,0,c,0)}raycastRoot(n,s,c,g,f,_,T=1){return dk([n,s,-100],[c,g,this.maximums[0]*T],f,_)}raycast(n,s,c,g,f,_,T=1){if(!this.nodeCount)return null;const A=this.raycastRoot(n,s,c,g,f,_,T);if(A==null)return null;const D=[],w=[],k=[],O=[],I=[{idx:0,t:A,nodex:0,nodey:0,depth:0}];for(;I.length>0;){const{idx:R,t:B,nodex:W,nodey:K,depth:ie}=I.pop();if(this.leaves[R]){pk(W,K,ie,n,s,c,g,k,O);const Q=1<<ie,ue=(W+0)/Q,ge=(W+1)/Q,Se=(K+0)/Q,Fe=(K+1)/Q,ze=wd(ue,Se,this.dem)*T,Le=wd(ge,Se,this.dem)*T,nt=wd(ge,Fe,this.dem)*T,$e=wd(ue,Fe,this.dem)*T,it=fk(k[0],k[1],ze,O[0],k[1],Le,O[0],O[1],nt,f,_),dt=fk(O[0],O[1],nt,k[0],O[1],$e,k[0],k[1],ze,f,_),ct=Math.min(it!==null?it:Number.MAX_VALUE,dt!==null?dt:Number.MAX_VALUE);if(ct!==Number.MAX_VALUE)return ct;{const mt=Ne.vec3.scaleAndAdd([],f,_,B);if(gk(ze,Le,$e,nt,hk(mt[0],k[0],O[0]),hk(mt[1],k[1],O[1]))>=mt[2])return B}continue}let oe=0;for(let Q=0;Q<this._siblingOffset.length;Q++){pk((W<<1)+this._siblingOffset[Q][0],(K<<1)+this._siblingOffset[Q][1],ie+1,n,s,c,g,k,O),k[2]=-100,O[2]=this.maximums[this.childOffsets[R]+Q]*T;const ue=dk(k,O,f,_);if(ue!=null){const ge=ue;D[Q]=ge;let Se=!1;for(let Fe=0;Fe<oe&&!Se;Fe++)ge>=D[w[Fe]]&&(w.splice(Fe,0,Q),Se=!0);Se||(w[oe]=Q),oe++}}for(let Q=0;Q<oe;Q++){const ue=w[Q];I.push({idx:this.childOffsets[R]+ue,t:D[ue],nodex:(W<<1)+this._siblingOffset[ue][0],nodey:(K<<1)+this._siblingOffset[ue][1],depth:ie+1})}}return null}_addNode(n,s,c){return this.minimums.push(n),this.maximums.push(s),this.leaves.push(c),this.childOffsets.push(0),this.nodeCount++}_construct(n,s,c,g,f){if(n[g].isLeaf(s,c)===1)return;this.childOffsets[f]||(this.childOffsets[f]=this.nodeCount);const _=g-1,T=n[_];let A=0,D=0;for(let w=0;w<this._siblingOffset.length;w++){const k=2*s+this._siblingOffset[w][0],O=2*c+this._siblingOffset[w][1],I=T.getElevation(k,O),R=T.isLeaf(k,O),B=this._addNode(I.min,I.max,R);R&&(A|=1<<w),D||(D=B)}for(let w=0;w<this._siblingOffset.length;w++)A&1<<w||this._construct(n,2*s+this._siblingOffset[w][0],2*c+this._siblingOffset[w][1],_,D+w)}}function gk(u,n,s,c,g,f){return pr(pr(u,s,f),pr(n,c,f),g)}function wd(u,n,s){const c=s.dim,g=Et(u*c-.5,0,c-1),f=Et(n*c-.5,0,c-1),_=Math.floor(g),T=Math.floor(f),A=Math.min(_+1,c-1),D=Math.min(T+1,c-1);return gk(s.get(_,T),s.get(A,T),s.get(_,D),s.get(A,D),g-_,f-T)}const QV={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};function e$(u,n,s){return(256*u*256+256*n+s)/10-1e4}function t$(u,n,s){return 256*u+n+s/256-32768}class db{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(n,s,c,g=!1){if(this.uid=n,s.height!==s.width)throw new RangeError("DEM tiles must be square");if(c&&c!=="mapbox"&&c!=="terrarium")return void xn(`"${c}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=s.height;const f=this.dim=s.height-2,_=new Uint32Array(s.data.buffer);if(this.pixels=new Uint8Array(s.data.buffer),this.floatView=new Float32Array(s.data.buffer),this.borderReady=g,this._modifiedForSources={},!g){for(let A=0;A<f;A++)_[this._idx(-1,A)]=_[this._idx(0,A)],_[this._idx(f,A)]=_[this._idx(f-1,A)],_[this._idx(A,-1)]=_[this._idx(A,0)],_[this._idx(A,f)]=_[this._idx(A,f-1)];_[this._idx(-1,-1)]=_[this._idx(0,0)],_[this._idx(f,-1)]=_[this._idx(f-1,0)],_[this._idx(-1,f)]=_[this._idx(0,f-1)],_[this._idx(f,f)]=_[this._idx(f-1,f-1)]}const T=c==="terrarium"?t$:e$;for(let A=0;A<_.length;++A){const D=4*A;this.floatView[A]=T(this.pixels[D],this.pixels[D+1],this.pixels[D+2])}this._timestamp=bn.now()}_buildQuadTree(){this._tree=new mk(this)}get(n,s,c=!1){c&&(n=Et(n,-1,this.dim),s=Et(s,-1,this.dim));const g=this._idx(n,s);return this.floatView[g]}set(n,s,c){const g=this._idx(n,s),f=this.floatView[g];return this.floatView[g]=c,c-f}static getUnpackVector(n){return QV[n]}_idx(n,s){if(n<-1||n>=this.dim+1||s<-1||s>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(s+1)*this.stride+(n+1)}static pack(n,s){const c=[0,0,0,0],g=db.getUnpackVector(s);let f=Math.floor((n+g[3])/g[2]);return c[2]=f%256,f=Math.floor(f/256),c[1]=f%256,f=Math.floor(f/256),c[0]=f,c}getPixels(){return new zM({width:this.stride,height:this.stride},this.pixels)}backfillBorder(n,s,c){if(this.dim!==n.dim)throw new Error("dem dimension mismatch");let g=s*this.dim,f=s*this.dim+this.dim,_=c*this.dim,T=c*this.dim+this.dim;switch(s){case-1:g=f-1;break;case 1:f=g+1}switch(c){case-1:_=T-1;break;case 1:T=_+1}const A=-s*this.dim,D=-c*this.dim;for(let w=_;w<T;w++)for(let k=g;k<f;k++){const O=4*this._idx(k,w),I=4*this._idx(k+A,w+D);this.pixels[O+0]=n.pixels[I+0],this.pixels[O+1]=n.pixels[I+1],this.pixels[O+2]=n.pixels[I+2],this.pixels[O+3]=n.pixels[I+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}function n$(u,n,s){u===1?n.headerLength=s.readFixed32():u===2?n.x=s.readVarint():u===3?n.y=s.readVarint():u===4?n.z=s.readVarint():u===5&&n.layers.push(function(c,g){return c.readFields(a$,{version:0,name:"",units:"",tileSize:0,buffer:0,pixelFormat:0,dataIndex:[]},g)}(s,s.readVarint()+s.pos))}function r$(u,n,s){u===1?(n.delta_filter=function(c,g){return c.readFields(i$,{blockSize:0},g)}(s,s.readVarint()+s.pos),n.filter="delta_filter"):u===2?(s.readVarint(),n.filter="zigzag_filter"):u===3?(s.readVarint(),n.filter="bitshuffle_filter"):u===4&&(s.readVarint(),n.filter="byteshuffle_filter")}function i$(u,n,s){u===1&&(n.blockSize=s.readVarint())}function o$(u,n,s){u===1?(s.readVarint(),n.codec="gzip_data"):u===2?(s.readVarint(),n.codec="jpeg_image"):u===3?(s.readVarint(),n.codec="webp_image"):u===4&&(s.readVarint(),n.codec="png_image")}function s$(u,n,s){let c=0,g=0;u===1?n.firstByte=s.readFixed64():u===2?n.lastByte=s.readFixed64():u===3?n.filters.push(function(f,_){return f.readFields(r$,{},_)}(s,s.readVarint()+s.pos)):u===4?n.codec=function(f,_){return f.readFields(o$,{},_)}(s,s.readVarint()+s.pos):u===5?g=s.readFloat():u===6?c=s.readFloat():u===7?n.bands.push(s.readString()):u===8?n.offset=s.readDouble():u===9&&(n.scale=s.readDouble()),n.offset===0&&(n.offset=g),n.scale===0&&(n.scale=c)}function a$(u,n,s){u===1?n.version=s.readVarint():u===2?n.name=s.readString():u===3?n.units=s.readString():u===4?n.tileSize=s.readVarint():u===5?n.buffer=s.readVarint():u===6?n.pixelFormat=s.readVarint():u===7&&n.dataIndex.push(function(c,g){return c.readFields(s$,{firstByte:0,lastByte:0,filters:[],codec:null,offset:0,scale:0,bands:[]},g)}(s,s.readVarint()+s.pos))}function l$(u,n,s){if(u===2)(function(c,g,f){c.readFields(u$,f,g)})(s,s.readVarint()+s.pos,n);else if(u===3)throw new Error("Not implemented")}function u$(u,n,s){if(u===1){let c=0;const g=s.readVarint()+s.pos;for(;s.pos<g;)n[c++]=s.readVarint()}}function c$(u,n){if(n.length!==4)throw new Error(`Expected data of dimension 4 but got ${n.length}.`);let s=n[3];for(let c=2;c>=1;c--){const g=c===1?1:0,f=c===2?1:0;for(let _=0;_<n[0];_++){const T=n[1]*_;for(let A=g;A<n[1];A++){const D=n[2]*(A+T);for(let w=f;w<n[2];w++){const k=n[3]*(w+D);for(let O=0;O<n[3];O++){const I=k+O;u[I]+=u[I-s]}}}}s*=n[c]}return u}function d$(u){for(let n=0,s=u.length;n<s;n++)u[n]=u[n]>>>1^-(1&u[n]);return u}function f$(u,n){switch(n){case"uint32":return u;case"uint16":for(let s=0;s<u.length;s+=2){const c=u[s],g=u[s+1];u[s]=(240&c)>>4|(61440&c)>>8|(240&g)<<4|61440&g,u[s+1]=15&c|(3840&c)>>4|(15&g)<<8|(3840&g)<<4}return u;case"uint8":for(let s=0;s<u.length;s+=4){const c=u[s],g=u[s+1],f=u[s+2],_=u[s+3];u[s+0]=(192&c)>>6|(192&g)>>4|(192&f)>>2|192&_,u[s+1]=(48&c)>>4|(48&g)>>2|48&f|(48&_)<<2,u[s+2]=(12&c)>>2|12&g|(12&f)<<2|(12&_)<<4,u[s+3]=3&c|(3&g)<<2|(3&f)<<4|(3&_)<<6}return u;default:throw new Error(`Invalid pixel format, "${n}"`)}}Gn(db,"DEMData"),Gn(mk,"DemMinMaxQuadTree",{omit:["dem"]});var Na=Uint8Array,V_=Uint16Array,h$=Int32Array,_k=new Na([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),yk=new Na([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),p$=new Na([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),vk=function(u,n){for(var s=new V_(31),c=0;c<31;++c)s[c]=n+=1<<u[c-1];var g=new h$(s[30]);for(c=1;c<30;++c)for(var f=s[c];f<s[c+1];++f)g[f]=f-s[c]<<5|c;return{b:s,r:g}},bk=vk(_k,2),xk=bk.b,m$=bk.r;xk[28]=258,m$[258]=28;for(var g$=vk(yk,0).b,wk=new V_(32768),xo=0;xo<32768;++xo){var Qp=(43690&xo)>>1|(21845&xo)<<1;wk[xo]=((65280&(Qp=(61680&(Qp=(52428&Qp)>>2|(13107&Qp)<<2))>>4|(3855&Qp)<<4))>>8|(255&Qp)<<8)>>1}var $_=function(u,n,s){for(var c=u.length,g=0,f=new V_(n);g<c;++g)u[g]&&++f[u[g]-1];var _,T=new V_(n);for(g=1;g<n;++g)T[g]=T[g-1]+f[g-1]<<1;_=new V_(1<<n);var A=15-n;for(g=0;g<c;++g)if(u[g])for(var D=g<<4|u[g],w=n-u[g],k=T[u[g]-1]++<<w,O=k|(1<<w)-1;k<=O;++k)_[wk[k]>>A]=D;return _},U_=new Na(288);for(xo=0;xo<144;++xo)U_[xo]=8;for(xo=144;xo<256;++xo)U_[xo]=9;for(xo=256;xo<280;++xo)U_[xo]=7;for(xo=280;xo<288;++xo)U_[xo]=8;var Sk=new Na(32);for(xo=0;xo<32;++xo)Sk[xo]=5;var _$=$_(U_,9),y$=$_(Sk,5),b2=function(u){for(var n=u[0],s=1;s<u.length;++s)u[s]>n&&(n=u[s]);return n},Fl=function(u,n,s){var c=n/8|0;return(u[c]|u[c+1]<<8)>>(7&n)&s},x2=function(u,n){var s=n/8|0;return(u[s]|u[s+1]<<8|u[s+2]<<16)>>(7&n)},v$=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],Nl=function(u,n,s){var c=new Error(n||v$[u]);if(c.code=u,Error.captureStackTrace&&Error.captureStackTrace(c,Nl),!s)throw c;return c},b$=new Na(0),x$=typeof TextDecoder<"u"&&new TextDecoder;try{x$.decode(b$,{stream:!0})}catch{}const w$={gzip_data:"gzip"};class el extends Error{constructor(n){super(n),this.name="MRTError"}}const S$={0:"uint32",1:"uint32",2:"uint16",3:"uint8"},Tk={uint32:1,uint16:2,uint8:4},T$={uint32:Uint32Array,uint16:Uint16Array,uint8:Uint8Array};let w2;class S2{constructor(n=5){this.x=NaN,this.y=NaN,this.z=NaN,this.layers={},this._cacheSize=n}getLayer(n){const s=this.layers[n];if(!s)throw new el(`Layer '${n}' not found`);return s}getHeaderLength(n){const s=new Uint8Array(n),c=new DataView(n);if(s[0]!==13)throw new el("File is not a valid MRT.");return c.getUint32(1,!0)}parseHeader(n){const s=new Uint8Array(n),c=this.getHeaderLength(n);if(s.length<c)throw new el(`Expected header with length >= ${c} but got buffer of length ${s.length}`);const g=function(f,_){return f.readFields(n$,{headerLength:0,x:0,y:0,z:0,layers:[]},void 0)}(new w2(s.subarray(0,c)));if(!isNaN(this.x)&&(this.x!==g.x||this.y!==g.y||this.z!==g.z))throw new el(`Invalid attempt to parse header ${g.z}/${g.x}/${g.y} for tile ${this.z}/${this.x}/${this.y}`);this.x=g.x,this.y=g.y,this.z=g.z;for(const f of g.layers)this.layers[f.name]=new C$(f,{cacheSize:this._cacheSize});return this}createDecodingTask(n){const s=[],c=this.getLayer(n.layerName);for(let g of n.blockIndices){const f=c.dataIndex[g],_=f.firstByte-n.firstByte,T=f.lastByte-n.firstByte;if(c._blocksInProgress.has(g))continue;const A={layerName:c.name,firstByte:_,lastByte:T,pixelFormat:c.pixelFormat,blockIndex:g,blockShape:[f.bands.length].concat(c.bandShape),buffer:c.buffer,codec:f.codec.codec,filters:f.filters.map(D=>D.filter)};c._blocksInProgress.add(g),s.push(A)}return new Ck(s,()=>{s.forEach(g=>c._blocksInProgress.delete(g.blockIndex))},(g,f)=>{if(s.forEach(_=>c._blocksInProgress.delete(_.blockIndex)),g)throw g;f.forEach(_=>{this.getLayer(_.layerName).processDecodedData(_)})})}}class C${constructor({version:n,name:s,units:c,tileSize:g,pixelFormat:f,buffer:_,dataIndex:T},A){if(this.version=n,this.version!==1)throw new el(`Cannot parse raster layer encoded with MRT version ${n}`);this.name=s,this.units=c,this.tileSize=g,this.buffer=_,this.pixelFormat=S$[f],this.dataIndex=T,this.bandShape=[g+2*_,g+2*_,Tk[this.pixelFormat]],this._decodedBlocks=new y2(A?A.cacheSize:5),this._blocksInProgress=new Set}get dimension(){return Tk[this.pixelFormat]}get cacheSize(){return this._decodedBlocks.capacity}getBandList(){return this.dataIndex.map(({bands:n})=>n).flat()}processDecodedData(n){const s=n.blockIndex.toString();this._decodedBlocks.get(s)||this._decodedBlocks.put(s,n.data)}getBlockForBand(n){let s=0;switch(typeof n){case"string":for(const[c,g]of this.dataIndex.entries()){for(const[f,_]of g.bands.entries())if(_===n)return{bandIndex:s+f,blockIndex:c,blockBandIndex:f};s+=g.bands.length}break;case"number":for(const[c,g]of this.dataIndex.entries()){if(n>=s&&n<s+g.bands.length)return{bandIndex:n,blockIndex:c,blockBandIndex:n-s};s+=g.bands.length}break;default:throw new el(`Invalid band \`${JSON.stringify(n)}\`. Expected string or integer.`)}throw new el(`Band not found: ${JSON.stringify(n)}`)}getDataRange(n){let s=1/0,c=-1/0;const g=[],f=new Set;for(const _ of n){const{blockIndex:T}=this.getBlockForBand(_);if(T<0)throw new el(`Invalid band: ${JSON.stringify(_)}`);const A=this.dataIndex[T];g.includes(T)||g.push(T),f.add(T),s=Math.min(s,A.firstByte),c=Math.max(c,A.lastByte)}if(f.size>this.cacheSize)throw new el(`Number of blocks to decode (${f.size}) exceeds cache size (${this.cacheSize}).`);return{layerName:this.name,firstByte:s,lastByte:c,blockIndices:g}}hasBand(n){const{blockIndex:s}=this.getBlockForBand(n);return s>=0}hasDataForBand(n){const{blockIndex:s}=this.getBlockForBand(n);return s>=0&&!!this._decodedBlocks.get(s.toString())}getBandView(n){const{blockIndex:s,blockBandIndex:c}=this.getBlockForBand(n),g=this._decodedBlocks.get(s.toString());if(!g)throw new el(`Data for band ${JSON.stringify(n)} of layer "${this.name}" not decoded.`);const f=this.dataIndex[s],_=this.bandShape.reduce((D,w)=>D*w,1),T=c*_,A=g.subarray(T,T+_);return{data:A,bytes:new Uint8Array(A.buffer).subarray(A.byteOffset,A.byteOffset+A.byteLength),tileSize:this.tileSize,buffer:this.buffer,pixelFormat:this.pixelFormat,dimension:this.dimension,offset:f.offset,scale:f.scale}}}S2.setPbf=function(u){w2=u};class Ck{constructor(n,s,c){this.tasks=n,this._onCancel=s,this._onComplete=c,this._finalized=!1}cancel(){this._finalized||(this._onCancel(),this._finalized=!0)}complete(n,s){this._finalized||(this._onComplete(n,s),this._finalized=!0)}}S2.performDecoding=function(u,n){const s=new Uint8Array(u);return Promise.all(n.tasks.map(c=>{const{layerName:g,firstByte:f,lastByte:_,pixelFormat:T,blockShape:A,blockIndex:D,filters:w,codec:k}=c,O=s.subarray(f,_+1),I=new Uint32Array(A[0]*A[1]*A[2]);let R;if(k!=="gzip_data")throw new el(`Unhandled codec: ${k}`);return R=function(B,W){if(!globalThis.DecompressionStream&&W==="gzip_data")return Promise.resolve(((Q=function(Se){Se[0]==31&&Se[1]==139&&Se[2]==8||Nl(6,"invalid gzip data");var Fe=Se[3],ze=10;4&Fe&&(ze+=2+(Se[10]|Se[11]<<8));for(var Le=(Fe>>3&1)+(Fe>>4&1);Le>0;Le-=!Se[ze++]);return ze+(2&Fe)}(oe=B))+8>oe.length&&Nl(6,"invalid gzip data"),function(Se,Fe,ze,Le){var nt=Se.length;if(!nt||Fe.f&&!Fe.l)return ze||new Na(0);var $e=!ze,it=$e||Fe.i!=2,dt=Fe.i;$e&&(ze=new Na(3*nt));var ct,mt,wt=function(gc){var Cd=ze.length;if(gc>Cd){var Ed=new Na(Math.max(2*Cd,gc));Ed.set(ze),ze=Ed}},Mt=Fe.f||0,vt=Fe.p||0,qt=Fe.b||0,mn=Fe.l,Zt=Fe.d,Tn=Fe.m,Sn=Fe.n,On=8*nt;do{if(!mn){Mt=Fl(Se,vt,1);var nn=Fl(Se,vt+1,3);if(vt+=3,!nn){var Yn=Se[(Sr=4+((vt+7)/8|0))-4]|Se[Sr-3]<<8,In=Sr+Yn;if(In>nt){dt&&Nl(0);break}it&&wt(qt+Yn),ze.set(Se.subarray(Sr,In),qt),Fe.b=qt+=Yn,Fe.p=vt=8*In,Fe.f=Mt;continue}if(nn==1)mn=_$,Zt=y$,Tn=9,Sn=5;else if(nn==2){var qn=Fl(Se,vt,31)+257,ar=Fl(Se,vt+10,15)+4,Mr=qn+Fl(Se,vt+5,31)+1;vt+=14;for(var Pr=new Na(Mr),Br=new Na(19),Rr=0;Rr<ar;++Rr)Br[p$[Rr]]=Fl(Se,vt+3*Rr,7);vt+=3*ar;var Ur=b2(Br),Ei=(1<<Ur)-1,gi=$_(Br,Ur);for(Rr=0;Rr<Mr;){var Sr,_i=gi[Fl(Se,vt,Ei)];if(vt+=15&_i,(Sr=_i>>4)<16)Pr[Rr++]=Sr;else{var fi=0,Mi=0;for(Sr==16?(Mi=3+Fl(Se,vt,3),vt+=2,fi=Pr[Rr-1]):Sr==17?(Mi=3+Fl(Se,vt,7),vt+=3):Sr==18&&(Mi=11+Fl(Se,vt,127),vt+=7);Mi--;)Pr[Rr++]=fi}}var wo=Pr.subarray(0,qn),So=Pr.subarray(qn);Tn=b2(wo),Sn=b2(So),mn=$_(wo,Tn),Zt=$_(So,Sn)}else Nl(1);if(vt>On){dt&&Nl(0);break}}it&&wt(qt+131072);for(var so=(1<<Tn)-1,Os=(1<<Sn)-1,Wi=vt;;Wi=vt){var qi=(fi=mn[x2(Se,vt)&so])>>4;if((vt+=15&fi)>On){dt&&Nl(0);break}if(fi||Nl(2),qi<256)ze[qt++]=qi;else{if(qi==256){Wi=vt,mn=null;break}var ps=qi-254;qi>264&&(ps=Fl(Se,vt,(1<<(Po=_k[Rr=qi-257]))-1)+xk[Rr],vt+=Po);var To=Zt[x2(Se,vt)&Os],Gs=To>>4;if(To||Nl(3),vt+=15&To,So=g$[Gs],Gs>3){var Po=yk[Gs];So+=x2(Se,vt)&(1<<Po)-1,vt+=Po}if(vt>On){dt&&Nl(0);break}it&&wt(qt+131072);var Cu=qt+ps;if(qt<So){var Sd=0-So,Td=Math.min(So,Cu);for(Sd+qt<0&&Nl(3);qt<Td;++qt)ze[qt]=(void 0)[Sd+qt]}for(;qt<Cu;++qt)ze[qt]=ze[qt-So]}}Fe.l=mn,Fe.p=Wi,Fe.b=qt,Fe.f=Mt,mn&&(Mt=1,Fe.m=Tn,Fe.d=Zt,Fe.n=Sn)}while(!Mt);return qt!=ze.length&&$e?(ct=ze,((mt=qt)==null||mt>ct.length)&&(mt=ct.length),new Na(ct.subarray(0,mt))):ze.subarray(0,qt)}(oe.subarray(Q,-8),{i:2},new Na(((K=oe)[(ie=K.length)-4]|K[ie-3]<<8|K[ie-2]<<16|K[ie-1]<<24)>>>0))));var K,ie,oe,Q;const ue=w$[W];if(!ue)throw new Error(`Unhandled codec: ${W}`);const ge=new globalThis.DecompressionStream(ue);return new Response(new Blob([B]).stream().pipeThrough(ge)).arrayBuffer().then(Se=>new Uint8Array(Se))}(O,k).then(B=>(function(W,K){W.readFields(l$,K)}(new w2(B),I),new T$[T](I.buffer))),R.then(B=>{for(let W=w.length-1;W>=0;W--)switch(w[W]){case"delta_filter":c$(B,A);break;case"zigzag_filter":d$(B);break;case"bitshuffle_filter":f$(B,T);break;default:throw new el(`Unhandled filter "${w[W]}"`)}return{layerName:g,blockIndex:D,data:B}}).catch(B=>{throw B})}))},Gn(Ck,"MRTDecodingBatch",{omit:["_onCancel","_onComplete"]});let j_,T2,Bl,em,C2,tm=null;function Ek(){return Qi()&&self.worker&&self.worker.dracoUrl?self.worker.dracoUrl:T2||He.DRACO_URL}function Mk(){if(Qi()&&self.worker&&self.worker.meshoptUrl)return self.worker.meshoptUrl;if(em)return em;const u=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]);if(typeof WebAssembly!="object")throw new Error("WebAssembly not supported, cannot instantiate meshoptimizer");return em=WebAssembly.validate(u)?He.MESHOPT_SIMD_URL:He.MESHOPT_URL,em}const fb={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},E$={5120:"DT_INT8",5121:"DT_UINT8",5122:"DT_INT16",5123:"DT_UINT16",5125:"DT_UINT32",5126:"DT_FLOAT32"},H_={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16};function Ik(u,n,s){const c=s.json.bufferViews.length,g=s.buffers.length;n.bufferView=c,s.json.bufferViews[c]={buffer:g,byteLength:u.byteLength},s.buffers[g]=u}const E2="KHR_draco_mesh_compression";function M$(u,n){const s=u.extensions&&u.extensions[E2];if(!s)return;const c=new Bl.Decoder,g=Rk(n,s.bufferView),f=new Bl.Mesh;if(!c.DecodeArrayToMesh(g,g.byteLength,f))throw new Error("Failed to decode Draco mesh");const _=n.json.accessors[u.indices],T=fb[_.componentType],A=_.count*T.BYTES_PER_ELEMENT,D=Bl._malloc(A);T===Uint16Array?c.GetTrianglesUInt16Array(f,A,D):c.GetTrianglesUInt32Array(f,A,D),Ik(Bl.memory.buffer.slice(D,D+A),_,n),Bl._free(D);for(const w of Object.keys(s.attributes)){const k=c.GetAttributeByUniqueId(f,s.attributes[w]),O=n.json.accessors[u.attributes[w]],I=E$[O.componentType],R=O.count*H_[O.type]*fb[O.componentType].BYTES_PER_ELEMENT,B=Bl._malloc(R);c.GetAttributeDataArrayForAllPoints(f,k,Bl[I],R,B),Ik(Bl.memory.buffer.slice(B,B+R),O,n),Bl._free(B)}c.destroy(),f.destroy(),delete u.extensions[E2]}const hb="EXT_meshopt_compression";function I$(u,n){if(!u.extensions||!u.extensions[hb])return;const s=u.extensions[hb],c=new Uint8Array(n.buffers[s.buffer],s.byteOffset||0,s.byteLength||0),g=new Uint8Array(s.count*s.byteStride);C2.decodeGltfBuffer(g,s.count,s.byteStride,c,s.mode,s.filter),u.buffer=n.buffers.length,u.byteOffset=0,n.buffers[u.buffer]=g.buffer,delete u.extensions[hb]}const Ak=1179937895,kk=new TextDecoder("utf8");function Pk(u,n){return new URL(u,n).href}function A$(u,n,s,c){return fetch(Pk(u.uri,c)).then(g=>g.arrayBuffer()).then(g=>{n.buffers[s]=g})}function Rk(u,n){const s=u.json.bufferViews[n];return new Uint8Array(u.buffers[s.buffer],s.byteOffset||0,s.byteLength)}function k$(u,n,s,c){if(u.uri){const g=Pk(u.uri,c);return fetch(g).then(f=>f.blob()).then(f=>createImageBitmap(f)).then(f=>{n.images[s]=f})}if(u.bufferView!==void 0){const g=Rk(n,u.bufferView),f=new Blob([g],{type:u.mimeType});return createImageBitmap(f).then(_=>{n.images[s]=_})}}function Ok(u,n=0,s){const c={json:null,images:[],buffers:[]};if(new Uint32Array(u,n,1)[0]===Ak){const w=new Uint32Array(u,n);let k=2;const O=(w[k++]>>2)-3,I=w[k++]>>2;if(k++,c.json=JSON.parse(kk.decode(w.subarray(k,k+I))),k+=I,k<O){const R=w[k++];k++;const B=n+(k<<2);c.buffers[0]=u.slice(B,B+R)}}else c.json=JSON.parse(kk.decode(new Uint8Array(u,n)));const{buffers:g,images:f,meshes:_,extensionsUsed:T,bufferViews:A}=c.json;let D=Promise.resolve();if(g){const w=[];for(let k=0;k<g.length;k++){const O=g[k];O.uri?w.push(A$(O,c,k,s)):c.buffers[k]||(c.buffers[k]=null)}D=Promise.all(w)}return D.then(()=>{const w=[],k=T&&T.includes(E2),O=T&&T.includes(hb);if(k&&w.push(function(){if(!Bl)return j_??(j_=function(I){let R,B=null;function W(){R=new Uint8Array(B.buffer)}function K(){throw new Error("Unexpected Draco error.")}const ie={a:{a:K,d:function(oe,Q,ue){return R.copyWithin(oe,Q,Q+ue)},c:function(oe){const Q=R.length,ue=Math.max(oe>>>0,Math.ceil(1.2*Q)),ge=Math.ceil((ue-Q)/65536);try{return B.grow(ge),W(),!0}catch{return!1}},b:K}};return(WebAssembly.instantiateStreaming?WebAssembly.instantiateStreaming(I,ie):I.then(oe=>oe.arrayBuffer()).then(oe=>WebAssembly.instantiate(oe,ie))).then(oe=>{const{Rb:Q,Qb:ue,P:ge,T:Se,X:Fe,Ja:ze,La:Le,Qa:nt,Va:$e,Wa:it,eb:dt,jb:ct,f:mt,e:wt,yb:Mt,zb:vt,Ab:qt,Bb:mn,Db:Zt,Gb:Tn}=oe.instance.exports;B=wt;const Sn=(()=>{let On=0,nn=0,Yn=0,In=0;return qn=>{Yn&&(Q(In),Q(On),nn+=Yn,Yn=On=0),On||(nn+=128,On=ue(nn));const ar=qn.length+7&-8;let Mr=On;ar>=nn&&(Yn=ar,Mr=In=ue(ar));for(let Pr=0;Pr<qn.length;Pr++)R[Mr+Pr]=qn[Pr];return Mr}})();return W(),mt(),{memory:wt,_free:Q,_malloc:ue,Mesh:class{constructor(){this.ptr=ge()}destroy(){Se(this.ptr)}},Decoder:class{constructor(){this.ptr=ze()}destroy(){ct(this.ptr)}DecodeArrayToMesh(On,nn,Yn){const In=Sn(On),qn=Le(this.ptr,In,nn,Yn.ptr);return!!Fe(qn)}GetAttributeByUniqueId(On,nn){return{ptr:nt(this.ptr,On.ptr,nn)}}GetTrianglesUInt16Array(On,nn,Yn){$e(this.ptr,On.ptr,nn,Yn)}GetTrianglesUInt32Array(On,nn,Yn){it(this.ptr,On.ptr,nn,Yn)}GetAttributeDataArrayForAllPoints(On,nn,Yn,In,qn){dt(this.ptr,On.ptr,nn.ptr,Yn,In,qn)}},DT_INT8:Mt(),DT_UINT8:vt(),DT_INT16:qt(),DT_UINT16:mn(),DT_UINT32:Zt(),DT_FLOAT32:Tn()}})}(fetch(Ek())),j_.then(I=>{Bl=I,j_=void 0}))}()),O&&w.push(function(){if(C2)return;const I=function(R){let B;const W=WebAssembly.instantiateStreaming(R,{}).then(oe=>{B=oe.instance,B.exports.__wasm_call_ctors()}),K={NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},ie={ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"};return{ready:W,supported:!0,decodeGltfBuffer(oe,Q,ue,ge,Se,Fe){(function(ze,Le,nt,$e,it,dt,ct){const mt=ze.exports.sbrk,wt=$e+3&-4,Mt=mt(wt*it),vt=mt(dt.length),qt=new Uint8Array(ze.exports.memory.buffer);qt.set(dt,vt);const mn=Le(Mt,$e,it,vt,dt.length);if(mn===0&&ct&&ct(Mt,wt,it),nt.set(qt.subarray(Mt,Mt+$e*it)),mt(Mt-mt(0)),mn!==0)throw new Error(`Malformed buffer data: ${mn}`)})(B,B.exports[ie[Se]],oe,Q,ue,ge,B.exports[K[Fe]])}}}(fetch(Mk()));return I.ready.then(()=>{C2=I})}()),f)for(let I=0;I<f.length;I++)w.push(k$(f[I],c,I,s));return(w.length?Promise.all(w):Promise.resolve()).then(()=>{if(k&&_)for(const{primitives:I}of _)for(const R of I)M$(R,c);if(O&&_&&A)for(const I of A)I$(I,c);return c})})}function Yf(u,n){const s=u.json.bufferViews[n.bufferView],c=fb[n.componentType];return new c(u.buffers[s.buffer],(n.byteOffset||0)+(s.byteOffset||0),n.count*(s.byteStride&&s.byteStride!==H_[n.type]*c.BYTES_PER_ELEMENT?s.byteStride/c.BYTES_PER_ELEMENT:H_[n.type]))}function M2(u,n,s,c){const g=fb[n.componentType],f=function(w){switch(w){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:return 1}}(g),_=u.json.bufferViews[n.bufferView],T=_.byteStride?_.byteStride/g.BYTES_PER_ELEMENT:H_[n.type],A=s.float32,D=A.length/s.capacity;for(let w=0,k=0;w<n.count*T;w+=T,k+=D)for(let O=0;O<D;O++)A[k+O]=c[w+O]*f;s._trim()}function P$(u,n,s){const c=u.indices,g=u.attributes,f={};f.indexArray=new Uo;const _=n.json.accessors[c],T=_.count/3;f.indexArray.reserve(T);const A=Yf(n,_);for(let O=0;O<T;O++)f.indexArray.emplaceBack(A[3*O],A[3*O+1],A[3*O+2]);f.indexArray._trim(),f.vertexArray=new gu;const D=n.json.accessors[g.POSITION];f.vertexArray.reserve(D.count);const w=Yf(n,D);for(let O=0;O<D.count;O++)f.vertexArray.emplaceBack(w[3*O],w[3*O+1],w[3*O+2]);if(f.vertexArray._trim(),f.aabb=new fr(D.min,D.max),f.centroid=function(O,I){const R=[0,0,0],B=O.length;if(B>0){for(let W=0;W<B;W++){const K=3*O[W];R[0]+=I[K],R[1]+=I[K+1],R[2]+=I[K+2]}R[0]/=B,R[1]/=B,R[2]/=B}return R}(A,w),g.COLOR_0!==void 0){const O=n.json.accessors[g.COLOR_0],I=H_[O.type],R=Yf(n,O);f.colorArray=I===3?new gu:new Al,f.colorArray.resize(O.count),M2(n,O,f.colorArray,R)}if(g.NORMAL!==void 0){f.normalArray=new gu;const O=n.json.accessors[g.NORMAL];f.normalArray.resize(O.count);const I=Yf(n,O);M2(n,O,f.normalArray,I)}if(g.TEXCOORD_0!==void 0&&s.length>0){f.texcoordArray=new kl;const O=n.json.accessors[g.TEXCOORD_0];f.texcoordArray.resize(O.count);const I=Yf(n,O);M2(n,O,f.texcoordArray,I)}if(g._FEATURE_ID_RGBA4444!==void 0){const O=n.json.accessors[g._FEATURE_ID_RGBA4444];n.json.extensionsUsed&&n.json.extensionsUsed.includes("EXT_meshopt_compression")&&(f.featureData=Yf(n,O))}g._FEATURE_RGBA4444!==void 0&&(f.featureData=new Uint32Array(Yf(n,n.json.accessors[g._FEATURE_RGBA4444]).buffer));const k=u.material;return f.material=function(O,I){const{emissiveFactor:R=[0,0,0],alphaMode:B="OPAQUE",alphaCutoff:W=.5,normalTexture:K,occlusionTexture:ie,emissiveTexture:oe,doubleSided:Q}=O,{baseColorFactor:ue=[1,1,1,1],metallicFactor:ge=1,roughnessFactor:Se=1,baseColorTexture:Fe,metallicRoughnessTexture:ze}=O.pbrMetallicRoughness||{},Le=ie?I[ie.index]:void 0;if(ie&&ie.extensions&&ie.extensions.KHR_texture_transform&&Le){const nt=ie.extensions.KHR_texture_transform;Le.offsetScale=[nt.offset[0],nt.offset[1],nt.scale[0],nt.scale[1]]}return{pbrMetallicRoughness:{baseColorFactor:new Jr(...ue),metallicFactor:ge,roughnessFactor:Se,baseColorTexture:Fe?I[Fe.index]:void 0,metallicRoughnessTexture:ze?I[ze.index]:void 0},doubleSided:Q,emissiveFactor:R,alphaMode:B,alphaCutoff:W,normalTexture:K?I[K.index]:void 0,occlusionTexture:Le,emissionTexture:oe?I[oe.index]:void 0,defined:O.defined===void 0}}(k!==void 0?n.json.materials[k]:{defined:!1},s),f}function Lk(u,n,s){const{matrix:c,rotation:g,translation:f,scale:_,mesh:T,extras:A,children:D}=u,w={};if(w.matrix=c||Ne.mat4.fromRotationTranslationScale([],g||[0,0,0,1],f||[0,0,0],_||[1,1,1]),T!==void 0){w.meshes=s[T];const k=w.anchor=[0,0];for(const O of w.meshes){const{min:I,max:R}=O.aabb;k[0]+=I[0]+R[0],k[1]+=I[1]+R[1]}k[0]=Math.floor(k[0]/w.meshes.length/2),k[1]=Math.floor(k[1]/w.meshes.length/2)}if(A&&(A.id&&(w.id=A.id),A.lights&&(w.lights=function(k){if(!k.length)return[];const O=function(K){const ie=atob(K),oe=new Uint8Array(ie.length);for(let Q=0;Q<ie.length;Q++)oe[Q]=ie.codePointAt(Q);return oe}(k),I=[],R=O.length/24,B=new Uint16Array(O.buffer),W=new Float32Array(O.buffer);for(let K=0;K<R;K++){const ie=B[2*K*6]/30,oe=B[2*K*6+1]/30,Q=B[2*K*6+10]/100,ue=W[6*K+1],ge=W[6*K+2],Se=W[6*K+3],Fe=W[6*K+4],ze=Se-ue,Le=Fe-ge,nt=Math.hypot(ze,Le);I.push({pos:[ue+.5*ze,ge+.5*Le,oe],normal:[Le/nt,-ze/nt,0],width:nt,height:ie,depth:Q,points:[ue,ge,Se,Fe]})}return I}(A.lights))),D){const k=[];for(const O of D)k.push(Lk(n.json.nodes[O],n,s));w.children=k}return w}function R$(u){if(u.vertices.length===0||u.indices.length===0)return null;const n=new Aw(u.vertices,u.indices,8,256),[s,c]=[n.min.clone(),n.max.clone()];return{vertices:u.vertices,indices:u.indices,grid:n,min:s,max:c}}function O$(u){if(!u.extras||!u.extras.ground)return null;const n=u.extras.ground;if(!n||!Array.isArray(n)||n.length===0)return null;const s=n[0];if(!s||!Array.isArray(s)||s.length===0)return null;const c=[];for(const _ of s){if(!Array.isArray(_)||_.length!==2)continue;const T=_[0],A=_[1];typeof T=="number"&&typeof A=="number"&&c.push(new Je(T,A))}if(c.length<3)return null;c.length>1&&c[c.length-1].equals(c[0])&&c.pop();let g=0;for(let _=0;_<c.length;_++){const T=c[_],A=c[(_+1)%c.length],D=c[(_+2)%c.length];g+=(T.x-A.x)*(D.y-A.y)-(D.x-A.x)*(T.y-A.y)}g>0&&c.reverse();const f=g_(c.flatMap(_=>[_.x,_.y]),[]);return f.length===0?null:{vertices:c,indices:f}}function L$(u,n){const s=[],c=[];let g=0;const f=[];for(const _ of u){g=s.length;const T=_.vertexArray.float32,A=_.indexArray.uint16;for(let D=0;D<_.vertexArray.length;D++)f[0]=T[3*D+0],f[1]=T[3*D+1],f[2]=T[3*D+2],Ne.vec3.transformMat4(f,f,n),s.push(new Je(f[0],f[1]));for(let D=0;D<3*_.indexArray.length;D++)c.push(A[D]+g)}if(c.length%3!=0)return null;for(let _=0;_<c.length;_+=3){const T=s[c[_+0]],A=s[c[_+1]],D=s[c[_+2]];(T.x-A.x)*(D.y-A.y)-(D.x-A.x)*(T.y-A.y)>0&&([c[_+1],c[_+2]]=[c[_+2],c[_+1]])}return{vertices:s,indices:c}}function Dk(u){const n=function(A,D){const w=[],k=WebGL2RenderingContext;if(A.json.textures)for(const O of A.json.textures){const I={magFilter:k.LINEAR,minFilter:k.NEAREST,wrapS:k.REPEAT,wrapT:k.REPEAT};O.sampler!==void 0&&Object.assign(I,A.json.samplers[O.sampler]),w.push({image:D[O.source],sampler:I,uploaded:!1})}return w}(u,u.images),s=function(A,D){const w=[];for(const k of A.json.meshes){const O=[];for(const I of k.primitives)O.push(P$(I,A,D));w.push(O)}return w}(u,n),{scenes:c,scene:g,nodes:f}=u.json,_=c?c[g||0].nodes:f,T=[];for(const A of _)T.push(Lk(f[A],u,s));return function(A,D,w){const k={},O=new Set;for(let I=0;I<A.length;I++){const R=w[D[I]];if(!R.extras)continue;const B=R.extras["mapbox:footprint:version"],W=R.extras["mapbox:footprint:id"];(B||W)&&O.add(I),B==="1.0.0"&&W&&(k[W]=I)}for(let I=0;I<A.length;I++){if(O.has(I))continue;const R=A[I],B=w[D[I]];if(!B.extras)continue;let W=null;R.id in k&&(W=L$(A[k[R.id]].meshes,R.matrix)),W||(W=O$(B)),W&&(R.footprint=R$(W))}if(O.size>0){const I=Array.from(O.values()).sort((R,B)=>R-B);for(let R=I.length-1;R>=0;R--)A.splice(I[R],1)}}(T,_,u.json.nodes),T}function D$(u){u.heightmap=new Float32Array(4096),u.heightmap.fill(-1);const n=u.vertexArray.float32,s=u.aabb.min[0]-1,c=u.aabb.min[1]-1,g=qf/(u.aabb.max[0]-s+2),f=qf/(u.aabb.max[1]-c+2);for(let _=0;_<n.length;_+=3){const T=n[_+2],A=(n[_+0]-s)*g|0,D=(n[_+1]-c)*f|0;T>u.heightmap[D*qf+A]&&(u.heightmap[D*qf+A]=T)}}function z$(u,n){const s={};s.indexArray=new Uo,s.indexArray.reserve(4*u.length),s.vertexArray=new gu,s.vertexArray.reserve(10*u.length),s.colorArray=new Al,s.vertexArray.reserve(10*u.length);let c=0;for(const _ of u){const T=Math.min(10,Math.max(4,1.3*_.height))*n,A=[-_.normal[1],_.normal[0],0],D=Math.min(.29,.1*_.width/_.depth),w=_.width-2*_.depth*n*(D+.01),k=Ne.vec3.scaleAndAdd([],_.pos,A,w/2),O=Ne.vec3.scaleAndAdd([],_.pos,A,-w/2),I=[k[0],k[1],k[2]+_.height],R=[O[0],O[1],O[2]+_.height],B=Ne.vec3.scaleAndAdd([],_.normal,A,D);Ne.vec3.scale(B,B,T);const W=Ne.vec3.scaleAndAdd([],_.normal,A,-D);Ne.vec3.scale(W,W,T),Ne.vec3.add(B,k,B),Ne.vec3.add(W,O,W),k[2]+=.1,O[2]+=.1,s.vertexArray.emplaceBack(B[0],B[1],B[2]),s.vertexArray.emplaceBack(W[0],W[1],W[2]),s.vertexArray.emplaceBack(k[0],k[1],k[2]),s.vertexArray.emplaceBack(O[0],O[1],O[2]),s.vertexArray.emplaceBack(I[0],I[1],I[2]),s.vertexArray.emplaceBack(R[0],R[1],R[2]),s.vertexArray.emplaceBack(k[0],k[1],k[2]),s.vertexArray.emplaceBack(O[0],O[1],O[2]),s.vertexArray.emplaceBack(B[0],B[1],B[2]),s.vertexArray.emplaceBack(W[0],W[1],W[2]);const K=w/T/2;s.colorArray.emplaceBack(-K-D,-1,K,.8),s.colorArray.emplaceBack(K+D,-1,K,.8),s.colorArray.emplaceBack(-K,0,K,1.3),s.colorArray.emplaceBack(K,0,K,1.3),s.colorArray.emplaceBack(K+D,-.8,K,.7),s.colorArray.emplaceBack(K+D,-.8,K,.7),s.colorArray.emplaceBack(0,0,K,1.3),s.colorArray.emplaceBack(0,0,K,1.3),s.colorArray.emplaceBack(K+D,-1.2,K,.8),s.colorArray.emplaceBack(K+D,-1.2,K,.8),s.indexArray.emplaceBack(6+c,4+c,8+c),s.indexArray.emplaceBack(7+c,9+c,5+c),s.indexArray.emplaceBack(0+c,1+c,2+c),s.indexArray.emplaceBack(1+c,3+c,2+c),c+=10}const g={defined:!0,emissiveFactor:[0,0,0]},f={};return f.baseColorFactor=Jr.white,g.pbrMetallicRoughness=f,s.material=g,s.aabb=new fr([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),s}class zk{constructor(n){this._stringToNumber={},this._numberToString=[];for(let s=0;s<n.length;s++){const c=n[s];this._stringToNumber[c]=s,this._numberToString[s]=c}}encode(n){return this._stringToNumber[n]}decode(n){return this._numberToString[n]}}const F$=["id","tile","layer","source","sourceLayer","state"];class nm{constructor(n,s,c,g,f){this.type="Feature",this._vectorTileFeature=n,this._z=s,this._x=c,this._y=g,this.properties=n.properties,this.id=f}clone(){const n=new nm(this._vectorTileFeature,this._z,this._x,this._y,this.id);return this.state&&(n.state={...this.state}),this.layer&&(n.layer={...this.layer}),this.source&&(n.source=this.source),this.sourceLayer&&(n.sourceLayer=this.sourceLayer),n}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(n){this._geometry=n}toJSON(){const n={type:"Feature",state:void 0,geometry:this.geometry,properties:this.properties};for(const s of F$)this[s]!==void 0&&(n[s]=this[s]);return n}}class Fk{constructor(n,s){this.tileID=n,this.x=n.canonical.x,this.y=n.canonical.y,this.z=n.canonical.z,this.grid=new ic(kn,16,0),this.featureIndexArray=new g0,this.promoteId=s,this.is3DTile=!1,this.serializedLayersCache=new Map}insert(n,s,c,g,f,_=0,T=0){const A=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(c,g,f,_);const D=this.grid;for(let w=0;w<s.length;w++){const k=s[w],O=[1/0,1/0,-1/0,-1/0];for(let I=0;I<k.length;I++){const R=k[I];O[0]=Math.min(O[0],R.x),O[1]=Math.min(O[1],R.y),O[2]=Math.max(O[2],R.x),O[3]=Math.max(O[3],R.y)}T!==0&&(O[0]-=T,O[1]-=T,O[2]+=T,O[3]+=T),O[0]<kn&&O[1]<kn&&O[2]>=0&&O[3]>=0&&D.insert(A,O[0],O[1],O[2],O[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new Up.VectorTile(new z0(this.rawTileData)).layers,this.sourceLayerCoder=new zk(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const n in this.vtLayers)this.vtFeatures[n]=[]}return this.vtLayers}query(n,s){const{tilespaceGeometry:c,transform:g,tileTransform:f,pixelPosMatrix:_,availableImages:T}=s;this.loadVTLayers(),this.serializedLayersCache.clear();const A=c.bufferedTilespaceBounds,D=this.grid.query(A.min.x,A.min.y,A.max.x,A.max.y,(I,R,B,W)=>Vt(c.bufferedTilespaceGeometry,I,R,B,W));D.sort(N$);let w=null;g.elevation&&D.length>0&&(w=Zp.create(g.elevation,this.tileID));const k={};let O;for(let I=0;I<D.length;I++){const R=D[I];if(R===O)continue;O=R;const B=this.featureIndexArray.get(R);let W=null;this.is3DTile?this.loadMatchingModelFeature(k,B,n,c,g):this.loadMatchingFeature(k,B,n,T,(K,ie,oe,Q=0)=>(W||(W=Y(K,this.tileID.canonical,f)),ie.queryIntersectsFeature(c,K,oe,W,this.z,g,_,w,Q)))}return k}loadMatchingFeature(n,s,c,g,f){const{featureIndex:_,bucketIndex:T,sourceLayerIndex:A,layoutVertexArrayOffset:D}=s,w=this.bucketLayerIDs[T],k=c.layers,O=Object.keys(k);if(O.length&&!function(K,ie){for(let oe=0;oe<K.length;oe++)if(ie.indexOf(K[oe])>=0)return!0;return!1}(O,w))return;const I=c.sourceCache,R=this.sourceLayerCoder.decode(A),B=this.vtLayers[R].feature(_),W=this.getId(B,R);for(let K=0;K<w.length;K++){const ie=w[K];if(!k[ie])continue;const{styleLayer:oe,targets:Q}=k[ie];let ue={};W!==void 0&&(ue=I.getFeatureState(oe.sourceLayer,W));const ge=!f||f(B,oe,ue,D);if(!ge)continue;const Se=new nm(B,this.z,this.x,this.y,W);Se.tile=this.tileID.canonical,Se.state=ue;let Fe=this.serializedLayersCache.get(ie);Fe||(Fe=oe.serialize(),Fe.id=ie,this.serializedLayersCache.set(ie,Fe)),Se.source=Fe.source,Se.sourceLayer=Fe["source-layer"],Se.layer=er({},Fe),Se.layer.paint=Nk(Fe.paint,oe.paint,B,ue,g),Se.layer.layout=Nk(Fe.layout,oe.layout,B,ue,g);let ze=!1;for(const Le of Q){this.updateFeatureProperties(Se,Le);const{filter:nt}=Le;if(nt){if(B.properties=Se.properties,nt.needGeometry){const $e=ne(B,!0);if(!nt.filter(new ji(this.tileID.overscaledZ),$e,this.tileID.canonical))continue}else if(!nt.filter(new ji(this.tileID.overscaledZ),B))continue}ze=!0,Le.targetId&&this.addFeatureVariant(Se,Le)}ze&&this.appendToResult(n,ie,_,Se,ge)}}loadMatchingModelFeature(n,s,c,g,f){const _=this.bucketLayerIDs[0][0],T=c.layers;if(!T[_])return;const{styleLayer:A,targets:D}=T[_];if(A.type!=="model")return;const w=g.tile,k=s.featureIndex,O=w.getBucket(A);if(!(O&&O instanceof ib))return;const I=function(Fe,ze,Le,nt){const $e=Fe.getNodesInfo()[ze];if($e.hiddenByReplacement||!$e.node.meshes)return;let it=Number.MAX_VALUE;const dt=$e.node,ct=Le.tile,mt=nt.calculatePosMatrix(ct.tileID.toUnwrapped(),nt.worldSize),wt=$e.evaluatedScale;let Mt=0;nt.elevation&&dt.elevation&&(Mt=dt.elevation*nt.elevation.exaggeration()),Ne.mat4.translate(mt,mt,[(dt.anchor?dt.anchor[0]:0)*(wt[0]-1),(dt.anchor?dt.anchor[1]:0)*(wt[1]-1),Mt]),Ne.mat4.scale(mt,mt,wt);const vt=Le.queryGeometry,qt=vt.isPointQuery()?vt.screenBounds:vt.screenGeometry,mn=function(Tn){const Sn=Ne.mat4.multiply([],mt,Tn.matrix);Ne.mat4.multiply(Sn,nt.expandedFarZProjMatrix,Sn);for(let On=0;On<Tn.meshes.length;++On){const nn=Tn.meshes[On];if(On===Tn.lightMeshIndex)continue;const Yn=NA(qt,nt,Sn,nn.aabb);Yn!=null&&(it=Math.min(Yn,it))}if(Tn.children)for(const On of Tn.children)mn(On)};if(mn(dt),it===Number.MAX_VALUE)return;const Zt=new Qr(0,0);return YA(ct.tileID.canonical,Zt,$e.node.anchor[0],$e.node.anchor[1]),{intersectionZ:it,position:Zt,feature:$e.feature}}(O,k,g,f);if(!I)return;const{z:R,x:B,y:W}=w.tileID.canonical,{feature:K,intersectionZ:ie,position:oe}=I;let Q={};K.id!==void 0&&(Q=c.sourceCache.getFeatureState(A.sourceLayer,K.id));const ue=new nm({},R,B,W,K.id);ue.tile=this.tileID.canonical,ue.state=Q,ue.properties=K.properties,ue.geometry={type:"Point",coordinates:[oe.lng,oe.lat]};let ge=this.serializedLayersCache.get(_);ge||(ge=A.serialize(),ge.id=_,this.serializedLayersCache.set(_,ge)),ue.source=ge.source,ue.sourceLayer=ge["source-layer"],ue.layer=er({},ge);let Se=!1;for(const Fe of D){this.updateFeatureProperties(ue,Fe);const{filter:ze}=Fe;if(ze){if(K.properties=ue.properties,ze.needGeometry){if(!ze.filter(new ji(this.tileID.overscaledZ),K,this.tileID.canonical))continue}else if(!ze.filter(new ji(this.tileID.overscaledZ),K))continue}Se=!0,Fe.targetId&&this.addFeatureVariant(ue,Fe)}Se&&this.appendToResult(n,_,k,ue,ie)}updateFeatureProperties(n,s,c){if(s.properties){const g={};for(const f in s.properties){const _=s.properties[f].evaluate({zoom:this.z},n._vectorTileFeature,n.state,n.tile,c);_!=null&&(g[f]=_)}n.properties=g}}addFeatureVariant(n,s,c){const g={target:s.target,namespace:s.namespace};s.properties&&(g.properties=n.properties),n.variants=n.variants||{},n.variants[s.targetId]=n.variants[s.targetId]||[],n.variants[s.targetId].push(g)}appendToResult(n,s,c,g,f){let _=n[s];_===void 0&&(_=n[s]=[]),_.push({featureIndex:c,feature:g,intersectionZ:f})}lookupSymbolFeatures(n,s,c,g,f){const _={};this.loadVTLayers();for(const T of n)this.loadMatchingFeature(_,{bucketIndex:s,sourceLayerIndex:c,featureIndex:T,layoutVertexArrayOffset:0},g,f);return _}loadFeature(n){const{featureIndex:s,sourceLayerIndex:c}=n;this.loadVTLayers();const g=this.sourceLayerCoder.decode(c),f=this.vtFeatures[g];if(f[s])return f[s];const _=this.vtLayers[g].feature(s);return f[s]=_,_}hasLayer(n){for(const s of this.bucketLayerIDs)for(const c of s)if(n===c)return!0;return!1}getId(n,s){let c=n.id;if(this.promoteId){const g=typeof this.promoteId=="string"?this.promoteId:this.promoteId[s];g!=null&&(c=n.properties[g]),typeof c=="boolean"&&(c=Number(c))}return c}}function Nk(u,n,s,c,g){return st(u,(f,_)=>{const T=n instanceof sd?n.get(_):null;return T&&T.evaluate?T.evaluate(s,c,g):T})}function N$(u,n){return n-u}Gn(Fk,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});const Bk=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class I2{static from(n){if(!(n instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[s,c]=new Uint8Array(n,0,2);if(s!==219)throw new Error("Data does not appear to be in a KDBush format.");const g=c>>4;if(g!==1)throw new Error(`Got v${g} data when expected v1.`);const f=Bk[15&c];if(!f)throw new Error("Unrecognized array type.");const[_]=new Uint16Array(n,2,1),[T]=new Uint32Array(n,4,1);return new I2(T,_,f,n)}constructor(n,s=64,c=Float64Array,g){if(isNaN(n)||n<0)throw new Error(`Unpexpected numItems value: ${n}.`);this.numItems=+n,this.nodeSize=Math.min(Math.max(+s,2),65535),this.ArrayType=c,this.IndexArrayType=n<65536?Uint16Array:Uint32Array;const f=Bk.indexOf(this.ArrayType),_=2*n*this.ArrayType.BYTES_PER_ELEMENT,T=n*this.IndexArrayType.BYTES_PER_ELEMENT,A=(8-T%8)%8;if(f<0)throw new Error(`Unexpected typed array class: ${c}.`);g&&g instanceof ArrayBuffer?(this.data=g,this.ids=new this.IndexArrayType(this.data,8,n),this.coords=new this.ArrayType(this.data,8+T+A,2*n),this._pos=2*n,this._finished=!0):(this.data=new ArrayBuffer(8+_+T+A),this.ids=new this.IndexArrayType(this.data,8,n),this.coords=new this.ArrayType(this.data,8+T+A,2*n),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+f]),new Uint16Array(this.data,2,1)[0]=s,new Uint32Array(this.data,4,1)[0]=n)}add(n,s){const c=this._pos>>1;return this.ids[c]=c,this.coords[this._pos++]=n,this.coords[this._pos++]=s,c}finish(){const n=this._pos>>1;if(n!==this.numItems)throw new Error(`Added ${n} items when expected ${this.numItems}.`);return A2(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(n,s,c,g){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:f,coords:_,nodeSize:T}=this,A=[0,f.length-1,0],D=[];for(;A.length;){const w=A.pop()||0,k=A.pop()||0,O=A.pop()||0;if(k-O<=T){for(let W=O;W<=k;W++){const K=_[2*W],ie=_[2*W+1];K>=n&&K<=c&&ie>=s&&ie<=g&&D.push(f[W])}continue}const I=O+k>>1,R=_[2*I],B=_[2*I+1];R>=n&&R<=c&&B>=s&&B<=g&&D.push(f[I]),(w===0?n<=R:s<=B)&&(A.push(O),A.push(I-1),A.push(1-w)),(w===0?c>=R:g>=B)&&(A.push(I+1),A.push(k),A.push(1-w))}return D}within(n,s,c){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:g,coords:f,nodeSize:_}=this,T=[0,g.length-1,0],A=[],D=c*c;for(;T.length;){const w=T.pop()||0,k=T.pop()||0,O=T.pop()||0;if(k-O<=_){for(let W=O;W<=k;W++)$k(f[2*W],f[2*W+1],n,s)<=D&&A.push(g[W]);continue}const I=O+k>>1,R=f[2*I],B=f[2*I+1];$k(R,B,n,s)<=D&&A.push(g[I]),(w===0?n-c<=R:s-c<=B)&&(T.push(O),T.push(I-1),T.push(1-w)),(w===0?n+c>=R:s+c>=B)&&(T.push(I+1),T.push(k),T.push(1-w))}return A}}function A2(u,n,s,c,g,f){if(g-c<=s)return;const _=c+g>>1;Vk(u,n,_,c,g,f),A2(u,n,s,c,_-1,1-f),A2(u,n,s,_+1,g,1-f)}function Vk(u,n,s,c,g,f){for(;g>c;){if(g-c>600){const D=g-c+1,w=s-c+1,k=Math.log(D),O=.5*Math.exp(2*k/3),I=.5*Math.sqrt(k*O*(D-O)/D)*(w-D/2<0?-1:1);Vk(u,n,s,Math.max(c,Math.floor(s-w*O/D+I)),Math.min(g,Math.floor(s+(D-w)*O/D+I)),f)}const _=n[2*s+f];let T=c,A=g;for(G_(u,n,c,s),n[2*g+f]>_&&G_(u,n,c,g);T<A;){for(G_(u,n,T,A),T++,A--;n[2*T+f]<_;)T++;for(;n[2*A+f]>_;)A--}n[2*c+f]===_?G_(u,n,c,A):(A++,G_(u,n,A,g)),A<=s&&(c=A+1),s<=A&&(g=A-1)}}function G_(u,n,s,c){k2(u,s,c),k2(n,2*s,2*c),k2(n,2*s+1,2*c+1)}function k2(u,n,s){const c=u[n];u[n]=u[s],u[s]=c}function $k(u,n,s,c){const g=u-s,f=n-c;return g*g+f*f}r.$=Gg,r.A=Lo,r.B=2,r.C=tA,r.D=Yp,r.E=$c,r.F=qw,r.G=class extends nb{},r.H=ec,r.I=v2,r.J=$h,r.K=i0,r.L=cp,r.M=td,r.N=Gv,r.O=Vg,r.P=Je,r.Q=Sp,r.R=_l,r.S=Zv,r.T=o2,r.U=Af,r.V=nb,r.W=nc,r.X=Ml,r.Y=Xc,r.Z=Ts,r._=Vh,r.a=function(u){return He.API_CDN_URL_REGEX.test(u)},r.a$=nm,r.a0=dp,r.a1=Hv,r.a2=function(u){const n=u.value;let s=[];if(!n)return s;const c=ec(n);return c!=="string"?(s=s.concat([new nb(u.key,n,`string expected, "${c}" found`)]),s):(VA(n,!0)||(s=s.concat([new nb(u.key,n,`invalid url "${n}"`)])),s)},r.a3=Ot,r.a4=lc,r.a5=Zi,r.a6=_n,r.a7=class{constructor(u){this.specification=u}possiblyEvaluate(u,n){return xi(u.expression.evaluate(n))}interpolate(u,n,s){return{x:pr(u.x,n.x,s),y:pr(u.y,n.y,s),z:pr(u.z,n.z,s),azimuthal:pr(u.azimuthal,n.azimuthal,s),polar:pr(u.polar,n.polar,s)}}},r.a8=ji,r.a9=nd,r.aA=Rl,r.aB=class{constructor(u){this.entries={},this.scheduler=u}request(u,n,s,c){const g=this.entries[u]=this.entries[u]||{callbacks:[]};if(g.result){const[f,_]=g.result;return this.scheduler?this.scheduler.add(()=>{c(f,_)},n):c(f,_),()=>{}}return g.callbacks.push(c),g.cancel||(g.cancel=s((f,_)=>{g.result=[f,_];for(const T of g.callbacks)this.scheduler?this.scheduler.add(()=>{T(f,_)},n):T(f,_);setTimeout(()=>delete this.entries[u],3e3)})),()=>{g.result||(g.callbacks=g.callbacks.filter(f=>f!==c),g.callbacks.length||(g.cancel(),delete this.entries[u]))}}},r.aC=ds,r.aD=function(u,n,s){const c=JSON.stringify(u.request);return u.data&&(this.deduped.entries[c]={result:[null,u.data]}),this.deduped.request(c,{type:"parseTile",isSymbolTile:u.isSymbolTile,zoom:u.tileZoom},g=>{const f=Zu(u.request,(_,T,A,D)=>{_?g(_):T&&g(null,{vectorTile:s?void 0:new Up.VectorTile(new z0(T)),rawData:T,cacheControl:A,expires:D})});return()=>{f.cancel(),g()}},n)},r.aE=function(u){di++,di>cr&&(u.getActor().send("enforceCacheSizeLimit",ur),di=0)},r.aF=function(u){return u<=1?1:Math.pow(2,Math.floor(Math.log(u)/Math.LN2))},r.aG=An,r.aH=MA,r.aI=OA,r.aJ=EA,r.aK=function(u,n){const s=document.createElement("video");s.muted=!0,s.onloadstart=function(){n(null,s)};for(let c=0;c<u.length;c++){const g=document.createElement("source");hg(u[c])||(s.crossOrigin="Anonymous"),g.src=u[c],s.appendChild(g)}return{cancel:()=>{}}},r.aL=X0,r.aM=function(u){return fetch(u).then(n=>n.arrayBuffer()).then(n=>Ok(n,0,u))},r.aN=Dk,r.aO=class{constructor(u,n,s,c){this.id=u,this.position=n!=null?new Qr(n[0],n[1]):new Qr(0,0),this.orientation=s??[0,0,0],this.nodes=c,this.uploaded=!1,this.aabb=new fr([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),this.matrix=[]}_applyTransformations(u,n){if(Ne.mat4.multiply(u.matrix,n,u.matrix),u.meshes)for(const s of u.meshes){const c=fr.applyTransformFast(s.aabb,u.matrix);this.aabb.encapsulate(c)}if(u.children)for(const s of u.children)this._applyTransformations(s,u.matrix)}computeBoundsAndApplyParent(){const u=Ne.mat4.identity([]);for(const n of this.nodes)this._applyTransformations(n,u)}computeModelMatrix(u,n,s,c,g,f,_=!1){GA(this.matrix,this,u.transform,this.position,n,s,c,g,f,_)}upload(u){if(!this.uploaded){for(const n of this.nodes)c2(n,u);for(const n of this.nodes)rb(n);this.uploaded=!0}}destroy(){for(const u of this.nodes)d2(u)}},r.aP=ui,r.aQ=A_,r.aR=ks,r.aS=Fo,r.aT=fd,r.aU=Uo,r.aV=Ar,r.aW=f0,r.aX=Z0,r.aY=function(){Is.isLoading()||Is.isLoaded()||Hg()!=="deferred"||t0()},r.aZ=o0,r.a_=ne,r.aa=v,r.ab=Ne,r.ac=En,r.ad=sd,r.ae=Yo,r.af=pr,r.ag=kn,r.ah=gg,r.ai=Pt,r.aj=Jr,r.ak=class{constructor(u){this.specification=u}possiblyEvaluate(u,n){return function([s,c]){const g=xi([1,s,c]);return{x:g.x,y:g.y,z:g.z}}(u.expression.evaluate(n))}interpolate(u,n,s){return{x:pr(u.x,n.x,s),y:pr(u.y,n.y,s),z:pr(u.z,n.z,s)}}},r.al=function(u,n,s=0,c=!0){const g=new Je(s,s),f=u.sub(g),_=n.add(g),T=[f,new Je(_.x,f.y),_,new Je(f.x,_.y)];return c&&T.push(f.clone()),T},r.am=function(u,n){const s=[];for(let c=0;c<u.length;c++){const g=Xn(c-1,-1,u.length-1),f=Xn(c+1,-1,u.length-1),_=u[c],T=u[f],A=u[g].sub(_).unit(),D=T.sub(_).unit(),w=D.angleWithSep(A.x,A.y),k=A.add(D).unit().mult(-1*n/Math.sin(w/2));s.push(_.add(k))}return s},r.an=fA,r.ao=Vt,r.ap=function(u,n,s=0){return Ne.vec3.fromValues(((n.x-s)*u.scale-u.x)*kn,(n.y*u.scale-u.y)*kn,h_(n.z,n.y))},r.aq=Or,r.ar=PI,r.as=function(u){let n=1/0,s=1/0,c=-1/0,g=-1/0;for(const f of u)n=Math.min(n,f.x),s=Math.min(s,f.y),c=Math.max(c,f.x),g=Math.max(g,f.y);return{min:new Je(n,s),max:new Je(c,g)}},r.at=Su,r.au=pt,r.av=E,r.aw=Et,r.ax=Ko,r.ay=function(u,n){const s={};for(let c=0;c<n.length;c++){const g=n[c];g in u&&(s[g]=u[g])}return s},r.az=wu,r.b=function(u){return He.API_FONTS_REGEX.test(u)},r.b$=eb,r.b0=ci,r.b1=Nw,r.b2=Iw,r.b3=Y,r.b4=Il,r.b5=r_,r.b6=Gr,r.b7=Yi,r.b8=g_,r.b9=n2,r.bA=uI,r.bB=Yw,r.bC=lA,r.bD=Ww,r.bE=I2,r.bF=Xn,r.bG=pi,r.bH=os,r.bI=function(u,n,s){u[4*n+0]=s[0],u[4*n+1]=s[1],u[4*n+2]=s[2],u[4*n+3]=s[3]},r.bJ=$f,r.bK=Ja,r.bL=Lp,r.bM=no,r.bN=uc,r.bO=Qr,r.bP=_A,r.bQ=Dn,r.bR=Kr,r.bS=DA,r.bT=Rn,r.bU=Ni,r.bV=function(u,n,s,c,g,f,_,T,A){if(A.name==="globe")return Ni(u,n,new Rn(s,c,g),!1);const D=A_({z:s,x:c,y:g},A);return new fr([(f+D.x/D.scale)*n,n*(D.y/D.scale),_],[(f+D.x2/D.scale)*n,n*(D.y2/D.scale),T])},r.bW=function(u,n,s){let c=0;for(let g=0;g<2;++g)u[g]>0&&(c+=(u[g]-0)*(u[g]-0)),n[g]<0&&(c+=(0-n[g])*(0-n[g]));return c},r.bX=Ps,r.bY=u_,r.bZ=function(u){const n=Ne.mat4.identity(new Float64Array(16));Ne.mat4.multiply(n,u.pixelMatrix,u.globeMatrix);const s=[0,ma,0],c=[0,ga,0];return Ne.vec3.transformMat4(s,s,n),Ne.vec3.transformMat4(c,c,n),[s[0]>0&&s[0]<=u.width&&s[1]>0&&s[1]<=u.height&&!Ll(u,new Qr(u.center.lat,90)),c[0]>0&&c[0]<=u.width&&c[1]>0&&c[1]<=u.height&&!Ll(u,new Qr(u.center.lat,-90))]},r.b_=function(u,n){const{scale:s}=u.tileTransform,c=s*kn/(u.tileSize*Math.pow(2,n.zoom-u.tileID.overscaledZ+u.tileID.canonical.z));return Ne.mat2.scale(new Float32Array(4),n.inverseAdjustmentMatrix,[c,c])},r.ba=function(u,n){const s=Yo(n.zoom);if(s===0)return Io(u);const c=Ci(u),g=Zr(c),f=Su(c.getWest())*n.worldSize,_=Su(c.getEast())*n.worldSize,T=Rl(c.getNorth())*n.worldSize,A=Rl(c.getSouth())*n.worldSize,D=[f,T,0],w=[_,T,0],k=[f,A,0],O=[_,A,0],I=Ne.mat4.invert([],n.globeMatrix);return Ne.vec3.transformMat4(D,D,I),Ne.vec3.transformMat4(w,w,I),Ne.vec3.transformMat4(k,k,I),Ne.vec3.transformMat4(O,O,I),g[0]=ho(g[0],k,s),g[1]=ho(g[1],O,s),g[2]=ho(g[2],w,s),g[3]=ho(g[3],D,s),fr.fromPoints(g)},r.bb=jo,r.bc=Xi,r.bd=ho,r.be=dd,r.bf=wr,r.bg=S2,r.bh=z0,r.bi=Zu,r.bj=function(u){const n=[];for(const s in u)n.push(u[s]);return n},r.bk=function(u,n){const s=[];for(const c in u)c in n||s.push(c);return s},r.bl=vr,r.bm=["type","source","source-layer","minzoom","maxzoom","filter","layout"],r.bn=Jt,r.bo=function(u,n){const{x:s,y:c}=u.point,g=Qa(s,c,u.worldSize/u._pixelsPerMercatorPixel,0,0);return Ne.mat4.multiply(g,g,js(Io(n)))},r.bp=jp,r.bq=Fa,r.br=D0,r.bs=function(u,n,s,c,g){const f=5*n+2;u.float32[f+0]=s,u.float32[f+1]=c,u.float32[f+2]=g},r.bt=K0,r.bu=eA,r.bv=Ce,r.bw=Xo,r.bx=rI,r.by=BA,r.bz=lI,r.c=ft,r.c$=(u,n,s,c,g,f,_,T)=>{const A=u.transform,D=A.pitch<15?RI(.07,.7,Et((14-A.zoom)/5,0,1)):.07,w=s.paint.get("line-trim-color-use-theme").constantOr("default")==="none";return{u_matrix:LI(u,n,s,c),u_texsize:n.imageAtlasTexture?n.imageAtlasTexture.size:[0,0],u_pixels_to_tile_units:A.calculatePixelsToTileUnitsMatrix(n),u_device_pixel_ratio:g,u_width_scale:f,u_floor_width_scale:_,u_image:0,u_tile_units_to_pixels:OI(n,A),u_units_to_pixels:[1/A.pixelsToGLUnits[0],1/A.pixelsToGLUnits[1]],u_alpha_discard_threshold:0,u_trim_offset:T,u_trim_fade_range:s.paint.get("line-trim-fade-range"),u_trim_color:s.paint.get("line-trim-color").toRenderColor(w?null:s.lut).toArray01(),u_emissive_strength:s.paint.get("line-emissive-strength"),u_zbias_factor:D,u_tile_to_meter:m(n.tileID.canonical,0)}},r.c0=LA,r.c1=function(u){const n=LA(u,!0);return Ne.mat2.invert([],[n[0],n[1],n[4],n[5]])},r.c2=Ui,r.c3=function(u){const{x:n,y:s}=u.point,{lng:c,lat:g}=u._center;return Qa(n,s,u.worldSize,c,g)},r.c4=Dt,r.c5=Bn,r.c6=l_,r.c7=function(u){const n=Math.round((u+45+360)%360/90)%4;return rn[n]},r.c8=45,r.c9=Uf,r.cA=class extends La{constructor(u){super(u),this.current=vw}set(u,n,s){if(this.fetchUniformLocation(u,n)){for(let c=0;c<9;c++)if(s[c]!==this.current[c]){this.current=s,this.gl.uniformMatrix3fv(this.location,!1,s);break}}}},r.cB=on,r.cC=function(u,n,s){const c=Yo(s.zoom),g=u.style.map._antialias,f=n.options.extStandardDerivativesForceOff||u.terrain&&u.terrain.exaggeration()>0;return c===0&&!g&&!f},r.cD=function(u){const n=u.pixelsPerMeter,s=n/os(1,u.center.lat),c=Ne.mat4.identity(new Float64Array(16));return Ne.mat4.translate(c,c,[u.point.x,u.point.y,0]),Ne.mat4.scale(c,c,[s,s,n]),Float32Array.from(c)},r.cE=Ci,r.cF=function(u){const n=Ps-5;u=Et(u,-80.051129,n)/n*90;const s=Math.pow(Math.abs(Math.sin(Pt(u))),3);return Math.round(s*(c_.length-1))},r.cG=function(u,n,s,c){const g=n.getNorth(),f=n.getSouth(),_=n.getWest(),T=n.getEast(),A=1<<u.z,D=T-_,w=g-f,k=D/dc,O=-w/c_[s],I=[0,k,0,O,0,0,g,_,0];if(u.z>0){const R=180/c;Ne.mat3.multiply(I,I,[R/D+1,0,0,0,R/w+1,0,-.5*R/k,.5*R/O,1])}return I[2]=A,I[5]=u.x,I[8]=u.y,I},r.cH=Io,r.cI=function(u,n,s){const c=Ne.mat4.identity(new Float64Array(16)),g=(n/(1<<u)-.5)*Math.PI*2;return Ne.mat4.rotateY(c,s.globeMatrix,g),Float32Array.from(c)},r.cJ=class{isDataAvailableAtPoint(u){const n=this._source();if(this.isUsingMockSource()||!n||u.y<0||u.y>1)return!1;const s=n.getSource().maxzoom,c=1<<s,g=Math.floor(u.x),f=Math.floor((u.x-g)*c),_=Math.floor(u.y*c),T=this.findDEMTileFor(new An(s,g,s,f,_));return!(!T||!T.dem)}getAtPointOrZero(u,n=0){return this.getAtPoint(u,n)||0}getAtPoint(u,n,s=!0){if(this.isUsingMockSource())return null;n==null&&(n=null);const c=this._source();if(!c||u.y<0||u.y>1)return n;const g=c.getSource().maxzoom,f=1<<g,_=Math.floor(u.x),T=u.x-_,A=new An(g,_,g,Math.floor(T*f),Math.floor(u.y*f)),D=this.findDEMTileFor(A);if(!D||!D.dem)return n;const w=D.dem,k=1<<D.tileID.canonical.z,O=(T*k-D.tileID.canonical.x)*w.dim,I=(u.y*k-D.tileID.canonical.y)*w.dim,R=Math.floor(O),B=Math.floor(I);return(s?this.exaggeration():1)*pr(pr(w.get(R,B),w.get(R,B+1),I-B),pr(w.get(R+1,B),w.get(R+1,B+1),I-B),O-R)}getAtTileOffset(u,n,s){const c=1<<u.canonical.z;return this.getAtPointOrZero(new v(u.wrap+(u.canonical.x+n/kn)/c,(u.canonical.y+s/kn)/c))}getAtTileOffsetFunc(u,n,s,c){return g=>{const f=this.getAtTileOffset(u,g.x,g.y),_=c.upVector(u.canonical,g.x,g.y),T=c.upVectorScale(u.canonical,n,s).metersToTile;return Ne.vec3.scale(_,_,f*T),_}}getForTilePoints(u,n,s,c){if(this.isUsingMockSource())return!1;const g=Zp.create(this,u,c);return!!g&&(n.forEach(f=>{f[2]=this.exaggeration()*g.getElevationAt(f[0],f[1],s)}),!0)}getMinMaxForTile(u){if(this.isUsingMockSource())return null;const n=this.findDEMTileFor(u);if(!n||!n.dem)return null;const s=n.dem.tree,c=n.tileID,g=1<<u.canonical.z-c.canonical.z;let f=u.canonical.x/g-c.canonical.x,_=u.canonical.y/g-c.canonical.y,T=0;for(let A=0;A<u.canonical.z-c.canonical.z&&!s.leaves[T];A++){f*=2,_*=2;const D=2*Math.floor(_)+Math.floor(f);T=s.childOffsets[T]+D,f%=1,_%=1}return{min:this.exaggeration()*s.minimums[T],max:this.exaggeration()*s.maximums[T]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(u,n,s){throw new Error("Pure virtual method called.")}pointCoordinate(u){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(u){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}getMinMaxForVisibleTiles(){const u=this.visibleDemTiles;if(u.length===0)return null;let n=!1,s=Number.MAX_VALUE,c=Number.MIN_VALUE;for(const g of u){const f=this.getMinMaxForTile(g.tileID);f&&(s=Math.min(s,f.min),c=Math.max(c,f.max),n=!0)}return n?{min:s,max:c}:null}},r.cK=zM,r.cL=ni,r.cM=function(u,n){return[Math.pow(u[0],2.2)*n,Math.pow(u[1],2.2)*n,Math.pow(u[2],2.2)*n]},r.cN=Ol,r.cO=ke,r.cP=Ee,r.cQ=256,r.cR=function(u,n){const s=[0,0,0],c=jo(Io(n.canonical));return Ne.vec3.transformMat4(s,s,c),Ne.vec3.transformMat4(s,s,u),s},r.cS=u=>({u_camera_to_center_distance:new no(u),u_extrude_scale:new Fp(u),u_device_pixel_ratio:new no(u),u_matrix:new $f(u),u_inv_rot_matrix:new $f(u),u_merc_center:new Ja(u),u_tile_id:new Lp(u),u_zoom_transition:new no(u),u_up_dir:new Lp(u),u_emissive_strength:new no(u)}),r.cT=u=>({u_matrix:new $f(u),u_pixels_to_tile_units:new Fp(u),u_device_pixel_ratio:new no(u),u_width_scale:new no(u),u_floor_width_scale:new no(u),u_units_to_pixels:new Ja(u),u_dash_image:new uc(u),u_gradient_image:new uc(u),u_image_height:new no(u),u_texsize:new Ja(u),u_tile_units_to_pixels:new no(u),u_alpha_discard_threshold:new no(u),u_trim_offset:new Ja(u),u_trim_fade_range:new Ja(u),u_trim_color:new Dp(u),u_emissive_strength:new no(u),u_zbias_factor:new no(u),u_tile_to_meter:new no(u)}),r.cU=u=>({u_matrix:new $f(u),u_texsize:new Ja(u),u_pixels_to_tile_units:new Fp(u),u_device_pixel_ratio:new no(u),u_width_scale:new no(u),u_floor_width_scale:new no(u),u_image:new uc(u),u_units_to_pixels:new Ja(u),u_tile_units_to_pixels:new no(u),u_alpha_discard_threshold:new no(u),u_trim_offset:new Ja(u),u_trim_fade_range:new Ja(u),u_trim_color:new Dp(u),u_emissive_strength:new no(u),u_zbias_factor:new no(u),u_tile_to_meter:new no(u)}),r.cV=Jg,r.cW=$5,r.cX=U5,r.cY=Vp,r.cZ=(u,n,s,c,g,f)=>{const _=u.transform,T=_.projection.name==="globe";let A;if(f.paint.get("circle-pitch-alignment")==="map")if(T){const w=Ol(_.zoom,n.canonical)*_._pixelsPerMercatorPixel;A=Float32Array.from([w,0,0,w])}else A=_.calculatePixelsToTileUnitsMatrix(s);else A=new Float32Array([_.pixelsToGLUnits[0],0,0,_.pixelsToGLUnits[1]]);const D={u_camera_to_center_distance:u.transform.getCameraToCenterDistance(_.projection),u_matrix:u.translatePosMatrix(n.projMatrix,s,f.paint.get("circle-translate"),f.paint.get("circle-translate-anchor")),u_device_pixel_ratio:bn.devicePixelRatio,u_extrude_scale:A,u_inv_rot_matrix:p_,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0],u_emissive_strength:f.paint.get("circle-emissive-strength")};if(T){D.u_inv_rot_matrix=c,D.u_merc_center=g,D.u_tile_id=[n.canonical.x,n.canonical.y,1<<n.canonical.z],D.u_zoom_transition=Yo(_.zoom);const w=g[0]*kn,k=g[1]*kn;D.u_up_dir=_.projection.upVector(new Rn(0,0,0),w,k)}return D},r.c_=DI,r.ca=Dp,r.cb=function(u,n,s){const c=Math.sqrt(u*u+n*n+s*s),g=c>0?Math.acos(s/c)*Nt:0;let f=u!==0||n!==0?Math.atan2(-n,-u)*Nt+90:0;return f<0&&(f+=360),[c,f,g]},r.cc=m,r.cd=fr,r.ce=xi,r.cf=function(u){return[Math.pow(u[0],1/2.2),Math.pow(u[1],1/2.2),Math.pow(u[2],1/2.2)]},r.cg=function(u,n){return u.readFields(LV,{icons:[]},n)},r.ch=function(u){return u({pluginStatus:Ms,pluginURL:Ra}),wp.on("pluginStateChange",u),u},r.ci=ob,r.cj=Gp,r.ck=Kw,r.cl=Vc,r.cm=jg,r.cn=or,r.co=ff,r.cp=Ye,r.cq=function(u){const n=u.indexOf(Of);return n>=0?u.slice(0,n):u},r.cr=function(u){return u.indexOf(Of)>=0},r.cs=function(u){const n=u.indexOf(Of);return n>=0?u.slice(n+1):""},r.ct=function(u){const n=[],s=u.id;return s===void 0&&n.push({message:`layers.${s}: missing required property "id"`}),u.render===void 0&&n.push({message:`layers.${s}: missing required method "render"`}),u.renderingMode&&u.renderingMode!=="2d"&&u.renderingMode!=="3d"&&n.push({message:`layers.${s}: property "renderingMode" must be either "2d" or "3d"`}),n},r.cu=function(u,n,s,c){return u.type==="custom"?new bV(u,n):new PV[u.type](u,n,s,c)},r.cv=Ft,r.cw=class extends nm{constructor(u,n){super(u._vectorTileFeature,u._z,u._x,u._y,u.id),u.state&&(this.state={...u.state}),this.target=n.target,this.namespace=n.namespace,n.properties&&(this.properties=n.properties),this.target&&("featuresetId"in this.target&&!this.target.importId||"layerId"in this.target)&&(this.source=u.source,this.sourceLayer=u.sourceLayer,this.layer=u.layer)}toJSON(){const u=super.toJSON();return u.target=this.target,u.namespace=this.namespace,u}},r.cx=wp,r.cy=yl,r.cz=zp,r.d=function(u){return He.API_TILEJSON_REGEX.test(u)},r.d$=st,r.d0=(u,n,s,c,g,f,_,T,A)=>{const D=u.transform,w=D.calculatePixelsToTileUnitsMatrix(n),k=s.paint.get("line-trim-color-use-theme").constantOr("default")==="none",O=D.pitch<15?RI(.07,.7,Et((14-D.zoom)/5,0,1)):.07;return{u_matrix:LI(u,n,s,c),u_pixels_to_tile_units:w,u_device_pixel_ratio:f,u_width_scale:_,u_floor_width_scale:T,u_units_to_pixels:[1/D.pixelsToGLUnits[0],1/D.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:g,u_texsize:zI(s)&&n.lineAtlasTexture?n.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:OI(n,u.transform),u_alpha_discard_threshold:0,u_trim_offset:A,u_trim_fade_range:s.paint.get("line-trim-fade-range"),u_trim_color:s.paint.get("line-trim-color").toRenderColor(k?null:s.lut).toArray01(),u_emissive_strength:s.paint.get("line-emissive-strength"),u_zbias_factor:O,u_tile_to_meter:m(n.tileID.canonical,0)}},r.d1=Di,r.d2=m_,r.d3=wI,r.d4=br,r.d5=O0,r.d6=yd,r.d7=450,r.d8=7,r.d9=vV,r.dA=yn,r.dB=l,r.dC=hc,r.dD=function([u,n,s]){const c=Math.hypot(u,n,s),g=Math.atan2(u,s),f=.5*Math.PI-Math.acos(-n/c);return new Qr(Dt(g),Dt(f))},r.dE=a2,r.dF=function(u){const n=u.navigator?u.navigator.userAgent:null;return!!function(s){if(co==null){const c=s.navigator?s.navigator.userAgent:null;co=!!s.safari||!(!c||!(/\b(iPad|iPhone|iPod)\b/.test(c)||c.match("Safari")&&!c.match("Chrome")))}return co}(u)&&n&&(n.match("Version/15.4")||n.match("Version/15.5")||n.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/))},r.dG=function(u,n){ur=u,cr=n},r.dH=Ll,r.dI=Hs,r.dJ=function(u){const n=[0,0,0],s=Ne.mat4.identity(new Float64Array(16));return Ne.mat4.multiply(s,u.pixelMatrix,u.globeMatrix),Ne.vec3.transformMat4(n,n,s),new Je(n[0],n[1])},r.dK=function(u,n,s=!1){if(Ms===Xa||Ms===$g||Ms===Ug)throw new Error("setRTLTextPlugin cannot be called multiple times.");Ra=bn.resolveURL(u),Ms=Xa,xp=n,rd(),s||t0()},r.dL=Hg,r.dM=function(){ob().acquire(h2)},r.dN=function(){const u=F_;u&&(u.isPreloaded()&&u.numActive()===1?(u.release(h2),F_=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},r.dO=Zf,r.dP=function(u){const n=Kn();if(!n)return;const s=n.delete(dr);u&&s.catch(u).then(()=>u())},r.dQ=z_,r.dR=Ek,r.dS=function(u){T2=bn.resolveURL(u),tm||(tm=new Yp(ob(),new $c)),tm.broadcast("setDracoUrl",T2)},r.dT=Mk,r.dU=function(u){em=bn.resolveURL(u),tm||(tm=new Yp(ob(),new $c)),tm.broadcast("setMeshoptUrl",em)},r.dV=Gn,r.dW=_d,r.dX=zl,r.dY=zk,r.dZ=Fk,r.d_=II,r.da=ti,r.db=Pp,r.dc=256,r.dd=js,r.de=gu,r.df=vu,r.dg=e_,r.dh=function(u,n,s,c,g){return Et((u-n)/(s-n)*(g-c)+c,c,g)},r.di=Uv,r.dj=i,r.dk=class{constructor(u,n,s,c){this.context=u,this.format=c,this.size=s,this.texture=u.gl.createTexture();const[g,f,_]=this.size,{gl:T}=u;T.bindTexture(T.TEXTURE_3D,this.texture),u.pixelStoreUnpackFlipY.set(!1),u.pixelStoreUnpack.set(1),u.pixelStoreUnpackPremultiplyAlpha.set(!1),T.texImage3D(T.TEXTURE_3D,0,this.format,g,f,_,0,r2(this.format),i2(this.format),n.data)}bind(u,n){const{context:s}=this,{gl:c}=s;c.bindTexture(c.TEXTURE_3D,this.texture),u!==this.minFilter&&(c.texParameteri(c.TEXTURE_3D,c.TEXTURE_MAG_FILTER,u),c.texParameteri(c.TEXTURE_3D,c.TEXTURE_MIN_FILTER,u),this.minFilter=u),n!==this.wrapS&&(c.texParameteri(c.TEXTURE_3D,c.TEXTURE_WRAP_S,n),c.texParameteri(c.TEXTURE_3D,c.TEXTURE_WRAP_T,n),this.wrapS=n)}destroy(){const{gl:u}=this.context;u.deleteTexture(this.texture),this.texture=null}},r.dl=l2,r.dm=[1,1,1],r.dn=Zp,r.dp=Kp,r.dq=yu,r.dr=kl,r.ds=gd,r.dt=n_,r.du=t_,r.dv=class{constructor(){this._updateTime=0,this._sourceIds=[],this._activeRegions=[],this._prevRegions=[],this._globalClipBounds={min:new Je(1/0,1/0),max:new Je(-1/0,-1/0)}}clear(){this._activeRegions.length>0&&++this._updateTime,this._activeRegions=[],this._prevRegions=[]}get updateTime(){return this._updateTime}getReplacementRegionsForTile(u,n=!1){const s=oI(new Je(0,0),new Je(kn,kn),u),c=[];if(n&&!Ow(s,this._globalClipBounds))return c;for(const g of this._activeRegions){if(g.hiddenByOverlap||!Ow(s,g))continue;const f=p5(g.min,g.max,u);c.push({min:f.min,max:f.max,sourceId:this._sourceIds[g.priority],footprint:g.footprint,footprintTileId:g.tileId,order:g.order,clipMask:g.clipMask,clipScope:g.clipScope})}return c}setSources(u){this._setSources(u.map(n=>({getSourceId:()=>n.cache.id,getFootprints:()=>{const s=[];for(const c of n.cache.getVisibleCoordinates()){const g=n.cache.getTile(c).buckets[n.layer];g&&g.updateFootprints(c.toUnwrapped(),s)}return s},getOrder:()=>n.order,getClipMask:()=>n.clipMask,getClipScope:()=>n.clipScope})))}_addSource(u){const n=u.getFootprints();if(n.length===0)return;const s=u.getOrder(),c=u.getClipMask(),g=u.getClipScope();for(const f of n){if(!f.footprint)continue;const _=oI(f.footprint.min,f.footprint.max,f.id);this._activeRegions.push({min:_.min,max:_.max,hiddenByOverlap:!1,priority:this._sourceIds.length,tileId:f.id,footprint:f.footprint,order:s,clipMask:c,clipScope:g})}this._sourceIds.push(u.getSourceId())}_computeReplacement(){this._activeRegions.sort((n,s)=>n.priority-s.priority||P0(n.min,s.min)||P0(n.max,s.max)||n.order-s.order||n.clipMask-s.clipMask||function(c,g){const f=(_,T)=>_+T;return c.length-g.length||c.reduce(f,"").localeCompare(g.reduce(f,""))}(n.clipScope,s.clipScope));let u=this._activeRegions.length!==this._prevRegions.length;if(!u){let n=0;for(;!u&&n!==this._activeRegions.length;){const s=this._activeRegions[n],c=this._prevRegions[n];u=s.priority!==c.priority||!iI(s,c)||s.order!==c.order||s.clipMask!==c.clipMask||!Jt(s.clipScope,c.clipScope),++n}}if(u){++this._updateTime;for(const s of this._activeRegions)s.order!==k0&&(this._globalClipBounds.min.x=Math.min(this._globalClipBounds.min.x,s.min.x),this._globalClipBounds.min.y=Math.min(this._globalClipBounds.min.y,s.min.y),this._globalClipBounds.max.x=Math.max(this._globalClipBounds.max.x,s.max.x),this._globalClipBounds.max.y=Math.max(this._globalClipBounds.max.y,s.max.y));const n=s=>{const c=this._activeRegions;if(s>=c.length)return s;const g=c[s].priority;for(;s<c.length&&c[s].priority===g;)++s;return s};if(this._sourceIds.length>1){let s=0,c=n(s);for(;s!==c;){let g=s;const f=s;for(;g!==c;){const _=this._activeRegions[g];_.hiddenByOverlap=!1;for(let T=0;T<f;T++){const A=this._activeRegions[T];if(!A.hiddenByOverlap&&_.order===k0&&Ow(_,A)&&(_.hiddenByOverlap=aI(_.footprint,_.tileId,A.footprint,A.tileId),_.hiddenByOverlap))break}++g}s=c,c=n(s)}}}}_setSources(u){[this._prevRegions,this._activeRegions]=[this._activeRegions,[]],this._sourceIds=[];for(let n=u.length-1;n>=0;n--)this._addSource(u[n]);this._computeReplacement()}},r.dw=class{constructor(u){this._createGrid(u),this._createPoles(u)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const u of this._poleSegments)u.destroy();for(const u of this._gridSegments)u.withSkirts.destroy(),u.withoutSkirts.destroy()}_fillGridMeshWithLods(u,n){const s=new Il,c=new Uo,g=[],f=u+1+2,_=n[0]+1,T=n[0]+1+(1+n.length),A=(D,w,k)=>{let O=D===f-1?D-2:D===0?D:D-1;return O+=k?24575:0,[O,w]};for(let D=0;D<f;++D)s.emplaceBack(...A(D,0,!0));for(let D=0;D<_;++D)for(let w=0;w<f;++w)s.emplaceBack(...A(w,D,(w===0||w===f-1)&&!0));for(let D=0;D<n.length;++D){const w=n[D];for(let k=0;k<f;++k)s.emplaceBack(...A(k,w,!0))}for(let D=0;D<n.length;++D){const w=c.length,k=n[D]+1+2,O=new Uo;for(let B=0;B<k-1;B++){const W=B===k-2,K=W?f*(T-n.length+D-B):f;for(let ie=0;ie<f-1;ie++){const oe=B*f+ie;B===0||W||ie===0||ie===f-2?(O.emplaceBack(oe+1,oe,oe+K),O.emplaceBack(oe+K,oe+K+1,oe+1)):(c.emplaceBack(oe+1,oe,oe+K),c.emplaceBack(oe+K,oe+K+1,oe+1))}}const I=Yi.simpleSegment(0,w,s.length,c.length-w);for(let B=0;B<O.uint16.length;B+=3)c.emplaceBack(O.uint16[B],O.uint16[B+1],O.uint16[B+2]);const R=Yi.simpleSegment(0,w,s.length,c.length-w);g.push({withoutSkirts:I,withSkirts:R})}return{vertices:s,indices:c,segments:g}}_createGrid(u){const n=this._fillGridMeshWithLods(dc,c_);this._gridSegments=n.segments,this._gridBuffer=u.createVertexBuffer(n.vertices,Gr.members),this._gridIndexBuffer=u.createIndexBuffer(n.indices,!0)}_createPoles(u){const n=new Uo;for(let _=0;_<=dc;_++)n.emplaceBack(0,_+1,_+2);this._poleIndexBuffer=u.createIndexBuffer(n,!0);const s=new vu,c=new vu,g=new vu,f=new vu;this._poleSegments=[];for(let _=0,T=0;_<l_;_++){const A=360/(1<<_);s.emplaceBack(0,-Ko,0,.5,0),c.emplaceBack(0,-Ko,0,.5,1),g.emplaceBack(0,-Ko,0,.5,.5),f.emplaceBack(0,-Ko,0,.5,.5);for(let D=0;D<=dc;D++){let w=D/dc,k=0;const O=pr(0,A,w),[I,R,B]=fc(pc,jf,O,Ko);s.emplaceBack(I,R,B,w,k),c.emplaceBack(I,R,B,w,1-k);const W=Pt(O);w=.5+.5*Math.sin(W),k=.5+.5*Math.cos(W),g.emplaceBack(I,R,B,w,k),f.emplaceBack(I,R,B,w,1-k)}this._poleSegments.push(Yi.simpleSegment(T,0,66,64)),T+=66}this._poleNorthVertexBuffer=u.createVertexBuffer(s,rr,!1),this._poleSouthVertexBuffer=u.createVertexBuffer(c,rr,!1),this._texturedPoleNorthVertexBuffer=u.createVertexBuffer(g,rr,!1),this._texturedPoleSouthVertexBuffer=u.createVertexBuffer(f,rr,!1)}getGridBuffers(u,n){return[this._gridBuffer,this._gridIndexBuffer,n?this._gridSegments[u].withSkirts:this._gridSegments[u].withoutSkirts]}getPoleBuffers(u,n){return[n?this._texturedPoleNorthVertexBuffer:this._poleNorthVertexBuffer,n?this._texturedPoleSouthVertexBuffer:this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[u]]}},r.dx=k0,r.dy=Ln,r.dz=function(){return!!document.fullscreenElement||!!document.webkitFullscreenElement},r.e=He,r.e0=Za,r.e1=nA,r.e2=function(u,n,s,c,g,f,_,T,A,D,w=1,k,O){u.createArrays(),u.tilePixelRatio=kn/(512*u.overscaling),u.compareText={},u.iconsNeedLinear=!1;const I=u.layers[0].layout,R=u.layers[0]._unevaluatedLayout._values,B={};B.scaleFactor=w,B.textSizeScaleRange=I.get("text-size-scale-range"),B.iconSizeScaleRange=I.get("icon-size-scale-range");const[W,K]=B.textSizeScaleRange,[ie,oe]=B.iconSizeScaleRange;if(B.textScaleFactor=Et(B.scaleFactor,W,K),B.iconScaleFactor=Et(B.scaleFactor,ie,oe),u.textSizeData.kind==="composite"){const{minZoom:Se,maxZoom:Fe}=u.textSizeData;B.compositeTextSizes=[R["text-size"].possiblyEvaluate(new ji(Se),T),R["text-size"].possiblyEvaluate(new ji(Fe),T)]}if(u.iconSizeData.kind==="composite"){const{minZoom:Se,maxZoom:Fe}=u.iconSizeData;B.compositeIconSizes=[R["icon-size"].possiblyEvaluate(new ji(Se),T),R["icon-size"].possiblyEvaluate(new ji(Fe),T)]}B.layoutTextSize=R["text-size"].possiblyEvaluate(new ji(A+1),T),B.layoutIconSize=R["icon-size"].possiblyEvaluate(new ji(A+1),T),B.textMaxSize=R["text-size"].possiblyEvaluate(new ji(18),T);const Q=I.get("text-rotation-alignment")==="map"&&I.get("symbol-placement")!=="point",ue=I.get("text-size");let ge=!1;for(const Se of u.features)if(Se.icon&&Se.icon.nameSecondary){ge=!0;break}for(const Se of u.features){const Fe=I.get("text-font").evaluate(Se,{},T).join(","),ze=ue.evaluate(Se,{},T)*B.textScaleFactor,Le=B.layoutTextSize.evaluate(Se,{},T)*B.textScaleFactor,nt=(B.layoutIconSize.evaluate(Se,{},T),{horizontal:{},vertical:void 0}),$e=Se.text;let it,dt=[0,0];if($e){const Mt=$e.toString(),vt=I.get("text-letter-spacing").evaluate(Se,{},T)*Xo,qt=I.get("text-line-height").evaluate(Se,{},T)*Xo,mn=Jv(Mt)?vt:0,Zt=I.get("text-anchor").evaluate(Se,{},T),Tn=I.get("text-variable-anchor");if(!Tn){const In=I.get("text-radial-offset").evaluate(Se,{},T);dt=In?lA(Zt,[In*Xo,Zw]):I.get("text-offset").evaluate(Se,{},T).map(qn=>qn*Xo)}let Sn=Q?"center":I.get("text-justify").evaluate(Se,{},T);const On=I.get("symbol-placement")==="point",nn=On?I.get("text-max-width").evaluate(Se,{},T)*Xo:1/0,Yn=In=>{u.allowVerticalPlacement&&_p(Mt)&&(nt.vertical=Gw($e,n,s,g,Fe,nn,qt,Zt,In,mn,dt,Fa.vertical,!0,Le,ze))};if(!Q&&Tn){const In=Sn==="auto"?Tn.map(ar=>Yw(ar)):[Sn];let qn=!1;for(let ar=0;ar<In.length;ar++){const Mr=In[ar];if(!nt.horizontal[Mr])if(qn)nt.horizontal[Mr]=nt.horizontal[0];else{const Pr=Gw($e,n,s,g,Fe,nn,qt,"center",Mr,mn,dt,Fa.horizontal,!1,Le,ze);Pr&&(nt.horizontal[Mr]=Pr,qn=Pr.positionedLines.length===1)}}Yn("left")}else{if(Sn==="auto"&&(Sn=Yw(Zt)),On||I.get("text-writing-mode").indexOf("horizontal")>=0||!_p(Mt)){const In=Gw($e,n,s,g,Fe,nn,qt,Zt,Sn,mn,dt,Fa.horizontal,!1,Le,ze);In&&(nt.horizontal[Sn]=In)}Yn(On?"left":Sn)}}let ct=!1,mt=!1;if(Se.icon&&Se.icon.namePrimary){const Mt=L0(u.iconSizeData,R["icon-size"],T,u.zoom,Se)*B.iconScaleFactor*k,vt=Se.icon.getPrimary().scaleSelf(Mt).serialize(),qt=c[vt];qt&&(it=Q5(g[vt],Se.icon.nameSecondary?g[Se.icon.getSecondary().scaleSelf(Mt).serialize()]:void 0,I.get("icon-offset").evaluate(Se,{},T),I.get("icon-anchor").evaluate(Se,{},T)),ct=qt.sdf,mt=qt.usvg,u.sdfIcons===void 0?u.sdfIcons=qt.sdf:u.sdfIcons!==qt.sdf&&xn("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(qt.pixelRatio!==u.pixelRatio||I.get("icon-rotate").constantOr(1)!==0)&&(u.iconsNeedLinear=!0))}const wt=cA(nt.horizontal)||nt.vertical;u.iconsInText||(u.iconsInText=!!wt&&wt.iconsInText),(wt||it)&&sV(u,Se,nt,it,c,B,Le,0,dt,ct,mt,_,T,D,O,ge)}f&&u.generateCollisionDebugBuffers(A,u.collisionBoxArray,B.textScaleFactor)},r.e3=Up,r.e4=db,r.e5=tt,r.e6=QM,r.e7=UI,r.e8=S,r.e9=function(u){let n=0;if(new Uint32Array(u,0,1)[0]!==Ak){const s=new Uint32Array(u,0,7),[,,c,g,f,_]=s;n=s.byteLength+g+f+_+f,(c!==u.byteLength||n>=u.byteLength)&&xn("Invalid b3dm header information.")}return Ok(u,n)},r.ea=function(u,n){const s=Dk(u);for(const c of s){for(const g of c.meshes)D$(g);c.lights&&(c.lightMeshIndex=c.meshes.length,c.meshes.push(z$(c.lights,n)))}return s},r.eb=ib,r.ec=XA,r.ed=Is,r.ee=function(u){Qn(),Yt!=null&&Yt.then(n=>{n.keys().then(s=>{for(let c=0;c<s.length-u;c++)n.delete(s[c])})})},r.f=function(u){return u.indexOf("mapbox:")===0},r.g=function(u,n){return yl(er(u,{method:"GET"}),n)},r.h=ut,r.i=function(u){return He.API_STYLE_REGEX.test(u)&&!ft(u)},r.j=function(u){return decodeURIComponent(atob(u).split("").map(n=>"%"+("00"+n.charCodeAt(0).toString(16)).slice(-2)).join(""))},r.k=function(u){return btoa(encodeURIComponent(u).replace(/%([0-9A-F]{2})/g,(n,s)=>String.fromCharCode(+("0x"+s))))},r.l=er,r.m=eo,r.n=function(u,n){return yl(er(u,{type:"json"}),n)},r.o=zh,r.p=function(u,n){return yl(er(u,{method:"POST"}),n)},r.q=bn,r.r=ss,r.s=function(u){try{const n=self[u];return n.setItem("_mapbox_test_",1),n.removeItem("_mapbox_test_"),!0}catch{return!1}},r.t=Qt,r.u=function(){return function u(n){return n?(n^Math.random()*(16>>n/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,u)}()},r.v=function(u){return!!u&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(u)},r.w=xn,r.x=function(){return p2||(p2=new Zf),p2},r.y=uu,r.z=lu}),p(["./shared"],function(r){function S(Ut){const Ee=Ut?Ut.url.toString():void 0;return Ee?performance.getEntriesByName(Ee):[]}function C(Ut){if(typeof Ut=="number"||typeof Ut=="boolean"||typeof Ut=="string"||Ut==null)return JSON.stringify(Ut);if(Array.isArray(Ut)){let ke="[";for(const He of Ut)ke+=`${C(He)},`;return`${ke}]`}let Ee="{";for(const ke of Object.keys(Ut).sort())Ee+=`${ke}:${C(Ut[ke])},`;return`${Ee}}`}function M(Ut){let Ee="";for(const ke of r.bm)Ee+=`/${C(Ut[ke])}`;return Ee}class P{constructor(Ee){this.keyCache={},this._layers={},this._layerConfigs={},Ee&&this.replace(Ee)}replace(Ee,ke){this._layerConfigs={},this._layers={},this.update(Ee,[],ke)}update(Ee,ke,He){this._options=He;for(const ft of Ee)this._layerConfigs[ft.id]=ft,(this._layers[ft.id]=r.cu(ft,this.scope,null,this._options)).compileFilter(He),this.keyCache[ft.id]&&delete this.keyCache[ft.id];for(const ft of ke)delete this.keyCache[ft],delete this._layerConfigs[ft],delete this._layers[ft];this.familiesBySource={};const ut=function(ft,xt){const Lt={};for(let $t=0;$t<ft.length;$t++){const Qe=ft[$t];let yt=xt&&xt[Qe.id];!yt&&(yt=M(Qe),Qe.type==="line"&&Qe.paint)&&function bn(Mn){return typeof Mn=="string"&&Mn==="line-progress"||(Array.isArray(Mn)?Mn.some(bn):!(!Mn||typeof Mn!="object")&&Object.values(Mn).some(bn))}(Qe.paint["line-width"])&&(yt+=`/${C(Qe.paint["line-width"])}`),xt&&(xt[Qe.id]=yt);let Qt=Lt[yt];Qt||(Qt=Lt[yt]=[]),Qt.push(Qe)}const Tt=[];for(const $t in Lt)Tt.push(Lt[$t]);return Tt}(r.bj(this._layerConfigs),this.keyCache);for(const ft of ut){const xt=ft.map(Qt=>this._layers[Qt.id]),Lt=xt[0];if(Lt.visibility==="none")continue;const Tt=Lt.source||"";let $t=this.familiesBySource[Tt];$t||($t=this.familiesBySource[Tt]={});const Qe=Lt.sourceLayer||"_geojsonTileLayer";let yt=$t[Qe];yt||(yt=$t[Qe]=[]),yt.push(xt)}}}const z=1*r.dX;class F{constructor(Ee){const ke={},He=[];for(const Lt in Ee){const Tt=Ee[Lt],$t=ke[Lt]={};for(const Qe in Tt.glyphs){const yt=Tt.glyphs[+Qe];if(!yt||yt.bitmap.width===0||yt.bitmap.height===0)continue;const Qt=yt.metrics.localGlyph?z:1,bn={x:0,y:0,w:yt.bitmap.width+2*Qt,h:yt.bitmap.height+2*Qt};He.push(bn),$t[Qe]=bn}}const{w:ut,h:ft}=r.C(He),xt=new r.dW({width:ut||1,height:ft||1});for(const Lt in Ee){const Tt=Ee[Lt];for(const $t in Tt.glyphs){const Qe=Tt.glyphs[+$t];if(!Qe||Qe.bitmap.width===0||Qe.bitmap.height===0)continue;const yt=ke[Lt][$t],Qt=Qe.metrics.localGlyph?z:1;r.dW.copy(Qe.bitmap,xt,{x:0,y:0},{x:yt.x+Qt,y:yt.y+Qt},Qe.bitmap)}}this.image=xt,this.positions=ke}}r.dV(F,"GlyphAtlas");class V{constructor(Ee){this.tileID=new r.aG(Ee.tileID.overscaledZ,Ee.tileID.wrap,Ee.tileID.canonical.z,Ee.tileID.canonical.x,Ee.tileID.canonical.y),this.tileZoom=Ee.tileZoom,this.uid=Ee.uid,this.zoom=Ee.zoom,this.lut=Ee.lut,this.canonical=Ee.tileID.canonical,this.pixelRatio=Ee.pixelRatio,this.tileSize=Ee.tileSize,this.source=Ee.source,this.scope=Ee.scope,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=Ee.showCollisionBoxes,this.collectResourceTiming=!!Ee.request&&Ee.request.collectResourceTiming,this.promoteId=Ee.promoteId,this.isSymbolTile=Ee.isSymbolTile,this.tileTransform=r.aQ(Ee.tileID.canonical,Ee.projection),this.projection=Ee.projection,this.worldview=Ee.worldview,this.localizableLayerIds=Ee.localizableLayerIds,this.brightness=Ee.brightness,this.extraShadowCaster=!!Ee.extraShadowCaster,this.tessellationStep=Ee.tessellationStep,this.scaleFactor=Ee.scaleFactor}parse(Ee,ke,He,ut,ft){this.status="parsing",this.data=Ee,this.collisionBoxArray=new r.aW;const xt=new r.dY(Object.keys(Ee.layers).sort()),Lt=new r.dZ(this.tileID,this.promoteId);Lt.bucketLayerIDs=[];const Tt={},$t=new r.d_(256,256),Qe={featureIndex:Lt,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:$t,availableImages:He,brightness:this.brightness,scaleFactor:this.scaleFactor},yt=ke.familiesBySource[this.source];for(const cr in yt){const ei=Ee.layers[cr];if(!ei)continue;let Yt=!1,wn=!1,Kn=!1;for(const eo of yt[cr])eo[0].type==="symbol"?Yt=!0:wn=!0,eo[0].is3D()&&eo[0].type!=="model"&&(Kn=!0);if(this.extraShadowCaster&&!Kn||this.isSymbolTile===!0&&!Yt||this.isSymbolTile===!1&&!wn)continue;ei.version===1&&r.w(`Vector tile source "${this.source}" layer "${cr}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const Qn=xt.encode(cr),di=[];for(let eo=0,vo=0;eo<ei.length;eo++){const bo=ei.feature(eo),gl=Lt.getId(bo,cr);if(this.localizableLayerIds&&this.localizableLayerIds.has(cr)){const Ea=bo.properties?bo.properties.worldview:null;if(this.worldview&&typeof Ea=="string")if(Ea==="all")bo.properties.$localized=!0;else{if(!Ea.split(",").includes(this.worldview))continue;bo.properties.$localized=!0,bo.properties.worldview=this.worldview}}di.push({feature:bo,id:gl,index:vo,sourceLayerIndex:Qn}),vo++}for(const eo of yt[cr]){const vo=eo[0];(!this.extraShadowCaster||vo.is3D()&&vo.type!=="model")&&(this.isSymbolTile!==void 0&&vo.type==="symbol"!==this.isSymbolTile||vo.minzoom&&this.zoom<Math.floor(vo.minzoom)||vo.maxzoom&&this.zoom>=vo.maxzoom||vo.visibility!=="none"&&(N(eo,this.zoom,Qe.brightness,He),(Tt[vo.id]=vo.createBucket({index:Lt.bucketLayerIDs.length,layers:eo,zoom:this.zoom,lut:this.lut,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Qn,sourceID:this.source,projection:this.projection.spec,tessellationStep:this.tessellationStep})).populate(di,Qe,this.tileID.canonical,this.tileTransform),Lt.bucketLayerIDs.push(eo.map(bo=>r.aC(bo.id,bo.scope)))))}}let Qt,bn,Mn,or;$t.trim();const dr={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},ur=()=>{if(Qt)return this.status="done",ft(Qt);if(this.extraShadowCaster)this.status="done",ft(null,{buckets:r.bj(Tt).filter(cr=>!cr.isEmpty()),featureIndex:Lt,collisionBoxArray:null,glyphAtlasImage:null,lineAtlas:null,imageAtlas:null,brightness:Qe.brightness,glyphMap:null,iconMap:null,glyphPositions:null});else if(bn&&Mn&&or){const cr=new F(bn),ei=new r.e1(Mn,or,this.lut);for(const Yt in Tt){const wn=Tt[Yt];wn instanceof r.aX?(N(wn.layers,this.zoom,Qe.brightness,He),r.e2(wn,bn,cr.positions,Mn,ei.iconPositions,this.showCollisionBoxes,He,this.tileID.canonical,this.tileZoom,this.projection,this.scaleFactor,this.pixelRatio,this.brightness)):wn.hasPattern&&(wn instanceof r.b1||wn instanceof r.b2||wn instanceof r.d5)&&(N(wn.layers,this.zoom,Qe.brightness,He),wn.addFeatures(Qe,this.tileID.canonical,ei.patternPositions,He,this.tileTransform,this.brightness))}this.status="done",ft(null,{buckets:r.bj(Tt).filter(Yt=>!Yt.isEmpty()),featureIndex:Lt,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:cr.image,lineAtlas:$t,imageAtlas:ei,brightness:Qe.brightness})}};if(!this.extraShadowCaster){const cr=r.d$(Qe.glyphDependencies,wn=>Object.keys(wn).map(Number));Object.keys(cr).length?ut.send("getGlyphs",{uid:this.uid,stacks:cr,scope:this.scope},(wn,Kn)=>{Qt||(Qt=wn,bn=Kn,ur())},void 0,!1,dr):bn={};const ei=Object.keys(Qe.iconDependencies);ei.length?ut.send("getImages",{icons:ei,source:this.source,scope:this.scope,tileID:this.tileID,type:"icons"},(wn,Kn)=>{if(Qt)return;Qt=wn;const Qn={};Object.values(Kn).some(di=>di.usvg)?this.rasterize(ut,Qn,Kn,Qe.iconDependencies,()=>{Mn=Qn,ur()}):(this.fillImageMap(Qn,Qe.iconDependencies,Kn),Mn=Qn,ur())},void 0,!1,dr):Mn={};const Yt=Object.keys(Qe.patternDependencies);Yt.length?ut.send("getImages",{icons:Yt,source:this.source,scope:this.scope,tileID:this.tileID,type:"patterns"},(wn,Kn)=>{if(!Qt){Qt=wn;const Qn={};Object.values(Kn).some(di=>di.usvg)?this.rasterize(ut,Qn,Kn,Qe.patternDependencies,()=>{or=Qn,ur()}):(this.fillImageMap(Qn,Qe.patternDependencies,Kn),or=Qn,ur())}},void 0,!1,dr):or={}}ur()}fillImageMap(Ee,ke,He){for(const ut in He){const ft=ke[ut]||[];for(const xt of ft)He[xt.id].usvg||(Ee[xt.serialize()]=He[xt.id])}}getImageTaskQueue(Ee,ke,He){const ut={};for(const ft in ke){const xt=He[ft]||[];for(const Lt of xt){const Tt=Lt.serialize();ke[Lt.id].usvg?ut[Tt]||(ut[Tt]=Lt):Ee[Tt]=ke[Lt.id]}}return ut}rasterize(Ee,ke,He,ut,ft){const xt=this.getImageTaskQueue(ke,He,ut);this.rasterizeTask=Ee.send("rasterizeImages",{scope:this.scope,imageTasks:xt},(Lt,Tt)=>{if(!Lt)for(const $t in Tt){const{id:Qe}=r.e0.deserializeFromString($t);ke[$t]=Object.assign({},He[Qe],{data:Tt[$t]})}ft()})}cancelRasterize(){this.rasterizeTask&&this.rasterizeTask.cancel()}}function N(Ut,Ee,ke,He){const ut=new r.a8(Ee,{brightness:ke});for(const ft of Ut)ft.recalculate(ut,He)}class H extends r.E{constructor(Ee,ke,He,ut,ft,xt){super(),this.actor=Ee,this.layerIndex=ke,this.availableImages=He,this.loadVectorData=ft||r.aD,this.loading={},this.loaded={},this.deduped=new r.aB(Ee.scheduler),this.isSpriteLoaded=ut,this.scheduler=Ee.scheduler,this.brightness=xt}loadTile(Ee,ke){const He=Ee.uid,ut=Ee&&Ee.request,ft=ut&&ut.collectResourceTiming,xt=this.loading[He]=new V(Ee);xt.abort=this.loadVectorData(Ee,(Lt,Tt)=>{const $t=!this.loading[He];if(delete this.loading[He],xt.cancelRasterize(),$t||Lt||!Tt)return xt.status="done",$t||(this.loaded[He]=xt),ke(Lt);const Qe=Tt.rawData,yt={};Tt.expires&&(yt.expires=Tt.expires),Tt.cacheControl&&(yt.cacheControl=Tt.cacheControl),xt.vectorTile=Tt.vectorTile||new r.e3.VectorTile(new r.bh(Qe));const Qt=()=>{xt.parse(xt.vectorTile,this.layerIndex,this.availableImages,this.actor,(bn,Mn)=>{if(bn||!Mn)return ke(bn);const or={};if(ft){const dr=S(ut);dr.length>0&&(or.resourceTiming=JSON.parse(JSON.stringify(dr)))}ke(null,r.l({rawTileData:Qe.slice(0)},Mn,yt,or))})};this.isSpriteLoaded?Qt():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(Qt,{type:"parseTile",isSymbolTile:Ee.isSymbolTile,zoom:Ee.tileZoom}):Qt()}),this.loaded=this.loaded||{},this.loaded[He]=xt})}reloadTile(Ee,ke){const He=this.loaded,ut=Ee.uid;if(He&&He[ut]){const ft=He[ut];ft.scaleFactor=Ee.scaleFactor,ft.showCollisionBoxes=Ee.showCollisionBoxes,ft.projection=Ee.projection,ft.brightness=Ee.brightness,ft.tileTransform=r.aQ(Ee.tileID.canonical,Ee.projection),ft.extraShadowCaster=Ee.extraShadowCaster,ft.lut=Ee.lut;const xt=(Lt,Tt)=>{const $t=ft.reloadCallback;$t&&(delete ft.reloadCallback,ft.parse(ft.vectorTile,this.layerIndex,this.availableImages,this.actor,$t)),ke(Lt,Tt)};ft.status==="parsing"?ft.reloadCallback=xt:ft.status==="done"&&(ft.vectorTile?ft.parse(ft.vectorTile,this.layerIndex,this.availableImages,this.actor,xt):xt())}else ke(null,void 0)}abortTile(Ee,ke){const He=Ee.uid,ut=this.loading[He];ut&&(ut.abort&&ut.abort(),delete this.loading[He]),ke()}removeTile(Ee,ke){const He=this.loaded,ut=Ee.uid;He&&He[ut]&&delete He[ut],ke()}}class U{loadTile(Ee,ke){const{uid:He,encoding:ut,rawImageData:ft,padding:xt}=Ee,Lt=ImageBitmap&&ft instanceof ImageBitmap?this.getImageData(ft,xt):ft;ke(null,new r.e4(He,Lt,ut,xt<1))}getImageData(Ee,ke){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(Ee.width,Ee.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=Ee.width,this.offscreenCanvas.height=Ee.height,this.offscreenCanvasContext.drawImage(Ee,0,0,Ee.width,Ee.height);const He=this.offscreenCanvasContext.getImageData(-ke,-ke,Ee.width+2*ke,Ee.height+2*ke);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),He}}r.bg.setPbf(r.bh);class te{decodeRasterArray({task:Ee,buffer:ke},He){r.bg.performDecoding(ke,Ee).then(ut=>{He(null,ut)},ut=>{He(ut)})}}const Z=r.e3.VectorTileFeature.prototype.toGeoJSON;class q{constructor(Ee){this._feature=Ee,this.extent=r.ag,this.type=Ee.type,this.properties=Ee.tags,"id"in Ee&&!isNaN(Ee.id)&&(this.id=parseInt(Ee.id,10))}loadGeometry(){if(this._feature.type===1){const Ee=[];for(const ke of this._feature.geometry)Ee.push([new r.P(ke[0],ke[1])]);return Ee}{const Ee=[];for(const ke of this._feature.geometry){const He=[];for(const ut of ke)He.push(new r.P(ut[0],ut[1]));Ee.push(He)}return Ee}}toGeoJSON(Ee,ke,He){return Z.call(this,Ee,ke,He)}}class J{constructor(Ee){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=r.ag,this.length=Ee.length,this._features=Ee}feature(Ee){return new q(this._features[Ee])}}const re=64/4096,se=128;class he{constructor(){this.features=new Map}clear(){this.features.clear()}load(Ee=[],ke){for(const He of Ee){const ut=He.id;if(ut==null)continue;let ft=this.features.get(ut);ft&&this.updateCache(ft,ke),He.geometry?(ft=ce(He),this.updateCache(ft,ke),this.features.set(ut,ft)):this.features.delete(ut),this.updateCache(ft,ke)}}updateCache(Ee,ke){for(const{canonical:He,uid:ut}of Object.values(ke)){const{z:ft,x:xt,y:Lt}=He;le(Ee,Math.pow(2,ft),xt,Lt)&&delete ke[ut]}}getTile(Ee,ke,He){const ut=Math.pow(2,Ee),ft=[];for(const xt of this.features.values())le(xt,ut,ke,He)&&ft.push(Ve(xt,ut,ke,He));return{features:ft}}getFeatures(){return[...this.features.values()]}}function le({minX:Ut,minY:Ee,maxX:ke,maxY:He},ut,ft,xt){return Ut<(ft+1+re)/ut&&Ee<(xt+1+re)/ut&&ke>(ft-re)/ut&&He>(xt-re)/ut}function ce(Ut){const{id:Ee,geometry:ke,properties:He}=Ut;if(!ke)return;if(ke.type==="GeometryCollection")throw new Error("GeometryCollection not supported in dynamic mode.");const{type:ut,coordinates:ft}=ke,xt={id:Ee,type:1,geometry:[],tags:He,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0},Lt=xt.geometry;if(ut==="Point")pe(ft,Lt,xt);else if(ut==="MultiPoint")for(const Tt of ft)pe(Tt,Lt,xt);else if(ut==="LineString")xt.type=2,de(ft,Lt,xt);else if(ut==="MultiLineString")xt.type=2,Ie(ft,Lt,xt);else if(ut==="Polygon")xt.type=3,Ie(ft,Lt,xt,!0);else{if(ut!=="MultiPolygon")throw new Error("Input data is not a valid GeoJSON object.");xt.type=3;for(const Tt of ft)Ie(Tt,Lt,xt,!0)}return xt}function pe([Ut,Ee],ke,He){const ut=r.at(Ut);let ft=r.aA(Ee);ft=ft<0?0:ft>1?1:ft,ke.push(ut,ft),He.minX=Math.min(He.minX,ut),He.minY=Math.min(He.minY,ft),He.maxX=Math.max(He.maxX,ut),He.maxY=Math.max(He.maxY,ft)}function de(Ut,Ee,ke,He=!1,ut=!1){const ft=[];for(const xt of Ut)pe(xt,ft,ke);Ee.push(ft),He&&function(xt,Lt){let Tt=0;for(let $t=0,Qe=xt.length,yt=Qe-2;$t<Qe;yt=$t,$t+=2)Tt+=(xt[$t]-xt[yt])*(xt[$t+1]+xt[yt+1]);if(Tt>0===Lt)for(let $t=0,Qe=xt.length;$t<Qe/2;$t+=2){const yt=xt[$t],Qt=xt[$t+1];xt[$t]=xt[Qe-2-$t],xt[$t+1]=xt[Qe-1-$t],xt[Qe-2-$t]=yt,xt[Qe-1-$t]=Qt}}(ft,ut)}function Ie(Ut,Ee,ke,He=!1){for(let ut=0;ut<Ut.length;ut++)de(Ut[ut],Ee,ke,He,ut===0)}function Ve(Ut,Ee,ke,He){const{id:ut,type:ft,geometry:xt,tags:Lt}=Ut,Tt=[];if(ft===1)(function($t,Qe,yt,Qt,bn){for(let Mn=0;Mn<$t.length;Mn+=2){const or=Math.round(r.ag*($t[Mn+0]*Qe-yt)),dr=Math.round(r.ag*($t[Mn+1]*Qe-Qt));bn.push([or,dr])}})(xt,Ee,ke,He,Tt);else for(const $t of xt)be($t,Ee,ke,He,Tt);return{id:ut,type:ft,geometry:Tt,tags:Lt}}function be(Ut,Ee,ke,He,ut){const xt=r.ag+se;let Lt;for(let Tt=0;Tt<Ut.length-2;Tt+=2){let $t=Math.round(r.ag*(Ut[Tt+0]*Ee-ke)),Qe=Math.round(r.ag*(Ut[Tt+1]*Ee-He)),yt=Math.round(r.ag*(Ut[Tt+2]*Ee-ke)),Qt=Math.round(r.ag*(Ut[Tt+3]*Ee-He));const bn=yt-$t,Mn=Qt-Qe;$t<-128&&yt<-128||($t<-128?(Qe+=Math.round(Mn*((-128-$t)/bn)),$t=-128):yt<-128&&(Qt=Qe+Math.round(Mn*((-128-$t)/bn)),yt=-128),Qe<-128&&Qt<-128||(Qe<-128?($t+=Math.round(bn*((-128-Qe)/Mn)),Qe=-128):Qt<-128&&(yt=$t+Math.round(bn*((-128-Qe)/Mn)),Qt=-128),$t>=xt&&yt>=xt||($t>=xt?(Qe+=Math.round(Mn*((xt-$t)/bn)),$t=xt):yt>=xt&&(Qt=Qe+Math.round(Mn*((xt-$t)/bn)),yt=xt),Qe>=xt&&Qt>=xt||(Qe>=xt?($t+=Math.round(bn*((xt-Qe)/Mn)),Qe=xt):Qt>=xt&&(yt=$t+Math.round(bn*((xt-Qe)/Mn)),Qt=xt),Lt&&$t===Lt[Lt.length-1][0]&&Qe===Lt[Lt.length-1][1]||(Lt=[[$t,Qe]],ut.push(Lt)),Lt.push([yt,Qt])))))}}var ye,Me,we,me={exports:{}},De=function(){if(we)return me.exports;we=1;var Ut=r.e7(),Ee=function(){if(Me)return ye;Me=1;var Qe=r.e5(),yt=r.e6().VectorTileFeature;function Qt(Mn,or){this.options=or||{},this.features=Mn,this.length=Mn.length}function bn(Mn,or){this.id=typeof Mn.id=="number"?Mn.id:void 0,this.type=Mn.type,this.rawGeometry=Mn.type===1?[Mn.geometry]:Mn.geometry,this.properties=Mn.tags,this.extent=or||4096}return ye=Qt,Qt.prototype.feature=function(Mn){return new bn(this.features[Mn],this.options.extent)},bn.prototype.loadGeometry=function(){var Mn=this.rawGeometry;this.geometry=[];for(var or=0;or<Mn.length;or++){for(var dr=Mn[or],ur=[],cr=0;cr<dr.length;cr++)ur.push(new Qe(dr[cr][0],dr[cr][1]));this.geometry.push(ur)}return this.geometry},bn.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var Mn=this.geometry,or=1/0,dr=-1/0,ur=1/0,cr=-1/0,ei=0;ei<Mn.length;ei++)for(var Yt=Mn[ei],wn=0;wn<Yt.length;wn++){var Kn=Yt[wn];or=Math.min(or,Kn.x),dr=Math.max(dr,Kn.x),ur=Math.min(ur,Kn.y),cr=Math.max(cr,Kn.y)}return[or,ur,dr,cr]},bn.prototype.toGeoJSON=yt.prototype.toGeoJSON,ye}();function ke(Qe){var yt=new Ut;return function(Qt,bn){for(var Mn in Qt.layers)bn.writeMessage(3,He,Qt.layers[Mn])}(Qe,yt),yt.finish()}function He(Qe,yt){var Qt;yt.writeVarintField(15,Qe.version||1),yt.writeStringField(1,Qe.name||""),yt.writeVarintField(5,Qe.extent||4096);var bn={keys:[],values:[],keycache:{},valuecache:{}};for(Qt=0;Qt<Qe.length;Qt++)bn.feature=Qe.feature(Qt),yt.writeMessage(2,ut,bn);var Mn=bn.keys;for(Qt=0;Qt<Mn.length;Qt++)yt.writeStringField(3,Mn[Qt]);var or=bn.values;for(Qt=0;Qt<or.length;Qt++)yt.writeMessage(4,$t,or[Qt])}function ut(Qe,yt){var Qt=Qe.feature;Qt.id!==void 0&&yt.writeVarintField(1,Qt.id),yt.writeMessage(2,ft,Qe),yt.writeVarintField(3,Qt.type),yt.writeMessage(4,Tt,Qt)}function ft(Qe,yt){var Qt=Qe.feature,bn=Qe.keys,Mn=Qe.values,or=Qe.keycache,dr=Qe.valuecache;for(var ur in Qt.properties){var cr=Qt.properties[ur],ei=or[ur];if(cr!==null){ei===void 0&&(bn.push(ur),or[ur]=ei=bn.length-1),yt.writeVarint(ei);var Yt=typeof cr;Yt!=="string"&&Yt!=="boolean"&&Yt!=="number"&&(cr=JSON.stringify(cr));var wn=Yt+":"+cr,Kn=dr[wn];Kn===void 0&&(Mn.push(cr),dr[wn]=Kn=Mn.length-1),yt.writeVarint(Kn)}}}function xt(Qe,yt){return(yt<<3)+(7&Qe)}function Lt(Qe){return Qe<<1^Qe>>31}function Tt(Qe,yt){for(var Qt=Qe.loadGeometry(),bn=Qe.type,Mn=0,or=0,dr=Qt.length,ur=0;ur<dr;ur++){var cr=Qt[ur],ei=1;bn===1&&(ei=cr.length),yt.writeVarint(xt(1,ei));for(var Yt=bn===3?cr.length-1:cr.length,wn=0;wn<Yt;wn++){wn===1&&bn!==1&&yt.writeVarint(xt(2,Yt-1));var Kn=cr[wn].x-Mn,Qn=cr[wn].y-or;yt.writeVarint(Lt(Kn)),yt.writeVarint(Lt(Qn)),Mn+=Kn,or+=Qn}bn===3&&yt.writeVarint(xt(7,1))}}function $t(Qe,yt){var Qt=typeof Qe;Qt==="string"?yt.writeStringField(1,Qe):Qt==="boolean"?yt.writeBooleanField(7,Qe):Qt==="number"&&(Qe%1!=0?yt.writeDoubleField(3,Qe):Qe<0?yt.writeSVarintField(6,Qe):yt.writeVarintField(5,Qe))}return me.exports=ke,me.exports.fromVectorTileJs=ke,me.exports.fromGeojsonVt=function(Qe,yt){yt=yt||{};var Qt={};for(var bn in Qe)Qt[bn]=new Ee(Qe[bn].features,yt),Qt[bn].name=bn,Qt[bn].version=yt.version,Qt[bn].extent=yt.extent;return ke({layers:Qt})},me.exports.GeoJSONWrapper=Ee,me.exports}(),Ge=r.e8(De);const rt={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:Ut=>Ut},Oe=Math.fround||(Ct=new Float32Array(1),Ut=>(Ct[0]=+Ut,Ct[0]));var Ct;const kt=3,Bt=5,_t=6;class jt{constructor(Ee){this.options=Object.assign(Object.create(rt),Ee),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(Ee){const{log:ke,minZoom:He,maxZoom:ut}=this.options;ke&&console.time("total time");const ft=`prepare ${Ee.length} points`;ke&&console.time(ft),this.points=Ee;const xt=[];for(let Tt=0;Tt<Ee.length;Tt++){const $t=Ee[Tt];if(!$t.geometry)continue;const[Qe,yt]=$t.geometry.coordinates,Qt=Oe(an(Qe)),bn=Oe(Ae(yt));xt.push(Qt,bn,1/0,Tt,-1,1),this.options.reduce&&xt.push(0)}let Lt=this.trees[ut+1]=this._createTree(xt);ke&&console.timeEnd(ft);for(let Tt=ut;Tt>=He;Tt--){const $t=+Date.now();Lt=this.trees[Tt]=this._createTree(this._cluster(Lt,Tt)),ke&&console.log("z%d: %d clusters in %dms",Tt,Lt.numItems,+Date.now()-$t)}return ke&&console.timeEnd("total time"),this}getClusters(Ee,ke){let He=((Ee[0]+180)%360+360)%360-180;const ut=Math.max(-90,Math.min(90,Ee[1]));let ft=Ee[2]===180?180:((Ee[2]+180)%360+360)%360-180;const xt=Math.max(-90,Math.min(90,Ee[3]));if(Ee[2]-Ee[0]>=360)He=-180,ft=180;else if(He>ft){const yt=this.getClusters([He,ut,180,xt],ke),Qt=this.getClusters([-180,ut,ft,xt],ke);return yt.concat(Qt)}const Lt=this.trees[this._limitZoom(ke)],Tt=Lt.range(an(He),Ae(xt),an(ft),Ae(ut)),$t=Lt.data,Qe=[];for(const yt of Tt){const Qt=this.stride*yt;Qe.push($t[Qt+Bt]>1?Gt($t,Qt,this.clusterProps):this.points[$t[Qt+kt]])}return Qe}getChildren(Ee){const ke=this._getOriginId(Ee),He=this._getOriginZoom(Ee),ut="No cluster with the specified id.",ft=this.trees[He];if(!ft)throw new Error(ut);const xt=ft.data;if(ke*this.stride>=xt.length)throw new Error(ut);const Lt=this.options.radius/(this.options.extent*Math.pow(2,He-1)),Tt=ft.within(xt[ke*this.stride],xt[ke*this.stride+1],Lt),$t=[];for(const Qe of Tt){const yt=Qe*this.stride;xt[yt+4]===Ee&&$t.push(xt[yt+Bt]>1?Gt(xt,yt,this.clusterProps):this.points[xt[yt+kt]])}if($t.length===0)throw new Error(ut);return $t}getLeaves(Ee,ke,He){const ut=[];return this._appendLeaves(ut,Ee,ke=ke||10,He=He||0,0),ut}getTile(Ee,ke,He){const ut=this.trees[this._limitZoom(Ee)],ft=Math.pow(2,Ee),{extent:xt,radius:Lt}=this.options,Tt=Lt/xt,$t=(He-Tt)/ft,Qe=(He+1+Tt)/ft,yt={features:[]};return this._addTileFeatures(ut.range((ke-Tt)/ft,$t,(ke+1+Tt)/ft,Qe),ut.data,ke,He,ft,yt),ke===0&&this._addTileFeatures(ut.range(1-Tt/ft,$t,1,Qe),ut.data,ft,He,ft,yt),ke===ft-1&&this._addTileFeatures(ut.range(0,$t,Tt/ft,Qe),ut.data,-1,He,ft,yt),yt.features.length?yt:null}getClusterExpansionZoom(Ee){let ke=this._getOriginZoom(Ee)-1;for(;ke<=this.options.maxZoom;){const He=this.getChildren(Ee);if(ke++,He.length!==1)break;Ee=He[0].properties.cluster_id}return ke}_appendLeaves(Ee,ke,He,ut,ft){const xt=this.getChildren(ke);for(const Lt of xt){const Tt=Lt.properties;if(Tt&&Tt.cluster?ft+Tt.point_count<=ut?ft+=Tt.point_count:ft=this._appendLeaves(Ee,Tt.cluster_id,He,ut,ft):ft<ut?ft++:Ee.push(Lt),Ee.length===He)break}return ft}_createTree(Ee){const ke=new r.bE(Ee.length/this.stride|0,this.options.nodeSize,Float32Array);for(let He=0;He<Ee.length;He+=this.stride)ke.add(Ee[He],Ee[He+1]);return ke.finish(),ke.data=Ee,ke}_addTileFeatures(Ee,ke,He,ut,ft,xt){for(const Lt of Ee){const Tt=Lt*this.stride,$t=ke[Tt+Bt]>1;let Qe,yt,Qt;if($t)Qe=Ne(ke,Tt,this.clusterProps),yt=ke[Tt],Qt=ke[Tt+1];else{const or=this.points[ke[Tt+kt]];Qe=or.properties;const[dr,ur]=or.geometry.coordinates;yt=an(dr),Qt=Ae(ur)}const bn={type:1,geometry:[[Math.round(this.options.extent*(yt*ft-He)),Math.round(this.options.extent*(Qt*ft-ut))]],tags:Qe};let Mn;Mn=$t||this.options.generateId?ke[Tt+kt]:this.points[ke[Tt+kt]].id,Mn!==void 0&&(bn.id=Mn),xt.features.push(bn)}}_limitZoom(Ee){return Math.max(this.options.minZoom,Math.min(Math.floor(+Ee),this.options.maxZoom+1))}_cluster(Ee,ke){const{radius:He,extent:ut,reduce:ft,minPoints:xt}=this.options,Lt=He/(ut*Math.pow(2,ke)),Tt=Ee.data,$t=[],Qe=this.stride;for(let yt=0;yt<Tt.length;yt+=Qe){if(Tt[yt+2]<=ke)continue;Tt[yt+2]=ke;const Qt=Tt[yt],bn=Tt[yt+1],Mn=Ee.within(Tt[yt],Tt[yt+1],Lt),or=Tt[yt+Bt];let dr=or;for(const ur of Mn){const cr=ur*Qe;Tt[cr+2]>ke&&(dr+=Tt[cr+Bt])}if(dr>or&&dr>=xt){let ur,cr=Qt*or,ei=bn*or,Yt=-1;const wn=(yt/Qe<<5)+(ke+1)+this.points.length;for(const Kn of Mn){const Qn=Kn*Qe;if(Tt[Qn+2]<=ke)continue;Tt[Qn+2]=ke;const di=Tt[Qn+Bt];cr+=Tt[Qn]*di,ei+=Tt[Qn+1]*di,Tt[Qn+4]=wn,ft&&(ur||(ur=this._map(Tt,yt,!0),Yt=this.clusterProps.length,this.clusterProps.push(ur)),ft(ur,this._map(Tt,Qn)))}Tt[yt+4]=wn,$t.push(cr/dr,ei/dr,1/0,wn,-1,dr),ft&&$t.push(Yt)}else{for(let ur=0;ur<Qe;ur++)$t.push(Tt[yt+ur]);if(dr>1)for(const ur of Mn){const cr=ur*Qe;if(!(Tt[cr+2]<=ke)){Tt[cr+2]=ke;for(let ei=0;ei<Qe;ei++)$t.push(Tt[cr+ei])}}}}return $t}_getOriginId(Ee){return Ee-this.points.length>>5}_getOriginZoom(Ee){return(Ee-this.points.length)%32}_map(Ee,ke,He){if(Ee[ke+Bt]>1){const xt=this.clusterProps[Ee[ke+_t]];return He?Object.assign({},xt):xt}const ut=this.points[Ee[ke+kt]].properties,ft=this.options.map(ut);return He&&ft===ut?Object.assign({},ft):ft}}function Gt(Ut,Ee,ke){return{type:"Feature",id:Ut[Ee+kt],properties:Ne(Ut,Ee,ke),geometry:{type:"Point",coordinates:[(He=Ut[Ee],360*(He-.5)),tt(Ut[Ee+1])]}};var He}function Ne(Ut,Ee,ke){const He=Ut[Ee+Bt],ut=He>=1e4?`${Math.round(He/1e3)}k`:He>=1e3?Math.round(He/100)/10+"k":He,ft=Ut[Ee+_t],xt=ft===-1?{}:Object.assign({},ke[ft]);return Object.assign(xt,{cluster:!0,cluster_id:Ut[Ee+kt],point_count:He,point_count_abbreviated:ut})}function an(Ut){return Ut/360+.5}function Ae(Ut){const Ee=Math.sin(Ut*Math.PI/180),ke=.5-.25*Math.log((1+Ee)/(1-Ee))/Math.PI;return ke<0?0:ke>1?1:ke}function tt(Ut){const Ee=(180-360*Ut)*Math.PI/180;return 360*Math.atan(Math.exp(Ee))/Math.PI-90}function Je(Ut,Ee,ke,He){let ut=He;const ft=Ee+(ke-Ee>>1);let xt,Lt=ke-Ee;const Tt=Ut[Ee],$t=Ut[Ee+1],Qe=Ut[ke],yt=Ut[ke+1];for(let Qt=Ee+3;Qt<ke;Qt+=3){const bn=Jt(Ut[Qt],Ut[Qt+1],Tt,$t,Qe,yt);if(bn>ut)xt=Qt,ut=bn;else if(bn===ut){const Mn=Math.abs(Qt-ft);Mn<Lt&&(xt=Qt,Lt=Mn)}}ut>He&&(xt-Ee>3&&Je(Ut,Ee,xt,He),Ut[xt+2]=ut,ke-xt>3&&Je(Ut,xt,ke,He))}function Jt(Ut,Ee,ke,He,ut,ft){let xt=ut-ke,Lt=ft-He;if(xt!==0||Lt!==0){const Tt=((Ut-ke)*xt+(Ee-He)*Lt)/(xt*xt+Lt*Lt);Tt>1?(ke=ut,He=ft):Tt>0&&(ke+=xt*Tt,He+=Lt*Tt)}return xt=Ut-ke,Lt=Ee-He,xt*xt+Lt*Lt}function Kt(Ut,Ee,ke,He){const ut={id:Ut??null,type:Ee,geometry:ke,tags:He,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(Ee==="Point"||Ee==="MultiPoint"||Ee==="LineString")Nt(ut,ke);else if(Ee==="Polygon")Nt(ut,ke[0]);else if(Ee==="MultiLineString")for(const ft of ke)Nt(ut,ft);else if(Ee==="MultiPolygon")for(const ft of ke)Nt(ut,ft[0]);return ut}function Nt(Ut,Ee){for(let ke=0;ke<Ee.length;ke+=3)Ut.minX=Math.min(Ut.minX,Ee[ke]),Ut.minY=Math.min(Ut.minY,Ee[ke+1]),Ut.maxX=Math.max(Ut.maxX,Ee[ke]),Ut.maxY=Math.max(Ut.maxY,Ee[ke+1])}function Pt(Ut,Ee,ke,He){if(!Ee.geometry)return;const ut=Ee.geometry.coordinates;if(ut&&ut.length===0)return;const ft=Ee.geometry.type,xt=Math.pow(ke.tolerance/((1<<ke.maxZoom)*ke.extent),2);let Lt=[],Tt=Ee.id;if(ke.promoteId?Tt=Ee.properties[ke.promoteId]:ke.generateId&&(Tt=He||0),ft==="Point")Dt(ut,Lt);else if(ft==="MultiPoint")for(const $t of ut)Dt($t,Lt);else if(ft==="LineString")rn(ut,Lt,xt,!1);else if(ft==="MultiLineString"){if(ke.lineMetrics){for(const $t of ut)Lt=[],rn($t,Lt,xt,!1),Ut.push(Kt(Tt,"LineString",Lt,Ee.properties));return}on(ut,Lt,xt,!1)}else if(ft==="Polygon")on(ut,Lt,xt,!0);else{if(ft!=="MultiPolygon"){if(ft==="GeometryCollection"){for(const $t of Ee.geometry.geometries)Pt(Ut,{id:Tt,geometry:$t,properties:Ee.properties},ke,He);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const $t of ut){const Qe=[];on($t,Qe,xt,!0),Lt.push(Qe)}}Ut.push(Kt(Tt,ft,Lt,Ee.properties))}function Dt(Ut,Ee){Ee.push(Ln(Ut[0]),yn(Ut[1]),0)}function rn(Ut,Ee,ke,He){let ut,ft,xt=0;for(let Tt=0;Tt<Ut.length;Tt++){const $t=Ln(Ut[Tt][0]),Qe=yn(Ut[Tt][1]);Ee.push($t,Qe,0),Tt>0&&(xt+=He?(ut*Qe-$t*ft)/2:Math.sqrt(Math.pow($t-ut,2)+Math.pow(Qe-ft,2))),ut=$t,ft=Qe}const Lt=Ee.length-3;Ee[2]=1,Je(Ee,0,Lt,ke),Ee[Lt+2]=1,Ee.size=Math.abs(xt),Ee.start=0,Ee.end=Ee.size}function on(Ut,Ee,ke,He){for(let ut=0;ut<Ut.length;ut++){const ft=[];rn(Ut[ut],ft,ke,He),Ee.push(ft)}}function Ln(Ut){return Ut/360+.5}function yn(Ut){const Ee=Math.sin(Ut*Math.PI/180),ke=.5-.25*Math.log((1+Ee)/(1-Ee))/Math.PI;return ke<0?0:ke>1?1:ke}function Et(Ut,Ee,ke,He,ut,ft,xt,Lt){if(He/=Ee,ft>=(ke/=Ee)&&xt<He)return Ut;if(xt<ke||ft>=He)return null;const Tt=[];for(const $t of Ut){const Qe=$t.geometry;let yt=$t.type;const Qt=ut===0?$t.minX:$t.minY,bn=ut===0?$t.maxX:$t.maxY;if(Qt>=ke&&bn<He){Tt.push($t);continue}if(bn<ke||Qt>=He)continue;let Mn=[];if(yt==="Point"||yt==="MultiPoint")En(Qe,Mn,ke,He,ut);else if(yt==="LineString")Xn(Qe,Mn,ke,He,ut,!1,Lt.lineMetrics);else if(yt==="MultiLineString")er(Qe,Mn,ke,He,ut,!1);else if(yt==="Polygon")er(Qe,Mn,ke,He,ut,!0);else if(yt==="MultiPolygon")for(const or of Qe){const dr=[];er(or,dr,ke,He,ut,!0),dr.length&&Mn.push(dr)}if(Mn.length){if(Lt.lineMetrics&&yt==="LineString"){for(const or of Mn)Tt.push(Kt($t.id,yt,or,$t.tags));continue}yt!=="LineString"&&yt!=="MultiLineString"||(Mn.length===1?(yt="LineString",Mn=Mn[0]):yt="MultiLineString"),yt!=="Point"&&yt!=="MultiPoint"||(yt=Mn.length===3?"Point":"MultiPoint"),Tt.push(Kt($t.id,yt,Mn,$t.tags))}}return Tt.length?Tt:null}function En(Ut,Ee,ke,He,ut){for(let ft=0;ft<Ut.length;ft+=3){const xt=Ut[ft+ut];xt>=ke&&xt<=He&&Dr(Ee,Ut[ft],Ut[ft+1],Ut[ft+2])}}function Xn(Ut,Ee,ke,He,ut,ft,xt){let Lt=vr(Ut);const Tt=ut===0?Ar:Di;let $t,Qe,yt=Ut.start;for(let dr=0;dr<Ut.length-3;dr+=3){const ur=Ut[dr],cr=Ut[dr+1],ei=Ut[dr+2],Yt=Ut[dr+3],wn=Ut[dr+4],Kn=ut===0?ur:cr,Qn=ut===0?Yt:wn;let di=!1;xt&&($t=Math.sqrt(Math.pow(ur-Yt,2)+Math.pow(cr-wn,2))),Kn<ke?Qn>ke&&(Qe=Tt(Lt,ur,cr,Yt,wn,ke),xt&&(Lt.start=yt+$t*Qe)):Kn>He?Qn<He&&(Qe=Tt(Lt,ur,cr,Yt,wn,He),xt&&(Lt.start=yt+$t*Qe)):Dr(Lt,ur,cr,ei),Qn<ke&&Kn>=ke&&(Qe=Tt(Lt,ur,cr,Yt,wn,ke),di=!0),Qn>He&&Kn<=He&&(Qe=Tt(Lt,ur,cr,Yt,wn,He),di=!0),!ft&&di&&(xt&&(Lt.end=yt+$t*Qe),Ee.push(Lt),Lt=vr(Ut)),xt&&(yt+=$t)}let Qt=Ut.length-3;const bn=Ut[Qt],Mn=Ut[Qt+1],or=ut===0?bn:Mn;or>=ke&&or<=He&&Dr(Lt,bn,Mn,Ut[Qt+2]),Qt=Lt.length-3,ft&&Qt>=3&&(Lt[Qt]!==Lt[0]||Lt[Qt+1]!==Lt[1])&&Dr(Lt,Lt[0],Lt[1],Lt[2]),Lt.length&&Ee.push(Lt)}function vr(Ut){const Ee=[];return Ee.size=Ut.size,Ee.start=Ut.start,Ee.end=Ut.end,Ee}function er(Ut,Ee,ke,He,ut,ft){for(const xt of Ut)Xn(xt,Ee,ke,He,ut,ft,!1)}function Dr(Ut,Ee,ke,He){Ut.push(Ee,ke,He)}function Ar(Ut,Ee,ke,He,ut,ft){const xt=(ft-Ee)/(He-Ee);return Dr(Ut,ft,ke+(ut-ke)*xt,1),xt}function Di(Ut,Ee,ke,He,ut,ft){const xt=(ft-ke)/(ut-ke);return Dr(Ut,Ee+(He-Ee)*xt,ft,1),xt}function ui(Ut,Ee){const ke=[];for(let He=0;He<Ut.length;He++){const ut=Ut[He],ft=ut.type;let xt;if(ft==="Point"||ft==="MultiPoint"||ft==="LineString")xt=zt(ut.geometry,Ee);else if(ft==="MultiLineString"||ft==="Polygon"){xt=[];for(const Lt of ut.geometry)xt.push(zt(Lt,Ee))}else if(ft==="MultiPolygon"){xt=[];for(const Lt of ut.geometry){const Tt=[];for(const $t of Lt)Tt.push(zt($t,Ee));xt.push(Tt)}}ke.push(Kt(ut.id,ft,xt,ut.tags))}return ke}function zt(Ut,Ee){const ke=[];ke.size=Ut.size,Ut.start!==void 0&&(ke.start=Ut.start,ke.end=Ut.end);for(let He=0;He<Ut.length;He+=3)ke.push(Ut[He]+Ee,Ut[He+1],Ut[He+2]);return ke}function st(Ut,Ee){if(Ut.transformed)return Ut;const ke=1<<Ut.z,He=Ut.x,ut=Ut.y;for(const ft of Ut.features){const xt=ft.geometry,Lt=ft.type;if(ft.geometry=[],Lt===1)for(let Tt=0;Tt<xt.length;Tt+=2)ft.geometry.push(Ft(xt[Tt],xt[Tt+1],Ee,ke,He,ut));else for(let Tt=0;Tt<xt.length;Tt++){const $t=[];for(let Qe=0;Qe<xt[Tt].length;Qe+=2)$t.push(Ft(xt[Tt][Qe],xt[Tt][Qe+1],Ee,ke,He,ut));ft.geometry.push($t)}}return Ut.transformed=!0,Ut}function Ft(Ut,Ee,ke,He,ut,ft){return[Math.round(ke*(Ut*He-ut)),Math.round(ke*(Ee*He-ft))]}function Ye(Ut,Ee,ke,He,ut){const ft=Ee===ut.maxZoom?0:ut.tolerance/((1<<Ee)*ut.extent),xt={features:[],numPoints:0,numSimplified:0,numFeatures:Ut.length,source:null,x:ke,y:He,z:Ee,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const Lt of Ut)pn(xt,Lt,ft,ut);return xt}function pn(Ut,Ee,ke,He){const ut=Ee.geometry,ft=Ee.type,xt=[];if(Ut.minX=Math.min(Ut.minX,Ee.minX),Ut.minY=Math.min(Ut.minY,Ee.minY),Ut.maxX=Math.max(Ut.maxX,Ee.maxX),Ut.maxY=Math.max(Ut.maxY,Ee.maxY),ft==="Point"||ft==="MultiPoint")for(let Lt=0;Lt<ut.length;Lt+=3)xt.push(ut[Lt],ut[Lt+1]),Ut.numPoints++,Ut.numSimplified++;else if(ft==="LineString")xn(xt,ut,Ut,ke,!1,!1);else if(ft==="MultiLineString"||ft==="Polygon")for(let Lt=0;Lt<ut.length;Lt++)xn(xt,ut[Lt],Ut,ke,ft==="Polygon",Lt===0);else if(ft==="MultiPolygon")for(let Lt=0;Lt<ut.length;Lt++){const Tt=ut[Lt];for(let $t=0;$t<Tt.length;$t++)xn(xt,Tt[$t],Ut,ke,!0,$t===0)}if(xt.length){let Lt=Ee.tags||null;if(ft==="LineString"&&He.lineMetrics){Lt={};for(const $t in Ee.tags)Lt[$t]=Ee.tags[$t];Lt.mapbox_clip_start=ut.start/ut.size,Lt.mapbox_clip_end=ut.end/ut.size}const Tt={geometry:xt,type:ft==="Polygon"||ft==="MultiPolygon"?3:ft==="LineString"||ft==="MultiLineString"?2:1,tags:Lt};Ee.id!==null&&(Tt.id=Ee.id),Ut.features.push(Tt)}}function xn(Ut,Ee,ke,He,ut,ft){const xt=He*He;if(He>0&&Ee.size<(ut?xt:He))return void(ke.numPoints+=Ee.length/3);const Lt=[];for(let Tt=0;Tt<Ee.length;Tt+=3)(He===0||Ee[Tt+2]>xt)&&(ke.numSimplified++,Lt.push(Ee[Tt],Ee[Tt+1])),ke.numPoints++;ut&&function(Tt,$t){let Qe=0;for(let yt=0,Qt=Tt.length,bn=Qt-2;yt<Qt;bn=yt,yt+=2)Qe+=(Tt[yt]-Tt[bn])*(Tt[yt+1]+Tt[bn+1]);if(Qe>0===$t)for(let yt=0,Qt=Tt.length;yt<Qt/2;yt+=2){const bn=Tt[yt],Mn=Tt[yt+1];Tt[yt]=Tt[Qt-2-yt],Tt[yt+1]=Tt[Qt-1-yt],Tt[Qt-2-yt]=bn,Tt[Qt-1-yt]=Mn}}(Lt,ft),Ut.push(Lt)}const _r={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class yi{constructor(Ee,ke){const He=(ke=this.options=function(ft,xt){for(const Lt in xt)ft[Lt]=xt[Lt];return ft}(Object.create(_r),ke)).debug;if(He&&console.time("preprocess data"),ke.maxZoom<0||ke.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(ke.promoteId&&ke.generateId)throw new Error("promoteId and generateId cannot be used together.");let ut=function(ft,xt){const Lt=[];if(ft.type==="FeatureCollection")for(let Tt=0;Tt<ft.features.length;Tt++)Pt(Lt,ft.features[Tt],xt,Tt);else Pt(Lt,ft.type==="Feature"?ft:{geometry:ft},xt);return Lt}(Ee,ke);this.tiles={},this.tileCoords=[],He&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",ke.indexMaxZoom,ke.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),ut=function(ft,xt){const Lt=xt.buffer/xt.extent;let Tt=ft;const $t=Et(ft,1,-1-Lt,Lt,0,-1,2,xt),Qe=Et(ft,1,1-Lt,2+Lt,0,-1,2,xt);return($t||Qe)&&(Tt=Et(ft,1,-Lt,1+Lt,0,-1,2,xt)||[],$t&&(Tt=ui($t,1).concat(Tt)),Qe&&(Tt=Tt.concat(ui(Qe,-1)))),Tt}(ut,ke),ut.length&&this.splitTile(ut,0,0,0),He&&(ut.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(Ee,ke,He,ut,ft,xt,Lt){const Tt=[Ee,ke,He,ut],$t=this.options,Qe=$t.debug;for(;Tt.length;){ut=Tt.pop(),He=Tt.pop(),ke=Tt.pop(),Ee=Tt.pop();const yt=1<<ke,Qt=xi(ke,He,ut);let bn=this.tiles[Qt];if(!bn&&(Qe>1&&console.time("creation"),bn=this.tiles[Qt]=Ye(Ee,ke,He,ut,$t),this.tileCoords.push({z:ke,x:He,y:ut}),Qe)){Qe>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",ke,He,ut,bn.numFeatures,bn.numPoints,bn.numSimplified),console.timeEnd("creation"));const di=`z${ke}`;this.stats[di]=(this.stats[di]||0)+1,this.total++}if(bn.source=Ee,ft==null){if(ke===$t.indexMaxZoom||bn.numPoints<=$t.indexMaxPoints)continue}else{if(ke===$t.maxZoom||ke===ft)continue;if(ft!=null){const di=ft-ke;if(He!==xt>>di||ut!==Lt>>di)continue}}if(bn.source=null,Ee.length===0)continue;Qe>1&&console.time("clipping");const Mn=.5*$t.buffer/$t.extent,or=.5-Mn,dr=.5+Mn,ur=1+Mn;let cr=null,ei=null,Yt=null,wn=null,Kn=Et(Ee,yt,He-Mn,He+dr,0,bn.minX,bn.maxX,$t),Qn=Et(Ee,yt,He+or,He+ur,0,bn.minX,bn.maxX,$t);Ee=null,Kn&&(cr=Et(Kn,yt,ut-Mn,ut+dr,1,bn.minY,bn.maxY,$t),ei=Et(Kn,yt,ut+or,ut+ur,1,bn.minY,bn.maxY,$t),Kn=null),Qn&&(Yt=Et(Qn,yt,ut-Mn,ut+dr,1,bn.minY,bn.maxY,$t),wn=Et(Qn,yt,ut+or,ut+ur,1,bn.minY,bn.maxY,$t),Qn=null),Qe>1&&console.timeEnd("clipping"),Tt.push(cr||[],ke+1,2*He,2*ut),Tt.push(ei||[],ke+1,2*He,2*ut+1),Tt.push(Yt||[],ke+1,2*He+1,2*ut),Tt.push(wn||[],ke+1,2*He+1,2*ut+1)}}getTile(Ee,ke,He){Ee=+Ee,ke=+ke,He=+He;const ut=this.options,{extent:ft,debug:xt}=ut;if(Ee<0||Ee>24)return null;const Lt=1<<Ee,Tt=xi(Ee,ke=ke+Lt&Lt-1,He);if(this.tiles[Tt])return st(this.tiles[Tt],ft);xt>1&&console.log("drilling down to z%d-%d-%d",Ee,ke,He);let $t,Qe=Ee,yt=ke,Qt=He;for(;!$t&&Qe>0;)Qe--,yt>>=1,Qt>>=1,$t=this.tiles[xi(Qe,yt,Qt)];return $t&&$t.source?(xt>1&&(console.log("found parent tile z%d-%d-%d",Qe,yt,Qt),console.time("drilling down")),this.splitTile($t.source,Qe,yt,Qt,Ee,ke,He),xt>1&&console.timeEnd("drilling down"),this.tiles[Tt]?st(this.tiles[Tt],ft):null):null}}function xi(Ut,Ee,ke){return 32*((1<<Ut)*ke+Ee)+Ut}function Qi(Ut,Ee){const ke=Ut.tileID.canonical;if(!this._geoJSONIndex)return void Ee(null,null);const He=this._geoJSONIndex.getTile(ke.z,ke.x,ke.y);if(!He)return void Ee(null,null);const ut=new J(He.features);let ft=Ge(ut);ft.byteOffset===0&&ft.byteLength===ft.buffer.byteLength||(ft=new Uint8Array(ft)),Ee(null,{vectorTile:ut,rawData:ft.buffer})}class ci extends H{constructor(Ee,ke,He,ut,ft,xt){super(Ee,ke,He,ut,Qi,xt),ft&&(this.loadGeoJSON=ft),this._dynamicIndex=new he}loadData(Ee,ke){const He=Ee&&Ee.request,ut=He&&He.collectResourceTiming;this.loadGeoJSON(Ee,(ft,xt)=>{if(ft||!xt)return ke(ft);if(typeof xt!="object")return ke(new Error(`Input data given to '${Ee.source}' is not a valid GeoJSON object.`));{try{if(Ee.filter){const Tt=r.U(Ee.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(Tt.result==="error")throw new Error(Tt.value.map($t=>`${$t.key}: ${$t.message}`).join(", "));xt.features=xt.features.filter($t=>Tt.value.evaluate({zoom:0},$t))}Ee.dynamic?(xt.type==="Feature"&&(xt={type:"FeatureCollection",features:[xt]}),Ee.append||(this._dynamicIndex.clear(),this.loaded={}),this._dynamicIndex.load(xt.features,this.loaded),Ee.cluster&&(xt.features=this._dynamicIndex.getFeatures())):this.loaded={},this._geoJSONIndex=Ee.cluster?new jt(function({superclusterOptions:Tt,clusterProperties:$t}){if(!$t||!Tt)return Tt;const Qe={},yt={},Qt={accumulated:null,zoom:0},bn={properties:null},Mn=Object.keys($t);for(const or of Mn){const[dr,ur]=$t[or],cr=r.U(ur),ei=r.U(typeof dr=="string"?[dr,["accumulated"],["get",or]]:dr);Qe[or]=cr.value,yt[or]=ei.value}return Tt.map=or=>{bn.properties=or;const dr={};for(const ur of Mn)dr[ur]=Qe[ur].evaluate(Qt,bn);return dr},Tt.reduce=(or,dr)=>{bn.properties=dr;for(const ur of Mn)Qt.accumulated=or[ur],or[ur]=yt[ur].evaluate(Qt,bn)},Tt}(Ee)).load(xt.features):Ee.dynamic?this._dynamicIndex:function(Tt,$t){return new yi(Tt,$t)}(xt,Ee.geojsonVtOptions)}catch(Tt){return ke(Tt)}const Lt={};if(ut){const Tt=S(He);Tt&&(Lt.resourceTiming={},Lt.resourceTiming[Ee.source]=JSON.parse(JSON.stringify(Tt)))}ke(null,Lt)}})}reloadTile(Ee,ke){const He=this.loaded;return He&&He[Ee.uid]?Ee.partial?ke(null,void 0):super.reloadTile(Ee,ke):this.loadTile(Ee,ke)}loadGeoJSON(Ee,ke){if(Ee.request)r.n(Ee.request,ke);else{if(typeof Ee.data!="string")return ke(new Error(`Input data given to '${Ee.source}' is not a valid GeoJSON object.`));try{return ke(null,JSON.parse(Ee.data))}catch{return ke(new Error(`Input data given to '${Ee.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(Ee,ke){try{ke(null,this._geoJSONIndex.getClusterExpansionZoom(Ee.clusterId))}catch(He){ke(He)}}getClusterChildren(Ee,ke){try{ke(null,this._geoJSONIndex.getChildren(Ee.clusterId))}catch(He){ke(He)}}getClusterLeaves(Ee,ke){try{ke(null,this._geoJSONIndex.getLeaves(Ee.clusterId,Ee.limit,Ee.offset))}catch(He){ke(He)}}}class co{constructor(Ee,ke){this.tileID=new r.aG(Ee.tileID.overscaledZ,Ee.tileID.wrap,Ee.tileID.canonical.z,Ee.tileID.canonical.x,Ee.tileID.canonical.y),this.tileZoom=Ee.tileZoom,this.uid=Ee.uid,this.zoom=Ee.zoom,this.canonical=Ee.tileID.canonical,this.pixelRatio=Ee.pixelRatio,this.tileSize=Ee.tileSize,this.source=Ee.source,this.overscaling=this.tileID.overscaleFactor(),this.projection=Ee.projection,this.brightness=ke}parse(Ee,ke,He,ut){this.status="parsing";const ft=new r.aG(He.tileID.overscaledZ,He.tileID.wrap,He.tileID.canonical.z,He.tileID.canonical.x,He.tileID.canonical.y),xt=[],Lt=ke.familiesBySource[He.source],Tt=new r.dZ(ft,He.promoteId);return Tt.bucketLayerIDs=[],Tt.is3DTile=!0,r.e9(Ee).then($t=>{if(!$t)return ut(new Error("Could not parse tile"));const Qe=r.ea($t,1/r.cc(He.tileID.canonical)),yt=$t.json.extensionsUsed&&$t.json.extensionsUsed.includes("MAPBOX_mesh_features")||$t.json.asset.extras&&$t.json.asset.extras.MAPBOX_mesh_features,Qt=$t.json.extensionsUsed&&$t.json.extensionsUsed.includes("EXT_meshopt_compression"),bn=new r.a8(this.zoom,{brightness:this.brightness});for(const Mn in Lt)for(const or of Lt[Mn]){const dr=or[0];Tt.bucketLayerIDs.push(or.map(cr=>r.aC(cr.id,cr.scope))),dr.recalculate(bn,[]);const ur=new r.eb(or,Qe,ft,yt,Qt,this.brightness,Tt);yt||(ur.needsUpload=!0),xt.push(ur),ur.evaluate(dr)}this.status="done",ut(null,{buckets:xt,featureIndex:Tt,collisionBoxArray:null,glyphAtlasImage:null,lineAtlas:null,imageAtlas:null,brightness:null})}).catch($t=>ut(new Error($t.message)))}}class pi{constructor(Ee,ke,He,ut,ft,xt){this.actor=Ee,this.layerIndex=ke,this.availableImages=He,this.brightness=xt,this.loading={},this.loaded={}}loadTile(Ee,ke){const He=Ee.uid,ut=this.loading[He]=new co(Ee,this.brightness);r.bi(Ee.request,(ft,xt)=>{const Lt=!this.loading[He];return delete this.loading[He],Lt||ft?(ut.status="done",Lt||(this.loaded[He]=ut),ke(ft)):xt&&xt.byteLength!==0?void ut.parse(xt,this.layerIndex,Ee,(Tt,$t)=>{ut.status="done",this.loaded=this.loaded||{},this.loaded[He]=ut,Tt||!$t?ke(Tt):ke(null,$t)}):(ut.status="done",this.loaded[He]=ut,ke())})}reloadTile(Ee,ke){const He=this.loaded,ut=Ee.uid;if(He&&He[ut]){const ft=He[ut];ft.projection=Ee.projection,ft.brightness=Ee.brightness;const xt=(Lt,Tt)=>{ft.reloadCallback&&(delete ft.reloadCallback,this.loadTile(Ee,ke)),ke(Lt,Tt)};ft.status==="parsing"?ft.reloadCallback=xt:ft.status==="done"&&this.loadTile(Ee,ke)}}abortTile(Ee,ke){const He=Ee.uid;this.loading[He]&&delete this.loading[He],ke()}removeTile(Ee,ke){const He=this.loaded,ut=Ee.uid;He&&He[ut]&&delete He[ut],ke()}}class Oo{constructor(Ee){this.self=Ee,this.actor=new r.ec(Ee,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.imageRasterizer=new r.I,this.projections={},this.defaultProjection=r.bP({name:"mercator"}),this.workerSourceTypes={vector:H,geojson:ci,"batched-model":pi},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(ke,He)=>{if(this.workerSourceTypes[ke])throw new Error(`Worker source with name "${ke}" already registered.`);this.workerSourceTypes[ke]=He},this.self.registerRTLTextPlugin=ke=>{if(r.ed.isParsed())throw new Error("RTL text plugin already registered.");r.ed.applyArabicShaping=ke.applyArabicShaping,r.ed.processBidirectionalText=ke.processBidirectionalText,r.ed.processStyledBidirectionalText=ke.processStyledBidirectionalText}}clearCaches(Ee,ke,He){delete this.layerIndexes[Ee],delete this.availableImages[Ee],delete this.workerSources[Ee],delete this.demWorkerSources[Ee],delete this.rasterArrayWorkerSource,He()}checkIfReady(Ee,ke,He){He()}setReferrer(Ee,ke){this.referrer=ke}spriteLoaded(Ee,{scope:ke,isLoaded:He}){if(this.isSpriteLoaded[Ee]||(this.isSpriteLoaded[Ee]={}),this.isSpriteLoaded[Ee][ke]=He,this.workerSources[Ee]&&this.workerSources[Ee][ke])for(const ut in this.workerSources[Ee][ke]){const ft=this.workerSources[Ee][ke][ut];for(const xt in ft){const Lt=ft[xt];Lt instanceof H&&(Lt.isSpriteLoaded=He,Lt.fire(new r.z("isSpriteLoaded")))}}}setImages(Ee,{scope:ke,images:He},ut){if(this.availableImages[Ee]||(this.availableImages[Ee]={}),this.availableImages[Ee][ke]=He,this.workerSources[Ee]&&this.workerSources[Ee][ke]){for(const ft in this.workerSources[Ee][ke]){const xt=this.workerSources[Ee][ke][ft];for(const Lt in xt)xt[Lt].availableImages=He}ut()}else ut()}setProjection(Ee,ke){this.projections[Ee]=r.bP(ke)}setBrightness(Ee,ke,He){this.brightness=ke,He()}setLayers(Ee,ke,He){this.getLayerIndex(Ee,ke.scope).replace(ke.layers,ke.options),He()}updateLayers(Ee,ke,He){this.getLayerIndex(Ee,ke.scope).update(ke.layers,ke.removedIds,ke.options),He()}loadTile(Ee,ke,He){ke.projection=this.projections[Ee]||this.defaultProjection,this.getWorkerSource(Ee,ke.type,ke.source,ke.scope).loadTile(ke,He)}loadDEMTile(Ee,ke,He){this.getDEMWorkerSource(Ee,ke.source,ke.scope).loadTile(ke,He)}decodeRasterArray(Ee,ke,He){this.getRasterArrayWorkerSource().decodeRasterArray(ke,He)}reloadTile(Ee,ke,He){ke.projection=this.projections[Ee]||this.defaultProjection,this.getWorkerSource(Ee,ke.type,ke.source,ke.scope).reloadTile(ke,He)}abortTile(Ee,ke,He){this.getWorkerSource(Ee,ke.type,ke.source,ke.scope).abortTile(ke,He)}removeTile(Ee,ke,He){this.getWorkerSource(Ee,ke.type,ke.source,ke.scope).removeTile(ke,He)}removeSource(Ee,ke,He){if(!(this.workerSources[Ee]&&this.workerSources[Ee][ke.scope]&&this.workerSources[Ee][ke.scope][ke.type]&&this.workerSources[Ee][ke.scope][ke.type][ke.source]))return;const ut=this.workerSources[Ee][ke.scope][ke.type][ke.source];delete this.workerSources[Ee][ke.scope][ke.type][ke.source],ut.removeSource!==void 0?ut.removeSource(ke,He):He()}loadWorkerSource(Ee,ke,He){try{this.self.importScripts(ke.url),He()}catch(ut){He(ut.toString())}}syncRTLPluginState(Ee,ke,He){try{r.ed.setState(ke);const ut=r.ed.getPluginURL();if(r.ed.isLoaded()&&!r.ed.isParsed()&&ut!=null){this.self.importScripts(ut);const ft=r.ed.isParsed();He(ft?void 0:new Error(`RTL Text Plugin failed to import scripts from ${ut}`),ft)}}catch(ut){He(ut.toString())}}setDracoUrl(Ee,ke){this.dracoUrl=ke}getAvailableImages(Ee,ke){this.availableImages[Ee]||(this.availableImages[Ee]={});let He=this.availableImages[Ee][ke];return He||(He=[]),He}getLayerIndex(Ee,ke){this.layerIndexes[Ee]||(this.layerIndexes[Ee]={});let He=this.layerIndexes[Ee][ke];return He||(He=this.layerIndexes[Ee][ke]=new P,He.scope=ke),He}getWorkerSource(Ee,ke,He,ut){return this.workerSources[Ee]||(this.workerSources[Ee]={}),this.workerSources[Ee][ut]||(this.workerSources[Ee][ut]={}),this.workerSources[Ee][ut][ke]||(this.workerSources[Ee][ut][ke]={}),this.isSpriteLoaded[Ee]||(this.isSpriteLoaded[Ee]={}),this.workerSources[Ee][ut][ke][He]||(this.workerSources[Ee][ut][ke][He]=new this.workerSourceTypes[ke]({send:(ft,xt,Lt,Tt,$t,Qe)=>{this.actor.send(ft,xt,Lt,Ee,$t,Qe)},scheduler:this.actor.scheduler},this.getLayerIndex(Ee,ut),this.getAvailableImages(Ee,ut),this.isSpriteLoaded[Ee][ut],void 0,this.brightness)),this.workerSources[Ee][ut][ke][He]}rasterizeImages(Ee,ke,He){const{imageTasks:ut,scope:ft}=ke,xt={};for(const Lt in ut){const{image:Tt,imageIdWithOptions:$t}=ut[Lt];xt[Lt]=this.imageRasterizer.rasterize($t,Tt,ft,Ee)}He(void 0,xt)}removeRasterizedImages(Ee,ke,He){const{imageIds:ut,scope:ft}=ke;this.imageRasterizer.removeImagesFromCacheByIds(ut,ft,Ee),He()}getDEMWorkerSource(Ee,ke,He){return this.demWorkerSources[Ee]||(this.demWorkerSources[Ee]={}),this.demWorkerSources[Ee][He]||(this.demWorkerSources[Ee][He]={}),this.demWorkerSources[Ee][He][ke]||(this.demWorkerSources[Ee][He][ke]=new U),this.demWorkerSources[Ee][He][ke]}getRasterArrayWorkerSource(){return this.rasterArrayWorkerSource||(this.rasterArrayWorkerSource=new te),this.rasterArrayWorkerSource}enforceCacheSizeLimit(Ee,ke){r.ee(ke)}getWorkerPerformanceMetrics(Ee,ke,He){He(void 0,void 0)}}return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new Oo(self)),Oo}),p(["./shared"],function(r){var S="3.9.2";const C={create:"create",load:"load",fullLoad:"fullLoad"},M={mark(h){performance.mark(h)},measure(h,i,l){performance.measure(h,i,l)}};function P(h){const i=h.name.split("?")[0];return r.a(i)&&i.includes("mapbox-gl.js")?"javascript":r.a(i)&&i.includes("mapbox-gl.css")?"css":r.b(i)?"fontRange":r.c(i)?"sprite":r.i(i)?"style":r.d(i)?"tilejson":"other"}var z,F={},V=function(){if(z)return F;function h(m){return!i(m)}function i(m){return typeof window>"u"||typeof document>"u"?"not a browser":function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var x,E,L=new Blob([""],{type:"text/javascript"}),$=URL.createObjectURL(L);try{E=new Worker($),x=!0}catch{x=!1}return E&&E.terminate(),URL.revokeObjectURL($),x}()?function(){var x=document.createElement("canvas");x.width=x.height=1;var E=x.getContext("2d");if(!E)return!1;var L=E.getImageData(0,0,1,1);return L&&L.width===x.width}()?(l[v=m&&m.failIfMajorPerformanceCaveat]===void 0&&(l[v]=function(x){var E,L=function($){var j=document.createElement("canvas"),G=Object.create(h.webGLContextAttributes);return G.failIfMajorPerformanceCaveat=$,j.getContext("webgl2",G)}(x);if(!L)return!1;try{E=L.createShader(L.VERTEX_SHADER)}catch{return!1}return!(!E||L.isContextLost())&&(L.shaderSource(E,"void main() {}"),L.compileShader(E),L.getShaderParameter(E,L.COMPILE_STATUS)===!0)}(v)),l[v]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL2 support"):"insufficient Canvas/getImageData support":"insufficient worker support";var v}z=1,F.supported=h,F.notSupportedReason=i;var l={};return h.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0},F}();function N(h,i,l){const m=document.createElement(h);return i!=null&&(m.className=i),l&&l.appendChild(m),m}function H(h,i,l){const m=document.createElementNS("http://www.w3.org/2000/svg",h);for(const v of Object.keys(i))m.setAttributeNS(null,v,String(i[v]));return l&&l.appendChild(m),m}const U=typeof document<"u"?document.documentElement&&document.documentElement.style:null,te=U&&U.userSelect!==void 0?"userSelect":"WebkitUserSelect";let Z;function q(){U&&te&&(Z=U[te],U[te]="none")}function J(){U&&te&&(U[te]=Z)}function re(h){h.preventDefault(),h.stopPropagation(),window.removeEventListener("click",re,!0)}function se(){window.addEventListener("click",re,!0),window.setTimeout(()=>{window.removeEventListener("click",re,!0)},0)}function he(h,i){const l=h.getBoundingClientRect();return pe(h,l,i)}function le(h,i){const l=h.getBoundingClientRect(),m=[];for(let v=0;v<i.length;v++)m.push(pe(h,l,i[v]));return m}function ce(h){return window.InstallTrigger!==void 0&&h.button===2&&h.ctrlKey&&window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:h.button}function pe(h,i,l){const m=h.offsetWidth===i.width?1:h.offsetWidth/i.width;return new r.P((l.clientX-i.left)*m,(l.clientY-i.top)*m)}const de="01",Ie="NO_ACCESS_TOKEN";class Ve{constructor(i,l,m){this._transformRequestFn=i,this._customAccessToken=l,this._silenceAuthErrors=!!m,this._createSkuToken()}_createSkuToken(){const i=function(){let l="";for(let m=0;m<10;m++)l+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",de,l].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=i.token,this._skuTokenExpiresAt=i.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(i,l){return this._transformRequestFn&&this._transformRequestFn(i,l)||{url:i}}normalizeStyleURL(i,l){if(!r.f(i))return i;const m=ye(i);return m.params.push(`sdk=js-${S}`),m.path=`/styles/v1${m.path}`,this._makeAPIURL(m,this._customAccessToken||l)}normalizeGlyphsURL(i,l){if(!r.f(i))return i;const m=ye(i);return m.path=`/fonts/v1${m.path}`,this._makeAPIURL(m,this._customAccessToken||l)}normalizeModelURL(i,l){if(!r.f(i))return i;const m=ye(i);return m.path=`/models/v1${m.path}`,this._makeAPIURL(m,this._customAccessToken||l)}normalizeSourceURL(i,l,m,v){if(!r.f(i))return i;const x=ye(i);return x.path=`/v4/${x.authority}.json`,x.params.push("secure"),m&&x.params.push(`language=${m}`),v&&x.params.push(`worldview=${v}`),this._makeAPIURL(x,this._customAccessToken||l)}normalizeIconsetURL(i,l){const m=ye(i);return r.f(i)?(m.path=`/styles/v1${m.path}/iconset.pbf`,this._makeAPIURL(m,this._customAccessToken||l)):Me(m)}normalizeSpriteURL(i,l,m,v){const x=ye(i);return r.f(i)?(x.path=`/styles/v1${x.path}/sprite${l}${m}`,this._makeAPIURL(x,this._customAccessToken||v)):(x.path+=`${l}${m}`,Me(x))}normalizeTileURL(i,l,m){if(this._isSkuTokenExpired()&&this._createSkuToken(),i&&!r.f(i))return i;const v=ye(i);v.path=v.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${l||m&&v.authority!=="raster"&&m===512?"@2x":""}${r.m.supported?".webp":"$1"}`),v.authority==="raster"?v.path=`/${r.e.RASTER_URL_PREFIX}${v.path}`:v.authority==="rasterarrays"?v.path=`/${r.e.RASTERARRAYS_URL_PREFIX}${v.path}`:v.authority==="3dtiles"?v.path=`/${r.e.TILES3D_URL_PREFIX}${v.path}`:(v.path=v.path.replace(/^.+\/v4\//,"/"),v.path=`/${r.e.TILE_URL_VERSION}${v.path}`);const x=this._customAccessToken||function(E){for(const L of E){const $=L.match(/^access_token=(.*)$/);if($)return $[1]}return null}(v.params)||r.e.ACCESS_TOKEN;return r.e.REQUIRE_ACCESS_TOKEN&&x&&this._skuToken&&v.params.push(`sku=${this._skuToken}`),this._makeAPIURL(v,x)}canonicalizeTileURL(i,l){const m=ye(i);if(!m.path.match(/^(\/v4\/|\/(raster|rasterarrays)\/v1\/)/)||!m.path.match(/\.[\w]+$/))return i;let v="mapbox://";m.path.match(/^\/raster\/v1\//)?v+=`raster/${m.path.replace(`/${r.e.RASTER_URL_PREFIX}/`,"")}`:m.path.match(/^\/rasterarrays\/v1\//)?v+=`rasterarrays/${m.path.replace(`/${r.e.RASTERARRAYS_URL_PREFIX}/`,"")}`:v+=`tiles/${m.path.replace(`/${r.e.TILE_URL_VERSION}/`,"")}`;let x=m.params;return l&&(x=x.filter(E=>!E.match(/^access_token=/))),x.length&&(v+=`?${x.join("&")}`),v}canonicalizeTileset(i,l){const m=!!l&&r.f(l),v=[];for(const x of i.tiles||[])r.h(x)?v.push(this.canonicalizeTileURL(x,m)):v.push(x);return v}_makeAPIURL(i,l){const m="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",v=ye(r.e.API_URL);if(i.protocol=v.protocol,i.authority=v.authority,i.protocol==="http"){const x=i.params.indexOf("secure");x>=0&&i.params.splice(x,1)}if(v.path!=="/"&&(i.path=`${v.path}${i.path}`),!r.e.REQUIRE_ACCESS_TOKEN)return Me(i);if(l=l||r.e.ACCESS_TOKEN,!this._silenceAuthErrors){if(!l)throw new Error(`An API access token is required to use Mapbox GL. ${m}`);if(l[0]==="s")throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${m}`)}return i.params=i.params.filter(x=>x.indexOf("access_token")===-1),i.params.push(`access_token=${l||""}`),Me(i)}}const be=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function ye(h){const i=h.match(be);if(!i)throw new Error("Unable to parse URL object");return{protocol:i[1],authority:i[2],path:i[3]||"/",params:i[4]?i[4].split("&"):[]}}function Me(h){const i=h.params.length?`?${h.params.join("&")}`:"";return`${h.protocol}://${h.authority}${h.path}${i}`}const we="mapbox.eventData";function me(h){if(!h)return null;const i=h.split(".");if(!i||i.length!==3)return null;try{return JSON.parse(r.j(i[1]))}catch{return null}}class De{constructor(i){this.type=i,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(i){const l=me(r.e.ACCESS_TOKEN);let m="";return m=l&&l.u?r.k(l.u):r.e.ACCESS_TOKEN||"",i?`${we}.${i}:${m}`:`${we}:${m}`}fetchEventData(){const i=r.s("localStorage"),l=this.getStorageKey(),m=this.getStorageKey("uuid");if(i)try{const v=localStorage.getItem(l);v&&(this.eventData=JSON.parse(v));const x=localStorage.getItem(m);x&&(this.anonId=x)}catch{r.w("Unable to read from LocalStorage")}}saveEventData(){const i=r.s("localStorage"),l=this.getStorageKey(),m=this.getStorageKey("uuid"),v=this.anonId;if(i&&v)try{localStorage.setItem(m,v),Object.keys(this.eventData).length>=1&&localStorage.setItem(l,JSON.stringify(this.eventData))}catch{r.w("Unable to write to LocalStorage")}}processRequests(i){}postEvent(i,l,m,v){if(!r.e.EVENTS_URL)return;const x=ye(r.e.EVENTS_URL);x.params.push(`access_token=${v||r.e.ACCESS_TOKEN||""}`);const E={event:this.type,created:new Date(i).toISOString()},L=l?r.l(E,l):E,$={url:Me(x),headers:{"Content-Type":"text/plain"},body:JSON.stringify([L])};this.pendingRequest=r.p($,j=>{this.pendingRequest=null,m(j),this.saveEventData(),this.processRequests(v)})}queueRequest(i,l){this.queue.push(i),this.processRequests(l)}}const Ge=new class extends De{constructor(h){super("appUserTurnstile"),this._customAccessToken=h}postTurnstileEvent(h,i){r.e.EVENTS_URL&&r.e.ACCESS_TOKEN&&Array.isArray(h)&&h.some(l=>r.f(l)||r.h(l))&&this.queueRequest(Date.now(),i)}processRequests(h){if(this.pendingRequest||this.queue.length===0)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const i=me(r.e.ACCESS_TOKEN),l=i?i.u:r.e.ACCESS_TOKEN;let m=l!==this.eventData.tokenU;r.v(this.anonId)||(this.anonId=r.u(),m=!0);const v=this.queue.shift();if(this.eventData.lastSuccess){const x=new Date(this.eventData.lastSuccess),E=new Date(v),L=(v-this.eventData.lastSuccess)/864e5;m=m||L>=1||L<-1||x.getDate()!==E.getDate()}else m=!0;m?this.postEvent(v,{sdkIdentifier:"mapbox-gl-js",sdkVersion:S,skuId:de,"enabled.telemetry":!1,userId:this.anonId},x=>{x||(this.eventData.lastSuccess=v,this.eventData.tokenU=l)},h):this.processRequests()}},rt=Ge.postTurnstileEvent.bind(Ge),Oe=new class extends De{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(h,i,l,m){this.skuToken=i,this.errorCb=m,r.e.EVENTS_URL&&(l||r.e.ACCESS_TOKEN?this.queueRequest({id:h,timestamp:Date.now()},l):this.errorCb(new Error(Ie)))}processRequests(h){if(this.pendingRequest||this.queue.length===0)return;const{id:i,timestamp:l}=this.queue.shift();i&&this.success[i]||(this.anonId||this.fetchEventData(),r.v(this.anonId)||(this.anonId=r.u()),this.postEvent(l,{sdkIdentifier:"mapbox-gl-js",sdkVersion:S,skuId:de,skuToken:this.skuToken,userId:this.anonId},m=>{m?this.errorCb(m):i&&(this.success[i]=!0)},h))}remove(){this.errorCb=null}},Ct=Oe.postMapLoadEvent.bind(Oe),kt=new class extends De{constructor(){super("style.load"),this.eventIdPerMapInstanceMap=new Map,this.mapInstanceIdMap=new WeakMap}getMapInstanceId(h){let i=this.mapInstanceIdMap.get(h);return i||(i=r.u(),this.mapInstanceIdMap.set(h,i)),i}getEventId(h){const i=this.eventIdPerMapInstanceMap.get(h)||0;return this.eventIdPerMapInstanceMap.set(h,i+1),i}postStyleLoadEvent(h,i){const{map:l,style:m,importedStyles:v}=i;if(!r.e.EVENTS_URL||!h&&!r.e.ACCESS_TOKEN)return;const x=this.getMapInstanceId(l),E={mapInstanceId:x,eventId:this.getEventId(x),style:m};v.length&&(E.importedStyles=v),this.queueRequest({timestamp:Date.now(),payload:E},h)}processRequests(h){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:i,payload:l}=this.queue.shift();this.postEvent(i,l,()=>{},h)}},Bt=kt.postStyleLoadEvent.bind(kt),_t=new class extends De{constructor(){super("gljs.performance")}postPerformanceEvent(h,i){r.e.EVENTS_URL&&(h||r.e.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:i},h)}processRequests(h){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:i,performanceData:l}=this.queue.shift(),m=function(v){const x=performance.getEntriesByType("resource"),E=performance.getEntriesByType("mark"),L=function(ne){const ve={};if(ne){for(const _e in ne)if(_e!=="other")for(const Te of ne[_e]){const Ce=`${_e}ResolveRangeMin`,Re=`${_e}ResolveRangeMax`,je=`${_e}RequestCount`,Be=`${_e}RequestCachedCount`;ve[Ce]=Math.min(ve[Ce]||1/0,Te.startTime),ve[Re]=Math.max(ve[Re]||-1/0,Te.responseEnd);const et=Ze=>{ve[Ze]===void 0&&(ve[Ze]=0),++ve[Ze]};Te.transferSize!==void 0&&Te.transferSize===0&&et(Be),et(je)}}return ve}(function(ne,ve){const _e={};if(ne)for(const Te of ne){const Ce=ve(Te);_e[Ce]===void 0&&(_e[Ce]=[]),_e[Ce].push(Te)}return _e}(x,P)),$=window.devicePixelRatio,j=navigator.connection||navigator.mozConnection||navigator.webkitConnection,G=j?j.effectiveType:void 0,X={counters:[],metadata:[],attributes:[]},Y=(ne,ve,_e)=>{_e!=null&&ne.push({name:ve,value:_e.toString()})};for(const ne in L)Y(X.counters,ne,L[ne]);if(v.interactionRange[0]!==1/0&&v.interactionRange[1]!==-1/0&&(Y(X.counters,"interactionRangeMin",v.interactionRange[0]),Y(X.counters,"interactionRangeMax",v.interactionRange[1])),E)for(const ne of Object.keys(C)){const ve=C[ne],_e=E.find(Te=>Te.name===ve);_e&&Y(X.counters,ve,_e.startTime)}return Y(X.counters,"visibilityHidden",v.visibilityHidden),Y(X.attributes,"style",function(ne){if(ne)for(const ve of ne){const _e=ve.name.split("?")[0];if(r.i(_e)){const Te=_e.split("/").slice(-2);if(Te.length===2)return`mapbox://styles/${Te[0]}/${Te[1]}`}}}(x)),Y(X.attributes,"terrainEnabled",v.terrainEnabled?"true":"false"),Y(X.attributes,"fogEnabled",v.fogEnabled?"true":"false"),Y(X.attributes,"projection",v.projection),Y(X.attributes,"zoom",v.zoom),Y(X.metadata,"devicePixelRatio",$),Y(X.metadata,"connectionEffectiveType",G),Y(X.metadata,"navigatorUserAgent",navigator.userAgent),Y(X.metadata,"screenWidth",window.screen.width),Y(X.metadata,"screenHeight",window.screen.height),Y(X.metadata,"windowWidth",window.innerWidth),Y(X.metadata,"windowHeight",window.innerHeight),Y(X.metadata,"mapWidth",v.width/$),Y(X.metadata,"mapHeight",v.height/$),Y(X.metadata,"webglRenderer",v.renderer),Y(X.metadata,"webglVendor",v.vendor),Y(X.metadata,"sdkVersion",S),Y(X.metadata,"sdkIdentifier","mapbox-gl-js"),X}(l);for(const v of m.metadata);for(const v of m.counters);for(const v of m.attributes);this.postEvent(i,m,()=>{},h)}},jt=_t.postPerformanceEvent.bind(_t),Gt=new class extends De{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(h,i,l,m){if(!r.e.API_URL||!r.e.SESSION_PATH)return;const v=ye(r.e.API_URL+r.e.SESSION_PATH);v.params.push(`sku=${i||""}`),v.params.push(`access_token=${m||r.e.ACCESS_TOKEN||""}`);const x={url:Me(v),headers:{"Content-Type":"text/plain"}};this.pendingRequest=r.g(x,E=>{this.pendingRequest=null,l(E),this.saveEventData(),this.processRequests(m)})}getSessionAPI(h,i,l,m){this.skuToken=i,this.errorCb=m,r.e.SESSION_PATH&&r.e.API_URL&&(l||r.e.ACCESS_TOKEN?this.queueRequest({id:h,timestamp:Date.now()},l):this.errorCb(new Error(Ie)))}processRequests(h){if(this.pendingRequest||this.queue.length===0)return;const{id:i,timestamp:l}=this.queue.shift();i&&this.success[i]||this.getSession(l,this.skuToken,m=>{m?this.errorCb(m):i&&(this.success[i]=!0)},h)}remove(){this.errorCb=null}},Ne=Gt.getSessionAPI.bind(Gt),an=new Set;function Ae(h,i){i?an.add(h):an.delete(h)}class tt{constructor(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSourceCaches={},this._updatedPaintProps=new Set,this._updatedImages=new Set}isDirty(){return this._changed}setDirty(){this._changed=!0}getUpdatedSourceCaches(){return this._updatedSourceCaches}updateSourceCache(i,l){this._updatedSourceCaches[i]=l,this.setDirty()}discardSourceCacheUpdate(i){delete this._updatedSourceCaches[i]}updateLayer(i){const l=i.scope;this._updatedLayers[l]=this._updatedLayers[l]||new Set,this._updatedLayers[l].add(i.id),this.setDirty()}removeLayer(i){const l=i.scope;this._removedLayers[l]=this._removedLayers[l]||{},this._updatedLayers[l]=this._updatedLayers[l]||new Set,this._removedLayers[l][i.id]=i,this._updatedLayers[l].delete(i.id),this._updatedPaintProps.delete(i.fqid),this.setDirty()}getRemovedLayer(i){return this._removedLayers[i.scope]?this._removedLayers[i.scope][i.id]:null}discardLayerRemoval(i){this._removedLayers[i.scope]&&delete this._removedLayers[i.scope][i.id]}getLayerUpdatesByScope(){const i={};for(const l in this._updatedLayers)i[l]=i[l]||{},i[l].updatedIds=Array.from(this._updatedLayers[l].values());for(const l in this._removedLayers)i[l]=i[l]||{},i[l].removedIds=Object.keys(this._removedLayers[l]);return i}getUpdatedPaintProperties(){return this._updatedPaintProps}updatePaintProperties(i){this._updatedPaintProps.add(i.fqid),this.setDirty()}getUpdatedImages(){return Array.from(this._updatedImages.values())}updateImage(i){this._updatedImages.add(i),this.setDirty()}resetUpdatedImages(){this._updatedImages.clear()}reset(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSourceCaches={},this._updatedPaintProps.clear(),this._updatedImages.clear()}}function Je(h){const{userImage:i}=h;return!!(i&&i.render&&i.render())&&(h.data.replace(new Uint8Array(i.data.buffer)),!0)}class Jt extends r.E{constructor(i){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded={},this.requestors=[],this.patterns={},this.atlasImage={},this.atlasTexture={},this.dirty=!0,this.spriteFormat=i,i!=="raster"&&r.t()&&(this.imageRasterizerDispatcher=new r.D(r.x(),this,"Image Rasterizer Worker",1))}get imageRasterizer(){return this._imageRasterizer||(this._imageRasterizer=new r.I),this._imageRasterizer}createScope(i){this.images[i]={},this.loaded[i]=!1,this.updatedImages[i]={},this.patterns[i]={},this.callbackDispatchedThisFrame[i]={},this.atlasImage[i]=new r.r({width:1,height:1})}isLoaded(){for(const i in this.loaded)if(!this.loaded[i])return!1;return!0}setLoaded(i,l){if(this.loaded[l]!==i&&(this.loaded[l]=i,i)){for(const{ids:m,callback:v}of this.requestors)this._notify(m,l,v);this.requestors=[]}}hasImage(i,l){return!!this.getImage(i,l)}getImage(i,l){return this.images[l][i]}addImage(i,l,m){this._validate(i,m)&&(this.images[l][i]=m)}_validate(i,l){let m=!0;return this._validateStretch(l.stretchX,l.data&&l.data.width)||(this.fire(new r.y(new Error(`Image "${i}" has invalid "stretchX" value`))),m=!1),this._validateStretch(l.stretchY,l.data&&l.data.height)||(this.fire(new r.y(new Error(`Image "${i}" has invalid "stretchY" value`))),m=!1),this._validateContent(l.content,l)||(this.fire(new r.y(new Error(`Image "${i}" has invalid "content" value`))),m=!1),m}_validateStretch(i,l){if(!i)return!0;let m=0;for(const v of i){if(v[0]<m||v[1]<v[0]||l<v[1])return!1;m=v[1]}return!0}_validateContent(i,l){return i?i.length!==4||!l.usvg&&(i[0]<0||l.data.width<i[0]||i[1]<0||l.data.height<i[1]||i[2]<0||l.data.width<i[2]||i[3]<0||l.data.height<i[3])?!1:!(i[2]<i[0]||i[3]<i[1]):!0}updateImage(i,l,m){m.version=this.images[l][i].version+1,this.images[l][i]=m,this.updatedImages[l][i]=!0,this.removeFromImageRasterizerCache(i,l)}removeFromImageRasterizerCache(i,l){this.spriteFormat!=="raster"&&(r.t()?this.imageRasterizerDispatcher.getActor().send("removeRasterizedImages",{imageIds:[i],scope:l}):this.imageRasterizer.removeImagesFromCacheByIds([i],l))}removeImage(i,l){const m=this.images[l][i];delete this.images[l][i],delete this.patterns[l][i],this.removeFromImageRasterizerCache(i,l),m.userImage&&m.userImage.onRemove&&m.userImage.onRemove()}listImages(i){return Object.keys(this.images[i])}getImages(i,l,m){let v=!0;const x=!!this.loaded[l];if(!x)for(const E of i)this.images[l][E]||(v=!1);x||v?this._notify(i,l,m):this.requestors.push({ids:i,scope:l,callback:m})}rasterizeImages({scope:i,imageTasks:l},m){const v={};for(const x in l){const E=l[x],L=this.getImage(E.id,i);L&&(v[x]={image:L,imageIdWithOptions:E})}r.t()?this.imageRasterizerDispatcher.getActor().send("rasterizeImages",{imageTasks:v,scope:i},m):this.rasterizeImagesInMainThread({imageTasks:v,scope:i},m)}rasterizeImagesInMainThread(i,l){const{imageTasks:m,scope:v}=i,x={};for(const E in m){const{image:L,imageIdWithOptions:$}=m[E];x[E]=this.imageRasterizer.rasterize($,L,v,"")}l(void 0,x)}getUpdatedImages(i){return this.updatedImages[i]}_notify(i,l,m){const v={};for(const x of i){this.images[l][x]||this.fire(new r.z("styleimagemissing",{id:x}));const E=this.images[l][x];E?v[x]={data:E.usvg?null:E.data.clone(),pixelRatio:E.pixelRatio,sdf:E.sdf,usvg:E.usvg,version:E.version,stretchX:E.stretchX,stretchY:E.stretchY,content:E.content,hasRenderCallback:!!(E.userImage&&E.userImage.render)}:r.w(`Image "${x}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}m(null,v)}getPixelSize(i){const{width:l,height:m}=this.atlasImage[i];return{width:l,height:m}}getPattern(i,l,m){const v=this.patterns[l][i],x=this.getImage(i,l);if(!x)return null;if(v&&v.position.version===x.version)return v.position;if(v)v.position.version=x.version;else{x.usvg&&!x.data&&(x.data=this.imageRasterizer.rasterize(r.A.from(i).getPrimary(),x,l,""));const E={w:x.data.width+2*r.B,h:x.data.height+2*r.B,x:0,y:0},L=new r.F(E,x,r.B);this.patterns[l][i]={bin:E,position:L}}return this._updatePatternAtlas(l,m),this.patterns[l][i].position}bind(i,l){const m=i.gl;let v=this.atlasTexture[l];v?this.dirty&&(v.update(this.atlasImage[l]),this.dirty=!1):(v=new r.T(i,this.atlasImage[l],m.RGBA8),this.atlasTexture[l]=v),v.bind(m.LINEAR,m.CLAMP_TO_EDGE)}_updatePatternAtlas(i,l){const m=[];for(const L in this.patterns[i])m.push(this.patterns[i][L].bin);const{w:v,h:x}=r.C(m),E=this.atlasImage[i];E.resize({width:v||1,height:x||1});for(const L in this.patterns[i]){const{bin:$,position:j}=this.patterns[i][L];let G=j.padding;const X=$.x+G,Y=$.y+G,ne=this.images[i][L].data,ve=ne.width,_e=ne.height;G=G>1?G-1:G,r.r.copy(ne,E,{x:0,y:0},{x:X,y:Y},{width:ve,height:_e},l),r.r.copy(ne,E,{x:0,y:_e-G},{x:X,y:Y-G},{width:ve,height:G},l),r.r.copy(ne,E,{x:0,y:0},{x:X,y:Y+_e},{width:ve,height:G},l),r.r.copy(ne,E,{x:ve-G,y:0},{x:X-G,y:Y},{width:G,height:_e},l),r.r.copy(ne,E,{x:0,y:0},{x:X+ve,y:Y},{width:G,height:_e},l),r.r.copy(ne,E,{x:ve-G,y:_e-G},{x:X-G,y:Y-G},{width:G,height:G},l),r.r.copy(ne,E,{x:0,y:_e-G},{x:X+ve,y:Y-G},{width:G,height:G},l),r.r.copy(ne,E,{x:0,y:0},{x:X+ve,y:Y+_e},{width:G,height:G},l),r.r.copy(ne,E,{x:ve-G,y:0},{x:X-G,y:Y+_e},{width:G,height:G},l)}this.dirty=!0}beginFrame(){for(const i in this.images)this.callbackDispatchedThisFrame[i]={}}dispatchRenderCallbacks(i,l){for(const m of i){if(this.callbackDispatchedThisFrame[l][m])continue;this.callbackDispatchedThisFrame[l][m]=!0;const v=this.images[l][m];Je(v)&&this.updateImage(m,l,v)}}}function Kt(h){const i=h.key,l=h.value,m=h.valueSpec||{},v=h.objectElementValidators||{},x=h.style,E=h.styleSpec;let L=[];const $=r.H(l);if($!=="object")return[new r.V(i,l,`object expected, ${$} found`)];for(const j in l){const G=j.split(".")[0];let X;v[G]?X=v[G]:m[G]?X=xn:v["*"]?X=v["*"]:m["*"]&&(X=xn),X?L=L.concat(X({key:(i&&`${i}.`)+j,value:l[j],valueSpec:m[G]||m["*"],style:x,styleSpec:E,object:l,objectKey:j},l)):L.push(new r.G(i,l[j],`unknown property "${j}"`))}for(const j in m)v[j]||m[j].required&&m[j].default===void 0&&l[j]===void 0&&L.push(new r.V(i,l,`missing required property "${j}"`));return L}function Nt(h){const i=h.value,l=h.valueSpec,m=h.style,v=h.styleSpec,x=h.key,E=h.arrayElementValidator||xn;if(r.H(i)!=="array")return[new r.V(x,i,`array expected, ${r.H(i)} found`)];if(l.length&&i.length!==l.length)return[new r.V(x,i,`array length ${l.length} expected, length ${i.length} found`)];if(l["min-length"]&&i.length<l["min-length"])return[new r.V(x,i,`array length at least ${l["min-length"]} expected, length ${i.length} found`)];let L={type:l.value,values:l.values,minimum:l.minimum,maximum:l.maximum,function:void 0};v.$version<7&&(L.function=l.function),r.H(l.value)==="object"&&(L=l.value);let $=[];for(let j=0;j<i.length;j++)$=$.concat(E({array:i,arrayIndex:j,value:i[j],valueSpec:L,style:m,styleSpec:v,key:`${x}[${j}]`},!0));return $}function Pt(h){const i=h.key,l=h.value,m=h.valueSpec;let v=r.H(l);if(v==="number"&&l!=l&&(v="NaN"),v!=="number")return[new r.V(i,l,`number expected, ${v} found`)];if("minimum"in m){let x=m.minimum;if(r.H(m.minimum)==="array"&&(x=m.minimum[h.arrayIndex]),l<x)return[new r.V(i,l,`${l} is less than the minimum value ${x}`)]}if("maximum"in m){let x=m.maximum;if(r.H(m.maximum)==="array"&&(x=m.maximum[h.arrayIndex]),l>x)return[new r.V(i,l,`${l} is greater than the maximum value ${x}`)]}return[]}function Dt(h){const i=h.valueSpec,l=r.K(h.value.type);let m,v,x,E={};const L=l!=="categorical"&&h.value.property===void 0,$=!L,j=r.H(h.value.stops)==="array"&&r.H(h.value.stops[0])==="array"&&r.H(h.value.stops[0][0])==="object",G=Kt({key:h.key,value:h.value,valueSpec:h.styleSpec.function,style:h.style,styleSpec:h.styleSpec,objectElementValidators:{stops:function(ne){if(l==="identity")return[new r.V(ne.key,ne.value,'identity function may not have a "stops" property')];let ve=[];const _e=ne.value;return ve=ve.concat(Nt({key:ne.key,value:_e,valueSpec:ne.valueSpec,style:ne.style,styleSpec:ne.styleSpec,arrayElementValidator:X})),r.H(_e)==="array"&&_e.length===0&&ve.push(new r.V(ne.key,_e,"array must have at least one stop")),ve},default:function(ne){return xn({key:ne.key,value:ne.value,valueSpec:i,style:ne.style,styleSpec:ne.styleSpec})}}});return l==="identity"&&L&&G.push(new r.V(h.key,h.value,'missing required property "property"')),l==="identity"||h.value.stops||G.push(new r.V(h.key,h.value,'missing required property "stops"')),l==="exponential"&&h.valueSpec.expression&&!r.L(h.valueSpec)&&G.push(new r.V(h.key,h.value,"exponential functions not supported")),h.styleSpec.$version>=8&&($&&!r.M(h.valueSpec)?G.push(new r.V(h.key,h.value,"property functions not supported")):L&&!r.N(h.valueSpec)&&G.push(new r.V(h.key,h.value,"zoom functions not supported"))),l!=="categorical"&&!j||h.value.property!==void 0||G.push(new r.V(h.key,h.value,'"property" property is required')),G;function X(ne){let ve=[];const _e=ne.value,Te=ne.key;if(r.H(_e)!=="array")return[new r.V(Te,_e,`array expected, ${r.H(_e)} found`)];if(_e.length!==2)return[new r.V(Te,_e,`array length 2 expected, length ${_e.length} found`)];if(j){if(r.H(_e[0])!=="object")return[new r.V(Te,_e,`object expected, ${r.H(_e[0])} found`)];if(_e[0].zoom===void 0)return[new r.V(Te,_e,"object stop key must have zoom")];if(_e[0].value===void 0)return[new r.V(Te,_e,"object stop key must have value")];const Ce=r.K(_e[0].zoom);if(typeof Ce!="number")return[new r.V(Te,_e[0].zoom,"stop zoom values must be numbers")];if(x&&x>Ce)return[new r.V(Te,_e[0].zoom,"stop zoom values must appear in ascending order")];Ce!==x&&(x=Ce,v=void 0,E={}),ve=ve.concat(Kt({key:`${Te}[0]`,value:_e[0],valueSpec:{zoom:{}},style:ne.style,styleSpec:ne.styleSpec,objectElementValidators:{zoom:Pt,value:Y}}))}else ve=ve.concat(Y({key:`${Te}[0]`,value:_e[0],valueSpec:{},style:ne.style,styleSpec:ne.styleSpec},_e));return r.O(r.Q(_e[1]))?ve.concat([new r.V(`${Te}[1]`,_e[1],"expressions are not allowed in function stops.")]):ve.concat(xn({key:`${Te}[1]`,value:_e[1],valueSpec:i,style:ne.style,styleSpec:ne.styleSpec}))}function Y(ne,ve){const _e=r.H(ne.value),Te=r.K(ne.value),Ce=ne.value!==null?ne.value:ve;if(m){if(_e!==m)return[new r.V(ne.key,Ce,`${_e} stop domain type must match previous stop domain type ${m}`)]}else m=_e;if(_e!=="number"&&_e!=="string"&&_e!=="boolean"&&typeof Te!="number"&&typeof Te!="string"&&typeof Te!="boolean")return[new r.V(ne.key,Ce,"stop domain value must be a number, string, or boolean")];if(_e!=="number"&&l!=="categorical"){let Re=`number expected, ${_e} found`;return r.M(i)&&l===void 0&&(Re+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new r.V(ne.key,Ce,Re)]}return l!=="categorical"||_e!=="number"||typeof Te=="number"&&isFinite(Te)&&Math.floor(Te)===Te?l!=="categorical"&&_e==="number"&&typeof Te=="number"&&typeof v=="number"&&v!==void 0&&Te<v?[new r.V(ne.key,Ce,"stop domain values must appear in ascending order")]:(v=Te,l==="categorical"&&Te in E?[new r.V(ne.key,Ce,"stop domain values must be unique")]:(E[Te]=!0,[])):[new r.V(ne.key,Ce,`integer expected, found ${String(Te)}`)]}}function rn(h){const i=(h.expressionContext==="property"?r.S:r.U)(r.Q(h.value),h.valueSpec);if(i.result==="error")return i.value.map(m=>new r.V(`${h.key}${m.key}`,h.value,m.message));const l=i.value.expression||i.value._styleExpression.expression;if(h.expressionContext==="property"&&h.propertyKey==="text-font"&&!l.outputDefined())return[new r.V(h.key,h.value,`Invalid data expression for "${h.propertyKey}". Output values must be contained as literals within the expression.`)];if(h.expressionContext==="property"&&h.propertyType==="layout"&&!r.W(l))return[new r.V(h.key,h.value,'"feature-state" data expressions are not supported with layout properties.')];if(h.expressionContext==="filter")return on(l,h);if(h.expressionContext&&h.expressionContext.indexOf("cluster")===0){if(!r.X(l,["zoom","feature-state"]))return[new r.V(h.key,h.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(h.expressionContext==="cluster-initial"&&!r.Y(l))return[new r.V(h.key,h.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function on(h,i){const l=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(i.valueSpec&&i.valueSpec.expression)for(const v of i.valueSpec.expression.parameters)l.delete(v);if(l.size===0)return[];const m=[];return h instanceof r.Z&&l.has(h.name)?[new r.V(i.key,i.value,`["${h.name}"] expression is not supported in a filter for a ${i.object.type} layer with id: ${i.object.id}`)]:(h.eachChild(v=>{m.push(...on(v,i))}),m)}function Ln(h){const i=h.key,l=h.value,m=h.valueSpec,v=[];return Array.isArray(m.values)?m.values.indexOf(r.K(l))===-1&&v.push(new r.V(i,l,`expected one of [${m.values.join(", ")}], ${JSON.stringify(l)} found`)):Object.keys(m.values).indexOf(r.K(l))===-1&&v.push(new r.V(i,l,`expected one of [${Object.keys(m.values).join(", ")}], ${JSON.stringify(l)} found`)),v}function yn(h){return r.$(r.Q(h.value))?rn(r.J({},h,{expressionContext:"filter",valueSpec:h.styleSpec[`filter_${h.layerType||"fill"}`]})):Et(h)}function Et(h){const i=h.value,l=h.key;if(r.H(i)!=="array")return[new r.V(l,i,`array expected, ${r.H(i)} found`)];const m=h.styleSpec;let v,x=[];if(i.length<1)return[new r.V(l,i,"filter array must have at least 1 element")];switch(x=x.concat(Ln({key:`${l}[0]`,value:i[0],valueSpec:m.filter_operator,style:h.style,styleSpec:h.styleSpec})),r.K(i[0])){case"<":case"<=":case">":case">=":i.length>=2&&r.K(i[1])==="$type"&&x.push(new r.V(l,i,`"$type" cannot be use with operator "${i[0]}"`));case"==":case"!=":i.length!==3&&x.push(new r.V(l,i,`filter array for operator "${i[0]}" must have 3 elements`));case"in":case"!in":i.length>=2&&(v=r.H(i[1]),v!=="string"&&x.push(new r.V(`${l}[1]`,i[1],`string expected, ${v} found`)));for(let E=2;E<i.length;E++)v=r.H(i[E]),r.K(i[1])==="$type"?x=x.concat(Ln({key:`${l}[${E}]`,value:i[E],valueSpec:m.geometry_type,style:h.style,styleSpec:h.styleSpec})):v!=="string"&&v!=="number"&&v!=="boolean"&&x.push(new r.V(`${l}[${E}]`,i[E],`string, number, or boolean expected, ${v} found`));break;case"any":case"all":case"none":for(let E=1;E<i.length;E++)x=x.concat(Et({key:`${l}[${E}]`,value:i[E],style:h.style,styleSpec:h.styleSpec}));break;case"has":case"!has":v=r.H(i[1]),i.length!==2?x.push(new r.V(l,i,`filter array for "${i[0]}" operator must have 2 elements`)):v!=="string"&&x.push(new r.V(`${l}[1]`,i[1],`string expected, ${v} found`))}return x}function En(h,i){const l=h.key,m=h.style,v=h.layer,x=h.styleSpec,E=h.value,L=h.objectKey,$=x[`${i}_${h.layerType}`];if(!$)return[];const j=L.match(/^(.*)-use-theme$/);if(i==="paint"&&j&&$[j[1]])return xn({key:l,value:E,valueSpec:{type:"string"},style:m,styleSpec:x});const G=L.match(/^(.*)-transition$/);if(i==="paint"&&G&&$[G[1]]&&$[G[1]].transition)return xn({key:l,value:E,valueSpec:x.transition,style:m,styleSpec:x});const X=h.valueSpec||$[L];if(!X)return[new r.G(l,E,`unknown property "${L}"`)];let Y;if(r.H(E)==="string"&&r.M(X)&&!X.tokens&&(Y=/^{([^}]+)}$/.exec(E))){const ve=`\`{ "type": "identity", "property": ${Y?JSON.stringify(Y[1]):'"_"'} }\``;return[new r.V(l,E,`"${L}" does not support interpolation syntax
Use an identity property function instead: ${ve}.`)]}const ne=[];if(h.layerType==="symbol")L!=="text-field"||!m||m.glyphs||m.imports||ne.push(new r.V(l,E,'use of "text-field" requires a style "glyphs" property')),L==="text-font"&&r.a0(r.Q(E))&&r.K(E.type)==="identity"&&ne.push(new r.V(l,E,'"text-font" does not support identity functions'));else if(h.layerType==="model"&&i==="paint"&&v&&v.layout&&v.layout.hasOwnProperty("model-id")&&r.M(X)&&(r.a1(X)||r.N(X))){const ve=r.S(r.Q(E),X),_e=ve.value.expression||ve.value._styleExpression.expression;_e&&!r.X(_e,["measure-light"])&&(L==="model-emissive-strength"&&r.Y(_e)&&r.W(_e)||ne.push(new r.V(l,E,`${L} does not support measure-light expressions when the model layer source is vector tile or GeoJSON.`)))}return ne.concat(xn({key:h.key,value:E,valueSpec:X,style:m,styleSpec:x,expressionContext:"property",propertyType:i,propertyKey:L}))}function Xn(h){return En(h,"paint")}function vr(h){return En(h,"layout")}function er(h){let i=[];const l=h.value,m=h.key,v=h.style,x=h.styleSpec;l.type||l.ref||i.push(new r.V(m,l,'either "type" or "ref" is required'));let E=r.K(l.type);const L=r.K(l.ref);if(l.id){const $=r.K(l.id);for(let j=0;j<h.arrayIndex;j++){const G=v.layers[j];r.K(G.id)===$&&i.push(new r.V(m,l.id,`duplicate layer id "${l.id}", previously used at line ${G.id.__line__}`))}}if("ref"in l){let $;["type","source","source-layer","filter","layout"].forEach(j=>{j in l&&i.push(new r.V(m,l[j],`"${j}" is prohibited for ref layers`))}),v.layers.forEach(j=>{r.K(j.id)===L&&($=j)}),$?$.ref?i.push(new r.V(m,l.ref,"ref cannot reference another ref layer")):E=r.K($.type):typeof L=="string"&&i.push(new r.V(m,l.ref,`ref layer "${L}" not found`))}else if(E!=="background"&&E!=="sky"&&E!=="slot")if(l.source){const $=v.sources&&v.sources[l.source],j=$&&r.K($.type);$?j==="vector"&&E==="raster"?i.push(new r.V(m,l.source,`layer "${l.id}" requires a raster source`)):j==="raster"&&E!=="raster"?i.push(new r.V(m,l.source,`layer "${l.id}" requires a vector source`)):j!=="vector"||l["source-layer"]?j==="raster-dem"&&E!=="hillshade"?i.push(new r.V(m,l.source,"raster-dem source can only be used with layer type 'hillshade'.")):j!=="raster-array"||["raster","raster-particle"].includes(E)?E!=="line"||!l.paint||!l.paint["line-gradient"]&&!l.paint["line-trim-offset"]||j==="geojson"&&$.lineMetrics?E==="raster-particle"&&j!=="raster-array"&&i.push(new r.V(m,l.source,`layer "${l.id}" requires a 'raster-array' source.`)):i.push(new r.V(m,l,`layer "${l.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):i.push(new r.V(m,l.source,"raster-array source can only be used with layer type 'raster'.")):i.push(new r.V(m,l,`layer "${l.id}" must specify a "source-layer"`)):i.push(new r.V(m,l.source,`source "${l.source}" not found`))}else i.push(new r.V(m,l,'missing required property "source"'));return i=i.concat(Kt({key:m,value:l,valueSpec:x.layer,style:h.style,styleSpec:h.styleSpec,objectElementValidators:{"*":()=>[],type:()=>xn({key:`${m}.type`,value:l.type,valueSpec:x.layer.type,style:h.style,styleSpec:h.styleSpec,object:l,objectKey:"type"}),filter:$=>yn(r.J({layerType:E},$)),layout:$=>Kt({layer:l,key:$.key,value:$.value,valueSpec:{},style:$.style,styleSpec:$.styleSpec,objectElementValidators:{"*":j=>vr(r.J({layerType:E},j))}}),paint:$=>Kt({layer:l,key:$.key,value:$.value,valueSpec:{},style:$.style,styleSpec:$.styleSpec,objectElementValidators:{"*":j=>Xn(r.J({layerType:E,layer:l},j))}})}})),i}function Dr(h){const i=h.value,l=h.key,m=r.H(i);return m!=="string"?[new r.V(l,i,`string expected, ${m} found`)]:[]}const Ar={promoteId:function({key:h,value:i}){if(r.H(i)==="string")return Dr({key:h,value:i});{const l=[];for(const m in i)l.push(...Dr({key:`${h}.${m}`,value:i[m]}));return l}}};function Di(h){const i=h.value,l=h.key,m=h.styleSpec,v=h.style;if(!i.type)return[new r.V(l,i,'"type" is required')];const x=r.K(i.type);let E=[];switch(["vector","raster","raster-dem","raster-array"].includes(x)&&(i.url||i.tiles||E.push(new r.G(l,i,'Either "url" or "tiles" is required.'))),x){case"vector":case"raster":case"raster-dem":case"raster-array":return E=E.concat(Kt({key:l,value:i,valueSpec:m[`source_${x.replace("-","_")}`],style:h.style,styleSpec:m,objectElementValidators:Ar})),E;case"geojson":if(E=Kt({key:l,value:i,valueSpec:m.source_geojson,style:v,styleSpec:m,objectElementValidators:Ar}),i.cluster)for(const L in i.clusterProperties){const[$,j]=i.clusterProperties[L],G=typeof $=="string"?[$,["accumulated"],["get",L]]:$;E.push(...rn({key:`${l}.${L}.map`,value:j,expressionContext:"cluster-map"})),E.push(...rn({key:`${l}.${L}.reduce`,value:G,expressionContext:"cluster-reduce"}))}return E;case"video":return Kt({key:l,value:i,valueSpec:m.source_video,style:v,styleSpec:m});case"image":return Kt({key:l,value:i,valueSpec:m.source_image,style:v,styleSpec:m});case"canvas":return[new r.V(l,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Ln({key:`${l}.type`,value:i.type,valueSpec:{values:ui(m)},style:v,styleSpec:m})}}function ui(h){return h.source.reduce((i,l)=>{const m=h[l];return m.type.type==="enum"&&(i=i.concat(Object.keys(m.type.values))),i},[])}function zt(h){const i=h.value,l=h.styleSpec,m=l.light,v=h.style;let x=[];const E=r.H(i);if(i===void 0)return x;if(E!=="object")return x=x.concat([new r.V("light",i,`object expected, ${E} found`)]),x;for(const L in i){const $=L.match(/^(.*)-transition$/),j=L.match(/^(.*)-use-theme$/);x=x.concat(j&&m[j[1]]?xn({key:L,value:i[L],valueSpec:{type:"string"},style:v,styleSpec:l}):$&&m[$[1]]&&m[$[1]].transition?xn({key:L,value:i[L],valueSpec:l.transition,style:v,styleSpec:l}):m[L]?xn({key:L,value:i[L],valueSpec:m[L],style:v,styleSpec:l}):[new r.V(L,i[L],`unknown property "${L}"`)])}return x}function st(h){const i=h.value;let l=[];if(!i)return l;const m=r.H(i);if(m!=="object")return l=l.concat([new r.V("light-3d",i,`object expected, ${m} found`)]),l;const v=h.styleSpec,x=v["light-3d"],E=h.key,L=h.style,$=h.style.lights;for(const X of["type","id"])if(!(X in i))return l=l.concat([new r.V("light-3d",i,`missing property ${X} on light`)]),l;if(i.type&&$)for(let X=0;X<h.arrayIndex;X++){const Y=r.K(i.type),ne=$[X];r.K(ne.type)===Y&&l.push(new r.V(E,i.id,`duplicate light type "${i.type}", previously defined at line ${ne.id.__line__}`))}const j=`properties_light_${i.type}`;if(!(j in v))return l=l.concat([new r.V("light-3d",i,`Invalid light type ${i.type}`)]),l;const G=v[j];for(const X in i)if(X==="properties"){const Y=i[X],ne=r.H(Y);if(ne!=="object")return l=l.concat([new r.V("properties",Y,`object expected, ${ne} found`)]),l;for(const ve in Y)l=l.concat(G[ve]?xn({key:ve,value:Y[ve],valueSpec:G[ve],style:L,styleSpec:v}):[new r.G(h.key,Y[ve],`unknown property "${ve}"`)])}else{const Y=X.match(/^(.*)-transition$/),ne=X.match(/^(.*)-use-theme$/);l=l.concat(ne&&x[ne[1]]?xn({key:X,value:i[X],valueSpec:{type:"string"},style:L,styleSpec:v}):Y&&x[Y[1]]&&x[Y[1]].transition?xn({key:X,value:i[X],valueSpec:v.transition,style:L,styleSpec:v}):x[X]?xn({key:X,value:i[X],valueSpec:x[X],style:L,styleSpec:v}):[new r.G(X,i[X],`unknown property "${X}"`)])}return l}function Ft(h){const i=h.value,l=h.key,m=h.style,v=h.styleSpec,x=v.terrain;let E=[];const L=r.H(i);if(i===void 0||L==="null")return E;if(L!=="object")return E=E.concat([new r.V("terrain",i,`object expected, ${L} found`)]),E;for(const $ in i){const j=$.match(/^(.*)-transition$/),G=$.match(/^(.*)-use-theme$/);E=E.concat(G&&x[G[1]]?xn({key:$,value:i[$],valueSpec:{type:"string"},style:m,styleSpec:v}):j&&x[j[1]]&&x[j[1]].transition?xn({key:$,value:i[$],valueSpec:v.transition,style:m,styleSpec:v}):x[$]?xn({key:$,value:i[$],valueSpec:x[$],style:m,styleSpec:v}):[new r.G($,i[$],`unknown property "${$}"`)])}if(i.source){const $=m.sources&&m.sources[i.source],j=$&&r.K($.type);$?j!=="raster-dem"&&E.push(new r.V(l,i.source,`terrain cannot be used with a source of type ${String(j)}, it only be used with a "raster-dem" source type`)):E.push(new r.V(l,i.source,`source "${i.source}" not found`))}else E.push(new r.V(l,i,'terrain is missing required property "source"'));return E}function Ye(h){const i=h.value,l=h.style,m=h.styleSpec,v=m.fog;let x=[];const E=r.H(i);if(i===void 0)return x;if(E!=="object")return x=x.concat([new r.V("fog",i,`object expected, ${E} found`)]),x;for(const L in i){const $=L.match(/^(.*)-transition$/),j=L.match(/^(.*)-use-theme$/);x=x.concat(j&&v[j[1]]?xn({key:L,value:i[L],valueSpec:{type:"string"},style:l,styleSpec:m}):$&&v[$[1]]&&v[$[1]].transition?xn({key:L,value:i[L],valueSpec:m.transition,style:l,styleSpec:m}):v[L]?xn({key:L,value:i[L],valueSpec:v[L],style:l,styleSpec:m}):[new r.G(L,i[L],`unknown property "${L}"`)])}return x}const pn={"*":()=>[],array:Nt,boolean:function(h){const i=h.value,l=h.key,m=r.H(i);return m!=="boolean"?[new r.V(l,i,`boolean expected, ${m} found`)]:[]},number:Pt,color:function(h){const i=h.key,l=h.value,m=r.H(l);return m!=="string"?[new r.V(i,l,`color expected, ${m} found`)]:r._.parseCSSColor(l)===null?[new r.V(i,l,`color expected, "${l}" found`)]:[]},enum:Ln,filter:yn,function:Dt,layer:er,object:Kt,source:Di,model:r.a2,light:zt,"light-3d":st,terrain:Ft,fog:Ye,string:Dr,formatted:function(h){return Dr(h).length===0?[]:rn(h)},resolvedImage:function(h){return Dr(h).length===0?[]:rn(h)},projection:function(h){const i=h.value,l=h.styleSpec,m=l.projection,v=h.style;let x=[];const E=r.H(i);if(E==="object")for(const L in i)x=x.concat(xn({key:L,value:i[L],valueSpec:m[L],style:v,styleSpec:l}));else E!=="string"&&(x=x.concat([new r.V("projection",i,`object or string expected, ${E} found`)]));return x},import:function(h){const{value:i,styleSpec:l}=h,{data:m,...v}=i;Object.defineProperty(v,"__line__",{value:i.__line__,enumerable:!1});let x=Kt(r.J({},h,{value:v,valueSpec:l.import}));return r.K(v.id)===""&&x.push(new r.V(`${h.key}.id`,v,"import id can't be an empty string")),m&&(x=x.concat(yi(m,l,{key:`${h.key}.data`}))),x}};function xn(h,i=!1){const l=h.value,m=h.valueSpec,v=h.styleSpec;if(m.expression&&r.a0(r.K(l)))return Dt(h);if(m.expression&&r.O(r.Q(l)))return rn(h);if(m.type&&pn[m.type]){const x=pn[m.type](h);return i===!0&&x.length>0&&r.H(h.value)==="array"?rn(h):x}return Kt(r.J({},h,{valueSpec:m.type?v[m.type]:m}))}function _r(h){const i=h.value,l=h.key,m=Dr(h);return m.length||(i.indexOf("{fontstack}")===-1&&m.push(new r.V(l,i,'"glyphs" url must include a "{fontstack}" token')),i.indexOf("{range}")===-1&&m.push(new r.V(l,i,'"glyphs" url must include a "{range}" token'))),m}function yi(h,i=r.a3,l={}){return xn({key:l.key||"",value:h,valueSpec:i.$root,styleSpec:i,style:h,objectElementValidators:{glyphs:_r,"*":()=>[]}})}function xi(h,i=r.a3){return Lt(yi(h,i))}const Qi=h=>Lt(Di(h)),ci=h=>Lt(zt(h)),co=h=>Lt(st(h)),pi=h=>Lt(Ft(h)),Oo=h=>Lt(Ye(h)),Ut=h=>Lt(function(i){const l=i.value,m=i.style,v=i.styleSpec,x=v.snow;let E=[];const L=r.H(l);if(l===void 0)return E;if(L!=="object")return E=E.concat([new r.V("snow",l,`object expected, ${L} found`)]),E;for(const $ in l){const j=$.match(/^(.*)-transition$/);E=E.concat(j&&x[j[1]]&&x[j[1]].transition?xn({key:$,value:l[$],valueSpec:v.transition,style:m,styleSpec:v}):x[$]?xn({key:$,value:l[$],valueSpec:x[$],style:m,styleSpec:v}):[new r.G($,l[$],`unknown property "${$}"`)])}return E}(h)),Ee=h=>Lt(function(i){const l=i.value,m=i.style,v=i.styleSpec,x=v.rain;let E=[];const L=r.H(l);if(l===void 0)return E;if(L!=="object")return E=E.concat([new r.V("rain",l,`object expected, ${L} found`)]),E;for(const $ in l){const j=$.match(/^(.*)-transition$/);E=E.concat(j&&x[j[1]]&&x[j[1]].transition?xn({key:$,value:l[$],valueSpec:v.transition,style:m,styleSpec:v}):x[$]?xn({key:$,value:l[$],valueSpec:x[$],style:m,styleSpec:v}):[new r.G($,l[$],`unknown property "${$}"`)])}return E}(h)),ke=h=>Lt(er(h)),He=h=>Lt(yn(h)),ut=h=>Lt(Xn(h)),ft=h=>Lt(vr(h)),xt=h=>Lt(r.a2(h));function Lt(h){return h.slice().sort((i,l)=>i.line&&l.line?i.line-l.line:0)}function Tt(h,i){let l=!1;if(i&&i.length)for(const m of i)m instanceof r.G?r.w(m.message):(h.fire(new r.y(new Error(m.message))),l=!0);return l}let $t;class Qe extends r.E{constructor(i,l="flat"){super(),this._transitionable=new r.a4($t||($t=new r.a5({anchor:new r.a6(r.a3.light.anchor),position:new r.a7(r.a3.light.position),color:new r.a6(r.a3.light.color),intensity:new r.a6(r.a3.light.intensity)}))),this.setLight(i,l),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(i,l,m={}){this._validate(ci,i,m)||(this._transitionable.setTransitionOrValue(i),this.id=l)}updateTransitions(i){this._transitioning=this._transitionable.transitioned(i,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(i){this.properties=this._transitioning.possiblyEvaluate(i)}_validate(i,l,m){return(!m||m.validate!==!1)&&Tt(this,i.call(xi,r.l({value:l,style:{glyphs:!0,sprite:!0},styleSpec:r.a3})))}}let yt=class extends r.E{constructor(h,i,l,m){super(),this.scope=l,this._transitionable=new r.a4(new r.a5({source:new r.a6(r.a3.terrain.source),exaggeration:new r.a6(r.a3.terrain.exaggeration)}),l,m),this._transitionable.setTransitionOrValue(h,m),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=i}get(){return this._transitionable.serialize()}set(h,i){this._transitionable.setTransitionOrValue(h,i)}updateTransitions(h){this._transitioning=this._transitionable.transitioned(h,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(h){this.properties=this._transitioning.possiblyEvaluate(h)}getExaggeration(h){return this._transitioning.possiblyEvaluate(new r.a8(h)).get("exaggeration")}getAttenuationRange(){if(!this.isZoomDependent())return null;const h=this._transitionable._values.exaggeration;if(!h)return null;const i=h.value.expression;if(!i)return null;let l=-1,m=-1,v=1;for(const x of i.zoomStops)v=i.evaluate(new r.a8(x)),v>.01?(l=x,m=-1):m=x;return v<.01&&l>0&&m>l?[l,m]:null}isZoomDependent(){const h=this._transitionable._values.exaggeration;return h!=null&&h.value!=null&&h.value.expression!=null&&h.value.expression instanceof r.a9}};const Qt=45,bn=65,Mn=.05;function or(h,i,l,m){const v=r.ac(Qt,bn,l),[x,E]=dr(h,m);let L=1-Math.min(1,Math.exp((i-x)/(E-x)*-6));return L*=L*L,L=Math.min(1,1.00747*L),L*v*h.alpha}function dr(h,i){const l=.5/Math.tan(.5*i);return[h.range[0]+l,h.range[1]+l]}function ur(h,i,l,m,v){const x=r.ab.vec3.transformMat4([],[i,l,m],v.mercatorFogMatrix);return or(h,r.ab.vec3.length(x),v.pitch,v._fov)}function cr(h,i,l,m,v,x,E){const L=[[l,m,0],[v,m,0],[v,x,0],[l,x,0]];let $=Number.MAX_VALUE,j=-Number.MAX_VALUE;for(const G of L){const X=r.ab.vec3.transformMat4([],G,i),Y=r.ab.vec3.length(X);$=Math.min($,Y),j=Math.max(j,Y)}return[or(h,$,E.pitch,E._fov),or(h,j,E.pitch,E._fov)]}class ei extends r.E{constructor(i,l,m,v){super();const x=new r.a5({range:new r.a6(r.a3.fog.range),color:new r.a6(r.a3.fog.color),"color-use-theme":new r.a6({type:"string","property-type":"data-constant",default:"default"}),"high-color":new r.a6(r.a3.fog["high-color"]),"high-color-use-theme":new r.a6({type:"string","property-type":"data-constant",default:"default"}),"space-color":new r.a6(r.a3.fog["space-color"]),"space-color-use-theme":new r.a6({type:"string","property-type":"data-constant",default:"default"}),"horizon-blend":new r.a6(r.a3.fog["horizon-blend"]),"star-intensity":new r.a6(r.a3.fog["star-intensity"]),"vertical-range":new r.a6(r.a3.fog["vertical-range"])});this._transitionable=new r.a4(x,m,new Map(v)),this.set(i,v),this._transitioning=this._transitionable.untransitioned(),this._transform=l,this.properties=new r.ad(x),this.scope=m}get state(){const i=this._transform,l=i.projection.name==="globe",m=r.ae(i.zoom),v=this.properties.get("range"),x=[.5,3];return{range:l?[r.af(x[0],v[0],m),r.af(x[1],v[1],m)]:v,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(i,l,m={}){if(this._validate(Oo,i,m))return;const v=r.l({},i);for(const x of Object.keys(r.a3.fog))v[x]===void 0&&(v[x]=r.a3.fog[x].default);this._options=v,this._transitionable.setTransitionOrValue(this._options,l)}getOpacity(i){if(!this._transform.projection.supportsFog)return 0;const l=this.properties&&this.properties.get("color")||1;return(this._transform.projection.name==="globe"?1:r.ac(Qt,bn,i))*l.a}getOpacityAtLatLng(i,l){return this._transform.projection.supportsFog?function(m,v,x){const E=r.aa.fromLngLat(v),L=x.elevation?x.elevation.getAtPointOrZero(E):0;return ur(m,E.x,E.y,L,x)}(this.state,i,l):0}getOpacityForTile(i){if(!this._transform.projection.supportsFog)return[1,1];const l=this._transform.calculateFogTileMatrix(i.toUnwrapped());return cr(this.state,l,0,0,r.ag,r.ag,this._transform)}getOpacityForBounds(i,l,m,v,x){return this._transform.projection.supportsFog?cr(this.state,i,l,m,v,x,this._transform):[1,1]}getFovAdjustedRange(i){return this._transform.projection.supportsFog?dr(this.state,i):[0,1]}isVisibleOnFrustum(i){if(!this._transform.projection.supportsFog)return!1;const l=[4,5,6,7];for(const m of l){const v=i.points[m];let x;if(v[2]>=0)x=v;else{const E=i.points[m-4];x=r.ah(E,v,E[2]/(E[2]-v[2]))}if(ur(this.state,x[0],x[1],0,this._transform)>=Mn)return!0}return!1}updateConfig(i){this._transitionable.setTransitionOrValue(this._options,new Map(i))}updateTransitions(i){this._transitioning=this._transitionable.transitioned(i,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(i){this.properties=this._transitioning.possiblyEvaluate(i)}_validate(i,l,m){return(!m||m.validate!==!1)&&Tt(this,i.call(xi,r.l({value:l,style:{glyphs:!0,sprite:!0},styleSpec:r.a3})))}}let Yt,wn,Kn,Qn,di=class extends r.E{constructor(h,i,l,m){super();const v=Yt||(Yt=new r.a5({density:new r.a6(r.a3.snow.density),intensity:new r.a6(r.a3.snow.intensity),color:new r.a6(r.a3.snow.color),opacity:new r.a6(r.a3.snow.opacity),vignette:new r.a6(r.a3.snow.vignette),"vignette-color":new r.a6(r.a3.snow["vignette-color"]),"center-thinning":new r.a6(r.a3.snow["center-thinning"]),direction:new r.a6(r.a3.snow.direction),"flake-size":new r.a6(r.a3.snow["flake-size"])}));this._transitionable=new r.a4(v,l,new Map(m)),this.set(h,m),this._transitioning=this._transitionable.untransitioned(),this.properties=new r.ad(v),this.scope=l}get state(){const h=this.properties.get("opacity"),i=this.properties.get("color"),l=this.properties.get("direction"),m=r.ai(l[0]),v=-Math.max(r.ai(l[1]),.01),x=[Math.cos(m)*Math.cos(v),Math.sin(m)*Math.cos(v),Math.sin(v)],E=this.properties.get("vignette"),L=this.properties.get("vignette-color");return L.a=E,{density:this.properties.get("density"),intensity:this.properties.get("intensity"),color:new r.aj(i.r,i.g,i.b,i.a*h),direction:x,centerThinning:this.properties.get("center-thinning"),flakeSize:this.properties.get("flake-size"),vignetteColor:L}}get(){return this._transitionable.serialize()}set(h,i,l={}){if(this._validate(Ut,h,l))return;const m=r.l({},h);for(const v of Object.keys(r.a3.snow))m[v]===void 0&&(m[v]=r.a3.snow[v].default);this._options=m,this._transitionable.setTransitionOrValue(this._options,i)}updateConfig(h){this._transitionable.setTransitionOrValue(this._options,new Map(h))}updateTransitions(h){this._transitioning=this._transitionable.transitioned(h,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(h){this.properties=this._transitioning.possiblyEvaluate(h)}_validate(h,i,l){return(!l||l.validate!==!1)&&Tt(this,h.call(xi,r.l({value:i,style:{glyphs:!0,sprite:!0},styleSpec:r.a3})))}},eo=class extends r.E{constructor(h,i,l,m){super();const v=wn||(wn=new r.a5({density:new r.a6(r.a3.rain.density),intensity:new r.a6(r.a3.rain.intensity),color:new r.a6(r.a3.rain.color),opacity:new r.a6(r.a3.rain.opacity),vignette:new r.a6(r.a3.rain.vignette),"vignette-color":new r.a6(r.a3.rain["vignette-color"]),"center-thinning":new r.a6(r.a3.rain["center-thinning"]),direction:new r.a6(r.a3.rain.direction),"droplet-size":new r.a6(r.a3.rain["droplet-size"]),"distortion-strength":new r.a6(r.a3.rain["distortion-strength"])}));this._transitionable=new r.a4(v,l,new Map(m)),this.set(h,m),this._transitioning=this._transitionable.untransitioned(),this.properties=new r.ad(v),this.scope=l}get state(){const h=this.properties.get("opacity"),i=this.properties.get("color"),l=this.properties.get("direction"),m=r.ai(l[0]),v=-Math.max(r.ai(l[1]),.01),x=[Math.cos(m)*Math.cos(v),Math.sin(m)*Math.cos(v),Math.sin(v)],E=this.properties.get("vignette-color");return E.a=this.properties.get("vignette"),{density:this.properties.get("density"),intensity:this.properties.get("intensity"),color:new r.aj(i.r,i.g,i.b,i.a*h),direction:x,centerThinning:this.properties.get("center-thinning"),dropletSize:this.properties.get("droplet-size"),distortionStrength:this.properties.get("distortion-strength"),vignetteColor:E}}get(){return this._transitionable.serialize()}set(h,i,l={}){if(this._validate(Ee,h,l))return;const m=r.l({},h);for(const v of Object.keys(r.a3.rain))m[v]===void 0&&(m[v]=r.a3.rain[v].default);this._options=m,this._transitionable.setTransitionOrValue(this._options,i)}updateConfig(h){this._transitionable.setTransitionOrValue(this._options,new Map(h))}updateTransitions(h){this._transitioning=this._transitionable.transitioned(h,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(h){this.properties=this._transitioning.possiblyEvaluate(h)}_validate(h,i,l){return(!l||l.validate!==!1)&&Tt(this,h.call(xi,r.l({value:i,style:{glyphs:!0,sprite:!0},styleSpec:r.a3})))}};class vo extends r.E{constructor(i,l,m,v){super(),this.scope=m,this._options=i,this.properties=new r.ad(l),this._transitionable=new r.a4(l,m,new Map(v)),this._transitionable.setTransitionOrValue(i.properties),this._transitioning=this._transitionable.untransitioned()}updateConfig(i){this._transitionable.setTransitionOrValue(this._options.properties,new Map(i))}updateTransitions(i){this._transitioning=this._transitionable.transitioned(i,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(i){this.properties=this._transitioning.possiblyEvaluate(i)}get(){return this._options.properties=this._transitionable.serialize(),this._options}set(i,l){this._options=i,this._transitionable.setTransitionOrValue(i.properties,l)}shadowsEnabled(){return!!this.properties&&this.properties.get("cast-shadows")===!0}}class bo{constructor(i,l,m,v){this.screenBounds=i,this.cameraPoint=l,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=m,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,v)}static createFromScreenPoints(i,l){let m,v;if(i instanceof r.P||typeof i[0]=="number"){const x=r.P.convert(i);m=[x],v=l.isPointAboveHorizon(x)}else{const x=r.P.convert(i[0]),E=r.P.convert(i[1]);m=[x,E],v=r.al(x,E).every(L=>l.isPointAboveHorizon(L))}return new bo(m,l.getCameraPoint(),v,l)}isPointQuery(){return this.screenBounds.length===1}bufferedScreenGeometry(i){return r.al(this.screenBounds[0],this.screenBounds.length===1?this.screenBounds[0]:this.screenBounds[1],i)}bufferedCameraGeometry(i){const l=this.screenBounds[0],m=this.screenBounds.length===1?this.screenBounds[0].add(new r.P(1,1)):this.screenBounds[1],v=r.al(l,m,0,!1);return this.cameraPoint.y>m.y&&(this.cameraPoint.x>l.x&&this.cameraPoint.x<m.x?v.splice(3,0,this.cameraPoint):this.cameraPoint.x>=m.x?v[2]=this.cameraPoint:this.cameraPoint.x<=l.x&&(v[3]=this.cameraPoint)),r.am(v,i)}bufferedCameraGeometryGlobe(i){const l=this.screenBounds[0],m=this.screenBounds.length===1?this.screenBounds[0].add(new r.P(1,1)):this.screenBounds[1],v=r.al(l,m,i),x=this.cameraPoint.clone();switch(3*((x.y>l.y)+(x.y>m.y))+((x.x>l.x)+(x.x>m.x))){case 0:v[0]=x,v[4]=x.clone();break;case 1:v.splice(1,0,x);break;case 2:v[1]=x;break;case 3:v.splice(4,0,x);break;case 5:v.splice(2,0,x);break;case 6:v[3]=x;break;case 7:v.splice(3,0,x);break;case 8:v[2]=x}return v}containsTile(i,l,m,v=0){const x=i.queryPadding/l._pixelsPerMercatorPixel+1,E=m?this._bufferedCameraMercator(x,l):this._bufferedScreenMercator(x,l);let L=i.tileID.wrap+(E.unwrapped?v:0);const $=E.polygon.map(Te=>r.an(i.tileTransform,Te,L));if(!r.ao($,0,0,r.ag,r.ag))return;L=i.tileID.wrap+(this.screenGeometryMercator.unwrapped?v:0);const j=this.screenGeometryMercator.polygon.map(Te=>r.ap(i.tileTransform,Te,L)),G=j.map(Te=>new r.P(Te[0],Te[1])),X=l.getFreeCameraOptions().position||new r.aa(0,0,0),Y=r.ap(i.tileTransform,X,L),ne=j.map(Te=>{const Ce=r.ab.vec3.sub(Te,Te,Y);return r.ab.vec3.normalize(Ce,Ce),new r.aq(Y,Ce)}),ve=r.ar(i,1,l.zoom)*l._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:G,tilespaceRays:ne,bufferedTilespaceGeometry:$,bufferedTilespaceBounds:(_e=r.as($),_e.min.x=r.aw(_e.min.x,0,r.ag),_e.min.y=r.aw(_e.min.y,0,r.ag),_e.max.x=r.aw(_e.max.x,0,r.ag),_e.max.y=r.aw(_e.max.y,0,r.ag),_e),tile:i,tileID:i.tileID,pixelToTileUnitsFactor:ve};var _e}_bufferedScreenMercator(i,l){const m=cf(i);if(this._screenRaycastCache[m])return this._screenRaycastCache[m];{let v;return v=l.projection.name==="globe"?this._projectAndResample(this.bufferedScreenGeometry(i),l):{polygon:this.bufferedScreenGeometry(i).map(x=>l.pointCoordinate3D(x)),unwrapped:!0},this._screenRaycastCache[m]=v,v}}_bufferedCameraMercator(i,l){const m=cf(i);if(this._cameraRaycastCache[m])return this._cameraRaycastCache[m];{let v;return v=l.projection.name==="globe"?this._projectAndResample(this.bufferedCameraGeometryGlobe(i),l):{polygon:this.bufferedCameraGeometry(i).map(x=>l.pointCoordinate3D(x)),unwrapped:!0},this._cameraRaycastCache[m]=v,v}}_projectAndResample(i,l){const m=function(x,E){const L=r.ab.mat4.multiply([],E.pixelMatrix,E.globeMatrix),$=[0,-r.ax,0,1],j=[0,r.ax,0,1],G=[0,0,0,1];r.ab.vec4.transformMat4($,$,L),r.ab.vec4.transformMat4(j,j,L),r.ab.vec4.transformMat4(G,G,L);const X=new r.P($[0]/$[3],$[1]/$[3]),Y=new r.P(j[0]/j[3],j[1]/j[3]),ne=r.au(x,X)&&$[3]<G[3],ve=r.au(x,Y)&&j[3]<G[3];if(!ne&&!ve)return null;const _e=function(Xe,Ke,at){for(let pt=1;pt<Xe.length;pt++){const Vt=Ea(Ke.pointCoordinate3D(Xe[pt-1]).x),Rt=Ea(Ke.pointCoordinate3D(Xe[pt]).x);if(at<0){if(Vt<Rt)return{idx:pt,t:-Vt/(Rt-1-Vt)}}else if(Rt<Vt)return{idx:pt,t:(1-Vt)/(Rt+1-Vt)}}return null}(x,E,ne?-1:1);if(!_e)return null;const{idx:Te,t:Ce}=_e;let Re=Te>1?gl(x.slice(0,Te),E):[],je=Te<x.length?gl(x.slice(Te),E):[];Re=Re.map(Xe=>new r.P(Ea(Xe.x),Xe.y)),je=je.map(Xe=>new r.P(Ea(Xe.x),Xe.y));const Be=[...Re];Be.length===0&&Be.push(je[je.length-1]);const et=r.af(Be[Be.length-1].y,(je.length===0?Re[0]:je[0]).y,Ce);let Ze;return Ze=ne?[new r.P(0,et),new r.P(0,0),new r.P(1,0),new r.P(1,et)]:[new r.P(1,et),new r.P(1,1),new r.P(0,1),new r.P(0,et)],Be.push(...Ze),je.length===0?Be.push(Re[0]):Be.push(...je),{polygon:Be.map(Xe=>new r.aa(Xe.x,Xe.y)),unwrapped:!1}}(i,l);if(m)return m;const v=function(x,E){let L=!1,$=-1/0,j=0;for(let X=0;X<x.length-1;X++)x[X].x>$&&($=x[X].x,j=X);for(let X=0;X<x.length-1;X++){const Y=(j+X)%(x.length-1),ne=x[Y],ve=x[Y+1];Math.abs(ne.x-ve.x)>.5&&(ne.x<ve.x?(ne.x+=1,Y===0&&(x[x.length-1].x+=1)):(ve.x+=1,Y+1===x.length-1&&(x[0].x+=1)),L=!0)}const G=r.at(E.center.lng);return L&&G<Math.abs(G-1)&&x.forEach(X=>{X.x-=1}),{polygon:x,unwrapped:L}}(gl(i,l).map(x=>new r.P(Ea(x.x),x.y)),l);return{polygon:v.polygon.map(x=>new r.aa(x.x,x.y)),unwrapped:v.unwrapped}}}function gl(h,i){return r.av(h,l=>{const m=i.pointCoordinate3D(l);l.x=m.x,l.y=m.y},1/256)}function Ea(h){return h<0?1+h%1:h%1}function cf(h){return 100*h|0}function Bc(h,i,l,m,v){const x=function(L,$){if(L)return v(L);if($){if(h.url&&$.tiles&&h.tiles&&delete h.tiles,$.variants){if(!Array.isArray($.variants))return v(new Error("variants must be an array"));for(const G of $.variants){if(G==null||typeof G!="object"||G.constructor!==Object)return v(new Error("variant must be an object"));if(!Array.isArray(G.capabilities))return v(new Error("capabilities must be an array"));if(G.capabilities.length===1&&G.capabilities[0]==="meshopt"){$=r.l($,G);break}}}const j=r.ay(r.l({},$,h),["tilejson","tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding","vector_layers","raster_layers","worldview_options","worldview_default","worldview"]);j.tiles=i.canonicalizeTileset(j,h.url),v(null,j)}},E=function(L,$,j){if(!L)return null;if(!$&&!j)return L;j=j||L.worldview_default;const G=Object.values(L.language||{});if(G.length===0)return null;const X=Object.values(L.worldview||{});if(X.length===0)return null;const Y=G.every(ve=>ve===$),ne=X.every(ve=>ve===j);return Y&&ne?L:$ in(L.language_options||{})||j in(L.worldview_options||{})?null:L.language_options&&L.worldview_options?L:null}(h.data,l,m);return E?r.q.frame(()=>x(null,E)):h.url?r.n(i.transformRequest(i.normalizeSourceURL(h.url,null,l,m),r.R.Source),x):r.q.frame(()=>{const{data:L,...$}=h;x(null,$)})}class _l{constructor(i,l,m){this.bounds=r.az.convert(this.validateBounds(i)),this.minzoom=l||0,this.maxzoom=m||24}validateBounds(i){return Array.isArray(i)&&i.length===4?[Math.max(-180,i[0]),Math.max(-90,i[1]),Math.min(180,i[2]),Math.min(90,i[3])]:[-180,-90,180,90]}contains(i){const l=Math.pow(2,i.z),m=Math.floor(r.at(this.bounds.getWest())*l),v=Math.floor(r.aA(this.bounds.getNorth())*l),x=Math.ceil(r.at(this.bounds.getEast())*l),E=Math.ceil(r.aA(this.bounds.getSouth())*l);return i.x>=m&&i.x<x&&i.y>=v&&i.y<E}}class Lh extends r.E{constructor(i,l,m,v){if(super(),this.id=i,this.dispatcher=m,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,r.l(this,r.ay(l,["url","scheme","tileSize","promoteId"])),this._options=r.l({type:"vector"},l),this._collectResourceTiming=!!l.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(v),this._tileWorkers={},this._deduped=new r.aB}load(i){this._loaded=!1,this.fire(new r.z("dataloading",{dataType:"source"}));const l=Array.isArray(this.map._language)?this.map._language.join():this.map._language,m=this.map.getWorldview();this._tileJSONRequest=Bc(this._options,this.map._requestManager,l,m,(v,x)=>{if(this._tileJSONRequest=null,this._loaded=!0,v)l&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${l}`),m&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${m}`),this.fire(new r.y(v));else if(x){if(r.l(this,x),this.hasWorldviews=!!x.worldview_options,x.worldview_default&&(this.worldviewDefault=x.worldview_default),x.vector_layers){this.vectorLayers=x.vector_layers,this.vectorLayerIds=[],this.localizableLayerIds=new Set;for(const E of x.vector_layers)this.vectorLayerIds.push(E.id),x.worldview&&x.worldview[E.source]&&this.localizableLayerIds.add(E.id)}x.bounds&&(this.tileBounds=new _l(x.bounds,this.minzoom,this.maxzoom)),rt(x.tiles,this.map._requestManager._customAccessToken),this.fire(new r.z("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new r.z("data",{dataType:"source",sourceDataType:"content"}))}i&&i(v)})}loaded(){return this._loaded}hasTile(i){return!this.tileBounds||this.tileBounds.contains(i.canonical)}onAdd(i){this.map=i,this.load()}reload(){this.cancelTileJSONRequest();const i=r.aC(this.id,this.scope);this.load(()=>this.map.style.clearSource(i))}setTiles(i){return this._options.tiles=i,this.reload(),this}setUrl(i){return this.url=i,this._options.url=i,this.reload(),this}onRemove(i){this.cancelTileJSONRequest()}serialize(){return r.l({},this._options)}loadTile(i,l){const m=i.tileID.canonical.url(this.tiles,this.scheme),v=this.map._requestManager.normalizeTileURL(m),x=this.map._requestManager.transformRequest(v,r.R.Tile),E=this.map.style?this.map.style.getLut(this.scope):null,L=E?{image:E.image.clone()}:null,$={request:x,data:void 0,uid:i.uid,tileID:i.tileID,tileZoom:i.tileZoom,zoom:i.tileID.overscaledZ,maxZoom:this.maxzoom,lut:L,tileSize:this.tileSize*i.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,pixelRatio:r.q.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:i.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0,extraShadowCaster:i.isExtraShadowCaster,tessellationStep:this.map._tessellationStep,scaleFactor:this.map.getScaleFactor()};if(this.hasWorldviews&&r.f(m)&&($.worldview=this.map.getWorldview()||this.worldviewDefault,$.localizableLayerIds=this.localizableLayerIds),$.request.collectResourceTiming=this._collectResourceTiming,i.actor&&i.state!=="expired")i.state==="loading"?i.reloadCallback=l:i.request=i.actor.send("reloadTile",$,j.bind(this));else if(i.actor=this._tileWorkers[v]=this._tileWorkers[v]||this.dispatcher.getActor(),this.dispatcher.ready)i.request=i.actor.send("loadTile",$,j.bind(this),void 0,!0);else{const G=r.aD.call({deduped:this._deduped},$,(X,Y)=>{X||!Y?j.call(this,X):($.data={cacheControl:Y.cacheControl,expires:Y.expires,rawData:Y.rawData.slice(0)},i.actor&&i.actor.send("loadTile",$,j.bind(this),void 0,!0))},!0);i.request={cancel:G}}function j(G,X){return delete i.request,i.aborted?l(null):G&&G.status!==404?l(G):(X&&X.resourceTiming&&(i.resourceTiming=X.resourceTiming),this.map._refreshExpiredTiles&&X&&i.setExpiryData(X),i.loadVectorData(X,this.map.painter),r.aE(this.dispatcher),l(null),void(i.reloadCallback&&(this.loadTile(i,i.reloadCallback),i.reloadCallback=null)))}}abortTile(i){i.request&&(i.request.cancel(),delete i.request),i.actor&&i.actor.send("abortTile",{uid:i.uid,type:this.type,source:this.id,scope:this.scope})}unloadTile(i,l){i.actor&&i.actor.send("removeTile",{uid:i.uid,type:this.type,source:this.id,scope:this.scope}),i.destroy()}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class Vc extends r.E{constructor(i,l,m,v){super(),this.id=i,this.dispatcher=m,this.setEventedParent(v),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=r.l({type:"raster"},l),r.l(this,r.ay(l,["url","scheme","tileSize"]))}load(i){this._loaded=!1,this.fire(new r.z("dataloading",{dataType:"source"})),this._tileJSONRequest=Bc(this._options,this.map._requestManager,null,null,(l,m)=>{this._tileJSONRequest=null,this._loaded=!0,l?this.fire(new r.y(l)):m&&(r.l(this,m),m.raster_layers&&(this.rasterLayers=m.raster_layers,this.rasterLayerIds=this.rasterLayers.map(v=>v.id)),m.bounds&&(this.tileBounds=new _l(m.bounds,this.minzoom,this.maxzoom)),rt(m.tiles),this.fire(new r.z("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new r.z("data",{dataType:"source",sourceDataType:"content"}))),i&&i(l)})}loaded(){return this._loaded}onAdd(i){this.map=i,this.load()}reload(){this.cancelTileJSONRequest();const i=r.aC(this.id,this.scope);this.load(()=>this.map.style.clearSource(i))}setTiles(i){return this._options.tiles=i,this.reload(),this}setUrl(i){return this.url=i,this._options.url=i,this.reload(),this}onRemove(i){this.cancelTileJSONRequest()}serialize(){return r.l({},this._options)}hasTile(i){return!this.tileBounds||this.tileBounds.contains(i.canonical)}loadTile(i,l){const m=r.q.devicePixelRatio>=2,v=this.map._requestManager.normalizeTileURL(i.tileID.canonical.url(this.tiles,this.scheme),m,this.tileSize);i.request=r.o(this.map._requestManager.transformRequest(v,r.R.Tile),(x,E,L,$)=>(delete i.request,i.aborted?(i.state="unloaded",l(null)):x?(i.state="errored",l(x)):E?(this.map._refreshExpiredTiles&&i.setExpiryData({cacheControl:L,expires:$}),i.setTexture(E,this.map.painter),i.state="loaded",r.aE(this.dispatcher),void l(null)):l(null)))}abortTile(i,l){i.request&&(i.request.cancel(),delete i.request),l&&l()}unloadTile(i,l){i.texture&&i.texture instanceof r.T?(i.destroy(!0),i.texture&&i.texture instanceof r.T&&this.map.painter.saveTileTexture(i.texture)):i.destroy(),l&&l()}hasTransition(){return!1}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class yl extends Vc{constructor(i,l,m,v){super(i,l,m,v),this.type="raster-array",this.maxzoom=22,this._options=r.l({type:"raster-array"},l)}triggerRepaint(i){const l=this.map.painter._terrain,m=this.map.style.getSourceCache(this.id);l&&l.enabled&&m&&l._clearRenderCacheForTile(m.id,i.tileID),this.map.triggerRepaint()}loadTile(i,l){const m=this.map._requestManager.normalizeTileURL(i.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize),v=this.map._requestManager.transformRequest(m,r.R.Tile);i.requestParams=v,i.actor||(i.actor=this.dispatcher.getActor()),i.request=i.fetchHeader(void 0,(x,E,L,$)=>{if(delete i.request,i.aborted)return i.state="unloaded",l(null);if(x)return x.code===20?void 0:(i.state="errored",l(x));this.map._refreshExpiredTiles&&i.setExpiryData({cacheControl:L,expires:$}),i.state="empty",l(null)})}unloadTile(i,l){const m=i.texture;m&&m instanceof r.T?(i.destroy(!0),this.map.painter.saveTileTexture(m)):(i.destroy(),i.flushQueues(),i._isHeaderLoaded=!1,delete i._mrt,delete i.textureDescriptor),i.fbo&&(i.fbo.destroy(),delete i.fbo),delete i.request,delete i.requestParams,delete i.neighboringTiles,i.state="unloaded"}prepareTile(i,l,m){i._isHeaderLoaded&&(i.state!=="empty"&&(i.state="reloading"),i.fetchBand(l,m,(v,x)=>{if(v)return i.state="errored",this.fire(new r.y(v)),void this.triggerRepaint(i);x&&(i.setTexture(x,this.map.painter),i.state="loaded",this.triggerRepaint(i))}))}getInitialBand(i){if(!this.rasterLayers)return 0;const l=this.rasterLayers.find(({id:x})=>x===i),m=l&&l.fields,v=m&&m.bands&&m.bands;return v?v[0]:0}getTextureDescriptor(i,l,m){if(!i)return;const v=l.sourceLayer||this.rasterLayerIds&&this.rasterLayerIds[0];if(!v)return;let x=null;l instanceof r.aH?x=l.paint.get("raster-array-band"):l instanceof r.aI&&(x=l.paint.get("raster-particle-array-band"));const E=x||this.getInitialBand(v);if(E!=null)if(i.textureDescriptor){if(!i.updateNeeded(v,E)||m)return Object.assign({},i.textureDescriptor,{texture:i.texture})}else this.prepareTile(i,v,E)}}const Zu={vector:Lh,raster:Vc,"raster-dem":class extends Vc{constructor(h,i,l,m){super(h,i,l,m),this.type="raster-dem",this.maxzoom=22,this._options=r.l({type:"raster-dem"},i),this.encoding=i.encoding||"mapbox"}loadTile(h,i){const l=this.map._requestManager.normalizeTileURL(h.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function m(v,x){v&&(h.state="errored",i(v)),x&&(h.dem=x,h.dem.onDeserialize(),h.needsHillshadePrepare=!0,h.needsDEMTextureUpload=!0,h.state="loaded",i(null))}h.request=r.o(this.map._requestManager.transformRequest(l,r.R.Tile),(function(v,x,E,L){if(delete h.request,h.aborted)h.state="unloaded",i(null);else if(v)h.state="errored",i(v);else if(x){this.map._refreshExpiredTiles&&h.setExpiryData({cacheControl:E,expires:L});const $=ImageBitmap&&x instanceof ImageBitmap&&r.t(),j=1-(x.width-r.aF(x.width))/2;j<1||h.neighboringTiles||(h.neighboringTiles=this._getNeighboringTiles(h.tileID));const G=$?x:r.q.getImageData(x,j),X={uid:h.uid,coord:h.tileID,source:this.id,scope:this.scope,rawImageData:G,encoding:this.encoding,padding:j};h.actor&&h.state!=="expired"||(h.actor=this.dispatcher.getActor(),h.actor.send("loadDEMTile",X,m.bind(this),void 0,!0))}}).bind(this))}_getNeighboringTiles(h){const i=h.canonical,l=Math.pow(2,i.z),m=(i.x-1+l)%l,v=i.x===0?h.wrap-1:h.wrap,x=(i.x+1+l)%l,E=i.x+1===l?h.wrap+1:h.wrap,L={};return L[new r.aG(h.overscaledZ,v,i.z,m,i.y).key]={backfilled:!1},L[new r.aG(h.overscaledZ,E,i.z,x,i.y).key]={backfilled:!1},i.y>0&&(L[new r.aG(h.overscaledZ,v,i.z,m,i.y-1).key]={backfilled:!1},L[new r.aG(h.overscaledZ,h.wrap,i.z,i.x,i.y-1).key]={backfilled:!1},L[new r.aG(h.overscaledZ,E,i.z,x,i.y-1).key]={backfilled:!1}),i.y+1<l&&(L[new r.aG(h.overscaledZ,v,i.z,m,i.y+1).key]={backfilled:!1},L[new r.aG(h.overscaledZ,h.wrap,i.z,i.x,i.y+1).key]={backfilled:!1},L[new r.aG(h.overscaledZ,E,i.z,x,i.y+1).key]={backfilled:!1}),L}},"raster-array":yl,geojson:class extends r.E{constructor(h,i,l,m){super(),this.id=h,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=l.getActor(),this.setEventedParent(m),this._data=i.data,this._options=r.l({},i),this._collectResourceTiming=i.collectResourceTiming,i.maxzoom!==void 0&&(this.maxzoom=i.maxzoom),i.minzoom!==void 0&&(this.minzoom=i.minzoom),i.type&&(this.type=i.type),i.attribution&&(this.attribution=i.attribution),this.promoteId=i.promoteId;const v=r.ag/this.tileSize;this.workerOptions=r.l({source:this.id,scope:this.scope,cluster:i.cluster||!1,geojsonVtOptions:{buffer:(i.buffer!==void 0?i.buffer:128)*v,tolerance:(i.tolerance!==void 0?i.tolerance:.375)*v,extent:r.ag,maxZoom:this.maxzoom,lineMetrics:i.lineMetrics||!1,generateId:i.generateId||!1},superclusterOptions:{maxZoom:i.clusterMaxZoom!==void 0?i.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,i.clusterMinPoints||2),extent:r.ag,radius:(i.clusterRadius!==void 0?i.clusterRadius:50)*v,log:!1,generateId:i.generateId||!1},clusterProperties:i.clusterProperties,filter:i.filter,dynamic:i.dynamic},i.workerOptions)}onAdd(h){this.map=h,this.setData(this._data)}setData(h){return this._data=h,this._updateWorkerData(),this}updateData(h){if(!this._options.dynamic)return this.fire(new r.y(new Error("Can't call updateData on a GeoJSON source with dynamic set to false.")));if(typeof h!="string"&&(h.type==="Feature"&&(h={type:"FeatureCollection",features:[h]}),h.type!=="FeatureCollection"))return this.fire(new r.y(new Error("Data to update should be a feature or a feature collection.")));if(this._coalesce&&typeof h!="string"&&typeof this._data!="string"&&this._data.type==="FeatureCollection"){const i=new Map;for(const l of this._data.features)i.set(l.id,l);for(const l of h.features)i.set(l.id,l);this._data.features=[...i.values()]}else this._data=h;return this._updateWorkerData(!0),this}getClusterExpansionZoom(h,i){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:h,source:this.id,scope:this.scope},i),this}getClusterChildren(h,i){return this.actor.send("geojson.getClusterChildren",{clusterId:h,source:this.id,scope:this.scope},i),this}getClusterLeaves(h,i,l,m){return this.actor.send("geojson.getClusterLeaves",{source:this.id,scope:this.scope,clusterId:h,limit:i,offset:l},m),this}_updateWorkerData(h=!1){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new r.z("dataloading",{dataType:"source"})),this._loaded=!1;const i=r.l({append:h},this.workerOptions);i.scope=this.scope;const l=this._data;typeof l=="string"?(i.request=this.map._requestManager.transformRequest(r.q.resolveURL(l),r.R.Source),i.request.collectResourceTiming=this._collectResourceTiming):i.data=JSON.stringify(l),this._pendingLoad=this.actor.send(`${this.type}.loadData`,i,(m,v)=>{if(this._loaded=!0,this._pendingLoad=null,m)this.fire(new r.y(m));else{const x={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&v&&v.resourceTiming&&v.resourceTiming[this.id]&&(x.resourceTiming=v.resourceTiming[this.id]),h&&(this._partialReload=!0),this.fire(new r.z("data",x)),this._partialReload=!1,this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(h),this._coalesce=!1)})}loaded(){return this._loaded}loadTile(h,i){const l=h.actor?"reloadTile":"loadTile";h.actor=this.actor;const m=this.map.style?this.map.style.getLut(this.scope):null,v=m?{image:m.image.clone()}:null,x=this._partialReload,E={type:this.type,uid:h.uid,tileID:h.tileID,tileZoom:h.tileZoom,zoom:h.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,lut:v,scope:this.scope,pixelRatio:r.q.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,brightness:this.map.style&&this.map.style.getBrightness()||0,scaleFactor:this.map.getScaleFactor(),partial:x};h.request=this.actor.send(l,E,(L,$)=>x&&!$?(h.state="loaded",i(null)):(delete h.request,h.destroy(),h.aborted?i(null):L?i(L):(h.loadVectorData($,this.map.painter,l==="reloadTile"),i(null))),void 0,l==="loadTile")}abortTile(h){h.request&&(h.request.cancel(),delete h.request),h.aborted=!0}unloadTile(h,i){this.actor.send("removeTile",{uid:h.uid,type:this.type,source:this.id,scope:this.scope}),h.destroy()}onRemove(h){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return r.l({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends r.aJ{constructor(h,i,l,m){super(h,i,l,m),this.roundZoom=!0,this.type="video",this.options=i}load(){this._loaded=!1;const h=this.options;this.urls=[];for(const i of h.urls)this.urls.push(this.map._requestManager.transformRequest(i,r.R.Source).url);r.aK(this.urls,(i,l)=>{this._loaded=!0,i?this.fire(new r.y(i)):l&&(this.video=l,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(h){if(this.video){const i=this.video.seekable;h<i.start(0)||h>i.end(0)?this.fire(new r.y(new r.V(`sources.${this.id}`,null,`Playback for this video can be set only between the ${i.start(0)} and ${i.end(0)}-second mark.`))):this.video.currentTime=h}}getVideo(){return this.video}onAdd(h){this.map||(this.map=h,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const h=this.map.painter.context,i=h.gl;this.texture?this.video.paused||(this.texture.bind(i.LINEAR,i.CLAMP_TO_EDGE),i.texSubImage2D(i.TEXTURE_2D,0,0,0,i.RGBA,i.UNSIGNED_BYTE,this.video)):(this.texture=new r.T(h,this.video,i.RGBA8),this.texture.bind(i.LINEAR,i.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(h)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:r.aJ,model:class extends r.E{constructor(h,i,l,m){super(),this.id=h,this.type="model",this.models=[],this._loaded=!1,this._options=i}load(){const h=[];for(const i in this._options.models){const l=this._options.models[i],m=r.aM(this.map._requestManager.transformRequest(l.uri,r.R.Model).url).then(v=>{if(!v)return;const x=r.aN(v),E=new r.aO(i,l.position,l.orientation,x);E.computeBoundsAndApplyParent(),this.models.push(E)}).catch(v=>{this.fire(new r.y(new Error(`Could not load model ${i} from ${l.uri}: ${v.message}`)))});h.push(m)}return Promise.allSettled(h).then(()=>{this._loaded=!0,this.fire(new r.z("data",{dataType:"source",sourceDataType:"metadata"}))}).catch(i=>{this.fire(new r.y(new Error(`Could not load models: ${i.message}`)))})}onAdd(h){this.map=h,this.load()}hasTransition(){return!1}loaded(){return this._loaded}getModels(){return this.models}loadTile(h,i){}serialize(){return{type:"model"}}},"batched-model":class extends r.E{constructor(h,i,l,m){super(),this.type="batched-model",this.id=h,this.tileSize=512,this._options=i,this.tiles=this._options.tiles,this.maxzoom=i.maxzoom||19,this.minzoom=i.minzoom||0,this.roundZoom=!0,this.usedInConflation=!0,this.dispatcher=l,this.reparseOverscaled=!1,this.scheme="xyz",this._loaded=!1,this.setEventedParent(m)}onAdd(h){this.map=h,this.load()}load(h){this._loaded=!1,this.fire(new r.z("dataloading",{dataType:"source"}));const i=Array.isArray(this.map._language)?this.map._language.join():this.map._language,l=this.map.getWorldview();this._tileJSONRequest=Bc(this._options,this.map._requestManager,i,l,(m,v)=>{this._tileJSONRequest=null,this._loaded=!0,m?(i&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${i}`),l&&l.length!==2&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${l}`),this.fire(new r.y(m))):v&&(r.l(this,v),v.bounds&&(this.tileBounds=new _l(v.bounds,this.minzoom,this.maxzoom)),rt(v.tiles,this.map._requestManager._customAccessToken),this.fire(new r.z("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new r.z("data",{dataType:"source",sourceDataType:"content"}))),h&&h(m)})}hasTransition(){return!1}hasTile(h){return!this.tileBounds||this.tileBounds.contains(h.canonical)}loaded(){return this._loaded}loadTile(h,i){const l=this.map._requestManager.normalizeTileURL(h.tileID.canonical.url(this.tiles,this.scheme)),m={request:this.map._requestManager.transformRequest(l,r.R.Tile),data:void 0,uid:h.uid,tileID:h.tileID,tileZoom:h.tileZoom,zoom:h.tileID.overscaledZ,tileSize:this.tileSize*h.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,showCollisionBoxes:this.map.showCollisionBoxes,isSymbolTile:h.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0,lut:null,maxZoom:null,promoteId:null,pixelRatio:null,scaleFactor:null};if(h.actor&&h.state!=="expired")if(h.state==="loading")h.reloadCallback=i;else{if(h.buckets){const x=Object.values(h.buckets);for(const E of x)E.dirty=!0;return void(h.state="loaded")}h.request=h.actor.send("reloadTile",m,v.bind(this))}else h.actor=this.dispatcher.getActor(),h.request=h.actor.send("loadTile",m,v.bind(this),void 0,!0);function v(x,E){return h.aborted?i(null):x&&x.status!==404?i(x):(this.map._refreshExpiredTiles&&E&&h.setExpiryData(E),h.loadModelData(E,this.map.painter),h.state="loaded",void i(null))}}serialize(){return r.l({},this._options)}},canvas:class extends r.aJ{constructor(h,i,l,m){super(h,i,l,m),i.coordinates?Array.isArray(i.coordinates)&&i.coordinates.length===4&&!i.coordinates.some(v=>!Array.isArray(v)||v.length!==2||v.some(x=>typeof x!="number"))||this.fire(new r.y(new r.V(`sources.${h}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new r.y(new r.V(`sources.${h}`,null,'missing required property "coordinates"'))),i.animate&&typeof i.animate!="boolean"&&this.fire(new r.y(new r.V(`sources.${h}`,null,'optional "animate" property must be a boolean value'))),i.canvas?typeof i.canvas=="string"||i.canvas instanceof HTMLCanvasElement||this.fire(new r.y(new r.V(`sources.${h}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new r.y(new r.V(`sources.${h}`,null,'missing required property "canvas"'))),this.options=i,this.animate=i.animate===void 0||i.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new r.y(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(h){this.map=h,this.load(),this.canvas&&this.animate&&this.play()}onRemove(h){this.pause()}prepare(){let h=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,h=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,h=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const i=this.map.painter.context;this.texture?!h&&!this._playing||this.texture instanceof r.aL||this.texture.update(this.canvas,{premultiply:!0}):this.texture=new r.T(i,this.canvas,i.gl.RGBA8,{premultiply:!0}),this._prepareData(i)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const h of[this.canvas.width,this.canvas.height])if(isNaN(h)||h<=0)return!0;return!1}},custom:class extends r.E{constructor(h,i,l,m){super(),this.id=h,this.type="custom",this._dataType="raster",this._dispatcher=l,this._implementation=i,this.setEventedParent(m),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new r.y(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new r.y(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new _l(this._implementation.bounds,this.minzoom,this.maxzoom)),i.update=this._update.bind(this),i.clearTiles=this._clearTiles.bind(this),i.coveringTiles=this._coveringTiles.bind(this),r.l(this,r.ay(i,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return r.ay(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new r.z("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new r.z("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(h){this.map=h,this._loaded=!1,this.fire(new r.z("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(h),this.load()}onRemove(h){this._implementation.onRemove&&this._implementation.onRemove(h)}hasTile(h){if(this._implementation.hasTile){const{x:i,y:l,z:m}=h.canonical;return this._implementation.hasTile({x:i,y:l,z:m})}return!this.tileBounds||this.tileBounds.contains(h.canonical)}loadTile(h,i){const{x:l,y:m,z:v}=h.tileID.canonical,x=new AbortController;h.request=Promise.resolve(this._implementation.loadTile({x:l,y:m,z:v},{signal:x.signal})).then((function(E){return delete h.request,h.aborted?(h.state="unloaded",i(null)):E===void 0?(h.state="errored",i(null)):E===null?(this.loadTileData(h,{width:this.tileSize,height:this.tileSize,data:null}),h.state="loaded",i(null)):function(L){return L instanceof ImageData||L instanceof HTMLCanvasElement||L instanceof ImageBitmap||L instanceof HTMLImageElement}(E)?(this.loadTileData(h,E),h.state="loaded",void i(null)):(h.state="errored",i(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`)))}).bind(this)).catch(E=>{E.code!==20&&(h.state="errored",i(E))}),h.request.cancel=()=>x.abort()}loadTileData(h,i){h.setTexture(i,this.map.painter)}unloadTile(h,i){if(h.texture&&h.texture instanceof r.T?(h.destroy(!0),h.texture&&h.texture instanceof r.T&&this.map.painter.saveTileTexture(h.texture)):h.destroy(),this._implementation.unloadTile){const{x:l,y:m,z:v}=h.tileID.canonical;this._implementation.unloadTile({x:l,y:m,z:v})}i&&i()}abortTile(h,i){h.request&&h.request.cancel&&(h.request.cancel(),delete h.request),i&&i()}hasTransition(){return!1}_coveringTiles(){return this.map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map(h=>({x:h.canonical.x,y:h.canonical.y,z:h.canonical.z}))}_clearTiles(){const h=r.aC(this.id,this.scope);this.map.style.clearSource(h)}_update(){this.fire(new r.z("data",{dataType:"source",sourceDataType:"content"}))}}},hg=function(h,i,l,m){const v=new Zu[i.type](h,i,l,m);if(v.id!==h)throw new Error(`Expected Source id to be ${h} instead of ${v.id}`);return r.aP(["load","abort","unload","serialize","prepare"],v),v};function wv(h,i,l,m,v=!1){const x=i.sourceCache.transform,E=i.sourceCache.tilesIn(h,i.has3DLayers,v);E.sort(zh);const L=[];for(const $ of E){const j=$.tile.queryRenderedFeatures(i,$,l,m,x,v);Object.keys(j).length&&L.push({wrappedTileID:$.tile.tileID.wrapped().key,queryResults:j})}return L.length===0?{}:function($){const j={},G={};for(const X of $){const Y=X.queryResults,ne=X.wrappedTileID,ve=G[ne]=G[ne]||{};for(const _e in Y){const Te=Y[_e],Ce=ve[_e]=ve[_e]||{},Re=j[_e]=j[_e]||[];for(const je of Te)Ce[je.featureIndex]||(Ce[je.featureIndex]=!0,Re.push(je))}}return j}(L)}function Dh(h,i,l,m,v){const x={},E=m.queryRenderedSymbols(h),L=[];for(const $ of Object.keys(E).map(Number))L.push(v[$]);L.sort(zh);for(const $ of L){const j=$.featureIndex.lookupSymbolFeatures(E[$.bucketInstanceId],$.bucketIndex,$.sourceLayerIndex,i,l);for(const G in j){const X=x[G]=x[G]||[],Y=j[G];Y.sort((ne,ve)=>{const _e=$.featureSortOrder;if(_e){const Te=_e.indexOf(ne.featureIndex);return _e.indexOf(ve.featureIndex)-Te}return ve.featureIndex-ne.featureIndex});for(const ne of Y)X.push(ne)}}return x}function df(h,i){const l=h.getRenderableIds().map(x=>h.getTileByID(x)),m=[],v={};for(let x=0;x<l.length;x++){const E=l[x],L=E.tileID.canonical.key;v[L]||(v[L]=!0,E.querySourceFeatures(m,i))}return m}function zh(h,i){const l=h.tileID,m=i.tileID;return l.overscaledZ-m.overscaledZ||l.canonical.y-m.canonical.y||l.wrap-m.wrap||l.canonical.x-m.canonical.x}function pg(h,i){const l={};if(!i)return l;for(const m of h){const v=m.layerIds.map(x=>i.getLayer(x)).filter(Boolean);if(v.length!==0){m.layers=v,m.stateDependentLayerIds&&(m.stateDependentLayers=m.stateDependentLayerIds.map(x=>v.filter(E=>E.id===x)[0]));for(const x of v)l[x.fqid]=m}}return l}const Us=32,Ma=33,la=new Uint16Array(8184);for(let h=0;h<2046;h++){let i=h+2,l=0,m=0,v=0,x=0,E=0,L=0;for(1&i?v=x=E=Us:l=m=L=Us;(i>>=1)>1;){const j=l+v>>1,G=m+x>>1;1&i?(v=l,x=m,l=E,m=L):(l=v,m=x,v=E,x=L),E=j,L=G}const $=4*h;la[$+0]=l,la[$+1]=m,la[$+2]=v,la[$+3]=x}const Ia=new Uint16Array(2178),vl=new Uint8Array(1089),Fh=new Uint16Array(1089);function ff(h){return h===0?-.03125:h===32?.03125:0}const lu={type:2,extent:r.ag,loadGeometry:()=>[[new r.P(0,0),new r.P(r.ag+1,0),new r.P(r.ag+1,r.ag+1),new r.P(0,r.ag+1),new r.P(0,0)]]};class uu{constructor(i,l,m,v,x){this.tileID=i,this.uid=r.aV(),this.uses=0,this.tileSize=l,this.tileZoom=m,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=x,v&&v.style&&(this._lastUpdatedBrightness=v.style.getBrightness()),this.expiredRequestCount=0,this.state="loading",v&&v.transform&&(this.projection=v.transform.projection)}registerFadeDuration(i){const l=i+this.timeAdded;l<r.q.now()||this.fadeEndTime&&l<this.fadeEndTime||(this.fadeEndTime=l)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}get tileTransform(){return this._tileTransform||(this._tileTransform=r.aQ(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(i,l,m){if(this.unloadVectorData(),this.state="loaded",i){i.featureIndex&&(this.latestFeatureIndex=i.featureIndex,i.rawTileData?(this.latestRawTileData=i.rawTileData,this.latestFeatureIndex.rawTileData=i.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=i.collisionBoxArray,this.buckets=pg(i.buckets,l.style),this.hasSymbolBuckets=!1;for(const v in this.buckets){const x=this.buckets[v];if(x instanceof r.aX){if(this.hasSymbolBuckets=!0,!m)break;x.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const v in this.buckets){const x=this.buckets[v];if(x instanceof r.aX&&x.hasRTLText){this.hasRTLText=!0,r.aY();break}}this.queryPadding=0;for(const v in this.buckets){const x=this.buckets[v],E=l.style.getOwnLayer(v);if(!E)continue;const L=E.queryRadius(x);this.queryPadding=Math.max(this.queryPadding,L)}i.imageAtlas&&(this.imageAtlas=i.imageAtlas),i.glyphAtlasImage&&(this.glyphAtlasImage=i.glyphAtlasImage),i.lineAtlas&&(this.lineAtlas=i.lineAtlas),this._lastUpdatedBrightness=i.brightness}else this.collisionBoxArray=new r.aW}unloadVectorData(){if(this.hasData()){for(const i in this.buckets)this.buckets[i].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}loadModelData(i,l,m){i&&(i.resourceTiming&&(this.resourceTiming=i.resourceTiming),this.buckets={...this.buckets,...pg(i.buckets,l.style)},i.featureIndex&&(this.latestFeatureIndex=i.featureIndex))}getBucket(i){return this.buckets[i.fqid]}upload(i){for(const v in this.buckets){const x=this.buckets[v];x.uploadPending()&&x.upload(i)}const l=i.gl,m=this.imageAtlas;if(m&&!m.uploaded){const v=!!Object.keys(m.patternPositions).length;this.imageAtlasTexture=new r.T(i,m.image,l.RGBA8,{useMipmap:v}),this.imageAtlas.uploaded=!0}this.glyphAtlasImage&&(this.glyphAtlasTexture=new r.T(i,this.glyphAtlasImage,l.R8),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new r.T(i,this.lineAtlas.image,l.R8),this.lineAtlas.uploaded=!0)}prepare(i,l,m){if(this.imageAtlas&&this.imageAtlasTexture&&this.imageAtlas.patchUpdatedImages(i,this.imageAtlasTexture,m),!l||!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData)return;const v=l.style.getBrightness();(this._lastUpdatedBrightness||v)&&(this._lastUpdatedBrightness&&v&&Math.abs(this._lastUpdatedBrightness-v)<.001||(this.updateBuckets(l,this._lastUpdatedBrightness!==v),this._lastUpdatedBrightness=v))}queryRenderedFeatures(i,l,m,v,x,E){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData&&!this.latestFeatureIndex.is3DTile)return{};const L=function($,j){const G=r.ab.mat4.fromScaling([],[.5*$.width,.5*-$.height,1]);return r.ab.mat4.translate(G,G,[1,-1,0]),r.ab.mat4.multiply(G,G,$.calculateProjMatrix(j.toUnwrapped())),Float32Array.from(G)}(x,this.tileID);return this.latestFeatureIndex.query(i,{tilespaceGeometry:l,pixelPosMatrix:L,transform:v,availableImages:m,tileTransform:this.tileTransform})}querySourceFeatures(i,l){const m=this.latestFeatureIndex;if(!m||!m.rawTileData)return;const v=m.loadVTLayers(),x=l?l.sourceLayer:"",E=v._geojsonTileLayer||v[x];if(!E)return;const L=r.aZ(l&&l.filter),{z:$,x:j,y:G}=this.tileID.canonical,X={z:$,x:j,y:G};for(let Y=0;Y<E.length;Y++){const ne=E.feature(Y);if(L.needGeometry){const Te=r.a_(ne,!0);if(!L.filter(new r.a8(this.tileID.overscaledZ),Te,this.tileID.canonical))continue}else if(!L.filter(new r.a8(this.tileID.overscaledZ),ne))continue;const ve=m.getId(ne,x),_e=new r.a$(ne,$,j,G,ve);_e.tile=X,i.push(_e)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return!!this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(i){const l=this.expirationTime;if(i.cacheControl){const m=r.b0(i.cacheControl);m["max-age"]&&(this.expirationTime=Date.now()+1e3*m["max-age"])}else i.expires&&(this.expirationTime=new Date(i.expires).getTime());if(this.expirationTime){const m=Date.now();let v=!1;if(this.expirationTime>m)v=!1;else if(l)if(this.expirationTime<l)v=!0;else{const x=this.expirationTime-l;x?this.expirationTime=m+Math.max(x,3e4):v=!0}else v=!0;v?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}refreshFeatureState(i){this.latestFeatureIndex&&(this.latestFeatureIndex.rawTileData||this.latestFeatureIndex.is3DTile)&&i&&this.updateBuckets(i)}updateBuckets(i,l){if(!this.latestFeatureIndex||!i.style)return;const m=this.latestFeatureIndex.loadVTLayers(),v=i.style.listImages(),x=i.style.getBrightness();for(const E in this.buckets){if(!i.style.hasLayer(E))continue;const L=this.buckets[E],$=L.layers[0],j=$.sourceLayer||"_geojsonTileLayer",G=m[j],X=i.style.getSourceCache($.source,$.scope);let Y={};X&&(Y=X._state.getState(j,void 0));const ne=this.imageAtlas&&this.imageAtlas.patternPositions||{},ve=Object.keys(Y).length>0&&!l;(ve&&L.stateDependentLayers.length!==0||l)&&L.update(Y,G,v,ne,ve?L.stateDependentLayers:L.layers,l,x),(L instanceof r.b1||L instanceof r.b2)&&i._terrain&&i._terrain.enabled&&X&&L.programConfigurations.needsUpload&&i._terrain._clearRenderCacheForTile(X.id,this.tileID);const _e=i&&i.style&&i.style.getOwnLayer(E);_e&&(this.queryPadding=Math.max(this.queryPadding,_e.queryRadius(L)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<r.q.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(i){this.symbolFadeHoldUntil=r.q.now()+i}setTexture(i,l){const m=l.context,v=m.gl;this.texture=this.texture||l.getTileTexture(i.width),this.texture&&this.texture instanceof r.T?this.texture.update(i):(this.texture=new r.T(m,i,v.RGBA8,{useMipmap:!0}),this.texture.bind(v.LINEAR,v.CLAMP_TO_EDGE))}setDependencies(i,l){const m={};for(const v of l)m[v]=!0;this.dependencies[i]=m}hasDependency(i,l){for(const m of i){const v=this.dependencies[m];if(v){for(const x of l)if(v[x])return!0}}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(i,l){if(!l||l.name==="mercator"||this._tileDebugBuffer)return;const m=r.b3(lu,this.tileID.canonical,this.tileTransform)[0],v=new r.b4,x=new r.b5;for(let E=0;E<m.length;E++){const{x:L,y:$}=m[E];v.emplaceBack(L,$),x.emplaceBack(E)}x.emplaceBack(0),this._tileDebugIndexBuffer=i.createIndexBuffer(x),this._tileDebugBuffer=i.createVertexBuffer(v,r.b6.members),this._tileDebugSegments=r.b7.simpleSegment(0,0,v.length,x.length)}_makeTileBoundsBuffers(i,l){if(this._tileBoundsBuffer||!l||l.name==="mercator")return;const m=r.b3(lu,this.tileID.canonical,this.tileTransform)[0];let v,x;if(this.isRaster){const E=function(L,$){const j=r.aQ(L,$),G=Math.pow(2,L.z);for(let Te=0;Te<Ma;Te++)for(let Ce=0;Ce<Ma;Ce++){const Re=r.aR((L.x+(Ce+ff(Ce))/Us)/G),je=r.aS((L.y+(Te+ff(Te))/Us)/G),Be=$.project(Re,je),et=Te*Ma+Ce;Ia[2*et+0]=Math.round((Be.x*j.scale-j.x)*r.ag),Ia[2*et+1]=Math.round((Be.y*j.scale-j.y)*r.ag)}vl.fill(0),Fh.fill(0);for(let Te=2045;Te>=0;Te--){const Ce=4*Te,Re=la[Ce+0],je=la[Ce+1],Be=la[Ce+2],et=la[Ce+3],Ze=Re+Be>>1,Xe=je+et>>1,Ke=Ze+Xe-je,at=Xe+Re-Ze,pt=je*Ma+Re,Vt=et*Ma+Be,Rt=Xe*Ma+Ze,ht=Math.hypot((Ia[2*pt+0]+Ia[2*Vt+0])/2-Ia[2*Rt+0],(Ia[2*pt+1]+Ia[2*Vt+1])/2-Ia[2*Rt+1])>=16;vl[Rt]=vl[Rt]||(ht?1:0),Te<1022&&(vl[Rt]=vl[Rt]||vl[(je+at>>1)*Ma+(Re+Ke>>1)]||vl[(et+at>>1)*Ma+(Be+Ke>>1)])}const X=new r.aT,Y=new r.aU;let ne=0;function ve(Te,Ce){const Re=Ce*Ma+Te;return Fh[Re]===0&&(X.emplaceBack(Ia[2*Re+0],Ia[2*Re+1],Te*r.ag/Us,Ce*r.ag/Us),Fh[Re]=++ne),Fh[Re]-1}function _e(Te,Ce,Re,je,Be,et){const Ze=Te+Re>>1,Xe=Ce+je>>1;if(Math.abs(Te-Be)+Math.abs(Ce-et)>1&&vl[Xe*Ma+Ze])_e(Be,et,Te,Ce,Ze,Xe),_e(Re,je,Be,et,Ze,Xe);else{const Ke=ve(Te,Ce),at=ve(Re,je),pt=ve(Be,et);Y.emplaceBack(Ke,at,pt)}}return _e(0,0,Us,Us,Us,0),_e(Us,Us,0,0,0,Us),{vertices:X,indices:Y}}(this.tileID.canonical,l);v=E.vertices,x=E.indices}else{v=new r.aT,x=new r.aU;for(const{x:L,y:$}of m)v.emplaceBack(L,$,0,0);const E=r.b8(v.int16,void 0,4);for(let L=0;L<E.length;L+=3)x.emplaceBack(E[L],E[L+1],E[L+2])}this._tileBoundsBuffer=i.createVertexBuffer(v,r.b9.members),this._tileBoundsIndexBuffer=i.createIndexBuffer(x),this._tileBoundsSegments=r.b7.simpleSegment(0,0,v.length,x.length)}_makeGlobeTileDebugBuffers(i,l){const m=l.projection;if(!m||m.name!=="globe"||l.freezeTileCoverage)return;const v=this.tileID.canonical,x=r.ba(v,l),E=r.bb(x),L=r.ae(l.zoom);let $;L>0&&($=r.ab.mat4.invert(new Float64Array(16),l.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(i,v,l,E,$,L),this._makeGlobeTileDebugTextBuffer(i,v,l,E,$,L)}_globePoint(i,l,m,v,x,E,L){let $=r.bc(i,l,m);if(E){const j=1<<m.z,G=r.at(v.center.lng),X=r.aA(v.center.lat),Y=(m.x+.5)/j-G;let ne=0;Y>.5?ne=-1:Y<-.5&&(ne=1);let ve=(i/r.ag+m.x)/j+ne,_e=(l/r.ag+m.y)/j;ve=(ve-G)*v._pixelsPerMercatorPixel+G,_e=(_e-X)*v._pixelsPerMercatorPixel+X;const Te=[ve*v.worldSize,_e*v.worldSize,0];r.ab.vec3.transformMat4(Te,Te,E),$=r.bd($,Te,L)}return r.ab.vec3.transformMat4($,$,x)}_makeGlobeTileDebugBorderBuffer(i,l,m,v,x,E){const L=new r.b4,$=new r.b5,j=new r.be,G=(Y,ne,ve,_e,Te)=>{const Ce=(ve-Y)/(Te-1),Re=(_e-ne)/(Te-1),je=L.length;for(let Be=0;Be<Te;Be++){const et=Y+Be*Ce,Ze=ne+Be*Re;L.emplaceBack(et,Ze);const Xe=this._globePoint(et,Ze,l,m,v,x,E);j.emplaceBack(Xe[0],Xe[1],Xe[2]),$.emplaceBack(je+Be)}},X=r.ag;G(0,0,X,0,16),G(X,0,X,X,16),G(X,X,0,X,16),G(0,X,0,0,16),this._tileDebugIndexBuffer=i.createIndexBuffer($),this._tileDebugBuffer=i.createVertexBuffer(L,r.b6.members),this._globeTileDebugBorderBuffer=i.createVertexBuffer(j,r.bf.members),this._tileDebugSegments=r.b7.simpleSegment(0,0,L.length,$.length)}_makeGlobeTileDebugTextBuffer(i,l,m,v,x,E){const L=r.ag/4,$=new r.b4,j=new r.aU,G=new r.be,X=25;j.reserve(32),$.reserve(X),G.reserve(X);const Y=(ne,ve)=>X*ne+ve;for(let ne=0;ne<X;ne++){const ve=ne*L;for(let _e=0;_e<X;_e++){const Te=_e*L;$.emplaceBack(Te,ve);const Ce=this._globePoint(Te,ve,l,m,v,x,E);G.emplaceBack(Ce[0],Ce[1],Ce[2])}}for(let ne=0;ne<4;ne++)for(let ve=0;ve<4;ve++){const _e=Y(ne,ve),Te=Y(ne,ve+1),Ce=Y(ne+1,ve),Re=Y(ne+1,ve+1);j.emplaceBack(_e,Te,Ce),j.emplaceBack(Ce,Te,Re)}this._tileDebugTextIndexBuffer=i.createIndexBuffer(j),this._tileDebugTextBuffer=i.createVertexBuffer($,r.b6.members),this._globeTileDebugTextBuffer=i.createVertexBuffer(G,r.bf.members),this._tileDebugTextSegments=r.b7.simpleSegment(0,0,X,32)}destroy(i=!1){for(const l in this.buckets)this.buckets[l].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&(this.imageAtlasTexture.destroy(),delete this.imageAtlasTexture),this.glyphAtlasTexture&&(this.glyphAtlasTexture.destroy(),delete this.glyphAtlasTexture),this.lineAtlasTexture&&(this.lineAtlasTexture.destroy(),delete this.lineAtlasTexture),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),!i&&this.texture&&this.texture instanceof r.T&&(this.texture.destroy(),delete this.texture),this.hillshadeFBO&&(this.hillshadeFBO.destroy(),delete this.hillshadeFBO),this.dem&&delete this.dem,this.neighboringTiles&&delete this.neighboringTiles,this.demTexture&&(this.demTexture.destroy(),delete this.demTexture),this.rasterParticleState&&(this.rasterParticleState.destroy(),delete this.rasterParticleState),this.latestFeatureIndex=null,this.state="unloaded"}}r.bg.setPbf(r.bh);class Nh extends uu{constructor(i,l,m,v,x){super(i,l,m,v,x),this._workQueue=[],this._fetchQueue=[],this._isHeaderLoaded=!1}setTexture(i,l){const m=l.context,v=m.gl;this.texture=this.texture||l.getTileTexture(i.width),this.texture&&this.texture instanceof r.T?this.texture.update(i,{premultiply:!1}):this.texture=new r.T(m,i,v.RGBA8,{premultiply:!1})}flushQueues(){for(;this._workQueue.length;)this._workQueue.pop()();for(;this._fetchQueue.length;)this._fetchQueue.pop()()}fetchHeader(i=16384,l){const m=this._mrt=new r.bg(30),v=Object.assign({},this.requestParams,{headers:{Range:"bytes=0-"+(i-1)}});return this.entireBuffer=null,this.request=r.bi(v,(x,E,L,$)=>{if(x)l(x);else try{const j=m.getHeaderLength(E);if(j>i)return void(this.request=this.fetchHeader(j,l));m.parseHeader(E),this._isHeaderLoaded=!0;let G=0;for(const X of Object.values(m.layers))G=Math.max(G,X.dataIndex[X.dataIndex.length-1].last_byte);E.byteLength>=G&&(this.entireBuffer=E),l(null,this.entireBuffer||E,L,$)}catch(j){l(j)}}),this.request}fetchBand(i,l,m){const v=this._mrt;if(!this._isHeaderLoaded||!v)return void m(new Error("Tile header is not ready"));const x=this.actor;if(!x)return void m(new Error("Can't fetch tile band without an actor"));let E;const L=(X,Y)=>{E.complete(X,Y),X?m(X):(this.updateTextureDescriptor(i,l),m(null,this.textureDescriptor&&this.textureDescriptor.img))},$=(X,Y)=>{if(X)return m(X);const ne=x.send("decodeRasterArray",{buffer:Y,task:E},L,void 0,!0);this._workQueue.push(()=>{ne&&ne.cancel(),E.cancel()})},j=v.getLayer(i);if(!j)return void m(new Error(`Unknown sourceLayer "${i}"`));if(j.hasDataForBand(l))return this.updateTextureDescriptor(i,l),void m(null,this.textureDescriptor?this.textureDescriptor.img:null);const G=j.getDataRange([l]);if(E=v.createDecodingTask(G),!E||E.tasks.length)if(this.flushQueues(),this.entireBuffer)$(null,this.entireBuffer.slice(G.firstByte,G.lastByte+1));else{const X=Object.assign({},this.requestParams,{headers:{Range:`bytes=${G.firstByte}-${G.lastByte}`}}),Y=r.bi(X,$);this._fetchQueue.push(()=>{Y.cancel(),E.cancel()})}else m(null)}updateNeeded(i,l){return(!this.textureDescriptor||this.textureDescriptor.band!==l||this.textureDescriptor.layer!==i)&&this.state!=="errored"}updateTextureDescriptor(i,l){if(!this._mrt)return;const m=this._mrt.getLayer(i);if(!m||!m.hasBand(l)||!m.hasDataForBand(l))return;const{bytes:v,tileSize:x,buffer:E,offset:L,scale:$}=m.getBandView(l),j=x+2*E,G={data:v,width:j,height:j},X=this.texture;X&&X instanceof r.T&&X.update(G,{premultiply:!1}),this.textureDescriptor={layer:i,band:l,img:G,buffer:E,offset:L,tileSize:x,format:m.pixelFormat,mix:[$,256*$,65536*$,16777216*$]}}}class mg{constructor(i,l){this.max=i,this.onRemove=l,this.reset()}reset(){for(const i in this.data)for(const l of this.data[i])l.timeout&&clearTimeout(l.timeout),this.onRemove(l.value);return this.data={},this.order=[],this}add(i,l,m){const v=i.wrapped().key;this.data[v]===void 0&&(this.data[v]=[]);const x={value:l,timeout:void 0};if(m!==void 0&&(x.timeout=setTimeout(()=>{this.remove(i,x)},m)),this.data[v].push(x),this.order.push(v),this.order.length>this.max){const E=this._getAndRemoveByKey(this.order[0]);E&&this.onRemove(E)}return this}has(i){return i.wrapped().key in this.data}getAndRemove(i){return this.has(i)?this._getAndRemoveByKey(i.wrapped().key):null}_getAndRemoveByKey(i){const l=this.data[i].shift();return l.timeout&&clearTimeout(l.timeout),this.data[i].length===0&&delete this.data[i],this.order.splice(this.order.indexOf(i),1),l.value}getByKey(i){const l=this.data[i];return l?l[0].value:null}get(i){return this.has(i)?this.data[i.wrapped().key][0].value:null}remove(i,l){if(!this.has(i))return this;const m=i.wrapped().key,v=l===void 0?0:this.data[m].indexOf(l),x=this.data[m][v];return this.data[m].splice(v,1),x.timeout&&clearTimeout(x.timeout),this.data[m].length===0&&delete this.data[m],this.onRemove(x.value),this.order.splice(this.order.indexOf(m),1),this}setMaxSize(i){for(this.max=i;this.order.length>this.max;){const l=this._getAndRemoveByKey(this.order[0]);l&&this.onRemove(l)}return this}filter(i){const l=[];for(const m in this.data)for(const v of this.data[m])i(v.value)||l.push(v);for(const m of l)this.remove(m.value.tileID,m)}}class $c{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(i,l,m){const v=String(l);if(this.stateChanges[i]=this.stateChanges[i]||{},this.stateChanges[i][v]=this.stateChanges[i][v]||{},r.l(this.stateChanges[i][v],m),this.deletedStates[i]===null){this.deletedStates[i]={};for(const x in this.state[i])x!==v&&(this.deletedStates[i][x]=null)}else if(this.deletedStates[i]&&this.deletedStates[i][v]===null){this.deletedStates[i][v]={};for(const x in this.state[i][v])m[x]||(this.deletedStates[i][v][x]=null)}else for(const x in m)this.deletedStates[i]&&this.deletedStates[i][v]&&this.deletedStates[i][v][x]===null&&delete this.deletedStates[i][v][x]}removeFeatureState(i,l,m){if(this.deletedStates[i]===null)return;const v=String(l);if(this.deletedStates[i]=this.deletedStates[i]||{},m&&l!==void 0)this.deletedStates[i][v]!==null&&(this.deletedStates[i][v]=this.deletedStates[i][v]||{},this.deletedStates[i][v][m]=null);else if(l!==void 0)if(this.stateChanges[i]&&this.stateChanges[i][v])for(m in this.deletedStates[i][v]={},this.stateChanges[i][v])this.deletedStates[i][v][m]=null;else this.deletedStates[i][v]=null;else this.deletedStates[i]=null}getState(i,l){const m=this.state[i]||{},v=this.stateChanges[i]||{},x=this.deletedStates[i];if(x===null)return{};if(l!==void 0){const L=String(l),$=r.l({},m[L],v[L]);if(x){const j=x[l];if(j===null)return{};for(const G in j)delete $[G]}return $}const E=r.l({},m,v);if(x)for(const L in x)delete E[L];return E}initializeTileState(i,l){i.refreshFeatureState(l)}coalesceChanges(i,l){const m={};for(const v in this.stateChanges){this.state[v]=this.state[v]||{};const x={};for(const E in this.stateChanges[v])this.state[v][E]||(this.state[v][E]={}),r.l(this.state[v][E],this.stateChanges[v][E]),x[E]=this.state[v][E];m[v]=x}for(const v in this.deletedStates){this.state[v]=this.state[v]||{};const x={};if(this.deletedStates[v]===null)for(const E in this.state[v])x[E]={},this.state[v][E]={};else for(const E in this.deletedStates[v]){if(this.deletedStates[v][E]===null)this.state[v][E]={};else if(this.state[v][E])for(const L of Object.keys(this.deletedStates[v][E]))delete this.state[v][E][L];x[E]=this.state[v][E]}m[v]=m[v]||{},r.l(m[v],x)}if(this.stateChanges={},this.deletedStates={},Object.keys(m).length!==0)for(const v in i)i[v].refreshFeatureState(l)}}class ua extends r.E{constructor(i,l,m){super(),this.id=i,this._onlySymbols=m,l.on("data",v=>{v.dataType==="source"&&v.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&v.dataType==="source"&&v.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform))}),l.on("error",()=>{this._sourceErrored=!0}),this._source=l,this._tiles={},this._cache=new mg(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=l.minTileCacheSize,this._maxTileCacheSize=l.maxTileCacheSize,this._loadedParentTiles={},this.castsShadows=!1,this.tileCoverLift=0,this._coveredTiles={},this._shadowCasterTiles={},this._state=new $c,this._isRaster=this._source.type==="raster"||this._source.type==="raster-dem"||this._source.type==="raster-array"||this._source.type==="custom"&&this._source._dataType==="raster"}onAdd(i){this.map=i,this._minTileCacheSize=this._minTileCacheSize===void 0&&i?i._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=this._maxTileCacheSize===void 0&&i?i._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const i in this._tiles){const l=this._tiles[i];if(l.state!=="loaded"&&l.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const i=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,i&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(i,l){return i.isSymbolTile=this._onlySymbols,i.isExtraShadowCaster=this._shadowCasterTiles[i.tileID.key],this._source.loadTile(i,l)}_unloadTile(i){if(this._source.unloadTile)return this._source.unloadTile(i)}_abortTile(i){if(this._source.abortTile)return this._source.abortTile(i)}serialize(){return this._source.serialize()}prepare(i){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const l in this._tiles){const m=this._tiles[l];m.upload(i),m.prepare(this.map.style.imageManager,this.map?this.map.painter:null,this._source.scope)}}getIds(){return r.bj(this._tiles).map(i=>i.tileID).sort(Bh).map(i=>i.key)}getRenderableIds(i,l){const m=[];for(const v in this._tiles)this._isIdRenderable(+v,i,l)&&m.push(this._tiles[v]);return i?m.sort((v,x)=>{const E=v.tileID,L=x.tileID,$=new r.P(E.canonical.x,E.canonical.y)._rotate(this.transform.angle),j=new r.P(L.canonical.x,L.canonical.y)._rotate(this.transform.angle);return E.overscaledZ-L.overscaledZ||j.y-$.y||j.x-$.x}).map(v=>v.tileID.key):m.map(v=>v.tileID).sort(Bh).map(v=>v.key)}hasRenderableParent(i){const l=this.findLoadedParent(i,0);return!!l&&this._isIdRenderable(l.tileID.key)}_isIdRenderable(i,l,m){return this._tiles[i]&&this._tiles[i].hasData()&&!this._coveredTiles[i]&&(l||!this._tiles[i].holdingForFade())&&(m||!this._shadowCasterTiles[i])}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const i in this._tiles)this._tiles[i].state!=="errored"&&this._reloadTile(+i,"reloading")}}_reloadTile(i,l){const m=this._tiles[i];m&&(m.state!=="loading"&&(m.state=l),this._loadTile(m,this._tileLoaded.bind(this,m,i,l)))}_tileLoaded(i,l,m,v){if(v)if(i.state="errored",v.status!==404)this._source.fire(new r.y(v,{tile:i}));else{if(this._source.fire(new r.z("data",{dataType:"source",sourceDataType:"error",sourceId:this._source.id,tile:i})),!(i.tileID.key in this._loadedParentTiles))return;if(this._source.type==="raster-dem"&&this.usedForTerrain&&this.map.painter.terrain){const x=this.map.painter.terrain;this.update(this.transform,x.getScaledDemTileSize(),!0),x.resetTileLookupCache(this.id)}else this.update(this.transform)}else i.timeAdded=r.q.now(),m==="expired"&&(i.refreshedUponExpiration=!0),this._setTileReloadTimer(l,i),this._source.type==="raster-dem"&&i.dem&&this._backfillDEM(i),this._state.initializeTileState(i,this.map?this.map.painter:null),this._source.fire(new r.z("data",{dataType:"source",tile:i,coord:i.tileID,sourceCacheId:this.id}))}_backfillDEM(i){const l=this.getRenderableIds();for(let v=0;v<l.length;v++){const x=l[v];if(i.neighboringTiles&&i.neighboringTiles[x]){const E=this.getTileByID(x);m(i,E),m(E,i)}}function m(v,x){if(!v.dem||v.dem.borderReady)return;v.needsHillshadePrepare=!0,v.needsDEMTextureUpload=!0;let E=x.tileID.canonical.x-v.tileID.canonical.x;const L=x.tileID.canonical.y-v.tileID.canonical.y,$=Math.pow(2,v.tileID.canonical.z),j=x.tileID.key;E===0&&L===0||Math.abs(L)>1||(Math.abs(E)>1&&(Math.abs(E+$)===1?E+=$:Math.abs(E-$)===1&&(E-=$)),x.dem&&v.dem&&(v.dem.backfillBorder(x.dem,E,L),v.neighboringTiles&&v.neighboringTiles[j]&&(v.neighboringTiles[j].backfilled=!0)))}}getTile(i){return this.getTileByID(i.key)}getTileByID(i){return this._tiles[i]}_retainLoadedChildren(i,l,m,v){for(const x in this._tiles){let E=this._tiles[x];if(v[x]||!E.hasData()||E.tileID.overscaledZ<=l||E.tileID.overscaledZ>m)continue;let L=E.tileID;for(;E&&E.tileID.overscaledZ>l+1;){const j=E.tileID.scaledTo(E.tileID.overscaledZ-1);E=this._tiles[j.key],E&&E.hasData()&&(L=j)}let $=L;for(;$.overscaledZ>l;)if($=$.scaledTo($.overscaledZ-1),i[$.key]){v[L.key]=L;break}}}findLoadedParent(i,l){if(i.key in this._loadedParentTiles){const m=this._loadedParentTiles[i.key];return m&&m.tileID.overscaledZ>=l?m:null}for(let m=i.overscaledZ-1;m>=l;m--){const v=i.scaledTo(m),x=this._getLoadedTile(v);if(x)return x}}_getLoadedTile(i){const l=this._tiles[i.key];return l&&l.hasData()?l:this._cache.getByKey(this._source.reparseOverscaled?i.wrapped().key:i.canonical.key)}updateCacheSize(i,l){l=l||this._source.tileSize;const m=Math.ceil(i.width/l)+1,v=Math.ceil(i.height/l)+1,x=Math.floor(m*v*5),E=typeof this._minTileCacheSize=="number"?Math.max(this._minTileCacheSize,x):x,L=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,E):E;this._cache.setMaxSize(L)}handleWrapJump(i){const l=Math.round((i-(this._prevLng===void 0?i:this._prevLng))/360);if(this._prevLng=i,l){const m={};for(const v in this._tiles){const x=this._tiles[v];x.tileID=x.tileID.unwrapTo(x.tileID.wrap+l),m[x.tileID.key]=x}this._tiles=m;for(const v in this._timers)clearTimeout(this._timers[v]),delete this._timers[v];for(const v in this._tiles)this._setTileReloadTimer(+v,this._tiles[v])}}update(i,l,m,v){if(this.transform=i,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!m)return;this.updateCacheSize(i,l),this.transform.projection.name!=="globe"&&this.handleWrapJump(this.transform.center.lng),this._shadowCasterTiles={},this._coveredTiles={};const x=this._source.type==="batched-model";let E,L=this._source.maxzoom;const $=this.map&&this.map.painter?this.map.painter._terrain:null;if($&&$.sourceCache===this&&$.attenuationRange()){const X=$.attenuationRange()[0],Y=Math.floor(X)-Math.log2($.getDemUpscale());L>Y&&(L=Y)}if(this.used||this.usedForTerrain){if(this._source.tileID)E=i.getVisibleUnwrappedCoordinates(this._source.tileID).map(X=>new r.aG(X.canonical.z,X.wrap,X.canonical.z,X.canonical.x,X.canonical.y));else if(this.tileCoverLift!==0){const X=i.clone();X.tileCoverLift=this.tileCoverLift,E=X.coveringTiles({tileSize:l||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:L,roundZoom:this._source.roundZoom&&!m,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain,calculateQuadrantVisibility:x}),this._source.minzoom<=1&&i.projection.name==="globe"&&(E.push(new r.aG(1,0,1,0,0)),E.push(new r.aG(1,0,1,1,0)),E.push(new r.aG(1,0,1,0,1)),E.push(new r.aG(1,0,1,1,1)))}else if(E=i.coveringTiles({tileSize:l||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:L,roundZoom:this._source.roundZoom&&!m,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain,calculateQuadrantVisibility:x}),this._source.hasTile){const X=this._source.hasTile.bind(this._source);E=E.filter(Y=>X(Y))}}else E=[];if(E.length>0&&this.castsShadows&&v&&this.transform.projection.name!=="globe"&&!this.usedForTerrain&&!Vh(this._source.type)){const X=i.coveringZoomLevel({tileSize:l||this._source.tileSize,roundZoom:this._source.roundZoom&&!m}),Y=Math.min(X,this._source.maxzoom);if(x){const ne=i.extendTileCover(E,Y);for(const ve of ne)E.push(ve)}else{const ne=i.extendTileCover(E,Y,v);for(const ve of ne)this._shadowCasterTiles[ve.key]=!0,E.push(ve)}}const j=this._updateRetainedTiles(E);if(Vh(this._source.type)&&E.length!==0){const X={},Y={},ne=Object.keys(j);for(const _e of ne){const Te=j[_e],Ce=this._tiles[_e];if(!Ce||Ce.fadeEndTime&&Ce.fadeEndTime<=r.q.now())continue;const Re=this.findLoadedParent(Te,Math.max(Te.overscaledZ-ua.maxOverzooming,this._source.minzoom));Re&&(this._addTile(Re.tileID),X[Re.tileID.key]=Re.tileID),Y[_e]=Te}const ve=E[E.length-1].overscaledZ;for(const _e in this._tiles){const Te=this._tiles[_e];if(j[_e]||!Te.hasData())continue;let Ce=Te.tileID;for(;Ce.overscaledZ>ve;){Ce=Ce.scaledTo(Ce.overscaledZ-1);const Re=this._tiles[Ce.key];if(Re&&Re.hasData()&&Y[Ce.key]){j[_e]=Te.tileID;break}}}for(const _e in X)j[_e]||(this._coveredTiles[_e]=!0,j[_e]=X[_e])}for(const X in j)this._tiles[X].clearFadeHold();const G=r.bk(this._tiles,j);for(const X of G){const Y=this._tiles[X];Y.hasSymbolBuckets&&!Y.holdingForFade()?Y.setHoldDuration(this.map._fadeDuration):Y.hasSymbolBuckets&&!Y.symbolFadeFinished()||this._removeTile(+X)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const i in this._tiles)this._tiles[i].holdingForFade()&&this._removeTile(+i)}_updateRetainedTiles(i){const l={};if(i.length===0)return l;const m={},v=i.reduce((j,G)=>Math.min(j,G.overscaledZ),1/0),x=i[0].overscaledZ,E=Math.max(x-ua.maxOverzooming,this._source.minzoom),L=Math.max(x+ua.maxUnderzooming,this._source.minzoom),$={};for(const j of i){const G=this._addTile(j);l[j.key]=j,G.hasData()||v<this._source.maxzoom&&($[j.key]=j)}this._retainLoadedChildren($,v,L,l);for(const j of i){let G=this._tiles[j.key];if(G.hasData())continue;if(j.canonical.z>=this._source.maxzoom){const Y=j.children(this._source.maxzoom)[0],ne=this.getTile(Y);if(ne&&ne.hasData()){l[Y.key]=Y;continue}}else{const Y=j.children(this._source.maxzoom);if(l[Y[0].key]&&l[Y[1].key]&&l[Y[2].key]&&l[Y[3].key])continue}let X=G.wasRequested();for(let Y=j.overscaledZ-1;Y>=E;--Y){const ne=j.scaledTo(Y);if(m[ne.key]||(m[ne.key]=!0,G=this.getTile(ne),!G&&X&&(G=this._addTile(ne)),G&&(l[ne.key]=ne,X=G.wasRequested(),G.hasData())))break}}return l}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const i in this._tiles){const l=[];let m,v=this._tiles[i].tileID;for(;v.overscaledZ>0;){if(v.key in this._loadedParentTiles){m=this._loadedParentTiles[v.key];break}l.push(v.key);const x=v.scaledTo(v.overscaledZ-1);if(m=this._getLoadedTile(x),m)break;v=x}for(const x of l)this._loadedParentTiles[x]=m}}_addTile(i){let l=this._tiles[i.key];if(l)return l.isExtraShadowCaster!==!0||this._shadowCasterTiles[i.key]||this._reloadTile(i.key,"reloading"),l;l=this._cache.getAndRemove(i),l&&(this._setTileReloadTimer(i.key,l),l.tileID=i,this._state.initializeTileState(l,this.map?this.map.painter:null),this._cacheTimers[i.key]&&(clearTimeout(this._cacheTimers[i.key]),delete this._cacheTimers[i.key],this._setTileReloadTimer(i.key,l)));const m=!!l;if(!m){const v=this.map?this.map.painter:null,x=this._source.tileSize*i.overscaleFactor();l=this._source.type==="raster-array"?new Nh(i,x,this.transform.tileZoom,v,this._isRaster):new uu(i,x,this.transform.tileZoom,v,this._isRaster),this._loadTile(l,this._tileLoaded.bind(this,l,i.key,l.state))}return l?(l.uses++,this._tiles[i.key]=l,m||this._source.fire(new r.z("dataloading",{tile:l,coord:l.tileID,dataType:"source"})),l):null}_setTileReloadTimer(i,l){i in this._timers&&(clearTimeout(this._timers[i]),delete this._timers[i]);const m=l.getExpiryTimeout();m&&(this._timers[i]=setTimeout(()=>{this._reloadTile(i,"expired"),delete this._timers[i]},m))}_removeTile(i){const l=this._tiles[i];l&&(l.uses--,delete this._tiles[i],this._timers[i]&&(clearTimeout(this._timers[i]),delete this._timers[i]),l.uses>0||(l.hasData()&&l.state!=="reloading"||l.state==="empty"?this._cache.add(l.tileID,l,l.getExpiryTimeout()):(l.aborted=!0,this._abortTile(l),this._unloadTile(l))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const i in this._tiles)this._removeTile(+i);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(i,l,m){const v=[],x=this.transform;if(!x)return v;const E=x.projection.name==="globe",L=r.at(x.center.lng);for(const $ in this._tiles){const j=this._tiles[$];if(m&&j.clearQueryDebugViz(),j.holdingForFade())continue;let G;if(E){const X=j.tileID.canonical;if(X.z===0){const Y=[Math.abs(r.aw(L,...Jr(X,-1))-L),Math.abs(r.aw(L,...Jr(X,1))-L)];G=[0,2*Y.indexOf(Math.min(...Y))-1]}else{const Y=[Math.abs(r.aw(L,...Jr(X,-1))-L),Math.abs(r.aw(L,...Jr(X,0))-L),Math.abs(r.aw(L,...Jr(X,1))-L)];G=[Y.indexOf(Math.min(...Y))-1]}}else G=[0];for(const X of G){const Y=i.containsTile(j,x,l,X);Y&&v.push(Y)}}return v}getShadowCasterCoordinates(){return this._getRenderableCoordinates(!1,!0)}getVisibleCoordinates(i){return this._getRenderableCoordinates(i)}_getRenderableCoordinates(i,l){const m=this.getRenderableIds(i,l).map(x=>this._tiles[x].tileID),v=this.transform.projection.name==="globe";for(const x of m)x.projMatrix=this.transform.calculateProjMatrix(x.toUnwrapped()),x.expandedProjMatrix=v?this.transform.calculateProjMatrix(x.toUnwrapped(),!1,!0):x.projMatrix;return m}sortCoordinatesByDistance(i){const l=i.slice(),m=this.transform._camera.position,v=this.transform._camera.forward(),x={};for(const E of l){const L=1/(1<<E.canonical.z);x[E.key]=((E.canonical.x+.5)*L+E.wrap-m[0])*v[0]+((E.canonical.y+.5)*L-m[1])*v[1]-m[2]*v[2]}return l.sort((E,L)=>x[E.key]-x[L.key]),l}hasTransition(){if(this._source.hasTransition())return!0;if(Vh(this._source.type))for(const i in this._tiles){const l=this._tiles[i];if(l.fadeEndTime!==void 0&&l.fadeEndTime>=r.q.now())return!0}return!1}setFeatureState(i,l,m){this._state.updateState(i=i||"_geojsonTileLayer",l,m)}removeFeatureState(i,l,m){this._state.removeFeatureState(i=i||"_geojsonTileLayer",l,m)}getFeatureState(i,l){return this._state.getState(i=i||"_geojsonTileLayer",l)}setDependencies(i,l,m){const v=this._tiles[i];v&&v.setDependencies(l,m)}reloadTilesForDependencies(i,l){for(const m in this._tiles)this._tiles[m].hasDependency(i,l)&&this._reloadTile(+m,"reloading");this._cache.filter(m=>!m.hasDependency(i,l))}_preloadTiles(i,l){if(!this._sourceLoaded){const $=()=>{this._sourceLoaded&&(this._source.off("data",$),this._preloadTiles(i,l))};return void this._source.on("data",$)}const m=new Map,v=Array.isArray(i)?i:[i],x=this.map.painter.terrain,E=this.usedForTerrain&&x?x.getScaledDemTileSize():this._source.tileSize;for(const $ of v){const j=$.coveringTiles({tileSize:E,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const G of j)m.set(G.key,G);this.usedForTerrain&&$.updateElevation(!1)}const L=Array.from(m.values());r.bl(L,($,j)=>{const G=new uu($,this._source.tileSize*$.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile(G,X=>{this._source.type==="raster-dem"&&G.dem&&this._backfillDEM(G),j(X,G)})},l)}}function Bh(h,i){const l=Math.abs(2*h.wrap)-+(h.wrap<0),m=Math.abs(2*i.wrap)-+(i.wrap<0);return h.overscaledZ-i.overscaledZ||m-l||i.canonical.y-h.canonical.y||i.canonical.x-h.canonical.x}function Vh(h){return h==="raster"||h==="image"||h==="video"||h==="custom"}function Jr(h,i){const l=1<<h.z;return[h.x/l+i,(h.x+1)/l+i]}ua.maxOverzooming=10,ua.maxUnderzooming=3;class Ux{constructor(i){this.style=i,this.layersGotHidden=!1,this.layers=[]}processLayersChanged(){this.layers=[];const i=!1,l=!1;for(const m in this.style._mergedLayers){const v=this.style._mergedLayers[m];if(v.type==="fill-extrusion")this.layers.push({layer:v,visible:i,visibilityChanged:l});else if(v.type==="model"){const x=this.style.getLayerSource(v);x&&x.type==="batched-model"&&this.layers.push({layer:v,visible:i,visibilityChanged:l})}}}onNewFrame(i){this.layersGotHidden=!1;for(const l of this.layers){const m=l.layer;let v=!1;m.type==="fill-extrusion"?v=!m.isHidden(i)&&m.paint.get("fill-extrusion-opacity")>0:m.type==="model"&&(v=!m.isHidden(i)&&m.paint.get("model-opacity").constantOr(1)>0),this.layersGotHidden=this.layersGotHidden||!v&&l.visible,l.visible=v}}updateZOffset(i,l){this.currentBuildingBuckets=[];for(const v of this.layers){const x=v.layer,E=this.style.getLayerSourceCache(x);let L=1;x.type==="fill-extrusion"&&(L=v.visible?x.paint.get("fill-extrusion-vertical-scale"):0);let $=E?E.getTile(l):null;if(!$&&E&&l.canonical.z>E.getSource().minzoom){let j=l.scaledTo(Math.min(E.getSource().maxzoom,l.overscaledZ-1));for(;j.overscaledZ>=E.getSource().minzoom&&($=E.getTile(j),!$&&j.overscaledZ!==0);)j=j.scaledTo(j.overscaledZ-1)}this.currentBuildingBuckets.push({bucket:$?$.getBucket(x):null,tileID:$?$.tileID:l,verticalScale:L})}i.hasAnyZOffset=!1;let m=!1;for(let v=0;v<i.symbolInstances.length;v++){const x=i.symbolInstances.get(v),E=x.zOffset,L=this._getHeightAtTileOffset(l,x.tileAnchorX,x.tileAnchorY);x.zOffset=L!==Number.NEGATIVE_INFINITY?L:E,m||E===x.zOffset||(m=!0),i.hasAnyZOffset||x.zOffset===0||(i.hasAnyZOffset=!0)}m&&(i.zOffsetBuffersNeedUpload=!0,i.zOffsetSortDirty=!0)}_mapCoordToOverlappingTile(i,l,m,v){let x=l,E=m;if(i.canonical.z!==v.canonical.z){const L=v.canonical,$=1/(1<<i.canonical.z-L.z);x=(l+i.canonical.x*r.ag)*$-L.x*r.ag|0,E=(m+i.canonical.y*r.ag)*$-L.y*r.ag|0}return{tileX:x,tileY:E}}_getHeightAtTileOffset(i,l,m){let v,x;for(let E=0;E<this.layers.length;++E){if(this.layers[E].layer.type!=="fill-extrusion")continue;const{bucket:L,tileID:$,verticalScale:j}=this.currentBuildingBuckets[E];if(!L)continue;const{tileX:G,tileY:X}=this._mapCoordToOverlappingTile(i,l,m,$),Y=L.getHeightAtTileCoord(G,X);Y&&Y.height!==void 0&&(Y.hidden?v=Y.height:x=Math.max(Y.height*j,x||0))}if(x!==void 0)return x;for(let E=0;E<this.layers.length;++E){const L=this.layers[E];if(L.layer.type!=="model"||!L.visible)continue;const{bucket:$,tileID:j}=this.currentBuildingBuckets[E];if(!$)continue;const{tileX:G,tileY:X}=this._mapCoordToOverlappingTile(i,l,m,j),Y=$.getHeightAtTileCoord(G,X);if(Y&&!Y.hidden)return Y.height===void 0&&v!==void 0?Math.min(Y.maxHeight,v)*Y.verticalScale:Y.height?Y.height*Y.verticalScale:Number.NEGATIVE_INFINITY}return this.layersGotHidden?0:Number.NEGATIVE_INFINITY}}function pr(h,i){const l={};for(const m in h)m!=="ref"&&(l[m]=h[m]);return r.bm.forEach(m=>{m in i&&(l[m]=i[m])}),l}function gg(h){h=h.slice();const i=Object.create(null);for(let l=0;l<h.length;l++)i[h[l].id]=h[l];for(let l=0;l<h.length;l++)"ref"in h[l]&&(h[l]=pr(h[l],i[h[l].ref]));return h}const Yr={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setSlot:"setSlot",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setSnow:"setSnow",setRain:"setRain",setCamera:"setCamera",setLights:"setLights",setProjection:"setProjection",addImport:"addImport",removeImport:"removeImport",updateImport:"updateImport"};function $h(h,i,l){l.push({command:Yr.addSource,args:[h,i[h]]})}function ca(h,i,l){i.push({command:Yr.removeSource,args:[h]}),l[h]=!0}function _g(h,i,l,m){ca(h,l,m),$h(h,i,l)}function Uc(h,i,l){let m;for(m in h[l])if(h[l].hasOwnProperty(m)&&m!=="data"&&!r.bn(h[l][m],i[l][m]))return!1;for(m in i[l])if(i[l].hasOwnProperty(m)&&m!=="data"&&!r.bn(h[l][m],i[l][m]))return!1;return!0}function Hn(h,i,l,m,v,x){let E;for(E in i=i||{},h=h||{})h.hasOwnProperty(E)&&(r.bn(h[E],i[E])||l.push({command:x,args:[m,E,i[E],v]}));for(E in i)i.hasOwnProperty(E)&&!h.hasOwnProperty(E)&&(r.bn(h[E],i[E])||l.push({command:x,args:[m,E,i[E],v]}))}function oi(h){return h.id}function Xr(h,i){return h[i.id]=i,h}class Ss{constructor(i,l){this.reset(i,l)}reset(i,l){this.points=i||[],this._distances=[0];for(let m=1;m<this.points.length;m++)this._distances[m]=this._distances[m-1]+this.points[m].dist(this.points[m-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(l||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(i){if(this.points.length===1)return this.points[0];i=r.aw(i,0,1);let l=1,m=this._distances[l];const v=i*this.paddedLength+this.padding;for(;m<v&&l<this._distances.length;)m=this._distances[++l];const x=l-1,E=this._distances[x],L=m-E,$=L>0?(v-E)/L:0;return this.points[x].mult(1-$).add(this.points[l].mult($))}}class Yu{constructor(i,l,m){const v=this.boxCells=[],x=this.circleCells=[];this.xCellCount=Math.ceil(i/m),this.yCellCount=Math.ceil(l/m);for(let E=0;E<this.xCellCount*this.yCellCount;E++)v.push([]),x.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=i,this.height=l,this.xScale=this.xCellCount/i,this.yScale=this.yCellCount/l,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(i,l,m,v,x){this._forEachCell(l,m,v,x,this._insertBoxCell,this.boxUid++),this.boxKeys.push(i),this.bboxes.push(l),this.bboxes.push(m),this.bboxes.push(v),this.bboxes.push(x)}insertCircle(i,l,m,v){this._forEachCell(l-v,m-v,l+v,m+v,this._insertCircleCell,this.circleUid++),this.circleKeys.push(i),this.circles.push(l),this.circles.push(m),this.circles.push(v)}_insertBoxCell(i,l,m,v,x,E){this.boxCells[x].push(E)}_insertCircleCell(i,l,m,v,x,E){this.circleCells[x].push(E)}_query(i,l,m,v,x,E){if(m<0||i>this.width||v<0||l>this.height)return!x&&[];const L=[];if(i<=0&&l<=0&&this.width<=m&&this.height<=v){if(x)return!0;for(let $=0;$<this.boxKeys.length;$++)L.push({key:this.boxKeys[$],x1:this.bboxes[4*$],y1:this.bboxes[4*$+1],x2:this.bboxes[4*$+2],y2:this.bboxes[4*$+3]});for(let $=0;$<this.circleKeys.length;$++){const j=this.circles[3*$],G=this.circles[3*$+1],X=this.circles[3*$+2];L.push({key:this.circleKeys[$],x1:j-X,y1:G-X,x2:j+X,y2:G+X})}return E?L.filter(E):L}return this._forEachCell(i,l,m,v,this._queryCell,L,{hitTest:x,seenUids:{box:{},circle:{}}},E),x?L.length>0:L}_queryCircle(i,l,m,v,x){const E=i-m,L=i+m,$=l-m,j=l+m;if(L<0||E>this.width||j<0||$>this.height)return!v&&[];const G=[];return this._forEachCell(E,$,L,j,this._queryCellCircle,G,{hitTest:v,circle:{x:i,y:l,radius:m},seenUids:{box:{},circle:{}}},x),v?G.length>0:G}query(i,l,m,v,x){return this._query(i,l,m,v,!1,x)}hitTest(i,l,m,v,x){return this._query(i,l,m,v,!0,x)}hitTestCircle(i,l,m,v){return this._queryCircle(i,l,m,!0,v)}_queryCell(i,l,m,v,x,E,L,$){const j=L.seenUids,G=this.boxCells[x];if(G!==null){const Y=this.bboxes;for(const ne of G)if(!j.box[ne]){j.box[ne]=!0;const ve=4*ne;if(i<=Y[ve+2]&&l<=Y[ve+3]&&m>=Y[ve+0]&&v>=Y[ve+1]&&(!$||$(this.boxKeys[ne]))){if(L.hitTest)return E.push(!0),!0;E.push({key:this.boxKeys[ne],x1:Y[ve],y1:Y[ve+1],x2:Y[ve+2],y2:Y[ve+3]})}}}const X=this.circleCells[x];if(X!==null){const Y=this.circles;for(const ne of X)if(!j.circle[ne]){j.circle[ne]=!0;const ve=3*ne;if(this._circleAndRectCollide(Y[ve],Y[ve+1],Y[ve+2],i,l,m,v)&&(!$||$(this.circleKeys[ne]))){if(L.hitTest)return E.push(!0),!0;{const _e=Y[ve],Te=Y[ve+1],Ce=Y[ve+2];E.push({key:this.circleKeys[ne],x1:_e-Ce,y1:Te-Ce,x2:_e+Ce,y2:Te+Ce})}}}}}_queryCellCircle(i,l,m,v,x,E,L,$){const j=L.circle,G=L.seenUids,X=this.boxCells[x];if(X!==null){const ne=this.bboxes;for(const ve of X)if(!G.box[ve]){G.box[ve]=!0;const _e=4*ve;if(this._circleAndRectCollide(j.x,j.y,j.radius,ne[_e+0],ne[_e+1],ne[_e+2],ne[_e+3])&&(!$||$(this.boxKeys[ve])))return E.push(!0),!0}}const Y=this.circleCells[x];if(Y!==null){const ne=this.circles;for(const ve of Y)if(!G.circle[ve]){G.circle[ve]=!0;const _e=3*ve;if(this._circlesCollide(ne[_e],ne[_e+1],ne[_e+2],j.x,j.y,j.radius)&&(!$||$(this.circleKeys[ve])))return E.push(!0),!0}}}_forEachCell(i,l,m,v,x,E,L,$){const j=this._convertToXCellCoord(i),G=this._convertToYCellCoord(l),X=this._convertToXCellCoord(m),Y=this._convertToYCellCoord(v);for(let ne=j;ne<=X;ne++)for(let ve=G;ve<=Y;ve++)if(x.call(this,i,l,m,v,this.xCellCount*ve+ne,E,L,$))return}_convertToXCellCoord(i){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(i*this.xScale)))}_convertToYCellCoord(i){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(i*this.yScale)))}_circlesCollide(i,l,m,v,x,E){const L=v-i,$=x-l,j=m+E;return j*j>L*L+$*$}_circleAndRectCollide(i,l,m,v,x,E,L){const $=(E-v)/2,j=Math.abs(i-(v+$));if(j>$+m)return!1;const G=(L-x)/2,X=Math.abs(l-(x+G));if(X>G+m)return!1;if(j<=$||X<=G)return!0;const Y=j-$,ne=X-G;return Y*Y+ne*ne<=m*m}}const Hr={unknown:0,flipRequired:1,flipNotRequired:2},Uh=Math.tan(85*Math.PI/180);function bl(h,i,l,m,v,x,E){const L=r.ab.mat4.create();if(l)if(x.name==="globe"){const $=r.bo(v,i);r.ab.mat4.multiply(L,L,$)}else{const $=r.ab.mat2.invert([],E);L[0]=$[0],L[1]=$[1],L[4]=$[2],L[5]=$[3],m||r.ab.mat4.rotateZ(L,L,v.angle)}else r.ab.mat4.multiply(L,v.labelPlaneMatrix,h);return L}function Xu(h,i,l,m,v,x,E){const L=bl(h,i,l,m,v,x,E);return x.name==="globe"&&l||(L[2]=L[6]=L[10]=L[14]=0),L}function Wo(h,i,l,m,v,x,E){if(l){if(x.name==="globe"){const L=bl(h,i,l,m,v,x,E);return r.ab.mat4.invert(L,L),r.ab.mat4.multiply(L,h,L),L}{const L=r.ab.mat4.clone(h),$=r.ab.mat4.identity([]);return $[0]=E[0],$[1]=E[1],$[4]=E[2],$[5]=E[3],r.ab.mat4.multiply(L,L,$),m||r.ab.mat4.rotateZ(L,L,-v.angle),L}}return v.glCoordMatrix}function zi(h,i,l,m){const v=[h,i,l,1];l?r.ab.vec4.transformMat4(v,v,m):Qu(v,v,m);const x=v[3];return v[0]/=x,v[1]/=x,v[2]/=x,v}function Sv(h,i){return Math.min(.5+h/i*.5,1.5)}function hf(h,i){const l=h[0]/h[3],m=h[1]/h[3];return l>=-i[0]&&l<=i[0]&&m>=-i[1]&&m<=i[1]}function jh(h,i,l,m,v,x,E,L,$,j){const G=l.transform,X=m?h.textSizeData:h.iconSizeData,Y=r.bp(X,l.transform.zoom),ne=G.projection.name==="globe",ve=[256/l.width*2+1,256/l.height*2+1],_e=m?h.text.dynamicLayoutVertexArray:h.icon.dynamicLayoutVertexArray;_e.clear();let Te=null;ne&&(Te=m?h.text.globeExtVertexArray:h.icon.globeExtVertexArray);const Ce=h.lineVertexArray,Re=m?h.text.placedSymbolArray:h.icon.placedSymbolArray,je=l.transform.width/l.transform.height;let Be,et=!1;for(let Ze=0;Ze<Re.length;Ze++){const Xe=Re.get(Ze),{numGlyphs:Ke,writingMode:at}=Xe;if(at!==r.bq.vertical||et||Be===r.bq.horizontal||(et=!0),Be=at,(Xe.hidden||at===r.bq.vertical)&&!et){Ju(Ke,_e);continue}et=!1;const pt=new r.P(Xe.tileAnchorX,Xe.tileAnchorY);let{x:Vt,y:Rt,z:ht}=G.projection.projectTilePoint(pt.x,pt.y,j.canonical);if($){const[tn,Rn,Dn]=$(pt);Vt+=tn,Rt+=Rn,ht+=Dn}const St=[Vt,Rt,ht,1];if(r.ab.vec4.transformMat4(St,St,i),!hf(St,ve)){Ju(Ke,_e);continue}const en=St[3],hn=Sv(l.transform.getCameraToCenterDistance(G.projection),en),vn=r.br(X,Y,Xe),It=E?vn/hn:vn*hn,ln=zi(Vt,Rt,ht,v);if(ln[3]<=0){Ju(Ke,_e);continue}let Ht={};const gn=E?null:$,cn=pf(Xe,It,!1,L,i,v,x,h.glyphOffsetArray,Ce,_e,Te,ln,pt,Ht,je,gn,G.projection,j,E);et=cn.useVertical,gn&&cn.needsFlipping&&(Ht={}),(cn.notEnoughRoom||et||cn.needsFlipping&&pf(Xe,It,!0,L,i,v,x,h.glyphOffsetArray,Ce,_e,Te,ln,pt,Ht,je,gn,G.projection,j,E).notEnoughRoom)&&Ju(Ke,_e)}m?(h.text.dynamicLayoutVertexBuffer.updateData(_e),Te&&h.text.globeExtVertexBuffer&&h.text.globeExtVertexBuffer.updateData(Te)):(h.icon.dynamicLayoutVertexBuffer.updateData(_e),Te&&h.icon.globeExtVertexBuffer&&h.icon.globeExtVertexBuffer.updateData(Te))}function jc(h,i,l,m,v,x,E,L,$,j,G,X,Y,ne,ve,_e){const{lineStartIndex:Te,glyphStartIndex:Ce,segment:Re}=L,je=Ce+L.numGlyphs,Be=Te+L.lineLength,et=i.getoffsetX(Ce),Ze=i.getoffsetX(je-1),Xe=Lo(h*et,l,m,v,x,E,Re,Te,Be,$,j,G,X,Y,!0,ne,ve,_e);if(!Xe)return null;const Ke=Lo(h*Ze,l,m,v,x,E,Re,Te,Be,$,j,G,X,Y,!0,ne,ve,_e);return Ke?{first:Xe,last:Ke}:null}function Hh(h,i,l,m){return h===r.bq.horizontal&&Math.abs(m)>Math.abs(l)?{useVertical:!0}:h===r.bq.vertical?m>0?{needsFlipping:!0}:null:i!==Hr.unknown&&function(v,x){return v===0||Math.abs(x/v)>Uh}(l,m)?i===Hr.flipRequired?{needsFlipping:!0}:null:l<0?{needsFlipping:!0}:null}function pf(h,i,l,m,v,x,E,L,$,j,G,X,Y,ne,ve,_e,Te,Ce,Re){const je=i/24,Be=h.lineOffsetX*je,et=h.lineOffsetY*je,{lineStartIndex:Ze,glyphStartIndex:Xe,numGlyphs:Ke,segment:at,writingMode:pt,flipState:Vt}=h,Rt=Ze+h.lineLength,ht=St=>{if(G){const[It,ln,Ht]=St.up,gn=j.length;r.bs(G,gn+0,It,ln,Ht),r.bs(G,gn+1,It,ln,Ht),r.bs(G,gn+2,It,ln,Ht),r.bs(G,gn+3,It,ln,Ht)}const[en,hn,vn]=St.point;r.bt(j,en,hn,vn,St.angle)};if(Ke>1){const St=jc(je,L,Be,et,l,X,Y,h,$,x,ne,_e,!1,Te,Ce,Re);if(!St)return{notEnoughRoom:!0};if(m&&!l){let[en,hn,vn]=St.first.point,[It,ln,Ht]=St.last.point;[en,hn]=zi(en,hn,vn,E),[It,ln]=zi(It,ln,Ht,E);const gn=Hh(pt,Vt,(It-en)*ve,ln-hn);if(h.flipState=gn&&gn.needsFlipping?Hr.flipRequired:Hr.flipNotRequired,gn)return gn}ht(St.first);for(let en=Xe+1;en<Xe+Ke-1;en++){const hn=Lo(je*L.getoffsetX(en),Be,et,l,X,Y,at,Ze,Rt,$,x,ne,_e,!1,!1,Te,Ce,Re);if(!hn)return j.length-=4*(en-Xe),{notEnoughRoom:!0};ht(hn)}ht(St.last)}else{if(m&&!l){const en=zi(Y.x,Y.y,0,v),hn=Ze+at+1,vn=new r.P($.getx(hn),$.gety(hn)),It=zi(vn.x,vn.y,0,v),ln=It[3]>0?It:Za(Y,vn,en,1,v,void 0,Te,Ce.canonical),Ht=Hh(pt,Vt,(ln[0]-en[0])*ve,ln[1]-en[1]);if(h.flipState=Ht&&Ht.needsFlipping?Hr.flipRequired:Hr.flipNotRequired,Ht)return Ht}const St=Lo(je*L.getoffsetX(Xe),Be,et,l,X,Y,at,Ze,Rt,$,x,ne,_e,!1,!1,Te,Ce,Re);if(!St)return{notEnoughRoom:!0};ht(St)}return{}}function qo(h,i,l,m,v){const{x,y:E,z:L}=m.projectTilePoint(h.x,h.y,i);if(!v)return zi(x,E,L,l);const[$,j,G]=v(h);return zi(x+$,E+j,L+G,l)}function Za(h,i,l,m,v,x,E,L){const $=qo(h.sub(i)._unit()._add(h),L,v,E,x);return r.ab.vec3.sub($,l,$),r.ab.vec3.normalize($,$),r.ab.vec3.scaleAndAdd($,l,$,m)}function Lo(h,i,l,m,v,x,E,L,$,j,G,X,Y,ne,ve,_e,Te,Ce){const Re=m?h-i:h+i;let je=Re>0?1:-1,Be=0;m&&(je*=-1,Be=Math.PI),je<0&&(Be+=Math.PI);let et=L+E+(je>0?0:1)|0,Ze=v,Xe=v,Ke=0,at=0;const pt=Math.abs(Re),Vt=[],Rt=[];let ht=x,St=ht;const en=()=>Za(St,ht,Xe,pt-Ke+1,G,Y,_e,Te.canonical);for(;Ke+at<=pt;){if(et+=je,et<L||et>=$)return null;if(Xe=Ze,St=ht,Vt.push(Xe),ne&&Rt.push(St),ht=new r.P(j.getx(et),j.gety(et)),Ze=X[et],!Ze){const Rn=qo(ht,Te.canonical,G,_e,Y);Ze=Rn[3]>0?X[et]=Rn:en()}Ke+=at,at=r.ab.vec3.distance(Xe,Ze)}ve&&Y&&(X[et]&&(Ze=en(),at=r.ab.vec3.distance(Xe,Ze)),X[et]=Ze);const hn=(pt-Ke)/at,vn=ht.sub(St)._mult(hn)._add(St),It=r.ab.vec3.sub([],Ze,Xe),ln=r.ab.vec3.scaleAndAdd([],Xe,It,hn);let Ht=[0,0,1],gn=It[0],cn=It[1];if(Ce&&(Ht=_e.upVector(Te.canonical,vn.x,vn.y),Ht[0]!==0||Ht[1]!==0||Ht[2]!==1)){const Rn=[Ht[2],0,-Ht[0]],Dn=r.ab.vec3.cross([],Ht,Rn);r.ab.vec3.normalize(Rn,Rn),r.ab.vec3.normalize(Dn,Dn),gn=r.ab.vec3.dot(It,Rn),cn=r.ab.vec3.dot(It,Dn)}if(l){const Rn=r.ab.vec3.cross([],Ht,It);r.ab.vec3.normalize(Rn,Rn),r.ab.vec3.scaleAndAdd(ln,ln,Rn,l*je)}const tn=Be+Math.atan2(cn,gn);return Vt.push(ln),ne&&Rt.push(vn),{point:ln,angle:tn,path:Vt,tilePath:Rt,up:Ht}}function Ju(h,i){const l=i.length,m=l+4*h;i.resize(m),i.float32.fill(-1/0,4*l,4*m)}function Qu(h,i,l){const m=i[0],v=i[1];return h[0]=l[0]*m+l[4]*v+l[12],h[1]=l[1]*m+l[5]*v+l[13],h[3]=l[3]*m+l[7]*v+l[15],h}const Gi=100;class Aa{constructor(i,l,m=new Yu(i.width+200,i.height+200,25),v=new Yu(i.width+200,i.height+200,25)){this.transform=i,this.grid=m,this.ignoredGrid=v,this.pitchfactor=Math.cos(i._pitch)*i.cameraToCenterDistance,this.screenRightBoundary=i.width+Gi,this.screenBottomBoundary=i.height+Gi,this.gridRightBoundary=i.width+200,this.gridBottomBoundary=i.height+200,this.fogState=l}placeCollisionBox(i,l,m,v,x,E,L,$){let j=m.projectedAnchorX,G=m.projectedAnchorY,X=m.projectedAnchorZ;const Y=m.elevation,ne=m.tileID,ve=i.getProjection();if(Y&&ne){const[Ze,Xe,Ke]=ve.upVector(ne.canonical,m.tileAnchorX,m.tileAnchorY),at=ve.upVectorScale(ne.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;j+=Ze*Y*at,G+=Xe*Y*at,X+=Ke*Y*at}const _e=this.projectAndGetPerspectiveRatio(L,j,G,X,m.tileID,ve.name==="globe"||!!Y||this.transform.pitch>0,ve),Te=E*_e.perspectiveRatio,Ce=(m.x1*l+v.x-m.padding)*Te+_e.point.x,Re=(m.y1*l+v.y-m.padding)*Te+_e.point.y,je=(m.x2*l+v.x+m.padding)*Te+_e.point.x,Be=(m.y2*l+v.y+m.padding)*Te+_e.point.y,et=_e.perspectiveRatio<=.55||_e.occluded;return!this.isInsideGrid(Ce,Re,je,Be)||!x&&this.grid.hitTest(Ce,Re,je,Be,$)||et?{box:[],offscreen:!1,occluded:_e.occluded}:{box:[Ce,Re,je,Be],offscreen:this.isOffscreen(Ce,Re,je,Be),occluded:!1}}placeCollisionCircles(i,l,m,v,x,E,L,$,j,G,X,Y,ne,ve,_e){const Te=[],Ce=this.transform.elevation,Re=i.getProjection(),je=Ce?Ce.getAtTileOffsetFunc(_e,this.transform.center.lat,this.transform.worldSize,Re):null,Be=new r.P(m.tileAnchorX,m.tileAnchorY);let{x:et,y:Ze,z:Xe}=Re.projectTilePoint(Be.x,Be.y,_e.canonical);if(je){const[vn,It,ln]=je(Be);et+=vn,Ze+=It,Xe+=ln}const Ke=Re.name==="globe",at=this.projectAndGetPerspectiveRatio(L,et,Ze,Xe,_e,Ke||!!Ce||this.transform.pitch>0,Re),{perspectiveRatio:pt}=at,Vt=(X?E/pt:E*pt)/r.bw,Rt=zi(et,Ze,Xe,$),ht=at.signedDistanceFromCamera>0?jc(Vt,x,m.lineOffsetX*Vt,m.lineOffsetY*Vt,!1,Rt,Be,m,v,$,{},Ce&&!X?je:null,X&&!!Ce,Re,_e,X):null;let St=!1,en=!1,hn=!0;if(ht&&!at.occluded){const vn=.5*ne*pt+ve,It=new r.P(-100,-100),ln=new r.P(this.screenRightBoundary,this.screenBottomBoundary),Ht=new Ss,{first:gn,last:cn}=ht,tn=gn.path.length;let Rn=[];for(let Bn=tn-1;Bn>=1;Bn--)Rn.push(gn.path[Bn]);for(let Bn=1;Bn<cn.path.length;Bn++)Rn.push(cn.path[Bn]);const Dn=2.5*vn;j&&(Rn=Rn.map(([Bn,br,ir],rr)=>(je&&!Ke&&(ir=je(rr<tn-1?gn.tilePath[tn-1-rr]:cn.tilePath[rr-tn+2])[2]),zi(Bn,br,ir,j))),Rn.some(Bn=>Bn[3]<=0)&&(Rn=[]));let An=[];if(Rn.length>0){let Bn=1/0,br=-1/0,ir=1/0,rr=-1/0;for(const wr of Rn)Bn=Math.min(Bn,wr[0]),ir=Math.min(ir,wr[1]),br=Math.max(br,wr[0]),rr=Math.max(rr,wr[1]);br>=It.x&&Bn<=ln.x&&rr>=It.y&&ir<=ln.y&&(An=[Rn.map(wr=>new r.P(wr[0],wr[1]))],(Bn<It.x||br>ln.x||ir<It.y||rr>ln.y)&&(An=r.bu(An,It.x,It.y,ln.x,ln.y)))}for(const Bn of An){Ht.reset(Bn,.25*vn);let br=0;br=Ht.length<=.5*vn?1:Math.ceil(Ht.paddedLength/Dn)+1;for(let ir=0;ir<br;ir++){const rr=ir/Math.max(br-1,1),wr=Ht.lerp(rr),Gr=wr.x+Gi,Or=wr.y+Gi;Te.push(Gr,Or,vn,0);const Ui=Gr-vn,ki=Or-vn,li=Gr+vn,mi=Or+vn;if(hn=hn&&this.isOffscreen(Ui,ki,li,mi),en=en||this.isInsideGrid(Ui,ki,li,mi),!l&&this.grid.hitTestCircle(Gr,Or,vn,Y)&&(St=!0,!G))return{circles:[],offscreen:!1,collisionDetected:St,occluded:!1}}}}return{circles:!G&&St||!en?[]:Te,offscreen:hn,collisionDetected:St,occluded:at.occluded}}queryRenderedSymbols(i){if(i.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const l=[];let m=1/0,v=1/0,x=-1/0,E=-1/0;for(const G of i){const X=new r.P(G.x+Gi,G.y+Gi);m=Math.min(m,X.x),v=Math.min(v,X.y),x=Math.max(x,X.x),E=Math.max(E,X.y),l.push(X)}const L=this.grid.query(m,v,x,E).concat(this.ignoredGrid.query(m,v,x,E)),$={},j={};for(const G of L){const X=G.key;if($[X.bucketInstanceId]===void 0&&($[X.bucketInstanceId]={}),$[X.bucketInstanceId][X.featureIndex])continue;const Y=[new r.P(G.x1,G.y1),new r.P(G.x2,G.y1),new r.P(G.x2,G.y2),new r.P(G.x1,G.y2)];r.bv(l,Y)&&($[X.bucketInstanceId][X.featureIndex]=!0,j[X.bucketInstanceId]===void 0&&(j[X.bucketInstanceId]=[]),j[X.bucketInstanceId].push(X.featureIndex))}return j}insertCollisionBox(i,l,m,v,x){(l?this.ignoredGrid:this.grid).insert({bucketInstanceId:m,featureIndex:v,collisionGroupID:x},i[0],i[1],i[2],i[3])}insertCollisionCircles(i,l,m,v,x){const E=l?this.ignoredGrid:this.grid,L={bucketInstanceId:m,featureIndex:v,collisionGroupID:x};for(let $=0;$<i.length;$+=4)E.insertCircle(L,i[$],i[$+1],i[$+2])}projectAndGetPerspectiveRatio(i,l,m,v,x,E,L){const $=[l,m,v,1];let j=!1;v||this.transform.pitch>0?(r.ab.vec4.transformMat4($,$,i),this.fogState&&x&&L.name!=="globe"&&(j=function(Y,ne,ve,_e,Te,Ce){const Re=Ce.calculateFogTileMatrix(Te),je=[ne,ve,_e];return r.ab.vec3.transformMat4(je,je,Re),or(Y,r.ab.vec3.length(je),Ce.pitch,Ce._fov)}(this.fogState,l,m,v,x.toUnwrapped(),this.transform)>.9)):Qu($,$,i);const G=$[3];return{point:new r.P(($[0]/G+1)/2*this.transform.width+Gi,(-$[1]/G+1)/2*this.transform.height+Gi),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(L)/G*.5,1.5),signedDistanceFromCamera:G,occluded:E&&$[2]>G||j}}isOffscreen(i,l,m,v){return m<Gi||i>=this.screenRightBoundary||v<Gi||l>this.screenBottomBoundary}isInsideGrid(i,l,m,v){return m>=0&&i<this.gridRightBoundary&&v>=0&&l<this.gridBottomBoundary}getViewportMatrix(){const i=r.ab.mat4.identity([]);return r.ab.mat4.translate(i,i,[-100,-100,0]),i}}function da(h,i,l){const m=i.createTileMatrix(h,h.worldSize,l.toUnwrapped());return r.ab.mat4.multiply(new Float32Array(16),h.projMatrix,m)}function fo(h,i,l){if(i.projection.name===l.projection.name)return h.projMatrix;const m=l.clone();return m.setProjection(i.projection),da(m,i.getProjection(),h)}function mf(h,i,l){return i.name===l.projection.name?h.projMatrix:da(l,i,h)}class fa{constructor(i,l,m,v){this.opacity=i?Math.max(0,Math.min(1,i.opacity+(i.placed?l:-l))):v&&m?1:0,this.placed=m}isHidden(){return this.opacity===0&&!this.placed}}class xl{constructor(i,l,m,v,x,E=!1){this.text=new fa(i?i.text:null,l,m,x),this.icon=new fa(i?i.icon:null,l,v,x),this.clipped=E}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Hc{constructor(i,l,m,v=!1){this.text=i,this.icon=l,this.skipFade=m,this.clipped=v}}class ec{constructor(){this.invProjMatrix=r.ab.mat4.create(),this.viewportMatrix=r.ab.mat4.create(),this.circles=[]}}class jx{constructor(i,l,m,v,x){this.bucketInstanceId=i,this.featureIndex=l,this.sourceLayerIndex=m,this.bucketIndex=v,this.tileID=x}}class wl{constructor(i){this.crossSourceCollisions=i,this.maxGroupID=0,this.collisionGroups={}}get(i){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[i]){const l=++this.maxGroupID;this.collisionGroups[i]={ID:l,predicate:m=>m.collisionGroupID===l}}return this.collisionGroups[i]}}function Tv(h,i,l,m,v){const{horizontalAlign:x,verticalAlign:E}=r.bD(h),L=-(x-.5)*i,$=-(E-.5)*l,j=r.bC(h,m);return new r.P(L+j[0]*v,$+j[1]*v)}function Gh(h,i,l,m,v){const x=new r.P(h,i);return l&&x._rotate(m?v:-v),x}class Ts{constructor(i,l,m,v,x,E){this.transform=i.clone(),this.projection=i.projection.name,this.collisionIndex=new Aa(this.transform,x),this.buildingIndex=E,this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=l,this.retainedQueryData={},this.collisionGroups=new wl(m),this.collisionCircleArrays={},this.prevPlacement=v,v&&(v.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(i,l,m,v,x=1){const E=m.getBucket(l),L=m.latestFeatureIndex;if(!E||!L||l.fqid!==E.layerIds[0])return;const $=E.layers[0].layout,j=E.layers[0].paint,G=m.collisionBoxArray,X=Math.pow(2,this.transform.zoom-m.tileID.overscaledZ),Y=m.tileSize/r.ag,ne=m.tileID.toUnwrapped();this.transform.setProjection(E.projection);const ve=(_e=m.tileID,Te=E.getProjection(),Ce=this.transform,Te.name===this.projection?Ce.calculateProjMatrix(_e.toUnwrapped()):da(Ce,Te,_e));var _e,Te,Ce;const Re=$.get("text-pitch-alignment")==="map",je=$.get("text-rotation-alignment")==="map";l.compileFilter(l.options);const Be=l.dynamicFilter(),et=l.dynamicFilterNeedsFeature(),Ze=this.transform.calculatePixelsToTileUnitsMatrix(m),Xe=Xu(ve,m.tileID.canonical,Re,je,this.transform,E.getProjection(),Ze);let Ke=null;if(Re){const vn=Wo(ve,m.tileID.canonical,Re,je,this.transform,E.getProjection(),Ze);Ke=r.ab.mat4.multiply([],this.transform.labelPlaneMatrix,vn)}let at=null;Be&&m.latestFeatureIndex&&(at={unwrappedTileID:ne,dynamicFilter:Be,dynamicFilterNeedsFeature:et}),this.retainedQueryData[E.bucketInstanceId]=new jx(E.bucketInstanceId,L,E.sourceLayerIndex,E.index,m.tileID);const[pt,Vt]=E.layers[0].layout.get("text-size-scale-range"),Rt=r.aw(x,pt,Vt),[ht,St]=$.get("icon-size-scale-range"),en=r.aw(x,ht,St),hn={bucket:E,layout:$,paint:j,posMatrix:ve,textLabelPlaneMatrix:Xe,labelToScreenMatrix:Ke,clippingData:at,scale:X,textPixelRatio:Y,holdingForFade:m.holdingForFade(),collisionBoxArray:G,partiallyEvaluatedTextSize:r.bp(E.textSizeData,this.transform.zoom,Rt),partiallyEvaluatedIconSize:r.bp(E.iconSizeData,this.transform.zoom,en),collisionGroup:this.collisionGroups.get(E.sourceID),latestFeatureIndex:m.latestFeatureIndex};if(v)for(const vn of E.sortKeyRanges){const{sortKey:It,symbolInstanceStart:ln,symbolInstanceEnd:Ht}=vn;i.push({sortKey:It,symbolInstanceStart:ln,symbolInstanceEnd:Ht,parameters:hn})}else i.push({symbolInstanceStart:0,symbolInstanceEnd:E.symbolInstances.length,parameters:hn})}attemptAnchorPlacement(i,l,m,v,x,E,L,$,j,G,X,Y,ne,ve,_e,Te,Ce,Re){const{textOffset0:je,textOffset1:Be,crossTileID:et}=Y,Ze=[je,Be],Xe=Tv(i,m,v,Ze,x),Ke=this.collisionIndex.placeCollisionBox(ve,x,l,Gh(Xe.x,Xe.y,E,L,this.transform.angle),X,$,j,G.predicate);if(Te){const at=ve.getSymbolInstanceIconSize(Re,this.transform.zoom,Y.placedIconSymbolIndex);if(this.collisionIndex.placeCollisionBox(ve,at,Te,Gh(Xe.x,Xe.y,E,L,this.transform.angle),X,$,j,G.predicate).box.length===0)return}if(Ke.box.length>0){let at;return this.prevPlacement&&this.prevPlacement.variableOffsets[et]&&this.prevPlacement.placements[et]&&this.prevPlacement.placements[et].text&&(at=this.prevPlacement.variableOffsets[et].anchor),this.variableOffsets[et]={textOffset:Ze,width:m,height:v,anchor:i,textScale:x,prevAnchor:at},this.markUsedJustification(ve,i,Y,_e),ve.allowVerticalPlacement&&(this.markUsedOrientation(ve,_e,Y),this.placedOrientations[et]=_e),{shift:Xe,placedGlyphBoxes:Ke}}}placeLayerBucketPart(i,l,m,v,x=1){const{bucket:E,layout:L,paint:$,posMatrix:j,textLabelPlaneMatrix:G,labelToScreenMatrix:X,clippingData:Y,textPixelRatio:ne,holdingForFade:ve,collisionBoxArray:_e,partiallyEvaluatedTextSize:Te,partiallyEvaluatedIconSize:Ce,collisionGroup:Re,latestFeatureIndex:je}=i.parameters,Be=L.get("text-optional"),et=L.get("icon-optional"),Ze=L.get("text-allow-overlap"),Xe=L.get("icon-allow-overlap"),Ke=L.get("text-rotation-alignment")==="map",at=L.get("text-pitch-alignment")==="map",pt=L.get("symbol-z-elevate"),Vt=$.get("symbol-z-offset"),Rt=L.get("symbol-elevation-reference")==="sea",[ht,St]=L.get("text-size-scale-range"),[en,hn]=L.get("icon-size-scale-range"),vn=r.aw(x,ht,St),It=r.aw(x,en,hn);this.transform.setProjection(E.projection);let ln=Ze&&(Xe||!E.hasIconData()||et),Ht=Xe&&(Ze||!E.hasTextData()||Be);const gn=!Vt.isConstant();!E.collisionArrays&&_e&&E.deserializeCollisionBoxes(_e),m&&v&&E.updateCollisionDebugBuffers(this.transform.zoom,_e,vn,It);const cn=(tn,Rn,Dn)=>{const{crossTileID:An,numVerticalGlyphVertices:Bn}=tn;let br=null;if(Y&&Y.dynamicFilterNeedsFeature||gn){const Ni=this.retainedQueryData[E.bucketInstanceId];br=je.loadFeature({featureIndex:tn.featureIndex,bucketIndex:Ni.bucketIndex,sourceLayerIndex:Ni.sourceLayerIndex,layoutVertexArrayOffset:0})}if(Y&&!(0,Y.dynamicFilter)({zoom:this.transform.zoom,pitch:this.transform.pitch},br,this.retainedQueryData[E.bucketInstanceId].tileID.canonical,new r.P(tn.tileAnchorX,tn.tileAnchorY),this.transform.calculateDistanceTileData(Y.unwrappedTileID)))return this.placements[An]=new Hc(!1,!1,!1,!0),void l.add(An);const ir=Vt.evaluate(br,{});if(l.has(An))return;if(ve)return void(this.placements[An]=new Hc(!1,!1,!1));let rr=!1,wr=!1,Gr=!0,Or=!1,Ui=!1,ki=null,li={box:null,offscreen:null,occluded:null},mi={box:null,offscreen:null,occluded:null},Lr=null,Kr=null,fr=null,ni=0,Ki=0,Do=0;Dn.textFeatureIndex?ni=Dn.textFeatureIndex:tn.useRuntimeCollisionCircles&&(ni=tn.featureIndex),Dn.verticalTextFeatureIndex&&(Ki=Dn.verticalTextFeatureIndex);const Rs=Ni=>{Ni.tileID=this.retainedQueryData[E.bucketInstanceId].tileID;const Ci=this.transform.elevation;Ni.elevation=Rt?ir:ir+(Ci?Ci.getAtTileOffset(Ni.tileID,Ni.tileAnchorX,Ni.tileAnchorY):0),Ni.elevation+=tn.zOffset},Zo=Dn.textBox;if(Zo){Rs(Zo);const Ni=Zr=>{let Xi=r.bq.horizontal;if(E.allowVerticalPlacement&&!Zr&&this.prevPlacement){const Ao=this.prevPlacement.placedOrientations[An];Ao&&(this.placedOrientations[An]=Ao,Xi=Ao,this.markUsedOrientation(E,Xi,tn))}return Xi},Ci=(Zr,Xi)=>{if(E.allowVerticalPlacement&&Bn>0&&Dn.verticalTextBox){for(const Ao of E.writingModes)if(Ao===r.bq.vertical?(li=Xi(),mi=li):li=Zr(),li&&li.box&&li.box.length)break}else li=Zr()};if(L.get("text-variable-anchor")){let Zr=L.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[An]){const Pi=this.prevPlacement.variableOffsets[An];Zr.indexOf(Pi.anchor)>0&&(Zr=Zr.filter(jo=>jo!==Pi.anchor),Zr.unshift(Pi.anchor))}const Xi=(Pi,jo,js)=>{const hs=E.getSymbolInstanceTextSize(Te,tn,this.transform.zoom,Rn),Ol=(Pi.x2-Pi.x1)*hs+2*Pi.padding,Qa=(Pi.y2-Pi.y1)*hs+2*Pi.padding,Yo=tn.hasIconTextFit&&!Xe?jo:null;Yo&&Rs(Yo);let Hs={box:[],offscreen:!1,occluded:!1};const Ll=Ze?2*Zr.length:Zr.length;for(let za=0;za<Ll;++za){const pc=this.attemptAnchorPlacement(Zr[za%Zr.length],Pi,Ol,Qa,hs,Ke,at,ne,j,Re,za>=Zr.length,tn,Rn,E,js,Yo,Te,Ce);if(pc&&(Hs=pc.placedGlyphBoxes,Hs&&Hs.box&&Hs.box.length)){rr=!0,ki=pc.shift;break}}return Hs};Ci(()=>Xi(Zo,Dn.iconBox,r.bq.horizontal),()=>{const Pi=Dn.verticalTextBox;return Pi&&Rs(Pi),E.allowVerticalPlacement&&!(li&&li.box&&li.box.length)&&Bn>0&&Pi?Xi(Pi,Dn.verticalIconBox,r.bq.vertical):{box:null,offscreen:null,occluded:null}}),li&&(rr=li.box,Gr=li.offscreen,Or=li.occluded);const Ao=Ni(!(!li||!li.box));if(!rr&&this.prevPlacement){const Pi=this.prevPlacement.variableOffsets[An];Pi&&(this.variableOffsets[An]=Pi,this.markUsedJustification(E,Pi.anchor,tn,Ao))}}else{const Zr=(Xi,Ao)=>{const Pi=E.getSymbolInstanceTextSize(Te,tn,this.transform.zoom,Rn,x),jo=this.collisionIndex.placeCollisionBox(E,Pi,Xi,new r.P(0,0),Ze,ne,j,Re.predicate);return jo&&jo.box&&jo.box.length&&(this.markUsedOrientation(E,Ao,tn),this.placedOrientations[An]=Ao),jo};Ci(()=>Zr(Zo,r.bq.horizontal),()=>{const Xi=Dn.verticalTextBox;return E.allowVerticalPlacement&&Bn>0&&Xi?(Rs(Xi),Zr(Xi,r.bq.vertical)):{box:null,offscreen:null,occluded:null}}),Ni(!!(li&&li.box&&li.box.length))}}if(Lr=li,rr=Lr&&Lr.box&&Lr.box.length>0,Gr=Lr&&Lr.offscreen,Or=Lr&&Lr.occluded,tn.useRuntimeCollisionCircles){const Ni=E.text.placedSymbolArray.get(tn.centerJustifiedTextSymbolIndex>=0?tn.centerJustifiedTextSymbolIndex:tn.verticalPlacedTextSymbolIndex),Ci=r.br(E.textSizeData,Te,Ni),Zr=L.get("text-padding");Kr=this.collisionIndex.placeCollisionCircles(E,Ze,Ni,E.lineVertexArray,E.glyphOffsetArray,Ci,j,G,X,m,at,Re.predicate,tn.collisionCircleDiameter*Ci/r.bw,Zr,this.retainedQueryData[E.bucketInstanceId].tileID),rr=Ze||Kr.circles.length>0&&!Kr.collisionDetected,Gr=Gr&&Kr.offscreen,Or=Kr.occluded}if(Dn.iconFeatureIndex&&(Do=Dn.iconFeatureIndex),Dn.iconBox){const Ni=Ci=>{Rs(Ci);const Zr=tn.hasIconTextFit&&ki?Gh(ki.x,ki.y,Ke,at,this.transform.angle):new r.P(0,0),Xi=E.getSymbolInstanceIconSize(Ce,this.transform.zoom,tn.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(E,Xi,Ci,Zr,Xe,ne,j,Re.predicate)};mi&&mi.box&&mi.box.length&&Dn.verticalIconBox?(fr=Ni(Dn.verticalIconBox),wr=fr.box.length>0):(fr=Ni(Dn.iconBox),wr=fr.box.length>0),Gr=Gr&&fr.offscreen,Ui=fr.occluded}const Io=Be||tn.numHorizontalGlyphVertices===0&&Bn===0,ho=et||tn.numIconVertices===0;if(Io||ho?ho?Io||(wr=wr&&rr):rr=wr&&rr:wr=rr=wr&&rr,rr&&Lr&&Lr.box&&this.collisionIndex.insertCollisionBox(Lr.box,L.get("text-ignore-placement"),E.bucketInstanceId,mi&&mi.box&&Ki?Ki:ni,Re.ID),wr&&fr&&this.collisionIndex.insertCollisionBox(fr.box,L.get("icon-ignore-placement"),E.bucketInstanceId,Do,Re.ID),Kr&&(rr&&this.collisionIndex.insertCollisionCircles(Kr.circles,L.get("text-ignore-placement"),E.bucketInstanceId,ni,Re.ID),m)){const Ni=E.bucketInstanceId;let Ci=this.collisionCircleArrays[Ni];Ci===void 0&&(Ci=this.collisionCircleArrays[Ni]=new ec);for(let Zr=0;Zr<Kr.circles.length;Zr+=4)Ci.circles.push(Kr.circles[Zr+0]),Ci.circles.push(Kr.circles[Zr+1]),Ci.circles.push(Kr.circles[Zr+2]),Ci.circles.push(Kr.collisionDetected?1:0)}const to=E.projection.name!=="globe";ln=ln&&(to||!Or),Ht=Ht&&(to||!Ui),this.placements[An]=new Hc(rr||ln,wr||Ht,Gr||E.justReloaded),l.add(An)};if(pt&&this.buildingIndex&&(this.buildingIndex.updateZOffset(E,this.retainedQueryData[E.bucketInstanceId].tileID),E.updateZOffset()),E.sortFeaturesByY){const tn=E.getSortedSymbolIndexes(this.transform.angle);for(let Rn=tn.length-1;Rn>=0;--Rn){const Dn=tn[Rn];cn(E.symbolInstances.get(Dn),Dn,E.collisionArrays[Dn])}E.hasAnyZOffset&&r.w(`${E.layerIds[0]} layer symbol-z-elevate: symbols are not sorted by elevation if symbol-z-order is evaluated to viewport-y`)}else if(E.hasAnyZOffset){const tn=E.getSortedIndexesByZOffset();for(let Rn=0;Rn<tn.length;++Rn){const Dn=tn[Rn];cn(E.symbolInstances.get(Dn),Dn,E.collisionArrays[Dn])}}else for(let tn=i.symbolInstanceStart;tn<i.symbolInstanceEnd;tn++)cn(E.symbolInstances.get(tn),tn,E.collisionArrays[tn]);if(m&&E.bucketInstanceId in this.collisionCircleArrays){const tn=this.collisionCircleArrays[E.bucketInstanceId];r.ab.mat4.invert(tn.invProjMatrix,j),tn.viewportMatrix=this.collisionIndex.getViewportMatrix()}E.justReloaded=!1}markUsedJustification(i,l,m,v){const{leftJustifiedTextSymbolIndex:x,centerJustifiedTextSymbolIndex:E,rightJustifiedTextSymbolIndex:L,verticalPlacedTextSymbolIndex:$,crossTileID:j}=m,G=r.bB(l),X=v===r.bq.vertical?$:G==="left"?x:G==="center"?E:G==="right"?L:-1;x>=0&&(i.text.placedSymbolArray.get(x).crossTileID=X>=0&&x!==X?0:j),E>=0&&(i.text.placedSymbolArray.get(E).crossTileID=X>=0&&E!==X?0:j),L>=0&&(i.text.placedSymbolArray.get(L).crossTileID=X>=0&&L!==X?0:j),$>=0&&(i.text.placedSymbolArray.get($).crossTileID=X>=0&&$!==X?0:j)}markUsedOrientation(i,l,m){const v=l===r.bq.horizontal||l===r.bq.horizontalOnly?l:0,x=l===r.bq.vertical?l:0,{leftJustifiedTextSymbolIndex:E,centerJustifiedTextSymbolIndex:L,rightJustifiedTextSymbolIndex:$,verticalPlacedTextSymbolIndex:j}=m,G=i.text.placedSymbolArray;E>=0&&(G.get(E).placedOrientation=v),L>=0&&(G.get(L).placedOrientation=v),$>=0&&(G.get($).placedOrientation=v),j>=0&&(G.get(j).placedOrientation=x)}commit(i){this.commitTime=i,this.zoomAtLastRecencyCheck=this.transform.zoom;const l=this.prevPlacement;let m=!1;this.prevZoomAdjustment=l?l.zoomAdjustment(this.transform.zoom):0;const v=l?l.symbolFadeChange(i):1,x=l?l.opacities:{},E=l?l.variableOffsets:{},L=l?l.placedOrientations:{};for(const $ in this.placements){const j=this.placements[$],G=x[$];G?(this.opacities[$]=new xl(G,v,j.text,j.icon,null,j.clipped),m=m||j.text!==G.text.placed||j.icon!==G.icon.placed):(this.opacities[$]=new xl(null,v,j.text,j.icon,j.skipFade,j.clipped),m=m||j.text||j.icon)}for(const $ in x){const j=x[$];if(!this.opacities[$]){const G=new xl(j,v,!1,!1);G.isHidden()||(this.opacities[$]=G,m=m||j.text.placed||j.icon.placed)}}for(const $ in E)this.variableOffsets[$]||!this.opacities[$]||this.opacities[$].isHidden()||(this.variableOffsets[$]=E[$]);for(const $ in L)this.placedOrientations[$]||!this.opacities[$]||this.opacities[$].isHidden()||(this.placedOrientations[$]=L[$]);m?this.lastPlacementChangeTime=i:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=l?l.lastPlacementChangeTime:i)}updateLayerOpacities(i,l,m,v){const x=new Set;for(const E of l){const L=E.getBucket(i);L&&E.latestFeatureIndex&&i.fqid===L.layerIds[0]&&(this.updateBucketOpacities(L,x,E,E.collisionBoxArray,m,v,E.tileID,i.scope),L.layers[0].layout.get("symbol-z-elevate")&&this.buildingIndex&&(this.buildingIndex.updateZOffset(L,E.tileID),L.updateZOffset()))}}updateBucketOpacities(i,l,m,v,x,E,L,$){i.hasTextData()&&i.text.opacityVertexArray.clear(),i.hasIconData()&&i.icon.opacityVertexArray.clear(),i.hasIconCollisionBoxData()&&i.iconCollisionBox.collisionVertexArray.clear(),i.hasTextCollisionBoxData()&&i.textCollisionBox.collisionVertexArray.clear();const j=i.layers[0].layout,G=i.layers[0].paint,X=!!i.layers[0].dynamicFilter(),Y=new xl(null,0,!1,!1,!0),ne=j.get("text-allow-overlap"),ve=j.get("icon-allow-overlap"),_e=j.get("text-variable-anchor"),Te=j.get("text-rotation-alignment")==="map",Ce=j.get("text-pitch-alignment")==="map",Re=G.get("symbol-z-offset"),je=j.get("symbol-elevation-reference")==="sea",Be=!Re.isConstant(),et=new xl(null,0,ne&&(ve||!i.hasIconData()||j.get("icon-optional")),ve&&(ne||!i.hasTextData()||j.get("text-optional")),!0);!i.collisionArrays&&v&&(i.hasIconCollisionBoxData()||i.hasTextCollisionBoxData())&&i.deserializeCollisionBoxes(v);const Ze=(Ke,at,pt)=>{for(let Vt=0;Vt<at/4;Vt++)Ke.opacityVertexArray.emplaceBack(pt)};let Xe=0;E&&i.updateReplacement(L,E);for(let Ke=0;Ke<i.symbolInstances.length;Ke++){const at=i.symbolInstances.get(Ke),{numHorizontalGlyphVertices:pt,numVerticalGlyphVertices:Vt,crossTileID:Rt,numIconVertices:ht,tileAnchorX:St,tileAnchorY:en}=at;let hn=null;const vn=this.retainedQueryData[i.bucketInstanceId];Be&&at&&vn&&(hn=m.latestFeatureIndex.loadFeature({featureIndex:at.featureIndex,bucketIndex:vn.bucketIndex,sourceLayerIndex:vn.sourceLayerIndex,layoutVertexArrayOffset:0}));const It=Re.evaluate(hn,{}),ln=l.has(Rt);let Ht=this.opacities[Rt];ln?Ht=Y:Ht||(Ht=et,this.opacities[Rt]=Ht),l.add(Rt);const gn=pt>0||Vt>0,cn=ht>0,tn=this.placedOrientations[Rt],Rn=tn===r.bq.vertical,Dn=tn===r.bq.horizontal||tn===r.bq.horizontalOnly;!gn&&!cn||Ht.isHidden()||Xe++;let An=!1;if((gn||cn)&&E)for(const Bn of i.activeReplacements){if(r.bx(Bn,x,r.by.Symbol,$)||Bn.min.x>St||St>Bn.max.x||Bn.min.y>en||en>Bn.max.y)continue;const br=r.bz(St,en,L.canonical,Bn.footprintTileId.canonical);if(An=r.bA(br,Bn.footprint),An)break}if(gn){const Bn=An?ka:Ev(Ht.text);Ze(i.text,pt,Rn?ka:Bn),Ze(i.text,Vt,Dn?ka:Bn);const br=Ht.text.isHidden(),{leftJustifiedTextSymbolIndex:ir,centerJustifiedTextSymbolIndex:rr,rightJustifiedTextSymbolIndex:wr,verticalPlacedTextSymbolIndex:Gr}=at,Or=i.text.placedSymbolArray,Ui=br||Rn?1:0;ir>=0&&(Or.get(ir).hidden=Ui),rr>=0&&(Or.get(rr).hidden=Ui),wr>=0&&(Or.get(wr).hidden=Ui),Gr>=0&&(Or.get(Gr).hidden=br||Dn?1:0);const ki=this.variableOffsets[Rt];ki&&this.markUsedJustification(i,ki.anchor,at,tn);const li=this.placedOrientations[Rt];li&&(this.markUsedJustification(i,"left",at,li),this.markUsedOrientation(i,li,at))}if(cn){const Bn=An?ka:Ev(Ht.icon),{placedIconSymbolIndex:br,verticalPlacedIconSymbolIndex:ir}=at,rr=i.icon.placedSymbolArray,wr=Ht.icon.isHidden()?1:0;br>=0&&(Ze(i.icon,ht,Rn?ka:Bn),rr.get(br).hidden=wr),ir>=0&&(Ze(i.icon,at.numVerticalIconVertices,Dn?ka:Bn),rr.get(ir).hidden=wr)}if(i.hasIconCollisionBoxData()||i.hasTextCollisionBoxData()){const Bn=i.collisionArrays[Ke];if(Bn){let br=new r.P(0,0),ir=!0;if(Bn.textBox||Bn.verticalTextBox){if(_e){const wr=this.variableOffsets[Rt];wr?(br=Tv(wr.anchor,wr.width,wr.height,wr.textOffset,wr.textScale),Te&&br._rotate(Ce?this.transform.angle:-this.transform.angle)):ir=!1}X&&(ir=!Ht.clipped),Bn.textBox&&Wh(i.textCollisionBox.collisionVertexArray,Ht.text.placed,!ir||Rn,It,je,br.x,br.y),Bn.verticalTextBox&&Wh(i.textCollisionBox.collisionVertexArray,Ht.text.placed,!ir||Dn,It,je,br.x,br.y)}const rr=ir&&!!(!Dn&&Bn.verticalIconBox);Bn.iconBox&&Wh(i.iconCollisionBox.collisionVertexArray,Ht.icon.placed,rr,It,je,at.hasIconTextFit?br.x:0,at.hasIconTextFit?br.y:0),Bn.verticalIconBox&&Wh(i.iconCollisionBox.collisionVertexArray,Ht.icon.placed,!rr,It,je,at.hasIconTextFit?br.x:0,at.hasIconTextFit?br.y:0)}}}if(i.fullyClipped=Xe===0,i.sortFeatures(this.transform.angle),this.retainedQueryData[i.bucketInstanceId]&&(this.retainedQueryData[i.bucketInstanceId].featureSortOrder=i.featureSortOrder),i.hasTextData()&&i.text.opacityVertexBuffer&&i.text.opacityVertexBuffer.updateData(i.text.opacityVertexArray),i.hasIconData()&&i.icon.opacityVertexBuffer&&i.icon.opacityVertexBuffer.updateData(i.icon.opacityVertexArray),i.hasIconCollisionBoxData()&&i.iconCollisionBox.collisionVertexBuffer&&i.iconCollisionBox.collisionVertexBuffer.updateData(i.iconCollisionBox.collisionVertexArray),i.hasTextCollisionBoxData()&&i.textCollisionBox.collisionVertexBuffer&&i.textCollisionBox.collisionVertexBuffer.updateData(i.textCollisionBox.collisionVertexArray),i.bucketInstanceId in this.collisionCircleArrays){const Ke=this.collisionCircleArrays[i.bucketInstanceId];i.placementInvProjMatrix=Ke.invProjMatrix,i.placementViewportMatrix=Ke.viewportMatrix,i.collisionCircleArray=Ke.circles,delete this.collisionCircleArrays[i.bucketInstanceId]}}symbolFadeChange(i){return this.fadeDuration===0?1:(i-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(i){return Math.max(0,(this.transform.zoom-i)/1.5)}hasTransitions(i){return this.stale||i-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(i,l){const m=this.zoomAtLastRecencyCheck===l?1-this.zoomAdjustment(l):1;return this.zoomAtLastRecencyCheck=l,this.commitTime+this.fadeDuration*m>i}setStale(){this.stale=!0}}function Wh(h,i,l,m,v,x,E){h.emplaceBack(i?1:0,l?1:0,x||0,E||0,m,v?1:0),h.emplaceBack(i?1:0,l?1:0,x||0,E||0,m,v?1:0),h.emplaceBack(i?1:0,l?1:0,x||0,E||0,m,v?1:0),h.emplaceBack(i?1:0,l?1:0,x||0,E||0,m,v?1:0)}const qh=Math.pow(2,25),Cv=Math.pow(2,24),gf=Math.pow(2,17),Hx=Math.pow(2,16),Gx=Math.pow(2,9),_f=Math.pow(2,8),yf=Math.pow(2,1);function Ev(h){if(h.opacity===0&&!h.placed)return 0;if(h.opacity===1&&h.placed)return 4294967295;const i=h.placed?1:0,l=Math.floor(127*h.opacity);return l*qh+i*Cv+l*gf+i*Hx+l*Gx+i*_f+l*yf+i}const ka=0;class Mv{constructor(i){this._sortAcrossTiles=i.layout.get("symbol-z-order")!=="viewport-y"&&i.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs=new Set,this._bucketParts=[]}continuePlacement(i,l,m,v,x,E){const L=this._bucketParts;for(;this._currentTileIndex<i.length;)if(l.getBucketParts(L,v,i[this._currentTileIndex],this._sortAcrossTiles,E),this._currentTileIndex++,x())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,L.sort(($,j)=>$.sortKey-j.sortKey));this._currentPartIndex<L.length;){const $=L[this._currentPartIndex];if(l.placeLayerBucketPart($,this._seenCrossTileIDs,m,$.symbolInstanceStart===0,E),this._currentPartIndex++,x())return!0}return!1}}class Kh{constructor(i,l,m,v,x,E,L,$,j){this.placement=new Ts(i,x,E,L,$,j),this._currentPlacementIndex=l.length-1,this._forceFullPlacement=m,this._showCollisionBoxes=v,this._done=!1}isDone(){return this._done}continuePlacement(i,l,m,v,x){const E=r.q.now(),L=()=>{const $=r.q.now()-E;return!this._forceFullPlacement&&$>2};for(;this._currentPlacementIndex>=0;){const $=l[i[this._currentPlacementIndex]],j=this.placement.collisionIndex.transform.zoom;if($.type==="symbol"&&(!$.minzoom||$.minzoom<=j)&&(!$.maxzoom||$.maxzoom>j)){const G=$,X=G.layout.get("symbol-z-elevate"),Y=G.layout.get("symbol-sort-key").constantOr(1)!==void 0,ne=G.layout.get("symbol-z-order"),ve=ne==="viewport-y"||ne==="auto"&&!(ne!=="viewport-y"&&Y),_e=G.layout.get("text-allow-overlap")||G.layout.get("icon-allow-overlap")||G.layout.get("text-ignore-placement")||G.layout.get("icon-ignore-placement"),Te=ve&&_e,Ce=this._inProgressLayer=this._inProgressLayer||new Mv(G),Re=r.aC($.source,$.scope);if(Ce.continuePlacement(X||Te?v[Re]:m[Re],this.placement,this._showCollisionBoxes,$,L,x))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(i){return this.placement.commit(i),this.placement}}const Ya=512/r.ag/2;class Wx{constructor(i,l,m){this.tileID=i,this.bucketInstanceId=m,this.index=new r.bE(l.length,16,Int32Array),this.keys=[],this.crossTileIDs=[];const v=i.canonical.x*r.ag,x=i.canonical.y*r.ag;for(let E=0;E<l.length;E++){const{key:L,crossTileID:$,tileAnchorX:j,tileAnchorY:G}=l.get(E),X=Math.floor((v+j)*Ya),Y=Math.floor((x+G)*Ya);this.index.add(X,Y),this.keys.push(L),this.crossTileIDs.push($)}this.index.finish()}findMatches(i,l,m){const v=this.tileID.canonical.z<l.canonical.z?1:Math.pow(2,this.tileID.canonical.z-l.canonical.z),x=Ya/Math.pow(2,l.canonical.z-this.tileID.canonical.z),E=l.canonical.x*r.ag,L=l.canonical.y*r.ag;for(let $=0;$<i.length;$++){const j=i.get($);if(j.crossTileID)continue;const{key:G,tileAnchorX:X,tileAnchorY:Y}=j,ne=Math.floor((E+X)*x),ve=Math.floor((L+Y)*x),_e=this.index.range(ne-v,ve-v,ne+v,ve+v);for(const Te of _e){const Ce=this.crossTileIDs[Te];if(this.keys[Te]===G&&!m.has(Ce)){m.add(Ce),j.crossTileID=Ce;break}}}}}class qx{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Kx{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(i){const l=Math.round((i-this.lng)/360);if(l!==0)for(const m in this.indexes){const v=this.indexes[m],x={};for(const E in v){const L=v[E];L.tileID=L.tileID.unwrapTo(L.tileID.wrap+l),x[L.tileID.key]=L}this.indexes[m]=x}this.lng=i}addBucket(i,l,m){if(this.indexes[i.overscaledZ]&&this.indexes[i.overscaledZ][i.key]){if(this.indexes[i.overscaledZ][i.key].bucketInstanceId===l.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(i.overscaledZ,this.indexes[i.overscaledZ][i.key])}for(let x=0;x<l.symbolInstances.length;x++)l.symbolInstances.get(x).crossTileID=0;this.usedCrossTileIDs[i.overscaledZ]||(this.usedCrossTileIDs[i.overscaledZ]=new Set);const v=this.usedCrossTileIDs[i.overscaledZ];for(const x in this.indexes){const E=this.indexes[x];if(Number(x)>i.overscaledZ)for(const L in E){const $=E[L];$.tileID.isChildOf(i)&&$.findMatches(l.symbolInstances,i,v)}else{const L=E[i.scaledTo(Number(x)).key];L&&L.findMatches(l.symbolInstances,i,v)}}for(let x=0;x<l.symbolInstances.length;x++){const E=l.symbolInstances.get(x);E.crossTileID||(E.crossTileID=m.generate(),v.add(E.crossTileID))}return this.indexes[i.overscaledZ]===void 0&&(this.indexes[i.overscaledZ]={}),this.indexes[i.overscaledZ][i.key]=new Wx(i,l.symbolInstances,l.bucketInstanceId),!0}removeBucketCrossTileIDs(i,l){for(const m of l.crossTileIDs)this.usedCrossTileIDs[i].delete(m)}removeStaleBuckets(i){let l=!1;for(const m in this.indexes){const v=this.indexes[m];for(const x in v)i[v[x].bucketInstanceId]||(this.removeBucketCrossTileIDs(m,v[x]),delete v[x],l=!0)}return l}}class Iv{constructor(){this.layerIndexes={},this.crossTileIDs=new qx,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(i,l,m,v){let x=this.layerIndexes[i.fqid];x===void 0&&(x=this.layerIndexes[i.fqid]=new Kx);let E=!1;const L={};v.name!=="globe"&&x.handleWrapJump(m);for(const $ of l){const j=$.getBucket(i);j&&i.fqid===j.layerIds[0]&&(j.bucketInstanceId||(j.bucketInstanceId=++this.maxBucketInstanceId),x.addBucket($.tileID,j,this.crossTileIDs)&&(E=!0),L[j.bucketInstanceId]=!0)}return x.removeStaleBuckets(L)&&(E=!0),E}pruneUnusedLayers(i){const l={};i.forEach(m=>{l[m]=!0});for(const m in this.layerIndexes)l[m]||delete this.layerIndexes[m]}}const Gc=771;class zr{constructor(i,l,m,v){this.blendFunction=i,this.blendColor=l,this.mask=m,this.blendEquation=v}}zr.Replace=[1,0,1,0],zr.disabled=new zr(zr.Replace,r.aj.transparent,[!1,!1,!1,!1]),zr.unblended=new zr(zr.Replace,r.aj.transparent,[!0,!0,!0,!0]),zr.alphaBlended=new zr([1,Gc,1,Gc],r.aj.transparent,[!0,!0,!0,!0]),zr.alphaBlendedNonPremultiplied=new zr([770,Gc,770,Gc],r.aj.transparent,[!0,!0,!0,!0]),zr.multiply=new zr([774,0,774,0],r.aj.transparent,[!0,!0,!0,!0]);class nr{constructor(i,l,m){this.func=i,this.mask=l,this.range=m}}nr.ReadOnly=!1,nr.ReadWrite=!0,nr.disabled=new nr(519,nr.ReadOnly,[0,1]);const Zh=7680;class Tr{constructor(i,l,m,v,x,E){this.test=i,this.ref=l,this.mask=m,this.fail=v,this.depthFail=x,this.pass=E}}Tr.disabled=new Tr({func:519,mask:0},0,0,Zh,Zh,Zh);const Yh=1029,Sl=2305;class mr{constructor(i,l,m){this.enable=i,this.mode=l,this.frontFace=m}}function yg(h,i){const l=r.bG(h,3);r.ab.mat4.fromQuat(h,i),r.bI(h,3,l)}function Xh(h,i){const l=r.ab.quat.identity([]);return r.ab.quat.rotateZ(l,l,-i),r.ab.quat.rotateX(l,l,-h),l}function Wc(h,i){const l=[h[0],h[1],0],m=[i[0],i[1],0];if(r.ab.vec3.length(l)>=1e-15){const E=r.ab.vec3.normalize([],l);r.ab.vec3.scale(m,E,r.ab.vec3.dot(m,E)),i[0]=m[0],i[1]=m[1]}const v=r.ab.vec3.cross([],i,h);if(r.ab.vec3.len(v)<1e-15)return null;const x=Math.atan2(-v[1],v[0]);return Xh(Math.atan2(Math.sqrt(h[0]*h[0]+h[1]*h[1]),-h[2]),x)}mr.disabled=new mr(!1,Yh,Sl),mr.backCCW=new mr(!0,Yh,Sl),mr.backCW=new mr(!0,Yh,2304),mr.frontCW=new mr(!0,1028,2304),mr.frontCCW=new mr(!0,1028,Sl);class qc{constructor(i,l){this.position=i,this.orientation=l}get position(){return this._position}set position(i){if(i){const l=i instanceof r.aa?i:new r.aa(i[0],i[1],i[2]);this._renderWorldCopies&&(l.x=r.bF(l.x,0,1)),this._position=l}else this._position=null}lookAtPoint(i,l){if(this.orientation=null,!this.position)return;const m=this.position,v=this._elevation?this._elevation.getAtPointOrZero(r.aa.fromLngLat(i)):0,x=r.aa.fromLngLat(i,v),E=[x.x-m.x,x.y-m.y,x.z-m.z];l||(l=[0,0,1]),l[2]=Math.abs(l[2]),this.orientation=Wc(E,l)}setPitchBearing(i,l){this.orientation=Xh(r.ai(i),r.ai(-l))}}class vf{constructor(i,l){this._transform=r.ab.mat4.identity([]),this.orientation=l,this.position=i}get mercatorPosition(){const i=this.position;return new r.aa(i[0],i[1],i[2])}get position(){const i=r.bG(this._transform,3);return[i[0],i[1],i[2]]}set position(i){var l;i&&r.bI(this._transform,3,[(l=i)[0],l[1],l[2],1])}get orientation(){return this._orientation}set orientation(i){this._orientation=i||r.ab.quat.identity([]),i&&yg(this._transform,this._orientation)}getPitchBearing(){const i=this.forward(),l=this.right();return{bearing:Math.atan2(-l[1],l[0]),pitch:Math.atan2(Math.sqrt(i[0]*i[0]+i[1]*i[1]),-i[2])}}setPitchBearing(i,l){this._orientation=Xh(i,l),yg(this._transform,this._orientation)}forward(){const i=r.bG(this._transform,2);return[-i[0],-i[1],-i[2]]}up(){const i=r.bG(this._transform,1);return[-i[0],-i[1],-i[2]]}right(){const i=r.bG(this._transform,0);return[i[0],i[1],i[2]]}getCameraToWorld(i,l){const m=new Float64Array(16);return r.ab.mat4.invert(m,this.getWorldToCamera(i,l)),m}getCameraToWorldMercator(){return this._transform}getWorldToCameraPosition(i,l,m){const v=this.position;r.ab.vec3.scale(v,v,-i);const x=new Float64Array(16);return r.ab.mat4.fromScaling(x,[m,m,m]),r.ab.mat4.translate(x,x,v),x[10]*=l,x}getWorldToCamera(i,l){const m=new Float64Array(16),v=new Float64Array(4),x=this.position;return r.ab.quat.conjugate(v,this._orientation),r.ab.vec3.scale(x,x,-i),r.ab.mat4.fromQuat(m,v),r.ab.mat4.translate(m,m,x),m[1]*=-1,m[5]*=-1,m[9]*=-1,m[13]*=-1,m[8]*=l,m[9]*=l,m[10]*=l,m[11]*=l,m}getCameraToClipPerspective(i,l,m,v){const x=new Float64Array(16);return r.ab.mat4.perspective(x,i,l,m,v),x}getCameraToClipOrthographic(i,l,m,v,x,E){const L=new Float64Array(16);return r.ab.mat4.ortho(L,i,l,m,v,x,E),L}getDistanceToElevation(i,l=!1){const m=i===0?0:r.bH(i,l?r.aS(this.position[1]):this.position[1]),v=this.forward();return(m-this.position[2])/v[2]}clone(){return new vf([...this.position],[...this.orientation])}}const Vo={BaseColor:5,MetallicRoughness:6,Normal:7,Occlusion:8,Emission:9,LUT:10,ShadowMap0:11};class Cs{constructor(i=0,l=0,m=0,v=0){if(isNaN(i)||i<0||isNaN(l)||l<0||isNaN(m)||m<0||isNaN(v)||v<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=i,this.bottom=l,this.left=m,this.right=v}interpolate(i,l,m){return l.top!=null&&i.top!=null&&(this.top=r.af(i.top,l.top,m)),l.bottom!=null&&i.bottom!=null&&(this.bottom=r.af(i.bottom,l.bottom,m)),l.left!=null&&i.left!=null&&(this.left=r.af(i.left,l.left,m)),l.right!=null&&i.right!=null&&(this.right=r.af(i.right,l.right,m)),this}getCenter(i,l){const m=r.aw((this.left+i-this.right)/2,0,i),v=r.aw((this.top+l-this.bottom)/2,0,l);return new r.P(m,v)}equals(i){return this.top===i.top&&this.bottom===i.bottom&&this.left===i.left&&this.right===i.right}clone(){return new Cs(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}const Jh=(h,i,l)=>(1-l)*h+l*i,kn=h=>h*h*h*h*h;class Qh{constructor(i,l,m,v,x,E,L){this.tileSize=512,this._renderWorldCopies=x===void 0||x,this._minZoom=i||0,this._maxZoom=l||22,this._minPitch=m??0,this._maxPitch=v??60,this.setProjection(E),this.setMaxBounds(L),this.width=0,this.height=0,this._center=new r.bO(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new Cs,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._expandedProjMatrixCache={},this._distanceTileDataCache={},this._camera=new vf,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._tileCoverLift=0,this.freezeTileCoverage=!1,this._horizonShift=.1,this._orthographicProjectionAtLowPitch=!1}clone(){const i=new Qh(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection());return i._elevation=this._elevation,i._centerAltitude=this._centerAltitude,i._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,i.tileSize=this.tileSize,i.mercatorFromTransition=this.mercatorFromTransition,i.width=this.width,i.height=this.height,i.cameraElevationReference=this.cameraElevationReference,i._center=this._center,i._setZoom(this.zoom),i._seaLevelZoom=this._seaLevelZoom,i.angle=this.angle,i._fov=this._fov,i._pitch=this._pitch,i._nearZ=this._nearZ,i._farZ=this._farZ,i._averageElevation=this._averageElevation,i._orthographicProjectionAtLowPitch=this._orthographicProjectionAtLowPitch,i._unmodified=this._unmodified,i._edgeInsets=this._edgeInsets.clone(),i._camera=this._camera.clone(),i._calcMatrices(),i.freezeTileCoverage=this.freezeTileCoverage,i.frustumCorners=this.frustumCorners,i}get isOrthographic(){return this.projection.name!=="globe"&&this._orthographicProjectionAtLowPitch&&this.pitch<15}get elevation(){return this._elevation}set elevation(i){this._elevation!==i&&(this._elevation=i,this._updateCameraOnTerrain(),this._calcMatrices())}get depthOcclusionForSymbolsAndCircles(){return this.projection.name!=="globe"&&!this.isOrthographic}updateElevation(i,l=!1){const m=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(this._seaLevelZoom==null||m)&&this._updateCameraOnTerrain(),(i||m)&&this._constrainCamera(l),this._calcMatrices()}getProjection(){return r.ay(this.projection,["name","center","parallels"])}setProjection(i){this.projectionOptions=i||{name:"mercator"};const l=this.projection?this.getProjection():void 0;this.projection=r.bP(this.projectionOptions);const m=this.getProjection(),v=!r.bn(l,m);return v&&this._calcMatrices(),this.mercatorFromTransition=!1,v}setOrthographicProjectionAtLowPitch(i){return this._orthographicProjectionAtLowPitch!==i&&(this._orthographicProjectionAtLowPitch=i,this._calcMatrices(),!0)}setMercatorFromTransition(){const i=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=r.bP({name:"mercator"});const l=i!==this.projection.name;return l&&this._calcMatrices(),l}get minZoom(){return this._minZoom}set minZoom(i){this._minZoom!==i&&(this._minZoom=i,this.zoom=Math.max(this.zoom,i))}get maxZoom(){return this._maxZoom}set maxZoom(i){this._maxZoom!==i&&(this._maxZoom=i,this.zoom=Math.min(this.zoom,i))}get minPitch(){return this._minPitch}set minPitch(i){this._minPitch!==i&&(this._minPitch=i,this.pitch=Math.max(this.pitch,i))}get maxPitch(){return this._maxPitch}set maxPitch(i){this._maxPitch!==i&&(this._maxPitch=i,this.pitch=Math.min(this.pitch,i))}get renderWorldCopies(){return this._renderWorldCopies&&this.projection.supportsWorldCopies===!0}set renderWorldCopies(i){i===void 0?i=!0:i===null&&(i=!1),this._renderWorldCopies=i}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){const i=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(i))}get cameraWorldSize(){const i=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(i))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return r.bH(1,this.center.lat)*this.cameraWorldSizeForFog}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new r.P(this.width,this.height)}get bearing(){return r.bF(this.rotation,-180,180)}set bearing(i){this.rotation=i}get rotation(){return-this.angle/Math.PI*180}set rotation(i){const l=-i*Math.PI/180;this.angle!==l&&(this._unmodified=!1,this.angle=l,this._calcMatrices(),this.rotationMatrix=r.ab.mat2.create(),r.ab.mat2.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(i){const l=r.aw(i,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==l&&(this._unmodified=!1,this._pitch=l,this._calcMatrices())}get aspect(){return this.width/this.height}get fov(){return this._fov/Math.PI*180}get fovX(){return this._fov}get fovY(){const i=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/i)}set fov(i){i=Math.max(.01,Math.min(60,i)),this._fov!==i&&(this._unmodified=!1,this._fov=r.ai(i),this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(i){this._averageElevation=i,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(i){const l=Math.min(Math.max(i,this.minZoom),this.maxZoom);this._zoom!==l&&(this._unmodified=!1,this._setZoom(l),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(i){this._zoom=i,this.scale=this.zoomScale(i),this.tileZoom=Math.floor(i),this.zoomFraction=i-this.tileZoom}get tileCoverLift(){return this._tileCoverLift}set tileCoverLift(i){this._tileCoverLift!==i&&(this._tileCoverLift=i)}_updateCameraOnTerrain(){const i=this.elevation?this.elevation.getAtPoint(this.locationCoordinate(this.center),Number.NEGATIVE_INFINITY):Number.NEGATIVE_INFINITY,l=this.elevation&&i===Number.NEGATIVE_INFINITY&&this.elevation.visibleDemTiles.length>0&&this.elevation.exaggeration()>0&&this._centerAltitudeValidForExaggeration;if(!this._elevation||i===Number.NEGATIVE_INFINITY&&(!l||!this._centerAltitude))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const m=this._elevation;l||this._centerAltitude&&this._centerAltitudeValidForExaggeration&&m.exaggeration()&&this._centerAltitudeValidForExaggeration!==m.exaggeration()?(this._centerAltitude=this._centerAltitude/this._centerAltitudeValidForExaggeration*m.exaggeration(),this._centerAltitudeValidForExaggeration=m.exaggeration()):(this._centerAltitude=i||0,this._centerAltitudeValidForExaggeration=m.exaggeration()),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){this._centerAltitudeValidForExaggeration!==void 0&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;const i=this._elevation,l=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],m=this.horizonLineFromTop();let v=0,x=0;for(let E=0;E<l.length;E++){const L=new r.P(l[E][0]*this.width,m+l[E][1]*(this.height-m)),$=i.pointCoordinate(L);if(!$)continue;const j=1/Math.hypot($[0]-this._camera.position[0],$[1]-this._camera.position[1]);v+=$[3]*j,x+=j}return x===0?NaN:v/x}get center(){return this._center}set center(i){i.lat===this._center.lat&&i.lng===this._center.lng||(this._unmodified=!1,this._center=i,this._terrainEnabled()&&(this.cameraElevationReference==="ground"?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(this._seaLevelZoom==null||!this._elevation)return;const i=this._seaLevelZoom,l=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),m=this.pixelsPerMeter/this.worldSize*l,v=this._mercatorZfromZoom(i),x=this._mercatorZfromZoom(this._maxZoom),E=Math.max(v-m,x);this._setZoom(this._zoomFromMercatorZ(E))}get padding(){return this._edgeInsets.toJSON()}set padding(i){this._edgeInsets.equals(i)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,i,1),this._calcMatrices())}computeZoomRelativeTo(i){const l=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,i.toAltitude()));let m;m=i.z<this._camera.position[2]?[l.x,l.y,l.z]:[i.x,i.y,i.z];const v=r.ab.vec3.length(r.ab.vec3.sub([],this._camera.position,m));return r.aw(this._zoomFromMercatorZ(v),this._minZoom,this._maxZoom)}setFreeCameraOptions(i){if(!this.height||!i.position&&!i.orientation)return;this._updateCameraState();let l=!1;if(i.orientation&&!r.ab.quat.exactEquals(i.orientation,this._camera.orientation)&&(l=this._setCameraOrientation(i.orientation)),i.position){const m=[i.position.x,i.position.y,i.position.z];r.ab.vec3.exactEquals(m,this._camera.position)||(this._setCameraPosition(m),l=!0)}l&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const i=this._camera.position,l=new qc;return l.position=new r.aa(i[0],i[1],i[2]),l.orientation=this._camera.orientation,l._elevation=this.elevation,l._renderWorldCopies=this.renderWorldCopies,l}_setCameraOrientation(i){if(!r.ab.quat.length(i))return!1;r.ab.quat.normalize(i,i);const l=r.ab.vec3.transformQuat([],[0,0,-1],i),m=r.ab.vec3.transformQuat([],[0,-1,0],i);if(m[2]<0)return!1;const v=Wc(l,m);return!!v&&(this._camera.orientation=v,!0)}_setCameraPosition(i){const l=this.zoomScale(this.minZoom)*this.tileSize,m=this.zoomScale(this.maxZoom)*this.tileSize,v=this.cameraToCenterDistance;i[2]=r.aw(i[2],v/m,v/l),this._camera.position=i}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(i){return this._edgeInsets.equals(i)}interpolatePadding(i,l,m){this._unmodified=!1,this._edgeInsets.interpolate(i,l,m),this._constrain(),this._calcMatrices()}coveringZoomLevel(i){const l=(i.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/i.tileSize));return Math.max(0,l)}getVisibleUnwrappedCoordinates(i){const l=[new r.bQ(0,i)];if(this.renderWorldCopies){const m=this.pointCoordinate(new r.P(0,0)),v=this.pointCoordinate(new r.P(this.width,0)),x=this.pointCoordinate(new r.P(this.width,this.height)),E=this.pointCoordinate(new r.P(0,this.height)),L=Math.floor(Math.min(m.x,v.x,x.x,E.x)),$=Math.floor(Math.max(m.x,v.x,x.x,E.x)),j=1;for(let G=L-j;G<=$+j;G++)G!==0&&l.push(new r.bQ(G,i))}return l}isLODDisabled(i){return(!i||this.pitch<=60)&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace}extendTileCover(i,l,m){let v=[];const x=m!==void 0,E=!x;if(E&&this.zoom<l||x&&m[0]===0&&m[1]===0)return v;const L=new Set,$=(G,X,Y,ne,ve)=>{const _e=r.c5(X,G,Y,ne,ve);L.has(_e)||(v.push(new r.aG(G,X,Y,ne,ve)),L.add(_e))};for(let G=0;G<i.length;G++){const X=i[G];if(E&&X.canonical.z!==l)continue;const Y=X.canonical,ne=X.overscaledZ,ve=X.wrap,_e=1<<Y.z,Te=Y.x+1<_e,Ce=Y.x>0,Re=Y.y+1<_e,je=Y.y>0,Be=X.wrap-(Ce?0:1),et=X.wrap+(Te?0:1),Ze=Ce?Y.x-1:_e-1,Xe=Te?Y.x+1:0;if(x)m[0]<0?($(ne,et,Y.z,Xe,Y.y),m[1]<0&&Re&&($(ne,ve,Y.z,Y.x,Y.y+1),$(ne,et,Y.z,Xe,Y.y+1)),m[1]>0&&je&&($(ne,ve,Y.z,Y.x,Y.y-1),$(ne,et,Y.z,Xe,Y.y-1))):m[0]>0?($(ne,Be,Y.z,Ze,Y.y),m[1]<0&&Re&&($(ne,ve,Y.z,Y.x,Y.y+1),$(ne,Be,Y.z,Ze,Y.y+1)),m[1]>0&&je&&($(ne,ve,Y.z,Y.x,Y.y-1),$(ne,Be,Y.z,Ze,Y.y-1))):m[1]<0&&Re?$(ne,ve,Y.z,Y.x,Y.y+1):je&&$(ne,ve,Y.z,Y.x,Y.y-1);else{const Ke=X.visibleQuadrants;1&Ke&&($(ne,Be,Y.z,Ze,Y.y),je&&($(ne,ve,Y.z,Y.x,Y.y-1),$(ne,Be,Y.z,Ze,Y.y-1))),2&Ke&&($(ne,et,Y.z,Xe,Y.y),je&&($(ne,ve,Y.z,Y.x,Y.y-1),$(ne,et,Y.z,Xe,Y.y-1))),4&Ke&&($(ne,Be,Y.z,Ze,Y.y),Re&&($(ne,ve,Y.z,Y.x,Y.y+1),$(ne,Be,Y.z,Ze,Y.y+1))),8&Ke&&($(ne,et,Y.z,Xe,Y.y),Re&&($(ne,ve,Y.z,Y.x,Y.y+1),$(ne,et,Y.z,Xe,Y.y+1)))}}const j=[];for(const G of v)v.some(X=>G.isChildOf(X))||j.push(G);if(v=j.filter(G=>!i.some(X=>!!(G.overscaledZ<l&&X.isChildOf(G))||G.equals(X)||G.isChildOf(X))),E){const G=1<<l,X=this.projection.name==="globe"?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),Y=[G*X.x,G*X.y],ne=4,ve=ne*ne;v=v.filter(_e=>{const Te=_e.canonical.x+.5-Y[0],Ce=_e.canonical.y+.5-Y[1];return Te*Te+Ce*Ce<ve})}return v}coveringTiles(i){let l=this.coveringZoomLevel(i);const m=l,v=this.elevation&&this.elevation.exaggeration(),x=v&&!i.isTerrainDEM,E=this.projection.name==="mercator";if(i.minzoom!==void 0&&l<i.minzoom)return[];i.maxzoom!==void 0&&l>i.maxzoom&&(l=i.maxzoom);const L=this.locationCoordinate(this.center),$=this.center.lat,j=1<<l,G=[j*L.x,j*L.y,0],X=this.projection.name==="globe",Y=!X,ne=r.bR.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,l,Y),ve=X?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),_e=j*r.bH(1,this.center.lat),Te=this._camera.position[2]/r.bH(1,this.center.lat),Ce=[j*ve.x,j*ve.y,Te*(Y?1:_e)],Re=X||v,je=this.cameraToCenterDistance/i.tileSize*(i.roundZoom?1:.502),Be=this.isLODDisabled(!0)?l:0;let et;if(this._elevation&&i.isTerrainDEM)et=1e4*this._elevation.exaggeration();else if(this._elevation){const It=this._elevation.getMinMaxForVisibleTiles();et=It?It.max:this._centerAltitude}else et=this._centerAltitude;const Ze=i.isTerrainDEM?-et:this._elevation?this._elevation.getMinElevationBelowMSL():0,Xe=this.projection.isReprojectedInTileSpace?r.bS(this):1,Ke=It=>{const Ht=new r.aa(It.x+25e-6,It.y,It.z),gn=new r.aa(It.x,It.y+25e-6,It.z),cn=It.toLngLat(),tn=Ht.toLngLat(),Rn=gn.toLngLat(),Dn=this.locationCoordinate(cn),An=this.locationCoordinate(tn),Bn=this.locationCoordinate(Rn),br=Math.hypot(An.x-Dn.x,An.y-Dn.y),ir=Math.hypot(Bn.x-Dn.x,Bn.y-Dn.y);return Math.sqrt(br*ir)*Xe/25e-6},at=It=>{const ln=et,Ht=Ze;return{aabb:r.bV(this,j,0,0,0,It,Ht,ln,this.projection),zoom:0,x:0,y:0,minZ:Ht,maxZ:ln,wrap:It,fullyVisible:!1}},pt=[];let Vt=[];const Rt=l,ht=i.reparseOverscaled?m:l,St=(Te-this._centerAltitude)*_e,en=It=>{if(!this._elevation||!It.tileID||!E)return;const ln=this._elevation.getMinMaxForTile(It.tileID),Ht=It.aabb;ln?(Ht.min[2]=ln.min,Ht.max[2]=ln.max,Ht.center[2]=(Ht.min[2]+Ht.max[2])/2):(It.shouldSplit=vn(It),It.shouldSplit||(Ht.min[2]=Ht.max[2]=Ht.center[2]=this._centerAltitude))},hn=(It,ln)=>{if(.707*ln<It)return 1;const Ht=ln/It;return Ht/(1.4144271570014144+(Math.pow(1.1,Ht-1.4144271570014144+1)-1)/(1.1-1)-1)},vn=It=>{if(It.zoom<Be)return!0;if(It.zoom===Rt)return!1;if(It.shouldSplit!=null)return It.shouldSplit;const ln=It.aabb.distanceX(Ce),Ht=It.aabb.distanceY(Ce);let gn=St,cn=1;if(X){gn=It.aabb.distanceZ(Ce);const ir=Math.pow(2,It.zoom),rr=r.aS((It.y+1)/ir),wr=r.aS(It.y/ir),Gr=Math.min(Math.max($,rr),wr),Or=r.c9(Gr)/r.c9($);if(cn=Gr===$?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,Or/this._mercatorScaleRatio),this.zoom<=r.c6&&It.zoom===Rt-1&&Or>=.9)return!0}else if(x&&(gn=It.aabb.distanceZ(Ce)*_e),this.projection.isReprojectedInTileSpace&&m<=5){const ir=Math.pow(2,It.zoom),rr=Ke(new r.aa((It.x+.5)/ir,(It.y+.5)/ir));cn=rr>.85?1:rr}if(!E){const ir=Math.sqrt(ln*ln+Ht*Ht+gn*gn);let rr=(1<<Rt-It.zoom)*je*cn;return rr*=hn(Math.max(gn,St),ir),ir<rr}let tn=Number.MAX_VALUE,Rn=0;const Dn=It.aabb.getCorners(),An=[];for(const ir of Dn){r.ab.vec3.sub(An,ir,Ce),X||(x?An[2]*=_e:An[2]=St);const rr=r.ab.vec3.dot(An,this._camera.forward());rr<tn&&(tn=rr,Rn=Math.abs(An[2]))}let Bn=(1<<Rt-It.zoom)*je*cn;if(Bn*=hn(Math.max(Rn,St),tn),tn<Bn)return!0;const br=It.aabb.closestPoint(G);return br[0]===G[0]&&br[1]===G[1]};if(this.renderWorldCopies)for(let It=1;It<=3;It++)pt.push(at(-It)),pt.push(at(It));for(pt.push(at(0));pt.length>0;){const It=pt.pop(),ln=It.x,Ht=It.y;let gn=It.fullyVisible;const cn=()=>this.projection.name==="globe"&&(It.y===0||It.y===(1<<It.zoom)-1);if(!gn){let tn=Re?It.aabb.intersects(ne):It.aabb.intersectsFlat(ne);if(tn===0&&cn()){const Rn=new r.bT(It.zoom,ln,Ht);tn=r.bU(this,j,Rn,!0).intersects(ne)}if(tn===0)continue;gn=tn===2}if(It.zoom!==Rt&&vn(It))for(let tn=0;tn<4;tn++){const Rn=(ln<<1)+tn%2,Dn=(Ht<<1)+(tn>>1),An={aabb:E?It.aabb.quadrant(tn):r.bV(this,j,It.zoom+1,Rn,Dn,It.wrap,It.minZ,It.maxZ,this.projection),zoom:It.zoom+1,x:Rn,y:Dn,wrap:It.wrap,fullyVisible:gn,tileID:void 0,shouldSplit:void 0,minZ:It.minZ,maxZ:It.maxZ};x&&!X&&(An.tileID=new r.aG(It.zoom+1===Rt?ht:It.zoom+1,It.wrap,It.zoom+1,Rn,Dn),en(An)),pt.push(An)}else{const tn=It.zoom===Rt?ht:It.zoom;if(i.minzoom&&i.minzoom>tn)continue;let Rn=0;if(!gn){let br=Re?It.aabb.intersectsPrecise(ne):It.aabb.intersectsPreciseFlat(ne);if(br===0&&cn()){const ir=new r.bT(It.zoom,ln,Ht);br=r.bU(this,j,ir,!0).intersectsPrecise(ne)}if(br===0)continue;if(i.calculateQuadrantVisibility)if(ne.containsPoint(It.aabb.center))Rn=15;else for(let ir=0;ir<4;ir++)It.aabb.quadrant(ir).intersects(ne)!==0&&(Rn|=1<<ir)}const Dn=G[0]-(.5+ln+(It.wrap<<It.zoom))*(1<<l-It.zoom),An=G[1]-.5-Ht,Bn=It.tileID?It.tileID:new r.aG(tn,It.wrap,It.zoom,ln,Ht);i.calculateQuadrantVisibility&&(Bn.visibleQuadrants=Rn),Vt.push({tileID:Bn,distanceSq:Dn*Dn+An*An})}}if(this.fogCullDistSq){const It=this.fogCullDistSq,ln=this.horizonLineFromTop();Vt=Vt.filter(Ht=>{const gn=[0,0,0,1],cn=[r.ag,r.ag,0,1],tn=this.calculateFogTileMatrix(Ht.tileID.toUnwrapped());r.ab.vec4.transformMat4(gn,gn,tn),r.ab.vec4.transformMat4(cn,cn,tn);const Rn=r.ab.vec4.min([],gn,cn),Dn=r.ab.vec4.max([],gn,cn),An=r.bW(Rn,Dn);if(An===0)return!0;let Bn=!1;const br=this._elevation;if(br&&An>It&&ln!==0){const ir=this.calculateProjMatrix(Ht.tileID.toUnwrapped());let rr;i.isTerrainDEM||(rr=br.getMinMaxForTile(Ht.tileID)),rr||(rr={min:Ze,max:et});const wr=r.c7(this.rotation),Gr=[wr[0]*r.ag,wr[1]*r.ag,rr.max];r.ab.vec3.transformMat4(Gr,Gr,ir),Bn=(1-Gr[1])*this.height*.5<ln}return An<It||Bn})}return Vt.sort((It,ln)=>It.distanceSq-ln.distanceSq).map(It=>It.tileID)}resize(i,l){this.width=i,this.height=l,this.pixelsToGLUnits=[2/i,-2/l],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(i){return Math.pow(2,i)}scaleZoom(i){return Math.log(i)/Math.LN2}project(i){const l=r.aw(i.lat,-r.bX,r.bX),m=this.projection.project(i.lng,l);return new r.P(m.x*this.worldSize,m.y*this.worldSize)}unproject(i){return this.projection.unproject(i.x/this.worldSize,i.y/this.worldSize)}get point(){return this.project(this.center)}get pointMerc(){return this.point._div(this.worldSize)}get pixelsPerMeterRatio(){return this.pixelsPerMeter/r.bH(1,this.center.lat)/this.worldSize}setLocationAtPoint(i,l){let m,v;const x=this.centerPoint;if(this.projection.name==="globe"){const L=this.worldSize;m=(l.x-x.x)/L,v=(l.y-x.y)/L}else{const L=this.pointCoordinate(l),$=this.pointCoordinate(x);m=L.x-$.x,v=L.y-$.y}const E=this.locationCoordinate(i);this.setLocation(new r.aa(E.x-m,E.y-v))}setLocation(i){this.center=this.coordinateLocation(i),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(i){return this.projection.locationPoint(this,i)}locationPoint3D(i){return this.projection.locationPoint(this,i,!0)}pointLocation(i){return this.coordinateLocation(this.pointCoordinate(i))}pointLocation3D(i){return this.coordinateLocation(this.pointCoordinate3D(i))}locationCoordinate(i,l){const m=l?r.bH(l,i.lat):void 0,v=this.projection.project(i.lng,i.lat);return new r.aa(v.x,v.y,m)}coordinateLocation(i){return this.projection.unproject(i.x,i.y)}pointRayIntersection(i,l){const m=l??this._centerAltitude,v=[i.x,i.y,0,1],x=[i.x,i.y,1,1];r.ab.vec4.transformMat4(v,v,this.pixelMatrixInverse),r.ab.vec4.transformMat4(x,x,this.pixelMatrixInverse);const E=x[3];r.ab.vec4.scale(v,v,1/v[3]),r.ab.vec4.scale(x,x,1/E);const L=v[2],$=x[2];return{p0:v,p1:x,t:L===$?0:(m-L)/($-L)}}screenPointToMercatorRay(i){const l=[i.x,i.y,0,1],m=[i.x,i.y,1,1];return r.ab.vec4.transformMat4(l,l,this.pixelMatrixInverse),r.ab.vec4.transformMat4(m,m,this.pixelMatrixInverse),r.ab.vec4.scale(l,l,1/l[3]),r.ab.vec4.scale(m,m,1/m[3]),l[2]=r.bH(l[2],this._center.lat)*this.worldSize,m[2]=r.bH(m[2],this._center.lat)*this.worldSize,r.ab.vec4.scale(l,l,1/this.worldSize),r.ab.vec4.scale(m,m,1/this.worldSize),new r.aq([l[0],l[1],l[2]],r.ab.vec3.normalize([],r.ab.vec3.sub([],m,l)))}rayIntersectionCoordinate(i){const{p0:l,p1:m,t:v}=i,x=r.bH(l[2],this._center.lat),E=r.bH(m[2],this._center.lat);return new r.aa(r.af(l[0],m[0],v)/this.worldSize,r.af(l[1],m[1],v)/this.worldSize,r.af(x,E,v))}pointCoordinate(i,l=this._centerAltitude){return this.projection.pointCoordinate(this,i.x,i.y,l)}pointCoordinate3D(i){if(!this.elevation)return this.pointCoordinate(i);let l=this.projection.pointCoordinate3D(this,i.x,i.y);if(l)return new r.aa(l[0],l[1],l[2]);let m=0,v=this.horizonLineFromTop();if(i.y>v)return this.pointCoordinate(i);const x=.02*v,E=i.clone();for(let L=0;L<10&&v-m>x;L++){E.y=r.af(m,v,.66);const $=this.projection.pointCoordinate3D(this,E.x,E.y);$?(v=E.y,l=$):m=E.y}return l?new r.aa(l[0],l[1],l[2]):this.pointCoordinate(i)}isPointAboveHorizon(i){return this.projection.isPointAboveHorizon(this,i)}isPointOnSurface(i){if(i.y<0||i.y>this.height||i.x<0||i.x>this.width)return!1;if(this.elevation||this.zoom>=r.bY)return!this.isPointAboveHorizon(i);const l=this.pointCoordinate(i);return l.y>=0&&l.y<=1}_coordinatePoint(i,l){const m=l&&this.elevation?this.elevation.getAtPointOrZero(i,this._centerAltitude):this._centerAltitude,v=[i.x*this.worldSize,i.y*this.worldSize,m+i.toAltitude(),1];return r.ab.vec4.transformMat4(v,v,this.pixelMatrix),v[3]>0?new r.P(v[0]/v[3],v[1]/v[3]):new r.P(Number.MAX_VALUE,Number.MAX_VALUE)}_getBoundsNonRectangular(){const{top:i,left:l}=this._edgeInsets,m=this.height-this._edgeInsets.bottom,v=this.width-this._edgeInsets.right,x=this.pointLocation3D(new r.P(l,i)),E=this.pointLocation3D(new r.P(v,i)),L=this.pointLocation3D(new r.P(v,m)),$=this.pointLocation3D(new r.P(l,m));let j=Math.min(x.lng,E.lng,L.lng,$.lng),G=Math.max(x.lng,E.lng,L.lng,$.lng),X=Math.min(x.lat,E.lat,L.lat,$.lat),Y=Math.max(x.lat,E.lat,L.lat,$.lat);const ne=Math.pow(2,-this.zoom)/16*270,ve=this.projection.name==="globe"?1:4,_e=(Te,Ce,Re,je,Be)=>{const et=(Te+Re)/2,Ze=(Ce+je)/2,Xe=new r.P(et,Ze),{lng:Ke,lat:at}=this.pointLocation3D(Xe),pt=Math.max(0,j-Ke,X-at,Ke-G,at-Y);j=Math.min(j,Ke),G=Math.max(G,Ke),X=Math.min(X,at),Y=Math.max(Y,at),(Be<ve||pt>ne)&&(_e(Te,Ce,et,Ze,Be+1),_e(et,Ze,Re,je,Be+1))};if(_e(l,i,v,i,1),_e(v,i,v,m,1),_e(v,m,l,m,1),_e(l,m,l,i,1),this.projection.name==="globe"){const[Te,Ce]=r.bZ(this);Te?(Y=90,G=180,j=-180):Ce&&(X=-90,G=180,j=-180)}return new r.az(new r.bO(j,X),new r.bO(G,Y))}_getBoundsRectangular(i,l){const{top:m,left:v}=this._edgeInsets,x=this.height-this._edgeInsets.bottom,E=this.width-this._edgeInsets.right,L=new r.P(v,m),$=new r.P(E,m),j=new r.P(E,x),G=new r.P(v,x);let X=this.pointCoordinate(L,i),Y=this.pointCoordinate($,i);const ne=this.pointCoordinate(j,l),ve=this.pointCoordinate(G,l),_e=(Te,Ce)=>(Ce.y-Te.y)/(Ce.x-Te.x);return X.y>1&&Y.y>=0?X=new r.aa((1-ve.y)/_e(ve,X)+ve.x,1):X.y<0&&Y.y<=1&&(X=new r.aa(-ve.y/_e(ve,X)+ve.x,0)),Y.y>1&&X.y>=0?Y=new r.aa((1-ne.y)/_e(ne,Y)+ne.x,1):Y.y<0&&X.y<=1&&(Y=new r.aa(-ne.y/_e(ne,Y)+ne.x,0)),new r.az().extend(this.coordinateLocation(X)).extend(this.coordinateLocation(Y)).extend(this.coordinateLocation(ve)).extend(this.coordinateLocation(ne))}_getBoundsRectangularTerrain(){const i=this.elevation;if(!i.visibleDemTiles.length||i.isUsingMockSource())return this._getBoundsRectangular(0,0);const l=i.visibleDemTiles.reduce((m,v)=>{if(v.dem){const x=v.dem.tree;m.min=Math.min(m.min,x.minimums[0]),m.max=Math.max(m.max,x.maximums[0])}return m},{min:Number.MAX_VALUE,max:0});return this._getBoundsRectangular(l.min*i.exaggeration(),l.max*i.exaggeration())}getBounds(){return this.projection.name==="mercator"||this.projection.name==="equirectangular"?this._terrainEnabled()?this._getBoundsRectangularTerrain():this._getBoundsRectangular(0,0):this._getBoundsNonRectangular()}horizonLineFromTop(i=!0){const l=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))-this.centerOffset.y,m=this.height/2-l*(1-this._horizonShift);return i?Math.max(0,m):m}getMaxBounds(){return this.maxBounds}setMaxBounds(i){this.maxBounds=i,this.minLat=-r.bX,this.maxLat=r.bX,this.minLng=-180,this.maxLng=180,i&&(this.minLat=i.getSouth(),this.maxLat=i.getNorth(),this.minLng=i.getWest(),this.maxLng=i.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=r.at(this.minLng)*this.tileSize,this.worldMaxX=r.at(this.maxLng)*this.tileSize,this.worldMinY=r.aA(this.maxLat)*this.tileSize,this.worldMaxY=r.aA(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(i,l){return this.projection.createTileMatrix(this,l,i)}calculateDistanceTileData(i){const l=i.key,m=this._distanceTileDataCache;if(m[l])return m[l];const v=i.canonical,x=1/this.height,E=this.cameraWorldSize,L=E/this.zoomScale(v.z),$=(v.x+Math.pow(2,v.z)*i.wrap)*L,j=v.y*L,G=this.point;G.x*=E/this.worldSize,G.y*=E/this.worldSize;const X=this.angle,Y=Math.sin(-X),ne=-Math.cos(-X);return m[l]={bearing:[Y,ne],center:[(G.x-$)*x,(G.y-j)*x],scale:L/r.ag*x},m[l]}calculateFogTileMatrix(i){const l=i.key,m=this._fogTileMatrixCache;if(m[l])return m[l];const v=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,i);return r.ab.mat4.multiply(v,this.worldToFogMatrix,v),m[l]=new Float32Array(v),m[l]}calculateProjMatrix(i,l=!1,m=!1){const v=i.key;let x;if(x=m?this._expandedProjMatrixCache:l?this._alignedProjMatrixCache:this._projMatrixCache,x[v])return x[v];const E=this.calculatePosMatrix(i,this.worldSize);let L;return L=this.projection.isReprojectedInTileSpace?this.mercatorMatrix:m?this.expandedFarZProjMatrix:l?this.alignedProjMatrix:this.projMatrix,r.ab.mat4.multiply(E,L,E),x[v]=new Float32Array(E),x[v]}calculatePixelsToTileUnitsMatrix(i){const l=i.tileID.key,m=this._pixelsToTileUnitsCache;if(m[l])return m[l];const v=r.b_(i,this);return m[l]=v,m[l]}customLayerMatrix(){return this.mercatorMatrix.slice()}globeToMercatorMatrix(){if(this.projection.name==="globe"){const i=1/this.worldSize,l=r.ab.mat4.fromScaling([],[i,i,i]);return r.ab.mat4.multiply(l,l,this.globeMatrix),l}}recenterOnTerrain(){if(!this._elevation||this.projection.name==="globe")return;const i=this._elevation;this._updateCameraState();const l=r.bH(1,this._center.lat)*this.worldSize,m=this._computeCameraPosition(l),v=this._camera.forward(),x=r.bH(1,this._center.lat);m[2]/=x,v[2]/=x,r.ab.vec3.normalize(v,v);const E=i.raycast(m,v,i.exaggeration());if(E){const L=r.ab.vec3.scaleAndAdd([],m,v,E),$=new r.aa(L[0],L[1],r.bH(L[2],r.aS(L[1]))),j=($.z+r.ab.vec3.length([$.x-m[0],$.y-m[1],$.z-m[2]*x]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(j),this._centerAltitude=$.toAltitude(),this._center=this.coordinateLocation($),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(i=!1){if(!this._elevation)return;const l=this._elevation,m=r.bH(1,this._center.lat)*this.worldSize,v=this._computeCameraPosition(m),x=l.getAtPointOrZero(new r.aa(...v)),E=this.pixelsPerMeter/this.worldSize*x,L=this._minimumHeightOverTerrain(),$=v[2]-E;if($<=L)if($<0||i){const j=this.locationCoordinate(this._center,this._centerAltitude),G=[v[0],v[1],j.z-v[2]],X=r.ab.vec3.length(G);G[2]-=(L-$)/this._pixelsPerMercatorPixel;const Y=r.ab.vec3.length(G);if(Y===0)return;r.ab.vec3.scale(G,G,X/Y*this._pixelsPerMercatorPixel),this._camera.position=[v[0],v[1],j.z*this._pixelsPerMercatorPixel-G[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const i=this.projection.name==="globe"||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||i){const Y=this.center;return Y.lat=r.aw(Y.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!i)&&(Y.lng=r.aw(Y.lng,this.minLng,this.maxLng)),this.center=Y,void(this._constraining=!1)}const l=this._unmodified,{x:m,y:v}=this.point;let x=0,E=m,L=v;const $=this.width/2,j=this.height/2,G=this.worldMinY*this.scale,X=this.worldMaxY*this.scale;if(v-j<G&&(L=G+j),v+j>X&&(L=X-j),X-G<this.height&&(x=Math.max(x,this.height/(X-G)),L=(X+G)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const Y=this.worldMinX*this.scale,ne=this.worldMaxX*this.scale,ve=this.worldSize/2-(Y+ne)/2;E=(m+ve+this.worldSize)%this.worldSize-ve,E-$<Y&&(E=Y+$),E+$>ne&&(E=ne-$),ne-Y<this.width&&(x=Math.max(x,this.width/(ne-Y)),E=(ne+Y)/2)}E===m&&L===v||(this.center=this.unproject(new r.P(E,L))),x&&(this.zoom+=this.scaleZoom(x)),this._constrainCamera(),this._unmodified=l,this._constraining=!1}_minZoomForBounds(){let i=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(i=Math.max(i,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),i}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const i=this.centerOffset,l=this.projection.name==="globe",m=this.pixelsPerMeter;this.projection.name==="globe"&&(this._mercatorScaleRatio=r.bH(1,this.center.lat)/r.bH(1,r.c8));const v=r.b$(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,v),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const x=this.projection.zAxisUnit==="meters"?m:1,E=this._camera.getWorldToCamera(this.worldSize,x);let L;const $=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);if($[8]=2*-i.x/this.width,$[9]=2*i.y/this.height,this.isOrthographic){let at=.5*this.height/Math.tan(this._fov/2)*1*Math.tan(.5*this._fov),pt=at*this.aspect,Vt=-pt,Rt=-at;pt-=i.x,Vt-=i.x,at+=i.y,Rt+=i.y,L=this._camera.getCameraToClipOrthographic(Vt,pt,Rt,at,this._nearZ,this._farZ),((ht,St,en,hn)=>{for(let vn=0;vn<16;vn++)ht[vn]=Jh(St[vn],en[vn],hn)})(L,L,$,kn(this.pitch>=15?1:this.pitch/15))}else L=$;const j=r.ab.mat4.mul([],$,E);let G=r.ab.mat4.mul([],L,E);if(this.projection.isReprojectedInTileSpace){const at=this.locationCoordinate(this.center),pt=r.ab.mat4.identity([]);r.ab.mat4.translate(pt,pt,[at.x*this.worldSize,at.y*this.worldSize,0]),r.ab.mat4.multiply(pt,pt,r.c0(this)),r.ab.mat4.translate(pt,pt,[-at.x*this.worldSize,-at.y*this.worldSize,0]),r.ab.mat4.multiply(G,G,pt),r.ab.mat4.multiply(j,j,pt),this.inverseAdjustmentMatrix=r.c1(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];if(this.mercatorMatrix=r.ab.mat4.scale([],G,[this.worldSize,this.worldSize,this.worldSize/x,1]),this.projMatrix=G,this.invProjMatrix=r.ab.mat4.invert(new Float64Array(16),this.projMatrix),l){const at=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,1/0);at[8]=2*-i.x/this.width,at[9]=2*i.y/this.height,this.expandedFarZProjMatrix=r.ab.mat4.mul([],at,E)}else this.expandedFarZProjMatrix=this.projMatrix;const X=r.ab.mat4.invert([],L);this.frustumCorners=r.c2.fromInvProjectionMatrix(X,this.horizonLineFromTop(),this.height),this.cameraFrustum=r.bR.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,0,!l);const Y=new Float32Array(16);r.ab.mat4.identity(Y),r.ab.mat4.scale(Y,Y,[1,-1,1]),r.ab.mat4.rotateX(Y,Y,this._pitch),r.ab.mat4.rotateZ(Y,Y,this.angle);const ne=r.ab.mat4.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ);this.starsProjMatrix=r.ab.mat4.clone(ne);const ve=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;ne[8]=2*-i.x/this.width,ne[9]=2*(i.y+ve)/this.height,this.skyboxMatrix=r.ab.mat4.multiply(Y,ne,Y);const _e=this.point,Te=_e.x,Ce=_e.y,Re=this.width%2/2,je=this.height%2/2,Be=Math.cos(this.angle),et=Math.sin(this.angle),Ze=Te-Math.round(Te)+Be*Re+et*je,Xe=Ce-Math.round(Ce)+Be*je+et*Re,Ke=new Float64Array(G);if(r.ab.mat4.translate(Ke,Ke,[Ze>.5?Ze-1:Ze,Xe>.5?Xe-1:Xe,0]),this.alignedProjMatrix=Ke,G=r.ab.mat4.create(),r.ab.mat4.scale(G,G,[this.width/2,-this.height/2,1]),r.ab.mat4.translate(G,G,[1,-1,0]),this.labelPlaneMatrix=G,G=r.ab.mat4.create(),r.ab.mat4.scale(G,G,[1,-1,1]),r.ab.mat4.translate(G,G,[-1,-1,0]),r.ab.mat4.scale(G,G,[2/this.width,2/this.height,1]),this.glCoordMatrix=G,this.pixelMatrix=r.ab.mat4.multiply(new Float64Array(16),this.labelPlaneMatrix,j),this._calcFogMatrices(),this._distanceTileDataCache={},G=r.ab.mat4.invert(new Float64Array(16),this.pixelMatrix),!G)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=G,this.projection.name==="globe"||this.mercatorFromTransition){this.globeMatrix=r.c3(this);const at=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=r.ab.vec3.transformMat4(at,at,E),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=G;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={},this._expandedProjMatrixCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const i=this.cameraWorldSizeForFog,l=this.cameraPixelsPerMeter,m=this._camera.position,v=1/this.height/this._pixelsPerMercatorPixel,x=[i,i,l];r.ab.vec3.scale(x,x,v),r.ab.vec3.scale(m,m,-1),r.ab.vec3.multiply(m,m,x);const E=r.ab.mat4.create();r.ab.mat4.translate(E,E,m),r.ab.mat4.scale(E,E,x),this.mercatorFogMatrix=E,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(i,l,v)}_computeCameraPosition(i){const l=(i=i||this.pixelsPerMeter)/this.pixelsPerMeter,m=this._camera.forward(),v=this.point,x=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*l-i/this.worldSize*this._centerAltitude;return[v.x/this.worldSize-m[0]*x,v.y/this.worldSize-m[1]*x,i/this.worldSize*this._centerAltitude-m[2]*x]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(i){const l=this._maxCameraBoundsDistance()*Math.cos(this._pitch),m=this._camera.position[2],v=i[2];let x=1;this.projection.wrap&&(this.center=this.center.wrap()),v>0&&(x=Math.min((l-m)/v,1)),this._camera.position=r.ab.vec3.scaleAndAdd([],this._camera.position,i,x),this._updateStateFromCamera()}_updateStateFromCamera(){const i=this._camera.position,l=this._camera.forward(),{pitch:m,bearing:v}=this._camera.getPitchBearing(),x=r.bH(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,E=this._mercatorZfromZoom(this._maxZoom)*Math.cos(r.ai(this._maxPitch)),L=Math.max((i[2]-x)/Math.cos(m),E),$=this._zoomFromMercatorZ(L);r.ab.vec3.scaleAndAdd(i,i,l,L),this._pitch=r.aw(m,r.ai(this.minPitch),r.ai(this.maxPitch)),this.angle=r.bF(v,-Math.PI,Math.PI),this._setZoom(r.aw($,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new r.aa(i[0],i[1],i[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(i){return Math.pow(2,i)*this.tileSize}_mercatorZfromZoom(i){return this.cameraToCenterDistance/this._worldSizeFromZoom(i)}_minimumHeightOverTerrain(){const i=Math.min(this._seaLevelZoom!=null?this._seaLevelZoom:this._zoom,this._maxZoom)+4;return this._mercatorZfromZoom(i)}_zoomFromMercatorZ(i){return this.scaleZoom(this.cameraToCenterDistance/(i*this.tileSize))}zoomFromMercatorZAdjusted(i){let l=0,m=r.bY,v=0,x=1/0;for(;m-l>1e-6&&m>l;){const E=l+.5*(m-l),L=this.tileSize*Math.pow(2,E),$=this.getCameraToCenterDistance(this.projection,E,L),j=this.scaleZoom($/(i*this.tileSize)),G=Math.abs(E-j);G<x&&(x=G,v=E),E<j?l=E:m=E}return v}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(r.w("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(i,l){const m=Math.min(i.x,l.x),v=Math.max(i.x,l.x),x=Math.min(i.y,l.y),E=Math.max(i.y,l.y);if(x<this.horizonLineFromTop(!1))return!0;if(this.projection.name!=="mercator")return!1;const L=[new r.P(m,x),new r.P(v,E),new r.P(m,E),new r.P(v,x)],$=this.renderWorldCopies?-3:0,j=this.renderWorldCopies?4:1;for(const G of L){const X=this.pointRayIntersection(G);if(X.t<0)return!0;const Y=this.rayIntersectionCoordinate(X);if(Y.x<$||Y.y<0||Y.x>j||Y.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+r.c4(this.fovAboveCenter)>88||this.anyCornerOffEdge(new r.P(0,0),new r.P(this.width,this.height))}zoomDeltaToMovement(i,l){const m=r.ab.vec3.length(r.ab.vec3.sub([],this._camera.position,i)),v=this._zoomFromMercatorZ(m)+l;return m-this._mercatorZfromZoom(v)}getCameraPoint(){if(this.projection.name==="globe"){const i=function([l,m,v],x){const E=[l,m,v,1];r.ab.vec4.transformMat4(E,E,x);const L=E[3]=Math.max(E[3],1e-6);return E[0]/=L,E[1]/=L,E[2]/=L,E}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new r.P(i[0],i[1])}{const i=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new r.P(0,i))}}getCameraToCenterDistance(i,l=this.zoom,m=this.worldSize){const v=r.b$(i,l,this.width,this.height,1024),x=i.pixelSpaceConversion(this.center.lat,m,v);let E=.5/Math.tan(.5*this._fov)*this.height*x;return this.isOrthographic&&(E=Jh(1,E,kn(this.pitch>=15?1:this.pitch/15))),E}getWorldToCameraMatrix(){const i=this._camera.getWorldToCamera(this.worldSize,this.projection.zAxisUnit==="meters"?this.pixelsPerMeter:1);return this.projection.name==="globe"&&r.ab.mat4.multiply(i,i,this.globeMatrix),i}getFrustum(i){return r.bR.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,i,this.projection.zAxisUnit==="meters")}}const Tl=(h,i)=>{if(i>0&&h.terrain&&r.w("Cutoff is currently disabled on terrain"),i<=0||h.terrain)return{shouldRenderCutoff:!1,uniformValues:{u_cutoff_params:[0,0,0,1]}};const l=h.transform,m=Math.max(Math.abs(l._zoom-(h.minCutoffZoom-1)),1),v=l.isLODDisabled(!1)?r.ac(60,45,l.pitch):r.ac(30,15,l.pitch),x=l._farZ-l._nearZ,E=i*l.height,L=((1-($=v))*l.cameraToCenterDistance+$*(l._farZ+E))*m;var $;return{shouldRenderCutoff:v<1,uniformValues:{u_cutoff_params:[l._nearZ,l._farZ,(L-l._nearZ)/x,(L-E-l._nearZ)/x]}}},$o={cascadeCount:2,normalOffset:3,shadowMapResolution:2048};class Av{constructor(i,l){this.aabb=i,this.lastCascade=l}}class ep{add(i,l){const m=this.receivers[i.key];m!==void 0?(m.aabb.min[0]=Math.min(m.aabb.min[0],l.min[0]),m.aabb.min[1]=Math.min(m.aabb.min[1],l.min[1]),m.aabb.min[2]=Math.min(m.aabb.min[2],l.min[2]),m.aabb.max[0]=Math.max(m.aabb.max[0],l.max[0]),m.aabb.max[1]=Math.max(m.aabb.max[1],l.max[1]),m.aabb.max[2]=Math.max(m.aabb.max[2],l.max[2])):this.receivers[i.key]=new Av(l,null)}clear(){this.receivers={}}get(i){return this.receivers[i.key]}computeRequiredCascades(i,l,m){const v=r.cd.fromPoints(i.points);let x=0;for(const E in this.receivers){const L=this.receivers[E];if(!L||!v.intersectsAabb(L.aabb))continue;L.aabb.min=v.closestPoint(L.aabb.min),L.aabb.max=v.closestPoint(L.aabb.max);const $=L.aabb.getCorners();for(let j=0;j<m.length;j++){let G=!0;for(const X of $){const Y=[X[0]*l,X[1]*l,X[2]];if(r.ab.vec3.transformMat4(Y,Y,m[j].matrix),Y[0]<-1||Y[0]>1||Y[1]<-1||Y[1]>1){G=!1;break}}if(L.lastCascade=j,x=Math.max(x,j),G)break}}return x+1}}class Cl{constructor(i){this.painter=i,this._enabled=!1,this._shadowLayerCount=0,this._numCascadesToRender=0,this._cascades=[],this._groundShadowTiles=[],this._receivers=new ep,this._depthMode=new nr(i.context.gl.LEQUAL,nr.ReadWrite,[0,1]),this._uniformValues={u_light_matrix_0:new Float32Array(16),u_light_matrix_1:new Float32Array(16),u_shadow_intensity:0,u_fade_range:[0,0],u_shadow_normal_offset:[1,1,1],u_shadow_texel_size:1,u_shadow_map_resolution:1,u_shadow_direction:[0,0,1],u_shadow_bias:[36e-5,.0012,.012],u_shadowmap_0:0,u_shadowmap_1:0},this._forceDisable=!1,this.useNormalOffset=!1,i.tp.registerParameter(this,["Shadows"],"_forceDisable",{label:"forceDisable"},()=>{this.painter.style.map.triggerRepaint()}),i.tp.registerParameter($o,["Shadows"],"cascadeCount",{min:1,max:2,step:1}),i.tp.registerParameter($o,["Shadows"],"normalOffset",{min:0,max:10,step:.05}),i.tp.registerParameter($o,["Shadows"],"shadowMapResolution",{min:32,max:2048,step:32}),i.tp.registerBinding(this,["Shadows"],"_numCascadesToRender",{readonly:!0,label:"numCascadesToRender"})}destroy(){for(const i of this._cascades)i.texture.destroy(),i.framebuffer.destroy();this._cascades=[]}updateShadowParameters(i,l){const m=this.painter;if(this._enabled=!1,this._shadowLayerCount=0,this._receivers.clear(),!l||!l.properties)return;const v=l.properties.get("shadow-intensity");if(!l.shadowsEnabled()||v<=0||(this._shadowLayerCount=m.style.order.reduce((ve,_e)=>{const Te=m.style._mergedLayers[_e];return ve+(Te.hasShadowPass()&&!Te.isHidden(i.zoom)?1:0)},0),this._enabled=this._shadowLayerCount>0,!this.enabled))return;const x=m.context,E=$o.shadowMapResolution,L=$o.shadowMapResolution;if(this._cascades.length===0||$o.shadowMapResolution!==this._cascades[0].texture.size[0]){this._cascades=[];for(let ve=0;ve<$o.cascadeCount;++ve){const _e=m._shadowMapDebug,Te=x.gl,Ce=x.createFramebuffer(E,L,_e,"texture"),Re=new r.T(x,{width:E,height:L,data:null},Te.DEPTH_COMPONENT16);if(Ce.depthAttachment.set(Re.texture),_e){const je=new r.T(x,{width:E,height:L,data:null},Te.RGBA8);Ce.colorAttachment.set(je.texture)}this._cascades.push({framebuffer:Ce,texture:Re,matrix:[],far:0,boundingSphereRadius:0,frustum:new r.bR,scale:0})}}this.shadowDirection=cu(l);let $=0;if(i.elevation){const ve=i.elevation,_e=[1e4,-1e4];ve.visibleDemTiles.filter(Te=>Te.dem).forEach(Te=>{const Ce=Te.dem.tree;_e[0]=Math.min(_e[0],Ce.minimums[0]),_e[1]=Math.max(_e[1],Ce.maximums[0])}),_e[0]!==1e4&&($=(_e[1]-_e[0])*ve.exaggeration())}const j=1.5*i.cameraToCenterDistance,G=3*j,X=new Float64Array(16);for(let ve=0;ve<this._cascades.length;++ve){const _e=this._cascades[ve];let Te=i.height/50,Ce=1;$o.cascadeCount===1?Ce=G:ve===0?Ce=j:(Te=j,Ce=G);const[Re,je]=Yc(i,this.shadowDirection,Te,Ce,$o.shadowMapResolution,$);_e.scale=i.scale,_e.matrix=Re,_e.boundingSphereRadius=je,r.ab.mat4.invert(X,_e.matrix),_e.frustum=r.bR.fromInvProjectionMatrix(X,1,0,!0),_e.far=Ce}const Y=this._cascades.length-1;this._uniformValues.u_fade_range=[.75*this._cascades[Y].far,this._cascades[Y].far],this._uniformValues.u_shadow_intensity=v,this._uniformValues.u_shadow_direction=[this.shadowDirection[0],this.shadowDirection[1],this.shadowDirection[2]],this._uniformValues.u_shadow_texel_size=1/$o.shadowMapResolution,this._uniformValues.u_shadow_map_resolution=$o.shadowMapResolution,this._uniformValues.u_shadowmap_0=Vo.ShadowMap0,this._uniformValues.u_shadowmap_1=Vo.ShadowMap0+1,this._groundShadowTiles=m.transform.coveringTiles({tileSize:512,renderWorldCopies:!0});const ne=m.transform.elevation;for(const ve of this._groundShadowTiles){let _e={min:0,max:0};if(ne){const Te=ne.getMinMaxForTile(ve);Te&&(_e=Te)}this.addShadowReceiver(ve.toUnwrapped(),_e.min,_e.max)}}get enabled(){return this._enabled&&!this._forceDisable}set enabled(i){this._enabled=i}drawShadowPass(i,l){if(!this.enabled)return;const m=this.painter,v=m.context;this._numCascadesToRender=this._receivers.computeRequiredCascades(m.transform.getFrustum(0),m.transform.worldSize,this._cascades),v.viewport.set([0,0,$o.shadowMapResolution,$o.shadowMapResolution]);for(let x=0;x<this._numCascadesToRender;++x){m.currentShadowCascade=x,v.bindFramebuffer.set(this._cascades[x].framebuffer.framebuffer),v.clear({color:r.aj.white,depth:1});for(const E of i.order){const L=i._mergedLayers[E];if(!L.hasShadowPass()||L.isHidden(m.transform.zoom))continue;const $=i.getLayerSourceCache(L),j=$?l[$.id]:void 0;(L.type==="model"||j&&j.length)&&m.renderLayer(m,$,L,j)}}m.currentShadowCascade=0}drawGroundShadows(){if(!this.enabled)return;const i=this.painter,l=i.style,m=i.context,v=l.directionalLight,x=l.ambientLight;if(!v||!x)return;const E=[],L=Tl(i,i.longestCutoffRange);L.shouldRenderCutoff&&E.push("RENDER_CUTOFF"),E.push("RENDER_SHADOWS","DEPTH_TEXTURE"),this.useNormalOffset&&E.push("NORMAL_OFFSET");const $=Zc(l,v,x),j=new nr(m.gl.LEQUAL,nr.ReadOnly,i.depthRangeFor3D);for(const G of this._groundShadowTiles){const X=G.toUnwrapped(),Y=i.isTileAffectedByFog(G),ne=i.getOrCreateProgram("groundShadow",{defines:E,overrideFog:Y});this.setupShadows(X,ne),i.uploadCommonUniforms(m,ne,X,null,L);const ve={u_matrix:i.transform.calculateProjMatrix(X),u_ground_shadow_factor:$};ne.draw(i,m.gl.TRIANGLES,j,Tr.disabled,zr.multiply,mr.disabled,ve,"ground_shadow",i.tileExtentBuffer,i.quadTriangleIndexBuffer,i.tileExtentSegments,{},i.transform.zoom,null,null)}}getShadowPassColorMode(){return this.painter._shadowMapDebug?zr.unblended:zr.disabled}getShadowPassDepthMode(){return this._depthMode}getShadowCastingLayerCount(){return this._shadowLayerCount}calculateShadowPassMatrixFromTile(i){const l=this.painter.transform,m=l.calculatePosMatrix(i,l.worldSize);return r.ab.mat4.multiply(m,this._cascades[this.painter.currentShadowCascade].matrix,m),Float32Array.from(m)}calculateShadowPassMatrixFromMatrix(i){return r.ab.mat4.multiply(i,this._cascades[this.painter.currentShadowCascade].matrix,i),Float32Array.from(i)}setupShadows(i,l,m,v=0){if(!this.enabled)return;const x=this.painter.transform,E=this.painter.context,L=E.gl,$=this._uniformValues,j=new Float64Array(16),G=x.calculatePosMatrix(i,x.worldSize);for(let X=0;X<this._cascades.length;X++)r.ab.mat4.multiply(j,this._cascades[X].matrix,G),$[X===0?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(j),E.activeTexture.set(L.TEXTURE0+Vo.ShadowMap0+X),this._cascades[X].texture.bind(L.NEAREST,L.CLAMP_TO_EDGE);if(this.useNormalOffset=!!m,this.useNormalOffset){const X=r.cc(i.canonical),Y=2/x.tileSize*r.ag/$o.shadowMapResolution,ne=Y*this._cascades[0].boundingSphereRadius,ve=Y*this._cascades[this._cascades.length-1].boundingSphereRadius,_e=(m==="vector-tile"?1:3)/Math.pow(2,v-i.canonical.z-(1-x.zoom+Math.floor(x.zoom)));$.u_shadow_normal_offset=[X,ne*_e,ve*_e],$.u_shadow_bias=[6e-5,.0012,.012]}else $.u_shadow_bias=[36e-5,.0012,.012];l.setShadowUniformValues(E,$)}setupShadowsFromMatrix(i,l,m=!1){if(!this.enabled)return;const v=this.painter.context,x=v.gl,E=this._uniformValues,L=new Float64Array(16);for(let $=0;$<$o.cascadeCount;$++)r.ab.mat4.multiply(L,this._cascades[$].matrix,i),E[$===0?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(L),v.activeTexture.set(x.TEXTURE0+Vo.ShadowMap0+$),this._cascades[$].texture.bind(x.NEAREST,x.CLAMP_TO_EDGE);if(this.useNormalOffset=m,m){const $=$o.normalOffset;E.u_shadow_normal_offset=[1,$,$],E.u_shadow_bias=[6e-5,.0012,.012]}else E.u_shadow_bias=[36e-5,.0012,.012];l.setShadowUniformValues(v,E)}getShadowUniformValues(){return this._uniformValues}getCurrentCascadeFrustum(){return this._cascades[this.painter.currentShadowCascade].frustum}computeSimplifiedTileShadowVolume(i,l,m,v){if(v[2]>=0)return{};const x=function($,j,G){const X=G/(1<<$.canonical.z);return new r.cd([$.canonical.x*X+$.wrap*G,$.canonical.y*X+$.wrap*G,0],[($.canonical.x+1)*X+$.wrap*G,($.canonical.y+1)*X+$.wrap*G,j])}(i,l,m).getCorners(),E=l/-v[2];v[0]<0?(r.ab.vec3.add(x[0],x[0],[v[0]*E,0,0]),r.ab.vec3.add(x[3],x[3],[v[0]*E,0,0])):v[0]>0&&(r.ab.vec3.add(x[1],x[1],[v[0]*E,0,0]),r.ab.vec3.add(x[2],x[2],[v[0]*E,0,0])),v[1]<0?(r.ab.vec3.add(x[0],x[0],[0,v[1]*E,0]),r.ab.vec3.add(x[1],x[1],[0,v[1]*E,0])):v[1]>0&&(r.ab.vec3.add(x[2],x[2],[0,v[1]*E,0]),r.ab.vec3.add(x[3],x[3],[0,v[1]*E,0]));const L={};return L.vertices=x,L.planes=[Kc(x[1],x[0],x[4]),Kc(x[2],x[1],x[5]),Kc(x[3],x[2],x[6]),Kc(x[0],x[3],x[7])],L}addShadowReceiver(i,l,m){this._receivers.add(i,r.cd.fromTileIdAndHeight(i,l,m))}getMaxCascadeForTile(i){const l=this._receivers.get(i);return l&&l.lastCascade?l.lastCascade:0}}function Kc(h,i,l){const m=r.ab.vec3.sub([],l,i),v=r.ab.vec3.sub([],h,i),x=r.ab.vec3.cross([],m,v),E=r.ab.vec3.length(x);return E===0?[0,0,1,0]:(r.ab.vec3.scale(x,x,1/E),[x[0],x[1],x[2],-r.ab.vec3.dot(x,i)])}function cu(h){const i=h.properties.get("direction"),l=r.cb(i.x,i.y,i.z);l[2]=r.aw(l[2],0,75);const m=r.ce([l[0],l[1],l[2]]);return r.ab.vec3.fromValues(m.x,m.y,m.z)}function Zc(h,i,l){const m=i.properties.get("color-use-theme")==="none",v=i.properties.get("color"),x=i.properties.get("intensity"),E=i.properties.get("direction"),L=[E.x,E.y,E.z],$=l.properties.get("color-use-theme")==="none",j=l.properties.get("color"),G=l.properties.get("intensity"),X=Math.max(r.ab.vec3.dot([0,0,1],L),0),Y=[0,0,0];r.ab.vec3.scale(Y,j.toRenderColor($?null:h.getLut(i.scope)).toArray01Linear().slice(0,3),G);const ne=[0,0,0];return r.ab.vec3.scale(ne,v.toRenderColor(m?null:h.getLut(l.scope)).toArray01Linear().slice(0,3),X*x),r.cf([Y[0]>0?Y[0]/(Y[0]+ne[0]):0,Y[1]>0?Y[1]/(Y[1]+ne[1]):0,Y[2]>0?Y[2]/(Y[2]+ne[2]):0])}function Yc(h,i,l,m,v,x){const E=h.zoom,L=h.scale,$=h.worldSize,j=1/$,G=h.aspect,X=Math.sqrt(1+G*G)*Math.tan(.5*h.fovX),Y=X*X,ne=m-l,ve=m+l;let _e,Te;Y>ne/ve?(_e=m,Te=m*X):(_e=.5*ve*(1+Y),Te=.5*Math.sqrt(ne*ne+2*(m*m+l*l)*Y+ve*ve*Y*Y));const Ce=h.projection.pixelsPerMeter(h.center.lat,$),Re=h._camera.getCameraToWorldMercator(),je=[0,0,-_e*j];r.ab.vec3.transformMat4(je,je,Re);let Be=Te*j;const et=h._edgeInsets;if(!(et.left===0&&et.top===0&&et.right===0&&et.bottom===0||et.left===et.right&&et.top===et.bottom)){const gn=h._camera.getWorldToCamera(h.worldSize,h.projection.zAxisUnit==="meters"?Ce:1),cn=h._camera.getCameraToClipPerspective(h._fov,h.width/h.height,l,m);cn[8]=2*-h.centerOffset.x/h.width,cn[9]=2*h.centerOffset.y/h.height;const tn=new Float64Array(16);r.ab.mat4.mul(tn,cn,gn);const Rn=new Float64Array(16);r.ab.mat4.invert(Rn,tn);const Dn=r.bR.fromInvProjectionMatrix(Rn,$,E,!0);for(const An of Dn.points){const Bn=((Ze=An)[0]/=L,Ze[1]/=L,Ze[2]=r.bH(Ze[2],h._center.lat),Ze);Be=Math.max(Be,r.ab.vec3.len(r.ab.vec3.subtract([],je,Bn)))}}var Ze;Be*=v/(v-1);const Xe=Math.acos(i[2]),Ke=Math.atan2(-i[0],-i[1]),at=new vf;at.position=je,at.setPitchBearing(Xe,Ke);const pt=at.getWorldToCamera($,Ce),Vt=Be*$,Rt=Math.min(h._mercatorZfromZoom(17)*$*-2,-2*Vt),ht=at.getCameraToClipOrthographic(-Vt,Vt,-Vt,Vt,Rt,(Vt+x*Ce)/i[2]),St=new Float64Array(16);r.ab.mat4.multiply(St,ht,pt);const en=r.ab.vec3.fromValues(Math.floor(1e6*je[0])/1e6*$,Math.floor(1e6*je[1])/1e6*$,0),hn=.5*v,vn=[0,0,0];r.ab.vec3.transformMat4(vn,en,St),r.ab.vec3.scale(vn,vn,hn);const It=[Math.floor(vn[0]),Math.floor(vn[1]),Math.floor(vn[2])],ln=[0,0,0];r.ab.vec3.sub(ln,vn,It),r.ab.vec3.scale(ln,ln,-1/hn);const Ht=new Float64Array(16);return r.ab.mat4.identity(Ht),r.ab.mat4.translate(Ht,Ht,ln),r.ab.mat4.multiply(St,Ht,St),[St,Vt]}class Zx extends r.E{constructor(i){super(),this.requestManager=i,this.models={"":{}},this.numModelsLoading={}}loadModel(i,l){return r.aM(this.requestManager.transformRequest(l,r.R.Model).url).then(m=>{if(!m)return;const v=r.aN(m),x=new r.aO(i,void 0,void 0,v);return x.computeBoundsAndApplyParent(),x}).catch(m=>{if(m&&m.status===404)return null;this.fire(new r.y(new Error(`Could not load model ${i} from ${l}: ${m.message}`)))})}load(i,l){this.models[l]||(this.models[l]={});const m=Object.keys(i);this.numModelsLoading[l]=(this.numModelsLoading[l]||0)+m.length;const v=[];for(const x of m)v.push(this.loadModel(x,i[x]));Promise.allSettled(v).then(x=>{for(let E=0;E<x.length;E++){const{status:L,value:$}=x[E];L==="fulfilled"&&$&&(this.models[l][m[E]]={model:$,numReferences:1})}this.numModelsLoading[l]-=m.length,this.fire(new r.z("data",{dataType:"style"}))}).catch(x=>{this.fire(new r.y(new Error(`Could not load models: ${x.message}`)))})}isLoaded(){for(const i in this.numModelsLoading)if(this.numModelsLoading[i]>0)return!1;return!0}hasModel(i,l){return!!this.getModel(i,l)}getModel(i,l){return this.models[l]||(this.models[l]={}),this.models[l][i]?this.models[l][i].model:void 0}addModel(i,l,m){this.models[m]||(this.models[m]={}),this.hasModel(i,m)&&this.models[m][i].numReferences++,this.load({[i]:this.requestManager.normalizeModelURL(l)},m)}addModels(i,l){this.models[l]||(this.models[l]={});const m={};for(const v in i)this.models[l][v]={},m[v]=this.requestManager.normalizeModelURL(i[v]);this.load(m,l)}addModelsFromBucket(i,l){this.models[l]||(this.models[l]={});const m={};for(const v of i)this.hasModel(v,l)?this.models[l][v].numReferences++:m[v]=this.requestManager.normalizeModelURL(v);this.load(m,l)}removeModel(i,l){if(this.models[l]&&this.models[l][i]&&(this.models[l][i].numReferences--,this.models[l][i].numReferences===0)){const m=this.models[l][i].model;delete this.models[l][i],m.destroy()}}listModels(i){return this.models[i]||(this.models[i]={}),Object.keys(this.models[i])}upload(i,l){this.models[l]||(this.models[l]={});for(const m in this.models[l])this.models[l][m].model&&this.models[l][m].model.upload(i.context)}}const Yx=new r.a5({data:new r.a6(r.a3.colorTheme.data)}),vg={"mbx-indoor-active-floorplans":{default:["literal",[]]},"mbx-indoor-underground":{default:["literal",!1]},"mbx-indoor-loaded-levels":{default:["literal",[]]},"mbx-indoor-level-height":{default:["literal",{}]},"mbx-indoor-level-base":{default:["literal",{}]},"mbx-indoor-level-selected":{default:["literal",{}]},"mbx-indoor-level-overlapped":{default:["literal",{}]}};function kv(h){return h=h||{},Object.assign(h,vg)}class Pv extends r.E{constructor(i){super(),this.mergeFloors=!0,this._scope=void 0,this._queryFeatureSetId=void 0,this._buildingEntryFeatureSetId=void 0,this._selectedFloorplan=void 0,this._indoorData=void 0,this._selectedLevel=void 0,this._floorplanStates={},r.aP(["_onLoad","_onMove","_checkFloorplanVisible"],this),this._map=i,this._checkFloorplanVisible(!0),this._map.on("load",this._onLoad),this._map.on("move",this._onMove)}destroy(){this._map.indoor.off("load",this._onLoad),this._map.indoor.off("move",this._onMove),this._map=void 0}_onLoad(){this._map.style.forEachFragmentStyle(i=>{i.stylesheet.indoor&&(this._queryFeatureSetId?this.fire(new r.y(new Error("Multiple indoor map styles detected, simultaneous usage is not allowed currently."))):(this._queryFeatureSetId=i.stylesheet.indoor.floorplanFeaturesetId,this._buildingEntryFeatureSetId=i.stylesheet.indoor.buildingFeaturesetId,this._scope=i.scope))}),this._queryFeatureSetId&&this._buildingEntryFeatureSetId&&this._map.addInteraction("mbx-indoor-buildingclick",{type:"click",target:{featuresetId:this._buildingEntryFeatureSetId,importId:this._scope},handler:i=>(i.feature&&i.feature.properties.floorplan&&this.selectFloorplan(i.feature.properties.floorplan),!0)}),this._checkFloorplanVisible(!0)}_onMove(){this._checkFloorplanVisible(!1)}_checkFloorplanVisible(i){if(!this._queryFeatureSetId||!this._map.isStyleLoaded()||this._map.transform.zoom<13)return;this._indoorData&&!function(E,L){const[$,j]=E,{center:G,radius:X}=L,[Y,ne]=G,ve=Math.abs($-Y);return Math.sqrt((ve>180?360-ve:ve)**2+(j-ne)**2)<=X}([this._map.getCenter().lng,this._map.getCenter().lat],this._indoorData.circumCircle)&&(this._indoorData=void 0,this._selectedFloorplan=void 0,this._map.setConfigProperty(this._scope,"mbx-indoor-underground",!1),this._map.setConfigProperty(this._scope,"mbx-indoor-active-floorplans",["literal",[]]),this.fire(new r.z("floorplangone")));const l={target:{featuresetId:this._queryFeatureSetId,importId:this._scope}},m=new r.P(this._map.transform.width/2,this._map.transform.height/2),v=[new r.P(0,0),new r.P(this._map.transform.width,this._map.transform.height)],x=this._map.queryRenderedFeatures(i?v:m,l);x.length>0&&(this._selectedFloorplan&&x[0].properties.id===this._selectedFloorplan.properties.id||(this._selectedFloorplan=x[0],this._floorplanSelected(!1)))}_floorplanSelected(i){this._indoorData=JSON.parse(this._selectedFloorplan.properties["indoor-data"]),this._indoorData.id=this._selectedFloorplan.properties.id,this._indoorData.circumCircle=function(x){const[[E,L],[$,j]]=x,G=($-E+360)%360,X=G>180?360-G:G;return{center:[(E+X/2+360)%360,(L+j)/2],radius:Math.sqrt(X**2+(j-L)**2)/2}}(this._indoorData.extent),this._floorplanStates[this._indoorData.id]||(this._floorplanStates[this._indoorData.id]={});const l=this._floorplanStates[this._indoorData.id].selectedBuilding,m=this._floorplanStates[this._indoorData.id].selectedLevel;let v;if(this._map.setConfigProperty(this._scope,"mbx-indoor-active-floorplans",this._indoorData.floorplanIDs),this._selectedLevel)for(const x of this._indoorData.levels)x.id===this._selectedLevel.id&&(v=x.id);if(this.fire(new r.z("floorplanselected",{buildings:this._indoorData.buildings,levels:this._indoorData.levels,selectedLevelId:v})),l){const x=this._indoorData.buildings.find(E=>E.id===l);this._buildingSelected(x,!1)}else this._indoorData.buildings.length>0&&this._buildingSelected(this._indoorData.buildings[0],!1);if(m){const x=this._indoorData.levels.find(E=>E.id===m);this._updateLevels(x,i)}else i&&this._indoorData["default-levels"].length>0&&this.selectLevel(this._indoorData["default-levels"][0])}_buildingSelected(i,l){l&&i&&i.extent&&this._map.fitBounds(i.extent,{pitch:this._map.getPitch(),bearing:this._map.getBearing()}),this._floorplanStates[this._indoorData.id].selectedBuilding=i?i.id:void 0;const m=this._indoorData.levels.filter(v=>i.levels.includes(v.id));this.fire(new r.z("buildingselected",{buildingId:i.id,levels:m}))}_levelSelected(i){if(i==="overview")this._updateLevels(void 0,!0);else{const l=this._indoorData.levels.find(m=>m.id===i);this._updateLevels(l,!0)}this.fire(new r.z("levelselected",{levelId:i==="overview"?void 0:i}))}_updateLevels(i,l){if(!i)return this._map.setConfigProperty(this._scope,"mbx-indoor-loaded-levels",["literal",[]]),this._map.setConfigProperty(this._scope,"mbx-indoor-underground",!1),this._floorplanStates[this._indoorData.id].selectedLevel=void 0,void(l&&this._indoorData.extent&&this._map.fitBounds(this._indoorData.extent,{pitch:this._map.getPitch(),bearing:this._map.getBearing()}));function m(j){const G=j.indexOf("/floor/");if(G===-1)return j;const X=G+7,Y=j.indexOf("/",X);return Y===-1?j.slice(X):j.slice(X,Y)}this._selectedLevel=i,this._floorplanStates[this._indoorData.id].selectedLevel=i?i.id:void 0;const v=[],x={},E={},L={},$={};for(const j of this._indoorData.levels)if(v.push(j.id),x[j.id]=j.height,E[j.id]=j.base,i){if(this.mergeFloors){const G=m(i.id),X=m(j.id);L[j.id]=X===G?"true":"false"}else L[j.id]=j.id===i.id?"true":"false";$[j.id]=j.base<i.base?"true":"false"}else $[j.id]=!0;if(this._map.setConfigProperty(this._scope,"mbx-indoor-loaded-levels",["literal",v]),this._map.setConfigProperty(this._scope,"mbx-indoor-level-height",["literal",x]),this._map.setConfigProperty(this._scope,"mbx-indoor-level-base",["literal",E]),this._map.setConfigProperty(this._scope,"mbx-indoor-level-selected",["literal",L]),this._map.setConfigProperty(this._scope,"mbx-indoor-level-overlapped",["literal",$]),i&&(this._map.setConfigProperty(this._scope,"mbx-indoor-underground",!!i.isUnderground),l&&i.extent)){const j=this._map.cameraForBounds(i.extent,{pitch:this._map.getPitch(),bearing:this._map.getBearing()}),G=this._map.getZoom(),X=j.zoom?Math.abs(G-j.zoom):0;this._map.fitBounds(i.extent,X>=1?{pitch:this._map.getPitch(),bearing:this._map.getBearing()}:{pitch:this._map.getPitch(),bearing:this._map.getBearing(),zoom:G})}}selectFloorplan(i){const l={target:{featuresetId:this._queryFeatureSetId,importId:this._scope}},m=[new r.P(0,0),new r.P(this._map.transform.width,this._map.transform.height)],v=this._map.queryRenderedFeatures(m,l);if(v.length>0){for(const x of v)if(JSON.parse(x.properties["indoor-data"]).floorplanIDs.includes(i)){this._selectedFloorplan=x,this._floorplanSelected(!0);break}}}selectBuilding(i){const l=this._indoorData.buildings.find(m=>m.id===i);this._buildingSelected(l,!0)}selectLevel(i){this._levelSelected(i)}}function Rv(h){if(!h.metadata||!h.metadata.content_area)return;const{left:i,top:l,width:m,height:v}=h.metadata.content_area;return[i,l,i+m,l+v]}const El=(h,i)=>Tt(h,i&&i.filter(l=>l.identifier!=="source.canvas")),Xx=r.ay(Yr,["addLayer","removeLayer","setLights","setPaintProperty","setLayoutProperty","setSlot","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setSnow","setRain","setProjection","setCamera","addImport","removeImport","updateImport"]),Jx=r.ay(Yr,["setCenter","setZoom","setBearing","setPitch"]),bg=new Set(["background","sky","slot","custom"]),Ov={version:8,layers:[],sources:{}},xg={duration:300,delay:0};class Pa extends r.E{constructor(i,l={}){super(),this.map=i,this.scope=l.scope||"",this.globalId=null,this.fragments=[],this.importDepth=l.importDepth||0,this.importsCache=l.importsCache||new Map,this.resolvedImports=l.resolvedImports||new Set,this.transition=r.l({},xg),this._buildingIndex=new Ux(this),this.crossTileSymbolIndex=new Iv,this._mergedOrder=[],this._drapedFirstOrder=[],this._mergedLayers={},this._mergedSourceCaches={},this._mergedOtherSourceCaches={},this._mergedSymbolSourceCaches={},this._clipLayerPresent=!1,this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this._changes=l.styleChanges||new tt,this.dispatcher=l.dispatcher?l.dispatcher:new r.D(r.ci(),this),l.imageManager?this.imageManager=l.imageManager:(this.imageManager=new Jt(this.map._spriteFormat),this.imageManager.setEventedParent(this)),this.imageManager.createScope(this.scope),this.glyphManager=l.glyphManager?l.glyphManager:new r.cj(i._requestManager,l.localFontFamily?r.ck.all:l.localIdeographFontFamily?r.ck.ideographs:r.ck.none,l.localFontFamily||l.localIdeographFontFamily),l.modelManager?this.modelManager=l.modelManager:(this.modelManager=new Zx(i._requestManager),this.modelManager.setEventedParent(this)),this._layers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._precompileDone=!1,this._shouldPrecompile=!1,this._availableImages=[],this._order=[],this._markersNeedUpdate=!1,this.options=l.configOptions?l.configOptions:new Map,this._configDependentLayers=l.configDependentLayers?l.configDependentLayers:new Set,this._config=l.config,this._styleColorTheme={lut:null,lutLoading:!1,lutLoadingCorrelationID:0,colorTheme:null,colorThemeOverride:l.colorThemeOverride},this._styleColorThemeForScope={},this._initialConfig=l.initialConfig,this.dispatcher.broadcast("setReferrer",r.cl());const m=this;this._rtlTextPluginCallback=Pa.registerForPluginStateChange(v=>{m.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:v.pluginStatus,pluginURL:v.pluginURL},(x,E)=>{if(r.cm(x),E&&E.every(L=>L))for(const L in m._sourceCaches){const $=m._sourceCaches[L],j=$.getSource().type;j!=="vector"&&j!=="geojson"||$.reload()}})}),this.on("data",v=>{if(v.dataType!=="source"||v.sourceDataType!=="metadata")return;const x=this.getOwnSource(v.sourceId);if(x&&x.vectorLayerIds)for(const E in this._layers){const L=this._layers[E];L.source===x.id&&this._validateLayer(L)}})}load(i){return i?(typeof i=="string"?this.loadURL(i):this.loadJSON(i),this):this}_getGlobalId(i){if(!i)return null;if(typeof i=="string"){if(r.f(i))return i;const l=r.cn(i);if(!l.startsWith("http"))try{return new URL(l,location.href).toString()}catch{return l}return l}return`json://${r.co(JSON.stringify(i))}`}_diffStyle(i,l,m){this.globalId=this._getGlobalId(i);const v=(x,E)=>{try{E(null,this.setState(x,m))}catch(L){E(L,!1)}};if(typeof i=="string"){const x=this.map._requestManager.normalizeStyleURL(i),E=this.map._requestManager.transformRequest(x,r.R.Style);r.n(E,(L,$)=>{L?this.fire(new r.y(L)):$&&v($,l)})}else typeof i=="object"&&v(i,l)}loadURL(i,l={}){this.fire(new r.z("dataloading",{dataType:"style"}));const m=typeof l.validate=="boolean"?l.validate:!r.f(i);this.globalId=this._getGlobalId(i),i=this.map._requestManager.normalizeStyleURL(i,l.accessToken),this.resolvedImports.add(i);const v=this.importsCache.get(i);if(v)return this._load(v,m);const x=this.map._requestManager.transformRequest(i,r.R.Style);this._request=r.n(x,(E,L)=>{if(this._request=null,E)this.fire(new r.y(E));else if(L)return this.importsCache.set(i,L),this._load(L,m)})}loadJSON(i,l={}){this.fire(new r.z("dataloading",{dataType:"style"})),this.globalId=this._getGlobalId(i),this._request=r.q.frame(()=>{this._request=null,this._load(i,l.validate!==!1)})}loadEmpty(){this.fire(new r.z("dataloading",{dataType:"style"})),this._load(Ov,!1)}_loadImports(i,l,m){if(this.importDepth>=4)return r.w("Style doesn't support nesting deeper than 5"),Promise.resolve();const v=[];for(const x of i){const E=this._createFragmentStyle(x),L=new Promise(G=>{E.once("style.import.load",G),E.once("error",G)}).then(()=>this.mergeAll());if(v.push(L),this.resolvedImports.has(x.url)){E.loadEmpty();continue}const $=x.data||this.importsCache.get(x.url);$?(E.loadJSON($,{validate:l}),this._isInternalStyle($)&&(E.globalId=null)):x.url?E.loadURL(x.url,{validate:l}):E.loadEmpty();const j={style:E,id:x.id,config:x.config};if(m){const G=this.fragments.findIndex(({id:X})=>X===m);this.fragments=this.fragments.slice(0,G).concat(j).concat(this.fragments.slice(G))}else this.fragments.push(j)}return Promise.allSettled(v)}getImportGlobalIds(i=this,l=new Set){for(const m of i.fragments)m.style.globalId&&l.add(m.style.globalId),this.getImportGlobalIds(m.style,l);return[...l.values()]}_createFragmentStyle(i){const l=this.scope?r.aC(i.id,this.scope):i.id;let m;const v=this._initialConfig&&this._initialConfig[l];(i.config||v)&&(m=r.l({},i.config,v));const x=new Pa(this.map,{scope:l,styleChanges:this._changes,importDepth:this.importDepth+1,importsCache:this.importsCache,resolvedImports:new Set(this.resolvedImports),dispatcher:this.dispatcher,imageManager:this.imageManager,glyphManager:this.glyphManager,modelManager:this.modelManager,config:m,configOptions:this.options,colorThemeOverride:i["color-theme"],configDependentLayers:this._configDependentLayers});return x.setEventedParent(this.map,{style:x}),x}_reloadImports(){this.mergeAll(),this._updateMapProjection(),this.updateConfigDependencies(),this.map._triggerCameraUpdate(this.camera),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options}),this._shouldPrecompile=this.map._precompilePrograms&&this.isRootStyle()}_isInternalStyle(i){return this.isRootStyle()&&(i.fragment||!!i.schema&&i.fragment!==!1)}_load(i,l){const m=i.indoor?kv(i.schema):i.schema;if(this._isInternalStyle(i)){const E=r.l({},Ov,{imports:[{id:"basemap",data:i,url:""}]});return void this._load(E,l)}if(this.updateConfig(this._config,m),l&&El(this,xi(i)))return;this._loaded=!0,this.stylesheet=r.cp(i);const v=()=>{for(const j in i.sources)this.addSource(j,i.sources[j],{validate:!1,isInitialLoad:!0});i.sprite?this._loadIconset(i.sprite):(this.imageManager.setLoaded(!0,this.scope),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0})),this.glyphManager.setURL(i.glyphs,this.scope);const E=gg(this.stylesheet.layers);if(this._order=E.map(j=>j.id),this.stylesheet.light&&r.w("The `light` root property is deprecated, prefer using `lights` with `flat` light type instead."),this.stylesheet.lights)if(this.stylesheet.lights.length===1&&this.stylesheet.lights[0].type==="flat"){const j=this.stylesheet.lights[0];this.light=new Qe(j.properties,j.id)}else this.setLights(this.stylesheet.lights);this.light||(this.light=new Qe(this.stylesheet.light)),this._layers={};for(const j of E){const G=r.cu(j,this.scope,this._styleColorTheme.lut,this.options);G.configDependencies.size!==0&&this._configDependentLayers.add(G.fqid),G.setEventedParent(this,{layer:{id:G.id}}),this._layers[G.id]=G;const X=this.getOwnLayerSourceCache(G),Y=!!this.directionalLight&&this.directionalLight.shadowsEnabled();X&&G.canCastShadows()&&Y&&(X.castsShadows=!0)}this.stylesheet.featuresets&&this.setFeaturesetSelectors(this.stylesheet.featuresets),this.stylesheet.models&&this.modelManager.addModels(this.stylesheet.models,this.scope);const L=this.stylesheet.terrain;L&&(this.checkCanvasFingerprintNoise(),this.disableElevatedTerrain||this.terrainSetForDrapingOnly()||this._createTerrain(L,1)),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this.stylesheet.snow&&this._createSnow(this.stylesheet.snow),this.stylesheet.rain&&this._createRain(this.stylesheet.rain),this.stylesheet.transition&&this.setTransition(this.stylesheet.transition),this.fire(new r.z("data",{dataType:"style"}));const $=this.isRootStyle();i.imports?this._loadImports(i.imports,l).then(()=>{this._reloadImports(),this.fire(new r.z($?"style.load":"style.import.load"))}):(this._reloadImports(),this.fire(new r.z($?"style.load":"style.import.load")))};this._styleColorTheme.colorTheme=this.stylesheet["color-theme"];const x=this._styleColorTheme.colorThemeOverride?this._styleColorTheme.colorThemeOverride:this._styleColorTheme.colorTheme;if(x){const E=this._evaluateColorThemeData(x);this._loadColorTheme(E).then(()=>{v()}).catch(L=>{r.w(`Couldn't load color theme from the stylesheet: ${L}`),v()})}else this._styleColorTheme.lut=null,v()}isRootStyle(){return this.importDepth===0}mergeAll(){let i,l,m,v,x,E,L,$,j,G;const X={};this.terrain&&this.terrain.scope!==this.scope&&delete this.terrain,this.forEachFragmentStyle(Y=>{if(Y.stylesheet){if(Y.light!=null&&(i=Y.light),Y.stylesheet.lights)for(const ne of Y.stylesheet.lights)ne.type==="ambient"&&Y.ambientLight!=null&&(l=Y.ambientLight),ne.type==="directional"&&Y.directionalLight!=null&&(m=Y.directionalLight);v=this._prioritizeTerrain(v,Y.terrain,Y.stylesheet.terrain),Y.stylesheet.fog&&Y.fog!=null&&(x=Y.fog),Y.stylesheet.snow&&Y.snow!=null&&(E=Y.snow),Y.stylesheet.rain&&Y.rain!=null&&(L=Y.rain),Y.stylesheet.camera!=null&&(G=Y.stylesheet.camera),Y.stylesheet.projection!=null&&($=Y.stylesheet.projection),Y.stylesheet.transition!=null&&(j=Y.stylesheet.transition),X[Y.scope]=Y._styleColorTheme}}),this.light=i,this.ambientLight=l,this.directionalLight=m,this.fog=x,this.snow=E,this.rain=L,this._styleColorThemeForScope=X,v===null?delete this.terrain:this.terrain=v,this.camera=G||{"camera-projection":"perspective"},this.projection=$||{name:"mercator"},this.transition=r.l({},xg,j),this.mergeSources(),this.mergeLayers()}forEachFragmentStyle(i){const l=m=>{for(const v of m.fragments)l(v.style);i(m)};l(this)}_prioritizeTerrain(i,l,m){const v=i&&i.drapeRenderMode===0;return m===null?l&&l.drapeRenderMode===0?l:v?i:null:l!=null&&(!i||v||l&&l.drapeRenderMode===1)?l:i}mergeTerrain(){let i;this.terrain&&this.terrain.scope!==this.scope&&delete this.terrain,this.forEachFragmentStyle(l=>{i=this._prioritizeTerrain(i,l.terrain,l.stylesheet.terrain)}),i===null?delete this.terrain:this.terrain=i}mergeProjection(){let i;this.forEachFragmentStyle(l=>{l.stylesheet.projection!=null&&(i=l.stylesheet.projection)}),this.projection=i||{name:"mercator"}}mergeSources(){const i={},l={},m={};this.forEachFragmentStyle(v=>{for(const x in v._sourceCaches){const E=r.aC(x,v.scope);i[E]=v._sourceCaches[x]}for(const x in v._otherSourceCaches){const E=r.aC(x,v.scope);l[E]=v._otherSourceCaches[x]}for(const x in v._symbolSourceCaches){const E=r.aC(x,v.scope);m[E]=v._symbolSourceCaches[x]}}),this._mergedSourceCaches=i,this._mergedOtherSourceCaches=l,this._mergedSymbolSourceCaches=m}mergeLayers(){const i={},l=[],m={};this._mergedSlots=[],this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this.forEachFragmentStyle(x=>{for(const E of x._order){const L=x._layers[E];if(L.type==="slot"){const $=r.cq(E);if(i[$])continue;i[$]=[]}L.slot&&i[L.slot]?i[L.slot].push(L):l.push(L)}}),this._mergedOrder=[];const v=(x=[])=>{for(const E of x)if(E.type==="slot"){const L=r.cq(E.id);i[L]&&v(i[L]),this._mergedSlots.push(L)}else{const L=r.aC(E.id,E.scope);this._mergedOrder.push(L),m[L]=E,E.is3D()&&(this._has3DLayers=!0),E.type==="circle"&&(this._hasCircleLayers=!0),E.type==="symbol"&&(this._hasSymbolLayers=!0),E.type==="clip"&&(this._clipLayerPresent=!0)}};v(l),this._mergedOrder.sort((x,E)=>{const L=m[x],$=m[E];return L.hasInitialOcclusionOpacityProperties?$.is3D()?1:0:L.is3D()&&$.hasInitialOcclusionOpacityProperties?-1:0}),this._mergedLayers=m,this.updateDrapeFirstLayers(),this._buildingIndex.processLayersChanged()}terrainSetForDrapingOnly(){return!!this.terrain&&this.terrain.drapeRenderMode===0}getCamera(){return this.stylesheet.camera}setCamera(i){return this.stylesheet.camera=r.l({},this.stylesheet.camera,i),this.camera=this.stylesheet.camera,this}_evaluateColorThemeData(i){return i.data?function(l,m,v){const x=r.l({},m);for(const L of Object.keys(r.a3.colorTheme))x[L]===void 0&&(x[L]=r.a3.colorTheme[L].default);const E=new r.a4(Yx,l,new Map(v));return E.setTransitionOrValue(x,v),E.untransitioned().possiblyEvaluate(new r.a8(0))}(this.scope,i,this.options).get("data"):null}_loadColorTheme(i){this._styleColorTheme.lutLoading=!0,this._styleColorTheme.lutLoadingCorrelationID+=1;const l=this._styleColorTheme.lutLoadingCorrelationID;return new Promise((m,v)=>{const x="data:image/png;base64,";if(!i||i.length===0)return this._styleColorTheme.lut=null,this._styleColorTheme.lutLoading=!1,void m();let E=i;E.startsWith(x)||(E=x+E);const L="mapbox-reserved-lut",$=new Image;$.src=E,$.onerror=()=>{this._styleColorTheme.lutLoading=!1,v(new Error("Failed to load image data"))},$.onload=()=>{if(this._styleColorTheme.lutLoadingCorrelationID!==l)return void m();this._styleColorTheme.lutLoading=!1;const{width:j,height:G,data:X}=r.q.getImageData($);if(G>32)return void v(new Error("The height of the image must be less than or equal to 32 pixels."));if(j!==G*G)return void v(new Error("The width of the image must be equal to the height squared."));this.getImage(L)&&this.removeImage(L),this.addImage(L,{data:new r.r({width:j,height:G},X),pixelRatio:1,sdf:!1,usvg:!1,version:0});const Y=this.imageManager.getImage(L,this.scope);Y?(this._styleColorTheme.lut={image:Y.data,data:i},m()):v(new Error("Missing LUT image."))}})}getLut(i){const l=this._styleColorThemeForScope[i];return l?l.lut:null}setProjection(i){i?this.stylesheet.projection=i:delete this.stylesheet.projection,this.mergeProjection(),this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?(this.getTerrain()||this.stylesheet.terrain)&&!this.disableElevatedTerrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null,0))}_updateMapProjection(){this.isRootStyle()&&(this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.projection))}_loadSprite(i){this._spriteRequest=function(l,m,v){let x,E,L;const $=r.q.devicePixelRatio>1?"@2x":"";let j=r.n(m.transformRequest(m.normalizeSpriteURL(l,$,".json"),r.R.SpriteJSON),(Y,ne)=>{j=null,L||(L=Y,x=ne,X())}),G=r.o(m.transformRequest(m.normalizeSpriteURL(l,$,".png"),r.R.SpriteImage),(Y,ne)=>{G=null,L||(L=Y,E=ne,X())});function X(){if(L)v(L);else if(x&&E){const Y=r.q.getImageData(E),ne={};for(const ve in x){const{width:_e,height:Te,x:Ce,y:Re,sdf:je,pixelRatio:Be,stretchX:et,stretchY:Ze,content:Xe}=x[ve],Ke=new r.r({width:_e,height:Te});r.r.copy(Y,Ke,{x:Ce,y:Re},{x:0,y:0},{width:_e,height:Te},null),ne[ve]={data:Ke,pixelRatio:Be,sdf:je,stretchX:et,stretchY:Ze,content:Xe,usvg:!1}}v(null,ne)}}return{cancel(){j&&(j.cancel(),j=null),G&&(G.cancel(),G=null)}}}(i,this.map._requestManager,(l,m)=>{if(this._spriteRequest=null,l)this.fire(new r.y(l));else if(m)for(const v in m)this.imageManager.addImage(v,this.scope,m[v]);this.imageManager.setLoaded(!0,this.scope),this._availableImages=this.imageManager.listImages(this.scope),this.dispatcher.broadcast("setImages",{scope:this.scope,images:this._availableImages}),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0}),this.fire(new r.z("data",{dataType:"style"}))})}_loadIconset(i){if(!r.f(i)&&this.map._spriteFormat!=="icon_set"||this.map._spriteFormat==="raster")return void this._loadSprite(i);const l=this.map._spriteFormat==="auto";var m,v;this._spriteRequest=(v=(x,E)=>{if(this._spriteRequest=null,x)l?this._loadSprite(i):this.fire(new r.y(x));else if(E)for(const L in E)this.imageManager.addImage(L,this.scope,E[L]);this.imageManager.setLoaded(!0,this.scope),this._availableImages=this.imageManager.listImages(this.scope),this.dispatcher.broadcast("setImages",{scope:this.scope,images:this._availableImages}),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0}),this.fire(new r.z("data",{dataType:"style"}))},r.bi((m=this.map._requestManager).transformRequest(m.normalizeIconsetURL(i),r.R.Iconset),(x,E)=>{if(x)return void v(x);const L={},$=r.cg(new r.bh(E));for(const j of $.icons){const G={version:1,pixelRatio:r.q.devicePixelRatio,content:Rv(j),stretchX:j.metadata?j.metadata.stretch_x_areas:void 0,stretchY:j.metadata?j.metadata.stretch_y_areas:void 0,sdf:!1,usvg:!0,icon:j};L[j.name]=G}v(null,L)}))}_validateLayer(i){const l=this.getOwnSource(i.source);if(!l)return;const m=i.sourceLayer;m&&(l.type==="geojson"||l.vectorLayerIds&&l.vectorLayerIds.indexOf(m)===-1)&&this.fire(new r.y(new Error(`Source layer "${m}" does not exist on source "${l.id}" as specified by style layer "${i.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._changes.getUpdatedSourceCaches()).length)return!1;for(const i in this._sourceCaches)if(!this._sourceCaches[i].loaded())return!1;if(!this.imageManager.isLoaded()||!this.modelManager.isLoaded()||this._styleColorTheme.lutLoading)return!1;for(const{style:i}of this.fragments)if(!i.loaded())return!1;return!0}_serializeImports(){if(this.stylesheet.imports)return this.stylesheet.imports.map((i,l)=>{const m=this.fragments[l];return m&&m.style&&(i.data=m.style.serialize()),i})}_serializeSources(){const i={};for(const l in this._sourceCaches){const m=this._sourceCaches[l].getSource();i[m.id]||(i[m.id]=m.serialize())}return i}_serializeLayers(i){const l=[];for(const m of i){const v=this._layers[m];v&&v.type!=="custom"&&l.push(v.serialize())}return l}hasLightTransitions(){return!(!this.light||!this.light.hasTransition())||!(!this.ambientLight||!this.ambientLight.hasTransition())||!(!this.directionalLight||!this.directionalLight.hasTransition())}hasFogTransition(){return!!this.fog&&this.fog.hasTransition()}hasSnowTransition(){return!!this.snow&&this.snow.hasTransition()}hasRainTransition(){return!!this.rain&&this.rain.hasTransition()}hasTransitions(){if(this.hasLightTransitions()||this.hasFogTransition()||this.hasSnowTransition()||this.hasRainTransition())return!0;for(const i in this._sourceCaches)if(this._sourceCaches[i].hasTransition())return!0;for(const i in this._layers)if(this._layers[i].hasTransition())return!0;return!1}get order(){return this.terrain?this._drapedFirstOrder:this._mergedOrder}_getOrder(i){return i?this.order:this._mergedOrder}isLayerDraped(i){return!!this.terrain&&i.isDraped(this.getLayerSourceCache(i))}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}_checkLayer(i){const l=this.getOwnLayer(i);if(l)return l;this.fire(new r.y(new Error(`The layer '${i}' does not exist in the map's style.`)))}_checkSource(i){const l=this.getOwnSource(i);if(l)return l;this.fire(new r.y(new Error(`The source '${i}' does not exist in the map's style.`)))}precompilePrograms(i,l){const m=this.map.painter;if(m)for(let v=i.minzoom||0;v<(i.maxzoom||25.5);v++){const x=i.getProgramIds();if(x)for(const E of x){const L=i.getDefaultProgramParams(E,l.zoom,this._styleColorTheme.lut);L&&(m.style=this,this.fog&&(m._fogVisible=!0,L.overrideFog=!0,m.getOrCreateProgram(E,L)),m._fogVisible=!1,L.overrideFog=!1,m.getOrCreateProgram(E,L),(this.stylesheet.terrain||this.stylesheet.projection&&this.stylesheet.projection.name==="globe")&&(L.overrideRtt=!0,m.getOrCreateProgram(E,L)))}}}update(i){if(!this._loaded)return;this.ambientLight&&this.ambientLight.recalculate(i),this.directionalLight&&this.directionalLight.recalculate(i);const l=this.calculateLightsBrightness();i.brightness=l||0,l!==this._brightness&&(this._brightness=l,this.dispatcher.broadcast("setBrightness",l));const m=this._changes.isDirty();let v=!1;if(this._changes.isDirty()){const E=this._changes.getLayerUpdatesByScope();for(const L in E){const{updatedIds:$,removedIds:j}=E[L];($||j)&&(this._updateWorkerLayers(L,$,j),v=!0)}this.updateSourceCaches(),this._updateTilesForChangedImages(),this.updateLayers(i),this.light&&this.light.updateTransitions(i),this.ambientLight&&this.ambientLight.updateTransitions(i),this.directionalLight&&this.directionalLight.updateTransitions(i),this.fog&&this.fog.updateTransitions(i),this.snow&&this.snow.updateTransitions(i),this.rain&&this.rain.updateTransitions(i),this._changes.reset()}const x={};for(const E in this._mergedSourceCaches){const L=this._mergedSourceCaches[E];x[E]=L.used,L.used=!1,L.tileCoverLift=0}for(const E of this._mergedOrder){const L=this._mergedLayers[E];if(L.recalculate(i,this._availableImages),!L.isHidden(i.zoom)){const $=this.getLayerSourceCache(L);$&&($.used=!0,$.tileCoverLift=Math.max($.tileCoverLift,L.tileCoverLift()))}!this._precompileDone&&this._shouldPrecompile&&("requestIdleCallback"in window?requestIdleCallback(()=>{this.precompilePrograms(L,i)}):this.precompilePrograms(L,i))}this._shouldPrecompile&&(this._precompileDone=!0),this.terrain&&v&&this.mergeLayers();for(const E in x){const L=this._mergedSourceCaches[E];x[E]!==L.used&&L.getSource().fire(new r.z("data",{sourceDataType:"visibility",dataType:"source",sourceId:L.getSource().id}))}this.light&&this.light.recalculate(i),this.terrain&&this.terrain.recalculate(i),this.fog&&this.fog.recalculate(i),this.snow&&this.snow.recalculate(i),this.rain&&this.rain.recalculate(i),this.z=i.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),m&&this.fire(new r.z("data",{dataType:"style"}))}_updateTilesForChangedImages(){const i=this._changes.getUpdatedImages();if(i.length){for(const l in this._sourceCaches)this._sourceCaches[l].reloadTilesForDependencies(["icons","patterns"],i);this._changes.resetUpdatedImages()}}_updateWorkerLayers(i,l,m){const v=this.getFragmentStyle(i);v&&this.dispatcher.broadcast("updateLayers",{layers:l?v._serializeLayers(l):[],scope:i,removedIds:m||[],options:v.options})}setState(i,l){if(this._checkLoaded(),El(this,xi(i)))return!1;(i=r.cp(i)).layers=gg(i.layers);const m=function(E,L){if(!E)return[{command:Yr.setStyle,args:[L]}];let $=[];try{if(!r.bn(E.version,L.version))return[{command:Yr.setStyle,args:[L]}];if(r.bn(E.center,L.center)||$.push({command:Yr.setCenter,args:[L.center]}),r.bn(E.zoom,L.zoom)||$.push({command:Yr.setZoom,args:[L.zoom]}),r.bn(E.bearing,L.bearing)||$.push({command:Yr.setBearing,args:[L.bearing]}),r.bn(E.pitch,L.pitch)||$.push({command:Yr.setPitch,args:[L.pitch]}),r.bn(E.sprite,L.sprite)||$.push({command:Yr.setSprite,args:[L.sprite]}),r.bn(E.glyphs,L.glyphs)||$.push({command:Yr.setGlyphs,args:[L.glyphs]}),r.bn(E.imports,L.imports)||function(ne=[],ve=[],_e){ve=ve||[];const Te=(ne=ne||[]).map(oi),Ce=ve.map(oi),Re=ne.reduce(Xr,{}),je=ve.reduce(Xr,{}),Be=Te.slice();let et,Ze,Xe,Ke;for(et=0,Ze=0;et<Te.length;et++)Xe=Te[et],je.hasOwnProperty(Xe)?Ze++:(_e.push({command:Yr.removeImport,args:[Xe]}),Be.splice(Be.indexOf(Xe,Ze),1));for(et=0,Ze=0;et<Ce.length;et++)Xe=Ce[Ce.length-1-et],Be[Be.length-1-et]!==Xe&&(Re.hasOwnProperty(Xe)?(_e.push({command:Yr.removeImport,args:[Xe]}),Be.splice(Be.lastIndexOf(Xe,Be.length-Ze),1)):Ze++,Ke=Be[Be.length-et],_e.push({command:Yr.addImport,args:[je[Xe],Ke]}),Be.splice(Be.length-et,0,Xe));for(const at of ve){const pt=Re[at.id];pt&&!r.bn(pt,at)&&_e.push({command:Yr.updateImport,args:[at.id,at]})}}(E.imports,L.imports,$),r.bn(E.transition,L.transition)||$.push({command:Yr.setTransition,args:[L.transition]}),r.bn(E.light,L.light)||$.push({command:Yr.setLight,args:[L.light]}),r.bn(E.fog,L.fog)||$.push({command:Yr.setFog,args:[L.fog]}),r.bn(E.snow,L.snow)||$.push({command:Yr.setSnow,args:[L.snow]}),r.bn(E.rain,L.rain)||$.push({command:Yr.setRain,args:[L.rain]}),r.bn(E.projection,L.projection)||$.push({command:Yr.setProjection,args:[L.projection]}),r.bn(E.lights,L.lights)||$.push({command:Yr.setLights,args:[L.lights]}),r.bn(E.camera,L.camera)||$.push({command:Yr.setCamera,args:[L.camera]}),!r.bn(E["color-theme"],L["color-theme"]))return[{command:Yr.setStyle,args:[L]}];const j={},G=[];(function(ne,ve,_e,Te){let Ce;for(Ce in ve=ve||{},ne=ne||{})ne.hasOwnProperty(Ce)&&(ve.hasOwnProperty(Ce)||ca(Ce,_e,Te));for(Ce in ve){if(!ve.hasOwnProperty(Ce))continue;const Re=ve[Ce];ne.hasOwnProperty(Ce)?r.bn(ne[Ce],Re)||(ne[Ce].type==="geojson"&&Re.type==="geojson"&&Uc(ne,ve,Ce)?_e.push({command:Yr.setGeoJSONSourceData,args:[Ce,Re.data]}):_g(Ce,ve,_e,Te)):$h(Ce,ve,_e)}})(E.sources,L.sources,G,j);const X=[];E.layers&&E.layers.forEach(ne=>{ne.source&&j[ne.source]?$.push({command:Yr.removeLayer,args:[ne.id]}):X.push(ne)});let Y=E.terrain;Y&&j[Y.source]&&($.push({command:Yr.setTerrain,args:[void 0]}),Y=void 0),$=$.concat(G),r.bn(Y,L.terrain)||$.push({command:Yr.setTerrain,args:[L.terrain]}),function(ne,ve,_e){ve=ve||[];const Te=(ne=ne||[]).map(oi),Ce=ve.map(oi),Re=ne.reduce(Xr,{}),je=ve.reduce(Xr,{}),Be=Te.slice(),et=Object.create(null);let Ze,Xe,Ke,at,pt,Vt,Rt;for(Ze=0,Xe=0;Ze<Te.length;Ze++)Ke=Te[Ze],je.hasOwnProperty(Ke)?Xe++:(_e.push({command:Yr.removeLayer,args:[Ke]}),Be.splice(Be.indexOf(Ke,Xe),1));for(Ze=0,Xe=0;Ze<Ce.length;Ze++)Ke=Ce[Ce.length-1-Ze],Be[Be.length-1-Ze]!==Ke&&(Re.hasOwnProperty(Ke)?(_e.push({command:Yr.removeLayer,args:[Ke]}),Be.splice(Be.lastIndexOf(Ke,Be.length-Xe),1)):Xe++,Vt=Be[Be.length-Ze],_e.push({command:Yr.addLayer,args:[je[Ke],Vt]}),Be.splice(Be.length-Ze,0,Ke),et[Ke]=!0);for(Ze=0;Ze<Ce.length;Ze++)if(Ke=Ce[Ze],at=Re[Ke],pt=je[Ke],!et[Ke]&&!r.bn(at,pt))if(r.bn(at.source,pt.source)&&r.bn(at["source-layer"],pt["source-layer"])&&r.bn(at.type,pt.type)){for(Rt in Hn(at.layout,pt.layout,_e,Ke,null,Yr.setLayoutProperty),Hn(at.paint,pt.paint,_e,Ke,null,Yr.setPaintProperty),r.bn(at.slot,pt.slot)||_e.push({command:Yr.setSlot,args:[Ke,pt.slot]}),r.bn(at.filter,pt.filter)||_e.push({command:Yr.setFilter,args:[Ke,pt.filter]}),r.bn(at.minzoom,pt.minzoom)&&r.bn(at.maxzoom,pt.maxzoom)||_e.push({command:Yr.setLayerZoomRange,args:[Ke,pt.minzoom,pt.maxzoom]}),at)at.hasOwnProperty(Rt)&&Rt!=="layout"&&Rt!=="paint"&&Rt!=="filter"&&Rt!=="metadata"&&Rt!=="minzoom"&&Rt!=="maxzoom"&&Rt!=="slot"&&(Rt.indexOf("paint.")===0?Hn(at[Rt],pt[Rt],_e,Ke,Rt.slice(6),Yr.setPaintProperty):r.bn(at[Rt],pt[Rt])||_e.push({command:Yr.setLayerProperty,args:[Ke,Rt,pt[Rt]]}));for(Rt in pt)pt.hasOwnProperty(Rt)&&!at.hasOwnProperty(Rt)&&Rt!=="layout"&&Rt!=="paint"&&Rt!=="filter"&&Rt!=="metadata"&&Rt!=="minzoom"&&Rt!=="maxzoom"&&Rt!=="slot"&&(Rt.indexOf("paint.")===0?Hn(at[Rt],pt[Rt],_e,Ke,Rt.slice(6),Yr.setPaintProperty):r.bn(at[Rt],pt[Rt])||_e.push({command:Yr.setLayerProperty,args:[Ke,Rt,pt[Rt]]}))}else _e.push({command:Yr.removeLayer,args:[Ke]}),Vt=Be[Be.lastIndexOf(Ke)+1],_e.push({command:Yr.addLayer,args:[pt,Vt]})}(X,L.layers,$)}catch(j){console.warn("Unable to compute style diff:",j),$=[{command:Yr.setStyle,args:[L]}]}return $}(this.serialize(),i).filter(E=>!(E.command in Jx));if(m.length===0)return!1;const v=m.filter(E=>!(E.command in Xx));if(v.length>0)throw new Error(`Unimplemented: ${v.map(E=>E.command).join(", ")}.`);const x=[];return m.forEach(E=>{x.push(this[E.command].apply(this,E.args))}),l&&Promise.all(x).then(l),this.stylesheet=i,this.mergeAll(),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options}),!0}addImage(i,l){return this.getImage(i)?this.fire(new r.y(new Error("An image with this name already exists."))):(this.imageManager.addImage(i,this.scope,l),this._afterImageUpdated(i),this)}updateImage(i,l,m=!1){this.imageManager.updateImage(i,this.scope,l),m&&this._afterImageUpdated(i)}getImage(i){return this.imageManager.getImage(i,this.scope)}removeImage(i){return this.getImage(i)?(this.imageManager.removeImage(i,this.scope),this._afterImageUpdated(i),this):this.fire(new r.y(new Error("No image with this name exists.")))}_afterImageUpdated(i){this._availableImages=this.imageManager.listImages(this.scope),this._changes.updateImage(i),this.dispatcher.broadcast("setImages",{scope:this.scope,images:this._availableImages}),this.fire(new r.z("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addModel(i,l,m={}){return this._checkLoaded(),this._validate(xt,`models.${i}`,l,null,m)||(this.modelManager.addModel(i,l,this.scope),this._changes.setDirty()),this}hasModel(i){return this.modelManager.hasModel(i,this.scope)}removeModel(i){return this.hasModel(i)?(this.modelManager.removeModel(i,this.scope),this):this.fire(new r.y(new Error("No model with this ID exists.")))}listModels(){return this._checkLoaded(),this.modelManager.listModels(this.scope)}addSource(i,l,m={}){if(this._checkLoaded(),this.getOwnSource(i)!==void 0)throw new Error(`There is already a source with ID "${i}".`);if(!l.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(l).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(l.type)>=0&&this._validate(Qi,`sources.${i}`,l,null,m))return;this.map&&this.map._collectResourceTiming&&(l.collectResourceTiming=!0);const v=hg(i,l,this.dispatcher,this);v.scope=this.scope,v.setEventedParent(this,()=>({isSourceLoaded:this._isSourceCacheLoaded(v.id),source:v.serialize(),sourceId:v.id}));const x=E=>{const L=(E?"symbol:":"other:")+v.id,$=r.aC(L,this.scope),j=this._sourceCaches[L]=new ua($,v,E);(E?this._symbolSourceCaches:this._otherSourceCaches)[v.id]=j,j.onAdd(this.map)};x(!1),l.type!=="vector"&&l.type!=="geojson"||x(!0),v.onAdd&&v.onAdd(this.map),m.isInitialLoad||(this.mergeSources(),this._changes.setDirty())}removeSource(i){this._checkLoaded();const l=this.getOwnSource(i);if(!l)throw new Error("There is no source with this ID");for(const v in this._layers)if(this._layers[v].source===i)return this.fire(new r.y(new Error(`Source "${i}" cannot be removed while layer "${v}" is using it.`)));if(this.terrain&&this.terrain.scope===this.scope&&this.terrain.get().source===i)return this.fire(new r.y(new Error(`Source "${i}" cannot be removed while terrain is using it.`)));const m=this.getOwnSourceCaches(i);for(const v of m){const x=r.cq(v.id);delete this._sourceCaches[x],this._changes.discardSourceCacheUpdate(v.id),v.fire(new r.z("data",{sourceDataType:"metadata",dataType:"source",sourceId:v.getSource().id})),v.setEventedParent(null),v.clearTiles()}return delete this._otherSourceCaches[i],delete this._symbolSourceCaches[i],this.mergeSources(),l.setEventedParent(null),l.onRemove&&l.onRemove(this.map),this._changes.setDirty(),this}setGeoJSONSourceData(i,l){this._checkLoaded(),this.getOwnSource(i).setData(l),this._changes.setDirty()}getOwnSource(i){const l=this.getOwnSourceCache(i);return l&&l.getSource()}getOwnSources(){const i=[];for(const l in this._otherSourceCaches){const m=this.getOwnSourceCache(l);m&&i.push(m.getSource())}return i}areTilesLoaded(){const i=this._mergedSourceCaches;for(const l in i){const m=i[l]._tiles;for(const v in m){const x=m[v];if(x.state!=="loaded"&&x.state!=="errored")return!1}}return!0}setLights(i){if(this._checkLoaded(),!i)return delete this.ambientLight,void delete this.directionalLight;const l=this._getTransitionParameters();for(const v of i){if(this._validate(co,"lights",v))return;switch(v.type){case"ambient":if(this.ambientLight){const x=this.ambientLight;x.set(v),x.updateTransitions(l)}else this.ambientLight=new vo(v,Kn||(Kn=new r.a5({color:new r.a6(r.a3.properties_light_ambient.color),"color-use-theme":new r.a6({type:"string",default:"default","property-type":"data-constant"}),intensity:new r.a6(r.a3.properties_light_ambient.intensity)})),this.scope,this.options);break;case"directional":if(this.directionalLight){const x=this.directionalLight;x.set(v),x.updateTransitions(l)}else this.directionalLight=new vo(v,Qn||(Qn=new r.a5({direction:new r.ak(r.a3.properties_light_directional.direction),color:new r.a6(r.a3.properties_light_directional.color),"color-use-theme":new r.a6({type:"string",default:"default","property-type":"data-constant"}),intensity:new r.a6(r.a3.properties_light_directional.intensity),"cast-shadows":new r.a6(r.a3.properties_light_directional["cast-shadows"]),"shadow-quality":new r.a6(r.a3.properties_light_directional["shadow-quality"]),"shadow-intensity":new r.a6(r.a3.properties_light_directional["shadow-intensity"])})),this.scope,this.options)}}const m=new r.a8(this.z||0,l);this.ambientLight&&this.ambientLight.recalculate(m),this.directionalLight&&this.directionalLight.recalculate(m),this._brightness=this.calculateLightsBrightness(),this.dispatcher.broadcast("setBrightness",this._brightness)}calculateLightsBrightness(){const i=this.directionalLight,l=this.ambientLight;if(!i||!l)return;const m=Y=>.2126*(Y[0]<=.03928?Y[0]/12.92:Math.pow((Y[0]+.055)/1.055,2.4))+.7152*(Y[1]<=.03928?Y[1]/12.92:Math.pow((Y[1]+.055)/1.055,2.4))+.0722*(Y[2]<=.03928?Y[2]/12.92:Math.pow((Y[2]+.055)/1.055,2.4)),v=i.properties.get("color").toRenderColor(null).toArray01(),x=i.properties.get("intensity"),E=i.properties.get("direction"),L=1-r.cb(E.x,E.y,E.z)[2]/90,$=m(v)*x*L,j=l.properties.get("color").toRenderColor(null).toArray01(),G=l.properties.get("intensity"),X=m(j)*G;return Number((($+X)/2).toFixed(6))}getBrightness(){return this._brightness}getLights(){if(!this.enable3dLights())return null;const i=[];return this.directionalLight&&i.push(this.directionalLight.get()),this.ambientLight&&i.push(this.ambientLight.get()),i}enable3dLights(){return!!this.ambientLight&&!!this.directionalLight}getFragmentStyle(i){if(!i)return this;if(r.cr(i)){const l=r.cs(i),m=this.fragments.find(({id:x})=>x===l);if(!m)throw new Error(`Style import '${i}' not found`);const v=r.cq(i);return m.style.getFragmentStyle(v)}{const l=this.fragments.find(({id:m})=>m===i);if(!l)throw new Error(`Style import '${i}' not found`);return l.style}}setFeaturesetSelectors(i){if(!i)return;const l={},m=(v,x="")=>`${v}::${x}`;this.featuresetSelectors={};for(const v in i){const x=this.featuresetSelectors[v]=[];for(const E of i[v].selectors){if(E.featureNamespace){const $=this.getOwnLayer(E.layer);if(!$){r.w(`Layer is undefined for selector: ${E.layer}`);continue}const j=m($.source,$.sourceLayer);if(j in l&&l[j]!==E.featureNamespace){r.w(`"featureNamespace ${E.featureNamespace} of featureset ${v}'s selector is not associated to the same source, skip this selector`);continue}l[j]=E.featureNamespace}let L;if(E.properties)for(const $ in E.properties){const j=r.U(E.properties[$]);j.result==="success"&&(L=L||{},L[$]=j.value)}x.push({layerId:E.layer,namespace:E.featureNamespace,properties:L})}}}getFeaturesetDescriptors(i){const l=this.getFragmentStyle(i);if(!l||!l.stylesheet.featuresets)return[];const m=[];for(const v in l.stylesheet.featuresets)m.push({featuresetId:v,importId:l.scope?l.scope:void 0});return m}getFeaturesetLayers(i,l){const m=this.getFragmentStyle(l),v=m.stylesheet.featuresets;if(!v||!v[i])return this.fire(new r.y(new Error(`The featureset '${i}' does not exist in the map's style and cannot be queried.`))),[];const x=[];for(const E of v[i].selectors){const L=m.getOwnLayer(E.layer);L&&x.push(L)}return x}getConfigProperty(i,l){const m=this.getFragmentStyle(i);if(!m)return null;const v=r.aC(l,m.scope),x=m.options.get(v),E=x?x.value||x.default:null;return E?E.serialize():null}setConfigProperty(i,l,m){const v=this.getFragmentStyle(i);if(!v)return;const x=v.stylesheet.indoor?kv(v.stylesheet.schema):v.stylesheet.schema;if(!x||!x[l])return;const E=r.U(m);if(E.result!=="success")return void El(this,E.value);const L=E.value.expression,$=r.aC(l,v.scope),j=v.options.get($);if(!j)return;let G;const{minValue:X,maxValue:Y,stepValue:ne,type:ve,values:_e}=x[l],Te=r.U(x[l].default);Te.result==="success"&&(G=Te.value.expression),G?(this.options.set($,{...j,value:L,default:G,minValue:X,maxValue:Y,stepValue:ne,type:ve,values:_e}),this.updateConfigDependencies(l)):this.fire(new r.y(new Error(`No schema defined for the config option "${l}" in the "${i}" fragment.`)))}getConfig(i){const l=this.getFragmentStyle(i);if(!l)return null;const m=l.stylesheet.schema;if(!m)return null;const v={};for(const x in m){const E=r.aC(x,l.scope),L=l.options.get(E),$=L?L.value||L.default:null;v[x]=$?$.serialize():null}return v}setConfig(i,l){const m=this.getFragmentStyle(i);m&&(m.updateConfig(l,m.stylesheet.schema),this.updateConfigDependencies())}getSchema(i){const l=this.getFragmentStyle(i);return l?l.stylesheet.schema:null}setSchema(i,l){const m=this.getFragmentStyle(i);m&&(m.stylesheet.schema=l,m.updateConfig(m._config,l),this.updateConfigDependencies())}updateConfig(i,l){if(this._config=i,i||l)if(l)for(const m in l){let v,x;const E=r.U(l[m].default);if(E.result==="success"&&(v=E.value.expression),i&&i[m]!==void 0){const Y=r.U(i[m]);Y.result==="success"&&(x=Y.value.expression)}const{minValue:L,maxValue:$,stepValue:j,type:G,values:X}=l[m];if(v){const Y=r.aC(m,this.scope);this.options.set(Y,{default:v,value:x,minValue:L,maxValue:$,stepValue:j,type:G,values:X})}else this.fire(new r.y(new Error(`No schema defined for config option "${m}".`)))}else this.fire(new r.y(new Error("Attempting to set config for a style without schema.")))}updateConfigDependencies(i){for(const l of this._configDependentLayers){const m=this.getLayer(l);if(m){if(i&&!m.configDependencies.has(i))continue;m.possiblyEvaluateVisibility(),this._updateLayer(m)}}this.ambientLight&&this.ambientLight.updateConfig(this.options),this.directionalLight&&this.directionalLight.updateConfig(this.options),this.fog&&this.fog.updateConfig(this.options),this.snow&&this.snow.updateConfig(this.options),this.rain&&this.rain.updateConfig(this.options),this.forEachFragmentStyle(l=>{const m=l._styleColorTheme.colorThemeOverride?l._styleColorTheme.colorThemeOverride:l._styleColorTheme.colorTheme;if(m){const v=l._evaluateColorThemeData(m);(!l._styleColorTheme.lut&&v!==""||l._styleColorTheme.lut&&v!==l._styleColorTheme.lut.data)&&l.setColorTheme(m)}}),this._changes.setDirty()}addLayer(i,l,m={}){this._checkLoaded();const v=i.id;if(this._layers[v])return void this.fire(new r.y(new Error(`Layer with id "${v}" already exists on this map`)));let x;if(i.type==="custom"){if(El(this,r.ct(i)))return;x=r.cu(i,this.scope,this._styleColorTheme.lut,this.options)}else{if(typeof i.source=="object"&&(this.addSource(v,i.source),i=r.cp(i),i=r.l(i,{source:v})),this._validate(ke,`layers.${v}`,i,{arrayIndex:-1},m))return;x=r.cu(i,this.scope,this._styleColorTheme.lut,this.options),this._validateLayer(x),x.setEventedParent(this,{layer:{id:v}})}x.configDependencies.size!==0&&this._configDependentLayers.add(x.fqid);let E=this._order.length;if(l){const G=this._order.indexOf(l);if(G===-1)return void this.fire(new r.y(new Error(`Layer with id "${l}" does not exist on this map.`)));x.slot===this._layers[l].slot?E=G:r.w(`Layer with id "${l}" has a different slot. Layers can only be rearranged within the same slot.`)}this._order.splice(E,0,v),this._layerOrderChanged=!0,this._layers[v]=x;const L=this.getOwnLayerSourceCache(x),$=!!this.directionalLight&&this.directionalLight.shadowsEnabled();L&&x.canCastShadows()&&$&&(L.castsShadows=!0);const j=this._changes.getRemovedLayer(x);if(j&&x.source&&L&&x.type!=="custom"){this._changes.discardLayerRemoval(x);const G=r.aC(x.source,x.scope);j.type!==x.type?this._changes.updateSourceCache(G,"clear"):(this._changes.updateSourceCache(G,"reload"),L.pause())}this._updateLayer(x),x.onAdd&&x.onAdd(this.map),x.scope=this.scope,this.mergeLayers()}moveLayer(i,l){this._checkLoaded();const m=this._checkLayer(i);if(!m||i===l)return;const v=this._order.indexOf(i);this._order.splice(v,1);let x=this._order.length;if(l){const E=this._order.indexOf(l);if(E===-1)return void this.fire(new r.y(new Error(`Layer with id "${l}" does not exist on this map.`)));m.slot===this._layers[l].slot?x=E:r.w(`Layer with id "${l}" has a different slot. Layers can only be rearranged within the same slot.`)}this._order.splice(x,0,i),this._changes.setDirty(),this._layerOrderChanged=!0,this.mergeLayers()}removeLayer(i){this._checkLoaded();const l=this._checkLayer(i);if(!l)return;l.setEventedParent(null);const m=this._order.indexOf(i);this._order.splice(m,1),delete this._layers[i],this._changes.setDirty(),this._layerOrderChanged=!0,this._configDependentLayers.delete(l.fqid),this._changes.removeLayer(l);const v=this.getOwnLayerSourceCache(l);if(v&&v.castsShadows){let x=!1;for(const E in this._layers)if(this._layers[E].source===l.source&&this._layers[E].canCastShadows()){x=!0;break}v.castsShadows=x}l.onRemove&&l.onRemove(this.map),this.mergeLayers()}getOwnLayer(i){return this._layers[i]}hasLayer(i){return i in this._mergedLayers}hasLayerType(i){for(const l in this._layers)if(this._layers[l].type===i)return!0;return!1}setLayerZoomRange(i,l,m){this._checkLoaded();const v=this._checkLayer(i);v&&(v.minzoom===l&&v.maxzoom===m||(l!=null&&(v.minzoom=l),m!=null&&(v.maxzoom=m),this._updateLayer(v)))}getSlots(){return this._checkLoaded(),this._mergedSlots}setSlot(i,l){this._checkLoaded();const m=this._checkLayer(i);m&&m.slot!==l&&(m.slot=l,this._updateLayer(m))}setFilter(i,l,m={}){this._checkLoaded();const v=this._checkLayer(i);if(v&&!r.bn(v.filter,l))return l==null?(v.filter=void 0,void this._updateLayer(v)):void(this._validate(He,`layers.${v.id}.filter`,l,{layerType:v.type},m)||(v.filter=r.cp(l),this._updateLayer(v)))}getFilter(i){const l=this._checkLayer(i);if(l)return r.cp(l.filter)}setLayoutProperty(i,l,m,v={}){this._checkLoaded();const x=this._checkLayer(i);if(x&&!r.bn(x.getLayoutProperty(l),m)){if(m!=null&&(!v||v.validate!==!1)&&El(x,ft.call(xi,{key:`layers.${i}.layout.${l}`,layerType:x.type,objectKey:l,value:m,styleSpec:r.a3,style:{glyphs:!0,sprite:!0}})))return;x.setLayoutProperty(l,m),x.configDependencies.size!==0&&this._configDependentLayers.add(x.fqid),this._updateLayer(x)}}getLayoutProperty(i,l){const m=this._checkLayer(i);if(m)return m.getLayoutProperty(l)}setPaintProperty(i,l,m,v={}){this._checkLoaded();const x=this._checkLayer(i);if(!x||r.bn(x.getPaintProperty(l),m)||m!=null&&(!v||v.validate!==!1)&&El(x,ut.call(xi,{key:`layers.${i}.paint.${l}`,layerType:x.type,objectKey:l,value:m,styleSpec:r.a3})))return;const E=x.setPaintProperty(l,m);x.configDependencies.size!==0&&this._configDependentLayers.add(x.fqid),E&&this._updateLayer(x),this._changes.updatePaintProperties(x)}getPaintProperty(i,l){const m=this._checkLayer(i);if(m)return m.getPaintProperty(l)}setFeatureState(i,l){if(this._checkLoaded(),"target"in i){if("featuresetId"in i.target){const{featuresetId:$,importId:j}=i.target,G=this.getFragmentStyle(j),X=G.getFeaturesetLayers($);for(const{source:Y,sourceLayer:ne}of X)G.setFeatureState({id:i.id,source:Y,sourceLayer:ne},l)}else if("layerId"in i.target){const{layerId:$}=i.target,j=this.getLayer($);this.setFeatureState({id:i.id,source:j.source,sourceLayer:j.sourceLayer},l)}return}const m=i.source,v=i.sourceLayer,x=this._checkSource(m);if(!x)return;const E=x.type;if(E==="geojson"&&v)return void this.fire(new r.y(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if(E==="vector"&&!v)return void this.fire(new r.y(new Error("The sourceLayer parameter must be provided for vector source types.")));i.id===void 0&&this.fire(new r.y(new Error("The feature id parameter must be provided.")));const L=this.getOwnSourceCaches(m);for(const $ of L)$.setFeatureState(v,i.id,l)}removeFeatureState(i,l){if(this._checkLoaded(),"target"in i){if("featuresetId"in i.target){const{featuresetId:$,importId:j}=i.target,G=this.getFragmentStyle(j),X=G.getFeaturesetLayers($);for(const{source:Y,sourceLayer:ne}of X)G.removeFeatureState({id:i.id,source:Y,sourceLayer:ne},l)}else if("layerId"in i.target){const{layerId:$}=i.target,j=this.getLayer($);this.removeFeatureState({id:i.id,source:j.source,sourceLayer:j.sourceLayer},l)}return}const m=i.source,v=this._checkSource(m);if(!v)return;const x=v.type,E=x==="vector"?i.sourceLayer:void 0;if(x==="vector"&&!E)return void this.fire(new r.y(new Error("The sourceLayer parameter must be provided for vector source types.")));if(l&&typeof i.id!="string"&&typeof i.id!="number")return void this.fire(new r.y(new Error("A feature id is required to remove its specific state property.")));const L=this.getOwnSourceCaches(m);for(const $ of L)$.removeFeatureState(E,i.id,l)}getFeatureState(i){if(this._checkLoaded(),"target"in i){let x;if("featuresetId"in i.target){const{featuresetId:E,importId:L}=i.target,$=this.getFragmentStyle(L),j=$.getFeaturesetLayers(E);for(const{source:G,sourceLayer:X}of j){const Y=$.getFeatureState({id:i.id,source:G,sourceLayer:X});if(Y&&!x)x=Y;else if(!r.bn(x,Y))return void this.fire(new r.y(new Error("The same feature id exists in multiple sources in the featureset, but their feature states are not consistent through the sources.")))}}else if("layerId"in i.target){const{layerId:E}=i.target,L=this.getLayer(E);x=this.getFeatureState({id:i.id,source:L.source,sourceLayer:L.sourceLayer})}return x}const l=i.source,m=i.sourceLayer,v=this._checkSource(l);if(v){if(v.type!=="vector"||m)return i.id===void 0&&this.fire(new r.y(new Error("The feature id parameter must be provided."))),this.getOwnSourceCaches(l)[0].getFeatureState(m,i.id);this.fire(new r.y(new Error("The sourceLayer parameter must be provided for vector source types.")))}}setTransition(i){return this.stylesheet.transition=r.l({},this.stylesheet.transition,i),this.transition=this.stylesheet.transition,this}getTransition(){return r.l({},this.stylesheet.transition)}serialize(){this._checkLoaded();const i=this.getTerrain(),l=i&&this.terrain&&this.terrain.scope===this.scope?i:this.stylesheet.terrain;return r.cv({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,fragment:this.stylesheet.fragment,imports:this._serializeImports(),schema:this.stylesheet.schema,camera:this.stylesheet.camera,light:this.stylesheet.light,lights:this.stylesheet.lights,terrain:l,fog:this.stylesheet.fog,snow:this.stylesheet.snow,rain:this.stylesheet.rain,center:this.stylesheet.center,"color-theme":this.stylesheet["color-theme"],zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:this._serializeSources(),layers:this._serializeLayers(this._order)},m=>m!==void 0)}_updateFilteredLayers(i){for(const l of Object.values(this._mergedLayers))i(l)&&this._updateLayer(l)}_updateLayer(i){this._changes.updateLayer(i);const l=this.getLayerSourceCache(i),m=r.aC(i.source,i.scope),v=this._changes.getUpdatedSourceCaches();i.source&&!v[m]&&l&&l.getSource().type!=="raster"&&(this._changes.updateSourceCache(m,"reload"),l.pause()),i.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(i){const l=L=>this._mergedLayers[L].is3D(),m=this.order,v={},x=[];for(let L=m.length-1;L>=0;L--){const $=m[L];if(l($)){v[$]=L;for(const j of i){const G=j[$];if(G)for(const X of G)x.push(X)}}}x.sort((L,$)=>$.intersectionZ-L.intersectionZ);const E=[];for(let L=m.length-1;L>=0;L--){const $=m[L];if(l($))for(let j=x.length-1;j>=0;j--){const G=x[j].feature;if(G.layer&&v[G.layer.id]<L)break;E.push(G),x.pop()}else for(const j of i){const G=j[$];if(G)for(const X of G)E.push(X.feature)}}return E}queryRenderedFeatures(i,l,m){let v;l&&!Array.isArray(l)&&l.filter&&(this._validate(He,"queryRenderedFeatures.filter",l.filter,null,l),v=r.aZ(l.filter));const x={},E=G=>{if(bg.has(G.type))return;const X=this.getOwnLayerSourceCache(G),Y=x[X.id]=x[X.id]||{sourceCache:X,layers:{},has3DLayers:!1};G.is3D()&&(Y.has3DLayers=!0),Y.layers[G.fqid]=Y.layers[G.fqid]||{styleLayer:G,targets:[]},Y.layers[G.fqid].targets.push({filter:v})};if(l&&l.layers){if(!Array.isArray(l.layers))return this.fire(new r.y(new Error("parameters.layers must be an Array."))),[];for(const G of l.layers){const X=this._layers[G];if(!X)return this.fire(new r.y(new Error(`The layer '${G}' does not exist in the map's style and cannot be queried for features.`))),[];E(X)}}else for(const G in this._layers)E(this._layers[G]);const L=this._queryRenderedFeatures(i,x,m),$=this._flattenAndSortRenderedFeatures(L),j=[];for(const G of $)r.cs(G.layer.id)===this.scope&&j.push(G);return j}queryRenderedFeatureset(i,l,m){let v;l&&!Array.isArray(l)&&l.filter&&(this._validate(He,"queryRenderedFeatures.filter",l.filter,null,l),v=r.aZ(l.filter));const x="mock",E=[];if(l&&l.target)E.push({...l,targetId:x,filter:v});else{const j=this.getFeaturesetDescriptors();for(const G of j)E.push({targetId:x,filter:v,target:G});for(const{style:G}of this.fragments){const X=G.getFeaturesetDescriptors();for(const Y of X)E.push({targetId:x,filter:v,target:Y})}}const L=this.queryRenderedTargets(i,E,m),$=[];for(const j of L)for(const G of j.variants[x])$.push(new r.cw(j,G));return $}queryRenderedTargets(i,l,m){const v={},x=(L,$,j,G)=>{const X=v[$.id]=v[$.id]||{sourceCache:$,layers:{},has3DLayers:!1};X.layers[L.fqid]=X.layers[L.fqid]||{styleLayer:L,targets:[]},L.is3D()&&(X.has3DLayers=!0),X.layers[L.fqid].targets.push(G?{...j,namespace:G.namespace,properties:G.properties}:j)};for(const L of l)if("featuresetId"in L.target){const{featuresetId:$,importId:j}=L.target,G=this.getFragmentStyle(j),X=G.featuresetSelectors[$];if(!X){this.fire(new r.y(new Error(`The featureset '${$}' does not exist in the map's style and cannot be queried for features.`)));continue}for(const Y of X){const ne=G.getOwnLayer(Y.layerId);ne&&!bg.has(ne.type)&&x(ne,G.getOwnLayerSourceCache(ne),L,Y)}}else if("layerId"in L.target){const{layerId:$}=L.target,j=this.getLayer($);if(!j||bg.has(j.type))continue;x(j,this.getLayerSourceCache(j),L)}const E=this._queryRenderedFeatures(i,v,m);return this._flattenAndSortRenderedFeatures(E)}_queryRenderedFeatures(i,l,m){const v=[],x=!!this.map._showQueryGeometry,E=bo.createFromScreenPoints(i,m);for(const L in l){const $=wv(E,l[L],this._availableImages,m,x);Object.keys($).length&&v.push($)}if(this.placement)for(const L in l){if(!l[L].sourceCache._onlySymbols)continue;const $=Dh(E.screenGeometry,l[L],this._availableImages,this.placement.collisionIndex,this.placement.retainedQueryData);Object.keys($).length&&v.push($)}return v}querySourceFeatures(i,l){const m=l&&l.filter;m&&this._validate(He,"querySourceFeatures.filter",m,null,l);let v=[];const x=this.getOwnSourceCaches(i);for(const E of x)v=v.concat(df(E,l));return v}addSourceType(i,l,m){return Pa.getSourceType(i)?m(new Error(`A source type called "${i}" already exists.`)):(Pa.setSourceType(i,l),l.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:i,url:l.workerSourceURL},m):m(null,null))}getFlatLight(){return this.light.getLight()}setFlatLight(i,l,m={}){this._checkLoaded();const v=this.light.getLight();let x=!1;for(const L in i)if(!r.bn(i[L],v[L])){x=!0;break}if(!x)return;const E=this._getTransitionParameters();this.light.setLight(i,l,m),this.light.updateTransitions(E)}getTerrain(){return this.terrain&&this.terrain.drapeRenderMode===1?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}checkCanvasFingerprintNoise(){this.disableElevatedTerrain===void 0&&(this.disableElevatedTerrain=r.q.hasCanvasFingerprintNoise(),this.disableElevatedTerrain&&r.w("Terrain and hillshade are disabled because of Canvas2D limitations when fingerprinting protection is enabled (e.g. in private browsing mode)."))}setTerrain(i,l=1){if(this._checkLoaded(),!i)return this.terrainSetForDrapingOnly()||(delete this.terrain,this.map.transform.projection.requiresDraping&&this.setTerrainForDraping()),l===0&&delete this.terrain,i===null?this.stylesheet.terrain=null:delete this.stylesheet.terrain,this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);this.checkCanvasFingerprintNoise();let m=i;const v=i.source==null;if(l===1){if(this.disableElevatedTerrain)return;if(typeof m.source=="object"){const L="terrain-dem-src";this.addSource(L,m.source),m=r.cp(m),m=r.l(m,{source:L})}const x=r.l({},m),E={};if(this.terrain&&v){x.source=this.terrain.get().source;const L=this.terrain?this.getFragmentStyle(this.terrain.scope):null;L&&(E.style=L.serialize())}if(this._validate(pi,"terrain",x,E))return}if(!this.terrain||this.terrain.scope!==this.scope&&!v||this.terrain&&l!==this.terrain.drapeRenderMode){if(!m)return;this._createTerrain(m,l),this.fire(new r.z("data",{dataType:"style"}))}else{const x=this.terrain,E=x.get();for(const L of Object.keys(r.a3.terrain))!m.hasOwnProperty(L)&&r.a3.terrain[L].default&&(m[L]=r.a3.terrain[L].default);for(const L in i)if(!r.bn(i[L],E[L])){x.set(i,this.options),this.stylesheet.terrain=i;const $=this._getTransitionParameters({duration:0});x.updateTransitions($),this.fire(new r.z("data",{dataType:"style"}));break}}this.mergeTerrain(),this.updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(i){const l=this.fog=new ei(i,this.map.transform,this.scope,this.options);this.stylesheet.fog=l.get();const m=this._getTransitionParameters({duration:0});l.updateTransitions(m)}_createSnow(i){const l=this.snow=new di(i,this.map.transform,this.scope,this.options);this.stylesheet.snow=l.get();const m=this._getTransitionParameters({duration:0});l.updateTransitions(m)}_createRain(i){const l=this.rain=new eo(i,this.map.transform,this.scope,this.options);this.stylesheet.rain=l.get();const m=this._getTransitionParameters({duration:0});l.updateTransitions(m)}_updateMarkersOpacity(){this.map._markers.length!==0&&this.map._requestDomTask(()=>{for(const i of this.map._markers)i._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(i){if(this._checkLoaded(),!i)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const l=this.fog;if(!r.bn(l.get(),i)){l.set(i,this.options),this.stylesheet.fog=l.get();const m=this._getTransitionParameters({duration:0});l.updateTransitions(m)}}else this._createFog(i);this._markersNeedUpdate=!0}getSnow(){return this.snow?this.snow.get():null}setSnow(i){if(this._checkLoaded(),!i)return delete this.snow,void delete this.stylesheet.snow;if(this.snow){const l=this.snow;if(!r.bn(l.get(),i)){l.set(i,this.options),this.stylesheet.snow=l.get();const m=this._getTransitionParameters({duration:0});l.updateTransitions(m)}}else this._createSnow(i);this._markersNeedUpdate=!0}getRain(){return this.rain?this.rain.get():null}setRain(i){if(this._checkLoaded(),!i)return delete this.rain,void delete this.stylesheet.rain;if(this.rain){const l=this.rain;if(!r.bn(l.get(),i)){l.set(i,this.options),this.stylesheet.rain=l.get();const m=this._getTransitionParameters({duration:0});l.updateTransitions(m)}}else this._createRain(i);this._markersNeedUpdate=!0}_reloadColorTheme(){const i=()=>{for(const v in this._layers)this._layers[v].lut=this._styleColorTheme.lut;for(const v in this._sourceCaches)this._sourceCaches[v].clearTiles()},l=this._styleColorTheme.colorThemeOverride?this._styleColorTheme.colorThemeOverride:this._styleColorTheme.colorTheme;if(!l)return this._styleColorTheme.lut=null,void i();const m=this._evaluateColorThemeData(l);this._loadColorTheme(m).then(()=>{this.fire(new r.z("colorthemeset")),i()}).catch(v=>{r.w(`Couldn't set color theme: ${v}`)})}setColorTheme(i){this._checkLoaded(),this._styleColorTheme.colorThemeOverride&&r.w("Note: setColorTheme is called on a style with a color-theme override, the passed color-theme won't be visible."),this._styleColorTheme.colorTheme=i,this._reloadColorTheme()}setImportColorTheme(i,l){const m=this.getFragmentStyle(i);m&&(m._styleColorTheme.colorThemeOverride=l,m._reloadColorTheme())}_getTransitionParameters(i){return{now:r.q.now(),transition:r.l(this.transition,i)}}updateDrapeFirstLayers(){if(!this.terrain)return;const i=[],l=[];for(const m of this._mergedOrder)this.isLayerDraped(this._mergedLayers[m])?i.push(m):l.push(m);this._drapedFirstOrder=[],this._drapedFirstOrder.push(...i),this._drapedFirstOrder.push(...l)}_createTerrain(i,l){const m=this.terrain=new yt(i,l,this.scope,this.options);l===1&&(this.stylesheet.terrain=i),this.mergeTerrain(),this.updateDrapeFirstLayers(),this._force3DLayerUpdate();const v=this._getTransitionParameters({duration:0});m.updateTransitions(v)}_force3DLayerUpdate(){for(const i in this._layers){const l=this._layers[i];l.type==="fill-extrusion"&&this._updateLayer(l)}}_forceSymbolLayerUpdate(){for(const i in this._layers){const l=this._layers[i];l.type==="symbol"&&this._updateLayer(l)}}_validate(i,l,m,v,x={}){if(x&&x.validate===!1)return!1;const E=r.l({},this.serialize());return El(this,i.call(xi,r.l({key:l,style:E,value:m,styleSpec:r.a3},v)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),r.cx.off("pluginStateChange",this._rtlTextPluginCallback);for(const i in this._mergedLayers)this._mergedLayers[i].setEventedParent(null);for(const i in this._mergedSourceCaches)this._mergedSourceCaches[i].clearTiles(),this._mergedSourceCaches[i].setEventedParent(null);this.setEventedParent(null),delete this.fog,delete this.snow,delete this.rain,delete this.terrain,delete this.ambientLight,delete this.directionalLight,this.isRootStyle()&&(this.imageManager.setEventedParent(null),this.modelManager.setEventedParent(null),this.dispatcher.remove())}clearSource(i){const l=this.getSourceCaches(i);for(const m of l)m.clearTiles()}clearSources(){for(const i in this._mergedSourceCaches)this._mergedSourceCaches[i].clearTiles()}reloadSource(i){const l=this.getSourceCaches(i);for(const m of l)m.resume(),m.reload()}reloadSources(){for(const i of this.getSources())i.reload&&i.reload()}updateSources(i){let l;this.directionalLight&&(l=cu(this.directionalLight));for(const m in this._mergedSourceCaches)this._mergedSourceCaches[m].update(i,void 0,void 0,l)}_generateCollisionBoxes(){for(const i in this._sourceCaches){const l=this._sourceCaches[i];l.resume(),l.reload()}}_updatePlacement(i,l,m,v,x,E,L=!1){let $=!1,j=!1;const G={},X={};for(const Y of this._mergedOrder){const ne=this._mergedLayers[Y];if(ne.type!=="symbol")continue;const ve=r.aC(ne.source,ne.scope);let _e=G[ve];if(!_e){const Ce=this.getLayerSourceCache(ne);if(!Ce)continue;const Re=Ce.getRenderableIds(!0).map(je=>Ce.getTileByID(je));X[ve]=Re.slice(),_e=G[ve]=Re.sort((je,Be)=>Be.tileID.overscaledZ-je.tileID.overscaledZ||(je.tileID.isLessThan(Be.tileID)?-1:1))}const Te=this.crossTileSymbolIndex.addLayer(ne,_e,l.center.lng,l.projection);$=$||Te}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._mergedOrder),L=L||this._layerOrderChanged||v===0,this._layerOrderChanged&&this.fire(new r.z("neworder")),(L||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(r.q.now(),l.zoom))&&(this.pauseablePlacement=new Kh(l,this._mergedOrder,L,m,v,x,this.placement,this.fog&&l.projection.supportsFog?this.fog.state:null,this._buildingIndex),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._mergedOrder,this._mergedLayers,G,X,this.map.painter.scaleFactor),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(r.q.now()),j=!0),$&&this.pauseablePlacement.placement.setStale()),j||$){this._buildingIndex.onNewFrame(l.zoom);for(let Y=0;Y<this._mergedOrder.length;Y++){const ne=this._mergedLayers[this._mergedOrder[Y]];if(ne.type!=="symbol")continue;const ve=this.isLayerClipped(ne);this.placement.updateLayerOpacities(ne,G[r.aC(ne.source,ne.scope)],Y,ve?E:null)}}return{needsRerender:!this.pauseablePlacement.isDone()||this.placement.hasTransitions(r.q.now())}}_releaseSymbolFadeTiles(){for(const i in this._sourceCaches)this._sourceCaches[i].releaseSymbolFadeTiles()}addImport(i,l){this._checkLoaded();const m=this.stylesheet.imports=this.stylesheet.imports||[];if(m.findIndex(({id:x})=>x===i.id)!==-1)return void this.fire(new r.y(new Error(`Import with id '${i.id}' already exists in the map's style.`)));if(!l)return m.push(i),this._loadImports([i],!0);const v=m.findIndex(({id:x})=>x===l);return v===-1&&this.fire(new r.y(new Error(`Import with id "${l}" does not exist on this map.`))),this.stylesheet.imports=m.slice(0,v).concat(i).concat(m.slice(v)),this._loadImports([i],!0,l)}updateImport(i,l){this._checkLoaded();const m=this.stylesheet.imports||[],v=this.getImportIndex(i);return v===-1?this:typeof l=="string"?(this.setImportUrl(i,l),this):(l.url&&l.url!==m[v].url&&this.setImportUrl(i,l.url),r.bn(l.config,m[v].config)||this.setImportConfig(i,l.config),r.bn(l.data,m[v].data)||this.setImportData(i,l.data),this)}moveImport(i,l){this._checkLoaded();let m=this.stylesheet.imports||[];const v=this.getImportIndex(i);if(v===-1)return this;const x=this.getImportIndex(l);if(x===-1)return this;const E=m[v],L=this.fragments[v];return m=m.filter(({id:$})=>$!==i),this.fragments=this.fragments.filter(({id:$})=>$!==i),this.stylesheet.imports=m.slice(0,x).concat(E).concat(m.slice(x)),this.fragments=this.fragments.slice(0,x).concat(L).concat(this.fragments.slice(x)),this.mergeLayers(),this}setImportUrl(i,l){this._checkLoaded();const m=this.stylesheet.imports||[],v=this.getImportIndex(i);if(v===-1)return this;m[v].url=l;const x=this.fragments[v];return x.style=this._createFragmentStyle(m[v]),x.style.on("style.import.load",()=>this.mergeAll()),x.style.loadURL(l),this}setImportData(i,l){this._checkLoaded();const m=this.getImportIndex(i),v=this.stylesheet.imports||[];return m===-1?this:l?(this.fragments[m].style.setState(l),this._reloadImports(),this):(delete v[m].data,this.setImportUrl(i,v[m].url))}setImportConfig(i,l){this._checkLoaded();const m=this.getImportIndex(i),v=this.stylesheet.imports||[];if(m===-1)return this;l?v[m].config=l:delete v[m].config;const x=this.fragments[m],E=x.style.stylesheet&&x.style.stylesheet.schema;return x.config=l,x.style.updateConfig(l,E),this.updateConfigDependencies(),this}removeImport(i){this._checkLoaded();const l=this.stylesheet.imports||[],m=this.getImportIndex(i);m!==-1&&(l.splice(m,1),this.fragments[m].style._remove(),this.fragments.splice(m,1),this._reloadImports())}getImportIndex(i){const l=(this.stylesheet.imports||[]).findIndex(m=>m.id===i);return l===-1&&this.fire(new r.y(new Error(`Import '${i}' does not exist in the map's style and cannot be updated.`))),l}getLayer(i){return this._mergedLayers[i]}getSources(){const i=[];for(const l in this._mergedOtherSourceCaches){const m=this._mergedOtherSourceCaches[l];m&&i.push(m.getSource())}return i}getSource(i,l){const m=this.getSourceCache(i,l);return m&&m.getSource()}getLayerSource(i){const l=this.getLayerSourceCache(i);return l&&l.getSource()}getSourceCache(i,l){const m=r.aC(i,l);return this._mergedOtherSourceCaches[m]}getLayerSourceCache(i){const l=r.aC(i.source,i.scope);return i.type==="symbol"?this._mergedSymbolSourceCaches[l]:this._mergedOtherSourceCaches[l]}getSourceCaches(i){if(i==null)return Object.values(this._mergedSourceCaches);const l=[];return this._mergedOtherSourceCaches[i]&&l.push(this._mergedOtherSourceCaches[i]),this._mergedSymbolSourceCaches[i]&&l.push(this._mergedSymbolSourceCaches[i]),l}updateSourceCaches(){const i=this._changes.getUpdatedSourceCaches();for(const l in i){const m=i[l];m==="reload"?this.reloadSource(l):m==="clear"&&this.clearSource(l)}}updateLayers(i){const l=this._changes.getUpdatedPaintProperties();for(const m of l){const v=this.getLayer(m);v&&v.updateTransitions(i)}}getImages(i,l,m){this.imageManager.getImages(l.icons,l.scope,m),this._updateTilesForChangedImages();const v=x=>{x&&x.setDependencies(l.tileID.key,l.type,l.icons)};v(this._otherSourceCaches[l.source]),v(this._symbolSourceCaches[l.source])}rasterizeImages(i,l,m){this.imageManager.rasterizeImages(l,m)}getGlyphs(i,l,m){this.glyphManager.getGlyphs(l.stacks,l.scope,m)}getResource(i,l,m){return r.cy(l,m)}getOwnSourceCache(i){return this._otherSourceCaches[i]}getOwnLayerSourceCache(i){return i.type==="symbol"?this._symbolSourceCaches[i.source]:this._otherSourceCaches[i.source]}getOwnSourceCaches(i){const l=[];return this._otherSourceCaches[i]&&l.push(this._otherSourceCaches[i]),this._symbolSourceCaches[i]&&l.push(this._symbolSourceCaches[i]),l}_isSourceCacheLoaded(i){const l=this.getOwnSourceCaches(i);return l.length===0?(this.fire(new r.y(new Error(`There is no source with ID '${i}'`))),!1):l.every(m=>m.loaded())}has3DLayers(){return this._has3DLayers}hasSymbolLayers(){return this._hasSymbolLayers}hasCircleLayers(){return this._hasCircleLayers}isLayerClipped(i,l){if(!this._clipLayerPresent&&i.type!=="fill-extrusion")return!1;const m=i.type==="fill-extrusion"&&i.sourceLayer==="building";if(i.is3D()){if(m||l&&l.type==="batched-model"||i.type==="model")return!0}else if(i.type==="symbol")return!0;return!1}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.fragments.forEach(i=>{i.style._remove()}),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}Pa.getSourceType=function(h){return Zu[h]},Pa.setSourceType=function(h,i){Zu[h]=i},Pa.registerForPluginStateChange=r.ch;var bf=`
#define EPSILON 0.0000001
#define PI 3.141592653589793
#ifdef RENDER_CUTOFF
float cutoff_opacity(vec4 cutoff_params,float depth) {float near=cutoff_params.x;float far=cutoff_params.y;float cutoffStart=cutoff_params.z;float cutoffEnd=cutoff_params.w;float linearDepth=(depth-near)/(far-near);return clamp((linearDepth-cutoffStart)/(cutoffEnd-cutoffStart),0.0,1.0);}
#endif`,Lv=`
out vec4 glFragColor;highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}
#ifdef INDICATOR_CUTOUT
uniform vec3 u_indicator_cutout_centers;uniform vec4 u_indicator_cutout_params;
#endif
vec4 applyCutout(vec4 color,float height) {
#ifdef INDICATOR_CUTOUT
float verticalFadeRange=u_indicator_cutout_centers.z*0.25;float holeMinOpacity=mix(1.0,u_indicator_cutout_params.x,smoothstep(u_indicator_cutout_centers.z,u_indicator_cutout_centers.z+verticalFadeRange,height));float holeRadius=max(u_indicator_cutout_params.y,0.0);float holeAspectRatio=u_indicator_cutout_params.z;float fadeStart=u_indicator_cutout_params.w;float distA=distance(vec2(gl_FragCoord.x,gl_FragCoord.y*holeAspectRatio),vec2(u_indicator_cutout_centers[0],u_indicator_cutout_centers[1]*holeAspectRatio));return color*min(smoothstep(fadeStart,holeRadius,distA)+holeMinOpacity,1.0);
#else
return color;
#endif
}
#ifdef DEBUG_WIREFRAME
#define HANDLE_WIREFRAME_DEBUG \\
glFragColor=vec4(0.7,0.0,0.0,0.7); \\
gl_FragDepth=gl_FragCoord.z-0.0001;
#else
#define HANDLE_WIREFRAME_DEBUG
#endif
#ifdef RENDER_CUTOFF
uniform highp vec4 u_cutoff_params;in float v_cutoff_opacity;
#endif
vec4 textureLodCustom(sampler2D image,highp vec2 pos,highp vec2 lod_coord) {highp vec2 size=vec2(textureSize(image,0));highp vec2 dx=dFdx(lod_coord.xy*size);highp vec2 dy=dFdy(lod_coord.xy*size);highp float delta_max_sqr=max(dot(dx,dx),dot(dy,dy));highp float lod=0.5*log2(delta_max_sqr);return textureLod(image,pos,lod);}vec4 applyLUT(highp sampler3D lut,vec4 col) {vec3 size=vec3(textureSize(lut,0));vec3 uvw=(col.rbg*float(size-1.0)+0.5)/size;return vec4(texture(lut,uvw).rgb,col.a);}vec3 applyLUT(highp sampler3D lut,vec3 col) {return applyLUT(lut,vec4(col,1.0)).rgb;}`,wg=`
#define EXTENT 8192.0
#define RAD_TO_DEG 180.0/PI
#define DEG_TO_RAD PI/180.0
#define GLOBE_RADIUS EXTENT/PI/2.0
float wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}
#ifdef PROJECTION_GLOBE_VIEW
vec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {
#ifndef PROJECTED_POS_ON_VIEWPORT
float tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;
#else
return vec3(0.0);
#endif
}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(
unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const vec2 units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (units_to_pixels*pos+offset)/pattern_size;}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {return get_pattern_pos(pixel_coord_upper,pixel_coord_lower,pattern_size,vec2(tile_units_to_pixels),pos);}float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(PI/4.0+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}
#ifdef RENDER_CUTOFF
uniform vec4 u_cutoff_params;out float v_cutoff_opacity;
#endif
const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);const float skirtOffset=24575.0;vec3 decomposeToPosAndSkirt(vec2 posWithComposedSkirt)
{float skirt=float(posWithComposedSkirt.x >=skirtOffset);vec2 pos=posWithComposedSkirt-vec2(skirt*skirtOffset,0.0);return vec3(pos,skirt);}`,tp="in highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;out highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",xf=`
#define ELEVATION_SCALE 7.0
#define ELEVATION_OFFSET 450.0
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(
mix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}
#else
vec3 elevationVector(vec2 pos) { return vec3(0,0,1); }
#endif
#ifdef TERRAIN
uniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float currentElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem,pos).r;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(dd,0)).r;float bl=texture(u_dem,pos+vec2(0,dd)).r;float br=texture(u_dem,pos+vec2(dd,dd)).r;return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}float prevElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem_prev,pos).r;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=texture(u_dem_prev,pos).r;float tr=texture(u_dem_prev,pos+vec2(dd,0)).r;float bl=texture(u_dem_prev,pos+vec2(0,dd)).r;float br=texture(u_dem_prev,pos+vec2(dd,dd)).r;return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}
#ifdef TERRAIN_VERTEX_MORPHING
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
float nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}
#else
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
return currentElevation(apos);}
#endif
vec4 fourSample(vec2 pos,vec2 off) {float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(off.x,0.0)).r;float bl=texture(u_dem,pos+vec2(0.0,off.y)).r;float br=texture(u_dem,pos+off).r;return vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}
#else
float elevation(vec2 pos) { return 0.0; }
#endif
#ifdef DEPTH_OCCLUSION
uniform highp sampler2D u_depth;uniform highp vec2 u_depth_size_inv;uniform highp vec2 u_depth_range_unpack;uniform highp float u_occluder_half_size;uniform highp float u_occlusion_depth_offset;
#ifdef DEPTH_D24
float unpack_depth(float depth) {return depth*u_depth_range_unpack.x+u_depth_range_unpack.y;}vec4 unpack_depth4(vec4 depth) {return depth*u_depth_range_unpack.x+vec4(u_depth_range_unpack.y);}
#else
highp float unpack_depth_rgba(vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}
#endif
bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;
#ifdef DEPTH_D24
float depth=unpack_depth(texture(u_depth,(coord.xy+1.0)*0.5).r);
#else
float depth=unpack_depth_rgba(texture(u_depth,(coord.xy+1.0)*0.5));
#endif
return coord.z+u_occlusion_depth_offset > depth;}highp vec4 getCornerDepths(vec2 coord) {highp vec3 df=vec3(u_occluder_half_size*u_depth_size_inv,0.0);highp vec2 uv=0.5*coord.xy+0.5;
#ifdef DEPTH_D24
highp vec4 depth=vec4(
texture(u_depth,uv-df.xz).r,texture(u_depth,uv+df.xz).r,texture(u_depth,uv-df.zy).r,texture(u_depth,uv+df.zy).r
);depth=unpack_depth4(depth);
#else
highp vec4 depth=vec4(
unpack_depth_rgba(texture(u_depth,uv-df.xz)),unpack_depth_rgba(texture(u_depth,uv+df.xz)),unpack_depth_rgba(texture(u_depth,uv-df.zy)),unpack_depth_rgba(texture(u_depth,uv+df.zy))
);
#endif
return depth;}highp float occlusionFadeMultiSample(vec4 frag) {highp vec3 coord=frag.xyz/frag.w;highp vec2 uv=0.5*coord.xy+0.5;int NX=3;int NY=4;highp vec2 df=u_occluder_half_size*u_depth_size_inv;highp vec2 oneStep=2.0*u_occluder_half_size*u_depth_size_inv/vec2(NX-1,NY-1);highp float res=0.0;for (int y=0; y < NY;++y) {for (int x=0; x < NX;++x) {
#ifdef DEPTH_D24
highp float depth=unpack_depth(texture(u_depth,uv-df+vec2(float(x)*oneStep.x,float(y)*oneStep.y)).r);
#else
highp float depth=unpack_depth_rgba(texture(u_depth,uv-df+vec2(float(x)*oneStep.x,float(y)*oneStep.y)));
#endif
res+=1.0-clamp(300.0*(coord.z+u_occlusion_depth_offset-depth),0.0,1.0);}}res=clamp(2.0*res/float(NX*NY)-0.5,0.0,1.0);return res;}highp float occlusionFade(vec4 frag) {highp vec3 coord=frag.xyz/frag.w;highp vec4 depth=getCornerDepths(coord.xy);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z+u_occlusion_depth_offset)-depth),0.0,1.0));}
#else
bool isOccluded(vec4 frag) { return false; }highp float occlusionFade(vec4 frag) { return 1.0; }highp float occlusionFadeMultiSample(vec4 frag) { return 1.0; }
#endif//DEPTH_OCCLUSION`,np=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;out vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}
#endif`,du=`highp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}
#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump vec2 u_fog_vertical_limit;uniform mediump float u_fog_temporal_offset;in vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos,float opacity_limit) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,min(opacity,opacity_limit));}vec3 fog_apply(vec3 color,vec3 pos) {return fog_apply(color,pos,1.0);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec4 fog_apply_premultiplied(vec4 color,vec3 pos,float heightMeters) {float verticalProgress=(u_fog_vertical_limit.x > 0.0 || u_fog_vertical_limit.y > 0.0) ? smoothstep(u_fog_vertical_limit.x,u_fog_vertical_limit.y,heightMeters) : 0.0;float opacityLimit=1.0-smoothstep(0.9,1.0,fog_opacity(pos));return mix(fog_apply_premultiplied(color,pos),color,min(verticalProgress,opacityLimit));}vec3 fog_dither(vec3 color) {
#ifdef FOG_DITHERING
vec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);
#else
return color;
#endif
}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}
#endif`,rp=`#ifdef RASTER_ARRAY
uniform highp sampler2D u_image0;uniform sampler2D u_image1;const vec4 NODATA=vec4(1);ivec4 _raTexLinearCoord(highp vec2 texCoord,highp vec2 texResolution,out highp vec2 fxy) {texCoord=texCoord*texResolution-0.5;fxy=fract(texCoord);texCoord-=fxy;return ivec4(texCoord.xxyy+vec2(1.5,0.5).xyxy);}vec2 _raTexLinearMix(highp vec2 fxy,highp vec4 colorMix,highp float colorOffset,highp vec4 t00,highp vec4 t10,highp vec4 t01,highp vec4 t11) {vec2 c00=t00==NODATA ? vec2(0) : vec2(colorOffset+dot(t00,colorMix),1);vec2 c10=t10==NODATA ? vec2(0) : vec2(colorOffset+dot(t10,colorMix),1);vec2 c01=t01==NODATA ? vec2(0) : vec2(colorOffset+dot(t01,colorMix),1);vec2 c11=t11==NODATA ? vec2(0) : vec2(colorOffset+dot(t11,colorMix),1);return mix(mix(c01,c11,fxy.x),mix(c00,c10,fxy.x),fxy.y);}vec2 raTexture2D_image0_linear(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec2 fxy;ivec4 c=_raTexLinearCoord(texCoord,texResolution,fxy);return _raTexLinearMix(fxy,colorMix,colorOffset,texelFetch(u_image0,c.yz,0),texelFetch(u_image0,c.xz,0),texelFetch(u_image0,c.yw,0),texelFetch(u_image0,c.xw,0)
);}vec2 raTexture2D_image1_linear(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec2 fxy;ivec4 c=_raTexLinearCoord(texCoord,texResolution,fxy);return _raTexLinearMix(fxy,colorMix,colorOffset,texelFetch(u_image1,c.yz,0),texelFetch(u_image1,c.xz,0),texelFetch(u_image1,c.yw,0),texelFetch(u_image1,c.xw,0)
);}vec2 raTexture2D_image0_nearest(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec4 t=texelFetch(u_image0,ivec2(texCoord*texResolution),0);return t==NODATA ? vec2(0) : vec2(colorOffset+dot(t,colorMix),1);}vec2 raTexture2D_image1_nearest(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec4 t=texelFetch(u_image1,ivec2(texCoord*texResolution),0);return t==NODATA ? vec2(0) : vec2(colorOffset+dot(t,colorMix),1);}
#endif`,Sg=`#ifdef RASTER_ARRAY
uniform sampler2D u_velocity;uniform mediump vec2 u_velocity_res;uniform mediump float u_max_speed;const vec4 NO_DATA=vec4(1);const vec2 INVALID_VELOCITY=vec2(-1);uniform highp vec2 u_uv_offset;uniform highp float u_data_offset;uniform highp vec2 u_data_scale;ivec4 rasterArrayLinearCoord(highp vec2 texCoord,highp vec2 texResolution,out highp vec2 fxy) {texCoord=texCoord*texResolution-0.5;fxy=fract(texCoord);texCoord-=fxy;return ivec4(texCoord.xxyy+vec2(1.5,0.5).xyxy);}highp vec2 lookup_velocity(highp vec2 uv) {uv=u_uv_offset.x+u_uv_offset.y*uv;highp vec2 fxy;ivec4 c=rasterArrayLinearCoord(uv,u_velocity_res,fxy);highp vec4 tl=texelFetch(u_velocity,c.yz,0);highp vec4 tr=texelFetch(u_velocity,c.xz,0);highp vec4 bl=texelFetch(u_velocity,c.yw,0);highp vec4 br=texelFetch(u_velocity,c.xw,0);if (tl==NO_DATA) {return INVALID_VELOCITY;}if (tr==NO_DATA) {return INVALID_VELOCITY;}if (bl==NO_DATA) {return INVALID_VELOCITY;}if (br==NO_DATA) {return INVALID_VELOCITY;}highp vec4 t=mix(mix(bl,br,fxy.x),mix(tl,tr,fxy.x),fxy.y);highp vec2 velocity=u_data_offset+vec2(dot(t.rg,u_data_scale),dot(t.ba,u_data_scale));velocity.y=-velocity.y;velocity/=max(u_max_speed,length(velocity));return velocity;}
#endif
uniform highp float u_particle_pos_scale;uniform highp vec2 u_particle_pos_offset;highp vec4 pack_pos_to_rgba(highp vec2 p) {highp vec2 v=(p+u_particle_pos_offset)/u_particle_pos_scale;highp vec4 r=vec4(v.x,fract(v.x*255.0),v.y,fract(v.y*255.0));return vec4(r.x-r.y/255.0,r.y,r.z-r.w/255.0,r.w);}highp vec2 unpack_pos_from_rgba(highp vec4 v) {v=floor(v*255.0+0.5)/255.0;highp vec2 p=vec2(v.x+(v.y/255.0),v.z+(v.w/255.0));return u_particle_pos_scale*p-u_particle_pos_offset;}`,tc=`#ifdef RENDER_SHADOWS
uniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_normal_offset;vec3 shadow_normal_offset(vec3 normal) {float tileInMeters=u_shadow_normal_offset[0];vec3 n=vec3(-normal.xy,tileInMeters*normal.z);float dotScale=min(1.0-dot(normal,u_shadow_direction),1.0)*0.5+0.5;return n*dotScale;}vec3 shadow_normal_offset_model(vec3 normal) {vec3 transformed_normal=vec3(-normal.xy,normal.z);float NDotL=dot(normalize(transformed_normal),u_shadow_direction);float dotScale=min(1.0-NDotL,1.0)*0.5+0.5;return normal*dotScale;}float shadow_normal_offset_multiplier0() {return u_shadow_normal_offset[1];}float shadow_normal_offset_multiplier1() {return u_shadow_normal_offset[2];}
#endif//RENDER_SHADOWS`,Xc=`#ifdef RENDER_SHADOWS
#ifdef DEPTH_TEXTURE
uniform highp sampler2D u_shadowmap_0;uniform highp sampler2D u_shadowmap_1;
#else
uniform sampler2D u_shadowmap_0;uniform sampler2D u_shadowmap_1;
#endif
uniform float u_shadow_intensity;uniform float u_shadow_map_resolution;uniform float u_shadow_texel_size;uniform highp vec3 u_shadow_normal_offset;uniform vec2 u_fade_range;uniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_bias;highp float shadow_sample_1(highp vec2 uv,highp float compare) {highp float shadow_depth;
#ifdef DEPTH_TEXTURE
shadow_depth=texture(u_shadowmap_1,uv).r;
#else
shadow_depth=unpack_depth(texture(u_shadowmap_1,uv))*0.5+0.5;
#endif
return step(shadow_depth,compare);}highp float shadow_sample_0(highp vec2 uv,highp float compare) {highp float shadow_depth;
#ifdef DEPTH_TEXTURE
shadow_depth=texture(u_shadowmap_0,uv).r;
#else
shadow_depth=unpack_depth(texture(u_shadowmap_0,uv))*0.5+0.5;
#endif
return step(shadow_depth,compare);}float shadow_occlusion_1(highp vec4 pos,highp float bias) {highp vec2 uv=pos.xy;return shadow_sample_1(uv,pos.z-bias);}float shadow_occlusion_0(highp vec4 pos,highp float bias) {highp float compare0=pos.z-bias;
#ifdef TEXTURE_GATHER
highp vec2 uv=pos.xy;highp vec4 samples=textureGather(u_shadowmap_0,uv,0);lowp vec4 stepSamples=step(samples,vec4(compare0));
#else
highp vec2 uv00=pos.xy-vec2(0.5*u_shadow_texel_size);highp vec2 uv10=uv00+vec2(u_shadow_texel_size,0.0);highp vec2 uv01=uv00+vec2(0.0,u_shadow_texel_size);highp vec2 uv11=uv01+vec2(u_shadow_texel_size,0.0);lowp vec4 stepSamples=vec4(
shadow_sample_0(uv01,compare0),shadow_sample_0(uv11,compare0),shadow_sample_0(uv10,compare0),shadow_sample_0(uv00,compare0)
);
#endif
vec2 f=fract(pos.xy*u_shadow_map_resolution-vec2(0.5));lowp vec2 lerpx=mix(stepSamples.wx,stepSamples.zy,f.xx);return mix(lerpx.x,lerpx.y,f.y);}float shadow_occlusion(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth,highp float bias) {
#ifdef SHADOWS_SINGLE_CASCADE
light_view_pos0.xyz/=light_view_pos0.w;vec2 abs_bounds=abs(light_view_pos0.xy);if (abs_bounds.x >=1.0 || abs_bounds.y >=1.0) {return 0.0;}light_view_pos0.xyz=light_view_pos0.xyz*0.5+0.5;return shadow_occlusion_0(light_view_pos0,bias);
#else
light_view_pos0.xyz/=light_view_pos0.w;light_view_pos1.xyz/=light_view_pos1.w;vec4 uv=vec4(light_view_pos0.xy,light_view_pos1.xy);vec4 abs_bounds=abs(uv);if (abs_bounds.x < 1.0 && abs_bounds.y < 1.0) {light_view_pos0.xyz=light_view_pos0.xyz*0.5+0.5;return shadow_occlusion_0(light_view_pos0,bias);}if (abs_bounds.z >=1.0 || abs_bounds.w >=1.0) {return 0.0;}light_view_pos1.xyz=light_view_pos1.xyz*0.5+0.5;float occlusion1=shadow_occlusion_1(light_view_pos1,bias);return mix(occlusion1,0.0,smoothstep(u_fade_range.x,u_fade_range.y,view_depth));
#endif
}highp float calculate_shadow_bias(float NDotL) {
#ifdef NORMAL_OFFSET
return 0.5*u_shadow_bias.x;
#else
return 0.5*(u_shadow_bias.x+clamp(u_shadow_bias.y*tan(acos(NDotL)),0.0,u_shadow_bias.z));
#endif
}float shadowed_light_factor_normal(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=calculate_shadow_bias(NDotL);float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor_normal_opacity(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth,float shadow_opacity) {float NDotL=dot(N,u_shadow_direction);float bias=calculate_shadow_bias(NDotL);float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias)*shadow_opacity;return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor_normal_unbiased(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}highp vec2 compute_receiver_plane_depth_bias(highp vec3 pos_dx,highp vec3 pos_dy)
{highp vec2 biasUV=vec2(
pos_dy.y*pos_dx.z-pos_dx.y*pos_dy.z,pos_dx.x*pos_dy.z-pos_dy.x*pos_dx.z);biasUV*=1.0/((pos_dx.x*pos_dy.y)-(pos_dx.y*pos_dy.x));return biasUV;}float shadowed_light_factor_plane_bias(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {highp vec3 light_view_pos0_xyz=light_view_pos0.xyz/light_view_pos0.w*0.5+0.5;highp vec3 light_view_pos0_ddx=dFdx(light_view_pos0_xyz);highp vec3 light_view_pos0_ddy=dFdy(light_view_pos0_xyz);highp vec2 plane_depth_bias=compute_receiver_plane_depth_bias(light_view_pos0_ddx,light_view_pos0_ddy);highp float bias=dot(vec2(u_shadow_texel_size,u_shadow_texel_size),plane_depth_bias)+0.0001;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return 1.0-(u_shadow_intensity*occlusion);}float shadowed_light_factor(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return 1.0-(u_shadow_intensity*occlusion);}float shadow_occlusion(float ndotl,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=calculate_shadow_bias(ndotl);return shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);}
#endif`;const nc=[];fu(bf,nc),fu(wg,nc),fu(Lv,nc);const rc={"_prelude_fog.vertex.glsl":np,"_prelude_terrain.vertex.glsl":xf,"_prelude_shadow.vertex.glsl":tc,"_prelude_fog.fragment.glsl":du,"_prelude_shadow.fragment.glsl":Xc,"_prelude_lighting.glsl":`
#ifdef LIGHTING_3D_MODE
uniform mediump vec3 u_lighting_ambient_color;uniform mediump vec3 u_lighting_directional_dir;uniform mediump vec3 u_lighting_directional_color;uniform mediump vec3 u_ground_radiance;float calculate_ambient_directional_factor(vec3 normal) {float NdotL=dot(normal,u_lighting_directional_dir);const float factor_reduction_max=0.3;float dir_luminance=dot(u_lighting_directional_color,vec3(0.2126,0.7152,0.0722));float directional_factor_min=1.0-factor_reduction_max*min(dir_luminance,1.0);float ambient_directional_factor=mix(directional_factor_min,1.0,min((NdotL+1.0),1.0));const float vertical_factor_min=0.92;float vertical_factor=mix(vertical_factor_min,1.0,normal.z*0.5+0.5);return vertical_factor*ambient_directional_factor;}vec3 linearProduct(vec3 srgbIn,vec3 k) {return srgbIn*pow(k,vec3(1./2.2));}vec3 apply_lighting(vec3 color,vec3 normal,float dir_factor) {float ambient_directional_factor=calculate_ambient_directional_factor(normal);vec3 ambient_contrib=ambient_directional_factor*u_lighting_ambient_color;vec3 directional_contrib=u_lighting_directional_color*dir_factor;return linearProduct(color,ambient_contrib+directional_contrib);}vec4 apply_lighting(vec4 color,vec3 normal,float dir_factor) {return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting(vec3 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return apply_lighting(color.rgb,normal,dir_factor);}vec4 apply_lighting(vec4 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting_ground(vec3 color) {return color*u_ground_radiance;}vec4 apply_lighting_ground(vec4 color) {return vec4(apply_lighting_ground(color.rgb),color.a);}float calculate_NdotL(vec3 normal) {const float ext=0.70710678118;return (clamp(dot(normal,u_lighting_directional_dir),-ext,1.0)+ext)/(1.0+ext);}vec4 apply_lighting_with_emission_ground(vec4 color,float emissive_strength) {return mix(apply_lighting_ground(color),color,emissive_strength);}vec3 compute_flood_lighting(vec3 flood_light_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=flood_light_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);float occlusion_ramp=smoothstep(0.0,0.2,1.0-occlusion);return mix(fully_occluded_color,flood_light_color,occlusion_ramp);}vec3 compute_emissive_draped(vec3 unlit_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=unlit_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);return mix(fully_occluded_color,unlit_color,1.0-occlusion);}
#endif//LIGHTING_3D_MODE`,"_prelude_raster_array.glsl":rp,"_prelude_raster_particle.glsl":Sg},Ml={};jr("",xf),jr(du,np),jr(Xc,tc),jr(rp,""),jr(Sg,"");const wf=jr(Lv,wg),ip=bf;var Tg={background:jr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec4 u_color;uniform float u_opacity;
#ifdef LIGHTING_3D_MODE
in vec4 v_color;
#endif
void main() {vec4 out_color;
#ifdef LIGHTING_3D_MODE
out_color=v_color;
#else
out_color=u_color;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_lighting.glsl"
in vec2 a_pos;uniform mat4 u_matrix;
#ifdef LIGHTING_3D_MODE
uniform mediump vec4 u_color;out vec4 v_color;uniform float u_emissive_strength;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef LIGHTING_3D_MODE
v_color=apply_lighting_with_emission_ground(u_color,u_emissive_strength);
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),backgroundPattern:jr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform float u_emissive_strength;uniform sampler2D u_image;in highp vec2 v_pos;void main() {highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=textureLodCustom(u_image,pos,v_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec2 u_pattern_units_to_pixels;in vec2 a_pos;out highp vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_pattern_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),circle:jr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
in vec3 v_data;in float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
uniform float u_emissive_strength;void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float blur_positive=blur < 0.0 ? 0.0 : 1.0;lowp float antialiasblur=v_data.z;float extrude_length=length(extrude)+antialiasblur*(1.0-blur_positive);float antialiased_blur=-max(abs(blur),antialiasblur);float opacity_t=smoothstep((1.0-blur_positive)*antialiased_blur,blur_positive*antialiased_blur,extrude_length-1.0)-smoothstep(0.0,antialiasblur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(
antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)
);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_apply_premultiplied(out_color,v_fog_pos);
#endif
glFragColor=out_color*(v_visibility*opacity_t);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define NUM_VISIBILITY_RINGS 2
#define INV_SQRT2 0.70710678
#define ELEVATION_BIAS 0.0001
#define NUM_SAMPLES_PER_RING 16
uniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
out vec3 v_data;out float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
vec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {
#if defined(TERRAIN)
return elevation(pos)+ELEVATION_BIAS;
#else
return 0.0;
#endif
}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);
#ifdef PITCH_WITH_MAP
#ifdef PROJECTION_GLOBE_VIEW
return u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );
#else
return u_matrix*( world_center+vec4(sample_offset,0,0) );
#endif
#else
return projected_center+vec4(sample_offset,0,0);
#endif
}float get_sample_step() {
#ifdef PITCH_WITH_MAP
return 2.0*PI/float(NUM_SAMPLES_PER_RING);
#else
return PI/float(NUM_SAMPLES_PER_RING);
#endif
}void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);
#else 
surface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);
#endif
vec4 projected_center=u_matrix*world_center;float view_scale=0.0;
#ifdef PITCH_WITH_MAP
#ifdef SCALE_WITH_MAP
view_scale=1.0;
#else
view_scale=projected_center.w/u_camera_to_center_distance;
#endif
#else
#ifdef SCALE_WITH_MAP
view_scale=u_camera_to_center_distance;
#else
view_scale=projected_center.w;
#endif
#endif
gl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;
#ifdef TERRAIN
float step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;
#ifdef PITCH_WITH_MAP
float cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;
#else
occlusion_world_center=world_center;occlusion_projected_center=projected_center;
#endif
for(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);
#else
visibility=1.0;
#endif
#ifdef PROJECTION_GLOBE_VIEW
visibility=1.0;
#endif
v_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);
#ifdef FOG
v_fog_pos=fog_position(world_center.xyz);
#endif
}`),clippingMask:jr("void main() {glFragColor=vec4(1.0);}","in vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:jr(`#include "_prelude_fog.fragment.glsl"
uniform highp float u_intensity;in vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);glFragColor=vec4(val,1.0,1.0,1.0);
#ifdef FOG
if (u_is_globe==0) {glFragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
out vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#else
pos=vec3(tilePos+extrude,elevation(tilePos));
#endif
gl_Position=u_matrix*vec4(pos,1);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),heatmapTexture:jr(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));glFragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(0.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,"in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:jr("in float v_placed;in float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);glFragColor =mix(red,blue,step(0.5,v_placed))*0.5;glFragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}",`#include "_prelude_terrain.vertex.glsl"
in vec3 a_pos;in vec2 a_anchor_pos;in vec2 a_extrude;in vec2 a_placed;in vec2 a_shift;in vec2 a_elevation_from_sea;in float a_size_scale;in vec2 a_padding;in float a_auto_z_offset;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;out float v_placed;out float v_notUsed;void main() {float feature_elevation=a_elevation_from_sea.x+a_auto_z_offset;float terrain_elevation=(a_elevation_from_sea.y==1.0 ? 0.0 : elevation(a_anchor_pos));vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*(feature_elevation+terrain_elevation),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}`),collisionCircle:jr("in float v_radius;in vec2 v_extrude;in float v_perspective_ratio;in float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);glFragColor=color*alpha*opacity_t;}",`in vec2 a_pos_2f;in float a_radius;in vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;out float v_radius;out vec2 v_extrude;out float v_perspective_ratio;out float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(
mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}`),debug:jr("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);glFragColor=mix(u_color,overlay_color,overlay_color.a);}",`#include "_prelude_terrain.vertex.glsl"
in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;
#endif
out vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
gl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);
#else
gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);
#endif
}`),fill:jr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
#ifdef INDICATOR_CUTOUT
in highp float v_z_offset;
#endif
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
vec4 out_color=color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
out_color*=opacity;
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color,v_z_offset);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
#ifdef INDICATOR_CUTOUT
out highp float v_z_offset;
#endif
uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp float z_offset
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#ifdef INDICATOR_CUTOUT
v_z_offset=z_offset;
#endif
}`),fillOutline:jr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
in highp vec2 v_pos;uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
uniform mat4 u_matrix;uniform vec2 u_world;out highp vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp float z_offset
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutlinePattern:jr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
in highp vec2 v_pos;in highp vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
out highp vec2 v_pos;out highp vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize highp float z_offset
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillPattern:jr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;in highp vec2 v_pos;uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
out highp vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize highp float z_offset
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillExtrusion:jr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
in vec4 v_color;in vec4 v_flat;
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;
#endif
uniform lowp float u_opacity;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;in vec2 v_ao;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
in vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
in highp vec3 v_normal;
#endif
uniform vec3 u_flood_light_color;uniform highp float u_vertical_scale;uniform float u_flood_light_intensity;uniform vec3 u_ground_shadow_factor;
#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)
in float v_flood_radius;in float v_has_floodlight;
#endif
in float v_height;
#pragma mapbox: define highp float emissive_strength
void main() {
#pragma mapbox: initialize highp float emissive_strength
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
vec3 normal=normalize(v_normal);
#endif
float z;vec4 color=v_color;
#ifdef ZERO_ROOF_RADIUS
z=float(normal.z > 0.00001);
#ifdef LIGHTING_3D_MODE
normal=mix(normal,vec3(0.0,0.0,1.0),z);
#else
color=mix(v_color,v_roof_color,z);
#endif
#endif
float h=max(0.0,v_height);float ao_shade=1.0;
#ifdef FAUX_AO
float intensity=u_ao[0];float h_floors=h/(u_ao[1]*u_vertical_scale);float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);ao_shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;
#ifdef ZERO_ROOF_RADIUS
concave*=(1.0-z);
#endif
float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);ao_shade*=mix(1.0,x_shade*x_shade*x_shade,concave);
#ifdef LIGHTING_3D_MODE
#ifdef FLOOD_LIGHT
color.rgb*=mix(ao_shade,1.0,v_has_floodlight);
#else
color.rgb*=ao_shade;
#endif
#else
color.rgb*=ao_shade;
#endif
#endif
#ifdef LIGHTING_3D_MODE
float flood_radiance=0.0;
#ifdef FLOOD_LIGHT
flood_radiance=(1.0-min(h/v_flood_radius,1.0))*u_flood_light_intensity*v_has_floodlight;
#endif
#ifdef RENDER_SHADOWS
#ifdef FLOOD_LIGHT
float ndotl_unclamped=dot(normal,u_shadow_direction);float ndotl=max(0.0,ndotl_unclamped);float occlusion=ndotl_unclamped < 0.0 ? 1.0 : shadow_occlusion(ndotl,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);vec3 litColor=apply_lighting(color.rgb,normal,(1.0-u_shadow_intensity*occlusion)*ndotl);vec3 floodLitColor=compute_flood_lighting(u_flood_light_color*u_opacity,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=mix(litColor,floodLitColor,flood_radiance);
#else
float shadowed_lighting_factor;
#ifdef RENDER_CUTOFF
shadowed_lighting_factor=shadowed_light_factor_normal_opacity(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w,v_cutoff_opacity);if (v_cutoff_opacity==0.0) {discard;}
#else
shadowed_lighting_factor=shadowed_light_factor_normal(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);
#endif
color.rgb=apply_lighting(color.rgb,normal,shadowed_lighting_factor);
#endif
#else
color.rgb=apply_lighting(color.rgb,normal);
#ifdef FLOOD_LIGHT
color.rgb=mix(color.rgb,u_flood_light_color*u_opacity,flood_radiance);
#endif
#endif
color.rgb=mix(color.rgb,v_flat.rgb,emissive_strength);color*=u_opacity;
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos,h));
#endif
#ifdef INDICATOR_CUTOUT
color=applyCutout(color,h);
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#include "_prelude_lighting.glsl"
uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;uniform float u_width_scale;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef RENDER_WALL_MODE
in vec3 a_join_normal_inside;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
#ifdef TERRAIN
uniform int u_height_type;uniform int u_base_type;
#endif
uniform highp float u_vertical_scale;out vec4 v_color;out vec4 v_flat;
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
out vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
out highp vec3 v_normal;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;out vec2 v_ao;
#endif
#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)
out float v_flood_radius;out float v_has_floodlight;
#endif
out float v_height;vec3 linearTosRGB(vec3 color) {return pow(color,vec3(1./2.2));}vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
#pragma mapbox: define highp float flood_light_wall_radius
#pragma mapbox: define highp float line_width
#pragma mapbox: define highp float emissive_strength
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize highp float flood_light_wall_radius
#pragma mapbox: initialize highp float line_width
#pragma mapbox: initialize highp float emissive_strength
base*=u_vertical_scale;height*=u_vertical_scale;vec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
v_normal=normal;
#endif
base=max(0.0,base);float attr_height=height;height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=0.0;float c_ele=0.0;vec3 pos;
#ifdef TERRAIN
bool is_flat_height=centroid_pos.x !=0.0 && u_height_type==1;bool is_flat_base=centroid_pos.x !=0.0 && u_base_type==1;ele=elevation(pos_nx.xy);c_ele=is_flat_height || is_flat_base ? (centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos)) : ele;float h_height=is_flat_height ? max(c_ele+height,ele+base+2.0) : ele+height;float h_base=is_flat_base ? max(c_ele+base,ele+base) : ele+(base==0.0 ?-5.0 : base);h=t > 0.0 ? max(h_base,h_height) : h_base;pos=vec3(pos_nx.xy,h);
#else
h=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float cutoff=1.0;vec3 scaled_pos=pos;
#ifdef RENDER_CUTOFF
vec3 centroid_random=vec3(centroid_pos.xy,centroid_pos.x+centroid_pos.y+1.0);vec3 ground_pos=centroid_pos.x==0.0 ? pos.xyz : (centroid_random/8.0);vec4 ground=u_matrix*vec4(ground_pos.xy,ele,1.0);cutoff=cutoff_opacity(u_cutoff_params,ground.z);if (centroid_pos.y !=0.0 && centroid_pos.x !=0.0) {vec3 g=floor(ground_pos);vec3 mod_=centroid_random-g*8.0;float seed=min(1.0,0.1*(min(3.5,max(mod_.x+mod_.y,0.2*attr_height))*0.35+mod_.z));if (cutoff < 0.8-seed) {cutoff=0.0;}}float cutoff_scale=cutoff;v_cutoff_opacity=cutoff;scaled_pos.z=mix(c_ele,h,cutoff_scale);
#endif
float hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (cutoff==0.0 && centroid_pos.x !=0.0) || (color.a==0.0));
#ifdef RENDER_WALL_MODE
vec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);scaled_pos.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;scaled_pos.xy-=a_join_normal_inside.z*wall_offset*0.5;
#endif
gl_Position=mix(u_matrix*vec4(scaled_pos,1),AWAY,hidden);h=h-ele;v_height=h;
#ifdef RENDER_SHADOWS
vec3 shd_pos0=pos;vec3 shd_pos1=pos;
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(normal);shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);
#endif
float NdotL=0.0;float colorvalue=0.0;
#ifndef LIGHTING_3D_MODE
colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);if (normal.y !=0.0) {float r=0.84;r=mix(0.7,0.98,1.0-u_lightintensity);NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#endif
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec2(mix(concave,-concave,start),y_ground);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
#ifdef FLOOD_LIGHT
float is_wall=1.0-float(t > 0.0 && top_up_ny.y > 0.0);v_has_floodlight=float(flood_light_wall_radius > 0.0 && is_wall > 0.0);v_flood_radius=flood_light_wall_radius*u_vertical_scale;
#endif
v_color=vec4(color.rgb,1.0);float ndotl=calculate_NdotL(normal);v_flat.rgb=sRGBToLinear(color.rgb);v_flat.rgb=v_flat.rgb*(ndotl+(1.0-min(ndotl*57.29,1.0))*emissive_strength);v_flat=vec4(linearTosRGB(v_flat.rgb),1.0);
#else
v_color=vec4(0.0,0.0,0.0,1.0);v_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_color*=u_opacity;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
float roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color=vec4(0.0,0.0,0.0,1.0);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_roof_color*=u_opacity;
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),fillExtrusionDepth:jr(`in highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
glFragColor=pack_depth(v_depth);
#endif
}`,`#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;uniform float u_edge_radius;uniform float u_width_scale;uniform float u_vertical_scale;
#ifdef TERRAIN
uniform int u_height_type;uniform int u_base_type;
#endif
in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef RENDER_WALL_MODE
in vec3 a_join_normal_inside;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp float line_width
#pragma mapbox: define highp vec4 color
out highp float v_depth;void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp float line_width
#pragma mapbox: initialize highp vec4 color
base*=u_vertical_scale;height*=u_vertical_scale;vec3 pos_nx=floor(a_pos_normal_ed.xyz*0.5);mediump vec3 top_up_ny=a_pos_normal_ed.xyz-2.0*pos_nx;base=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
vec3 pos;
#ifdef TERRAIN
bool is_flat_height=centroid_pos.x !=0.0 && u_height_type==1;bool is_flat_base=centroid_pos.x !=0.0 && u_base_type==1;float ele=elevation(pos_nx.xy);float c_ele=is_flat_height || is_flat_base ? (centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos)) : ele;float h_height=is_flat_height ? max(c_ele+height,ele+base+2.0) : ele+height;float h_base=is_flat_base ? max(c_ele+base,ele+base) : ele+(base==0.0 ?-5.0 : base);float h=t > 0.0 ? max(h_base,h_height) : h_base;pos=vec3(pos_nx.xy,h);
#else
pos=vec3(pos_nx.xy,t > 0.0 ? height : base);
#endif
#ifdef RENDER_WALL_MODE
vec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);pos.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;pos.xy-=a_join_normal_inside.z*wall_offset*0.5;
#endif
float hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (color.a==0.0));gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);v_depth=gl_Position.z/gl_Position.w;}`),fillExtrusionPattern:jr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;in vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
in vec3 v_normal;
#endif
in highp vec2 v_pos;in vec4 v_lighting;uniform lowp float u_opacity;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define highp float pixel_ratio
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize highp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color,normalize(v_normal))*u_opacity;
#else
out_color=out_color*v_lighting;
#endif
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color,height);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#include "_prelude_lighting.glsl"
uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_width_scale;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef RENDER_WALL_MODE
in vec3 a_join_normal_inside;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
#ifdef TERRAIN
uniform int u_height_type;uniform int u_base_type;
#endif
out highp vec2 v_pos;out vec4 v_lighting;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;out vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
out vec3 v_normal;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define highp float pixel_ratio
#pragma mapbox: define highp float line_width
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize highp float pixel_ratio
#pragma mapbox: initialize highp float line_width
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=z;vec3 p;float c_ele;
#ifdef TERRAIN
bool is_flat_height=centroid_pos.x !=0.0 && u_height_type==1;bool is_flat_base=centroid_pos.x !=0.0 && u_base_type==1;ele=elevation(pos_nx.xy);c_ele=is_flat_height || is_flat_base ? (centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos)) : ele;float h_height=is_flat_height ? max(c_ele+height,ele+base+2.0) : ele+height;float h_base=is_flat_base ? max(c_ele+base,ele+base) : ele+(base==0.0 ?-5.0 : base);h=t > 0.0 ? max(h_base,h_height) : h_base;p=vec3(pos_nx.xy,h);
#else
p=vec3(pos_nx.xy,z);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
#ifdef RENDER_WALL_MODE
vec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);p.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;p.xy-=a_join_normal_inside.z*wall_offset*0.5;
#endif
float hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (color.a==0.0));gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0
? pos_nx.xy
: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;
#ifdef LIGHTING_3D_MODE
NdotL=calculate_NdotL(normal);
#else
NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);
#endif
if (normal.y !=0.0) {float r=0.84;
#ifndef LIGHTING_3D_MODE
r=mix(0.7,0.98,1.0-u_lightintensity);
#endif
NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
v_normal=normal;
#else
v_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;
#endif 
#ifdef FOG
v_fog_pos=fog_position(p);
#endif
}`),groundShadow:jr(`#include "_prelude_shadow.fragment.glsl"
precision highp float;uniform vec3 u_ground_shadow_factor;in vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;
#ifdef FOG
in float v_fog_opacity;
#endif
void main() {float light=shadowed_light_factor_plane_bias(v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);vec3 shadow=mix(u_ground_shadow_factor,vec3(1.0),light);
#ifdef RENDER_CUTOFF
shadow=mix(vec3(1.0),shadow,cutoff_opacity(u_cutoff_params,1.0/gl_FragCoord.w));
#endif
#ifdef FOG
shadow=mix(shadow,vec3(1.0),v_fog_opacity);
#endif
#ifdef INDICATOR_CUTOUT
shadow=mix(shadow,vec3(1.0),1.0-applyCutout(vec4(1.0),0.0).r);
#endif
glFragColor=vec4(shadow,1.0);}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;in vec2 a_pos;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;
#ifdef FOG
out float v_fog_opacity;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0.0,1.0);v_pos_light_view_0=u_light_matrix_0*vec4(a_pos,0.0,1.0);v_pos_light_view_1=u_light_matrix_1*vec4(a_pos,0.0,1.0);
#ifdef FOG
v_fog_pos=fog_position(a_pos);v_fog_opacity=fog(v_fog_pos);
#endif
}`),fillExtrusionGroundEffect:jr(`uniform highp float u_ao_pass;uniform highp float u_opacity;uniform highp float u_flood_light_intensity;uniform highp vec3 u_flood_light_color;uniform highp float u_attenuation;uniform sampler2D u_fb;uniform float u_fb_size;
#ifdef SDF_SUBPASS
in highp vec2 v_pos;in highp vec4 v_line_segment;in highp float v_flood_light_radius_tile;in highp vec2 v_ao;float line_df(highp vec2 a,highp vec2 b,highp vec2 p) {highp vec2 ba=b-a;highp vec2 pa=p-a;highp float r=clamp(dot(pa,ba)/dot(ba,ba),0.0,1.0);return length(pa-r*ba);}
#ifdef FOG
in highp float v_fog;
#endif
#endif
void main() {
#ifdef CLEAR_SUBPASS
vec4 color=vec4(1.0);
#ifdef CLEAR_FROM_TEXTURE
color=texture(u_fb,gl_FragCoord.xy/vec2(u_fb_size));
#endif
glFragColor=color;
#else
#ifdef SDF_SUBPASS
highp float d=line_df(v_line_segment.xy,v_line_segment.zw,v_pos);highp float effect_radius=mix(v_flood_light_radius_tile,v_ao.y,u_ao_pass);d/=effect_radius;d=min(d,1.0);d=1.0-pow(1.0-d,u_attenuation);highp float effect_intensity=mix(u_flood_light_intensity,v_ao.x,u_ao_pass);highp float fog=1.0;
#ifdef FOG
fog=v_fog;
#endif
#ifdef RENDER_CUTOFF
fog*=v_cutoff_opacity;
#endif
glFragColor=vec4(vec3(0.0),mix(1.0,d,effect_intensity*u_opacity*fog));
#else
vec4 color=mix(vec4(u_flood_light_color,1.0),vec4(vec3(0.0),1.0),u_ao_pass);
#ifdef OVERDRAW_INSPECTOR
color=vec4(1.0);
#endif
glFragColor=color;
#endif
HANDLE_WIREFRAME_DEBUG;
#endif
}`,`#include "_prelude_fog.vertex.glsl"
in highp vec4 a_pos_end;in highp float a_angular_offset_factor;in highp float a_hidden_by_landmark;
#ifdef SDF_SUBPASS
out highp vec2 v_pos;out highp vec4 v_line_segment;out highp float v_flood_light_radius_tile;out highp vec2 v_ao;
#ifdef FOG
out highp float v_fog;
#endif
#endif
uniform highp float u_flood_light_intensity;uniform highp mat4 u_matrix;uniform highp float u_ao_pass;uniform highp float u_meter_to_tile;uniform highp float u_edge_radius;uniform highp float u_dynamic_offset;uniform highp vec2 u_ao;
#pragma mapbox: define highp float flood_light_ground_radius
const float TANGENT_CUTOFF=4.0;const float NORM=32767.0;void main() {
#pragma mapbox: initialize highp float flood_light_ground_radius
vec2 p=a_pos_end.xy;vec2 q=floor(a_pos_end.zw*0.5);vec2 start_bottom=a_pos_end.zw-q*2.0;float fl_ground_radius=flood_light_ground_radius;fl_ground_radius=abs(flood_light_ground_radius);float direction=flood_light_ground_radius < 0.0 ?-1.0 : 1.0;float flood_radius_tile=fl_ground_radius*u_meter_to_tile;vec2 v=normalize(q-p);float ao_radius=u_ao.y/3.5;float effect_radius=mix(flood_radius_tile,ao_radius,u_ao_pass)+u_edge_radius;float angular_offset_factor=a_angular_offset_factor/NORM*TANGENT_CUTOFF;float angular_offset=direction*angular_offset_factor*effect_radius;float top=1.0-start_bottom.y;float side=(0.5-start_bottom.x)*2.0;vec2 extrusion_parallel=v*side*mix(u_dynamic_offset,angular_offset,top);vec2 perp=vec2(v.y,-v.x);vec2 extrusion_perp=direction*perp*effect_radius*top;vec3 pos=vec3(mix(q,p,start_bottom.x),0.0);pos.xy+=extrusion_parallel+extrusion_perp;
#ifdef SDF_SUBPASS
v_pos=pos.xy;v_line_segment=vec4(p,q)+perp.xyxy*u_edge_radius;v_flood_light_radius_tile=flood_radius_tile;v_ao=vec2(u_ao.x,ao_radius);
#ifdef FOG
v_fog_pos=fog_position(pos);v_fog=1.0-fog(v_fog_pos);
#endif
#endif
float hidden_by_landmark=0.0;
#ifdef HAS_CENTROID
hidden_by_landmark=a_hidden_by_landmark;
#endif
float isFloodlit=float(fl_ground_radius > 0.0 && u_flood_light_intensity > 0.0);float hidden=mix(1.0-isFloodlit,isFloodlit,u_ao_pass);hidden+=hidden_by_landmark;gl_Position=mix(u_matrix*vec4(pos,1.0),AWAY,float(hidden > 0.0));
#ifdef RENDER_CUTOFF
v_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);
#endif
}`),hillshadePrepare:jr(`precision highp float;uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;float getElevation(vec2 coord) {return texture(u_image,coord).r/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(
(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)
)/pow(2.0,exaggeration+(19.2562-u_zoom));glFragColor=clamp(vec4(
deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:jr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;uniform float u_emissive_strength;void main() {vec4 pixel=texture(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);glFragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef LIGHTING_3D_MODE
glFragColor=apply_lighting_with_emission_ground(glFragColor,u_emissive_strength);
#endif
#ifdef FOG
glFragColor=fog_dither(fog_apply_premultiplied(glFragColor,v_fog_pos));
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),line:jr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform lowp float u_device_pixel_ratio;uniform highp float u_width_scale;uniform highp float u_floor_width_scale;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;uniform highp vec2 u_trim_fade_range;uniform lowp vec4 u_trim_color;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec4 v_uv;
#ifdef ELEVATED_ROADS
in highp float v_road_z_offset;
#endif
#ifdef RENDER_LINE_DASH
uniform sampler2D u_dash_image;in vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform sampler2D u_gradient_image;
#endif
#ifdef INDICATOR_CUTOUT
in highp float v_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
float luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}uniform float u_emissive_strength;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float border_width
#pragma mapbox: define lowp vec4 border_color
float linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float border_width
#pragma mapbox: initialize lowp vec4 border_color
float dist=length(v_normal)*v_width2.s;float blur2=(u_width_scale*blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);
#ifdef RENDER_LINE_DASH
float sdfdist=texture(u_dash_image,v_tex).r;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;float scaled_floorwidth=(floorwidth*u_floor_width_scale);alpha*=linearstep(0.5-sdfgamma/scaled_floorwidth,0.5+sdfgamma/scaled_floorwidth,sdfdist);
#endif
highp vec4 out_color;
#ifdef RENDER_LINE_GRADIENT
out_color=texture(u_gradient_image,v_uv.xy);
#else
out_color=color;
#endif
float trim_alpha=1.0;
#ifdef RENDER_LINE_TRIM_OFFSET
highp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {highp float start_transition=max(0.0,min(1.0,(line_progress-trim_start)/max(u_trim_fade_range[0],1.0e-9)));highp float end_transition=max(0.0,min(1.0,(trim_end-line_progress)/max(u_trim_fade_range[1],1.0e-9)));highp float transition_factor=min(start_transition,end_transition);out_color=mix(out_color,u_trim_color,transition_factor);trim_alpha=1.0-transition_factor;}
#endif
if (u_alpha_discard_threshold !=0.0) {if (alpha < u_alpha_discard_threshold) {discard;}}
#ifdef RENDER_LINE_BORDER
float edgeBlur=((border_width*u_width_scale)+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);if (border_color.a==0.0) {float Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}} else {out_color=mix(border_color*trim_alpha,out_color,smoothAlpha);}}
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);
#ifdef ELEVATED_ROADS
out_color.rgb*=mix(v_road_z_offset > 0.0 ? u_ground_shadow_factor : vec3(1.0),vec3(1.0),light);
#else
out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
out_color*=(alpha*opacity);
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color,v_z_offset);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define EXTRUDE_SCALE 0.015873016
in vec2 a_pos_normal;in vec4 a_data;
#if defined(ELEVATED) || defined(ELEVATED_ROADS) || defined(VARIABLE_LINE_WIDTH)
in vec2 a_z_offset_width;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
in highp vec4 a_packed;
#endif
#ifdef RENDER_LINE_DASH
in float a_linesofar;
#endif
uniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;uniform float u_width_scale;uniform highp float u_floor_width_scale;
#ifdef ELEVATED
uniform lowp float u_zbias_factor;uniform lowp float u_tile_to_meter;float sample_elevation(vec2 apos) {
#ifdef ELEVATION_REFERENCE_SEA
return 0.0;
#else
return elevation(apos);
#endif
}
#endif
out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec4 v_uv;
#ifdef ELEVATED_ROADS
out highp float v_road_z_offset;
#endif
#ifdef RENDER_LINE_DASH
uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;out vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform float u_image_height;
#endif
#ifdef INDICATOR_CUTOUT
out highp float v_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float border_width
#pragma mapbox: define lowp vec4 border_color
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float border_width
#pragma mapbox: initialize lowp vec4 border_color
float a_z_offset;
#if defined(ELEVATED) || defined(ELEVATED_ROADS)
a_z_offset=a_z_offset_width.x;
#endif
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth;
#ifdef VARIABLE_LINE_WIDTH
halfwidth=(u_width_scale*a_z_offset_width.y)/2.0;
#else
halfwidth=(u_width_scale*width)/2.0;
#endif
offset=-1.0*offset*u_width_scale;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);float hidden=float(opacity==0.0);vec2 extrude=dist*u_pixels_to_tile_units;vec4 projected_extrude=u_matrix*vec4(extrude,0.0,0.0);vec2 projected_extrude_xy=projected_extrude.xy;
#ifdef ELEVATED_ROADS
v_road_z_offset=a_z_offset;gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,a_z_offset+0.01*step(0.01,a_z_offset),1.0)+projected_extrude;
#else
#ifdef ELEVATED
vec2 offsetTile=offset2*u_pixels_to_tile_units;vec2 offset_pos=pos+offsetTile;float ele=0.0;
#ifdef CROSS_SLOPE_VERTICAL
float top=a_pos_normal.y-2.0*floor(a_pos_normal.y*0.5);float line_height=2.0*u_tile_to_meter*outset*top*u_pixels_to_tile_units[1][1]+a_z_offset;ele=sample_elevation(offset_pos)+line_height;projected_extrude=vec4(0);
#else
#ifdef CROSS_SLOPE_HORIZONTAL
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,max(ele1,ele2));ele=ele_max+a_z_offset;
#else
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,0.5*(ele1+ele2));ele=ele_max-ele0+ele1+a_z_offset;
#endif
#endif
gl_Position=u_matrix*vec4(offset_pos,ele,1.0)+projected_extrude;float z=clamp(gl_Position.z/gl_Position.w,0.5,1.0);float zbias=max(0.00005,(pow(z,0.8)-z)*u_zbias_factor*u_exaggeration);gl_Position.z-=(gl_Position.w*zbias);gl_Position=mix(gl_Position,AWAY,hidden);
#else
gl_Position=mix(u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude,AWAY,hidden);
#endif
#endif
#ifdef ELEVATED_ROADS
#ifdef RENDER_SHADOWS
vec3 shd_pos=vec3(pos+(offset2+dist)*u_pixels_to_tile_units,a_z_offset);vec3 shd_pos0=shd_pos;vec3 shd_pos1=shd_pos;
#ifdef NORMAL_OFFSET
vec3 shd_pos_offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=shd_pos_offset*shadow_normal_offset_multiplier0();shd_pos1+=shd_pos_offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#endif
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude_xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=mix(extrude_length_without_perspective/extrude_length_with_perspective,1.0,step(0.01,blur));
#else
v_gamma_scale=1.0;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
float a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];
#ifdef RENDER_LINE_GRADIENT
highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec4(a_uv_x,a_split_index*texel_height-half_texel_height,a_clip_start,a_clip_end);
#else
v_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);
#endif
#endif
#ifdef RENDER_LINE_DASH
float scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/(floorwidth*u_floor_width_scale),(-normal.y*height+dash.x+0.5)/u_texsize.y);
#endif
v_width2=vec2(outset,inset);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
#ifdef INDICATOR_CUTOUT
v_z_offset=a_z_offset;
#endif
}`),linePattern:jr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform highp float u_device_pixel_ratio;uniform highp float u_width_scale;uniform highp float u_alpha_discard_threshold;uniform highp vec2 u_texsize;uniform highp float u_tile_units_to_pixels;uniform highp vec2 u_trim_offset;uniform highp vec2 u_trim_fade_range;uniform lowp vec4 u_trim_color;uniform sampler2D u_image;in vec2 v_normal;in vec2 v_width2;in highp float v_linesofar;in float v_gamma_scale;in float v_width;
#ifdef RENDER_LINE_TRIM_OFFSET
in highp vec4 v_uv;
#endif
#ifdef ELEVATED_ROADS
in highp float v_road_z_offset;
#endif
#ifdef LINE_JOIN_NONE
in vec2 v_pattern_data;
#endif
#ifdef INDICATOR_CUTOUT
in highp float v_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
uniform float u_emissive_strength;
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define mediump float pixel_ratio
#pragma mapbox: define mediump float blur
#pragma mapbox: define mediump float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize mediump float pixel_ratio
#pragma mapbox: initialize mediump float blur
#pragma mapbox: initialize mediump float opacity
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;highp float pattern_size=display_size.x/u_tile_units_to_pixels;float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(u_width_scale*blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);highp float pattern_x=v_linesofar/pattern_size*aspect;highp float x=mod(pattern_x,1.0);highp float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;highp vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));highp vec2 lod_pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(pattern_x,y));vec4 color=textureLodCustom(u_image,pos,lod_pos);
#ifdef RENDER_LINE_TRIM_OFFSET
highp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {highp float start_transition=max(0.0,min(1.0,(line_progress-trim_start)/max(u_trim_fade_range[0],1.0e-9)));highp float end_transition=max(0.0,min(1.0,(trim_end-line_progress)/max(u_trim_fade_range[1],1.0e-9)));highp float transition_factor=min(start_transition,end_transition);color=mix(color,color.a*u_trim_color,transition_factor);}
#endif
#ifdef LINE_JOIN_NONE
highp float pattern_len=pattern_size/aspect;highp float segment_phase=pattern_len-mod(v_linesofar-v_pattern_data.x+pattern_len,pattern_len);highp float visible_start=segment_phase-step(pattern_len*0.5,segment_phase)*pattern_len;highp float visible_end=floor((v_pattern_data.y-segment_phase)/pattern_len)*pattern_len+segment_phase;visible_end+=step(pattern_len*0.5,v_pattern_data.y-visible_end)*pattern_len;if (v_pattern_data.x < visible_start || v_pattern_data.x >=visible_end) {color=vec4(0.0);}
#endif
#ifdef LIGHTING_3D_MODE
color=apply_lighting_with_emission_ground(color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);
#ifdef ELEVATED_ROADS
color.rgb*=mix(v_road_z_offset > 0.0 ? u_ground_shadow_factor : vec3(1.0),vec3(1.0),light);
#else
color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
color*=(alpha*opacity);if (u_alpha_discard_threshold !=0.0) {if (color.a < u_alpha_discard_threshold) {discard;}}
#ifdef INDICATOR_CUTOUT
color=applyCutout(color,v_z_offset);
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;
#if defined(ELEVATED) || defined(ELEVATED_ROADS)
in vec2 a_z_offset_width;
#endif
#ifdef RENDER_LINE_TRIM_OFFSET
in highp vec4 a_packed;
#endif
in highp float a_linesofar;
#ifdef LINE_JOIN_NONE
in highp vec3 a_pattern_data;out vec2 v_pattern_data;
#endif
#ifdef INDICATOR_CUTOUT
out highp float v_z_offset;
#endif
uniform mat4 u_matrix;uniform float u_tile_units_to_pixels;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform float u_device_pixel_ratio;uniform float u_width_scale;uniform float u_floor_width_scale;
#ifdef ELEVATED
uniform lowp float u_zbias_factor;uniform lowp float u_tile_to_meter;float sample_elevation(vec2 apos) {
#ifdef ELEVATION_REFERENCE_SEA
return 0.0;
#else
return elevation(apos);
#endif
}
#endif
out vec2 v_normal;out vec2 v_width2;out highp float v_linesofar;out float v_gamma_scale;out float v_width;
#ifdef RENDER_LINE_TRIM_OFFSET
out highp vec4 v_uv;
#endif
#ifdef ELEVATED_ROADS
out highp float v_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
#pragma mapbox: define mediump float blur
#pragma mapbox: define mediump float opacity
#pragma mapbox: define mediump float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define mediump float floorwidth
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define mediump float pixel_ratio
void main() {
#pragma mapbox: initialize mediump float blur
#pragma mapbox: initialize mediump float opacity
#pragma mapbox: initialize mediump float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize mediump float floorwidth
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize mediump float pixel_ratio
float a_z_offset;
#if defined(ELEVATED) || defined(ELEVATED_ROADS)
a_z_offset=a_z_offset_width.x;
#endif
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=(u_width_scale*width)/2.0;offset=-1.0*offset*u_width_scale;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);vec2 dist=outset*a_extrude*scale;float u=0.5*a_direction;float t=1.0-abs(u);vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float hidden=float(opacity==0.0);vec2 extrude=dist*u_pixels_to_tile_units;vec4 projected_extrude=u_matrix*vec4(extrude,0.0,0.0);vec2 projected_extrude_xy=projected_extrude.xy;
#ifdef ELEVATED_ROADS
v_road_z_offset=a_z_offset;gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,a_z_offset+0.01*step(0.01,a_z_offset),1.0)+projected_extrude;
#else
#ifdef ELEVATED
vec2 offsetTile=offset2*u_pixels_to_tile_units;vec2 offset_pos=pos+offsetTile;float ele=0.0;
#ifdef CROSS_SLOPE_VERTICAL
float top=a_pos_normal.y-2.0*floor(a_pos_normal.y*0.5);float line_height=2.0*u_tile_to_meter*outset*top*u_pixels_to_tile_units[1][1]+a_z_offset;ele=sample_elevation(offset_pos)+line_height;projected_extrude=vec4(0);
#else
#ifdef CROSS_SLOPE_HORIZONTAL
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,max(ele1,ele2));ele=ele_max+a_z_offset;
#else
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,0.5*(ele1+ele2));ele=ele_max-ele0+ele1+a_z_offset;
#endif
#endif
gl_Position=u_matrix*vec4(offset_pos,ele,1.0)+projected_extrude;float z=clamp(gl_Position.z/gl_Position.w,0.5,1.0);float zbias=max(0.00005,(pow(z,0.8)-z)*u_zbias_factor*u_exaggeration);gl_Position.z-=(gl_Position.w*zbias);gl_Position=mix(gl_Position,AWAY,hidden);
#else
gl_Position=mix(u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude,AWAY,hidden);
#endif
#endif
#ifdef ELEVATED_ROADS
#ifdef RENDER_SHADOWS
vec3 shd_pos=vec3(pos+(offset2+dist)*u_pixels_to_tile_units,a_z_offset);vec3 shd_pos0=shd_pos;vec3 shd_pos1=shd_pos;
#ifdef NORMAL_OFFSET
vec3 shd_pos_offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=shd_pos_offset*shadow_normal_offset_multiplier0();shd_pos1+=shd_pos_offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#endif
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude_xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=mix(extrude_length_without_perspective/extrude_length_with_perspective,1.0,step(0.01,blur));
#else
v_gamma_scale=1.0;
#endif
#ifdef RENDER_LINE_TRIM_OFFSET
float a_uv_x=a_packed[0];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];v_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=(floorwidth*u_floor_width_scale);
#ifdef LINE_JOIN_NONE
v_width=(floorwidth*u_floor_width_scale)+ANTIALIASING;mediump float pixels_to_tile_units=1.0/u_tile_units_to_pixels;mediump float pixel_ratio_inverse=1.0/pixel_ratio;mediump float aspect=v_width/((pattern.w-pattern.y)*pixel_ratio_inverse);highp float subt_multiple=(pattern.z-pattern.x)*pixel_ratio_inverse*pixels_to_tile_units*aspect*32.0;highp float subt=floor(a_pattern_data.z/subt_multiple)*subt_multiple;float offset_sign=(fract(a_pattern_data.x)-0.5)*4.0;float line_progress_offset=offset_sign*v_width*0.5*pixels_to_tile_units;v_linesofar=(a_pattern_data.z-subt)+a_linesofar+line_progress_offset;v_pattern_data=vec2(a_pattern_data.x+line_progress_offset,a_pattern_data.y);
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
#ifdef INDICATOR_CUTOUT
v_z_offset=a_z_offset;
#endif
}`),raster:jr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_raster_array.glsl"
uniform float u_fade_t;uniform float u_opacity;uniform highp float u_raster_elevation;uniform highp float u_zoom_transition;in vec2 v_pos0;in vec2 v_pos1;in float v_depth;
#ifdef PROJECTION_GLOBE_VIEW
in float v_split_fade;
#endif
uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;uniform float u_emissive_strength;
#ifndef RASTER_ARRAY
uniform highp sampler2D u_image0;uniform sampler2D u_image1;
#endif
#ifdef RASTER_COLOR
uniform sampler2D u_color_ramp;uniform highp vec4 u_colorization_mix;uniform highp float u_colorization_offset;uniform vec2 u_texture_res;
#endif
void main() {vec4 color0,color1,color;vec2 value;
#ifdef RASTER_COLOR
#ifdef RASTER_ARRAY
#ifdef RASTER_ARRAY_LINEAR
value=mix(
raTexture2D_image0_linear(v_pos0,u_texture_res,u_colorization_mix,u_colorization_offset),raTexture2D_image1_linear(v_pos1,u_texture_res,u_colorization_mix,u_colorization_offset),u_fade_t
);
#else
value=mix(
raTexture2D_image0_nearest(v_pos0,u_texture_res,u_colorization_mix,u_colorization_offset),raTexture2D_image1_nearest(v_pos1,u_texture_res,u_colorization_mix,u_colorization_offset),u_fade_t
);
#endif
if (value.y > 0.0) value.x/=value.y;
#else
color=mix(texture(u_image0,v_pos0),texture(u_image1,v_pos1),u_fade_t);value=vec2(u_colorization_offset+dot(color.rgb,u_colorization_mix.rgb),color.a);
#endif
color=texture(u_color_ramp,vec2(value.x,0.5));if (color.a > 0.0) color.rgb/=color.a;color.a*=value.y;
#else
color0=texture(u_image0,v_pos0);color1=texture(u_image1,v_pos1);if (color0.a > 0.0) color0.rgb/=color0.a;if (color1.a > 0.0) color1.rgb/=color1.a;color=mix(color0,color1,u_fade_t);
#endif
color.a*=u_opacity;
#ifdef GLOBE_POLES
color.a*=1.0-smoothstep(0.0,0.05,u_zoom_transition);
#endif
vec3 rgb=color.rgb;rgb=vec3(
dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(vec4(out_color,1.0),u_emissive_strength).rgb;
#endif
#ifdef FOG
highp float fog_limit_high_meters=1000000.0;highp float fog_limit_low_meters=600000.0;float fog_limit=1.0-smoothstep(fog_limit_low_meters,fog_limit_high_meters,u_raster_elevation);out_color=fog_dither(fog_apply(out_color,v_fog_pos,fog_limit));
#endif
glFragColor=vec4(out_color*color.a,color.a);
#ifdef PROJECTION_GLOBE_VIEW
glFragColor*=mix(1.0,1.0-smoothstep(0.0,0.05,u_zoom_transition),smoothstep(0.8,0.9,v_split_fade));
#endif
#ifdef RENDER_CUTOFF
glFragColor=glFragColor*cutoff_opacity(u_cutoff_params,v_depth);
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform mat3 u_grid_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;uniform vec2 u_texture_offset;uniform float u_raster_elevation;uniform float u_zoom_transition;uniform vec2 u_merc_center;
#define GLOBE_UPSCALE GLOBE_RADIUS/6371008.8
#ifdef GLOBE_POLES
in vec3 a_globe_pos;in vec2 a_uv;
#else
in vec2 a_pos;in vec2 a_texture_pos;
#endif
out vec2 v_pos0;out vec2 v_pos1;out float v_depth;
#ifdef PROJECTION_GLOBE_VIEW
out float v_split_fade;
#endif
void main() {vec2 uv;
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;gl_Position=u_matrix*u_globe_matrix*vec4(globe_pos   ,1.0);uv=a_uv;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(a_globe_pos,1.0)).xyz);
#endif
#else
float w=1.0+dot(a_texture_pos,u_perspective_transform);uv=a_texture_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);vec3 globe_pos=latLngToECEF(latLng.xy);globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);float mercatorY=mercatorYfromLat(latLng[0]);float mercatorX=mercatorXfromLng(latLng[1]);    
v_split_fade=0.0;if (u_zoom_transition > 0.0) {vec2 merc_pos=vec2(mercatorX,mercatorY);merc_world_pos=vec4(merc_pos,u_raster_elevation,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;float opposite_merc_center=mod(u_merc_center.x+0.5,1.0);float dist_from_poles=(abs(mercatorY-0.5)*2.0);float range=0.1;v_split_fade=abs(opposite_merc_center-mercatorX);v_split_fade=clamp(1.0-v_split_fade,0.0,1.0);v_split_fade=max(smoothstep(1.0-range,1.0,dist_from_poles),max(smoothstep(1.0-range,1.0,v_split_fade),smoothstep(1.0-range,1.0,1.0-v_split_fade)));}float tiles=u_grid_matrix[0][2];if (tiles > 0.0) {float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];float uvY=mercatorY*tiles-idy;float uvX=mercatorX*tiles-idx;uv=vec2(uvX,uvY);}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition)*w,w);gl_Position=u_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
#else
gl_Position=u_matrix*vec4(a_pos*w,u_raster_elevation*w,w);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#endif
#endif
v_pos0=uv;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;v_pos0=u_texture_offset.x+u_texture_offset.y*v_pos0;v_pos1=u_texture_offset.x+u_texture_offset.y*v_pos1;
#ifdef RENDER_CUTOFF
v_depth=gl_Position.z;
#endif
}`),rasterParticle:jr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform float u_fade_t;uniform float u_opacity;uniform highp float u_raster_elevation;in vec2 v_pos0;in vec2 v_pos1;uniform sampler2D u_image0;uniform sampler2D u_image1;void main() {vec4 color0,color1,color;color0=texture(u_image0,v_pos0);color1=texture(u_image1,v_pos1);if (color0.a > 0.0) color0.rgb/=color0.a;if (color1.a > 0.0) color1.rgb/=color1.a;color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 out_color=color.rgb;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(vec4(out_color,1.0),0.0).rgb;
#endif
#ifdef FOG
highp float fog_limit_high_meters=1000000.0;highp float fog_limit_low_meters=600000.0;float fog_limit=1.0-smoothstep(fog_limit_low_meters,fog_limit_high_meters,u_raster_elevation);out_color=fog_dither(fog_apply(out_color,v_fog_pos,fog_limit));
#endif
glFragColor=vec4(out_color*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform mat3 u_grid_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_raster_elevation;uniform float u_zoom_transition;uniform vec2 u_merc_center;
#define GLOBE_UPSCALE GLOBE_RADIUS/6371008.8
in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {float w=1.0;vec2 uv;
#ifdef PROJECTION_GLOBE_VIEW
vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float mercatorX=mercatorXfromLng(latLng[1]);float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];float uvX=mercatorX*tiles-idx;float uvY=mercatorY*tiles-idy;uv=vec2(uvX,uvY);vec3 globe_pos=latLngToECEF(latLng.xy);globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {vec2 merc_pos=vec2(mercatorX,mercatorY);merc_world_pos=vec4(merc_pos,u_raster_elevation,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition)*w,w);gl_Position=u_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
#else
uv=a_texture_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*w,u_raster_elevation*w,w);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#endif
v_pos0=uv;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}`),rasterParticleDraw:jr("uniform sampler2D u_color_ramp;in float v_particle_speed;void main() {glFragColor=texture(u_color_ramp,vec2(v_particle_speed,0.5));}",`#include "_prelude_raster_particle.glsl"
in float a_index;uniform sampler2D u_particle_texture;uniform float u_particle_texture_side_len;uniform vec2 u_tile_offset;out float v_particle_speed;void main() {ivec2 pixel_coord=ivec2(
mod(a_index,u_particle_texture_side_len),a_index/u_particle_texture_side_len);vec4 pixel=texelFetch(u_particle_texture,pixel_coord,0);vec2 pos=unpack_pos_from_rgba(pixel)+u_tile_offset;vec2 tex_coord=fract(pos);vec2 velocity=lookup_velocity(tex_coord);if (velocity==INVALID_VELOCITY) {gl_Position=AWAY;v_particle_speed=0.0;} else {gl_Position=vec4(2.0*pos-1.0,0,1);v_particle_speed=length(velocity);}gl_PointSize=1.0;}`),rasterParticleTexture:jr("uniform sampler2D u_texture;uniform float u_opacity;in vec2 v_tex_pos;void main() {vec4 color=texture(u_texture,v_tex_pos);glFragColor=vec4(floor(255.0*color*u_opacity)/255.0);}","in vec2 a_pos;out vec2 v_tex_pos;void main() {vec2 uv=0.5*a_pos+vec2(0.5);v_tex_pos=uv;gl_Position=vec4(a_pos,0.0,1.0);}"),rasterParticleUpdate:jr(`#include "_prelude_raster_particle.glsl"
uniform sampler2D u_particle_texture;uniform mediump float u_particle_texture_side_len;uniform mediump float u_speed_factor;uniform highp float u_reset_rate;uniform highp float u_rand_seed;in highp vec2 v_tex_coord;vec2 linearstep(vec2 edge0,vec2 edge1,vec2 x) {return  clamp((x-edge0)/(edge1-edge0),vec2(0),vec2(1));}const highp vec3 rand_constants=vec3(12.9898,78.233,4375.85453);highp float rand(const highp vec2 co) {highp float t=dot(rand_constants.xy,co);return fract(sin(t)*(rand_constants.z+t));}void main() {ivec2 pixel_coord=ivec2(v_tex_coord*u_particle_texture_side_len);highp vec4 pixel=texelFetch(u_particle_texture,pixel_coord,0);highp vec2 pos=unpack_pos_from_rgba(pixel);highp vec2 velocity=lookup_velocity(clamp(pos,0.0,1.0));highp vec2 dp=velocity==INVALID_VELOCITY ? vec2(0) : velocity*u_speed_factor;pos=pos+dp;highp vec2 seed=(pos+v_tex_coord)*u_rand_seed;highp vec2 random_pos=vec2(rand(seed+1.3),rand(seed+2.1));highp vec2 persist_rate=pow(
linearstep(vec2(-u_particle_pos_offset),vec2(0),pos)*linearstep(vec2(1.0+u_particle_pos_offset),vec2(1),pos),vec2(4)
);highp vec2 per_frame_persist=pow(persist_rate,abs(dp)/u_particle_pos_offset);highp float drop_rate=1.0-per_frame_persist.x*per_frame_persist.y;drop_rate=any(greaterThanEqual(abs(pos-0.5),vec2(0.5+u_particle_pos_offset))) ? 1.0 : drop_rate;highp float drop=step(1.0-drop_rate-u_reset_rate,rand(seed));highp vec2 next_pos=mix(pos,random_pos,drop);glFragColor=pack_pos_to_rgba(next_pos);}`,"in vec2 a_pos;out vec2 v_tex_coord;void main() {v_tex_coord=0.5*(a_pos+vec2(1.0));gl_Position=vec4(a_pos,0.0,1.0);}"),symbol:jr(`#include "_prelude_lighting.glsl"
#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;uniform bool u_is_halo;uniform lowp float u_scale_factor;
#ifdef ICON_TRANSITION
uniform float u_icon_transition;
#endif
#ifdef COLOR_ADJUSTMENT
uniform mat4 u_color_adj_mat;
#endif
#ifdef INDICATOR_CUTOUT
in highp float v_z_offset;
#endif
in vec2 v_tex_a;
#ifdef ICON_TRANSITION
in vec2 v_tex_b;
#endif
in float v_draw_halo;in vec3 v_gamma_scale_size_fade_opacity;
#ifdef RENDER_TEXT_AND_SYMBOL
in float is_sdf;in vec2 v_tex_a_icon;
#endif
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
vec4 out_color;float fade_opacity=v_gamma_scale_size_fade_opacity[2];
#ifdef RENDER_TEXT_AND_SYMBOL
if (is_sdf==ICON) {vec2 tex_icon=v_tex_a_icon;lowp float alpha=opacity*fade_opacity;glFragColor=texture(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
return;}
#endif
#ifdef RENDER_SDF
float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_gamma_scale_size_fade_opacity.x;float size=v_gamma_scale_size_fade_opacity.y;float fontScale=u_is_text ? size/24.0 : size;out_color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;bool draw_halo=v_draw_halo > 0.0;if (draw_halo) {out_color=halo_color;gamma=(halo_blur*u_scale_factor*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width*u_scale_factor/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,v_tex_a).r;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);out_color*=alpha;
#else
#ifdef ICON_TRANSITION
vec4 a=texture(u_texture,v_tex_a)*(1.0-u_icon_transition);vec4 b=texture(u_texture,v_tex_b)*u_icon_transition;out_color=(a+b);
#else
out_color=texture(u_texture,v_tex_a);
#endif
#ifdef COLOR_ADJUSTMENT
out_color=u_color_adj_mat*out_color;
#endif
#endif
out_color*=opacity*fade_opacity;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,emissive_strength);
#endif
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color,v_z_offset);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
in vec4 a_pos_offset;in vec4 a_tex_size;in vec4 a_pixeloffset;in vec4 a_projected_pos;in float a_fade_opacity;
#ifdef Z_OFFSET
in float a_auto_z_offset;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_globe_anchor;in vec3 a_globe_normal;
#endif
#ifdef ICON_TRANSITION
in vec2 a_texb;
#endif
#ifdef OCCLUSION_QUERIES
in float a_occlusion_query_opacity;
#endif
#ifdef INDICATOR_CUTOUT
out highp float v_z_offset;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_elevation_from_sea;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;uniform bool u_is_halo;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
out vec2 v_tex_a;
#ifdef ICON_TRANSITION
out vec2 v_tex_b;
#endif
out float v_draw_halo;out vec3 v_gamma_scale_size_fade_opacity;
#ifdef RENDER_TEXT_AND_SYMBOL
out float is_sdf;out vec2 v_tex_a_icon;
#endif
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
#pragma mapbox: define lowp float occlusion_opacity
#pragma mapbox: define lowp float z_offset
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
#pragma mapbox: initialize lowp float occlusion_opacity
#pragma mapbox: initialize lowp float z_offset
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;float e=u_elevation_from_sea ? z_offset : z_offset+elevation(tile_anchor);
#ifdef Z_OFFSET
e+=a_auto_z_offset;
#endif
vec3 h=elevationVector(tile_anchor)*e;float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;vec3 world_pos_globe;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos_globe=a_globe_anchor+h;world_pos=mix_globe_mercator(world_pos_globe,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;vec2 a;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);vec4 projected_point_globe=u_matrix*vec4(world_pos_globe,1);a=projected_point_globe.xy/projected_point_globe.w;
#else
offsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);a=projected_point.xy/projected_point.w;
#endif
vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
#ifdef Z_OFFSET
z+=u_pitch_with_map ? a_auto_z_offset+(u_elevation_from_sea ? z_offset : z_offset) : 0.0;
#else
z+=u_pitch_with_map ? (u_elevation_from_sea ? z_offset : z_offset) : 0.0;
#endif
float occlusion_fade=globe_occlusion_fade;float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float out_fade_opacity=interpolated_fade_opacity*projection_transition_fade;
#ifdef DEPTH_OCCLUSION
float depth_occlusion=occlusionFadeMultiSample(projected_point);float depth_occlusion_multplier=mix(occlusion_opacity,1.0,depth_occlusion);out_fade_opacity*=depth_occlusion_multplier;
#endif
#ifdef OCCLUSION_QUERIES
float occludedFadeMultiplier=mix(occlusion_opacity,1.0,a_occlusion_query_opacity);out_fade_opacity*=occludedFadeMultiplier;
#endif
float alpha=opacity*out_fade_opacity;float hidden=float(alpha==0.0 || projected_point.w <=0.0 || occlusion_fade==0.0);
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,hidden);
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,hidden);
#endif
float gamma_scale=gl_Position.w;v_draw_halo=(u_is_halo && float(gl_InstanceID)==0.0) ? 1.0 : 0.0;v_gamma_scale_size_fade_opacity=vec3(gamma_scale,size,out_fade_opacity);v_tex_a=a_tex/u_texsize;
#ifdef RENDER_TEXT_AND_SYMBOL
is_sdf=a_size[0]-2.0*a_size_min;v_tex_a_icon=a_tex/u_texsize_icon;
#endif
#ifdef ICON_TRANSITION
v_tex_b=a_texb/u_texsize;
#endif
#ifdef INDICATOR_CUTOUT
v_z_offset=e;
#endif
}`),terrainRaster:jr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image0;in vec2 v_pos0;
#ifdef FOG
in float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
in vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;
#endif
uniform vec3 u_ground_shadow_factor;void main() {vec4 image_color=texture(u_image0,v_pos0);vec4 color;
#ifdef LIGHTING_3D_MODE
const vec3 normal=vec3(0.0,0.0,1.0);
#ifdef RENDER_SHADOWS
float cutoffOpacity=1.0;
#ifdef RENDER_CUTOFF
cutoffOpacity=cutoff_opacity(u_cutoff_params,1.0/gl_FragCoord.w);
#endif
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
vec3 unlit_base=image_color.rgb*(1.0-image_color.a);vec3 emissive_base=image_color.rgb*image_color.a;float ndotl=u_shadow_direction.z;float occlusion=ndotl < 0.0 ? 1.0 : shadow_occlusion(v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w,0.0);ndotl=max(0.0,ndotl);vec3 lit=apply_lighting(unlit_base,normal,mix(1.0,(1.0-(u_shadow_intensity*occlusion))*ndotl,cutoffOpacity));vec3 emissive=compute_emissive_draped(emissive_base,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=lit+emissive;color.a=1.0;
#else
float lighting_factor=shadowed_light_factor_normal_unbiased(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);color=apply_lighting(image_color,normal,mix(1.0,lighting_factor,cutoffOpacity));
#endif
#else
float lighting_factor=u_lighting_directional_dir.z;color=apply_lighting(image_color,normal,lighting_factor);
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
color.rgb=mix(color.rgb,image_color.rgb,image_color.a);color.a=1.0;
#endif
#endif
#else
color=image_color;
#endif
#ifdef FOG
#ifdef ZERO_EXAGGERATION
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#else
color=fog_dither(fog_apply_from_vert(color,v_fog_opacity));
#endif
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;uniform float u_skirt_height;in vec2 a_pos;out vec2 v_pos0;
#ifdef FOG
out float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;out float v_depth;
#endif
void main() {vec3 decomposedPosAndSkirt=decomposeToPosAndSkirt(a_pos);float skirt=decomposedPosAndSkirt.z;vec2 decodedPos=decomposedPosAndSkirt.xy;float elevation=elevation(decodedPos)-skirt*u_skirt_height;v_pos0=decodedPos/8192.0;gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);
#ifdef FOG
#ifdef ZERO_EXAGGERATION
v_fog_pos=fog_position(decodedPos);
#else
v_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));
#endif
#endif
#ifdef RENDER_SHADOWS
vec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);
#endif
}`),terrainDepth:jr("precision highp float;in float v_depth;void main() {glFragColor=pack_depth(v_depth);}",`#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;in vec2 a_pos;out float v_depth;void main() {float elevation=elevation(a_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}`),skybox:jr(`#include "_prelude_fog.fragment.glsl"
in lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(
cos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=texture(u_cubemap,uv).rgb;
#ifdef FOG
sky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);
#endif
sky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);glFragColor=vec4(sky_color*u_opacity,u_opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,tp),skyboxGradient:jr(`#include "_prelude_fog.fragment.glsl"
in highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture(u_color_ramp,vec2(progress,0.5));
#ifdef FOG
color.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;
#endif
color*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,tp),skyboxCapture:jr(`
in highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;precision highp float;
#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)
#define BETA_M                  vec3(21e-6,21e-6,21e-6)
#define MIE_G                   0.76
#define DENSITY_HEIGHT_SCALE_R  8000.0
#define DENSITY_HEIGHT_SCALE_M  1200.0
#define PLANET_RADIUS           6360e3
#define ATMOSPHERE_RADIUS       6420e3
#define SAMPLE_STEPS            10
#define DENSITY_STEPS           4
float ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;glFragColor=vec4(color,1.0);}`,"in highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;out highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:jr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image0;uniform float u_far_z_cutoff;in vec2 v_pos0;
#ifndef FOG
uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;
#endif
void main() {vec4 color;
#ifdef CUSTOM_ANTIALIASING
vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);vec3 dir=normalize(ray_dir);vec3 closest_point=dot(u_globe_pos,dir)*dir;float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture(u_image0,v_pos0);
#ifdef LIGHTING_3D_MODE
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
raster=apply_lighting_with_emission_ground(raster,raster.a);color=vec4(raster.rgb*antialias,antialias);
#else
raster=apply_lighting_ground(raster);color=vec4(raster.rgb*antialias,raster.a*antialias);
#endif
#else
color=vec4(raster.rgb*antialias,raster.a*antialias);
#endif
#else
color=texture(u_image0,v_pos0);
#ifdef LIGHTING_3D_MODE
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
color=apply_lighting_with_emission_ground(color,color.a);color.a=1.0;
#else
color=apply_lighting_ground(color);
#endif
#endif
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
color*=1.0-step(u_far_z_cutoff,1.0/gl_FragCoord.w);glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;uniform float u_skirt_height;
#ifdef GLOBE_POLES
in vec3 a_globe_pos;in vec2 a_uv;
#else
in vec2 a_pos;
#endif
out vec2 v_pos0;void main() {
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;vec2 uv=a_uv;
#else
float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);
#endif
v_pos0=uv;vec2 tile_pos=uv*EXTENT;vec3 globe_derived_up_vector=normalize(globe_pos)*u_tile_up_scale;
#ifdef GLOBE_POLES
vec3 up_vector=globe_derived_up_vector;
#else
vec3 up_vector=elevationVector(tile_pos);
#endif
float height=elevation(tile_pos);globe_pos+=up_vector*height;
#ifndef GLOBE_POLES
globe_pos-=globe_derived_up_vector*u_skirt_height*decomposed_pos_and_skirt.z;
#endif
#ifdef GLOBE_POLES
vec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);
#else
vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height-u_skirt_height*decomposed_pos_and_skirt.z,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);
#endif
gl_Position=u_proj_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
}`),globeAtmosphere:jr(`#include "_prelude_fog.fragment.glsl"
uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec4 u_color;uniform vec4 u_high_color;uniform vec4 u_space_color;uniform float u_horizon_angle;in highp vec3 v_ray_dir;in highp vec3 v_horizon_dir;void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;
#ifdef PROJECTION_GLOBE_VIEW
globe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {
#ifdef ALPHA_PASS
glFragColor=vec4(0,0,0,0);return;
#else
#ifdef NATIVE
glFragColor=vec4(1,1,1,1);
#else
glFragColor=vec4(0,0,0,1);
#endif
return;
#endif
}
#endif
highp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?
0.0 : max(acos(clamp(dot(dir,horizon_dir),-1.0,1.0)),0.0);float horizon_angle;
#ifdef PROJECTION_GLOBE_VIEW
highp vec3 closest_point=globe_pos_dot_dir*dir;highp float closest_point_to_center=length(closest_point-u_globe_pos);highp float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?
PI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);
#else
horizon_angle=horizon_angle_mercator;
#endif
horizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;
#ifdef ALPHA_PASS
float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);glFragColor=vec4(1.0,1.0,1.0,a);
#else
vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c=c2;
#ifndef NATIVE
c=dither(c,gl_FragCoord.xy+u_temporal_offset);
#endif
glFragColor=vec4(c*t,t);
#endif
}`,`in vec3 a_pos;in vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;out highp vec3 v_ray_dir;out highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(
mix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}`),model:jr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform float u_opacity;uniform vec3 u_lightcolor;uniform vec3 u_lightpos;uniform float u_lightintensity;uniform vec4 u_baseColorFactor;uniform vec4 u_emissiveFactor;uniform float u_metallicFactor;uniform float u_roughnessFactor;uniform float u_emissive_strength;in highp vec4 v_position_height;in lowp vec4 v_color_mix;
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in float v_depth_shadows;
#endif
#ifdef OCCLUSION_TEXTURE_TRANSFORM
uniform vec4 u_occlusionTextureTransform;
#endif
#pragma mapbox: define-attribute highp vec3 normal_3f
#pragma mapbox: define-attribute highp vec3 color_3f
#pragma mapbox: define-attribute highp vec4 color_4f
#pragma mapbox: define-attribute highp vec2 uv_2f
#pragma mapbox: initialize-attribute highp vec3 normal_3f
#pragma mapbox: initialize-attribute highp vec3 color_3f
#pragma mapbox: initialize-attribute highp vec4 color_4f
#pragma mapbox: initialize-attribute highp vec2 uv_2f
#ifdef HAS_ATTRIBUTE_a_pbr
in lowp vec4 v_roughness_metallic_emissive_alpha;in mediump vec4 v_height_based_emission_params;
#endif
#ifdef HAS_TEXTURE_u_baseColorTexture
uniform sampler2D u_baseColorTexture;uniform bool u_baseTextureIsAlpha;uniform bool u_alphaMask;uniform float u_alphaCutoff;
#endif
#ifdef HAS_TEXTURE_u_metallicRoughnessTexture
uniform sampler2D u_metallicRoughnessTexture;
#endif
#ifdef HAS_TEXTURE_u_occlusionTexture
uniform sampler2D u_occlusionTexture;uniform float u_aoIntensity;
#endif
#ifdef HAS_TEXTURE_u_normalTexture
uniform sampler2D u_normalTexture;
#endif
#ifdef HAS_TEXTURE_u_emissionTexture
uniform sampler2D u_emissionTexture;
#endif
#ifdef APPLY_LUT_ON_GPU
uniform highp sampler3D u_lutTexture;
#endif
#ifdef TERRAIN_FRAGMENT_OCCLUSION
in highp float v_depth;uniform highp sampler2D u_depthTexture;uniform highp vec2 u_inv_depth_size;uniform highp vec2 u_depth_range_unpack;
#ifdef DEPTH_D24
highp float unpack_depth(highp float depth) {return  depth*u_depth_range_unpack.x+u_depth_range_unpack.y;}
#else
highp float unpack_depth_rgba(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}
#endif
bool isOccluded() {highp vec2 coord=gl_FragCoord.xy*u_inv_depth_size;
#ifdef DEPTH_D24
highp float depth=unpack_depth(texture(u_depthTexture,coord).r);
#else
highp float depth=unpack_depth_rgba(texture(u_depthTexture,coord));
#endif
return v_depth > depth+0.0005;}
#endif
#define saturate(_x) clamp(_x,0.,1.)
vec3 linearTosRGB(vec3 color) {return pow(color,vec3(1./2.2));}vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}float calculate_NdotL(vec3 normal,vec3 lightDir) {const float ext=0.70710678118;return (clamp(dot(normal,lightDir),-ext,1.0)+ext)/(1.0+ext);}vec3 getDiffuseShadedColor(vec3 albedo,vec3 normal,vec3 lightDir,vec3 lightColor)
{
#ifdef LIGHTING_3D_MODE
vec3 transformed_normal=vec3(-normal.xy,normal.z);float lighting_factor;
#ifdef RENDER_SHADOWS
lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
lighting_factor=saturate(dot(transformed_normal,u_lighting_directional_dir));
#endif
return apply_lighting(albedo,transformed_normal,lighting_factor);
#else
vec3 n=normal;float colorvalue=((albedo.x*0.2126)+(albedo.y*0.7152))+(albedo.z*0.0722);vec3 c=vec3(0.03,0.03,0.03);float directional=clamp(dot(n,vec3(lightDir)),0.0,1.0);directional=mix(1.0-u_lightintensity,max((1.0-colorvalue)+u_lightintensity,1.0),directional);vec3 c3=c+clamp((albedo*directional)*lightColor,mix(vec3(0.0),vec3(0.3),vec3(1.0)-lightColor),vec3(1.0));return c3;
#endif
}vec4 getBaseColor() {vec4 albedo=u_baseColorFactor;
#ifdef HAS_ATTRIBUTE_a_color_3f
albedo*=vec4(color_3f,1.0);
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
#else
#ifdef HAS_ATTRIBUTE_a_color_4f
albedo*=color_4f;
#endif
#endif
#if defined (HAS_TEXTURE_u_baseColorTexture) && defined (HAS_ATTRIBUTE_a_uv_2f)
vec4 texColor=texture(u_baseColorTexture,uv_2f);if(u_alphaMask) {if (texColor.w < u_alphaCutoff) {discard;}}
#ifdef UNPREMULT_TEXTURE_IN_SHADER
if(texColor.w > 0.0) {texColor.rgb/=texColor.w;}texColor.w=1.0;
#endif
if(u_baseTextureIsAlpha) {if (texColor.r < 0.5) {discard;}} else {texColor.rgb=sRGBToLinear(texColor.rgb);albedo*=texColor;}
#endif
vec4 color=vec4(mix(albedo.rgb,v_color_mix.rgb,v_color_mix.a),albedo.a);
#ifdef APPLY_LUT_ON_GPU
color=applyLUT(u_lutTexture,color);
#endif
return color;}highp mat3 cotangentFrame(highp vec3 N,highp vec3 p,highp vec2 uv ) {
#ifdef HAS_TEXTURE_u_normalTexture
highp vec3 dp1=vec3(dFdx(p.x),dFdx(p.y),dFdx(p.z));highp vec3 dp2=vec3(dFdy(p.x),dFdy(p.y),dFdy(p.z));highp vec2 duv1=vec2(dFdx(uv.x),dFdx(uv.y));highp vec2 duv2=vec2(dFdy(uv.x),dFdy(uv.y));highp vec3 dp2perp=cross( dp2,N );highp vec3 dp1perp=cross( N,dp1 );highp vec3 T=dp2perp*duv1.x+dp1perp*duv2.x;highp vec3 B=dp2perp*duv1.y+dp1perp*duv2.y;highp float lengthT=dot(T,T);highp float lengthB=dot(B,B);highp float maxLength=max(lengthT,lengthB);highp float invmax=inversesqrt( maxLength );highp mat3 res=mat3( T*invmax,B*invmax,N );return res;
#else
return mat3(1.0);
#endif
}highp vec3 getNormal(){highp vec3 n;
#ifdef HAS_ATTRIBUTE_a_normal_3f
n=normalize(normal_3f);
#else
highp vec3 fdx=vec3(dFdx(v_position_height.x),dFdx(v_position_height.y),dFdx(v_position_height.z));highp vec3 fdy=vec3(dFdy(v_position_height.x),dFdy(v_position_height.y),dFdy(v_position_height.z));n=normalize(cross(fdx,fdy))*-1.0;
#endif
#if defined(HAS_TEXTURE_u_normalTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
vec3 nMap=texture( u_normalTexture,uv_2f).xyz;nMap=normalize(2.0*nMap-vec3(1.0));highp vec3 v=normalize(-v_position_height.xyz);highp mat3 TBN=cotangentFrame(n,v,uv_2f);n=normalize(TBN*nMap);
#endif
return n;}struct Material {float perceptualRoughness;float alphaRoughness;float metallic;vec3 f90;vec4 baseColor;vec3 diffuseColor;vec3 specularColor;highp vec3 normal;};Material getPBRMaterial() {Material mat;mat.baseColor=getBaseColor();mat.perceptualRoughness=u_roughnessFactor;mat.metallic=u_metallicFactor;
#ifdef HAS_ATTRIBUTE_a_pbr
mat.perceptualRoughness=v_roughness_metallic_emissive_alpha.x;mat.metallic=v_roughness_metallic_emissive_alpha.y;mat.baseColor.w*=v_roughness_metallic_emissive_alpha.w;
#endif
#if defined(HAS_TEXTURE_u_metallicRoughnessTexture) && defined(HAS_ATTRIBUTE_a_uv_2f) 
vec4 mrSample=texture(u_metallicRoughnessTexture,uv_2f);mat.perceptualRoughness*=mrSample.g;mat.metallic*=mrSample.b;
#endif
const float c_minRoughness=0.04;mat.perceptualRoughness=clamp(mat.perceptualRoughness,c_minRoughness,1.0);mat.metallic=saturate(mat.metallic);mat.alphaRoughness=mat.perceptualRoughness*mat.perceptualRoughness;const vec3 f0=vec3(0.04);mat.diffuseColor=mat.baseColor.rgb*(vec3(1.0)-f0);mat.diffuseColor*=1.0-mat.metallic;mat.specularColor=mix(f0,mat.baseColor.rgb,mat.metallic);highp float reflectance=max(max(mat.specularColor.r,mat.specularColor.g),mat.specularColor.b);highp float reflectance90=saturate(reflectance*25.0);mat.f90=vec3(reflectance90);mat.normal=getNormal();return mat;}float V_GGX(float NdotL,float NdotV,float roughness)
{float a2=roughness*roughness;float GGXV=NdotL*sqrt(NdotV*NdotV*(1.0-a2)+a2);float GGXL=NdotV*sqrt(NdotL*NdotL*(1.0-a2)+a2);return 0.5/(GGXV+GGXL);}float V_GGXFast(float NdotL,float NdotV,float roughness) {float a=roughness;float GGXV=NdotL*(NdotV*(1.0-a)+a);float GGXL=NdotV*(NdotL*(1.0-a)+a);return 0.5/(GGXV+GGXL);}vec3 F_Schlick(vec3 specularColor,vec3 f90,float VdotH)
{return specularColor+(f90-specularColor)*pow(clamp(1.0-VdotH,0.0,1.0),5.0);}vec3 F_SchlickFast(vec3 specularColor,float VdotH)
{float x=1.0-VdotH;float x4=x*x*x*x;return specularColor+(1.0-specularColor)*x4*x;}float D_GGX(highp float NdotH,float alphaRoughness)
{highp float a4=alphaRoughness*alphaRoughness;highp float f=(NdotH*a4-NdotH)*NdotH+1.0;return a4/(PI*f*f);}vec3 diffuseBurley(Material mat,float LdotH,float NdotL,float NdotV)
{float f90=2.0*LdotH*LdotH*mat.alphaRoughness-0.5;return (mat.diffuseColor/PI)*(1.0+f90*pow((1.0-NdotL),5.0))*(1.0+f90*pow((1.0-NdotV),5.0));}vec3 diffuseLambertian(Material mat)
{
#ifdef LIGHTING_3D_MODE
return mat.diffuseColor;
#else
return mat.diffuseColor/PI;
#endif
}vec3 EnvBRDFApprox(vec3 specularColor,float roughness,highp float NdotV)
{vec4 c0=vec4(-1,-0.0275,-0.572,0.022);vec4 c1=vec4(1,0.0425,1.04,-0.04);highp vec4 r=roughness*c0+c1;highp float a004=min(r.x*r.x,exp2(-9.28*NdotV))*r.x+r.y;vec2 AB=vec2(-1.04,1.04)*a004+r.zw;return specularColor*AB.x+AB.y;}vec3 computeIndirectLightContribution(Material mat,float NdotV,vec3 normal)
{vec3 env_light=vec3(0.65,0.65,0.65);
#ifdef LIGHTING_3D_MODE
float ambient_factor=calculate_ambient_directional_factor(normal);env_light=u_lighting_ambient_color*ambient_factor;
#endif
vec3 envBRDF=EnvBRDFApprox(mat.specularColor,mat.perceptualRoughness,NdotV);vec3 indirectSpecular= envBRDF*env_light;vec3 indirectDiffuse=mat.diffuseColor*env_light;return indirectSpecular+indirectDiffuse;}vec3 computeLightContribution(Material mat,vec3 lightPosition,vec3 lightColor)
{highp vec3 n=mat.normal;highp vec3 v=normalize(-v_position_height.xyz);highp vec3 l=normalize(lightPosition);highp vec3 h=normalize(v+l);float NdotV=clamp(abs(dot(n,v)),0.001,1.0);float NdotL=saturate(dot(n,l));highp float NdotH=saturate(dot(n,h));float VdotH=saturate(dot(v,h));vec3 f=F_SchlickFast(mat.specularColor,VdotH);float g=V_GGXFast(NdotL,NdotV,mat.alphaRoughness);float d=D_GGX(NdotH,mat.alphaRoughness);vec3 diffuseTerm=(1.0-f)*diffuseLambertian(mat);vec3 specularTerm=f*g*d;vec3 transformed_normal=vec3(-n.xy,n.z);float lighting_factor;
#ifdef RENDER_SHADOWS
lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
lighting_factor=NdotL;
#endif
vec3 directLightColor=(specularTerm+diffuseTerm)*lighting_factor*lightColor;vec3 indirectLightColor=computeIndirectLightContribution(mat,NdotV,transformed_normal);vec3 color=(saturate(directLightColor)+indirectLightColor);float intensityFactor=1.0;
#if !defined(LIGHTING_3D_MODE)
const vec3 luminosityFactor=vec3(0.2126,0.7152,0.0722);float luminance=dot(diffuseTerm,luminosityFactor);intensityFactor=mix((1.0-u_lightintensity),max((1.0-luminance+u_lightintensity),1.0),NdotL);
#endif
color*=intensityFactor;return color;}void main() {
#ifdef TERRAIN_FRAGMENT_OCCLUSION
if (isOccluded()) {discard;}
#endif
vec3 lightDir=u_lightpos;vec3 lightColor=u_lightcolor;
#ifdef LIGHTING_3D_MODE
lightDir=u_lighting_directional_dir;lightDir.xy=-lightDir.xy;lightColor=u_lighting_directional_color;
#endif
vec4 finalColor;
#ifdef DIFFUSE_SHADED
vec3 N=getNormal();vec3 baseColor=getBaseColor().rgb;vec3 diffuse=getDiffuseShadedColor(baseColor,N,lightDir,lightColor);
#ifdef HAS_TEXTURE_u_occlusionTexture
float ao=(texture(u_occlusionTexture,uv_2f).r-1.0)*u_aoIntensity+1.0;diffuse*=ao;
#endif
finalColor=vec4(mix(diffuse,baseColor,u_emissive_strength),1.0)*u_opacity;
#else
Material mat=getPBRMaterial();vec3 color=computeLightContribution(mat,lightDir,lightColor);float ao=1.0;
#if defined (HAS_TEXTURE_u_occlusionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
#ifdef OCCLUSION_TEXTURE_TRANSFORM
vec2 uv=uv_2f.xy*u_occlusionTextureTransform.zw+u_occlusionTextureTransform.xy;
#else
vec2 uv=uv_2f;
#endif
ao=(texture(u_occlusionTexture,uv).x-1.0)*u_aoIntensity+1.0;color*=ao;
#endif
vec4 emissive=u_emissiveFactor;
#if defined(HAS_TEXTURE_u_emissionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
emissive.rgb*=sRGBToLinear(texture(u_emissionTexture,uv_2f).rgb);
#endif
#ifdef APPLY_LUT_ON_GPU
float emissiveFactorLength=max(length(u_emissiveFactor.rgb),0.001);emissive.rgb=sRGBToLinear(applyLUT(u_lutTexture,linearTosRGB(emissive.rgb/emissiveFactorLength).rbg))*emissiveFactorLength;
#endif
color+=emissive.rgb;float opacity=mat.baseColor.w*u_opacity;
#ifdef HAS_ATTRIBUTE_a_pbr
float resEmission=v_roughness_metallic_emissive_alpha.z;resEmission*=v_height_based_emission_params.z+v_height_based_emission_params.w*pow(clamp(v_height_based_emission_params.x,0.0,1.0),v_height_based_emission_params.y);vec3 color_mix=v_color_mix.rgb;
#ifdef APPLY_LUT_ON_GPU
color_mix=applyLUT(u_lutTexture,color_mix);
#endif
color=mix(color,color_mix,min(1.0,resEmission));
#ifdef HAS_ATTRIBUTE_a_color_4f
float distance=length(vec2(1.3*max(0.0,abs(color_4f.x)-color_4f.z),color_4f.y));distance+= mix(0.5,0.0,clamp(resEmission-1.0,0.0,1.0));opacity*=v_roughness_metallic_emissive_alpha.w*saturate(1.0-distance*distance);
#endif
#endif
vec3 unlitColor=mat.baseColor.rgb*ao+emissive.rgb;color=mix(color,unlitColor,u_emissive_strength);color=linearTosRGB(color);color*=opacity;finalColor=vec4(color,opacity);
#endif
#ifdef FOG
finalColor=fog_dither(fog_apply_premultiplied(finalColor,v_fog_pos,v_position_height.w));
#endif
#ifdef RENDER_CUTOFF
finalColor*=v_cutoff_opacity;
#endif
#ifdef INDICATOR_CUTOUT
finalColor=applyCutout(finalColor,v_position_height.w);
#endif
glFragColor=finalColor;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec3 a_pos_3f;
#pragma mapbox: define-attribute highp vec3 normal_3f
#pragma mapbox: define-attribute highp vec2 uv_2f
#pragma mapbox: define-attribute highp vec3 color_3f
#pragma mapbox: define-attribute highp vec4 color_4f
#pragma mapbox: define-attribute-vertex-shader-only highp vec4 pbr
#pragma mapbox: define-attribute-vertex-shader-only highp vec3 heightBasedEmissiveStrength
uniform mat4 u_matrix;uniform mat4 u_node_matrix;uniform mat4 u_lighting_matrix;uniform vec3 u_camera_pos;uniform vec4 u_color_mix;
#ifdef INSTANCED_ARRAYS
in vec4 a_normal_matrix0;in vec4 a_normal_matrix1;in vec4 a_normal_matrix2;in vec4 a_normal_matrix3;
#else
uniform highp mat4 u_normal_matrix;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out float v_depth_shadows;
#endif
out vec4 v_position_height;out lowp vec4 v_color_mix;
#ifdef TERRAIN_FRAGMENT_OCCLUSION
out highp float v_depth;
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
out lowp vec4 v_roughness_metallic_emissive_alpha;out mediump vec4 v_height_based_emission_params;
#endif
vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}void main() {
#pragma mapbox: initialize-attribute highp vec3 normal_3f
#pragma mapbox: initialize-attribute highp vec2 uv_2f
#pragma mapbox: initialize-attribute highp vec3 color_3f
#pragma mapbox: initialize-attribute highp vec4 color_4f
#pragma mapbox: initialize-attribute-custom highp vec4 pbr
#pragma mapbox: initialize-attribute-custom highp vec3 heightBasedEmissiveStrength
highp mat4 normal_matrix;
#ifdef INSTANCED_ARRAYS
normal_matrix=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);
#else
normal_matrix=u_normal_matrix;
#endif
vec3 local_pos;mat3 rs;
#ifdef MODEL_POSITION_ON_GPU
vec3 pos_color=normal_matrix[0].xyz;vec4 translate=normal_matrix[1];vec3 pos_a=floor(pos_color);vec3 rgb=1.05*(pos_color-pos_a);float hidden=float(pos_a.x > EXTENT);float color_mix=pos_a.z/100.0;v_color_mix=vec4(sRGBToLinear(rgb),color_mix);float meter_to_tile=normal_matrix[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);rs[0].x=normal_matrix[1].w;rs[0].yz=normal_matrix[2].xy;rs[1].xy=normal_matrix[2].zw;rs[1].z=normal_matrix[3].x;rs[2].xyz=normal_matrix[3].yzw;vec4 pos_node=u_lighting_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;local_pos=pos.xyz;gl_Position=mix(u_matrix*pos,AWAY,hidden);pos.z*=meter_to_tile;v_position_height.xyz=pos.xyz-u_camera_pos;
#else
local_pos=a_pos_3f;gl_Position=u_matrix*vec4(a_pos_3f,1);v_position_height.xyz=vec3(u_lighting_matrix*vec4(a_pos_3f,1));v_color_mix=vec4(sRGBToLinear(u_color_mix.rgb),u_color_mix.a);
#endif
v_position_height.w=a_pos_3f.z;
#ifdef HAS_ATTRIBUTE_a_pbr
vec4 albedo_c=decode_color(pbr.xy);vec2 e_r_m=unpack_float(pbr.z);vec2 r_m= unpack_float(e_r_m.y*16.0);r_m.r=r_m.r*16.0;v_color_mix=vec4(albedo_c.rgb,1.0);v_roughness_metallic_emissive_alpha=vec4(vec3(r_m,e_r_m.x)/255.0,albedo_c.a);v_roughness_metallic_emissive_alpha.z*=2.0;float heightBasedRelativeIntepolation=a_pos_3f.z*heightBasedEmissiveStrength.x+heightBasedEmissiveStrength.y;v_height_based_emission_params.x=heightBasedRelativeIntepolation;v_height_based_emission_params.y=heightBasedEmissiveStrength.z;vec2 emissionMultiplierValues=unpack_float(pbr.w)/256.0;v_height_based_emission_params.z=emissionMultiplierValues.x;v_height_based_emission_params.w=emissionMultiplierValues.y-emissionMultiplierValues.x;
#endif
#ifdef FOG
v_fog_pos=fog_position(local_pos);
#endif
#ifdef RENDER_CUTOFF
v_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);
#endif
#ifdef TERRAIN_FRAGMENT_OCCLUSION
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef HAS_ATTRIBUTE_a_normal_3f
#ifdef MODEL_POSITION_ON_GPU
float x_squared_scale=dot(rs[0],rs[0]);float y_squared_scale=dot(rs[1],rs[1]);float z_squared_scale=dot(rs[2],rs[2]);vec3 squared_scale=vec3(x_squared_scale,y_squared_scale,z_squared_scale);normal_3f=rs*((u_lighting_matrix*vec4(normal_3f,0.0)).xyz/squared_scale);normal_3f=normalize(normal_3f);
#else
normal_3f=vec3(normal_matrix*vec4(normal_3f,0));
#endif
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
#ifdef HAS_ATTRIBUTE_a_color_4f
v_roughness_metallic_emissive_alpha.w=clamp(color_4f.a*v_roughness_metallic_emissive_alpha.w*(v_roughness_metallic_emissive_alpha.z-1.0),0.0,1.0);
#endif
#endif
#ifdef RENDER_SHADOWS
vec4 shadow_pos=u_node_matrix*vec4(local_pos,1.0);
#ifdef NORMAL_OFFSET
#ifdef HAS_ATTRIBUTE_a_normal_3f
#ifdef MODEL_POSITION_ON_GPU
vec3 offset=shadow_normal_offset(vec3(-normal_3f.xy,normal_3f.z));shadow_pos.xyz+=offset*shadow_normal_offset_multiplier0();
#else
vec3 offset=shadow_normal_offset_model(normal_3f);shadow_pos.xyz+=offset*shadow_normal_offset_multiplier0();
#endif
#endif
#endif
v_pos_light_view_0=u_light_matrix_0*shadow_pos;v_pos_light_view_1=u_light_matrix_1*shadow_pos;v_depth_shadows=gl_Position.w;
#endif
}`),modelDepth:jr(`in highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
glFragColor=pack_depth(v_depth);
#endif
}`,`in vec3 a_pos_3f;uniform mat4 u_matrix;out highp float v_depth;
#ifdef MODEL_POSITION_ON_GPU
#ifdef INSTANCED_ARRAYS
in vec4 a_normal_matrix0;in vec4 a_normal_matrix1;in vec4 a_normal_matrix2;in vec4 a_normal_matrix3;
#else
uniform highp mat4 u_instance;
#endif
uniform highp mat4 u_node_matrix;
#endif
void main() {
#ifdef MODEL_POSITION_ON_GPU
highp mat4 instance;
#ifdef INSTANCED_ARRAYS
instance=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);
#else
instance=u_instance;
#endif
vec3 pos_color=instance[0].xyz;vec4 translate=instance[1];vec3 pos_a=floor(pos_color);float hidden=float(pos_a.x > EXTENT);float meter_to_tile=instance[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);mat3 rs;rs[0].x=instance[1].w;rs[0].yz=instance[2].xy;rs[1].xy=instance[2].zw;rs[1].z=instance[3].x;rs[2].xyz=instance[3].yzw;vec4 pos_node=u_node_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;gl_Position=mix(u_matrix*pos,AWAY,hidden);
#else
gl_Position=u_matrix*vec4(a_pos_3f,1);
#endif
v_depth=gl_Position.z/gl_Position.w;}`),stars:jr(`in highp vec2 v_uv;in mediump float v_intensity;float shapeCircle(in vec2 uv)
{float beginFade=0.6;float lengthFromCenter=length(v_uv);return 1.0-clamp((lengthFromCenter-beginFade)/(1.0-beginFade),0.0,1.0);}void main() {float alpha=shapeCircle(v_uv);vec3 color=vec3(1.0,1.0,1.0);alpha*=v_intensity;glFragColor=vec4(color*alpha,alpha);HANDLE_WIREFRAME_DEBUG;}`,`
in vec3 a_pos_3f;in vec2 a_uv;in float a_size_scale;in float a_fade_opacity;uniform mat4 u_matrix;uniform vec3 u_up;uniform vec3 u_right;uniform float u_intensity_multiplier;out highp vec2 v_uv;out mediump float v_intensity;void main() {v_uv=a_uv;v_intensity=a_fade_opacity*u_intensity_multiplier;vec3 pos=a_pos_3f;pos+=a_uv.x*u_right*a_size_scale;pos+=a_uv.y*u_up*a_size_scale;gl_Position=u_matrix*vec4(pos,1.0);}`),snowParticle:jr("in highp vec2 uv;in highp float alphaMultiplier;uniform vec4 u_particleColor;uniform vec2 u_simpleShapeParameters;void main() {float t=clamp((length(uv)-u_simpleShapeParameters.x)/(1.0-u_simpleShapeParameters.x),0.0,1.0);float alpha=1.0-pow(t,pow(10.0,u_simpleShapeParameters.y));alpha*=alphaMultiplier;alpha*=u_particleColor.a;vec3 color=u_particleColor.rgb*alpha;glFragColor=vec4(color,alpha) ;HANDLE_WIREFRAME_DEBUG;}",`
in highp vec3 a_pos_3f;in highp vec2 a_uv;in highp vec4 a_snowParticleData;in highp vec4 a_snowParticleDataHorizontalOscillation;uniform mat4 u_modelview;uniform mat4 u_projection;uniform vec3 u_cam_pos;uniform vec2 u_screenSize;uniform float u_time;uniform float u_boxSize;uniform float u_velocityConeAperture; 
uniform float u_velocity;uniform vec3 u_direction;uniform float u_horizontalOscillationRadius; 
uniform float u_horizontalOscillationRate; 
uniform float u_billboardSize;uniform vec2 u_thinningCenterPos;uniform vec3 u_thinningShape;uniform float u_thinningAffectedRatio;uniform float u_thinningParticleOffset;out highp vec2 uv;out highp float alphaMultiplier;void main() {vec3 pos=a_pos_3f;float halfBoxSize=0.5*u_boxSize;pos.xyz*=halfBoxSize;pos+=u_cam_pos;float velocityConeApertureRad=radians(u_velocityConeAperture*0.5);float coneAnglePichRad=velocityConeApertureRad*a_snowParticleData.z;float coneAngleHeadingRad=a_snowParticleData.w*radians(360.0);vec3 localZ=normalize(u_direction);vec3 localX=normalize(cross(localZ,vec3(1,0,0)));vec3 localY=normalize(cross(localZ,localX));vec3 direction;direction.x=cos(coneAngleHeadingRad)*sin(coneAnglePichRad);direction.y=sin(coneAngleHeadingRad)*sin(coneAnglePichRad);direction.z=cos(coneAnglePichRad);direction=normalize(direction);vec3 simPosLocal=vec3(0,0,0);float velocityScale=(1.0+3.0*a_snowParticleData.y)*u_velocity;simPosLocal+=direction*velocityScale*u_time;float horizontalOscillationRadius=u_horizontalOscillationRadius*a_snowParticleDataHorizontalOscillation.x;float horizontalOscillationAngle=u_horizontalOscillationRate*u_time*(-1.0+2.0*a_snowParticleDataHorizontalOscillation.y);simPosLocal.xy+=horizontalOscillationRadius*vec2(cos(horizontalOscillationAngle),sin(horizontalOscillationAngle));vec3 simPos=localX*simPosLocal.x+
localY*simPosLocal.y+localZ*simPosLocal.z;pos+=simPos;pos=fract((pos+vec3(halfBoxSize))/vec3(u_boxSize))*u_boxSize-vec3(halfBoxSize);float clipZ=-u_cam_pos.z+pos.z;vec4 posView=u_modelview*vec4(pos,1.0);float size=u_billboardSize;alphaMultiplier=1.0;vec4 posScreen=u_projection*posView;posScreen/=posScreen.w;posScreen.xy=vec2(0.5)+posScreen.xy*0.5;posScreen.xy*=u_screenSize;vec2 thinningCenterPos=u_thinningCenterPos.xy;thinningCenterPos.y=u_screenSize.y-thinningCenterPos.y;float screenDist=length((thinningCenterPos-posScreen.xy)/(0.5*u_screenSize));screenDist+=a_snowParticleData.x*u_thinningParticleOffset;float scaleFactorMode=0.0;float thinningShapeDist=u_thinningShape.x+u_thinningShape.y;if (screenDist < thinningShapeDist) {float thinningFadeRatio=clamp((screenDist-u_thinningShape.x)/u_thinningShape.y,0.0,1.0);thinningFadeRatio=pow(thinningFadeRatio,u_thinningShape.z);if (a_snowParticleData.x < u_thinningAffectedRatio) {scaleFactorMode=1.0-thinningFadeRatio;alphaMultiplier=thinningFadeRatio;}}vec4 posScreen1=u_projection*vec4(posView.x-size,posView.yzw);posScreen1/=posScreen1.w;vec4 posScreen2=u_projection*vec4(posView.x+size,posView.yzw);posScreen2/=posScreen2.w;posScreen1.xy=vec2(0.5)+posScreen1.xy*0.5;posScreen1.xy*=u_screenSize;posScreen2.xy=vec2(0.5)+posScreen2.xy*0.5;posScreen2.xy*=u_screenSize;float screenLength=length(posScreen1.xy-posScreen2.xy);float screenEpsilon=3.0;float scaleFactor=1.0;if (screenLength < screenEpsilon) {scaleFactor=screenEpsilon/max(screenLength,0.01);scaleFactor=mix(scaleFactor,1.0,scaleFactorMode);}float screenEpsilon2=15.0;if (screenLength > screenEpsilon2) {scaleFactor=screenEpsilon2/max(screenLength,0.01);}size*=scaleFactor;vec2 right=size*vec2(1,0);vec2 up=size*vec2(0,1);posView.xy+=right*a_uv.x;posView.xy+=up*a_uv.y;uv=a_uv;gl_Position=u_projection*posView;}`),rainParticle:jr("in highp vec2 uv;in highp float particleRandomValue;uniform sampler2D u_texScreen;uniform float u_distortionStrength;uniform vec4 u_color;uniform vec2 u_thinningCenterPos;uniform vec3 u_thinningShape;uniform float u_thinningAffectedRatio;uniform float u_thinningParticleOffset;uniform float u_shapeDirectionalPower;uniform float u_mode;void main() {vec2 st=uv*0.5+vec2(0.5);vec2 uvm=uv;uvm.y=-1.0+2.0*pow(st.y,u_shapeDirectionalPower);float shape=clamp(1.0-length(uvm),0.0,1.0);float alpha=abs(shape)*u_color.a;vec2 screenSize=vec2(textureSize(u_texScreen,0));vec2 thinningCenterPos=u_thinningCenterPos.xy;thinningCenterPos.y=screenSize.y-thinningCenterPos.y;float screenDist=length((thinningCenterPos-gl_FragCoord.xy)/(0.5*screenSize));screenDist+=(0.5+0.5*particleRandomValue)*u_thinningParticleOffset;float thinningShapeDist=u_thinningShape.x+u_thinningShape.y;float thinningAlpha=1.0;if (screenDist < thinningShapeDist) {float thinningFadeRatio=clamp((screenDist-u_thinningShape.x)/u_thinningShape.y,0.0,1.0);thinningFadeRatio=pow(thinningFadeRatio,u_thinningShape.z);thinningAlpha*=thinningFadeRatio;}vec2 offsetXY=normalize(uvm)*abs(shape);vec2 stScreen=(gl_FragCoord.xy+offsetXY*u_distortionStrength*thinningAlpha)/screenSize;vec3 colorScreen=texture(u_texScreen,stScreen).rgb;alpha*=thinningAlpha;glFragColor=mix(vec4(colorScreen,1.0),vec4(u_color.rgb*alpha,alpha),u_mode);HANDLE_WIREFRAME_DEBUG;}",`
in highp vec3 a_pos_3f;in highp vec2 a_uv;in highp vec4 a_rainParticleData;uniform mat4 u_modelview;uniform mat4 u_projection;uniform vec3 u_cam_pos;uniform float u_time;uniform float u_boxSize;uniform float u_velocityConeAperture; 
uniform float u_velocity; 
uniform vec2 u_rainDropletSize;uniform vec3 u_rainDirection;out highp vec2 uv;out highp float particleRandomValue;void main() {vec3 pos=a_pos_3f;float halfBoxSize=0.5*u_boxSize;pos*=halfBoxSize; 
pos+=u_cam_pos;float velocityConeApertureRad=radians(u_velocityConeAperture*0.5);float coneAnglePichRad=velocityConeApertureRad*a_rainParticleData.z;float coneAngleHeadingRad=a_rainParticleData.w*radians(360.0);vec3 localZ=normalize(u_rainDirection);vec3 localX=normalize(cross(localZ,vec3(1,0,0)));vec3 localY=normalize(cross(localZ,localX));vec3 directionLocal;directionLocal.x=cos(coneAngleHeadingRad)*sin(coneAnglePichRad);directionLocal.y=sin(coneAngleHeadingRad)*sin(coneAnglePichRad);directionLocal.z=cos(coneAnglePichRad);directionLocal=normalize(directionLocal);vec3 directionWorld=localX*directionLocal.x+localY*directionLocal.y+localZ*directionLocal.z;float velocityScale=(1.0+3.0*a_rainParticleData.y)*u_velocity;vec3 simPosLocal=vec3(0,0,0);simPosLocal+=directionLocal*velocityScale*u_time;vec3 simPos=localX*simPosLocal.x+
localY*simPosLocal.y+localZ*simPosLocal.z;pos+=simPos;pos=fract((pos+vec3(halfBoxSize))/vec3(u_boxSize))*u_boxSize-vec3(halfBoxSize);vec4 posView=u_modelview*vec4(pos,1.0);vec3 directionView=normalize((u_modelview*vec4(directionWorld,0.0)).xyz);vec3 side=cross(directionView,normalize(posView.xyz));posView.xyz+=side*a_uv.x*u_rainDropletSize.x;posView.xyz+=directionView*a_uv.y*u_rainDropletSize.y;uv=a_uv;particleRandomValue=a_rainParticleData.x;gl_Position=u_projection*posView;}`),vignette:jr("uniform vec3 u_vignetteShape;uniform vec4 u_vignetteColor;in vec2 st;void main() {float screenDist=length(st);float alpha=clamp((screenDist-u_vignetteShape.x)/u_vignetteShape.y,0.0,1.0);alpha=pow(alpha,u_vignetteShape.z)*u_vignetteColor.a;vec3 color=u_vignetteColor.rgb;glFragColor=vec4(color*alpha,alpha) ;}","in vec2 a_pos_2f;out vec2 st;void main() {st=a_pos_2f;gl_Position=vec4(a_pos_2f,0,1);}"),occlusion:jr("uniform vec4 u_color;void main() {glFragColor=u_color;}",`#include "_prelude_terrain.vertex.glsl"
in highp vec2 a_offset_xy;uniform highp vec3 u_anchorPos;uniform mat4 u_matrix;uniform vec2 u_screenSizePx;uniform vec2 u_occluderSizePx;void main() {vec3 world_pos=u_anchorPos;
#ifdef TERRAIN
float e=elevation(world_pos.xy);world_pos.z+=e;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1.0);projected_point.xy+=projected_point.w*a_offset_xy*0.5*u_occluderSizePx/u_screenSizePx;gl_Position=projected_point;}`)};function fu(h,i){const l=h.replace(/\s*\/\/[^\n]*\n/g,`
`).split(`
`);for(let m of l)if(m=m.trim(),m[0]==="#"&&m.includes("if")&&!m.includes("endif")){m=m.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const v=m.split(" ");for(const x of v)i.includes(x)||i.push(x)}}function jr(h,i){const l=/#include\s+"([^"]+)"/g,m=/#pragma mapbox: ([\w\-]+) ([\w]+) ([\w]+) ([\w]+)/g;let v=i.match(/(attribute(\S*)|(^\s*|;)in) (highp |mediump |lowp )?([\w]+) ([\w]+)/gm);v&&(v=v.map(j=>{const G=j.split(" ");return G[G.length-1]}),v=[...new Set(v)]);const x={},E=[],L=[];if(h=h.replace(l,(j,G)=>(L.push(G),"")),(i=i.replace(l,(j,G)=>(E.push(G),""))).includes("flat out"))return void console.error('The usage of "flat" qualifier is disallowed, see: https://bugs.webkit.org/show_bug.cgi?id=268071');let $=[...nc];fu(h,$),fu(i,$);for(const j of[...E,...L])rc[j]||console.error(`Undefined include: ${j}`),Ml[j]||(Ml[j]=[],fu(rc[j],Ml[j])),$=[...$,...Ml[j]];return{fragmentSource:h=h.replace(m,(j,G,X,Y,ne)=>(x[ne]=!0,G==="define"?`
#ifndef HAS_UNIFORM_u_${ne}
in ${X} ${Y} ${ne};
#else
uniform ${X} ${Y} u_${ne};
#endif
`:G==="initialize"?`
#ifdef HAS_UNIFORM_u_${ne}
    ${X} ${Y} ${ne} = u_${ne};
#endif
`:G==="define-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${ne}
    in ${X} ${Y} ${ne};
#endif
`:G==="initialize-attribute"?"":void 0)),vertexSource:i=i.replace(m,(j,G,X,Y,ne)=>{const ve=Y==="float"?"vec2":Y,_e=ne.match(/color/)?"color":ve;return G==="define-attribute-vertex-shader-only"?`
#ifdef HAS_ATTRIBUTE_a_${ne}
in ${X} ${Y} a_${ne};
#endif
`:x[ne]?G==="define"?`
#ifndef HAS_UNIFORM_u_${ne}
uniform lowp float u_${ne}_t;
in ${X} ${ve} a_${ne};
out ${X} ${Y} ${ne};
#else
uniform ${X} ${Y} u_${ne};
#endif
`:G==="initialize"?_e==="vec4"?`
#ifndef HAS_UNIFORM_u_${ne}
    ${ne} = a_${ne};
#else
    ${X} ${Y} ${ne} = u_${ne};
#endif
`:`
#ifndef HAS_UNIFORM_u_${ne}
    ${ne} = unpack_mix_${_e}(a_${ne}, u_${ne}_t);
#else
    ${X} ${Y} ${ne} = u_${ne};
#endif
`:G==="define-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${ne}
    in ${X} ${Y} a_${ne};
    out ${X} ${Y} ${ne};
#endif
`:G==="initialize-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${ne}
    ${ne} = a_${ne};
#endif
`:void 0:G==="define"?`
#ifndef HAS_UNIFORM_u_${ne}
uniform lowp float u_${ne}_t;
in ${X} ${ve} a_${ne};
#else
uniform ${X} ${Y} u_${ne};
#endif
`:G==="define-instanced"?_e==="mat4"?`
#ifdef INSTANCED_ARRAYS
in vec4 a_${ne}0;
in vec4 a_${ne}1;
in vec4 a_${ne}2;
in vec4 a_${ne}3;
#else
uniform ${X} ${Y} u_${ne};
#endif
`:`
#ifdef INSTANCED_ARRAYS
in ${X} ${ve} a_${ne};
#else
uniform ${X} ${Y} u_${ne};
#endif
`:G==="initialize-attribute-custom"?`
#ifdef HAS_ATTRIBUTE_a_${ne}
    ${X} ${Y} ${ne} = a_${ne};
#endif
`:_e==="vec4"?`
#ifndef HAS_UNIFORM_u_${ne}
    ${X} ${Y} ${ne} = a_${ne};
#else
    ${X} ${Y} ${ne} = u_${ne};
#endif
`:`
#ifndef HAS_UNIFORM_u_${ne}
    ${X} ${Y} ${ne} = unpack_mix_${_e}(a_${ne}, u_${ne}_t);
#else
    ${X} ${Y} ${ne} = u_${ne};
#endif
`}),staticAttributes:v,usedDefines:$,vertexIncludes:E,fragmentIncludes:L}}class Sf{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(i,l,m,v,x,E,L,$){this.context=i;let j=this.boundPaintVertexBuffers.length!==v.length;for(let X=0;!j&&X<v.length;X++)this.boundPaintVertexBuffers[X]!==v[X]&&(j=!0);let G=this.boundDynamicVertexBuffers.length!==L.length;for(let X=0;!G&&X<L.length;X++)this.boundDynamicVertexBuffers[X]!==L[X]&&(G=!0);if(!this.vao||this.boundProgram!==l||this.boundLayoutVertexBuffer!==m||j||G||this.boundIndexBuffer!==x||this.boundVertexOffset!==E)this.freshBind(l,m,v,x,E,L,$);else{i.bindVertexArrayOES.set(this.vao);for(const X of L)X&&(X.bind(),$&&X.instanceCount&&X.setVertexAttribDivisor(i.gl,l,$));x&&x.dynamicDraw&&x.bind()}}freshBind(i,l,m,v,x,E,L){const $=i.numAttributes,j=this.context,G=j.gl;this.vao&&this.destroy(),this.vao=j.gl.createVertexArray(),j.bindVertexArrayOES.set(this.vao),this.boundProgram=i,this.boundLayoutVertexBuffer=l,this.boundPaintVertexBuffers=m,this.boundIndexBuffer=v,this.boundVertexOffset=x,this.boundDynamicVertexBuffers=E,l.enableAttributes(G,i),l.bind(),l.setVertexAttribPointers(G,i,x);for(const X of m)X.enableAttributes(G,i),X.bind(),X.setVertexAttribPointers(G,i,x);for(const X of E)X&&(X.enableAttributes(G,i),X.bind(),X.setVertexAttribPointers(G,i,x),L&&X.instanceCount&&X.setVertexAttribDivisor(G,i,L));v&&v.bind(),j.currentNumAttributes=$}destroy(){this.vao&&(this.context.gl.deleteVertexArray(this.vao),this.vao=null)}}function Dv(h,i){const l=Math.pow(2,i.canonical.z),m=i.canonical.y;return[new r.aa(0,m/l).toLngLat().lat,new r.aa(0,(m+1)/l).toLngLat().lat]}function zv(h,i,l,m,v,x,E){const L=h.context,$=L.gl,j=l.hillshadeFBO;if(!j)return;h.prepareDrawTile();const G=h.isTileAffectedByFog(i),X=h.getOrCreateProgram("hillshade",{overrideFog:G});L.activeTexture.set($.TEXTURE0),$.bindTexture($.TEXTURE_2D,j.colorAttachment.get());const Y=((Te,Ce,Re,je)=>{const Be=Re.paint.get("hillshade-shadow-color"),et=Re.paint.get("hillshade-shadow-color-use-theme").constantOr("default")==="none",Ze=Re.paint.get("hillshade-highlight-color"),Xe=Re.paint.get("hillshade-highlight-color-use-theme").constantOr("default")==="none",Ke=Re.paint.get("hillshade-accent-color"),at=Re.paint.get("hillshade-accent-color-use-theme").constantOr("default")==="none",pt=Re.paint.get("hillshade-emissive-strength");let Vt=r.ai(Re.paint.get("hillshade-illumination-direction"));if(Re.paint.get("hillshade-illumination-anchor")==="viewport")Vt-=Te.transform.angle;else if(Te.style&&Te.style.enable3dLights()&&Te.style.directionalLight){const ht=Te.style.directionalLight.properties.get("direction"),St=r.cb(ht.x,ht.y,ht.z);Vt=r.ai(St[1])}const Rt=!Te.options.moving;return{u_matrix:je||Te.transform.calculateProjMatrix(Ce.tileID.toUnwrapped(),Rt),u_image:0,u_latrange:Dv(0,Ce.tileID),u_light:[Re.paint.get("hillshade-exaggeration"),Vt],u_shadow:Be.toRenderColor(et?null:Re.lut),u_highlight:Ze.toRenderColor(Xe?null:Re.lut),u_emissive_strength:pt,u_accent:Ke.toRenderColor(at?null:Re.lut)}})(h,l,m,h.terrain?i.projMatrix:null);h.uploadCommonUniforms(L,X,i.toUnwrapped());const{tileBoundsBuffer:ne,tileBoundsIndexBuffer:ve,tileBoundsSegments:_e}=h.getTileBoundsBuffers(l);X.draw(h,$.TRIANGLES,v,x,E,mr.disabled,Y,m.id,ne,ve,_e)}function Cg(h,i,l){if(!i.needsDEMTextureUpload)return;const m=h.context,v=m.gl;m.pixelStoreUnpackPremultiplyAlpha.set(!1),i.demTexture=i.demTexture||h.getTileTexture(l.stride);const x=l.getPixels();i.demTexture?i.demTexture.update(x,{premultiply:!1}):i.demTexture=new r.T(m,x,v.R32F,{premultiply:!1}),i.needsDEMTextureUpload=!1}function Jc(h,i,l){const m=h.context,v=m.gl;if(!i.dem)return;const x=i.dem;if(m.activeTexture.set(v.TEXTURE1),Cg(h,i,x),!i.demTexture)return;i.demTexture.bind(v.NEAREST,v.CLAMP_TO_EDGE);const E=x.dim;m.activeTexture.set(v.TEXTURE0);let L=i.hillshadeFBO;if(!L){const Y=new r.T(m,{width:E,height:E,data:null},v.RGBA8);Y.bind(v.LINEAR,v.CLAMP_TO_EDGE),L=i.hillshadeFBO=m.createFramebuffer(E,E,!0,"renderbuffer"),L.colorAttachment.set(Y.texture)}m.bindFramebuffer.set(L.framebuffer),m.viewport.set([0,0,E,E]);const{tileBoundsBuffer:$,tileBoundsIndexBuffer:j,tileBoundsSegments:G}=h.getMercatorTileBoundsBuffers(),X=[];h.linearFloatFilteringSupported()&&X.push("TERRAIN_DEM_FLOAT_FORMAT"),h.getOrCreateProgram("hillshadePrepare",{defines:X}).draw(h,v.TRIANGLES,nr.disabled,Tr.disabled,zr.unblended,mr.disabled,((Y,ne)=>{const ve=ne.stride,_e=r.ab.mat4.create();return r.ab.mat4.ortho(_e,0,r.ag,-r.ag,0,0,1),r.ab.mat4.translate(_e,_e,[0,-r.ag,0]),{u_matrix:_e,u_image:1,u_dimension:[ve,ve],u_zoom:Y.overscaledZ}})(i.tileID,x),l.id,$,j,G),i.needsHillshadePrepare=!1}class $i{constructor(i){this.gl=i.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(i){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Qx extends $i{getDefault(){return r.aj.transparent}set(i){const l=this.current;(i.r!==l.r||i.g!==l.g||i.b!==l.b||i.a!==l.a||this.dirty)&&(this.gl.clearColor(i.r,i.g,i.b,i.a),this.current=i,this.dirty=!1)}}class ew extends $i{getDefault(){return 1}set(i){(i!==this.current||this.dirty)&&(this.gl.clearDepth(i),this.current=i,this.dirty=!1)}}class tw extends $i{getDefault(){return 0}set(i){(i!==this.current||this.dirty)&&(this.gl.clearStencil(i),this.current=i,this.dirty=!1)}}class Eg extends $i{getDefault(){return[!0,!0,!0,!0]}set(i){const l=this.current;(i[0]!==l[0]||i[1]!==l[1]||i[2]!==l[2]||i[3]!==l[3]||this.dirty)&&(this.gl.colorMask(i[0],i[1],i[2],i[3]),this.current=i,this.dirty=!1)}}class Mg extends $i{getDefault(){return!0}set(i){(i!==this.current||this.dirty)&&(this.gl.depthMask(i),this.current=i,this.dirty=!1)}}class Ig extends $i{getDefault(){return 255}set(i){(i!==this.current||this.dirty)&&(this.gl.stencilMask(i),this.current=i,this.dirty=!1)}}class Ag extends $i{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(i){const l=this.current;(i.func!==l.func||i.ref!==l.ref||i.mask!==l.mask||this.dirty)&&(this.gl.stencilFunc(i.func,i.ref,i.mask),this.current=i,this.dirty=!1)}}class Fv extends $i{getDefault(){const i=this.gl;return[i.KEEP,i.KEEP,i.KEEP]}set(i){const l=this.current;(i[0]!==l[0]||i[1]!==l[1]||i[2]!==l[2]||this.dirty)&&(this.gl.stencilOp(i[0],i[1],i[2]),this.current=i,this.dirty=!1)}}class Nv extends $i{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;const l=this.gl;i?l.enable(l.STENCIL_TEST):l.disable(l.STENCIL_TEST),this.current=i,this.dirty=!1}}class nw extends $i{getDefault(){return[0,1]}set(i){const l=this.current;(i[0]!==l[0]||i[1]!==l[1]||this.dirty)&&(this.gl.depthRange(i[0],i[1]),this.current=i,this.dirty=!1)}}class Tf extends $i{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;const l=this.gl;i?l.enable(l.DEPTH_TEST):l.disable(l.DEPTH_TEST),this.current=i,this.dirty=!1}}class Cf extends $i{getDefault(){return this.gl.LESS}set(i){(i!==this.current||this.dirty)&&(this.gl.depthFunc(i),this.current=i,this.dirty=!1)}}class Bv extends $i{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;const l=this.gl;i?l.enable(l.BLEND):l.disable(l.BLEND),this.current=i,this.dirty=!1}}class Es extends $i{getDefault(){const i=this.gl;return[i.ONE,i.ZERO,i.ONE,i.ZERO]}set(i){const l=this.current;(i[0]!==l[0]||i[1]!==l[1]||i[2]!==l[2]||i[3]!==l[3]||this.dirty)&&(this.gl.blendFuncSeparate(i[0],i[1],i[2],i[3]),this.current=i,this.dirty=!1)}}class kg extends $i{getDefault(){return r.aj.transparent}set(i){const l=this.current;(i.r!==l.r||i.g!==l.g||i.b!==l.b||i.a!==l.a||this.dirty)&&(this.gl.blendColor(i.r,i.g,i.b,i.a),this.current=i,this.dirty=!1)}}class op extends $i{getDefault(){return this.gl.FUNC_ADD}set(i){(i!==this.current||this.dirty)&&(this.gl.blendEquationSeparate(i,i),this.current=i,this.dirty=!1)}}class sp extends $i{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;const l=this.gl;i?l.enable(l.CULL_FACE):l.disable(l.CULL_FACE),this.current=i,this.dirty=!1}}class Pg extends $i{getDefault(){return this.gl.BACK}set(i){(i!==this.current||this.dirty)&&(this.gl.cullFace(i),this.current=i,this.dirty=!1)}}class Rg extends $i{getDefault(){return this.gl.CCW}set(i){(i!==this.current||this.dirty)&&(this.gl.frontFace(i),this.current=i,this.dirty=!1)}}let ap=class extends $i{getDefault(){return null}set(h){(h!==this.current||this.dirty)&&(this.gl.useProgram(h),this.current=h,this.dirty=!1)}};class Og extends $i{getDefault(){return this.gl.TEXTURE0}set(i){(i!==this.current||this.dirty)&&(this.gl.activeTexture(i),this.current=i,this.dirty=!1)}}class Lg extends $i{getDefault(){const i=this.gl;return[0,0,i.drawingBufferWidth,i.drawingBufferHeight]}set(i){const l=this.current;(i[0]!==l[0]||i[1]!==l[1]||i[2]!==l[2]||i[3]!==l[3]||this.dirty)&&(this.gl.viewport(i[0],i[1],i[2],i[3]),this.current=i,this.dirty=!1)}}class lp extends $i{getDefault(){return null}set(i){if(i===this.current&&!this.dirty)return;const l=this.gl;l.bindFramebuffer(l.FRAMEBUFFER,i),this.current=i,this.dirty=!1}}class Vv extends $i{getDefault(){return null}set(i){if(i===this.current&&!this.dirty)return;const l=this.gl;l.bindRenderbuffer(l.RENDERBUFFER,i),this.current=i,this.dirty=!1}}class $v extends $i{getDefault(){return null}set(i){if(i===this.current&&!this.dirty)return;const l=this.gl;l.bindTexture(l.TEXTURE_2D,i),this.current=i,this.dirty=!1}}class Qc extends $i{getDefault(){return null}set(i){if(i===this.current&&!this.dirty)return;const l=this.gl;l.bindBuffer(l.ARRAY_BUFFER,i),this.current=i,this.dirty=!1}}class rw extends $i{getDefault(){return null}set(i){const l=this.gl;l.bindBuffer(l.ELEMENT_ARRAY_BUFFER,i),this.current=i,this.dirty=!1}}class iw extends $i{getDefault(){return null}set(i){this.gl&&(i!==this.current||this.dirty)&&(this.gl.bindVertexArray(i),this.current=i,this.dirty=!1)}}class ow extends $i{getDefault(){return 4}set(i){if(i===this.current&&!this.dirty)return;const l=this.gl;l.pixelStorei(l.UNPACK_ALIGNMENT,i),this.current=i,this.dirty=!1}}class sw extends $i{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;const l=this.gl;l.pixelStorei(l.UNPACK_PREMULTIPLY_ALPHA_WEBGL,i),this.current=i,this.dirty=!1}}class aw extends $i{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;const l=this.gl;l.pixelStorei(l.UNPACK_FLIP_Y_WEBGL,i),this.current=i,this.dirty=!1}}class Dg extends $i{constructor(i,l){super(i),this.context=i,this.parent=l}getDefault(){return null}}class zg extends Dg{setDirty(){this.dirty=!0}set(i){if(i===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const l=this.gl;l.framebufferTexture2D(l.FRAMEBUFFER,l.COLOR_ATTACHMENT0,l.TEXTURE_2D,i,0),this.current=i,this.dirty=!1}}class up extends Dg{attachment(){return this.gl.DEPTH_ATTACHMENT}set(i){if(i===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const l=this.gl;l.framebufferRenderbuffer(l.FRAMEBUFFER,this.attachment(),l.RENDERBUFFER,i),this.current=i,this.dirty=!1}}class Uv extends Dg{attachment(){return this.gl.DEPTH_ATTACHMENT}set(i){if(i===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const l=this.gl;l.framebufferTexture2D(l.FRAMEBUFFER,this.attachment(),l.TEXTURE_2D,i,0),this.current=i,this.dirty=!1}}class ed extends up{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}const jv=(h,i,l)=>({u_matrix:h,u_image0:0,u_skirt_height:i,u_ground_shadow_factor:l}),Fg=(h,i,l,m,v,x,E,L,$,j,G,X,Y,ne,ve,_e)=>({u_proj_matrix:Float32Array.from(h),u_globe_matrix:i,u_normalize_matrix:Float32Array.from(m),u_merc_matrix:l,u_zoom_transition:v,u_merc_center:x,u_image0:0,u_frustum_tl:E,u_frustum_tr:L,u_frustum_br:$,u_frustum_bl:j,u_globe_pos:G,u_globe_radius:X,u_viewport:Y,u_grid_matrix:_e?Float32Array.from(_e):new Float32Array(9),u_skirt_height:ne,u_far_z_cutoff:ve});function Ng(h,i){return h!=null&&i!=null&&!(!h.hasData()||!i.hasData())&&h.demTexture!=null&&i.demTexture!=null&&h.tileID.key!==i.tileID.key}const hu=new class{constructor(){this.operations={}}newMorphing(h,i,l,m,v){if(h in this.operations){const x=this.operations[h];x.to.tileID.key!==l.tileID.key&&(x.queued=l)}else this.operations[h]={startTime:m,phase:0,duration:v,from:i,to:l,queued:null}}getMorphValuesForProxy(h){if(!(h in this.operations))return null;const i=this.operations[h];return{from:i.from,to:i.to,phase:i.phase}}update(h){for(const i in this.operations){const l=this.operations[i];for(l.phase=(h-l.startTime)/l.duration;l.phase>=1||!this._validOp(l);)if(!this._nextOp(l,h)){delete this.operations[i];break}}}_nextOp(h,i){return!!h.queued&&(h.from=h.to,h.to=h.queued,h.queued=null,h.phase=0,h.startTime=i,!0)}_validOp(h){return h.from.hasData()&&h.to.hasData()}},pu={0:null,1:"TERRAIN_VERTEX_MORPHING"};function Bg(h,i,l){if(i===0)return 0;const m=i<1&&l===514?.25/i:1;return 6*Math.pow(1.5,22-h)*Math.max(i,1)*m}function mu(h,i){const l=1<<h.z;return!i&&(h.x===0||h.x===l-1)||h.y===0||h.y===l-1}const Ef=h=>({u_matrix:h});function td(h,i,l,m,v){if(v>0){const x=r.q.now(),E=(x-h.timeAdded)/v,L=i?(x-i.timeAdded)/v:-1,$=l.getSource(),j=m.coveringZoomLevel({tileSize:$.tileSize,roundZoom:$.roundZoom}),G=!i||Math.abs(i.tileID.overscaledZ-j)>Math.abs(h.tileID.overscaledZ-j),X=G&&h.refreshedUponExpiration?1:r.aw(G?E:1-L,0,1);return h.refreshedUponExpiration&&E>=1&&(h.refreshedUponExpiration=!1),i?{opacity:1,mix:1-X}:{opacity:X,mix:0}}return{opacity:1,mix:0}}class Hv extends ua{constructor(i){const l={type:"raster-dem",maxzoom:i.transform.maxZoom},m=new r.D(r.ci(),null),v=hg("mock-dem",l,m,i.style);super("mock-dem",v,!1),v.setEventedParent(this),this._sourceLoaded=!0}_loadTile(i,l){i.state="loaded",l(null)}}class Gv extends ua{constructor(i){const l=hg("proxy",{type:"geojson",maxzoom:i.transform.maxZoom},new r.D(r.ci(),null),i.style);super("proxy",l,!1),l.setEventedParent(this),this.map=this.getSource().map=i,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(i,l,m){if(i.freezeTileCoverage)return;this.transform=i;const v=i.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((x,E)=>{if(x[E.key]="",!this._tiles[E.key]){const L=new uu(E,this._source.tileSize*E.overscaleFactor(),i.tileZoom);L.state="loaded",this._tiles[E.key]=L}return x},{});for(const x in this._tiles)x in v||(this.freeFBO(x),this._tiles[x].unloadVectorData(),delete this._tiles[x])}freeFBO(i){const l=this.proxyCachedFBO[i];if(l!==void 0){const m=Object.values(l);this.renderCachePool.push(...m),delete this.proxyCachedFBO[i]}}deallocRenderCache(){this.renderCache.forEach(i=>i.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class cp extends r.aG{constructor(i,l,m){super(i.overscaledZ,i.wrap,i.canonical.z,i.canonical.x,i.canonical.y),this.proxyTileKey=l,this.projMatrix=m}}class dp extends r.cJ{constructor(i,l){super(),this._debugParams={sortTilesHiZFirst:!0,disableRenderCache:!1},i.tp.registerParameter(this._debugParams,["Terrain"],"sortTilesHiZFirst",{},()=>{this._style.map.triggerRepaint()}),i.tp.registerParameter(this._debugParams,["Terrain"],"disableRenderCache",{},()=>{this._style.map.triggerRepaint()}),i.tp.registerButton(["Terrain"],"Invalidate Render Cache",()=>{this.invalidateRenderCache=!0,this._style.map.triggerRepaint()}),this.painter=i,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[m,v,x]=function($){const j=new r.b4,G=new r.aU,X=131;j.reserve(17161),G.reserve(33800);const Y=r.ag/128,ne=r.ag+Y/2,ve=ne+Y;for(let Te=-Y;Te<ve;Te+=Y)for(let Ce=-Y;Ce<ve;Ce+=Y){const Re=Ce<0||Ce>ne||Te<0||Te>ne?24575:0,je=r.aw(Math.round(Ce),0,r.ag),Be=r.aw(Math.round(Te),0,r.ag);j.emplaceBack(je+Re,Be)}const _e=(Te,Ce)=>{const Re=Ce*X+Te;G.emplaceBack(Re+1,Re,Re+X),G.emplaceBack(Re+X,Re+X+1,Re+1)};for(let Te=1;Te<129;Te++)for(let Ce=1;Ce<129;Ce++)_e(Ce,Te);return[0,129].forEach(Te=>{for(let Ce=0;Ce<130;Ce++)_e(Ce,Te),_e(Te,Ce)}),[j,G,32768]}(),E=i.context;this.gridBuffer=E.createVertexBuffer(m,r.b6.members),this.gridIndexBuffer=E.createIndexBuffer(v),this.gridSegments=r.b7.simpleSegment(0,0,m.length,v.length),this.gridNoSkirtSegments=r.b7.simpleSegment(0,0,m.length,x),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new Gv(l.map),this.orthoMatrix=r.ab.mat4.create(),r.ab.mat4.ortho(this.orthoMatrix,this.painter.transform.projection.name==="globe"?.015:0,r.ag,0,r.ag,0,1);const L=E.gl;this._overlapStencilMode=new Tr({func:L.GEQUAL,mask:255},0,255,L.KEEP,L.KEEP,L.REPLACE),this._previousZoom=i.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=l,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new Hv(l.map),this._pendingGroundEffectLayers=[]}set style(i){i.on("data",this._onStyleDataEvent.bind(this)),this._style=i,this._style.map.on("moveend",()=>{this._clearLineLayersFromRenderCache()})}update(i,l,m){if(i&&i.terrain){this._style!==i&&(this.style=i,this._evaluationZoom=void 0);const v=i.terrain.properties,x=i.terrain.drapeRenderMode===0,E=i.terrain.isZoomDependent();this._previousUpdateTimestamp=this.enabled?this._updateTimestamp:void 0,this._updateTimestamp=r.q.now();const L=i.terrain&&i.terrain.scope,$=v.get("source"),j=x?this._mockSourceCache:i.getSourceCache($,L);if(!j)return void r.w(`Couldn't find terrain source "${$}".`);if(this.sourceCache=j,this._attenuationRange=i.terrain.getAttenuationRange(),this._exaggeration=E?this.calculateExaggeration(l):v.get("exaggeration"),!l.projection.requiresDraping&&E&&this._exaggeration===0)return void this._disable();this.enabled=!0;const G=()=>{this.sourceCache.used&&r.w(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.
This leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const X=this.getScaledDemTileSize();this.sourceCache.update(l,X,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,G(),this._initializing=!0),G(),l.updateElevation(!0,m),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(l),this._emptyDEMTextureDirty=!0,this._previousZoom=l.zoom}else this._disable()}calculateExaggeration(i){if(this._attenuationRange&&i.zoom>=Math.ceil(this._attenuationRange[1]))return this._style.terrain.getExaggeration(i.zoom);const l=this._previousCameraAltitude,m=i.getFreeCameraOptions().position.z/i.pixelsPerMeter*i.worldSize;this._previousCameraAltitude=m;const v=l!=null?m-l:Number.MAX_VALUE;if(Math.abs(v)<2)return this._exaggeration;const x=i.zoom,E=this._style.terrain;if(!this._previousUpdateTimestamp)return E.getExaggeration(x);let L=x-this._previousZoom;const $=this._previousUpdateTimestamp;let j=x;this._evaluationZoom!=null&&(j=this._evaluationZoom,Math.abs(x-j)>.5&&(L=.5*(x-j+L)),L*v<0&&(j+=L)),this._evaluationZoom=j;const G=E.getExaggeration(j),X=G===E.getExaggeration(Math.max(0,j-.1));if(X&&Math.abs(G-this._exaggeration)<.01)return G;let Y=Math.min(.1,.00375*(this._updateTimestamp-$));return(X||G<.1||Math.abs(L)<1e-4)&&(Y=Math.min(.2,4*Y)),r.af(this._exaggeration,G,Y)}resetTileLookupCache(i){this._findCoveringTileCache[i]={}}attenuationRange(){return this._attenuationRange}getDemUpscale(){return this.proxySourceCache.getSource().tileSize/128}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_onStyleDataEvent(i){i.coord&&i.dataType==="source"?this._clearRenderCacheForTile(i.sourceCacheId,i.coord):i.dataType==="style"&&(this.invalidateRenderCache=!0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this._previousCameraAltitude=void 0)}_disable(){if(this.enabled&&(this.enabled=!1,this._emptyDEMTextureDirty=!0,this._sharedDepthStencil=void 0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const i in this._style._mergedSourceCaches)this._style._mergedSourceCaches[i].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this.pool.forEach(i=>i.fb.destroy()),this.pool=[],this.framebufferCopyTexture&&this.framebufferCopyTexture.destroy()}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this.enabled?this._exaggeration:0}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const i=2*this.proxySourceCache.getSource().tileSize;return[i,i]}set useVertexMorphing(i){this._useVertexMorphing=i}updateTileBinding(i){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const l=this.proxySourceCache,m=this.painter.transform;this._initializing&&(this._initializing=m._centerAltitude===0&&this.getAtPointOrZero(r.aa.fromLngLat(m.center),-1)===-1,this._emptyDEMTextureDirty=!this._initializing);const v=this.proxyCoords=l.getIds().map($=>{const j=l.getTileByID($).tileID;return j.projMatrix=m.calculateProjMatrix(j.toUnwrapped()),j});(function($,j){const G=j.transform.pointCoordinate(j.transform.getCameraPoint()),X=new r.P(G.x,G.y);$.sort((Y,ne)=>{if(ne.overscaledZ-Y.overscaledZ)return ne.overscaledZ-Y.overscaledZ;const ve=new r.P(Y.canonical.x+(1<<Y.canonical.z)*Y.wrap,Y.canonical.y),_e=new r.P(ne.canonical.x+(1<<ne.canonical.z)*ne.wrap,ne.canonical.y),Te=X.mult(1<<Y.canonical.z);return Te.x-=.5,Te.y-=.5,Te.distSqr(ve)-Te.distSqr(_e)})})(v,this.painter);const x=this.proxyToSource||{};this.proxyToSource={},v.forEach($=>{this.proxyToSource[$.key]={}}),this.terrainTileForTile={};const E=this._style._mergedSourceCaches;for(const $ in E){const j=E[$];if(!j.used||(j!==this.sourceCache&&this.resetTileLookupCache(j.id),this._setupProxiedCoordsForOrtho(j,i[$],x),j.usedForTerrain))continue;const G=i[$];j.getSource().reparseOverscaled&&this._assignTerrainTiles(G)}this.proxiedCoords[l.id]=v.map($=>new cp($,$.key,this.orthoMatrix)),this._assignTerrainTiles(v),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(x),this.renderingToTexture=!1;const L={};this._visibleDemTiles=[];for(const $ of this.proxyCoords){const j=this.terrainTileForTile[$.key];if(!j)continue;const G=j.tileID.key;G in L||(this._visibleDemTiles.push(j),L[G]=G)}}_assignTerrainTiles(i){this._initializing||i.forEach(l=>{if(this.terrainTileForTile[l.key])return;const m=this._findTileCoveringTileID(l,this.sourceCache);m&&(this.terrainTileForTile[l.key]=m)})}_prepareDEMTextures(){const i=this.painter.context,l=i.gl;for(const m in this.terrainTileForTile){const v=this.terrainTileForTile[m],x=v.dem;!x||v.demTexture&&!v.needsDEMTextureUpload||(i.activeTexture.set(l.TEXTURE1),Cg(this.painter,v,x))}}_prepareDemTileUniforms(i,l,m,v){if(!l||l.demTexture==null)return!1;const x=i.tileID.canonical,E=Math.pow(2,l.tileID.canonical.z-x.z),L=v||"";return m[`u_dem_tl${L}`]=[x.x*E%1,x.y*E%1],m[`u_dem_scale${L}`]=E,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}_getLoadedAreaMinimum(){if(!this.enabled)return 0;let i=0;const l=this._visibleDemTiles.reduce((m,v)=>{if(!v.dem)return m;const x=v.dem.tree.minimums[0];return x>0&&i++,m+x},0);return i?l/i:0}_updateEmptyDEMTexture(){const i=this.painter.context,l=i.gl;i.activeTexture.set(l.TEXTURE2);const m=this._getLoadedAreaMinimum(),v=new r.cK({width:1,height:1},new Float32Array([m]));this._emptyDEMTextureDirty=!1;let x=this._emptyDEMTexture;return x?x.update(v,{premultiply:!1}):x=this._emptyDEMTexture=new r.T(i,v,l.R32F,{premultiply:!1}),x}setupElevationDraw(i,l,m){const v=this.painter.context,x=v.gl,E={u_dem:2,u_dem_prev:4,u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_depth_range_unpack:[0,1],u_occluder_half_size:16,u_occlusion_depth_offset:-1e-4,u_exaggeration:0};E.u_exaggeration=this.exaggeration();let L=null,$=null,j=1;if(m&&m.morphing&&this._useVertexMorphing){const ne=m.morphing.srcDemTile,ve=m.morphing.dstDemTile;j=m.morphing.phase,ne&&ve&&(this._prepareDemTileUniforms(i,ne,E,"_prev")&&($=ne),this._prepareDemTileUniforms(i,ve,E)&&(L=ve))}const G=ne=>ne&&ne.demTexture&&this.painter.linearFloatFilteringSupported()?x.LINEAR:x.NEAREST;let X=null;var Y;if(this.enabled?$&&L?(X=L.demTexture,v.activeTexture.set(x.TEXTURE4),$.demTexture.bind(G($),x.CLAMP_TO_EDGE),E.u_dem_lerp=j):(L=this.terrainTileForTile[i.tileID.key],X=this._prepareDemTileUniforms(i,L,E)?L.demTexture:this.emptyDEMTexture):X=this.emptyDEMTexture,v.activeTexture.set(x.TEXTURE2),X&&(E.u_dem_size=(Y=X).size[0]===1?1:Y.size[0]-2,X.bind(G(L),x.CLAMP_TO_EDGE)),this.painter.setupDepthForOcclusion(m&&m.useDepthForOcclusion,l,E),m&&m.useMeterToDem&&L){const ne=(1<<L.tileID.canonical.z)*r.bH(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;E.u_meter_to_dem=ne}if(m&&m.labelPlaneMatrixInv&&(E.u_label_plane_matrix_inv=m.labelPlaneMatrixInv),l.setTerrainUniformValues(v,E),this.painter.transform.projection.name==="globe"){const ne=this.globeUniformValues(this.painter.transform,i.tileID.canonical,m&&m.useDenormalizedUpVectorScale);l.setGlobeUniformValues(v,ne)}}globeUniformValues(i,l,m){const v=i.projection;return{u_tile_tl_up:v.upVector(l,0,0),u_tile_tr_up:v.upVector(l,r.ag,0),u_tile_br_up:v.upVector(l,r.ag,r.ag),u_tile_bl_up:v.upVector(l,0,r.ag),u_tile_up_scale:m?r.cL(1):v.upVectorScale(l,i.center.lat,i.worldSize).metersToTile}}renderToBackBuffer(i){const l=this.painter,m=this.painter.context;i.length!==0&&(m.bindFramebuffer.set(null),m.viewport.set([0,0,l.width,l.height]),l.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(v,x,E,L,$){if(v.transform.projection.name==="globe")(function(j,G,X,Y,ne){const ve=j.context,_e=ve.gl;let Te,Ce;const Re=j.transform,je=r.cC(j,ve,Re),Be=(ht,St)=>{if(Ce===St)return;const en=[pu[St],"PROJECTION_GLOBE_VIEW"];je&&en.push("CUSTOM_ANTIALIASING");const hn=j.isTileAffectedByFog(ht);Te=j.getOrCreateProgram("globeRaster",{defines:en,overrideFog:hn}),Ce=St},et=j.colorModeForRenderPass(),Ze=new nr(_e.LEQUAL,nr.ReadWrite,j.depthRangeFor3D);hu.update(ne);const Xe=r.cD(Re),Ke=[r.at(Re.center.lng),r.aA(Re.center.lat)],at=j.globeSharedBuffers,pt=[Re.width*r.q.devicePixelRatio,Re.height*r.q.devicePixelRatio],Vt=Float32Array.from(Re.globeMatrix),Rt={useDenormalizedUpVectorScale:!0};{const ht=j.transform,St=Bg(ht.zoom,G.exaggeration(),G.sourceCache._source.tileSize);Ce=-1;const en=_e.TRIANGLES;for(const hn of Y){const vn=X.getTile(hn),It=Tr.disabled,ln=G.prevTerrainTileForTile[hn.key],Ht=G.terrainTileForTile[hn.key];Ng(ln,Ht)&&hu.newMorphing(hn.key,ln,Ht,ne,250),ve.activeTexture.set(_e.TEXTURE0),vn.texture&&vn.texture.bind(_e.LINEAR,_e.CLAMP_TO_EDGE);const gn=hu.getMorphValuesForProxy(hn.key),cn=gn?1:0;gn&&r.J(Rt,{morphing:{srcDemTile:gn.from,dstDemTile:gn.to,phase:r.cB(gn.phase)}});const tn=r.cE(hn.canonical),Rn=r.cF(tn.getCenter().lat),Dn=r.cG(hn.canonical,tn,Rn,ht.worldSize/ht._pixelsPerMercatorPixel),An=r.bb(r.cH(hn.canonical)),Bn=Fg(ht.expandedFarZProjMatrix,Vt,Xe,An,r.ae(ht.zoom),Ke,ht.frustumCorners.TL,ht.frustumCorners.TR,ht.frustumCorners.BR,ht.frustumCorners.BL,ht.globeCenterInViewSpace,ht.globeRadius,pt,St,ht._farZ,Dn);if(Be(hn,cn),Te&&(G.setupElevationDraw(vn,Te,Rt),j.uploadCommonUniforms(ve,Te,hn.toUnwrapped()),at)){const[br,ir,rr]=at.getGridBuffers(Rn,St!==0);Te.draw(j,en,Ze,It,et,mr.backCCW,Bn,"globe_raster",br,ir,rr)}}}if(at&&(j.renderDefaultNorthPole||j.renderDefaultSouthPole)){const ht=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];je&&ht.push("CUSTOM_ANTIALIASING"),Te=j.getOrCreateProgram("globeRaster",{defines:ht});for(const St of Y){const{x:en,y:hn,z:vn}=St.canonical,It=hn===0,ln=hn===(1<<vn)-1,[Ht,gn,cn,tn]=at.getPoleBuffers(vn,!1);if(tn&&(It||ln)){const Rn=X.getTile(St);ve.activeTexture.set(_e.TEXTURE0),Rn.texture&&Rn.texture.bind(_e.LINEAR,_e.CLAMP_TO_EDGE);let Dn=r.cI(vn,en,Re);const An=r.bb(r.cH(St.canonical)),Bn=(br,ir)=>br.draw(j,_e.TRIANGLES,Ze,Tr.disabled,et,mr.disabled,Fg(Re.expandedFarZProjMatrix,Dn,Dn,An,0,Ke,Re.frustumCorners.TL,Re.frustumCorners.TR,Re.frustumCorners.BR,Re.frustumCorners.BL,Re.globeCenterInViewSpace,Re.globeRadius,pt,0,Re._farZ),"globe_pole_raster",ir,cn,tn);G.setupElevationDraw(Rn,Te,Rt),j.uploadCommonUniforms(ve,Te,St.toUnwrapped()),It&&j.renderDefaultNorthPole&&Bn(Te,Ht),ln&&j.renderDefaultSouthPole&&(Dn=r.ab.mat4.scale(r.ab.mat4.create(),Dn,[1,-1,1]),Bn(Te,gn))}}}})(v,x,E,L,$);else{const j=v.context,G=j.gl;let X,Y;const ne=v.shadowRenderer,ve=Tl(v,v.longestCutoffRange),_e=et=>{if(Y===et)return;const Ze=[];Ze.push(pu[et]),ve.shouldRenderCutoff&&Ze.push("RENDER_CUTOFF"),ne&&(Ze.push("RENDER_SHADOWS","DEPTH_TEXTURE"),ne.useNormalOffset&&Ze.push("NORMAL_OFFSET")),X=v.getOrCreateProgram("terrainRaster",{defines:Ze}),Y=et},Te=v.colorModeForRenderPass(),Ce=new nr(G.LEQUAL,nr.ReadWrite,v.depthRangeFor3D);hu.update($);const Re=v.transform,je=Bg(Re.zoom,x.exaggeration(),x.sourceCache._source.tileSize);let Be=[0,0,0];if(ne){const et=v.style.directionalLight,Ze=v.style.ambientLight;et&&Ze&&(Be=Zc(v.style,et,Ze))}{Y=-1;const et=G.TRIANGLES,[Ze,Xe]=[x.gridIndexBuffer,x.gridSegments];for(const Ke of L){const at=E.getTile(Ke),pt=Tr.disabled,Vt=x.prevTerrainTileForTile[Ke.key],Rt=x.terrainTileForTile[Ke.key];Ng(Vt,Rt)&&hu.newMorphing(Ke.key,Vt,Rt,$,250),j.activeTexture.set(G.TEXTURE0),at.texture&&at.texture.bind(G.LINEAR,G.CLAMP_TO_EDGE);const ht=hu.getMorphValuesForProxy(Ke.key),St=ht?1:0;let en;ht&&(en={morphing:{srcDemTile:ht.from,dstDemTile:ht.to,phase:r.cB(ht.phase)}});const hn=jv(Ke.projMatrix,mu(Ke.canonical,Re.renderWorldCopies)?je/10:je,Be);if(_e(St),!X)continue;x.setupElevationDraw(at,X,en);const vn=Ke.toUnwrapped();ne&&ne.setupShadows(vn,X),v.uploadCommonUniforms(j,X,vn,null,ve),X.draw(v,et,Ce,pt,Te,mr.backCCW,hn,"terrain_raster",x.gridBuffer,Ze,Xe)}}}}(l,this,this.proxySourceCache,i,this._updateTimestamp),this.renderingToTexture=!0,l.gpuTimingDeferredRenderEnd(),i.splice(0,i.length))}renderBatch(i){if(this._drapedRenderBatches.length===0)return i+1;this.renderingToTexture=!0;const l=this.painter,m=this.painter.context,v=this.proxySourceCache,x=this.proxiedCoords[v.id],E=this._drapedRenderBatches.shift(),L=l.style.order,$=[];let j=0;for(const G of x){const X=v.getTileByID(G.proxyTileKey),Y=v.proxyCachedFBO[G.key]?v.proxyCachedFBO[G.key][i]:void 0,ne=Y!==void 0?v.renderCache[Y]:this.pool[j++],ve=Y!==void 0;if(X.texture=ne.tex,ve&&!ne.dirty){$.push(X.tileID);continue}let _e;m.bindFramebuffer.set(ne.fb.framebuffer),this.renderedToTile=!1,ne.dirty&&(m.clear({color:r.aj.transparent,stencil:0}),ne.dirty=!1);for(let Te=E.start;Te<=E.end;++Te){const Ce=l.style._mergedLayers[L[Te]];if(Ce.isHidden(l.transform.zoom))continue;const Re=l.style.getLayerSourceCache(Ce),je=Re?this.proxyToSource[G.key][Re.id]:[G];if(!je)continue;const Be=je;m.viewport.set([0,0,ne.fb.width,ne.fb.height]),_e!==(Re?Re.id:null)&&(this._setupStencil(ne,je,Ce,Re),_e=Re?Re.id:null),l.renderLayer(l,Re,Ce,Be)}if(this._drapedRenderBatches.length===0)for(const Te of this._pendingGroundEffectLayers){const Ce=l.style._mergedLayers[L[Te]];if(Ce.isHidden(l.transform.zoom))continue;const Re=l.style.getLayerSourceCache(Ce),je=Re?this.proxyToSource[G.key][Re.id]:[G];if(!je)continue;const Be=je;m.viewport.set([0,0,ne.fb.width,ne.fb.height]),_e!==(Re?Re.id:null)&&(this._setupStencil(ne,je,Ce,Re),_e=Re?Re.id:null),l.renderLayer(l,Re,Ce,Be)}this.renderedToTile?(ne.dirty=!0,$.push(X.tileID)):ve||--j,j===5&&(j=0,this.renderToBackBuffer($))}return this.renderToBackBuffer($),this.renderingToTexture=!1,m.bindFramebuffer.set(null),m.viewport.set([0,0,l.width,l.height]),E.end+1}postRender(){}isLayerOrderingCorrect(i){const l=i.order.length;let m=-1,v=l;for(let x=0;x<l;++x)this._style.isLayerDraped(i._mergedLayers[i.order[x]])?m=Math.max(m,x):v=Math.min(v,x);return v>m}getMinElevationBelowMSL(){let i=0;return this._visibleDemTiles.filter(l=>l.dem).forEach(l=>{i=Math.min(i,l.dem.tree.minimums[0])}),i===0?i:(i-30)*this._exaggeration}raycast(i,l,m){if(!this._visibleDemTiles)return null;const v=this._visibleDemTiles.filter(x=>x.dem).map(x=>{const E=x.tileID,L=1<<E.overscaledZ,{x:$,y:j}=E.canonical,G=$/L,X=($+1)/L,Y=j/L,ne=(j+1)/L;return{minx:G,miny:Y,maxx:X,maxy:ne,t:x.dem.tree.raycastRoot(G,Y,X,ne,i,l,m),tile:x}});v.sort((x,E)=>(x.t!==null?x.t:Number.MAX_VALUE)-(E.t!==null?E.t:Number.MAX_VALUE));for(const x of v){if(x.t==null)return null;const E=x.tile.dem.tree.raycast(x.minx,x.miny,x.maxx,x.maxy,i,l,m);if(E!=null)return E}return null}_createFBO(){const i=this.painter.context,l=i.gl,m=this.drapeBufferSize;i.activeTexture.set(l.TEXTURE0);const v=new r.T(i,{width:m[0],height:m[1],data:null},l.RGBA8);v.bind(l.LINEAR,l.CLAMP_TO_EDGE);const x=i.createFramebuffer(m[0],m[1],!0,null);return x.colorAttachment.set(v.texture),x.depthAttachment=new ed(i,x.framebuffer),this._sharedDepthStencil===void 0?(this._sharedDepthStencil=i.createRenderbuffer(i.gl.DEPTH_STENCIL,m[0],m[1]),this._stencilRef=0,x.depthAttachment.set(this._sharedDepthStencil),i.clear({stencil:0})):x.depthAttachment.set(this._sharedDepthStencil),i.extTextureFilterAnisotropic&&l.texParameterf(l.TEXTURE_2D,i.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,i.extTextureFilterAnisotropicMax),{fb:x,tex:v,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._debugParams.disableRenderCache||this._style.hasLightTransitions())return!0;for(const i in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[i].hasTransition())return!0;return this._style.order.some(i=>{const l=this._style._mergedLayers[i],m=l.isHidden(this.painter.transform.zoom);return l.type==="hillshade"||l.type==="custom"?!m&&l.shouldRedrape():!m&&l.hasTransition()})}_clearLineLayersFromRenderCache(){let i=!1;for(const m of this._style.getSources())if(m instanceof Lh){i=!0;break}if(!i)return;const l={};for(let m=0;m<this._style.order.length;++m){const v=this._style._mergedLayers[this._style.order[m]],x=this._style.getLayerSourceCache(v);if(x&&!l[x.id]&&!v.isHidden(this.painter.transform.zoom)&&v.type==="line"&&v.widthExpression()instanceof r.a9){l[x.id]=!0;for(const E of this.proxyCoords){const L=this.proxyToSource[E.key][x.id];if(L)for(const $ of L)this._clearRenderCacheForTile(x.id,$)}}}}_clearRasterLayersFromRenderCache(){let i=!1;for(const m in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[m]._source instanceof Vc){i=!0;break}if(!i)return;const l={};for(let m=0;m<this._style.order.length;++m){const v=this._style._mergedLayers[this._style.order[m]],x=this._style.getLayerSourceCache(v);if(!x||l[x.id]||v.isHidden(this.painter.transform.zoom)||v.type!=="raster")continue;const E=v.paint.get("raster-fade-duration");for(const L of this.proxyCoords){const $=this.proxyToSource[L.key][x.id];if($)for(const j of $){const G=td(x.getTile(j),x.findLoadedParent(j,0),x,this.painter.transform,E);(G.opacity!==1||G.mix!==0)&&this._clearRenderCacheForTile(x.id,j)}}}}_setupDrapedRenderBatches(){this._style.updateDrapeFirstLayers();const i=this._style.order,l=i.length;if(l===0)return;const m=[];this._pendingGroundEffectLayers=[];let v,x=0,E=this._style._mergedLayers[i[x]];for(;!this._style.isLayerDraped(E)&&E.isHidden(this.painter.transform.zoom)&&++x<l;)E=this._style._mergedLayers[i[x]];for(;x<l;++x){const L=this._style._mergedLayers[i[x]];L.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(L)?v===void 0&&(v=x):(L.type==="fill-extrusion"&&this._pendingGroundEffectLayers.push(x),v!==void 0&&(m.push({start:v,end:x-1}),v=void 0)))}if(v!==void 0&&m.push({start:v,end:x-1}),m.length!==0){const L=m[m.length-1];this._pendingGroundEffectLayers.every($=>$>L.end)||r.w("fill-extrusion with flood lighting and/or ground ambient occlusion should be moved to be on top of all draped layers.")}this._drapedRenderBatches=m}_setupRenderCache(i){const l=this.proxySourceCache;if(this._shouldDisableRenderCache()||this.invalidateRenderCache){if(this.invalidateRenderCache=!1,l.renderCache.length>l.renderCachePool.length){const E=Object.values(l.proxyCachedFBO);l.proxyCachedFBO={};for(let L=0;L<E.length;++L){const $=Object.values(E[L]);l.renderCachePool.push(...$)}}return}this._clearRasterLayersFromRenderCache();const m=this.proxyCoords,v=this._tilesDirty;for(let E=m.length-1;E>=0;E--){const L=m[E];if(l.getTileByID(L.key),l.proxyCachedFBO[L.key]!==void 0){const $=i[L.key],j=this.proxyToSource[L.key];let G=0;for(const X in j){const Y=j[X],ne=$[X];if(!ne||ne.length!==Y.length||Y.some((ve,_e)=>ve!==ne[_e]||v[X]&&v[X].hasOwnProperty(ve.key))){G=-1;break}++G}for(const X in l.proxyCachedFBO[L.key])l.renderCache[l.proxyCachedFBO[L.key][X]].dirty=G<0||G!==Object.values($).length}}const x=[...this._drapedRenderBatches];x.sort((E,L)=>L.end-L.start-(E.end-E.start));for(const E of x)for(const L of m){if(l.proxyCachedFBO[L.key])continue;let $=l.renderCachePool.pop();$===void 0&&l.renderCache.length<50&&($=l.renderCache.length,l.renderCache.push(this._createFBO())),$!==void 0&&(l.proxyCachedFBO[L.key]={},l.proxyCachedFBO[L.key][E.start]=$,l.renderCache[$].dirty=!0)}this._tilesDirty={}}_setupStencil(i,l,m,v){if(!v||!this._sourceTilesOverlap[v.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const x=this.painter.context,E=x.gl;if(l.length<=1)return void(this._overlapStencilType=!1);let L;if(m.isTileClipped())L=l.length,this._overlapStencilMode.test={func:E.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(l[0].overscaledZ>l[l.length-1].overscaledZ))return void(this._overlapStencilType=!1);L=1,this._overlapStencilMode.test={func:E.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+L>255&&(x.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=L,this._overlapStencilMode.ref=this._stencilRef,m.isTileClipped()&&this._renderTileClippingMasks(l,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return this._overlapStencilType==="Clip"||this._overlapStencilType==="Mask"}stencilModeForRTTOverlap(i){return this.renderingToTexture&&this._overlapStencilType?(this._overlapStencilType==="Clip"&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[i.key]),this._overlapStencilMode):Tr.disabled}_renderTileClippingMasks(i,l){const m=this.painter,v=this.painter.context,x=v.gl;m._tileClippingMaskIDs={},v.setColorMode(zr.disabled),v.setDepthMode(nr.disabled);const E=m.getOrCreateProgram("clippingMask");for(const L of i){const $=m._tileClippingMaskIDs[L.key]=--l;E.draw(m,x.TRIANGLES,nr.disabled,new Tr({func:x.ALWAYS,mask:0},$,255,x.KEEP,x.KEEP,x.REPLACE),zr.disabled,mr.disabled,Ef(L.projMatrix),"$clipping",m.tileExtentBuffer,m.quadTriangleIndexBuffer,m.tileExtentSegments)}}pointCoordinate(i){const l=this.painter.transform;if(i.x<0||i.x>l.width||i.y<0||i.y>l.height)return null;const m=[i.x,i.y,1,1];r.ab.vec4.transformMat4(m,m,l.pixelMatrixInverse),r.ab.vec4.scale(m,m,1/m[3]),m[0]/=l.worldSize,m[1]/=l.worldSize;const v=l._camera.position,x=r.bH(1,l.center.lat),E=[v[0],v[1],v[2]/x,0],L=r.ab.vec3.subtract([],m.slice(0,3),E);r.ab.vec3.normalize(L,L);const $=this.raycast(E,L,this._exaggeration);return $!==null&&$?(r.ab.vec3.scaleAndAdd(E,E,L,$),E[3]=E[2],E[2]*=x,E):null}_setupProxiedCoordsForOrtho(i,l,m){if(i.getSource()instanceof r.aJ)return this._setupProxiedCoordsForImageSource(i,l,m);this._findCoveringTileCache[i.id]=this._findCoveringTileCache[i.id]||{};const v=this.proxiedCoords[i.id]=[],x=this.proxyCoords;for(let $=0;$<x.length;$++){const j=x[$],G=this._findTileCoveringTileID(j,i);if(G){const X=this._createProxiedId(j,G,m[j.key]&&m[j.key][i.id]);v.push(X),this.proxyToSource[j.key][i.id]=[X]}}let E=!1;const L=new Set;for(let $=0;$<l.length;$++){const j=i.getTile(l[$]);if(!j||!j.hasData())continue;const G=this._findTileCoveringTileID(j.tileID,this.proxySourceCache);if(G&&G.tileID.canonical.z!==j.tileID.canonical.z){const X=this.proxyToSource[G.tileID.key][i.id],Y=this._createProxiedId(G.tileID,j,m[G.tileID.key]&&m[G.tileID.key][i.id]);X?X.splice(X.length-1,0,Y):this.proxyToSource[G.tileID.key][i.id]=[Y];const ne=this.proxyToSource[G.tileID.key][i.id];L.has(ne)||L.add(ne),v.push(Y),E=!0}}if(this._sourceTilesOverlap[i.id]=E,E&&this._debugParams.sortTilesHiZFirst)for(const $ of L)$.sort((j,G)=>G.overscaledZ-j.overscaledZ)}_setupProxiedCoordsForImageSource(i,l,m){if(!i.getSource().loaded())return;const v=this.proxiedCoords[i.id]=[],x=this.proxyCoords,E=i.getSource(),L=E.tileID;if(!L)return;const $=new r.P(L.x,L.y)._div(1<<L.z),j=E.coordinates.map(r.aa.fromLngLat).reduce((X,Y)=>(X.min.x=Math.min(X.min.x,Y.x-$.x),X.min.y=Math.min(X.min.y,Y.y-$.y),X.max.x=Math.max(X.max.x,Y.x-$.x),X.max.y=Math.max(X.max.y,Y.y-$.y),X),{min:new r.P(Number.MAX_VALUE,Number.MAX_VALUE),max:new r.P(-Number.MAX_VALUE,-Number.MAX_VALUE)}),G=(X,Y)=>{const ne=X.wrap+X.canonical.x/(1<<X.canonical.z),ve=X.canonical.y/(1<<X.canonical.z),_e=r.ag/(1<<X.canonical.z),Te=Y.wrap+Y.canonical.x/(1<<Y.canonical.z),Ce=Y.canonical.y/(1<<Y.canonical.z);return ne+_e<Te+j.min.x||ne>Te+j.max.x||ve+_e<Ce+j.min.y||ve>Ce+j.max.y};for(let X=0;X<x.length;X++){const Y=x[X];for(let ne=0;ne<l.length;ne++){const ve=i.getTile(l[ne]);if(!ve||!ve.hasData()||G(Y,ve.tileID))continue;const _e=this._createProxiedId(Y,ve,m[Y.key]&&m[Y.key][i.id]),Te=this.proxyToSource[Y.key][i.id];Te?Te.push(_e):this.proxyToSource[Y.key][i.id]=[_e],v.push(_e)}}}_createProxiedId(i,l,m){let v=this.orthoMatrix;if(m){const x=m.find(E=>E.key===l.tileID.key);if(x)return x}if(l.tileID.key!==i.key){const x=i.canonical.z-l.tileID.canonical.z;let E,L,$;v=r.ab.mat4.create();const j=l.tileID.wrap-i.wrap<<i.overscaledZ;x>0?(E=r.ag>>x,L=E*((l.tileID.canonical.x<<x)-i.canonical.x+j),$=E*((l.tileID.canonical.y<<x)-i.canonical.y)):(E=r.ag<<-x,L=r.ag*(l.tileID.canonical.x-(i.canonical.x+j<<-x)),$=r.ag*(l.tileID.canonical.y-(i.canonical.y<<-x))),r.ab.mat4.ortho(v,0,E,0,E,0,1),r.ab.mat4.translate(v,v,[L,$,0])}return new cp(l.tileID,i.key,v)}_findTileCoveringTileID(i,l){let m=l.getTile(i);if(m&&m.hasData())return m;const v=this._findCoveringTileCache[l.id],x=v[i.key];if(m=x?l.getTileByID(x):null,m&&m.hasData()||x===null)return m;let E=m?m.tileID:i,L=E.overscaledZ;const $=l.getSource().minzoom,j=[];if(!x){const X=l.getSource().maxzoom;if(i.canonical.z>=X){const Y=i.canonical.z-X;l.getSource().reparseOverscaled?(L=Math.max(i.canonical.z+2,l.transform.tileZoom),E=new r.aG(L,i.wrap,X,i.canonical.x>>Y,i.canonical.y>>Y)):Y!==0&&(L=X,E=new r.aG(L,i.wrap,X,i.canonical.x>>Y,i.canonical.y>>Y))}E.key!==i.key&&(j.push(E.key),m=l.getTile(E))}const G=X=>{j.forEach(Y=>{v[Y]=X}),j.length=0};for(L-=1;L>=$&&(!m||!m.hasData());L--){m&&G(m.tileID.key);const X=E.calculateScaledKey(L);if(m=l.getTileByID(X),m&&m.hasData())break;const Y=v[X];if(Y===null)break;Y===void 0?j.push(X):m=l.getTileByID(Y)}return G(m?m.tileID.key:null),m&&m.hasData()?m:null}findDEMTileFor(i){return this.enabled?this._findTileCoveringTileID(i,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(i,l){let m=this._tilesDirty[i];m||(m=this._tilesDirty[i]={}),m[l.key]=!0}}function lw(h,i,l){const m=function(L,$,j){const G=r.ab.vec3.dot($,L),X=r.ab.vec3.dot(j,[.2126,.7152,.0722]),Y=(ve,_e,Te)=>(1-Te)*ve+Te*_e,ne=Y(1-.3*Math.min(X,1),1,Math.min(G+1,1));return Y(.92,1,Math.asin(r.aw($[2],-1,1))/Math.PI+.5)*ne}(h,[0,0,1],i),v=[0,0,0];r.ab.vec3.scale(v,l.slice(0,3),m);const x=[0,0,0];r.ab.vec3.scale(x,i.slice(0,3),h[2]);const E=[0,0,0];return r.ab.vec3.add(E,v,x),r.cf(E)}const Wv=["fill","fillOutline","fillPattern","line","linePattern","background","backgroundPattern","hillshade","raster"],Mf=["stars","rainParticle","snowParticle","fillExtrusion","fillExtrusionGroundEffect","model","symbol"];class qv{static cacheKey(i,l,m,v){let x=`${l}${v?v.cacheKey:""}`;for(const E of m)i.usedDefines.includes(E)&&(x+=`/${E}`);return x}constructor(i,l,m,v,x,E){const L=i.gl;this.program=L.createProgram(),this.configuration=v,this.name=l,this.fixedDefines=[...E];const $=v?v.getBinderAttributes():[],j=(m.staticAttributes||[]).concat($);let G=v?v.defines():[];G=G.concat(E.map(Te=>`#define ${Te}`));const X=`#version 300 es
`;let Y=X+G.concat("precision mediump float;",ip,wf.fragmentSource).join(`
`);for(const Te of m.fragmentIncludes)Y+=`
${rc[Te]}`;Y+=`
${m.fragmentSource}`;let ne=X+G.concat("precision highp float;",ip,wf.vertexSource).join(`
`);for(const Te of m.vertexIncludes)ne+=`
${rc[Te]}`;this.forceManualRenderingForInstanceIDShaders=i.forceManualRenderingForInstanceIDShaders&&m.vertexSource.indexOf("gl_InstanceID")!==-1,this.forceManualRenderingForInstanceIDShaders&&(ne+=`
uniform int u_instanceID;
`),ne+=`
${m.vertexSource}`,this.forceManualRenderingForInstanceIDShaders&&(ne=ne.replaceAll("gl_InstanceID","u_instanceID"));const ve=L.createShader(L.FRAGMENT_SHADER);if(L.isContextLost())return void(this.failedToCreate=!0);L.shaderSource(ve,Y),L.compileShader(ve),L.attachShader(this.program,ve);const _e=L.createShader(L.VERTEX_SHADER);if(L.isContextLost())this.failedToCreate=!0;else{L.shaderSource(_e,ne),L.compileShader(_e),L.attachShader(this.program,_e),this.attributes={},this.numAttributes=j.length;for(let Te=0;Te<this.numAttributes;Te++)if(j[Te]){const Ce=j[Te].startsWith("a_")?j[Te]:`a_${j[Te]}`;L.bindAttribLocation(this.program,Te,Ce),this.attributes[Ce]=Te}L.linkProgram(this.program),L.deleteShader(_e),L.deleteShader(ve),this.fixedUniforms=x(i),this.binderUniforms=v?v.getUniforms(i):[],this.forceManualRenderingForInstanceIDShaders&&(this.instancingUniforms=(Te=>({u_instanceID:new r.bN(Te)}))(i)),(E.includes("TERRAIN")||l.indexOf("symbol")!==-1||l.indexOf("circle")!==-1)&&(this.terrainUniforms=(Te=>({u_dem:new r.bN(Te),u_dem_prev:new r.bN(Te),u_dem_tl:new r.bK(Te),u_dem_scale:new r.bM(Te),u_dem_tl_prev:new r.bK(Te),u_dem_scale_prev:new r.bM(Te),u_dem_size:new r.bM(Te),u_dem_lerp:new r.bM(Te),u_exaggeration:new r.bM(Te),u_depth:new r.bN(Te),u_depth_size_inv:new r.bK(Te),u_depth_range_unpack:new r.bK(Te),u_occluder_half_size:new r.bM(Te),u_occlusion_depth_offset:new r.bM(Te),u_meter_to_dem:new r.bM(Te),u_label_plane_matrix_inv:new r.bJ(Te)}))(i)),E.includes("GLOBE")&&(this.globeUniforms=(Te=>({u_tile_tl_up:new r.bL(Te),u_tile_tr_up:new r.bL(Te),u_tile_br_up:new r.bL(Te),u_tile_bl_up:new r.bL(Te),u_tile_up_scale:new r.bM(Te)}))(i)),E.includes("FOG")&&(this.fogUniforms=(Te=>({u_fog_matrix:new r.bJ(Te),u_fog_range:new r.bK(Te),u_fog_color:new r.ca(Te),u_fog_horizon_blend:new r.bM(Te),u_fog_vertical_limit:new r.bK(Te),u_fog_temporal_offset:new r.bM(Te),u_frustum_tl:new r.bL(Te),u_frustum_tr:new r.bL(Te),u_frustum_br:new r.bL(Te),u_frustum_bl:new r.bL(Te),u_globe_pos:new r.bL(Te),u_globe_radius:new r.bM(Te),u_globe_transition:new r.bM(Te),u_is_globe:new r.bN(Te),u_viewport:new r.bK(Te)}))(i)),E.includes("RENDER_CUTOFF")&&(this.cutoffUniforms=(Te=>({u_cutoff_params:new r.ca(Te)}))(i)),E.includes("LIGHTING_3D_MODE")&&(this.lightsUniforms=(Te=>({u_lighting_ambient_color:new r.bL(Te),u_lighting_directional_dir:new r.bL(Te),u_lighting_directional_color:new r.bL(Te),u_ground_radiance:new r.bL(Te)}))(i)),E.includes("RENDER_SHADOWS")&&(this.shadowUniforms=(Te=>({u_light_matrix_0:new r.bJ(Te),u_light_matrix_1:new r.bJ(Te),u_fade_range:new r.bK(Te),u_shadow_normal_offset:new r.bL(Te),u_shadow_intensity:new r.bM(Te),u_shadow_texel_size:new r.bM(Te),u_shadow_map_resolution:new r.bM(Te),u_shadow_direction:new r.bL(Te),u_shadow_bias:new r.bL(Te),u_shadowmap_0:new r.bN(Te),u_shadowmap_1:new r.bN(Te)}))(i))}}setTerrainUniformValues(i,l){if(!this.terrainUniforms)return;const m=this.terrainUniforms;if(!this.failedToCreate){i.program.set(this.program);for(const v in l)m[v]&&m[v].set(this.program,v,l[v])}}setGlobeUniformValues(i,l){if(!this.globeUniforms)return;const m=this.globeUniforms;if(!this.failedToCreate){i.program.set(this.program);for(const v in l)m[v]&&m[v].set(this.program,v,l[v])}}setFogUniformValues(i,l){if(!this.fogUniforms)return;const m=this.fogUniforms;if(!this.failedToCreate){i.program.set(this.program);for(const v in l)m[v].set(this.program,v,l[v])}}setCutoffUniformValues(i,l){if(!this.cutoffUniforms)return;const m=this.cutoffUniforms;if(!this.failedToCreate){i.program.set(this.program);for(const v in l)m[v].set(this.program,v,l[v])}}setLightsUniformValues(i,l){if(!this.lightsUniforms)return;const m=this.lightsUniforms;if(!this.failedToCreate){i.program.set(this.program);for(const v in l)m[v].set(this.program,v,l[v])}}setShadowUniformValues(i,l){if(this.failedToCreate||!this.shadowUniforms)return;const m=this.shadowUniforms;i.program.set(this.program);for(const v in l)m[v].set(this.program,v,l[v])}_drawDebugWireframe(i,l,m,v,x,E,L,$,j,G){const X=i.options.wireframe;if(X.terrain===!1&&X.layers2D===!1&&X.layers3D===!1)return;const Y=i.context;if(!(!(!X.terrain||this.name!=="terrainRaster"&&this.name!=="globeRaster")||!(!X.layers2D||i._terrain&&i._terrain.renderingToTexture||!Wv.includes(this.name))||!(!X.layers3D||!Mf.includes(this.name))))return;const ne=Y.gl,ve=i.wireframeDebugCache.getLinesFromTrianglesBuffer(i.frameCounter,x,Y);if(!ve)return;const _e=[...this.fixedDefines];_e.push("DEBUG_WIREFRAME");const Te=i.getOrCreateProgram(this.name,{config:this.configuration,defines:_e});Y.program.set(Te.program);const Ce=(Be,et,Ze)=>{if(et[Be]&&Ze[Be])for(const Xe in et[Be])Ze[Be][Xe]&&Ze[Be][Xe].set(Ze.program,Xe,et[Be][Xe].current)};j&&j.setUniforms(Te.program,Y,Te.binderUniforms,L,{zoom:$}),Ce("fixedUniforms",this,Te),Ce("terrainUniforms",this,Te),Ce("globeUniforms",this,Te),Ce("fogUniforms",this,Te),Ce("lightsUniforms",this,Te),Ce("shadowUniforms",this,Te),ve.bind(),Y.setColorMode(new zr([ne.ONE,ne.ONE_MINUS_SRC_ALPHA,ne.ZERO,ne.ONE],r.aj.transparent,[!0,!0,!0,!1])),Y.setDepthMode(new nr(l.func===ne.LESS?ne.LEQUAL:l.func,nr.ReadOnly,l.range)),Y.setStencilMode(Tr.disabled);const Re=3*E.primitiveLength*2,je=3*E.primitiveOffset*2*2;if(this.forceManualRenderingForInstanceIDShaders){const Be=G||1;for(let et=0;et<Be;++et)Te.instancingUniforms.u_instanceID.set(this.program,"u_instanceID",et),ne.drawElements(ne.LINES,Re,ne.UNSIGNED_SHORT,je)}else G&&G>1?ne.drawElementsInstanced(ne.LINES,Re,ne.UNSIGNED_SHORT,je,G):ne.drawElements(ne.LINES,Re,ne.UNSIGNED_SHORT,je);x.bind(),Y.program.set(this.program),Y.setDepthMode(l),Y.setStencilMode(m),Y.setColorMode(v)}checkUniforms(i,l,m){if(this.fixedDefines.includes(l)){for(const v of Object.keys(m))if(!m[v].initialized)throw new Error(`Program '${this.name}', from draw '${i}': uniform ${v} not set but required by ${l} being defined`)}}draw(i,l,m,v,x,E,L,$,j,G,X,Y,ne,ve,_e,Te){const Ce=i.context,Re=Ce.gl;if(this.failedToCreate)return;Ce.program.set(this.program),Ce.setDepthMode(m),Ce.setStencilMode(v),Ce.setColorMode(x),Ce.setCullFace(E);for(const et of Object.keys(this.fixedUniforms))this.fixedUniforms[et].set(this.program,et,L[et]);ve&&ve.setUniforms(this.program,Ce,this.binderUniforms,Y,{zoom:ne});const je={[Re.POINTS]:1,[Re.LINES]:2,[Re.TRIANGLES]:3,[Re.LINE_STRIP]:1}[l];this.checkUniforms($,"RENDER_SHADOWS",this.shadowUniforms);const Be=Te&&Te>0?1:void 0;for(const et of X.get()){const Ze=et.vaos||(et.vaos={});if((Ze[$]||(Ze[$]=new Sf)).bind(Ce,this,j,ve?ve.getPaintVertexBuffers():[],G,et.vertexOffset,_e||[],Be),this.forceManualRenderingForInstanceIDShaders){const Xe=Te||1;for(let Ke=0;Ke<Xe;++Ke)this.instancingUniforms.u_instanceID.set(this.program,"u_instanceID",Ke),G?Re.drawElements(l,et.primitiveLength*je,Re.UNSIGNED_SHORT,et.primitiveOffset*je*2):Re.drawArrays(l,et.vertexOffset,et.vertexLength)}else Te&&Te>1?Re.drawElementsInstanced(l,et.primitiveLength*je,Re.UNSIGNED_SHORT,et.primitiveOffset*je*2,Te):G?Re.drawElements(l,et.primitiveLength*je,Re.UNSIGNED_SHORT,et.primitiveOffset*je*2):Re.drawArrays(l,et.vertexOffset,et.vertexLength);l===Re.TRIANGLES&&G&&this._drawDebugWireframe(i,m,v,x,G,et,Y,ne,ve,Te)}}}function Kv(h,i){const l=Math.pow(2,i.tileID.overscaledZ),m=i.tileSize*Math.pow(2,h.transform.tileZoom)/l,v=m*(i.tileID.canonical.x+i.tileID.wrap*l),x=m*i.tileID.canonical.y;return{u_image:0,u_texsize:i.imageAtlasTexture?i.imageAtlasTexture.size:[0,0],u_tile_units_to_pixels:1/r.ar(i,1,h.transform.tileZoom),u_pixel_coord_upper:[v>>16,x>>16],u_pixel_coord_lower:[65535&v,65535&x]}}const If={terrain:0,flat:1},uw=r.ab.mat4.create(),fp=(h,i,l,m,v,x,E,L,$,j,G,X,Y,ne,ve,_e,Te,Ce)=>{const Re=i.style.light,je=Re.properties.get("position"),Be=[je.x,je.y,je.z],et=r.ab.mat3.create();Re.properties.get("anchor")==="viewport"&&(r.ab.mat3.fromRotation(et,-i.transform.angle),r.ab.vec3.transformMat3(Be,Be,et));const Ze=Re.properties.get("color"),Xe=i.transform,Ke={u_matrix:h,u_lightpos:Be,u_lightintensity:Re.properties.get("intensity"),u_lightcolor:[Ze.r,Ze.g,Ze.b],u_vertical_gradient:+l,u_opacity:m,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:uw,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_height_type:If[j],u_base_type:If[G],u_ao:v,u_edge_radius:x,u_width_scale:E,u_flood_light_color:ve,u_vertical_scale:_e,u_flood_light_intensity:Te,u_ground_shadow_factor:Ce};return Xe.projection.name==="globe"&&(Ke.u_tile_id=[L.canonical.x,L.canonical.y,1<<L.canonical.z],Ke.u_zoom_transition=X,Ke.u_inv_rot_matrix=ne,Ke.u_merc_center=Y,Ke.u_up_dir=Xe.projection.upVector(new r.bT(0,0,0),Y[0]*r.ag,Y[1]*r.ag),Ke.u_height_lift=$),Ke},Vg=(h,i,l,m,v,x)=>({u_matrix:h,u_edge_radius:i,u_width_scale:l,u_vertical_scale:m,u_height_type:If[v],u_base_type:If[x]}),Af=(h,i,l,m,v,x,E,L,$,j,G,X,Y,ne,ve,_e,Te)=>{const Ce=fp(h,i,l,m,v,x,E,L,j,G,X,Y,ne,ve,_e,Te,1,[0,0,0]),Re={u_height_factor:-Math.pow(2,L.overscaledZ)/$.tileSize/8};return r.l(Ce,Kv(i,$),Re)},hp=(h,i)=>({u_matrix:h,u_emissive_strength:i}),nd=(h,i,l,m)=>r.l(hp(h,i),Kv(l,m)),Zv=(h,i,l)=>({u_matrix:h,u_world:l,u_emissive_strength:i}),pp=(h,i,l,m,v)=>r.l(nd(h,i,l,m),{u_world:v}),mp=(h,i,l,m)=>{const v=r.ag/l.tileSize;return{u_matrix:h,u_camera_to_center_distance:i.getCameraToCenterDistance(m),u_extrude_scale:[i.pixelsToGLUnits[0]/v,i.pixelsToGLUnits[1]/v]}},gp=(h,i,l=1)=>({u_matrix:h,u_color:i.toRenderColor(null),u_overlay:0,u_overlay_scale:l}),Yv=r.ab.mat4.create(),cw=(h,i,l,m,v,x,E)=>{const L=h.transform,$=L.projection.name==="globe",j=$?r.cN(L.zoom,i.canonical)*L._pixelsPerMercatorPixel:r.ar(l,1,x),G={u_matrix:i.projMatrix,u_extrude_scale:j,u_intensity:E,u_inv_rot_matrix:Yv,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if($){G.u_inv_rot_matrix=m,G.u_merc_center=v,G.u_tile_id=[i.canonical.x,i.canonical.y,1<<i.canonical.z],G.u_zoom_transition=r.ae(L.zoom);const X=v[0]*r.ag,Y=v[1]*r.ag;G.u_up_dir=L.projection.upVector(new r.bT(0,0,0),X,Y)}return G};function ic(h,[i,l,m,v],[x,E]){if(x===E)return[0,0,0,0];const L=255*(h-1)/(h*(E-x));return[i*L,l*L,m*L,v*L]}function kf(h,i,[l,m]){return l===m?0:.5/h+(i-l)*(h-1)/(h*(m-l))}const Gn=(h,i,l,m,v,x,E,L,$,j,G,X,Y,ne,ve,_e,Te,Ce,Re,je,Be)=>({u_matrix:h,u_normalize_matrix:i,u_globe_matrix:l,u_merc_matrix:m,u_grid_matrix:v,u_tl_parent:x,u_scale_parent:j,u_fade_t:G.mix,u_opacity:G.opacity*X.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:X.paint.get("raster-brightness-min"),u_brightness_high:X.paint.get("raster-brightness-max"),u_saturation_factor:r.cO(X.paint.get("raster-saturation")),u_contrast_factor:r.cP(X.paint.get("raster-contrast")),u_spin_weights:Xv(X.paint.get("raster-hue-rotate")),u_perspective_transform:Y,u_raster_elevation:ne,u_zoom_transition:E,u_merc_center:L,u_cutoff_params:$,u_colorization_mix:ic(r.cQ,_e,Ce),u_colorization_offset:kf(r.cQ,Te,Ce),u_color_ramp:ve,u_texture_offset:[je/(Re+2*je),Re/(Re+2*je)],u_texture_res:[Re+2*je,Re+2*je],u_emissive_strength:Be});function Xv(h){h*=Math.PI/180;const i=Math.sin(h),l=Math.cos(h);return[(2*l+1)/3,(-Math.sqrt(3)*i-l+1)/3,(Math.sqrt(3)*i-l+1)/3]}const oc=.05,sc=(h,i,l,m,v,x,E,L,$,j,G,X)=>({u_matrix:h,u_normalize_matrix:i,u_globe_matrix:l,u_merc_matrix:m,u_grid_matrix:v,u_tl_parent:x,u_scale_parent:j,u_fade_t:G.mix,u_opacity:G.opacity,u_image0:0,u_image1:1,u_raster_elevation:X,u_zoom_transition:E,u_merc_center:L,u_cutoff_params:$}),ac=(h,i,l,m,v,x,E,L,$,j)=>({u_particle_texture:h,u_particle_texture_side_len:i,u_tile_offset:l,u_velocity:m,u_color_ramp:x,u_velocity_res:v,u_max_speed:E,u_uv_offset:L,u_data_scale:[255*$[0],255*$[1]],u_data_offset:j,u_particle_pos_scale:1.1,u_particle_pos_offset:[oc,oc]}),tr=(h,i,l,m,v,x,E,L,$,j)=>({u_particle_texture:h,u_particle_texture_side_len:i,u_velocity:l,u_velocity_res:m,u_max_speed:v,u_speed_factor:x,u_reset_rate:E,u_rand_seed:Math.random(),u_uv_offset:L,u_data_scale:[255*$[0],255*$[1]],u_data_offset:j,u_particle_pos_scale:1.1,u_particle_pos_offset:[oc,oc]}),_p=r.ab.mat4.create(),Jv=(h,i,l,m,v,x,E,L,$,j,G,X,Y,ne,ve,_e,Te,Ce,Re,je,Be,et)=>{const Ze=v.transform,Xe={u_is_size_zoom_constant:+(h==="constant"||h==="source"),u_is_size_feature_constant:+(h==="constant"||h==="camera"),u_size_t:i?i.uSizeT:0,u_size:i?i.uSize:0,u_camera_to_center_distance:Ze.getCameraToCenterDistance(Re),u_rotate_symbol:+l,u_aspect_ratio:Ze.width/Ze.height,u_fade_change:v.options.fadeDuration?v.symbolFadeChange:1,u_matrix:x,u_label_plane_matrix:E,u_coord_matrix:L,u_is_text:+j,u_elevation_from_sea:$?1:0,u_pitch_with_map:+m,u_texsize:G,u_texsize_icon:X,u_texture:0,u_texture_icon:1,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:_p,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:_p,u_up_vector:[0,-1,0],u_color_adj_mat:je,u_icon_transition:Be||0,u_gamma_scale:m?v.transform.getCameraToCenterDistance(Re)*Math.cos(v.terrain?0:v.transform._pitch):1,u_device_pixel_ratio:r.q.devicePixelRatio,u_is_halo:1,u_scale_factor:et||1};return Re.name==="globe"&&(Xe.u_tile_id=[ne.canonical.x,ne.canonical.y,1<<ne.canonical.z],Xe.u_zoom_transition=ve,Xe.u_inv_rot_matrix=Te,Xe.u_merc_center=_e,Xe.u_camera_forward=Ze._camera.forward(),Xe.u_ecef_origin=r.cR(Ze.globeMatrix,ne.toUnwrapped()),Xe.u_tile_matrix=Float32Array.from(Ze.globeMatrix),Xe.u_up_vector=Ce),Xe},Qv=(h,i,l,m)=>({u_matrix:h,u_emissive_strength:i,u_opacity:l,u_color:m}),yp=(h,i,l,m,v,x,E,L,$)=>r.l(function(j,G,X,Y,ne,ve){const{width:_e,height:Te}=Y.imageManager.getPixelSize(G),Ce=Math.pow(2,ve.tileID.overscaledZ),Re=ve.tileSize*Math.pow(2,Y.transform.tileZoom)/Ce,je=Re*(ve.tileID.canonical.x+ve.tileID.wrap*Ce),Be=Re*ve.tileID.canonical.y;return{u_image:0,u_pattern_tl:X.tl,u_pattern_br:X.br,u_texsize:[_e,Te],u_pattern_size:X.displaySize,u_pattern_units_to_pixels:ne?[Y.transform.width,-1*Y.transform.height]:[1/r.ar(ve,1,Y.transform.tileZoom),1/r.ar(ve,1,Y.transform.tileZoom)],u_pixel_coord_upper:[je>>16,Be>>16],u_pixel_coord_lower:[65535&je,65535&Be]}}(0,x,E,m,L,$),{u_matrix:h,u_emissive_strength:i,u_opacity:l}),vp=new Float32Array(r.ab.mat4.identity([])),bp=(h,i,l,m,v,x,E,L,$,j,G,X,Y,ne=[0,0,0],ve)=>{const _e=v.style.light,Te=_e.properties.get("position"),Ce=[-Te.x,-Te.y,Te.z],Re=r.ab.mat3.create();_e.properties.get("anchor")==="viewport"&&(r.ab.mat3.fromRotation(Re,-v.transform.angle),r.ab.vec3.transformMat3(Ce,Ce,Re));const je=G.alphaMode==="MASK",Be=_e.properties.get("color").toRenderColor(null),et=Y.paint.get("model-ambient-occlusion-intensity"),Ze=Y.paint.get("model-color").constantOr(r.aj.white).toRenderColor(null),Xe=Y.paint.get("model-color-mix-intensity").constantOr(0);return{u_matrix:h,u_lighting_matrix:i,u_normal_matrix:l,u_node_matrix:m||vp,u_lightpos:Ce,u_lightintensity:_e.properties.get("intensity"),u_lightcolor:[Be.r,Be.g,Be.b],u_camera_pos:ne,u_opacity:x,u_baseTextureIsAlpha:0,u_alphaMask:+je,u_alphaCutoff:G.alphaCutoff,u_baseColorFactor:[E.r,E.g,E.b,E.a],u_emissiveFactor:[L[0],L[1],L[2],1],u_metallicFactor:$,u_roughnessFactor:j,u_baseColorTexture:Vo.BaseColor,u_metallicRoughnessTexture:Vo.MetallicRoughness,u_normalTexture:Vo.Normal,u_occlusionTexture:Vo.Occlusion,u_emissionTexture:Vo.Emission,u_lutTexture:Vo.LUT,u_color_mix:[Ze.r,Ze.g,Ze.b,Xe],u_aoIntensity:et,u_emissive_strength:X,u_occlusionTextureTransform:ve||[0,0,0,0]}},e0=(h,i=vp,l=vp)=>({u_matrix:h,u_instance:i,u_node_matrix:l}),dw={fillExtrusion:h=>({u_matrix:new r.bJ(h),u_lightpos:new r.bL(h),u_lightintensity:new r.bM(h),u_lightcolor:new r.bL(h),u_vertical_gradient:new r.bM(h),u_opacity:new r.bM(h),u_edge_radius:new r.bM(h),u_width_scale:new r.bM(h),u_ao:new r.bK(h),u_height_type:new r.bN(h),u_base_type:new r.bN(h),u_tile_id:new r.bL(h),u_zoom_transition:new r.bM(h),u_inv_rot_matrix:new r.bJ(h),u_merc_center:new r.bK(h),u_up_dir:new r.bL(h),u_height_lift:new r.bM(h),u_flood_light_color:new r.bL(h),u_vertical_scale:new r.bM(h),u_flood_light_intensity:new r.bM(h),u_ground_shadow_factor:new r.bL(h)}),fillExtrusionDepth:h=>({u_matrix:new r.bJ(h),u_edge_radius:new r.bM(h),u_width_scale:new r.bM(h),u_vertical_scale:new r.bM(h),u_height_type:new r.bN(h),u_base_type:new r.bN(h)}),fillExtrusionPattern:h=>({u_matrix:new r.bJ(h),u_lightpos:new r.bL(h),u_lightintensity:new r.bM(h),u_lightcolor:new r.bL(h),u_vertical_gradient:new r.bM(h),u_height_factor:new r.bM(h),u_edge_radius:new r.bM(h),u_width_scale:new r.bM(h),u_ao:new r.bK(h),u_height_type:new r.bN(h),u_base_type:new r.bN(h),u_tile_id:new r.bL(h),u_zoom_transition:new r.bM(h),u_inv_rot_matrix:new r.bJ(h),u_merc_center:new r.bK(h),u_up_dir:new r.bL(h),u_height_lift:new r.bM(h),u_image:new r.bN(h),u_texsize:new r.bK(h),u_pixel_coord_upper:new r.bK(h),u_pixel_coord_lower:new r.bK(h),u_tile_units_to_pixels:new r.bM(h),u_opacity:new r.bM(h)}),fillExtrusionGroundEffect:h=>({u_matrix:new r.bJ(h),u_opacity:new r.bM(h),u_ao_pass:new r.bM(h),u_meter_to_tile:new r.bM(h),u_ao:new r.bK(h),u_flood_light_intensity:new r.bM(h),u_flood_light_color:new r.bL(h),u_attenuation:new r.bM(h),u_edge_radius:new r.bM(h),u_fb:new r.bN(h),u_fb_size:new r.bM(h),u_dynamic_offset:new r.bM(h)}),fill:h=>({u_matrix:new r.bJ(h),u_emissive_strength:new r.bM(h)}),fillPattern:h=>({u_matrix:new r.bJ(h),u_emissive_strength:new r.bM(h),u_image:new r.bN(h),u_texsize:new r.bK(h),u_pixel_coord_upper:new r.bK(h),u_pixel_coord_lower:new r.bK(h),u_tile_units_to_pixels:new r.bM(h)}),fillOutline:h=>({u_matrix:new r.bJ(h),u_emissive_strength:new r.bM(h),u_world:new r.bK(h)}),fillOutlinePattern:h=>({u_matrix:new r.bJ(h),u_emissive_strength:new r.bM(h),u_world:new r.bK(h),u_image:new r.bN(h),u_texsize:new r.bK(h),u_pixel_coord_upper:new r.bK(h),u_pixel_coord_lower:new r.bK(h),u_tile_units_to_pixels:new r.bM(h)}),circle:r.cS,collisionBox:h=>({u_matrix:new r.bJ(h),u_camera_to_center_distance:new r.bM(h),u_extrude_scale:new r.bK(h)}),collisionCircle:h=>({u_matrix:new r.bJ(h),u_inv_matrix:new r.bJ(h),u_camera_to_center_distance:new r.bM(h),u_viewport_size:new r.bK(h)}),debug:h=>({u_color:new r.cz(h),u_matrix:new r.bJ(h),u_overlay:new r.bN(h),u_overlay_scale:new r.bM(h)}),clippingMask:h=>({u_matrix:new r.bJ(h)}),heatmap:h=>({u_extrude_scale:new r.bM(h),u_intensity:new r.bM(h),u_matrix:new r.bJ(h),u_inv_rot_matrix:new r.bJ(h),u_merc_center:new r.bK(h),u_tile_id:new r.bL(h),u_zoom_transition:new r.bM(h),u_up_dir:new r.bL(h)}),heatmapTexture:h=>({u_image:new r.bN(h),u_color_ramp:new r.bN(h),u_opacity:new r.bM(h)}),hillshade:h=>({u_matrix:new r.bJ(h),u_image:new r.bN(h),u_latrange:new r.bK(h),u_light:new r.bK(h),u_shadow:new r.cz(h),u_highlight:new r.cz(h),u_emissive_strength:new r.bM(h),u_accent:new r.cz(h)}),hillshadePrepare:h=>({u_matrix:new r.bJ(h),u_image:new r.bN(h),u_dimension:new r.bK(h),u_zoom:new r.bM(h)}),line:r.cT,linePattern:r.cU,raster:h=>({u_matrix:new r.bJ(h),u_normalize_matrix:new r.bJ(h),u_globe_matrix:new r.bJ(h),u_merc_matrix:new r.bJ(h),u_grid_matrix:new r.cA(h),u_tl_parent:new r.bK(h),u_scale_parent:new r.bM(h),u_fade_t:new r.bM(h),u_opacity:new r.bM(h),u_image0:new r.bN(h),u_image1:new r.bN(h),u_brightness_low:new r.bM(h),u_brightness_high:new r.bM(h),u_saturation_factor:new r.bM(h),u_contrast_factor:new r.bM(h),u_spin_weights:new r.bL(h),u_perspective_transform:new r.bK(h),u_raster_elevation:new r.bM(h),u_zoom_transition:new r.bM(h),u_merc_center:new r.bK(h),u_cutoff_params:new r.ca(h),u_colorization_mix:new r.ca(h),u_colorization_offset:new r.bM(h),u_color_ramp:new r.bN(h),u_texture_offset:new r.bK(h),u_texture_res:new r.bK(h),u_emissive_strength:new r.bM(h)}),rasterParticle:h=>({u_matrix:new r.bJ(h),u_normalize_matrix:new r.bJ(h),u_globe_matrix:new r.bJ(h),u_merc_matrix:new r.bJ(h),u_grid_matrix:new r.cA(h),u_tl_parent:new r.bK(h),u_scale_parent:new r.bM(h),u_fade_t:new r.bM(h),u_opacity:new r.bM(h),u_image0:new r.bN(h),u_image1:new r.bN(h),u_raster_elevation:new r.bM(h),u_zoom_transition:new r.bM(h),u_merc_center:new r.bK(h),u_cutoff_params:new r.ca(h)}),rasterParticleTexture:h=>({u_texture:new r.bN(h),u_opacity:new r.bM(h)}),rasterParticleDraw:h=>({u_particle_texture:new r.bN(h),u_particle_texture_side_len:new r.bM(h),u_tile_offset:new r.bK(h),u_velocity:new r.bN(h),u_color_ramp:new r.bN(h),u_velocity_res:new r.bK(h),u_max_speed:new r.bM(h),u_uv_offset:new r.bK(h),u_data_scale:new r.bK(h),u_data_offset:new r.bM(h),u_particle_pos_scale:new r.bM(h),u_particle_pos_offset:new r.bK(h)}),rasterParticleUpdate:h=>({u_particle_texture:new r.bN(h),u_particle_texture_side_len:new r.bM(h),u_velocity:new r.bN(h),u_velocity_res:new r.bK(h),u_max_speed:new r.bM(h),u_speed_factor:new r.bM(h),u_reset_rate:new r.bM(h),u_rand_seed:new r.bM(h),u_uv_offset:new r.bK(h),u_data_scale:new r.bK(h),u_data_offset:new r.bM(h),u_particle_pos_scale:new r.bM(h),u_particle_pos_offset:new r.bK(h)}),symbol:h=>({u_is_size_zoom_constant:new r.bN(h),u_is_size_feature_constant:new r.bN(h),u_size_t:new r.bM(h),u_size:new r.bM(h),u_camera_to_center_distance:new r.bM(h),u_rotate_symbol:new r.bN(h),u_aspect_ratio:new r.bM(h),u_fade_change:new r.bM(h),u_matrix:new r.bJ(h),u_label_plane_matrix:new r.bJ(h),u_coord_matrix:new r.bJ(h),u_is_text:new r.bN(h),u_elevation_from_sea:new r.bN(h),u_pitch_with_map:new r.bN(h),u_texsize:new r.bK(h),u_texsize_icon:new r.bK(h),u_texture:new r.bN(h),u_texture_icon:new r.bN(h),u_gamma_scale:new r.bM(h),u_device_pixel_ratio:new r.bM(h),u_tile_id:new r.bL(h),u_zoom_transition:new r.bM(h),u_inv_rot_matrix:new r.bJ(h),u_merc_center:new r.bK(h),u_camera_forward:new r.bL(h),u_tile_matrix:new r.bJ(h),u_up_vector:new r.bL(h),u_ecef_origin:new r.bL(h),u_is_halo:new r.bN(h),u_icon_transition:new r.bM(h),u_color_adj_mat:new r.bJ(h),u_scale_factor:new r.bM(h)}),background:h=>({u_matrix:new r.bJ(h),u_emissive_strength:new r.bM(h),u_opacity:new r.bM(h),u_color:new r.cz(h)}),backgroundPattern:h=>({u_matrix:new r.bJ(h),u_emissive_strength:new r.bM(h),u_opacity:new r.bM(h),u_image:new r.bN(h),u_pattern_tl:new r.bK(h),u_pattern_br:new r.bK(h),u_texsize:new r.bK(h),u_pattern_size:new r.bK(h),u_pixel_coord_upper:new r.bK(h),u_pixel_coord_lower:new r.bK(h),u_pattern_units_to_pixels:new r.bK(h)}),terrainRaster:h=>({u_matrix:new r.bJ(h),u_image0:new r.bN(h),u_skirt_height:new r.bM(h),u_ground_shadow_factor:new r.bL(h)}),skybox:h=>({u_matrix:new r.bJ(h),u_sun_direction:new r.bL(h),u_cubemap:new r.bN(h),u_opacity:new r.bM(h),u_temporal_offset:new r.bM(h)}),skyboxGradient:h=>({u_matrix:new r.bJ(h),u_color_ramp:new r.bN(h),u_center_direction:new r.bL(h),u_radius:new r.bM(h),u_opacity:new r.bM(h),u_temporal_offset:new r.bM(h)}),skyboxCapture:h=>({u_matrix_3f:new r.cA(h),u_sun_direction:new r.bL(h),u_sun_intensity:new r.bM(h),u_color_tint_r:new r.ca(h),u_color_tint_m:new r.ca(h),u_luminance:new r.bM(h)}),globeRaster:h=>({u_proj_matrix:new r.bJ(h),u_globe_matrix:new r.bJ(h),u_normalize_matrix:new r.bJ(h),u_merc_matrix:new r.bJ(h),u_zoom_transition:new r.bM(h),u_merc_center:new r.bK(h),u_image0:new r.bN(h),u_grid_matrix:new r.cA(h),u_skirt_height:new r.bM(h),u_far_z_cutoff:new r.bM(h),u_frustum_tl:new r.bL(h),u_frustum_tr:new r.bL(h),u_frustum_br:new r.bL(h),u_frustum_bl:new r.bL(h),u_globe_pos:new r.bL(h),u_globe_radius:new r.bM(h),u_viewport:new r.bK(h)}),globeAtmosphere:h=>({u_frustum_tl:new r.bL(h),u_frustum_tr:new r.bL(h),u_frustum_br:new r.bL(h),u_frustum_bl:new r.bL(h),u_horizon:new r.bM(h),u_transition:new r.bM(h),u_fadeout_range:new r.bM(h),u_color:new r.ca(h),u_high_color:new r.ca(h),u_space_color:new r.ca(h),u_temporal_offset:new r.bM(h),u_horizon_angle:new r.bM(h)}),model:h=>({u_matrix:new r.bJ(h),u_lighting_matrix:new r.bJ(h),u_normal_matrix:new r.bJ(h),u_node_matrix:new r.bJ(h),u_lightpos:new r.bL(h),u_lightintensity:new r.bM(h),u_lightcolor:new r.bL(h),u_camera_pos:new r.bL(h),u_opacity:new r.bM(h),u_baseColorFactor:new r.ca(h),u_emissiveFactor:new r.ca(h),u_metallicFactor:new r.bM(h),u_roughnessFactor:new r.bM(h),u_baseTextureIsAlpha:new r.bN(h),u_alphaMask:new r.bN(h),u_alphaCutoff:new r.bM(h),u_baseColorTexture:new r.bN(h),u_metallicRoughnessTexture:new r.bN(h),u_normalTexture:new r.bN(h),u_occlusionTexture:new r.bN(h),u_emissionTexture:new r.bN(h),u_lutTexture:new r.bN(h),u_color_mix:new r.ca(h),u_aoIntensity:new r.bM(h),u_emissive_strength:new r.bM(h),u_occlusionTextureTransform:new r.ca(h)}),modelDepth:h=>({u_matrix:new r.bJ(h),u_instance:new r.bJ(h),u_node_matrix:new r.bJ(h)}),groundShadow:h=>({u_matrix:new r.bJ(h),u_ground_shadow_factor:new r.bL(h)}),stars:h=>({u_matrix:new r.bJ(h),u_up:new r.bL(h),u_right:new r.bL(h),u_intensity_multiplier:new r.bM(h)}),snowParticle:h=>({u_modelview:new r.bJ(h),u_projection:new r.bJ(h),u_time:new r.bM(h),u_cam_pos:new r.bL(h),u_velocityConeAperture:new r.bM(h),u_velocity:new r.bM(h),u_horizontalOscillationRadius:new r.bM(h),u_horizontalOscillationRate:new r.bM(h),u_boxSize:new r.bM(h),u_billboardSize:new r.bM(h),u_simpleShapeParameters:new r.bK(h),u_screenSize:new r.bK(h),u_thinningCenterPos:new r.bK(h),u_thinningShape:new r.bL(h),u_thinningAffectedRatio:new r.bM(h),u_thinningParticleOffset:new r.bM(h),u_particleColor:new r.ca(h),u_direction:new r.bL(h)}),rainParticle:h=>({u_modelview:new r.bJ(h),u_projection:new r.bJ(h),u_time:new r.bM(h),u_cam_pos:new r.bL(h),u_texScreen:new r.bN(h),u_velocityConeAperture:new r.bM(h),u_velocity:new r.bM(h),u_boxSize:new r.bM(h),u_rainDropletSize:new r.bK(h),u_distortionStrength:new r.bM(h),u_rainDirection:new r.bL(h),u_color:new r.ca(h),u_screenSize:new r.bK(h),u_thinningCenterPos:new r.bK(h),u_thinningShape:new r.bL(h),u_thinningAffectedRatio:new r.bM(h),u_thinningParticleOffset:new r.bM(h),u_shapeDirectionalPower:new r.bM(h),u_shapeNormalPower:new r.bM(h),u_mode:new r.bM(h)}),vignette:h=>({u_vignetteShape:new r.bL(h),u_vignetteColor:new r.ca(h)}),occlusion:h=>({u_matrix:new r.bJ(h),u_anchorPos:new r.bL(h),u_screenSizePx:new r.bK(h),u_occluderSizePx:new r.bK(h),u_color:new r.ca(h)})};class Xa{constructor(i,l,m,v){this.id=Xa.uniqueIdxCounter,Xa.uniqueIdxCounter++,this.context=i;const x=i.gl;this.buffer=x.createBuffer(),this.dynamicDraw=!!m,this.context.unbindVAO(),i.bindElementBuffer.set(this.buffer),x.bufferData(x.ELEMENT_ARRAY_BUFFER,l.arrayBuffer,this.dynamicDraw?x.DYNAMIC_DRAW:x.STATIC_DRAW),this.dynamicDraw||v||l.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(i){this.id=Xa.uniqueIdxCounter,Xa.uniqueIdxCounter++;const l=this.context.gl;this.context.unbindVAO(),this.bind(),l.bufferSubData(l.ELEMENT_ARRAY_BUFFER,0,i.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}Xa.uniqueIdxCounter=0;const $g={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Ug{constructor(i,l,m,v,x,E){this.length=l.length,this.attributes=m,this.itemSize=l.bytesPerElement,this.dynamicDraw=v,this.instanceCount=E,this.context=i;const L=i.gl;this.buffer=L.createBuffer(),i.bindVertexBuffer.set(this.buffer),L.bufferData(L.ARRAY_BUFFER,l.arrayBuffer,this.dynamicDraw?L.DYNAMIC_DRAW:L.STATIC_DRAW),this.dynamicDraw||x||l.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(i){const l=this.context.gl;this.bind(),l.bufferSubData(l.ARRAY_BUFFER,0,i.arrayBuffer)}enableAttributes(i,l){for(let m=0;m<this.attributes.length;m++){const v=l.attributes[this.attributes[m].name];v!==void 0&&i.enableVertexAttribArray(v)}}setVertexAttribPointers(i,l,m){for(let v=0;v<this.attributes.length;v++){const x=this.attributes[v],E=l.attributes[x.name];E!==void 0&&i.vertexAttribPointer(E,x.components,i[$g[x.type]],!1,this.itemSize,x.offset+this.itemSize*(m||0))}}setVertexAttribDivisor(i,l,m){for(let v=0;v<this.attributes.length;v++){const x=l.attributes[this.attributes[v].name];x!==void 0&&this.instanceCount&&this.instanceCount>0&&i.vertexAttribDivisor(x,m)}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class xp{constructor(i,l,m,v,x){this.context=i,this.width=l,this.height=m;const E=this.framebuffer=i.gl.createFramebuffer();v&&(this.colorAttachment=new zg(i,E)),x&&(this.depthAttachmentType=x,this.depthAttachment=x==="renderbuffer"?new up(i,E):new Uv(i,E))}destroy(){const i=this.context.gl;if(this.colorAttachment){const l=this.colorAttachment.get();l&&i.deleteTexture(l)}if(this.depthAttachment&&this.depthAttachmentType)if(this.depthAttachmentType==="renderbuffer"){const l=this.depthAttachment.get();l&&i.deleteRenderbuffer(l)}else{const l=this.depthAttachment.get();l&&i.deleteTexture(l)}i.deleteFramebuffer(this.framebuffer)}}class Ms{constructor(i,l){this.gl=i,this.clearColor=new Qx(this),this.clearDepth=new ew(this),this.clearStencil=new tw(this),this.colorMask=new Eg(this),this.depthMask=new Mg(this),this.stencilMask=new Ig(this),this.stencilFunc=new Ag(this),this.stencilOp=new Fv(this),this.stencilTest=new Nv(this),this.depthRange=new nw(this),this.depthTest=new Tf(this),this.depthFunc=new Cf(this),this.blend=new Bv(this),this.blendFunc=new Es(this),this.blendColor=new kg(this),this.blendEquation=new op(this),this.cullFace=new sp(this),this.cullFaceSide=new Pg(this),this.frontFace=new Rg(this),this.program=new ap(this),this.activeTexture=new Og(this),this.viewport=new Lg(this),this.bindFramebuffer=new lp(this),this.bindRenderbuffer=new Vv(this),this.bindTexture=new $v(this),this.bindVertexBuffer=new Qc(this),this.bindElementBuffer=new rw(this),this.bindVertexArrayOES=new iw(this),this.pixelStoreUnpack=new ow(this),this.pixelStoreUnpackPremultiplyAlpha=new sw(this),this.pixelStoreUnpackFlipY=new aw(this),this.options=l?{...l}:{},this.options.extTextureFilterAnisotropicForceOff||(this.extTextureFilterAnisotropic=i.getExtension("EXT_texture_filter_anisotropic")||i.getExtension("MOZ_EXT_texture_filter_anisotropic")||i.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=i.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT))),this.extDebugRendererInfo=i.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=i.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=i.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),this.forceManualRenderingForInstanceIDShaders=l&&!!l.forceManualRenderingForInstanceIDShaders||this.renderer&&this.renderer.indexOf("PowerVR")!==-1,this.options.extTextureFloatLinearForceOff||(this.extTextureFloatLinear=i.getExtension("OES_texture_float_linear")),this.extRenderToTextureHalfFloat=i.getExtension("EXT_color_buffer_half_float"),this.extTimerQuery=i.getExtension("EXT_disjoint_timer_query_webgl2"),this.maxTextureSize=i.getParameter(i.MAX_TEXTURE_SIZE),this.maxPointSize=i.getParameter(i.ALIASED_POINT_SIZE_RANGE)[1]}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArrayOES.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(i,l,m){return new Xa(this,i,l,m)}createVertexBuffer(i,l,m,v,x){return new Ug(this,i,l,m,v,x)}createRenderbuffer(i,l,m){const v=this.gl,x=v.createRenderbuffer();return this.bindRenderbuffer.set(x),v.renderbufferStorage(v.RENDERBUFFER,i,l,m),this.bindRenderbuffer.set(null),x}createFramebuffer(i,l,m,v){return new xp(this,i,l,m,v)}clear({color:i,depth:l,stencil:m,colorMask:v}){const x=this.gl;let E=0;i&&(E|=x.COLOR_BUFFER_BIT,this.clearColor.set(i),this.colorMask.set(v||[!0,!0,!0,!0])),l!==void 0&&(E|=x.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(l),this.depthMask.set(!0)),m!==void 0&&(E|=x.STENCIL_BUFFER_BIT,this.clearStencil.set(m),this.stencilMask.set(255)),x.clear(E)}setCullFace(i){i.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(i.mode),this.frontFace.set(i.frontFace))}setDepthMode(i){i.func!==this.gl.ALWAYS||i.mask?(this.depthTest.set(!0),this.depthFunc.set(i.func),this.depthMask.set(i.mask),this.depthRange.set(i.range)):this.depthTest.set(!1)}setStencilMode(i){i.test.func!==this.gl.ALWAYS||i.mask?(this.stencilTest.set(!0),this.stencilMask.set(i.mask),this.stencilOp.set([i.fail,i.depthFail,i.pass]),this.stencilFunc.set({func:i.test.func,ref:i.ref,mask:i.test.mask})):this.stencilTest.set(!1)}setColorMode(i){r.bn(i.blendFunction,zr.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(i.blendFunction),this.blendColor.set(i.blendColor),i.blendEquation?this.blendEquation.set(i.blendEquation):this.blendEquation.setDefault()),this.colorMask.set(i.mask)}unbindVAO(){this.bindVertexArrayOES.set(null)}}let Ra;function jg(h,i,l,m,v,x,E){const L=h.context,$=L.gl,j=h.transform,G=h.getOrCreateProgram("collisionBox"),X=[];let Y=0,ne=0;for(let Be=0;Be<m.length;Be++){const et=m[Be],Ze=i.getTile(et),Xe=Ze.getBucket(l);if(!Xe)continue;const Ke=fo(et,Xe,j);let at=Ke;v[0]===0&&v[1]===0||(at=h.translatePosMatrix(Ke,Ze,v,x));const pt=E?Xe.textCollisionBox:Xe.iconCollisionBox,Vt=Xe.collisionCircleArray;if(Vt.length>0){const Rt=r.ab.mat4.create(),ht=at;r.ab.mat4.mul(Rt,Xe.placementInvProjMatrix,j.glCoordMatrix),r.ab.mat4.mul(Rt,Rt,Xe.placementViewportMatrix),X.push({circleArray:Vt,circleOffset:ne,transform:ht,invTransform:Rt,projection:Xe.getProjection()}),Y+=Vt.length/4,ne=Y}pt&&(h.terrain&&h.terrain.setupElevationDraw(Ze,G),G.draw(h,$.LINES,nr.disabled,Tr.disabled,h.colorModeForRenderPass(),mr.disabled,mp(at,j,Ze,Xe.getProjection()),l.id,pt.layoutVertexBuffer,pt.indexBuffer,pt.segments,null,j.zoom,null,[pt.collisionVertexBuffer,pt.collisionVertexBufferExt]))}if(!E||!X.length)return;const ve=h.getOrCreateProgram("collisionCircle"),_e=new r.cV;_e.resize(4*Y),_e._trim();let Te=0;for(const Be of X)for(let et=0;et<Be.circleArray.length/4;et++){const Ze=4*et,Xe=Be.circleArray[Ze+0],Ke=Be.circleArray[Ze+1],at=Be.circleArray[Ze+2],pt=Be.circleArray[Ze+3];_e.emplace(Te++,Xe,Ke,at,pt,0),_e.emplace(Te++,Xe,Ke,at,pt,1),_e.emplace(Te++,Xe,Ke,at,pt,2),_e.emplace(Te++,Xe,Ke,at,pt,3)}(!Ra||Ra.length<2*Y)&&(Ra=function(Be){const et=2*Be,Ze=new r.aU;Ze.resize(et),Ze._trim();for(let Xe=0;Xe<et;Xe++){const Ke=6*Xe;Ze.uint16[Ke+0]=4*Xe+0,Ze.uint16[Ke+1]=4*Xe+1,Ze.uint16[Ke+2]=4*Xe+2,Ze.uint16[Ke+3]=4*Xe+2,Ze.uint16[Ke+4]=4*Xe+3,Ze.uint16[Ke+5]=4*Xe+0}return Ze}(Y));const Ce=L.createIndexBuffer(Ra,!0),Re=L.createVertexBuffer(_e,r.cW.members,!0);for(const Be of X){const et={u_matrix:Be.transform,u_inv_matrix:Be.invTransform,u_camera_to_center_distance:(je=j).getCameraToCenterDistance(Be.projection),u_viewport_size:[je.width,je.height]};ve.draw(h,$.TRIANGLES,nr.disabled,Tr.disabled,h.colorModeForRenderPass(),mr.disabled,et,l.id,Re,Ce,r.b7.simpleSegment(0,2*Be.circleOffset,Be.circleArray.length,Be.circleArray.length/2),null,j.zoom)}var je;Re.destroy(),Ce.destroy()}const rd=r.ab.mat4.create();function wp(h){const i=h._camera.getWorldToCamera(h.worldSize,1),l=r.ab.mat4.multiply([],i,h.globeMatrix);r.ab.mat4.invert(l,l);const m=[0,0,0],v=[0,1,0,0];return r.ab.vec4.transformMat4(v,v,l),m[0]=v[0],m[1]=v[1],m[2]=v[2],r.ab.vec3.normalize(m,m),m}function Hg({width:h,height:i,anchor:l,textOffset:m,textScale:v},x){const{horizontalAlign:E,verticalAlign:L}=r.bD(l),$=-(E-.5)*h,j=-(L-.5)*i,G=r.bC(l,m);return new r.P(($/v+G[0])*x,(j/v+G[1])*x)}function t0(h,i,l,m,v,x,E,L,$,j,G){const X=h.text.placedSymbolArray,Y=h.text.dynamicLayoutVertexArray,ne=h.icon.dynamicLayoutVertexArray,ve={},_e=h.getProjection(),Te=mf(L,_e,x),Ce=x.elevation,Re=_e.upVectorScale(L.canonical,x.center.lat,x.worldSize).metersToTile;Y.clear();for(let je=0;je<X.length;je++){const Be=X.get(je),{tileAnchorX:et,tileAnchorY:Ze,numGlyphs:Xe}=Be,Ke=Be.hidden||!Be.crossTileID||h.allowVerticalPlacement&&!Be.placedOrientation?null:m[Be.crossTileID];if(Ke){let at=0,pt=0,Vt=0;if(Ce){const Ht=Ce?Ce.getAtTileOffset(L,et,Ze):0,[gn,cn,tn]=_e.upVector(L.canonical,et,Ze);at=Ht*gn*Re,pt=Ht*cn*Re,Vt=Ht*tn*Re}let[Rt,ht,St,en]=zi(Be.projectedAnchorX+at,Be.projectedAnchorY+pt,Be.projectedAnchorZ+Vt,l?Te:E);const hn=Sv(x.getCameraToCenterDistance(_e),en);let vn=v.evaluateSizeForFeature(h.textSizeData,j,Be)*hn/r.bw;l&&(vn*=h.tilePixelRatio/$);const It=Hg(Ke,vn);l?({x:Rt,y:ht,z:St}=_e.projectTilePoint(et+It.x,Ze+It.y,L.canonical),[Rt,ht,St]=zi(Rt+at,ht+pt,St+Vt,E)):(i&&It._rotate(-x.angle),Rt+=It.x,ht+=It.y,St=0);const ln=h.allowVerticalPlacement&&Be.placedOrientation===r.bq.vertical?Math.PI/2:0;for(let Ht=0;Ht<Xe;Ht++)r.bt(Y,Rt,ht,St,ln);G&&Be.associatedIconIndex>=0&&(ve[Be.associatedIconIndex]={x:Rt,y:ht,z:St,angle:ln})}else Ju(Xe,Y)}if(G){ne.clear();const je=h.icon.placedSymbolArray;for(let Be=0;Be<je.length;Be++){const et=je.get(Be),{numGlyphs:Ze}=et,Xe=ve[Be];if(et.hidden||!Xe)Ju(Ze,ne);else{const{x:Ke,y:at,z:pt,angle:Vt}=Xe;for(let Rt=0;Rt<Ze;Rt++)r.bt(ne,Ke,at,pt,Vt)}}h.icon.dynamicLayoutVertexBuffer.updateData(ne)}h.text.dynamicLayoutVertexBuffer.updateData(Y)}function Is(h,i,l,m,v,x,E={}){const L=l.paint.get("icon-translate"),$=l.paint.get("text-translate"),j=l.paint.get("icon-translate-anchor"),G=l.paint.get("text-translate-anchor"),X=l.layout.get("icon-rotation-alignment"),Y=l.layout.get("text-rotation-alignment"),ne=l.layout.get("icon-pitch-alignment"),ve=l.layout.get("text-pitch-alignment"),_e=l.layout.get("icon-keep-upright"),Te=l.layout.get("text-keep-upright"),Ce=l.paint.get("icon-color-saturation"),Re=l.paint.get("icon-color-contrast"),je=l.paint.get("icon-color-brightness-min"),Be=l.paint.get("icon-color-brightness-max"),et=l.layout.get("symbol-elevation-reference")==="sea",Ze=h.context,Xe=Ze.gl,Ke=h.transform,at=X==="map",pt=Y==="map",Vt=ne==="map",Rt=ve==="map",ht=l.layout.get("symbol-sort-key").constantOr(1)!==void 0;let St=!1;const en=h.depthModeForSublayer(0,nr.ReadOnly),hn=[r.at(Ke.center.lng),r.aA(Ke.center.lat)],vn=l.layout.get("text-variable-anchor"),It=Ke.projection.name==="globe",ln=[],Ht=[0,-1,0];for(const gn of m){const cn=i.getTile(gn),tn=cn.getBucket(l);if(!tn||tn.projection.name==="mercator"&&It||tn.fullyClipped)continue;const Rn=tn.projection.name==="globe",Dn=Rn?r.ae(Ke.zoom):0,An=mf(gn,tn.getProjection(),Ke),Bn=Ke.calculatePixelsToTileUnitsMatrix(cn),br=vn&&tn.hasTextData(),ir=tn.hasIconTextFit()&&br&&tn.hasIconData(),rr=tn.getProjection().createInversionMatrix(Ke,gn.canonical),wr=fr=>{Ke.depthOcclusionForSymbolsAndCircles&&(l.hasInitialOcclusionOpacityProperties||h.terrain)&&(fr.push("DEPTH_D24"),fr.push("DEPTH_OCCLUSION"))},Gr=()=>{const fr=at&&l.layout.get("symbol-placement")!=="point",ni=[];wr(ni);const Ki=fr||ir,Do=l.paint.get("icon-image-cross-fade").constantOr(0);h.terrainRenderModeElevated()&&Vt&&ni.push("PITCH_WITH_MAP_TERRAIN"),Rn&&(ni.push("PROJECTION_GLOBE_VIEW"),Ki&&ni.push("PROJECTED_POS_ON_VIEWPORT")),Do>0&&ni.push("ICON_TRANSITION"),tn.icon.zOffsetVertexBuffer&&ni.push("Z_OFFSET"),Ce===0&&Re===0&&je===0&&Be===1||ni.push("COLOR_ADJUSTMENT"),tn.sdfIcons&&ni.push("RENDER_SDF");const Rs=tn.icon.programConfigurations.get(l.id),Zo=h.getOrCreateProgram("symbol",{config:Rs,defines:ni}),Io=cn.imageAtlasTexture?cn.imageAtlasTexture.size:[0,0],ho=tn.iconSizeData,to=r.bp(ho,Ke.zoom),Ni=Vt||Ke.pitch!==0,Ci=bl(An,cn.tileID.canonical,Vt,at,Ke,tn.getProjection(),Bn),Zr=Wo(An,cn.tileID.canonical,Vt,at,Ke,tn.getProjection(),Bn),Xi=h.translatePosMatrix(Zr,cn,L,j,!0),Ao=h.translatePosMatrix(An,cn,L,j),Pi=Ki?rd:Ci,jo=at&&!Vt&&!fr;let js=Ht;!It&&!Ke.mercatorFromTransition||at||(js=wp(Ke));const hs=Rn?js:Ht,Ol=l.getColorAdjustmentMatrix(Ce,Re,je,Be),Qa=Jv(ho.kind,to,jo,Vt,h,Ao,Pi,Xi,et,!1,Io,[0,0],!0,gn,Dn,hn,rr,hs,tn.getProjection(),Ol,Do),Yo=cn.imageAtlasTexture?cn.imageAtlasTexture:null,Hs=l.layout.get("icon-size").constantOr(0)!==1||tn.iconsNeedLinear,Ll=tn.sdfIcons||h.options.rotating||h.options.zooming||Hs||Ni?Xe.LINEAR:Xe.NEAREST,za=tn.sdfIcons&&l.paint.get("icon-halo-width").constantOr(1)!==0,pc=h.terrain&&Vt&&fr?r.ab.mat4.invert(r.ab.mat4.create(),Ci):rd;if(fr&&tn.icon){const jf=Ke.elevation,p_=jf?jf.getAtTileOffsetFunc(gn,Ke.center.lat,Ke.worldSize,tn.getProjection()):null,Vp=Xu(An,cn.tileID.canonical,Vt,at,Ke,tn.getProjection(),Bn);jh(tn,An,h,!1,Vp,Zr,Vt,_e,p_,gn)}return{program:Zo,buffers:tn.icon,uniformValues:Qa,atlasTexture:Yo,atlasTextureIcon:null,atlasInterpolation:Ll,atlasInterpolationIcon:null,isSDF:tn.sdfIcons,hasHalo:za,tile:cn,labelPlaneMatrixInv:pc}},Or=()=>{const fr=pt&&l.layout.get("symbol-placement")!=="point",ni=[],Ki=fr||vn||ir;h.terrainRenderModeElevated()&&Rt&&ni.push("PITCH_WITH_MAP_TERRAIN"),Rn&&(ni.push("PROJECTION_GLOBE_VIEW"),Ki&&ni.push("PROJECTED_POS_ON_VIEWPORT")),tn.text.zOffsetVertexBuffer&&ni.push("Z_OFFSET"),tn.iconsInText&&ni.push("RENDER_TEXT_AND_SYMBOL"),ni.push("RENDER_SDF"),wr(ni);const Do=tn.text.programConfigurations.get(l.id),Rs=h.getOrCreateProgram("symbol",{config:Do,defines:ni});let Zo,Io=[0,0],ho=null;const to=tn.textSizeData;tn.iconsInText&&(Io=cn.imageAtlasTexture?cn.imageAtlasTexture.size:[0,0],ho=cn.imageAtlasTexture?cn.imageAtlasTexture:null,Zo=Rt||Ke.pitch!==0||h.options.rotating||h.options.zooming||to.kind==="composite"||to.kind==="camera"?Xe.LINEAR:Xe.NEAREST);const Ni=cn.glyphAtlasTexture?cn.glyphAtlasTexture.size:[0,0],Ci=l.layout.get("text-size-scale-range"),Zr=r.aw(h.scaleFactor,Ci[0],Ci[1]),Xi=r.bp(to,Ke.zoom,Zr),Ao=bl(An,cn.tileID.canonical,Rt,pt,Ke,tn.getProjection(),Bn),Pi=Wo(An,cn.tileID.canonical,Rt,pt,Ke,tn.getProjection(),Bn),jo=h.translatePosMatrix(Pi,cn,$,G,!0),js=h.translatePosMatrix(An,cn,$,G),hs=Ki?rd:Ao,Ol=pt&&!Rt&&!fr;let Qa=Ht;!It&&!Ke.mercatorFromTransition||pt||(Qa=wp(Ke));const Yo=Jv(to.kind,Xi,Ol,Rt,h,js,hs,jo,et,!0,Ni,Io,!0,gn,Dn,hn,rr,Rn?Qa:Ht,tn.getProjection(),null,null,Zr),Hs=cn.glyphAtlasTexture?cn.glyphAtlasTexture:null,Ll=Xe.LINEAR,za=l.paint.get("text-halo-width").constantOr(1)!==0,pc=h.terrain&&Rt&&fr?r.ab.mat4.invert(r.ab.mat4.create(),Ao):rd;if(fr&&tn.text){const jf=Ke.elevation,p_=jf?jf.getAtTileOffsetFunc(gn,Ke.center.lat,Ke.worldSize,tn.getProjection()):null,Vp=Xu(An,cn.tileID.canonical,Rt,pt,Ke,tn.getProjection(),Bn);jh(tn,An,h,!0,Vp,Pi,Rt,Te,p_,gn)}return{program:Rs,buffers:tn.text,uniformValues:Yo,atlasTexture:Hs,atlasTextureIcon:ho,atlasInterpolation:Ll,atlasInterpolationIcon:Zo,isSDF:!0,hasHalo:za,tile:cn,labelPlaneMatrixInv:pc}},Ui=tn.icon.segments.get().length,ki=tn.text.segments.get().length,li=Ui&&!E.onlyText?Gr():null,mi=ki&&!E.onlyIcons?Or():null,Lr=l.paint.get("icon-opacity").constantOr(1),Kr=l.paint.get("text-opacity").constantOr(1);if(ht&&tn.canOverlap){St=!0;const fr=Lr&&!E.onlyText?tn.icon.segments.get():[],ni=Kr&&!E.onlyIcons?tn.text.segments.get():[];for(const Ki of fr)ln.push({segments:new r.b7([Ki]),sortKey:Ki.sortKey,state:li});for(const Ki of ni)ln.push({segments:new r.b7([Ki]),sortKey:Ki.sortKey,state:mi})}else E.onlyText||ln.push({segments:Lr?tn.icon.segments:new r.b7([]),sortKey:0,state:li}),E.onlyIcons||ln.push({segments:Kr?tn.text.segments:new r.b7([]),sortKey:0,state:mi})}St&&ln.sort((gn,cn)=>gn.sortKey-cn.sortKey);for(const gn of ln){const cn=gn.state;if(cn)if(h.terrain?h.terrain.setupElevationDraw(cn.tile,cn.program,{useDepthForOcclusion:Ke.depthOcclusionForSymbolsAndCircles,labelPlaneMatrixInv:cn.labelPlaneMatrixInv}):h.setupDepthForOcclusion(Ke.depthOcclusionForSymbolsAndCircles,cn.program),Ze.activeTexture.set(Xe.TEXTURE0),cn.atlasTexture&&cn.atlasTexture.bind(cn.atlasInterpolation,Xe.CLAMP_TO_EDGE,!0),cn.atlasTextureIcon&&(Ze.activeTexture.set(Xe.TEXTURE1),cn.atlasTextureIcon&&cn.atlasTextureIcon.bind(cn.atlasInterpolationIcon,Xe.CLAMP_TO_EDGE,!0)),h.uploadCommonLightUniforms(h.context,cn.program),cn.hasHalo){const tn=cn.uniformValues;tn.u_is_halo=1,ji(cn.buffers,gn.segments,l,h,cn.program,en,v,x,tn,2),tn.u_is_halo=0}else{if(cn.isSDF){const tn=cn.uniformValues;cn.hasHalo&&(tn.u_is_halo=1,ji(cn.buffers,gn.segments,l,h,cn.program,en,v,x,tn,1)),tn.u_is_halo=0}ji(cn.buffers,gn.segments,l,h,cn.program,en,v,x,cn.uniformValues,1)}}}function ji(h,i,l,m,v,x,E,L,$,j){const G=[h.dynamicLayoutVertexBuffer,h.opacityVertexBuffer,h.iconTransitioningVertexBuffer,h.globeExtVertexBuffer,h.zOffsetVertexBuffer];v.draw(m,m.context.gl.TRIANGLES,x,E,L,mr.disabled,$,l.id,h.layoutVertexBuffer,h.indexBuffer,i,l.paint,m.transform.zoom,h.programConfigurations.get(l.id),G,j)}function Pf(h,i,l,m,v,x,E){const L=h.context.gl,$=l.paint.get("fill-pattern"),j=l.is3D(),G=j?h.stencilModeFor3D():Tr.disabled,X=$&&$.constantOr(1);let Y,ne,ve,_e,Te;E?(ne=X&&!l.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",Y=L.LINES):(ne=X?"fillPattern":"fill",Y=L.TRIANGLES);for(const Ce of m){const Re=i.getTile(Ce);if(X&&!Re.patternsLoaded())continue;const je=Re.getBucket(l);if(!je)continue;h.prepareDrawTile();const Be=je.programConfigurations.get(l.id),et=h.isTileAffectedByFog(Ce),Ze=h.getOrCreateProgram(ne,{config:Be,overrideFog:et});X&&(h.context.activeTexture.set(L.TEXTURE0),Re.imageAtlasTexture&&Re.imageAtlasTexture.bind(L.LINEAR,L.CLAMP_TO_EDGE),Be.updatePaintBuffers());const Xe=$.constantOr(null);if(Xe&&Re.imageAtlas){const pt=Re.imageAtlas,Vt=r.A.from(Xe),Rt=pt.patternPositions[Vt.getSerializedPrimary()];Rt&&Be.setConstantPatternPositions(Rt)}const Ke=h.translatePosMatrix(Ce.projMatrix,Re,l.paint.get("fill-translate"),l.paint.get("fill-translate-anchor")),at=l.paint.get("fill-emissive-strength");if(E){_e=je.indexBuffer2,Te=je.segments2;const pt=h.terrain&&h.terrain.renderingToTexture?h.terrain.drapeBufferSize:[L.drawingBufferWidth,L.drawingBufferHeight];ve=ne==="fillOutlinePattern"&&X?pp(Ke,at,h,Re,pt):Zv(Ke,at,pt)}else _e=je.indexBuffer,Te=je.segments,ve=X?nd(Ke,at,h,Re):hp(Ke,at);h.uploadCommonUniforms(h.context,Ze,Ce.toUnwrapped()),Ze.draw(h,Y,v,j?G:h.stencilModeForClipping(Ce),x,mr.disabled,ve,l.id,je.layoutVertexBuffer,_e,Te,l.paint,h.transform.zoom,Be,void 0)}}function id(h,i,l,m,v,x,E,L){l.resetLayerRenderingStats(h);const $=h.context,j=$.gl,G=h.transform,X=l.paint.get("fill-extrusion-pattern"),Y=X.constantOr(1),ne=l.paint.get("fill-extrusion-opacity"),ve=h.style.enable3dLights(),_e=l.paint.get(ve&&!Y?"fill-extrusion-ambient-occlusion-wall-radius":"fill-extrusion-ambient-occlusion-radius"),Te=[l.paint.get("fill-extrusion-ambient-occlusion-intensity"),_e],Ce=l.layout.get("fill-extrusion-edge-radius"),Re=Ce>0&&!l.paint.get("fill-extrusion-rounded-roof"),je=Re?0:Ce,Be=G.projection.name==="globe"?r.d3():0,et=G.projection.name==="globe",Ze=et?r.ae(G.zoom):0,Xe=[r.at(G.center.lng),r.aA(G.center.lat)],Ke=l.paint.get("fill-extrusion-flood-light-color-use-theme").constantOr("default")==="none",at=l.paint.get("fill-extrusion-flood-light-color").toRenderColor(Ke?null:l.lut).toArray01().slice(0,3),pt=l.paint.get("fill-extrusion-flood-light-intensity"),Vt=l.paint.get("fill-extrusion-vertical-scale"),Rt=l.paint.get("fill-extrusion-line-width").constantOr(1)!==0,ht=l.paint.get("fill-extrusion-height-alignment"),St=l.paint.get("fill-extrusion-base-alignment"),en=Tl(h,l.paint.get("fill-extrusion-cutoff-fade-range")),hn=[];let vn;et&&hn.push("PROJECTION_GLOBE_VIEW"),Te[0]>0&&hn.push("FAUX_AO"),Re&&hn.push("ZERO_ROOF_RADIUS"),L&&hn.push("HAS_CENTROID"),pt>0&&hn.push("FLOOD_LIGHT"),en.shouldRenderCutoff&&hn.push("RENDER_CUTOFF"),Rt&&hn.push("RENDER_WALL_MODE");const It=h.renderPass==="shadow",ln=h.shadowRenderer,Ht=It&&!!ln;h.shadowRenderer&&(h.shadowRenderer.useNormalOffset=!0);let gn=[0,0,0];if(ln){const Rn=h.style.directionalLight,Dn=h.style.ambientLight;Rn&&Dn&&(gn=Zc(h.style,Rn,Dn)),It||(hn.push("RENDER_SHADOWS","DEPTH_TEXTURE"),ln.useNormalOffset&&hn.push("NORMAL_OFFSET")),vn=hn.concat(["SHADOWS_SINGLE_CASCADE"])}const cn=Ht?"fillExtrusionDepth":Y?"fillExtrusionPattern":"fillExtrusion",tn=l.getLayerRenderingStats();for(const Rn of m){const Dn=i.getTile(Rn),An=Dn.getBucket(l);if(!An||An.projection.name!==G.projection.name)continue;let Bn=!1;ln&&(Bn=ln.getMaxCascadeForTile(Rn.toUnwrapped())===0);const br=h.isTileAffectedByFog(Rn),ir=An.programConfigurations.get(l.id),rr=h.getOrCreateProgram(cn,{config:ir,defines:Bn?vn:hn,overrideFog:br});if(h.terrain&&h.terrain.setupElevationDraw(Dn,rr,{useMeterToDem:!0}),!An.centroidVertexBuffer){const mi=rr.attributes.a_centroid_pos;mi!==void 0&&j.vertexAttrib2f(mi,0,0)}!It&&ln&&ln.setupShadows(Dn.tileID.toUnwrapped(),rr,"vector-tile",Dn.tileID.overscaledZ),Y&&(h.context.activeTexture.set(j.TEXTURE0),Dn.imageAtlasTexture&&Dn.imageAtlasTexture.bind(j.LINEAR,j.CLAMP_TO_EDGE),ir.updatePaintBuffers());const wr=X.constantOr(null);if(wr&&Dn.imageAtlas){const mi=Dn.imageAtlas,Lr=r.A.from(wr),Kr=mi.patternPositions[Lr.getSerializedPrimary()];Kr&&ir.setConstantPatternPositions(Kr)}const Gr=l.paint.get("fill-extrusion-vertical-gradient"),Or=1/An.tileToMeter;let Ui;if(It&&ln){if(sd(Dn.tileID,An,h))continue;const mi=ln.calculateShadowPassMatrixFromTile(Dn.tileID.toUnwrapped());Ui=Vg(mi,je,Or,Vt,ht,St)}else{const mi=h.translatePosMatrix(Rn.expandedProjMatrix,Dn,l.paint.get("fill-extrusion-translate"),l.paint.get("fill-extrusion-translate-anchor")),Lr=G.projection.createInversionMatrix(G,Rn.canonical);Ui=Y?Af(mi,h,Gr,ne,Te,je,Or,Rn,Dn,Be,ht,St,Ze,Xe,Lr,at,Vt):fp(mi,h,Gr,ne,Te,je,Or,Rn,Be,ht,St,Ze,Xe,Lr,at,Vt,pt,gn)}h.uploadCommonUniforms($,rr,Rn.toUnwrapped(),null,en);let ki=An.segments;if(G.projection.name==="mercator"&&!It&&(ki=An.getVisibleSegments(Dn.tileID,h.terrain,h.transform.getFrustum(0)),!ki.get().length))continue;if(tn)if(It)for(const mi of ki.get())tn.numRenderedVerticesInShadowPass+=mi.primitiveLength;else for(const mi of ki.get())tn.numRenderedVerticesInTransparentPass+=mi.primitiveLength;const li=[];(h.terrain||L)&&li.push(An.centroidVertexBuffer),et&&li.push(An.layoutVertexExtBuffer),Rt&&li.push(An.wallVertexBuffer),rr.draw(h,$.gl.TRIANGLES,v,x,E,mr.backCCW,Ui,l.id,An.layoutVertexBuffer,An.indexBuffer,ki,l.paint,h.transform.zoom,ir,li)}h.shadowRenderer&&(h.shadowRenderer.useNormalOffset=!1)}function lc(h,i,l,m,v,x,E,L,$,j,G,X,Y,ne,ve,_e,Te,Ce,Re){const je=h.context,Be=je.gl,et=h.transform,Ze=h.transform.zoom,Xe=[],Ke=Tl(h,l.paint.get("fill-extrusion-cutoff-fade-range"));j==="clear"?(Xe.push("CLEAR_SUBPASS"),Re&&(Xe.push("CLEAR_FROM_TEXTURE"),je.activeTexture.set(Be.TEXTURE0),Re.bind(Be.LINEAR,Be.CLAMP_TO_EDGE))):j==="sdf"&&Xe.push("SDF_SUBPASS"),Te&&Xe.push("HAS_CENTROID"),Ke.shouldRenderCutoff&&Xe.push("RENDER_CUTOFF");const at=l.layout.get("fill-extrusion-edge-radius"),pt=(Vt,Rt,ht,St,en)=>{const hn=Rt.programConfigurations.get(l.id),vn=h.isTileAffectedByFog(Vt),It=h.getOrCreateProgram("fillExtrusionGroundEffect",{config:hn,defines:Xe,overrideFog:vn}),ln=((gn,cn,tn,Rn,Dn,An,Bn,br,ir,rr,wr)=>({u_matrix:cn,u_opacity:tn,u_ao_pass:Rn?1:0,u_meter_to_tile:Dn,u_ao:An,u_flood_light_intensity:Bn,u_flood_light_color:br,u_attenuation:ir,u_edge_radius:rr,u_fb:0,u_fb_size:wr,u_dynamic_offset:1}))(0,St,G,$,en,[X,Y*en],ne,ve,_e,Ze>=17?0:at*en,Re?Re.size[0]:0),Ht=[];Te&&Ht.push(Rt.hiddenByLandmarkVertexBuffer),h.uploadCommonUniforms(je,It,Vt.toUnwrapped(),null,Ke),It.draw(h,je.gl.TRIANGLES,v,x,E,L,ln,l.id,Rt.vertexBuffer,Rt.indexBuffer,ht,l.paint,Ze,hn,Ht)};for(const Vt of m){const Rt=i.getTile(Vt),ht=Rt.getBucket(l);if(!ht||ht.projection.name!==et.projection.name||!ht.groundEffect||ht.groundEffect&&!ht.groundEffect.hasData())continue;const St=ht.groundEffect,en=1/ht.tileToMeter;{const hn=h.translatePosMatrix(Vt.projMatrix,Rt,l.paint.get("fill-extrusion-translate"),l.paint.get("fill-extrusion-translate-anchor")),vn=St.getDefaultSegment();pt(Vt,St,vn,hn,en)}if(Ce)for(let hn=0;hn<4;hn++){const vn=r.d4[hn](Vt),It=i.getTile(vn);if(!It)continue;const ln=It.getBucket(l);if(!ln||ln.projection.name!==et.projection.name||!ln.groundEffect||ln.groundEffect&&!ln.groundEffect.hasData())continue;const Ht=ln.groundEffect;let gn,cn;hn===0?(gn=[-r.ag,0,0],cn=1):hn===1?(gn=[r.ag,0,0],cn=0):hn===2?(gn=[0,-r.ag,0],cn=3):(gn=[0,r.ag,0],cn=2);const tn=Ht.regionSegments[cn];if(!tn)continue;const Rn=new Float32Array(16);r.ab.mat4.translate(Rn,Vt.projMatrix,gn),pt(Vt,Ht,tn,h.translatePosMatrix(Rn,Rt,l.paint.get("fill-extrusion-translate"),l.paint.get("fill-extrusion-translate-anchor")),en)}}}function n0(h,i,l,m,v,x,E){m.centroidVertexArray.length===0&&m.createCentroidsBuffer();const L=x?x.findDEMTileFor(l):null;if(!(L&&L.dem||E))return;x&&L&&L.dem&&m.selfDEMTileTimestamp!==L.dem._timestamp&&(m.borderDoneWithNeighborZ=[-1,-1,-1,-1],m.selfDEMTileTimestamp=L.dem._timestamp);const $=Ce=>new r.P(Math.ceil((Ce+r.d7)*r.d8),0),j=Ce=>{const Re=i.getSource().minzoom,je=et=>{const Ze=i.getTileByID(et);if(Ze&&Ze.hasData())return Ze.getBucket(v)},Be=[0,-1,1];for(const et of Be){if(Ce.overscaledZ+et<Re)continue;const Ze=je(Ce.calculateScaledKey(Ce.overscaledZ+et));if(Ze)return Ze}},G=[0,0,0],X=(Ce,Re)=>(G[0]=Math.min(Ce.min.y,Re.min.y),G[1]=Math.max(Ce.max.y,Re.max.y),G[2]=r.ag-Re.min.x>Ce.max.x?Re.min.x-r.ag:Ce.max.x,G),Y=(Ce,Re)=>(G[0]=Math.min(Ce.min.x,Re.min.x),G[1]=Math.max(Ce.max.x,Re.max.x),G[2]=r.ag-Re.min.y>Ce.max.y?Re.min.y-r.ag:Ce.max.y,G),ne=[(Ce,Re)=>X(Ce,Re),(Ce,Re)=>X(Re,Ce),(Ce,Re)=>Y(Ce,Re),(Ce,Re)=>Y(Re,Ce)],ve=(Ce,Re,je,Be,et,Ze,Xe)=>{if(!x)return 0;const Ke=[[Ze?je:Ce,Ze?Ce:je,0],[Ze?je:Re,Ze?Re:je,0]],at=Xe<0?r.ag+Xe:Xe,pt=[Ze?at:(Ce+Re)/2,Ze?(Ce+Re)/2:at,0];return je===0&&Xe<0||je!==0&&Xe>0?x.getForTilePoints(et,[pt],!0,Be):Ke.push(pt),x.getForTilePoints(l,Ke,!0,L),Math.max(Ke[0][2],Ke[1][2],pt[2])/x.exaggeration()};for(let Ce=0;Ce<4;Ce++){const Re=m.borderFeatureIndices[Ce];if(Re.length===0)continue;const je=r.d4[Ce](l),Be=j(je);if(!(Be&&Be instanceof r.d5))continue;const et=x?x.findDEMTileFor(je):null;if(!(et&&et.dem||E)||(x&&et&&et.dem&&m.borderDEMTileTimestamp[Ce]!==et.dem._timestamp&&(m.borderDoneWithNeighborZ[Ce]=-1,m.borderDEMTileTimestamp[Ce]=et.dem._timestamp),m.borderDoneWithNeighborZ[Ce]===Be.canonical.z))continue;Be.centroidVertexArray.length===0&&Be.createCentroidsBuffer();const Ze=(Ce<2?1:5)-Ce,Xe=Be.borderDoneWithNeighborZ[Ze]!==m.canonical.z,Ke=Be.borderFeatureIndices[Ze];let at=0;if(m.canonical.z!==Be.canonical.z){for(const pt of Re)m.showCentroid(m.featuresOnBorder[pt]);if(Xe)for(const pt of Ke)Be.showCentroid(Be.featuresOnBorder[pt]);m.borderDoneWithNeighborZ[Ce]=Be.canonical.z,Be.borderDoneWithNeighborZ[Ze]=m.canonical.z}for(const pt of Re){const Vt=m.featuresOnBorder[pt],Rt=m.centroidData[Vt.centroidDataIndex],ht=Vt.borders[Ce];let St;for(;at<Ke.length;){St=Be.featuresOnBorder[Ke[at]];const en=St.borders[Ze];if(en[1]>ht[0]+3||en[0]>ht[0]-3)break;Be.showCentroid(St),at++}if(St&&at<Ke.length){const en=at;let hn=0;for(;!(St.borders[Ze][0]>ht[1]-3)&&(hn++,++at!==Ke.length);)St=Be.featuresOnBorder[Ke[at]];St=Be.featuresOnBorder[Ke[en]];let vn=!1;if(hn>=1){const Ht=St.borders[Ze];Math.abs(ht[0]-Ht[0])<3&&Math.abs(ht[1]-Ht[1])<3&&(hn=1,vn=!0,at=en+1)}else if(hn===0){m.showCentroid(Vt);continue}const It=Be.centroidData[St.centroidDataIndex];E&&vn&&(((_e=Rt).flags|(Te=It).flags)&r.d6?(_e.flags|=r.d6,Te.flags|=r.d6):(_e.flags&=~r.d6,Te.flags&=~r.d6));const ln=Vt.intersectsCount()>1||St.intersectsCount()>1;if(hn>1)at=en,Rt.centroidXY=It.centroidXY=new r.P(0,0);else if(et&&et.dem&&!ln){const Ht=ne[Ce](Rt,It),gn=Ce%2?r.ag-1:0,cn=ve(Ht[0],Math.min(r.ag-1,Ht[1]),gn,et,je,Ce<2,Ht[2]);Rt.centroidXY=It.centroidXY=$(cn)}else ln?Rt.centroidXY=It.centroidXY=new r.P(0,0):(Rt.centroidXY=m.encodeBorderCentroid(Vt),It.centroidXY=Be.encodeBorderCentroid(St));m.writeCentroidToBuffer(Rt),Be.writeCentroidToBuffer(It)}else m.showCentroid(Vt)}m.borderDoneWithNeighborZ[Ce]=Be.canonical.z,Be.borderDoneWithNeighborZ[Ze]=m.canonical.z}var _e,Te;(m.needsCentroidUpdate||!m.centroidVertexBuffer&&m.centroidVertexArray.length!==0)&&m.uploadCentroid(h)}const r0=[1,0,0],fw=[0,1,0],od=[0,0,1];function sd(h,i,l){const m=l.transform,v=l.shadowRenderer;if(!v)return!0;const x=h.toUnwrapped(),E=m.tileSize*v._cascades[l.currentShadowCascade].scale;let L=i.maxHeight;if(m.elevation){const _e=m.elevation.getMinMaxForTile(h);_e&&(L+=_e.max)}const $=[...v.shadowDirection];$[2]=-$[2];const j=v.computeSimplifiedTileShadowVolume(x,L,E,$);if(!j)return!1;const G=[r0,fw,od,$,[$[0],0,$[2]],[0,$[1],$[2]]],X=m.projection.name==="globe",Y=m.scaleZoom(E),ne=r.bR.fromInvProjectionMatrix(m.invProjMatrix,m.worldSize,Y,!X),ve=v.getCurrentCascadeFrustum();return ne.intersectsPrecise(j.vertices,j.planes,G)===0||ve.intersectsPrecise(j.vertices,j.planes,G)===0}function _n(h){return[h[0]*r.d9,h[1]*r.d9,h[2]*r.d9,0]}function Fn(h,i,l,m,v,x,E,L,$){const j=m.getSource(),G=l.globeSharedBuffers;if(!G)return;let X,Y,ne;if(i&&(X=m.getTile(i)),j instanceof r.aJ?(Y=j.texture,ne=r.cI(0,0,l.transform)):X&&i&&(Y=X.texture,ne=r.cI(i.canonical.z,i.canonical.x,l.transform)),!Y||!ne)return;h||(ne=r.ab.mat4.scale(r.ab.mat4.create(),ne,[1,-1,1]));const ve=l.context,_e=ve.gl,Te=v.paint.get("raster-resampling")==="nearest"?_e.NEAREST:_e.LINEAR,Ce=l.colorModeForDrapableLayerRenderPass(x),Re=E.defines;Re.push("GLOBE_POLES");const je=new nr(_e.LEQUAL,nr.ReadWrite,l.depthRangeFor3D),Be=Float32Array.from(l.transform.expandedFarZProjMatrix),et=Float32Array.from(r.bb(r.cH(new r.bT(0,0,0))));l.terrain&&l.terrain.prepareDrawTile(),ve.activeTexture.set(_e.TEXTURE0),Y.bind(Te,_e.CLAMP_TO_EDGE),ve.activeTexture.set(_e.TEXTURE1),Y.bind(Te,_e.CLAMP_TO_EDGE),Y.useMipmap&&ve.extTextureFilterAnisotropic&&l.transform.pitch>20&&_e.texParameterf(_e.TEXTURE_2D,ve.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,ve.extTextureFilterAnisotropicMax);const[Ze,Xe,Ke,at]=i?G.getPoleBuffers(i.canonical.z,!1):G.getPoleBuffers(0,!0),pt=v.paint.get("raster-elevation");let Vt;h?(Vt=Ze,l.renderDefaultNorthPole=pt!==0):(Vt=Xe,l.renderDefaultSouthPole=pt!==0);const Rt=_n(E.mix),ht=((en,hn,vn,It,ln,Ht,gn,cn,tn,Rn,Dn,An,Bn)=>Gn(en,hn,vn,new Float32Array(16),new Float32Array(9),[0,0],It,[0,0],[0,0,0,0],1,{opacity:1,mix:0},Ht,[0,0],cn,2,Rn,Dn,An,1,0,Bn))(Be,et,ne,r.ae(l.transform.zoom),0,v,0,pt,0,Rt,E.offset,E.range,x),St=l.getOrCreateProgram("raster",{defines:Re});l.uploadCommonUniforms(ve,St,null),St.draw(l,_e.TRIANGLES,je,$,Ce,L,ht,v.id,Vt,Ke,at)}function ad(h){const i=h._nearZ,l=h.projection.farthestPixelDistance(h),m=l-i,v=.2*h.height,x=i+v;return[i,l,(x-v-i)/m,(x-i)/m]}function Zi(h,i,l,m){if(h)return i instanceof yl&&h instanceof Nh?i.getTextureDescriptor(h,l,!0):{texture:h.texture,mix:_n(m.mix),offset:m.offset,buffer:0,tileSize:1}}var Ot=r.da([{name:"a_index",type:"Int16",components:1}]);class i0{constructor(i,l,m,v){const x={width:m[0],height:m[1],data:null},E=i.gl;this.targetColorTexture=new r.T(i,x,E.RGBA8,{useMipmap:!1}),this.backgroundColorTexture=new r.T(i,x,E.RGBA8,{useMipmap:!1}),this.context=i,this.updateParticleTexture(l,v),this.lastInvalidatedAt=0}updateParticleTexture(i,l){if(this.particleTextureDimension===l.width)return;(this.particleTexture0||this.particleTexture1||this.particleIndexBuffer||this.particleSegment)&&(this.particleTexture0.destroy(),this.particleTexture1.destroy(),this.particleIndexBuffer.destroy(),this.particleSegment.destroy());const m=this.context.gl,v=l.width*l.height;this.particleTexture0=new r.T(this.context,l,m.RGBA8,{premultiply:!1,useMipmap:!1}),this.particleTexture1=new r.T(this.context,l,m.RGBA8,{premultiply:!1,useMipmap:!1});const x=new r.db;x.reserve(v);for(let E=0;E<v;E++)x.emplaceBack(E);this.particleIndexBuffer=this.context.createVertexBuffer(x,Ot.members,!0),this.particleSegment=r.b7.simpleSegment(0,0,this.particleIndexBuffer.length,0),this.particleTextureDimension=l.width}update(i){return!(this.lastInvalidatedAt<i&&(this.lastInvalidatedAt=r.q.now(),1))}destroy(){this.targetColorTexture.destroy(),this.backgroundColorTexture.destroy(),this.particleIndexBuffer.destroy(),this.particleTexture0.destroy(),this.particleTexture1.destroy(),this.particleSegment.destroy()}}function Sp(h,i,l){if(!h)return null;const m=i.getTextureDescriptor(h,l,!0);if(!m)return null;let{texture:v,mix:x,offset:E,tileSize:L,buffer:$,format:j}=m;if(!v||!j)return null;let G=!1;return j==="uint32"&&(G=!0,x[3]=0,x=ic(r.dc,x,[0,l.paint.get("raster-particle-max-speed")]),E=kf(r.dc,E,[0,l.paint.get("raster-particle-max-speed")])),{texture:v,textureOffset:[$/(L+2*$),L/(L+2*$)],tileSize:L,scalarData:G,scale:x,offset:E,defines:["RASTER_ARRAY",{uint8:"DATA_FORMAT_UINT8",uint16:"DATA_FORMAT_UINT16",uint32:"DATA_FORMAT_UINT32"}[j]]}}function Gg(h){const i=h._nearZ,l=h.projection.farthestPixelDistance(h),m=l-i,v=.2*h.height,x=i+v;return[i,l,(x-v-i)/m,(x-i)/m]}const o0=new r.aj(1,0,0,1),s0=new r.aj(0,1,0,1),a0=new r.aj(0,0,1,1),ld=new r.aj(1,0,1,1),hw=new r.aj(0,1,1,1);function ud(h,i,l,m,v,x,E){const L=h.context,$=h.transform,j=L.gl,G=$.projection.name==="globe",X=G?["PROJECTION_GLOBE_VIEW"]:[];let Y=r.ab.mat4.clone(l.projMatrix);if(G&&r.ae($.zoom)>0){const Rt=r.ba(l.canonical,$),ht=r.dd(Rt);Y=r.ab.mat4.multiply(new Float32Array(16),$.globeMatrix,ht),r.ab.mat4.multiply(Y,$.projMatrix,Y)}const ne=r.ab.mat4.create();ne[12]+=2*v/(r.q.devicePixelRatio*$.width),ne[13]+=2*x/(r.q.devicePixelRatio*$.height),r.ab.mat4.multiply(Y,ne,Y);const ve=h.getOrCreateProgram("debug",{defines:X}),_e=i.getTileByID(l.key);h.terrain&&h.terrain.setupElevationDraw(_e,ve);const Te=nr.disabled,Ce=Tr.disabled,Re=h.colorModeForRenderPass(),je="$debug";L.activeTexture.set(j.TEXTURE0),h.emptyTexture.bind(j.LINEAR,j.CLAMP_TO_EDGE),G?_e._makeGlobeTileDebugBuffers(h.context,$):_e._makeDebugTileBoundsBuffers(h.context,$.projection);const Be=_e._tileDebugBuffer||h.debugBuffer,et=_e._tileDebugIndexBuffer||h.debugIndexBuffer,Ze=_e._tileDebugSegments||h.debugSegments;if(ve.draw(h,j.LINE_STRIP,Te,Ce,Re,mr.disabled,gp(Y,m),je,Be,et,Ze,null,null,null,[_e._globeTileDebugBorderBuffer]),E){const Rt=_e.latestRawTileData,ht=Math.floor((Rt&&Rt.byteLength||0)/1024);let St=l.canonical.toString();l.overscaledZ!==l.canonical.z&&(St+=` => ${l.overscaledZ}`),St+=` ${_e.state}`,St+=` ${ht}kb`,function(en,hn){en.initDebugOverlayCanvas();const vn=en.debugOverlayCanvas,It=en.context.gl,ln=en.debugOverlayCanvas.getContext("2d");ln.clearRect(0,0,vn.width,vn.height),ln.shadowColor="white",ln.shadowBlur=2,ln.lineWidth=1.5,ln.strokeStyle="white",ln.textBaseline="top",ln.font="bold 36px Open Sans, sans-serif",ln.fillText(hn,5,5),ln.strokeText(hn,5,5),en.debugOverlayTexture.update(vn),en.debugOverlayTexture.bind(It.LINEAR,It.CLAMP_TO_EDGE)}(h,St)}const Xe=i.getTile(l).tileSize,Ke=512/Math.min(Xe,512)*(l.overscaledZ/$.zoom)*.5,at=_e._tileDebugTextBuffer||h.debugBuffer,pt=_e._tileDebugTextIndexBuffer||h.quadTriangleIndexBuffer,Vt=_e._tileDebugTextSegments||h.debugSegments;ve.draw(h,j.TRIANGLES,Te,Ce,zr.alphaBlended,mr.disabled,gp(Y,r.aj.transparent,Ke),je,at,pt,Vt,null,null,null,[_e._globeTileDebugTextBuffer])}function Wg(h,i,l,m){cd(h,0,i+l/2,h.transform.width,l,m)}function Rf(h,i,l,m){cd(h,i-l/2,0,l,h.transform.height,m)}function cd(h,i,l,m,v,x){const E=h.context,L=E.gl;L.enable(L.SCISSOR_TEST),L.scissor(i*r.q.devicePixelRatio,l*r.q.devicePixelRatio,m*r.q.devicePixelRatio,v*r.q.devicePixelRatio),E.clear({color:x}),L.disable(L.SCISSOR_TEST)}const l0=r.da([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:u0}=l0;function Oa(h,i,l,m){h.emplaceBack(i,l,m)}class Of{constructor(i){this.vertexArray=new r.de,this.indices=new r.aU,Oa(this.vertexArray,-1,-1,1),Oa(this.vertexArray,1,-1,1),Oa(this.vertexArray,-1,1,1),Oa(this.vertexArray,1,1,1),Oa(this.vertexArray,-1,-1,-1),Oa(this.vertexArray,1,-1,-1),Oa(this.vertexArray,-1,1,-1),Oa(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=i.createVertexBuffer(this.vertexArray,u0),this.indexBuffer=i.createIndexBuffer(this.indices),this.segment=r.b7.simpleSegment(0,0,36,12)}}function ds(h,i,l,m,v,x){const E=h.context.gl,L=i.paint.get("sky-atmosphere-color"),$=i.paint.get("sky-atmosphere-halo-color"),j=i.paint.get("sky-atmosphere-sun-intensity"),G=((X,Y,ne,ve,_e)=>({u_matrix_3f:X,u_sun_direction:Y,u_sun_intensity:ne,u_color_tint_r:[ve.r,ve.g,ve.b,ve.a],u_color_tint_m:[_e.r,_e.g,_e.b,_e.a],u_luminance:5e-5}))(r.ab.mat3.fromMat4(r.ab.mat3.create(),m),v,j,L,$);E.framebufferTexture2D(E.FRAMEBUFFER,E.COLOR_ATTACHMENT0,E.TEXTURE_CUBE_MAP_POSITIVE_X+x,i.skyboxTexture,0),l.draw(h,E.TRIANGLES,nr.disabled,Tr.disabled,zr.unblended,mr.frontCW,G,"skyboxCapture",i.skyboxGeometry.vertexBuffer,i.skyboxGeometry.indexBuffer,i.skyboxGeometry.segment)}const c0=r.da([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class pw{constructor(i){const l=new r.df;l.emplaceBack(-1,1,1,0,0),l.emplaceBack(1,1,1,1,0),l.emplaceBack(1,-1,1,1,1),l.emplaceBack(-1,-1,1,0,1);const m=new r.aU;m.emplaceBack(0,1,2),m.emplaceBack(2,3,0),this.vertexBuffer=i.createVertexBuffer(l,c0.members),this.indexBuffer=i.createIndexBuffer(m),this.segments=r.b7.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const fs=r.da([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_size_scale",components:1},{type:"Float32",name:"a_fade_opacity",components:1}]);class mw{constructor(){this.starsCount=16e3,this.sizeMultiplier=.15,this.sizeRange=100,this.intensityRange=200}}class Lf{constructor(i){this.colorModeAlphaBlendedWriteRGB=new zr([1,Gc,1,Gc],r.aj.transparent,[!0,!0,!0,!1]),this.colorModeWriteAlpha=new zr([1,0,1,0],r.aj.transparent,[!1,!1,!1,!0]),this.params=new mw,this.updateNeeded=!0,i.tp.registerParameter(this.params,["Stars"],"starsCount",{min:100,max:16e3,step:1},()=>{this.updateNeeded=!0}),i.tp.registerParameter(this.params,["Stars"],"sizeMultiplier",{min:.01,max:2,step:.01}),i.tp.registerParameter(this.params,["Stars"],"sizeRange",{min:0,max:200,step:1},()=>{this.updateNeeded=!0}),i.tp.registerParameter(this.params,["Stars"],"intensityRange",{min:0,max:200,step:1},()=>{this.updateNeeded=!0})}update(i){const l=i.context;if(!this.atmosphereBuffer||this.updateNeeded){this.updateNeeded=!1,this.atmosphereBuffer=new pw(l);const m=this.params.sizeRange,v=this.params.intensityRange,x=function(G){const X=r.di(30),Y=[];for(let ne=0;ne<G;++ne){const ve=2*Math.PI*X(),_e=Math.acos(1-2*X())-.5*Math.PI;Y.push(r.ab.vec3.fromValues(Math.cos(_e)*Math.cos(ve),Math.cos(_e)*Math.sin(ve),Math.sin(_e)))}return Y}(this.params.starsCount),E=r.di(300),L=new r.dg,$=new r.aU;let j=0;for(let G=0;G<x.length;++G){const X=r.ab.vec3.scale([],x[G],200),Y=Math.max(0,1+.01*m*(1*E()-.5)),ne=Math.max(0,1+.01*v*(1*E()-.5));L.emplaceBack(X[0],X[1],X[2],-1,-1,Y,ne),L.emplaceBack(X[0],X[1],X[2],1,-1,Y,ne),L.emplaceBack(X[0],X[1],X[2],1,1,Y,ne),L.emplaceBack(X[0],X[1],X[2],-1,1,Y,ne),$.emplaceBack(j+0,j+1,j+2),$.emplaceBack(j+0,j+2,j+3),j+=4}this.starsVx=l.createVertexBuffer(L,fs.members),this.starsIdx=l.createIndexBuffer($),this.starsSegments=r.b7.simpleSegment(0,0,L.length,$.length)}}destroy(){this.atmosphereBuffer&&this.atmosphereBuffer.destroy(),this.starsVx&&this.starsVx.destroy(),this.starsIdx&&this.starsIdx.destroy()}drawAtmosphereGlow(i,l){const m=i.context,v=m.gl,x=i.transform,E=new nr(v.LEQUAL,nr.ReadOnly,[0,1]),L=r.ae(x.zoom),$=i.style.getLut(l.scope),j=l.properties.get("color-use-theme")==="none",G=l.properties.get("color").toRenderColor(j?null:$).toArray01(),X=l.properties.get("high-color-use-theme")==="none",Y=l.properties.get("high-color").toRenderColor(X?null:$).toArray01(),ne=l.properties.get("space-color-use-theme")==="none",ve=l.properties.get("space-color").toRenderColor(ne?null:$).toArray01PremultipliedAlpha(),_e=5e-4,Te=r.dh(l.properties.get("horizon-blend"),0,1,_e,.25),Ce=r.cC(i,m,x)&&Te===_e?x.worldSize/(2*Math.PI*1.025)-1:x.globeRadius,Re=i.frameCounter/1e3%1,je=r.ab.vec3.length(x.globeCenterInViewSpace),Be=Math.sqrt(Math.pow(je,2)-Math.pow(Ce,2)),et=Math.acos(Be/je),Ze=Xe=>{const Ke=x.projection.name==="globe"?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"];Xe&&Ke.push("ALPHA_PASS");const at=i.getOrCreateProgram("globeAtmosphere",{defines:Ke}),pt=((Rt,ht,St,en,hn,vn,It,ln,Ht,gn,cn,tn)=>({u_frustum_tl:Rt,u_frustum_tr:ht,u_frustum_br:St,u_frustum_bl:en,u_horizon:hn,u_transition:vn,u_fadeout_range:It,u_color:ln,u_high_color:Ht,u_space_color:gn,u_temporal_offset:cn,u_horizon_angle:tn}))(x.frustumCorners.TL,x.frustumCorners.TR,x.frustumCorners.BR,x.frustumCorners.BL,x.frustumCorners.horizon,L,Te,G,Y,ve,Re,et);i.uploadCommonUniforms(m,at);const Vt=this.atmosphereBuffer;Vt&&at.draw(i,v.TRIANGLES,E,Tr.disabled,Xe?this.colorModeWriteAlpha:this.colorModeAlphaBlendedWriteRGB,mr.backCW,pt,Xe?"atmosphere_glow_alpha":"atmosphere_glow",Vt.vertexBuffer,Vt.indexBuffer,Vt.segments)};Ze(!1),Ze(!0)}drawStars(i,l){const m=r.aw(l.properties.get("star-intensity"),0,1);if(m===0)return;const v=i.context,x=v.gl,E=i.transform,L=i.getOrCreateProgram("stars"),$=r.ab.quat.identity([]);r.ab.quat.rotateX($,$,-E._pitch),r.ab.quat.rotateZ($,$,-E.angle),r.ab.quat.rotateX($,$,r.ai(E._center.lat)),r.ab.quat.rotateY($,$,-r.ai(E._center.lng));const j=r.ab.mat4.fromQuat(new Float32Array(16),$),G=r.ab.mat4.multiply([],E.starsProjMatrix,j),X=r.ab.mat3.fromMat4([],j),Y=r.ab.mat3.invert([],X),ne=[0,1,0];r.ab.vec3.transformMat3(ne,ne,Y),r.ab.vec3.scale(ne,ne,this.params.sizeMultiplier);const ve=[1,0,0];r.ab.vec3.transformMat3(ve,ve,Y),r.ab.vec3.scale(ve,ve,this.params.sizeMultiplier);const _e=(Te=ne,Ce=ve,Re=m,{u_matrix:Float32Array.from(G),u_up:Te,u_right:Ce,u_intensity_multiplier:Re});var Te,Ce,Re;i.uploadCommonUniforms(v,L),this.starsVx&&this.starsIdx&&L.draw(i,x.TRIANGLES,nr.disabled,Tr.disabled,this.colorModeAlphaBlendedWriteRGB,mr.disabled,_e,"atmosphere_stars",this.starsVx,this.starsIdx,this.starsSegments)}}function Fi(h,i){const l=[...h],m=i.cameraWorldSizeForFog/i.worldSize,v=r.ab.mat4.identity([]);return r.ab.mat4.scale(v,v,[m,m,1]),r.ab.mat4.multiply(l,v,l),r.ab.mat4.multiply(l,i.worldToFogMatrix,l),l}function ti(h,i,l,m,v){const x=l.material,E=m.context,{baseColorTexture:L,metallicRoughnessTexture:$}=x.pbrMetallicRoughness,{normalTexture:j,occlusionTexture:G,emissionTexture:X}=x;function Y(ve,_e,Te){if(ve&&(h.push(_e),E.activeTexture.set(E.gl.TEXTURE0+Te),ve.gfxTexture)){const{minFilter:Ce,magFilter:Re,wrapS:je,wrapT:Be}=ve.sampler;ve.gfxTexture.bindExtraParam(Ce,Re,je,Be)}}Y(L,"HAS_TEXTURE_u_baseColorTexture",Vo.BaseColor),Y($,"HAS_TEXTURE_u_metallicRoughnessTexture",Vo.MetallicRoughness),Y(j,"HAS_TEXTURE_u_normalTexture",Vo.Normal),Y(G,"HAS_TEXTURE_u_occlusionTexture",Vo.Occlusion),Y(X,"HAS_TEXTURE_u_emissionTexture",Vo.Emission),v&&(v.texture||(v.texture=new r.dk(m.context,v.image,[v.image.height,v.image.height,v.image.height],E.gl.RGBA8)),E.activeTexture.set(E.gl.TEXTURE0+Vo.LUT),v.texture&&v.texture.bind(E.gl.LINEAR,E.gl.CLAMP_TO_EDGE),h.push("APPLY_LUT_ON_GPU")),l.texcoordBuffer&&(h.push("HAS_ATTRIBUTE_a_uv_2f"),i.push(l.texcoordBuffer)),l.colorBuffer&&(h.push(l.colorBuffer.itemSize===12?"HAS_ATTRIBUTE_a_color_3f":"HAS_ATTRIBUTE_a_color_4f"),i.push(l.colorBuffer)),l.normalBuffer&&(h.push("HAS_ATTRIBUTE_a_normal_3f"),i.push(l.normalBuffer)),l.pbrBuffer&&(h.push("HAS_ATTRIBUTE_a_pbr"),h.push("HAS_ATTRIBUTE_a_heightBasedEmissiveStrength"),i.push(l.pbrBuffer)),x.alphaMode!=="OPAQUE"&&x.alphaMode!=="MASK"||h.push("UNPREMULT_TEXTURE_IN_SHADER"),x.defined||h.push("DIFFUSE_SHADED"),h.push("USE_STANDARD_DERIVATIVES");const ne=m.shadowRenderer;ne&&(h.push("RENDER_SHADOWS","DEPTH_TEXTURE"),ne.useNormalOffset&&h.push("NORMAL_OFFSET"))}function Df(h,i,l,m,v,x){const E=l.paint.get("model-opacity").constantOr(1),L=i.context,$=new nr(i.context.gl.LEQUAL,nr.ReadWrite,i.depthRangeFor3D),j=i.transform,G=h.mesh,X=G.material,Y=X.pbrMetallicRoughness,ne=i.style.fog;let ve;ve=i.transform.projection.zAxisUnit==="pixels"?[...h.nodeModelMatrix]:r.ab.mat4.multiply([],m.zScaleMatrix,h.nodeModelMatrix),r.ab.mat4.multiply(ve,m.negCameraPosMatrix,ve);const _e=r.ab.mat4.invert([],ve);r.ab.mat4.transpose(_e,_e);const Te=l.paint.get("model-color-use-theme").constantOr("default")==="none",Ce=l.paint.get("model-emissive-strength").constantOr(0),Re=bp(new Float32Array(h.worldViewProjection),new Float32Array(ve),new Float32Array(_e),null,i,E,Y.baseColorFactor.toRenderColor(null),X.emissiveFactor,Y.metallicFactor,Y.roughnessFactor,X,Ce,l),je={defines:[]},Be=[],et=i.shadowRenderer;et&&(et.useNormalOffset=!1),ti(je.defines,Be,G,i,Te?null:l.lut);let Ze=null;if(ne){const at=Fi(h.nodeModelMatrix,i.transform);if(Ze=new Float32Array(at),j.projection.name!=="globe"){const pt=G.aabb.min,Vt=G.aabb.max,[Rt,ht]=ne.getOpacityForBounds(at,pt[0],pt[1],Vt[0],Vt[1]);je.overrideFog=Rt>=Mn||ht>=Mn}}const Xe=Tl(i,l.paint.get("model-cutoff-fade-range"));Xe.shouldRenderCutoff&&je.defines.push("RENDER_CUTOFF");const Ke=i.getOrCreateProgram("model",je);i.uploadCommonUniforms(L,Ke,null,Ze,Xe),i.renderPass!=="shadow"&&et&&et.setupShadowsFromMatrix(h.nodeModelMatrix,Ke),Ke.draw(i,L.gl.TRIANGLES,$,v,x,G.material.doubleSided?mr.disabled:mr.backCCW,Re,l.id,G.vertexBuffer,G.indexBuffer,G.segments,l.paint,i.transform.zoom,void 0,Be)}function Il(h,i,l,m,v,x,E){let L;L=h.projection.name==="globe"?r.dl(l,h):[...l],r.ab.mat4.multiply(L,L,i.matrix);const $=r.ab.mat4.multiply([],m,L);if(i.meshes)for(const j of i.meshes){if(j.material.alphaMode!=="BLEND"){E.push({mesh:j,depth:0,modelIndex:v,worldViewProjection:$,nodeModelMatrix:L});continue}const G=r.ab.vec3.transformMat4([],j.centroid,$);G[2]>0&&x.push({mesh:j,depth:G[2],modelIndex:v,worldViewProjection:$,nodeModelMatrix:L})}if(i.children)for(const j of i.children)Il(h,j,l,m,v,x,E)}function dd(h,i,l,m){const v=l.shadowRenderer;if(!v)return;const x=v.getShadowPassDepthMode(),E=v.getShadowPassColorMode(),L=v.calculateShadowPassMatrixFromMatrix(i),$=e0(L);l.getOrCreateProgram("modelDepth",{defines:l._shadowMapDebug?[]:["DEPTH_TEXTURE"]}).draw(l,l.context.gl.TRIANGLES,x,Tr.disabled,E,mr.backCCW,$,m.id,h.vertexBuffer,h.indexBuffer,h.segments,m.paint,l.transform.zoom,void 0,void 0)}function fd(h,i,l){const m=i.updateZoomBasedPaintProperties(),v=function(x,E,L){let $,j,G,X=x.terrain?x.terrain.exaggeration():0;if(x.terrain&&X>0){const Y=x.terrain,ne=Y.findDEMTileFor(L);ne&&ne.dem?$=r.dn.create(Y,L,ne):X=0}if(X===0&&(E.terrainElevationMin=0,E.terrainElevationMax=0),X===E.validForExaggeration&&(X===0||$&&$._demTile&&$._demTile.tileID===E.validForDEMTile.id&&$._dem._timestamp===E.validForDEMTile.timestamp))return!1;for(const Y in E.instancesPerModel){const ne=E.instancesPerModel[Y];for(let ve=0;ve<ne.instancedDataArray.length;++ve){const _e=($?X*$.getElevationAt(0|ne.instancedDataArray.float32[16*ve],0|ne.instancedDataArray.float32[16*ve+1],!0,!0):0)+ne.instancesEvaluatedElevation[ve];ne.instancedDataArray.float32[16*ve+6]=_e,j=j?Math.min(E.terrainElevationMin,_e):_e,G=G?Math.max(E.terrainElevationMax,_e):_e}}return E.terrainElevationMin=j||0,E.terrainElevationMax=G||0,E.validForExaggeration=X,E.validForDEMTile=$&&$._demTile?{id:$._demTile.tileID,timestamp:$._dem._timestamp}:{id:void 0,timestamp:0},!0}(h,i,l);(m||v)&&(i.uploaded=!1,i.upload(h.context))}const ha={shadowUniformsInitialized:!1,useSingleShadowCascade:!1,tileMatrix:new Float64Array(16),shadowTileMatrix:new Float32Array(16),aabb:new r.cd([0,0,0],[r.ag,r.ag,0])};function qg(h,i){const l=1<<h.canonical.z,m=i.getFreeCameraOptions().position,v=i.elevation,x=h.canonical.x/l,E=(h.canonical.x+1)/l,L=h.canonical.y/l,$=(h.canonical.y+1)/l;let j=i._centerAltitude;if(v){const ne=v.getMinMaxForTile(h);ne&&ne.max>j&&(j=ne.max)}const G=r.aw(m.x,x,E)-m.x,X=r.aw(m.y,L,$)-m.y,Y=r.bH(j,i.center.lat)-m.z;return i._zoomFromMercatorZ(Math.sqrt(G*G+X*X+Y*Y))}function Al(h,i,l,m,v,x,E){const L=h.context,$=h.renderPass==="shadow",j=h.shadowRenderer,G=$&&j?j.getShadowPassDepthMode():new nr(L.gl.LEQUAL,nr.ReadWrite,h.depthRangeFor3D),X=h.isTileAffectedByFog(x);if(l.meshes)for(const Y of l.meshes){const ne=["MODEL_POSITION_ON_GPU"],ve=[];let _e,Te,Ce;m.instancedDataArray.length>20&&ne.push("INSTANCED_ARRAYS");const Re=Tl(h,i.paint.get("model-cutoff-fade-range"));if(Re.shouldRenderCutoff&&ne.push("RENDER_CUTOFF"),$&&j)_e=h.getOrCreateProgram("modelDepth",{defines:ne}),Te=e0(E.shadowTileMatrix,E.shadowTileMatrix,Float32Array.from(l.matrix)),Ce=j.getShadowPassColorMode();else{ti(ne,ve,Y,h,i.paint.get("model-color-use-theme").constantOr("default")==="none"?null:i.lut),_e=h.getOrCreateProgram("model",{defines:ne,overrideFog:X});const Be=Y.material,et=Be.pbrMetallicRoughness,Ze=i.paint.get("model-opacity").constantOr(1),Xe=i.paint.get("model-emissive-strength").constantOr(0);Te=bp(x.expandedProjMatrix,Float32Array.from(l.matrix),new Float32Array(16),null,h,Ze,et.baseColorFactor.toRenderColor(null),Be.emissiveFactor,et.metallicFactor,et.roughnessFactor,Be,Xe,i,v),j&&(E.shadowUniformsInitialized?_e.setShadowUniformValues(L,j.getShadowUniformValues()):(j.setupShadows(x.toUnwrapped(),_e,"model-tile",x.overscaledZ),E.shadowUniformsInitialized=!0)),Ce=Re.shouldRenderCutoff||Ze<1||Be.alphaMode!=="OPAQUE"?zr.alphaBlended:zr.unblended}h.uploadCommonUniforms(L,_e,x.toUnwrapped(),null,Re);const je=Y.material.doubleSided?mr.disabled:mr.backCCW;if(m.instancedDataArray.length>20)ve.push(m.instancedDataBuffer),_e.draw(h,L.gl.TRIANGLES,G,Tr.disabled,Ce,je,Te,i.id,Y.vertexBuffer,Y.indexBuffer,Y.segments,i.paint,h.transform.zoom,void 0,ve,m.instancedDataArray.length);else{const Be=$?"u_instance":"u_normal_matrix";for(let et=0;et<m.instancedDataArray.length;++et)Te[Be]=new Float32Array(m.instancedDataArray.arrayBuffer,64*et,16),_e.draw(h,L.gl.TRIANGLES,G,Tr.disabled,Ce,je,Te,i.id,Y.vertexBuffer,Y.indexBuffer,Y.segments,i.paint,h.transform.zoom,void 0,ve)}}if(l.children)for(const Y of l.children)Al(h,i,Y,m,v,x,E)}const gu=[1,-1,1];function _u(h,i,l,m){if(!l.modelManager)return!0;const v=l.modelManager;if(!l.shadowRenderer)return!0;const x=l.shadowRenderer,E=i.aabb;let L=!0,$=h.maxHeight;if($===0){let G=0;for(const X in h.instancesPerModel){const Y=v.getModel(X,m);Y?G=Math.max(G,Math.max(Math.max(Y.aabb.max[0],Y.aabb.max[1]),Y.aabb.max[2])):L=!1}$=h.maxScale*G*1.41+h.maxVerticalOffset,L&&(h.maxHeight=$)}E.max[2]=$,E.min[2]+=h.terrainElevationMin,E.max[2]+=h.terrainElevationMax,r.ab.vec3.transformMat4(E.min,E.min,i.tileMatrix),r.ab.vec3.transformMat4(E.max,E.max,i.tileMatrix);const j=E.intersects(x.getCurrentCascadeFrustum());return l.currentShadowCascade===0&&(h.isInsideFirstShadowMapFrustum=j===2),j===0}function Tp(h,i){const l=h.uniformValues.u_cutoff_params[0],m=h.uniformValues.u_cutoff_params[1],v=h.uniformValues.u_cutoff_params[2],x=h.uniformValues.u_cutoff_params[3];return m===l||x===v?1:r.aw(((i-l)/(m-l)-v)/(x-v),0,1)}function Cp(h,i,l,m){if(i.pitch<20)return 1;const v=i.getWorldToCameraMatrix();r.ab.mat4.multiply(v,v,h);const x=r.ab.vec4.fromValues(l.min[0],l.min[1],l.min[2],1);let E=r.ab.vec4.transformMat4(r.ab.vec4.create(),x,v),L=E,$=E;x[1]=l.max[1],E=r.ab.vec4.transformMat4(r.ab.vec4.create(),x,v),L=E[1]<L[1]?E:L,$=E[1]>$[1]?E:$,x[0]=l.max[0],E=r.ab.vec4.transformMat4(r.ab.vec4.create(),x,v),L=E[1]<L[1]?E:L,$=E[1]>$[1]?E:$,x[1]=l.min[1],E=r.ab.vec4.transformMat4(r.ab.vec4.create(),x,v),L=E[1]<L[1]?E:L,$=E[1]>$[1]?E:$;const j=r.aw(m[0],0,1),G=100*i.pixelsPerMeter*r.aw(m[1],0,1),X=r.aw(m[2],0,1),Y=r.ab.vec4.lerp(r.ab.vec4.create(),L,$,j),ne=Math.tan(.5*i.fovX),ve=-Y[2]*ne;if(G===0)return Y[1]<-Math.abs(ve)?X:1;const _e=(-Math.abs(ve)-Y[1])/G,Te=(Re,je,Be)=>(1-Be)*Re+Be*je,Ce=r.aw(Te(1,X,_e),X,1);return Te(1,Ce,r.aw((i.pitch-20)/20,0,1))}class Kg{}class Zg{constructor(){this._storage=new Map}getLinesFromTrianglesBuffer(i,l,m){{const X=this._storage.get(l.id);if(X)return X.lastUsedFrameIdx=i,X.buf}const v=m.gl,x=v.getBufferParameter(v.ELEMENT_ARRAY_BUFFER,v.BUFFER_SIZE),E=new ArrayBuffer(x),L=new Int16Array(E);v.getBufferSubData(v.ELEMENT_ARRAY_BUFFER,0,new Int16Array(E));const $=new r.dq;for(let X=0;X<x/2;X+=3){const Y=L[X],ne=L[X+1],ve=L[X+2];$.emplaceBack(Y,ne),$.emplaceBack(ne,ve),$.emplaceBack(ve,Y)}const j=m.bindVertexArrayOES.current,G=new Kg;return G.buf=new Xa(m,$),G.lastUsedFrameIdx=i,this._storage.set(l.id,G),m.bindVertexArrayOES.set(j),G.buf}update(i){for(const[l,m]of this._storage)i-m.lastUsedFrameIdx>30&&(m.buf.destroy(),this._storage.delete(l))}destroy(){for(const[i,l]of this._storage)l.buf.destroy(),this._storage.delete(i)}}class Yg{constructor(i){this.occluderSize=30,this.depthOffset=-1e-4,i.registerParameter(this,["Occlusion"],"occluderSize",{min:1,max:100,step:1}),i.registerParameter(this,["Occlusion"],"depthOffset",{min:-.05,max:0,step:1e-5})}}const yu=r.da([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_rainParticleData",components:4}]);class Xg{registerParameter(){}registerButton(){}registerBinding(){}refreshUI(){}}class zf{constructor(i,l){this.revealStart=11,this.revealRange=2,i.registerParameter(this,[...l,"Reveal"],"revealStart",{min:0,max:17,step:.05}),i.registerParameter(this,[...l,"Reveal"],"revealRange",{min:.1,max:5.1,step:.05})}}const Jg=r.da([{type:"Float32",name:"a_pos_2f",components:2}]);class Qg{destroy(){this.vignetteVx&&this.vignetteVx.destroy(),this.vignetteIdx&&this.vignetteIdx.destroy()}draw(i,l){const m=i.getOrCreateProgram("vignette");if(!this.vignetteVx||!this.vignetteIdx){const E=new r.dr,L=new r.aU;E.emplaceBack(-1,-1),E.emplaceBack(1,-1),E.emplaceBack(1,1),E.emplaceBack(-1,1),L.emplaceBack(0,1,2),L.emplaceBack(0,2,3),this.vignetteVx=i.context.createVertexBuffer(E,Jg.members),this.vignetteIdx=i.context.createIndexBuffer(L)}const v=r.b7.simpleSegment(0,0,4,6);if(this.vignetteVx&&this.vignetteIdx){i.uploadCommonUniforms(i.context,m);const E={u_vignetteShape:(x={vignetteShape:[l.start,l.range,Math.pow(10,l.fadePower)],vignetteColor:[l.color.r,l.color.g,l.color.b,l.color.a*l.strength]}).vignetteShape,u_vignetteColor:x.vignetteColor};m.draw(i,i.context.gl.TRIANGLES,nr.disabled,Tr.disabled,zr.alphaBlended,mr.disabled,E,"vignette",this.vignetteVx,this.vignetteIdx,v,{})}var x}}class Uo{constructor(){this._accumulatedOffsetX=0,this._accumulatedOffsetY=0,this._accumulatedElevation=0}update(i,l){const m=i.getFreeCameraOptions().position,v=m.toAltitude(),x=m.toLngLat(),E=r.ai(x.lng),L=r.ai(x.lat),$=i.pixelsPerMeter/l,j=E*r.ds,G=r.ds*Math.log(Math.tan(Math.PI/4+L/2));if(this._offsetXPrev===void 0)this._offsetXPrev=0,this._offsetYPrev=0,this._elevationPrev=0,this._accumulatedOffsetX=0,this._accumulatedOffsetY=0,this._accumulatedElevation=0;else{const X=-this._offsetYPrev+G,Y=-this._elevationPrev+v;this._accumulatedOffsetX+=(-this._offsetXPrev+j)*$,this._accumulatedOffsetY+=X*$,this._accumulatedElevation+=Y*$,this._offsetXPrev=j,this._offsetYPrev=G,this._elevationPrev=v}}getPosition(){return[this._accumulatedOffsetX,this._accumulatedOffsetY,this._accumulatedElevation]}}function Ep(h,i){return[-(h[0]-Math.floor(h[0]/i)*i),-(h[1]-Math.floor(h[1]/i)*i),-(h[2]-Math.floor(h[2]/i)*i)]}function Mp(h){const i=r.di(1323123451230),l=[];for(let m=0;m<h;++m){const v=2*i()-1,x=2*i()-1,E=2*i()-1;l.push(r.ab.vec3.fromValues(v,x,E))}return l}function pa(h,i,l,m,v){const x=r.aw((v-l)/(m-l),0,1);return(1-x)*h+x*i}class vu{constructor(i){this._movement=new Uo,this._accumulatedTimeFromStart=0,this._prevTime=Date.now()/1e3,this._vignette=new Qg,this._ppmScaleFactor=i}destroy(){this.particlesVx&&this.particlesVx.destroy(),this.particlesIdx&&this.particlesIdx.destroy(),this._vignette&&this._vignette.destroy()}updateOnRender(i,l){const m=i.transform;this._movement.update(m,this._ppmScaleFactor);const v=m.starsProjMatrix,x=r.ab.quat.identity([]);r.ab.quat.rotateX(x,x,r.ai(90)-m._pitch),r.ab.quat.rotateZ(x,x,-m.angle);const E=r.ab.mat4.fromQuat(new Float32Array(16),x),L=r.ab.mat4.fromValues(1,0,0,0,0,0,1,0,0,-1,0,0,0,0,0,1),$=r.ab.mat4.transpose([],L),j=r.ab.mat4.multiply([],$,E),G=Date.now()/1e3;return this._accumulatedTimeFromStart+=(G-this._prevTime)*l,this._prevTime=G,{projectionMatrix:v,modelviewMatrix:j}}}class e_ extends vu{constructor(i){super(4.25),this._params={overrideStyleParameters:!1,intensity:.5,timeFactor:1,velocityConeAperture:0,velocity:300,boxSize:2500,dropletSizeX:1,dropletSizeYScale:10,distortionStrength:70,screenThinning:{intensity:.57,start:.46,range:1.17,fadePower:.17,affectedRatio:1,particleOffset:-.2},color:{r:.66,g:.68,b:.74,a:.7},direction:{x:-50,y:-35},shapeDirPower:2,shapeNormalPower:1},this._revealParams=new zf(i.tp,["Precipitation","Rain"]),this._vignetteParams={strength:1,start:.7,range:1,fadePower:.4,color:{r:.27,g:.27,b:.27,a:1}},this.particlesCount=16e3}update(i){const l=i.context;if(!this.particlesVx){const m=Mp(this.particlesCount),v=new r.dt,x=new r.aU;let E=0;const L=r.di(1323123451230);for(let $=0;$<m.length;++$){const j=m[$],G=[2*L()-1,L(),L(),L()];v.emplaceBack(j[0],j[1],j[2],-1,-1,...G),v.emplaceBack(j[0],j[1],j[2],1,-1,...G),v.emplaceBack(j[0],j[1],j[2],1,1,...G),v.emplaceBack(j[0],j[1],j[2],-1,1,...G),x.emplaceBack(E+0,E+1,E+2),x.emplaceBack(E+0,E+2,E+3),E+=4}this.particlesVx=l.createVertexBuffer(v,yu.members),this.particlesIdx=l.createIndexBuffer(x)}}draw(i){if(!this._params.overrideStyleParameters&&!i.style.rain)return;const l=this._params.overrideStyleParameters?this._revealParams:{revealStart:0,revealRange:.01},m=i.transform.zoom;if(l.revealStart>m)return;const v=pa(0,1,l.revealStart,l.revealStart+l.revealRange,m);if(!this.particlesVx||!this.particlesIdx)return;const x=structuredClone(this._params);let E=[-x.direction.x,x.direction.y,-100];r.ab.vec3.normalize(E,E);const L=structuredClone(this._vignetteParams);L.strength*=v,x.overrideStyleParameters||(x.intensity=i.style.rain.state.density,x.timeFactor=i.style.rain.state.intensity,x.color=structuredClone(i.style.rain.state.color),E=structuredClone(i.style.rain.state.direction),x.screenThinning.intensity=i.style.rain.state.centerThinning,x.dropletSizeX=i.style.rain.state.dropletSize[0],x.dropletSizeYScale=i.style.rain.state.dropletSize[1]/i.style.rain.state.dropletSize[0],x.distortionStrength=100*i.style.rain.state.distortionStrength,L.strength=1,L.color=structuredClone(i.style.rain.state.vignetteColor));const $=this.updateOnRender(i,x.timeFactor),j=i.context,G=j.gl,X=i.transform;this.screenTexture&&this.screenTexture.size[0]===i.width&&this.screenTexture.size[1]===i.height||(this.screenTexture=new r.T(j,{width:i.width,height:i.height,data:null},G.RGBA8)),x.distortionStrength>0&&(j.activeTexture.set(G.TEXTURE0),this.screenTexture.bind(G.LINEAR,G.CLAMP_TO_EDGE),G.copyTexSubImage2D(G.TEXTURE_2D,0,0,0,0,0,i.width,i.height));const Y=i.getOrCreateProgram("rainParticle");i.uploadCommonUniforms(j,Y),j.activeTexture.set(G.TEXTURE0),this.screenTexture.bind(G.LINEAR,G.CLAMP_TO_EDGE);const ne=[x.color.r,x.color.g,x.color.b,x.color.a],ve=(_e,Te)=>{const Ce=Ep(this._movement.getPosition(),_e),Re=x.dropletSizeX,je=x.dropletSizeX*x.dropletSizeYScale,Be=i.width/2,et=i.height/2,Ze=pa(0,x.screenThinning.start,0,1,x.screenThinning.intensity),Xe=pa(.001,x.screenThinning.range,0,1,x.screenThinning.intensity),Ke=pa(0,x.screenThinning.particleOffset,0,1,x.screenThinning.intensity),at=(pt={modelview:$.modelviewMatrix,projection:$.projectionMatrix,time:this._accumulatedTimeFromStart,camPos:Ce,velocityConeAperture:x.velocityConeAperture,velocity:x.velocity,boxSize:_e,rainDropletSize:[Re,je],distortionStrength:x.distortionStrength,rainDirection:E,color:ne,screenSize:[X.width,X.height],thinningCenterPos:[Be,et],thinningShape:[Ze,Xe,Math.pow(10,x.screenThinning.fadePower)],thinningAffectedRatio:x.screenThinning.affectedRatio,thinningParticleOffset:Ke,shapeDirectionalPower:x.shapeDirPower,shapeNormalPower:x.shapeNormalPower,mode:Te?0:1},{u_modelview:Float32Array.from(pt.modelview),u_projection:Float32Array.from(pt.projection),u_time:pt.time,u_cam_pos:pt.camPos,u_texScreen:0,u_velocityConeAperture:pt.velocityConeAperture,u_velocity:pt.velocity,u_boxSize:pt.boxSize,u_rainDropletSize:pt.rainDropletSize,u_distortionStrength:pt.distortionStrength,u_rainDirection:pt.rainDirection,u_color:pt.color,u_screenSize:pt.screenSize,u_thinningCenterPos:pt.thinningCenterPos,u_thinningShape:pt.thinningShape,u_thinningAffectedRatio:pt.thinningAffectedRatio,u_thinningParticleOffset:pt.thinningParticleOffset,u_shapeDirectionalPower:pt.shapeDirectionalPower,u_shapeNormalPower:pt.shapeNormalPower,u_mode:pt.mode});var pt;const Vt=Math.round(v*x.intensity*this.particlesCount),Rt=r.b7.simpleSegment(0,0,4*Vt,2*Vt);Y.draw(i,G.TRIANGLES,nr.disabled,Tr.disabled,zr.alphaBlended,mr.disabled,at,"rain_particles",this.particlesVx,this.particlesIdx,Rt,{})};x.distortionStrength>0&&ve(x.boxSize,!0),ve(x.boxSize,!1),this._vignette.draw(i,L)}}const t_=r.da([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_snowParticleData",components:4},{type:"Float32",name:"a_snowParticleDataHorizontalOscillation",components:2}]);class n_ extends vu{constructor(i){super(2.25),this._params={overrideStyleParameters:!1,intensity:.85,timeFactor:.75,velocityConeAperture:70,velocity:40,horizontalOscillationRadius:4,horizontalOscillationRate:1.5,boxSize:2e3,billboardSize:2,shapeFadeStart:.27,shapeFadePower:.21,screenThinning:{intensity:.4,start:.15,range:1.4,fadePower:.24,affectedRatio:1,particleOffset:-.2},color:{r:1,g:1,b:1,a:1},direction:{x:-50,y:-35}},this._revealParams=new zf(i.tp,["Precipitation","Snow"]),this._vignetteParams={strength:.3,start:.78,range:.46,fadePower:.2,color:{r:1,g:1,b:1,a:1}},this.particlesCount=16e3}update(i){const l=i.context;if(!this.particlesVx){const m=Mp(this.particlesCount),v=new r.du,x=new r.aU;let E=0;const L=r.di(1323123451230);for(let $=0;$<m.length;++$){const j=m[$],G=L(),X=L(),Y=L(),ne=[$/m.length,G,X,Y],ve=[L(),L()];v.emplaceBack(j[0],j[1],j[2],-1,-1,...ne,...ve),v.emplaceBack(j[0],j[1],j[2],1,-1,...ne,...ve),v.emplaceBack(j[0],j[1],j[2],1,1,...ne,...ve),v.emplaceBack(j[0],j[1],j[2],-1,1,...ne,...ve),x.emplaceBack(E+0,E+1,E+2),x.emplaceBack(E+0,E+2,E+3),E+=4}this.particlesVx=l.createVertexBuffer(v,t_.members),this.particlesIdx=l.createIndexBuffer(x)}}draw(i){if(!this._params.overrideStyleParameters&&!i.style.snow)return;const l=structuredClone(this._params);let m=[-l.direction.x,l.direction.y,-100];r.ab.vec3.normalize(m,m);const v=structuredClone(this._vignetteParams),x=l.overrideStyleParameters?this._revealParams:{revealStart:0,revealRange:.01},E=i.transform.zoom;if(x.revealStart>E)return;const L=pa(0,1,x.revealStart,x.revealStart+x.revealRange,E);v.strength*=L,l.overrideStyleParameters||(l.intensity=i.style.snow.state.density,l.timeFactor=i.style.snow.state.intensity,l.color=structuredClone(i.style.snow.state.color),m=structuredClone(i.style.snow.state.direction),l.screenThinning.intensity=i.style.snow.state.centerThinning,l.billboardSize=2.79*i.style.snow.state.flakeSize,v.strength=1,v.color=structuredClone(i.style.snow.state.vignetteColor));const $=this.updateOnRender(i,l.timeFactor);if(!this.particlesVx||!this.particlesIdx)return;const j=i.context,G=j.gl,X=i.transform,Y=i.getOrCreateProgram("snowParticle");i.uploadCommonUniforms(j,Y),((ne,ve,_e)=>{const Te=Ep(this._movement.getPosition(),ne),Ce=X.width/2,Re=X.height/2,je=pa(0,_e.screenThinning.start,0,1,_e.screenThinning.intensity),Be=pa(.001,_e.screenThinning.range,0,1,_e.screenThinning.intensity),et=pa(0,_e.screenThinning.particleOffset,0,1,_e.screenThinning.intensity),Ze=(Xe={modelview:$.modelviewMatrix,projection:$.projectionMatrix,time:this._accumulatedTimeFromStart,camPos:Te,velocityConeAperture:_e.velocityConeAperture,velocity:_e.velocity,horizontalOscillationRadius:_e.horizontalOscillationRadius,horizontalOscillationRate:_e.horizontalOscillationRate,boxSize:ne,billboardSize:1*_e.billboardSize,simpleShapeParameters:[_e.shapeFadeStart,_e.shapeFadePower],screenSize:[X.width,X.height],thinningCenterPos:[Ce,Re],thinningShape:[je,Be,Math.pow(10,_e.screenThinning.fadePower)],thinningAffectedRatio:_e.screenThinning.affectedRatio,thinningParticleOffset:et,color:[_e.color.r,_e.color.g,_e.color.b,_e.color.a],direction:m},{u_modelview:Float32Array.from(Xe.modelview),u_projection:Float32Array.from(Xe.projection),u_time:Xe.time,u_cam_pos:Xe.camPos,u_velocityConeAperture:Xe.velocityConeAperture,u_velocity:Xe.velocity,u_horizontalOscillationRadius:Xe.horizontalOscillationRadius,u_horizontalOscillationRate:Xe.horizontalOscillationRate,u_boxSize:Xe.boxSize,u_billboardSize:Xe.billboardSize,u_simpleShapeParameters:Xe.simpleShapeParameters,u_screenSize:Xe.screenSize,u_thinningCenterPos:Xe.thinningCenterPos,u_thinningShape:Xe.thinningShape,u_thinningAffectedRatio:Xe.thinningAffectedRatio,u_thinningParticleOffset:Xe.thinningParticleOffset,u_particleColor:Xe.color,u_direction:Xe.direction});var Xe;const Ke=Math.round(L*_e.intensity*this.particlesCount),at=r.b7.simpleSegment(0,0,4*Ke,2*Ke);this.particlesVx&&this.particlesIdx&&Y.draw(i,G.TRIANGLES,nr.disabled,Tr.disabled,zr.alphaBlended,mr.disabled,Ze,"snow_particles",this.particlesVx,this.particlesIdx,at,{})})(l.boxSize,0,l),this._vignette.draw(i,v)}}const kl={symbol:function(h,i,l,m,v){if(h.renderPass!=="translucent")return;const x=Tr.disabled,E=h.colorModeForRenderPass(),L=l.layout.get("text-variable-anchor"),$=l.layout.get("text-size-scale-range"),j=r.aw(h.scaleFactor,$[0],$[1]);L&&function(Y,ne,ve,_e,Te,Ce,Re,je){const Be=ne.transform,et=Te==="map",Ze=Ce==="map";for(const Xe of Y){const Ke=_e.getTile(Xe),at=Ke.getBucket(ve);if(!at||!at.text||!at.text.segments.get().length)continue;const pt=r.bp(at.textSizeData,Be.zoom,je),Vt=mf(Xe,at.getProjection(),Be),Rt=Be.calculatePixelsToTileUnitsMatrix(Ke),ht=bl(Vt,Ke.tileID.canonical,Ze,et,Be,at.getProjection(),Rt),St=at.hasIconTextFit()&&at.hasIconData();if(pt){const en=Math.pow(2,Be.zoom-Ke.tileID.overscaledZ);t0(at,et,Ze,Re,r.cX,Be,ht,Xe,en,pt,St)}}}(m,h,l,i,l.layout.get("text-rotation-alignment"),l.layout.get("text-pitch-alignment"),v,j);const G=l.paint.get("icon-opacity").constantOr(1)!==0,X=l.paint.get("text-opacity").constantOr(1)!==0;l.layout.get("symbol-sort-key").constantOr(1)!==void 0&&(G||X)?Is(h,i,l,m,x,E):(G&&Is(h,i,l,m,x,E,{onlyIcons:!0}),X&&Is(h,i,l,m,x,E,{onlyText:!0})),i.map.showCollisionBoxes&&(jg(h,i,l,m,l.paint.get("text-translate"),l.paint.get("text-translate-anchor"),!0),jg(h,i,l,m,l.paint.get("icon-translate"),l.paint.get("icon-translate-anchor"),!1))},circle:function(h,i,l,m){if(h.renderPass!=="translucent")return;const v=l.paint.get("circle-opacity"),x=l.paint.get("circle-stroke-width"),E=l.paint.get("circle-stroke-opacity"),L=l.layout.get("circle-sort-key").constantOr(1)!==void 0,$=l.paint.get("circle-emissive-strength");if(v.constantOr(1)===0&&(x.constantOr(1)===0||E.constantOr(1)===0))return;const j=h.context,G=j.gl,X=h.transform,Y=h.depthModeForSublayer(0,nr.ReadOnly),ne=Tr.disabled,ve=h.colorModeForDrapableLayerRenderPass($),_e=X.projection.name==="globe",Te=[r.at(X.center.lng),r.aA(X.center.lat)],Ce=[];for(let je=0;je<m.length;je++){const Be=m[je],et=i.getTile(Be),Ze=et.getBucket(l);if(!Ze||Ze.projection.name!==X.projection.name)continue;const Xe=Ze.programConfigurations.get(l.id),Ke=r.cY(l),at=h.isTileAffectedByFog(Be);_e&&Ke.push("PROJECTION_GLOBE_VIEW"),Ke.push("DEPTH_D24"),h.terrain&&X.depthOcclusionForSymbolsAndCircles&&Ke.push("DEPTH_OCCLUSION");const pt=h.getOrCreateProgram("circle",{config:Xe,defines:Ke,overrideFog:at}),Vt=Ze.layoutVertexBuffer,Rt=Ze.globeExtVertexBuffer,ht=Ze.indexBuffer,St=X.projection.createInversionMatrix(X,Be.canonical),en={programConfiguration:Xe,program:pt,layoutVertexBuffer:Vt,globeExtVertexBuffer:Rt,indexBuffer:ht,uniformValues:r.cZ(h,Be,et,St,Te,l),tile:et};if(L){const hn=Ze.segments.get();for(const vn of hn)Ce.push({segments:new r.b7([vn]),sortKey:vn.sortKey,state:en})}else Ce.push({segments:Ze.segments,sortKey:0,state:en})}L&&Ce.sort((je,Be)=>je.sortKey-Be.sortKey);const Re={useDepthForOcclusion:X.depthOcclusionForSymbolsAndCircles};for(const je of Ce){const{programConfiguration:Be,program:et,layoutVertexBuffer:Ze,globeExtVertexBuffer:Xe,indexBuffer:Ke,uniformValues:at,tile:pt}=je.state,Vt=je.segments;h.terrain&&h.terrain.setupElevationDraw(pt,et,Re),h.uploadCommonUniforms(j,et,pt.tileID.toUnwrapped()),et.draw(h,G.TRIANGLES,Y,ne,ve,mr.disabled,at,l.id,Ze,Ke,Vt,l.paint,X.zoom,Be,[Xe])}},heatmap:function(h,i,l,m){if(l.paint.get("heatmap-opacity")!==0)if(h.renderPass==="offscreen"){const v=h.context,x=v.gl,E=Tr.disabled,L=new zr([x.ONE,x.ONE,x.ONE,x.ONE],r.aj.transparent,[!0,!0,!0,!0]);(function(ne,ve,_e,Te){const Ce=ne.gl,Re=ve.width*Te,je=ve.height*Te;ne.activeTexture.set(Ce.TEXTURE1),ne.viewport.set([0,0,Re,je]);let Be=_e.heatmapFbo;if(!Be||Be&&(Be.width!==Re||Be.height!==je)){Be&&Be.destroy();const et=Ce.createTexture();Ce.bindTexture(Ce.TEXTURE_2D,et),Ce.texParameteri(Ce.TEXTURE_2D,Ce.TEXTURE_WRAP_S,Ce.CLAMP_TO_EDGE),Ce.texParameteri(Ce.TEXTURE_2D,Ce.TEXTURE_WRAP_T,Ce.CLAMP_TO_EDGE),Ce.texParameteri(Ce.TEXTURE_2D,Ce.TEXTURE_MIN_FILTER,Ce.LINEAR),Ce.texParameteri(Ce.TEXTURE_2D,Ce.TEXTURE_MAG_FILTER,Ce.LINEAR),Be=_e.heatmapFbo=ne.createFramebuffer(Re,je,!0,null),function(Ze,Xe,Ke,at,pt,Vt){const Rt=Ze.gl;Rt.texImage2D(Rt.TEXTURE_2D,0,Ze.extRenderToTextureHalfFloat?Rt.RGBA16F:Rt.RGBA,pt,Vt,0,Rt.RGBA,Ze.extRenderToTextureHalfFloat?Rt.HALF_FLOAT:Rt.UNSIGNED_BYTE,null),at.colorAttachment.set(Ke)}(ne,0,et,Be,Re,je)}else Ce.bindTexture(Ce.TEXTURE_2D,Be.colorAttachment.get()),ne.bindFramebuffer.set(Be.framebuffer)})(v,h,l,h.transform.projection.name==="globe"?.5:.25),v.clear({color:r.aj.transparent});const $=h.transform,j=$.projection.name==="globe",G=j?["PROJECTION_GLOBE_VIEW"]:[],X=j?mr.frontCCW:mr.disabled,Y=[r.at($.center.lng),r.aA($.center.lat)];for(let ne=0;ne<m.length;ne++){const ve=m[ne];if(i.hasRenderableParent(ve))continue;const _e=i.getTile(ve),Te=_e.getBucket(l);if(!Te||Te.projection.name!==$.projection.name)continue;const Ce=h.isTileAffectedByFog(ve),Re=Te.programConfigurations.get(l.id),je=h.getOrCreateProgram("heatmap",{config:Re,defines:G,overrideFog:Ce}),{zoom:Be}=h.transform;h.terrain&&h.terrain.setupElevationDraw(_e,je),h.uploadCommonUniforms(v,je,ve.toUnwrapped());const et=$.projection.createInversionMatrix($,ve.canonical);je.draw(h,x.TRIANGLES,nr.disabled,E,L,X,cw(h,ve,_e,et,Y,Be,l.paint.get("heatmap-intensity")),l.id,Te.layoutVertexBuffer,Te.indexBuffer,Te.segments,l.paint,h.transform.zoom,Re,j?[Te.globeExtVertexBuffer]:null)}v.viewport.set([0,0,h.width,h.height])}else h.renderPass==="translucent"&&(h.context.setColorMode(h.colorModeForRenderPass()),function(v,x){const E=v.context,L=E.gl,$=x.heatmapFbo;if(!$)return;E.activeTexture.set(L.TEXTURE0),L.bindTexture(L.TEXTURE_2D,$.colorAttachment.get()),E.activeTexture.set(L.TEXTURE1);let j=x.colorRampTexture;j||(j=x.colorRampTexture=new r.T(E,x.colorRamp,L.RGBA8)),j.bind(L.LINEAR,L.CLAMP_TO_EDGE),v.getOrCreateProgram("heatmapTexture").draw(v,L.TRIANGLES,nr.disabled,Tr.disabled,v.colorModeForRenderPass(),mr.disabled,((G,X,Y,ne)=>({u_image:0,u_color_ramp:1,u_opacity:X.paint.get("heatmap-opacity")}))(0,x),x.id,v.viewportBuffer,v.quadTriangleIndexBuffer,v.viewportSegments,x.paint,v.transform.zoom)}(h,l))},line:function(h,i,l,m){if(h.renderPass!=="translucent")return;const v=l.paint.get("line-opacity"),x=l.paint.get("line-width");if(v.constantOr(1)===0||x.constantOr(1)===0)return;const E=l.paint.get("line-emissive-strength"),L=l.paint.get("line-occlusion-opacity"),$=l.layout.get("line-elevation-reference"),j=l.layout.get("line-width-unit")==="meters",G=$==="sea",X=h.context,Y=X.gl,ne=!l.isDraped();if(ne&&h.transform.projection.name==="globe")return;const ve=l.layout.get("line-cross-slope"),_e=ve!==void 0,Te=ve<1,Ce=ne?new nr(h.depthOcclusion?Y.GREATER:Y.LEQUAL,nr.ReadOnly,h.depthRangeFor3D):h.depthModeForSublayer(0,nr.ReadOnly),Re=h.colorModeForDrapableLayerRenderPass(E),je=h.terrain&&h.terrain.renderingToTexture,Be=je?1:r.q.devicePixelRatio,et=l.paint.get("line-dasharray"),Ze=et.constantOr(1),Xe=l.layout.get("line-cap"),Ke=et.constantOr(null),at=Xe.constantOr(null),pt=l.paint.get("line-pattern"),Vt=pt.constantOr(1),Rt=pt.constantOr(null),ht=l.paint.get("line-opacity").constantOr(1);let St=!Vt&&ht!==1||h.depthOcclusion&&L>0&&L<1;const en=l.paint.get("line-gradient"),hn=Vt?"linePattern":"line",vn=r.c_(l);let It;if(je&&h.terrain&&h.terrain.clipOrMaskOverlapStencilType()&&(St=!1),L!==0&&h.depthOcclusion){const Ht=l.paint._values["line-opacity"];Ht&&Ht.value&&Ht.value.kind==="constant"?It=Ht.value:r.w(`Occlusion opacity for layer ${l.id} is supported only when line-opacity isn't data-driven.`)}if(ne&&(h.forceTerrainMode=!0),!ne&&L!==0&&h.terrain&&!je)return void r.w(`Occlusion opacity for layer ${l.id} is supported on terrain only if the layer has line-z-offset enabled.`);const ln=St&&ne?h.stencilModeFor3D():Tr.disabled;ne&&(vn.push("ELEVATED"),_e&&vn.push(Te?"CROSS_SLOPE_HORIZONTAL":"CROSS_SLOPE_VERTICAL"),G&&vn.push("ELEVATION_REFERENCE_SEA")),x.value.kind!=="constant"&&x.value.isLineProgressConstant===!1&&vn.push("VARIABLE_LINE_WIDTH");for(const Ht of m){const gn=i.getTile(Ht);if(Vt&&!gn.patternsLoaded())continue;const cn=gn.getBucket(l);if(!cn)continue;h.prepareDrawTile();const tn=cn.programConfigurations.get(l.id),Rn=h.isTileAffectedByFog(Ht),Dn=h.getOrCreateProgram(hn,{config:tn,defines:vn,overrideFog:Rn,overrideRtt:!ne&&void 0});if(Rt&&gn.imageAtlas){const Or=r.A.from(Rt),Ui=gn.imageAtlas.patternPositions[Or.getSerializedPrimary()];Ui&&tn.setConstantPatternPositions(Ui)}if(!Vt&&Ke&&at&&gn.lineAtlas){const Or=gn.lineAtlas.getDash(Ke,at);Or&&tn.setConstantPatternPositions(Or)}let[An,Bn]=l.paint.get("line-trim-offset");(at==="round"||at==="square")&&An!==Bn&&(An===0&&(An-=1),Bn===1&&(Bn+=1));const br=je?Ht.projMatrix:null,ir=j?1/cn.tileToMeter/r.ar(gn,1,h.transform.zoom):1,rr=j?1/cn.tileToMeter/r.ar(gn,1,Math.floor(h.transform.zoom)):1,wr=Vt?r.c$(h,gn,l,br,Be,ir,rr,[An,Bn]):r.d0(h,gn,l,br,cn.lineClipsArray.length,Be,ir,rr,[An,Bn]);if(en){const Or=cn.gradients[l.id];let Ui=Or.texture;if(l.gradientVersion!==Or.version){let ki=256;if(l.stepInterpolant){const li=i.getSource().maxzoom,mi=Ht.canonical.z===li?Math.ceil(1<<h.transform.maxZoom-Ht.canonical.z):1;ki=r.aw(r.d1(cn.maxLineLength/r.ag*1024*mi),256,X.maxTextureSize)}Or.gradient=r.d2({expression:l.gradientExpression(),evaluationKey:"lineProgress",resolution:ki,image:Or.gradient||void 0,clips:cn.lineClipsArray}),Or.texture?Or.texture.update(Or.gradient):Or.texture=new r.T(X,Or.gradient,Y.RGBA8),Or.version=l.gradientVersion,Ui=Or.texture}X.activeTexture.set(Y.TEXTURE1),Ui.bind(l.stepInterpolant?Y.NEAREST:Y.LINEAR,Y.CLAMP_TO_EDGE)}Ze&&(X.activeTexture.set(Y.TEXTURE0),gn.lineAtlasTexture&&gn.lineAtlasTexture.bind(Y.LINEAR,Y.REPEAT),tn.updatePaintBuffers()),Vt&&(X.activeTexture.set(Y.TEXTURE0),gn.imageAtlasTexture&&gn.imageAtlasTexture.bind(Y.LINEAR,Y.CLAMP_TO_EDGE),tn.updatePaintBuffers()),ne&&!G&&h.terrain.setupElevationDraw(gn,Dn),h.uploadCommonUniforms(X,Dn,Ht.toUnwrapped());const Gr=Or=>{It!=null&&(It.value=ht*L),Dn.draw(h,Y.TRIANGLES,Ce,Or,Re,mr.disabled,wr,l.id,cn.layoutVertexBuffer,cn.indexBuffer,cn.segments,l.paint,h.transform.zoom,tn,[cn.layoutVertexBuffer2,cn.patternVertexBuffer,cn.zOffsetVertexBuffer]),It!=null&&(It.value=ht)};if(St&&!ne){const Or=h.stencilModeForClipping(Ht).ref;Or===0&&je&&X.clear({stencil:0});const Ui={func:Y.EQUAL,mask:255};wr.u_alpha_discard_threshold=.8,Gr(new Tr(Ui,Or,255,Y.KEEP,Y.KEEP,Y.INVERT)),wr.u_alpha_discard_threshold=0,Gr(new Tr(Ui,Or,255,Y.KEEP,Y.KEEP,Y.KEEP))}else St&&ne&&(wr.u_alpha_discard_threshold=.001),Gr(ne?ln:h.stencilModeForClipping(Ht))}ne&&(h.forceTerrainMode=!1),St&&(h.resetStencilClippingMasks(),je&&X.clear({stencil:0})),L===0||h.depthOcclusion||je||h.layersWithOcclusionOpacity.push(h.currentLayer)},fill:function(h,i,l,m){const v=l.paint.get("fill-color"),x=l.paint.get("fill-opacity"),E=l.is3D(),L=new nr(h.context.gl.LEQUAL,nr.ReadWrite,h.depthRangeFor3D);if(x.constantOr(1)===0)return;const $=l.paint.get("fill-emissive-strength"),j=h.colorModeForDrapableLayerRenderPass($),G=l.paint.get("fill-pattern"),X=h.opaquePassEnabledForLayer()&&!G.constantOr(1)&&v.constantOr(r.aj.transparent).a===1&&x.constantOr(0)===1?"opaque":"translucent";if(h.renderPass===X){const Y=E?L:h.depthModeForSublayer(1,h.renderPass==="opaque"?nr.ReadWrite:nr.ReadOnly);Pf(h,i,l,m,Y,j,!1)}if(!E&&h.renderPass==="translucent"&&l.paint.get("fill-antialias")){const Y=E?L:h.depthModeForSublayer(l.getPaintProperty("fill-outline-color")?2:0,nr.ReadOnly);Pf(h,i,l,m,Y,j,!0)}},"fill-extrusion":function(h,i,l,m){const v=l.paint.get("fill-extrusion-opacity"),x=h.context,E=x.gl,L=h.terrain,$=L&&L.renderingToTexture;if(v===0)return;const j=h.conflationActive&&h.style.isLayerClipped(l,i.getSource()),G=h.style.order.indexOf(l.fqid);if(j&&function(X,Y,ne,ve,_e){for(const Te of ve){const Ce=Y.getTile(Te).getBucket(ne);Ce&&(Ce.updateReplacement(Te,X.replacementSource,_e),Ce.uploadCentroid(X.context))}}(h,i,l,m,G),L||j)for(const X of m){const Y=i.getTile(X).getBucket(l);Y&&n0(h.context,i,X,Y,l,L,j)}if(h.renderPass==="shadow"&&h.shadowRenderer){const X=h.shadowRenderer;if(L&&v<.65&&l._transitionablePaint._values["fill-extrusion-opacity"].value.expression instanceof r.a9)return;const Y=X.getShadowPassDepthMode(),ne=X.getShadowPassColorMode();id(h,i,l,m,Y,Tr.disabled,ne,j)}else if(h.renderPass==="translucent"){const X=!l.paint.get("fill-extrusion-pattern").constantOr(1),Y=l.paint.get("fill-extrusion-color").constantOr(r.aj.white);if(!$&&Y.a!==0){const ne=new nr(h.context.gl.LEQUAL,nr.ReadWrite,h.depthRangeFor3D);v===1&&X?id(h,i,l,m,ne,Tr.disabled,zr.unblended,j):(id(h,i,l,m,ne,Tr.disabled,zr.disabled,j),id(h,i,l,m,ne,h.stencilModeFor3D(),h.colorModeForRenderPass(),j),h.resetStencilClippingMasks())}if(h.style.enable3dLights()&&X&&(!L&&h.transform.projection.name!=="globe"||$)){const ne=l.paint.get("fill-extrusion-opacity"),ve=l.paint.get("fill-extrusion-ambient-occlusion-intensity"),_e=l.paint.get("fill-extrusion-ambient-occlusion-ground-radius"),Te=l.paint.get("fill-extrusion-flood-light-intensity"),Ce=l.paint.get("fill-extrusion-flood-light-color-use-theme").constantOr("default")==="none",Re=l.paint.get("fill-extrusion-flood-light-color").toRenderColor(Ce?null:l.lut).toArray01().slice(0,3),je=ve>0&&_e>0,Be=Te>0,et=(Xe,Ke,at)=>(1-at)*Xe+at*Ke,Ze=Xe=>{const Ke=h.depthModeForSublayer(1,nr.ReadOnly,E.LEQUAL,!0),at=l.paint.get(Xe?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),pt=et(.1,3,at),Vt=h._showOverdrawInspector;if(!Vt){const Rt=new Tr({func:E.ALWAYS,mask:255},255,255,E.KEEP,E.KEEP,E.REPLACE),ht=new zr([E.ONE,E.ONE,E.ONE,E.ONE],r.aj.transparent,[!1,!1,!1,!0],E.MIN);lc(h,i,l,m,Ke,Rt,ht,mr.disabled,Xe,"sdf",ne,ve,_e,Te,Re,pt,j,!1)}{const Rt=Vt?Tr.disabled:new Tr({func:E.EQUAL,mask:255},255,255,E.KEEP,E.DECR,E.DECR),ht=Vt?h.colorModeForRenderPass():new zr([E.ONE_MINUS_DST_ALPHA,E.DST_ALPHA,E.ONE,E.ONE],r.aj.transparent,[!0,!0,!0,!0]);lc(h,i,l,m,Ke,Rt,ht,mr.disabled,Xe,"color",ne,ve,_e,Te,Re,pt,j,!1)}};if($){const Xe=(Ke,at,pt)=>{const Vt=h.depthModeForSublayer(1,nr.ReadOnly,E.LEQUAL,!1),Rt=l.paint.get(Ke?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),ht=et(.1,3,Rt);{const St=new zr([E.ONE,E.ONE,E.ONE,E.ONE],r.aj.transparent,[!1,!1,!1,!0]);lc(h,i,l,m,Vt,Tr.disabled,St,mr.disabled,Ke,"clear",ne,ve,_e,Te,Re,ht,j,at)}{const St=new Tr({func:E.ALWAYS,mask:255},255,255,E.KEEP,E.KEEP,E.REPLACE),en=new zr([E.ONE,E.ONE,E.ONE,E.ONE],r.aj.transparent,[!1,!1,!1,!0],E.MIN);lc(h,i,l,m,Vt,St,en,mr.disabled,Ke,"sdf",ne,ve,_e,Te,Re,ht,j,at)}{const St=Ke?E.ZERO:E.ONE_MINUS_DST_ALPHA,en=new Tr({func:E.EQUAL,mask:255},255,255,E.KEEP,E.DECR,E.DECR),hn=new zr([St,E.DST_ALPHA,E.ONE_MINUS_DST_ALPHA,E.ZERO],r.aj.transparent,[!0,!0,!0,!0]);lc(h,i,l,m,Vt,en,hn,mr.disabled,Ke,"color",ne,ve,_e,Te,Re,ht,j,at)}{const St=new zr([E.ONE,E.ONE,E.ONE,Ke?E.ZERO:E.ONE],r.aj.transparent,[!1,!1,!1,!0],Ke?E.FUNC_ADD:E.MAX);lc(h,i,l,m,Vt,Tr.disabled,St,mr.disabled,Ke,"clear",ne,ve,_e,Te,Re,ht,j,at,pt)}};if(je||Be){let Ke;if(h.prepareDrawTile(),L){const at=L.drapeBufferSize[0],pt=L.drapeBufferSize[1];Ke=L.framebufferCopyTexture,Ke&&(!Ke||Ke.size[0]===at&&Ke.size[1]===pt)||(Ke&&Ke.destroy(),Ke=L.framebufferCopyTexture=new r.T(x,new r.r({width:at,height:pt}),E.RGBA8)),Ke.bind(E.LINEAR,E.CLAMP_TO_EDGE),E.copyTexSubImage2D(E.TEXTURE_2D,0,0,0,0,0,at,pt)}je&&Xe(!0,!1,Ke),Be&&Xe(!1,!0,Ke)}}else je&&Ze(!0),Be&&Ze(!1),(je||Be)&&h.resetStencilClippingMasks()}}},hillshade:function(h,i,l,m){if(h.renderPass!=="offscreen"&&h.renderPass!=="translucent"||h.style.disableElevatedTerrain)return;const v=h.context,x=h.terrain&&h.terrain.renderingToTexture,[E,L]=h.renderPass!=="translucent"||x?[{},m]:h.stencilConfigForOverlap(m);for(const $ of L){const j=i.getTile($);if(j.needsHillshadePrepare&&h.renderPass==="offscreen")Jc(h,j,l);else if(h.renderPass==="translucent"){const G=h.depthModeForSublayer(0,nr.ReadOnly),X=l.paint.get("hillshade-emissive-strength"),Y=h.colorModeForDrapableLayerRenderPass(X),ne=x&&h.terrain?h.terrain.stencilModeForRTTOverlap($):E[$.overscaledZ];zv(h,$,j,l,G,ne,Y)}}v.viewport.set([0,0,h.width,h.height]),h.resetStencilClippingMasks()},raster:function(h,i,l,m,v,x){if(h.renderPass!=="translucent"||l.paint.get("raster-opacity")===0)return;const E=h.transform.projection.name==="globe",L=l.paint.get("raster-elevation")!==0,$=L&&E;if(h.renderElevatedRasterBackface&&!$)return;const j=h.context,G=j.gl,X=i.getSource(),Y=function(Ze,Xe,Ke,at){const pt=Xe.paint.get("raster-color"),Vt=Ze.type==="raster-array",Rt=[],ht=Xe.paint.get("raster-resampling"),St=Xe.paint.get("raster-color-mix");let en=Xe.paint.get("raster-color-range");const hn=[St[0],St[1],St[2],0],vn=St[3];let It=ht==="nearest"?at.NEAREST:at.LINEAR;if(Vt&&(Rt.push("RASTER_ARRAY"),pt||Rt.push("RASTER_COLOR"),ht==="linear"&&Rt.push("RASTER_ARRAY_LINEAR"),It=at.NEAREST,!en&&Ze.rasterLayers)){const ln=Ze.rasterLayers.find(({id:Ht})=>Ht===Xe.sourceLayer);ln&&ln.fields&&ln.fields.range&&(en=ln.fields.range)}if(en=en||[0,1],pt){Rt.push("RASTER_COLOR"),Ke.activeTexture.set(at.TEXTURE2),Xe.updateColorRamp(en);let ln=Xe.colorRampTexture;ln||(ln=Xe.colorRampTexture=new r.T(Ke,Xe.colorRamp,at.RGBA8)),ln.bind(at.LINEAR,at.CLAMP_TO_EDGE)}return{mix:hn,range:en,offset:vn,defines:Rt,resampling:It}}(X,l,j,G);if(X instanceof r.aJ&&!m.length&&!E)return;const ne=l.paint.get("raster-emissive-strength"),ve=h.colorModeForDrapableLayerRenderPass(ne),_e=h.terrain&&h.terrain.renderingToTexture,Te=!h.options.moving,Ce=l.paint.get("raster-resampling")==="nearest"?G.NEAREST:G.LINEAR;if(X instanceof r.aJ&&!m.length&&(X.onNorthPole||X.onSouthPole)){const Ze=L?h.stencilModeFor3D():Tr.disabled;return void Fn(!!X.onNorthPole,null,h,i,l,ne,Y,mr.disabled,Ze)}if(!m.length)return;const[Re,je]=X instanceof r.aJ||_e?[{},m]:h.stencilConfigForOverlap(m),Be=je[je.length-1].overscaledZ;$&&Y.defines.push("PROJECTION_GLOBE_VIEW"),L&&Y.defines.push("RENDER_CUTOFF");const et=(Ze,Xe,Ke)=>{for(const at of Ze){const pt=at.toUnwrapped(),Vt=i.getTile(at);if(_e&&(!Vt||!Vt.hasData()))continue;j.activeTexture.set(G.TEXTURE0);const Rt=Zi(Vt,X,l,Y);if(!Rt||!Rt.texture)continue;const{texture:ht,mix:St,offset:en,tileSize:hn,buffer:vn}=Rt;let It,ln;_e?(It=nr.disabled,ln=at.projMatrix):L?(It=new nr(G.LEQUAL,nr.ReadWrite,h.depthRangeFor3D),ln=E?Float32Array.from(h.transform.expandedFarZProjMatrix):h.transform.calculateProjMatrix(pt,Te)):(It=h.depthModeForSublayer(at.overscaledZ-Be,l.paint.get("raster-opacity")===1?nr.ReadWrite:nr.ReadOnly,G.LESS),ln=h.transform.calculateProjMatrix(pt,Te));const Ht=h.terrain&&_e?h.terrain.stencilModeForRTTOverlap(at):Re[at.overscaledZ],gn=x?0:l.paint.get("raster-fade-duration");Vt.registerFadeDuration(gn);const cn=i.findLoadedParent(at,0),tn=td(Vt,cn,i,h.transform,gn);let Rn,Dn;h.terrain&&h.terrain.prepareDrawTile(),j.activeTexture.set(G.TEXTURE0),ht.bind(Ce,G.CLAMP_TO_EDGE),j.activeTexture.set(G.TEXTURE1),cn?(cn.texture&&cn.texture.bind(Ce,G.CLAMP_TO_EDGE),Rn=Math.pow(2,cn.tileID.overscaledZ-Vt.tileID.overscaledZ),Dn=[Vt.tileID.canonical.x*Rn%1,Vt.tileID.canonical.y*Rn%1]):ht.bind(Ce,G.CLAMP_TO_EDGE),ht.useMipmap&&j.extTextureFilterAnisotropic&&h.transform.pitch>20&&G.texParameterf(G.TEXTURE_2D,j.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,j.extTextureFilterAnisotropicMax);const An=h.transform;let Bn;const br=L?ad(An):[0,0,0,0];let ir,rr,wr,Gr,Or,Ui=0;if($&&X instanceof r.aJ&&X.coordinates.length>3)ir=Float32Array.from(r.bb(r.cH(new r.bT(0,0,0)))),rr=Float32Array.from(An.globeMatrix),wr=Float32Array.from(r.cD(An)),Gr=[r.at(An.center.lng),r.aA(An.center.lat)],Bn=X.elevatedGlobePerspectiveTransform,Or=X.elevatedGlobeGridMatrix||new Float32Array(9);else if($){const Lr=r.cE(at.canonical);Ui=r.cF(Lr.getCenter().lat),ir=Float32Array.from(r.bb(r.cH(at.canonical))),rr=Float32Array.from(An.globeMatrix),wr=Float32Array.from(r.cD(An)),Gr=[r.at(An.center.lng),r.aA(An.center.lat)],Bn=[0,0],Or=Float32Array.from(r.cG(at.canonical,Lr,Ui,An.worldSize/An._pixelsPerMercatorPixel))}else Bn=X instanceof r.aJ?X.perspectiveTransform:[0,0],ir=new Float32Array(16),rr=new Float32Array(9),wr=new Float32Array(16),Gr=[0,0],Or=new Float32Array(9);const ki=Gn(ln,ir,rr,wr,Or,Dn||[0,0],r.ae(h.transform.zoom),Gr,br,Rn||1,tn,l,Bn,L?l.paint.get("raster-elevation"):0,2,St,en,Y.range,hn,vn,ne),li=h.isTileAffectedByFog(at),mi=h.getOrCreateProgram("raster",{defines:Y.defines,overrideFog:li});if(h.uploadCommonUniforms(j,mi,pt),X instanceof r.aJ){const Lr=X.elevatedGlobeVertexBuffer,Kr=X.elevatedGlobeIndexBuffer;if(_e||!E)X.boundsBuffer&&X.boundsSegments&&mi.draw(h,G.TRIANGLES,It,Tr.disabled,ve,mr.disabled,ki,l.id,X.boundsBuffer,h.quadTriangleIndexBuffer,X.boundsSegments);else if(Lr&&Kr){const fr=An.zoom<=r.c6?X.elevatedGlobeSegments:X.getSegmentsForLongitude(An.center.lng);fr&&mi.draw(h,G.TRIANGLES,It,Tr.disabled,ve,Xe,ki,l.id,Lr,Kr,fr)}}else if($){It=new nr(G.LEQUAL,nr.ReadOnly,h.depthRangeFor3D);const Lr=h.globeSharedBuffers;if(Lr){const[Kr,fr,ni]=Lr.getGridBuffers(Ui,!1);mi.draw(h,G.TRIANGLES,It,Ke||Ht,h.colorModeForRenderPass(),Xe,ki,l.id,Kr,fr,ni)}}else{const{tileBoundsBuffer:Lr,tileBoundsIndexBuffer:Kr,tileBoundsSegments:fr}=h.getTileBoundsBuffers(Vt);mi.draw(h,G.TRIANGLES,It,Ht,ve,mr.disabled,ki,l.id,Lr,Kr,fr)}}if(!(X instanceof r.aJ)&&$)for(const at of Ze){const pt=at.canonical.y===(1<<at.canonical.z)-1;at.canonical.y===0&&Fn(!0,at,h,i,l,ne,Y,Xe,Ke||Tr.disabled),pt&&Fn(!1,at,h,i,l,ne,Y,Xe===mr.frontCW?mr.backCW:mr.frontCW,Ke||Tr.disabled)}};$?et(je,h.renderElevatedRasterBackface?mr.backCW:mr.frontCW,h.stencilModeFor3D()):et(je,mr.disabled,void 0),h.resetStencilClippingMasks()},"raster-particle":function(h,i,l,m,v,x){h.renderPass==="offscreen"&&function(E,L,$,j){if(!j.length)return;const G=E.context,X=G.gl,Y=L.getSource();if(!(Y instanceof yl))return;const ne=Math.ceil(Math.sqrt($.paint.get("raster-particle-count")));let ve=$.particlePositionRGBAImage;if(!ve||ve.width!==ne){const je=function(Be){const et=Be*Be,Ze=new Uint8Array(4*et),Xe=function(at){return at|=0,at=Math.imul(2747636419^at,2654435769),at=Math.imul(at^at>>>16,2654435769),((at=Math.imul(at^at>>>16,2654435769))>>>0)/4294967296},Ke=1/1.1;for(let at=0;at<et;at++){const pt=Ke*(Xe(2*at+0)+oc),Vt=Ke*(Xe(2*at+1)+oc),Rt=255*pt%1,ht=255*Vt%1,St=Rt,en=Vt-ht/255,hn=ht;Ze[4*at+0]=255*(pt-Rt/255),Ze[4*at+1]=255*St,Ze[4*at+2]=255*en,Ze[4*at+3]=255*hn}return Ze}(ne);ve=$.particlePositionRGBAImage=new r.r({width:ne,height:ne},je)}let _e=$.particleFramebuffer;_e?_e.width!==ne&&(_e.destroy(),_e=$.particleFramebuffer=G.createFramebuffer(ne,ne,!0,null)):_e=$.particleFramebuffer=G.createFramebuffer(ne,ne,!0,null);const Te=[];for(const je of j){const Be=L.getTile(je);if(!(Be instanceof Nh))continue;const et=Sp(Be,Y,$);if(!et)continue;const Ze=[Be.tileSize,Be.tileSize];let Xe=$.tileFramebuffer;Xe||(Xe=$.tileFramebuffer=G.createFramebuffer(Ze[0],Ze[1],!0,null));let Ke=Be.rasterParticleState;Ke||(Ke=Be.rasterParticleState=new i0(G,je,Ze,ve));const at=Ke.update($.lastInvalidatedAt);Ke.particleTextureDimension!==ne&&Ke.updateParticleTexture(je,ve);const pt=Ke.targetColorTexture;Ke.targetColorTexture=Ke.backgroundColorTexture,Ke.backgroundColorTexture=pt;const Vt=Ke.particleTexture0;Ke.particleTexture0=Ke.particleTexture1,Ke.particleTexture1=Vt,Te.push([je,et,Ke,at])}if(Te.length===0)return;const Ce=r.q.now(),Re=$.previousDrawTimestamp?.001*(Ce-$.previousDrawTimestamp):.0167;if($.previousDrawTimestamp=Ce,$.hasColorMap()){G.activeTexture.set(X.TEXTURE0+2);let je=$.colorRampTexture;je||(je=$.colorRampTexture=new r.T(G,$.colorRamp,X.RGBA8)),je.bind(X.LINEAR,X.CLAMP_TO_EDGE)}G.bindFramebuffer.set($.tileFramebuffer.framebuffer),function(je,Be,et){const Ze=je.context,Xe=Ze.gl,Ke=Be.tileFramebuffer;Ze.activeTexture.set(Xe.TEXTURE0);const at={u_texture:0,u_opacity:1.05*(Vt=Be.paint.get("raster-particle-fade-opacity-factor"))/(Vt+.05)},pt=je.getOrCreateProgram("rasterParticleTexture",{defines:[],overrideFog:!1});var Vt;for(const Rt of et){const[,,ht,St]=Rt;Ke.colorAttachment.set(ht.targetColorTexture.texture),Ze.viewport.set([0,0,Ke.width,Ke.height]),Ze.clear({color:r.aj.transparent}),St&&(ht.backgroundColorTexture.bind(Xe.NEAREST,Xe.CLAMP_TO_EDGE),pt.draw(je,Xe.TRIANGLES,nr.disabled,Tr.disabled,zr.alphaBlended,mr.disabled,at,Be.id,je.viewportBuffer,je.quadTriangleIndexBuffer,je.viewportSegments))}}(E,$,Te),function(je,Be,et,Ze){const Xe=je.context,Ke=Xe.gl,at=et.tileFramebuffer,pt=je.transform.projection.name==="globe",Vt=et.paint.get("raster-particle-max-speed");for(const Rt of Ze){const[ht,St,en]=Rt;Xe.activeTexture.set(Ke.TEXTURE0+0),St.texture.bind(Ke.LINEAR,Ke.CLAMP_TO_EDGE),at.colorAttachment.set(en.targetColorTexture.texture);const hn=je.getOrCreateProgram("rasterParticleDraw",{defines:St.defines,overrideFog:!1});Xe.activeTexture.set(Ke.TEXTURE0+1);const vn=St.scalarData?[]:[0,1,2,3].map(Ht=>r.d4[Ht](ht));vn.push(ht);const It=ht.canonical.x,ln=ht.canonical.y;for(const Ht of vn){const gn=Be.getTile(pt?Ht.wrapped():Ht);if(!gn)continue;const cn=gn.rasterParticleState;if(!cn)continue;const tn=Ht.canonical.x+(1<<Ht.canonical.z)*(Ht.wrap-ht.wrap),Rn=Ht.canonical.y;cn.particleTexture0.bind(Ke.NEAREST,Ke.CLAMP_TO_EDGE);const Dn=ac(1,cn.particleTexture0.size[0],[tn-It,Rn-ln],0,St.texture.size,2,Vt,St.textureOffset,St.scale,St.offset);hn.draw(je,Ke.POINTS,nr.disabled,Tr.disabled,zr.alphaBlended,mr.disabled,Dn,et.id,cn.particleIndexBuffer,void 0,cn.particleSegment)}}}(E,L,$,Te),G.bindFramebuffer.set($.particleFramebuffer.framebuffer),function(je,Be,et,Ze){const Xe=je.context,Ke=Xe.gl,at=Be.paint.get("raster-particle-max-speed"),pt=Ze*Be.paint.get("raster-particle-speed-factor")*.15,Vt=function(ht){return Math.pow(ht,6)}(.01+1*Be.paint.get("raster-particle-reset-rate-factor")),Rt=Be.particleFramebuffer;Xe.viewport.set([0,0,Rt.width,Rt.height]);for(const ht of et){const[,St,en]=ht;Xe.activeTexture.set(Ke.TEXTURE0+0),St.texture.bind(Ke.LINEAR,Ke.CLAMP_TO_EDGE),Xe.activeTexture.set(Ke.TEXTURE0+1);const hn=en.particleTexture0;hn.bind(Ke.NEAREST,Ke.CLAMP_TO_EDGE);const vn=tr(1,hn.size[0],0,St.texture.size,at,pt,Vt,St.textureOffset,St.scale,St.offset);Rt.colorAttachment.set(en.particleTexture1.texture),Xe.clear({color:r.aj.transparent}),je.getOrCreateProgram("rasterParticleUpdate",{defines:St.defines}).draw(je,Ke.TRIANGLES,nr.disabled,Tr.disabled,zr.unblended,mr.disabled,vn,Be.id,je.viewportBuffer,je.quadTriangleIndexBuffer,je.viewportSegments)}}(E,$,Te,Re)}(h,i,l,m),h.renderPass==="translucent"&&(function(E,L,$,j,G){const X=E.context,Y=X.gl,ne=L.getSource().tileSize,ve=5*(1-r.ac(r.bY,r.bY+1,E.transform.zoom))*ne+$.paint.get("raster-particle-elevation"),_e=!E.options.moving,Te=E.transform.projection.name==="globe";if(!j.length)return;const[Ce,Re]=E.stencilConfigForOverlap(j),je=[];Te&&je.push("PROJECTION_GLOBE_VIEW");const Be=E.stencilModeFor3D();for(const et of Re){const Ze=et.toUnwrapped(),Xe=L.getTile(et);if(!Xe.rasterParticleState)continue;const Ke=Xe.rasterParticleState,at=100;Xe.registerFadeDuration(at);const pt=L.findLoadedParent(et,0),Vt=td(Xe,pt,L,E.transform,at);let Rt,ht;E.terrain&&E.terrain.prepareDrawTile(),X.activeTexture.set(Y.TEXTURE0),Ke.targetColorTexture.bind(Y.LINEAR,Y.CLAMP_TO_EDGE),X.activeTexture.set(Y.TEXTURE1),pt&&pt.rasterParticleState?(pt.rasterParticleState.targetColorTexture.bind(Y.LINEAR,Y.CLAMP_TO_EDGE),Rt=Math.pow(2,pt.tileID.overscaledZ-Xe.tileID.overscaledZ),ht=[Xe.tileID.canonical.x*Rt%1,Xe.tileID.canonical.y*Rt%1]):Ke.targetColorTexture.bind(Y.LINEAR,Y.CLAMP_TO_EDGE);const St=Te?Float32Array.from(E.transform.expandedFarZProjMatrix):E.transform.calculateProjMatrix(Ze,_e),en=E.transform,hn=Gg(en),vn=r.cE(et.canonical),It=r.cF(vn.getCenter().lat);let ln,Ht,gn,cn,tn;Te?(ln=Float32Array.from(r.bb(r.cH(et.canonical))),Ht=Float32Array.from(en.globeMatrix),gn=Float32Array.from(r.cD(en)),cn=[r.at(en.center.lng),r.aA(en.center.lat)],tn=Float32Array.from(r.cG(et.canonical,vn,It,en.worldSize/en._pixelsPerMercatorPixel))):(ln=new Float32Array(16),Ht=new Float32Array(9),gn=new Float32Array(16),cn=[0,0],tn=new Float32Array(9));const Rn=sc(St,ln,Ht,gn,tn,ht||[0,0],r.ae(E.transform.zoom),cn,hn,Rt||1,Vt,ve),Dn=E.isTileAffectedByFog(et),An=E.getOrCreateProgram("rasterParticle",{defines:je,overrideFog:Dn});if(E.uploadCommonUniforms(X,An,Ze),Te){const Bn=new nr(Y.LEQUAL,nr.ReadOnly,E.depthRangeFor3D),br=0,ir=E.globeSharedBuffers;if(ir){const[rr,wr,Gr]=ir.getGridBuffers(It,br!==0);An.draw(E,Y.TRIANGLES,Bn,Be,zr.alphaBlended,E.renderElevatedRasterBackface?mr.frontCCW:mr.backCCW,Rn,$.id,rr,wr,Gr)}}else{const Bn=E.depthModeForSublayer(0,nr.ReadOnly),br=Ce[et.overscaledZ],{tileBoundsBuffer:ir,tileBoundsIndexBuffer:rr,tileBoundsSegments:wr}=E.getTileBoundsBuffers(Xe);An.draw(E,Y.TRIANGLES,Bn,br,zr.alphaBlended,mr.disabled,Rn,$.id,ir,rr,wr)}}E.resetStencilClippingMasks()}(h,i,l,m),h.style.map.triggerRepaint())},background:function(h,i,l,m){const v=l.paint.get("background-color"),x=l.paint.get("background-color-use-theme").constantOr("default")==="none",E=l.paint.get("background-opacity"),L=l.paint.get("background-emissive-strength"),$=l.paint.get("background-pitch-alignment")==="viewport";if(E===0)return;const j=h.context,G=j.gl,X=h.transform,Y=X.tileSize,ne=l.paint.get("background-pattern");let ve;if(ne!==void 0&&(ne===null||(ve=h.imageManager.getPattern(ne.toString(),l.scope,h.style.getLut(l.scope)),!ve)))return;const _e=!ne&&v.a===1&&E===1&&h.opaquePassEnabledForLayer()?"opaque":"translucent";if(h.renderPass!==_e)return;const Te=Tr.disabled,Ce=h.depthModeForSublayer(0,_e==="opaque"?nr.ReadWrite:nr.ReadOnly),Re=h.colorModeForDrapableLayerRenderPass(L),je=ne?"backgroundPattern":"background";let Be,et=m;if(et||(Be=h.getBackgroundTiles(),et=Object.values(Be).map(Ze=>Ze.tileID)),ne&&(j.activeTexture.set(G.TEXTURE0),h.imageManager.bind(h.context,l.scope)),$){const Ze=h.getOrCreateProgram(je,{overrideFog:!1,overrideRtt:!0}),Xe=new Float32Array(r.ab.mat4.identity([])),Ke=new r.aG(0,0,0,0,0),at=ne?yp(Xe,L,E,h,0,l.scope,ve,$,{tileID:Ke,tileSize:Y}):Qv(Xe,L,E,v.toRenderColor(x?null:l.lut));Ze.draw(h,G.TRIANGLES,Ce,Te,Re,mr.disabled,at,l.id,h.viewportBuffer,h.quadTriangleIndexBuffer,h.viewportSegments)}else for(const Ze of et){const Xe=h.isTileAffectedByFog(Ze),Ke=h.getOrCreateProgram(je,{overrideFog:Xe}),at=Ze.toUnwrapped(),pt=m?Ze.projMatrix:h.transform.calculateProjMatrix(at);h.prepareDrawTile();const Vt=i?i.getTile(Ze):Be?Be[Ze.key]:new uu(Ze,Y,X.zoom,h),Rt=ne?yp(pt,L,E,h,0,l.scope,ve,$,{tileID:Ze,tileSize:Y}):Qv(pt,L,E,v.toRenderColor(x?null:l.lut));h.uploadCommonUniforms(j,Ke,at);const{tileBoundsBuffer:ht,tileBoundsIndexBuffer:St,tileBoundsSegments:en}=h.getTileBoundsBuffers(Vt);Ke.draw(h,G.TRIANGLES,Ce,Te,Re,mr.disabled,Rt,l.id,ht,St,en)}},sky:function(h,i,l){const m=h._atmosphere?r.ae(h.transform.zoom):1,v=l.paint.get("sky-opacity")*m;if(v===0)return;const x=h.context,E=l.paint.get("sky-type"),L=new nr(x.gl.LEQUAL,nr.ReadOnly,[0,1]),$=h.frameCounter/1e3%1;E==="atmosphere"?h.renderPass==="offscreen"?l.needsSkyboxCapture(h)&&(function(j,G,X,Y){const ne=j.context,ve=ne.gl;let _e=G.skyboxFbo;if(!_e){_e=G.skyboxFbo=ne.createFramebuffer(32,32,!0,null),G.skyboxGeometry=new Of(ne),G.skyboxTexture=ne.gl.createTexture(),ve.bindTexture(ve.TEXTURE_CUBE_MAP,G.skyboxTexture),ve.texParameteri(ve.TEXTURE_CUBE_MAP,ve.TEXTURE_WRAP_S,ve.CLAMP_TO_EDGE),ve.texParameteri(ve.TEXTURE_CUBE_MAP,ve.TEXTURE_WRAP_T,ve.CLAMP_TO_EDGE),ve.texParameteri(ve.TEXTURE_CUBE_MAP,ve.TEXTURE_MIN_FILTER,ve.LINEAR),ve.texParameteri(ve.TEXTURE_CUBE_MAP,ve.TEXTURE_MAG_FILTER,ve.LINEAR);for(let je=0;je<6;++je)ve.texImage2D(ve.TEXTURE_CUBE_MAP_POSITIVE_X+je,0,ve.RGBA,32,32,0,ve.RGBA,ve.UNSIGNED_BYTE,null)}ne.bindFramebuffer.set(_e.framebuffer),ne.viewport.set([0,0,32,32]);const Te=G.getCenter(j,!0),Ce=j.getOrCreateProgram("skyboxCapture"),Re=new Float64Array(16);r.ab.mat4.identity(Re),r.ab.mat4.rotateY(Re,Re,.5*-Math.PI),ds(j,G,Ce,Re,Te,0),r.ab.mat4.identity(Re),r.ab.mat4.rotateY(Re,Re,.5*Math.PI),ds(j,G,Ce,Re,Te,1),r.ab.mat4.identity(Re),r.ab.mat4.rotateX(Re,Re,.5*-Math.PI),ds(j,G,Ce,Re,Te,2),r.ab.mat4.identity(Re),r.ab.mat4.rotateX(Re,Re,.5*Math.PI),ds(j,G,Ce,Re,Te,3),r.ab.mat4.identity(Re),ds(j,G,Ce,Re,Te,4),r.ab.mat4.identity(Re),r.ab.mat4.rotateY(Re,Re,Math.PI),ds(j,G,Ce,Re,Te,5),ne.viewport.set([0,0,j.width,j.height])}(h,l),l.markSkyboxValid(h)):h.renderPass==="sky"&&function(j,G,X,Y,ne){const ve=j.context,_e=ve.gl,Te=j.transform,Ce=j.getOrCreateProgram("skybox");ve.activeTexture.set(_e.TEXTURE0),_e.bindTexture(_e.TEXTURE_CUBE_MAP,G.skyboxTexture);const Re=((je,Be,et,Ze,Xe)=>({u_matrix:je,u_sun_direction:Be,u_cubemap:0,u_opacity:Ze,u_temporal_offset:Xe}))(Te.skyboxMatrix,G.getCenter(j,!1),0,Y,ne);j.uploadCommonUniforms(ve,Ce),Ce.draw(j,_e.TRIANGLES,X,Tr.disabled,j.colorModeForRenderPass(),mr.backCW,Re,"skybox",G.skyboxGeometry.vertexBuffer,G.skyboxGeometry.indexBuffer,G.skyboxGeometry.segment)}(h,l,L,v,$):E==="gradient"&&h.renderPass==="sky"&&function(j,G,X,Y,ne){const ve=j.context,_e=ve.gl,Te=j.transform,Ce=j.getOrCreateProgram("skyboxGradient");G.skyboxGeometry||(G.skyboxGeometry=new Of(ve)),ve.activeTexture.set(_e.TEXTURE0);let Re=G.colorRampTexture;Re||(Re=G.colorRampTexture=new r.T(ve,G.colorRamp,_e.RGBA8)),Re.bind(_e.LINEAR,_e.CLAMP_TO_EDGE);const je=((Be,et,Ze,Xe,Ke)=>({u_matrix:Be,u_color_ramp:0,u_center_direction:et,u_radius:r.ai(Ze),u_opacity:Xe,u_temporal_offset:Ke}))(Te.skyboxMatrix,G.getCenter(j,!1),G.paint.get("sky-gradient-radius"),Y,ne);j.uploadCommonUniforms(ve,Ce),Ce.draw(j,_e.TRIANGLES,X,Tr.disabled,j.colorModeForRenderPass(),mr.backCW,je,"skyboxGradient",G.skyboxGeometry.vertexBuffer,G.skyboxGeometry.indexBuffer,G.skyboxGeometry.segment)}(h,l,L,v,$)},debug:function(h,i,l,m,v,x){for(let E=0;E<l.length;E++)if(v){const j=new r.aj(m.r*.8,m.g*.8,m.b*.8,1);ud(h,i,l[E],m,-1,-1,x),ud(h,i,l[E],m,-1,1,x),ud(h,i,l[E],m,1,1,x),ud(h,i,l[E],m,1,-1,x),ud(h,i,l[E],j,0,0,x)}else ud(h,i,l[E],m,0,0,x)},custom:function(h,i,l,m){const v=h.context,x=l.implementation;if(!h.transform.projection.unsupportedLayers||!h.transform.projection.unsupportedLayers.includes("custom")||h.terrain&&(h.terrain.renderingToTexture||h.renderPass==="offscreen")&&l.isDraped(i)){if(h.renderPass==="offscreen"){const E=x.prerender;if(E){if(h.setCustomLayerDefaults(),v.setColorMode(h.colorModeForRenderPass()),h.transform.projection.name==="globe"){const L=h.transform.pointMerc;E.call(x,v.gl,h.transform.customLayerMatrix(),h.transform.getProjection(),h.transform.globeToMercatorMatrix(),r.ae(h.transform.zoom),[L.x,L.y],h.transform.pixelsPerMeterRatio)}else E.call(x,v.gl,h.transform.customLayerMatrix());v.setDirty(),h.setBaseState()}}else if(h.renderPass==="translucent"){if(h.terrain&&h.terrain.renderingToTexture){const L=x.renderToTile;if(L){const $=m[0].canonical,j=new r.aa($.x+m[0].wrap*(1<<$.z),$.y,$.z);v.setDepthMode(nr.disabled),v.setStencilMode(Tr.disabled),v.setColorMode(h.colorModeForRenderPass()),h.setCustomLayerDefaults(),L.call(x,v.gl,j),v.setDirty(),h.setBaseState()}return}h.setCustomLayerDefaults(),v.setColorMode(h.colorModeForRenderPass()),v.setStencilMode(Tr.disabled);const E=x.renderingMode==="3d"?new nr(h.context.gl.LEQUAL,nr.ReadWrite,h.depthRangeFor3D):h.depthModeForSublayer(0,nr.ReadOnly);if(v.setDepthMode(E),h.transform.projection.name==="globe"){const L=h.transform.pointMerc;x.render(v.gl,h.transform.customLayerMatrix(),h.transform.getProjection(),h.transform.globeToMercatorMatrix(),r.ae(h.transform.zoom),[L.x,L.y],h.transform.pixelsPerMeterRatio)}else x.render(v.gl,h.transform.customLayerMatrix());v.setDirty(),h.setBaseState(),v.bindFramebuffer.set(null)}}else r.w("Custom layers are not yet supported with this projection. Use mercator or globe to enable usage of custom layers.")},model:function(h,i,l,m){if(h.renderPass==="opaque")return;const v=l.paint.get("model-opacity").constantOr(1);if(v===0)return;const x=l.paint.get("model-cast-shadows");if(h.renderPass==="shadow"&&(!x||h.terrain&&v<.65&&l._transitionablePaint._values["model-opacity"].value.expression instanceof r.a9))return;const E=h.shadowRenderer,L=l.paint.get("model-receive-shadows");E&&(E.useNormalOffset=!0,L||(E.enabled=!1));const $=()=>{E&&(E.useNormalOffset=!0,L||(E.enabled=!0))},j=i.getSource();if(h.renderPass==="light-beam"&&j.type!=="batched-model")return;if(j.type==="vector"||j.type==="geojson")return function(Ce,Re,je,Be,et){const Ze=Ce.transform;if(Ze.projection.name!=="mercator")return void r.w(`Drawing 3D models for ${Ze.projection.name} projection is not yet implemented`);const Xe=Ze.getFreeCameraOptions().position;if(!Ce.modelManager)return;const Ke=Ce.modelManager;je.modelManager=Ke;const at=Ce.shadowRenderer;if(!je._unevaluatedLayout._values.hasOwnProperty("model-id"))return;const pt=je._unevaluatedLayout._values["model-id"],Vt={...je.layout.get("model-id").parameters},Rt=Ce.style.order.indexOf(je.fqid);for(const ht of Be){const St=Re.getTile(ht).getBucket(je);if(!St||St.projection.name!==Ze.projection.name)continue;const en=St.getModelUris();en&&!St.modelsRequested&&(Ke.addModelsFromBucket(en,et),St.modelsRequested=!0);const hn=qg(ht,Ze);Vt.zoom=hn;const vn=pt.possiblyEvaluate(Vt);if(fd(Ce,St,ht),ha.shadowUniformsInitialized=!1,ha.useSingleShadowCascade=!!at&&at.getMaxCascadeForTile(ht.toUnwrapped())===0,Ce.renderPass==="shadow"&&at){if(Ce.currentShadowCascade===1&&St.isInsideFirstShadowMapFrustum)continue;const Ht=Ze.calculatePosMatrix(ht.toUnwrapped(),Ze.worldSize);if(ha.tileMatrix.set(Ht),ha.shadowTileMatrix=Float32Array.from(at.calculateShadowPassMatrixFromMatrix(Ht)),ha.aabb.min.fill(0),ha.aabb.max[0]=ha.aabb.max[1]=r.ag,ha.aabb.max[2]=0,_u(St,ha,Ce,je.scope))continue}const It=1<<ht.canonical.z,ln=[((Xe.x-ht.wrap)*It-ht.canonical.x)*r.ag,(Xe.y*It-ht.canonical.y)*r.ag,Xe.z*It*r.ag];Ce.conflationActive&&Object.keys(St.instancesPerModel).length>0&&Ce.style.isLayerClipped(je,Re.getSource())&&St.updateReplacement(ht,Ce.replacementSource,Rt,et)&&(St.uploaded=!1,St.upload(Ce.context));for(let Ht in St.instancesPerModel){const gn=St.instancesPerModel[Ht];gn.features.length>0&&(Ht=vn.evaluate(gn.features[0].feature,{}));const cn=Ke.getModel(Ht,et);if(cn&&cn.uploaded)for(const tn of cn.nodes)Al(Ce,je,tn,gn,ln,ht,ha)}}}(h,i,l,m,j.type==="vector"?l.scope:""),void $();if(!j.loaded())return;if(j.type==="batched-model")return function(Ce,Re,je,Be){je.resetLayerRenderingStats(Ce);const et=Ce.context,Ze=Ce.transform,Xe=Ce.style.fog,Ke=Ce.shadowRenderer;if(Ze.projection.name!=="mercator")return void r.w(`Drawing 3D landmark models for ${Ze.projection.name} projection is not yet implemented`);const at=Ce.transform.getFreeCameraOptions().position,pt=r.ab.vec3.scale([],[at.x,at.y,at.z],Ce.transform.worldSize),Vt=r.ab.vec3.negate([],pt),Rt=r.ab.mat4.identity([]),ht=r.dj(Ze.center.lat,Ze.zoom),St=r.ab.mat4.fromScaling([],[1,1,1/ht]);r.ab.mat4.translate(Rt,Rt,Vt);const en=je.paint.get("model-opacity").constantOr(1),hn=new nr(et.gl.LEQUAL,nr.ReadWrite,Ce.depthRangeFor3D),vn=new nr(et.gl.LEQUAL,nr.ReadOnly,Ce.depthRangeFor3D),It=new r.cd([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),ln=Ce.renderPass==="shadow",Ht=ln&&Ke?Ke.getCurrentCascadeFrustum():Ze.getFrustum(Ze.scaleZoom(Ze.worldSize)),gn=je.paint.get("model-front-cutoff"),cn=gn[2]<1,tn=Tl(Ce,je.paint.get("model-cutoff-fade-range")),Rn=je.getLayerRenderingStats();(function(Dn,An,Bn,br){const ir=Dn.terrain?Dn.terrain.exaggeration():0,rr=Dn.transform.zoom;for(const wr of br){const Gr=An.getTile(wr).getBucket(Bn);Gr&&(Dn.conflationActive&&Gr.updateReplacement(wr,Dn.replacementSource),Gr.evaluateScale(Dn,Bn),Dn.terrain&&ir>0&&Gr.elevationUpdate(Dn.terrain,ir,wr,Bn.source),Gr.needsReEvaluation(Dn,rr,Bn)&&Gr.evaluate(Bn))}})(Ce,Re,je,Be),function(){let Dn,An,Bn;cn?(Dn=Be.length-1,An=-1,Bn=-1):(Dn=0,An=Be.length,Bn=1);const br=new Float64Array(16),ir=r.ab.vec3.create(),rr=new r.P(0,0);for(let wr=Dn;wr!==An;wr+=Bn){const Gr=Be[wr],Or=Re.getTile(Gr).getBucket(je);if(!Or||!Or.uploaded)continue;let Ui=!1;Ke&&(Ui=Ke.getMaxCascadeForTile(Gr.toUnwrapped())===0);const ki=Ze.calculatePosMatrix(Gr.toUnwrapped(),Ze.worldSize),li=Or.modelTraits;!ln&&cn&&(r.ab.mat4.invert(br,ki),r.ab.vec3.transformMat4(ir,pt,br),rr.x=ir[0],rr.y=ir[1]);const mi=[];for(const Lr of Or.getNodesInfo()){if(Lr.hiddenByReplacement||!Lr.node.meshes)continue;const Kr=Lr.node;let fr=0;Ce.terrain&&Kr.elevation&&(fr=Kr.elevation*Ce.terrain.exaggeration());const ni=(()=>{const Zr=Lr.aabb;return It.min=[...Zr.min],It.max=[...Zr.max],It.min[2]+=fr,It.max[2]+=fr,r.ab.vec3.transformMat4(It.min,It.min,ki),r.ab.vec3.transformMat4(It.max,It.max,ki),It})(),Ki=Lr.evaluatedScale;if(Ki[0]<=1&&Ki[1]<=1&&Ki[2]<=1&&ni.intersects(Ht)===0)continue;if(!ln&&cn){const Zr=.16666666666666666;Lr.cameraCollisionOpacity=pt[0]>ni.min[0]&&pt[0]<ni.max[0]&&pt[1]>ni.min[1]&&pt[1]<ni.max[1]&&pt[2]*ht<ni.max[2]&&Kr.footprint&&r.bA(rr,Kr.footprint)?Math.max(Lr.cameraCollisionOpacity-Zr,0):Math.min(1,Lr.cameraCollisionOpacity+Zr)}const Do=[...ki],Rs=Kr.anchor?Kr.anchor[0]:0,Zo=Kr.anchor?Kr.anchor[1]:0;r.ab.mat4.translate(Do,Do,[Rs*(Ki[0]-1),Zo*(Ki[1]-1),fr]),r.ab.vec3.exactEquals(Ki,r.dm)||r.ab.mat4.scale(Do,Do,Ki);const Io=r.ab.mat4.multiply([],Do,Kr.matrix),ho=r.ab.mat4.multiply([],Ze.expandedFarZProjMatrix,Io),to=r.ab.mat4.multiply([],Ze.expandedFarZProjMatrix,Do),Ni=r.ab.vec4.transformMat4([],[Rs,Zo,fr,1],ho)[2];Kr.hidden=!1;let Ci=en;ln||(cn&&(Ci*=Lr.cameraCollisionOpacity,Ci*=Cp(Do,Ze,Lr.aabb,gn)),Ci*=Tp(tn,Ni)),Ci!==0?mi.push({nodeInfo:Lr,depth:Ni,opacity:Ci,wvpForNode:ho,wvpForTile:to,nodeModelMatrix:Io,tileModelMatrix:Do}):Kr.hidden=!0}ln||mi.sort((Lr,Kr)=>!cn||Lr.opacity===1&&Kr.opacity===1?Lr.depth<Kr.depth?-1:1:Lr.opacity===1?-1:Kr.opacity===1?1:Lr.depth>Kr.depth?-1:1);for(const Lr of mi){const Kr=Lr.nodeInfo,fr=Kr.node;let ni=r.ab.mat4.multiply([],St,Lr.tileModelMatrix);r.ab.mat4.multiply(ni,Rt,ni);const Ki=r.ab.mat4.invert([],ni);r.ab.mat4.transpose(Ki,Ki),r.ab.mat4.scale(Ki,Ki,gu),ni=r.ab.mat4.multiply(ni,ni,fr.matrix);const Do=Ce.renderPass==="light-beam",Rs=je.paint.get("model-color-use-theme").constantOr("default")==="none",Zo=li&r.dp.HasMapboxMeshFeatures,Io=Zo?0:Kr.evaluatedRMEA[0][2];for(let ho=0;ho<fr.meshes.length;++ho){const to=fr.meshes[ho],Ni=ho===fr.lightMeshIndex;let Ci=Lr.wvpForNode;if(Ni){if(!Do&&!Ce.terrain&&Ce.shadowRenderer){Ce.currentLayer<Ce.firstLightBeamLayer&&(Ce.firstLightBeamLayer=Ce.currentLayer);continue}Ci=Lr.wvpForTile}else if(Do)continue;const Zr={defines:[]},Xi=[];if(!ln&&Ke&&(Ke.useNormalOffset=!!to.normalBuffer),ti(Zr.defines,Xi,to,Ce,Rs?null:je.lut),Zo||Zr.defines.push("DIFFUSE_SHADED"),Ui&&Zr.defines.push("SHADOWS_SINGLE_CASCADE"),Rn&&(ln?Rn.numRenderedVerticesInShadowPass+=to.vertexArray.length:Rn.numRenderedVerticesInTransparentPass+=to.vertexArray.length),ln){dd(to,Lr.nodeModelMatrix,Ce,je);continue}let Ao=null;if(Xe){const Qa=Fi(Lr.nodeModelMatrix,Ce.transform);if(Ao=new Float32Array(Qa),Ze.projection.name!=="globe"){const Yo=to.aabb.min,Hs=to.aabb.max,[Ll,za]=Xe.getOpacityForBounds(Qa,Yo[0],Yo[1],Hs[0],Hs[1]);Zr.overrideFog=Ll>=Mn||za>=Mn}}const Pi=to.material;let jo;Pi.occlusionTexture&&Pi.occlusionTexture.offsetScale&&(jo=Pi.occlusionTexture.offsetScale,Zr.defines.push("OCCLUSION_TEXTURE_TRANSFORM"));const js=Ce.getOrCreateProgram("model",Zr);!ln&&Ke&&Ke.setupShadowsFromMatrix(Lr.tileModelMatrix,js,Ke.useNormalOffset),Ce.uploadCommonUniforms(et,js,null,Ao);const hs=Pi.pbrMetallicRoughness;hs.metallicFactor=.9,hs.roughnessFactor=.5;const Ol=bp(new Float32Array(Ci),new Float32Array(ni),new Float32Array(Ki),new Float32Array(fr.matrix),Ce,Lr.opacity,hs.baseColorFactor.toRenderColor(null),Pi.emissiveFactor,hs.metallicFactor,hs.roughnessFactor,Pi,Io,je,[0,0,0],jo);!Ni&&(Kr.hasTranslucentParts||Lr.opacity<1)&&js.draw(Ce,et.gl.TRIANGLES,hn,Tr.disabled,zr.disabled,mr.backCCW,Ol,je.id,to.vertexBuffer,to.indexBuffer,to.segments,je.paint,Ce.transform.zoom,void 0,Xi),js.draw(Ce,et.gl.TRIANGLES,Ni?vn:hn,Tr.disabled,Ni||Lr.opacity<1||Kr.hasTranslucentParts?zr.alphaBlended:zr.unblended,mr.backCCW,Ol,je.id,to.vertexBuffer,to.indexBuffer,to.segments,je.paint,Ce.transform.zoom,void 0,Xi)}}}}()}(h,i,l,m),void $();if(j.type!=="model")return;const G=j.getModels(),X=[],Y=h.transform.getFreeCameraOptions().position,ne=r.ab.vec3.scale([],[Y.x,Y.y,Y.z],h.transform.worldSize);r.ab.vec3.negate(ne,ne);const ve=[],_e=[];let Te=0;for(const Ce of G){const Re=l.paint.get("model-rotation").constantOr(null),je=l.paint.get("model-scale").constantOr(null),Be=l.paint.get("model-translation").constantOr(null);Ce.computeModelMatrix(h,Re,je,Be,!0,!0,!1);const et=r.ab.mat4.identity([]),Ze=r.dj(Ce.position.lat,h.transform.zoom),Xe=r.ab.mat4.fromScaling([],[1,1,1/Ze]);r.ab.mat4.translate(et,et,ne),X.push({zScaleMatrix:Xe,negCameraPosMatrix:et});for(const Ke of Ce.nodes)Il(h.transform,Ke,Ce.matrix,h.transform.expandedFarZProjMatrix,Te,ve,_e);Te++}if(ve.sort((Ce,Re)=>Re.depth-Ce.depth),h.renderPass!=="shadow"){if(v===1)for(const Ce of _e)Df(Ce,h,l,X[Ce.modelIndex],Tr.disabled,h.colorModeForRenderPass());else{for(const Ce of _e)Df(Ce,h,l,X[Ce.modelIndex],Tr.disabled,zr.disabled);for(const Ce of _e)Df(Ce,h,l,X[Ce.modelIndex],h.stencilModeFor3D(),h.colorModeForRenderPass());h.resetStencilClippingMasks()}for(const Ce of ve)Df(Ce,h,l,X[Ce.modelIndex],Tr.disabled,h.colorModeForRenderPass());$()}else{for(const Ce of _e)dd(Ce.mesh,Ce.nodeModelMatrix,h,l);for(const Ce of ve)dd(Ce.mesh,Ce.nodeModelMatrix,h,l);$()}}},Ip={model:function(h,i,l){const m=i.getSource();if(!m.loaded())return;if(m.type==="vector"||m.type==="geojson")return void(l.modelManager&&l.modelManager.upload(l,m.type==="vector"?h.scope:""));if(m.type==="batched-model"||m.type!=="model")return;const v=m.getModels();for(const x of v)x.upload(l.context)},raster:function(h,i,l){const m=i.getSource();if(!(m instanceof yl&&m.loaded()))return;const v=h.sourceLayer||m.rasterLayerIds&&m.rasterLayerIds[0];if(!v)return;const x=h.paint.get("raster-array-band")||m.getInitialBand(v);if(x==null)return;const E=i.getIds().map(L=>i.getTileByID(L));for(const L of E)L.updateNeeded(v,x)&&m.prepareTile(L,v,x)},"raster-particle":function(h,i,l){const m=i.getSource();if(!(m instanceof yl&&m.loaded()))return;const v=h.sourceLayer||m.rasterLayerIds&&m.rasterLayerIds[0];if(!v)return;const x=h.paint.get("raster-particle-array-band")||m.getInitialBand(v);if(x==null)return;const E=i.getIds().map(L=>i.getTileByID(L));for(const L of E)L.updateNeeded(v,x)&&m.prepareTile(L,v,x)}};class r_{constructor(i,l,m,v,x){this.context=new Ms(i,l),this.transform=m,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.tp=x,this._timeStamp=r.q.now(),this._averageFPS=0,this._fpsHistory=[],this._dt=0,this._debugParams={forceEnablePrecipitation:!1,showTerrainProxyTiles:!1,fpsWindow:30,continousRedraw:!1,enabledLayers:{}};const E=["fill","line","symbol","circle","heatmap","fill-extrusion","raster","raster-particle","hillshade","model","background","sky"];for(const $ of E)this._debugParams.enabledLayers[$]=!0;x.registerParameter(this._debugParams,["Terrain"],"showTerrainProxyTiles",{},()=>{this.style.map.triggerRepaint()}),x.registerParameter(this._debugParams,["Precipitation"],"forceEnablePrecipitation"),x.registerParameter(this._debugParams,["FPS"],"fpsWindow",{min:1,max:100,step:1}),x.registerBinding(this._debugParams,["FPS"],"continousRedraw",{readonly:!0,label:"continuous redraw"}),x.registerBinding(this,["FPS"],"_averageFPS",{readonly:!0,label:"value"}),x.registerBinding(this,["FPS"],"_averageFPS",{readonly:!0,label:"graph",view:"graph",min:0,max:200});for(const $ of E)x.registerParameter(this._debugParams.enabledLayers,["Debug","Layers"],$);this.occlusionParams=new Yg(x),this.setup(),this.numSublayers=ua.maxUnderzooming+ua.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={},this.conflationActive=!1,this.replacementSource=new r.dv,this.longestCutoffRange=0,this.minCutoffZoom=0,this._fogVisible=!1,this._cachedTileFogOpacities={},this._shadowRenderer=new Cl(this),this._wireframeDebugCache=new Zg,this.renderDefaultNorthPole=!0,this.renderDefaultSouthPole=!0,this.layersWithOcclusionOpacity=[];const L=new r.r({width:1,height:1},Uint8Array.of(0,0,0,0));this.emptyDepthTexture=new r.T(this.context,L,i.RGBA8),this._clippingActiveLastFrame=!1,this.scaleFactor=v}updateTerrain(i,l){const m=!!i&&!!i.terrain&&this.transform.projection.supportsTerrain;if(!(m||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new dp(this,i));const v=this._terrain;this.transform.elevation=m?v:null,v.update(i,this.transform,l),this.transform.elevation&&!v.enabled&&(this.transform.elevation=null)}_updateFog(i){const l=i.fog;if(!l||this.transform.projection.name==="globe"||l.getOpacity(this.transform.pitch)<1||l.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[m,v]=l.getFovAdjustedRange(this.transform._fov);if(m>v)return void(this.transform.fogCullDistSq=null);const x=m+.78*(v-m);this.transform.fogCullDistSq=x*x}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled||this._forceTerrainMode?this._terrain:null}get forceTerrainMode(){return this._forceTerrainMode}set forceTerrainMode(i){i&&!this._terrain&&(this._terrain=new dp(this,this.style)),this._forceTerrainMode=i}get shadowRenderer(){return this._shadowRenderer&&this._shadowRenderer.enabled?this._shadowRenderer:null}get wireframeDebugCache(){return this._wireframeDebugCache}resize(i,l){if(this.width=i*r.q.devicePixelRatio,this.height=l*r.q.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const m of this.style.order)this.style._mergedLayers[m].resize()}setup(){const i=this.context,l=new r.b4;l.emplaceBack(0,0),l.emplaceBack(r.ag,0),l.emplaceBack(0,r.ag),l.emplaceBack(r.ag,r.ag),this.tileExtentBuffer=i.createVertexBuffer(l,r.b6.members),this.tileExtentSegments=r.b7.simpleSegment(0,0,4,2);const m=new r.b4;m.emplaceBack(0,0),m.emplaceBack(r.ag,0),m.emplaceBack(0,r.ag),m.emplaceBack(r.ag,r.ag),this.debugBuffer=i.createVertexBuffer(m,r.b6.members),this.debugSegments=r.b7.simpleSegment(0,0,4,5);const v=new r.b4;v.emplaceBack(-1,-1),v.emplaceBack(1,-1),v.emplaceBack(-1,1),v.emplaceBack(1,1),this.viewportBuffer=i.createVertexBuffer(v,r.b6.members),this.viewportSegments=r.b7.simpleSegment(0,0,4,2);const x=new r.aT;x.emplaceBack(0,0,0,0),x.emplaceBack(r.ag,0,r.ag,0),x.emplaceBack(0,r.ag,0,r.ag),x.emplaceBack(r.ag,r.ag,r.ag,r.ag),this.mercatorBoundsBuffer=i.createVertexBuffer(x,r.b9.members),this.mercatorBoundsSegments=r.b7.simpleSegment(0,0,4,2);const E=new r.aU;E.emplaceBack(0,1,2),E.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=i.createIndexBuffer(E);const L=new r.b5;for(const j of[0,1,3,2,0])L.emplaceBack(j);this.debugIndexBuffer=i.createIndexBuffer(L),this.emptyTexture=new r.T(i,new r.r({width:1,height:1},Uint8Array.of(0,0,0,0)),i.gl.RGBA8),this.identityMat=r.ab.mat4.create();const $=this.context.gl;this.stencilClearMode=new Tr({func:$.ALWAYS,mask:0},0,255,$.ZERO,$.ZERO,$.ZERO),this.loadTimeStamps.push(performance.now())}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(i){return i._makeTileBoundsBuffers(this.context,this.transform.projection),i._tileBoundsBuffer?{tileBoundsBuffer:i._tileBoundsBuffer,tileBoundsIndexBuffer:i._tileBoundsIndexBuffer,tileBoundsSegments:i._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const i=this.context.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.getOrCreateProgram("clippingMask").draw(this,i.TRIANGLES,nr.disabled,this.stencilClearMode,zr.disabled,mr.disabled,Ef(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(i,l,m){if(!l||this.currentStencilSource===l.id||!i.isTileClipped()||!m||m.length===0)return;if(this._tileClippingMaskIDs&&!this.terrain){let L=!1;for(const $ of m)if(this._tileClippingMaskIDs[$.key]===void 0){L=!0;break}if(!L)return}this.currentStencilSource=l.id;const v=this.context,x=v.gl;this.nextStencilID+m.length>256&&this.clearStencil(),v.setColorMode(zr.disabled),v.setDepthMode(nr.disabled);const E=this.getOrCreateProgram("clippingMask");this._tileClippingMaskIDs={};for(const L of m){const $=l.getTile(L),j=this._tileClippingMaskIDs[L.key]=this.nextStencilID++,{tileBoundsBuffer:G,tileBoundsIndexBuffer:X,tileBoundsSegments:Y}=this.getTileBoundsBuffers($);E.draw(this,x.TRIANGLES,nr.disabled,new Tr({func:x.ALWAYS,mask:0},j,255,x.KEEP,x.KEEP,x.REPLACE),zr.disabled,mr.disabled,Ef(L.projMatrix),"$clipping",G,X,Y)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const i=this.nextStencilID++,l=this.context.gl;return new Tr({func:l.NOTEQUAL,mask:255},i,255,l.KEEP,l.KEEP,l.REPLACE)}stencilModeForClipping(i){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(i);const l=this.context.gl;return new Tr({func:l.EQUAL,mask:255},this._tileClippingMaskIDs[i.key],0,l.KEEP,l.KEEP,l.REPLACE)}stencilConfigForOverlap(i){const l=this.context.gl,m=i.sort((E,L)=>L.overscaledZ-E.overscaledZ),v=m[m.length-1].overscaledZ,x=m[0].overscaledZ-v+1;if(x>1){this.currentStencilSource=void 0,this.nextStencilID+x>256&&this.clearStencil();const E={};for(let L=0;L<x;L++)E[L+v]=new Tr({func:l.GEQUAL,mask:255},L+this.nextStencilID,255,l.KEEP,l.KEEP,l.REPLACE);return this.nextStencilID+=x,[E,m]}return[{[v]:Tr.disabled},m]}colorModeForRenderPass(){const i=this.context.gl;return this._showOverdrawInspector?new zr([i.CONSTANT_COLOR,i.ONE,i.CONSTANT_COLOR,i.ONE],new r.aj(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?zr.unblended:zr.alphaBlended}colorModeForDrapableLayerRenderPass(i){const l=this.context.gl;return this.style&&this.style.enable3dLights()&&this.terrain&&this.terrain.renderingToTexture&&this.renderPass==="translucent"?new zr([l.ONE,l.ONE_MINUS_SRC_ALPHA,l.CONSTANT_ALPHA,l.ONE_MINUS_SRC_ALPHA],new r.aj(0,0,0,i===void 0?0:i),[!0,!0,!0,!0]):this.colorModeForRenderPass()}depthModeForSublayer(i,l,m,v=!1){if(this.depthOcclusion)return new nr(this.context.gl.GREATER,nr.ReadOnly,this.depthRangeFor3D);if(!this.opaquePassEnabledForLayer()&&!v)return nr.disabled;const x=1-((1+this.currentLayer)*this.numSublayers+i)*this.depthEpsilon;return new nr(m||this.context.gl.LEQUAL,l,[x,x])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}blitDepth(){const i=this.context.gl,l=Math.ceil(this.width),m=Math.ceil(this.height),v=this.context.bindFramebuffer.get(),x=i.getParameter(i.TEXTURE_BINDING_2D);this.depthFBO&&this.depthFBO.width===l&&this.depthFBO.height===m||(this.depthFBO&&(this.depthFBO.destroy(),this.depthFBO=void 0,this.depthTexture=void 0),l!==0&&m!==0&&(this.depthFBO=new xp(this.context,l,m,!1,"texture"),this.depthTexture=new r.T(this.context,{width:l,height:m,data:null},i.DEPTH24_STENCIL8),this.depthFBO.depthAttachment.set(this.depthTexture.texture))),this.context.bindFramebuffer.set(v),i.bindTexture(i.TEXTURE_2D,x),this.depthFBO&&(i.bindFramebuffer(i.READ_FRAMEBUFFER,null),i.bindFramebuffer(i.DRAW_FRAMEBUFFER,this.depthFBO.framebuffer),i.blitFramebuffer(0,0,l,m,0,0,l,m,i.DEPTH_BUFFER_BIT,i.NEAREST),i.bindFramebuffer(i.FRAMEBUFFER,this.context.bindFramebuffer.current))}updateAverageFPS(){this._fpsHistory.push(this._dt===0?0:1e3/this._dt),this._fpsHistory.length>this._debugParams.fpsWindow&&this._fpsHistory.splice(0,this._fpsHistory.length-this._debugParams.fpsWindow),this._averageFPS=Math.round(this._fpsHistory.reduce((i,l)=>i+l/this._fpsHistory.length,0))}render(i,l){const m=r.q.now();this._dt=m-this._timeStamp,this._timeStamp=m,this._wireframeDebugCache.update(this.frameCounter),this._debugParams.continousRedraw=i.map.repaint,this.style=i,this.options=l;const v=this.style._mergedLayers,x=this.style._getOrder(!(!this.terrain||!this.terrain.enabled)).filter(ht=>{const St=v[ht];return!(St.type in this._debugParams.enabledLayers)||this._debugParams.enabledLayers[St.type]});let E=!1,L=!1;for(const ht of x){const St=v[ht];St.type==="circle"&&(E=!0),St.type==="symbol"&&(St.hasInitialOcclusionOpacityProperties?L=!0:E=!0)}const $=x.map(ht=>v[ht]),j=this.style._mergedSourceCaches;this.imageManager=i.imageManager,this.modelManager=i.modelManager,this.symbolFadeChange=i.placement.symbolFadeChange(r.q.now()),this.imageManager.beginFrame();let G=0,X=!1;for(const ht in j){const St=j[ht];St.used&&(St.prepare(this.context),St.getSource().usedInConflation&&++G)}let Y=!1;for(const ht of $)ht.isHidden(this.transform.zoom)||(ht.type==="clip"&&(Y=!0),this.prepareLayer(ht));const ne={},ve={},_e={},Te={},Ce={};for(const ht in j){const St=j[ht];ne[ht]=St.getVisibleCoordinates(),ve[ht]=ne[ht].slice().reverse(),_e[ht]=St.getVisibleCoordinates(!0).reverse(),Te[ht]=St.getShadowCasterCoordinates(),Ce[ht]=St.sortCoordinatesByDistance(ne[ht])}const Re=ht=>{const St=this.style.getLayerSourceCache(ht);return St&&St.used?St.getSource():null};if(G||Y||this._clippingActiveLastFrame){const ht=[],St=[];let en=0;for(const hn of $)this.isSourceForClippingOrConflation(hn,Re(hn))&&(ht.push(hn),St.push(en)),en++;if(Y||ht.length>1||this._clippingActiveLastFrame){Y=!1;const hn=[];for(let vn=0;vn<ht.length;vn++){const It=ht[vn],ln=St[vn],Ht=this.style.getLayerSourceCache(It);if(!Ht||!Ht.used||!Ht.getSource().usedInConflation&&It.type!=="clip")continue;let gn=r.dx,cn=r.by.None;const tn=[];let Rn=!0;if(It.type==="clip"){gn=ln;for(const Dn of It.layout.get("clip-layer-types"))cn|=Dn==="model"?r.by.Model:Dn==="symbol"?r.by.Symbol:r.by.FillExtrusion;for(const Dn of It.layout.get("clip-layer-scope"))tn.push(Dn);It.isHidden(this.transform.zoom)?Rn=!1:Y=!0}Rn&&hn.push({layer:It.fqid,cache:Ht,order:gn,clipMask:cn,clipScope:tn})}this.replacementSource.setSources(hn),X=!0}}this._clippingActiveLastFrame=Y,X||this.replacementSource.clear(),this.conflationActive=X,this.minCutoffZoom=0,this.longestCutoffRange=0,this.opaquePassCutoff=1/0,this._lastOcclusionLayer=-1,this.layersWithOcclusionOpacity=[];for(let ht=0;ht<$.length;ht++){const St=$[ht],en=St.cutoffRange();if(this.longestCutoffRange=Math.max(en,this.longestCutoffRange),en>0){const hn=Re(St);hn&&(this.minCutoffZoom=Math.max(hn.minzoom,this.minCutoffZoom)),St.minzoom&&(this.minCutoffZoom=Math.max(St.minzoom,this.minCutoffZoom))}St.is3D()&&(this.opaquePassCutoff===1/0&&(this.opaquePassCutoff=ht),this._lastOcclusionLayer=ht)}const je=this.style&&this.style.fog;je?(this._fogVisible=je.getOpacity(this.transform.pitch)!==0,this._fogVisible&&this.transform.projection.name!=="globe"&&(this._fogVisible=je.isVisibleOnFrustum(this.transform.cameraFrustum))):this._fogVisible=!1,this._cachedTileFogOpacities={},this.terrain&&(this.terrain.updateTileBinding(_e),this.opaquePassCutoff=0);const Be=this._shadowRenderer;if(Be){Be.updateShadowParameters(this.transform,this.style.directionalLight);for(const ht in j)for(const St of ne[ht]){let en={min:0,max:0};this.terrain&&(en=this.terrain.getMinMaxForTile(St)||en),Be.addShadowReceiver(St.toUnwrapped(),en.min,en.max)}}this.transform.projection.name!=="globe"||this.globeSharedBuffers||(this.globeSharedBuffers=new r.dw(this.context)),this.style.fog&&this.transform.projection.supportsFog?(this._atmosphere||(this._atmosphere=new Lf(this)),this._atmosphere.update(this)):this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0);const et=this._debugParams.forceEnablePrecipitation||!(!this.style||!this.style.snow),Ze=this._debugParams.forceEnablePrecipitation||!(!this.style||!this.style.rain);if(et&&!this._snow&&(this._snow=new n_(this)),!et&&this._snow&&(this._snow.destroy(),delete this._snow),Ze&&!this._rain&&(this._rain=new e_(this)),!Ze&&this._rain&&(this._rain.destroy(),delete this._rain),this._snow&&this._snow.update(this),this._rain&&this._rain.update(this),!an.has(this.context.gl))return;this.renderPass="offscreen";for(const ht of $){const St=i.getLayerSourceCache(ht);if(!ht.hasOffscreenPass()||ht.isHidden(this.transform.zoom))continue;const en=St?ve[St.id]:void 0;(ht.type==="custom"||ht.type==="raster"||ht.type==="raster-particle"||ht.isSky()||en&&en.length)&&this.renderLayer(this,St,ht,en)}this.depthRangeFor3D=[0,1-($.length+2)*this.numSublayers*this.depthEpsilon],this._shadowRenderer&&(this.renderPass="shadow",this._shadowRenderer.drawShadowPass(this.style,Te)),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]);const Xe=this.transform.projection.name==="globe"||this.transform.isHorizonVisible(),Ke=(()=>{if(l.showOverdrawInspector)return r.aj.black;const ht=this.style.fog;if(ht&&this.transform.projection.supportsFog){const St=this.style.getLut(ht.scope);if(!Xe){const en=ht.properties.get("color-use-theme")==="none",hn=ht.properties.get("color").toRenderColor(en?null:St).toArray01();return new r.aj(...hn)}if(Xe){const en=ht.properties.get("space-color-use-theme")==="none",hn=ht.properties.get("space-color").toRenderColor(en?null:St).toArray01();return new r.aj(...hn)}}return r.aj.transparent})();if(this.context.clear({color:Ke,depth:1}),this.clearStencil(),this._showOverdrawInspector=l.showOverdrawInspector,this.renderPass="opaque",this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&Xe&&this._atmosphere.drawStars(this,this.style.fog),!this.terrain)for(this.currentLayer=x.length-1;this.currentLayer>=0;this.currentLayer--){const ht=$[this.currentLayer],St=i.getLayerSourceCache(ht);if(ht.isSky())continue;const en=St?(ht.is3D()?Ce:ve)[St.id]:void 0;this._renderTileClippingMasks(ht,St,en),this.renderLayer(this,St,ht,en)}if(this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&Xe&&this._atmosphere.drawAtmosphereGlow(this,this.style.fog),this.renderPass="sky",(!this._atmosphere||r.ae(this.transform.zoom)>0)&&(this.transform.projection.name==="globe"||this.transform.isHorizonVisible()))for(this.currentLayer=0;this.currentLayer<x.length;this.currentLayer++){const ht=$[this.currentLayer],St=i.getLayerSourceCache(ht);ht.isSky()&&this.renderLayer(this,St,ht,St?ve[St.id]:void 0)}function at(ht,St){let en;return St&&(en=(ht.type==="symbol"?_e:ht.is3D()?Ce:ve)[St.id]),en}if(this.renderPass="translucent",this.transform.projection.name==="globe"){for(this.renderElevatedRasterBackface=!0,this.currentLayer=0;this.currentLayer<x.length;){const ht=$[this.currentLayer];if(ht.type==="raster"||ht.type==="raster-particle"){const St=i.getLayerSourceCache(ht);this.renderLayer(this,St,ht,at(ht,St))}++this.currentLayer}this.renderElevatedRasterBackface=!1}this.currentLayer=0,this.firstLightBeamLayer=Number.MAX_SAFE_INTEGER;let pt=0;Be&&(pt=Be.getShadowCastingLayerCount());let Vt=!1,Rt=-1;for(let ht=0;ht<x.length;++ht){const St=$[ht];St.isHidden(this.transform.zoom)||St.is3D()&&(Rt=ht)}for(L&&Rt===-1&&(E=!0);this.currentLayer<x.length;){const ht=$[this.currentLayer],St=i.getLayerSourceCache(ht);if(ht.isSky())++this.currentLayer;else if(this.terrain&&this.style.isLayerDraped(ht)){if(ht.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer),this._lastOcclusionLayer=Math.max(this.currentLayer,this._lastOcclusionLayer)}else{if(E&&!Vt&&this.terrain&&!this.transform.isOrthographic&&(Vt=!0,this.blitDepth()),L&&Rt!==-1&&this.currentLayer===Rt+1&&!this.transform.isOrthographic&&this.blitDepth(),ht.is3D()||this.terrain||this._renderTileClippingMasks(ht,St,St?ne[St.id]:void 0),this.renderLayer(this,St,ht,at(ht,St)),!this.terrain&&Be&&pt>0&&ht.hasShadowPass()&&--pt==0&&(Be.drawGroundShadows(),this.firstLightBeamLayer<=this.currentLayer)){const en=this.currentLayer;for(this.renderPass="light-beam",this.currentLayer=this.firstLightBeamLayer;this.currentLayer<=en;this.currentLayer++){const hn=$[this.currentLayer];if(!hn.hasLightBeamPass())continue;const vn=i.getLayerSourceCache(hn);this.renderLayer(this,vn,hn,vn?ve[vn.id]:void 0)}this.currentLayer=en,this.renderPass="translucent"}if(this.currentLayer>=this._lastOcclusionLayer&&this.layersWithOcclusionOpacity.length>0){const en=this.currentLayer;this.depthOcclusion=!0;for(const hn of this.layersWithOcclusionOpacity){this.currentLayer=hn;const vn=$[this.currentLayer],It=i.getLayerSourceCache(vn),ln=It?ve[It.id]:void 0;vn.is3D()||this.terrain||this._renderTileClippingMasks(vn,It,It?ne[It.id]:void 0),this.renderLayer(this,It,vn,ln)}this.depthOcclusion=!1,this.currentLayer=en,this.renderPass="translucent",this.layersWithOcclusionOpacity=[]}++this.currentLayer}}if(this.terrain&&this.terrain.postRender(),this._snow&&this._snow.draw(this),this._rain&&this._rain.draw(this),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let ht=null;$.forEach(St=>{const en=i.getLayerSourceCache(St);en&&!St.isHidden(this.transform.zoom)&&en.getVisibleCoordinates().length&&(!ht||ht.getSource().maxzoom<en.getSource().maxzoom)&&(ht=en)}),ht&&this.options.showTileBoundaries&&kl.debug(this,ht,ht.getVisibleCoordinates(),r.aj.red,!1,this.options.showParseStatus)}this.terrain&&this._debugParams.showTerrainProxyTiles&&kl.debug(this,this.terrain.proxySourceCache,this.terrain.proxyCoords,new r.aj(1,.8,.1,1),!0,this.options.showParseStatus),this.options.showPadding&&function(ht){const St=ht.transform.padding;Wg(ht,ht.transform.height-(St.top||0),3,o0),Wg(ht,St.bottom||0,3,s0),Rf(ht,St.left||0,3,a0),Rf(ht,ht.transform.width-(St.right||0),3,ld);const en=ht.transform.centerPoint;(function(hn,vn,It,ln){cd(hn,vn-1,It-10,2,20,ln),cd(hn,vn-10,It-1,20,2,ln)})(ht,en.x,ht.transform.height-en.y,hw)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(performance.now()),this.saveCanvasCopy()),X||(this.conflationActive=!1)}prepareLayer(i){this.gpuTimingStart(i);const{unsupportedLayers:l}=this.transform.projection,m=!l||!l.includes(i.type);if(Ip[i.type]&&(m||this.terrain&&i.type==="custom")){const v=this.style.getLayerSourceCache(i);Ip[i.type](i,v,this)}this.gpuTimingEnd()}renderLayer(i,l,m,v){m.isHidden(this.transform.zoom)||(m.type==="background"||m.type==="sky"||m.type==="custom"||m.type==="model"||m.type==="raster"||m.type==="raster-particle"||v&&v.length)&&(this.id=m.id,this.gpuTimingStart(m),i.transform.projection.unsupportedLayers&&i.transform.projection.unsupportedLayers.includes(m.type)&&(!i.terrain||m.type!=="custom")||m.type==="clip"||kl[m.type](i,l,m,v,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(i){if(!this.options.gpuTiming)return;const l=this.context.extTimerQuery,m=this.context.gl;let v=this.gpuTimers[i.id];v||(v=this.gpuTimers[i.id]={calls:0,cpuTime:0,query:m.createQuery()}),v.calls++,m.beginQuery(l.TIME_ELAPSED_EXT,v.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const i=this.context.extTimerQuery,l=this.context.gl,m=l.createQuery();this.deferredRenderGpuTimeQueries.push(m),l.beginQuery(i.TIME_ELAPSED_EXT,m)}}gpuTimingDeferredRenderEnd(){this.options.gpuTimingDeferredRender&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}gpuTimingEnd(){this.options.gpuTiming&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}collectGpuTimers(){const i=this.gpuTimers;return this.gpuTimers={},i}collectDeferredRenderGpuQueries(){const i=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],i}queryGpuTimers(i){const l={};for(const m in i){const v=i[m],x=this.context.extTimerQuery,E=x.getQueryParameter(v.query,this.context.gl.QUERY_RESULT)/1e6;x.deleteQueryEXT(v.query),l[m]=E}return l}queryGpuTimeDeferredRender(i){if(!this.options.gpuTimingDeferredRender)return 0;const l=this.context.gl;let m=0;for(const v of i)m+=l.getQueryParameter(v,l.QUERY_RESULT)/1e6,l.deleteQuery(v);return m}translatePosMatrix(i,l,m,v,x){if(!m[0]&&!m[1])return i;const E=x?v==="map"?this.transform.angle:0:v==="viewport"?-this.transform.angle:0;if(E){const j=Math.sin(E),G=Math.cos(E);m=[m[0]*G-m[1]*j,m[0]*j+m[1]*G]}const L=[x?m[0]:r.ar(l,m[0],this.transform.zoom),x?m[1]:r.ar(l,m[1],this.transform.zoom),0],$=new Float32Array(16);return r.ab.mat4.translate($,i,L),$}saveTileTexture(i){const l=i.size[0],m=this._tileTextures[l];m?m.push(i):this._tileTextures[l]=[i]}getTileTexture(i){const l=this._tileTextures[i];return l&&l.length>0?l.pop():null}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture||this.forceTerrainMode}linearFloatFilteringSupported(){return this.context.extTextureFloatLinear!=null}currentGlobalDefines(i,l,m){const v=m===void 0?this.terrain&&this.terrain.renderingToTexture:m,x=[];return this.style&&this.style.enable3dLights()&&(i==="globeRaster"||i==="terrainRaster"?(x.push("LIGHTING_3D_MODE"),x.push("LIGHTING_3D_ALPHA_EMISSIVENESS")):v||x.push("LIGHTING_3D_MODE")),this.renderPass==="shadow"&&(this._shadowMapDebug||x.push("DEPTH_TEXTURE")),this.terrainRenderModeElevated()&&(x.push("TERRAIN"),this.linearFloatFilteringSupported()&&x.push("TERRAIN_DEM_FLOAT_FORMAT")),this.transform.projection.name==="globe"&&x.push("GLOBE"),!this._fogVisible||v||l!==void 0&&!l||x.push("FOG","FOG_DITHERING"),v&&x.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&x.push("OVERDRAW_INSPECTOR"),x}getOrCreateProgram(i,l){this.cache=this.cache||{};const m=l&&l.defines||[],v=l&&l.config,x=this.currentGlobalDefines(i,l&&l.overrideFog,l&&l.overrideRtt).concat(m),E=qv.cacheKey(Tg[i],i,x,v);return this.cache[E]||(this.cache[E]=new qv(this.context,i,Tg[i],v,dw[i],x)),this.cache[E]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const i=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(i.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new r.T(this.context,this.debugOverlayCanvas,this.context.gl.RGBA8))}destroy(){this._terrain&&this._terrain.destroy(),this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this._wireframeDebugCache.destroy(),this.depthFBO&&(this.depthFBO.destroy(),this.depthFBO=void 0,this.depthTexture=void 0),this.emptyDepthTexture&&this.emptyDepthTexture.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}uploadCommonLightUniforms(i,l){if(this.style.enable3dLights()){const m=this.style.directionalLight,v=this.style.ambientLight;if(m&&v){const x=((E,L,$)=>{const j=E.properties.get("direction"),G=E.properties.get("color-use-theme")==="none",X=E.properties.get("color").toRenderColor(G?null:$.getLut(E.scope)).toArray01(),Y=E.properties.get("intensity"),ne=L.properties.get("color-use-theme")==="none",ve=L.properties.get("color").toRenderColor(ne?null:$.getLut(L.scope)).toArray01(),_e=L.properties.get("intensity"),Te=[j.x,j.y,j.z],Ce=r.cM(ve,_e),Re=r.cM(X,Y);return{u_lighting_ambient_color:Ce,u_lighting_directional_dir:Te,u_lighting_directional_color:Re,u_ground_radiance:lw(Te,Re,Ce)}})(m,v,this.style);l.setLightsUniformValues(i,x)}}}uploadCommonUniforms(i,l,m,v,x){if(this.uploadCommonLightUniforms(i,l),this.terrain&&this.terrain.renderingToTexture)return;const E=this.style.fog;if(E){const L=E.getOpacity(this.transform.pitch),$=((j,G,X,Y,ne,ve,_e,Te,Ce,Re,je,Be)=>{const et=j.transform,Ze=G.properties.get("color-use-theme")==="none",Xe=G.properties.get("color").toRenderColor(Ze?null:j.style.getLut(G.scope)).toArray01();Xe[3]=Y;const Ke=j.frameCounter/1e3%1,[at,pt]=G.properties.get("vertical-range");return{u_fog_matrix:X?et.calculateFogTileMatrix(X):Be||j.identityMat,u_fog_range:G.getFovAdjustedRange(et._fov),u_fog_color:Xe,u_fog_horizon_blend:G.properties.get("horizon-blend"),u_fog_vertical_limit:[Math.min(at,pt),pt],u_fog_temporal_offset:Ke,u_frustum_tl:ne,u_frustum_tr:ve,u_frustum_br:_e,u_frustum_bl:Te,u_globe_pos:Ce,u_globe_radius:Re,u_viewport:je,u_globe_transition:r.ae(et.zoom),u_is_globe:+(et.projection.name==="globe")}})(this,E,m,L,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*r.q.devicePixelRatio,this.transform.height*r.q.devicePixelRatio],v);l.setFogUniformValues(i,$)}x&&l.setCutoffUniformValues(i,x.uniformValues)}setTileLoadedFlag(i){this.tileLoaded=i}saveCanvasCopy(){const i=this.canvasCopy();i&&(this.frameCopies.push(i),this.tileLoaded=!1)}canvasCopy(){const i=this.context.gl,l=i.createTexture();return i.bindTexture(i.TEXTURE_2D,l),i.copyTexImage2D(i.TEXTURE_2D,0,i.RGBA,0,0,i.drawingBufferWidth,i.drawingBufferHeight,0),l}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const i=this.style&&this.style.fog;return!!i&&i.getOpacity(this.transform.pitch)!==0}getBackgroundTiles(){const i=this._backgroundTiles,l=this._backgroundTiles={},m=this.transform.coveringTiles({tileSize:512});for(const v of m)l[v.key]=i[v.key]||new uu(v,512,this.transform.tileZoom,this);return l}clearBackgroundTiles(){this._backgroundTiles={}}isSourceForClippingOrConflation(i,l){return!(!i.is3D()||i.type!=="clip"&&(i.minzoom&&i.minzoom>this.transform.zoom||(this.style._clipLayerPresent||i.sourceLayer!=="building")&&(!l||l.type!=="batched-model")))}isTileAffectedByFog(i){if(!this.style||!this.style.fog)return!1;if(this.transform.projection.name==="globe")return!0;let l=this._cachedTileFogOpacities[i.key];return l||(this._cachedTileFogOpacities[i.key]=l=this.style.fog.getOpacityForTile(i)),l[0]>=Mn||l[1]>=Mn}setupDepthForOcclusion(i,l,m){const v=this.context,x=v.gl,E=!!m;var L;m||(m={u_dem:2,u_dem_prev:4,u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_depth_range_unpack:[0,1],u_occluder_half_size:16,u_occlusion_depth_offset:-1e-4,u_exaggeration:0}),v.activeTexture.set(x.TEXTURE3),i&&this.depthFBO&&this.depthTexture?(this.depthTexture.bind(x.NEAREST,x.CLAMP_TO_EDGE),m.u_depth_size_inv=[1/this.depthFBO.width,1/this.depthFBO.height],m.u_depth_range_unpack=[2/((L=this.depthRangeFor3D)[1]-L[0]),-1-2*L[0]/(L[1]-L[0])],m.u_occluder_half_size=.5*this.occlusionParams.occluderSize,m.u_occlusion_depth_offset=this.occlusionParams.depthOffset):this.emptyDepthTexture.bind(x.NEAREST,x.CLAMP_TO_EDGE),v.activeTexture.set(x.TEXTURE0),E||l.setTerrainUniformValues(v,m)}}function Ap(h,i){let l=!1,m=null;const v=()=>{m=null,l&&(h(),m=setTimeout(v,i),l=!1)};return()=>(l=!0,m||v(),m)}class kp{constructor(i){this._hashName=i&&encodeURIComponent(i),r.aP(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=Ap(this._updateHashUnthrottled.bind(this),300)}addTo(i){return this._map=i,window.addEventListener("hashchange",this._onHashChange,!1),i.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const i=this._map;if(!i)return"";const l=Pp(i);if(this._hashName){const m=this._hashName;let v=!1;const x=location.hash.slice(1).split("&").map(E=>{const L=E.split("=")[0];return L===m?(v=!0,`${L}=${l}`):E}).filter(E=>E);return v||x.push(`${m}=${l}`),`#${x.join("&")}`}return`#${l}`}_getCurrentHash(){const i=location.hash.replace("#","");if(this._hashName){let l;return i.split("&").map(m=>m.split("=")).forEach(m=>{m[0]===this._hashName&&(l=m)}),(l&&l[1]||"").split("/")}return i.split("/")}_onHashChange(){const i=this._map;if(!i)return!1;const l=this._getCurrentHash();if(l.length>=3&&!l.some(m=>isNaN(m))){const m=i.dragRotate.isEnabled()&&i.touchZoomRotate.isEnabled()?+(l[3]||0):i.getBearing();return i.jumpTo({center:[+l[2],+l[1]],zoom:+l[0],bearing:m,pitch:+(l[4]||0)}),!0}return!1}_updateHashUnthrottled(){history.replaceState(history.state,"",location.href.replace(/(#.+)?$/,this.getHashString()))}}function Pp(h,i){const l=h.getCenter(),m=Math.round(100*h.getZoom())/100,v=Math.ceil((m*Math.LN2+Math.log(512/360/.5))/Math.LN10),x=Math.pow(10,v),E=Math.round(l.lng*x)/x,L=Math.round(l.lat*x)/x,$=h.getBearing(),j=h.getPitch();let G=i?`/${E}/${L}/${m}`:`${m}/${L}/${E}`;return($||j)&&(G+="/"+Math.round(10*$)/10),j&&(G+=`/${Math.round(j)}`),G}const hd={linearity:.3,easing:r.dy(0,0,.3,1)},d0=r.l({deceleration:2500,maxSpeed:1400},hd),f0=r.l({deceleration:20,maxSpeed:1400},hd),h0=r.l({deceleration:1e3,maxSpeed:360},hd),p0=r.l({deceleration:1e3,maxSpeed:90},hd);class m0{constructor(i){this._map=i,this.clear()}clear(){this._inertiaBuffer=[]}record(i){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:r.q.now(),settings:i})}_drainInertiaBuffer(){const i=this._inertiaBuffer,l=r.q.now();for(;i.length>0&&l-i[0].time>160;)i.shift()}_onMoveEnd(i){if(this._map._prefersReducedMotion()||(this._drainInertiaBuffer(),this._inertiaBuffer.length<2))return;const l={zoom:0,bearing:0,pitch:0,pan:new r.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:x}of this._inertiaBuffer)l.zoom+=x.zoomDelta||0,l.bearing+=x.bearingDelta||0,l.pitch+=x.pitchDelta||0,x.panDelta&&l.pan._add(x.panDelta),x.around&&(l.around=x.around),x.pinchAround&&(l.pinchAround=x.pinchAround);const m=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,v={};if(l.pan.mag()){const x=Nf(l.pan.mag(),m,r.l({},d0,i||{}));v.offset=l.pan.mult(x.amount/l.pan.mag()),v.center=this._map.transform.center,Ff(v,x)}if(l.zoom){const x=Nf(l.zoom,m,f0);v.zoom=this._map.transform.zoom+x.amount,Ff(v,x)}if(l.bearing){const x=Nf(l.bearing,m,h0);v.bearing=this._map.transform.bearing+r.aw(x.amount,-179,179),Ff(v,x)}if(l.pitch){const x=Nf(l.pitch,m,p0);v.pitch=this._map.transform.pitch+x.amount,Ff(v,x)}if(v.zoom||v.bearing){const x=l.pinchAround===void 0?l.around:l.pinchAround;v.around=x?this._map.unproject(x):this._map.getCenter()}return this.clear(),v.noMoveStart=!0,v}}function Ff(h,i){(!h.duration||h.duration<i.duration)&&(h.duration=i.duration,h.easing=i.easing)}function Nf(h,i,l){const{maxSpeed:m,linearity:v,deceleration:x}=l,E=r.aw(h*v/(i/1e3),-m,m),L=Math.abs(E)/(x*v);return{easing:l.easing,duration:1e3*L,amount:E*(L/2)}}class As extends r.z{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(i,l,m,v={}){const x=he(l.getCanvasContainer(),m),E=l.unproject(x);super(i,r.l({point:x,lngLat:E,originalEvent:m},v)),this._defaultPrevented=!1,this.target=l}}class Bf extends r.z{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(i,l,m){const v=i==="touchend"?m.changedTouches:m.touches,x=le(l.getCanvasContainer(),v),E=x.map($=>l.unproject($)),L=x.reduce(($,j,G,X)=>$.add(j.div(X.length)),new r.P(0,0));super(i,{points:x,point:L,lngLats:E,lngLat:l.unproject(L),originalEvent:m}),this._defaultPrevented=!1}}class g0 extends r.z{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(i,l){super("wheel",{originalEvent:l}),this._defaultPrevented=!1}}class _0{constructor(i,l){this._map=i,this._clickTolerance=l.clickTolerance}reset(){this._mousedownPos=void 0}wheel(i){return this._firePreventable(new g0(this._map,i))}mousedown(i,l){return this._mousedownPos=l,this._firePreventable(new As(i.type,this._map,i))}mouseup(i){this._map.fire(new As(i.type,this._map,i))}preclick(i){const l=r.l({},i);l.type="preclick",this._map.fire(new As(l.type,this._map,l))}click(i,l){this._mousedownPos&&this._mousedownPos.dist(l)>=this._clickTolerance||(this.preclick(i),this._map.fire(new As(i.type,this._map,i)))}dblclick(i){return this._firePreventable(new As(i.type,this._map,i))}mouseover(i){this._map.fire(new As(i.type,this._map,i))}mouseout(i){this._map.fire(new As(i.type,this._map,i))}touchstart(i){return this._firePreventable(new Bf(i.type,this._map,i))}touchmove(i){this._map.fire(new Bf(i.type,this._map,i))}touchend(i){this._map.fire(new Bf(i.type,this._map,i))}touchcancel(i){this._map.fire(new Bf(i.type,this._map,i))}_firePreventable(i){if(this._map.fire(i),i.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class y0{constructor(i){this._map=i}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(i){this._map.fire(new As(i.type,this._map,i))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new As("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(i){this._delayContextMenu?this._contextMenuEvent=i:this._map.fire(new As(i.type,this._map,i)),this._map.listens("contextmenu")&&i.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class v0{constructor(i,l){this._map=i,this._el=i.getCanvasContainer(),this._container=i.getContainer(),this._clickTolerance=l.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(i,l){this.isEnabled()&&i.shiftKey&&i.button===0&&(q(),this._startPos=this._lastPos=l,this._active=!0)}mousemoveWindow(i,l){if(!this._active)return;const m=l,v=this._startPos,x=this._lastPos;if(!v||!x||x.equals(m)||!this._box&&m.dist(v)<this._clickTolerance)return;this._lastPos=m,this._box||(this._box=N("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",i));const E=Math.min(v.x,m.x),L=Math.max(v.x,m.x),$=Math.min(v.y,m.y),j=Math.max(v.y,m.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${E}px,${$}px)`,this._box.style.width=L-E+"px",this._box.style.height=j-$+"px")})}mouseupWindow(i,l){if(!this._active)return;const m=this._startPos,v=l;if(m&&i.button===0){if(this.reset(),se(),m.x!==v.x||m.y!==v.y)return this._map.fire(new r.z("boxzoomend",{originalEvent:i})),{cameraAnimation:x=>x.fitScreenCoordinates(m,v,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",i)}}keydown(i){this._active&&i.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",i))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),J(),delete this._startPos,delete this._lastPos}_fireEvent(i,l){return this._map.fire(new r.z(i,{originalEvent:l}))}}function i_(h,i){const l={};for(let m=0;m<h.length;m++)l[h[m].identifier]=i[m];return l}class gw{constructor(i){this.reset(),this.numTouches=i.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(i,l,m){(this.centroid||m.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===0&&(this.startTime=i.timeStamp),m.length===this.numTouches&&(this.centroid=function(v){const x=new r.P(0,0);for(const E of v)x._add(E);return x.div(v.length)}(l),this.touches=i_(m,l)))}touchmove(i,l,m){if(this.aborted||!this.centroid)return;const v=i_(m,l);for(const x in this.touches){const E=v[x];(!E||E.dist(this.touches[x])>30)&&(this.aborted=!0)}}touchend(i,l,m){if((!this.centroid||i.timeStamp-this.startTime>500)&&(this.aborted=!0),m.length===0){const v=!this.aborted&&this.centroid;if(this.reset(),v)return v}}}class Yi{constructor(i){this.singleTap=new gw(i),this.numTaps=i.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(i,l,m){this.singleTap.touchstart(i,l,m)}touchmove(i,l,m){this.singleTap.touchmove(i,l,m)}touchend(i,l,m){const v=this.singleTap.touchend(i,l,m);if(v){const x=i.timeStamp-this.lastTime<500,E=!this.lastTap||this.lastTap.dist(v)<30;if(x&&E||this.reset(),this.count++,this.lastTime=i.timeStamp,this.lastTap=v,this.count===this.numTaps)return this.reset(),v}}}class b0{constructor(){this._zoomIn=new Yi({numTouches:1,numTaps:2}),this._zoomOut=new Yi({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(i,l,m){this._zoomIn.touchstart(i,l,m),this._zoomOut.touchstart(i,l,m)}touchmove(i,l,m){this._zoomIn.touchmove(i,l,m),this._zoomOut.touchmove(i,l,m)}touchend(i,l,m){const v=this._zoomIn.touchend(i,l,m),x=this._zoomOut.touchend(i,l,m);return v?(this._active=!0,i.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:E=>E.easeTo({duration:300,zoom:E.getZoom()+1,around:E.unproject(v)},{originalEvent:i})}):x?(this._active=!0,i.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:E=>E.easeTo({duration:300,zoom:E.getZoom()-1,around:E.unproject(x)},{originalEvent:i})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const _w={0:1,2:2};class o_{constructor(i){this.reset(),this._clickTolerance=i.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(i,l){return!1}_move(i,l){return{}}mousedown(i,l){if(this._lastPoint)return;const m=ce(i);this._correctButton(i,m)&&(this._lastPoint=l,this._eventButton=m)}mousemoveWindow(i,l){const m=this._lastPoint;if(m){if(i.preventDefault(),this._eventButton!=null&&function(v,x){const E=_w[x];return v.buttons===void 0||(v.buttons&E)!==E}(i,this._eventButton))this.reset();else if(this._moved||!(l.dist(m)<this._clickTolerance))return this._moved=!0,this._lastPoint=l,this._move(m,l)}}mouseupWindow(i){this._lastPoint&&ce(i)===this._eventButton&&(this._moved&&se(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Vf extends o_{mousedown(i,l){super.mousedown(i,l),this._lastPoint&&(this._active=!0)}_correctButton(i,l){return l===0&&!i.ctrlKey}_move(i,l){return{around:l,panDelta:l.sub(i)}}}class s_ extends o_{_correctButton(i,l){return l===0&&i.ctrlKey||l===2}_move(i,l){const m=.8*(l.x-i.x);if(m)return this._active=!0,{bearingDelta:m}}contextmenu(i){i.preventDefault()}}class Rp extends o_{_correctButton(i,l){return l===0&&i.ctrlKey||l===2}_move(i,l){const m=-.5*(l.y-i.y);if(m)return this._active=!0,{pitchDelta:m}}contextmenu(i){i.preventDefault()}}class Op{constructor(i,l){this._map=i,this._el=i.getCanvasContainer(),this._minTouches=1,this._clickTolerance=l.clickTolerance||1,this.reset(),r.aP(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new r.P(0,0)}touchstart(i,l,m){return this._calculateTransform(i,l,m)}touchmove(i,l,m){if(this._active&&!(m.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(m.length===1&&!r.dz())return void this._showTouchPanBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return i.cancelable&&i.preventDefault(),this._calculateTransform(i,l,m)}}touchend(i,l,m){this._calculateTransform(i,l,m),this._active&&m.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(i,l,m){m.length>0&&(this._active=!0);const v=i_(m,l),x=new r.P(0,0),E=new r.P(0,0);let L=0;for(const j in v){const G=v[j],X=this._touches[j];X&&(x._add(G),E._add(G.sub(X)),L++,v[j]=G)}if(this._touches=v,L<this._minTouches||!E.mag())return;const $=E.div(L);return this._sum._add($),this._sum.mag()<this._clickTolerance?void 0:{around:x.div(L),panDelta:$}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=N("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=window.setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.removeAttribute("role")},500)}}class La{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(i){}_move(i,l,m){return{}}touchstart(i,l,m){this._firstTwoTouches||m.length<2||(this._firstTwoTouches=[m[0].identifier,m[1].identifier],this._start([l[0],l[1]]))}touchmove(i,l,m){const v=this._firstTwoTouches;if(!v)return;i.preventDefault();const[x,E]=v,L=uc(m,l,x),$=uc(m,l,E);if(!L||!$)return;const j=this._aroundCenter?null:L.add($).div(2);return this._move([L,$],j,i)}touchend(i,l,m){if(!this._firstTwoTouches)return;const[v,x]=this._firstTwoTouches,E=uc(m,l,v),L=uc(m,l,x);E&&L||(this._active&&se(),this.reset())}touchcancel(){this.reset()}enable(i){this._enabled=!0,this._aroundCenter=!!i&&i.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function uc(h,i,l){for(let m=0;m<h.length;m++)if(h[m].identifier===l)return i[m]}function no(h,i){return Math.log(h/i)/Math.LN2}class Ja extends La{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(i){this._startDistance=this._distance=i[0].dist(i[1])}_move(i,l){const m=this._distance;if(this._distance=i[0].dist(i[1]),this._active||!(Math.abs(no(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:no(this._distance,m),pinchAround:l}}}function Lp(h,i){return 180*h.angleWith(i)/Math.PI}class Dp extends La{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(i){this._startVector=this._vector=i[0].sub(i[1]),this._minDiameter=i[0].dist(i[1])}_move(i,l){const m=this._vector;if(this._vector=i[0].sub(i[1]),m&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:Lp(this._vector,m),pinchAround:l}}_isBelowThreshold(i){this._minDiameter=Math.min(this._minDiameter,i.mag());const l=25/(Math.PI*this._minDiameter)*360,m=this._startVector;if(!m)return!1;const v=Lp(i,m);return Math.abs(v)<l}}function zp(h){return Math.abs(h.y)>Math.abs(h.x)}class yw extends La{constructor(i){super(),this._map=i}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(i){this._lastPoints=i,zp(i[0].sub(i[1]))&&(this._valid=!1)}_move(i,l,m){const v=this._lastPoints;if(!v)return;const x=i[0].sub(v[0]),E=i[1].sub(v[1]);return this._map._cooperativeGestures&&!r.dz()&&m.touches.length<3||(this._valid=this.gestureBeginsVertically(x,E,m.timeStamp),!this._valid)?void 0:(this._lastPoints=i,this._active=!0,{pitchDelta:(x.y+E.y)/2*-.5})}gestureBeginsVertically(i,l,m){if(this._valid!==void 0)return this._valid;const v=i.mag()>=2,x=l.mag()>=2;if(!v&&!x)return;if(!v||!x)return this._firstMove==null&&(this._firstMove=m),m-this._firstMove<100&&void 0;const E=i.y>0==l.y>0;return zp(i)&&zp(l)&&E}}const $f={panStep:100,bearingStep:15,pitchStep:10};class vw{constructor(){const i=$f;this._panStep=i.panStep,this._bearingStep=i.bearingStep,this._pitchStep=i.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(i){if(i.altKey||i.ctrlKey||i.metaKey)return;let l=0,m=0,v=0,x=0,E=0;switch(i.keyCode){case 61:case 107:case 171:case 187:l=1;break;case 189:case 109:case 173:l=-1;break;case 37:i.shiftKey?m=-1:(i.preventDefault(),x=-1);break;case 39:i.shiftKey?m=1:(i.preventDefault(),x=1);break;case 38:i.shiftKey?v=1:(i.preventDefault(),E=-1);break;case 40:i.shiftKey?v=-1:(i.preventDefault(),E=1);break;default:return}return this._rotationDisabled&&(m=0,v=0),{cameraAnimation:L=>{const $=L.getZoom();L.easeTo({duration:300,easeId:"keyboardHandler",easing:bw,zoom:l?Math.round($)+l*(i.shiftKey?2:1):$,bearing:L.getBearing()+m*this._bearingStep,pitch:L.getPitch()+v*this._pitchStep,offset:[-x*this._panStep,-E*this._panStep],center:L.getCenter()},{originalEvent:i})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function bw(h){return h*(2-h)}const Fp=4.000244140625,a_=1/450;class pd{constructor(i,l){this._map=i,this._el=i.getCanvasContainer(),this._handler=l,this._delta=0,this._lastDelta=0,this._defaultZoomRate=.01,this._wheelZoomRate=a_,r.aP(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(i){this._defaultZoomRate=i}setWheelZoomRate(i){this._wheelZoomRate=i}isEnabled(){return!!this._enabled}isActive(){return this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(i){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!i&&i.around==="center",this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(i){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(i.ctrlKey||i.metaKey||this.isZooming()||r.dz()))return void this._showBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let l=i.deltaMode===WheelEvent.DOM_DELTA_LINE?40*i.deltaY:i.deltaY;const m=r.q.now(),v=m-(this._lastWheelEventTime||0);this._lastWheelEventTime=m,l!==0&&l%Fp==0?this._type="wheel":l!==0&&Math.abs(l)<4?this._type="trackpad":v>400?(this._type=null,this._lastValue=l,this._timeout=window.setTimeout(this._onTimeout,40,i)):this._type||(this._type=Math.abs(v*l)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,l+=this._lastValue)),i.shiftKey&&l&&(l/=4),this._type&&(this._lastWheelEvent=i,this._delta-=l,this._active||this._start(i)),i.preventDefault()}_onTimeout(i){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(i)}_start(i){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const l=he(this._el,i);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:l,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const i=this._map.transform;this._type==="wheel"&&i.projection.wrap&&(i._center.lng>=180||i._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);const l=()=>i._terrainEnabled()&&this._aroundCoord?i.computeZoomRelativeTo(this._aroundCoord):i.zoom;if(this._delta!==0){const j=this._type==="wheel"&&Math.abs(this._delta)>Fp?this._wheelZoomRate:this._defaultZoomRate;let G=2/(1+Math.exp(-Math.abs(this._delta*j)));this._delta<0&&G!==0&&(G=1/G);const X=l(),Y=Math.pow(2,X),ne=typeof this._targetZoom=="number"?i.zoomScale(this._targetZoom):Y;this._targetZoom=Math.min(i.maxZoom,Math.max(i.minZoom,i.scaleZoom(ne*G))),this._type==="wheel"&&(this._startZoom=X,this._easing=this._smoothOutEasing(200)),this._lastDelta=this._delta,this._delta=0}const m=typeof this._targetZoom=="number"?this._targetZoom:l(),v=this._startZoom,x=this._easing;let E,L=!1;if(this._type==="wheel"&&v&&x){const j=Math.min((r.q.now()-this._lastWheelEventTime)/200,1),G=x(j);E=r.af(v,m,G),j<1?this._frameId||(this._frameId=!0):L=!0}else E=m,L=!0;this._active=!0,L&&(this._active=!1,this._finishTimeout=window.setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200));let $=E-l();return $*this._lastDelta<0&&($=0),{noInertia:!0,needsRenderFrame:!L,zoomDelta:$,around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(i){let l=r.dA;if(this._prevEase){const m=this._prevEase,v=(r.q.now()-m.start)/m.duration,x=m.easing(v+.01)-m.easing(v),E=.27/Math.sqrt(x*x+1e-4)*.01,L=Math.sqrt(.0729-E*E);l=r.dy(E,L,.25,1)}return this._prevEase={start:r.q.now(),duration:i,easing:l},l}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=N("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=window.setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.removeAttribute("role")},200)}}class md{constructor(i,l){this._clickZoom=i,this._tapZoom=l}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Pl{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(i,l){return i.preventDefault(),{cameraAnimation:m=>{m.easeTo({duration:300,zoom:m.getZoom()+(i.shiftKey?-1:1),around:m.unproject(l)},{originalEvent:i})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Da{constructor(){this._tap=new Yi({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(i,l,m){this._swipePoint||(this._tapTime&&i.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?m.length>0&&(this._swipePoint=l[0],this._swipeTouch=m[0].identifier):this._tap.touchstart(i,l,m))}touchmove(i,l,m){if(this._tapTime){if(this._swipePoint){if(m[0].identifier!==this._swipeTouch)return;const v=l[0],x=v.y-this._swipePoint.y;return this._swipePoint=v,i.preventDefault(),this._active=!0,{zoomDelta:x/128}}}else this._tap.touchmove(i,l,m)}touchend(i,l,m){this._tapTime?this._swipePoint&&m.length===0&&this.reset():this._tap.touchend(i,l,m)&&(this._tapTime=i.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class bu{constructor(i,l,m){this._el=i,this._mousePan=l,this._touchPan=m}enable(i){this._inertiaOptions=i||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class cc{constructor(i,l,m){this._pitchWithRotate=i.pitchWithRotate,this._mouseRotate=l,this._mousePitch=m}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class xu{constructor(i,l,m,v){this._el=i,this._touchZoom=l,this._touchRotate=m,this._tapDragZoom=v,this._rotationDisabled=!1,this._enabled=!0}enable(i){this._touchZoom.enable(i),this._rotationDisabled||this._touchRotate.enable(i),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const Np=h=>h.zoom||h.drag||h.pitch||h.rotate;class xw extends r.z{}class ww{constructor(){this.constants=[1,1,.01],this.radius=0}setup(i,l){const m=r.ab.vec3.sub([],l,i);this.radius=r.ab.vec3.length(m[2]<0?r.ab.vec3.div([],m,this.constants):[m[0],m[1],0])}projectRay(i){r.ab.vec3.div(i,i,this.constants),r.ab.vec3.normalize(i,i),r.ab.vec3.mul(i,i,this.constants);const l=r.ab.vec3.scale([],i,this.radius);if(l[2]>0){const m=r.ab.vec3.scale([],[0,0,1],r.ab.vec3.dot(l,[0,0,1])),v=r.ab.vec3.scale([],r.ab.vec3.normalize([],[l[0],l[1],0]),this.radius),x=r.ab.vec3.add([],l,r.ab.vec3.scale([],r.ab.vec3.sub([],r.ab.vec3.add([],v,m),l),2));l[0]=x[0],l[1]=x[1]}return l}}function Bp(h){return h.panDelta&&h.panDelta.mag()||h.zoomDelta||h.bearingDelta||h.pitchDelta}class x0{constructor(i,l){this._map=i,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new m0(i),this._bearingSnap=l.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new ww,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(l),r.aP(["handleEvent","handleWindowEvent"],this);const m=this._el;this._listeners=[[m,"touchstart",{passive:!0}],[m,"touchmove",{passive:!1}],[m,"touchend",void 0],[m,"touchcancel",void 0],[m,"mousedown",void 0],[m,"mousemove",void 0],[m,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[m,"mouseover",void 0],[m,"mouseout",void 0],[m,"dblclick",void 0],[m,"click",void 0],[m,"keydown",{capture:!1}],[m,"keyup",void 0],[m,"wheel",{passive:!1}],[m,"contextmenu",void 0],[window,"blur",void 0]];for(const[v,x,E]of this._listeners){const L=v===document?this.handleWindowEvent:this.handleEvent;v.addEventListener(x,L,E)}}destroy(){for(const[i,l,m]of this._listeners){const v=i===document?this.handleWindowEvent:this.handleEvent;i.removeEventListener(l,v,m)}}_addDefaultHandlers(i){const l=this._map,m=l.getCanvasContainer();this._add("mapEvent",new _0(l,i));const v=l.boxZoom=new v0(l,i);this._add("boxZoom",v);const x=new b0,E=new Pl;l.doubleClickZoom=new md(E,x),this._add("tapZoom",x),this._add("clickZoom",E);const L=new Da;this._add("tapDragZoom",L);const $=l.touchPitch=new yw(l);this._add("touchPitch",$);const j=new s_(i),G=new Rp(i);l.dragRotate=new cc(i,j,G),this._add("mouseRotate",j,["mousePitch"]),this._add("mousePitch",G,["mouseRotate"]);const X=new Vf(i),Y=new Op(l,i);l.dragPan=new bu(m,X,Y),this._add("mousePan",X),this._add("touchPan",Y,["touchZoom","touchRotate"]);const ne=new Dp,ve=new Ja;l.touchZoomRotate=new xu(m,ve,ne,L),this._add("touchRotate",ne,["touchPan","touchZoom"]),this._add("touchZoom",ve,["touchPan","touchRotate"]),this._add("blockableMapEvent",new y0(l));const _e=l.scrollZoom=new pd(l,this);this._add("scrollZoom",_e,["mousePan"]);const Te=l.keyboard=new vw;this._add("keyboard",Te);for(const Ce of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])i.interactive&&i[Ce]&&l[Ce].enable(i[Ce])}_add(i,l,m){this._handlers.push({handlerName:i,handler:l,allowed:m}),this._handlersById[i]=l}stop(i){if(!this._updatingCamera){for(const{handler:l}of this._handlers)l.reset();this._inertia.clear(),this._fireEvents({},{},i),this._changes=[],this._originalZoom=void 0}}isActive(){for(const{handler:i}of this._handlers)if(i.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Np(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(i,l,m){for(const v in i)if(v!==m&&(!l||l.indexOf(v)<0))return!0;return!1}handleWindowEvent(i){this.handleEvent(i,`${i.type}Window`)}_getMapTouches(i){const l=[];for(const m of i)this._el.contains(m.target)&&l.push(m);return l}handleEvent(i,l){this._updatingCamera=!0;const m=i.type==="renderFrame",v=m?void 0:i,x={needsRenderFrame:!1},E={},L={},$=i.touches?this._getMapTouches(i.touches):void 0,j=$?le(this._el,$):m?void 0:he(this._el,i);for(const{handlerName:Y,handler:ne,allowed:ve}of this._handlers){if(!ne.isEnabled())continue;let _e;this._blockedByActive(L,ve,Y)?ne.reset():ne[l||i.type]&&(_e=ne[l||i.type](i,j,$),this.mergeHandlerResult(x,E,_e,Y,v),_e&&_e.needsRenderFrame&&this._triggerRenderFrame()),(_e||ne.isActive())&&(L[Y]=ne)}const G={};for(const Y in this._previousActiveHandlers)L[Y]||(G[Y]=v);this._previousActiveHandlers=L,(Object.keys(G).length||Bp(x))&&(this._changes.push([x,E,G]),this._triggerRenderFrame()),(Object.keys(L).length||Bp(x))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:X}=x;X&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],X(this._map))}mergeHandlerResult(i,l,m,v,x){if(!m)return;r.l(i,m);const E={handlerName:v,originalEvent:m.originalEvent||x};m.zoomDelta!==void 0&&(l.zoom=E),m.panDelta!==void 0&&(l.drag=E),m.pitchDelta!==void 0&&(l.pitch=E),m.bearingDelta!==void 0&&(l.rotate=E)}_applyChanges(){const i={},l={},m={};for(const[v,x,E]of this._changes)v.panDelta&&(i.panDelta=(i.panDelta||new r.P(0,0))._add(v.panDelta)),v.zoomDelta&&(i.zoomDelta=(i.zoomDelta||0)+v.zoomDelta),v.bearingDelta&&(i.bearingDelta=(i.bearingDelta||0)+v.bearingDelta),v.pitchDelta&&(i.pitchDelta=(i.pitchDelta||0)+v.pitchDelta),v.around!==void 0&&(i.around=v.around),v.aroundCoord!==void 0&&(i.aroundCoord=v.aroundCoord),v.pinchAround!==void 0&&(i.pinchAround=v.pinchAround),v.noInertia&&(i.noInertia=v.noInertia),r.l(l,x),r.l(m,E);this._updateMapTransform(i,l,m),this._changes=[]}_updateMapTransform(i,l,m){const v=this._map,x=v.transform,E=Re=>[Re.x,Re.y,Re.z];if((Re=>{const je=this._eventsInProgress.drag;return je&&!this._handlersById[je.handlerName].isActive()})()&&!Bp(i)){const Re=x.zoom;x.cameraElevationReference="sea",this._originalZoom!=null&&x._orthographicProjectionAtLowPitch&&x.projection.name!=="globe"&&x.pitch===0?(x.cameraElevationReference="ground",x.zoom=this._originalZoom):(x.recenterOnTerrain(),x.cameraElevationReference="ground"),Re!==x.zoom&&this._map._update(!0)}if(x._isCameraConstrained&&v._stop(!0),!Bp(i))return void this._fireEvents(l,m,!0);let{panDelta:L,zoomDelta:$,bearingDelta:j,pitchDelta:G,around:X,aroundCoord:Y,pinchAround:ne}=i;x._isCameraConstrained&&($>0&&($=0),x._isCameraConstrained=!1),ne!==void 0&&(X=ne),($||(Re=>l[Re]&&!this._eventsInProgress[Re])("drag"))&&X&&(this._dragOrigin=E(x.pointCoordinate3D(X)),this._originalZoom=x.zoom,this._trackingEllipsoid.setup(x._camera.position,this._dragOrigin)),x.cameraElevationReference="sea",v._stop(!0),X=X||v.transform.centerPoint,j&&(x.bearing+=j),G&&(x.pitch+=G),x._updateCameraState();const ve=[0,0,0];if(L)if(x.projection.name==="mercator"){const Re=this._trackingEllipsoid.projectRay(x.screenPointToMercatorRay(X).dir),je=this._trackingEllipsoid.projectRay(x.screenPointToMercatorRay(X.sub(L)).dir);ve[0]=je[0]-Re[0],ve[1]=je[1]-Re[1]}else{const Re=x.pointCoordinate(X);if(x.projection.name==="globe"){L=L.rotate(-x.angle);const je=x._pixelsPerMercatorPixel/x.worldSize;ve[0]=-L.x*r.dB(r.aS(Re.y))*je,ve[1]=-L.y*r.dB(x.center.lat)*je}else{const je=x.pointCoordinate(X.sub(L));Re&&je&&(ve[0]=je.x-Re.x,ve[1]=je.y-Re.y)}}const _e=x.zoom,Te=[0,0,0];if($){const Re=E(Y||x.pointCoordinate3D(X)),je={dir:r.ab.vec3.normalize([],r.ab.vec3.sub([],Re,x._camera.position))};if(je.dir[2]<0){const Be=x.zoomDeltaToMovement(Re,$);r.ab.vec3.scale(Te,je.dir,Be)}}const Ce=r.ab.vec3.add(ve,ve,Te);x._translateCameraConstrained(Ce),$&&Math.abs(x.zoom-_e)>1e-4&&x.recenterOnTerrain(),x.cameraElevationReference="ground",this._map._update(),i.noInertia||this._inertia.record(i),this._fireEvents(l,m,!0)}_fireEvents(i,l,m){const v=Np(this._eventsInProgress),x=Np(i),E={};for(const G in i){const{originalEvent:X}=i[G];this._eventsInProgress[G]||(E[`${G}start`]=X),this._eventsInProgress[G]=i[G]}!v&&x&&this._fireEvent("movestart",x.originalEvent);for(const G in E)this._fireEvent(G,E[G]);x&&this._fireEvent("move",x.originalEvent);for(const G in i){const{originalEvent:X}=i[G];this._fireEvent(G,X)}const L={};let $;for(const G in this._eventsInProgress){const{handlerName:X,originalEvent:Y}=this._eventsInProgress[G];this._handlersById[X].isActive()||(delete this._eventsInProgress[G],$=l[X]||Y,L[`${G}end`]=$)}for(const G in L)this._fireEvent(G,L[G]);const j=Np(this._eventsInProgress);if(m&&(v||x)&&!j){this._updatingCamera=!0;const G=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),X=Y=>Y!==0&&-this._bearingSnap<Y&&Y<this._bearingSnap;G?(X(G.bearing||this._map.getBearing())&&(G.bearing=0),this._map.easeTo(G,{originalEvent:$})):(this._map.fire(new r.z("moveend",{originalEvent:$})),X(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(i,l){this._map.fire(new r.z(i,l?{originalEvent:l}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(i=>{this._frameId=void 0,this.handleEvent(new xw("renderFrame",{timeStamp:i})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}const Ko="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class l_ extends r.E{constructor(i,l){super(),this._moving=!1,this._zooming=!1,this.transform=i,this._bearingSnap=l.bearingSnap,this._respectPrefersReducedMotion=l.respectPrefersReducedMotion!==!1,r.aP(["_renderFrameCallback"],this)}getCenter(){return new r.bO(this.transform.center.lng,this.transform.center.lat)}setCenter(i,l){return this.jumpTo({center:i},l)}panBy(i,l,m){return i=r.P.convert(i).mult(-1),this.panTo(this.transform.center,r.l({offset:i},l),m)}panTo(i,l,m){return this.easeTo(r.l({center:i},l),m)}getZoom(){return this.transform.zoom}setZoom(i,l){return this.jumpTo({zoom:i},l),this}zoomTo(i,l,m){return this.easeTo(r.l({zoom:i},l),m)}zoomIn(i,l){return this.zoomTo(this.getZoom()+1,i,l),this}zoomOut(i,l){return this.zoomTo(this.getZoom()-1,i,l),this}getBearing(){return this.transform.bearing}setBearing(i,l){return this.jumpTo({bearing:i},l),this}getPadding(){return this.transform.padding}setPadding(i,l){return this.jumpTo({padding:i},l),this}rotateTo(i,l,m){return this.easeTo(r.l({bearing:i},l),m)}resetNorth(i,l){return this.rotateTo(0,r.l({duration:1e3},i),l),this}resetNorthPitch(i,l){return this.easeTo(r.l({bearing:0,pitch:0,duration:1e3},i),l),this}snapToNorth(i,l){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(i,l):this}getPitch(){return this.transform.pitch}setPitch(i,l){return this.jumpTo({pitch:i},l),this}cameraForBounds(i,l){i=r.az.convert(i);const m=l&&l.bearing||0,v=l&&l.pitch||0,x=i.getNorthWest(),E=i.getSouthEast();return this._cameraForBounds(this.transform,x,E,m,v,l)}_extendPadding(i){const l={top:0,right:0,bottom:0,left:0};return i==null?r.l({},l,this.transform.padding):typeof i=="number"?{top:i,bottom:i,right:i,left:i}:r.l({},l,i)}_extendCameraOptions(i){return(i=r.l({offset:[0,0],maxZoom:this.transform.maxZoom},i)).padding=this._extendPadding(i.padding),i}_minimumAABBFrustumDistance(i,l){const m=l.max[0]-l.min[0],v=l.max[1]-l.min[1];return m/v>i.aspect?m/(2*Math.tan(.5*i.fovX)*i.aspect):v/(2*Math.tan(.5*i.fovY)*i.aspect)}_cameraForBoundsOnGlobe(i,l,m,v,x,E){const L=i.clone(),$=this._extendCameraOptions(E);L.bearing=v,L.pitch=x;const j=r.bO.convert(l),G=r.bO.convert(m),X=.5*(j.lat+G.lat),Y=.5*(j.lng+G.lng),ne=r.dC(X,Y),ve=r.ab.vec3.normalize([],ne),_e=r.ab.vec3.normalize([],r.ab.vec3.cross([],ve,[0,1,0])),Te=r.ab.vec3.cross([],_e,ve),Ce=[_e[0],_e[1],_e[2],0,Te[0],Te[1],Te[2],0,ve[0],ve[1],ve[2],0,0,0,0,1],Re=[ne,r.dC(j.lat,j.lng),r.dC(G.lat,j.lng),r.dC(G.lat,G.lng),r.dC(j.lat,G.lng),r.dC(X,j.lng),r.dC(X,G.lng),r.dC(j.lat,Y),r.dC(G.lat,Y)];let je=r.cd.fromPoints(Re.map(Ht=>[r.ab.vec3.dot(_e,Ht),r.ab.vec3.dot(Te,Ht),r.ab.vec3.dot(ve,Ht)]));const Be=r.ab.vec3.transformMat4([],je.center,Ce);r.ab.vec3.squaredLength(Be)===0&&r.ab.vec3.set(Be,0,0,1),r.ab.vec3.normalize(Be,Be),r.ab.vec3.scale(Be,Be,r.ax),L.center=r.dD(Be);const et=L.getWorldToCameraMatrix(),Ze=r.ab.mat4.invert(new Float64Array(16),et);je=r.cd.applyTransform(je,r.ab.mat4.multiply([],et,Ce));const Xe=this._extendAABB(je,L,$,v);if(!Xe)return void r.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");je=Xe,r.ab.vec3.transformMat4(Be,Be,et);const Ke=.5*(je.max[2]-je.min[2]),at=this._minimumAABBFrustumDistance(L,je),pt=r.ab.vec3.scale([],[0,0,1],Ke),Vt=r.ab.vec3.add(pt,Be,pt),Rt=at+(L.pitch===0?0:r.ab.vec3.distance(Be,Vt)),ht=L.globeCenterInViewSpace,St=r.ab.vec3.sub([],Be,[ht[0],ht[1],ht[2]]);r.ab.vec3.normalize(St,St),r.ab.vec3.scale(St,St,Rt);const en=r.ab.vec3.add([],Be,St);r.ab.vec3.transformMat4(en,en,Ze);const hn=r.ds/r.ax,vn=r.ab.vec3.length(en),It=r.bH(Math.max(vn*hn-r.ds,Number.EPSILON),0),ln=Math.min(L.zoomFromMercatorZAdjusted(It),$.maxZoom);return ln>.5*(r.c6+r.bY)?(L.setProjection({name:"mercator"}),L.zoom=ln,this._cameraForBounds(L,l,m,v,x,E)):{center:L.center,zoom:ln,bearing:v,pitch:x}}_extendAABB(i,l,m,v){const x=.5*((m.padding.left||0)+(m.padding.right||0)),E=.5*((m.padding.top||0)+(m.padding.bottom||0)),L=E,$=x,j=x,G=E,X=l.width-($+j),Y=l.height-(L+G),ne=r.ab.vec3.sub([],i.max,i.min),ve=Math.min(X/ne[0],Y/ne[1]),_e=Math.min(l.scaleZoom(l.scale*ve),m.maxZoom);if(isNaN(_e))return null;const Te=l.scale/l.zoomScale(_e),Ce=new r.cd([i.min[0]-$*Te,i.min[1]-G*Te,i.min[2]],[i.max[0]+j*Te,i.max[1]+L*Te,i.max[2]]),Re=(typeof m.offset.x=="number"&&typeof m.offset.y=="number"?new r.P(m.offset.x,m.offset.y):r.P.convert(m.offset)).rotate(-r.ai(v));return Ce.center[0]-=Re.x*Te,Ce.center[1]+=Re.y*Te,Ce}queryTerrainElevation(i,l){const m=this.transform.elevation;return m?(l=r.l({},{exaggerated:!0},l),m.getAtPoint(r.aa.fromLngLat(i),null,l.exaggerated)):null}_cameraForBounds(i,l,m,v,x,E){if(i.projection.name==="globe")return this._cameraForBoundsOnGlobe(i,l,m,v,x,E);const L=i.clone(),$=this._extendCameraOptions(E);L.bearing=v,L.pitch=x;const j=r.bO.convert(l),G=r.bO.convert(m),X=new r.bO(j.lng,G.lat),Y=new r.bO(G.lng,j.lat),ne=L.project(j),ve=L.project(G),_e=this.queryTerrainElevation(j),Te=this.queryTerrainElevation(G),Ce=this.queryTerrainElevation(X),Re=this.queryTerrainElevation(Y),je=[[ne.x,ne.y,Math.min(_e||0,Te||0,Ce||0,Re||0)],[ve.x,ve.y,Math.max(_e||0,Te||0,Ce||0,Re||0)]];let Be=r.cd.fromPoints(je);const et=L.getWorldToCameraMatrix(),Ze=r.ab.mat4.invert(new Float64Array(16),et);Be=r.cd.applyTransform(Be,et);const Xe=this._extendAABB(Be,L,$,v);if(!Xe)return void r.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");Be=Xe;const Ke=.5*r.ab.vec3.sub([],Be.max,Be.min)[2],at=this._minimumAABBFrustumDistance(L,Be),pt=[0,0,1,0];r.ab.vec4.transformMat4(pt,pt,et),r.ab.vec4.normalize(pt,pt);const Vt=r.ab.vec3.scale([],pt,at+Ke),Rt=r.ab.vec3.add([],Be.center,Vt);r.ab.vec3.transformMat4(Be.center,Be.center,Ze),r.ab.vec3.transformMat4(Rt,Rt,Ze);const ht=L.unproject(new r.P(Be.center[0],Be.center[1])),St=r.dE(L.projection,ht),en=Math.pow(2,St),hn=Math.min(L._zoomFromMercatorZ(Rt[2]*L.pixelsPerMeter*en/L.worldSize),$.maxZoom);return L.mercatorFromTransition&&hn<.5*(r.c6+r.bY)?(L.setProjection({name:"globe"}),L.zoom=hn,this._cameraForBounds(L,l,m,v,x,E)):{center:ht,zoom:hn,bearing:v,pitch:x}}fitBounds(i,l,m){const v=this.cameraForBounds(i,l);return this._fitInternal(v,l,m)}fitScreenCoordinates(i,l,m,v,x){const E=r.P.convert(i),L=r.P.convert(l),$=new r.P(Math.min(E.x,L.x),Math.min(E.y,L.y)),j=new r.P(Math.max(E.x,L.x),Math.max(E.y,L.y));if(this.transform.projection.name==="mercator"&&this.transform.anyCornerOffEdge(E,L))return this;const G=this.transform.pointLocation3D($),X=this.transform.pointLocation3D(j),Y=this.transform.pointLocation3D(new r.P($.x,j.y)),ne=this.transform.pointLocation3D(new r.P(j.x,$.y)),ve=[Math.min(G.lng,X.lng,Y.lng,ne.lng),Math.min(G.lat,X.lat,Y.lat,ne.lat)],_e=[Math.max(G.lng,X.lng,Y.lng,ne.lng),Math.max(G.lat,X.lat,Y.lat,ne.lat)],Te=v&&v.pitch?v.pitch:this.getPitch(),Ce=this._cameraForBounds(this.transform,ve,_e,m,Te,v);return this._fitInternal(Ce,v,x)}_fitInternal(i,l,m){return i?(l=r.l(i,l)).linear?this.easeTo(l,m):this.flyTo(l,m):this}jumpTo(i,l){this.stop();const m=i.preloadOnly?this.transform.clone():this.transform;let v=!1,x=!1,E=!1;"zoom"in i&&m.zoom!==+i.zoom&&(v=!0,m.zoom=+i.zoom),i.center!==void 0&&(m.center=r.bO.convert(i.center)),"bearing"in i&&m.bearing!==+i.bearing&&(x=!0,m.bearing=+i.bearing),"pitch"in i&&m.pitch!==+i.pitch&&(E=!0,m.pitch=+i.pitch);const L=typeof i.padding=="number"?this._extendPadding(i.padding):i.padding;if(i.padding!=null&&!m.isPaddingEqual(L))if(i.retainPadding===!1){const $=m.clone();$.padding=L,m.setLocationAtPoint(m.center,$.centerPoint)}else m.padding=L;return i.preloadOnly?(this._preloadTiles(m),this):(this.fire(new r.z("movestart",l)).fire(new r.z("move",l)),v&&this.fire(new r.z("zoomstart",l)).fire(new r.z("zoom",l)).fire(new r.z("zoomend",l)),x&&this.fire(new r.z("rotatestart",l)).fire(new r.z("rotate",l)).fire(new r.z("rotateend",l)),E&&this.fire(new r.z("pitchstart",l)).fire(new r.z("pitch",l)).fire(new r.z("pitchend",l)),this.fire(new r.z("moveend",l)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||r.w(Ko),this.transform.getFreeCameraOptions()}setFreeCameraOptions(i,l){const m=this.transform;if(!m.projection.supportsFreeCamera)return r.w(Ko),this;this.stop();const v=m.zoom,x=m.pitch,E=m.bearing;m.setFreeCameraOptions(i);const L=v!==m.zoom,$=x!==m.pitch,j=E!==m.bearing;return this.fire(new r.z("movestart",l)).fire(new r.z("move",l)),L&&this.fire(new r.z("zoomstart",l)).fire(new r.z("zoom",l)).fire(new r.z("zoomend",l)),j&&this.fire(new r.z("rotatestart",l)).fire(new r.z("rotate",l)).fire(new r.z("rotateend",l)),$&&this.fire(new r.z("pitchstart",l)).fire(new r.z("pitch",l)).fire(new r.z("pitchend",l)),this.fire(new r.z("moveend",l)),this}easeTo(i,l){this._stop(!1,i.easeId),((i=r.l({offset:[0,0],duration:500,easing:r.dA},i)).animate===!1||this._prefersReducedMotion(i))&&(i.duration=0);const m=this.transform,v=this.getZoom(),x=this.getBearing(),E=this.getPitch(),L=this.getPadding(),$="zoom"in i?+i.zoom:v,j="bearing"in i?this._normalizeBearing(i.bearing,x):x,G="pitch"in i?+i.pitch:E,X=this._extendPadding(i.padding),Y=r.P.convert(i.offset);let ne,ve,_e;if(m.projection.name==="globe"){const pt=r.aa.fromLngLat(m.center),Vt=Y.rotate(-m.angle);pt.x+=Vt.x/m.worldSize,pt.y+=Vt.y/m.worldSize;const Rt=pt.toLngLat(),ht=r.bO.convert(i.center||Rt);this._normalizeCenter(ht),ne=m.centerPoint.add(Vt),ve=new r.P(pt.x,pt.y).mult(m.worldSize),_e=new r.P(r.at(ht.lng),r.aA(ht.lat)).mult(m.worldSize).sub(ve)}else{ne=m.centerPoint.add(Y);const pt=m.pointLocation(ne),Vt=r.bO.convert(i.center||pt);this._normalizeCenter(Vt),ve=m.project(pt),_e=m.project(Vt).sub(ve)}const Te=m.zoomScale($-v);let Ce,Re;i.around&&(Ce=r.bO.convert(i.around),Re=m.locationPoint(Ce));const je=this._zooming||$!==v,Be=this._rotating||x!==j,et=this._pitching||G!==E,Ze=!m.isPaddingEqual(X),Xe=i.retainPadding===!1?m.clone():m,Ke=pt=>Vt=>{if(je&&(pt.zoom=r.af(v,$,Vt)),Be&&(pt.bearing=r.af(x,j,Vt)),et&&(pt.pitch=r.af(E,G,Vt)),Ze&&(Xe.interpolatePadding(L,X,Vt),ne=Xe.centerPoint.add(Y)),Ce)pt.setLocationAtPoint(Ce,Re);else{const Rt=pt.zoomScale(pt.zoom-v),ht=$>v?Math.min(2,Te):Math.max(.5,Te),St=Math.pow(ht,1-Vt),en=pt.unproject(ve.add(_e.mult(Vt*St)).mult(Rt));pt.setLocationAtPoint(pt.renderWorldCopies?en.wrap():en,ne)}return i.preloadOnly||this._fireMoveEvents(l),pt};if(i.preloadOnly){const pt=this._emulate(Ke,i.duration,m);return this._preloadTiles(pt),this}const at={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=je,this._rotating=Be,this._pitching=et,this._padding=Ze,this._easeId=i.easeId,this._prepareEase(l,i.noMoveStart,at),this._ease(Ke(m),pt=>{m.cameraElevationReference==="sea"&&m.recenterOnTerrain(),this._afterEase(l,pt)},i),this}_prepareEase(i,l,m={}){this._moving=!0,this.transform.cameraElevationReference="sea",this.transform._orthographicProjectionAtLowPitch&&this.transform.pitch===0&&this.transform.projection.name!=="globe"&&(this.transform.cameraElevationReference="ground"),l||m.moving||this.fire(new r.z("movestart",i)),this._zooming&&!m.zooming&&this.fire(new r.z("zoomstart",i)),this._rotating&&!m.rotating&&this.fire(new r.z("rotatestart",i)),this._pitching&&!m.pitching&&this.fire(new r.z("pitchstart",i))}_fireMoveEvents(i){this.fire(new r.z("move",i)),this._zooming&&this.fire(new r.z("zoom",i)),this._rotating&&this.fire(new r.z("rotate",i)),this._pitching&&this.fire(new r.z("pitch",i))}_afterEase(i,l){if(this._easeId&&l&&this._easeId===l)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const m=this._zooming,v=this._rotating,x=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,m&&this.fire(new r.z("zoomend",i)),v&&this.fire(new r.z("rotateend",i)),x&&this.fire(new r.z("pitchend",i)),this.fire(new r.z("moveend",i))}flyTo(i,l){if(this._prefersReducedMotion(i)){const Ht=r.ay(i,["center","zoom","bearing","pitch","around","padding","retainPadding"]);return this.jumpTo(Ht,l)}this.stop(),i=r.l({offset:[0,0],speed:1.2,curve:1.42,easing:r.dA},i);const m=this.transform,v=this.getZoom(),x=this.getBearing(),E=this.getPitch(),L=this.getPadding(),$="zoom"in i?r.aw(+i.zoom,m.minZoom,m.maxZoom):v,j="bearing"in i?this._normalizeBearing(i.bearing,x):x,G="pitch"in i?+i.pitch:E,X=this._extendPadding(i.padding),Y=m.zoomScale($-v),ne=r.P.convert(i.offset);let ve=m.centerPoint.add(ne);const _e=m.pointLocation(ve),Te=r.bO.convert(i.center||_e);this._normalizeCenter(Te);const Ce=m.project(_e),Re=m.project(Te).sub(Ce);let je=i.curve;const Be=Math.max(m.width,m.height),et=Be/Y,Ze=Re.mag();if("minZoom"in i){const Ht=r.aw(Math.min(i.minZoom,v,$),m.minZoom,m.maxZoom),gn=Be/m.zoomScale(Ht-v);je=Math.sqrt(gn/Ze*2)}const Xe=je*je;function Ke(Ht){const gn=(et*et-Be*Be+(Ht?-1:1)*Xe*Xe*Ze*Ze)/(2*(Ht?et:Be)*Xe*Ze);return Math.log(Math.sqrt(gn*gn+1)-gn)}function at(Ht){return(Math.exp(Ht)-Math.exp(-Ht))/2}function pt(Ht){return(Math.exp(Ht)+Math.exp(-Ht))/2}const Vt=Ke(0);let Rt=function(Ht){return pt(Vt)/pt(Vt+je*Ht)},ht=function(Ht){return Be*((pt(Vt)*(at(gn=Vt+je*Ht)/pt(gn))-at(Vt))/Xe)/Ze;var gn},St=(Ke(1)-Vt)/je;if(Math.abs(Ze)<1e-6||!isFinite(St)){if(Math.abs(Be-et)<1e-6)return this.easeTo(i,l);const Ht=et<Be?-1:1;St=Math.abs(Math.log(et/Be))/je,ht=function(){return 0},Rt=function(gn){return Math.exp(Ht*je*gn)}}i.duration="duration"in i?+i.duration:1e3*St/("screenSpeed"in i?+i.screenSpeed/je:+i.speed),i.maxDuration&&i.duration>i.maxDuration&&(i.duration=0);const en=x!==j,hn=G!==E,vn=!m.isPaddingEqual(X),It=i.retainPadding===!1?m.clone():m,ln=Ht=>gn=>{const cn=gn*St,tn=1/Rt(cn);Ht.zoom=gn===1?$:v+Ht.scaleZoom(tn),en&&(Ht.bearing=r.af(x,j,gn)),hn&&(Ht.pitch=r.af(E,G,gn)),vn&&(It.interpolatePadding(L,X,gn),ve=It.centerPoint.add(ne));const Rn=gn===1?Te:Ht.unproject(Ce.add(Re.mult(ht(cn))).mult(tn));return Ht.setLocationAtPoint(Ht.renderWorldCopies?Rn.wrap():Rn,ve),Ht._updateCameraOnTerrain(),i.preloadOnly||this._fireMoveEvents(l),Ht};if(i.preloadOnly){const Ht=this._emulate(ln,i.duration,m);return this._preloadTiles(Ht),this}return this._zooming=!0,this._rotating=en,this._pitching=hn,this._padding=vn,this._prepareEase(l,!1),this._ease(ln(m),()=>this._afterEase(l),i),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_requestRenderFrame(i){}_cancelRenderFrame(i){}_stop(i,l){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const m=this._onEaseEnd;this._onEaseEnd=void 0,m.call(this,l)}if(!i){const m=this.handlers;m&&m.stop(!1)}return this}_ease(i,l,m){m.animate===!1||m.duration===0?(i(1),l()):(this._easeStart=r.q.now(),this._easeOptions=m,this._onEaseFrame=i,this._onEaseEnd=l,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const i=Math.min((r.q.now()-this._easeStart)/this._easeOptions.duration,1),l=this._onEaseFrame;l&&l(this._easeOptions.easing(i)),i<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(i,l){i=r.bF(i,-180,180);const m=Math.abs(i-l);return Math.abs(i-360-l)<m&&(i-=360),Math.abs(i+360-l)<m&&(i+=360),i}_normalizeCenter(i){const l=this.transform;if(l.maxBounds||l.projection.name!=="globe"&&!l.renderWorldCopies)return;const m=i.lng-l.center.lng;i.lng+=m>180?-360:m<-180?360:0}_prefersReducedMotion(i){return this._respectPrefersReducedMotion&&r.q.prefersReducedMotion&&!(i&&i.essential)}_emulate(i,l,m){const v=Math.ceil(15*l/1e3),x=[],E=i(m.clone());for(let L=0;L<=v;L++){const $=E(L/v);x.push($.clone())}return x}_preloadTiles(i,l){}}class u_{constructor(i={}){this.options=i,r.aP(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(i){const l=this.options&&this.options.compact,m=i._getUIString("AttributionControl.ToggleAttribution");this._map=i,this._container=N("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=N("button","mapboxgl-ctrl-attrib-button",this._container),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._compactButton.setAttribute("aria-label",m);const v=N("span","mapboxgl-ctrl-icon",this._compactButton);return v.setAttribute("aria-hidden","true"),v.setAttribute("title",m),this._innerContainer=N("div","mapboxgl-ctrl-attrib-inner",this._container),l&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),l===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let i=this._editLink;i||(i=this._editLink=this._container.querySelector(".mapbox-improve-map"));const l=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||r.e.ACCESS_TOKEN}];if(i){const m=l.reduce((v,x,E)=>(x.value&&(v+=`${x.key}=${x.value}${E<l.length-1?"&":""}`),v),"?");i.href=`${r.e.FEEDBACK_URL}/${m}#${Pp(this._map,!0)}`,i.rel="noopener nofollow"}}_updateData(i){!i||i.sourceDataType!=="metadata"&&i.sourceDataType!=="visibility"&&i.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let i=[];if(this._map.style.stylesheet){const v=this._map.style.stylesheet;this.styleOwner=v.owner,this.styleId=v.id}const l=this._map.style._mergedSourceCaches;for(const v in l){const x=l[v];if(x.used){const E=x.getSource();E.attribution&&i.indexOf(E.attribution)<0&&i.push(E.attribution)}}i.sort((v,x)=>v.length-x.length),i=i.filter((v,x)=>{for(let E=x+1;E<i.length;E++)if(i[E].indexOf(v)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?i=[...this.options.customAttribution,...i]:i.unshift(this.options.customAttribution));const m=i.join(" | ");m!==this._attribHTML&&(this._attribHTML=m,i.length?(this._innerContainer.innerHTML=m,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class w0{constructor(){r.aP(["_updateLogo","_updateCompact"],this)}onAdd(i){this._map=i,this._container=N("div","mapboxgl-ctrl");const l=N("a","mapboxgl-ctrl-logo");return l.target="_blank",l.rel="noopener nofollow",l.href="https://www.mapbox.com/",l.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),l.setAttribute("rel","noopener nofollow"),this._container.appendChild(l),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(i){i&&i.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const i=this._map.style._sourceCaches;if(Object.entries(i).length===0)return!0;for(const l in i){const m=i[l].getSource();if(m.hasOwnProperty("mapbox_logo")&&!m.mapbox_logo)return!1}return!0}_updateCompact(){const i=this._container.children;if(i.length){const l=i[0];this._map.getCanvasContainer().offsetWidth<250?l.classList.add("mapboxgl-compact"):l.classList.remove("mapboxgl-compact")}}}class dc{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(i){const l=++this._id;return this._queue.push({callback:i,id:l,cancelled:!1}),l}remove(i){const l=this._currentlyRunning,m=l?this._queue.concat(l):this._queue;for(const v of m)if(v.id===i)return void(v.cancelled=!0)}run(i=0){const l=this._currentlyRunning=this._queue;this._queue=[];for(const m of l)if(!m.cancelled&&(m.callback(i),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}class c_{constructor(i){this.jumpTo(i)}getValue(i){if(i<=this._startTime)return this._start;if(i>=this._endTime)return this._end;const l=r.cB((i-this._startTime)/(this._endTime-this._startTime));return this._start*(1-l)+this._end*l}isEasing(i){return i>=this._startTime&&i<=this._endTime}jumpTo(i){this._startTime=-1/0,this._endTime=-1/0,this._start=i,this._end=i}easeTo(i,l,m){this._start=this.getValue(l),this._end=i,this._startTime=l,this._endTime=l+m}}const ma={"AttributionControl.ToggleAttribution":"Toggle attribution","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox homepage","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use  + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"},ga=["mouseenter","mouseover","mouseleave","mouseout"];class fc extends r.z{constructor(i,l,m,v){const{point:x,lngLat:E,originalEvent:L,target:$}=i;super(i.type,{point:x,lngLat:E,originalEvent:L,target:$}),this.preventDefault=()=>{i.preventDefault()},this.id=l,this.interaction=m,this.feature=v}}class hc{constructor(i){this.map=i,this.interactionsByType=new Map,this.typeById=new Map,this.filters=new Map,this.delegatedHandlers=new Map,this.handleType=this.handleType.bind(this)}add(i,l){if(this.typeById.has(i))throw new Error(`Interaction id "${i}" already exists.`);const{type:m,filter:v}=l;v&&this.filters.set(i,r.aZ(v));const x=this.interactionsByType.get(m)||new Map;if(x.size===0){if(ga.includes(m)){const{mousemove:E,mouseout:L}=this._createDelegatedHandlers(i,l);this.map.on("mousemove",E),this.map.on("mouseout",L),this.delegatedHandlers.set(i,{mousemove:E,mouseout:L})}else this.map.on(m,this.handleType);this.interactionsByType.set(m,x)}x.set(i,l),this.typeById.set(i,m)}get(i){const l=this.typeById.get(i);if(!l)return;const m=this.interactionsByType.get(l);return m?m.get(i):void 0}remove(i){const l=this.typeById.get(i);if(!l)return;this.typeById.delete(i),this.filters.delete(i);const m=this.interactionsByType.get(l);if(m){if(m.delete(i),this.delegatedHandlers.has(i)){const{mousemove:v,mouseout:x}=this.delegatedHandlers.get(i);this.map.off("mousemove",v),this.map.off("mouseout",x),this.delegatedHandlers.delete(i)}m.size===0&&this.map.off(l,this.handleType)}}queryTargets(i,l){const m=[];for(const[v,x]of l)x.target&&m.push({targetId:v,target:x.target,filter:this.filters.get(v)});return this.map.style.queryRenderedTargets(i,m,this.map.transform)}handleType(i,l){const m=this.interactionsByType.get(i.type),v=Array.from(m).reverse();l=l||this.queryTargets(i.point,v);let x=!1;for(const E of l){for(const[L,$]of v){if(!$.target)continue;const j=E.variants?E.variants[L]:null;if(j){for(const G of j){const X=new r.cw(E,G);if($.handler(new fc(i,L,$,X))!==!1){x=!0;break}}if(x)break}}if(x)break}if(!x)for(const[E,L]of v){const{handler:$,target:j}=L;if(!j&&$(new fc(i,E,L,null))!==!1)break}}_createDelegatedHandlers(i,l){switch(l.type){case"mouseenter":case"mouseover":{let m=!1,v=new Set;return{mousemove:x=>{const E=this.queryTargets(x.point,[[i,l]]),L=new Set;if(!E.length)return m=!1,void v.clear();const $=[];for(const j of E)v.has(j.id)||(L.add(j.id),$.push(j));m&&!$.length||(m=!0,v=L,x.type=l.type,this.handleType(x,$))},mouseout:()=>{m=!1,v.clear()}}}case"mouseleave":case"mouseout":{let m=[];return{mousemove:v=>{const x=this.queryTargets(v.point,[[i,l]]);if(!x.length)return v.type=l.type,this.handleType(v,m),void(m=x);const E=[],L=new Set(x.map($=>$.id));for(const $ of m)L.has($.id)||E.push($);E.length&&(v.type=l.type,this.handleType(v,E)),m=x},mouseout:v=>{m.length&&(v.type=l.type,this.handleType(v,m),m=[])}}}}}}function gd(h,i){if(Array.isArray(h)&&Array.isArray(i)){const l=new Set(h),m=new Set(i);return l.size===m.size&&h.every(v=>m.has(v))}return r.bn(h,i)}const d_={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,antialias:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,respectPrefersReducedMotion:!0,crossSourceCollisions:!0,collectResourceTiming:!1,testMode:!1,precompilePrograms:!0,scaleFactor:1,spriteFormat:"auto"},Qr={showCompass:!0,showZoom:!0,visualizePitch:!1};class wu{constructor(i,l,m=!1){this._clickTolerance=10,this.element=l,this.mouseRotate=new s_({clickTolerance:i.dragRotate._mouseRotate._clickTolerance}),this.map=i,m&&(this.mousePitch=new Rp({clickTolerance:i.dragRotate._mousePitch._clickTolerance})),r.aP(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),l.addEventListener("mousedown",this.mousedown),l.addEventListener("touchstart",this.touchstart,{passive:!1}),l.addEventListener("touchmove",this.touchmove),l.addEventListener("touchend",this.touchend),l.addEventListener("touchcancel",this.reset)}down(i,l){this.mouseRotate.mousedown(i,l),this.mousePitch&&this.mousePitch.mousedown(i,l),q()}move(i,l){const m=this.map,v=this.mouseRotate.mousemoveWindow(i,l),x=v&&v.bearingDelta;if(x&&m.setBearing(m.getBearing()+x),this.mousePitch){const E=this.mousePitch.mousemoveWindow(i,l),L=E&&E.pitchDelta;L&&m.setPitch(m.getPitch()+L)}}off(){const i=this.element;i.removeEventListener("mousedown",this.mousedown),i.removeEventListener("touchstart",this.touchstart,{passive:!1}),i.removeEventListener("touchmove",this.touchmove),i.removeEventListener("touchend",this.touchend),i.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){J(),window.removeEventListener("mousemove",this.mousemove),window.removeEventListener("mouseup",this.mouseup)}mousedown(i){this.down(r.l({},i,{ctrlKey:!0,preventDefault:()=>i.preventDefault()}),he(this.element,i)),window.addEventListener("mousemove",this.mousemove),window.addEventListener("mouseup",this.mouseup)}mousemove(i){this.move(i,he(this.element,i))}mouseup(i){this.mouseRotate.mouseupWindow(i),this.mousePitch&&this.mousePitch.mouseupWindow(i),this.offTemp()}touchstart(i){i.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=le(this.element,i.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>i.preventDefault()},this._startPos))}touchmove(i){i.targetTouches.length!==1?this.reset():(this._lastPos=le(this.element,i.targetTouches)[0],this.move({preventDefault:()=>i.preventDefault()},this._lastPos))}touchend(i){i.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}function S0(h,i,l){if(h=new r.bO(h.lng,h.lat),i){const m=new r.bO(h.lng-360,h.lat),v=new r.bO(h.lng+360,h.lat),x=360*Math.ceil(Math.abs(h.lng-l.center.lng)/360),E=l.locationPoint(h).distSqr(i),L=i.x<0||i.y<0||i.x>l.width||i.y>l.height;l.locationPoint(m).distSqr(i)<E&&(L||Math.abs(m.lng-l.center.lng)<x)?h=m:l.locationPoint(v).distSqr(i)<E&&(L||Math.abs(v.lng-l.center.lng)<x)&&(h=v)}for(;Math.abs(h.lng-l.center.lng)>180;){const m=l.locationPoint(h);if(m.x>=0&&m.y>=0&&m.x<=l.width&&m.y<=l.height)break;h.lng>l.center.lng?h.lng-=360:h.lng+=360}return h}const f_={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class Uf extends r.E{constructor(i,l){if(super(),(i instanceof HTMLElement||l)&&(i=r.l({element:i},l)),r.aP(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=i&&i.anchor||"center",this._color=i&&i.color||"#3FB1CE",this._scale=i&&i.scale||1,this._draggable=i&&i.draggable||!1,this._clickTolerance=i&&i.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=i&&i.rotation||0,this._rotationAlignment=i&&i.rotationAlignment||"auto",this._pitchAlignment=i&&i.pitchAlignment&&i.pitchAlignment||"auto",this._updateMoving=()=>this._update(!0),this._occludedOpacity=i&&i.occludedOpacity||.2,i&&i.element)this._element=i.element,this._offset=r.P.convert(i&&i.offset||[0,0]);else{this._defaultMarker=!0,this._element=N("div");const x=41,E=27,L=H("svg",{display:"block",height:x*this._scale+"px",width:E*this._scale+"px",viewBox:`0 0 ${E} ${x}`},this._element),$=H("radialGradient",{id:"shadowGradient"},H("defs",{},L));H("stop",{offset:"10%","stop-opacity":.4},$),H("stop",{offset:"100%","stop-opacity":.05},$),H("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},L),H("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},L),H("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},L),H("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},L),this._offset=r.P.convert(i&&i.offset||[0,-14])}this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.hasAttribute("role")||this._element.setAttribute("role","img"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",x=>{x.preventDefault()}),this._element.addEventListener("mousedown",x=>{x.preventDefault()});const m=this._element.classList;for(const x in f_)m.remove(`mapboxgl-marker-anchor-${x}`);m.add(`mapboxgl-marker-anchor-${this._anchor}`);const v=i&&i.className?i.className.trim().split(/\s+/):[];m.add(...v),this._popup=null}addTo(i){return i===this._map||(this.remove(),this._map=i,i.getCanvasContainer().appendChild(this._element),i.on("move",this._updateMoving),i.on("moveend",this._update),i.on("remove",this._clearFadeTimer),i._addMarker(this),this.setDraggable(this._draggable),this._update(),i.on("click",this._onMapClick)),this}remove(){const i=this._map;return i&&(i.off("click",this._onMapClick),i.off("move",this._updateMoving),i.off("moveend",this._update),i.off("mousedown",this._addDragHandler),i.off("touchstart",this._addDragHandler),i.off("mouseup",this._onUp),i.off("touchend",this._onUp),i.off("mousemove",this._onMove),i.off("touchmove",this._onMove),i.off("remove",this._clearFadeTimer),i._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(i){return this._lngLat=r.bO.convert(i),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}getElement(){return this._element}setPopup(i){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),i){if(!("offset"in i.options)){const v=Math.sqrt(Math.pow(13.5,2)/2);i.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[v,-1*(38.1-13.5+v)],"bottom-right":[-v,-1*(38.1-13.5+v)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=i,i._marker=this,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(i){const l=i.code,m=i.charCode||i.keyCode;l!=="Space"&&l!=="Enter"&&m!==32&&m!==13||this.togglePopup()}_onMapClick(i){const l=i.originalEvent.target,m=this._element;this._popup&&(l===m||m.contains(l))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const i=this._popup;return i?(i.isOpen()?(i.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(i.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const i=this._map,l=this._pos;if(!i||!l)return!1;const m=i.unproject(l),v=i.getFreeCameraOptions();if(!v.position)return!1;const x=v.position.toLngLat();return x.distanceTo(m)<.9*x.distanceTo(this._lngLat)}_evaluateOpacity(){const i=this._map;if(!i)return;const l=this._pos;if(!l||l.x<0||l.x>i.transform.width||l.y<0||l.y>i.transform.height)return void this._clearFadeTimer();const m=i.unproject(l);let v;i._showingGlobe()&&r.dH(i.transform,this._lngLat)?v=0:(v=1-i._queryFogOpacity(m),i.transform._terrainEnabled()&&i.getTerrain()&&this._behindTerrain()&&(v*=this._occludedOpacity)),this._element.style.opacity=`${v}`,this._element.style.pointerEvents=v>0?"auto":"none",this._popup&&this._popup._setOpacity(v),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const i=this._pos;if(!i||!this._map)return;const l=this._offset.mult(this._scale);this._element.style.transform=`
            translate(${i.x}px,${i.y}px)
            ${f_[this._anchor]}
            ${this._calculateXYTransform()} ${this._calculateZTransform()}
            translate(${l.x}px,${l.y}px)
        `}_calculateXYTransform(){const i=this._pos,l=this._map,m=this.getPitchAlignment();if(!l||!i||m!=="map")return"";if(!l._showingGlobe()){const $=l.getPitch();return $?`rotateX(${$}deg)`:""}const v=r.c4(r.dI(l.transform,this._lngLat)),x=i.sub(r.dJ(l.transform)),E=Math.abs(x.x)+Math.abs(x.y);if(E===0)return"";const L=v/E;return`rotateX(${-x.y*L}deg) rotateY(${x.x*L}deg)`}_calculateZTransform(){const i=this._pos,l=this._map;if(!l||!i)return"";let m=0;const v=this.getRotationAlignment();if(v==="map")if(l._showingGlobe()){const x=l.project(new r.bO(this._lngLat.lng,this._lngLat.lat+.001)),E=l.project(new r.bO(this._lngLat.lng,this._lngLat.lat-.001)).sub(x);m=r.c4(Math.atan2(E.y,E.x))-90}else m=-l.getBearing();else if(v==="horizon"){const x=r.ac(4,6,l.getZoom()),E=r.dJ(l.transform);E.y+=x*l.transform.height;const L=i.sub(E),$=r.c4(Math.atan2(L.y,L.x));m=($>90?$-270:$+90)*(1-x)}return m+=this._rotation,m?`rotateZ(${m}deg)`:""}_update(i){cancelAnimationFrame(this._updateFrameId);const l=this._map;l&&(l.transform.renderWorldCopies&&(this._lngLat=S0(this._lngLat,this._pos,l.transform)),this._pos=l.project(this._lngLat),i===!0?this._updateFrameId=requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),l._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(l._showingGlobe()||l.getTerrain()||l.getFog())&&!this._fadeTimer&&(this._fadeTimer=window.setTimeout(this._evaluateOpacity.bind(this),60)))}))}getOffset(){return this._offset}setOffset(i){return this._offset=r.P.convert(i),this._update(),this}addClassName(i){return this._element.classList.add(i),this}removeClassName(i){return this._element.classList.remove(i),this}toggleClassName(i){return this._element.classList.toggle(i)}_onMove(i){const l=this._map;if(!l)return;const m=this._pointerdownPos,v=this._positionDelta;if(m&&v){if(!this._isDragging){const x=this._clickTolerance||l._clickTolerance;if(i.point.dist(m)<x)return;this._isDragging=!0}this._pos=i.point.sub(v),this._lngLat=l.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new r.z("dragstart"))),this.fire(new r.z("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const i=this._map;i&&(i.off("mousemove",this._onMove),i.off("touchmove",this._onMove)),this._state==="active"&&this.fire(new r.z("dragend")),this._state="inactive"}_addDragHandler(i){const l=this._map,m=this._pos;l&&m&&this._element.contains(i.originalEvent.target)&&(i.preventDefault(),this._positionDelta=i.point.sub(m),this._pointerdownPos=i.point,this._state="pending",l.on("mousemove",this._onMove),l.on("touchmove",this._onMove),l.once("mouseup",this._onUp),l.once("touchend",this._onUp))}setDraggable(i){this._draggable=!!i;const l=this._map;return l&&(i?(l.on("mousedown",this._addDragHandler),l.on("touchstart",this._addDragHandler)):(l.off("mousedown",this._addDragHandler),l.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(i){return this._rotation=i||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(i){return this._rotationAlignment=i||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment==="auto"||this._rotationAlignment==="horizon"&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(i){return this._pitchAlignment=i||"auto",this._update(),this}getPitchAlignment(){return this._pitchAlignment==="auto"?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(i){return this._occludedOpacity=i||.2,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}const Su={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},Rl={maxWidth:100,unit:"metric"},os={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"},ks={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},Fo=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function h_(h=new r.P(0,0),i="bottom"){if(typeof h=="number"){const l=Math.round(Math.sqrt(.5*Math.pow(h,2)));switch(i){case"top":return new r.P(0,h);case"top-left":return new r.P(l,l);case"top-right":return new r.P(-l,l);case"bottom":return new r.P(0,-h);case"bottom-left":return new r.P(l,-l);case"bottom-right":return new r.P(-l,-l);case"left":return new r.P(h,0);case"right":return new r.P(-h,0)}return new r.P(0,0)}return h instanceof r.P||Array.isArray(h)?r.P.convert(h):r.P.convert(h[i]||[0,0])}return{version:S,supported:V.supported,setRTLTextPlugin:r.dK,getRTLTextPluginStatus:r.dL,Map:class extends l_{constructor(h){M.mark(C.create);const i=h;if((h=r.l({},d_,h)).minZoom!=null&&h.maxZoom!=null&&h.minZoom>h.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(h.minPitch!=null&&h.maxPitch!=null&&h.minPitch>h.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(h.minPitch!=null&&h.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(h.maxPitch!=null&&h.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(h.antialias&&r.dF(window)&&(h.antialias=!1,r.w("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new Qh(h.minZoom,h.maxZoom,h.minPitch,h.maxPitch,h.renderWorldCopies),h),this._repaint=!!h.repaint,this._interactive=h.interactive,this._minTileCacheSize=h.minTileCacheSize,this._maxTileCacheSize=h.maxTileCacheSize,this._failIfMajorPerformanceCaveat=h.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=h.preserveDrawingBuffer,this._antialias=h.antialias,this._trackResize=h.trackResize,this._bearingSnap=h.bearingSnap,this._refreshExpiredTiles=h.refreshExpiredTiles,this._fadeDuration=h.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=h.crossSourceCollisions,this._collectResourceTiming=h.collectResourceTiming,this._language=this._parseLanguage(h.language),this._worldview=h.worldview,this._renderTaskQueue=new dc,this._domRenderTaskQueue=new dc,this._controls=[],this._markers=[],this._popups=[],this._mapId=r.aV(),this._locale=r.l({},ma,h.locale),this._clickTolerance=h.clickTolerance,this._cooperativeGestures=h.cooperativeGestures,this._performanceMetricsCollection=h.performanceMetricsCollection,this._tessellationStep=h.tessellationStep,this._containerWidth=0,this._containerHeight=0,this._showParseStatus=!0,this._precompilePrograms=h.precompilePrograms,this._scaleFactorChanged=!1,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new c_(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._frameId=0,this._scaleFactor=h.scaleFactor,this._requestManager=new Ve(h.transformRequest,h.accessToken,h.testMode),this._silenceAuthErrors=!!h.testMode,this._contextCreateOptions=h.contextCreateOptions?{...h.contextCreateOptions}:{},typeof h.container=="string"){const l=document.getElementById(h.container);if(!l)throw new Error(`Container '${h.container.toString()}' not found.`);this._container=l}else{if(!(h.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=h.container}if(this._container.childNodes.length>0&&r.w("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),h.maxBounds&&this.setMaxBounds(h.maxBounds),this._spriteFormat=h.spriteFormat,r.aP(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._tp||(this._tp=new Xg),this._tp.registerParameter(this,["Debug"],"showOverdrawInspector"),this._tp.registerParameter(this,["Debug"],"showTileBoundaries"),this._tp.registerParameter(this,["Debug"],"showParseStatus"),this._tp.registerParameter(this,["Debug"],"repaint"),this._tp.registerParameter(this,["Debug"],"showTileAABBs"),this._tp.registerParameter(this,["Debug"],"showPadding"),this._tp.registerParameter(this,["Debug"],"showCollisionBoxes",{noSave:!0}),this._tp.registerParameter(this.transform,["Debug"],"freezeTileCoverage",{noSave:!0},()=>{this._update()}),this._tp.registerParameter(this,["Debug","Wireframe"],"showTerrainWireframe"),this._tp.registerParameter(this,["Debug","Wireframe"],"showLayers2DWireframe"),this._tp.registerParameter(this,["Debug","Wireframe"],"showLayers3DWireframe"),this._tp.registerParameter(this,["Scaling"],"_scaleFactor",{min:.1,max:10,step:.1},()=>{this.setScaleFactor(this._scaleFactor)}),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");if(this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this._fullscreenchangeEvent="onfullscreenchange"in document?"fullscreenchange":"webkitfullscreenchange",window.addEventListener("online",this._onWindowOnline,!1),window.addEventListener("resize",this._onWindowResize,!1),window.addEventListener("orientationchange",this._onWindowResize,!1),window.addEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),window.addEventListener("visibilitychange",this._onVisibilityChange,!1),this.handlers=new x0(this,h),this._localFontFamily=h.localFontFamily,this._localIdeographFontFamily=h.localIdeographFontFamily,(h.style||!h.testMode)&&this.setStyle(h.style||r.e.DEFAULT_STYLE,{config:h.config,localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),h.projection&&this.setProjection(h.projection),this.indoor=new Pv(this),h.hash&&(this._hash=new kp(typeof h.hash=="string"&&h.hash||void 0).addTo(this)),!this._hash||!this._hash._onHashChange()){i.center==null&&i.zoom==null||(this.transform._unmodified=!1),this.jumpTo({center:h.center,zoom:h.zoom,bearing:h.bearing,pitch:h.pitch});const l=h.bounds;l&&(this.resize(),this.fitBounds(l,r.l({},h.fitBoundsOptions,{duration:0})))}this.resize(),h.attributionControl&&this.addControl(new u_({customAttribution:h.customAttribution})),this._logoControl=new w0,this.addControl(this._logoControl,h.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet),this._postStyleLoadEvent()}),this.on("data",l=>{this._update(l.dataType==="style"),this.fire(new r.z(`${l.dataType}data`,l))}),this.on("dataloading",l=>{this.fire(new r.z(`${l.dataType}dataloading`,l))}),this._interactions=new hc(this)}_getMapId(){return this._mapId}addControl(h,i){if(i===void 0&&(i=h.getDefaultPosition?h.getDefaultPosition():"top-right"),!h||!h.onAdd)return this.fire(new r.y(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const l=h.onAdd(this);this._controls.push(h);const m=this._controlPositions[i];return i.indexOf("bottom")!==-1?m.insertBefore(l,m.firstChild):m.appendChild(l),this}removeControl(h){if(!h||!h.onRemove)return this.fire(new r.y(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const i=this._controls.indexOf(h);return i>-1&&this._controls.splice(i,1),h.onRemove(this),this}hasControl(h){return this._controls.indexOf(h)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(h){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const i=!this._moving;return i&&this.fire(new r.z("movestart",h)).fire(new r.z("move",h)),this.fire(new r.z("resize",h)),i&&this.fire(new r.z("moveend",h)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(h){return this.transform.setMaxBounds(r.az.convert(h)),this._update()}setMinZoom(h){if((h=h??-2)>=-2&&h<=this.transform.maxZoom)return this.transform.minZoom=h,this._update(),this.getZoom()<h?this.setZoom(h):this.fire(new r.z("zoomstart")).fire(new r.z("zoom")).fire(new r.z("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(h){if((h=h??22)>=this.transform.minZoom)return this.transform.maxZoom=h,this._update(),this.getZoom()>h?this.setZoom(h):this.fire(new r.z("zoomstart")).fire(new r.z("zoom")).fire(new r.z("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(h){if((h=h??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(h>=0&&h<=this.transform.maxPitch)return this.transform.minPitch=h,this._update(),this.getPitch()<h?this.setPitch(h):this.fire(new r.z("pitchstart")).fire(new r.z("pitch")).fire(new r.z("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(h){if((h=h??85)>85)throw new Error("maxPitch must be less than or equal to 85");if(h>=this.transform.minPitch)return this.transform.maxPitch=h,this._update(),this.getPitch()>h?this.setPitch(h):this.fire(new r.z("pitchstart")).fire(new r.z("pitch")).fire(new r.z("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getScaleFactor(){return this._scaleFactor}setScaleFactor(h){return this._scaleFactor=h,this.painter.scaleFactor=h,this._tp.refreshUI(),this._scaleFactorChanged=!0,this.style._updateFilteredLayers(i=>i.type==="symbol"),this._update(!0),this}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(h){return this.transform.renderWorldCopies=h,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(h){return h==="auto"?navigator.language:Array.isArray(h)?h.length===0?void 0:h.map(i=>i==="auto"?navigator.language:i):h}setLanguage(h){const i=this._parseLanguage(h);if(!this.style||i===this._language)return this;this._language=i,this.style.reloadSources();for(const l of this._controls)l._setLanguage&&l._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(h){return this.style&&h!==this._worldview?(this._worldview=h,this.style.reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return this.transform.projection.name==="globe"}setProjection(h){return this._lazyInitEmptyStyle(),h?typeof h=="string"&&(h={name:h}):h=null,this._useExplicitProjection=!!h,this._prioritizeAndUpdateProjection(h,this.style.projection)}_updateProjectionTransition(){if(this.getProjection().name!=="globe")return;const h=this.transform,i=h.projection.name;let l;i==="globe"&&h.zoom>=r.bY?(h.setMercatorFromTransition(),l=!0):i==="mercator"&&h.zoom<r.bY&&(h.setProjection({name:"globe"}),l=!0),l&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate())}_prioritizeAndUpdateProjection(h,i){return this._updateProjection(h||i||{name:"mercator"})}_updateProjection(h){let i;return i=h.name==="globe"&&this.transform.zoom>=r.bY?this.transform.setMercatorFromTransition():this.transform.setProjection(h),this.style.applyProjectionUpdate(),i&&(this.painter.clearBackgroundTiles(),this.style.clearSources(),this._update(!0),this._forceMarkerAndPopupUpdate(!0)),this}project(h){return this.transform.locationPoint3D(r.bO.convert(h))}unproject(h){return this.transform.pointLocation3D(r.P.convert(h))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(h,i,l){const m=v=>{let x=[];if(Array.isArray(i)){const E=i.filter(L=>this.getLayer(L));x=E.length?this.queryRenderedFeatures(v,{layers:E}):[]}else x=this.queryRenderedFeatures(v,{target:i});return x};if(h==="mouseenter"||h==="mouseover"){let v=!1;return{listener:l,targets:i,delegates:{mousemove:E=>{const L=m(E.point);L.length?v||(v=!0,l.call(this,new As(h,this,E.originalEvent,{features:L}))):v=!1},mouseout:()=>{v=!1}}}}if(h==="mouseleave"||h==="mouseout"){let v=!1;return{listener:l,targets:i,delegates:{mousemove:L=>{m(L.point).length?v=!0:v&&(v=!1,l.call(this,new As(h,this,L.originalEvent)))},mouseout:L=>{v&&(v=!1,l.call(this,new As(h,this,L.originalEvent)))}}}}{const v=x=>{const E=m(x.point);E.length&&(x.features=E,l.call(this,x),delete x.features)};return{listener:l,targets:i,delegates:{[h]:v}}}}on(h,i,l){if(typeof i=="function"||l===void 0)return super.on(h,i);if(typeof i=="string"&&(i=[i]),!this._areTargetsValid(i))return this;const m=this._createDelegatedListener(h,i,l);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[h]=this._delegatedListeners[h]||[],this._delegatedListeners[h].push(m);for(const v in m.delegates)this.on(v,m.delegates[v]);return this}once(h,i,l){if(typeof i=="function"||l===void 0)return super.once(h,i);if(typeof i=="string"&&(i=[i]),!this._areTargetsValid(i))return this;const m=this._createDelegatedListener(h,i,l);for(const v in m.delegates)this.once(v,m.delegates[v]);return this}off(h,i,l){if(typeof i=="function"||l===void 0)return super.off(h,i);if(typeof i=="string"&&(i=[i]),!this._areTargetsValid(i))return this;const m=this._delegatedListeners?this._delegatedListeners[h]:void 0;return m&&(v=>{for(let x=0;x<v.length;x++){const E=v[x];if(E.listener===l&&gd(E.targets,i)){for(const L in E.delegates)this.off(L,E.delegates[L]);return v.splice(x,1),this}}})(m),this}queryRenderedFeatures(h,i){if(!this.style)return[];if(h===void 0||h instanceof r.P||Array.isArray(h)||i!==void 0||(i=h,h=void 0),h=h||[[0,0],[this.transform.width,this.transform.height]],!i){const x=this.style.queryRenderedFeatures(h,void 0,this.transform),E=this.style.queryRenderedFeatureset(h,void 0,this.transform);return x.concat(E)}let l=!0;if(i.target&&(l=this._isTargetValid(i.target),l&&!i.layers))return this.style.queryRenderedFeatureset(h,i,this.transform);let m=!0;if(i.layers&&Array.isArray(i.layers)){for(const x of i.layers)if(!this._isValidId(x)){m=!1;break}if(m&&!i.target)return this.style.queryRenderedFeatures(h,i,this.transform)}let v=[];return m&&(v=v.concat(this.style.queryRenderedFeatures(h,i,this.transform))),l&&(v=v.concat(this.style.queryRenderedFeatureset(h,i,this.transform))),v}querySourceFeatures(h,i){return!h||typeof h=="string"&&!this._isValidId(h)?[]:this.style.querySourceFeatures(h,i)}isPointOnSurface(h){const{name:i}=this.transform.projection;return i!=="globe"&&i!=="mercator"&&r.w(`${i} projection does not support isPointOnSurface, this API may behave unexpectedly.`),this.transform.isPointOnSurface(r.P.convert(h))}addInteraction(h,i){return this._interactions.add(h,i),this}removeInteraction(h){return this._interactions.remove(h),this}setStyle(h,i){return i=r.l({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},i),this.style&&h&&i.diff!==!1&&i.localFontFamily===this._localFontFamily&&i.localIdeographFontFamily===this._localIdeographFontFamily&&!i.config?(this.style._diffStyle(h,(l,m)=>{l?(r.w(`Unable to perform style diff: ${String(l.message||l.error||l)}. Rebuilding the style from scratch.`),this._updateStyle(h,i)):m&&this._update(!0)},()=>{this._postStyleLoadEvent()}),this):(this._localIdeographFontFamily=i.localIdeographFontFamily,this._localFontFamily=i.localFontFamily,this._updateStyle(h,i))}_getUIString(h){const i=this._locale[h];if(i==null)throw new Error(`Missing UI string '${h}'`);return i}_updateStyle(h,i){if(this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),h){const l=r.l({},i);i&&i.config&&(l.initialConfig=i.config,delete l.config),this.style=new Pa(this,l).load(h),this.style.setEventedParent(this,{style:this.style})}return this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new Pa(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(r.w("There is no style added to the map."),!1)}_isValidId(h){return h==null?(this.fire(new r.y(new Error("IDs can't be empty."))),!1):!r.cr(h)||(this.fire(new r.y(new Error(`IDs can't contain special symbols: "${h}".`))),!1)}_isTargetValid(h){return"featuresetId"in h?this._isValidId("importId"in h?h.importId:h.featuresetId):"layerId"in h&&this._isValidId(h.layerId)}_areTargetsValid(h){if(Array.isArray(h)){for(const i of h)if(!this._isValidId(i))return!1;return!0}return this._isTargetValid(h)}addSource(h,i){return this._isValidId(h)?(this._lazyInitEmptyStyle(),this.style.addSource(h,i),this._update(!0)):this}isSourceLoaded(h){return!!this._isValidId(h)&&!!this.style&&this.style._isSourceCacheLoaded(h)}areTilesLoaded(){return this.style.areTilesLoaded()}addSourceType(h,i,l){this._lazyInitEmptyStyle(),this.style.addSourceType(h,i,l)}removeSource(h){return this._isValidId(h)?(this.style.removeSource(h),this._updateTerrain(),this._update(!0)):this}getSource(h){return this._isValidId(h)?this.style.getOwnSource(h):null}addImage(h,i,{pixelRatio:l=1,sdf:m=!1,stretchX:v,stretchY:x,content:E}={}){if(this._lazyInitEmptyStyle(),i instanceof HTMLImageElement||ImageBitmap&&i instanceof ImageBitmap){const{width:L,height:$,data:j}=r.q.getImageData(i);this.style.addImage(h,{data:new r.r({width:L,height:$},j),pixelRatio:l,stretchX:v,stretchY:x,content:E,sdf:m,version:0,usvg:!1})}else if(i.width===void 0||i.height===void 0)this.fire(new r.y(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:L,height:$}=i,j=i;this.style.addImage(h,{data:new r.r({width:L,height:$},new Uint8Array(j.data)),pixelRatio:l,stretchX:v,stretchY:x,content:E,sdf:m,usvg:!1,version:0,userImage:j}),j.onAdd&&j.onAdd(this,h)}}updateImage(h,i){this._lazyInitEmptyStyle();const l=this.style.getImage(h);if(!l)return void this.fire(new r.y(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const m=i instanceof HTMLImageElement||ImageBitmap&&i instanceof ImageBitmap?r.q.getImageData(i):i,{width:v,height:x,data:E}=m;if(v===void 0||x===void 0)return void this.fire(new r.y(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(v!==(l.usvg?l.icon.usvg_tree.width:l.data.width)||x!==(l.usvg?l.icon.usvg_tree.height:l.data.height))return void this.fire(new r.y(new Error(`The width and height of the updated image (${v}, ${x})
                must be that same as the previous version of the image
                (${l.data.width}, ${l.data.height})`)));const L=!(i instanceof HTMLImageElement||ImageBitmap&&i instanceof ImageBitmap);let $=!1;l.usvg?(l.data=new r.r({width:v,height:x},new Uint8Array(E)),l.usvg=!1,l.icon=void 0,$=!0):l.data.replace(E,L),this.style.updateImage(h,l,$)}hasImage(h){return h?!!this.style&&!!this.style.getImage(h):(this.fire(new r.y(new Error("Missing required image id"))),!1)}removeImage(h){this.style.removeImage(h)}loadImage(h,i){r.o(this._requestManager.transformRequest(h,r.R.Image),(l,m)=>{i(l,m instanceof HTMLImageElement?r.q.getImageData(m):m)})}listImages(){return this.style.listImages()}addModel(h,i){this._lazyInitEmptyStyle(),this.style.addModel(h,i)}hasModel(h){return h?this.style.hasModel(h):(this.fire(new r.y(new Error("Missing required model id"))),!1)}removeModel(h){this.style.removeModel(h)}listModels(){return this.style.listModels()}addLayer(h,i){return this._isValidId(h.id)?(this._lazyInitEmptyStyle(),this.style.addLayer(h,i),this._update(!0)):this}getSlot(h){const i=this.getLayer(h);return i&&i.slot||null}setSlot(h,i){return this.style.setSlot(h,i),this.style.mergeLayers(),this._update(!0)}addImport(h,i){return this.style.addImport(h,i),this}updateImport(h,i){return typeof i!="string"&&i.id!==h?(this.removeImport(h),this.addImport(i)):(this.style.updateImport(h,i),this._update(!0))}removeImport(h){return this.style.removeImport(h),this}moveImport(h,i){return this.style.moveImport(h,i),this._update(!0)}moveLayer(h,i){return this._isValidId(h)?(this.style.moveLayer(h,i),this._update(!0)):this}removeLayer(h){return this._isValidId(h)?(this.style.removeLayer(h),this._update(!0)):this}getLayer(h){if(!this._isValidId(h))return null;const i=this.style.getOwnLayer(h);return i?i.type==="custom"?i.implementation:i.serialize():void 0}getSlots(){return this.style.getSlots()}setLayerZoomRange(h,i,l){return this._isValidId(h)?(this.style.setLayerZoomRange(h,i,l),this._update(!0)):this}setFilter(h,i,l={}){return this._isValidId(h)?(this.style.setFilter(h,i,l),this._update(!0)):this}getFilter(h){return this._isValidId(h)?this.style.getFilter(h):null}setPaintProperty(h,i,l,m={}){return this._isValidId(h)?(this.style.setPaintProperty(h,i,l,m),this._update(!0)):this}getPaintProperty(h,i){return this._isValidId(h)?this.style.getPaintProperty(h,i):null}setLayoutProperty(h,i,l,m={}){return this._isValidId(h)?(this.style.setLayoutProperty(h,i,l,m),this._update(!0)):this}getLayoutProperty(h,i){return this._isValidId(h)?this.style.getLayoutProperty(h,i):null}getSchema(h){return this.style.getSchema(h)}setSchema(h,i){return this.style.setSchema(h,i),this._update(!0)}getConfig(h){return this.style.getConfig(h)}setConfig(h,i){return this.style.setConfig(h,i),this._update(!0)}getConfigProperty(h,i){return this.style.getConfigProperty(h,i)}setConfigProperty(h,i,l){return this.style.setConfigProperty(h,i,l),this._update(!0)}getFeaturesetDescriptors(h){return this.style.getFeaturesetDescriptors(h)}setLights(h){if(this._lazyInitEmptyStyle(),h&&h.length===1&&h[0].type==="flat"){const i=h[0];i.properties?this.style.setFlatLight(i.properties,i.id,{}):this.style.setFlatLight({},"flat")}else this.style.setLights(h),this.painter.terrain&&(this.painter.terrain.invalidateRenderCache=!0);return this._update(!0)}getLights(){const h=this.style.getLights()||[];return h.length===0&&h.push({id:this.style.light.id,type:"flat",properties:this.style.getFlatLight()}),h}setLight(h,i={}){return console.log("The `map.setLight` function is deprecated, prefer using `map.setLights` with `flat` light type instead."),this.setLights([{id:"flat",type:"flat",properties:h}])}getLight(){return console.log("The `map.getLight` function is deprecated, prefer using `map.getLights` instead."),this.style.getFlatLight()}setTerrain(h){return this._lazyInitEmptyStyle(),!h&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(h),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(h){return this._lazyInitEmptyStyle(),this.style.setFog(h),this._update(!0)}getFog(){return this.style?this.style.getFog():null}setSnow(h){return this._lazyInitEmptyStyle(),this.style.setSnow(h),this._update(!0)}getSnow(){return this.style?this.style.getSnow():null}setRain(h){return this._lazyInitEmptyStyle(),this.style.setRain(h),this._update(!0)}getRain(){return this.style?this.style.getRain():null}setColorTheme(h){return this._lazyInitEmptyStyle(),this.style.setColorTheme(h),this._update(!0)}setImportColorTheme(h,i){return this._lazyInitEmptyStyle(),this.style.setImportColorTheme(h,i),this._update(!0)}setCamera(h){return this.style.setCamera(h),this._triggerCameraUpdate(h)}_triggerCameraUpdate(h){return this._update(this.transform.setOrthographicProjectionAtLowPitch(h["camera-projection"]==="orthographic"))}getCamera(){return this.style.camera}_queryFogOpacity(h){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(r.bO.convert(h),this.transform):0}setFeatureState(h,i){return h.source&&!this._isValidId(h.source)?this:(this.style.setFeatureState(h,i),this._update())}removeFeatureState(h,i){return h.source&&!this._isValidId(h.source)?this:(this.style.removeFeatureState(h,i),this._update())}getFeatureState(h){return h.source&&!this._isValidId(h.source)?null:this.style.getFeatureState(h)}_updateContainerDimensions(){if(!this._container)return;const h=this._container.getBoundingClientRect().width||400,i=this._container.getBoundingClientRect().height||300;let l,m,v,x=this._container;for(;x&&(!m||!v);){const E=window.getComputedStyle(x).transform;E&&E!=="none"&&(l=E.match(/matrix.*\((.+)\)/)[1].split(", "),l[0]&&l[0]!=="0"&&l[0]!=="1"&&(m=l[0]),l[3]&&l[3]!=="0"&&l[3]!=="1"&&(v=l[3])),x=x.parentElement}this._containerWidth=m?Math.abs(h/m):h,this._containerHeight=v?Math.abs(i/v):i}_detectMissingCSS(){window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&r.w("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const h=this._container;h.classList.add("mapboxgl-map"),(this._missingCSSCanary=N("div","mapboxgl-canary",h)).style.visibility="hidden",this._detectMissingCSS();const i=this._canvasContainer=N("div","mapboxgl-canvas-container",h);this._canvas=N("canvas","mapboxgl-canvas",i),this._interactive&&(i.classList.add("mapboxgl-interactive"),this._canvas.setAttribute("tabindex","0")),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const l=this._controlContainer=N("div","mapboxgl-control-container",h),m=this._controlPositions={};["top-left","top","top-right","right","bottom-right","bottom","bottom-left","left"].forEach(v=>{m[v]=N("div",`mapboxgl-ctrl-${v}`,l)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(h,i){const l=r.q.devicePixelRatio||1;this._canvas.width=l*Math.ceil(h),this._canvas.height=l*Math.ceil(i),this._canvas.style.width=`${h}px`,this._canvas.style.height=`${i}px`}_addMarker(h){this._markers.push(h)}_removeMarker(h){const i=this._markers.indexOf(h);i!==-1&&this._markers.splice(i,1)}_addPopup(h){this._popups.push(h)}_removePopup(h){const i=this._popups.indexOf(h);i!==-1&&this._popups.splice(i,1)}_setupPainter(){const h=r.l({},V.supported.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),i=this._canvas.getContext("webgl2",h);i?(Ae(i,!0),this.painter=new r_(i,this._contextCreateOptions,this.transform,this._scaleFactor,this._tp),this.on("data",l=>{l.dataType==="source"&&this.painter.setTileLoadedFlag(!0)}),r.m.testSupport(i)):this.fire(new r.y(new Error("Failed to initialize WebGL")))}_contextLost(h){h.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new r.z("webglcontextlost",{originalEvent:h}))}_contextRestored(h){this._setupPainter(),this.resize(),this._update(),this.fire(new r.z("webglcontextrestored",{originalEvent:h}))}_onMapScroll(h){if(h.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}idle(){return!this.isMoving()&&this.loaded()}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}frameReady(){return this.loaded()&&!this._placementDirty}_update(h){return this.style?(this._styleDirty=this._styleDirty||h,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(h){return this._update(),this._renderTaskQueue.add(h)}_cancelRenderFrame(h){this._renderTaskQueue.remove(h)}_requestDomTask(h){!this.loaded()||this.loaded()&&!this.isMoving()?h():this._domRenderTaskQueue.add(h)}_render(h){let i;this.fire(new r.z("renderstart")),++this._frameId;const l=this.painter.context.extTimerQuery,m=r.q.now(),v=this.painter.context.gl;if(this.listens("gpu-timing-frame")&&(i=v.createQuery(),v.beginQuery(l.TIME_ELAPSED_EXT,i)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],performance.now())),this._renderTaskQueue.run(h),this._domRenderTaskQueue.run(h),this._removed)return;this._updateProjectionTransition();const x=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const j=this.transform.zoom,G=this.transform.pitch,X=r.q.now(),Y=new r.a8(j,{now:X,fadeDuration:x,pitch:G,transition:this.style.transition});this.style.update(Y)}this.style&&this.style.hasFogTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let E=!1;this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),E=this._updateAverageElevation(m),this.style.updateSources(this.transform),this._forceMarkerAndPopupUpdate()):E=this._updateAverageElevation(m);const L=this.style&&this.style._updatePlacement(this.painter,this.painter.transform,this.showCollisionBoxes,x,this._crossSourceCollisions,this.painter.replacementSource,this._scaleFactorChanged);if(this._scaleFactorChanged&&(this._scaleFactorChanged=!1),L&&(this._placementDirty=L.needsRerender),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showParseStatus:this.showParseStatus,wireframe:{terrain:this.showTerrainWireframe,layers2D:this.showLayers2DWireframe,layers3D:this.showLayers3DWireframe},showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:x,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new r.z("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,M.mark(C.load),this.fire(new r.z("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&(this.style.snow||this.style.rain)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),i){const j=r.q.now()-m;v.endQuery(l.TIME_ELAPSED_EXT),setTimeout(()=>{const G=v.getQueryParameter(i,v.QUERY_RESULT)/1e6;v.deleteQuery(i),this.fire(new r.z("gpu-timing-frame",{cpuTime:j,gpuTime:G}))},50)}if(this.listens("gpu-timing-layer")){const j=this.painter.collectGpuTimers();setTimeout(()=>{const G=this.painter.queryGpuTimers(j);this.fire(new r.z("gpu-timing-layer",{layerTimes:G}))},50)}if(this.listens("gpu-timing-deferred-render")){const j=this.painter.collectDeferredRenderGpuQueries();setTimeout(()=>{const G=this.painter.queryGpuTimeDeferredRender(j);this.fire(new r.z("gpu-timing-deferred-render",{gpuTime:G}))},50)}const $=this._sourcesDirty||this._styleDirty||this._placementDirty||E;if($||this._repaint)this.triggerRepaint();else{const j=this.idle();if(j&&(E=this._updateAverageElevation(m,!0)),E)this.triggerRepaint();else if(this._triggerFrame(!1),j&&(this.fire(new r.z("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const G=this._calculateSpeedIndex();this.fire(new r.z("speedindexcompleted",{speedIndex:G})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||$||(this._fullyLoaded=!0,M.mark(C.fullLoad),this._performanceMetricsCollection&&jt(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(h){for(const i of this._markers)h&&!this.getRenderWorldCopies()&&(i._lngLat=i._lngLat.wrap()),i._update();for(const i of this._popups)!h||this.getRenderWorldCopies()||i._trackPointer||(i._lngLat=i._lngLat.wrap()),i._update()}_updateAverageElevation(h,i=!1){const l=v=>(this.transform.averageElevation=v,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return this.transform.averageElevation!==0&&l(0);const m=this.transform.elevation&&this.transform.elevation.exaggeration()!==this._averageElevationExaggeration;if(m||(i||h-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(h)){const v=this.transform.averageElevation;let x=this.transform.sampleAverageElevation();this.transform.elevation!=null&&(this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(x)?x=0:this._averageElevationLastSampledAt=h;const E=Math.abs(v-x);if(E>1){if(this._isInitialLoad||m)return this._averageElevation.jumpTo(x),l(x);this._averageElevation.easeTo(x,h,300)}else if(E>1e-4)return this._averageElevation.jumpTo(x),l(x)}return!!this._averageElevation.isEasing(h)&&l(this._averageElevation.getValue(h))}_authenticate(){Ne(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,h=>{if(h&&(h.message===Ie||h.status===401)){const i=this.painter.context.gl;Ae(i,!1),this._logoControl instanceof w0&&this._logoControl._updateLogo(),i&&i.clear(i.DEPTH_BUFFER_BIT|i.COLOR_BUFFER_BIT|i.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new r.y(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),Ct(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_postStyleLoadEvent(){this.style.globalId&&Bt(this._requestManager._customAccessToken,{map:this,skuToken:this._requestManager._skuToken,style:this.style.globalId,importedStyles:this.style.getImportGlobalIds()})}_updateTerrain(){const h=this._isDragging();this.painter.updateTerrain(this.style,h)}_calculateSpeedIndex(){const h=this.painter.canvasCopy(),i=this.painter.getCanvasCopiesAndTimestamps();i.timeStamps.push(performance.now());const l=this.painter.context.gl,m=l.createFramebuffer();function v(x){l.framebufferTexture2D(l.FRAMEBUFFER,l.COLOR_ATTACHMENT0,l.TEXTURE_2D,x,0);const E=new Uint8Array(l.drawingBufferWidth*l.drawingBufferHeight*4);return l.readPixels(0,0,l.drawingBufferWidth,l.drawingBufferHeight,l.RGBA,l.UNSIGNED_BYTE,E),E}return l.bindFramebuffer(l.FRAMEBUFFER,m),this._canvasPixelComparison(v(h),i.canvasCopies.map(v),i.timeStamps)}_canvasPixelComparison(h,i,l){let m=l[1]-l[0];const v=h.length/4;for(let x=0;x<i.length;x++){const E=i[x];let L=0;for(let $=0;$<E.length;$+=4)E[$]===h[$]&&E[$+1]===h[$+1]&&E[$+2]===h[$+2]&&E[$+3]===h[$+3]&&(L+=1);m+=(l[x+2]-l[x+1])*(1-L/v)}return m}remove(){this._hash&&this._hash.remove();for(const i of this._controls)i.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.indoor.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),window.removeEventListener("resize",this._onWindowResize,!1),window.removeEventListener("orientationchange",this._onWindowResize,!1),window.removeEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),window.removeEventListener("online",this._onWindowOnline,!1),window.removeEventListener("visibilitychange",this._onVisibilityChange,!1);const h=this.painter.context.gl.getExtension("WEBGL_lose_context");h&&h.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),an.delete(this.painter.context.gl),Gt.remove(),Oe.remove(),this._removed=!0,this.fire(new r.z("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(h){this._renderNextFrame=this._renderNextFrame||h,this.style&&!this._frame&&(this._frame=r.q.frame(i=>{const l=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,l&&this._render(i)}))}_preloadTiles(h){const i=this.style?this.style.getSourceCaches():[];return r.bl(i,(l,m)=>l._preloadTiles(h,m),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(h){this._trackResize&&this.resize({originalEvent:h})._update()}_onVisibilityChange(){document.visibilityState==="hidden"&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(h){this._showTileBoundaries!==h&&(this._showTileBoundaries=h,this._tp.refreshUI(),this._update())}get showParseStatus(){return!!this._showParseStatus}set showParseStatus(h){this._showParseStatus!==h&&(this._showParseStatus=h,this._tp.refreshUI(),this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(h){this._showTerrainWireframe!==h&&(this._showTerrainWireframe=h,this._tp.refreshUI(),this._update())}get showLayers2DWireframe(){return!!this._showLayers2DWireframe}set showLayers2DWireframe(h){this._showLayers2DWireframe!==h&&(this._showLayers2DWireframe=h,this._tp.refreshUI(),this._update())}get showLayers3DWireframe(){return!!this._showLayers3DWireframe}set showLayers3DWireframe(h){this._showLayers3DWireframe!==h&&(this._showLayers3DWireframe=h,this._tp.refreshUI(),this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(h){this._speedIndexTiming!==h&&(this._speedIndexTiming=h,this._update())}get showPadding(){return!!this._showPadding}set showPadding(h){this._showPadding!==h&&(this._showPadding=h,this._tp.refreshUI(),this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(h){this._showCollisionBoxes!==h&&(this._showCollisionBoxes=h,this._tp.refreshUI(),h?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(h){this._showOverdrawInspector!==h&&(this._showOverdrawInspector=h,this._tp.refreshUI(),this._update())}get repaint(){return!!this._repaint}set repaint(h){this._repaint!==h&&(this._repaint=h,this._tp.refreshUI(),this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(h){this._vertices=h,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(h){this._showTileAABBs!==h&&(this._showTileAABBs=h,this._tp.refreshUI(),h&&this._update())}_setCacheLimits(h,i){r.dG(h,i)}get version(){return S}},NavigationControl:class{constructor(h={}){this.options=r.l({},Qr,h),this._container=N("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",i=>i.preventDefault()),this.options.showZoom&&(r.aP(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",i=>{this._map&&this._map.zoomIn({},{originalEvent:i})}),N("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",i=>{this._map&&this._map.zoomOut({},{originalEvent:i})}),N("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(r.aP(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",i=>{const l=this._map;l&&(this.options.visualizePitch?l.resetNorthPitch({},{originalEvent:i}):l.resetNorth({},{originalEvent:i}))}),this._compassIcon=N("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const h=this._map;if(!h)return;const i=h.getZoom(),l=i===h.getMaxZoom(),m=i===h.getMinZoom();this._zoomInButton.disabled=l,this._zoomOutButton.disabled=m,this._zoomInButton.setAttribute("aria-disabled",l.toString()),this._zoomOutButton.setAttribute("aria-disabled",m.toString())}_rotateCompassArrow(){const h=this._map;if(!h)return;const i=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(h.transform.pitch*(Math.PI/180)),.5)}) rotateX(${h.transform.pitch}deg) rotateZ(${h.transform.angle*(180/Math.PI)}deg)`:`rotate(${h.transform.angle*(180/Math.PI)}deg)`;h._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=i)})}onAdd(h){return this._map=h,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),h.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&h.on("pitch",this._rotateCompassArrow),h.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new wu(h,this._compass,this.options.visualizePitch)),this._container}onRemove(){const h=this._map;h&&(this._container.remove(),this.options.showZoom&&h.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&h.off("pitch",this._rotateCompassArrow),h.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(h,i){const l=N("button",h,this._container);return l.type="button",l.addEventListener("click",i),l}_setButtonTitle(h,i){if(!this._map)return;const l=this._map._getUIString(`NavigationControl.${i}`);h.setAttribute("aria-label",l),h.firstElementChild&&h.firstElementChild.setAttribute("title",l)}},GeolocateControl:class extends r.E{constructor(h={}){super();const i=navigator.geolocation;this.options=r.l({geolocation:i},Su,h),r.aP(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=Ap(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(h){return this._map=h,this._container=N("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){this._geolocationWatchID!==void 0&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(h){const i=(l=!!this.options.geolocation)=>{this._supportsGeolocation=l,h(l)};this._supportsGeolocation!==void 0?h(this._supportsGeolocation):navigator.permissions!==void 0?navigator.permissions.query({name:"geolocation"}).then(l=>i(l.state!=="denied")).catch(()=>i()):i()}_isOutOfMapMaxBounds(h){const i=this._map.getMaxBounds(),l=h.coords;return!!i&&(l.longitude<i.getWest()||l.longitude>i.getEast()||l.latitude<i.getSouth()||l.latitude>i.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(h){if(this._map){if(this._isOutOfMapMaxBounds(h))return this._setErrorState(),this.fire(new r.z("outofmaxbounds",h)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=h,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(h),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(h),this.options.showUserLocation&&this._userLocationDotMarker.removeClassName("mapboxgl-user-location-dot-stale"),this.fire(new r.z("geolocate",h)),this._finish()}}_updateCamera(h){const i=new r.bO(h.coords.longitude,h.coords.latitude),l=h.coords.accuracy,m=this._map.getBearing(),v=r.l({bearing:m},this.options.fitBoundsOptions);this._map.fitBounds(i.toBounds(l),v,{geolocateSource:!0})}_updateMarker(h){if(h){const i=new r.bO(h.coords.longitude,h.coords.latitude);this._accuracyCircleMarker.setLngLat(i).addTo(this._map),this._userLocationDotMarker.setLngLat(i).addTo(this._map),this._accuracy=h.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const h=this._map.transform,i=r.bH(1,h._center.lat)*h.worldSize,l=Math.ceil(2*this._accuracy*i);this._circleElement.style.width=`${l}px`,this._circleElement.style.height=`${l}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&typeof this._heading=="number"?(this._userLocationDotMarker.setRotation(this._heading),this._userLocationDotMarker.addClassName("mapboxgl-user-location-show-heading")):(this._userLocationDotMarker.removeClassName("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(h){if(this._map){if(this.options.trackUserLocation)if(h.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const i=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",i),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",i),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(h.code===3&&this._noTimeout)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._userLocationDotMarker.addClassName("mapboxgl-user-location-dot-stale"),this.fire(new r.z("error",h)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(h){if(this._map!==void 0){if(this._container.addEventListener("contextmenu",i=>i.preventDefault()),this._geolocateButton=N("button","mapboxgl-ctrl-geolocate",this._container),N("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",h===!1){r.w("Geolocation support is not available so the GeolocateControl will be disabled.");const i=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",i),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",i)}else{const i=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",i),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",i)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=N("div","mapboxgl-user-location"),this._dotElement.appendChild(N("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(N("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new Uf({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=N("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Uf({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",i=>{i.geolocateSource||this._watchState!=="ACTIVE_LOCK"||i.originalEvent&&i.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new r.z("trackuserlocationend")))})}}_onDeviceOrientation(h){this._userLocationDotMarker&&(h.webkitCompassHeading?this._heading=h.webkitCompassHeading:h.absolute===!0&&(this._heading=-1*h.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return r.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new r.z("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new r.z("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new r.z("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let h;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(h={maximumAge:6e5,timeout:0},this._noTimeout=!0):(h=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,h),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=window.setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const h=()=>{"ondeviceorientationabsolute"in window?window.addEventListener("deviceorientationabsolute",this._onDeviceOrientation):window.addEventListener("deviceorientation",this._onDeviceOrientation)};typeof DeviceMotionEvent<"u"&&typeof DeviceMotionEvent.requestPermission=="function"?DeviceOrientationEvent.requestPermission().then(i=>{i==="granted"&&h()}).catch(console.error):h()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),window.removeEventListener("deviceorientation",this._onDeviceOrientation),window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:u_,ScaleControl:class{constructor(h={}){this.options=r.l({},Rl,h),this._isNumberFormatSupported=function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"short",unit:"meter"}),!0}catch{return!1}}(),r.aP(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const h=this.options.maxWidth||100,i=this._map,l=i._containerHeight/2,m=i._containerWidth/2-h/2,v=i.unproject([m,l]),x=i.unproject([m+h,l]),E=v.distanceTo(x);if(this.options.unit==="imperial"){const L=3.2808*E;L>5280?this._setScale(h,L/5280,"mile"):this._setScale(h,L,"foot")}else this.options.unit==="nautical"?this._setScale(h,E/1852,"nautical-mile"):E>=1e3?this._setScale(h,E/1e3,"kilometer"):this._setScale(h,E,"meter")}_setScale(h,i,l){this._map._requestDomTask(()=>{const m=function(x){const E=Math.pow(10,`${Math.floor(x)}`.length-1);let L=x/E;return L=L>=10?10:L>=5?5:L>=3?3:L>=2?2:L>=1?1:function($){const j=Math.pow(10,Math.ceil(-Math.log($)/Math.LN10));return Math.round($*j)/j}(L),E*L}(i),v=m/i;this._container.innerHTML=this._isNumberFormatSupported&&l!=="nautical-mile"?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"short",unit:l}).format(m):`${m}&nbsp;${os[l]}`,this._container.style.width=h*v+"px"})}onAdd(h){return this._map=h,this._language=h.getLanguage(),this._container=N("div","mapboxgl-ctrl mapboxgl-ctrl-scale",h.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(h){this._language=h,this._update()}setUnit(h){this.options.unit=h,this._update()}},FullscreenControl:class{constructor(h={}){this._fullscreen=!1,h&&h.container&&(h.container instanceof HTMLElement?this._container=h.container:r.w("Full screen control 'container' must be a DOM element.")),r.aP(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(h){return this._map=h,this._container||(this._container=this._map.getContainer()),this._controlContainer=N("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",r.w("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!document.fullscreenEnabled&&!document.webkitFullscreenEnabled)}_setupUI(){const h=this._fullscreenButton=N("button","mapboxgl-ctrl-fullscreen",this._controlContainer);N("span","mapboxgl-ctrl-icon",h).setAttribute("aria-hidden","true"),h.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const h=this._getTitle();this._fullscreenButton.setAttribute("aria-label",h),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",h)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(document.fullscreenElement||document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?document.exitFullscreen?document.exitFullscreen():document.webkitCancelFullScreen&&document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends r.E{constructor(h){super(),this.options=r.l(Object.create(ks),h),r.aP(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(h&&h.className?h.className.trim().split(/\s+/):[])}addTo(h){return this._map&&this.remove(),this._map=h,this.options.closeOnClick&&h.on("preclick",this._onClose),this.options.closeOnMove&&h.on("move",this._onClose),h.on("remove",this.remove),this._update(),h._addPopup(this),this._focusFirstElement(),this._trackPointer?(h.on("mousemove",this._onMouseEvent),h.on("mouseup",this._onMouseEvent),h._canvasContainer.classList.add("mapboxgl-track-pointer")):h.on("move",this._update),this.fire(new r.z("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const h=this._map;return h&&(h.off("move",this._update),h.off("move",this._onClose),h.off("preclick",this._onClose),h.off("click",this._onClose),h.off("remove",this.remove),h.off("mousemove",this._onMouseEvent),h.off("mouseup",this._onMouseEvent),h.off("drag",this._onMouseEvent),h._canvasContainer&&h._canvasContainer.classList.remove("mapboxgl-track-pointer"),h._removePopup(this),this._map=void 0),this.fire(new r.z("close")),this}getLngLat(){return this._lngLat}setLngLat(h){this._lngLat=r.bO.convert(h),this._pos=null,this._trackPointer=!1,this._update();const i=this._map;return i&&(i.on("move",this._update),i.off("mousemove",this._onMouseEvent),i._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const h=this._map;return h&&(h.off("move",this._update),h.on("mousemove",this._onMouseEvent),h.on("drag",this._onMouseEvent),h._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(h){return this.setDOMContent(document.createTextNode(h))}setHTML(h){const i=document.createDocumentFragment(),l=document.createElement("body");let m;for(l.innerHTML=h;m=l.firstChild,m;)i.appendChild(m);return this.setDOMContent(i)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(h){return this.options.maxWidth=h,this._update(),this}setDOMContent(h){let i=this._content;if(i)for(;i.hasChildNodes();)i.firstChild&&i.removeChild(i.firstChild);else i=this._content=N("div","mapboxgl-popup-content",this._container||void 0);if(i.appendChild(h),this.options.closeButton){const l=this._closeButton=N("button","mapboxgl-popup-close-button",i);l.type="button",l.setAttribute("aria-label","Close popup"),l.setAttribute("aria-hidden","true"),l.innerHTML="&#215;",l.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(h){return this._classList.add(h),this._updateClassList(),this}removeClassName(h){return this._classList.delete(h),this._updateClassList(),this}setOffset(h){return this.options.offset=h,this._update(),this}toggleClassName(h){let i;return this._classList.delete(h)?i=!1:(this._classList.add(h),i=!0),this._updateClassList(),i}_onMouseEvent(h){this._update(h.point)}_getAnchor(h){if(this.options.anchor)return this.options.anchor;const i=this._map,l=this._container,m=this._pos;if(!i||!l||!m)return"bottom";const v=l.offsetWidth,x=l.offsetHeight,E=m.x<v/2,L=m.x>i.transform.width-v/2;if(m.y+h<x)return E?"top-left":L?"top-right":"top";if(m.y>i.transform.height-x){if(E)return"bottom-left";if(L)return"bottom-right"}return E?"left":L?"right":"bottom"}_updateClassList(){const h=this._container;if(!h)return;const i=[...this._classList];i.push("mapboxgl-popup"),this._anchor&&i.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&i.push("mapboxgl-popup-track-pointer"),h.className=i.join(" ")}_update(h){const i=this._map,l=this._content;if(!i||!this._lngLat&&!this._trackPointer||!l)return;let m=this._container;if(m||(m=this._container=N("div","mapboxgl-popup",i.getContainer()),this._tip=N("div","mapboxgl-popup-tip",m),m.appendChild(l)),this.options.maxWidth&&m.style.maxWidth!==this.options.maxWidth&&(m.style.maxWidth=this.options.maxWidth),i.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=S0(this._lngLat,this._pos,i.transform)),!this._trackPointer||h){const v=this._pos=this._trackPointer&&h instanceof r.P?h:i.project(this._lngLat),x=h_(this.options.offset),E=this._anchor=this._getAnchor(x.y),L=h_(this.options.offset,E),$=v.add(L).round();i._requestDomTask(()=>{this._container&&E&&(this._container.style.transform=`${f_[E]} translate(${$.x}px,${$.y}px)`)})}if(!this._marker&&i._showingGlobe()){const v=r.dH(i.transform,this._lngLat)?0:1;this._setOpacity(v)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const h=this._container.querySelector(Fo);h&&h.focus()}_onClose(){this.remove()}_setOpacity(h){this._container&&(this._container.style.opacity=`${h}`),this._content&&(this._content.style.pointerEvents=h?"auto":"none")}},Marker:Uf,Style:Pa,LngLat:r.bO,LngLatBounds:r.az,Point:r.P,MercatorCoordinate:r.aa,FreeCameraOptions:qc,Evented:r.E,config:r.e,prewarm:r.dM,clearPrewarmedResources:r.dN,get accessToken(){return r.e.ACCESS_TOKEN},set accessToken(h){r.e.ACCESS_TOKEN=h},get baseApiUrl(){return r.e.API_URL},set baseApiUrl(h){r.e.API_URL=h},get workerCount(){return r.dO.workerCount},set workerCount(h){r.dO.workerCount=h},get maxParallelImageRequests(){return r.e.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(h){r.e.MAX_PARALLEL_IMAGE_REQUESTS=h},clearStorage(h){r.dP(h)},get workerUrl(){return r.dQ.workerUrl},set workerUrl(h){r.dQ.workerUrl=h},get workerClass(){return r.dQ.workerClass},set workerClass(h){r.dQ.workerClass=h},get workerParams(){return r.dQ.workerParams},set workerParams(h){r.dQ.workerParams=h},get dracoUrl(){return r.dR()},set dracoUrl(h){r.dS(h)},get meshoptUrl(){return r.dT()},set meshoptUrl(h){r.dU(h)},setNow:r.q.setNow,restoreNow:r.q.restoreNow}});var y=d;return y})})(CB);var Nge=CB.exports;const ms=qa(Nge);var MB={exports:{}};(function(e){function t(C){if(C=Object.assign({},C),!(this instanceof t))throw new Error("MapboxLanguage needs to be called with the new keyword");this.setLanguage=this.setLanguage.bind(this),this._initialStyleUpdate=this._initialStyleUpdate.bind(this),this._defaultLanguage=C.defaultLanguage,this._isLanguageField=C.languageField||/^name_/,this._getLanguageField=C.getLanguageField||function(P){return P==="mul"?"name":`name_${P}`},this._languageSource=C.languageSource||null,this._languageTransform=C.languageTransform,this._excludedLayerIds=C.excludedLayerIds||[],this.supportedLanguages=C.supportedLanguages||["ar","de","en","es","fr","it","ja","ko","mul","pt","ru","vi","zh-Hans","zh-Hant"]}const o=/^\{name/;function a(C,M){const P=Array.isArray(M)&&M[0]==="get";return P&&o.test(M[1])&&console.warn("This plugin no longer supports the use of token syntax (e.g. {name}). Please use a get expression. See https://docs.mapbox.com/mapbox-gl-js/style-spec/expressions/ for more details."),P&&C.test(M[1])}function d(C,M,P){if(Array.isArray(M))for(let z=1;z<M.length;z++)Array.isArray(M[z])&&(a(C,M[z])&&(M[z][1]=P),d(C,M[z],P))}function p(C,M,P){if(a(C,M)&&(M[1]=P),d(C,M,P),M[0]==="get"&&M[1]==="name"){const z=M.slice();M=["coalesce",["get",P],z]}return M}function y(C,M,P,z){return M.layout&&M.layout["text-field"]&&z.indexOf(M.id)===-1?Object.assign({},M,{layout:Object.assign({},M.layout,{"text-field":p(C,M.layout["text-field"],P)})}):M}function r(C){const M=Object.keys(C.sources).filter(P=>{const z=C.sources[P].url;return z&&z.indexOf("mapbox.mapbox-streets-v8")>-1||/mapbox-streets-v[1-9][1-9]/.test(z)});if(!M.length)throw new Error('If using MapboxLanguage with a Mapbox style, the style must be based on vector tile version 8, e.g. "streets-v11"');return M[0]}t.prototype.setLanguage=function(C,M){if(this.supportedLanguages.indexOf(M)<0)throw new Error(`Language ${M} is not supported`);const P=this._languageSource||r(C);if(!P)return C;const z=this._getLanguageField(M),F=this._isLanguageField,V=this._excludedLayerIds,N=C.layers.map(U=>U.source===P?y(F,U,z,V):U),H=Object.assign({},C,{layers:N});return this._languageTransform?this._languageTransform(H,M):H},t.prototype._initialStyleUpdate=function(){const C=this._map.getStyle(),M=this._defaultLanguage||S(this.supportedLanguages);this._map.setStyle(this.setLanguage(C,M))};function S(C){const M=navigator.languages?navigator.languages[0]:navigator.language||navigator.userLanguage,P=M&&M.split("-");let z=M;return P.length>1&&(z=P[0]),C.indexOf(z)>-1?z:null}t.prototype.onAdd=function(C){return this._map=C,this._map.on("style.load",this._initialStyleUpdate),this._container=document.createElement("div"),this._container},t.prototype.onRemove=function(){this._map.off("style.load",this._initialStyleUpdate),this._map=void 0},e.exports=t})(MB);var Bge=MB.exports;const Vge=qa(Bge),gM=mU("map",{state:()=>({map:null}),actions:{setMapConfig(e){this.$state={...this.$state,...e}}}}),$ge={className:"brp"},Uge=We({__name:"brp",setup(e){const t=gM(),{map:o}=bD(t),a=xe(""),d=p=>{p==null||p.on("mousemove",y=>{const{lat:r,lng:S}=y.lngLat;if(r&&S){let C=`:${S.toFixed(3)} :${r.toFixed(3)}`;a.value=C}})};return Wt(()=>o.value,p=>{d(p)}),(p,y)=>(ae(),Pe("div",$ge,fn(a.value),1))}}),_M=(e,t)=>{const o=e.__vccOpts||e;for(const[a,d]of t)o[a]=d;return o},jge=_M(Uge,[["__scopeId","data-v-fd337e4c"]]),nC=function(e,t){const o={drag:[],click:[],mousemove:[],mousedown:[],mouseup:[],mouseout:[],keydown:[],keyup:[],touchstart:[],touchmove:[],touchend:[],tap:[]},a={on(p,y,r){if(o[p]===void 0)throw new Error(`Invalid event type: ${p}`);o[p].push({selector:y,fn:r})},render(p){t.store.featureChanged(p)}},d=function(p,y){const r=o[p];let S=r.length;for(;S--;){const C=r[S];if(C.selector(y)){C.fn.call(a,y)||t.store.render(),t.ui.updateMapClasses();break}}};return e.start.call(a),{render:e.render,stop(){e.stop&&e.stop()},trash(){e.trash&&(e.trash(),t.store.render())},combineFeatures(){e.combineFeatures&&e.combineFeatures()},uncombineFeatures(){e.uncombineFeatures&&e.uncombineFeatures()},drag(p){d("drag",p)},click(p){d("click",p)},mousemove(p){d("mousemove",p)},mousedown(p){d("mousedown",p)},mouseup(p){d("mouseup",p)},mouseout(p){d("mouseout",p)},keydown(p){d("keydown",p)},keyup(p){d("keyup",p)},touchstart(p){d("touchstart",p)},touchmove(p){d("touchmove",p)},touchend(p){d("touchend",p)},tap(p){d("tap",p)}}};var yM={},Dx={};Dx.RADIUS=6378137;Dx.FLATTENING=1/298.257223563;Dx.POLAR_RADIUS=63567523142e-4;var EO=Dx;yM.geometry=IB;yM.ring=rC;function IB(e){var t=0,o;switch(e.type){case"Polygon":return MO(e.coordinates);case"MultiPolygon":for(o=0;o<e.coordinates.length;o++)t+=MO(e.coordinates[o]);return t;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0;case"GeometryCollection":for(o=0;o<e.geometries.length;o++)t+=IB(e.geometries[o]);return t}}function MO(e){var t=0;if(e&&e.length>0){t+=Math.abs(rC(e[0]));for(var o=1;o<e.length;o++)t-=Math.abs(rC(e[o]))}return t}function rC(e){var t,o,a,d,p,y,r,S=0,C=e.length;if(C>2){for(r=0;r<C;r++)r===C-2?(d=C-2,p=C-1,y=0):r===C-1?(d=C-1,p=0,y=1):(d=r,p=r+1,y=r+2),t=e[d],o=e[p],a=e[y],S+=(ES(a[0])-ES(t[0]))*Math.sin(ES(o[1]));S=S*EO.RADIUS*EO.RADIUS/2}return S}function ES(e){return e*Math.PI/180}const ba={CANVAS:"mapboxgl-canvas",CONTROL_BASE:"mapboxgl-ctrl",CONTROL_PREFIX:"mapboxgl-ctrl-",CONTROL_BUTTON:"mapbox-gl-draw_ctrl-draw-btn",CONTROL_BUTTON_LINE:"mapbox-gl-draw_line",CONTROL_BUTTON_POLYGON:"mapbox-gl-draw_polygon",CONTROL_BUTTON_POINT:"mapbox-gl-draw_point",CONTROL_BUTTON_TRASH:"mapbox-gl-draw_trash",CONTROL_BUTTON_COMBINE_FEATURES:"mapbox-gl-draw_combine",CONTROL_BUTTON_UNCOMBINE_FEATURES:"mapbox-gl-draw_uncombine",CONTROL_GROUP:"mapboxgl-ctrl-group",ATTRIBUTION:"mapboxgl-ctrl-attrib",ACTIVE_BUTTON:"active",BOX_SELECT:"mapbox-gl-draw_boxselect"},il={HOT:"mapbox-gl-draw-hot",COLD:"mapbox-gl-draw-cold"},Mo={ADD:"add",MOVE:"move",DRAG:"drag",POINTER:"pointer",NONE:"none"},xa={POLYGON:"polygon",LINE:"line_string",POINT:"point"},$r={FEATURE:"Feature",POLYGON:"Polygon",LINE_STRING:"LineString",POINT:"Point",FEATURE_COLLECTION:"FeatureCollection",MULTI_PREFIX:"Multi",MULTI_POINT:"MultiPoint",MULTI_LINE_STRING:"MultiLineString",MULTI_POLYGON:"MultiPolygon"},Bi={DRAW_LINE_STRING:"draw_line_string",DRAW_POLYGON:"draw_polygon",DRAW_POINT:"draw_point",SIMPLE_SELECT:"simple_select",DIRECT_SELECT:"direct_select"},sa={CREATE:"draw.create",DELETE:"draw.delete",UPDATE:"draw.update",SELECTION_CHANGE:"draw.selectionchange",MODE_CHANGE:"draw.modechange",ACTIONABLE:"draw.actionable",RENDER:"draw.render",COMBINE_FEATURES:"draw.combine",UNCOMBINE_FEATURES:"draw.uncombine"},vv={MOVE:"move",CHANGE_PROPERTIES:"change_properties",CHANGE_COORDINATES:"change_coordinates"},$s={FEATURE:"feature",MIDPOINT:"midpoint",VERTEX:"vertex"},ls={ACTIVE:"true",INACTIVE:"false"},AB=["scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate"],Hge=-90,iC=-85,Gge=90,oC=85,Wge=-270,qge=270,kB=Object.freeze(Object.defineProperty({__proto__:null,LAT_MAX:Gge,LAT_MIN:Hge,LAT_RENDERED_MAX:oC,LAT_RENDERED_MIN:iC,LNG_MAX:qge,LNG_MIN:Wge,activeStates:ls,classes:ba,cursors:Mo,events:sa,geojsonTypes:$r,interactions:AB,meta:$s,modes:Bi,sources:il,types:xa,updateActions:vv},Symbol.toStringTag,{value:"Module"})),IO={Point:0,LineString:1,MultiLineString:1,Polygon:2};function Kge(e,t){const o=IO[e.geometry.type]-IO[t.geometry.type];return o===0&&e.geometry.type===$r.POLYGON?e.area-t.area:o}function PB(e){return e.map(t=>(t.geometry.type===$r.POLYGON&&(t.area=yM.geometry({type:$r.FEATURE,property:{},geometry:t.geometry})),t)).sort(Kge).map(t=>(delete t.area,t))}function RB(e,t=0){return[[e.point.x-t,e.point.y-t],[e.point.x+t,e.point.y+t]]}function ul(e){if(this._items={},this._nums={},this._length=e?e.length:0,!!e)for(let t=0,o=e.length;t<o;t++)this.add(e[t]),e[t]!==void 0&&(typeof e[t]=="string"?this._items[e[t]]=t:this._nums[e[t]]=t)}ul.prototype.add=function(e){return this.has(e)?this:(this._length++,typeof e=="string"?this._items[e]=this._length:this._nums[e]=this._length,this)};ul.prototype.delete=function(e){return this.has(e)===!1?this:(this._length--,delete this._items[e],delete this._nums[e],this)};ul.prototype.has=function(e){return typeof e!="string"&&typeof e!="number"?!1:this._items[e]!==void 0||this._nums[e]!==void 0};ul.prototype.values=function(){const e=[];return Object.keys(this._items).forEach(t=>{e.push({k:t,v:this._items[t]})}),Object.keys(this._nums).forEach(t=>{e.push({k:JSON.parse(t),v:this._nums[t]})}),e.sort((t,o)=>t.v-o.v).map(t=>t.k)};ul.prototype.clear=function(){return this._length=0,this._items={},this._nums={},this};const Zge=[$s.FEATURE,$s.MIDPOINT,$s.VERTEX],Xm={click:Yge,touch:Xge};function Yge(e,t,o){return OB(e,t,o,o.options.clickBuffer)}function Xge(e,t,o){return OB(e,t,o,o.options.touchBuffer)}function OB(e,t,o,a){if(o.map===null)return[];const d=e?RB(e,a):t,p={};o.options.styles&&(p.layers=o.options.styles.map(C=>C.id).filter(C=>o.map.getLayer(C)!=null));const y=o.map.queryRenderedFeatures(d,p).filter(C=>Zge.indexOf(C.properties.meta)!==-1),r=new ul,S=[];return y.forEach(C=>{const M=C.properties.id;r.has(M)||(r.add(M),S.push(C))}),PB(S)}function u1(e,t){const o=Xm.click(e,null,t),a={mouse:Mo.NONE};return o[0]&&(a.mouse=o[0].properties.active===ls.ACTIVE?Mo.MOVE:Mo.POINTER,a.feature=o[0].properties.meta),t.events.currentModeName().indexOf("draw")!==-1&&(a.mouse=Mo.ADD),t.ui.queueMapClasses(a),t.ui.updateMapClasses(),o[0]}function vM(e,t){const o=e.x-t.x,a=e.y-t.y;return Math.sqrt(o*o+a*a)}const Jge=4,Qge=12,e_e=500;function sC(e,t,o={}){const a=o.fineTolerance!=null?o.fineTolerance:Jge,d=o.grossTolerance!=null?o.grossTolerance:Qge,p=o.interval!=null?o.interval:e_e;e.point=e.point||t.point,e.time=e.time||t.time;const y=vM(e.point,t.point);return y<a||y<d&&t.time-e.time<p}const t_e=25,n_e=250;function aC(e,t,o={}){const a=o.tolerance!=null?o.tolerance:t_e,d=o.interval!=null?o.interval:n_e;return e.point=e.point||t.point,e.time=e.time||t.time,vM(e.point,t.point)<a&&t.time-e.time<d}let r_e=(e,t=21)=>(o=t)=>{let a="",d=o|0;for(;d--;)a+=e[Math.random()*e.length|0];return a};const i_e=r_e("0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",32);function bM(){return i_e()}const aa=function(e,t){this.ctx=e,this.properties=t.properties||{},this.coordinates=t.geometry.coordinates,this.id=t.id||bM(),this.type=t.geometry.type};aa.prototype.changed=function(){this.ctx.store.featureChanged(this.id)};aa.prototype.incomingCoords=function(e){this.setCoordinates(e)};aa.prototype.setCoordinates=function(e){this.coordinates=e,this.changed()};aa.prototype.getCoordinates=function(){return JSON.parse(JSON.stringify(this.coordinates))};aa.prototype.setProperty=function(e,t){this.properties[e]=t};aa.prototype.toGeoJSON=function(){return JSON.parse(JSON.stringify({id:this.id,type:$r.FEATURE,properties:this.properties,geometry:{coordinates:this.getCoordinates(),type:this.type}}))};aa.prototype.internal=function(e){const t={id:this.id,meta:$s.FEATURE,"meta:type":this.type,active:ls.INACTIVE,mode:e};if(this.ctx.options.userProperties)for(const o in this.properties)t[`user_${o}`]=this.properties[o];return{type:$r.FEATURE,properties:t,geometry:{coordinates:this.getCoordinates(),type:this.type}}};const uf=function(e,t){aa.call(this,e,t)};uf.prototype=Object.create(aa.prototype);uf.prototype.isValid=function(){return typeof this.coordinates[0]=="number"&&typeof this.coordinates[1]=="number"};uf.prototype.updateCoordinate=function(e,t,o){arguments.length===3?this.coordinates=[t,o]:this.coordinates=[e,t],this.changed()};uf.prototype.getCoordinate=function(){return this.getCoordinates()};const Ku=function(e,t){aa.call(this,e,t)};Ku.prototype=Object.create(aa.prototype);Ku.prototype.isValid=function(){return this.coordinates.length>1};Ku.prototype.addCoordinate=function(e,t,o){this.changed();const a=parseInt(e,10);this.coordinates.splice(a,0,[t,o])};Ku.prototype.getCoordinate=function(e){const t=parseInt(e,10);return JSON.parse(JSON.stringify(this.coordinates[t]))};Ku.prototype.removeCoordinate=function(e){this.changed(),this.coordinates.splice(parseInt(e,10),1)};Ku.prototype.updateCoordinate=function(e,t,o){const a=parseInt(e,10);this.coordinates[a]=[t,o],this.changed()};const Ka=function(e,t){aa.call(this,e,t),this.coordinates=this.coordinates.map(o=>o.slice(0,-1))};Ka.prototype=Object.create(aa.prototype);Ka.prototype.isValid=function(){return this.coordinates.length===0?!1:this.coordinates.every(e=>e.length>2)};Ka.prototype.incomingCoords=function(e){this.coordinates=e.map(t=>t.slice(0,-1)),this.changed()};Ka.prototype.setCoordinates=function(e){this.coordinates=e,this.changed()};Ka.prototype.addCoordinate=function(e,t,o){this.changed();const a=e.split(".").map(p=>parseInt(p,10));this.coordinates[a[0]].splice(a[1],0,[t,o])};Ka.prototype.removeCoordinate=function(e){this.changed();const t=e.split(".").map(a=>parseInt(a,10)),o=this.coordinates[t[0]];o&&(o.splice(t[1],1),o.length<3&&this.coordinates.splice(t[0],1))};Ka.prototype.getCoordinate=function(e){const t=e.split(".").map(a=>parseInt(a,10)),o=this.coordinates[t[0]];return JSON.parse(JSON.stringify(o[t[1]]))};Ka.prototype.getCoordinates=function(){return this.coordinates.map(e=>e.concat([e[0]]))};Ka.prototype.updateCoordinate=function(e,t,o){this.changed();const a=e.split("."),d=parseInt(a[0],10),p=parseInt(a[1],10);this.coordinates[d]===void 0&&(this.coordinates[d]=[]),this.coordinates[d][p]=[t,o]};const o_e={MultiPoint:uf,MultiLineString:Ku,MultiPolygon:Ka},zx=(e,t,o,a,d)=>{const p=o.split("."),y=parseInt(p[0],10),r=p[1]?p.slice(1).join("."):null;return e[y][t](r,a,d)},na=function(e,t){if(aa.call(this,e,t),delete this.coordinates,this.model=o_e[t.geometry.type],this.model===void 0)throw new TypeError(`${t.geometry.type} is not a valid type`);this.features=this._coordinatesToFeatures(t.geometry.coordinates)};na.prototype=Object.create(aa.prototype);na.prototype._coordinatesToFeatures=function(e){const t=this.model.bind(this);return e.map(o=>new t(this.ctx,{id:bM(),type:$r.FEATURE,properties:{},geometry:{coordinates:o,type:this.type.replace("Multi","")}}))};na.prototype.isValid=function(){return this.features.every(e=>e.isValid())};na.prototype.setCoordinates=function(e){this.features=this._coordinatesToFeatures(e),this.changed()};na.prototype.getCoordinate=function(e){return zx(this.features,"getCoordinate",e)};na.prototype.getCoordinates=function(){return JSON.parse(JSON.stringify(this.features.map(e=>e.type===$r.POLYGON?e.getCoordinates():e.coordinates)))};na.prototype.updateCoordinate=function(e,t,o){zx(this.features,"updateCoordinate",e,t,o),this.changed()};na.prototype.addCoordinate=function(e,t,o){zx(this.features,"addCoordinate",e,t,o),this.changed()};na.prototype.removeCoordinate=function(e){zx(this.features,"removeCoordinate",e),this.changed()};na.prototype.getFeatures=function(){return this.features};function bi(e){this.map=e.map,this.drawConfig=JSON.parse(JSON.stringify(e.options||{})),this._ctx=e}bi.prototype.setSelected=function(e){return this._ctx.store.setSelected(e)};bi.prototype.setSelectedCoordinates=function(e){this._ctx.store.setSelectedCoordinates(e),e.reduce((t,o)=>(t[o.feature_id]===void 0&&(t[o.feature_id]=!0,this._ctx.store.get(o.feature_id).changed()),t),{})};bi.prototype.getSelected=function(){return this._ctx.store.getSelected()};bi.prototype.getSelectedIds=function(){return this._ctx.store.getSelectedIds()};bi.prototype.isSelected=function(e){return this._ctx.store.isSelected(e)};bi.prototype.getFeature=function(e){return this._ctx.store.get(e)};bi.prototype.select=function(e){return this._ctx.store.select(e)};bi.prototype.deselect=function(e){return this._ctx.store.deselect(e)};bi.prototype.deleteFeature=function(e,t={}){return this._ctx.store.delete(e,t)};bi.prototype.addFeature=function(e,t={}){return this._ctx.store.add(e,t)};bi.prototype.clearSelectedFeatures=function(){return this._ctx.store.clearSelected()};bi.prototype.clearSelectedCoordinates=function(){return this._ctx.store.clearSelectedCoordinates()};bi.prototype.setActionableState=function(e={}){const t={trash:e.trash||!1,combineFeatures:e.combineFeatures||!1,uncombineFeatures:e.uncombineFeatures||!1};return this._ctx.events.actionable(t)};bi.prototype.changeMode=function(e,t={},o={}){return this._ctx.events.changeMode(e,t,o)};bi.prototype.fire=function(e,t){return this._ctx.events.fire(e,t)};bi.prototype.updateUIClasses=function(e){return this._ctx.ui.queueMapClasses(e)};bi.prototype.activateUIButton=function(e){return this._ctx.ui.setActiveButton(e)};bi.prototype.featuresAt=function(e,t,o="click"){if(o!=="click"&&o!=="touch")throw new Error("invalid buffer type");return Xm[o](e,t,this._ctx)};bi.prototype.newFeature=function(e){const t=e.geometry.type;return t===$r.POINT?new uf(this._ctx,e):t===$r.LINE_STRING?new Ku(this._ctx,e):t===$r.POLYGON?new Ka(this._ctx,e):new na(this._ctx,e)};bi.prototype.isInstanceOf=function(e,t){if(e===$r.POINT)return t instanceof uf;if(e===$r.LINE_STRING)return t instanceof Ku;if(e===$r.POLYGON)return t instanceof Ka;if(e==="MultiFeature")return t instanceof na;throw new Error(`Unknown feature class: ${e}`)};bi.prototype.doRender=function(e){return this._ctx.store.featureChanged(e)};bi.prototype.onSetup=function(){};bi.prototype.onDrag=function(){};bi.prototype.onClick=function(){};bi.prototype.onMouseMove=function(){};bi.prototype.onMouseDown=function(){};bi.prototype.onMouseUp=function(){};bi.prototype.onMouseOut=function(){};bi.prototype.onKeyUp=function(){};bi.prototype.onKeyDown=function(){};bi.prototype.onTouchStart=function(){};bi.prototype.onTouchMove=function(){};bi.prototype.onTouchEnd=function(){};bi.prototype.onTap=function(){};bi.prototype.onStop=function(){};bi.prototype.onTrash=function(){};bi.prototype.onCombineFeature=function(){};bi.prototype.onUncombineFeature=function(){};bi.prototype.toDisplayFeatures=function(){throw new Error("You must overwrite toDisplayFeatures")};const LB={drag:"onDrag",click:"onClick",mousemove:"onMouseMove",mousedown:"onMouseDown",mouseup:"onMouseUp",mouseout:"onMouseOut",keyup:"onKeyUp",keydown:"onKeyDown",touchstart:"onTouchStart",touchmove:"onTouchMove",touchend:"onTouchEnd",tap:"onTap"},s_e=Object.keys(LB);function a_e(e){const t=Object.keys(e);return function(o,a={}){let d={};const p=t.reduce((r,S)=>(r[S]=e[S],r),new bi(o));function y(r){return S=>p[r](d,S)}return{start(){d=p.onSetup(a),s_e.forEach(r=>{const S=LB[r];let C=()=>!1;e[S]&&(C=()=>!0),this.on(r,C,y(S))})},stop(){p.onStop(d)},trash(){p.onTrash(d)},combineFeatures(){p.onCombineFeatures(d)},uncombineFeatures(){p.onUncombineFeatures(d)},render(r,S){p.toDisplayFeatures(d,r,S)}}}}function l_e(e){const t=Object.keys(e.options.modes).reduce((z,F)=>(z[F]=a_e(e.options.modes[F]),z),{});let o={},a={};const d={};let p=null,y=null;d.drag=function(z,F){F({point:z.point,time:new Date().getTime()})?(e.ui.queueMapClasses({mouse:Mo.DRAG}),y.drag(z)):z.originalEvent.stopPropagation()},d.mousedrag=function(z){d.drag(z,F=>!sC(o,F))},d.touchdrag=function(z){d.drag(z,F=>!aC(a,F))},d.mousemove=function(z){if((z.originalEvent.buttons!==void 0?z.originalEvent.buttons:z.originalEvent.which)===1)return d.mousedrag(z);const V=u1(z,e);z.featureTarget=V,y.mousemove(z)},d.mousedown=function(z){o={time:new Date().getTime(),point:z.point};const F=u1(z,e);z.featureTarget=F,y.mousedown(z)},d.mouseup=function(z){const F=u1(z,e);z.featureTarget=F,sC(o,{point:z.point,time:new Date().getTime()})?y.click(z):y.mouseup(z)},d.mouseout=function(z){y.mouseout(z)},d.touchstart=function(z){if(!e.options.touchEnabled)return;a={time:new Date().getTime(),point:z.point};const F=Xm.touch(z,null,e)[0];z.featureTarget=F,y.touchstart(z)},d.touchmove=function(z){if(e.options.touchEnabled)return y.touchmove(z),d.touchdrag(z)},d.touchend=function(z){if(z.originalEvent.preventDefault(),!e.options.touchEnabled)return;const F=Xm.touch(z,null,e)[0];z.featureTarget=F,aC(a,{time:new Date().getTime(),point:z.point})?y.tap(z):y.touchend(z)};const r=z=>!(z===8||z===46||z>=48&&z<=57);d.keydown=function(z){(z.srcElement||z.target).classList.contains(ba.CANVAS)&&((z.keyCode===8||z.keyCode===46)&&e.options.controls.trash?(z.preventDefault(),y.trash()):r(z.keyCode)?y.keydown(z):z.keyCode===49&&e.options.controls.point?S(Bi.DRAW_POINT):z.keyCode===50&&e.options.controls.line_string?S(Bi.DRAW_LINE_STRING):z.keyCode===51&&e.options.controls.polygon&&S(Bi.DRAW_POLYGON))},d.keyup=function(z){r(z.keyCode)&&y.keyup(z)},d.zoomend=function(){e.store.changeZoom()},d.data=function(z){if(z.dataType==="style"){const{setup:F,map:V,options:N,store:H}=e;N.styles.some(te=>V.getLayer(te.id))||(F.addLayers(),H.setDirty(),H.render())}};function S(z,F,V={}){y.stop();const N=t[z];if(N===void 0)throw new Error(`${z} is not valid`);p=z;const H=N(e,F);y=nC(H,e),V.silent||e.map.fire(sa.MODE_CHANGE,{mode:z}),e.store.setDirty(),e.store.render()}const C={trash:!1,combineFeatures:!1,uncombineFeatures:!1};function M(z){let F=!1;Object.keys(z).forEach(V=>{if(C[V]===void 0)throw new Error("Invalid action type");C[V]!==z[V]&&(F=!0),C[V]=z[V]}),F&&e.map.fire(sa.ACTIONABLE,{actions:C})}return{start(){p=e.options.defaultMode,y=nC(t[p](e),e)},changeMode:S,actionable:M,currentModeName(){return p},currentModeRender(z,F){return y.render(z,F)},fire(z,F){e.map&&e.map.fire(z,F)},addEventListeners(){e.map.on("mousemove",d.mousemove),e.map.on("mousedown",d.mousedown),e.map.on("mouseup",d.mouseup),e.map.on("data",d.data),e.map.on("touchmove",d.touchmove),e.map.on("touchstart",d.touchstart),e.map.on("touchend",d.touchend),e.container.addEventListener("mouseout",d.mouseout),e.options.keybindings&&(e.container.addEventListener("keydown",d.keydown),e.container.addEventListener("keyup",d.keyup))},removeEventListeners(){e.map.off("mousemove",d.mousemove),e.map.off("mousedown",d.mousedown),e.map.off("mouseup",d.mouseup),e.map.off("data",d.data),e.map.off("touchmove",d.touchmove),e.map.off("touchstart",d.touchstart),e.map.off("touchend",d.touchend),e.container.removeEventListener("mouseout",d.mouseout),e.options.keybindings&&(e.container.removeEventListener("keydown",d.keydown),e.container.removeEventListener("keyup",d.keyup))},trash(z){y.trash(z)},combineFeatures(){y.combineFeatures()},uncombineFeatures(){y.uncombineFeatures()},getMode(){return p}}}function bv(e){return[].concat(e).filter(t=>t!==void 0)}function u_e(){const e=this;if(!(e.ctx.map&&e.ctx.map.getSource(il.HOT)!==void 0))return S();const o=e.ctx.events.currentModeName();e.ctx.ui.queueMapClasses({mode:o});let a=[],d=[];e.isDirty?d=e.getAllIds():(a=e.getChangedIds().filter(C=>e.get(C)!==void 0),d=e.sources.hot.filter(C=>C.properties.id&&a.indexOf(C.properties.id)===-1&&e.get(C.properties.id)!==void 0).map(C=>C.properties.id)),e.sources.hot=[];const p=e.sources.cold.length;e.sources.cold=e.isDirty?[]:e.sources.cold.filter(C=>{const M=C.properties.id||C.properties.parent;return a.indexOf(M)===-1});const y=p!==e.sources.cold.length||d.length>0;a.forEach(C=>r(C,"hot")),d.forEach(C=>r(C,"cold"));function r(C,M){const z=e.get(C).internal(o);e.ctx.events.currentModeRender(z,F=>{F.properties.mode=o,e.sources[M].push(F)})}y&&e.ctx.map.getSource(il.COLD).setData({type:$r.FEATURE_COLLECTION,features:e.sources.cold}),e.ctx.map.getSource(il.HOT).setData({type:$r.FEATURE_COLLECTION,features:e.sources.hot}),S();function S(){e.isDirty=!1,e.clearChangedIds()}}function yo(e){this._features={},this._featureIds=new ul,this._selectedFeatureIds=new ul,this._selectedCoordinates=[],this._changedFeatureIds=new ul,this._emitSelectionChange=!1,this._mapInitialConfig={},this.ctx=e,this.sources={hot:[],cold:[]};let t;this.render=()=>{t||(t=requestAnimationFrame(()=>{t=null,u_e.call(this),this._emitSelectionChange&&(this.ctx.events.fire(sa.SELECTION_CHANGE,{features:this.getSelected().map(o=>o.toGeoJSON()),points:this.getSelectedCoordinates().map(o=>({type:$r.FEATURE,properties:{},geometry:{type:$r.POINT,coordinates:o.coordinates}}))}),this._emitSelectionChange=!1),this.ctx.events.fire(sa.RENDER,{})}))},this.isDirty=!1}yo.prototype.createRenderBatch=function(){const e=this.render;let t=0;return this.render=function(){t++},()=>{this.render=e,t>0&&this.render()}};yo.prototype.setDirty=function(){return this.isDirty=!0,this};yo.prototype.featureCreated=function(e,t={}){if(this._changedFeatureIds.add(e),(t.silent!=null?t.silent:this.ctx.options.suppressAPIEvents)!==!0){const a=this.get(e);this.ctx.events.fire(sa.CREATE,{features:[a.toGeoJSON()]})}return this};yo.prototype.featureChanged=function(e,t={}){return this._changedFeatureIds.add(e),(t.silent!=null?t.silent:this.ctx.options.suppressAPIEvents)!==!0&&this.ctx.events.fire(sa.UPDATE,{action:t.action?t.action:vv.CHANGE_COORDINATES,features:[this.get(e).toGeoJSON()]}),this};yo.prototype.getChangedIds=function(){return this._changedFeatureIds.values()};yo.prototype.clearChangedIds=function(){return this._changedFeatureIds.clear(),this};yo.prototype.getAllIds=function(){return this._featureIds.values()};yo.prototype.add=function(e,t={}){return this._features[e.id]=e,this._featureIds.add(e.id),this.featureCreated(e.id,{silent:t.silent}),this};yo.prototype.delete=function(e,t={}){const o=[];return bv(e).forEach(a=>{this._featureIds.has(a)&&(this._featureIds.delete(a),this._selectedFeatureIds.delete(a),t.silent||o.indexOf(this._features[a])===-1&&o.push(this._features[a].toGeoJSON()),delete this._features[a],this.isDirty=!0)}),o.length&&this.ctx.events.fire(sa.DELETE,{features:o}),DB(this,t),this};yo.prototype.get=function(e){return this._features[e]};yo.prototype.getAll=function(){return Object.keys(this._features).map(e=>this._features[e])};yo.prototype.select=function(e,t={}){return bv(e).forEach(o=>{this._selectedFeatureIds.has(o)||(this._selectedFeatureIds.add(o),this._changedFeatureIds.add(o),t.silent||(this._emitSelectionChange=!0))}),this};yo.prototype.deselect=function(e,t={}){return bv(e).forEach(o=>{this._selectedFeatureIds.has(o)&&(this._selectedFeatureIds.delete(o),this._changedFeatureIds.add(o),t.silent||(this._emitSelectionChange=!0))}),DB(this,t),this};yo.prototype.clearSelected=function(e={}){return this.deselect(this._selectedFeatureIds.values(),{silent:e.silent}),this};yo.prototype.setSelected=function(e,t={}){return e=bv(e),this.deselect(this._selectedFeatureIds.values().filter(o=>e.indexOf(o)===-1),{silent:t.silent}),this.select(e.filter(o=>!this._selectedFeatureIds.has(o)),{silent:t.silent}),this};yo.prototype.setSelectedCoordinates=function(e){return this._selectedCoordinates=e,this._emitSelectionChange=!0,this};yo.prototype.clearSelectedCoordinates=function(){return this._selectedCoordinates=[],this._emitSelectionChange=!0,this};yo.prototype.getSelectedIds=function(){return this._selectedFeatureIds.values()};yo.prototype.getSelected=function(){return this.getSelectedIds().map(e=>this.get(e))};yo.prototype.getSelectedCoordinates=function(){return this._selectedCoordinates.map(t=>({coordinates:this.get(t.feature_id).getCoordinate(t.coord_path)}))};yo.prototype.isSelected=function(e){return this._selectedFeatureIds.has(e)};yo.prototype.setFeatureProperty=function(e,t,o,a={}){this.get(e).setProperty(t,o),this.featureChanged(e,{silent:a.silent,action:vv.CHANGE_PROPERTIES})};function DB(e,t={}){const o=e._selectedCoordinates.filter(a=>e._selectedFeatureIds.has(a.feature_id));e._selectedCoordinates.length!==o.length&&!t.silent&&(e._emitSelectionChange=!0),e._selectedCoordinates=o}yo.prototype.storeMapConfig=function(){AB.forEach(e=>{this.ctx.map[e]&&(this._mapInitialConfig[e]=this.ctx.map[e].isEnabled())})};yo.prototype.restoreMapConfig=function(){Object.keys(this._mapInitialConfig).forEach(e=>{this._mapInitialConfig[e]?this.ctx.map[e].enable():this.ctx.map[e].disable()})};yo.prototype.getInitialConfigValue=function(e){return this._mapInitialConfig[e]!==void 0?this._mapInitialConfig[e]:!0};const c_e=["mode","feature","mouse"];function d_e(e){const t={};let o=null,a={mode:null,feature:null,mouse:null},d={mode:null,feature:null,mouse:null};function p(){y({mode:null,feature:null,mouse:null}),r()}function y(F){d=Object.assign(d,F)}function r(){if(!e.container)return;const F=[],V=[];c_e.forEach(N=>{d[N]!==a[N]&&(F.push(`${N}-${a[N]}`),d[N]!==null&&V.push(`${N}-${d[N]}`))}),F.length>0&&e.container.classList.remove(...F),V.length>0&&e.container.classList.add(...V),a=Object.assign(a,d)}function S(F,V={}){const N=document.createElement("button");return N.className=`${ba.CONTROL_BUTTON} ${V.className}`,N.setAttribute("title",V.title),V.container.appendChild(N),N.addEventListener("click",H=>{if(H.preventDefault(),H.stopPropagation(),H.target===o){C(),V.onDeactivate();return}M(F),V.onActivate()},!0),N}function C(){o&&(o.classList.remove(ba.ACTIVE_BUTTON),o=null)}function M(F){C();const V=t[F];V&&V&&F!=="trash"&&(V.classList.add(ba.ACTIVE_BUTTON),o=V)}function P(){const F=e.options.controls,V=document.createElement("div");return V.className=`${ba.CONTROL_GROUP} ${ba.CONTROL_BASE}`,F&&(F[xa.LINE]&&(t[xa.LINE]=S(xa.LINE,{container:V,className:ba.CONTROL_BUTTON_LINE,title:`LineString tool ${e.options.keybindings?"(l)":""}`,onActivate:()=>e.events.changeMode(Bi.DRAW_LINE_STRING),onDeactivate:()=>e.events.trash()})),F[xa.POLYGON]&&(t[xa.POLYGON]=S(xa.POLYGON,{container:V,className:ba.CONTROL_BUTTON_POLYGON,title:`Polygon tool ${e.options.keybindings?"(p)":""}`,onActivate:()=>e.events.changeMode(Bi.DRAW_POLYGON),onDeactivate:()=>e.events.trash()})),F[xa.POINT]&&(t[xa.POINT]=S(xa.POINT,{container:V,className:ba.CONTROL_BUTTON_POINT,title:`Marker tool ${e.options.keybindings?"(m)":""}`,onActivate:()=>e.events.changeMode(Bi.DRAW_POINT),onDeactivate:()=>e.events.trash()})),F.trash&&(t.trash=S("trash",{container:V,className:ba.CONTROL_BUTTON_TRASH,title:"Delete",onActivate:()=>{e.events.trash()}})),F.combine_features&&(t.combine_features=S("combineFeatures",{container:V,className:ba.CONTROL_BUTTON_COMBINE_FEATURES,title:"Combine",onActivate:()=>{e.events.combineFeatures()}})),F.uncombine_features&&(t.uncombine_features=S("uncombineFeatures",{container:V,className:ba.CONTROL_BUTTON_UNCOMBINE_FEATURES,title:"Uncombine",onActivate:()=>{e.events.uncombineFeatures()}}))),V}function z(){Object.keys(t).forEach(F=>{const V=t[F];V.parentNode&&V.parentNode.removeChild(V),delete t[F]})}return{setActiveButton:M,queueMapClasses:y,updateMapClasses:r,clearMapClasses:p,addButtons:P,removeButtons:z}}function f_e(e){let t=null,o=null;const a={onRemove(){return e.map.off("load",a.connect),clearInterval(o),a.removeLayers(),e.store.restoreMapConfig(),e.ui.removeButtons(),e.events.removeEventListeners(),e.ui.clearMapClasses(),e.boxZoomInitial&&e.map.boxZoom.enable(),e.map=null,e.container=null,e.store=null,t&&t.parentNode&&t.parentNode.removeChild(t),t=null,this},connect(){e.map.off("load",a.connect),clearInterval(o),a.addLayers(),e.store.storeMapConfig(),e.events.addEventListeners()},onAdd(d){if(e.map=d,e.events=l_e(e),e.ui=d_e(e),e.container=d.getContainer(),e.store=new yo(e),t=e.ui.addButtons(),e.options.boxSelect){e.boxZoomInitial=d.boxZoom.isEnabled(),d.boxZoom.disable();const p=d.dragPan.isEnabled();d.dragPan.disable(),d.dragPan.enable(),p||d.dragPan.disable()}return d.loaded()?a.connect():(d.on("load",a.connect),o=setInterval(()=>{d.loaded()&&a.connect()},16)),e.events.start(),t},addLayers(){e.map.addSource(il.COLD,{data:{type:$r.FEATURE_COLLECTION,features:[]},type:"geojson"}),e.map.addSource(il.HOT,{data:{type:$r.FEATURE_COLLECTION,features:[]},type:"geojson"}),e.options.styles.forEach(d=>{e.map.addLayer(d)}),e.store.setDirty(!0),e.store.render()},removeLayers(){e.options.styles.forEach(d=>{e.map.getLayer(d.id)&&e.map.removeLayer(d.id)}),e.map.getSource(il.COLD)&&e.map.removeSource(il.COLD),e.map.getSource(il.HOT)&&e.map.removeSource(il.HOT)}};return e.setup=a,a}const MS="#3bb2d0",ey="#fbb03b",AO="#fff",zB=[{id:"gl-draw-polygon-fill",type:"fill",filter:["all",["==","$type","Polygon"]],paint:{"fill-color":["case",["==",["get","active"],"true"],ey,MS],"fill-opacity":.1}},{id:"gl-draw-lines",type:"line",filter:["any",["==","$type","LineString"],["==","$type","Polygon"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":["case",["==",["get","active"],"true"],ey,MS],"line-dasharray":["case",["==",["get","active"],"true"],[.2,2],[2,0]],"line-width":2}},{id:"gl-draw-point-outer",type:"circle",filter:["all",["==","$type","Point"],["==","meta","feature"]],paint:{"circle-radius":["case",["==",["get","active"],"true"],7,5],"circle-color":AO}},{id:"gl-draw-point-inner",type:"circle",filter:["all",["==","$type","Point"],["==","meta","feature"]],paint:{"circle-radius":["case",["==",["get","active"],"true"],5,3],"circle-color":["case",["==",["get","active"],"true"],ey,MS]}},{id:"gl-draw-vertex-outer",type:"circle",filter:["all",["==","$type","Point"],["==","meta","vertex"],["!=","mode","simple_select"]],paint:{"circle-radius":["case",["==",["get","active"],"true"],7,5],"circle-color":AO}},{id:"gl-draw-vertex-inner",type:"circle",filter:["all",["==","$type","Point"],["==","meta","vertex"],["!=","mode","simple_select"]],paint:{"circle-radius":["case",["==",["get","active"],"true"],5,3],"circle-color":ey}},{id:"gl-draw-midpoint",type:"circle",filter:["all",["==","meta","midpoint"]],paint:{"circle-radius":3,"circle-color":ey}}];function Fx(e){return function(t){const o=t.featureTarget;return!o||!o.properties?!1:o.properties.meta===e}}function FB(e){return!e.originalEvent||!e.originalEvent.shiftKey?!1:e.originalEvent.button===0}function Oh(e){return!e.featureTarget||!e.featureTarget.properties?!1:e.featureTarget.properties.active===ls.ACTIVE&&e.featureTarget.properties.meta===$s.FEATURE}function xM(e){return!e.featureTarget||!e.featureTarget.properties?!1:e.featureTarget.properties.active===ls.INACTIVE&&e.featureTarget.properties.meta===$s.FEATURE}function Nx(e){return e.featureTarget===void 0}function wM(e){return!e.featureTarget||!e.featureTarget.properties?!1:e.featureTarget.properties.meta===$s.FEATURE}function xv(e){const t=e.featureTarget;return!t||!t.properties?!1:t.properties.meta===$s.VERTEX}function j1(e){return e.originalEvent?e.originalEvent.shiftKey===!0:!1}function Bx(e){return e.keyCode===27}function Vx(e){return e.keyCode===13}function h_e(){return!0}const p_e=Object.freeze(Object.defineProperty({__proto__:null,isActiveFeature:Oh,isEnterKey:Vx,isEscapeKey:Bx,isFeature:wM,isInactiveFeature:xM,isOfMetaType:Fx,isShiftDown:j1,isShiftMousedown:FB,isTrue:h_e,isVertex:xv,noTarget:Nx},Symbol.toStringTag,{value:"Module"}));function Vd(e,t){this.x=e,this.y=t}Vd.prototype={clone(){return new Vd(this.x,this.y)},add(e){return this.clone()._add(e)},sub(e){return this.clone()._sub(e)},multByPoint(e){return this.clone()._multByPoint(e)},divByPoint(e){return this.clone()._divByPoint(e)},mult(e){return this.clone()._mult(e)},div(e){return this.clone()._div(e)},rotate(e){return this.clone()._rotate(e)},rotateAround(e,t){return this.clone()._rotateAround(e,t)},matMult(e){return this.clone()._matMult(e)},unit(){return this.clone()._unit()},perp(){return this.clone()._perp()},round(){return this.clone()._round()},mag(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals(e){return this.x===e.x&&this.y===e.y},dist(e){return Math.sqrt(this.distSqr(e))},distSqr(e){const t=e.x-this.x,o=e.y-this.y;return t*t+o*o},angle(){return Math.atan2(this.y,this.x)},angleTo(e){return Math.atan2(this.y-e.y,this.x-e.x)},angleWith(e){return this.angleWithSep(e.x,e.y)},angleWithSep(e,t){return Math.atan2(this.x*t-this.y*e,this.x*e+this.y*t)},_matMult(e){const t=e[0]*this.x+e[1]*this.y,o=e[2]*this.x+e[3]*this.y;return this.x=t,this.y=o,this},_add(e){return this.x+=e.x,this.y+=e.y,this},_sub(e){return this.x-=e.x,this.y-=e.y,this},_mult(e){return this.x*=e,this.y*=e,this},_div(e){return this.x/=e,this.y/=e,this},_multByPoint(e){return this.x*=e.x,this.y*=e.y,this},_divByPoint(e){return this.x/=e.x,this.y/=e.y,this},_unit(){return this._div(this.mag()),this},_perp(){const e=this.y;return this.y=this.x,this.x=-e,this},_rotate(e){const t=Math.cos(e),o=Math.sin(e),a=t*this.x-o*this.y,d=o*this.x+t*this.y;return this.x=a,this.y=d,this},_rotateAround(e,t){const o=Math.cos(e),a=Math.sin(e),d=t.x+o*(this.x-t.x)-a*(this.y-t.y),p=t.y+a*(this.x-t.x)+o*(this.y-t.y);return this.x=d,this.y=p,this},_round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},constructor:Vd};Vd.convert=function(e){if(e instanceof Vd)return e;if(Array.isArray(e))return new Vd(+e[0],+e[1]);if(e.x!==void 0&&e.y!==void 0)return new Vd(+e.x,+e.y);throw new Error("Expected [x, y] or {x, y} point format")};function SM(e,t){const o=t.getBoundingClientRect();return new Vd(e.clientX-o.left-(t.clientLeft||0),e.clientY-o.top-(t.clientTop||0))}function Jm(e,t,o,a){return{type:$r.FEATURE,properties:{meta:$s.VERTEX,parent:e,coord_path:o,active:a?ls.ACTIVE:ls.INACTIVE},geometry:{type:$r.POINT,coordinates:t}}}function NB(e,t,o){const a=t.geometry.coordinates,d=o.geometry.coordinates;if(a[1]>oC||a[1]<iC||d[1]>oC||d[1]<iC)return null;const p={lng:(a[0]+d[0])/2,lat:(a[1]+d[1])/2};return{type:$r.FEATURE,properties:{meta:$s.MIDPOINT,parent:e,lng:p.lng,lat:p.lat,coord_path:o.properties.coord_path},geometry:{type:$r.POINT,coordinates:[p.lng,p.lat]}}}function $x(e,t={},o=null){const{type:a,coordinates:d}=e.geometry,p=e.properties&&e.properties.id;let y=[];a===$r.POINT?y.push(Jm(p,d,o,S(o))):a===$r.POLYGON?d.forEach((M,P)=>{r(M,o!==null?`${o}.${P}`:String(P))}):a===$r.LINE_STRING?r(d,o):a.indexOf($r.MULTI_PREFIX)===0&&C();function r(M,P){let z="",F=null;M.forEach((V,N)=>{const H=P!=null?`${P}.${N}`:String(N),U=Jm(p,V,H,S(H));if(t.midpoints&&F){const Z=NB(p,F,U);Z&&y.push(Z)}F=U;const te=JSON.stringify(V);z!==te&&y.push(U),N===0&&(z=te)})}function S(M){return t.selectedPaths?t.selectedPaths.indexOf(M)!==-1:!1}function C(){const M=a.replace($r.MULTI_PREFIX,"");d.forEach((P,z)=>{const F={type:$r.FEATURE,properties:e.properties,geometry:{type:M,coordinates:P}};y=y.concat($x(F,t,z))})}return y}const nu={enable(e){setTimeout(()=>{!e.map||!e.map.doubleClickZoom||!e._ctx||!e._ctx.store||!e._ctx.store.getInitialConfigValue||e._ctx.store.getInitialConfigValue("doubleClickZoom")&&e.map.doubleClickZoom.enable()},0)},disable(e){setTimeout(()=>{!e.map||!e.map.doubleClickZoom||e.map.doubleClickZoom.disable()},0)}},{LAT_MIN:Bb,LAT_MAX:Vb,LAT_RENDERED_MIN:kO,LAT_RENDERED_MAX:PO,LNG_MIN:RO,LNG_MAX:OO}=kB;function m_e(e){const t={Point:0,LineString:1,Polygon:2,MultiPoint:1,MultiLineString:2,MultiPolygon:3}[e.geometry.type],o=[e.geometry.coordinates].flat(t),a=o.map(r=>r[0]),d=o.map(r=>r[1]),p=r=>Math.min.apply(null,r),y=r=>Math.max.apply(null,r);return[p(a),p(d),y(a),y(d)]}function TM(e,t){let o=Bb,a=Vb,d=Bb,p=Vb,y=OO,r=RO;e.forEach(C=>{const M=m_e(C),P=M[1],z=M[3],F=M[0],V=M[2];P>o&&(o=P),z<a&&(a=z),z>d&&(d=z),P<p&&(p=P),F<y&&(y=F),V>r&&(r=V)});const S=t;return o+S.lat>PO&&(S.lat=PO-o),d+S.lat>Vb&&(S.lat=Vb-d),a+S.lat<kO&&(S.lat=kO-a),p+S.lat<Bb&&(S.lat=Bb-p),y+S.lng<=RO&&(S.lng+=Math.ceil(Math.abs(S.lng)/360)*360),r+S.lng>=OO&&(S.lng-=Math.ceil(Math.abs(S.lng)/360)*360),S}function CM(e,t){const o=TM(e.map(a=>a.toGeoJSON()),t);e.forEach(a=>{const d=a.getCoordinates(),p=C=>{const M={lng:C[0]+o.lng,lat:C[1]+o.lat};return[M.lng,M.lat]},y=C=>C.map(M=>p(M)),r=C=>C.map(M=>y(M));let S;a.type===$r.POINT?S=p(d):a.type===$r.LINE_STRING||a.type===$r.MULTI_POINT?S=d.map(p):a.type===$r.POLYGON||a.type===$r.MULTI_LINE_STRING?S=d.map(y):a.type===$r.MULTI_POLYGON&&(S=d.map(r)),a.incomingCoords(S)})}const lo={};lo.onSetup=function(e){const t={dragMoveLocation:null,boxSelectStartLocation:null,boxSelectElement:void 0,boxSelecting:!1,canBoxSelect:!1,dragMoving:!1,canDragMove:!1,initialDragPanState:this.map.dragPan.isEnabled(),initiallySelectedFeatureIds:e.featureIds||[]};return this.setSelected(t.initiallySelectedFeatureIds.filter(o=>this.getFeature(o)!==void 0)),this.fireActionable(),this.setActionableState({combineFeatures:!0,uncombineFeatures:!0,trash:!0}),t};lo.fireUpdate=function(){this.fire(sa.UPDATE,{action:vv.MOVE,features:this.getSelected().map(e=>e.toGeoJSON())})};lo.fireActionable=function(){const e=this.getSelected(),t=e.filter(p=>this.isInstanceOf("MultiFeature",p));let o=!1;if(e.length>1){o=!0;const p=e[0].type.replace("Multi","");e.forEach(y=>{y.type.replace("Multi","")!==p&&(o=!1)})}const a=t.length>0,d=e.length>0;this.setActionableState({combineFeatures:o,uncombineFeatures:a,trash:d})};lo.getUniqueIds=function(e){return e.length?e.map(o=>o.properties.id).filter(o=>o!==void 0).reduce((o,a)=>(o.add(a),o),new ul).values():[]};lo.stopExtendedInteractions=function(e){e.boxSelectElement&&(e.boxSelectElement.parentNode&&e.boxSelectElement.parentNode.removeChild(e.boxSelectElement),e.boxSelectElement=null),(e.canDragMove||e.canBoxSelect)&&e.initialDragPanState===!0&&this.map.dragPan.enable(),e.boxSelecting=!1,e.canBoxSelect=!1,e.dragMoving=!1,e.canDragMove=!1};lo.onStop=function(){nu.enable(this)};lo.onMouseMove=function(e,t){return wM(t)&&e.dragMoving&&this.fireUpdate(),this.stopExtendedInteractions(e),!0};lo.onMouseOut=function(e){return e.dragMoving?this.fireUpdate():!0};lo.onTap=lo.onClick=function(e,t){if(Nx(t))return this.clickAnywhere(e,t);if(Fx($s.VERTEX)(t))return this.clickOnVertex(e,t);if(wM(t))return this.clickOnFeature(e,t)};lo.clickAnywhere=function(e){const t=this.getSelectedIds();t.length&&(this.clearSelectedFeatures(),t.forEach(o=>this.doRender(o))),nu.enable(this),this.stopExtendedInteractions(e)};lo.clickOnVertex=function(e,t){this.changeMode(Bi.DIRECT_SELECT,{featureId:t.featureTarget.properties.parent,coordPath:t.featureTarget.properties.coord_path,startPos:t.lngLat}),this.updateUIClasses({mouse:Mo.MOVE})};lo.startOnActiveFeature=function(e,t){this.stopExtendedInteractions(e),this.map.dragPan.disable(),this.doRender(t.featureTarget.properties.id),e.canDragMove=!0,e.dragMoveLocation=t.lngLat};lo.clickOnFeature=function(e,t){nu.disable(this),this.stopExtendedInteractions(e);const o=j1(t),a=this.getSelectedIds(),d=t.featureTarget.properties.id,p=this.isSelected(d);if(!o&&p&&this.getFeature(d).type!==$r.POINT)return this.changeMode(Bi.DIRECT_SELECT,{featureId:d});p&&o?(this.deselect(d),this.updateUIClasses({mouse:Mo.POINTER}),a.length===1&&nu.enable(this)):!p&&o?(this.select(d),this.updateUIClasses({mouse:Mo.MOVE})):!p&&!o&&(a.forEach(y=>this.doRender(y)),this.setSelected(d),this.updateUIClasses({mouse:Mo.MOVE})),this.doRender(d)};lo.onMouseDown=function(e,t){if(e.initialDragPanState=this.map.dragPan.isEnabled(),Oh(t))return this.startOnActiveFeature(e,t);if(this.drawConfig.boxSelect&&FB(t))return this.startBoxSelect(e,t)};lo.startBoxSelect=function(e,t){this.stopExtendedInteractions(e),this.map.dragPan.disable(),e.boxSelectStartLocation=SM(t.originalEvent,this.map.getContainer()),e.canBoxSelect=!0};lo.onTouchStart=function(e,t){if(Oh(t))return this.startOnActiveFeature(e,t)};lo.onDrag=function(e,t){if(e.canDragMove)return this.dragMove(e,t);if(this.drawConfig.boxSelect&&e.canBoxSelect)return this.whileBoxSelect(e,t)};lo.whileBoxSelect=function(e,t){e.boxSelecting=!0,this.updateUIClasses({mouse:Mo.ADD}),e.boxSelectElement||(e.boxSelectElement=document.createElement("div"),e.boxSelectElement.classList.add(ba.BOX_SELECT),this.map.getContainer().appendChild(e.boxSelectElement));const o=SM(t.originalEvent,this.map.getContainer()),a=Math.min(e.boxSelectStartLocation.x,o.x),d=Math.max(e.boxSelectStartLocation.x,o.x),p=Math.min(e.boxSelectStartLocation.y,o.y),y=Math.max(e.boxSelectStartLocation.y,o.y),r=`translate(${a}px, ${p}px)`;e.boxSelectElement.style.transform=r,e.boxSelectElement.style.WebkitTransform=r,e.boxSelectElement.style.width=`${d-a}px`,e.boxSelectElement.style.height=`${y-p}px`};lo.dragMove=function(e,t){e.dragMoving=!0,t.originalEvent.stopPropagation();const o={lng:t.lngLat.lng-e.dragMoveLocation.lng,lat:t.lngLat.lat-e.dragMoveLocation.lat};CM(this.getSelected(),o),e.dragMoveLocation=t.lngLat};lo.onTouchEnd=lo.onMouseUp=function(e,t){if(e.dragMoving)this.fireUpdate();else if(e.boxSelecting){const o=[e.boxSelectStartLocation,SM(t.originalEvent,this.map.getContainer())],a=this.featuresAt(null,o,"click"),d=this.getUniqueIds(a).filter(p=>!this.isSelected(p));d.length&&(this.select(d),d.forEach(p=>this.doRender(p)),this.updateUIClasses({mouse:Mo.MOVE}))}this.stopExtendedInteractions(e)};lo.toDisplayFeatures=function(e,t,o){t.properties.active=this.isSelected(t.properties.id)?ls.ACTIVE:ls.INACTIVE,o(t),this.fireActionable(),!(t.properties.active!==ls.ACTIVE||t.geometry.type===$r.POINT)&&$x(t).forEach(o)};lo.onTrash=function(){this.deleteFeature(this.getSelectedIds()),this.fireActionable()};lo.onCombineFeatures=function(){const e=this.getSelected();if(e.length===0||e.length<2)return;const t=[],o=[],a=e[0].type.replace("Multi","");for(let d=0;d<e.length;d++){const p=e[d];if(p.type.replace("Multi","")!==a)return;p.type.includes("Multi")?p.getCoordinates().forEach(y=>{t.push(y)}):t.push(p.getCoordinates()),o.push(p.toGeoJSON())}if(o.length>1){const d=this.newFeature({type:$r.FEATURE,properties:o[0].properties,geometry:{type:`Multi${a}`,coordinates:t}});this.addFeature(d),this.deleteFeature(this.getSelectedIds(),{silent:!0}),this.setSelected([d.id]),this.fire(sa.COMBINE_FEATURES,{createdFeatures:[d.toGeoJSON()],deletedFeatures:o})}this.fireActionable()};lo.onUncombineFeatures=function(){const e=this.getSelected();if(e.length===0)return;const t=[],o=[];for(let a=0;a<e.length;a++){const d=e[a];this.isInstanceOf("MultiFeature",d)&&(d.getFeatures().forEach(p=>{this.addFeature(p),p.properties=d.properties,t.push(p.toGeoJSON()),this.select([p.id])}),this.deleteFeature(d.id,{silent:!0}),o.push(d.toGeoJSON()))}t.length>1&&this.fire(sa.UNCOMBINE_FEATURES,{createdFeatures:t,deletedFeatures:o}),this.fireActionable()};const BB=Fx($s.VERTEX),VB=Fx($s.MIDPOINT),uo={};uo.fireUpdate=function(){this.fire(sa.UPDATE,{action:vv.CHANGE_COORDINATES,features:this.getSelected().map(e=>e.toGeoJSON())})};uo.fireActionable=function(e){this.setActionableState({combineFeatures:!1,uncombineFeatures:!1,trash:e.selectedCoordPaths.length>0})};uo.startDragging=function(e,t){e.initialDragPanState=this.map.dragPan.isEnabled(),this.map.dragPan.disable(),e.canDragMove=!0,e.dragMoveLocation=t.lngLat};uo.stopDragging=function(e){e.canDragMove&&e.initialDragPanState===!0&&this.map.dragPan.enable(),e.dragMoving=!1,e.canDragMove=!1,e.dragMoveLocation=null};uo.onVertex=function(e,t){this.startDragging(e,t);const o=t.featureTarget.properties,a=e.selectedCoordPaths.indexOf(o.coord_path);!j1(t)&&a===-1?e.selectedCoordPaths=[o.coord_path]:j1(t)&&a===-1&&e.selectedCoordPaths.push(o.coord_path);const d=this.pathsToCoordinates(e.featureId,e.selectedCoordPaths);this.setSelectedCoordinates(d)};uo.onMidpoint=function(e,t){this.startDragging(e,t);const o=t.featureTarget.properties;e.feature.addCoordinate(o.coord_path,o.lng,o.lat),this.fireUpdate(),e.selectedCoordPaths=[o.coord_path]};uo.pathsToCoordinates=function(e,t){return t.map(o=>({feature_id:e,coord_path:o}))};uo.onFeature=function(e,t){e.selectedCoordPaths.length===0?this.startDragging(e,t):this.stopDragging(e)};uo.dragFeature=function(e,t,o){CM(this.getSelected(),o),e.dragMoveLocation=t.lngLat};uo.dragVertex=function(e,t,o){const a=e.selectedCoordPaths.map(y=>e.feature.getCoordinate(y)),d=a.map(y=>({type:$r.FEATURE,properties:{},geometry:{type:$r.POINT,coordinates:y}})),p=TM(d,o);for(let y=0;y<a.length;y++){const r=a[y];e.feature.updateCoordinate(e.selectedCoordPaths[y],r[0]+p.lng,r[1]+p.lat)}};uo.clickNoTarget=function(){this.changeMode(Bi.SIMPLE_SELECT)};uo.clickInactive=function(){this.changeMode(Bi.SIMPLE_SELECT)};uo.clickActiveFeature=function(e){e.selectedCoordPaths=[],this.clearSelectedCoordinates(),e.feature.changed()};uo.onSetup=function(e){const t=e.featureId,o=this.getFeature(t);if(!o)throw new Error("You must provide a featureId to enter direct_select mode");if(o.type===$r.POINT)throw new TypeError("direct_select mode doesn't handle point features");const a={featureId:t,feature:o,dragMoveLocation:e.startPos||null,dragMoving:!1,canDragMove:!1,selectedCoordPaths:e.coordPath?[e.coordPath]:[]};return this.setSelectedCoordinates(this.pathsToCoordinates(t,a.selectedCoordPaths)),this.setSelected(t),nu.disable(this),this.setActionableState({trash:!0}),a};uo.onStop=function(){nu.enable(this),this.clearSelectedCoordinates()};uo.toDisplayFeatures=function(e,t,o){e.featureId===t.properties.id?(t.properties.active=ls.ACTIVE,o(t),$x(t,{map:this.map,midpoints:!0,selectedPaths:e.selectedCoordPaths}).forEach(o)):(t.properties.active=ls.INACTIVE,o(t)),this.fireActionable(e)};uo.onTrash=function(e){e.selectedCoordPaths.sort((t,o)=>o.localeCompare(t,"en",{numeric:!0})).forEach(t=>e.feature.removeCoordinate(t)),this.fireUpdate(),e.selectedCoordPaths=[],this.clearSelectedCoordinates(),this.fireActionable(e),e.feature.isValid()===!1&&(this.deleteFeature([e.featureId]),this.changeMode(Bi.SIMPLE_SELECT,{}))};uo.onMouseMove=function(e,t){const o=Oh(t),a=BB(t),d=VB(t),p=e.selectedCoordPaths.length===0;return o&&p?this.updateUIClasses({mouse:Mo.MOVE}):a&&!p?this.updateUIClasses({mouse:Mo.MOVE}):this.updateUIClasses({mouse:Mo.NONE}),(a||o||d)&&e.dragMoving&&this.fireUpdate(),this.stopDragging(e),!0};uo.onMouseOut=function(e){return e.dragMoving&&this.fireUpdate(),!0};uo.onTouchStart=uo.onMouseDown=function(e,t){if(BB(t))return this.onVertex(e,t);if(Oh(t))return this.onFeature(e,t);if(VB(t))return this.onMidpoint(e,t)};uo.onDrag=function(e,t){if(e.canDragMove!==!0)return;e.dragMoving=!0,t.originalEvent.stopPropagation();const o={lng:t.lngLat.lng-e.dragMoveLocation.lng,lat:t.lngLat.lat-e.dragMoveLocation.lat};e.selectedCoordPaths.length>0?this.dragVertex(e,t,o):this.dragFeature(e,t,o),e.dragMoveLocation=t.lngLat};uo.onClick=function(e,t){if(Nx(t))return this.clickNoTarget(e,t);if(Oh(t))return this.clickActiveFeature(e,t);if(xM(t))return this.clickInactive(e,t);this.stopDragging(e)};uo.onTap=function(e,t){if(Nx(t))return this.clickNoTarget(e,t);if(Oh(t))return this.clickActiveFeature(e,t);if(xM(t))return this.clickInactive(e,t)};uo.onTouchEnd=uo.onMouseUp=function(e){e.dragMoving&&this.fireUpdate(),this.stopDragging(e)};const $u={};$u.onSetup=function(){const e=this.newFeature({type:$r.FEATURE,properties:{},geometry:{type:$r.POINT,coordinates:[]}});return this.addFeature(e),this.clearSelectedFeatures(),this.updateUIClasses({mouse:Mo.ADD}),this.activateUIButton(xa.POINT),this.setActionableState({trash:!0}),{point:e}};$u.stopDrawingAndRemove=function(e){this.deleteFeature([e.point.id],{silent:!0}),this.changeMode(Bi.SIMPLE_SELECT)};$u.onTap=$u.onClick=function(e,t){this.updateUIClasses({mouse:Mo.MOVE}),e.point.updateCoordinate("",t.lngLat.lng,t.lngLat.lat),this.fire(sa.CREATE,{features:[e.point.toGeoJSON()]}),this.changeMode(Bi.SIMPLE_SELECT,{featureIds:[e.point.id]})};$u.onStop=function(e){this.activateUIButton(),e.point.getCoordinate().length||this.deleteFeature([e.point.id],{silent:!0})};$u.toDisplayFeatures=function(e,t,o){const a=t.properties.id===e.point.id;if(t.properties.active=a?ls.ACTIVE:ls.INACTIVE,!a)return o(t)};$u.onTrash=$u.stopDrawingAndRemove;$u.onKeyUp=function(e,t){if(Bx(t)||Vx(t))return this.stopDrawingAndRemove(e,t)};function H1(e,t){return e.lngLat?e.lngLat.lng===t[0]&&e.lngLat.lat===t[1]:!1}const ru={};ru.onSetup=function(){const e=this.newFeature({type:$r.FEATURE,properties:{},geometry:{type:$r.POLYGON,coordinates:[[]]}});return this.addFeature(e),this.clearSelectedFeatures(),nu.disable(this),this.updateUIClasses({mouse:Mo.ADD}),this.activateUIButton(xa.POLYGON),this.setActionableState({trash:!0}),{polygon:e,currentVertexPosition:0}};ru.clickAnywhere=function(e,t){if(e.currentVertexPosition>0&&H1(t,e.polygon.coordinates[0][e.currentVertexPosition-1]))return this.changeMode(Bi.SIMPLE_SELECT,{featureIds:[e.polygon.id]});this.updateUIClasses({mouse:Mo.ADD}),e.polygon.updateCoordinate(`0.${e.currentVertexPosition}`,t.lngLat.lng,t.lngLat.lat),e.currentVertexPosition++,e.polygon.updateCoordinate(`0.${e.currentVertexPosition}`,t.lngLat.lng,t.lngLat.lat)};ru.clickOnVertex=function(e){return this.changeMode(Bi.SIMPLE_SELECT,{featureIds:[e.polygon.id]})};ru.onMouseMove=function(e,t){e.polygon.updateCoordinate(`0.${e.currentVertexPosition}`,t.lngLat.lng,t.lngLat.lat),xv(t)&&this.updateUIClasses({mouse:Mo.POINTER})};ru.onTap=ru.onClick=function(e,t){return xv(t)?this.clickOnVertex(e,t):this.clickAnywhere(e,t)};ru.onKeyUp=function(e,t){Bx(t)?(this.deleteFeature([e.polygon.id],{silent:!0}),this.changeMode(Bi.SIMPLE_SELECT)):Vx(t)&&this.changeMode(Bi.SIMPLE_SELECT,{featureIds:[e.polygon.id]})};ru.onStop=function(e){this.updateUIClasses({mouse:Mo.NONE}),nu.enable(this),this.activateUIButton(),this.getFeature(e.polygon.id)!==void 0&&(e.polygon.removeCoordinate(`0.${e.currentVertexPosition}`),e.polygon.isValid()?this.fire(sa.CREATE,{features:[e.polygon.toGeoJSON()]}):(this.deleteFeature([e.polygon.id],{silent:!0}),this.changeMode(Bi.SIMPLE_SELECT,{},{silent:!0})))};ru.toDisplayFeatures=function(e,t,o){const a=t.properties.id===e.polygon.id;if(t.properties.active=a?ls.ACTIVE:ls.INACTIVE,!a)return o(t);if(t.geometry.coordinates.length===0)return;const d=t.geometry.coordinates[0].length;if(!(d<3)){if(t.properties.meta=$s.FEATURE,o(Jm(e.polygon.id,t.geometry.coordinates[0][0],"0.0",!1)),d>3){const p=t.geometry.coordinates[0].length-3;o(Jm(e.polygon.id,t.geometry.coordinates[0][p],`0.${p}`,!1))}if(d<=4){const p=[[t.geometry.coordinates[0][0][0],t.geometry.coordinates[0][0][1]],[t.geometry.coordinates[0][1][0],t.geometry.coordinates[0][1][1]]];if(o({type:$r.FEATURE,properties:t.properties,geometry:{coordinates:p,type:$r.LINE_STRING}}),d===3)return}return o(t)}};ru.onTrash=function(e){this.deleteFeature([e.polygon.id],{silent:!0}),this.changeMode(Bi.SIMPLE_SELECT)};const iu={};iu.onSetup=function(e){e=e||{};const t=e.featureId;let o,a,d="forward";if(t){if(o=this.getFeature(t),!o)throw new Error("Could not find a feature with the provided featureId");let p=e.from;if(p&&p.type==="Feature"&&p.geometry&&p.geometry.type==="Point"&&(p=p.geometry),p&&p.type==="Point"&&p.coordinates&&p.coordinates.length===2&&(p=p.coordinates),!p||!Array.isArray(p))throw new Error("Please use the `from` property to indicate which point to continue the line from");const y=o.coordinates.length-1;if(o.coordinates[y][0]===p[0]&&o.coordinates[y][1]===p[1])a=y+1,o.addCoordinate(a,...o.coordinates[y]);else if(o.coordinates[0][0]===p[0]&&o.coordinates[0][1]===p[1])d="backwards",a=0,o.addCoordinate(a,...o.coordinates[0]);else throw new Error("`from` should match the point at either the start or the end of the provided LineString")}else o=this.newFeature({type:$r.FEATURE,properties:{},geometry:{type:$r.LINE_STRING,coordinates:[]}}),a=0,this.addFeature(o);return this.clearSelectedFeatures(),nu.disable(this),this.updateUIClasses({mouse:Mo.ADD}),this.activateUIButton(xa.LINE),this.setActionableState({trash:!0}),{line:o,currentVertexPosition:a,direction:d}};iu.clickAnywhere=function(e,t){if(e.currentVertexPosition>0&&H1(t,e.line.coordinates[e.currentVertexPosition-1])||e.direction==="backwards"&&H1(t,e.line.coordinates[e.currentVertexPosition+1]))return this.changeMode(Bi.SIMPLE_SELECT,{featureIds:[e.line.id]});this.updateUIClasses({mouse:Mo.ADD}),e.line.updateCoordinate(e.currentVertexPosition,t.lngLat.lng,t.lngLat.lat),e.direction==="forward"?(e.currentVertexPosition++,e.line.updateCoordinate(e.currentVertexPosition,t.lngLat.lng,t.lngLat.lat)):e.line.addCoordinate(0,t.lngLat.lng,t.lngLat.lat)};iu.clickOnVertex=function(e){return this.changeMode(Bi.SIMPLE_SELECT,{featureIds:[e.line.id]})};iu.onMouseMove=function(e,t){e.line.updateCoordinate(e.currentVertexPosition,t.lngLat.lng,t.lngLat.lat),xv(t)&&this.updateUIClasses({mouse:Mo.POINTER})};iu.onTap=iu.onClick=function(e,t){if(xv(t))return this.clickOnVertex(e,t);this.clickAnywhere(e,t)};iu.onKeyUp=function(e,t){Vx(t)?this.changeMode(Bi.SIMPLE_SELECT,{featureIds:[e.line.id]}):Bx(t)&&(this.deleteFeature([e.line.id],{silent:!0}),this.changeMode(Bi.SIMPLE_SELECT))};iu.onStop=function(e){nu.enable(this),this.activateUIButton(),this.getFeature(e.line.id)!==void 0&&(e.line.removeCoordinate(`${e.currentVertexPosition}`),e.line.isValid()?this.fire(sa.CREATE,{features:[e.line.toGeoJSON()]}):(this.deleteFeature([e.line.id],{silent:!0}),this.changeMode(Bi.SIMPLE_SELECT,{},{silent:!0})))};iu.onTrash=function(e){this.deleteFeature([e.line.id],{silent:!0}),this.changeMode(Bi.SIMPLE_SELECT)};iu.toDisplayFeatures=function(e,t,o){const a=t.properties.id===e.line.id;if(t.properties.active=a?ls.ACTIVE:ls.INACTIVE,!a)return o(t);t.geometry.coordinates.length<2||(t.properties.meta=$s.FEATURE,o(Jm(e.line.id,t.geometry.coordinates[e.direction==="forward"?t.geometry.coordinates.length-2:1],`${e.direction==="forward"?t.geometry.coordinates.length-2:1}`,!1)),o(t))};const $B={simple_select:lo,direct_select:uo,draw_point:$u,draw_polygon:ru,draw_line_string:iu},g_e={defaultMode:Bi.SIMPLE_SELECT,keybindings:!0,touchEnabled:!0,clickBuffer:2,touchBuffer:25,boxSelect:!0,displayControlsDefault:!0,styles:zB,modes:$B,controls:{},userProperties:!1,suppressAPIEvents:!0},__e={point:!0,line_string:!0,polygon:!0,trash:!0,combine_features:!0,uncombine_features:!0},y_e={point:!1,line_string:!1,polygon:!1,trash:!1,combine_features:!1,uncombine_features:!1};function LO(e,t){return e.map(o=>o.source?o:Object.assign({},o,{id:`${o.id}.${t}`,source:t==="hot"?il.HOT:il.COLD}))}function v_e(e={}){let t=Object.assign({},e);return e.controls||(t.controls={}),e.displayControlsDefault===!1?t.controls=Object.assign({},y_e,e.controls):t.controls=Object.assign({},__e,e.controls),t=Object.assign({},g_e,t),t.styles=LO(t.styles,"cold").concat(LO(t.styles,"hot")),t}var b_e=function e(t,o){if(t===o)return!0;if(t&&o&&typeof t=="object"&&typeof o=="object"){if(t.constructor!==o.constructor)return!1;var a,d,p;if(Array.isArray(t)){if(a=t.length,a!=o.length)return!1;for(d=a;d--!==0;)if(!e(t[d],o[d]))return!1;return!0}if(t.constructor===RegExp)return t.source===o.source&&t.flags===o.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===o.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===o.toString();if(p=Object.keys(t),a=p.length,a!==Object.keys(o).length)return!1;for(d=a;d--!==0;)if(!Object.prototype.hasOwnProperty.call(o,p[d]))return!1;for(d=a;d--!==0;){var y=p[d];if(!e(t[y],o[y]))return!1}return!0}return t!==t&&o!==o};const DO=qa(b_e);var x_e=S_e,w_e={Point:"geometry",MultiPoint:"geometry",LineString:"geometry",MultiLineString:"geometry",Polygon:"geometry",MultiPolygon:"geometry",GeometryCollection:"geometry",Feature:"feature",FeatureCollection:"featurecollection"};function S_e(e){if(!e||!e.type)return null;var t=w_e[e.type];if(!t)return null;if(t==="geometry")return{type:"FeatureCollection",features:[{type:"Feature",properties:{},geometry:e}]};if(t==="feature")return{type:"FeatureCollection",features:[e]};if(t==="featurecollection")return e}const T_e=qa(x_e);function UB(e,t){return e.length!==t.length?!1:JSON.stringify(e.map(o=>o).sort())===JSON.stringify(t.map(o=>o).sort())}const C_e={Polygon:Ka,LineString:Ku,Point:uf,MultiPolygon:na,MultiLineString:na,MultiPoint:na};function E_e(e,t){t.modes=Bi;const o=e.options.suppressAPIEvents!==void 0?!!e.options.suppressAPIEvents:!0;return t.getFeatureIdsAt=function(a){return Xm.click({point:a},null,e).map(p=>p.properties.id)},t.getSelectedIds=function(){return e.store.getSelectedIds()},t.getSelected=function(){return{type:$r.FEATURE_COLLECTION,features:e.store.getSelectedIds().map(a=>e.store.get(a)).map(a=>a.toGeoJSON())}},t.getSelectedPoints=function(){return{type:$r.FEATURE_COLLECTION,features:e.store.getSelectedCoordinates().map(a=>({type:$r.FEATURE,properties:{},geometry:{type:$r.POINT,coordinates:a.coordinates}}))}},t.set=function(a){if(a.type===void 0||a.type!==$r.FEATURE_COLLECTION||!Array.isArray(a.features))throw new Error("Invalid FeatureCollection");const d=e.store.createRenderBatch();let p=e.store.getAllIds().slice();const y=t.add(a),r=new ul(y);return p=p.filter(S=>!r.has(S)),p.length&&t.delete(p),d(),y},t.add=function(a){const p=JSON.parse(JSON.stringify(T_e(a))).features.map(y=>{if(y.id=y.id||bM(),y.geometry===null)throw new Error("Invalid geometry: null");if(e.store.get(y.id)===void 0||e.store.get(y.id).type!==y.geometry.type){const r=C_e[y.geometry.type];if(r===void 0)throw new Error(`Invalid geometry type: ${y.geometry.type}.`);const S=new r(e,y);e.store.add(S,{silent:o})}else{const r=e.store.get(y.id),S=r.properties;r.properties=y.properties,DO(S,y.properties)||e.store.featureChanged(r.id,{silent:o}),DO(r.getCoordinates(),y.geometry.coordinates)||r.incomingCoords(y.geometry.coordinates)}return y.id});return e.store.render(),p},t.get=function(a){const d=e.store.get(a);if(d)return d.toGeoJSON()},t.getAll=function(){return{type:$r.FEATURE_COLLECTION,features:e.store.getAll().map(a=>a.toGeoJSON())}},t.delete=function(a){return e.store.delete(a,{silent:o}),t.getMode()===Bi.DIRECT_SELECT&&!e.store.getSelectedIds().length?e.events.changeMode(Bi.SIMPLE_SELECT,void 0,{silent:o}):e.store.render(),t},t.deleteAll=function(){return e.store.delete(e.store.getAllIds(),{silent:o}),t.getMode()===Bi.DIRECT_SELECT?e.events.changeMode(Bi.SIMPLE_SELECT,void 0,{silent:o}):e.store.render(),t},t.changeMode=function(a,d={}){return a===Bi.SIMPLE_SELECT&&t.getMode()===Bi.SIMPLE_SELECT?(UB(d.featureIds||[],e.store.getSelectedIds())||(e.store.setSelected(d.featureIds,{silent:o}),e.store.render()),t):(a===Bi.DIRECT_SELECT&&t.getMode()===Bi.DIRECT_SELECT&&d.featureId===e.store.getSelectedIds()[0]||e.events.changeMode(a,d,{silent:o}),t)},t.getMode=function(){return e.events.getMode()},t.trash=function(){return e.events.trash({silent:o}),t},t.combineFeatures=function(){return e.events.combineFeatures({silent:o}),t},t.uncombineFeatures=function(){return e.events.uncombineFeatures({silent:o}),t},t.setFeatureProperty=function(a,d,p){return e.store.setFeatureProperty(a,d,p,{silent:o}),t},t}const M_e=Object.freeze(Object.defineProperty({__proto__:null,CommonSelectors:p_e,ModeHandler:nC,StringSet:ul,constrainFeatureMovement:TM,createMidPoint:NB,createSupplementaryPoints:$x,createVertex:Jm,doubleClickZoom:nu,euclideanDistance:vM,featuresAt:Xm,getFeatureAtAndSetCursors:u1,isClick:sC,isEventAtCoordinates:H1,isTap:aC,mapEventToBoundingBox:RB,moveFeatures:CM,sortFeatures:PB,stringSetsAreEqual:UB,theme:zB,toDenseArray:bv},Symbol.toStringTag,{value:"Module"})),I_e=function(e,t){e=v_e(e);const o={options:e};t=E_e(o,t),o.api=t;const a=f_e(o);return t.onAdd=a.onAdd,t.onRemove=a.onRemove,t.types=xa,t.options=e,t};function Yy(e){I_e(e,this)}Yy.modes=$B;Yy.constants=kB;Yy.lib=M_e;var Ks=63710088e-1,A_e={centimeters:Ks*100,centimetres:Ks*100,degrees:360/(2*Math.PI),feet:Ks*3.28084,inches:Ks*39.37,kilometers:Ks/1e3,kilometres:Ks/1e3,meters:Ks,metres:Ks,miles:Ks/1609.344,millimeters:Ks*1e3,millimetres:Ks*1e3,nauticalmiles:Ks/1852,radians:1,yards:Ks*1.0936};function jB(e,t,o={}){const a={type:"Feature"};return(o.id===0||o.id)&&(a.id=o.id),o.bbox&&(a.bbox=o.bbox),a.properties=t||{},a.geometry=e,a}function lC(e,t,o={}){if(!e)throw new Error("coordinates is required");if(!Array.isArray(e))throw new Error("coordinates must be an Array");if(e.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!zO(e[0])||!zO(e[1]))throw new Error("coordinates must contain numbers");return jB({type:"Point",coordinates:e},t,o)}function k_e(e,t,o={}){for(const d of e){if(d.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");if(d[d.length-1].length!==d[0].length)throw new Error("First and last Position are not equivalent.");for(let p=0;p<d[d.length-1].length;p++)if(d[d.length-1][p]!==d[0][p])throw new Error("First and last Position are not equivalent.")}return jB({type:"Polygon",coordinates:e},t,o)}function P_e(e,t="kilometers"){const o=A_e[t];if(!o)throw new Error(t+" units is invalid");return e*o}function $b(e){return e%360*Math.PI/180}function zO(e){return!isNaN(e)&&e!==null&&!Array.isArray(e)}function FO(e){if(!e)throw new Error("coord is required");if(!Array.isArray(e)){if(e.type==="Feature"&&e.geometry!==null&&e.geometry.type==="Point")return[...e.geometry.coordinates];if(e.type==="Point")return[...e.coordinates]}if(Array.isArray(e)&&e.length>=2&&!Array.isArray(e[0])&&!Array.isArray(e[1]))return[...e];throw new Error("coord must be GeoJSON Point or an Array of numbers")}function R_e(e,t,o={}){var a=FO(e),d=FO(t),p=$b(d[1]-a[1]),y=$b(d[0]-a[0]),r=$b(a[1]),S=$b(d[1]),C=Math.pow(Math.sin(p/2),2)+Math.pow(Math.sin(y/2),2)*Math.cos(r)*Math.cos(S);return P_e(2*Math.atan2(Math.sqrt(C),Math.sqrt(1-C)),o.units)}function HB(e,t,o){if(e!==null)for(var a,d,p,y,r,S,C,M=0,P=0,z,F=e.type,V=F==="FeatureCollection",N=F==="Feature",H=V?e.features.length:1,U=0;U<H;U++){C=V?e.features[U].geometry:N?e.geometry:e,z=C?C.type==="GeometryCollection":!1,r=z?C.geometries.length:1;for(var te=0;te<r;te++){var Z=0,q=0;if(y=z?C.geometries[te]:C,y!==null){S=y.coordinates;var J=y.type;switch(M=0,J){case null:break;case"Point":if(t(S,P,U,Z,q)===!1)return!1;P++,Z++;break;case"LineString":case"MultiPoint":for(a=0;a<S.length;a++){if(t(S[a],P,U,Z,q)===!1)return!1;P++,J==="MultiPoint"&&Z++}J==="LineString"&&Z++;break;case"Polygon":case"MultiLineString":for(a=0;a<S.length;a++){for(d=0;d<S[a].length-M;d++){if(t(S[a][d],P,U,Z,q)===!1)return!1;P++}J==="MultiLineString"&&Z++,J==="Polygon"&&q++}J==="Polygon"&&Z++;break;case"MultiPolygon":for(a=0;a<S.length;a++){for(q=0,d=0;d<S[a].length;d++){for(p=0;p<S[a][d].length-M;p++){if(t(S[a][d][p],P,U,Z,q)===!1)return!1;P++}q++}Z++}break;case"GeometryCollection":for(a=0;a<y.geometries.length;a++)if(HB(y.geometries[a],t)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function O_e(e,t){var o,a,d,p,y,r,S,C,M,P,z=0,F=e.type==="FeatureCollection",V=e.type==="Feature",N=F?e.features.length:1;for(o=0;o<N;o++){for(r=F?e.features[o].geometry:V?e.geometry:e,C=F?e.features[o].properties:V?e.properties:{},M=F?e.features[o].bbox:V?e.bbox:void 0,P=F?e.features[o].id:V?e.id:void 0,S=r?r.type==="GeometryCollection":!1,y=S?r.geometries.length:1,d=0;d<y;d++){if(p=S?r.geometries[d]:r,p===null){if(t(null,z,C,M,P)===!1)return!1;continue}switch(p.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(t(p,z,C,M,P)===!1)return!1;break}case"GeometryCollection":{for(a=0;a<p.geometries.length;a++)if(t(p.geometries[a],z,C,M,P)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}z++}}function L_e(e,t,o){var a=o;return O_e(e,function(d,p,y,r,S){a=t(a,d,p,y,r,S)}),a}function D_e(e){return L_e(e,(t,o)=>t+z_e(o),0)}function z_e(e){let t=0,o;switch(e.type){case"Polygon":return NO(e.coordinates);case"MultiPolygon":for(o=0;o<e.coordinates.length;o++)t+=NO(e.coordinates[o]);return t;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0}return 0}function NO(e){let t=0;if(e&&e.length>0){t+=Math.abs(BO(e[0]));for(let o=1;o<e.length;o++)t-=Math.abs(BO(e[o]))}return t}var F_e=Ks*Ks/2,IS=Math.PI/180;function BO(e){const t=e.length-1;if(t<=2)return 0;let o=0,a=0;for(;a<t;){const d=e[a],p=e[a+1===t?0:a+1],y=e[a+2>=t?(a+2)%t:a+2],r=d[0]*IS,S=p[1]*IS,C=y[0]*IS;o+=(C-r)*Math.sin(S),a++}return o*F_e}function N_e(e,t={}){if(e.bbox!=null&&t.recompute!==!0)return e.bbox;const o=[1/0,1/0,-1/0,-1/0];return HB(e,a=>{o[0]>a[0]&&(o[0]=a[0]),o[1]>a[1]&&(o[1]=a[1]),o[2]<a[0]&&(o[2]=a[0]),o[3]<a[1]&&(o[3]=a[1])}),o}function B_e(e,t={}){const o=N_e(e),a=(o[0]+o[2])/2,d=(o[1]+o[3])/2;return lC([a,d],t.properties,t)}const V_e="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAABExJREFUWEe1lm1sU1UYx//PbUfdi2NBFkOCcWM2ESMv2z6s3dx2b6OCmmlC+IDR+ILED6hZbzeGRhdrYqKuaW9H0MQY34jGLwajvAgRdzspvY3y4kCJRhj1FXVhMExh69oec+9are297e3A82VLz//5P7/znHPucwjzGM7PAiuYlVo5oFsNTwOjlGRHlDs8J8q1I7MBK/f7qqsqLENEdDeABoO4GGNs76XZ1MDxNVviZrxNAThk6REChgDUmzEFMMGAgaggvlNKXxLAMRLYk1l1Ka+CebUaUZfnnmKBRQGco8GHkGbvlp05N4Cjh5Vu9w4jD0MA56i/GWnu6BUlzwZz6Ralu++YnpcuQOsub9WC6oWfgtB1VQAYvkjEp+460uO9lO+nC+CQpQcIeM8o+fbV6/Hk1x9q0y11SwtkRy/8UngegAejgvi+KQCnHHwJYE/ni7PJfCvuw5YTH2vTzRkAG2dFpaUCkckYlHNndNjpZUVwP2MOICR9AoaefPFjDQ5UWSpw/w2t2PnrGM7PXsabseg/MnX+5F9/6AMQdim8eK85ADk4DrBGoy2I8G60h4LatKverv1NsjTsNfXGAKAziuBeZhJAmgZgyxere59Mp2AhDk01izEeP4ez0xe10mfHgT+/R2jilB77jCKI15gDGJFOgdCUL+5a3ITrbddCtPN47ts9GJn4Ac/efKdWcvV/dSzgrEikk4UADKcVl3iTOQBZkgHw+eLNy27TVj24fA2OZU66WoFcgOFV69A7tlOvAgcVQSy41rrX0ClLTwDYnu/y6ur12ko9dgGDmQr02wXcUrsEv01Poa6iEicv/o7XxsMFAMSoN+JybzNVgbYDwZWchY3li0e7nsKOn77CxgYHxOMf4cvJH7X9b1t0IzjMrSW7FbmxBPzMWW2rwp2bz5sCUEUOOfABgTZkAxqrr0OfXdA+QI83tmPD0hbEUzOIJxOIpxK4nEoAGYjsRyonmagI4ty1yRvFewHjwmCoysY4FzVAmYzp+Rj/ZnD/swFFu6Hjc7+XOO758jL+Rx3nwPhDguewkUdRAK0p1dSGAWqeDwQjbI3yovqQMRylHySydDsB+wBYyoTYrwji2lIxJQFUA6cc6AVI9xDpJiDMgjhe6e6NXBUA1aRdlt5gwKZShuo8gQYjgvtFc1ozKgBte7fVcpUpdSucRfeUSI7wbpdJ28zFNanukP2ONGgfQAv1Q9gUB7b2kND3b48u4W3qDOR6tIcCjzJGb+n5ErGNEd7ztsn1aLKyAbTzEJJeYQwDuYmIMBThxa3lJJ8XgCRJmxhjnnAjlp+tm+NfcoGhM0bfMMZe93g8BU3sir4DucE+n4+3WCxqq8aMFTiYeTF0ngZsmScAx3E9brd7t9lKlLUFuQBGCf5XADWp3+/3EpFufyAiryiKL5hd/bzOgBo0PDx8azKZ7CCiDgAJxliIMXa4v7//u3KSq9q/AacSfDB4RQOdAAAAAElFTkSuQmCC",$_e="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAABBJJREFUWEe1ln9MVWUYxz/PJbkKoVubrllrEBYjSyNX0zRj3oshBtP+ahnpvZBra4sfMtDNFk1nCmNEuprpvZeK5j85p4QlHEKMtdYo1g+XFYjIH23ZNG38EG73jXNPTuicwz0X6/3nnJ33eb7fz3ne5z3vEWYw1BbvQ7giy0CeNNJVJxHX19KofR+vnDhNUIVrk5kVqQGVB5JqnacugJxk3FUpH7QOOdF2BKD8a7aAqwaY70QUuASRSgl+1hgrPiaA8nlbEPJiCVnOK05KSFs/Xe60AMrvfQF4b0bmN5M2S1B7307DFkAVebNQfHOL5ka68IgEtB4rLUsAtTU/ifDwJyCr/xMA1BluS1on7zYP/1vPGsDv2QTSZGn++FpYeA98dNiY3roDOlvgp+9isKrnJdj+oUMA7xvAdkvFXYdgTymMDEHq/fDidrg+Cslz4fYUaD0Kxy2XfK8EtR3OAIpyTqBUvglguQfSH4DuM+DdCHfMh96zcORtyMyCihp4aT2Mj5nZRZol0FbgDMDvPT/R/WkmlZLdcOV3WPYEHNwD9y0G92xIzYCMJbCzCH69aLcU/RO74V6nAKOA26Tk2wajI/DwCqgqNKYLCuHp52BkGBrroOcLO4DrEtRmOwPweXsR0i2V9h+DvWWwaDHkPAP956DpAMxKhG37oO8sNO03pyr6JKQtcgrQgZBtUtmwGcJhSMuA7k4Y6IWMpXC6GVLmwbU/YFUudH1q0QN8LgHNtK1ttmHOy6AOmFQ8G2CwzzDW1/7aFSPkrlRYnQcLFkLDTuslUKpEQu1vOatAsWcJEfnWpKSXPT3TKP/gebjzbkh0Q/tx+LHH2BWXL1kBDOJ2L5V3Wv4hvhli/yn2e46APDtF7ZVdcOFnGPjFuF69DHOSYdVTxs642Atdp4zr1FEmQe1NK7JYZ0EXkGTX1qbnLhdEIlMf2+z/G0GxTsPqid+d1xwDmAOHQLIl2NZtpzE9QPRQGtGrkDUjCJEqCbTpPzK2I/YPid/jBdH3VUKcEKckqOXGyokJoAuoopwSlLJsIhuDcZQrW0Kttp9FRz0wWVz5PIcQKY71RtF54VUJaLudxDqqQLQKm9bNxT2uL8WKGMIdEtTWODE3WOMYqti7nAg6xDybtKu4yJXD2pdOZeMCiFbC5/UhBC0NFH4JaSGn5nFX4IawKsrZh1KVU4xEaiTQVhWP+YwA6uvri5VS5QUD3Znpf/4W9etLWUBz6qM/KKUOlpeXmw+xW/kOTM6tra3NTkhI6NCfzflrjI39X0Wnj6U9xkhCYvTe5XLll5aWfuy0EnH1wGQAO4P/FUA3raurqxYRy/NBRKrLysped/r2M+oBPamhoeHBcDi8UkRWAmNKqdNKqe6Kiopz8ZjrsX8DsGBJMCEPcb0AAAAASUVORK5CYII=",AS="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAYAAABWdVznAAAAAXNSR0IArs4c6QAAAQ1JREFUKFONkUErhFEUhp8zfoKy0qSUsmaj+bjKmrJgN8xs+AmDYkEx8xPYYGbHQrFWPj7ZsFZqosbKwj8wR/feueOmr7ir0znnPe859xGipwdmjQIJyrRLC3d0yWQzPQptEgKtm0dgIh4QxU+ykU76GYA2zBnKkmsorcLQqO/9aMP9qY+Fc6mly6L7pkyBpkvWbvINGrM+32VF+tOTCpQq+YLs2DtZF62bDjDMwjaMz+ULnq/hcs/W3q3gFRhhcRfGZvIFL7dwsWNrb3alJkrZHZtU/1qpJe7vhcN/Ha2s+2+NGVinwaJ3+uxAdhJcHYsfcDGL34v1GPTBhbpjMsA8ylQP1gNfXMlW2go93xgvWoFerZbMAAAAAElFTkSuQmCC",U_e="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAMCAYAAAB4MH11AAAAAXNSR0IArs4c6QAAAQxJREFUOE+tkl1Kw0AUhc+dDWX6mukKhN4NFAqKQqGgKAoFRVAUEUVRRBFFETfQTraQyWOTrOjWWqtR02aqnacZOOf75o8wxzD9tAlSS46Dpm+NfIP1KG+JyMsoL8Brwrrl0/UShFG2TIKnIpAIz3FDr1RJKgXG5quAPJSD6NFxsDZLMlNg+oM2SN1V7PLesW5Py0wV1HtpRxTdVF3B+E3kNuFapyxbKgijfJ1ErnzgkwwRXceNYONn55fA2GwTwMU88EL20rHe+vYZigtj821Azv4I/6jJuePazufJJhPTG3Sh1Mn/4OO2AKcJ6+5o/n5FoU13CXS0CPjXzuk45mCPjM3230QHi4QXWIdDKLNHSzG5InwAAAAASUVORK5CYII=",VO=({points:e,azimuth:t=!1})=>{const[o,a,d]=e,p={x:a[0]-o[0],y:a[1]-o[1]},y={x:d[0]-a[0],y:d[1]-a[1]},r=p.x*y.x+p.y*y.y,S=Math.sqrt(p.x**2+p.y**2),C=Math.sqrt(y.x**2+y.y**2),M=r/(S*C),P=Math.max(-1,Math.min(1,M)),F=Math.acos(P)*(180/Math.PI);let N=p.x*y.y-p.y*y.x<0?F-180:180-F;t&&(N=N<0?N+360:N);const{angleBA:H,angleBC:U}=j_e(e);let te=0;return H<0&&U<0&&(te=-Math.max(Math.abs(H),Math.abs(U))),H>0&&U>0&&(te=Math.min(Math.abs(H),Math.abs(U))),H>=135&&H<=180&&U<=-45&&U>=-90&&(te=H),U>=135&&U<=180&&H<=-45&&H>=-90&&(te=U),H>=135&&H<=180&&U<=0&&U>=-45&&(te=U),U>=135&&U<=180&&H<=0&&H>=-45&&(te=H),H>=90&&H<=135&&U<=0&&U>=-45&&(te=U),U>=90&&U<=135&&H<=0&&H>=-45&&(te=H),H>=90&&H<=135&&U>=-90&&U<=-45&&(te=H),U>=90&&U<=135&&H>=-90&&H<=-45&&(te=U),H>=0&&H<=90&&U<=0&&U>=-90&&(te=U),U>=0&&U<=90&&H<=0&&H>=-90&&(te=H),U>=-180&&U<=-90&&H<=180&&H>=90&&(te=H),H>=-180&&H<=-90&&U<=180&&U>=90&&(te=U),U>=-135&&U<=-90&&H>=0&&H<=45&&(te=U),U>=-135&&U<=-90&&H>=45&&H<=90&&(te=H),H>=-135&&H<=-90&&U>=0&&U<=45&&(te=H),H>=-135&&H<=-90&&U>=45&&U<=90&&(te=U),U>=-180&&U<=-135&&H>=0&&H<=45&&(te=U),U>=-180&&U<=-135&&H>=45&&H<=90&&(te=H),H>=-180&&H<=-135&&U>=0&&U<=45&&(te=H),H>=-180&&H<=-135&&U>=45&&U<=90&&(te=U),{Angle:Number(Math.abs(N.toFixed(0))),rotate:te,rotation:N*Math.PI/180}},j_e=e=>{const[t,o,a]=e,[d,p]=t,[y,r]=o,[S,C]=a,M={x:d-y,y:p-r},P={x:S-y,y:C-r};let z=Math.atan2(M.y,M.x)*(180/Math.PI),F=Math.atan2(P.y,P.x)*(180/Math.PI);return z>=0&&z<90||z>=90&&z<=180?z=180-z:(z<0&&z>=-90,z=Math.abs(z)-180),F>=0&&F<90||F>=90&&F<=180?F=180-F:(F<0&&F>=-90,F=Math.abs(F)-180),{angleBA:z,angleBC:F}},H_e=e=>{let t=(e+90)%360;return t<270&&(t+=360),t},$O=e=>{const t=H_e(e.Angle),o=40,a=100,d=100,p=d+o*Math.cos(t*Math.PI/180),y=a-o*Math.sin(t*Math.PI/180),r=a,S=d-o;let C;t>=450&&t<=629?C=0:t>=270&&t<450&&(C=1);const M=`M ${S} ${r} A ${o} ${o} 0 ${C} 1 ${y} ${p}`,P=`M ${y} ${p} L ${S} ${p}  L${S} ${r}`,z=Math.abs(t);let F=M;z==540&&(F=P);let V=e.Angle==90?"":`<text fill="black" font-size="16" text-anchor="middle">
              <textPath href="#arc" startOffset="50%" side="left">
                  <tspan dy="-5">${e.Angle}</tspan>
              </textPath>
          </text>`;const N=`<svg width="200" height="200" viewBox="0 0 200 200" style="transform:rotate(${e.rotate}deg);transform-origin: 100px 100px;"  transform="rotate(${e.rotate})" xmlns="http://www.w3.org/2000/svg">
          <path id="arc" fill="none" stroke="red" stroke-width="1" d="${F}" />${V}</svg>`;return"data:image/svg+xml;charset=utf-8,"+encodeURIComponent(N)},UO=e=>e>100?Math.round(e/1e3*100)/100+" km":Math.round(e*100)/100+" m",G_e=e=>e>1e6?Math.round(e/1e6*100)/100+" km":Math.round(e*100)/100+" m",$l={CLEAR:"CLEAR",MEASUREDISTANCE:"MEASUREDISTANCE",MEASUREANGLE:"MEASUREANGLE",AZIMUTH:"AZIMUTH",MEASUREPOLYGON:"MEASUREPOLYGON"},W_e={MEASUREDISTANCE:"draw_line_string",MEASUREANGLE:"draw_point",AZIMUTH:"draw_point",MEASUREPOLYGON:"draw_polygon"},q_e={CREATE:"draw.create",UPDATE:"draw.update"},K_e={class:"Draw_draw__UPVhb"},Z_e=["onClick"],Y_e={role:"img",class:"anticon"},X_e={width:"1em",height:"1em","aria-hidden":"true",focusable:"false",class:""},J_e=["xlink:href"],Q_e=We({__name:"tools",setup(e){const{CREATE:t,UPDATE:o}=q_e,{map:a}=bD(gM()),d=xe(""),p=Yy.modes,y=new Yy({modes:p});let r={},S={};Wt(()=>a.value,de=>{y&&y.onAdd(de),de.on(t,M),de.on(o,M)});let C=new Date().getTime();const M=de=>{var ye;y.getAll();const{type:Ie,features:Ve,action:be}=de;if(Ie==o&&Ve.length){let Me=null;if([$l.MEASUREDISTANCE,$l.MEASUREPOLYGON].includes(d.value)){const{id:we}=Ve[0];Me=we}else{const{id:we}=Ve[0],De=((ye=Object.values(r))==null?void 0:ye[0]).filter(Ge=>Ge.id==we);De&&De.length&&(Me=De[0].properties.timeStamp,r[Me]=r[Me].filter(Ge=>Ge.id!=we))}Me&&(S[Me].forEach(we=>{we.remove()}),S[Me]=[])}d.value==$l.MEASUREPOLYGON&&de.features&&de.features.length&&(H(de.features[0]),d.value=""),d.value==$l.MEASUREDISTANCE&&de.features&&de.features.length&&(te(de.features[0]),d.value=""),d.value==$l.MEASUREANGLE&&de.features&&de.features.length&&F(de.features[0]),d.value==$l.AZIMUTH&&de.features&&de.features.length&&P(de.features[0])},P=de=>{const Ie=y.getAll(),{id:Ve}=de;Ie.features.forEach((be,ye,Me)=>{be.id==Ve&&(Me[ye].properties.timeStamp=C,r[C]&&r[C].length&&r[C].length<2?r[C].push(be):r[C]||(r[C]=[be]))}),r[C].length<2?setTimeout(function(){y.changeMode("draw_point")},0):(z(),d.value="")},z=()=>{S[C]=[];let de=[];for(let Me=0;Me<r[C].length;Me++)de.push(r[C][Me].geometry.coordinates);const Ie=J(de[0],de[1]),Ve=[de[0][0],de[0][1]+Ie/111139];de.unshift(Ve);for(let Me=0;Me<de.length;Me++)S[C].push(new ms.Marker(Z(Me==0?U_e:AS,Me==0)).setLngLat(de[Me]).addTo(a.value));S[C].push(new ms.Marker({element:le("")}).setLngLat(de[0]).setOffset([0,-12]).addTo(a.value));const be=VO({points:de}),ye=$O(be);S[C].push(new ms.Marker(V(ye)).setLngLat(de[1]).addTo(a.value)),y.get(C)&&y.delete([C]),y.add({id:C,type:"Feature",properties:{},geometry:{type:"LineString",coordinates:de}})},F=de=>{const Ie=y.getAll(),{id:Ve}=de;Ie.features.forEach((be,ye,Me)=>{be.id==Ve&&(Me[ye].properties.timeStamp=C,r[C]&&r[C].length&&r[C].length<3?r[C].push(be):r[C]||(r[C]=[be]))}),r[C].length<3?setTimeout(function(){y.changeMode("draw_point")},0):(N(),d.value="")},V=de=>{const Ie=document.createElement("img");return Ie.className="mapbox-tool-angle-img",Ie.src=de,Ie.style.width="200px",Ie.style.height="200px",Ie},N=()=>{S[C]=[];let de=[];for(let be=0;be<r[C].length;be++){let ye=r[C][be].geometry.coordinates;de.push(ye),S[C].push(new ms.Marker(Z(AS)).setLngLat(ye).addTo(a.value))}const Ie=VO({points:de}),Ve=$O(Ie);S[C].push(new ms.Marker(V(Ve)).setLngLat(de[1]).addTo(a.value)),y.get(C)&&y.delete([C]),y.add({id:C,type:"Feature",properties:{},geometry:{type:"LineString",coordinates:de}})},H=de=>{const{geometry:{coordinates:Ie},id:Ve}=de;S[Ve]=[],q(Ie[0],!0,Ve);const be=k_e(Ie),ye=B_e(be),Me=D_e(de);S[Ve].push(new ms.Marker({element:le(G_e(Me))}).setLngLat(ye.geometry.coordinates).addTo(a.value))},U=(de="start")=>{const Ie=document.createElement("div");return Ie.className="mapbox-tool-marker",Ie.style.background=`url(${de=="start"?V_e:$_e})`,Ie.style.backgroundSize="100%",Ie.style.width="32px",Ie.style.height="32px",Ie.style.display="block",Ie},te=de=>{const{geometry:{coordinates:Ie},id:Ve}=de,be=U("start");S[Ve]=[],S[Ve].push(new ms.Marker(be).setLngLat(Ie[0]).setOffset([0,-14]).addTo(a.value));const ye=U("end");S[Ve].push(new ms.Marker(ye).setLngLat(Ie[Ie.length-1]).setOffset([0,-14]).addTo(a.value)),Ie.length>2&&q(Ie,!1,Ve),re(Ie,Ve)},Z=(de,Ie)=>{const Ve=document.createElement("div");return Ve.className="mapbox-tool-marker",Ve.style.background=`url(${de})`,Ve.style.backgroundSize="100%",Ve.style.width=Ie?"24px":"12px",Ve.style.height="12px",Ve.style.display="block",Ve};function q(de,Ie,Ve){let be=0;for(Ie||(be=1);be<de.length-1;be++)S[Ve].push(new ms.Marker(Z(AS)).setLngLat(de[be]).addTo(a.value))}function J(de,Ie){const Ve=[de[1],de[0]],be=[Ie[1],Ie[0]],ye=lC(Ve),Me=lC(be);return R_e(ye,Me,{units:"meters"})}function re(de,Ie){let Ve=0;for(let be=0;be<de.length-1;be++){const ye=de[be],Me=de[be+1],we=J(ye,Me);Ve+=we,se(ye,Me,we,Ie)}de.length>2&&S[Ie].push(new ms.Marker({element:le(UO(Ve))}).setLngLat(de[de.length-1]).setOffset([0,15]).addTo(a.value))}function se(de,Ie,Ve,be){const ye=[(de[0]+Ie[0])/2,(de[1]+Ie[1])/2],Me=he(de,Ie),we=UO(Ve);S[be].push(new ms.Marker({element:le(we)}).setLngLat(ye).setRotation(Me).setOffset([0,-10]).addTo(a.value))}function he(de,Ie){const Ve=Ie[0]-de[0],be=Ie[1]-de[1];let Me=Math.atan2(be,Ve)*(180/Math.PI);return Me<0&&(Me+=360),360-Me}function le(de){const Ie=document.createElement("div");return Ie.style.fontSize="12px",Ie.style.color="#333",Ie.style.textAlign="center",Ie.style.textShadow="2px 2px 5px white",Ie.textContent=`${de}`,Ie}const ce=de=>{d.value=de,C=new Date().getTime();const Ie=W_e[de];if(Ie)y.changeMode(Ie);else{y.deleteAll(),d.value="",r={},C=void 0;for(let Ve in S)S[Ve].forEach(be=>be.remove())}},pe=[{text:"",icon:"#icon-measure-distance",type:$l.MEASUREDISTANCE},{text:"",icon:"#icon-measure-polygon",type:$l.MEASUREPOLYGON},{text:"",icon:"#icon-protractor",type:$l.MEASUREANGLE},{text:"",icon:"#icon-azimuth",type:$l.AZIMUTH},{text:"",icon:"#icon-delete",type:$l.CLEAR}];return(de,Ie)=>{const Ve=Er("el-tooltip");return ae(),Pe("ul",K_e,[(ae(),Pe(Vn,null,Fr(pe,be=>Ue("li",{class:fe({active:d.value==be.type}),onClick:()=>ce(be.type)},[qe(Ve,{class:"box-item",effect:"dark",content:be.text,placement:"left",offset:20},{default:ot(()=>[Ue("span",Y_e,[(ae(),Pe("svg",X_e,[Ue("use",{"xlink:href":be.icon},null,8,J_e)]))])]),_:2},1032,["content"])],10,Z_e)),64))])}}}),eye=_M(Q_e,[["__scopeId","data-v-5cf25ef4"]]),tye={id:"map"},nye=We({__name:"map",setup(e){ms.accessToken="pk.eyJ1IjoibG9uZ2xvbmd3YXl0b2dvIiwiYSI6ImNqdnZ6OWV6cTFnY240NG9nbmxnc2k5dTkifQ.hsbNl4QUNyn46nfbztiFpw";const t=gM(),o=()=>{const a=new ms.Map({container:"map",style:"mapbox://styles/mapbox/light-v10",center:[114.3055,30.5928],zoom:12,projection:"globe"});a.scrollZoom.enable(),a.touchZoomRotate.enable(),a.addControl(new Vge({defaultLanguage:"zh-Hans"})),a.addControl(new ms.FullscreenControl),a.addControl(new ms.NavigationControl,"top-left"),a.addControl(new ms.ScaleControl),a.addControl(new ms.GeolocateControl({positionOptions:{enableHighAccuracy:!0},trackUserLocation:!0,showUserHeading:!0})),t.setMapConfig({map:a})};return yr(()=>{o()}),(a,d)=>(ae(),Pe("div",tye,[qe(jge),qe(eye)]))}}),rye=_M(nye,[["__scopeId","data-v-d6e2a61b"]]),iye=We({__name:"App",setup(e){const t=document.querySelector("#svgBase"),o=()=>{fetch("./icons.svg").then(a=>a.text()).then(a=>{t&&a&&(t.innerHTML=a)})};return ev(()=>{o()}),(a,d)=>(ae(),At(rye))}}),oye=uU(),EM=mD(iye);EM.use(oye);EM.use(Dge);let hh=null;function GB(e){const{container:t}=e,o=t?t.querySelector("#app"):document.getElementById("app");return console.log(" ~ render ~ node:",o),hh=EM.mount(o),hh}Fge({mount(e){hh=GB(e)},bootstrap(){},unmount(e){console.log(e),hh==null||hh.unmount()},update(e){console.log(e)}});zge.__POWERED_BY_QIANKUN__||(hh=GB({}))});export default sye();
